[{"tags": ["c", "compiler-construction", "abstract-syntax-tree", "bison"], "comments": [{"owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "reply_to_user": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "edited": false, "score": 0, "creation_date": 1560992203, "post_id": 56677336, "comment_id": 99922038, "body": "Edited the question. The compiler is for C-- but all the code is C."}, {"owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "reply_to_user": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "edited": false, "score": 0, "creation_date": 1560994022, "post_id": 56677336, "comment_id": 99922321, "body": "I double checked and my allocation is correct. Can you explain what you mean by the setting child node with unknown values?"}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1560995249, "post_id": 56677336, "comment_id": 99922528, "body": "We will need to see the callers of <code>add_sibling</code> and <code>new_subtree</code>."}, {"owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "edited": false, "score": 0, "creation_date": 1560996164, "post_id": 56677336, "comment_id": 99922683, "body": "Updated with callers."}, {"owner": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "edited": false, "score": 0, "creation_date": 1560998223, "post_id": 56677336, "comment_id": 99923014, "body": "Ah yes, I get what you are doing with <code>* node</code>.  My mistake.  As torek said, without knowing the callers, it&#39;s not possible to be sure of certain types of error (e.g. local variables that go out of scope etc.)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1561000745, "post_id": 56677336, "comment_id": 99923463, "body": "It&#39;s a lot easier to build ASTs without parent links. Why do you think you need them? Anyway, there are various problems with your code. One problem you could have avoided if you had read <a href=\"https://stackoverflow.com/a/56620571/1566221\">my other answer</a> more carefully. (Hint: what does <code>$$</code> mean in a MRA?). Another problem is probably <code>current_id</code>; I don&#39;t know where you are setting it, but I&#39;m guessing it&#39;s in your lexer, in which case it is not going to be in synch with your parse, leading to obscure bugs with certain inputs. You should use the semantic value, not a global, to communicate..."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1561000954, "post_id": 56677336, "comment_id": 99923515, "body": "But to get back to AST parents, you call <code>add_sibling</code> in an action for <code>var-decl-list</code>. Afaics <code>add_sibling</code> assumes that its first argument already has a parent. I claim that <code>$1</code> at that point doesn&#39;t yet have a parent. But of course I can only see a bit of your code. Prove me wrong, if you can. Or fix it."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1561001275, "post_id": 56677336, "comment_id": 99923577, "body": "Finally, I don&#39;t know what you mean when you say that &quot;gdb points at&quot; those two lines. What do you mean by that? I don&#39;t see how those two lines can be in the same backtrace, if that&#39;s what you meant. Are you talking about two different backtraces from two different inputs? What are the inputs? Please read the advice on preparing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, emphasis on &quot;minimal&quot;."}, {"owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1561006693, "post_id": 56677336, "comment_id": 99924583, "body": "Hello again @rici thank you for all your help. I thought in using parent links because I needed to create nodes (from rules) that have an indefinite n&#186; of children and are recursive e.g. the block nodes seen on this tree <a href=\"https://pasteboard.co/IkeRldh.png\" rel=\"nofollow noreferrer\">pasteboard.co/IkeRldh.png</a>"}, {"owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "edited": false, "score": 0, "creation_date": 1561007019, "post_id": 56677336, "comment_id": 99924657, "body": "I see what you mean by $1 not having a parent at that point and I guess you are right, I think this must be my main issue. Thought bison handled parsing differently. But I can&#39;t seem to think of another way to do it. Do you have some idea on how to fix it?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1561007646, "post_id": 56677336, "comment_id": 99924844, "body": "Simple solution: parent has pointer to first child; every node has pointer to next sibling. That&#39;s a standard tree representation, which shows the isomorphism between general trees and binary trees."}, {"owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "edited": false, "score": 0, "creation_date": 1561007690, "post_id": 56677336, "comment_id": 99924855, "body": "And yes those where two different backtraces. The inputs are simple C-- programs. And yes sorry about the scattered info, I had little time to spend on this project and the due was 2 hours ago. Total panic time when I posted this."}, {"owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1561008094, "post_id": 56677336, "comment_id": 99924967, "body": "That&#39;s a really nice simple solution, should have thought on this before making parent links, definitely will do. Thanks again @rici :)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1561010338, "post_id": 56677336, "comment_id": 99925619, "body": "Since you&#39;re rushing, I&#39;ll just leave you with the other part: bison parsers (usually) construct lists left-to-right which means each new node has to go on the end. But it&#39;s way easier to construct a linked list by adding each new node at the beginning. If you do that, the list ends up being backwards. Fortunately it&#39;s really easy to reverse a list in place, which you need to do when you finally make the list the child of some node (<code>$$.first_child = reverse($2);</code> or code to that effect)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1561010350, "post_id": 56677336, "comment_id": 99925625, "body": "Note that <code>reverse</code> must return the head of the reversed list, which will be the tail of the argument, which will, in fact, be the first element pushed onto an empty list. An empty list can just be a <code>NULL</code> pointer. Good luck!"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1561068130, "post_id": 56677336, "comment_id": 99954045, "body": "Add more warning options to your compiler command line.  Compile with <code>-g</code> for debug info. Use <code>valgrind</code> on your program before debugging with <code>gdb</code>; it finds problems that lead up to a crash, rather than just the crash itself."}], "owner": {"reputation": 333, "user_id": 7721886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nE_wBylnCHA/AAAAAAAAAAI/AAAAAAAAAJE/2roYWxdz1AE/photo.jpg?sz=128", "display_name": "Perestroika", "link": "https://stackoverflow.com/users/7721886/perestroika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560997289, "creation_date": 1560988646, "last_edit_date": 1560997289, "question_id": 56677336, "link": "https://stackoverflow.com/questions/56677336/making-an-ast-constructor-for-a-compiler-cant-figure-out-segfault", "title": "Making an AST constructor for a compiler, can&#39;t figure out segfault", "body": "<p>So I'm currently making a c-- compiler for a school project (due today) and I have a segfault that I can't figure out. There is a considerable amount of code don't want to overwhelm this question with all of it.</p>\n\n<p>I ran GDB and it pointed out a couple of functions of one file, but I couldn't tell what the issue is, probably because I don't have that much experience with C. The functions are being called from another file.</p>\n\n<p>Bellow are the used functions/structures of the file, GDB pointed to the lines I commented. I can tell it can't access the parent of a node, but I can't figure a reason for that.</p>\n\n<p>I'm watching this post, if you feel some code or info is missing please point out and I will edit the post instantly.</p>\n\n<p>PS: AST is a node. All this code is C.</p>\n\n<pre><code>#define CHILDREN_LIMIT 20\nstruct node {\n    NodeKind kind;\n    int data;\n    int count;\n    AST* parent;\n    AST* child[CHILDREN_LIMIT];\n};\n\nAST* new_node(NodeKind kind, int data) {\n    AST* node = malloc(sizeof * node);\n    node-&gt;kind = kind;\n    node-&gt;data = data;\n    node-&gt;count = 0;\n    node-&gt;parent = NULL;\n    for (int i = 0; i &lt; CHILDREN_LIMIT; i++) {\n        node-&gt;child[i] = NULL;\n    }\n    return node;\n}\n\nvoid add_child(AST *parent, AST *child) {\n    if (parent-&gt;count == CHILDREN_LIMIT) {\n        fprintf(stderr, \"Cannot add another child!\\n\");\n        exit(1);\n    }\n    parent-&gt;child[parent-&gt;count] = child;\n    parent-&gt;count++;\n    child-&gt;parent = parent; // GDB POINTS HERE\n}\n\nAST* get_child(AST *parent, int idx) {\n    return parent-&gt;child[idx];\n}\n\n// Adds s2 as child of s1 parent\nvoid add_sibling(AST *s1, AST *s2) {\n  if (s1-&gt;parent-&gt;count == CHILDREN_LIMIT) { // GDB POINTS HERE\n      fprintf(stderr, \"Cannot add another child!\\n\");\n      exit(1);\n  }\n  s1-&gt;parent-&gt;child[s1-&gt;parent-&gt;count] = s2;\n  s1-&gt;parent-&gt;count++;\n  s2-&gt;parent = s1-&gt;parent;\n}\n\nAST* new_subtree(NodeKind kind, int child_count, ...) {\n    if (child_count &gt; CHILDREN_LIMIT) {\n        fprintf(stderr, \"Too many children as arguments!\\n\");\n        exit(1);\n    }\n\n    AST* node = new_node(kind, 0);\n    va_list ap;\n    va_start(ap, child_count);\n    for (int i = 0; i &lt; child_count; i++) {\n        add_child(node, va_arg(ap, AST*));\n    }\n    va_end(ap);\n    return node;\n}\n</code></pre>\n\n<p>----------EDIT------------------ </p>\n\n<p>On my parser (bison) these are the caller rules and it's derivates:</p>\n\n<pre><code>write-call: WRITE LPAREN STRING RPAREN { new_subtree(WRITE_NODE,1,$3); }; // THIS ONE\n\nvar-decl-list: var-decl-list var-decl { add_sibling($1,$2); $$ = $1; } // AND THIS ONE\n| var-decl { $$ = new_node(VAR_LIST_NODE, 0); add_child($$,$1); };\n\nvar-decl: INT ID SEMI { var_size = 0; $$ = new_var(); }\n| INT ID LBRACK NUM { var_size = atoi(yytext); $$ = new_var(); } RBRACK SEMI;\n\nAST* new_var() {\n    int index = lookup_var(vt, current_id, scope);\n    if (index != -1) {\n        printf(\"SEMANTIC ERROR (%d): variable '%s' already declared at line %d.\\n\",\n                yylineno, current_id, get_var_line(vt, index));\n        exit(1);\n    }\n    index = add_var(vt, current_id, yylineno, scope, var_size);\n    AST *vd = new_node(VAR_DECL_NODE,index);\n    if(var_size &gt; 0) {\n      add_child(vd,new_node(NUM_NODE,var_size));\n    }\n    return vd;\n}\n</code></pre>\n\n<p>On my scanner (flex) I also have:</p>\n\n<pre><code>{number} { yylval = new_node(NUM_NODE, atoi(yytext)); return NUM; }\n{string} { int index = add_literal(lt, yytext); yylval = new_node(STR_NODE, index); return STRING; }\n</code></pre>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1560987078, "post_id": 56677154, "comment_id": 99921134, "body": "Is the growth factor always 2?"}, {"owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1560987361, "post_id": 56677154, "comment_id": 99921203, "body": "Yes the previous interval multiplied by 2"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1560987885, "post_id": 56677154, "comment_id": 99921315, "body": "Are you dealing with integers? Are there 10 or 11 elements in bin 0?"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 3, "creation_date": 1560987956, "post_id": 56677154, "comment_id": 99921326, "body": "Use base 2 logarithms and some math."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 6, "creation_date": 1560988425, "post_id": 56677154, "comment_id": 99921409, "body": "Apart from <code>0</code>, the <code>bin = floor(log2( 1 + ((x-1) &#47; 10) ));</code>"}, {"owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "edited": false, "score": 0, "creation_date": 1560988731, "post_id": 56677154, "comment_id": 99921467, "body": "The numbers are unsigned short"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1560988953, "post_id": 56677154, "comment_id": 99921505, "body": "You might get rounding errors using <code>log2()</code> and an integer computation is probably quicker. For example if the log is <code>1.999999999999</code> then you will get <code>1</code>."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1560989227, "post_id": 56677154, "comment_id": 99921553, "body": "Since the base is 2 and the input and output are integers, a function such as <code>__builtin_clz</code> could be used, unfortunately these are not portable."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1560991007, "post_id": 56677154, "comment_id": 99921874, "body": "Unless there are a large number of bins so that looping too many times is a performance problem, I&#39;d just stick with the loop."}], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 5141682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b29f5b1a276d5ed23eaace729b8be71?s=128&d=identicon&r=PG&f=1", "display_name": "Christina Jacob", "link": "https://stackoverflow.com/users/5141682/christina-jacob"}, "edited": false, "score": 0, "creation_date": 1561007475, "post_id": 56679126, "comment_id": 99924804, "body": "The intervals are in GP . So the nth bucket boundary would be sum of the intervals =start_interval * (2^n+1) -1. An element to be the upper boundary it should be the multiple of start_interval so do x = x+x%start_interval ; then x =x%start_interval. the resulting x should be a power of 2 to be the upper boundary of an interval so x &lt;= 2^n where n is the bucket no. ceil(logx) would give n.  Isn&#39;t the above solution a mathematical representation of similar logic?"}, {"owner": {"reputation": 17971, "user_id": 171006, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/unCkx.jpg?s=128&g=1", "display_name": "Lior Kogan", "link": "https://stackoverflow.com/users/171006/lior-kogan"}, "reply_to_user": {"reputation": 630, "user_id": 5141682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b29f5b1a276d5ed23eaace729b8be71?s=128&d=identicon&r=PG&f=1", "display_name": "Christina Jacob", "link": "https://stackoverflow.com/users/5141682/christina-jacob"}, "edited": false, "score": 0, "creation_date": 1561032645, "post_id": 56679126, "comment_id": 99936797, "body": "@ChristinaJacob: yes, it is"}], "tags": [], "owner": {"reputation": 17971, "user_id": 171006, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/unCkx.jpg?s=128&g=1", "display_name": "Lior Kogan", "link": "https://stackoverflow.com/users/171006/lior-kogan"}, "is_accepted": false, "score": 2, "last_activity_date": 1561060070, "last_edit_date": 1561060070, "creation_date": 1561005913, "answer_id": 56679126, "question_id": 56677154, "link": "https://stackoverflow.com/questions/56677154/c-finding-the-bin-index-which-a-value-belongs-to/56679126#56679126", "title": "C: Finding the bin index which a value belongs to", "body": "<p>As suggested by Weather Vane, </p>\n\n<pre><code>bin = floor( log2 (        (value + 9) / 10   ))\n</code></pre>\n\n<p>also:</p>\n\n<pre><code>bin = floor( log2 ( floor( (value + 9) / 10 ) ))\n</code></pre>\n\n<p>Integer division (i1/i2) in C is equal to trunc(i1/i2) (truncation toward zero), which is equivalent to floor(i1/i2) for non-negative integers, so there is no need to implement the inner floor.</p>\n\n<p>floor(log2(i)) can be implemented quite efficiently. See the <a href=\"https://stackoverflow.com/questions/11376288/fast-computing-of-log2-for-64-bit-integers\">accepted answer here</a> for a fast 32-bit and 64-bit integer implementations.</p>\n\n<p>Here is the code (valid when <em>int</em> is 32-bit). <a href=\"https://onlinegdb.com/SJWjz1Ykr\" rel=\"nofollow noreferrer\">OnlineGDB</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst unsigned int tab32[32] = {\n     0,  9,  1, 10, 13, 21,  2, 29,\n    11, 14, 16, 18, 22, 25,  3, 30,\n     8, 12, 20, 28, 15, 17, 24,  7,\n    19, 27, 23,  6, 26,  5,  4, 31};\n\nunsigned int log2_32(unsigned int value)\n{\n    value |= value &gt;&gt;  1;\n    value |= value &gt;&gt;  2;\n    value |= value &gt;&gt;  4;\n    value |= value &gt;&gt;  8;\n    value |= value &gt;&gt; 16;\n    return tab32[(value * 0x07C4ACDD) &gt;&gt; 27];\n}\n\nint main()\n{\n    unsigned int value = 151;\n\n    unsigned int bin = 0;\n    if (value &gt; 0)\n        bin = log2_32( (value + 9) / 10 );\n\n    printf(\"value: %u, bin: %u\", value, bin);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": true, "score": 1, "last_activity_date": 1561016307, "last_edit_date": 1561016307, "creation_date": 1561012847, "answer_id": 56680353, "question_id": 56677154, "link": "https://stackoverflow.com/questions/56677154/c-finding-the-bin-index-which-a-value-belongs-to/56680353#56680353", "title": "C: Finding the bin index which a value belongs to", "body": "<p>The log arithmetic is cool, but you could also just build a table and use binary search to find the bin.</p>\n\n<pre><code>int find_bin(unsigned x) {\n static unsigned bin_top[] = {\n    10u, // 0\n    30u, // 1\n    70u, // 2\n    150u, // 3\n    310u, // 4\n    630u, // 5\n    1270u, // 6\n    2550u, // 7\n    5110u, // 8\n    10230u, // 9\n    20470u, // 10\n    40950u, // 11\n    81910u, // 12\n    163830u, // 13\n    327670u, // 14\n    655350u, // 15\n    1310710u, // 16\n    2621430u, // 17\n    5242870u, // 18\n    10485750u, // 19\n    20971510u, // 20\n    41943030u, // 21\n    83886070u, // 22\n    167772150u, // 23\n    335544310u, // 24\n    671088630u, // 25\n    1342177270u, // 26\n    2684354550u, // 27\n    4294967295u, // 28\n  };\n  int lo = 0, hi = 28;\n  while (lo &lt; hi) {\n    int mid = (lo + hi) / 2;\n    if (mid &gt; 0 &amp;&amp; x &lt;= bin_top[mid - 1]) hi = mid - 1;\n    else if (x &gt; bin_top[mid]) lo = mid + 1;\n    else return mid;\n  }\n  return lo;\n}\n</code></pre>\n\n<p>The loop will never run more than five iterations, so it's pretty quick. Bin 28 is the biggest unsigned value, which isn't the calculated one.</p>\n"}], "owner": {"reputation": 555, "user_id": 3491653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4a181bf47a17fe43bf62ff3778525bfa?s=128&d=identicon&r=PG&f=1", "display_name": "i_use_the_internet", "link": "https://stackoverflow.com/users/3491653/i-use-the-internet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 56680353, "answer_count": 2, "score": 0, "last_activity_date": 1561060070, "creation_date": 1560986919, "question_id": 56677154, "link": "https://stackoverflow.com/questions/56677154/c-finding-the-bin-index-which-a-value-belongs-to", "title": "C: Finding the bin index which a value belongs to", "body": "<p>I have bins where the ranges grow exponentially.</p>\n\n<pre><code>Bin 0 -&gt; [0 &lt;= x &lt;= 10] (interval = 10)\nBin 1 -&gt; [11 &lt;= x &lt;= 30] (interval = 20)\nBin 2 -&gt; [31 &lt;= x &lt;= 70] (interval = 40)\nBin 3 -&gt; [71 &lt;= x &lt;= 150] (interval = 80)\nBin 4 -&gt; [151 &lt;= x &lt;= 310] (interval = 160)\n</code></pre>\n\n<p>... and so on.</p>\n\n<p>The number of bins and first interval are known prior (in this case it is 5, and 10 respectively). <code>x</code> lowest possible value is 0.</p>\n\n<p>What I am currently doing is a standard for-loop that multiplies by 2 each time, and then return the index of the bin if <code>value</code> is within the range. </p>\n\n<p>Is there a smarter way of doing this?</p>\n"}, {"tags": ["c", "arrays", "dynamic"], "comments": [{"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 0, "creation_date": 1560985779, "post_id": 56676975, "comment_id": 99920881, "body": "Are you sure that size&gt;0 when you do double max = numSet[size - 1]; ? Or more generally, is this all the code? How do you do qsort?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1560986116, "post_id": 56676975, "comment_id": 99920939, "body": "Note that if run on Unix, hitting <code>^Z</code> (control-Z) will put your program into suspended animation and let the shell take control again \u2014 without actually terminating the program.  On Windows, typing <code>^Z</code> indicates EOF."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1560986518, "post_id": 56676975, "comment_id": 99921013, "body": "You don&#39;t check that <code>size</code> is at least <code>1</code> before referencing the (possibly non-existent) data in the array. That&#39;s the warning from the compiler. \u2014\u2014 I see you&#39;ve removed a section of code <code>sort the array using qsort</code>.  Does the code you show crash, or only the code you don&#39;t show? (Sorting is not necessarily wrong, but isn&#39;t needed to get <code>min</code> and <code>max</code>.)"}, {"owner": {"reputation": 3266, "user_id": 6854407, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205840043960722/picture?type=large", "display_name": "Jim Rogers", "link": "https://stackoverflow.com/users/6854407/jim-rogers"}, "edited": false, "score": 2, "creation_date": 1560987074, "post_id": 56676975, "comment_id": 99921131, "body": "Are you required to use an array at all? If an array is not required your program is far more complicated than necessary. Your input loop can simply accumulate a total for all input values, count the number of input values, and identify the minimum and maximum values input."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1560987222, "post_id": 56676975, "comment_id": 99921166, "body": "The only errors I see are 1) a possibile buffer overrun (which you&#39;ve acknowledged in stating that you need a dynamic array) that could be &quot;fixed&quot; by changing your loop condition to: <code>while(size &lt; 1000 &amp;&amp; scanf_s(&quot;%lf&quot;, &amp;number) == 1)</code>, and 2) various bugs when <code>size</code> is 0 such as a) invalid array access at index -1, as the compiler is warning you, and b) division by 0."}, {"owner": {"reputation": 21, "user_id": 11673049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89f19fc7d9d8f0ea6bdb59957bde297?s=128&d=identicon&r=PG&f=1", "display_name": "lostwhispers", "link": "https://stackoverflow.com/users/11673049/lostwhispers"}, "edited": false, "score": 0, "creation_date": 1560989378, "post_id": 56676975, "comment_id": 99921581, "body": "The problem is that I don&#39;t need only the mean. I need to perform lots of statistics so I can not use a loop only to perform the sum..."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1561043108, "post_id": 56677434, "comment_id": 99943197, "body": "Looking at the MS manual page for <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l?view=vs-2019\" rel=\"nofollow noreferrer\"><code>scanf_s()</code></a> suggests that your &quot;extra argument&quot; idea is wrong for <code>double</code> (it shows an example of <code>float</code> being used without the extra argument, and the commentary says that the lengths are required for string-related conversion specifiers \u2014 not for numeric ones.  &#39;Tis funny, because we&#39;re linking to almost the same URL, but coming to opposite conclusions."}, {"owner": {"reputation": 530, "user_id": 8807809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6150c2b1e72864800de8df5a7afff2f3?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin W Matthews", "link": "https://stackoverflow.com/users/8807809/kevin-w-matthews"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1561053787, "post_id": 56677434, "comment_id": 99948561, "body": "@JonathanLeffler, you seem to have read the documentation more closely than I. It says &quot;Specify the sizes for all c, C, s, S, or string control set [] parameters&quot; with no mention of numeric types, as you suggest. Thanks!"}], "tags": [], "owner": {"reputation": 530, "user_id": 8807809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6150c2b1e72864800de8df5a7afff2f3?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin W Matthews", "link": "https://stackoverflow.com/users/8807809/kevin-w-matthews"}, "is_accepted": false, "score": 0, "last_activity_date": 1561136555, "last_edit_date": 1561136555, "creation_date": 1560989612, "answer_id": 56677434, "question_id": 56676975, "link": "https://stackoverflow.com/questions/56676975/store-doubles-in-an-array-in-c/56677434#56677434", "title": "Store doubles in an array in C", "body": "<p>As mentioned in the comments, it's possible for</p>\n\n<pre><code>double max = numSet[size - 1];\n</code></pre>\n\n<p>to evaluate as</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>double max = numSet[-1];\n</code></pre>\n\n<p>when <code>size = 0</code>. I'm guessing that a <code>double</code> is 8 bytes wide, so the compiler warns that it could try to read <code>-1 * 8 = -8</code> bytes from memory.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10788341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NRknc.jpg?s=128&g=1", "display_name": "3914", "link": "https://stackoverflow.com/users/10788341/3914"}, "is_accepted": false, "score": 0, "last_activity_date": 1560996936, "last_edit_date": 1560996936, "creation_date": 1560995758, "answer_id": 56678010, "question_id": 56676975, "link": "https://stackoverflow.com/questions/56676975/store-doubles-in-an-array-in-c/56678010#56678010", "title": "Store doubles in an array in C", "body": "<p>I think the problem is how you end the input loop, scanf_s isn't needed, please see the watch window. I simply change the end condition to some no digit char.</p>\n\n<p>Code::Blocks watch window</p>\n\n<p><a href=\"https://i.stack.imgur.com/0qDBv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0qDBv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 90, "user_id": 11617614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-msdRKrqQMI0/AAAAAAAAAAI/AAAAAAAAGTc/1OH467hIt3Q/photo.jpg?sz=128", "display_name": "Meet Maheshwari", "link": "https://stackoverflow.com/users/11617614/meet-maheshwari"}, "is_accepted": false, "score": 2, "last_activity_date": 1561227543, "last_edit_date": 1561227543, "creation_date": 1561031011, "answer_id": 56685236, "question_id": 56676975, "link": "https://stackoverflow.com/questions/56676975/store-doubles-in-an-array-in-c/56685236#56685236", "title": "Store doubles in an array in C", "body": "<pre><code>while (scanf_s(\"%lf\", &amp;number) == 1)\n    {\n        numSet[size] = number;\n        size++;\n    }\n</code></pre>\n\n<p>instead of this use</p>\n\n<pre><code>while (scanf_s(\"%lf\", &amp;number) == 1 &amp;&amp; size &lt;= 1000)\n    {\n        numSet[size] = number;\n        size++;\n    }\n</code></pre>\n\n<p>Your loop goes infinitely because it has no termination character.\n<code>scanf_s</code> only reads value from keyboard and has another parameter to set its maximum input buffer value which is useful to limit your input.</p>\n\n<p>What you can do is either read size from the user before letting him enter values or you can ask every time if the user wants to add more values to the array or not.</p>\n\n<p>for example: </p>\n\n<pre><code>char option = 'Y';\nwhile ( (scanf_s(\"%lf\", &amp;number) == 1 &amp;&amp; option == 'Y'){\n   // code to enter a new number\n   printf(\"Do you want to add more numbers? (Y/N) \");\n   scanf(\"%c\", &amp;option);\n}\n</code></pre>\n\n<p>Also, the <code>scanf_s</code> function returns the number of values scanned and every time is 1 as you are always taking one double value.</p>\n\n<p>So even if you remove it, it wont be of much trouble.</p>\n"}], "owner": {"reputation": 21, "user_id": 11673049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89f19fc7d9d8f0ea6bdb59957bde297?s=128&d=identicon&r=PG&f=1", "display_name": "lostwhispers", "link": "https://stackoverflow.com/users/11673049/lostwhispers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2770, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1561227543, "creation_date": 1560985460, "last_edit_date": 1560986232, "question_id": 56676975, "link": "https://stackoverflow.com/questions/56676975/store-doubles-in-an-array-in-c", "title": "Store doubles in an array in C", "body": "<p>I really need help to store double values in a double array. I am trying using scanf_s and it works. But if I try to input more than 4 values, my program crashes and returns me the error code 3</p>\n\n<p>I actually need a dynamic array, but as I was getting too many errors with that, I changed and I'm trying to use a common array, just so I can get at least some marks for this project.</p>\n\n<p>This is the code I am using now... </p>\n\n<pre><code>int main()\n{\n    printf(\"Enter white-space separated real numbers. Terminate input with ^Z\\n\");\n    //get the dynamic array\n\n    double numSet[1000] = { 0 };\n    int size = 0;\n    double number;\n    while (scanf_s(\"%lf\", &amp;number) == 1)\n    {\n        numSet[size] = number;\n        size++;\n    }\n\n\n    //sort the array using qsort \n\n\n    //range of the array \n\n    double min = numSet[0];\n    double max = numSet[size - 1];\n\n\n    //get the mean \n    double sum = 0.0;\n    for (size_t i = 0; i &lt; size; i++)\n    {\n        sum += numSet[i];\n    }\n\n    double mean = sum / size;\n\n\n\n    printf(\"Range: [%.2f ... %.2f]\\n\", min, max);\n    printf(\"Arithmetic mean is: %f\", mean);\n\n\n\n}\n</code></pre>\n\n<p>I have two problems: </p>\n\n<ol>\n<li><p>Is a warning about buffer overrun: </p>\n\n<pre><code>Warning C6385   Reading invalid data from 'numSet':\nthe readable size is '8000' bytes, but '-8' bytes may be read.  \n</code></pre></li>\n<li><p>When I try to input more than 4 numbers, my program crashes and returns the code 3</p></li>\n</ol>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 335, "user_id": 11639518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHyIi.jpg?s=128&g=1", "display_name": "jhelphenstine", "link": "https://stackoverflow.com/users/11639518/jhelphenstine"}, "edited": false, "score": 2, "creation_date": 1560984839, "post_id": 56676838, "comment_id": 99920671, "body": "I&#39;ve run this on both *nix &amp; Windows; each time it prompted me for 3 inputs and printed 2 outputs. It did hang if I hit &#39;enter&#39; without providing a number, but after I provided a number and hit enter, it continued. Does it prompt you for information in your console?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1560985272, "post_id": 56676838, "comment_id": 99920773, "body": "If it does not prompt for information you can add <code>fflush(stdout);</code> after each prompt. Note it does not hang if you hit &#39;enter&#39; without providing a number. It is ignoring whitespace until you enter a number."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1560985482, "post_id": 56676838, "comment_id": 99920809, "body": "If you can&#39;t be bothered to check the return value or results of your <code>scanf</code>, why should we bother to help you?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1560985763, "post_id": 56676838, "comment_id": 99920873, "body": "Please do some research on the behaviour of <code>scanf</code> and what happens if you provide alphabetic input when an integer is expected."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1560988271, "post_id": 56676838, "comment_id": 99921378, "body": "Have you tried entering 3 numbers?"}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1560989607, "post_id": 56676838, "comment_id": 99921616, "body": "You&#39;re not validating your input. Also clean your input stream if an invalid type is entered in the stream. What I suggest is taking data as a string with fgets and performing the conversion."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "is_accepted": false, "score": 0, "last_activity_date": 1560991602, "creation_date": 1560991602, "answer_id": 56677607, "question_id": 56676838, "link": "https://stackoverflow.com/questions/56676838/why-does-the-scanf-cause-my-code-to-be-running-indefinitely/56677607#56677607", "title": "Why does the scanf cause my code to be running indefinitely?", "body": "<p>there doesn't seem to be any mistakes in the code. i tried running it on Ubuntu And OnlineGDB. The Code is working just fine. It Can be your compiler's fault.</p>\n\n<p>You should check what \"scanf\" is returning.\nyou can check it using this:- (here d is your integer)</p>\n\n<pre><code>if (scanf(\"%d\", &amp;d) == 1)\n    ...all OK...\nelse\n    ...EOF or conversion failure...\n</code></pre>\n\n<p>If you have several conversions, check that they all completed.</p>\n"}, {"comments": [{"owner": {"reputation": 463, "user_id": 6337519, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1CiVF.jpg?s=128&g=1", "display_name": "joH1", "link": "https://stackoverflow.com/users/6337519/joh1"}, "edited": false, "score": 0, "creation_date": 1561032411, "post_id": 56685100, "comment_id": 99936666, "body": "There is no namespace in C, the argument <code>stream</code> to  <code>setbuf</code>is a <code>FILE</code>pointer, not an <code>std::FILE</code> one"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 463, "user_id": 6337519, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1CiVF.jpg?s=128&g=1", "display_name": "joH1", "link": "https://stackoverflow.com/users/6337519/joh1"}, "edited": false, "score": 0, "creation_date": 1561033365, "post_id": 56685100, "comment_id": 99937245, "body": "@joH1 fixed. The c++ and the C libraries are equivalent for these functions, other than the namespace."}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": false, "score": 1, "last_activity_date": 1561033253, "last_edit_date": 1561033253, "creation_date": 1561030470, "answer_id": 56685100, "question_id": 56676838, "link": "https://stackoverflow.com/questions/56676838/why-does-the-scanf-cause-my-code-to-be-running-indefinitely/56685100#56685100", "title": "Why does the scanf cause my code to be running indefinitely?", "body": "<p>The first print in your code (and similarly the others):</p>\n\n<blockquote>\n<pre><code>printf(\"enter height of box: \")\n</code></pre>\n</blockquote>\n\n<p>By default, this line will put the text into a buffer. The buffer is written to terminal (\"flushed\") only if either one of the following happens:</p>\n\n<ol>\n<li>The buffer gets full (can be 1024 bytes, 16384, or any other number).</li>\n<li><p>There is a newline at the end of the text (assuming the output is to the terminal). </p>\n\n<p>Note that this is a common behavior, but not guaranteed by the standard. Read <a href=\"https://stackoverflow.com/questions/3723795/is-stdout-line-buffered-unbuffered-or-indeterminate-by-default\">Is stdout line buffered, unbuffered or indeterminate by default?</a> to cover this subject.</p></li>\n<li><p>Some C implementations will automatically flush stdout when you read from stdin, but many implementations don't.</p>\n\n<p>Read <a href=\"https://stackoverflow.com/questions/2123528/does-reading-from-stdin-flush-stdout\">Does reading from stdin flush stdout?</a> to cover this subject.</p></li>\n</ol>\n\n<p>So you can see your prompt if you change the line to:</p>\n\n<pre><code> printf(\"enter height of box: \\n\");\n</code></pre>\n\n<p>A second option, is to force a flush, so that the buffer is written to the output:</p>\n\n<pre><code> printf(\"enter height of box: \");\n fflush(stdout);\n</code></pre>\n\n<p>A third option is to disable buffering completely. For that, you can use <a href=\"https://en.cppreference.com/w/cpp/io/c/setbuf\" rel=\"nofollow noreferrer\">setbuf</a>:</p>\n\n<blockquote>\n<pre><code>void setbuf( FILE* stream, char* buffer );\n</code></pre>\n  \n  <ul>\n  <li><strong>buffer</strong>  -<br>\n  pointer to a buffer for the stream to use. <strong>If NULL is supplied, the buffering is turned off</strong>. If not null, must be able to hold at least BUFSIZ characters</li>\n  </ul>\n</blockquote>\n\n<p>So, simply add the following at the beginning of the program, and all stdout buffering will be turned off:</p>\n\n<pre><code>setbuf(stdout, NULL);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 90, "user_id": 11617614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-msdRKrqQMI0/AAAAAAAAAAI/AAAAAAAAGTc/1OH467hIt3Q/photo.jpg?sz=128", "display_name": "Meet Maheshwari", "link": "https://stackoverflow.com/users/11617614/meet-maheshwari"}, "is_accepted": false, "score": 0, "last_activity_date": 1561031212, "creation_date": 1561031212, "answer_id": 56685304, "question_id": 56676838, "link": "https://stackoverflow.com/questions/56676838/why-does-the-scanf-cause-my-code-to-be-running-indefinitely/56685304#56685304", "title": "Why does the scanf cause my code to be running indefinitely?", "body": "<p>There may be a problem cause you might not be entering any value as input.</p>\n\n<p>In all other cases, the code seems to work fine.</p>\n"}], "owner": {"reputation": 1, "user_id": 11672974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6xLx7MePHtk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd0zpCltfCUQMdjWk-Yle-xpAF7AA/mo/photo.jpg?sz=128", "display_name": "user11672974", "link": "https://stackoverflow.com/users/11672974/user11672974"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1561033253, "creation_date": 1560984371, "last_edit_date": 1560985918, "question_id": 56676838, "link": "https://stackoverflow.com/questions/56676838/why-does-the-scanf-cause-my-code-to-be-running-indefinitely", "title": "Why does the scanf cause my code to be running indefinitely?", "body": "<p>When I try to run this code it just runs indefinitely. I have tried to use <code>scanf_s</code> but that did not change anything. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    int height, length, width, volume, weight;\n    printf(\"enter height of box: \");\n        scanf(\" %d\", &amp;height);\n    printf(\"enter length of box: \");\n        scanf(\" %d\", &amp;length);\n    printf(\"enter width of box: \");\n        scanf(\" %d\", &amp;width);\n\n    volume=height*width*length;\n    weight=(volume+165)/166;\n\n    printf(\"volume (cubic inches): %d\\n\", volume);\n    printf(\"dimensional weight (pounds): %d\\n\", weight);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "dynamic-programming"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1560991564, "post_id": 56676795, "comment_id": 99921945, "body": "What is your input? You need to find a case where your algorithm doesn&#39;t work and debug it. Test limits as given by the exercise."}], "answers": [{"tags": [], "owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "is_accepted": true, "score": 2, "last_activity_date": 1561025790, "last_edit_date": 1561025790, "creation_date": 1561025400, "answer_id": 56683709, "question_id": 56676795, "link": "https://stackoverflow.com/questions/56676795/determine-if-we-can-put-and-between-numbers-so-that-the-result-is-divisi/56683709#56683709", "title": "Determine if we can put &#39;+&#39; and &#39;-&#39; between numbers so that the result is divisible by a number: where&#39;s my mistake?", "body": "<p>I simplified your code and it looks OK to me. It should do the job. My only concern is efficiency. It takes about 20 seconds to find the answer \"Not divisible\" for the next sequence of 30 numbers: 30 2 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0. Every additional number will double the previous time. So, the tests that your code didn't pass could be because of the allowed test time. </p>\n\n<p>Dynamic programming is a must to pass the tests. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#pragma warning(disable : 4996)\n\nint howmanynums, mod, sequence[64];\n\nint main() {\n    freopen(\"input.txt\", \"r\", stdin);\n    // freopen(\"output.txt\", \"w\", stdout);\n    scanf(\"%d%d\", &amp;howmanynums, &amp;mod);\n    if (howmanynums &gt; 64)\n    {\n        printf(\"Too many %d\", howmanynums);\n    }\n    int k = 0;\n    while (k &lt; howmanynums)\n        scanf(\"%d\", &amp;sequence[k++]);\n    int x = (2 &lt;&lt; (howmanynums - 2)) - 1;\n    bool divisible = false;\n    while (!divisible &amp;&amp; x &gt;= 0)\n    {\n        int a = sequence[0], bit = 1;  k = 1;\n        while (k &lt; howmanynums)\n        {\n            a += x &amp; bit ? sequence[k] : -sequence[k];\n            k++;\n            bit *= 2;\n        }\n        divisible = a % mod == 0;\n        x--;\n    }\n    printf(\"%s\", divisible ? \"Divisible\": \"Not divisible\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 11358104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b60bb9f2b0e414b16b60e5be9c07598?s=128&d=identicon&r=PG&f=1", "display_name": "fragileradius", "link": "https://stackoverflow.com/users/11358104/fragileradius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 56683709, "answer_count": 1, "score": 0, "last_activity_date": 1561026029, "creation_date": 1560984068, "last_edit_date": 1561026029, "question_id": 56676795, "link": "https://stackoverflow.com/questions/56676795/determine-if-we-can-put-and-between-numbers-so-that-the-result-is-divisi", "title": "Determine if we can put &#39;+&#39; and &#39;-&#39; between numbers so that the result is divisible by a number: where&#39;s my mistake?", "body": "<p>We have <code>howmanynums</code> numbers. We must determine if there's a way to put <code>'+'</code> and <code>'-'</code> between them in a way that makes the result divisible by given number <code>mod</code>.</p>\n\n<p>(It is preferred to do it by means of dynamic programming, but I am just counting every sequence from the scratch because very short on time and just need it to work).</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\nint howmanynums, mod;\n\nint ring(int num) {\n    if ((num &gt;= 0) &amp;&amp; (num &lt;= mod - 1))\n        return num;\n    if (num &gt;= mod) {\n        while (num &gt;= mod)\n            num -= mod;\n        return num;\n    }\n    if (num &lt; 0) {\n        while (num &lt; 0)\n            num += mod;\n        return num;\n    }\n}\n\nlong int p(int n) {\n    long int t = 1;\n\n    while (n &gt; 0) {\n        t *= 2; \n        n--;\n    }\n    return t;\n}\n\nint sequence[10000][2];\n\nint main() {\n    freopen(\"input.txt\", \"r\", stdin);\n    freopen(\"output.txt\", \"w\", stdout);\n    scanf(\"%d%d%d\", &amp;howmanynums, &amp;mod, &amp;sequence[0][0]);\n    sequence[0][0] = ring(sequence[0][0]);\n    int temp;\n    int k = 1;\n    while (k &lt; howmanynums) {\n        scanf(\"%d\", &amp;temp);\n        sequence[k][0] = ring(temp);\n        sequence[k][1] = ring(-temp);\n        k++;\n    }\n\n    long int x = (p(howmanynums - 1)); \n    while (x &gt; 0) {\n        long int a = sequence[0][0];\n        long int permutation = x;\n        long int insidePermutation = x % 2;\n        int l = 1;\n        while (l &lt; howmanynums) { \n            a += sequence[l][insidePermutation]; \n            l++; \n            permutation = permutation / 2; \n            insidePermutation = permutation % 2; \n        }\n        if (a % mod == 0) {\n            printf(\"%s\", \"Divisible\");\n            goto e;\n        }\n        x--;\n    }\n     printf(\"%s\", \"Not divisible\");\n\n e:\n    return 0;\n}\n</code></pre>\n\n<p>It passes 10 tests out of 20. I don't know the tests.</p>\n\n<p>I also tried substituting all ints for long ints, but same result.</p>\n\n<p>Where's my mistake?</p>\n"}, {"tags": ["c", "linux", "bash", "x11", "gnome"], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 8683823, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OgmT1o-2AY0/AAAAAAAAAAI/AAAAAAAAAKU/aKamMOjUeB4/photo.jpg?sz=128", "display_name": "Luiz de Lima Souza", "link": "https://stackoverflow.com/users/8683823/luiz-de-lima-souza"}, "edited": false, "score": 0, "creation_date": 1560997994, "post_id": 56676251, "comment_id": 99922982, "body": "Thanks duskwuff. You&#39;re right, it&#39;s similar to screensavers behaviour. Your solution was even better than what I was trying to do before. This way, if I move the mouse the counter will be reset too."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 2, "last_activity_date": 1560980424, "creation_date": 1560980424, "answer_id": 56676251, "question_id": 56675916, "link": "https://stackoverflow.com/questions/56675916/is-there-an-way-to-get-any-button-pressed-in-ubuntu-even-those-not-pressed-insi/56676251#56676251", "title": "Is there an way to get any button pressed in ubuntu, even those not pressed inside my C/C++ application window?", "body": "<blockquote>\n  <p>show an alert whenever I haven't pressed any key or clicked any mouse button for a while</p>\n</blockquote>\n\n<p>This is very similar to what a screensaver would do, and most efficient way of implementing it will be to use the X11 <a href=\"https://www.x.org/releases/X11R7.7/doc/scrnsaverproto/saver.html\" rel=\"nofollow noreferrer\">Screen Saver Extension</a>. The <a href=\"https://linux.die.net/man/3/xscreensaverqueryinfo\" rel=\"nofollow noreferrer\"><code>XScreenSaverQueryInfo</code></a> function will populate a structure which includes the number of milliseconds since the last user input (<code>saver_info.idle</code>).</p>\n"}], "owner": {"reputation": 36, "user_id": 8683823, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OgmT1o-2AY0/AAAAAAAAAAI/AAAAAAAAAKU/aKamMOjUeB4/photo.jpg?sz=128", "display_name": "Luiz de Lima Souza", "link": "https://stackoverflow.com/users/8683823/luiz-de-lima-souza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 56676251, "answer_count": 1, "score": 0, "last_activity_date": 1560980424, "creation_date": 1560978809, "question_id": 56675916, "link": "https://stackoverflow.com/questions/56675916/is-there-an-way-to-get-any-button-pressed-in-ubuntu-even-those-not-pressed-insi", "title": "Is there an way to get any button pressed in ubuntu, even those not pressed inside my C/C++ application window?", "body": "<p>I'm developing a small app that will show an alert whenever I haven't pressed any key or clicked any mouse button for a while, just for helping me focus. But, I can't find a way to get buttons pressed  outside my application frame.</p>\n\n<p>My app is been developed in C for ubuntu 18.04 using gnome as desktop environment. I've thought if there was any way it would work, it would be by using X11 library methods, so I've tried using them but had no success. The method XNextEvent only captures events when my application is focused.</p>\n\n<p>I don't really need to know what was the key or mouse button pressed, <strong>it isn't a keylogger</strong>. All I'm interested is if there was an event from mouse or keyboard.</p>\n"}, {"tags": ["c", "struct", "initialization"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1560981477, "post_id": 56675755, "comment_id": 99919895, "body": "You can&#39;t mix a <code>typedef</code> with initializers \u2014 not in C, at any rate."}], "answers": [{"comments": [{"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1560982007, "post_id": 56676475, "comment_id": 99920049, "body": "I suggest using a <code>#define</code> to change the shape of <code>encPins</code> and <code>encSwitchPins</code> accordingly at compile time"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1560983158, "post_id": 56676475, "comment_id": 99920320, "body": "@bigwillydos \u2014 I&#39;ve added notes mentioning that possibility, but note that the array initializers would need to expand or contract too, which makes it less than easy to keep the code adaptable.  There&#39;s no indication of how those initialization values are determined \u2014 or how they&#39;d need to change if the number of pins went from 4 to 3 or 5 instead."}, {"owner": {"reputation": 13, "user_id": 2991509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c89ebaa77a6d7db26d5cc2138ab2e7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2991509", "link": "https://stackoverflow.com/users/2991509/user2991509"}, "edited": false, "score": 0, "creation_date": 1560983523, "post_id": 56676475, "comment_id": 99920406, "body": "Hello! Thanks for the detailed answer. Data for initializers comes from hardware designs. Different hardware modules have different initializer values.  I guess it will be better to hard-code each module, but I wanted to keep the hardcoding at minimum.  Amount of pins don&#39;t change, but the number of encoders in the module may. E41 has 4 encoders, but there will be other modules with different amounts in the future  Awesome answer though, thank you"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1560985709, "last_edit_date": 1560985709, "creation_date": 1560981829, "answer_id": 56676475, "question_id": 56675755, "link": "https://stackoverflow.com/questions/56675755/initializing-and-using-struct-members-inside-another-struct/56676475#56676475", "title": "Initializing and using struct members inside another struct", "body": "<h3>Minimum necessary changes</h3>\n\n<p>You can't mix a <code>typedef</code> with initializers \u2014 at least, not in C.  You also can't have structure types where the size varies depending on the data in the structure \u2014 at least, not without using one (and only one) flexible array member (FAM), but your code attempts to use two variable arrays (so they can't be FAMs).</p>\n\n<p>You need something more like:</p>\n\n<pre><code>typedef struct ytxModule{\n    uint8_t nEncoders;\n    uint8_t nDigital;\n    uint8_t nAnalog;\n    uint8_t nLedsPerControl;\n} ytxModule;  // Add name for typedef\n\ntypedef struct{\n    ytxModule components;\n    uint8_t encPins[4][2];\n    uint8_t encSwitchPins[4]; \n} ytxE41Module;\n\nytxE41Module module = {\n    .components = {4, 0, 0, 16},\n    .encPins = {\n      {1, 0},  \n      {4, 3},   \n      {14, 15},  \n      {11, 12}   \n    },\n    .encSwitchPins = { 2, 5, 13, 10 },\n}; \n</code></pre>\n\n<p>This won't change shape if you initialize <code>.components.nEncoders</code> to a value other than <code>4</code>.  Depending on your needs, you could consider replacing the hard-coded <code>4</code> with a compile-time changeable value, but you'd also need a way to resize the initializer arrays to match, which is likely to be fiddly at best, inscrutable at worst.  It isn't clear how the initializer values are established.</p>\n\n<h3>Using a flexible array member</h3>\n\n<p>If you want to use a flexible array member, you'll have to organize a type to hold an array for the <code>encSwitchPins</code> and <code>encPins</code> data, and use different notation to access the elements of the FAM.</p>\n\n<pre><code>typedef struct ytxModule{\n    uint8_t nEncoders;\n    uint8_t nDigital;\n    uint8_t nAnalog;\n    uint8_t nLedsPerControl;\n} ytxModule;\n\ntypedef struct\n{\n    ytxModule components;\n    struct\n    {\n        uint8_t encPins[2];\n        uint8_t encSwitchPins;\n    } pins[]; \n} ytxE41Module;\n</code></pre>\n\n<p>You can no longer use an initializer for this data type; you will dynamically allocate the memory and then assign values to the allocated data:</p>\n\n<pre><code>// Data used for initializing structure\nint n_pins = 4;\nuint8_t encPins[][2] = {\n    {  1,  0 },  \n    {  4,  3 },   \n    { 14, 15 },  \n    { 11, 12 },   \n};\nuint8_t switchPins[] = { 2, 5, 13, 10 };\n\n// Allocate and check allocation\nytxE41Module *mp = malloc(sizeof(*mp) + n_pins * sizeof(mp-&gt;pins[0]));\nif (mp == NULL)\n    return NULL;\n\n// Assign values to allocated structure\nmp-&gt;components = (ytxModule){ n_pins, 0, 0, 16};\nfor (int i = 0; i &lt; n_pins; i++)\n{\n    for (int j = 0; j &lt; 2; j++)\n        mp-&gt;pins[i].encPins[j] = encPins[i][j];\n    mp-&gt;pins[i].encSwitchPins = switchPins[i];\n}\n</code></pre>\n\n<p>If you tag the embedded structure type, you could initialize an array of that type and use <code>memmove()</code> (or <code>memcpy()</code>) to move copy a separate array into your FAM structure.  Etc.  It is much simpler if the amount of data in the structure is fixed (e.g. at 4 elements in the array), as shown in the first part of the answer.</p>\n"}], "owner": {"reputation": 13, "user_id": 2991509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c89ebaa77a6d7db26d5cc2138ab2e7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2991509", "link": "https://stackoverflow.com/users/2991509/user2991509"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 56676475, "answer_count": 1, "score": 0, "last_activity_date": 1561757869, "creation_date": 1560977966, "question_id": 56675755, "link": "https://stackoverflow.com/questions/56675755/initializing-and-using-struct-members-inside-another-struct", "title": "Initializing and using struct members inside another struct", "body": "<p>I need to use a struct (struct1), that was previously declared, inside a new struct (struct2).\nAlso I want to initialize it, and use some of the members of struct1 to initialize other members of struct2.</p>\n\n<p>Specifically, I want to set values for struct1 and use some of those values to define the sizes of other members of struct2</p>\n\n<p>I tried what is shown in the code, but I don't get why it isn't working.</p>\n\n<pre><code>typedef struct ytxModule{\n    uint8_t nEncoders;\n    uint8_t nDigital;\n    uint8_t nAnalog;\n    uint8_t nLedsPerControl;\n};\n\ntypedef struct{\n    ytxModule components = {4, 0, 0, 16};\n\n    // encoder pin connections to MCP23S17\n    uint8_t encPins[components.nEncoders][2] = {\n      {1, 0},  \n      {4, 3},   \n      {14, 15},  \n      {11, 12}   \n    };\n    // buttons on each encoder\n    uint8_t encSwitchPins[components.nEncoders] = { 2, 5, 13, 10 }; \n\n}ytxE41Module;\n</code></pre>\n\n<p>The error message I get is:</p>\n\n<pre><code>sketch\\headers/modules.h:52:37: error: invalid use of non-static data member '&lt;anonymous struct&gt;::components'\n\n  ytxModule components = {4, 0, 0, 16};\n\n                                     ^\n\nsketch\\headers/modules.h:55:18: error: from this location\n\n  uint8_t encPins[components.nEncoders][2] = {\n</code></pre>\n\n<p>Any help will be appreciated :)</p>\n"}, {"tags": ["c", "concurrency", "parallel-processing", "pthreads", "posix"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11672569, "user_type": "registered", "profile_image": "https://graph.facebook.com/825290147852772/picture?type=large", "display_name": "Shakil Azizul Hakim", "link": "https://stackoverflow.com/users/11672569/shakil-azizul-hakim"}, "edited": false, "score": 0, "creation_date": 1560978091, "post_id": 56675687, "comment_id": 99918795, "body": "Thanks a lot @Keine_Lust! Now the value  is static. but my expected result doesn&#39;t match. I need concurrency, working on same value not cloning by number of threads."}, {"owner": {"reputation": 13, "user_id": 11672569, "user_type": "registered", "profile_image": "https://graph.facebook.com/825290147852772/picture?type=large", "display_name": "Shakil Azizul Hakim", "link": "https://stackoverflow.com/users/11672569/shakil-azizul-hakim"}, "edited": false, "score": 1, "creation_date": 1560981369, "post_id": 56675687, "comment_id": 99919872, "body": "I see i should divide the task also! Thanks a lot @Keine_Lust!  Like a Boss! :D"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 0, "last_activity_date": 1561047127, "last_edit_date": 1561047127, "creation_date": 1560977600, "answer_id": 56675687, "question_id": 56675639, "link": "https://stackoverflow.com/questions/56675639/how-to-get-one-correct-value-from-a-function-which-is-parallelized-by-multi-thre/56675687#56675687", "title": "How to get one correct value from a function which is parallelized by multi-threads", "body": "<p>If you are under C11 you can use <code>_Atomic</code></p>\n\n<p>Of course each thread needs to work over a range of values (not with the complete set), pass a <code>struct</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdatomic.h&gt;\n#include &lt;pthread.h&gt;\n\n_Atomic int x;\nstatic int j = 5;\n\nstruct range {\n    int from, to;\n};\n\nvoid *print_count(void *data)\n{\n    struct range *range = data;\n\n    for (int i = range-&gt;from; i &lt; range-&gt;to; i++) {\n        x += j;\n    }\n    return NULL;\n}\n\nint main(void)\n{\n    pthread_t p1, p2, p3, p4;\n    struct range ranges[] = {\n        {0, 250},\n        {250, 500},\n        {500, 750},\n        {750, 1000}\n    };\n\n    pthread_create(&amp;p1, NULL, print_count, &amp;ranges[0]);\n    pthread_create(&amp;p2, NULL, print_count, &amp;ranges[1]);\n    pthread_create(&amp;p3, NULL, print_count, &amp;ranges[2]);\n    pthread_create(&amp;p4, NULL, print_count, &amp;ranges[3]);\n\n    pthread_join(p1, NULL);\n    pthread_join(p2, NULL);\n    pthread_join(p3, NULL);\n    pthread_join(p4, NULL);\n\n    printf(\"Actual output: %d \\nExpected output: 5000\\n\", x);\n    return 0;\n}\n</code></pre>\n\n<p>Or a compound literal:</p>\n\n<pre><code>pthread_create(&amp;p1, NULL, print_count, (int []){  0,  250});\npthread_create(&amp;p2, NULL, print_count, (int []){250,  500});\npthread_create(&amp;p3, NULL, print_count, (int []){500,  750});\npthread_create(&amp;p4, NULL, print_count, (int []){750, 1000});\n\n...\n\nvoid *print_count(void *data)\n{\n    int *range = data;\n\n    for (int i = range[0]; i &lt; range[1]; i++) {\n        x += j;\n    }\n    return NULL;\n}\n</code></pre>\n\n<p>in order to divide the task.</p>\n\n<p>Output:</p>\n\n<pre><code>Actual output: 5000 \nExpected output: 5000\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11672569, "user_type": "registered", "profile_image": "https://graph.facebook.com/825290147852772/picture?type=large", "display_name": "Shakil Azizul Hakim", "link": "https://stackoverflow.com/users/11672569/shakil-azizul-hakim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56675687, "answer_count": 1, "score": 0, "last_activity_date": 1561047127, "creation_date": 1560977386, "question_id": 56675639, "link": "https://stackoverflow.com/questions/56675639/how-to-get-one-correct-value-from-a-function-which-is-parallelized-by-multi-thre", "title": "How to get one correct value from a function which is parallelized by multi-threads", "body": "<p>For faster calculation, trying to make my method parallelized by 4 threads. Where threads are making 4 separate calculation whether I was expecting concurrent operation and on single variable. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;pthread.h&gt;\n\nstatic int x, j=5;\n\nvoid *print_count (void *dummy)\n{\n  for(int i=0;i&lt;1000;i++){\n  x+=j;\n  }\n}\n\nint main ()\n{\npthread_t p1, p2, p3, p4;\n\npthread_create (&amp;p1, NULL, print_count, NULL);\npthread_create (&amp;p2, NULL, print_count, NULL);\npthread_create (&amp;p3, NULL, print_count, NULL);\npthread_create (&amp;p4, NULL, print_count, NULL);\n\npthread_join (p1, NULL);\npthread_join (p2, NULL);\npthread_join (p3, NULL);\npthread_join (p4, NULL);\n\nprintf(\"Actual output: %d \\nExpected output: 5000\\n\", x);\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>I expect the output 5000 as the increment is 5 and loop for 1000 times.\nBut the actual output first of all not static, it always change and it is near 4 times of 5000 because threads are calculating the print_count separately.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1560977357, "post_id": 56675607, "comment_id": 99918512, "body": "You should have searched before posting."}, {"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1560977503, "post_id": 56675607, "comment_id": 99918566, "body": "<a href=\"https://stackoverflow.com/questions/21493174/c-func-signature-inside-linux-kernel-include-linux-sched-h\" title=\"c func signature inside linux kernel include linux sched h\">stackoverflow.com/questions/21493174/&hellip;</a> also explains what the macro expansion actually does."}, {"owner": {"reputation": 3, "user_id": 7477117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a13aa16ec2630eb76b8abf91a8c944?s=128&d=identicon&r=PG&f=1", "display_name": "Krishna Dogney", "link": "https://stackoverflow.com/users/7477117/krishna-dogney"}, "edited": false, "score": 0, "creation_date": 1560982261, "post_id": 56675607, "comment_id": 99920108, "body": "Thank you for pointing out to the answer. I understood the it now."}], "owner": {"reputation": 3, "user_id": 7477117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a13aa16ec2630eb76b8abf91a8c944?s=128&d=identicon&r=PG&f=1", "display_name": "Krishna Dogney", "link": "https://stackoverflow.com/users/7477117/krishna-dogney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1560979590, "answer_count": 0, "score": 0, "last_activity_date": 1560977325, "creation_date": 1560977234, "last_edit_date": 1560977325, "question_id": 56675607, "link": "https://stackoverflow.com/questions/56675607/how-to-interpret-the-following-line-in-the-c-language", "closed_reason": "Duplicate", "title": "How to interpret the following line in the c language?", "body": "<p>I am working on linux and came across the following declaration:-</p>\n\n<pre><code>static noinline void __sched __mutex_unlock_slowpath(atomic_t *lock_count);\n</code></pre>\n\n<p>Since I am new to this I am not sure how to read and interpret it. Please help me in understanding.</p>\n\n<p>My understanding is that it is a function declaration which is <code>static</code> and <code>noinline</code>. But what I don't understand is the use of <code>__sched</code>.</p>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1560976312, "post_id": 56675397, "comment_id": 99918140, "body": "Question; why are you using statics? (ni, ni1 etc.) I would guess that if you use non statics it works as expected."}, {"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 0, "creation_date": 1560976371, "post_id": 56675397, "comment_id": 99918164, "body": "Could it be related to the static variables in the loop? Can it be the fact that the index is static?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1560976377, "post_id": 56675397, "comment_id": 99918167, "body": "Show <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, your expected behavior and the actual one."}, {"owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1560976638, "post_id": 56675397, "comment_id": 99918257, "body": "@Stefan, each run of this code takes several days and this snippet is from a function which is a bottleneck. So I thought maybe static variables would be faster. Recently I moved those static variables from outside of the loop to inside, and then this situation occurred."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 1, "creation_date": 1560976905, "post_id": 56675397, "comment_id": 99918357, "body": "The thing is; with statics, they have a shared memory space. So they will likely to interfere with each other across the threads. Your parallel loops are all looking inside the same box."}, {"owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 1, "creation_date": 1560978044, "post_id": 56675397, "comment_id": 99918780, "body": "@Stefan, Yes. Now I understand. Previously, they were declared outside the loop and were listed in the <code>private</code> clause. I guess OpenMP treated them as auto variables. But when I brought them inside the loop things changed. Thanks a lot."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1560984931, "post_id": 56675397, "comment_id": 99920697, "body": "If you have an answer, add an answer below. Don&#39;t edit the title and put &quot;Solved&quot; in it. Accepted answers perform that function."}, {"owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1560985390, "post_id": 56675397, "comment_id": 99920787, "body": "@tadman, I know. But Stefan&#39;s comment solved the problem."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1561032219, "post_id": 56675397, "comment_id": 99936551, "body": "With static definition outside the loop, the private clause asks for each thread to have its own variable with scope inside the parallel region.  Nothing is copied between the one in the outer scope and the inner ones unless you set a firstprivate or lastprivate."}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 1, "last_activity_date": 1560985639, "creation_date": 1560985639, "answer_id": 56676993, "question_id": 56675397, "link": "https://stackoverflow.com/questions/56675397/openmp-parallel-for-doesnt-work-properly/56676993#56676993", "title": "OpenMP parallel &#39;for&#39; doesn&#39;t work properly", "body": "<p>(Answer by Stefan)</p>\n\n<p>Don't use <code>static</code> variables when OpenMP threads are involved.</p>\n\n<p>The thing is; with statics, they have a shared memory space. So they will likely to interfere with each other across the threads. Your parallel loops are all looking inside the same box.</p>\n"}], "owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56676993, "answer_count": 1, "score": 1, "last_activity_date": 1560985639, "creation_date": 1560976096, "last_edit_date": 1560984909, "question_id": 56675397, "link": "https://stackoverflow.com/questions/56675397/openmp-parallel-for-doesnt-work-properly", "title": "OpenMP parallel &#39;for&#39; doesn&#39;t work properly", "body": "<p>The following snippet is from one of the functions of my code:</p>\n\n<pre><code>static int i;\n\n#pragma omp parallel for default(shared) private(i) schedule(static,1)\nfor (i=0; i&lt;ttm_ic_last; i++)\n{\n    static int ni, ni1, ni2;\n    static double ni_ratio;\n    static double temp_e, temp_l;\n    ...\n}\n</code></pre>\n\n<p>It's odd that when I comment the line starting with <code>#pragma</code> it works properly, otherwise the loop doesn't touch at least some of the intended values of <code>i</code>. (I'm not sure if 'touch' is the correct  verb here.)</p>\n\n<p>I'm using a workstation with</p>\n\n<pre><code>gcc (GCC) 4.4.6 20120305 (Red Hat 4.4.6-4)\n\n</code></pre>\n\n<p>I wonder what the cause of this error can be.</p>\n"}, {"tags": ["c", "simd", "intrinsics", "avx"], "comments": [{"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1560975259, "post_id": 56675144, "comment_id": 99917707, "body": "If there was, what do you want to do?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1560975896, "post_id": 56675144, "comment_id": 99917962, "body": "Each project that might need some or all of these will eventually implement it. Does it count as official/unofficial drop?"}, {"owner": {"reputation": 102, "user_id": 1973207, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/557d7fa74d7ec23c6726f1c16986b032?s=128&d=identicon&r=PG", "display_name": "DuckQueen", "link": "https://stackoverflow.com/users/1973207/duckqueen"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1560976841, "post_id": 56675144, "comment_id": 99918342, "body": "@EugeneSh.: if it publishes it as something usable in stand-alone from the main project mode"}, {"owner": {"reputation": 15649, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1561011130, "post_id": 56675144, "comment_id": 99925936, "body": "Some of them are borderline impossible to emulate precisely: <code>rcpps</code>, <code>rsqrtps</code> use undocumented approximations, <code>vfmadd132pd</code> needs 128 bit floats. Basic math is simple but very slow: if the source code mixes floats and doubles, and you\u2019re emulating SSE with legacy x87 instructions, you\u2019ll need to switch precision in FP control register before every instruction."}, {"owner": {"reputation": 102, "user_id": 1973207, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/557d7fa74d7ec23c6726f1c16986b032?s=128&d=identicon&r=PG", "display_name": "DuckQueen", "link": "https://stackoverflow.com/users/1973207/duckqueen"}, "reply_to_user": {"reputation": 15649, "user_id": 126995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bdd0d42e87a7c2636f0570ce12d069e5?s=128&d=identicon&r=PG", "display_name": "Soonts", "link": "https://stackoverflow.com/users/126995/soonts"}, "edited": false, "score": 0, "creation_date": 1561094279, "post_id": 56675144, "comment_id": 99958894, "body": "@Soonts:  very slow is what is expected."}], "answers": [{"tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": true, "score": 4, "last_activity_date": 1560975449, "creation_date": 1560975449, "answer_id": 56675239, "question_id": 56675144, "link": "https://stackoverflow.com/questions/56675144/vanilla-c-drop-in-replacement-for-intel-intrinsics/56675239#56675239", "title": "Vanilla C drop in replacement for intel intrinsics?", "body": "<p>I have a project, <a href=\"https://github.com/nemequ/simde/\" rel=\"nofollow noreferrer\">SIMDe</a>, that does it.  It's not complete, but it's more substantial than <a href=\"https://github.com/nemequ/simde/#related-projects\" rel=\"nofollow noreferrer\">anything else I'm aware of</a>.  Contributions welcome ;)</p>\n"}], "owner": {"reputation": 102, "user_id": 1973207, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/557d7fa74d7ec23c6726f1c16986b032?s=128&d=identicon&r=PG", "display_name": "DuckQueen", "link": "https://stackoverflow.com/users/1973207/duckqueen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1561032014, "accepted_answer_id": 56675239, "answer_count": 1, "score": 2, "last_activity_date": 1560990455, "creation_date": 1560974910, "last_edit_date": 1560990455, "question_id": 56675144, "link": "https://stackoverflow.com/questions/56675144/vanilla-c-drop-in-replacement-for-intel-intrinsics", "closed_reason": "Needs details or clarity", "title": "Vanilla C drop in replacement for intel intrinsics?", "body": "<p>For each avx, sse4 etc intrinsic there is an open logical algorithm. I wonder if there is an official or unofficial drop in replacement of intrinsics with vanilla C code (for debugging, prototyping on arm etc)?</p>\n"}, {"tags": ["c", "linux", "audio", "alsa", "libalsa"], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "edited": false, "score": 0, "creation_date": 1560979669, "post_id": 56675241, "comment_id": 99919365, "body": "So it means that behaviors given by library is correct. So how can I control volume between [0,100] logarithmic scale same as sound slider do in operating system like Ubuntu?@meaning-matters"}], "tags": [], "owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "is_accepted": false, "score": 1, "last_activity_date": 1560975459, "creation_date": 1560975459, "answer_id": 56675241, "question_id": 56675099, "link": "https://stackoverflow.com/questions/56675099/how-to-change-volume-of-speaker-using-alsa-library/56675241#56675241", "title": "How to change volume of Speaker using Alsa library?", "body": "<p>You're seeing a logarithmic scale. So the percentage you set is nicely converted for you so that our ears experience a linear scale.</p>\n\n<p>This is the only correct way to set volume as you can read <a href=\"https://www.dr-lex.be/info-stuff/volumecontrols.html\" rel=\"nofollow noreferrer\">here for example</a>.</p>\n"}], "owner": {"reputation": 415, "user_id": 10669327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6051fc808e6d6c453bf165e339d09a6a?s=128&d=identicon&r=PG&f=1", "display_name": "raj123", "link": "https://stackoverflow.com/users/10669327/raj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560975459, "creation_date": 1560974687, "question_id": 56675099, "link": "https://stackoverflow.com/questions/56675099/how-to-change-volume-of-speaker-using-alsa-library", "title": "How to change volume of Speaker using Alsa library?", "body": "<p>I am controlling volume of Speaker using Alsa amixer library on Linux.\nThe problem I have is that its not controlling volume in a proper scale between [0,100] percentage.This sample code I got from here\n<a href=\"https://stackoverflow.com/questions/6787318/set-alsa-master-volume-from-c-code\">Set ALSA master volume from C code</a></p>\n\n<pre><code>//volume.c\n#include&lt;stdio.h&gt;\n#include&lt;alsa/asoundlib.h&gt;\n\nint main(int argc, char *argv[])\n{\nlong volume=atoi(argv[1]);\nlong min, max;\nsnd_mixer_t *handle;\nsnd_mixer_selem_id_t *sid;\nconst char *card = \"hw:0\";\nconst char *selem_name = \"Speaker\";\n\nsnd_mixer_open(&amp;handle, 0);\nsnd_mixer_attach(handle, card);\nsnd_mixer_selem_register(handle, NULL, NULL);\nsnd_mixer_load(handle);\n\nsnd_mixer_selem_id_alloca(&amp;sid);\nsnd_mixer_selem_id_set_index(sid, 0);\nsnd_mixer_selem_id_set_name(sid, selem_name);\nsnd_mixer_elem_t* elem = snd_mixer_find_selem(handle, sid);\n\nsnd_mixer_selem_get_playback_volume_range(elem, &amp;min, &amp;max);\nsnd_mixer_selem_set_playback_volume_all(elem, volume * max / 100);\n\nsnd_mixer_close(handle);\n}\n\n//compiling source code\ngcc volume.c -o volume -lasound\n\n//set volume of speaker 90%\n./volume 90\n</code></pre>\n\n<p>The above program is not setting up volume in proper percentage which I am passing as an argument.</p>\n\n<p>Percentage given to volume program -> actual set volume</p>\n\n<p>0->0</p>\n\n<p>10->2</p>\n\n<p>20->6</p>\n\n<p>30->10</p>\n\n<p>40->15</p>\n\n<p>50->22</p>\n\n<p>60->31</p>\n\n<p>70->41</p>\n\n<p>80->56</p>\n\n<p>90->75</p>\n\n<p>100->100</p>\n\n<p>As shown above when I am setting volume between range [0,100]%,  I am getting resulted volume in different scale.Ex. for value 40 it will set volume to 15%.  </p>\n\n<p>How can I setup volume in proper scale between [0,100] percentage ?</p>\n"}, {"tags": ["c", "signed"], "comments": [{"owner": {"reputation": 1782, "user_id": 10548514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hky6xOH08T4/AAAAAAAAAAI/AAAAAAAABSM/Tw8IuIniovs/photo.jpg?sz=128", "display_name": "Juan Carlos Ramirez", "link": "https://stackoverflow.com/users/10548514/juan-carlos-ramirez"}, "edited": false, "score": 1, "creation_date": 1560974958, "post_id": 56674978, "comment_id": 99917574, "body": "This might be helpful <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\" title=\"implicit type promotion rules\">stackoverflow.com/questions/46073295/&hellip;</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1560975099, "post_id": 56674978, "comment_id": 99917632, "body": "What is the return type of <code>pop()</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1560975170, "post_id": 56674978, "comment_id": 99917668, "body": "You should convert to <code>signed</code> at the earliest opportunity: <code>-1 * ((int32_t)pop() - (int32_t)pop())</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1560975791, "post_id": 56674978, "comment_id": 99917927, "body": "With regard to your second example, you should take extreme care in performing bitwise operations, especially shifts, with operands of signed types.  There are abundant ways to shoot yourself in the foot with that."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1560980140, "post_id": 56674978, "comment_id": 99919495, "body": "Can you show us examples of inputs, outputs, and expected outputs that make you think that signed values are being represented as unsigned when they shouldn&#39;t be?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561022680, "post_id": 56674978, "comment_id": 99931485, "body": "Please post the full declarations of <code>push</code> and <code>pop</code>. Currently posted answers seem to be speculating."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 10533848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6337b9eb5e0682df5bca51211b7df53b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/10533848/peter"}, "edited": false, "score": 0, "creation_date": 1560987903, "post_id": 56675321, "comment_id": 99921316, "body": "I have edited the question, pop() returns a signed int32_t. I did not know C doesn&#39;t specify the order of evaluation, thank you for pointing that out! The problem in this case probably was wrong order of evaluation of the two pop() calls, because the result was the inverse of the expected result. This was not related to signedness and the multiplication then. Unfortunately I can only accept one answer as far as I know, but I am really grateful for the help!"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1560975790, "creation_date": 1560975790, "answer_id": 56675321, "question_id": 56674978, "link": "https://stackoverflow.com/questions/56674978/how-to-force-c-to-interpet-variables-as-signed-or-unsigned-values/56675321#56675321", "title": "How to force C to interpet variables as signed or unsigned values?", "body": "<p>I assume <code>pop()</code> returns an unsigned type. If so, the expression <code>pop() - pop()</code> will be performed using unsigned arithmetic, which is modular and wraps around if the second <code>pop()</code> is larger than the first one (BTW, C doesn't specify a particular order of evaluation, so there's no guarantee which popped value will be first or second).</p>\n\n<p>As a result, the value that you multiply by <code>-1</code> might not be the difference you expect; if there was wraparound, it could be a large positive value rather than a negative value.</p>\n\n<p>You can get the equivalent of the temporaries if you cast at least one of the function calls directly.</p>\n\n<pre><code>push(-1 * ((int32_t)pop() - pop()));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 10533848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6337b9eb5e0682df5bca51211b7df53b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/10533848/peter"}, "edited": false, "score": 0, "creation_date": 1560984275, "post_id": 56675335, "comment_id": 99920556, "body": "This is what made me confused, I have edited the question, pop() returns a signed value, so casting it to a signed value does not make a difference."}], "tags": [], "owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "is_accepted": false, "score": 0, "last_activity_date": 1560975834, "creation_date": 1560975834, "answer_id": 56675335, "question_id": 56674978, "link": "https://stackoverflow.com/questions/56674978/how-to-force-c-to-interpet-variables-as-signed-or-unsigned-values/56675335#56675335", "title": "How to force C to interpet variables as signed or unsigned values?", "body": "<p>The result of an expression in C has its type determined by the types of the component operands of that expression, not by any cast you may apply to that result. As Barmar comments above, to force the type of the result you must cast one of the operands.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1560977025, "last_edit_date": 1560977025, "creation_date": 1560975924, "answer_id": 56675353, "question_id": 56674978, "link": "https://stackoverflow.com/questions/56674978/how-to-force-c-to-interpet-variables-as-signed-or-unsigned-values/56675353#56675353", "title": "How to force C to interpet variables as signed or unsigned values?", "body": "<p>if you just want to convert a binary buffer to the longer signed integers for example  received form somewhere (I assume the little endian)</p>\n\n<pre><code>int16_t bufftoInt16(const uint8_t *buff)\n{\n    return (uint16_t)buff[0] | ((uint16_t)buff[1] &lt;&lt; 8);\n}\n\nint32_t bufftoInt32(const uint8_t *buff)\n{\n    return (uint32_t)buff[0] | ((uint32_t)buff[1] &lt;&lt; 8) | ((uint32_t)buff[2] &lt;&lt; 16) | ((uint32_t)buff[3] &lt;&lt; 24) ;\n}\n\nint32_t bufftoInt32_2bytes(const uint8_t *buff)\n{\n    int16_t result = (uint16_t)buff[0] | ((uint16_t)buff[1] &lt;&lt; 8);\n    return result;\n}\n\n\nint main()\n{\n    int16_t x = -5;\n    int32_t y = -10;\n    int16_t w = -5567;\n\n    printf(\"%hd %d %d\\n\", bufftoInt16(&amp;x), bufftoInt32(&amp;y), bufftoInt32_2bytes(&amp;w));\n\n    return 0;\n}\n</code></pre>\n\n<p>casting bytes to signed integers works completely different way than the unsigned shift.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1560978705, "last_edit_date": 1560978705, "creation_date": 1560978163, "answer_id": 56675797, "question_id": 56674978, "link": "https://stackoverflow.com/questions/56674978/how-to-force-c-to-interpet-variables-as-signed-or-unsigned-values/56675797#56675797", "title": "How to force C to interpet variables as signed or unsigned values?", "body": "<blockquote>\n  <p>I am working on a project where I often need to interpret certain variables as signed or unsigned values and do signed operations on them.</p>\n</blockquote>\n\n<p>That seems fraught.  I take you to mean that you want to reinterpret objects' <em>representations</em> as having different types (varying only in signedness) in different situations, or perhaps that you want to convert values as if you were reinterpreting object representations.  This sort of thing generally produces a mess, though you can handle it if you take sufficient care.  That can be easier if you are willing to depend on details of your implementation, such as its representations of various types.</p>\n\n<p>It is imperative in such matters is to know and understand all <a href=\"https://stackoverflow.com/a/46073296/2402272\">the rules for implicit conversions</a>, both the integer promotions and the usual arithmetic conversions, and under which circumstances they apply.  It is essential to understand the effect of these rules on the evaluation of your expressions -- both the type and the value of all intermediate and final results.</p>\n\n<p>For example, the best you can hope for with respect to the cast in</p>\n\n<blockquote>\n<pre><code>push((int32_t)( (-1) * (temp1 - temp2) ) );\n</code></pre>\n</blockquote>\n\n<p>is that it is useless.  If the value is not representable in that type then (it being a signed integer type) a signal may be raised, and if not, then the result is implementation-defined.  If the value <em>is</em> representable, however, then the conversion does not change it.  In any case, the result is not exempted from further conversion to the type of <code>push()</code>'s parameter.</p>\n\n<p>For another example, the difference between version 1 and version 2 of your first example is largely which values are converted, when (but see also below).  If the two indeed produce different results then it follows that the return type of <code>pop()</code> is different from <code>int32_t</code>.  In that case, if you want to convert those to a different type to perform an operation on them then you must in fact do that.  Your version 2 accomplishes that via assigning the <code>pop()</code> results to variables of the desired type, but it would be more idiomatic to perform the conversions via casts:</p>\n\n<blockquote>\n<pre><code>push((-1) * ((int32_t)pop() - (int32_t)pop()));\n</code></pre>\n</blockquote>\n\n<p>Beware, however, that if the results of the <code>pop()</code> calls depend on their order -- if they pop elements off a stack, for instance -- then you have a further problem: the relative order in which those operands are evaluated is unspecified, and you cannot safely assume that it will be consistent.  For <em>that</em> reason, not because of typing considerations, your version 2 is preferable here.</p>\n\n<p>Overall, however, if you have a stack whose elements may represent values of different types, then I would suggest making the element type a union (if the type of each element is implicit from context) or a tagged union (if elements need to carry information about their own types.  For example,</p>\n\n<pre><code>union integer {\n    int32_t signed;\n    uint32_t unsigned;\n};\n\nunion integer pop();\nvoid push(union integer i);\n\nunion integer first = pop();\nunion integer second = pop();\npush((union integer) { .signed = second.signed - first.signed });\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 10533848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6337b9eb5e0682df5bca51211b7df53b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/10533848/peter"}, "edited": false, "score": 0, "creation_date": 1560990166, "post_id": 56676007, "comment_id": 99921708, "body": "Thank you for walking me through this! Unfortunately I can&#39;t accept multiple answers, but I appreciate the help! Does this mean that if I want to do bit shifting on types smaller, than int I have to cast the number of bits to shift by to that type? For example uint16_t foo; foo &lt;&lt; (uint16_t)8;"}, {"owner": {"reputation": 129, "user_id": 10533848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6337b9eb5e0682df5bca51211b7df53b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/10533848/peter"}, "edited": false, "score": 0, "creation_date": 1560990377, "post_id": 56676007, "comment_id": 99921752, "body": "An example input was 0xfff9, so argument[0] = 0xff and argument[1] = 0xf9. The 16 bit version of my function returned -7, as expected, but the 32 bit version returned 65 529, the decimal representation of 0xfff9"}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "reply_to_user": {"reputation": 129, "user_id": 10533848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6337b9eb5e0682df5bca51211b7df53b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/10533848/peter"}, "edited": false, "score": 0, "creation_date": 1560992615, "post_id": 56676007, "comment_id": 99922091, "body": "@Peter So you were trying to get negative numbers out of those functions? In that case, the important thing to be aware of is the distinction between the bits being stored in a value and how those bits are interpreted. There are a couple different ways to represent negative numbers, but all will have the most significant bit be 1.  0x0000FFF9 is a positive number; 0xFFF9 is a negative number. But the bitwise ops are just operating on the raw bits; they don&#39;t know or care about negative values. You got the right bits; now just cast the <i>final</i> value to int16_t and it&#39;ll work the way you want."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "reply_to_user": {"reputation": 129, "user_id": 10533848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6337b9eb5e0682df5bca51211b7df53b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/10533848/peter"}, "edited": false, "score": 0, "creation_date": 1560993151, "post_id": 56676007, "comment_id": 99922191, "body": "@Peter Which is to say, the problem isn&#39;t the signed/unsigned part of the type; it&#39;s the size. I&#39;ve added another paragraph to the end of the answer that explains what you should do in a bit more detail."}], "tags": [], "owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "is_accepted": true, "score": -1, "last_activity_date": 1560992939, "last_edit_date": 1560992939, "creation_date": 1560979196, "answer_id": 56676007, "question_id": 56674978, "link": "https://stackoverflow.com/questions/56674978/how-to-force-c-to-interpet-variables-as-signed-or-unsigned-values/56676007#56676007", "title": "How to force C to interpet variables as signed or unsigned values?", "body": "<p>To help you see what's happening in your code, I've included the text of the standard that explains how automatic type conversions are done (for integers), along with the section on bitwise shifting since that works a bit differently.  I then step through your code to see exactly what intermediate types exist after each operation.</p>\n\n<h1>Relevant parts of the standard</h1>\n\n<h3>6.3.1.1 Boolean, characters, and integers</h3>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>If an int can represent all values of the original type, the value is converted to an int; otherwise, it is converted to an unsigned int. These are called the integer promotions. All other types are unchanged by the integer promotions.</li>\n  </ol>\n</blockquote>\n\n<h3>6.3.1.8 Usual Arithmetic Conversions</h3>\n\n<p>(I'm just summarizing the relevant parts here.)</p>\n\n<ol>\n<li>Integer promotion is done.</li>\n<li>If they are both signed or both unsigned, they are both converted to the larger type.</li>\n<li>If the unsigned type is larger, the signed type is converted to the unsigned type.</li>\n<li>If the signed type can represent all values of the unsigned type, the unsigned type is converted to the signed one.</li>\n<li>Otherwise, they are both converted to the unsigned type of the same size as the signed type.</li>\n</ol>\n\n<p>(Basically, if you've got <code>a OP b</code>, the size of the type used will be the largest of <code>int</code>, type(a), type(b), and it\nwill prefer types that can represent all values representable by type(a) and type(b). And finally, it favors signed types.\nMost of the time, that means it'll be int.)</p>\n\n<h3>6.5.7 Bitwise shift operators</h3>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>The result of E1 &lt;&lt; E2 is E1 left-shifted E2 bit positions; vacated bits are filled with zeros. If E1 has an unsigned type, the value of the result is $E1 x 2^{E2}$,reduced modulo one more than the maximum value representable in the result type. If E1 has a signed type and nonnegative value, and $E1 x 2^{E2}$ is representable in the result type, then that is the resulting value; otherwise, the behavior is undefined.</li>\n  </ol>\n</blockquote>\n\n<hr>\n\n<h1>How all that applies to your code.</h1>\n\n<p>I'm skipping the first example for now, since I don't know what type pop() returns. If you add that information to your\nquestion, I can address that example as well.</p>\n\n<p>Let's step through what happens in this expression (note that you had an extra <code>(</code> after the first cast in your version; I've removed that):</p>\n\n<p><code>(((int32_t)argument[0] &lt;&lt; 8) &amp; (int32_t)0x0000ff00 | (((int32_t)argument[1]) &amp; (int32_t)0x000000ff) )</code></p>\n\n<p>Some of these conversions depend on the relative sizes of the types.\nLet INT_TYPE be the larger of int32_t and int on your system.</p>\n\n<h3><code>((int32_t)argument[0] &lt;&lt; 8)</code></h3>\n\n<ol>\n<li>argument[0] is explicitly cast to int32_t</li>\n<li>8 is already an int, so no conversion happens</li>\n<li>(int32_t)argument[0] is converted to INT_TYPE.</li>\n<li>The left shift happens and the result has type INT_TYPE.</li>\n</ol>\n\n<p>(Note that if argument[0] could have been negative, the shift would be undefined behavior. But since it was originally unsigned, so you're safe here.)</p>\n\n<p>Let <code>a</code> represent the result of those steps.</p>\n\n<h3><code>a &amp; (int32_t)0x0000ff00</code></h3>\n\n<ol>\n<li>0x000ff0 is explicitly cast to int32_t.</li>\n<li>Usual arithmetic conversions. Both sides are converted to INT_TYPE. Result is of type INT_TYPE.</li>\n</ol>\n\n<p>Let <code>b</code> represent the result of those steps.</p>\n\n<h3><code>(((int32_t)argument[1]) &amp; (int32_t)0x000000ff)</code></h3>\n\n<ol>\n<li>Both of the explicit casts happen</li>\n<li>Usual arithmetic conversions are done. Both sides are now INT_TYPE.</li>\n<li>Result has type INT_TYPE.</li>\n</ol>\n\n<p>Let <code>c</code> represent that result.</p>\n\n<h3><code>b | c</code></h3>\n\n<ol>\n<li>Usual arithmetic conversions; no changes since they're both INT_TYPE.</li>\n<li>Result has type INT_TYPE.</li>\n</ol>\n\n<h1>Conclusion</h1>\n\n<p>So none of the intermediate results are unsigned here.  (Also, most of the explicit casts were unnecessary, especially if <code>sizeof(int) &gt;= sizeof(int32_t)</code> on your system). </p>\n\n<p>Additionally, since you start with <code>uint8_t</code>s, never shift more than 8 bits, and are storing all the intermediate results in types of at least 32 bits, the top 16 bits will always be 0 and the values will all be non-negative, which means that the signed and unsigned types represent all the values you could have here <em>exactly the same</em>.</p>\n\n<p>What exactly are you observing that makes you think it's using unsigned types where it should use signed ones? Can we see example inputs and outputs along with the outputs you expected?</p>\n\n<p>Edit: \nBased on your comment, it appears that the reason it isn't working the way you expected is not because the type is <em>unsigned</em>, but because you're generating the bitwise representations of 16 bit signed ints but storing them in 32 bit signed ints.  Get rid of all the casts you have other than the <code>(int32_t)argument[0]</code> ones (and change those to <code>(int)argument[0]</code>. <code>int</code> is generally the size that the system operates on most efficiently, so your operations to use int unless you have a specific reason to use another size).  Then cast the <em>final</em> result to <code>int16_t</code>.</p>\n"}], "owner": {"reputation": 129, "user_id": 10533848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6337b9eb5e0682df5bca51211b7df53b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/10533848/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 56676007, "answer_count": 5, "score": 0, "last_activity_date": 1560992939, "creation_date": 1560974123, "last_edit_date": 1560983868, "question_id": 56674978, "link": "https://stackoverflow.com/questions/56674978/how-to-force-c-to-interpet-variables-as-signed-or-unsigned-values", "title": "How to force C to interpet variables as signed or unsigned values?", "body": "<p>I am working on  a project where I often need to interpret certain variables as signed or unsigned values and do signed operations on them; however, in multiple cases subtle, seemingly insignificant changes swapped an unsigned interpretation to a signed one, while in other cases I couldn't force C to interpret it as a signed value and it remained unsigned. Here are two examples:</p>\n\n<pre><code>int32_t pop();\n\n//Version 1\npush((int32_t)( (-1) * (pop() - pop()) ) );\n\n//Version 2\nint32_t temp1 = pop();\nint32_t temp2 = pop();\npush((int32_t)( (-1) * (temp1 - temp2) ) );\n\n/*Another example */\n\n//Version 1\nint32_t get_signed_argument(uint8_t* argument) {\n  return (int32_t)( (((int32_t)argument[0] &lt;&lt; 8) &amp; (int32_t)0x0000ff00 | (((int32_t)argument[1]) &amp; (int32_t)0x000000ff) );\n}\n\n//Version 2\nint16_t get_signed_argument(uint8_t* argument) {\n  return (int16_t)( (((int16_t)argument[0] &lt;&lt; 8) &amp; (int16_t)0xff00 | (((int16_t)argument[1]) &amp; (int16_t)0x00ff) );\n}\n</code></pre>\n\n<p>In the first example version 1 does not seem to multiply the value by -1, while version 2 does, but the only difference is storing the intermediate values of the calculation in temporary variables in one case or not doing so in the other.</p>\n\n<p>In the second example the value returned by version 1 is the unsigned interpretation of the same bytes as the returned value of version 2, which interprets it in 2's complement. The only difference is using int16_t or int32_t.</p>\n\n<p>In both cases I am using signed types (int32_t, int16_t), but this doesn't seem to be sufficient to interpret them as signed values. Can you please explain why these differences cause a difference in signedness? Where can I find more information on this? How can I use the shorter version of the first example, but still get signed values? Thank you in advance!</p>\n"}, {"tags": ["c", "debugging", "codeblocks"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1560976211, "post_id": 56674958, "comment_id": 99918096, "body": "Read about <code>memset</code>, what it does and what parameter types it should take. Also read the warnings your compiler is probably throwing you."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1560990122, "post_id": 56674958, "comment_id": 99921704, "body": "This starting code has too many nonsense to even discuss it. Run away from this challenger as fast as you can. Never talk to him about C ever again."}], "owner": {"reputation": 31, "user_id": 11631938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c78ce6427613df88283b3513f1a0b0c9?s=128&d=identicon&r=PG&f=1", "display_name": "Robt800", "link": "https://stackoverflow.com/users/11631938/robt800"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560974023, "creation_date": 1560974023, "question_id": 56674958, "link": "https://stackoverflow.com/questions/56674958/codeblocks-c-debugging", "title": "Codeblocks C Debugging", "body": "<p>I've got a new challenge to return the factorial of a number.  Got ideas on how to do this, but the challenger has given some starting code - which is shown below.</p>\n\n<p>Now this isn't how I would have started it (with my extremely limited experience!) - BUT I wasn't sure how system would grab some text &amp; place within an int array - hence I tried running it within codeblocks, debugging and looking at the watch table.  However I can't see 'num'.</p>\n\n<p>So I tried copying num to num1:\n    int num1[30] = {0};</p>\n\n<pre><code>memset(num1[0],num[0], sizeof(num));\n</code></pre>\n\n<p>that doesn't seem to affect anything...</p>\n\n<p>So question really is - is there something wrong with my codeblocks config (it debugs other programs and I've tried both cygwin &amp; MiniGW) or is there another reason for this behavious?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid FirstFactorial(int num[]) {\n\n// code goes here\nprintf(\"%d\", num);\n\n}\n\nint main(void) {\n\n// keep this function call here\nFirstFactorial(gets(stdin));\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "time.h"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1560973851, "post_id": 56674821, "comment_id": 99917137, "body": "Note that <a href=\"https://en.cppreference.com/w/c/chrono/localtime\" rel=\"nofollow noreferrer\"><code>localtime</code></a> can fail, and return a null pointer. Think bout what happen when you dereference a null pointer."}, {"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 1, "creation_date": 1560974077, "post_id": 56674821, "comment_id": 99917229, "body": "My understanding is that you have a problem if you call the function from different threads, so you have a race condition. Suggestions: you can use localtime_r if you are working on posix, and localtime_s if you are on windows. You can use use a #ifdef to conditionally enable them and wrap them all in a function to provide a somewhat portable alternative. Caution: the 2 functions require the same inputs but swapped. Caution 2: it looks like C11 has localtime_s (called as Windows) but with the input order to localtime_r ."}, {"owner": {"reputation": 792, "user_id": 3007075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a197e963f9bee28b4b692a594ee54f?s=128&d=identicon&r=PG&f=1", "display_name": "Mefitico", "link": "https://stackoverflow.com/users/3007075/mefitico"}, "reply_to_user": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 0, "creation_date": 1560975166, "post_id": 56674821, "comment_id": 99917665, "body": "@CuriouslyRecurringThoughts : I need to implement a solution for both windows and linux, so thanks for indicating both <code>localtime_r</code> and <code>localtime_s</code>. Nonetheless, this seems to solve the issue with <code>localtime</code>, but alter on I still get the problem on <code>mktime</code>."}, {"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 1, "creation_date": 1560975543, "post_id": 56674821, "comment_id": 99917833, "body": "@Mefitico then, most likely, is as &quot;Some programmer dude&quot; says: localtime return a NULL, you might want to add a check to validate the idea."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1560983899, "post_id": 56674821, "comment_id": 99920479, "body": "<code>localtime_s</code> is added in C11, so it should work on linux too, or any C11 compiler."}], "owner": {"reputation": 792, "user_id": 3007075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a197e963f9bee28b4b692a594ee54f?s=128&d=identicon&r=PG&f=1", "display_name": "Mefitico", "link": "https://stackoverflow.com/users/3007075/mefitico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560973464, "creation_date": 1560973464, "question_id": 56674821, "link": "https://stackoverflow.com/questions/56674821/mktime-and-localtime-causing-segmentation-fault-how-to-properly-initialize", "title": "mktime and localtime causing Segmentation fault, how to properly initialize?", "body": "<p>I have the following function that is repeatedly called within a larger program:</p>\n\n<pre><code>double troublesome_function() {\ntime_t time_ini = time(NULL);\nstruct tm tm_ini = *localtime(&amp;time_ini);\n\n(...)\n\ntime_t secs_passed;  \nsecs_passed = mktime(&amp;tm_ini);\n\ndouble return_value =0;\n\nreturn_value = (double)secs_passed;\n\nreturn(return_value); \n}\n</code></pre>\n\n<p>Most of the time, it works just fine. But in a few cases the line <code>*localtime(&amp;time_ini)</code> causes a Segmentation Fault. Removing this initialization from <code>tm_ini</code> seems okay, but then the code will again run fine in most cases but the line <code>mktime(&amp;tm_ini)</code> will cause a segmentation fault. Finally, the return operation may also be at error, which I've checked by adding <code>printf</code>s to the code. </p>\n\n<p>According to <a href=\"https://stackoverflow.com/a/22519450/3007075\">this answer</a> <em>\"One gotcha with <code>localtime</code> is the returned pointer is a pointer to a static global var and subsequent calls to <code>localtime</code> update the var.\"</em> </p>\n\n<p>I'm suspicious that the repeated calls to <code>mktime</code> are causing this behavior, so by adding a static counter variable, this happens at the 94th call.</p>\n\n<p>Any way to prevent functions from <code>time.h</code> from suffering this interference?</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 333, "user_id": 6513938, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206773999729679/picture?type=large", "display_name": "Jae Nulton", "link": "https://stackoverflow.com/users/6513938/jae-nulton"}, "edited": false, "score": 0, "creation_date": 1560972321, "post_id": 56674549, "comment_id": 99916514, "body": "Does it work the same in this script as I have used it in Bash? Sorry for the question, bash is my level - not this stuff. I am way out of my comfort zone on this. Where within all those curly brackets would I put the tee command to not get an error?"}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 2, "creation_date": 1560972336, "post_id": 56674549, "comment_id": 99916520, "body": "The file you linked to is that of an <a href=\"https://www.asterisk.org/\" rel=\"nofollow noreferrer\">asterisk</a> module. Modifying the C code to write to a file would be non-trivial. You can just call <code>asterisk -rx &quot;rpt dumpvars 1234&quot; &gt; variables.txt</code> from the command line."}, {"owner": {"reputation": 333, "user_id": 6513938, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206773999729679/picture?type=large", "display_name": "Jae Nulton", "link": "https://stackoverflow.com/users/6513938/jae-nulton"}, "reply_to_user": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1560972607, "post_id": 56674549, "comment_id": 99916616, "body": "THANK YOU SEAN! The -rx part of the string is what I couldn&#39;t remember. I used to use that all the time, it&#39;s been so long. That will be so much better than modifying this file."}, {"owner": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 2, "creation_date": 1560973289, "post_id": 56674549, "comment_id": 99916897, "body": "If you can&#39;t remember the flag to be used with the command, you can save some time and look it up in the man. Most likely there is a <code>man asterisk</code> page for your needs, or just look it up on the internet :)"}], "owner": {"reputation": 333, "user_id": 6513938, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206773999729679/picture?type=large", "display_name": "Jae Nulton", "link": "https://stackoverflow.com/users/6513938/jae-nulton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560972168, "creation_date": 1560972168, "question_id": 56674549, "link": "https://stackoverflow.com/questions/56674549/output-to-both-console-and-txt-file", "title": "Output to both console and txt file", "body": "<p>I think this is written in C, honestly don't know how to identify (if someone could give some tips it would be great). When the command <strong>rpt dumpvars 1234</strong> is run in the console it returns the variables of machine/node 1234 to the screen. I want the same data output to a variables.txt file. Is there a simple one liner that I can add to do this?</p>\n\n<p>The file is <a href=\"https://github.com/ismaelisuani/rpt_events/blob/master/app_rpt.c\" rel=\"nofollow noreferrer\">located here</a>. </p>\n\n<p>The portion of the data I am trying to get can be found on lines 7590-7623 as pasted here:</p>\n\n<pre><code>/*\n* Display a node's main channel variables from the command line \n*/\nstatic int rpt_do_showvars(int fd, int argc, char *argv[])\n{\nint i,thisRpt = -1;\nstruct ast_var_t *newvariable;\n\nif (argc != 3) return RESULT_SHOWUSAGE;\nfor(i = 0; i &lt; nrpts; i++)\n{\n    if(!strcmp(argv[2], rpt_vars[i].name))\n    {\n        thisRpt = i;\n        break;\n    } \n} \n\nif (thisRpt &lt; 0)\n{\n    ast_cli(fd, \"Unknown node number %s.\\n\", argv[2]);\n    return RESULT_FAILURE;\n} \ni = 0;\nast_cli(fd,\"Variable listing for node %s:\\n\",argv[2]);\nast_channel_lock(rpt_vars[thisRpt].rxchannel);\nAST_LIST_TRAVERSE (&amp;rpt_vars[thisRpt].rxchannel-&gt;varshead, newvariable, \nentries) {\n    i++;\n    ast_cli(fd,\"   %s=%s\\n\", ast_var_name(newvariable), \nast_var_value(newvariable));\n}\nast_channel_unlock(rpt_vars[thisRpt].rxchannel);\nast_cli(fd,\"    -- %d variables\\n\", i);\nreturn(0);\n}\n</code></pre>\n"}, {"tags": ["c", "char"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1560972131, "post_id": 56674512, "comment_id": 99916423, "body": "Case 11..15 are easy too: <code>&#39;a&#39; + znak - 10</code>. Another approach is to make a simple look-up table: <code>hex[znak]</code> and you&#39;re done."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1560972733, "post_id": 56674512, "comment_id": 99916657, "body": "@tadman You mean case 10..15."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1560972974, "post_id": 56674512, "comment_id": 99916762, "body": "@TomKarzes Precisely."}, {"owner": {"reputation": 2417, "user_id": 2503164, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/68d57915f8c4a877fe42a67251d1420a?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2503164/mike"}, "edited": false, "score": 1, "creation_date": 1560973293, "post_id": 56674512, "comment_id": 99916898, "body": "return &quot;0123456789abcdef&quot; [znak &amp; 0x0F];"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561004930, "post_id": 56674512, "comment_id": 99924212, "body": "there are 4 places in the code where there are assignments between &#39;unsigned&#39; and <code>int</code>  Your compiler should have warned you about those problems"}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 0, "creation_date": 1560975855, "post_id": 56674653, "comment_id": 99917949, "body": "I added magic numbers in comments so reader knows what I mean by adding and because I was trying to add either way (char/int/hex) I left it somehow. I meant to be <code>&#39;a&#39;</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1560972632, "creation_date": 1560972632, "answer_id": 56674653, "question_id": 56674512, "link": "https://stackoverflow.com/questions/56674512/adding-char-as-int-gives-unexpected-result/56674653#56674653", "title": "adding char as int gives unexpected result", "body": "<p>Lets take a closer look at the <code>ToHex4bits2</code> function:</p>\n\n<pre><code>static inline unsigned char ToHex4bits2(unsigned char znak)\n//unsigned char ToHex4bits2(unsigned char znak)\n    {\n    //unsigned char add = '0';\n    int add = '0';  /// [0-9]; add value of '0' (65 0x41    '0')\n    znak &amp;=0x0F;\n    if(znak &gt; 9)  /// [a-f]; if `znak' &lt;0x0a, 0x0f&gt; /// just one comparison as `znak' cannot be bigger than 15 anyway (znak &amp;=0x0F;)\n        {\n        add = 0x61;  /// 'a'; // 87 0x61    'a'\n        }\n    return znak + add;\n    }\n</code></pre>\n\n<p>If the value of <code>znak</code> is larger than <code>9</code> then you add the value <code>0x61</code> (ASCII code for <code>'a'</code>). If <code>znak</code> is (for example) <code>11</code> (hex <code>0xb</code>) the addition results in <code>0x72</code> which is the ASCII code for <code>'r'</code> To fix this you should subtract <code>10</code> (<code>0xa</code>) from <code>znak</code> first.</p>\n\n<p>And of course you should not use <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow noreferrer\">magic numbers</a>. If you mean the character <code>'a'</code> then <em>say</em> so. In the code itself.</p>\n"}, {"comments": [{"owner": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 0, "creation_date": 1560976597, "post_id": 56674697, "comment_id": 99918245, "body": "you meant       static inline unsigned char ToHex4bits2k(unsigned char znak)     {         znak &amp;= 0x0F;     return znak &gt; 9 ? znak + &#39;a&#39; - 10 : znak + &#39;0&#39;;     }"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 0, "creation_date": 1560976716, "post_id": 56674697, "comment_id": 99918288, "body": "@tansy What&#39;s the difference? Have I written anything wrong?"}, {"owner": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 0, "creation_date": 1560976962, "post_id": 56674697, "comment_id": 99918373, "body": "Well, yes. if <code>0 &lt; znak &lt; 9</code> you want to return <code>&#39;0&#39;-&#39;9&#39;</code> not <code>0x00-0x09</code>. I guess it&#39;s a typo."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 0, "creation_date": 1560977030, "post_id": 56674697, "comment_id": 99918397, "body": "@tansy You&#39;re completely right. My mistake. Corrected."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 0, "creation_date": 1560977781, "post_id": 56674697, "comment_id": 99918683, "body": "@tansy Updated with suggestions for optimizations."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 1, "creation_date": 1560978247, "post_id": 56674697, "comment_id": 99918852, "body": "@tansy Please mark the answer you consider best as &quot;accepted&quot;. Read more here: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "edited": false, "score": 0, "creation_date": 1560993071, "post_id": 56674697, "comment_id": 99922168, "body": "I run it 10^9 times and for all these &quot;versions&quot; it took ~10[s]. And you were right about optimization - the difference between all &quot;versions&quot; is less than 0.120[s]. There is no difference really. This code is too short I guess."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 1, "last_activity_date": 1560977741, "last_edit_date": 1560977741, "creation_date": 1560972879, "answer_id": 56674697, "question_id": 56674512, "link": "https://stackoverflow.com/questions/56674512/adding-char-as-int-gives-unexpected-result/56674697#56674697", "title": "adding char as int gives unexpected result", "body": "<p>The reason is simple. If <code>znak</code> is 10, then you want to return <code>'a'</code>, but you're returning <code>'a'+10</code>. So return <code>znak+add-10</code> instead.</p>\n\n<p>But you're making it extremely difficult for yourself. Magic constants all over the place and extremely complicated code for a simple task. This would do:</p>\n\n<pre><code>{\nznak &amp;= 0x0F;\nif(znak &gt; 9) \n    return znak + 'a' - 10;\nelse\n    return znak + '0';\n}\n</code></pre>\n\n<p>Or this if you want to be more compact. You're obviously not afraid of complicated code:</p>\n\n<pre><code>{\nznak &amp;= 0x0F;\nreturn znak &gt; 9 ? znak + 'a' - 10 : znak + '0';\n}\n</code></pre>\n\n<p>You mentioned that you're trying to optimize this code. I have a hard time seeing how you could do so much about it. It's likely that you would be better of optimizing a bigger chunk to see if there's something wrong with algorithms or something. But we can do a minor thing about the first, and it's this:</p>\n\n<pre><code>#define likely(x)      __builtin_expect(!!(x), 1) \n#define unlikely(x)    __builtin_expect(!!(x), 0) \nstatic inline unsigned char ToHex4bits1(unsigned char znak)\n{\n    {\n    znak &amp;= 0x0F;\n    // Hint the compiler that the first branch is less likely, which\n    // improves branch prediction\n    if(unlikely(znak &gt; 9)) \n        return znak + 'a' - 10;\n    else\n        return znak + '0';\n    }\n}\n</code></pre>\n\n<p>Read about it here: <a href=\"https://www.geeksforgeeks.org/branch-prediction-macros-in-gcc/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/branch-prediction-macros-in-gcc/</a></p>\n\n<p>But I think the fastest method is this:</p>\n\n<pre><code>static inline unsigned char ToHex4bits1(unsigned char znak)\n{\n    const unsigned char ret[] = { '0', '1', '2', '3', '4', '5', '6', '7',\n                                  '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n    return ret[znak &amp; 0x0F];\n}\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 8406172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Ko7V.jpg?s=128&g=1", "display_name": "tansy", "link": "https://stackoverflow.com/users/8406172/tansy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 56674697, "answer_count": 2, "score": 1, "last_activity_date": 1560993445, "creation_date": 1560971994, "last_edit_date": 1560993445, "question_id": 56674512, "link": "https://stackoverflow.com/questions/56674512/adding-char-as-int-gives-unexpected-result", "title": "adding char as int gives unexpected result", "body": "<p>I try to do some hex-bin/bin-hex conversion and test which function would be faster but I encountered strange error while adding 'a' as integer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/* convert bin to hex char [0-9a-f] */\nstatic inline unsigned char ToHex4bits1(unsigned char znak)\n//unsigned char ToHex4bits1(unsigned char znak)\n    {\n    znak &amp;= 0x0F;\n    switch(znak)\n        {\n        case 10: return 'a';\n        case 11: return 'b';\n        case 12: return 'c';\n        case 13: return 'd';\n        case 14: return 'e';\n        case 15: return 'f';\n        default: return znak + 48;  /// 48  0x30    '0'\n        }\n    }\n\n/* convert bin to hex char [0-9a-f] */    \nstatic inline unsigned char ToHex4bits2(unsigned char znak)\n//unsigned char ToHex4bits2(unsigned char znak)\n    {\n    //unsigned char add = '0';\n    int add = '0';  /// [0-9]; add value of '0' (65 0x41    '0')\n    znak &amp;=0x0F;\n    if(znak &gt; 9)  /// [a-f]; if `znak' &lt;0x0a, 0x0f&gt; /// just one comparison as `znak' cannot be bigger than 15 anyway (znak &amp;=0x0F;)\n        {\n        add = 0x61;  /// 'a'; // 87 0x61    'a'\n        }\n    return znak + add;\n    }\n\n//-----------//\nint main()\n    {\n    int i;\n    //char z;\n    int z; \n\n    printf(\"\\nToHex4bits1(i)\\n\");\n    for(i=0; i&lt;16; i++)\n        {\n        z = ToHex4bits1(i);\n        printf(\"%d\\t%02x\\t%c\\n\", z, z, z);\n        }\n\n    printf(\"\\nToHex4bits2(i)\\n\");\n    for(i=0; i&lt;16; i++)\n        {\n        z = ToHex4bits2(i);\n        printf(\"%d\\t%02x\\t%c\\n\", z, z, z);\n        }\n    return 0;\n    }\n</code></pre>\n\n<p>when I run it <code>$ gcc -o tohex4bits tohex4bits.c; ./tohex4bits</code> I get this result:</p>\n\n<pre><code>ToHex4bits1(i)\n48  30  0\n49  31  1\n(...)\n57  39  9\n97  61  a\n98  62  b\n(...)\n102 66  f\n48  30  0\n# which is what I expected\n\nToHex4bits2(i)\n48  30  0\n49  31  1\n(...)\n57  39  9\n107 6b  k # that's where things get interesting; it's 10 too much ('k'-'a'==10)\n108 6c  l\n109 6d  m\n110 6e  n\n111 6f  o\n112 70  p\n\n# which is wrong\n</code></pre>\n\n<p>What is actually wrong with second function <code>ToHex4bits2()</code>, why is that adding 'a' (97/0x61) makes it add 'k' (107/0x6b), or 'A' => 'K' for that matter?</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1560971289, "post_id": 56674337, "comment_id": 99916034, "body": "What problem? What have you tried to solve it?"}, {"owner": {"reputation": 11, "user_id": 11672305, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-S7AThCr84HE/AAAAAAAAAAI/AAAAAAAALL4/BXM-b6W0mMI/photo.jpg?sz=128", "display_name": "user11672305", "link": "https://stackoverflow.com/users/11672305/user11672305"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1560971637, "post_id": 56674337, "comment_id": 99916213, "body": "I have tried to run the code with some printf at the end of every fork, to try to figure out how to create the processes tree that we were asked for."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1560971677, "post_id": 56674337, "comment_id": 99916233, "body": "And how did that go? Did you get stuck at some particular point? If so, please include your thought process in your question. We need to see your attempt at solving your problem."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1560972033, "post_id": 56674337, "comment_id": 99916391, "body": "Instead of a bunch of variables consider using an array."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1560972170, "post_id": 56674490, "comment_id": 99916443, "body": "Your count is right, but your tree is wrong.  You appear to have gotten the sense of the condition backward.  <code>pid1 != 0</code> is true in the parent, not the child."}, {"owner": {"reputation": 11, "user_id": 11672305, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-S7AThCr84HE/AAAAAAAAAAI/AAAAAAAALL4/BXM-b6W0mMI/photo.jpg?sz=128", "display_name": "user11672305", "link": "https://stackoverflow.com/users/11672305/user11672305"}, "edited": false, "score": 0, "creation_date": 1560975664, "post_id": 56674490, "comment_id": 99917880, "body": "That is very helpful, I was having a similar confusion about the two fork () inside the if. But, now I think I got a clearer view abou it especially pid3. Thank you"}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": false, "score": 2, "last_activity_date": 1560972615, "last_edit_date": 1560972615, "creation_date": 1560971903, "answer_id": 56674490, "question_id": 56674337, "link": "https://stackoverflow.com/questions/56674337/how-do-i-count-correctly-processes-created-by-fork/56674490#56674490", "title": "How do I count correctly processes created by fork?", "body": "<p>Running the code is only somewhat helpful (and can't be done during the exam!)--better to draw a process tree. The rules are that every child process starts execution after the <code>fork</code> call that spawned it, parents have nonzero <code>pid</code> and children have a <code>pid</code> of zero.</p>\n\n<pre><code>         main\n       /   |   \\\n    pid1 pid2 pid3\n     /     |\n  pid4   pid3\n</code></pre>\n\n<p>We can see <code>main</code> spawns three children, <code>pid1</code>, <code>pid2</code> and <code>pid3</code> (<code>pid1</code> is trivial and the other two are spawned in the true <code>if</code> block). <code>pid1</code> goes on to the <code>else</code> portion of the conditional and spawns <code>pid4</code> before finishing. <code>pid2</code> is the only trick: it spawns again at <code>pid3</code> because that's where its execution starts.</p>\n\n<p>Answer:</p>\n\n<blockquote class=\"spoiler\">\n  <p> 6 processes in total are created (<code>main</code> and 5 children)</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 11672305, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-S7AThCr84HE/AAAAAAAAAAI/AAAAAAAALL4/BXM-b6W0mMI/photo.jpg?sz=128", "display_name": "user11672305", "link": "https://stackoverflow.com/users/11672305/user11672305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560972615, "creation_date": 1560971204, "last_edit_date": 1560971348, "question_id": 56674337, "link": "https://stackoverflow.com/questions/56674337/how-do-i-count-correctly-processes-created-by-fork", "title": "How do I count correctly processes created by fork?", "body": "<p>I am having problems with C code about processes that are created with fork given by our professor to figure out the number of processes that it creates.</p>\n\n<pre><code>pid1 = fork();\n\nif (pid1 != 0) {\n   pid2 = fork();\n   pid3 = fork();\n}\nelse {\n   pid4 = fork(); \n}\n</code></pre>\n"}, {"tags": ["c", "linux", "dji-sdk"], "answers": [{"comments": [{"owner": {"reputation": 1609, "user_id": 11530294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wmx8FmXvssw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddovKe67tDYNr2B-3B5bFJOj8cZg/mo/photo.jpg?sz=128", "display_name": "Dr Yuan Shenghai", "link": "https://stackoverflow.com/users/11530294/dr-yuan-shenghai"}, "reply_to_user": {"reputation": 3, "user_id": 11648890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb6f6605b166910d8c27f0e2cee63bb?s=128&d=identicon&r=PG&f=1", "display_name": "jchase34", "link": "https://stackoverflow.com/users/11648890/jchase34"}, "edited": false, "score": 0, "creation_date": 1561382220, "post_id": 56681885, "comment_id": 100033543, "body": "if it works for you, please consider accepting the question and gives a thumbs up"}], "tags": [], "owner": {"reputation": 1609, "user_id": 11530294, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wmx8FmXvssw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddovKe67tDYNr2B-3B5bFJOj8cZg/mo/photo.jpg?sz=128", "display_name": "Dr Yuan Shenghai", "link": "https://stackoverflow.com/users/11530294/dr-yuan-shenghai"}, "is_accepted": true, "score": 0, "last_activity_date": 1561018974, "creation_date": 1561018974, "answer_id": 56681885, "question_id": 56674047, "link": "https://stackoverflow.com/questions/56674047/failed-activation-of-dji-matrice-100-drone/56681885#56681885", "title": "Failed activation of DJI Matrice 100 Drone", "body": "<p>Welcome to the hell of DJI SDK world.  The world of shitty API documentation and bug land. </p>\n\n<p>Based on your error, the link is ok -> as you can see firmware version.</p>\n\n<p>The error is new device error which means you either did not open remote. Or the remote is not connected to Go App or Go App not authorize the API .</p>\n\n<p>Connect everything and power on everything accordinly. </p>\n\n<ol>\n<li>turn on the drone and remote. connect the phone and on Go App.</li>\n</ol>\n\n<p>Make sure that you can see drone position in map. </p>\n\n<ol start=\"2\">\n<li>Once you saw the drone in map in Go App, run sdk.launch.  </li>\n</ol>\n\n<p>Once you do that, the Go App will pop up a <strong>MESSAGE</strong> saying api sth sth xxxxxxxxx , you have to press OK or Confirm.  This is to solve the new device error</p>\n\n<p>Then ctrl-C for the terminal and run sdk.laucnch again.</p>\n\n<p>Also make sure that the sdk.lunch app id is the same account that are login in to the Go App</p>\n\n<p>If first time not working, power cycle again and repeat this 2 step. </p>\n\n<p>The sdk.launch needs to be run at least twice. I know its stupid but it is DJI and it is common. </p>\n\n<p>Also do remember to set up udev rules for your /dev/serial/by-id/usbXXXX  , then set the low latency mode for the serial. Those are all common error you are going to expect as well. </p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 12034863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bWkEb.jpg?s=128&g=1", "display_name": "crisscrosskao", "link": "https://stackoverflow.com/users/12034863/crisscrosskao"}, "is_accepted": false, "score": 0, "last_activity_date": 1567871217, "creation_date": 1567871217, "answer_id": 57835249, "question_id": 56674047, "link": "https://stackoverflow.com/questions/56674047/failed-activation-of-dji-matrice-100-drone/57835249#57835249", "title": "Failed activation of DJI Matrice 100 Drone", "body": "<p>I had the same problem a few days ago and literally went through like 10-20 posts on Stack Overflow, DJI forums, etc. I contacted dev@dji.com and their suggested approach worked for me. Below is the email.</p>\n\n<blockquote>\n  <p>Bruce Cheung (DJI) 6 Sep, 11:22 CST</p>\n  \n  <p>Dear Chris,</p>\n  \n  <p>Thank you for contacting DJI.</p>\n  \n  <p>If have the same error log as before, it doesn't matter the new device\n  is activated. Suggest that you can delete the catkin_ws folder, then\n  git clone DJI OSDK-ROS source code, modify dji_sdk_node.cpp, and do\n  catkin_make. You can provide a new log document if there is any\n  problem again. Good luck with your project.</p>\n  \n  <p>Thank you for your understanding and support, hope you have a nice\n  day.</p>\n  \n  <p>Best Regards, DJI SDK Support Team</p>\n</blockquote>\n\n<p>My reply after it worked:</p>\n\n<blockquote>\n  <p>Thank you, I took your advice and it worked.</p>\n  \n  <p>I deleted the folders, did catkin_make. This time I made a 2nd Onboard\n  SDK project at developer.dji.com and used that one instead. My first\n  one had been activated on the same computer but through the Linux (not\n  ROS sdk). Not sure if that makes a difference. It works now.</p>\n  \n  <p>Chris</p>\n</blockquote>\n\n<p>I'm really not sure why removing and then uninstalling worked, as I had literally just added a new install the day or two before. But guess it worked. I also made a 2nd API key but according to DJI that wasn't the reason why it worked.</p>\n"}], "owner": {"reputation": 3, "user_id": 11648890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb6f6605b166910d8c27f0e2cee63bb?s=128&d=identicon&r=PG&f=1", "display_name": "jchase34", "link": "https://stackoverflow.com/users/11648890/jchase34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 56681885, "answer_count": 2, "score": -1, "last_activity_date": 1567871217, "creation_date": 1560969966, "question_id": 56674047, "link": "https://stackoverflow.com/questions/56674047/failed-activation-of-dji-matrice-100-drone", "title": "Failed activation of DJI Matrice 100 Drone", "body": "<p>I am trying to run a sample application for the Matrice 100 by using ROS on a raspberry Pi 2.I have the Pi connected to the drone via USB-TTL cable to the UART port on the drone. I have my laptop connected to the drone running DJI Assistant 2, and the controller and my iPhone connected wirelessly to the drone as well through the DJI Go App(v3.1.54). All are connected to the internet and logged into my respective developer account for DJI. However, when I run \"roslaunch dji_sdk sdk.launch\" I am returned an error saying the drone is not activated. </p>\n\n<p>I have enable API access from DJI Assistant 2, I've made sure the the TX and RX pins are connected correctly, and I have changed my sdk.launch file  to have the correct App ID and Key. Ive noticed in other posts that they say to edit the UserConfig.txt file for App ID, Key, and BaudRate; however, I could not locate this file on my Pi(it doesn't exist). Just the sdk.launch file which I correctly changed these settings to fit my application and drone. </p>\n\n<pre><code>STATUS/1 @ init, L55: attempting to open device /dev/ttyUSB0 with     baudrate 230400...\nSTATUS/1 @ init, L65: ...serial started successfully.\nSTATUS/1 @ parseDroneVersionInfo, L727: device Serial No. = 041DF31901\nSTATUS/1 @ parseDroneVersionInfo, L729: Hardware = M100\nSTATUS/1 @ parseDroneVersionInfo, L730: Firmware = 3.1.10.0\nSTATUS/1 @ parseDroneVersionInfo, L733: Version CRC = 0xA6453AAC\nSTATUS/1 @ initSubscriber, L778: Telemetry subscription mechanism is not   supported on this platform!\nSTATUS/1 @ initMFIO, L981: MFIO is not supported on this platform!\nSTATUS/1 @ initHardSync, L1077: Hardware sync is not supported on this platform!\nSTATUS/1 @ activate, L1313: version 0x3010A00\nSTATUS/1 @ getErrorCodeMessage, L656: activate\nSTATUS/1 @ getCMDSetActivationMSG, L705: NEW_DEVICE_ERROR\n\nERRORLOG/1 @ activate, L1339: Failed to activate please retry SET 0x0 ID 0x1 code 0x3\n\nERRORLOG/1 @ activate, L1346: Solutions for NEW_DEVICE_ERROR\n   *Double check your app_id and app_key in UserConfig.txt. Does is match with your DJI developer account?\n   *If this is a new device, you need to activate it through the App or DJI assistant 2 with internet\n   For different aircraft, the App and the version of DJI Assistant 2 might be different, \n   For A3, N3, M600/Pro and M100, please use DJI Go App\n   For DJI Assistant 2, it's available on the download tab of the product page\n   *If this device is previously activated with another app_id and app_key, you will need to reactivate it again\n   *A new device needs to be activated twice to fix the NEW_DEVICE_ERROR, so please try it twice.\n\n[ERROR] [1560967071.851508645]: drone activation error\n[ERROR] [1560967071.851845364]: Vehicle initialization failed\n</code></pre>\n\n<p>I checked the app_id and app_key in the sdk.launch file and they are the same as on my app on DJI website. Still unable to find file \"UserConfig.txt\". I don't see where to activate a device on the DJI Go App after it is already connected to the vehicle via the controller. For DJI Assistant 2, I cannot find the download tab or where/how to activate the drone for OSDK via my laptop as well. I don't believe it was activated with another app_id and key considering it is very new. So this is where Im stuck, and would like to run a sample app on the drone. Any ideas on how to fix this issue?</p>\n"}, {"tags": ["c", "linux", "linker", "elf", "dynamic-loading"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1560968267, "post_id": 56673637, "comment_id": 99914659, "body": "<code>LD_PRELOAD=libsubb.so</code>. Also see <a href=\"https://stackoverflow.com/q/426230/608639\">What is the LD_PRELOAD trick?</a> and <a href=\"https://linux.die.net/man/8/ld-linux\" rel=\"nofollow noreferrer\"><code>ld.so(8)</code></a> man page."}, {"owner": {"reputation": 195, "user_id": 4978236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8138329de72ecf5cbe0436007aa4d86a?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4978236/john-doe"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1560968436, "post_id": 56673637, "comment_id": 99914725, "body": "It forces the <code>common</code> function to be the one from <code>libsubb.so</code>. I would like <code>func_a</code> to use the <code>common</code> function from <code>libsuba.so</code> and <code>func_b</code> the one from <code>libsubb.so</code>."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 4978236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8138329de72ecf5cbe0436007aa4d86a?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4978236/john-doe"}, "edited": false, "score": 0, "creation_date": 1561048316, "post_id": 56687860, "comment_id": 99946134, "body": "<code>objcopy</code> indeed seem to update only <code>.symtab</code> and not <code>.dynsym</code>. I reported the issue and in the meantime, I will try to load one of the two libraries using <code>dlsym()</code> and <code>RTLD_LOCAL</code> hoping that the lookup scopes are different (they are according to dsohowto.pdf)."}], "tags": [], "owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "is_accepted": true, "score": 1, "last_activity_date": 1561039824, "creation_date": 1561039824, "answer_id": 56687860, "question_id": 56673637, "link": "https://stackoverflow.com/questions/56673637/symbol-conflict-in-transitive-dependencies-of-two-dynamic-libraries/56687860#56687860", "title": "Symbol conflict in transitive dependencies of two dynamic libraries", "body": "<p>You should report the issue to the respective vendors of those libraries. I think they are missing namespaces for exported symbols (for sure, if <code>libsuba</code> and <code>libsubb</code> both export a symbol called \"common\").</p>\n\n<p>Have you thought about using <code>objcopy --redefine-sym</code> (see <a href=\"https://stackoverflow.com/a/678375/2104472\">this answer</a>)? However, objcopy does not seem to modify the dynamic symbol talbe, rendering this approach useless :(</p>\n"}], "owner": {"reputation": 195, "user_id": 4978236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8138329de72ecf5cbe0436007aa4d86a?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4978236/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 56687860, "answer_count": 1, "score": 0, "last_activity_date": 1561039824, "creation_date": 1560968189, "last_edit_date": 1560968565, "question_id": 56673637, "link": "https://stackoverflow.com/questions/56673637/symbol-conflict-in-transitive-dependencies-of-two-dynamic-libraries", "title": "Symbol conflict in transitive dependencies of two dynamic libraries", "body": "<p>I am using two third party dynamic libraries: <code>liba.so</code> and <code>libb.so</code>. They both call a function named <code>common</code> included in another dynamic library, but <code>liba.so</code> should use the one from <code>libsuba.so</code> while <code>libb.so</code> the one from <code>libsubb.so</code>.</p>\n\n<p>I have no access to the source code of these dynamic libraries and I am thus unable to change the function name of one library and recompile it to resolve the conflict.</p>\n\n<p>I am aware that macOS provides a two level namespace that seems to solve the issue, but I didn't found anything similar in <code>ld</code> man pages.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// exe.c\nextern void func_a(void);\nextern void func_b(void);\n\nvoid main(void) {\n    func_a();\n    func_b();\n}\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>// lib(a|b).c\nextern void common(void);\n\nvoid func_(a|b)(void) {\n    common();\n}\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>// libsub(a|b).c\n#include &lt;stdio.h&gt;\n\nvoid common(void) {\n    printf(\"Common (A|B)\\n\");\n}\n</code></pre>\n\n<pre><code>all: exe\n\nexe: exe.c liba.so libb.so\n    gcc -L. -Wl,-rpath=. -o $@ $&lt; -la -lb\n\nliba.so: liba.c libsuba.so\n    gcc -shared -fPIC -Wl,-rpath=. -L. -o $@ $&lt; -lsuba\n\nlibb.so: libb.c libsubb.so\n    gcc -shared -fPIC -Wl,-rpath=. -L. -o $@ $&lt; -lsubb\n\nlibsub%.so: libsub%.c\n    gcc -shared -fPIC -o $@ $&lt;\n</code></pre>\n\n<p>Is there any way to solve this issue?</p>\n\n<p>Edit: The current output value is:</p>\n\n<pre><code>$ ./exe \nCommon A\nCommon A\n</code></pre>\n\n<p>and I would like the output to be:</p>\n\n<pre><code>$ ./exe \nCommon A\nCommon B\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 0, "creation_date": 1560968477, "post_id": 56673604, "comment_id": 99914741, "body": "try: <code>int_copy(&amp;A[0], &amp;B[0], 3);</code>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1560968505, "post_id": 56673604, "comment_id": 99914760, "body": "...or <code>int_copy(A, B, 3);</code>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1560968837, "post_id": 56673604, "comment_id": 99914901, "body": "Yep, <code>A</code> is a pointer to int, <code>&amp;A</code> is a pointer to array of 4 ints."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1560969107, "post_id": 56673604, "comment_id": 99915029, "body": "@LeeDanielCrocker Actually, <code>A</code> is an array of four ints; it <i>decays</i> to a pointer when used in a context where a pointer is required..."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7420107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2230e0ad3ce79ead7200d24adf7ada3?s=128&d=identicon&r=PG&f=1", "display_name": "bman", "link": "https://stackoverflow.com/users/7420107/bman"}, "edited": false, "score": 0, "creation_date": 1560969364, "post_id": 56673820, "comment_id": 99915162, "body": "I made the changes and it worked, but im a little confused with  ``` i &lt; sizeof(A)/sizeof(*A);` ``` why are you dividing sizeof(A) with sizeof(*A)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 19, "user_id": 7420107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2230e0ad3ce79ead7200d24adf7ada3?s=128&d=identicon&r=PG&f=1", "display_name": "bman", "link": "https://stackoverflow.com/users/7420107/bman"}, "edited": false, "score": 0, "creation_date": 1560969590, "post_id": 56673820, "comment_id": 99915275, "body": "@bman <code>sizeof(whatever)</code> gives you the size of the object in question, whatever it is (struct, array, pointer, ...), in <i>bytes</i> \u2013 but you want to get the number of elements. So for arrays you divide the total size in bytes by the number of bytes of one single element. In your concrete case, assuming <code>int</code> having four bytes (this is not <i>necessarily</i> the case!): <code>sizeof(A)</code> is 16, <code>sizeof(*A)</code> is the size of <code>A</code>&#39;s first element, i. e. an <code>int</code>, i. e. 4, so final result is <code>16&#47;4 == 4</code>. Some prefer the variant <code>sizeof(A)&#47;sizeof(A[0])</code>, but that&#39;s equivalent..."}, {"owner": {"reputation": 19, "user_id": 7420107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2230e0ad3ce79ead7200d24adf7ada3?s=128&d=identicon&r=PG&f=1", "display_name": "bman", "link": "https://stackoverflow.com/users/7420107/bman"}, "edited": false, "score": 0, "creation_date": 1560970293, "post_id": 56673820, "comment_id": 99915611, "body": "In the line     for(size_t i = 0; i &lt; sizeof(A)/sizeof(*A); ++i)   I changed i &lt; sizeof(A) to i &lt; sizeof(&amp;A) and it now only printed the first two integers. Does using &amp; before A make it 8 bytes?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 19, "user_id": 7420107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2230e0ad3ce79ead7200d24adf7ada3?s=128&d=identicon&r=PG&f=1", "display_name": "bman", "link": "https://stackoverflow.com/users/7420107/bman"}, "edited": false, "score": 0, "creation_date": 1560970564, "post_id": 56673820, "comment_id": 99915724, "body": "No, it doesn&#39;t change <code>A</code> at all. <code>&amp;A</code> produces a <i>pointer</i> (have a look at my answer again for exact type...), so you get the size of a pointer (as if you did <code>sizeof(void*)</code>), which obviously is eight bytes on <i>your</i> system (again this can differ...). And can differ by far from the size of the original array..."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1560968987, "creation_date": 1560968987, "answer_id": 56673820, "question_id": 56673604, "link": "https://stackoverflow.com/questions/56673604/how-can-i-write-a-function-to-copy-an-array-of-items-for-some-defined-number-of/56673820#56673820", "title": "How can I write a function to copy an array of items for some defined number of items to copy", "body": "<p>The point is: arrays decay to pointers to their first element automatically, if passed to functions. So you just call your function like</p>\n\n<pre><code>int_copy(A, B, 3);\n</code></pre>\n\n<p>Taking the address of an array <em>is</em> possible, and as arrays and their first element <em>always</em> share the same address, will yield the same numerical value. but the type of pointer differs, it won't be a pointer to int, it will be a pointer to int-array of length 4:</p>\n\n<pre><code>int(*pointer)[4] = &amp;A;\n</code></pre>\n\n<p>Syntax is ugly, I know...</p>\n\n<blockquote>\n  <p>I want to output 6,7,8,4 for array A</p>\n</blockquote>\n\n<p>Suppose that's why you took a backup copy of <code>ptrA</code> first? Solely, you don't use it...</p>\n\n<pre><code>printf(\"%d\\n\", *ptrA);\nprintf(\"%d\\n\", *ptrB);\n</code></pre>\n\n<p>These two statements will only print one single integer each, the ones the two pointers point to. As you advanced both of them by 3 already in your loop, they will print out\n<code>4</code> and <code>9</code>.</p>\n\n<p>You'd need to use your backup pointer <code>p</code> and iterate in another loop over exactly four elements. Solely: your copy function cannot know about how many array elements there are. Printing this way might be possible under some constraints, but it is dangerous code. Imagine what happened if you passed a pointer to somewhere in the middle of the array (-> undefined behaviour due to reading beyond array bounds!).</p>\n\n<p>The safe way would be not to print in the called function, but rather:</p>\n\n<pre><code>int main(void)\n{\n    int_copy(&amp;A, &amp;B, 3);\n    for(size_t i = 0; i &lt; sizeof(A)/sizeof(*A); ++i)\n        printf(\"%d \", A[i]);\n}\n</code></pre>\n\n<p>Finally: you don't need to explicitly <code>return</code> in void functions (only if you want to exit prematurely...).</p>\n"}, {"comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1560969243, "post_id": 56673857, "comment_id": 99915094, "body": "RE the last bullet point: in this case, OP passes <code>nbr = 3</code> and the array length is <code>4</code> so the <code>printf</code> statements are ok."}, {"owner": {"reputation": 19, "user_id": 7420107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2230e0ad3ce79ead7200d24adf7ada3?s=128&d=identicon&r=PG&f=1", "display_name": "bman", "link": "https://stackoverflow.com/users/7420107/bman"}, "edited": false, "score": 0, "creation_date": 1560969915, "post_id": 56673857, "comment_id": 99915438, "body": "In void print for const int *p / when you call int print in main and have A in the position of const int *p, is p now pointing to the array A"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1560969141, "creation_date": 1560969141, "answer_id": 56673857, "question_id": 56673604, "link": "https://stackoverflow.com/questions/56673604/how-can-i-write-a-function-to-copy-an-array-of-items-for-some-defined-number-of/56673857#56673857", "title": "How can I write a function to copy an array of items for some defined number of items to copy", "body": "<p>Here are some problems in your code:</p>\n\n<ul>\n<li><p>you should define or at least declare function <code>int_copy</code> before calling it.</p></li>\n<li><p>You should pass pointers to the array contents to <code>int_copy</code>, which is done by passing pointers to the first elements of the arrays: <code>int_copy(&amp;A[0], &amp;B[0], 3);</code> which can be simplified as <code>int_copy(A, B, 3);</code></p></li>\n<li><p>In <code>int_copy</code>, you increment both pointers in the loop, which is fine, but you should not try and access the element they point to at the end of the loop as the point just past the end of the arrays, so reading these values has undefined behavior.</p></li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int A[] = { 1, 2, 3, 4 };\nint B[] = { 6, 7, 8, 9 };\n\nvoid int_copy(int *ptrA, int *ptrB, int nbr) {\n    for (int i = 0; i &lt; nbr; i++) {\n        *ptrA++ = *ptrB++;\n    }\n}\n\nvoid int_print(const char *msg, const int *p, int nbr) {\n    printf(\"%s:\", msg);\n    for (int i = 0; i &lt; nbr; i++) {\n        printf(\" %d\", p[i]);\n    }\n    printf(\"\\n\");\n}\n\nint main(void) {\n    int_print(\"before copy\", A, 4);\n    int_copy(A, B, 3);\n    int_print(\"after copy\", A, 4);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7420107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2230e0ad3ce79ead7200d24adf7ada3?s=128&d=identicon&r=PG&f=1", "display_name": "bman", "link": "https://stackoverflow.com/users/7420107/bman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1560969957, "creation_date": 1560968060, "last_edit_date": 1560969957, "question_id": 56673604, "link": "https://stackoverflow.com/questions/56673604/how-can-i-write-a-function-to-copy-an-array-of-items-for-some-defined-number-of", "title": "How can I write a function to copy an array of items for some defined number of items to copy", "body": "<p>Im trying to learn how to use pointers and want to write a function where I have two arrays of integers and want to copy an array of integers for a specific number(nbr) of integers to copy.</p>\n\n<pre><code>int A[]= {1,2,3,4};\nint B[] = {6,7,8,9};\n\nint main(void)\n{\n    int_copy(&amp;A, &amp;B, 3);\n}\n\nvoid int_copy(int *ptrA, int *ptrB, int nbr)\n{\n    int * p = ptrA;\n    for (int i = 0; i&lt;nbr; i++)\n    {\n        *ptrA++ = *ptrB++;\n    }\n\n    printf(\"%d\\n\", *ptrA);\n    printf(\"%d\\n\", *ptrB);\n\n    return;\n}\n</code></pre>\n\n<p>I want to output 6,7,8,4 for array A, but i get the following error messages:</p>\n\n<pre><code>intcopy.c:10:14: warning: incompatible pointer types passing 'int (*)[4]' to parameter of type 'int *' [-Wincompatible-pointer-types]\n    int_copy(&amp;A, &amp;B, 3);\n             ^~\n\nintcopy.c:6:20: note: passing argument to parameter 'ptrA' here\nvoid int_copy(int *ptrA, int *ptrB, int nbr);\n                   ^\n\nintcopy.c:10:18: warning: incompatible pointer types passing 'int (*)[4]' to parameter of type 'int *' [-Wincompatible-pointer-types]\n    int_copy(&amp;A, &amp;B, 3);\n                 ^~\n\nintcopy.c:6:31: note: passing argument to parameter 'ptrB' here\nvoid int_copy(int *ptrA, int *ptrB, int nbr);\n                              ^\n</code></pre>\n"}, {"tags": ["c", "linux", "system-calls"], "comments": [{"owner": {"reputation": 1256, "user_id": 3717691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e31f2eebcaa93d53b27abaf149df957?s=128&d=identicon&r=PG&f=1", "display_name": "Jeppe", "link": "https://stackoverflow.com/users/3717691/jeppe"}, "edited": false, "score": 1, "creation_date": 1560967299, "post_id": 56673439, "comment_id": 99914248, "body": "Your title is very different from your question - could you elaborate?"}, {"owner": {"reputation": 99, "user_id": 11385838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xoXUtYRTYo0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resbs7bRF5B4D2sgiIbuHM9JxSfYg/mo/photo.jpg?sz=128", "display_name": "Ramsey Alsheikh", "link": "https://stackoverflow.com/users/11385838/ramsey-alsheikh"}, "reply_to_user": {"reputation": 1256, "user_id": 3717691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e31f2eebcaa93d53b27abaf149df957?s=128&d=identicon&r=PG&f=1", "display_name": "Jeppe", "link": "https://stackoverflow.com/users/3717691/jeppe"}, "edited": false, "score": 0, "creation_date": 1560967388, "post_id": 56673439, "comment_id": 99914288, "body": "Fixed. Sorry about that!"}, {"owner": {"reputation": 1256, "user_id": 3717691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e31f2eebcaa93d53b27abaf149df957?s=128&d=identicon&r=PG&f=1", "display_name": "Jeppe", "link": "https://stackoverflow.com/users/3717691/jeppe"}, "edited": false, "score": 0, "creation_date": 1560967543, "post_id": 56673439, "comment_id": 99914344, "body": "You could check this thread, which appears to duplicate your question a bit: <a href=\"https://stackoverflow.com/questions/10509660/getting-getrusage-to-measure-system-time-in-c\">getting-getrusage-to-measure-system-time-in-c</a> You can also check documentations for <code>getrusage</code>, e.g <a href=\"http://man7.org/linux/man-pages/man2/getrusage.2.html\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 3193, "user_id": 2694511, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2e9aw.png?s=128&g=1", "display_name": "Spencer D", "link": "https://stackoverflow.com/users/2694511/spencer-d"}, "edited": false, "score": 0, "creation_date": 1560968079, "post_id": 56673439, "comment_id": 99914577, "body": "<a href=\"http://man7.org/linux/man-pages/man2/syscall.2.html\" rel=\"nofollow noreferrer\"><code>man syscall</code></a>? The man page even includes sample code for making system calls. That said, wrapper functions are generally considered the preferred approach (e.g., calling the <code>getrusage(...)</code> function rather than making a direct syscall)."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "reply_to_user": {"reputation": 3193, "user_id": 2694511, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2e9aw.png?s=128&g=1", "display_name": "Spencer D", "link": "https://stackoverflow.com/users/2694511/spencer-d"}, "edited": false, "score": 3, "creation_date": 1560969789, "post_id": 56673439, "comment_id": 99915373, "body": "@SpencerD: <code>syscall</code> is for making system calls from user space."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1560982511, "post_id": 56673439, "comment_id": 99920166, "body": "Take a look in the file <code>kernel&#47;sys.c</code>.  Search for &quot;getrusage&quot;.  Those are the kernel functions that implement (among other things) the <code>getrusage</code> system call.  Since you&#39;re in the kernel, you should be able to just call any of those functions directly."}, {"owner": {"reputation": 3193, "user_id": 2694511, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2e9aw.png?s=128&g=1", "display_name": "Spencer D", "link": "https://stackoverflow.com/users/2694511/spencer-d"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1561064458, "post_id": 56673439, "comment_id": 99952837, "body": "@NateEldredge, thank you for the clarification. +1"}], "answers": [{"comments": [{"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1561070677, "post_id": 56675330, "comment_id": 99954622, "body": "I wonder though - <code>getrusage</code> takes a pointer to a buffer to be filled in.  The corresponding function in the syscall table, <code>sys_getrusage</code> or whatever, is going to be expecting a pointer to userspace memory.  Will it still work, on all architectures, if you pass a pointer to kernel memory?"}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1561082548, "post_id": 56675330, "comment_id": 99956871, "body": "@NateEldredge: I have no idea how Linux does it. Myself (at least for 64-bit 80x86 where there&#39;s a huge number of registers); kernel would shove all the data into registers and return to user-space, and let the user-space library&#39;s <code>getrusage</code> code unpack the data from registers into the caller&#39;s buffer (so that the kernel doesn&#39;t have to do all the sanity checks/validation of the library function&#39;s caller&#39;s buffer). Linux is probably &quot;more generic&quot; though."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1561082728, "post_id": 56675330, "comment_id": 99956898, "body": "@NateEldredge: Of course if the kernel&#39;s internal <code>getrusage()</code> is only usable from user-space (e.g. uses a buffer from user-space) there might be a different function that obtains the data (e.g. a <code>getrusage_internal()</code> that doesn&#39;t do any checks on the buffer, which is called by <code>getrusage()</code> after it does the checks). Also; it&#39;s likely that  there&#39;s a &quot;process structure&quot; (for each process) that contains the same data, and all code in the kernel can access these structures directly (without bothering with any <code>getrusage()</code> wrapper bloat), so trying to use <code>getrusage()</code> is a mistake anyway."}], "tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 2, "last_activity_date": 1560975827, "creation_date": 1560975827, "answer_id": 56675330, "question_id": 56673439, "link": "https://stackoverflow.com/questions/56673439/how-to-call-system-call-from-kernel/56675330#56675330", "title": "How to call system call from kernel?", "body": "<blockquote>\n  <p>How to call system call from kernel?</p>\n</blockquote>\n\n<p>You don't. It doesn't even make sense. It's like asking \"How do I enter my house when I'm already inside my house?\".</p>\n\n<p>In the kernel there's a whole bunch of functions. Some of them are added to the system call table and some aren't; but if you're already in the kernel you can use them without caring if they were added to the system call table or not. Note that if you're writing a kernel module then it ends up being dynamic linking done when the module is loaded (a bit like the kernel is a shared library).</p>\n"}], "owner": {"reputation": 99, "user_id": 11385838, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xoXUtYRTYo0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resbs7bRF5B4D2sgiIbuHM9JxSfYg/mo/photo.jpg?sz=128", "display_name": "Ramsey Alsheikh", "link": "https://stackoverflow.com/users/11385838/ramsey-alsheikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560975827, "creation_date": 1560967202, "last_edit_date": 1560968418, "question_id": 56673439, "link": "https://stackoverflow.com/questions/56673439/how-to-call-system-call-from-kernel", "title": "How to call system call from kernel?", "body": "<p>I'm trying to invoke the <code>getrusage()</code> system call from kernel space, but I don't know how.</p>\n\n<p>I read about getting the kernel export (<a href=\"https://stackoverflow.com/questions/15841327/can-we-call-system-call-in-kernel-space\">Can we call system call in kernel space?</a>), but I don't know what that is or how to use it. Could someone show me how to call a system call from the kernel in C?</p>\n\n<p>Edit: The old title was for a draft of a question, sorry!</p>\n"}, {"tags": ["c", "struct", "function-pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1560966941, "post_id": 56673325, "comment_id": 99914069, "body": "Please try to create a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that replicates the problem, and show it to us. The code you show doesn&#39;t match the error you get. And please include a <i>full</i> and <i>complete</i> copy-paste of the build output of that example. Also please refresh <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 125, "user_id": 11034353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea82766211a6ead85242533fe388e630?s=128&d=identicon&r=PG&f=1", "display_name": "L_Cleo", "link": "https://stackoverflow.com/users/11034353/l-cleo"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1560967688, "post_id": 56673325, "comment_id": 99914415, "body": "@Someprogrammerdude sorry for that... I was making one but I got the answer from Sean Bright before I could finish it. Thanks anyways"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 11034353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea82766211a6ead85242533fe388e630?s=128&d=identicon&r=PG&f=1", "display_name": "L_Cleo", "link": "https://stackoverflow.com/users/11034353/l-cleo"}, "edited": false, "score": 0, "creation_date": 1560967745, "post_id": 56673389, "comment_id": 99914438, "body": "Thanks, this solved the problem. But if it&#39;s so long, what are the advantages of using the pointer functions? Isn&#39;t it the same defining a function with the struct type param and then calling it by her self?"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 125, "user_id": 11034353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea82766211a6ead85242533fe388e630?s=128&d=identicon&r=PG&f=1", "display_name": "L_Cleo", "link": "https://stackoverflow.com/users/11034353/l-cleo"}, "edited": false, "score": 2, "creation_date": 1560970598, "post_id": 56673389, "comment_id": 99915737, "body": "@L_Cleo If you&#39;re always calling the same function, yes, but function pointers allow you to call different functions based on data. One could have <code>area</code> functions for squares and circles, too, and keep the same interface."}, {"owner": {"reputation": 125, "user_id": 11034353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea82766211a6ead85242533fe388e630?s=128&d=identicon&r=PG&f=1", "display_name": "L_Cleo", "link": "https://stackoverflow.com/users/11034353/l-cleo"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1560983356, "post_id": 56673389, "comment_id": 99920375, "body": "@NeilEdelman Ok, well then I guess I would have to make a sample program that really would see those pointer functions as more convenient than the simple function definition. Thanks"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1561319441, "post_id": 56673389, "comment_id": 100014385, "body": "See <a href=\"https://stackoverflow.com/questions/12971995/how-pointers-to-function-as-struct-member-useful-in-c\" title=\"how pointers to function as struct member useful in c\">stackoverflow.com/questions/12971995/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/351733/can-you-write-object-oriented-code-in-c\" title=\"can you write object oriented code in c\">stackoverflow.com/questions/351733/&hellip;</a> and the Wikipedia article has some examples, <a href=\"https://en.wikipedia.org/wiki/Function_pointer\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Function_pointer</a>."}], "tags": [], "owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "is_accepted": true, "score": 4, "last_activity_date": 1560966912, "creation_date": 1560966912, "answer_id": 56673389, "question_id": 56673325, "link": "https://stackoverflow.com/questions/56673325/defining-a-pointer-function-inside-a-struct/56673389#56673389", "title": "Defining a pointer function inside a struct", "body": "<p>If <code>array</code> is an array of <code>Parallelogram</code>s:</p>\n\n<pre><code>printf(\"Area = %.2f\", array[i].areaFunc(array[i].base, array[i].upperR, array[i].lowerL));\n</code></pre>\n\n<p>Your current code is trying to print out a function pointer as a floating point number, which is obviously wrong. You need to <em>call</em> the function that is being pointed to.</p>\n"}], "owner": {"reputation": 125, "user_id": 11034353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea82766211a6ead85242533fe388e630?s=128&d=identicon&r=PG&f=1", "display_name": "L_Cleo", "link": "https://stackoverflow.com/users/11034353/l-cleo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56673389, "answer_count": 1, "score": 0, "last_activity_date": 1560966912, "creation_date": 1560966593, "question_id": 56673325, "link": "https://stackoverflow.com/questions/56673325/defining-a-pointer-function-inside-a-struct", "title": "Defining a pointer function inside a struct", "body": "<p>So I was trying to accomplish to write a struct with pointer functions in it and this is what I wrote</p>\n\n<pre><code>typedef struct Coordinates {\n    float x; \n    float y;\n} Coord;\n\ntypedef struct Parallelograms {\n        Coord upperR, lowerL;\n        float base;\n        float (*areaFunc)(float base, Coord upperR, Coord lowerL);\n        float (*perimeter)(float base, Coord upperR, Coord lowerL);\n} Parallelogram;\n</code></pre>\n\n<p>This is where I define the function:</p>\n\n<pre><code>float area(float base, Coord upperR, Coord lowerL) {\n    return (base*(upperR.y-lowerL.y));\n}\n</code></pre>\n\n<p>And then in some other function I call it this way:</p>\n\n<pre><code>Parallelogram para;   \npara.areaFunc = area;\n</code></pre>\n\n<p>The only thing is that when I try to print it</p>\n\n<pre><code>printf(\"Area = %.2f\", array[i].area);\n</code></pre>\n\n<p>(with array being the array of Parallelogram type of objects)\nIt returns this error when compiling:</p>\n\n<blockquote>\n  <p>format specifies type 'double' but the argument\n        has type 'float (<em>)(float, Coord, Coord)' (aka 'float (</em>)(float, struct\n        Coordinates, struct Coordinates)') [-Werror,-Wformat]\n    ...printf(\"#  Area = %.2f                  #\\n\", array[I].areaFunc);</p>\n</blockquote>\n\n<p>I thought I got the pointer functions right, so how can I convert the pointer function to the actual value that it should return?</p>\n"}, {"tags": ["c", "algorithm", "optimization"], "comments": [{"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1560964983, "post_id": 56672944, "comment_id": 99913159, "body": "I believe the right place for such questions is <a href=\"https://codereview.stackexchange.com/\">Code Review</a>."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1560965021, "post_id": 56672944, "comment_id": 99913179, "body": "@HristoIliev Not if the validity of the code is in question."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1560965052, "post_id": 56672944, "comment_id": 99913193, "body": "You should probably learn about <a href=\"https://en.wikipedia.org/wiki/Dynamic_programming\" rel=\"nofollow noreferrer\"><i>dynamic programming</i></a>. You do a lot of calculations many many times. If the result of those calculations could be &quot;cached&quot; or &quot;remembered&quot; you don&#39;t need to calculate them again, making the program more effective."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 5, "creation_date": 1560965059, "post_id": 56672944, "comment_id": 99913199, "body": "Note how in <code>is_prime</code> you keep looping even once you know it&#39;s not prime. <code>return false</code> in the loop in place of <code>flag = false</code> will be much faster. You can also check to the square root of <code>num</code> instead of <code>num&#47;2</code>, which is <i>much</i> faster for larger numbers."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1560965416, "post_id": 56672944, "comment_id": 99913365, "body": "For reference, here&#39;s what I used when I solved this. It&#39;s bad, has a few ugly edge cases, and was never meant to see the light of day, but oh well. <a href=\"https://gist.github.com/carcigenicate/56bf2dd9e1d5af780b2fc61bb98ffeb2\" rel=\"nofollow noreferrer\">gist.github.com/carcigenicate/56bf2dd9e1d5af780b2fc61bb98ffe&zwnj;&#8203;b2</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560965679, "post_id": 56672944, "comment_id": 99913477, "body": "Just counting to 600 billion will take forever. So you need an entirely different approach. Starting from 600851475143 and working backwards would be a minor improvement. After all, you <i>are</i> looking for the <i>largest</i> prime factor. But the real solution requires that you think about how the math works. I&#39;ll give a couple examples.  A) 14=2*7.  B) 220=2*110 and 110=2*55 and 55=5*11."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1560965889, "post_id": 56672944, "comment_id": 99913577, "body": "You need to learn group theory to be able to solve this in realistic time.  Also, you should read about memoization  <a href=\"https://en.wikipedia.org/wiki/Memoization\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Memoization</a>."}, {"owner": {"reputation": 41, "user_id": 7186129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b957adbff504d5e32c173eb766b74f4?s=128&d=identicon&r=PG&f=1", "display_name": "DuckHunterZx", "link": "https://stackoverflow.com/users/7186129/duckhunterzx"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1560967806, "post_id": 56672944, "comment_id": 99914460, "body": "@Someprogrammerdude Ah, yes, I know how to implement a couple of dynamic structures, such as binary trees and such, but I&#39;ve never actually used them to cache anything. I will certainly look into it though. Thanks for the tip."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560967989, "post_id": 56672944, "comment_id": 99914542, "body": "@everyone The solution to this problem is literally five lines of C code. You don&#39;t need dynamic programming, memoization, or group theory (rofl). You don&#39;t even need a list of primes or an <code>is_prime</code> function."}, {"owner": {"reputation": 41, "user_id": 7186129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b957adbff504d5e32c173eb766b74f4?s=128&d=identicon&r=PG&f=1", "display_name": "DuckHunterZx", "link": "https://stackoverflow.com/users/7186129/duckhunterzx"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1560968125, "post_id": 56672944, "comment_id": 99914595, "body": "@Carcigenicate Thanks for the tips, i&#39;ll be sure to try them. I&#39;ll look at your answer after i&#39;ve solved this though."}, {"owner": {"reputation": 41, "user_id": 7186129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b957adbff504d5e32c173eb766b74f4?s=128&d=identicon&r=PG&f=1", "display_name": "DuckHunterZx", "link": "https://stackoverflow.com/users/7186129/duckhunterzx"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560968303, "post_id": 56672944, "comment_id": 99914670, "body": "@user3386109 Although I appreciate learning the underlying math and solutions, it is not practical to learn a whole branch of mathematics for problem #3 (not just yet anyway), but I think i&#39;ll encounter it in uni and i feel good about that. I&#39;ll try to figure out your hints."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560968853, "post_id": 56672944, "comment_id": 99914909, "body": "@DuckHunterZx My whole point is that you <b>don&#39;t</b> need to learn any mathematics that you don&#39;t already know. That&#39;s why I&#39;m laughing at the absurd notion that you need to know group theory to solve this. You also <b>don&#39;t</b> need to know any advanced programming techniques like dynamic programming or memoization. This is Euler #3 after all. <b>The hints contain the answer.</b> (Note: Ignore the part about counting backwards. That was just an optimization for your current solution. Counting backwards is not part of the actual solution.)"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1560969872, "post_id": 56672944, "comment_id": 99915408, "body": "@DuckHunterZx It&#39;s basically the same idea as yours just with a few tweaks to speed up prime finding"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1560970239, "post_id": 56672944, "comment_id": 99915588, "body": "@Carcigenicate You do not need an <code>is_prime</code> function, or a list of primes, to solve this problem."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560970398, "post_id": 56672944, "comment_id": 99915660, "body": "@user3386109 Well, you need to know if a number is prime or not, so at the very least you need the same code that would be contained in a theoretical <code>is_prime</code> function. Whether or not you break that code off into its own function though is a matter of taste, and idk if I&#39;d be encouraging people to avoid making their code modular; even if it isn&#39;t necessary here."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1560970591, "post_id": 56672944, "comment_id": 99915734, "body": "@Carcigenicate The smallest factor of a number <b>is</b> a prime. You don&#39;t need to check if it is a prime."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560971179, "post_id": 56672944, "comment_id": 99915985, "body": "@user3386109 The problem is finding the largest prime factor. How would knowing that the smallest factor is prime help?"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1560971787, "post_id": 56672944, "comment_id": 99916275, "body": "@Carcigenicate How I solved it is when a &quot;small&quot; factor is found then divide the large value by that factor. As the factors get larger the value gets smaller and when they meet what is left is the largest factor. <a href=\"http://coliru.stacked-crooked.com/a/17ebac9bac81e4bc\" rel=\"nofollow noreferrer\">This code finds the answer in the blink of an eye.</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1560971837, "post_id": 56672944, "comment_id": 99916291, "body": "@Carcigenicate Take 14 for example. The smallest factor of 14 must be less than or equal to <code>floor(sqrt(14) ) = 3</code>. And in fact the smallest factor of 14 is 2. Divide 14 by 2 to get 7. The smallest factor of 7 must be less than or equal to <code>floor(sqrt(7)) = 2</code>. But 7 doesn&#39;t have any factors &lt;= 2, so 7 is the answer."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560971888, "post_id": 56672944, "comment_id": 99916313, "body": "@user3386109 Ya, I just looked up solutions to find an explanation. Ya, that would be more efficient."}, {"owner": {"reputation": 41, "user_id": 7186129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b957adbff504d5e32c173eb766b74f4?s=128&d=identicon&r=PG&f=1", "display_name": "DuckHunterZx", "link": "https://stackoverflow.com/users/7186129/duckhunterzx"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560973080, "post_id": 56672944, "comment_id": 99916804, "body": "@user3386109 alright great, going to eat, and brb to try this out, thank you lots"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7186129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b957adbff504d5e32c173eb766b74f4?s=128&d=identicon&r=PG&f=1", "display_name": "DuckHunterZx", "link": "https://stackoverflow.com/users/7186129/duckhunterzx"}, "edited": false, "score": 0, "creation_date": 1560979142, "post_id": 56675249, "comment_id": 99919166, "body": "Holy cow, you&#39;re the man, this was the most complete and detailed answer. I think what helped me most is how you shifted the focus of the problem from optimizing the primality test to removing it completely. Even after the first optimization it took no longer than 0.005s so i am thoroughly impressed, never got to witness that drastic a difference. I will call it a night right now as it worked, and will come back tomorrow to take a detailed look at your other proposals which are definitely interesting. Thanks for your insights!"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560992057, "post_id": 56675249, "comment_id": 99922016, "body": "There is a flaw lurking in this description. It says to divide out all the instances of the current test divisor <code>d</code>, and eventually return the leftover number <code>n</code>. However, if there are multiple instances of the last (largest) prime factor, and we continue while <code>d*d &lt;= n</code>, this will result in dividing them all out, leaving <code>n</code> set to 1."}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1560994845, "post_id": 56675249, "comment_id": 99922462, "body": "Ah, good point. That can be special-cased away. Thanks for spotting that!"}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": true, "score": 3, "last_activity_date": 1560982488, "last_edit_date": 1560982488, "creation_date": 1560975482, "answer_id": 56675249, "question_id": 56672944, "link": "https://stackoverflow.com/questions/56672944/taking-a-crack-at-project-euler-problem-3-is-my-solution-correct/56675249#56675249", "title": "Taking a crack at project euler problem 3, is my solution correct?", "body": "<p>The general strategy you're using so far, at a high level, looks like this:</p>\n\n<ol>\n<li>Try dividing the target number by all numbers less than or equal to half the target number.</li>\n<li>Each time you find a divisor, see if it's a prime number and bigger than the maximum factor. If so, update the maximum factor.</li>\n<li>Return the largest number you find this way.</li>\n</ol>\n\n<p>Considering that your goal is to find the largest factor of a single number, this is a fairly reasonable strategy. There are a couple of ways that you could speed this up. Some of them are echoed in the comments, while others (to the best of my knowledge) haven't been proposed there.</p>\n\n<h1>Optimization 1: Eliminate the Primality Checking</h1>\n\n<p>Right now, you're proceeding by dividing the target number by each possible divisor, then checking whether those divisors are prime numbers. If your target number has a lot of divisors, then you're going to spend a lot of time checking divisors that aren't prime, which will eat into your runtime.</p>\n\n<p>An alternative approach would be the following. As before, try dividing the target number by each possible divisor, in order. However, make one change: whenever you find a divisor, modify the target number by dividing out as many copies of that divisor as possible. If you do this, something interesting happens: the only numbers that you'll discover divide the number will be prime numbers.</p>\n\n<p>Why is this?</p>\n\n<p>To see why, think about how this will work. You'll first test whether 2 divides the number. If so, you'll divide out as many copies of 2 as is possible, meaning that if you try dividing by any number that's a multiple of 2 later on, you'll find that the larger number isn't a divisor.</p>\n\n<p>Similarly, you'll then test whether 3 divides the number. If so, you'll divide out all the copies of 3, so no number that is a multiple of three will ever divide the remaining number.</p>\n\n<p>This single change eliminates the need for the <code>is_prime</code> function, saving a ton of work. Plus, you can be guaranteed that any divisor you find this way will be a prime number.</p>\n\n<h1>Optimization 2: Stopping Early</h1>\n\n<p>Your current code works by stopping the search for divisors as soon as the candidate divisor is greater than half the target number. If you're looking for divisors in general, this is the best that you can do. However, if you begin by making the above optimization, you can stop even earlier than this.</p>\n\n<p>The above strategy of cleanly dividing out all prime factors you encounter has an added benefit. Suppose that, after all the dividing that's been done, your remaining target number is <code>n</code>. Now, imagine that your current divisor is <code>d</code> and that <code>d</code> &lt; <code>n</code>. If <code>d</code> divides <code>n</code>, then you can write <code>n</code> as the product of the two numbers <code>d</code> and <code>n / d</code>. Because you've been dividing the target number through by all prime factors you encounter, we're guaranteed that <code>n</code> has no prime factors less than <code>d</code>. That means, in turn, that if <code>n / d</code> &lt; <code>d</code>, then <code>d</code> can't be a divisor of <code>n</code>. Why? Because, if <code>d</code> did divide <code>n</code>, then the number <code>n / d</code> would have to have a prime factor less than <code>d</code>, but we know that <code>n</code> has no such prime factors.</p>\n\n<p>As a result, as you're trying out divisors, you can stop as soon as <code>n / d</code> &lt; <code>d</code>, or, equivalently, as soon as <code>n</code> &lt; <code>d</code><sup>2</sup>. Once that happens, you know that <code>n</code> no longer has any prime factors less than itself, so the leftover number <code>n</code> is the last prime divisor.</p>\n\n<p>In practice, this will dramatically speed things up. Your target number is roughly 10<sup>12</sup>, and you can stop as soon as the last divisor is roughly on the order of the square root of that number, which is around 10<sup>6</sup>. That means you only need to search a million divisors, not a trillion!</p>\n\n<h1>Optimization 3: Choose Divisors Intelligently</h1>\n\n<p>The two above optimizations, which more or less reflect your original strategy, will likely be enough for you to get your answer and call it a day. However, if you'd like to speed things up a bit more just for the fun of it, you could consider trying to select your divisors a bit better.</p>\n\n<p>Right now, for example, half of the numbers you try dividing the target by are even. Aside from 2, no even number is prime, so you could consider splitting your loop into two pieces: a special-case to handle 2, and a loop that starts counting at 3 and takes steps of size 2 (3, 5, 7, 9, 11, 13, etc.) rather than steps of size 1. (Eyeballing the target number, you can see that it's not even, so you could even skip division by 2 entirely!)</p>\n\n<p>Even better, consider downloading a list of all the prime numbers up to approximately 10<sup>7</sup>. Either hardcode that list into your program, or dump it all into a text file and read it in at program startup. Then, only divide the target by the numbers on that list. Voila! You're now only dividing by prime numbers, saving you a lot of time and effort. (The Prime Number Theorem says that only about ln 10<sup>7</sup> &asymp; 18.4 numbers less than 10<sup>7</sup> will be prime, so that's likely going to give you an extra 20x speedup on top of everything else.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 41, "user_id": 7186129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b957adbff504d5e32c173eb766b74f4?s=128&d=identicon&r=PG&f=1", "display_name": "DuckHunterZx", "link": "https://stackoverflow.com/users/7186129/duckhunterzx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 56675249, "answer_count": 1, "score": 1, "last_activity_date": 1560982488, "creation_date": 1560964812, "last_edit_date": 1560974057, "question_id": 56672944, "link": "https://stackoverflow.com/questions/56672944/taking-a-crack-at-project-euler-problem-3-is-my-solution-correct", "title": "Taking a crack at project euler problem 3, is my solution correct?", "body": "<p>Problem 3 of Project Euler reads as follows:</p>\n\n<blockquote>\n  <p>The prime factors of 13195 are 5, 7, 13 and 29.\n  What is the largest prime factor of the number 600851475143 ?</p>\n</blockquote>\n\n<p>I've made this solution, makes sense, looks okay, works for small numbers but when we get to the problem's huge number is when the program runs forever. My question is, is this fundamentally correct, and if so how could i optimize the code? In my understanding, the problematic function is is_prime(). </p>\n\n<pre><code>bool is_factor(long long int num, long long int factor)\n{\n    if(!(num%factor))\n    {\n        return true;\n    }\n    else\n    {\n        return false;\n    }\n}\n\nbool is_prime(long long int num)\n{\n    long long int i;\n    bool flag = true;\n    for(i = 2; i &lt;= num/2; i++)\n    {\n        if(!(num%i))\n        {\n            flag = false;\n        }\n    }\n    return flag;\n}\n\nint main(void)\n{\n    long long int i, max_factor = 1;\n    for(i = 1; i &lt; 600851475143; i++)\n    {\n        if(is_factor(600851475143,i) &amp;&amp; is_prime(i) &amp;&amp; i&gt;max_factor)\n        {\n            max_factor = i;\n        }\n    }\n    printf(\"%d\\n\",max_factor);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1560962713, "post_id": 56672387, "comment_id": 99912166, "body": "This is far too broad and opinion based for here. Poor use of <code>goto</code> and freeing a null pointer are what stands out though."}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "edited": false, "score": 0, "creation_date": 1560962787, "post_id": 56672387, "comment_id": 99912194, "body": "One odd thing is <code>if (is_ok) goto fail;</code> Probably meant <code>!is_ok</code>"}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 1, "creation_date": 1560962837, "post_id": 56672387, "comment_id": 99912219, "body": "What do you mean &quot;bad?&quot; Bad as in it fails to compile? Bad as in it fails a code review? Bad as in it doesn&#39;t do what you think it does? Bad as in it doesn&#39;t satisfy the requirements given to you? Bad as in it&#39;s inefficient? Bad as in it&#39;s doing things in ways that yourself or others doesn&#39;t deem &quot;good?&quot; Bad as in it&#39;s hard to read? etc."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1560963030, "post_id": 56672387, "comment_id": 99912303, "body": "Flagged by whom? How did you &quot;come across&quot; this code? What is your connection to / interest in the code - why do you need to know what&#39;s bad about it when it&#39;s not your code (and who told you that someone else&#39;s code is bad and why)? If you don&#39;t know C well enough to see what&#39;s bad about this code, why bother with this code rather than continuing to learn C until you have a better understanding of it? This almost seems like a &quot;find the mistakes in this piece of code&quot;-type homework assignment."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1560963291, "post_id": 56672387, "comment_id": 99912425, "body": "What are the prototypes and function declarations for the function <code>database_lookup()</code>?"}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1560965319, "post_id": 56672387, "comment_id": 99913328, "body": "Obviously not working code. Seems to be some sort of &quot;How many defects/code smells can you spot? I think @sepp2k has it right."}, {"owner": {"reputation": 1, "user_id": 8022705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ded81d79fb24ba5a53a8db5b15ae8511?s=128&d=identicon&r=PG&f=1", "display_name": "computerstudy", "link": "https://stackoverflow.com/users/8022705/computerstudy"}, "edited": false, "score": 0, "creation_date": 1561040893, "post_id": 56672387, "comment_id": 99941868, "body": "thank you all for your comments."}], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1560962725, "creation_date": 1560962725, "answer_id": 56672438, "question_id": 56672387, "link": "https://stackoverflow.com/questions/56672387/why-is-this-c-code-section-flagged-as-bad/56672438#56672438", "title": "Why is this C code section flagged as bad?", "body": "<p>This doesn't make much sense to me.  Why free a <code>NULL</code> pointer...</p>\n\n<pre><code>fail:\n    data = NULL;\n    free(data);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 0, "creation_date": 1560963295, "post_id": 56672446, "comment_id": 99912428, "body": "I would even go as far as supposing that the person who write this piece of code <i>reversed</i> the 2 lines in the <code>fail</code> case. The person probably meant:  <code>free(data); data = NULL;</code>"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 0, "creation_date": 1560964010, "post_id": 56672446, "comment_id": 99912724, "body": "@fassn <code>data</code> will be automatically cleared when the function exits shortly after, there&#39;s no need to manually clear it."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1560965929, "post_id": 56672446, "comment_id": 99913596, "body": "@Schwern The pointer itself will be cleared when it goes out of scope; the actual memory on the heap will remain until either it is freed or until (at least) the program terminates"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1560967357, "post_id": 56672446, "comment_id": 99914274, "body": "@GovindParmar Yes, <code>free(data)</code> is necessary. <code>data = NULL</code> is not."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1560967796, "post_id": 56672446, "comment_id": 99914456, "body": "@Schwern The reason people frequently set pointers to <code>NULL</code> immediately after <code>free</code>ing them is to prevent \u201cdouble free\u201d bugs. It\u2019s a good habit to have even if you\u2019re being redundant by placing the assignment to <code>NULL</code> at the end of a scope."}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1583557212, "last_edit_date": 1583557212, "creation_date": 1560962755, "answer_id": 56672446, "question_id": 56672387, "link": "https://stackoverflow.com/questions/56672387/why-is-this-c-code-section-flagged-as-bad/56672446#56672446", "title": "Why is this C code section flagged as bad?", "body": "<p>Setting a pointer to <code>NULL</code> before calling <code>free</code> on it makes the call to <code>free</code> benign (i.e. does nothing).</p>\n\n<p>If you have a static analysis tool in your IDE that checks for and probably incorrect code, I wouldn't be surprised that it got picked up by it.</p>\n\n<p>The idiomatic way to call <code>free</code> safely is to set the <code>free</code>-d pointer to <code>NULL</code> <em>after</em> the call, not before.</p>\n"}, {"comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1560964748, "post_id": 56672685, "comment_id": 99913073, "body": "An editor is not a linter. :P A linter is not a SAT, a SAT is not hooman, and a hooman is not a cat and cat is not an editor... :P"}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 2, "last_activity_date": 1560965581, "last_edit_date": 1560965581, "creation_date": 1560963721, "answer_id": 56672685, "question_id": 56672387, "link": "https://stackoverflow.com/questions/56672387/why-is-this-c-code-section-flagged-as-bad/56672685#56672685", "title": "Why is this C code section flagged as bad?", "body": "<p>Any decent <a href=\"https://en.wikipedia.org/wiki/Lint_(software)\" rel=\"nofollow noreferrer\">linter</a> will flag numerous problems with this code. Here's what the one provided with <a href=\"https://atom.io/\" rel=\"nofollow noreferrer\">Atom editor</a> found, plus what I eyeballed.</p>\n\n<pre><code>int lookup_personal_info(char *first_name, void *last_name, uint8_t (*sin)[9], const struct **info_out)\n</code></pre>\n\n<ul>\n<li><code>last_name</code> is declared <code>void *</code> but used as a <code>char *</code></li>\n<li><code>const struct **info_out</code> declares an anonymous struct. It should be <code>personal_info **info_out</code></li>\n<li>The function returns a <code>bool</code> not an <code>int</code>.</li>\n<li><code>sin</code> is never used except to check it's passed in.</li>\n</ul>\n\n<pre><code>    if (!first_name || !last_name || !sin)\n        return false;\n</code></pre>\n\n<ul>\n<li>Passing in a null pointer is probably a bug by the caller. This silently ignores that bug making it difficult to find. It should raise an error.</li>\n<li>It forgets to check <code>info_out</code>.</li>\n</ul>\n\n<pre><code>    char *initials[3] = { first_name[0], last_name[1] };\n</code></pre>\n\n<ul>\n<li>This is an array of character pointers being initialized with <code>char</code>. It should be <code>char initials[3]</code>.</li>\n<li>It is not null terminated. Maybe it doesn't have to be, but I wouldn't risk that.</li>\n<li><code>last_name</code> is declared <code>void *</code> yet used as a <code>char *</code>.</li>\n<li>It's using the first character of <code>first_name</code> as an initial, that makes sense, but why the second... thing... in <code>last_name</code>?</li>\n</ul>\n\n<pre><code>    personal_info *data = malloc(sizeof(struct personal_info));\n</code></pre>\n\n<p><code>struct personal_info</code> is not a type, the type is <code>personal_info</code>.</p>\n\n<pre><code>    *info_out = (personal_info *) data;\n</code></pre>\n\n<p><code>info_out</code> was incorrectly declared as an anonymous struct. It should be <code>personal_info **info_out</code>. Then no type cast is necessary.</p>\n\n<pre><code>    bool is_ok = database_lookup(initials, &amp;data);\n    if (is_ok)\n        goto fail;\n</code></pre>\n\n<p>The check is backwards.</p>\n\n<p>The use of <code>goto</code> is justified to ensure proper cleanup on error. It's probably included in the example as a red herring.</p>\n\n<pre><code>fail:\n    data = NULL;\n    free(data);\n\n    return true;\n</code></pre>\n\n<ul>\n<li><code>free</code> is called after nulling out <code>data</code> leaking memory.</li>\n<li>There's no need to set <code>data</code> to <code>NULL</code>, it's local to the function which will shortly exit.</li>\n<li>Both failure and success return <code>true</code>.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8022705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ded81d79fb24ba5a53a8db5b15ae8511?s=128&d=identicon&r=PG&f=1", "display_name": "computerstudy", "link": "https://stackoverflow.com/users/8022705/computerstudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1560972325, "answer_count": 3, "score": -7, "last_activity_date": 1583557212, "creation_date": 1560962515, "question_id": 56672387, "link": "https://stackoverflow.com/questions/56672387/why-is-this-c-code-section-flagged-as-bad", "closed_reason": "Needs more focus", "title": "Why is this C code section flagged as bad?", "body": "<p>I am new to c. I come across this section of code in C, it's flagged as a bad code. Not sure why it's bad and any suggestions for improvement? </p>\n\n<p>The original code is from this link:</p>\n\n<p><a href=\"https://pastebin.com/r2rTN6Zf\" rel=\"nofollow noreferrer\">https://pastebin.com/r2rTN6Zf</a></p>\n\n<pre><code>typedef struct {\n    bool is_married;\n    uint8_t age;\n    uint8_t num_children;\n} personal_info;\n\nint lookup_personal_info(char *first_name, void *last_name, uint8_t (*sin)[9], const struct **info_out)\n{\n    // Sanity check.\n    if (!first_name || !last_name || !sin)\n        return false;\n\n    char *initials[3] = { first_name[0], last_name[1] };\n\n    // Allocate space for the output.\n    personal_info *data = malloc(sizeof(struct personal_info));\n    if (!data)\n        goto fail;\n\n    // Look up the personal info by initials.\n    bool is_ok = database_lookup(initials, &amp;data);\n    if (is_ok)\n        goto fail;\n\n    // Assign the found data to the output parameter.\n    *info_out = (personal_info *) data;\n\n    // Success!\n    return true;\n\nfail:\n    data = NULL;\n    free(data);\n\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1560961933, "post_id": 56672226, "comment_id": 99911842, "body": "&quot;tamir&quot; is a string of <i>6</i> characters long. Remember that strings re terminated with a special <code>&#39;\\0&#39;</code> character."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1560962139, "post_id": 56672226, "comment_id": 99911936, "body": "Related: <a href=\"https://stackoverflow.com/questions/13490805/why-does-gcc-allow-char-array-initialization-with-string-literal-larger-than-arr\">Why does gcc allow char array initialization with string literal larger than array</a>"}], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 2, "creation_date": 1560962303, "post_id": 56672261, "comment_id": 99912011, "body": "And to avoid human errors, it would be even better to simply declare <code>char myName[]</code> and let the compiler allocate memory for you."}, {"owner": {"reputation": 6429, "user_id": 8274756, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207212471548575/picture?type=large", "display_name": "Tamir Abutbul", "link": "https://stackoverflow.com/users/8274756/tamir-abutbul"}, "reply_to_user": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 1, "creation_date": 1560962534, "post_id": 56672261, "comment_id": 99912100, "body": "@alinsoar What a funny mistake, I was sure that In C you can&#39;t declare an array as <code>myName[]</code> and let the compiler allocate memory for you as @fassn said. It really makes things clear now. I will accept your question when I will be able to (cant before 10 minutes). Have a great day"}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": true, "score": 1, "last_activity_date": 1560962371, "last_edit_date": 1560962371, "creation_date": 1560961994, "answer_id": 56672261, "question_id": 56672226, "link": "https://stackoverflow.com/questions/56672226/why-am-i-getting-extra-char-when-printing-an-array/56672261#56672261", "title": "Why am I getting extra char when printing an array", "body": "<pre><code>char myName [6] = \"tamir\";\n</code></pre>\n\n<p>will work. <em>And to avoid human errors, it would be even better to simply declare char myName[] and let the compiler allocate memory for you.</em> (comment suggested by @fassn ) The string literals are converted in a static char array adding also a NULL.  You need to reserve space for NULL as well. \"tamir\" is <a href=\"https://en.wikipedia.org/wiki/Syntactic_sugar\" rel=\"nofollow noreferrer\">syntactic sugar</a> for <code>{'t', 'a', 'm', 'i', 'r', 0}</code>. The very definition from <code>ISO/IEC 9899</code> is so, <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\"><code>6.4.5p5  String literal</code></a></p>\n\n<blockquote>\n  <p>In  translation  phase  7,  a  byte  or  code  of  value  zero  is  appended  to  each  multibytecharacter sequence that results from a string literal or literals.</p>\n</blockquote>\n"}], "owner": {"reputation": 6429, "user_id": 8274756, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207212471548575/picture?type=large", "display_name": "Tamir Abutbul", "link": "https://stackoverflow.com/users/8274756/tamir-abutbul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "closed_date": 1560962315, "accepted_answer_id": 56672261, "answer_count": 1, "score": -1, "last_activity_date": 1561006085, "creation_date": 1560961865, "last_edit_date": 1561006085, "question_id": 56672226, "link": "https://stackoverflow.com/questions/56672226/why-am-i-getting-extra-char-when-printing-an-array", "closed_reason": "Duplicate", "title": "Why am I getting extra char when printing an array", "body": "<p>I am new to C and I'm getting confused about printing arrays.</p>\n\n<p>Consider this simple code:</p>\n\n<pre><code>char myName [5] = \"tamir\";\nprintf(\"My name is %s\" , myName);\n</code></pre>\n\n<p>The output of this is \"tamirH\", with extra H at the end.</p>\n\n<p>But when I declare this array like this  <code>char myName [6] = \"tamir\";</code>  (now the array is declared with 6 chars and \"tamir\" is made out of 5 chars) I don't see the extra \"H\".</p>\n\n<p>Why is this happening? Is this related to the string terminator in C or am I confused?</p>\n"}, {"tags": ["c", "arrays", "byte"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1560961547, "post_id": 56672000, "comment_id": 99911686, "body": "In what <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endian form</a>? Bytes and multi-byte integers are not necessarily interchangeable."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1560961738, "post_id": 56672000, "comment_id": 99911769, "body": "How is that code supposed to work?  It  appears to be unrelated to your stated aim.  What is <code>size_of_const()</code> and what is the +12 offset for?  Also <code>0001 0004 0003</code> is not an unambiguous description of the content - 4 digit octal values suggests 12 bit value not <code>uint8_t</code> - or are these character strings representing integers and not 8 bit integers at all?  Too much ambiguity to post an answer."}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1560963138, "post_id": 56672000, "comment_id": 99912351, "body": "@Clifford good point about the octal values but I assume he meant 0x0001, 0x0004, etc"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 1, "creation_date": 1560963247, "post_id": 56672000, "comment_id": 99912410, "body": "But even then those would be 16 bits.."}, {"owner": {"reputation": 80, "user_id": 4741053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d4c845b6a78bf037a2d51cdfef7fa7a?s=128&d=identicon&r=PG&f=1", "display_name": "Nomios", "link": "https://stackoverflow.com/users/4741053/nomios"}, "edited": false, "score": 0, "creation_date": 1560966223, "post_id": 56672000, "comment_id": 99913726, "body": "Are you just trying to get the compiler to treat <code>buffer</code> as <code>int32_t*</code>? In this case just cast:<code>int32_t* const_data = (int32_t*) buffer</code>"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1560969994, "post_id": 56672000, "comment_id": 99915476, "body": "What is your reducing function?"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 11517609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4nsWtuPKOl8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN6cjcQ9aslUNfg8lmdn1AI13MdQ/mo/photo.jpg?sz=128", "display_name": "Mehmet Berk Cetin", "link": "https://stackoverflow.com/users/11517609/mehmet-berk-cetin"}, "edited": false, "score": 0, "creation_date": 1560966234, "post_id": 56673203, "comment_id": 99913729, "body": "I forgot to men that it is in C :("}, {"owner": {"reputation": 2636, "user_id": 4635560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv67d.jpg?s=128&g=1", "display_name": "Manthan Tilva", "link": "https://stackoverflow.com/users/4635560/manthan-tilva"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1560966631, "post_id": 56673203, "comment_id": 99913912, "body": "@bigwillydos thanks for pointing out my mistake. Updated for c."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1560967873, "post_id": 56673203, "comment_id": 99914490, "body": "<code>output[count] = (int32_t)(*(int32_t*)(&amp;input[count]));</code> is a <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing violation</a> and is likely to be a misaligned access.  Both of which are undefined behavior.  You can not safely take a character address and treat it like another type - <code>int32_t</code> in this case."}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1560970997, "post_id": 56673203, "comment_id": 99915912, "body": "@ManthanTilva cool, removed the downvote since you corrected that, however, I have not actually reviewed your answer"}], "tags": [], "owner": {"reputation": 2636, "user_id": 4635560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv67d.jpg?s=128&g=1", "display_name": "Manthan Tilva", "link": "https://stackoverflow.com/users/4635560/manthan-tilva"}, "is_accepted": false, "score": -1, "last_activity_date": 1560966655, "last_edit_date": 1560966655, "creation_date": 1560966037, "answer_id": 56673203, "question_id": 56672000, "link": "https://stackoverflow.com/questions/56672000/how-to-convert-an-int8-t-array-to-int32-t-array-in-c/56673203#56673203", "title": "How to convert an int8_t array to int32_t array in C", "body": "<p>Below is solution which I used in past for similar problem. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\nint main(){\n    int8_t input[] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08};\n    int32_t output[10];\n    int count=0;\n    for(;count&lt;sizeof(input);count+=sizeof(int32_t)/sizeof(int8_t)){\n        output[count] = (int32_t)(*(int32_t*)(&amp;input[count]));\n        printf(\"%x:%x\\n\",input[count],output[count]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note: As pointed out by @tadman in comment. You also need to consider endianness of your platform. This solution works well for my problem on platform I was working. Based on your platform you may need to tweak this. </p>\n\n<p><kbd><a href=\"https://ideone.com/zIvRIh\" rel=\"nofollow noreferrer\">Live Code</a></kbd> </p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 11517609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4nsWtuPKOl8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN6cjcQ9aslUNfg8lmdn1AI13MdQ/mo/photo.jpg?sz=128", "display_name": "Mehmet Berk Cetin", "link": "https://stackoverflow.com/users/11517609/mehmet-berk-cetin"}, "edited": false, "score": 0, "creation_date": 1560983472, "post_id": 56675783, "comment_id": 99920391, "body": "So this converts my byte_t array to word_t array but in an opposite way. So if byte_t array is 00 00 00 04. Then my word_t array becomes 40000000. How can I fix this so that my word_t array can be 00000004. Thank you!"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "reply_to_user": {"reputation": 99, "user_id": 11517609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4nsWtuPKOl8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN6cjcQ9aslUNfg8lmdn1AI13MdQ/mo/photo.jpg?sz=128", "display_name": "Mehmet Berk Cetin", "link": "https://stackoverflow.com/users/11517609/mehmet-berk-cetin"}, "edited": false, "score": 1, "creation_date": 1560985421, "post_id": 56675783, "comment_id": 99920799, "body": "It&#39;s actually 04 00 00 00. When you are printing, it doesn&#39;t show you the leading zero unless you specify it to do so (e.g. <code>printf(&quot;%08x\\n&quot;, my_union.const_data[0]);</code>) And this has to do with <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a>. I&#39;ll explain more in the following comment."}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "reply_to_user": {"reputation": 99, "user_id": 11517609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4nsWtuPKOl8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN6cjcQ9aslUNfg8lmdn1AI13MdQ/mo/photo.jpg?sz=128", "display_name": "Mehmet Berk Cetin", "link": "https://stackoverflow.com/users/11517609/mehmet-berk-cetin"}, "edited": false, "score": 0, "creation_date": 1560985721, "post_id": 56675783, "comment_id": 99920862, "body": "If <code>0x00000004</code> is your 32 bit value for <code>my_union.const_data[0]</code>, then <code>0x04</code> is the <i>least significant byte</i>, and on a <b>little endian</b> machine this will get stored in the lowest position of <code>my_union.buffer</code> (position 0). If you set <code>my_union.buffer[0] = 0x00</code>, <code>my_union.buffer[1] = 0x00</code>, <code>my_union.buffer[2] = 0x00</code>, <code>my_union.buffer[4] = 0x04</code>, then <code>my_union.const_data[0]</code> is going to print <code>0x04000000</code> because <code>0x04</code> is actually the <i>most significant byte</i>. If you want <code>0x04</code> to be the <i>least significant byte</i>, then store it at <code>my_union.buffer[0]</code>."}], "tags": [], "owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "is_accepted": true, "score": 2, "last_activity_date": 1560978084, "creation_date": 1560978084, "answer_id": 56675783, "question_id": 56672000, "link": "https://stackoverflow.com/questions/56672000/how-to-convert-an-int8-t-array-to-int32-t-array-in-c/56675783#56675783", "title": "How to convert an int8_t array to int32_t array in C", "body": "<p>The easiest and most straight forward way is to use a <code>union</code></p>\n\n<pre><code>#define array_size_int32    11\n#define array_size_int8     44\n\ntypedef union{\n    int32_t const_data[array_size_int32];\n    int8_t buffer[array_size_int8];\n}my_union_t;\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>/* initialize union members */\nmy_union_t my_union = {\n    .const_data = {\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n        0x12345678,\n    },\n};\n</code></pre>\n\n<p>Example way to print:</p>\n\n<pre><code>uint8_t i;\n\nfor(i = 0; i &lt; array_size_int8; i++){\n\n    /* mask off sign extension bits */\n    printf(\"my_union.buffer[%d] = %x\\n\", i, my_union.buffer[i] &amp; 0xff);\n\n}\n</code></pre>\n\n<p>You can try the code out <a href=\"https://onlinegdb.com/B1CAbmOyH\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I should add that this works because the memory size needed to allocate either array is the same and you'll run in to problems if you change the <code>#define</code>'s without taking that in to consideration.</p>\n\n<p>For example,</p>\n\n<pre><code>#define array_size_int32    10    //40 bytes\n#define array_size_int8     45    //45 bytes\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 11517609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4nsWtuPKOl8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN6cjcQ9aslUNfg8lmdn1AI13MdQ/mo/photo.jpg?sz=128", "display_name": "Mehmet Berk Cetin", "link": "https://stackoverflow.com/users/11517609/mehmet-berk-cetin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 1, "accepted_answer_id": 56675783, "answer_count": 2, "score": 2, "last_activity_date": 1560978084, "creation_date": 1560960877, "last_edit_date": 1560966252, "question_id": 56672000, "link": "https://stackoverflow.com/questions/56672000/how-to-convert-an-int8-t-array-to-int32-t-array-in-c", "title": "How to convert an int8_t array to int32_t array in C", "body": "<p>I have an array and I want to convert it to an int32_t array. </p>\n\n<p>I tried the code below.</p>\n\n<pre><code>int32_t const_data[11];\nint8_t buffer[44];\n\n    int k = 0;\n    while (k &lt; 11) {\n        for (int j = 0; j &lt; 44; j++) {\n                const_data[k] = bf.buffer[j];\n                k++;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 3, "creation_date": 1560959802, "post_id": 56671636, "comment_id": 99910909, "body": "&quot;i managed to print the first one but im having trouble with the other 2&quot; Can you be more precise?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1560959892, "post_id": 56671636, "comment_id": 99910952, "body": "There&#39;s a loop which prints a row of <code>tablero1</code>. Just repeat that also for <code>tablero2</code> and 3. Limiting the width of the numbers in the format specifier (e.g. with <code>%2d</code>) could be helpful too."}], "answers": [{"comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1560960780, "post_id": 56671771, "comment_id": 99911383, "body": "I edited your post.  It is legal to say &quot;a&quot; &quot;b&quot; instead of &quot;ab&quot;."}], "tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1560960752, "last_edit_date": 1560960752, "creation_date": 1560959961, "answer_id": 56671771, "question_id": 56671636, "link": "https://stackoverflow.com/questions/56671636/print-3-boards-with-borders-in-c/56671771#56671771", "title": "Print 3 boards with borders in C", "body": "<p>Add additional loops to print tables two and three:</p>\n\n<pre><code>void imprimir_3_tableros(char tablero1[10][10],char tablero2[10][10],char tablero3[10][10]){\nint i;\nint j;\n\nprintf(\"  A    B    C    D    E    F    G    H    I    J             A    B    C    D    E    F    G    H    I    J              A    B    C    D    E    F    G    H    I    J\\n\");\n\nprintf(\"\u2554\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2557        \"\n       \"\u2554\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2557        \"\n       \"\u2554\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2557\\n\");\n\nfor (i = 0; i &lt; 10; ++i) {\n    if(i != 0)\n        printf(\"\u2560\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2563       \"\n               \"\u2560\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2563       \"\n               \"\u2560\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2563\\n\");\n\n    for (j = 0; j &lt; 10; ++j)\n        printf(\"\u2551 %d  \", tablero1[i][j]);\n\n    printf(\"\u2551        \");\n\n    for (j = 0; j &lt; 10; ++j)\n        printf(\"\u2551 %d  \", tablero2[i][j]);\n\n    printf(\"\u2551         \");\n\n    for (j = 0; j &lt; 10; ++j)\n        printf(\"\u2551 %d  \", tablero3[i][j]);\n\n    printf(\"\u2551\\n\");\n}\nprintf(\"\u255a\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u255d        \"\n       \"\u255a\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u255d        \"\n       \"\u255a\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u255d\\n\");\n}\n</code></pre>\n\n<p>Adjust spacing as needed.</p>\n"}], "owner": {"reputation": 171, "user_id": 3663235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c3d76ec6c9e119b0dbd81c487fe61f?s=128&d=identicon&r=PG&f=1", "display_name": "Joaco", "link": "https://stackoverflow.com/users/3663235/joaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 56671771, "answer_count": 1, "score": 1, "last_activity_date": 1560961938, "creation_date": 1560959400, "last_edit_date": 1560961938, "question_id": 56671636, "link": "https://stackoverflow.com/questions/56671636/print-3-boards-with-borders-in-c", "title": "Print 3 boards with borders in C", "body": "<p>So im trying to print 3 boards, each one is a 2d array, i managed to print the first one but im having trouble with the other 2.\nany help is appreciated.</p>\n\n<p>here is how it looks now:\n<a href=\"https://i.stack.imgur.com/I17rR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I17rR.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>void imprimir_3_tableros(char tablero1[10][10],char tablero2[10][10],char tablero3[10][10]){\nint i;\nint j;\nprintf(\"  A    B    C    D    E    F    G    H    I    J             A    B    C    D    E    F    G    H    I    J              A    B    C    D    E    F    G    H    I    J\\n\");\nprintf(\"\u2554\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2557        \u2554\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2557         \u2554\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2557\\n\");\nfor (i = 0; i &lt; 10; ++i) {\n    if(i != 0){\n        printf(\"\u2560\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2563        \u2560\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2563         \u2560\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2563\\n\");\n    }\n    for (j = 0; j &lt; 10; ++j) {\n        printf(\"\u2551 %d  \", tablero1[i][j]);\n\n}\nprintf(\"\u2551\\n\");\n}\nprintf(\"\u255a\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u255d        \u255a\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u255d         \u255a\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u255d\\n\");\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "initialization"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1560959229, "post_id": 56671562, "comment_id": 99910614, "body": "<code>0</code> is <i>not</i> a marker for the array end. It knows the size of the array because you told it right here: <code>int dest_array[10]</code> &lt;---. There is a special case of C <i>strings</i> which are terminated with zero, but not arrays in general."}, {"owner": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "edited": false, "score": 0, "creation_date": 1560959637, "post_id": 56671562, "comment_id": 99910827, "body": "Take a look at your platform <code>memcpy(...)</code> source file."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560960562, "post_id": 56671691, "comment_id": 99911271, "body": "\u201cIn C, it is impossible to know the size of an array\u201d is nonsense. After <code>int x[10]</code>, the size of <code>x</code> is 10 <code>int</code>, and its size in bytes may be obtained with <code>sizeof x</code>. Perhaps you mean the size of an array cannot be obtained merely from a pointer to its first element, but then the answer should say that, not this."}, {"owner": {"reputation": 3193, "user_id": 2694511, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2e9aw.png?s=128&g=1", "display_name": "Spencer D", "link": "https://stackoverflow.com/users/2694511/spencer-d"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560961410, "post_id": 56671691, "comment_id": 99911634, "body": "@EricPostpischil, thanks for the comment. I agree that the first sentence could be worded more clearly. In actuality, I believe it should read: &quot;In C, it is impossible to know the length of an array inherently;&quot; however, fundamentally, the point is the same as what you suggested: the length an array cannot be determined by some intrinsic or built-in mechanism because an array in C is merely a pointer to the first element... or, more precisely, a pointer to some location in memory that we are choosing to treat as the first element of an array."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560967328, "post_id": 56671691, "comment_id": 99914262, "body": "An array is <b>not</b> a pointer to its first element. In many, but not all, expressions, an array is automatically converted to a pointer to its first element. But there are other contexts in which it is distinct and different from a pointer to its first element. For example, you can have a pointer to the array, which is different from a pointer to its first element, and it is not automatically converted."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1560973536, "post_id": 56671691, "comment_id": 99916998, "body": "@EricPostpischil: Further adding to the array/pointer distinction, both gcc and clang will sometimes process <code>arrayLValue[i]</code> differently from <code>*(arrayLValue+i)</code> in cases where the former may or may not actually be defined by the Standard, but clearly <i>should</i> be (the latter need only be processed identically to the former in cases where the former actually <i>is</i> defined)."}, {"owner": {"reputation": 65, "user_id": 10469162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad9f5aab6116c2a853861fbaf62f33c?s=128&d=identicon&r=PG&f=1", "display_name": "cassepipe", "link": "https://stackoverflow.com/users/10469162/cassepipe"}, "edited": false, "score": 0, "creation_date": 1607095774, "post_id": 56671691, "comment_id": 115172877, "body": "@SpencerD Now that I can add comments, I get to thank you for making the effort to understand what I did not understand. :)"}], "tags": [], "owner": {"reputation": 3193, "user_id": 2694511, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2e9aw.png?s=128&g=1", "display_name": "Spencer D", "link": "https://stackoverflow.com/users/2694511/spencer-d"}, "is_accepted": false, "score": 4, "last_activity_date": 1607150765, "last_edit_date": 1607150765, "creation_date": 1560959648, "answer_id": 56671691, "question_id": 56671562, "link": "https://stackoverflow.com/questions/56671562/c-if-as-i-understand-0-and-0-are-the-same-how-does-the-compiler-knows-the/56671691#56671691", "title": "C : If as I understand 0 and &#39;\\0&#39; are the same, how does the compiler knows the size of an array when I write int my_array = {0};?", "body": "<p>In C, it is impossible to know the length of an array inherently. This is due to the fact that an array is really just a contiguous chunk of memory, and the value passed to functions is really just a pointer to the first element in the array. As a result of this, to actually know the length of an array within a function other than the function where that array was declared, you have to somehow provide that value to the function. Two common approaches are the use of sentinel values which indicate the last element (similar to the way '\\0', the null character, is per convention interpreted as the first character not part of a string in C), or providing another parameter which contains the array length.</p>\n<p>As a very common example of this: if you have written any programs which use command-line parameters, then surely you are familiar with the common definition of <code>int main(int argc, char *argv[])</code>, which uses the second of the aforementioned approaches by providing the length of the <code>argv</code> array via the <code>argc</code> parameter.</p>\n<p>The compiler has some ways to work around this for <em>local</em> variables. E.g., the following would work:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int nums[10] = {0};\n    printf(&quot;%zu\\n&quot;, sizeof(nums)/sizeof(nums[0]));\n    \n    return 0;\n}\n</code></pre>\n<p>Which prints <code>10</code> to STDOUT; however, this only works because the <code>sizeof</code> operation is done locally, and the compiler knows the length of the array at that point.</p>\n<p>On the other hand, we can consider the situation of passing the array to another function:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint tryToGetSizeOf(int arr[]){\n    printf(&quot;%zu&quot;, sizeof(arr)/sizeof(arr[0]));\n}\n\nint main(){\n    int nums[10] = {0};\n    printf(&quot;%zu\\n&quot;, sizeof(nums)/sizeof(nums[0]));\n    \n    puts(&quot;Calling other function...&quot;);\n    tryToGetSizeOf(nums);\n    \n    return 0;\n}\n</code></pre>\n<p>This will end up printing the following to STDOUT:</p>\n<pre><code>10\nCalling other function...\n2\n</code></pre>\n<p>This may not be the value you're expecting, but this occurs due to the fact that the method signature <code>int tryToGetSizeOf(int arr[])</code> is functionally equivalent to <code>int tryToGetSizeOf(int *arr)</code>. Therefore, you are dividing the size of an integer pointer (<code>int *</code>) by the size of a single <code>int</code>; whereas while you're still in the local context of <code>main()</code> (<em>i.e., where the array was defined originally</em>), you are dividing the size of the allocated memory region by the size of the datatype that memory region is partitioned as (<code>int</code>).</p>\n<p><a href=\"http://%20https://ideone.com/kAAnXW\" rel=\"nofollow noreferrer\">An example of this available on Ideone</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1560960298, "post_id": 56671736, "comment_id": 99911136, "body": "worth noting that with something like <code>strcpy</code>, if you pass in memory that&#39;s too small (e.g. if <code>some_string</code> was 2 characters long for example), <code>strcpy</code> won&#39;t be able to tell, and will write past the end of <code>some_string</code>."}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "reply_to_user": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1560960442, "post_id": 56671736, "comment_id": 99911209, "body": "@CoffeeTableEspresso Yes, in practice the string safe versions should be used."}], "tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": false, "score": 3, "last_activity_date": 1560982512, "last_edit_date": 1560982512, "creation_date": 1560959818, "answer_id": 56671736, "question_id": 56671562, "link": "https://stackoverflow.com/questions/56671562/c-if-as-i-understand-0-and-0-are-the-same-how-does-the-compiler-knows-the/56671736#56671736", "title": "C : If as I understand 0 and &#39;\\0&#39; are the same, how does the compiler knows the size of an array when I write int my_array = {0};?", "body": "<pre><code>int* ptr1;\nint* ptr2;\n</code></pre>\n\n<p>You lose size information when you refer to arrays as pointers. There is no way you can identify the size of the array i.e. the number of elements using <code>ptr1</code>. You have to take help of another variable which will denote the size of the array referred by <code>ptr1</code> (or <code>ptr2</code>).</p>\n\n<p>Same holds for character arrays as well. Consider the below:</p>\n\n<pre><code>char some_string[100];\nstrcpy(some_string, \"hello\");\n</code></pre>\n\n<p>The approach you mentioned of checking for <code>\\0</code> (or <code>0</code>) gives you the number of elements which are part of the string residing in <code>some_string</code>. In no way does it refer to the number of elements in <code>some_string</code> which is <code>100</code>.</p>\n\n<p>To identify the size of destination, you have to pass another argument depicting its size.</p>\n\n<p>There are other ways to identify the end of the array but t is cleaner to pass the size explicitly rather than using some pointer hack like passing a pointer to end of the array or using some invalid value as the last element in array.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1560961922, "creation_date": 1560961922, "answer_id": 56672237, "question_id": 56671562, "link": "https://stackoverflow.com/questions/56671562/c-if-as-i-understand-0-and-0-are-the-same-how-does-the-compiler-knows-the/56672237#56672237", "title": "C : If as I understand 0 and &#39;\\0&#39; are the same, how does the compiler knows the size of an array when I write int my_array = {0};?", "body": "<p><strong>TL/DR</strong> - You will need to pass the array size as a separate parameter to your function.  Sentinel values like <code>0</code> only mark the <em>logical</em> end of a sequence, not the end of the array itself.  </p>\n\n<p>Unless it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is a string literal used to initialize a character array in a declaration, an <em>expression</em> of type \"N-element array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression will be the address of the first element of the array.  So when you pass your source and destination arrays as arguments to <code>copy</code>, what the function actually receives is just two pointers.  </p>\n\n<p>There's no metadata associated with a pointer that tells it whether it's pointing to the first object in a sequence, or how long that sequence is<sup>1</sup>.  A sentinel value like the 0 terminator in strings only tells you how long a <em>logical</em> sequence of values is, not the size of the array in which they are stored<sup>2</sup>.</p>\n\n<p>You will need to supply at least one more parameter to <code>copy</code> to tell it how large the target buffer is, so you stop copying when you've reached the end of the target buffer or you see a <code>0</code> in the source buffer, whichever comes first.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n\n<li>The same is true for array objects - there's no runtime metadata in the array object to store the size or anything else.  The only reason the <code>sizeof</code> trick works is that the array's declaration is in scope.  The array object itself doesn't know how big it is. \n\n<li>This is a problem for library functions like <code>strcpy</code>, which only receives the starting address for each buffer - if there are more characters in the source buffer than the target is sized to hold, <code>strcpy</code> will blast right past the end of the target buffer and overwrite whatever follows.  \n</ol>\n\n<p></sup></p>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 0, "last_activity_date": 1560963659, "creation_date": 1560963659, "answer_id": 56672666, "question_id": 56671562, "link": "https://stackoverflow.com/questions/56671562/c-if-as-i-understand-0-and-0-are-the-same-how-does-the-compiler-knows-the/56672666#56672666", "title": "C : If as I understand 0 and &#39;\\0&#39; are the same, how does the compiler knows the size of an array when I write int my_array = {0};?", "body": "<p>In C there is the concept of <em>complete</em> and <em>incomplete array</em>.  You can use the syntactic sugar in initialization <code>arr[X] = {0}</code> only for complete arrays.</p>\n"}], "owner": {"reputation": 65, "user_id": 10469162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad9f5aab6116c2a853861fbaf62f33c?s=128&d=identicon&r=PG&f=1", "display_name": "cassepipe", "link": "https://stackoverflow.com/users/10469162/cassepipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 56672237, "answer_count": 4, "score": 2, "last_activity_date": 1607150765, "creation_date": 1560959126, "last_edit_date": 1560959558, "question_id": 56671562, "link": "https://stackoverflow.com/questions/56671562/c-if-as-i-understand-0-and-0-are-the-same-how-does-the-compiler-knows-the", "title": "C : If as I understand 0 and &#39;\\0&#39; are the same, how does the compiler knows the size of an array when I write int my_array = {0};?", "body": "<p>I am trying to create a function to copy an array into another using pointers. I'd like to add the following condition : if the array of destination is smaller, the loop must break.</p>\n\n<p>So basically it's working, but it is not working if I intilize the the destination array as follows :</p>\n\n<p>int dest_array[10] = {0};</p>\n\n<p>From what I understand it fills the array with int 0's which are equivalent to '\\0' (null characters). So here is my question :</p>\n\n<p>In this case how can the computer know the array size or when it ends ?</p>\n\n<p>(And how do I compare arrays passed as parameters ?)</p>\n\n<pre><code>void copy(int *src_arr, int *dest_arr)\n{\n    // The advantage of using pointers is that you don't need to provide the source array's size\n\n        // I can't use sizeof to compare the sizes of the arrays because it does not work on parameters.\n        // It returns the size of the pointer to the array and not of of the whole array\n\n    int* ptr1;\n    int* ptr2;\n\n    for(     ptr1 = source, ptr2 = dest_arr ;\n        *ptr1 != '\\0'              ;        \n             ptr1++, ptr2++            )\n    {   \n        if(!*ptr2) // Problem here if dest_arr full of 0's\n                { \n                     printf(\"Copy interrupted :\\n\" +\n                            \"Destination array is too small\"); \n                     break; \n                }\n\n        *ptr2 = *ptr1;\n    }\n</code></pre>\n"}, {"tags": ["c", "file", "private-key", "der", "gnutls"], "comments": [{"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1560959970, "post_id": 56671277, "comment_id": 99910990, "body": "Couple of obvious issues: (1) <code>file_to_char</code> definitely needs to be type <code>int</code>, particularly with binary files, otherwise you have no way to distinguish <code>EOF</code> from a valid byte with the same bit pattern - using <code>fread()</code> may be easier here; (2) you should be using <code>&quot;rb&quot;</code> as the mode for <code>fopen()</code>, although this shouldn&#39;t make any difference on a POSIX system."}, {"owner": {"reputation": 1, "user_id": 11189454, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5XGUEB9xXug/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfx2-G37beGJ1bJLeqWfBUUcaaHOw/mo/photo.jpg?sz=128", "display_name": "Lucid lynx", "link": "https://stackoverflow.com/users/11189454/lucid-lynx"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1561018246, "post_id": 56671277, "comment_id": 99929202, "body": "Thanks you so much Paul. It worked and now I&#39;m able to import the private key."}], "owner": {"reputation": 1, "user_id": 11189454, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5XGUEB9xXug/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfx2-G37beGJ1bJLeqWfBUUcaaHOw/mo/photo.jpg?sz=128", "display_name": "Lucid lynx", "link": "https://stackoverflow.com/users/11189454/lucid-lynx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560958181, "creation_date": 1560958181, "question_id": 56671277, "link": "https://stackoverflow.com/questions/56671277/importing-der-encoded-private-key-using-gnutls-library-fails", "title": "Importing DER encoded private key using GnuTLS library fails", "body": "<p>I need to import a private key (.der format) to the gnutls_x509_privkey_t structure. For that, I first parsed the DER private key file into char[] using file operations. Then I have used gnutls_x509_privkey_import2 API to import the private key (char[]). </p>\n\n<p>While importing, it returns with an error \"<strong>ASN1 parser: Error in DER parsing</strong>\". </p>\n\n<p><strong><em>Note:</em></strong> When I try to parse the PEM encoded private key instead of using DER, the import API works fine. Am I making any mistake at the parsing of a DER file to char[] or is there a way to parse DER file? </p>\n\n<p>Also, I <strong>don't want to use gnutls_load_file API</strong> to load the DER private key.</p>\n\n<p>I have attached the sample code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;gnutls/gnutls.h&gt;\n#include &lt;gnutls/x509.h&gt;\n#include &lt;gnutls/abstract.h&gt;\n\nint main()\n{\nchar key_der[1675];\nchar file_to_char;\nFILE *fptr;\nint length;\ngnutls_x509_privkey_t pkey;\nint ret;\ngnutls_datum_t key;\n\nret = gnutls_x509_privkey_init(&amp;pkey);\nif (ret &lt; 0) {\n    printf(\"gnutls_x509_privkey_init: %d\\n\", ret);\n}\n\nif ((fptr = fopen(\"&lt;privatekey_filename&gt;.der\", \"r\")) == NULL)\n{\n    printf(\"Error! opening file\\n\");\n    // Program exits if file pointer returns NULL.\n    exit(1);\n}\n\nint i = 0;\nfile_to_char = fgetc(fptr);\nwhile (file_to_char != EOF)\n{\n    key_der[i] = file_to_char;\n    i++;\n    file_to_char = fgetc(fptr);\n}\nkey_der[i] = EOF;\n\nkey.data = (void *) key_der;\nkey.size = i;\n\nret = gnutls_x509_privkey_import2(pkey, &amp;key, GNUTLS_X509_FMT_DER, NULL, 0);\nif (ret &lt; 0) {\n    printf(\"\\nret value = %d\\n\", ret);\n    printf(\"gnutls_x509_privkey_import2: %s\\n\", gnutls_strerror(ret));\n}\n\nfclose(fptr);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "documentation", "system-calls", "xv6"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1560959797, "post_id": 56670751, "comment_id": 99910905, "body": "By &quot;the actual open&quot; do you mean the subroutine named <code>open</code> in the C runtime library, which will be a tiny wrapper around an <code>int</code> instruction to transfer control to the kernel, or do you mean the code inside the kernel that fields system-call traps and dispatches to <code>sys_open</code>?  (The latter appears to be in <code>trapasm.S</code>, <code>traps.c</code>, and <code>syscall.c</code>.  The former is not part of the xv6-public code repository; consult your instructor for where to find the C library.)"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1560960035, "post_id": 56670751, "comment_id": 99911020, "body": "what course of OS do you take to build xv6 ?"}, {"owner": {"reputation": 59, "user_id": 10578282, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VUHtenXERtY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDc0pXer6zijgsoGFFVfeVpCbq2DA/mo/photo.jpg?sz=128", "display_name": "Flacarile", "link": "https://stackoverflow.com/users/10578282/flacarile"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1560961553, "post_id": 56670751, "comment_id": 99911690, "body": "@zwol I mean whatever is the first thing that runs when you call open() in a program. i.e: int fd = open(&quot;temp&quot;, O_RDONLY);"}, {"owner": {"reputation": 59, "user_id": 10578282, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VUHtenXERtY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDc0pXer6zijgsoGFFVfeVpCbq2DA/mo/photo.jpg?sz=128", "display_name": "Flacarile", "link": "https://stackoverflow.com/users/10578282/flacarile"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1560961681, "post_id": 56670751, "comment_id": 99911737, "body": "@alinsoar Currently taking Operating System Fundamentals at the U of Windsor. Xv6 was recently introduced into our curriculum. As for building, we simply did a github install. Our bash guy installed a make qemu command. not sure how it runs"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1560961865, "post_id": 56670751, "comment_id": 99911817, "body": "Wonderful idea to implement xv6.  Could I find the laboratory materials posted online ?  Are you using raspberry-pi to have it run or how do you do ?"}, {"owner": {"reputation": 59, "user_id": 10578282, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VUHtenXERtY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDc0pXer6zijgsoGFFVfeVpCbq2DA/mo/photo.jpg?sz=128", "display_name": "Flacarile", "link": "https://stackoverflow.com/users/10578282/flacarile"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1560963472, "post_id": 56670751, "comment_id": 99912493, "body": "@alinsoar No raspberry-pi. I simply log in to my university&#39;s ssh, and am able to run it."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1560967781, "post_id": 56670751, "comment_id": 99914452, "body": "@Flacarile OK, you&#39;re talking about the <code>open</code> subroutine in the user-mode runtime library.  That code is not part of the xv6-public Git repository, nor do I see it anywhere on the PDOS or 6.828 websites.  You need to ask your instructor where to find the source code for the user-mode runtime library (often called &quot;the C library&quot;, for historical reasons) being used for your course.  We probably can&#39;t help you any further."}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 1, "last_activity_date": 1562077630, "last_edit_date": 1562077630, "creation_date": 1562066710, "answer_id": 56851393, "question_id": 56670751, "link": "https://stackoverflow.com/questions/56670751/location-of-the-definition-of-open-in-xv6/56851393#56851393", "title": "Location of the definition of open() in xv6", "body": "<p>Well,</p>\n\n<p><code>open</code> is declared in <a href=\"https://github.com/mit-pdos/xv6-public/blob/master/user.h\" rel=\"nofollow noreferrer\">user.h</a>. </p>\n\n<p><code>open</code> is defined in <a href=\"https://github.com/mit-pdos/xv6-public/blob/master/usys.S\" rel=\"nofollow noreferrer\">usys.S</a>:</p>\n\n<p>Lets see:</p>\n\n<pre><code>SYSCALL(open)\n</code></pre>\n\n<p>Will be transformed in </p>\n\n<pre><code>  .globl open; \n  open: \n    movl $SYS_ ## open, %eax; \n    int $T_SYSCALL; \n    ret\n</code></pre>\n\n<p>What happened?</p>\n\n<p>When function <code>open</code> is called </p>\n\n<ul>\n<li>register <code>%eax</code> is set to <code>SYS_open</code> (which value is 15 (see <a href=\"https://github.com/mit-pdos/xv6-public/blob/master/syscall.h\" rel=\"nofollow noreferrer\">syscall.h</a>) and <code>SYS_open</code> is defined in <a href=\"https://github.com/mit-pdos/xv6-public/blob/master/sysfile.c\" rel=\"nofollow noreferrer\">sysfile.c</a></li>\n<li>interuption <code>T_SYSCALL</code> (64 see <a href=\"https://github.com/mit-pdos/xv6-public/blob/master/traps.h\" rel=\"nofollow noreferrer\">traps.h</a>)  is raised.</li>\n<li>after the system call returned, <code>open</code> returns too.</li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 10578282, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VUHtenXERtY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDc0pXer6zijgsoGFFVfeVpCbq2DA/mo/photo.jpg?sz=128", "display_name": "Flacarile", "link": "https://stackoverflow.com/users/10578282/flacarile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562077630, "creation_date": 1560956485, "last_edit_date": 1560957230, "question_id": 56670751, "link": "https://stackoverflow.com/questions/56670751/location-of-the-definition-of-open-in-xv6", "title": "Location of the definition of open() in xv6", "body": "<p>I have an assignment that has me design my own system call. To do this, I would like to view the definition of the open system call. By this, I mean I would like to see how the actual open(const char*, const int) is defined, not sys_open (Since I know where the source code is and can read it).</p>\n\n<p>In both xv6's documentation and files in xv6-public, I am unable to find any reference of the prototype of definition.\nThe theory of my friend and I is that it's defined in some asm file, or some .o file.\nWould anyone happen to know where the actual source code is? I'd appreciate this greatly.</p>\n\n<p>Tried a ctrl-f for open in the source documentation, and tried a grep over all files in xv6-public. Found nothing.</p>\n"}, {"tags": ["c", "rpc"], "comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 2, "creation_date": 1560956118, "post_id": 56670483, "comment_id": 99908653, "body": "What is your input?"}, {"owner": {"reputation": 53, "user_id": 6912463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73a0259ab1eab2d513e259ca825c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Opresor", "link": "https://stackoverflow.com/users/6912463/opresor"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1560956242, "post_id": 56670483, "comment_id": 99908736, "body": "@Yastanub It&#39;s reading from a file, the input is 3:IBE3674:02-04-2019:19-45:Madrid:Berlin:Barajas:Tegel:IBERI&zwnj;&#8203;A:210:35:6:T4:60:N // Will add it to the main post"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1560956250, "post_id": 56670483, "comment_id": 99908741, "body": "What do you expect strtok to return and why?"}, {"owner": {"reputation": 53, "user_id": 6912463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73a0259ab1eab2d513e259ca825c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Opresor", "link": "https://stackoverflow.com/users/6912463/opresor"}, "edited": false, "score": 0, "creation_date": 1560956362, "post_id": 56670483, "comment_id": 99908806, "body": "Pointer to the next token so I can add it into a char pointer contained in a struct"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1560957836, "post_id": 56670483, "comment_id": 99909787, "body": "Well, if <code>strtok</code> returns <code>NULL</code> and afterwards your program crashes, you should think about checking the return value before using the <code>NULL</code> pointer. If you already pass <code>NULL</code> into <code>printf</code> you invoke undefined behaviour. Afterwards you still ignore the <code>NULL</code> and feed the pointer into <code>strlen</code> and <code>strndup</code>. A crash is not surprising if you feed <code>NULL</code> into tons of functions that are not expecting it"}, {"owner": {"reputation": 53, "user_id": 6912463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73a0259ab1eab2d513e259ca825c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Opresor", "link": "https://stackoverflow.com/users/6912463/opresor"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1560958430, "post_id": 56670483, "comment_id": 99910168, "body": "@Gerhardh Yeah, I know the crash is not surprising cause I know there is a null before, was more about the strtok returning null, thanks!"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1560958631, "post_id": 56670483, "comment_id": 99910292, "body": "I see. Maybe for future questions you put the things in the title that are not already clear for you."}, {"owner": {"reputation": 53, "user_id": 6912463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73a0259ab1eab2d513e259ca825c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Opresor", "link": "https://stackoverflow.com/users/6912463/opresor"}, "edited": false, "score": 0, "creation_date": 1560958785, "post_id": 56670483, "comment_id": 99910356, "body": "You are totally right, will do it and sorry"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6912463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73a0259ab1eab2d513e259ca825c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Opresor", "link": "https://stackoverflow.com/users/6912463/opresor"}, "edited": false, "score": 0, "creation_date": 1560958372, "post_id": 56671178, "comment_id": 99910139, "body": "So, I should make a copy of buffer into c2 and not just assign the pointer, right? Yeah, it worked, thanks you very much"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "reply_to_user": {"reputation": 53, "user_id": 6912463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73a0259ab1eab2d513e259ca825c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Opresor", "link": "https://stackoverflow.com/users/6912463/opresor"}, "edited": false, "score": 1, "creation_date": 1560961642, "post_id": 56671178, "comment_id": 99911727, "body": "@Opresor that would be one possibility but then you had the same string 2 times in memory(almost at least). You could also save the first tokens into an array and then reuse them later. Also note that strtok does not create new strings but only replaces the delimiters by 0 and then returns a pointer to the beginning of the token. So you actual string is not really split but just segmented. If you delete the Initial string, all tokens are invalidated."}], "tags": [], "owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "is_accepted": true, "score": 2, "last_activity_date": 1560957836, "creation_date": 1560957836, "answer_id": 56671178, "question_id": 56670483, "link": "https://stackoverflow.com/questions/56670483/strtok-r-returning-null/56671178#56671178", "title": "Strtok_r returning NULL", "body": "<p><code>strtok</code> does not simply modify the pointer it is passed but actually the string itself. It replaces each found delimiter with a <code>null</code> character. </p>\n\n<p>If you had string <code>test:strtok:for:me</code> and call <code>strtok</code> once you had <code>test\\0strtok:for:me</code> after that.</p>\n\n<p>So when you iterate ofer the first couple tokens each <code>:</code> is replaced with <code>\\0</code>. If you now reset your pointer <code>c2</code> to the beginning of the string and call strtok again, strtok finds a <code>null</code> charakter before it finds a delimiter and assumes the string ended before a delimiter is found and returns <code>NULL</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 6912463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73a0259ab1eab2d513e259ca825c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Opresor", "link": "https://stackoverflow.com/users/6912463/opresor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 56671178, "answer_count": 1, "score": 0, "last_activity_date": 1560958812, "creation_date": 1560955667, "last_edit_date": 1560958812, "question_id": 56670483, "link": "https://stackoverflow.com/questions/56670483/strtok-r-returning-null", "title": "Strtok_r returning NULL", "body": "<p>I'm trying to tokenize a string taken from a file. strtok_r works properly on the first sub string and then returns null (and segmentation fault cause I try to strndup into an other var)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char buffer[500];\nchar * c;\nchar * c1;\nchar * c2;\n//....\nwhile(fgets(buffer, sizeof(buffer), f) != NULL){\n    c2 = buffer;\n    printf(\"%s\\n\", buffer);\n    c = strtok(c2, \":\");\n    for(int i = 0; i &lt; 4; i++){\n        c = strtok(NULL, \":\");\n        printf(\"%s\\n\", c);\n    }\n    if(strcmp(c, argp-&gt;origen) == 0){\n        c = strtok(NULL, \":\");\n        printf(\"%s\\n\", c);\n        if(strcmp(c, argp-&gt;destino) == 0){\n            nodo = malloc(sizeof(lista_vuelo));\n            c2 = buffer;\n\n            c = strtok_r(c2, \":\", &amp;c1); \n            nodo-&gt;IdReg = atoi(c);\n            printf(\"\\n%d test\\n\", nodo-&gt;IdReg); //Works until here\n\n            c = strtok_r(NULL, \":\", &amp;c1);\n            printf(\"\\n%s\\n\", c); //Prints null and then segmentation fault\n\n            nodo-&gt;Idvuelo = strndup(c, strlen(c));\n            printf(\"\\n%s\\n\", nodo-&gt;Idvuelo);\n//....\n</code></pre>\n\n<blockquote>\n  <p>Input from file :</p>\n</blockquote>\n\n<p>3:IBE3674:02-04-2019:19-45:Madrid:Berlin:Barajas:Tegel:IBERIA:210:35:6:T4:60:N</p>\n\n<blockquote>\n  <p>Output :</p>\n</blockquote>\n\n<p>3 test -> Expected output</p>\n\n<pre><code>(null)\nViolaci\u00f3n de segmento (`core' generado) -&gt; Segmentation fault, (null) should be IBE3674\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560954567, "post_id": 56669960, "comment_id": 99907659, "body": "<i>but creating an IP address is the issue</i>  And just what is that issue?  Your computer reboots when you try to call <code>inet_aton()</code>?"}, {"owner": {"reputation": 25, "user_id": 11551547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBXEtwGoXpixzAVAQF_mP-B3hWruiUgXGeP06dt=k-s128", "display_name": "Matt ", "link": "https://stackoverflow.com/users/11551547/matt"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560954634, "post_id": 56669960, "comment_id": 99907697, "body": "when compiling I receive the error, or if I continue my program hangs until I exit the terminal"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1560954788, "post_id": 56669960, "comment_id": 99907785, "body": "Your server <i>really</i> listen on <code>88888</code>?"}, {"owner": {"reputation": 25, "user_id": 11551547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBXEtwGoXpixzAVAQF_mP-B3hWruiUgXGeP06dt=k-s128", "display_name": "Matt ", "link": "https://stackoverflow.com/users/11551547/matt"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1560954904, "post_id": 56669960, "comment_id": 99907863, "body": "@Mathieu No, it is just an example of what the input may be, I have a port assigned by the OS that is unique each time."}, {"owner": {"reputation": 32308, "user_id": 20270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37335856df5e5e73d82bca5a805bd647?s=128&d=identicon&r=PG", "display_name": "Hasturkun", "link": "https://stackoverflow.com/users/20270/hasturkun"}, "edited": false, "score": 0, "creation_date": 1560956476, "post_id": 56669960, "comment_id": 99908888, "body": "Have you tried <code>inet_aton(argv[1], &amp;server_info.sin_addr);</code> yet? (and note that <code>inet_aton()</code> returns a success value."}, {"owner": {"reputation": 25, "user_id": 11551547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBXEtwGoXpixzAVAQF_mP-B3hWruiUgXGeP06dt=k-s128", "display_name": "Matt ", "link": "https://stackoverflow.com/users/11551547/matt"}, "reply_to_user": {"reputation": 32308, "user_id": 20270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37335856df5e5e73d82bca5a805bd647?s=128&d=identicon&r=PG", "display_name": "Hasturkun", "link": "https://stackoverflow.com/users/20270/hasturkun"}, "edited": false, "score": 0, "creation_date": 1560958314, "post_id": 56669960, "comment_id": 99910108, "body": "@Hasturkun I tried it, and the program still continues to hang, but this compiler warning is no longer there, so I think it is a start"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 11551547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBXEtwGoXpixzAVAQF_mP-B3hWruiUgXGeP06dt=k-s128", "display_name": "Matt ", "link": "https://stackoverflow.com/users/11551547/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1561032217, "creation_date": 1561032217, "answer_id": 56685580, "question_id": 56669960, "link": "https://stackoverflow.com/questions/56669960/using-inet-aton-for-accepting-command-line-arguments-error/56685580#56685580", "title": "Using Inet_aton for accepting command line arguments error", "body": "<p>This is the solution that worked for me</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char ipadd[255];\n    strcpy(ipadd,argv[1]);\n    int portval = atoi(argv[2]);\n    struct sockaddr_in server_info, client_info;\n    int s_addrlen = sizeof(server_info);\n    int c_addrlen = sizeof(client_info);\n    memset(&amp;server_info, 0, s_addrlen);\n    memset(&amp;client_info, 0, c_addrlen);\n    server_info.sin_family = PF_INET;\n    server_info.sin_addr.s_addr = htonl(INADDR_ANY);\n    inet_aton(argv[1], &amp;server_info.sin_addr);\n    server_info.sin_port = htons(portval);\n\n\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11551547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBXEtwGoXpixzAVAQF_mP-B3hWruiUgXGeP06dt=k-s128", "display_name": "Matt ", "link": "https://stackoverflow.com/users/11551547/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561032217, "creation_date": 1560954070, "last_edit_date": 1560955081, "question_id": 56669960, "link": "https://stackoverflow.com/questions/56669960/using-inet-aton-for-accepting-command-line-arguments-error", "title": "Using Inet_aton for accepting command line arguments error", "body": "<p>I am trying to initialize a socket given command line arguments, argv1 is ip and argv2 is port. The port works as needed, but creating an IP address is the issue. A expect input would be ./client.out 10.5.10.20 88888\nThis is the client side, the server side creates the port number successfully.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    // Socket information\n    char ipadd[255];\n    strcpy(ipadd,argv[1]);\n    int portval = atoi(argv[2]);\n    struct sockaddr_in server_info, client_info;\n    int s_addrlen = sizeof(server_info);\n    int c_addrlen = sizeof(client_info);\n    memset(&amp;server_info, 0, s_addrlen);\n    memset(&amp;client_info, 0, c_addrlen);\n    server_info.sin_family = PF_INET;\n    server_info.sin_addr.s_addr = inet_aton(argv[1], &amp;server_info);\n    server_info.sin_port = htons(portval);\n\n\n</code></pre>\n\n<p>and I receive the warning when compiling</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>expected \u2018struct in_addr *\u2019 but argument is of type \u2018struct sockaddr_in *\u2019\n extern int inet_aton (const char *__cp, struct in_addr *__inp) __THROW;\n\n\n</code></pre>\n"}, {"tags": ["c", "gcc", "assembly", "language-lawyer", "x86-64"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1560954386, "post_id": 56669886, "comment_id": 99907557, "body": "I&#39;d say the point is to catch smaller arguments so I would expect it to throw a compilation error for <code>test[3]</code> ... except it doesn&#39;t. Maybe the compiler is not required to provide diagnostic or just <code>gcc</code> doesn&#39;t. <code>clang</code> does give a <code>warning: array argument is too small; contains 3 elements, callee requires at least 4 [-Warray-bounds]</code> PS: has nothing to do with assembly, it&#39;s a compilation time thing."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1560954990, "post_id": 56669886, "comment_id": 99907911, "body": "@Jester Just checked it in case of passing a smaller array. As you noted, adding <code>-Warray-bounds</code> to the compiler options does not give any warning. Maybe this is a gcc bug... ?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1560955170, "post_id": 56669886, "comment_id": 99908027, "body": "It&#39;s a bug if the standard says diagnostic is required. I do not have access to the standard, so I can&#39;t tell. But even <code>clang</code> is only providing a warning."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1560961977, "post_id": 56669886, "comment_id": 99911870, "body": "For the code you have provided, the <code>static</code> keyword is useless anyway: The <code>static</code> keyword allows the compiler to assume that the array has <i>at least</i> as many elements as indicated, but <i>if you access an index</i>, the compiler may <i>also</i> assume the index is valid, because accessing out of bounds would be undefined behavior. To construct a case where the feature <i>could</i> be useful, the access would have to be to a known index, but <i>conditional</i> on some run-time predicate. However, the feature is apparently not used much, so <code>gcc</code> doesn&#39;t make use of the freedom it offers."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1560983313, "post_id": 56672504, "comment_id": 99920361, "body": "Nice job finding a case where a compiler actually <i>does</i> take advantage of the guarantee that the whole array is there and readable.  Last time I played with <code>[static size]</code> on Godbolt I only found missed optimizations, IIRC, but I don&#39;t remember what exactly I tried."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1560985008, "post_id": 56672504, "comment_id": 99920714, "body": "The interesting thing is that this seems like a case where actual code would <i>not</i> want to make that guarantee. It seems like the zero element is a sentinel at the end of a dynamic-sized array, and you normally wouldn&#39;t want to allow access past it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1560985130, "post_id": 56672504, "comment_id": 99920743, "body": "And note that this probably wouldn&#39;t be a valid optimization for a <code>float</code> type, because of infinities and NaN. It takes advantage of a specific integer identity."}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1561034113, "post_id": 56672504, "comment_id": 99937708, "body": "@PeterCordes So the point of <code>static</code> is to make sure we don&#39;t get out of bound in case we access an array member with an index lesser than the size expression value?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "edited": false, "score": 3, "creation_date": 1561065208, "post_id": 56672504, "comment_id": 99953078, "body": "@St.Antario: yes, <code>foo(unsigned a[2])</code> is exactly equivalent to <code>foo(unsigned *a)</code>, and <code>a</code> is allowed to be pointing at the last int before an unmapped page.  <code>foo(unsigned a[static 2])</code> is different: the whole array object must be there.  (But <code>a</code>&#39;s type inside the function is still <code>unsigned *a</code>, not an actual array so you can&#39;t use <code>sizeof(a)</code> to get the array size. <a href=\"https://godbolt.org/z/6fz3jQ\" rel=\"nofollow noreferrer\">godbolt.org/z/6fz3jQ</a>)"}], "tags": [], "owner": {"reputation": 1476, "user_id": 538994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ab054203c7f091fb770b8fdc75b953?s=128&d=identicon&r=PG", "display_name": "dpi", "link": "https://stackoverflow.com/users/538994/dpi"}, "is_accepted": true, "score": 11, "last_activity_date": 1560962962, "creation_date": 1560962962, "answer_id": 56672504, "question_id": 56669886, "link": "https://stackoverflow.com/questions/56669886/static-keyword-in-an-array-function-parameter-declaration/56672504#56672504", "title": "Static keyword in an array function parameter declaration", "body": "<p>Here is an example where <code>static</code> actually makes a difference:</p>\n\n<pre><code>unsigned foo(unsigned a[2])\n{\n    return a[0] ? a[0] * a[1] : 0;\n}\n</code></pre>\n\n<p>clang (for x86-64, with -O3) compiles this to</p>\n\n<pre><code>foo:\n        mov     eax, dword ptr [rdi]\n        test    eax, eax\n        je      .LBB0_1\n        imul    eax, dword ptr [rdi + 4]\n        ret\n.LBB0_1:\n        xor     eax, eax\n        ret\n</code></pre>\n\n<p>But after replacing the function parameter with <code>unsigned a[static 2]</code>, the result is simply</p>\n\n<pre><code>foo:\n        mov     eax, dword ptr [rdi + 4]\n        imul    eax, dword ptr [rdi]\n        ret\n</code></pre>\n\n<p>The conditional branch is not necessary because <code>a[0] * a[1]</code> evaluates to the correct result whether a[0] is zero or not. But without the <code>static</code> keyword, the compiler cannot assume that a[1] can be accessed, and thus has to check a[0].</p>\n\n<p>Currently only clang does this optimization; ICC and gcc produce the same code in both cases.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 6, "last_activity_date": 1561023756, "creation_date": 1561023756, "answer_id": 56683181, "question_id": 56669886, "link": "https://stackoverflow.com/questions/56669886/static-keyword-in-an-array-function-parameter-declaration/56683181#56683181", "title": "Static keyword in an array function parameter declaration", "body": "<p>This isn't used much by compilers in my experience, but one use is that the compiler can assume that the (array decayed into pointer) parameter is not <code>NULL</code>.</p>\n\n<p>Given this function, both gcc and clang (x86) produce identical machine code at <code>-O3</code>:</p>\n\n<pre><code>int func (int a[2])\n{\n  if(a)\n    return 1;\n  return 0;\n}\n</code></pre>\n\n<p>Disassembly:</p>\n\n<pre><code>func:\n        xor     eax, eax\n        test    rdi, rdi\n        setne   al\n        ret\n</code></pre>\n\n<p>When changing the parameter to <code>int a[static 2]</code>, gcc gives the same output as before, but clang does a better job:</p>\n\n<pre><code>func: \n        mov     eax, 1\n        ret\n</code></pre>\n\n<p>Since clang realizes that <code>a</code> can never be NULL, so it can skip the check.</p>\n"}], "owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 2, "accepted_answer_id": 56672504, "answer_count": 2, "score": 6, "last_activity_date": 1561023756, "creation_date": 1560953877, "question_id": 56669886, "link": "https://stackoverflow.com/questions/56669886/static-keyword-in-an-array-function-parameter-declaration", "title": "Static keyword in an array function parameter declaration", "body": "<p>Here is the explanation of what it means 6.7.6.3/7:</p>\n\n<blockquote>\n  <p>If the keyword <code>static</code> also appears within the <code>[</code> and <code>]</code> of the array\n  type derivation, then for each call to the function, the value of the\n  corresponding actual argument shall provide access to the first\n  element of an array with at least as many elements as specified by the\n  size expression.</p>\n</blockquote>\n\n<p>It is not quite clear what it means. I ran the following example:</p>\n\n<p><code>main.c</code></p>\n\n<pre><code>#include \"func.h\"\n\nint main(void){\n    char test[4] = \"123\";\n    printf(\"%c\\n\", test_func(2, test));\n}\n</code></pre>\n\n<p>And 2 different implementations of the <code>test_func</code>:</p>\n\n<ol>\n<li>static version</li>\n</ol>\n\n<p><code>func.h</code></p>\n\n<pre><code>char test_func(size_t idx, const char[const static 4]);\n</code></pre>\n\n<p><code>func.c</code></p>\n\n<pre><code>char test_func(size_t idx, const char arr[const static 4]){\n    return arr[idx];\n} \n</code></pre>\n\n<ol start=\"2\">\n<li>non-static version</li>\n</ol>\n\n<p><code>func.h</code></p>\n\n<pre><code>char test_func(size_t idx, const char[const 4]);\n</code></pre>\n\n<p><code>func.c</code></p>\n\n<pre><code>char test_func(size_t idx, const char arr[const 4]){\n    return arr[idx];\n}\n</code></pre>\n\n<p>I checked the assembly code compiled with <code>gcc 7.4.0 -O3</code> of the function in both of the cases and it turned out to be completely identical:</p>\n\n<p>Disassembly of the functions</p>\n\n<pre><code>(gdb) disas main\nsub    rsp,0x18\nmov    edi,0x2\nlea    rsi,[rsp+0x4]\nmov    DWORD PTR [rsp+0x4],0x333231\nmov    rax,QWORD PTR fs:0x28\nmov    QWORD PTR [rsp+0x8],rax\nxor    eax,eax\ncall   0x740 &lt;test_func&gt;\n[...]\n\n(gdb) disas test_func \nmovzx  eax,BYTE PTR [rsi+rdi*1]\nret  \n</code></pre>\n\n<p>Can you give an example where the static keyword gives some benefits (or any differences at all) comparing to non-static counterpart?</p>\n"}, {"tags": ["c", "stm32", "can-bus"], "comments": [{"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1560954097, "post_id": 56669834, "comment_id": 99907360, "body": "When you say timeslices, do you mean single data points at that time, or do you mean blocks of points?"}, {"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "reply_to_user": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1560954169, "post_id": 56669834, "comment_id": 99907400, "body": "@yhyrcanus single datapoint at that time"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1560955847, "post_id": 56670337, "comment_id": 99908495, "body": "I&#39;m interested also to retrieve the data that is received , what type of storage should I use for that.. that&#39;s why I used a circular queue"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1560956066, "post_id": 56670337, "comment_id": 99908616, "body": "@andreahmed You should only need to store the latest message, so for standard CAN that would be an array of 8 bytes per message type."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "edited": false, "score": 0, "creation_date": 1560956789, "post_id": 56670337, "comment_id": 99909057, "body": "@andreahmed Just declare an array of 8 bytes per message type? <code>uint8_t foo [8];</code>. It could be wrapped in structures but apparently ST&#39;s &quot;HAL&quot; is returning raw arrays with the data payload."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1561467303, "last_edit_date": 1561467303, "creation_date": 1560955240, "answer_id": 56670337, "question_id": 56669834, "link": "https://stackoverflow.com/questions/56669834/synchronizing-different-messages/56670337#56670337", "title": "Synchronizing different messages", "body": "<p>You create a bit-field, and set a bit per received message type.</p>\n\n<pre><code>typedef enum\n{\n  RECEIVED_NONE = 0x00,\n  RECEIVED_ODO  = 0x01,\n  RECEIVED_VELO = 0x02,\n  RECEIVED_GPS  = 0x04,\n  RECEIVED_ALL  = RECEIVED_ODO | RECEIVED_VELO | RECEIVED_GPS,\n} can_received_t;\n\n\n\ncan_received_t can_received = RECEIVED_NONE;\n\nif(/* received odo */)\n{\n  can_received |= RECEIVED_ODO;\n}\n\n...\n\nif(can_received == RECEIVED_ALL)\n{\n  can_received = RECEIVED_NONE;\n  ...\n}\n</code></pre>\n\n<p>Storing queues seem fishy though. The normal procedure for CAN, being a real-time bus, is that you only keep the latest valid package and discard the rest. Particularly when dealing with sensors and control functions.</p>\n"}, {"tags": [], "owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "is_accepted": false, "score": 0, "last_activity_date": 1560955711, "creation_date": 1560955711, "answer_id": 56670501, "question_id": 56669834, "link": "https://stackoverflow.com/questions/56669834/synchronizing-different-messages/56670501#56670501", "title": "Synchronizing different messages", "body": "<p>You could just use the last value received every time. So you could receive a bunch of updates for the odometer, but only \"latch\" it in when the last of gps/velocity have been collected (pick one to sync to). If you're getting them from a system that periodically and predictably sends you messages, that's easy. You don't even need a queue, except for finalized values (if you want to see/use trending history).</p>\n\n<p>If you care about being synchronized <em>and</em> accurate, you could interpolate your velocity. Do the same thing as above for the odometer, and stop saving it once the GPS is collected. Collect 2 values for velocity (before the GPS collection, and after). Interpolate the velocity (linearly) to generate the velocity value at the GPS collection time. Then report that out. This will generate a synchronized and accurate value every time the velocity is collected, delayed by the offset between your velocity/GPS collection timestamps.</p>\n"}], "owner": {"reputation": 29, "user_id": 11511606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kaUQI0xrTpo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4OA9ip56Uye_6Jk1HJ-6PHuACAA/mo/photo.jpg?sz=128", "display_name": "andreahmed", "link": "https://stackoverflow.com/users/11511606/andreahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 56670337, "answer_count": 2, "score": -1, "last_activity_date": 1561467303, "creation_date": 1560953704, "question_id": 56669834, "link": "https://stackoverflow.com/questions/56669834/synchronizing-different-messages", "title": "Synchronizing different messages", "body": "<p>I think it's a general software paradigm problem, so it's not related that much to embedded software.</p>\n\n<p>I have 3 Messages that I get at different time slices, the three messages are\nOdo, velocity, gps. each one has timeslice 20ms, 1sec, and 1sec.</p>\n\n<p>My problem is how would I sync and get a complete message only when the three are already fetched. </p>\n\n<p>My current approach is to have three circural queues, and put three boolean variables and check if they are all in sync, but that doesn't work if for example odo which has timeslice 20ms, is pulled over and over without the other messages.</p>\n\n<p>Here is what I'm doing:</p>\n\n<pre><code>void HAL_CAN_RxFifo0MsgPendingCallback(CAN_HandleTypeDef *hcan)\n{\n\n  HAL_CAN_GetRxMessage(&amp;hcan1, CAN_RX_FIFO0, &amp;RxMessage, RxData);\n  static bool t1 = 0, t2=0, t3 =0;\n\n  if (RxMessage.StdId == 0x098)\n  {\n    insertCirQueue(&amp;q_velocity, 0x098);\n    HAL_GPIO_TogglePin(GPIOD, GPIO_PIN_12);\n    t1=1;\n  }\n  else if (RxMessage.StdId == 0x309)\n  {\n    /* Rx message Error */\n    insertCirQueue(&amp;q_Odo, 0x309);\n    t2=1;\n    HAL_GPIO_TogglePin(GPIOD, GPIO_PIN_13);\n  }\n  else if (RxMessage.StdId == 0x3EB)\n  {\n    /* Rx message Error */\n    insertCirQueue(&amp;q_Gps, 0x3EB);\n    t3=1;\n    HAL_GPIO_TogglePin(GPIOD, GPIO_PIN_14);\n  }\n\n  if (t1 &amp;&amp; t2 &amp;&amp; t3)\n  {\n    t2 = t3 = t1 = 0;\n    isSynced = true;\n  }\n}\n</code></pre>\n\n<p><strong>and in the main loop</strong> </p>\n\n<pre><code> if (isSynced)\n      {\n        isSynced = false;\n\n        int vel[8] = {0}, gps[8] = {0}, odo[8] = {0};\n        int counter = 0;\n        while (!isEmpty(&amp;q_velocity))\n        {\n          if (deleteCirQueue(&amp;q_velocity, &amp;vel[counter++]) == -1)\n              break;\n        }\n\n        counter = 0;\n        while (!isEmpty(&amp;q_Gps))\n        {\n          if(deleteCirQueue(&amp;q_Gps, &amp;gps[counter++]) == -1)\n              break;\n        }\n\n        counter = 0;\n        while (!isEmpty(&amp;q_Odo))\n        {\n\n          if(deleteCirQueue(&amp;q_Odo, &amp;odo[counter++]) == -1)\n             break;\n        }\n</code></pre>\n"}, {"tags": ["c", "windows", "string-concatenation", "c-strings"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 4, "creation_date": 1560952653, "post_id": 56669417, "comment_id": 99906453, "body": "You didn&#39;t actually post any code, nor say what problem(s) you are having with it."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1560953102, "creation_date": 1560953102, "answer_id": 56669617, "question_id": 56669417, "link": "https://stackoverflow.com/questions/56669417/create-directory-and-save-output-files-in-that-directory/56669617#56669617", "title": "Create directory and save output files in that directory", "body": "<p>Replace this</p>\n\n<pre><code>  fp1 = fopen(\"D:\\\\Courses\\\\directionname\\\\filename1.plt\", \"w\");\n</code></pre>\n\n<p>by</p>\n\n<pre><code>  char fullname[240];\n  sprintf(fullname, \"D:\\\\Courses\\\\%s\\\\%s\", directionname, filename1);\n  fp1 = fopen(fullname, \"w\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 11387389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41bebafd92a9f503d074e690405633f2?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/11387389/ali"}, "edited": false, "score": 0, "creation_date": 1560960303, "post_id": 56669623, "comment_id": 99911138, "body": "thanks for your answer but it doesn&#39;t work, error occurs"}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1560953111, "creation_date": 1560953111, "answer_id": 56669623, "question_id": 56669417, "link": "https://stackoverflow.com/questions/56669417/create-directory-and-save-output-files-in-that-directory/56669623#56669623", "title": "Create directory and save output files in that directory", "body": "<p>You do not use the <code>directionname</code> you've created.</p>\n\n<p>I guess you want something like:</p>\n\n<pre><code>char directionname[120];\nsprintf(directionname, \"Profile Iteration Number_%d\", it);\nmkdir(directionname);\n\nchar filename1[120];\nsprintf(filename1, \"Velocity Profile Iteration_%d.plt\", it);\n\nchar filepath[120];\nsprintf(filepath, \"D:\\\\Courses\\\\%s\\\\%s\", directionname, filename1);\n\nFILE * fp1;\nfp1 = fopen(filepath, \"w\"); \n\nif (!fp1)\n    perror(filepath);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 0, "last_activity_date": 1560961364, "creation_date": 1560961364, "answer_id": 56672111, "question_id": 56669417, "link": "https://stackoverflow.com/questions/56669417/create-directory-and-save-output-files-in-that-directory/56672111#56672111", "title": "Create directory and save output files in that directory", "body": "<pre><code>fp1 = fopen(\"D:\\\\Courses\\\\directionname\\\\filename1.plt\", \"w\");\n</code></pre>\n\n<p>It looks like from the above, that you're expecting <code>directionname</code> and <code>filename1</code> to be replaced by variables with those names. That isn't how strings work.</p>\n\n<p>You got things mostly right when you create the directory, but you don't appear to be in the right place when you run your program, so it'll create the new directory in your current directory not under \"D:\\Courses\\\". So you should change <code>directionname</code> to include the full path to where you want your new directory.</p>\n\n<pre><code>char directionname[120];\nsprintf(directionname, \"D:\\\\Courses\\\\Profile Iteration Number_%d\", it);\nmkdir(directionname);\n</code></pre>\n\n<p>And then you want to prepend the filename with that value like this</p>\n\n<pre><code>char filename1[120];\nsprintf(filename1, \"%s\\\\Velocity Profile Iteration_%d.plt\", directionname, it);\n</code></pre>\n\n<p><code>filename1</code> should now contain someting like \"D:\\Courses\\Profile Iteration Number_1\\Velocity Profile Iteration_1.plt\" which should allow you to open it like so...</p>\n\n<pre><code>FILE * fp1;\nfp1 = fopen(filename1, \"w\");\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11387389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41bebafd92a9f503d074e690405633f2?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/11387389/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 56672111, "answer_count": 3, "score": -1, "last_activity_date": 1560961364, "creation_date": 1560952551, "last_edit_date": 1560959725, "question_id": 56669417, "link": "https://stackoverflow.com/questions/56669417/create-directory-and-save-output-files-in-that-directory", "title": "Create directory and save output files in that directory", "body": "<p>I want to create a directory with variable name like <code>\"folder Iteration Number %d, Iteration\"</code> and after that save text output in that folder.</p>\n\n<p>Here is my code, the program makes the directory correctly but doesn't save the file in that, error occurs at the last line.</p>\n\n<p>I have tried this </p>\n\n<pre><code>fp1 = fopen(\"D:\\\\Courses\\\\filename1.plt\", \"w\"); \n</code></pre>\n\n<p>For the last line and it works but I want to write file in the specific folder that I have created.</p>\n\n<pre><code>char directionname[120];\nsprintf(directionname, \"Profile Iteration Number_%d\", it);\nmkdir(directionname);\nchar filename1[120];\nsprintf(filename1, \"Velocity Profile Iteration_%d.plt\", it);\nFILE * fp1;\nfp1 = fopen(\"D:\\\\Courses\\\\directionname\\\\filename1.plt\", \"w\"); \n</code></pre>\n"}, {"tags": ["c", "string", "segmentation-fault", "strtok", "string-literals"], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1560951417, "last_edit_date": 1560951417, "creation_date": 1560951053, "answer_id": 56668886, "question_id": 56668863, "link": "https://stackoverflow.com/questions/56668863/why-do-i-get-segmentation-fault-here/56668886#56668886", "title": "Why do I get segmentation fault here", "body": "<p>In this declaration</p>\n\n<pre><code>char *string =\"Test,string1,Test,string2:Test:string3\"; \n</code></pre>\n\n<p>there is defined a pointer that points to the first character of the string literal.</p>\n\n<p>And then you are trying to use the pointer to change the string literal.</p>\n\n<p>Take into account that the standard function <code>strtok</code> changes the passed to it string inserting the null terminating character at the point of the separator.</p>\n\n<p>You may not change string literals in C (and C++). They are immutable. Any attempt to change a string literal results in undefined behavior.</p>\n\n<p>Instead of the function <code>strtok</code> you could use functions <code>strspn</code> and <code>strcspn</code> to extract tokens. In this case you could process a string literal because these functions do not change passed to them strings.</p>\n"}, {"comments": [{"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1560954039, "post_id": 56669288, "comment_id": 99907330, "body": "Thanks for a well explained answer. It did happen to me once many years back and disk data got severely corrupted (that program had disk write also). I did not touch C for all these years!"}], "tags": [], "owner": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "is_accepted": true, "score": 0, "last_activity_date": 1560952789, "last_edit_date": 1560952789, "creation_date": 1560952159, "answer_id": 56669288, "question_id": 56668863, "link": "https://stackoverflow.com/questions/56668863/why-do-i-get-segmentation-fault-here/56669288#56669288", "title": "Why do I get segmentation fault here", "body": "<p>To answer your questions. <strong>This is why you receive a segfault</strong>:</p>\n\n<p>There is a fundamental difference between a string literal (such as what is declared with <code>char *string=\"Test,string1,Test,string2:Test:string3\";</code>) and a character array, which is the referenced version using <code>char[50]</code>.</p>\n\n<p>To provide a different persective of what is going wrong, here is what happens during compilation.</p>\n\n<p>In both scenarios, the constant string <code>\"Test,string1,Test,string2:Test:string3\"</code> is stored in the readonly data section of the binary. When you use <code>char *string</code>, you are assigning the location (pointer) of the constant string (in .rodata) to a variable on the stack. When you use <code>char string[50]</code> you are actually declaring an array of chars as storage on the stack, not a char pointer. The compiler actually performs this assignment in a different manner than what you may expect. In many cases, it will add a function call such as <code>memcpy</code> to initialize the character array. Something like this:</p>\n\n<pre><code>char string [50]\nmemcpy(string,\"Test,string1,Test,string2:Test:string3\",0x32);\n</code></pre>\n\n<p>This has the advantage of creating a local stack variable that can be manipulated through further functions such as <code>strtok</code>. However, you certainly cannot use the same functions to manipulate the original string in the readonly section of the binary. That is the fundamental difference. </p>\n\n<p>Everything else mentioned by @Vlad from Moscow is also relevant.</p>\n\n<p>Next question: <strong>Also, can segmentation fault cause damage to data on disk?</strong></p>\n\n<p>A segmentation fault occurs when an operation (read, write, execute) occurs in a memory segment that does not allow such operations. Most often, this occurs from attempting to read from or write to the location referenced by an invalid pointer. This is entirely a runtime concept. The fault is contained within the virtual memory of the process. Generally speaking, this will not cause harm to any secondary storage. There may exist edge cases (a segfault occurred after partially writing data to a file) where file in secondary storage may be corrupted, but the example you have shown is not such a case. To summarize, your disk should be fine unless a segfault occurs in the middle of a write to disk.</p>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "closed_date": 1560952968, "accepted_answer_id": 56669288, "answer_count": 2, "score": 1, "last_activity_date": 1560952789, "creation_date": 1560950989, "last_edit_date": 1560951424, "question_id": 56668863, "link": "https://stackoverflow.com/questions/56668863/why-do-i-get-segmentation-fault-here", "closed_reason": "Duplicate", "title": "Why do I get segmentation fault here", "body": "<p>I have modified code from <a href=\"https://fresh2refresh.com/c-programming/c-strings/c-strtok-function/\" rel=\"nofollow noreferrer\">here</a> replacing char[50] to char* in following code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main ()\n{\n  // change made in following line from char string[50]\n  char *string =\"Test,string1,Test,string2:Test:string3\"; \n  char *p;\n  printf (\"String  \\\"%s\\\" is split into tokens:\\n\",string);\n  p = strtok (string,\",:\");\n  while (p!= NULL)\n  {\n    printf (\"%s\\n\",p);\n    p = strtok (NULL, \",:\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>However, I get <code>segmentation fault</code> with above code. </p>\n\n<p>How can I use pointer version in above code?</p>\n\n<p>Also, can <code>segmentation fault</code> cause damage to data on disk?</p>\n"}, {"tags": ["c", "stm32", "i2c", "hal"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1560953990, "post_id": 56668846, "comment_id": 99907299, "body": "I don&#39;t think you can just write a string and expect it to appear on the LCD, it probably has commands that you need to send before the text."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1560954396, "post_id": 56668846, "comment_id": 99907562, "body": "(Or maybe you need to send 4 bits at a time with the other 4 of the octet being the command/mode.)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11670392, "user_type": "registered", "profile_image": "https://graph.facebook.com/2413242205409168/picture?type=large", "display_name": "Gaetan Kelabra", "link": "https://stackoverflow.com/users/11670392/gaetan-kelabra"}, "edited": false, "score": 0, "creation_date": 1561023996, "post_id": 56670991, "comment_id": 99932191, "body": "It&#39;s much more clear now. The I2C module&#39;s prupose is only to reduce the amont of cables, I still have to &quot;code&quot; the LCD. So in a way, using an I2C just makes it harder.  Anyway, I tried to use this tutoriel that I have seen before but did not understood at the time. <a href=\"https://www.controllerstech.com/i2c-lcd-in-stm32/\" rel=\"nofollow noreferrer\">controllerstech.com/i2c-lcd-in-stm32</a>  I only used the functions (replaced 0x4E with other values aswell : 0x3C, 0x3D, 0x7F, 0x7E)  I have no error but nothing shows on the screen"}], "tags": [], "owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "is_accepted": true, "score": 1, "last_activity_date": 1560957213, "creation_date": 1560957213, "answer_id": 56670991, "question_id": 56668846, "link": "https://stackoverflow.com/questions/56668846/f3discovery-trying-to-use-an-lcd-screen-1602-with-an-i2c-module/56670991#56670991", "title": "f3discovery: trying to use an lcd screen 1602 with an I2C module", "body": "<p>You expect it wrong.</p>\n\n<p>First of all\u0431 the I2C module, which is soldered on back, it is just simple serial-to parallel convertor. When you write data on I2C bus, it sets its 8 outputs according to 8 received bits in data bytes. When you read data bytes, it switches into input mode and read logical levels on 8 pins and transmits it over serial wire. More detailed description you can read in the <a href=\"https://www.nxp.com/docs/en/data-sheet/PCF8574_PCF8574A.pdf\" rel=\"nofollow noreferrer\">datasheet on PCF8574</a> you have provided.</p>\n\n<p>I.e. this part does not perform any \"magic\" which will take characters on input and output them on display. That means the outputting of random data is futile.</p>\n\n<p>You need to know two things more:</p>\n\n<ol>\n<li>how this module is connected to the display driver</li>\n<li>what kind of display driver is used and how to utilize it.</li>\n</ol>\n\n<p>Answer to the first question may be found in the Internet: \n<a href=\"https://i.stack.imgur.com/orFJn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/orFJn.png\" alt=\"I2C LCD module schematic\"></a> (taken from <a href=\"https://alselectro.wordpress.com/2016/05/12/serial-lcd-i2c-module-pcf8574/\" rel=\"nofollow noreferrer\">here</a>)</p>\n\n<p>You can see the display is connected in 4-bit mode, outputs <em>P4-P7</em> (i.e. what you transmit in four most significant bits of data bytes) are connected to data lines of the display, while outputs <em>P0-P2</em> are connected to control lines <em>RS</em>, <em>R/W</em>, <em>EH</em> and <em>P3</em> is used to control the backlight. </p>\n\n<p>Knowing this we came to the second question. I can only suggest, but more likely your display module have Hitachi HD44780 IC on it. In the <a href=\"https://www.sparkfun.com/datasheets/LCD/HD44780.pdf\" rel=\"nofollow noreferrer\">datasheet</a> on it you can found the information what data should be output on the control lines.</p>\n\n<p>You can find pin description at page 8:</p>\n\n<ul>\n<li>bit <strong>RS</strong> selects whatever it be a command (0) or a data (1)</li>\n<li>bit <strong>R/W</strong> chooses write opertion (0) or read (1)</li>\n<li>and bit <strong>E</strong> is actually a strobe. On the falling edge, i.e. when it changes from 1 to 0, the display driver reads data from data lines. That means to pass 4 bits of data you should perform 2 write operations: first one with bit 2 is set high, second with all other bits are the same, but the bit 2 is zero.</li>\n</ul>\n\n<p>Now you can read list of instructions at page 25 of datasheet. And initialization sequence for the 4-bit mode at page 46 (Figure 24). Note for each line of bits there you actually send 2 data bytes: with bit 2 high and then with bit 2 low.</p>\n\n<p>Note, in 4-bit mode all commands and data consist of two write phases: first - top half, then bottom half of a byte. Each phase is 2 data writes to I2C module, with E bit high and low, i.e. you'll need to send 4 bytes to output 1 byte of data.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9904399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c981cc7134026c457f2945680e9d7a5?s=128&d=identicon&r=PG&f=1", "display_name": "meteowrite", "link": "https://stackoverflow.com/users/9904399/meteowrite"}, "is_accepted": false, "score": 0, "last_activity_date": 1587932090, "creation_date": 1587932090, "answer_id": 61447468, "question_id": 56668846, "link": "https://stackoverflow.com/questions/56668846/f3discovery-trying-to-use-an-lcd-screen-1602-with-an-i2c-module/61447468#61447468", "title": "f3discovery: trying to use an lcd screen 1602 with an I2C module", "body": "<p>So basically in order to transmit data from you STM32 to the LCD display driver (HD44780) you need to emulate the latter's interface signalling via the I2C interface chip (PCF8574).</p>\n\n<p>In other words, MCU will send I2C commands that will toggle the I2C \"backpack\" chip such that it should emulate the <em>right</em> signaling for the LCD driver.</p>\n\n<p>This happens somehow easy whne you are using the HAL_I2C_Master_*() methods. In the buffer array you specify the state of the pins on the LCD as you want them and in the order [0], [1], [2]... etc. For example, let's say that we have DB[7:4] connected to the upper 4 bits of the PCF I2C expander. We can setup the following:</p>\n\n<pre><code>buffer[0] = 0xD0 ; // 0b11010000;\nbuffer[1] = 0xA0 ; // 0b10100000;\nbuffer[2] = 0xF0 ; // 0b11110000;\n\nHAL_I2C_Master_Transmit(&amp;hi2c1, adresseLCD, buffer, 3, 10); // Note 3 bytes are sent\n</code></pre>\n\n<p>Once the buffer is prepared, the HAL_I2C_Master_Transmit() call will send the tree bytes consecutively, thus toggling the DB pins as you have mentioned:</p>\n\n<pre><code>DB7: 1 -&gt; 1 -&gt; 1\nDB6: 1 -&gt; 0 -&gt; 1\nDB5: 0 -&gt; 1 -&gt; 1\nDB4: 1 -&gt; 0 -&gt; 1\n</code></pre>\n\n<p>The same can be applied to all 8 pins on the PCF chip. It is also worth noticing that this sequential IO update also creates a bit less of I2C communication overhead as it only addresses the I2C slave chip once :) . </p>\n\n<hr>\n\n<p>By the way, I am currently working on a LCD over I2C Library for STM32F1xx (probably it will fit other STM32F series). You can check it out on github (still WIP):</p>\n\n<p><a href=\"https://github.com/meteowrite/stm32_i2cLcd\" rel=\"nofollow noreferrer\">https://github.com/meteowrite/stm32_i2cLcd</a></p>\n\n<p>Cheers</p>\n"}], "owner": {"reputation": 3, "user_id": 11670392, "user_type": "registered", "profile_image": "https://graph.facebook.com/2413242205409168/picture?type=large", "display_name": "Gaetan Kelabra", "link": "https://stackoverflow.com/users/11670392/gaetan-kelabra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 56670991, "answer_count": 2, "score": 0, "last_activity_date": 1587932090, "creation_date": 1560950932, "question_id": 56668846, "link": "https://stackoverflow.com/questions/56668846/f3discovery-trying-to-use-an-lcd-screen-1602-with-an-i2c-module", "title": "f3discovery: trying to use an lcd screen 1602 with an I2C module", "body": "<p>I am trying to use an lcd screen on my stm32F3discovery.\nThe screen is made of an lcd 16 characters on 2 lines and an I2C module.</p>\n\n<p>Here is the link of the product:\n<a href=\"https://www.aliexpress.com/item/32763867041.html?spm=a2g0s.9042311.0.0.27424c4dsV7dLS\" rel=\"nofollow noreferrer\">https://www.aliexpress.com/item/32763867041.html?spm=a2g0s.9042311.0.0.27424c4dsV7dLS</a></p>\n\n<p>On the back of the screen I can see written: QAPASS 1602A\nOn the chip of the I2C module I can see written: PCF8574T</p>\n\n<p>Here is the datasheet of the chip:\n<a href=\"https://www.nxp.com/docs/en/data-sheet/PCF8574_PCF8574A.pdf\" rel=\"nofollow noreferrer\">https://www.nxp.com/docs/en/data-sheet/PCF8574_PCF8574A.pdf</a></p>\n\n<p>I tried to follow this tutoriel (the closest from what I am trying to do):\n<a href=\"https://www.youtube.com/watch?v=1COFk1M2tak\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=1COFk1M2tak</a></p>\n\n<p>I use the HAL library, the main function to send data is \"HAL_I2C_Master_Transmit\".</p>\n\n<p>Here is the description of the function in \"HAL_I2C_Master_Transmit\":</p>\n\n<ul>\n<li>@brief Transmits in master mode an amount of data in blocking mode.</li>\n<li>@param hi2c Pointer to a I2C_HandleTypeDef structure that contains the configuration information for the specified I2C.</li>\n<li>@param DevAddress Target device address: The device 7 bits address value in datasheet must be shifted to the left before calling the interface</li>\n<li>@param pData Pointer to data buffer</li>\n<li>@param Size Amount of data to be sent</li>\n<li>@param Timeout Timeout duration</li>\n<li>@retval HAL status</li>\n</ul>\n\n<p>HAL_StatusTypeDef HAL_I2C_Master_Transmit(I2C_HandleTypeDef *hi2c, uint16_t DevAddress, uint8_t *pData, uint16_t Size, uint32_t Timeout)</p>\n\n<pre><code>//I initialise a buffer\n//I use a for loop to find the address of my slave: 0x3D (even tho on the //datasheet it's 0x3F, looks like A1 is bridged :O )\n//I use the HAL_I2C_Master_Transmit function\n//I move the address one bit to the left\n//I reuse the HAL_I2C_Master_Transmit\n//Nothing happens on the screen\n\n//Here is my code (I tried to remove the useless comments):\n\n#include \"main.h\"\n\nI2C_HandleTypeDef hi2c1; // Init generated bu CubeMX\nSPI_HandleTypeDef hspi1; // Init generated bu CubeMX\nPCD_HandleTypeDef hpcd_USB_FS; // Init generated bu CubeMX\n\nuint16_t adresseLCD; // the variable I put the slave address on\nuint8_t buffer[]=\"123\"; // The buffer I wanna see on the screen\n\nvoid SystemClock_Config(void); // Generated by CubeMX\nstatic void MX_GPIO_Init(void); // Generated by CubeMX\nstatic void MX_I2C1_Init(void); // Generated by CubeMX\nstatic void MX_SPI1_Init(void); // Generated by CubeMX\nstatic void MX_USB_PCD_Init(void); // Generated by CubeMX\n\nint main(void)\n{\n    HAL_Init();\n    SystemClock_Config();\n    MX_GPIO_Init();\n    MX_I2C1_Init();\n    MX_SPI1_Init();\n    MX_USB_PCD_Init();\n\n    adresseLCD=0x3D;\n    HAL_I2C_Master_Transmit(&amp;hi2c1, adresseLCD, buffer, 1, 1000);\n\n    adresseLCD=adresseLCD*2; // Yes I could have used \"adresseLCD&lt;&lt;1\" but I \n    //am not used to that\n    HAL_I2C_Master_Transmit(&amp;hi2c1, adresseLCD, buffer, 1, 1000);\n\n    while(1)\n    {\n    }\n}\n</code></pre>\n\n<p>I expected something to show on the screen (even random values) but nothing appears (it lights up though).\nI get no error (only warnings because I use \"1\" instead of \"Pin_ON\" when I WritePIn)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 630, "user_id": 5141682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b29f5b1a276d5ed23eaace729b8be71?s=128&d=identicon&r=PG&f=1", "display_name": "Christina Jacob", "link": "https://stackoverflow.com/users/5141682/christina-jacob"}, "edited": false, "score": 0, "creation_date": 1560950196, "post_id": 56668557, "comment_id": 99904888, "body": "I found in the memoir all the variable declared in global, but I did not find the table and its contents in the memory. What did you mean?  How did you check?"}, {"owner": {"reputation": 4252, "user_id": 3103891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mZxsu.jpg?s=128&g=1", "display_name": "GalAbra", "link": "https://stackoverflow.com/users/3103891/galabra"}, "edited": false, "score": 0, "creation_date": 1560950203, "post_id": 56668557, "comment_id": 99904892, "body": "What do you mean by <i>did not find the table and its contents in the memory</i>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1560950210, "post_id": 56668557, "comment_id": 99904897, "body": "I&#39;m not really sure what you are asking, but this might be helpful: <a href=\"https://stackoverflow.com/questions/52855674/a-program-uses-different-regions-of-memory-for-static-objects-automatic-objects\">A program uses different regions of memory for static objects, automatic objects, and dynamically allocated objects</a>."}, {"owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "edited": false, "score": 0, "creation_date": 1560950567, "post_id": 56668557, "comment_id": 99905114, "body": "I mean, that after the execution of the code, I read the contents of the memory, (e.g I&#39;m working on a microcontroller, and I know where the data is saving) in I declare a global variable for example a = 10; when I read the contents of the memory I find the value 10 in the memory, but I do not find the content of the table that is 10,9,12,34,30"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1560950631, "post_id": 56668557, "comment_id": 99905155, "body": "Normally, arrays are stored in the same area of memory as any other variable type defined at the same point in the program source.  If it is a global or static array, it will be stored in the data segment; if it is local to a function (and not static) it will be stored on the stack."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1560950847, "post_id": 56668557, "comment_id": 99905295, "body": "Also a good overview : <a href=\"https://stackoverflow.com/questions/8385322/difference-between-static-memory-allocation-and-dynamic-memory-allocation\">Difference between static memory allocation and dynamic memory allocation</a>"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1560951193, "post_id": 56668557, "comment_id": 99905525, "body": "Also, is there some code that uses the array? It could be optimized away if it is not used. (And even if it is used, the optimizer might still not store it in a way you would expect, if it can produce the same result in other ways.)"}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1560951346, "post_id": 56668557, "comment_id": 99905609, "body": "1. What microcontroller are you using? 2. What compiler are you using? 3. How are you executing the program? 4. How are you viewing the memory?"}, {"owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1560951778, "post_id": 56668557, "comment_id": 99905875, "body": "@David I work on Aurix infineon, and I use Hightec as a compiler, I execute my code directly on the aurix, I read the memorition like this:          const volatile unsigned char * mem_start = 0xd0000000;          #define size ((ptrdiff_t) 0xfff)          unsigned char bufferf [size];         code ();        main(){       ... .     ..       ..       for (int e = 0; e &lt;sizeof (bufferf); e ++)       bufferf [e] = * (mem_start + e); // read memory }"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1560952170, "post_id": 56668557, "comment_id": 99906127, "body": "@Rbn As a quick observation, even if we disregard the undefined behaviour there, if the entire size of usable memory is indeed <code>size</code>, then <code>char bufferf[size]</code> cannot possibly fit in there together with <code>int e</code> and everything else. Also, why would you need to copy it into the <code>bufferf</code>, when you could just use <code>mem_start[e]</code> directly? On the other hand, if <code>size</code> is not the size of the entire memory, then you are not reading the entire memory\u2026"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1560952393, "post_id": 56668557, "comment_id": 99906268, "body": "(Also, if <code>bufferf</code> is stored in the same memory as whatever you are searching for, and there isn&#39;t enough memory for both \u2013 which there can&#39;t be if <code>size</code> is the total available memory size \u2013 you may well overwrite whatever you are searching for by writing to <code>bufferf</code>, which may overlap with it due to lack of space.)"}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1560963407, "post_id": 56668557, "comment_id": 99912463, "body": "Where does <code>0xd0000000</code> come from?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1560966351, "post_id": 56668557, "comment_id": 99913782, "body": "For one thing you&#39;re reading memory as bytes but your array is ints, so there will be extra zero bytes in memory. Have you printed the address of the array and looked there?"}, {"owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1561020195, "post_id": 56668557, "comment_id": 99930184, "body": "@Lee Daniel  yes c true it has many zero when I read the memory, what can I do to avoid that"}, {"owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1561020707, "post_id": 56668557, "comment_id": 99930461, "body": "@Arkku   Yes you are right, but how can I read and display the memory without the print in a buffer"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1561024917, "post_id": 56668557, "comment_id": 99932700, "body": "@Rbn If <code>size</code> is the size of the memory and it starts at <code>mem_start</code>, then <code>mem_start</code> itself is already a pointer to an array of <code>size</code> bytes, so you can use <code>mem_start</code> exactly as you would use <code>buffer_f</code> (with the exception that <code>sizeof mem_start</code> is not <code>size</code>, but since you already know <code>size</code>, it doesn&#39;t matter)."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "edited": false, "score": 0, "creation_date": 1560951327, "post_id": 56668890, "comment_id": 99905596, "body": "Thank you for your quick reply does that mean I can run my code without using the stack?"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "reply_to_user": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "edited": false, "score": 2, "creation_date": 1560951419, "post_id": 56668890, "comment_id": 99905657, "body": "@Rbn this means that in thinking your code you should not care if the compiler will use the stack or not."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 1, "last_activity_date": 1560951059, "creation_date": 1560951059, "answer_id": 56668890, "question_id": 56668557, "link": "https://stackoverflow.com/questions/56668557/where-are-arrays-stored-in-memory/56668890#56668890", "title": "Where are arrays stored in memory?", "body": "<pre><code>global variable is stored in memory, and the local variable is saved in the stack\n</code></pre>\n\n<p>This is false.  </p>\n\n<p>Global variables are sometimes kept in registers, not only in static memory.</p>\n\n<p>If the function is recursive the compiler may choose to use the stack or not.  If the function is tail recursive it is no need to use the stack as there is no continuation after the function returns and one can use the current frame for the next call.</p>\n\n<p>There are mechanical methods to convert the code in continuation passing style and in this equivalent form <a href=\"http://matt.might.net/articles/cps-conversion/\" rel=\"nofollow noreferrer\">it is evaluated stackless</a>.</p>\n\n<p>There are lots of mathematical models of computation and not all use the stack.  The code can be <a href=\"https://en.wikipedia.org/wiki/Turing_machine_equivalents\" rel=\"nofollow noreferrer\">converted from one model to other</a> keeping the same result after evaluation.</p>\n\n<p>You got these informations from books written in the 70s, 80s and in the meantime the process of evaluation of code was much improved (using methods that were theoretical in the 30s but nowadays are implemented in systems).</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "edited": false, "score": 0, "creation_date": 1561037088, "post_id": 56670038, "comment_id": 99939489, "body": "you can explain to me more what is it doing this code, I did not understand these 2 linens #define ARRAY_SIZE(array) \\     (sizeof(array) / sizeof(array[0]))  #define UNUSED(x) \\     (void)(x)"}], "tags": [], "owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "is_accepted": false, "score": 0, "last_activity_date": 1561051692, "last_edit_date": 1561051692, "creation_date": 1560954335, "answer_id": 56670038, "question_id": 56668557, "link": "https://stackoverflow.com/questions/56668557/where-are-arrays-stored-in-memory/56670038#56670038", "title": "Where are arrays stored in memory?", "body": "<p>This program may get you closer to what you want:</p>\n\n<pre><code>int tab[] = {10, 9, 12, 34, 30};\n\n// Used to get the number of elements in an array\n#define ARRAY_SIZE(array) \\\n    (sizeof(array) / sizeof(array[0]))\n\n// Used to suppress compiler warnings about unused variables\n#define UNUSED(x) \\\n    (void)(x)\n\nint main(void) {\n    int *tab_ptr;\n    int tab_copy[ARRAY_SIZE(tab)];\n    tab_ptr = tab;\n    UNUSED(tab_ptr);\n    for (int index = 0; index &lt; ARRAY_SIZE(tab_copy); index++) {\n        tab_copy[index] = tab[index];\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I don't have the Hightec environment to test this, nor do I have an Aurix to run it on. However, this may give you a starting point that helps you obtain the information you desire.</p>\n\n<p>It looks like the Infineon Aurix is a 32-bit little-endian machine. This means that an <code>int</code> will be 32-bits wide and the first byte will store the first 8 bits of the value. For example, the value 10 would be stored like this:</p>\n\n<pre><code>0a 00 00 00\n</code></pre>\n\n<p>If you try to read this memory as <code>char</code>, you will get <code>0x0a</code>, <code>0x00</code>, <code>0x00</code>, and <code>0x00</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "edited": false, "score": 0, "creation_date": 1561036912, "post_id": 56683909, "comment_id": 99939396, "body": "thank you very much you helped me too much, you helped me understand things and gave me ideas"}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 1, "last_activity_date": 1561037334, "last_edit_date": 1561037334, "creation_date": 1561026134, "answer_id": 56683909, "question_id": 56668557, "link": "https://stackoverflow.com/questions/56668557/where-are-arrays-stored-in-memory/56683909#56683909", "title": "Where are arrays stored in memory?", "body": "<p>The answer to the question of where arrays, or indeed any variables, are stored depends on whether you are considering the abstract machine or the real hardware. The C standard specifies how things work on the abstract machine, but a conforming compiler is free to do something else on the real hardware (e.g., due to optimization) if the <em>observable effects</em> are the same.</p>\n\n<p>(On the abstract machine, arrays are generally stored in the same place as other variables declared in the same scope would be.)</p>\n\n<p>For example, a variable might be placed in a register instead of the stack, or it might be optimized away completely. As a programmer you generally shouldn't care about this, since you can also just consider the abstract machine. (Admittedly there may be some cases where you do care about it, and on microcontrollers with very limited RAM one reason might be that you have to be very frugal about using the stack, etc.)</p>\n\n<p>As for your code for reading the memory: it cannot possibly work. If <code>size</code> is the size of the memory available to variables, you cannot fit the array <code>bufferf[size]</code> in that memory <em>together with everything else</em>.</p>\n\n<p>Fortunately, copying the contents of the memory to a separate buffer is not needed. Consider your line <code>bufferf[e] = *(mem_start + e)</code> \u2013 since you can already read an arbitrary index <code>e</code> from memory at <code>mem_start</code>, you can use <code>*(mem_start + e)</code> (or, better, <code>mem_start[e]</code>, which is exactly equivalent) directly everywhere you would use <code>bufferf[e]</code>! Just treat <code>mem_start</code> as pointing to the first element of an array of <code>size</code> bytes.</p>\n\n<p>Also note that if you are programmatically searching for the contents of the array <code>tab</code>, its elements are <code>int</code>s, so they are more than one byte each \u2013 you won't simply find five adjacent bytes with those values.</p>\n\n<p>(Then again, you can also just take the address of <code>tab[0]</code> and find out where it is stored, i.e., <code>((unsigned char *) tab) - mem_start</code> is the index of <code>tab</code> in <code>mem_start</code>. However, here observing it may change things due to the aforementioned optimization.)</p>\n"}], "owner": {"reputation": 59, "user_id": 11670525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxp3o2YyaXY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdR4nCLv2bMsZ_gjFa_jzoxJcZrIA/mo/photo.jpg?sz=128", "display_name": "Rbn", "link": "https://stackoverflow.com/users/11670525/rbn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 1, "accepted_answer_id": 56683909, "answer_count": 3, "score": 3, "last_activity_date": 1561051692, "creation_date": 1560950062, "last_edit_date": 1560952094, "question_id": 56668557, "link": "https://stackoverflow.com/questions/56668557/where-are-arrays-stored-in-memory", "title": "Where are arrays stored in memory?", "body": "<p>I know that the global variable is stored in memory, and the local variable is saved in the stack, and the stack will be destroyed after each use.</p>\n\n<p>But I do not know how an array is saved in memory.\nI tried to declare a global array:</p>\n\n<pre><code>  int tab[5]={10,9,12,34,30};\n</code></pre>\n\n<p>and at the end I read the contents of the memory, I mean, that after the execution of the code, I read the contents of the memory, (e.g I'm working on a microcontroller, and I know where the data is saving) when I declare a global variable for example a = 10; and when I read the contents of the memory I find the value 10 in the memory, but I do not find the content of the table that is 10,9,12,34,30</p>\n\n<p>I want to understand where the array content is it save in memory?</p>\n\n<p>I work on Aurix Infineon, and I use Hightec as a compiler, I execute my code directly on the aurix, I read the memorition like this:</p>\n\n<pre><code>const volatile unsigned char * mem_start = 0xd0000000;\n#define size ((ptrdiff_t) 0xfff)\nunsigned char bufferf [size];\ncode ();\nmain(){\n    ... \n    for (int e = 0; e &lt; sizeof (bufferf); e ++) \n        bufferf [e] = * (mem_start + e); // read memory\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560950307, "post_id": 56668465, "comment_id": 99904967, "body": "You really <b>can&#39;t</b> in pure C  much less in any &quot;reasonably portable way&quot;.  Just look for the GCC implementation of <code>__builtin_va_start()</code> for an example of what you&#39;d need to do."}, {"owner": {"reputation": 938, "user_id": 5502325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXFxy.jpg?s=128&g=1", "display_name": "Silveris", "link": "https://stackoverflow.com/users/5502325/silveris"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1560950425, "post_id": 56668465, "comment_id": 99905045, "body": "@AndrewHenle I think OP might actually be using C++ as he is using vectors"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1560950873, "post_id": 56668465, "comment_id": 99905312, "body": "My published API is C, and of course varargs is C, but I don&#39;t mind resorting to a little C++ when it helps."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1560952261, "post_id": 56668465, "comment_id": 99906186, "body": "I am not quite sure I understand what <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">your <i>actual</i> problem</a> here is, but I would be rather interested to hear it. You&#39;re talking about &quot;providing an answer to ftell&quot; in your &quot;own FILE-like wrapper&quot;. That sounds like you&#39;re implementing a C library...?!?"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1560952927, "post_id": 56668465, "comment_id": 99906647, "body": "The <a href=\"https://sourceware.org/libffi/\" rel=\"nofollow noreferrer\">libffi</a> project supports many ABIs, maybe it supports yours."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1560956247, "post_id": 56668465, "comment_id": 99908738, "body": "You might find some hints at <a href=\"https://stackoverflow.com/questions/34885868/c-late-binding-with-unknown-arguments\">this older question</a>."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1560959656, "post_id": 56668465, "comment_id": 99910838, "body": "@DevSolar Yes, something like that... a level of clib interception, but where possible falling back on the supplied functionality. So I have access to the standard library, and use it where I can."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1560959936, "post_id": 56668465, "comment_id": 99910968, "body": "@GemTaylor: If you are interested in discussing your approach with someone who&#39;s (in the process of) implementing a C library that is <i>designed</i> to make tinkering / adjusting it as easy as possible (and who&#39;d be interested if my approach would actually work for you), find me at <a href=\"http://pdclib.rootdirectory.de\" rel=\"nofollow noreferrer\">pdclib.rootdirectory.de</a>..."}], "answers": [{"tags": [], "owner": {"reputation": 219, "user_id": 2553424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4v5s.png?s=128&g=1", "display_name": "Arhadthedev", "link": "https://stackoverflow.com/users/2553424/arhadthedev"}, "is_accepted": false, "score": 1, "last_activity_date": 1560951619, "last_edit_date": 1560951619, "creation_date": 1560950943, "answer_id": 56668850, "question_id": 56668465, "link": "https://stackoverflow.com/questions/56668465/how-to-create-an-args-list-for-vscanf-vprinf-directly/56668850#56668850", "title": "How to create an args list for vscanf / vprinf directly?", "body": "<p>Argument lists, be they fixed or variable sized, are static compile-time entities. So in runtime you can read them, but not create. Use conventional pointers instead.</p>\n\n<p>The sole purpose of <code>va_list</code> is an iteration through arguments because nothing else provides durable access to them. So treat it as a roundabout for a specific feature of a language (a possibility to pass more arguments than specified in a prototype), not intended to be used anywhere else.</p>\n"}, {"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1562839890, "creation_date": 1562839890, "answer_id": 56986832, "question_id": 56668465, "link": "https://stackoverflow.com/questions/56668465/how-to-create-an-args-list-for-vscanf-vprinf-directly/56986832#56986832", "title": "How to create an args list for vscanf / vprinf directly?", "body": "<p>X-Y answer: In the end I used fopencookie and vfscanf on that, so I didn't have to process the arguments nor process the format string.</p>\n"}], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562839890, "creation_date": 1560949795, "question_id": 56668465, "link": "https://stackoverflow.com/questions/56668465/how-to-create-an-args-list-for-vscanf-vprinf-directly", "title": "How to create an args list for vscanf / vprinf directly?", "body": "<p>I know how to call vprintf, etc from an implementation of printf, correspondingly.</p>\n\n<p>But what if I want to create an argument list dynamically in code, especially for <code>vsscanf</code>, where I know they are all pointers?</p>\n\n<p>Is there some reasonably portable way that I can convert my dynamically allocated and filled array of pointers (actually a std::vector) into a va_list?</p>\n\n<p>This is all so that I can add a %n argument to the end and detect how much input was actually consumed, in order to provide an answer to ftell in my own FILE-like wrapper.</p>\n\n<p>Other than doing something hairy with a pipe; or writing my own implementation; or splitting the string and doing one argument at a time; I don't see how else I can detect the input stream usage, especially for sscanf. So other ideas to that end might be interesting.</p>\n"}, {"tags": ["c", "arrays", "random", "probability"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1560949132, "post_id": 56668105, "comment_id": 99904202, "body": "@Blaze hesitant at that. The accepted answer is somewhat adaptable but clearly all other answers there are very much C++ only."}, {"owner": {"reputation": 1846, "user_id": 2550541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTSrG.jpg?s=128&g=1", "display_name": "Luca Cappelletti", "link": "https://stackoverflow.com/users/2550541/luca-cappelletti"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1560949170, "post_id": 56668105, "comment_id": 99904230, "body": "@Blaze in particular there it works since the weights are integers, these are floats."}, {"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1560949265, "post_id": 56668105, "comment_id": 99904290, "body": "Surely you can tweak the code so that it works with floats. The type of the weights really doesn&#39;t matter. In any event, the basic question is somewhat language agnostic. Variations of it have been asked on Stack Overflow for just about all programming languages, with the answer being essentially the same (unless the language in question already implements it in a library)."}, {"owner": {"reputation": 1846, "user_id": 2550541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTSrG.jpg?s=128&g=1", "display_name": "Luca Cappelletti", "link": "https://stackoverflow.com/users/2550541/luca-cappelletti"}, "edited": false, "score": 0, "creation_date": 1560949592, "post_id": 56668105, "comment_id": 99904483, "body": "You are right, I&#39;ve voted to close as duplicate. I&#39;m getting a coffee."}], "answers": [{"tags": [], "owner": {"reputation": 490, "user_id": 8240510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d09259a12a30042981f4d6e0d1f79f?s=128&d=identicon&r=PG&f=1", "display_name": "Elbek", "link": "https://stackoverflow.com/users/8240510/elbek"}, "is_accepted": false, "score": -1, "last_activity_date": 1560949371, "creation_date": 1560949371, "answer_id": 56668313, "question_id": 56668105, "link": "https://stackoverflow.com/questions/56668105/extract-number-with-given-probabilities-in-c/56668313#56668313", "title": "Extract number with given probabilities in C", "body": "<p>Generate one random float value from 0 to <code>sum of all probabilities</code>.</p>\n\n<pre><code>float probabilities[] = [0.1, 0.2, 0.1, 0.15, 0.05, 0.1, 0.4];\n\nfloat x = 0.0000001+(float)rand()/(float)(RAND_MAX/sum_probabilites);\nfloat temp = 0;\nint i=0;\nint n = 7;\nint number = 0;\nfor(i=0; i&lt;n; i++)\n{\n   temp+=probabilites[i];\n   if(x&lt;=temp)\n   {\n       number = i+1;\n       break;\n   }\n\n}\n// int number contains value\n</code></pre>\n\n<p>Main idea is that you generate one float number and check if number belongs to range of probabilities.</p>\n"}], "owner": {"reputation": 1846, "user_id": 2550541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTSrG.jpg?s=128&g=1", "display_name": "Luca Cappelletti", "link": "https://stackoverflow.com/users/2550541/luca-cappelletti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "closed_date": 1560951837, "answer_count": 1, "score": 1, "last_activity_date": 1560949371, "creation_date": 1560948710, "last_edit_date": 1560949134, "question_id": 56668105, "link": "https://stackoverflow.com/questions/56668105/extract-number-with-given-probabilities-in-c", "closed_reason": "Duplicate", "title": "Extract number with given probabilities in C", "body": "<p>Let's say I have an array <code>probabilities = [0.1, 0.2, ..., 0.1, 0.4]</code> of <code>n</code> elements. These are floating point values, not integer weights.</p>\n\n<p>How do I extract a random integer from <code>1</code> to <code>n</code> with the given probabilities in Ansi C?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>probabilities = [0.1, 0.2, 0.1, 0.15, 0.05, 0.1, 0.4]\nextract_random_integer(probabilities)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 2, "creation_date": 1560948916, "post_id": 56668075, "comment_id": 99904056, "body": "You have to take into account 31 characters per line (30 letters followed by <code>\\n</code>), or possibly even 32 characters per line (30 letters followed by <code>\\r\\n</code>). Which means that you might want to check the format of your input file to begin with. And regardless of that, it&#39;s probably best to use <code>fseek</code> then <code>fread</code>."}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 3, "creation_date": 1560948942, "post_id": 56668075, "comment_id": 99904078, "body": "FWIW, <code>fread</code> doesn&#39;t care about EOL characters at all."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1560949022, "post_id": 56668075, "comment_id": 99904122, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">While is while (!feof(fp)) always wrong</a>. <code>fread</code> doesn&#39;t &quot;specially&quot; handle newline charaacters, it&#39;s just a character. Also it returns number of of read characters and the resulting data are not null terminated."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1560949035, "post_id": 56668075, "comment_id": 99904131, "body": "I think there are two problems here:  (1) You aren&#39;t taking into account that each line ends with a newline, which is a character.  So to read 2 lines, you need to read 30 + 1 + 30 characters = 61 characters, not 60.  You probably also want to strip out the newlines, and add your own back to it after every 30 characters.   And (2) you aren&#39;t adding a null character to the end of your buffer, so when you try to print it as a string, it&#39;s going right past the end until it happens to encounter a random zero byte in memory."}, {"owner": {"reputation": 1187, "user_id": 3205558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ffc8fc604953fb170da4593973045d8?s=128&d=identicon&r=PG", "display_name": "vlumi", "link": "https://stackoverflow.com/users/3205558/vlumi"}, "edited": false, "score": 0, "creation_date": 1560949178, "post_id": 56668075, "comment_id": 99904237, "body": "In your own loop using <code>fgetc</code> you add the null at the end of the string, but I think your indexes are off -- you should add it to the position of <code>i</code> when you <code>break</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1560949236, "post_id": 56668075, "comment_id": 99904271, "body": "If you&#39;re seeking in a file then you must open the file in <i>binary</i> mode. <code>fseek</code> works in text files only to seek to an offset that was returned by <code>ftell</code>."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 11670067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Rmh3G88QAM/AAAAAAAAAAI/AAAAAAAAAM8/6-FZ_5ml8mI/photo.jpg?sz=128", "display_name": "Kostis L", "link": "https://stackoverflow.com/users/11670067/kostis-l"}, "edited": false, "score": 1, "creation_date": 1561112030, "post_id": 56669876, "comment_id": 99966392, "body": "Thank you for your detailed answer! However, there&#39;s still one thing that still confuses me. Assume we have 90 characters in a single line and start=1(first character), end=90(last one). Then the characters are not end-start but end-start+1. So, if that&#39;s true,  it should be char_to_read=end-start +1. What am I missing? Btw, sry for some undefined variables, they&#39;re either missing due to the code being only a part of a function, or because I forgot to change their names when I copy-pasted them (e.g. &#39;exon&#39; is actually &#39;string&#39;)."}, {"owner": {"reputation": 554, "user_id": 5306039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b2908132960fc726570b38fe4266?s=128&d=identicon&r=PG&f=1", "display_name": "shubham", "link": "https://stackoverflow.com/users/5306039/shubham"}, "reply_to_user": {"reputation": 83, "user_id": 11670067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Rmh3G88QAM/AAAAAAAAAAI/AAAAAAAAAM8/6-FZ_5ml8mI/photo.jpg?sz=128", "display_name": "Kostis L", "link": "https://stackoverflow.com/users/11670067/kostis-l"}, "edited": false, "score": 0, "creation_date": 1561113996, "post_id": 56669876, "comment_id": 99967309, "body": "yes <code>char_to_read</code> should be <code>end - start + 1</code>. I forgot that in your case indexing starts with 1. I&#39;ll Change the code."}, {"owner": {"reputation": 554, "user_id": 5306039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b2908132960fc726570b38fe4266?s=128&d=identicon&r=PG&f=1", "display_name": "shubham", "link": "https://stackoverflow.com/users/5306039/shubham"}, "reply_to_user": {"reputation": 83, "user_id": 11670067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Rmh3G88QAM/AAAAAAAAAAI/AAAAAAAAAM8/6-FZ_5ml8mI/photo.jpg?sz=128", "display_name": "Kostis L", "link": "https://stackoverflow.com/users/11670067/kostis-l"}, "edited": false, "score": 0, "creation_date": 1561114360, "post_id": 56669876, "comment_id": 99967441, "body": "there was an issue with index of <code>start</code> and <code>end</code> fixed it by subtracting 1 from them"}, {"owner": {"reputation": 333, "user_id": 9987237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29e3310153a9b89ddeaed06c8d1ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Mance Rayder", "link": "https://stackoverflow.com/users/9987237/mance-rayder"}, "edited": false, "score": 0, "creation_date": 1561243523, "post_id": 56669876, "comment_id": 100000613, "body": "Instead of adjusting the values of <code>start</code> and <code>end</code>, you may do <code>int char_to_read = end - start; &#47;&#47; it&#39;s a difference -&gt; don&#39;t care if it&#39;s 0 or 1 indexed</code>, then add to that the number of newlines chars (<code>char_to_read &#47; 30</code>) + 1. After the read, the <code>\\n</code>s should be removed (or loop over the string writing each line to the file, without the newline char."}, {"owner": {"reputation": 83, "user_id": 11670067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Rmh3G88QAM/AAAAAAAAAAI/AAAAAAAAAM8/6-FZ_5ml8mI/photo.jpg?sz=128", "display_name": "Kostis L", "link": "https://stackoverflow.com/users/11670067/kostis-l"}, "edited": false, "score": 1, "creation_date": 1561369893, "post_id": 56669876, "comment_id": 100026987, "body": "@Shubham the edited <code>start</code> will now be 0, so shouldn&#39;t it be <code>fseek(fp, start, SEEK_SET</code>) in this example (start=1, end=90)? Also, my start/end values are generally not 0, so I&#39;m guessing that <code>start+=(start&#47;30)*m</code> (same with end) &amp; <code>char_to_read=end-start+1</code> will work fine right?"}, {"owner": {"reputation": 554, "user_id": 5306039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b2908132960fc726570b38fe4266?s=128&d=identicon&r=PG&f=1", "display_name": "shubham", "link": "https://stackoverflow.com/users/5306039/shubham"}, "edited": false, "score": 1, "creation_date": 1561370263, "post_id": 56669876, "comment_id": 100027185, "body": "yes, you are right about fseek it should be <code>fseek(fp, start, SEEK_SET)</code>. If <code>start</code> and <code>end</code> are not zero then it will work. I updated the answer, thanks for the pointing out"}], "tags": [], "owner": {"reputation": 554, "user_id": 5306039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b2908132960fc726570b38fe4266?s=128&d=identicon&r=PG&f=1", "display_name": "shubham", "link": "https://stackoverflow.com/users/5306039/shubham"}, "is_accepted": true, "score": 0, "last_activity_date": 1561370287, "last_edit_date": 1561370287, "creation_date": 1560953859, "answer_id": 56669876, "question_id": 56668075, "link": "https://stackoverflow.com/questions/56668075/reading-a-specific-part-of-a-text-file-as-a-string-in-c/56669876#56669876", "title": "Reading a specific part of a text file as a string in C?", "body": "<p>I have modified your code and added comments to it for explanation.</p>\n\n<p>Please go through it. You have neglected the error checking, code has few undefined variables.</p>\n\n<p>I have returned from the <code>if</code> block on failure, goto` would be more appropriate.</p>\n\n<p>Please refer <a href=\"https://stackoverflow.com/questions/56668075/reading-a-specific-part-of-a-text-file-as-a-string-in-c#comment99904056_56668075\">this comment</a> for whether to add 1 char or 2 chars to <code>start</code> and <code>end</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n        FILE* fp;\n        // fp = fopen(filename, \"r\");\n        // since the filename is undeclared i have used hard coded file name\n        fp = fopen(\"dna.txt\", \"r\");\n        // Nothing wrong in performing error checking\n        if (fp == NULL) {\n                puts(\"Failed to open file\");\n                return -1; \n        }\n\n        // Make sure start is not 0 if you want to use indices starting from 1\n        int start = 1, end = 90; \n\n        // I would adjust the start and end index by adding count of '\\n' or '\\r\\n' to the start and end\n        // Here I am adjusting for '\\n' i.e 1 char\n        // since you have 30 chars so hardcoding it.\n        int m = 1; // m depends on whether it is \\n or \\r\\n\n                   // 1 for \\n and 2 for \\r\\n\n        --start; --end; // adjusting indexes to be 0 based\n        if (start != 0)\n                start = start + (start / 30) * m;   // start will be 0\n        if (end != 0)\n                end = end + (end / 30) * m;         // start will be 93\n\n        // lets declare the chars to read\n        int char_to_read = end - start + 1;\n\n        // need only 1 extra char to append null char\n        // If start and end is going to change, then i would suggest using malloc instead of static buffer\n        // because compiler cannot predict the memory to allocate to the buffer if it is dependent on external factor\n        // char string[char_to_read + 1]; //characters from start to end = end-start+1\n\n        char *string = malloc(char_to_read + 1); \n        if (string == NULL) {\n                printf(\"malloc failed\\n\");\n                fclose(fp);\n                return -2;\n        }\n\n        // zero the buffer\n        memset(string, 0, char_to_read + 1); \n\n        int rc = fseek(fp, start, SEEK_SET);\n        if (rc == -1) {\n                printf(\"fseek failed\");\n                fclose(fp);\n                return -1;\n        }\n\n        // exon is not defined, and btw we wanted to read in string.\n        int bytes_read = fread(string, 1, char_to_read, fp);\n\n        // Lets check if there is any error after reading\n        if (bytes_read == -1) {\n                fclose(fp);\n                return -1; \n        }\n\n        // Now append the null char to the end\n        string[bytes_read] = 0;\n        printf(\"%s\\n\", string);\n        fclose(fp);\n\n        // free the memory once you are done with it\n        if (string)\n                free(string);\n\n\n// Now u can write it back to file.\n//      FILE* tp;\n//      tp=fopen(\"exon\", \"w\");\n//      if (tp==NULL) puts(\"Failed to make tmp file\");\n\n//      fprintf(tp, \"%s\\n\", string);\n//      fclose(tp);\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 11670067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Rmh3G88QAM/AAAAAAAAAAI/AAAAAAAAAM8/6-FZ_5ml8mI/photo.jpg?sz=128", "display_name": "Kostis L", "link": "https://stackoverflow.com/users/11670067/kostis-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 56669876, "answer_count": 1, "score": 8, "last_activity_date": 1561370287, "creation_date": 1560948623, "last_edit_date": 1560948744, "question_id": 56668075, "link": "https://stackoverflow.com/questions/56668075/reading-a-specific-part-of-a-text-file-as-a-string-in-c", "title": "Reading a specific part of a text file as a string in C?", "body": "<p>I'm writing code that reads huge text files containing DNA bases and I need to be able to extract specific parts. The file looks like this:</p>\n\n<pre><code>TGTTCCAGGCTGTCAGATGCTAACCTGGGG\nTCACTGGGGGTGTGCGTGCTGCTCCAGCCT\nGTTCCAGGATATCAGATGCTCACCTGGGGG\n</code></pre>\n\n<p>...</p>\n\n<p>Every line is 30 characters. </p>\n\n<p>I have a separate file indicating these parts, meaning I have a <strong><em>start</em></strong> value and an <strong><em>end</em></strong> value. So for each <strong><em>start</em></strong> and <strong><em>end</em></strong> value, I need to extract the corresponding string in the file. \nFor example, if I have <strong>start</strong>=10, <strong>end</strong>=45, I need to store the string which starts at the 10th character of the first line (C) and ends at the 15th character of the 2nd line (C) in a separate temporary file. </p>\n\n<p>I tried using the fread function as seen below for a test file with the above lines of letters. The parameters were <strong>start</strong>=1, <strong>end</strong>=90 and the resulting file looks like this:</p>\n\n<pre><code>TGTTCCAGGCTGTCAGATGCTAACCTGGGG\nTCACTGGGGGTGTGCGTGCTGCTCCAGCCT\nGTTCCAGGATATCAGATGCTCACCTGGG\u2122eRV\n</code></pre>\n\n<p>Each run will give random characters at the end. </p>\n\n<p>The code:</p>\n\n<pre><code>\nFILE* fp;\nfp=fopen(filename, \"r\");\nif (fp==NULL) puts(\"Failed to open file\");\n\nint start=1, end=90;\nchar string[end-start+2]; //characters from start to end = end-start+1\n\nfseek(fp, start-1, SEEK_SET);\n\nfread(exon,1, end-start+1, fp);\n\nFILE* tp;\ntp=fopen(\"exon\", \"w\");\nif (tp==NULL) puts(\"Failed to make tmp file\");\n\nfprintf(tp, \"%s\\n\", string);\nfclose(tp);\n\n</code></pre>\n\n<p>I couldn't understand how fread handles \\n characters so I tried replacing it with the following:</p>\n\n<pre><code>int i=0;\nchar ch;\nwhile (!feof(fp))\n{\n            ch=fgetc(fp);\n\n            if (ch != '\\n') \n            {\n                string[i]=ch;\n                i++;\n                if (i==end-start) break;\n            }\n\n}\nstring[end-start+1]='\\0';\n</code></pre>\n\n<p>It created the following file:\nTGTTCCAGGCTGTCAGATGCTAACCTGGGGTCACTGGGGGTGTGCGTGCTGCTCCAGCCTGTTCCAGGATATCAGATGCTCACCTGGGG\u00f4</p>\n\n<p>(without any line breaks, which I don't mind).\nAgain with each run, I get a different random character instead of 'G'.</p>\n\n<p>What am I doing wrong? Is there a way to get it done with fread or some other function? </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "malloc", "stm32", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1560950661, "post_id": 56667908, "comment_id": 99905171, "body": "I would rather suggest to do not use malloc in the embedded development or at least not the same way as on the large computers. Heap is very small and this kind algorithm will fragment it in no time - making any allocation impossible."}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1561019490, "post_id": 56667908, "comment_id": 99929843, "body": "At least be cautious about your heap. Don&#39;t go about allocating and freeing left and right and really only allocated stuff that needs to be the correct size but exists for the whole time."}, {"owner": {"reputation": 483, "user_id": 2648463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/B9n31.jpg?s=128&g=1", "display_name": "panc_fab", "link": "https://stackoverflow.com/users/2648463/panc-fab"}, "edited": false, "score": 0, "creation_date": 1561025637, "post_id": 56667908, "comment_id": 99933133, "body": "thanks guys, I am cautious, yes. I have just 2 of those signal_t structs in the whole FW. the structs are used as &quot;buffers&quot; in which at each iteration, the content of a goes to p, and the content of p goes in pp. same for af,pf,ppf. So instead of using non-pointer approach and heavily copy structs content, I just treat the structs by using pointers and switching them instead of huge copies."}], "owner": {"reputation": 483, "user_id": 2648463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/B9n31.jpg?s=128&g=1", "display_name": "panc_fab", "link": "https://stackoverflow.com/users/2648463/panc-fab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1560948591, "answer_count": 0, "score": 0, "last_activity_date": 1560948608, "creation_date": 1560948082, "last_edit_date": 1560948608, "question_id": 56667908, "link": "https://stackoverflow.com/questions/56667908/malloc-fails-when-allocating-pointer-to-struct-of-pointers-c", "closed_reason": "Duplicate", "title": "malloc fails when allocating pointer to struct of pointers - C", "body": "<p>I cannot figure out what is going on with my code. I am developing on a STM32F7 board.</p>\n\n<p>The fact is, I have typedef'd a struct of pointers:</p>\n\n<pre><code>typedef struct\n{\n    Pos_2D_t *a;\n    Pos_2D_t *p;\n    Pos_2D_t *pp;\n    Pos_2D_t *af;\n    Pos_2D_t *pf;\n    Pos_2D_t *ppf;\n}signal_t;      \n</code></pre>\n\n<p>Declared a pointer to it:</p>\n\n<pre><code>signal_t *positions;\n</code></pre>\n\n<p>and wrote a init function to malloc the struct - here the content:</p>\n\n<pre><code>FILTER_Init(signal_t *signal){\n\n   signal = malloc(sizeof(signal_t));\n\n   if(signal != NULL)\n   {\n       signal-&gt;a = malloc(sizeof(Pos_2D_t)); \n       signal-&gt;p = malloc(sizeof(Pos_2D_t)); \n       signal-&gt;pp = malloc(sizeof(Pos_2D_t)); \n       signal-&gt;af=  malloc(sizeof(Pos_2D_t)); \n       signal-&gt;pf = malloc(sizeof(Pos_2D_t)); \n       signal-&gt;ppf = malloc(sizeof(Pos_2D_t)); \n   }\n }\n</code></pre>\n\n<p>And call it:</p>\n\n<pre><code>FILTER_Init(positions);\n</code></pre>\n\n<p>The problem is, when I try to copy a value inside of each Pos_2D_t element</p>\n\n<pre><code>positions-&gt;a-&gt;x = value;\npositions-&gt;a-&gt;y = value;\n</code></pre>\n\n<p>I fall into Hard fault. From debugging with Keil uVision, I see that the value of the pointer to struct (its address) is 0x0000, but I see the other Pos_2D_t* elements having a meaningful address wrt the memory map of my board. </p>\n\n<p>I cannot understand why I see a 0x0000 address for the struct, and correct addresses for the inner elements(it should not allocate the inner Pos_2D_t having a check on signal != NULL, right?). I am quite sure I am messing with memory allocation, but I cannot find where and why.</p>\n\n<p>If I declare the struct not as a pointer, and I allocate only the inner elements of the struct, like that:</p>\n\n<pre><code>FILTER_Init(signal_t *signal){\n\n  signal-&gt;a = malloc(sizeof(Pos_2D_t)); \n  signal-&gt;p = malloc(sizeof(Pos_2D_t)); \n  signal-&gt;pp = malloc(sizeof(Pos_2D_t)); \n  signal-&gt;af = malloc(sizeof(Pos_2D_t)); \n  signal-&gt;pf = malloc(sizeof(Pos_2D_t)); \n  signal-&gt;ppf = malloc(sizeof(Pos_2D_t));\n\n} \n</code></pre>\n\n<p>It all goes well and my program does not crash or faults.\nCould you guys please help me?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>my Pos_2D_t struct is:</p>\n\n<pre><code>typedef struct\n{\n   float x;\n   float y;\n}Pos_2D_t;\n</code></pre>\n\n<p><strong>EDIT 2</strong>\nas someone already found out, my question has already been answered earlier. many thanks! </p>\n"}, {"tags": ["c", "linux", "assembly"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1560948224, "post_id": 56667896, "comment_id": 99903598, "body": "What does the debugger say?"}, {"owner": {"reputation": 129, "user_id": 11470640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189e54a5bf827efbb9939ff29b9abff?s=128&d=identicon&r=PG&f=1", "display_name": "BackSpace7777777", "link": "https://stackoverflow.com/users/11470640/backspace7777777"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1560948329, "post_id": 56667896, "comment_id": 99903672, "body": "Target received a signal: SIGSEGV, Segment fault"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1560948370, "post_id": 56667896, "comment_id": 99903706, "body": "Where at? Which line?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1560948376, "post_id": 56667896, "comment_id": 99903711, "body": "One obvious problem is that <code>rbx</code> is a callee-saved register and you destroy it in both of your functions. Use <code>rdx</code> instead or save and restore it."}, {"owner": {"reputation": 129, "user_id": 11470640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189e54a5bf827efbb9939ff29b9abff?s=128&d=identicon&r=PG&f=1", "display_name": "BackSpace7777777", "link": "https://stackoverflow.com/users/11470640/backspace7777777"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1560948495, "post_id": 56667896, "comment_id": 99903791, "body": "@Jester That solved the problem thank you!"}, {"owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "edited": false, "score": 0, "creation_date": 1560950270, "post_id": 56667896, "comment_id": 99904936, "body": "The stack pointer should be aligned to a multiple of 16 when calling <code>malloc</code>."}], "owner": {"reputation": 129, "user_id": 11470640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189e54a5bf827efbb9939ff29b9abff?s=128&d=identicon&r=PG&f=1", "display_name": "BackSpace7777777", "link": "https://stackoverflow.com/users/11470640/backspace7777777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560948286, "creation_date": 1560948058, "last_edit_date": 1560948286, "question_id": 56667896, "link": "https://stackoverflow.com/questions/56667896/why-do-i-get-a-segment-fault-when-i-have-an-array-length-greater-than-2", "title": "Why do I get a segment fault when I have an array length greater than 2", "body": "<p>I am using malloc to create an array (before I get criticized for using malloc in c++, I only wish to do this because I would like to learn) of length length. Any time that I have length greater than 2 I get a segment fault, and I'm not sure why. When I used a debugger I get a segment fault on a line that does not exist when I get the compiler to output the .S file.</p>\n\n<p>This is for Linux x86-64</p>\n\n<p>Initially I tried creating the array is x64 asm but when I kept getting segment errors I tried writing the same thing in c++, but I kept getting segment errors</p>\n\n<p>c++ code that does what fillArrayWithRandom64 without printing</p>\n\n<pre><code>int main(){\n    uint64_t length=4;\n    uint64_t* arr=(uint64_t*)malloc(8*length);\n    for(uint64_t i=0;i&lt;length;i++){\n        *(arr+i)=genRandom64();\n        cout&lt;&lt;\"Value at \"&lt;&lt;i&lt;&lt;\":\"&lt;&lt;*(arr+i)&lt;&lt;endl;\n    }\n    free(arr);\n    return 0;\n}\n</code></pre>\n\n<p>Generates array and fills with random numbers</p>\n\n<pre><code>fillArrayWithRandom64:#rdi is length\n#returns pointer to array\n    cmp     rdi,0\n    jle     _fillArrayWithRandom64Bad\n\n    push    rbp\n    mov     rbp,rsp\n\n    push    rdi     #-8     length\n    imul    rdi,8\n    call    malloc@PLT\n    push    rax     #-16    pointer\n    pushq   0       #-24    counter\n\n    _fillArrayWithRandom64L1:\n        call    genRandom64\n        mov     rbx,[rbp-16]\n        mov     rcx,[rbp-24]\n        mov     [rbx+rcx*8],rax\n\n        inc     rcx\n        mov     [rbp-24],rcx\n        cmp     rcx,[rbp-8]\n        jl      _fillArrayWithRandom64L1\n\n    mov     rax,[rbp-16]\n    mov     rsp,rbp\n    pop     rbp\n    ret\n    _fillArrayWithRandom64Bad:\n        mov     rax,0\n        ret\n</code></pre>\n\n<p>My random number function</p>\n\n<pre><code>genRandom64:#returns 64\n    call    rand@PLT\n    push    rax\n    call    rand@PLT\n    shl     rax,32\n    pop     rbx\n    or      rax,rbx\n    ret\n</code></pre>\n\n<p>My expected output was \"Value at (i):(some random number)\"\nI got Segment fault (core dumped)</p>\n"}, {"tags": ["c", "linux", "dpdk"], "answers": [{"tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": true, "score": 1, "last_activity_date": 1560975236, "creation_date": 1560975236, "answer_id": 56675204, "question_id": 56667858, "link": "https://stackoverflow.com/questions/56667858/dpdk-mempool-allocates-way-more-than-necessary/56675204#56675204", "title": "dpdk mempool allocates way more than necessary", "body": "<p>Unfortunately there\u2019s not much you can do. Each memory pool object has a header, which has pointers to:</p>\n\n<ol>\n<li>Next object. </li>\n<li>Memory pool the object belongs to. </li>\n<li>IO/physical address.</li>\n</ol>\n\n<p>See: \n<a href=\"http://doc.dpdk.org/api/structrte__mempool__objhdr.html\" rel=\"nofollow noreferrer\">http://doc.dpdk.org/api/structrte__mempool__objhdr.html</a></p>\n\n<p>Plus internally memory pool stores a circular buffer, which is roughly another pointer per object. So, the per-object overhead is much more than the data you\u2019re trying to store in each object.</p>\n\n<p>If we don\u2019t care about physical address, etc, and all we need is to be able to store those 24 bytes fast an efficient, we nigh use just the circular buffer (<a href=\"https://doc.dpdk.org/api/rte__ring_8h.html\" rel=\"nofollow noreferrer\">rte_ring</a>) with an flat array of small objects. The overhead will be ~8 bytes per object in this case.</p>\n\n<p>The performance will be lower, since memory pool implements internal per-core cache. </p>\n\n<p>If it\u2019s still too much, you should look into other non-DPDK data structures.</p>\n\n<p>Or store buckets of objects. Say, 100 objects per bucket will make the overhead effectively ~100 times lower. </p>\n"}], "owner": {"reputation": 523, "user_id": 407873, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/59e812fb03c96f8b8a483d1aa307f880?s=128&d=identicon&r=PG", "display_name": "barisdad", "link": "https://stackoverflow.com/users/407873/barisdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 56675204, "answer_count": 1, "score": 1, "last_activity_date": 1560975236, "creation_date": 1560947955, "last_edit_date": 1560951245, "question_id": 56667858, "link": "https://stackoverflow.com/questions/56667858/dpdk-mempool-allocates-way-more-than-necessary", "title": "dpdk mempool allocates way more than necessary", "body": "<p>I have a linux app which uses dpdk mempools. I am trying to allocate a mempool with 8000000 objects of 24 bytes. When running without <code>MEMPOOL_F_NO_CACHE_ALIGN</code> in the mempool creation it allocated 1688 megabytes of eal memory, about 10 times more than necessary. When I added <code>MEMPOOL_F_NO_CACHE_ALIGN</code> it was reduced to 512 megabytes which also more than twice as necessary. How can I reduce this?</p>\n"}, {"tags": ["c", "arrays", "initialization", "implicit-conversion", "string-literals"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1560947832, "post_id": 56667780, "comment_id": 99903361, "body": "In <code>char str[] = &quot;hello&quot;</code>, the <code>&quot;hello&quot;</code> stays static and the <code>str</code> contains a copy of the string on the stack. You then return a pointer to that copy on the stack."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1560948469, "post_id": 56667780, "comment_id": 99903773, "body": "(To be ultra pedantic, a string literal is the quoted string in the source code. When the program is translated [compiled], the string literal is used to initialize an array of static storage duration. That array is a different thing; it is not the string literal, but people often refer to it as the string literal.)"}, {"owner": {"reputation": 22489, "user_id": 3208297, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/KzpAh.jpg?s=128&g=1", "display_name": "blue_note", "link": "https://stackoverflow.com/users/3208297/blue-note"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560949249, "post_id": 56667780, "comment_id": 99904278, "body": "@EricPostpischil: please, be pedantic!! Does the <code>char str[] = &quot;hello&quot;</code> copy this static array to an automatic one, element by element? And the static one still exists? If so, can you point to a reference, I can&#39;t find it in the specification.."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1560949510, "post_id": 56667780, "comment_id": 99904443, "body": "@blue_note: The C standard defines C in terms of an abstract machine, an imaginary computer going through elementary steps. In that abstract machine, yes, the <code>&quot;hello&quot;</code> in <code>char str[] = &quot;hello&quot;</code> causes an array of static storage duration containing h, e, l, l, o, and the null character to be created, and that array is used to initialize <code>str</code>. Compilers do not have to implement the actual abstract machine; they can create any program that gets the same results (the same <i>observed behavior</i> as that is defined by the C standard). So they will optimize."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560949708, "post_id": 56667780, "comment_id": 99904572, "body": "@blue_note: If <code>char str[] = &quot;hello&quot;;</code> appears outside a function, so it is static, the compiler is likely to put <code>str</code> in a part of the object module that is for initialized writeable data, with the h, e, l, l, o, and null character in it, and then there will be no separate array for the string literal anywhere in the object module. If it appears inside a function, so it is automatic and the initialization may have to be performed more than once, the compiler may store the string in non-writeable data and copy it each time the initialization is needed. So the static array will actually exist."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560949745, "post_id": 56667780, "comment_id": 99904594, "body": "@EricPostpischil So, in response to <i>In <code>char str[] = &quot;hello&quot;</code>, the <code>&quot;hello&quot;</code> stays static</i>, the <code>&quot;hello&quot;</code> doesn&#39;t need to exist as a string literal at all?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1560949834, "post_id": 56667780, "comment_id": 99904660, "body": "@blue_note: As for where this is specified, the C 2018 standard describes string literals in 6.4.5, of which paragraph 6 says, in part, \u201cThe multibyte character sequence is then used to initialize an array of static storage duration and length just sufficient to contain the sequence. For character string literals, the array elements have type <code>char</code>, and are initialized with the individual bytes of the multibyte character sequence.\u201d"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560950139, "post_id": 56667780, "comment_id": 99904846, "body": "@AndrewHenle: I am not clear on whether you are asking about the abstract machine, an actual implementation, the <code>&quot;hello&quot;</code> that is the string literal, or the data that the compiler has to have. If <code>char str[] = &quot;hello&quot;</code> appears outside a function, it may result in <code>str</code> being represented in the object module as space inside a section for initialized writeable data, and that space will contain the characters of the string. There will not need to be any separate object for the <code>&quot;hello&quot;</code>. Although in the abstract machine, <code>str</code> and <code>&quot;hello&quot;</code> both exist, the latter can be discarded in practice."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1560950334, "post_id": 56667780, "comment_id": 99904985, "body": "@blue_note: For another example, if <code>char str[] = &quot;a&quot;</code> appears inside a function, the string is short enough that the compiler might not store  and the null character as a static object in the object module. Instead, it might implement it as an immediate operand in the instruction stream. The abstract machine has a string literal, but the optimized code the compiler produces does not need to."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1560955849, "post_id": 56667780, "comment_id": 99908496, "body": "The string literal in <code>sizeof &quot;string&quot;</code> might not be stored anywhere."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 5, "last_activity_date": 1560949676, "last_edit_date": 1560949676, "creation_date": 1560947918, "answer_id": 56667843, "question_id": 56667780, "link": "https://stackoverflow.com/questions/56667780/c-do-all-string-literals-have-static-storage-duration/56667843#56667843", "title": "C: do all string literals have static storage duration?", "body": "<p>This</p>\n\n<pre><code>char str[] = \"hello\";\n</code></pre>\n\n<p>is a declaration of a local array that is initialized by the string literal <code>\"hello\"</code>.</p>\n\n<p>In fact it is the same as if you declared the array the following way</p>\n\n<pre><code>char str[] = { 'h', 'e', 'l', 'l', 'o', '\\0' };\n</code></pre>\n\n<p>That is the own area of memory (with the automatic storage duration) of the array is initialized by a string literal.</p>\n\n<p>After exiting the function the array will not be alive.</p>\n\n<p>That is the function</p>\n\n<pre><code>char *f2() {\n   char str[] = \"hello\";\n   return str;\n}\n</code></pre>\n\n<p>tries to return a pointer to the first element of the local character array <code>str</code> that has the automatic storage duration.</p>\n\n<p>As for this function definition</p>\n\n<pre><code>char *f1() { return \"hello\"; }\n</code></pre>\n\n<p>then the function returns a pointer to the first character of the string literal <code>\"hello\"</code> that indeed has the static storage duration.</p>\n\n<p>You may imagine the first function definition the following way</p>\n\n<pre><code>char literal[] = \"hello\";\nchar *f1() { return literal; }\n</code></pre>\n\n<p>Now compare where the arrays are defined in the first function definition and in the second function definition.</p>\n\n<p>In the first function definition the array <code>literal</code> is defined globally while in the second function definition the array <code>str</code> is defined locally.</p>\n\n<blockquote>\n  <p>if the str points to the actual string literal (which has static\n  duration), why do I get an error?</p>\n</blockquote>\n\n<p><code>str</code> is not a pointer. It is a named extent of memory that was initialized by a string literal. That is the array has the type <code>char[6]</code>.</p>\n\n<p>In the return statement</p>\n\n<pre><code>return str;\n</code></pre>\n\n<p>the array is implicitly converted to pointer to its first element of the type <code>char *</code>.</p>\n\n<p>Functions in C and C++ may not return arrays. In C++ functions may return references to arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1560955482, "post_id": 56667926, "comment_id": 99908247, "body": "&quot;&gt; why do I get an error?&quot; Because <code>return str;</code> is equivalent to <code>return &amp;str[0];</code> and <code>str[0]</code> is an object with automatic storage duration. So <code>f2</code> returns a pointer to an object with automatic storage duration. The returned pointer is invalid for any caller of <code>f2</code>."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 4, "last_activity_date": 1560948131, "creation_date": 1560948131, "answer_id": 56667926, "question_id": 56667780, "link": "https://stackoverflow.com/questions/56667780/c-do-all-string-literals-have-static-storage-duration/56667926#56667926", "title": "C: do all string literals have static storage duration?", "body": "<blockquote>\n  <p>I've been reading in various sources that string literals remain in\n  memory for the whole lifetime of the program.</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>In that case, what is\n  the difference between those two functions</p>\n\n<pre><code>char *f1() { return \"hello\"; }\nchar *f2() {\n   char str[] = \"hello\";\n   return str;\n}\n</code></pre>\n</blockquote>\n\n<p><code>f1</code> returns a pointer to the first element of the array represented by a string literal, which has static storage duration.  <code>f2</code> returns a pointer to the first element of the <em>automatic</em> array <code>str</code>.  <code>str</code> has a string literal for an initializer, but it is a separate object.</p>\n\n<blockquote>\n  <p>While f1 compiles fine, f2 complains that I'm returning stack\n  allocated data. What happens here?</p>\n  \n  <ul>\n  <li>if the str points to the actual string literal (which has static duration), why do I get an error?</li>\n  </ul>\n</blockquote>\n\n<p>It does not.  In fact, it itself does not point to <em>anything</em>.  It is an array, not a pointer.</p>\n\n<blockquote>\n  <ul>\n  <li>if the string literal is copied to the local variable str, where does the original string literal go? does it remain in memory with no\n  reference to it?</li>\n  </ul>\n</blockquote>\n\n<p>C does not specify, but in practice, yes, some representation of the string literal must be stored somewhere in the program, perhaps in the function implementation, because it needs to be used to initialize <code>str</code> anew each time <code>f2</code> is called.</p>\n"}, {"tags": [], "owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": false, "score": 2, "last_activity_date": 1560948476, "last_edit_date": 1560948476, "creation_date": 1560948139, "answer_id": 56667929, "question_id": 56667780, "link": "https://stackoverflow.com/questions/56667780/c-do-all-string-literals-have-static-storage-duration/56667929#56667929", "title": "C: do all string literals have static storage duration?", "body": "<p><code>char str[] = \"hello\";</code> is a special syntax which copies the string literal, and your function returns a pointer to this local variable, which is destroyed once the function returns.<br>\n<code>char *f1() { return \"hello\"; }</code> is correct but returning <code>const char*</code> would probably be better. </p>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 9353387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3G2gD.jpg?s=128&g=1", "display_name": "Isaa\u0441 Weisberg", "link": "https://stackoverflow.com/users/9353387/isaa%d1%81-weisberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1561363892, "last_edit_date": 1561363892, "creation_date": 1560948320, "answer_id": 56667995, "question_id": 56667780, "link": "https://stackoverflow.com/questions/56667780/c-do-all-string-literals-have-static-storage-duration/56667995#56667995", "title": "C: do all string literals have static storage duration?", "body": "<p>The string that you will see on your stack is not a direct result of the presence of a string literal. The string is stored, in case of <code>ELF</code>, in a separate region of the executable binary called \"string table section\", along with other string literals that the linker meets during the linking process. Whenever the stack context of the code that actually caused a string to be included is instantiated, the contents of the string in string table section are <strong>actually copied to the stack</strong>.</p>\n\n<p>A brief reading that you might be interested in:\n<a href=\"http://refspecs.linuxbase.org/elf/gabi4+/ch4.strtab.html\" rel=\"nofollow noreferrer\">http://refspecs.linuxbase.org/elf/gabi4+/ch4.strtab.html</a></p>\n"}], "owner": {"reputation": 22489, "user_id": 3208297, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/KzpAh.jpg?s=128&g=1", "display_name": "blue_note", "link": "https://stackoverflow.com/users/3208297/blue-note"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 1, "closed_date": 1560948557, "accepted_answer_id": 56667926, "answer_count": 4, "score": 5, "last_activity_date": 1561363892, "creation_date": 1560947715, "last_edit_date": 1560948706, "question_id": 56667780, "link": "https://stackoverflow.com/questions/56667780/c-do-all-string-literals-have-static-storage-duration", "closed_reason": "Duplicate", "title": "C: do all string literals have static storage duration?", "body": "<p>I've been reading in various sources that string literals remain in memory for the whole lifetime of the program. In that case, what is the difference between those two functions</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char *f1() { return \"hello\"; }\nchar *f2() {\n   char str[] = \"hello\";\n   return str;\n}\n</code></pre>\n\n<p>While <code>f1</code> compiles fine, <code>f2</code> complains that I'm returning stack allocated data. What happens here?</p>\n\n<ul>\n<li>if the <code>str</code> points to the <em>actual</em> string literal (which has static duration), why do I get an error?</li>\n<li>if the string literal is copied to the local variable <code>str</code>, where does the original string literal go? does it remain in memory with no reference to it?</li>\n</ul>\n"}, {"tags": ["c", "execl"], "comments": [{"owner": {"reputation": 2827, "user_id": 3931225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/46nwm.gif?s=128&g=1", "display_name": "KompjoeFriek", "link": "https://stackoverflow.com/users/3931225/kompjoefriek"}, "edited": false, "score": 2, "creation_date": 1560947487, "post_id": 56667650, "comment_id": 99903153, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12596839/how-to-call-execl-in-c-with-the-proper-arguments\">How to call execl() in C with the proper arguments?</a>"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 4, "creation_date": 1560947496, "post_id": 56667650, "comment_id": 99903161, "body": "What does the <code>execl</code> return, and what <code>errno</code> does it set?"}, {"owner": {"reputation": 508, "user_id": 1659500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800dc77cc2498bea2b49cab73be68bd0?s=128&d=identicon&r=PG", "display_name": "&#216;ystein Sch&#248;nning-Johansen", "link": "https://stackoverflow.com/users/1659500/%c3%98ystein-sch%c3%b8nning-johansen"}, "edited": false, "score": 1, "creation_date": 1560947634, "post_id": 56667650, "comment_id": 99903237, "body": "Does <code>execl</code> find your hello program? maybe you need <code>execl(&quot;.&#47;hello&quot;, ... ) </code> ?"}, {"owner": {"reputation": 3, "user_id": 11655363, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-urMlJG0X8vI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwcRgiWoj9TzqoPPt9iw6YXx0GgQ/mo/photo.jpg?sz=128", "display_name": "Tomas", "link": "https://stackoverflow.com/users/11655363/tomas"}, "edited": false, "score": 0, "creation_date": 1560948038, "post_id": 56667650, "comment_id": 99903488, "body": "thank you very much, he needed ./hello"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1560948102, "post_id": 56667650, "comment_id": 99903523, "body": "<code>while(argv[i++] != NULL) printf(&quot;%s &quot;,argv[i]);</code> does not print the first argument and also includes the <code>NULL</code> pointer at the end."}, {"owner": {"reputation": 3, "user_id": 11655363, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-urMlJG0X8vI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwcRgiWoj9TzqoPPt9iw6YXx0GgQ/mo/photo.jpg?sz=128", "display_name": "Tomas", "link": "https://stackoverflow.com/users/11655363/tomas"}, "edited": false, "score": 0, "creation_date": 1560948351, "post_id": 56667650, "comment_id": 99903693, "body": "it does i just typed the code here wrong sorry)"}], "owner": {"reputation": 3, "user_id": 11655363, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-urMlJG0X8vI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwcRgiWoj9TzqoPPt9iw6YXx0GgQ/mo/photo.jpg?sz=128", "display_name": "Tomas", "link": "https://stackoverflow.com/users/11655363/tomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560948469, "creation_date": 1560947288, "last_edit_date": 1560948469, "question_id": 56667650, "link": "https://stackoverflow.com/questions/56667650/execl-dont-start-the-program", "title": "Execl dont start the program", "body": "<p>I have two programs, one of them calls another through execl, but it doesn't start.</p>\n\n<p>Here is the calling program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\nint main(int argc, int *argv[])\n{\n  printf(\"Program %s executes\", argv[0]);\n  execl(\"hello\", \" \", \"Hello\", \"World!\", NULL);\n  return 0;\n}\n</code></pre>\n\n<p>The \"hello\" program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char *argv[])\n{\n  int i=1;\n  printf(\"%s\\n\",argv[0]);\n  printf(\"Program started and got string : \");\n  while(argv[i++] != NULL)\n   printf(\"%s \",argv[i]);\n  return 0; \n}\n</code></pre>\n"}, {"tags": ["c", "azure-iot-hub", "mpu6050"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560949449, "post_id": 56667451, "comment_id": 99904412, "body": "<code>Wire.read()&lt;&lt;8</code> This looks mighty fishy and is certainly a bug, given that you&#39;ll have 16 bit <code>int</code>. Also, the presence of (double) floating point in an Arduino program is dead certain a bug."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560949689, "post_id": 56667451, "comment_id": 99904555, "body": "Also from the link, <code>(void *)(uintptr_t)messageTrackingId</code> seems like a massive bug too."}], "answers": [{"tags": [], "owner": {"reputation": 447, "user_id": 2522782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/971d2f587243b8cbeb13140b0a3564f1?s=128&d=identicon&r=PG", "display_name": "Mark Radbourne", "link": "https://stackoverflow.com/users/2522782/mark-radbourne"}, "is_accepted": false, "score": 2, "last_activity_date": 1560973372, "creation_date": 1560973372, "answer_id": 56674804, "question_id": 56667451, "link": "https://stackoverflow.com/questions/56667451/how-to-send-mpu6050-device-data-to-iot-hub/56674804#56674804", "title": "How to send MPU6050 device data to IoT Hub", "body": "<p>Take a look at the code here: <a href=\"https://github.com/Azure-Samples/iot-hub-feather-huzzah-client-app/blob/ab3d6e46f1b94192f8c8a96fb7b47d714df99439/app/app.ino#L114\" rel=\"nofollow noreferrer\">https://github.com/Azure-Samples/iot-hub-feather-huzzah-client-app/blob/ab3d6e46f1b94192f8c8a96fb7b47d714df99439/app/app.ino#L114</a>. This is calling a function that returns a JSON string in the buffer passed as the second parameter. This function is defined here: <a href=\"https://github.com/Azure-Samples/iot-hub-feather-huzzah-client-app/blob/ab3d6e46f1b94192f8c8a96fb7b47d714df99439/app/message.ino#L42\" rel=\"nofollow noreferrer\">https://github.com/Azure-Samples/iot-hub-feather-huzzah-client-app/blob/ab3d6e46f1b94192f8c8a96fb7b47d714df99439/app/message.ino#L42</a>. </p>\n\n<p>You would need to replace the content of readMessage with your code above to return your data in JSON form. However, you will need a little additional code. The code in loop has a 10ms delay and calls IoTHubClient_LL_DoWork on each iteration. For the Azure IoT SDK to work reliably this is required. Since you are only reading your sensor every 333ms you will need to track the time for yourself. For example, in loop you would only call readMessage each time loop has been executed 33 times. Something like this (quick and dirty for the sake of demonstration only):</p>\n\n<pre><code>static int messageCount = 1;\nstatic int loopCounter = 0;\nvoid loop()\n{\n    if (++loopCounter == 33)\n    {\n        if (!messagePending &amp;&amp; messageSending)\n        {\n            char messagePayload[MESSAGE_MAX_LEN];\n            bool temperatureAlert = readMessage(messageCount, messagePayload);\n            sendMessage(iotHubClientHandle, messagePayload, temperatureAlert);\n            messageCount++;\n            delay(interval);\n        }\n        loopCounter = 0;\n    }\n    IoTHubClient_LL_DoWork(iotHubClientHandle);\n    delay(10);\n}\n</code></pre>\n\n<p>This would give you a reading every 330ms. You will also need to add your connection string too.</p>\n"}], "owner": {"reputation": 33, "user_id": 7844987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGxh5.jpg?s=128&g=1", "display_name": "es_jm", "link": "https://stackoverflow.com/users/7844987/es-jm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1560973372, "creation_date": 1560946659, "question_id": 56667451, "link": "https://stackoverflow.com/questions/56667451/how-to-send-mpu6050-device-data-to-iot-hub", "title": "How to send MPU6050 device data to IoT Hub", "body": "<p>I am trying to send accelerometer data from MPU6050 which is connected to a ESP8266 to the Azure IoT Hub. I am using the Arduino IDE.</p>\n\n<p>I followed this tutorial from Microsoft: <a href=\"https://docs.microsoft.com/en-gb/azure/iot-hub/iot-hub-arduino-huzzah-esp8266-get-started\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-gb/azure/iot-hub/iot-hub-arduino-huzzah-esp8266-get-started</a>? which uses the DHT11 sensor and the esp8266. I also did this tutorial: <a href=\"http://archicode.be/esp8266-the-iot-prototyping-graal/\" rel=\"nofollow noreferrer\">http://archicode.be/esp8266-the-iot-prototyping-graal/</a> which shows which libraries and methods are required to connect the ESP8266 to Azure IoTHub. The Code which I used for testing the MPU6050 is here below and from <a href=\"https://playground.arduino.cc/Main/MPU-6050/#short\" rel=\"nofollow noreferrer\">https://playground.arduino.cc/Main/MPU-6050/#short</a></p>\n\n<pre><code>// MPU-6050 Short Example Sketch\n// By Arduino User JohnChi\n// August 17, 2014\n// Public Domain\n#include&lt;Wire.h&gt;\nconst int MPU_addr=0x68;  // I2C address of the MPU-6050\nint16_t AcX,AcY,AcZ,Tmp,GyX,GyY,GyZ;\nvoid setup(){\n  Wire.begin();\n  Wire.beginTransmission(MPU_addr);\n  Wire.write(0x6B);  // PWR_MGMT_1 register\n  Wire.write(0);     // set to zero (wakes up the MPU-6050)\n  Wire.endTransmission(true);\n  Serial.begin(9600);\n}\nvoid loop(){\n  Wire.beginTransmission(MPU_addr);\n  Wire.write(0x3B);  // starting with register 0x3B (ACCEL_XOUT_H)\n  Wire.endTransmission(false);\n  Wire.requestFrom(MPU_addr,14,true);  // request a total of 14 registers\n  AcX=Wire.read()&lt;&lt;8|Wire.read();  // 0x3B (ACCEL_XOUT_H) &amp; 0x3C (ACCEL_XOUT_L)    \n  AcY=Wire.read()&lt;&lt;8|Wire.read();  // 0x3D (ACCEL_YOUT_H) &amp; 0x3E (ACCEL_YOUT_L)\n  AcZ=Wire.read()&lt;&lt;8|Wire.read();  // 0x3F (ACCEL_ZOUT_H) &amp; 0x40 (ACCEL_ZOUT_L)\n  Tmp=Wire.read()&lt;&lt;8|Wire.read();  // 0x41 (TEMP_OUT_H) &amp; 0x42 (TEMP_OUT_L)\n  GyX=Wire.read()&lt;&lt;8|Wire.read();  // 0x43 (GYRO_XOUT_H) &amp; 0x44 (GYRO_XOUT_L)\n  GyY=Wire.read()&lt;&lt;8|Wire.read();  // 0x45 (GYRO_YOUT_H) &amp; 0x46 (GYRO_YOUT_L)\n  GyZ=Wire.read()&lt;&lt;8|Wire.read();  // 0x47 (GYRO_ZOUT_H) &amp; 0x48 (GYRO_ZOUT_L)\n  Serial.print(\"AcX = \"); Serial.print(AcX);\n  Serial.print(\" | AcY = \"); Serial.print(AcY);\n  Serial.print(\" | AcZ = \"); Serial.print(AcZ);\n  Serial.print(\" | Tmp = \"); Serial.print(Tmp/340.00+36.53);  //equation for temperature in degrees C from datasheet\n  Serial.print(\" | GyX = \"); Serial.print(GyX);\n  Serial.print(\" | GyY = \"); Serial.print(GyY);\n  Serial.print(\" | GyZ = \"); Serial.println(GyZ);\n  delay(333);\n}\n</code></pre>\n\n<p>How and where do I include this code? Does anyone have maybe a good reference? \nI would appreciate any help! :)</p>\n"}, {"tags": ["c#", "c", "openssl", "sni", "sslstream"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1560947661, "post_id": 56667331, "comment_id": 99903253, "body": "<code>&#47;&#47; No longer need server socket     closesocket(ListenSocket);</code> and then <code>SSL_set_fd(ssl, ListenSocket);</code>?!?  How well do you think the SSL negotiation is going to work if you tell it to use the <i>closed</i> socket used for <code>listen()</code>?"}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560948106, "post_id": 56667331, "comment_id": 99903526, "body": "@AndrewHenle Thanks, and it received, but added some code and edited but could not get servername yet"}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560948345, "post_id": 56667331, "comment_id": 99903689, "body": "@AndrewHenle *zx still null. have any idea?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560949675, "post_id": 56667331, "comment_id": 99904547, "body": "Why are you calling <code>recv()</code> and <code>send()</code> directly?  That just gets you the raw bytes sent across the network and doesn&#39;t use SSL at all."}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560971939, "post_id": 56667331, "comment_id": 99916342, "body": "@AndrewHenle sorry for late answer. Do you have any suggestion for using ssl library for receiving ssl content and diagnose servername (SNI)  and to other staff like other webservers and response to requests?"}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561010186, "post_id": 56667331, "comment_id": 99925575, "body": "@AndrewHenle I&#39;ve finally changed my code and callback worked, I&#39;ve edit it above. and doing other staff to see if I could handle multiple domains in same IP and respond to them"}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561010524, "post_id": 56667331, "comment_id": 99925696, "body": "@AndrewHenle I&#39;ve edited my code. 2 questions: <b>1)</b> Is it ok in every loop call <code>ssl = SSL_new(ctx);    SSL_set_fd(ssl, ClientSocket);    &#47;&#47;added this line for handling server name SSL_CTX_set_tlsext_servername_callback(ctx, ssl_servername_cb);</code> or out of loop? <b>2)</b> does <code>iResult = recv(ClientSocket, recvbuf, recvbuflen, 0);</code> needed for rest of job or just process request and socket write?"}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561181881, "post_id": 56667331, "comment_id": 99988358, "body": "@AndrewHenle Do you have any suggestion for continuous handshake and doing other staff?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1561205663, "post_id": 56667331, "comment_id": 99992837, "body": "You can find one example some a simple server here:  <a href=\"https://wiki.openssl.org/index.php/Simple_TLS_Server\" rel=\"nofollow noreferrer\">wiki.openssl.org/index.php/Simple_TLS_Server</a>  You can also look in the OpenSSL source for the <code>s_server</code> application."}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561284299, "post_id": 56667331, "comment_id": 100006130, "body": "@AndrewHenle <code>do {  \t\tssl = SSL_new(ctx); \t\tSSL_set_fd(ssl, ClientSocket);  \t\tint rr = SSL_accept(ssl);const char *senddata = \t\t\t&quot;HTTP&#47;1.1 200 Ok\\r\\nServer: BasisCore 1.0.1\\r\\nContent-Type: text&#47;html\\r\\n&quot; \t\t\t&quot;Content-Length : 20\\r\\n&quot; \t\t\t&quot;Vary: Accept-Encoding\\r\\n&quot; \t\t\t&quot;Hello from server ;)\\r\\n\\r\\n&quot;;  \t\t \t\tiSendResult=SSL_write(ssl, senddata, strlen(senddata)); \t\t&#47;&#47;iSendResult = send(ClientSocket, senddata, (int)strlen(senddata), 0); \t\tiResult = 0; \t\tSSL_free(ssl); \t\tclosesocket(ClientSocket); \t\tWSACleanup();} while (iResult &gt; 0);</code>"}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561284507, "post_id": 56667331, "comment_id": 100006169, "body": "@AndrewHenle I&#39;ve change the while loop here for sending http response to client. but setting breakpoint on line <code>*senddata = &quot;HTTP&#47;1.1 200 Ok\\r\\nServer:  ...</code> I see that in firefox, client socket is closed and firefox is not waiting for response. and I see this error: SSL_ERROR_NO_CYPHER_OVERLAP  authenticity of data received data could not be verified"}, {"owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1561292556, "post_id": 56667331, "comment_id": 100007841, "body": "@AndrewHenle My question is should I do all handshake process in server side by my own code like explained here [link]<a href=\"http://blog.fourthbit.com/2014/12/23/traffic-analysis-of-an-ssl-slash-tls-session[link]\" rel=\"nofollow noreferrer\">blog.fourthbit.com/2014/12/23/&hellip;</a> and there is no higher level methods in Openssl to do that?"}], "owner": {"reputation": 931, "user_id": 2763895, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c79ed41f2de6232396735c8088baef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed_gibago", "link": "https://stackoverflow.com/users/2763895/hamed-gibago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561010357, "creation_date": 1560946245, "last_edit_date": 1561010357, "question_id": 56667331, "link": "https://stackoverflow.com/questions/56667331/can-not-handle-servername-indication-with-openssl-library-from-server", "title": "Can not handle servername indication with openssl library from server", "body": "<p>I've develepted some windows server side socket in c\nand want to add sni server name indication to support sni</p>\n\n<p>but servername callback never called and cant get servername\nis there any suggestion?</p>\n\n<p>I've defined some functions for initializing ssl before main function:</p>\n\n<pre><code>void init_openssl()\n{\n    SSL_load_error_strings();\n    OpenSSL_add_ssl_algorithms();\n}\n\nSSL_CTX *create_context()\n{\n    const SSL_METHOD *method;\n    SSL_CTX *ctx;\n\n    //method = SSLv23_server_method();\n    method = TLSv1_1_server_method();\n\n    ctx = SSL_CTX_new(method);\n    if (!ctx) {\n        perror(\"Unable to create SSL context\");\n        ERR_print_errors_fp(stderr);\n        exit(EXIT_FAILURE);\n    }\n\n    return ctx;\n}\n\nvoid configure_context(SSL_CTX *ctx)\n{\n\n    SSL_CTX_set_ecdh_auto(ctx, 1);\n\n    /* Set the key and cert */\n    if (SSL_CTX_use_certificate_file(ctx, \"somesite.cer\", SSL_FILETYPE_PEM) &lt;= 0) {\n        ERR_print_errors_fp(stderr);\n\n        exit(EXIT_FAILURE);\n    }\n\n    if (SSL_CTX_use_PrivateKey_file(ctx, \"key.pem\", SSL_FILETYPE_PEM) &lt;= 0) {\n        ERR_print_errors_fp(stderr);\n\n        exit(EXIT_FAILURE);\n    }\n}\n\nstatic int ssl_servername_cb(SSL *ssl, int *ad, void *arg)\n{\n    if (ssl == NULL)\n        return SSL_TLSEXT_ERR_NOACK;\n\n    const char* servername = SSL_get_servername(ssl, TLSEXT_NAMETYPE_host_name);\n    printf(\"ServerName: %s\\n\", servername);\n}\n</code></pre>\n\n<p>and here is my main function: </p>\n\n<pre><code>int main()\n{\n\nSSL_CTX *ctx;\n\n    init_openssl();\n    ctx = create_context();\n\n    configure_context(ctx);\n\n    SSL_CTX_set_tlsext_servername_callback(ctx, ssl_servername_cb);\n\n\n\n    WSADATA wsaData;\n    int iResult;\n\n    SOCKET ListenSocket = INVALID_SOCKET;\n    SOCKET ClientSocket = INVALID_SOCKET;\n\n    struct addrinfo *result = NULL;\n    struct addrinfo hints;\n\n    int iSendResult;\n    char recvbuf[DEFAULT_BUFLEN];\n    int recvbuflen = DEFAULT_BUFLEN;\n\n    // Initialize Winsock\n    iResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);\n    if (iResult != 0) {\n        printf(\"WSAStartup failed with error: %d\\n\", iResult);\n        return 1;\n    }\n\n    ZeroMemory(&amp;hints, sizeof(hints));\n    hints.ai_family = AF_INET;\n    hints.ai_socktype = SOCK_STREAM;\n    hints.ai_protocol = IPPROTO_TCP;\n    hints.ai_flags = AI_PASSIVE;\n\n    // Resolve the server address and port\n    //iResult = getaddrinfo(NULL, DEFAULT_PORT, &amp;hints, &amp;result);\n    iResult = getaddrinfo(\"192.168.200.1\", DEFAULT_PORT, &amp;hints, &amp;result);\n    //iResult = getaddrinfo(\"127.0.0.1\", DEFAULT_PORT, &amp;hints, &amp;result);\n\n    if (iResult != 0) {\n        printf(\"getaddrinfo failed with error: %d\\n\", iResult);\n        WSACleanup();\n        return 1;\n    }\n\n    // Create a SOCKET for connecting to server \n    ListenSocket = socket(result-&gt;ai_family, result-&gt;ai_socktype, result-&gt;ai_protocol);\n    if (ListenSocket == INVALID_SOCKET) {\n        printf(\"socket failed with error: %ld\\n\", WSAGetLastError());\n        freeaddrinfo(result);\n        WSACleanup();\n        return 1;\n    }\n\n    // Setup the TCP listening socket   \n    iResult = bind(ListenSocket, result-&gt;ai_addr, (int)result-&gt;ai_addrlen);\n    if (iResult == SOCKET_ERROR) {\n        printf(\"bind failed with error: %d\\n\", WSAGetLastError());\n        freeaddrinfo(result);\n        closesocket(ListenSocket);\n        WSACleanup();\n        return 1;\n    }\n\n    freeaddrinfo(result);\n\n    iResult = listen(ListenSocket, SOMAXCONN);\n    if (iResult == SOCKET_ERROR) {\n        printf(\"listen failed with error: %d\\n\", WSAGetLastError());\n        closesocket(ListenSocket);\n        WSACleanup();\n        return 1;\n    }\n\n    // Accept a client socket       \n    ClientSocket = accept(ListenSocket, NULL, NULL);    \n    SSL *ssl;\n\n    if (ClientSocket == INVALID_SOCKET) {\n        printf(\"accept failed with error: %d\\n\", WSAGetLastError());\n        closesocket(ListenSocket);\n        WSACleanup();\n        return 1;\n    }\n\n    // No longer need server socket\n    closesocket(ListenSocket);\n\n    // Receive until the peer shuts down the connection\n    do {\n\n        ssl = SSL_new(ctx);\n    SSL_set_fd(ssl, ClientSocket);\n    //added this line for handling server name\n    SSL_CTX_set_tlsext_servername_callback(ctx, ssl_servername_cb);\n    int rr = SSL_accept(ssl);\n\n\n    iResult = recv(ClientSocket, recvbuf, recvbuflen, 0);\n\n    //int type=SSL_get_servername_type(ssl);\n    //const char[] x=SSL_get_servername(ssl, type);\n    const char *zx= SSL_get_servername(ssl, TLSEXT_NAMETYPE_host_name);\n\n        if (iResult &gt; 0) {\n            printf(\"Bytes received: %d\\n\", iResult);\n\n            // Echo the buffer back to the sender\n            iSendResult = send(ClientSocket, recvbuf, iResult, 0);\n            if (iSendResult == SOCKET_ERROR) {\n                printf(\"send failed with error: %d\\n\", WSAGetLastError());\n                closesocket(ClientSocket);\n                WSACleanup();\n                return 1;\n            }\n            printf(\"Bytes sent: %d\\n\", iSendResult);\n        }\n        else if (iResult == 0)\n            printf(\"Connection closing...\\n\");\n        else {\n            printf(\"recv failed with error: %d\\n\", WSAGetLastError());\n            closesocket(ClientSocket);\n            WSACleanup();\n            return 1;\n        }\n\n    } while (iResult &gt; 0);\n\nreturn 0;\n}\n</code></pre>\n\n<p>In do while function I've tried to call </p>\n\n<pre><code>const char* servername = SSL_get_servername(ssl, TLSEXT_NAMETYPE_host_name);\n</code></pre>\n\n<p>but didn't find anything.\nI know that clienthello handshake is in first bytes that is received from socket.</p>\n\n<pre><code>iResult = recv(ClientSocket, recvbuf, recvbuflen, 0);\n</code></pre>\n\n<p>And I receive 219 bytes of data. I need to handle servername and find it, and load certificate file and do continuous job, and maybe after that keep going with higher level in c# sslstream class.\nAny suggestion?</p>\n"}, {"tags": ["c++", "c", "json", "file", "elasticsearch"], "comments": [{"owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1560946139, "post_id": 56667128, "comment_id": 99902388, "body": "Elasticdump is the solution here. See this answer: <a href=\"https://stackoverflow.com/a/40778254/4604579\">stackoverflow.com/a/40778254/4604579</a>"}, {"owner": {"reputation": 35, "user_id": 11670131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed7bac3e904b3b0e37b23047f727e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Varuzhan", "link": "https://stackoverflow.com/users/11670131/varuzhan"}, "reply_to_user": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1560946455, "post_id": 56667128, "comment_id": 99902573, "body": "@Val it is using another tool to get it. I want to use c++ commands to get it."}, {"owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1560946542, "post_id": 56667128, "comment_id": 99902619, "body": "How about using the <code>system()</code> call in C++ to run the <code>elasticdump</code> command?"}, {"owner": {"reputation": 35, "user_id": 11670131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed7bac3e904b3b0e37b23047f727e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Varuzhan", "link": "https://stackoverflow.com/users/11670131/varuzhan"}, "reply_to_user": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "edited": false, "score": 0, "creation_date": 1560946756, "post_id": 56667128, "comment_id": 99902739, "body": "@Val elasticdump is a command of this tool(<a href=\"https://github.com/taskrabbit/elasticsearch-dump\" rel=\"nofollow noreferrer\">github.com/taskrabbit/elasticsearch-dump</a>). I do not want to use this tool."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11670131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed7bac3e904b3b0e37b23047f727e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Varuzhan", "link": "https://stackoverflow.com/users/11670131/varuzhan"}, "edited": false, "score": 0, "creation_date": 1560947918, "post_id": 56667534, "comment_id": 99903409, "body": "Thanks for help.But is it store data on disk in json format?"}], "tags": [], "owner": {"reputation": 163519, "user_id": 4604579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reC2t.jpg?s=128&g=1", "display_name": "Val", "link": "https://stackoverflow.com/users/4604579/val"}, "is_accepted": true, "score": 0, "last_activity_date": 1560946928, "creation_date": 1560946928, "answer_id": 56667534, "question_id": 56667128, "link": "https://stackoverflow.com/questions/56667128/how-to-save-data-of-elasticsearch-in-format-of-json/56667534#56667534", "title": "How to save data of elasticsearch in format of json?", "body": "<p>You can use a C++ Elastic client, like <a href=\"https://seznam.github.io/elasticlient/\" rel=\"nofollow noreferrer\">this one</a>.</p>\n\n<p>You can then retrieve all your data in JSON by leveraging the <a href=\"https://seznam.github.io/elasticlient/classelasticlient_1_1Scroll.html\" rel=\"nofollow noreferrer\">scroll API</a>. Sample usage can be found <a href=\"https://github.com/seznam/elasticlient#usage-of-scroll-api\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 35, "user_id": 11670131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed7bac3e904b3b0e37b23047f727e17b?s=128&d=identicon&r=PG&f=1", "display_name": "Varuzhan", "link": "https://stackoverflow.com/users/11670131/varuzhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "closed_date": 1560989663, "accepted_answer_id": 56667534, "answer_count": 1, "score": 0, "last_activity_date": 1561101672, "creation_date": 1560945426, "last_edit_date": 1561101672, "question_id": 56667128, "link": "https://stackoverflow.com/questions/56667128/how-to-save-data-of-elasticsearch-in-format-of-json", "closed_reason": "Needs details or clarity", "title": "How to save data of elasticsearch in format of json?", "body": "<p>I want to get document from elasticsearch and save it in format of json. This I need in my c++ code.Searching in the web I have found a command:</p>\n\n<blockquote>\n  <p>curl -XGET 'localhost:9200/</p>\n</blockquote>\n\n<p>But I need to get data in json format, store it and then work with it in my c++ code. </p>\n\n<p>I think I must use curl.h library.</p>\n\n<p>But this is all that I know.\nHow can I do it?</p>\n"}, {"tags": ["c", "pipe", "stdout", "stdin"], "comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1560942260, "post_id": 56666038, "comment_id": 99900163, "body": "Your use of <code>dup</code> is a bit fragile. I suggest you either use <code>dup2</code> or at least check the returned fd is what you expected. You can find out exactly what is happening by running it under <code>strace -ff -o strace</code> (to follow forks and separate the trace for each child process)"}, {"owner": {"reputation": 23, "user_id": 9005772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e279319157520ec86123f5f6c1bf439?s=128&d=identicon&r=PG&f=1", "display_name": "mrb", "link": "https://stackoverflow.com/users/9005772/mrb"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1560942610, "post_id": 56666038, "comment_id": 99900361, "body": "for replacing e. g.  <code>close(STDOUT_FILENO); dup(lssort[1]); close(lssort[0]);</code>  with dup2 it would be like this ?  <code>close(STDOUT_FILENO); dup2(lssort[1], STDOUT_FILENO);</code>"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1560942721, "post_id": 56666038, "comment_id": 99900412, "body": "Yep. I know <code>dup</code> uses the lowest available fd, but it relies on implicit knowledge, rather than being explicit in the code. It&#39;s also fragile in the face of refactoring or reordering code."}, {"owner": {"reputation": 23, "user_id": 9005772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e279319157520ec86123f5f6c1bf439?s=128&d=identicon&r=PG&f=1", "display_name": "mrb", "link": "https://stackoverflow.com/users/9005772/mrb"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1560942991, "post_id": 56666038, "comment_id": 99900564, "body": "Ok i have replaced the dup calls by dup2 calls but I doesn&#39;t seem to change the behaviour when I run the program.  How do i have to use <code>strace -ff -o strace</code>?"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1560945760, "post_id": 56666038, "comment_id": 99902187, "body": "stick that lot at the start of the command line and <code>&#47;path&#47;to&#47;your&#47;executable</code> at the end. It&#39;ll give you a trace of every system call made by every child process in separate files."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1560945943, "post_id": 56666038, "comment_id": 99902302, "body": "Is your assignment to write a C program that <b>behaves</b> like the shell command line? Or to write a C program that <b>invokes</b> the commands in a sub shell?"}, {"owner": {"reputation": 23, "user_id": 9005772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e279319157520ec86123f5f6c1bf439?s=128&d=identicon&r=PG&f=1", "display_name": "mrb", "link": "https://stackoverflow.com/users/9005772/mrb"}, "edited": false, "score": 0, "creation_date": 1560970462, "post_id": 56666038, "comment_id": 99915681, "body": "I have to write a C program that <b>behaves</b> like the shell command line. To do that I have to use fork, pipe &amp; exec."}], "owner": {"reputation": 23, "user_id": 9005772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e279319157520ec86123f5f6c1bf439?s=128&d=identicon&r=PG&f=1", "display_name": "mrb", "link": "https://stackoverflow.com/users/9005772/mrb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560941763, "creation_date": 1560941763, "question_id": 56666038, "link": "https://stackoverflow.com/questions/56666038/c-build-pipes-for-command-ls-lr-ddir-sort-grep-string-outfile", "title": "C build pipes for command &#39;ls -lR [-ddir] | sort | grep string [ &gt;outfile]&#39;", "body": "<p>For my homework I have to create a program in C that is equivalent to the shell command 'ls -lR [dir] | sort | grep string [ >outfile]' with the syntax 'lsgrep [-ddir] string [-foutfile]'.</p>\n\n<p>For some reason the second pipe (which should be connected to the grep-child-process) doesn't seem to work properly. </p>\n\n<p>When I remove the third child process (grep) the program prints the sorted 'ls -lR' contents and terminates. Therefore I think the problem is related to the second pipe (sortgrep).</p>\n\n<pre><code>    ...\n    // ls -lR [dir] | sort | grep string [ &gt;outfile]\n    // -------------^------^------------------------\n    int lssort[2];\n    int sortgrep[2];\n\n    pipe(lssort);\n    pipe(sortgrep);\n\n    if (fork() == 0)\n    {\n      close(STDOUT_FILENO);\n      dup(lssort[1]);\n      close(lssort[0]);\n      char * argv[] =\n      { \"ls\", \"-lR\", parameters.dirIsSet ? dir : (char *) NULL, (char *) NULL };\n      execvp(\"ls\", argv);\n    }\n\n    if (fork() == 0)\n    {\n      close(STDIN_FILENO);\n      dup(lssort[0]);\n      close(lssort[1]);\n\n      close(STDOUT_FILENO);\n      dup(sortgrep[1]);\n      close(sortgrep[0]);\n\n      char * argv[] = { \"sort\", (char *) NULL };\n      execvp(\"sort\", argv);\n    }\n\n    if (fork() == 0)\n    {\n      close(STDIN_FILENO);\n      dup(sortgrep[0]);\n      close(sortgrep[1]);\n\n      if (parameters.outfileIsSet)\n      {\n        close(STDOUT_FILENO);\n        int fd = open(outfile, O_CREAT | O_RDWR);\n        if (fd == -1) perror(\"Error: Could not open file\");\n        dup(fd);\n        close(fd);\n      }\n\n      char * argv[] = { \"grep\", string, (char *) NULL };\n      execvp(\"grep\", argv);\n    }\n\n    close(lssort[0]);\n    close(lssort[1]);\n\n    close(sortgrep[0]);\n    close(sortgrep[1]);\n\n    close(STDIN_FILENO);\n    close(STDOUT_FILENO);\n\n    wait(0);\n    wait(0);\n\n    return 0;\n    ...\n</code></pre>\n\n<p>My expected output when running the program would be</p>\n\n<ol>\n<li>'ls -lR [-ddir]' lists the contents of the (optionally given/current working) directory and pipes them through the pipe 'lssort' to the next child process (sort)</li>\n<li>'sort' sorts the contents received from the pipe 'lssort' and pipes the results through 'sortgrep' to the next child process (grep)</li>\n<li>'grep string [-foutfile]' selects lines which match the given pattern (string) and prints them to stdout or if defined to a log file (outfile)</li>\n</ol>\n\n<p>In fact the program just keeps on running/waiting for input. When I run 'top' in another terminal I can see that sort and grep are sleeping.</p>\n"}, {"tags": ["c", "stm32"], "comments": [{"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1560943790, "post_id": 56666025, "comment_id": 99901049, "body": "Hello and welcome to StackOverflow. Please take some time to read the <a href=\"https://stackoverflow.com/help\">help page</a>, especially the sections named <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>. You might also want to learn about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and how to <a href=\"https://stackoverflow.com/editing-help\">format your question</a>.  What keys are you using? And is your gateway in range and working correctly? Are you receiving uplinks from the node?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560944978, "post_id": 56666025, "comment_id": 99901723, "body": "Probably the radio modules aren&#39;t configured the same way. This is way too broad a question."}, {"owner": {"reputation": 1, "user_id": 11669551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fbb6db35c12a315e888a08ae7af1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Amaal", "link": "https://stackoverflow.com/users/11669551/amaal"}, "edited": false, "score": 0, "creation_date": 1560945526, "post_id": 56666025, "comment_id": 99902038, "body": "I&#39;m using the ping pong code on B-l072Z-LRWAN1 with I-CUBE-LRWAN firmware package and a device sending data  with CMWX1ZZABZ-091 open module by Murata I tested the device on the gateway and it&#39;s sending correctly , but there is no reception in the code of ping pong (while rx and tx parameters are the same like the device code)  ."}, {"owner": {"reputation": 1, "user_id": 11669551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fbb6db35c12a315e888a08ae7af1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Amaal", "link": "https://stackoverflow.com/users/11669551/amaal"}, "edited": false, "score": 0, "creation_date": 1560945750, "post_id": 56666025, "comment_id": 99902180, "body": "the radio module is configured the same way"}, {"owner": {"reputation": 1, "user_id": 11669551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fbb6db35c12a315e888a08ae7af1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Amaal", "link": "https://stackoverflow.com/users/11669551/amaal"}, "edited": false, "score": 0, "creation_date": 1561586125, "post_id": 56666025, "comment_id": 100117713, "body": "Acctually ,It was a problem with the stm board , the jumpers must be in their default position"}], "owner": {"reputation": 1, "user_id": 11669551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fbb6db35c12a315e888a08ae7af1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Amaal", "link": "https://stackoverflow.com/users/11669551/amaal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560941701, "creation_date": 1560941701, "question_id": 56666025, "link": "https://stackoverflow.com/questions/56666025/how-to-fix-ping-pong-with-lora-working-only-on-rx-timeout-and-tx-timeout-in-stm3", "title": "How to fix ping pong with lora working only on RX_timeout and TX_timeout in stm32 in C language", "body": "<p>I'm working with the ping pong with lora in stm32 , the code doesn't recieve anything , it only executes the RX_timeout and TX_timeout while the device in the other side is sending DATA correctly with lora,\nHow can I fix this problem  ? </p>\n\n<p>this is in the stm32 : B-l072Z-LRWAN1 with I-CUBE-LRWAN firmware package</p>\n"}, {"tags": ["c", "unix", "warnings", "shared-memory"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1560941193, "post_id": 56665611, "comment_id": 99899614, "body": "Next time, indicate <i>clearly</i> where the error occurrs. Next time first <i>investigate</i> what is going on at the error location."}, {"owner": {"reputation": 61, "user_id": 11121537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd462db1921900266a96519037dcad1d?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/11121537/abc"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1560943586, "post_id": 56665611, "comment_id": 99900914, "body": "I did, the problem was just that. My eyes saw everything perfect they had not noticed the missing parenthesis. So the problem for me was somewhere else but I didn&#39;t know where and what it was."}], "answers": [{"comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1560940741, "post_id": 56665693, "comment_id": 99899396, "body": "Note that there probably was also a warning telling you the assignment needed brackets. Warnings can be useful!"}, {"owner": {"reputation": 61, "user_id": 11121537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd462db1921900266a96519037dcad1d?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/11121537/abc"}, "edited": false, "score": 0, "creation_date": 1560941794, "post_id": 56665693, "comment_id": 99899932, "body": "Do you think the question should be removed? I would agree"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1560941984, "post_id": 56665693, "comment_id": 99900029, "body": "Just keep it, it does not hurt. I think it is a common mistake and now we have a reason to not use this construct at all."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560956601, "post_id": 56665693, "comment_id": 99908950, "body": "This can&#39;t be the whole story though. <code>id_mem</code> is an integer. The result of <code>==</code> is an integer. So where is the pointer from integer without a cast bug?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1560956684, "post_id": 56665693, "comment_id": 99909005, "body": "Ah right nevermind, it is the same kind of bug, but on a different line: <code>addr_mem =shmat(id_mem,NULL,0) == (void *)-1</code>. That&#39;s the line giving the compiler error."}], "tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": true, "score": 4, "last_activity_date": 1560940610, "creation_date": 1560940610, "answer_id": 56665693, "question_id": 56665611, "link": "https://stackoverflow.com/questions/56665611/how-to-fix-assignment-makes-pointer-from-integer-without-a-cast-wint-convers/56665693#56665693", "title": "How to fix &quot; assignment makes pointer from integer without a cast [-Wint-conversion]&quot;? C unix program", "body": "<p>IMO <code>if(id_mem = shmget(key_mem,SHMEMSIZE,IPC_CREAT|0666) == -1)</code> is very bad style, exactly for the problem you have. You forgot to add parantheses around the assignment. You compare the result of <code>shmget</code> with <code>-1</code> and assign this result to <code>id_mem</code>.</p>\n\n<p>Change it to <code>if((id_mem = shmget(key_mem,SHMEMSIZE,IPC_CREAT|0666)) == -1)</code> or even better</p>\n\n<pre><code>id_mem = shmget(key_mem,SHMEMSIZE,IPC_CREAT|0666);\nif (id_mem == -1)\n</code></pre>\n\n<p>The next <code>if</code>s have the same problem.</p>\n"}], "owner": {"reputation": 61, "user_id": 11121537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd462db1921900266a96519037dcad1d?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/11121537/abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 56665693, "answer_count": 1, "score": 0, "last_activity_date": 1560940610, "creation_date": 1560940329, "question_id": 56665611, "link": "https://stackoverflow.com/questions/56665611/how-to-fix-assignment-makes-pointer-from-integer-without-a-cast-wint-convers", "title": "How to fix &quot; assignment makes pointer from integer without a cast [-Wint-conversion]&quot;? C unix program", "body": "<p>I'm writing this 2 programs but I recive this warning: \" assignment makes pointer from integer without a cast [-Wint-conversion]\".</p>\n\n<p>I'm trying to compile these programs to other Machines, but I recive same problem.\nWhat can I do?</p>\n\n<pre><code>//PROGRAM 1  (PRODUCTOR)\n\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;stdio.h&gt;\n\n#define SHMEMSIZE 4096\n\nint main()\n{\n\n    key_t key_mem=6868;\n    key_t key_sem=3232;\n    int id_mem;\n    int id_sem;\n    void *addr_mem;\n    struct sembuf param[1];\n\n    if(id_mem = shmget(key_mem,SHMEMSIZE,0) == -1)\n    {\n        printf(\"Errore1\\n\");\n        return -1;\n    }\n\n\n    if(addr_mem =shmat(id_mem,NULL,0) == (void *)-1)\n    {\n        printf(\"Errore2\\n\");\n        return -1;\n    }\n\n    if(id_sem = semget(key_sem,2,0)== -1)\n    {   \n        perror(\"Errore3\\n\");\n        shmdt(addr_mem);\n        return -1;\n    }\n\n    while(1)\n    {\n        param[0].sem_num=1;\n        param[0].sem_op=-1;\n        param[0].sem_flg=0;\n\n        if(semop(id_sem,param,1)==-1)\n        {\n            printf(\"Errore6\\n\");\n            return -1;\n        }\n        printf(\"Scrivi messaggio: \");\n        if(scanf(\"%[^\\n]\", (char *)addr_mem) == 0)\n             *((char *)addr_mem) = '\\0';\n        getc(stdin);\n\n        param[0].sem_num=0;\n        param[0].sem_op=1;\n        param[0].sem_flg=0;\n        if(semop(id_sem,param,1)==-1)\n        {\n            printf(\"Errore7\\n\");\n            return -1;\n        }\n    }\n\n    shmdt(addr_mem);\n\n}\n\n\n\n\n\n\n_____________________________________________________\n\n//PROGRAM 2 (CONSUMER)\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;stdio.h&gt;\n#define SHMEMSIZE 4096\n\nunion semun \n{\n    int val;\n    struct semid_ds *buf;\n    unsigned short *array;\n    struct seminfo *__buf;\n};\n\nint main()\n{\n\n    key_t key_mem=6868;\n    key_t key_sem=3232;\n    int id_mem;\n    int id_sem;\n    void *addr_mem;\n\n    union semun arg;\n    struct sembuf param[1];\n\n    if(id_mem = shmget(key_mem,SHMEMSIZE,IPC_CREAT|0666) == -1)\n    {\n        printf(\"Errore1\");\n        return -1;\n    }\n\n    if(addr_mem =shmat(id_mem,NULL,0) == (void *)-1)\n    {\n        printf(\"Errore2\");\n        shmctl(id_mem, IPC_RMID, NULL);\n        return -1;\n    }\n\n    if(id_sem = semget(key_sem,2,IPC_CREAT|0666)== -1)\n    {   \n        printf(\"Errore3\");\n        shmctl(id_mem, IPC_RMID, NULL);\n        shmdt(addr_mem);\n        return -1;\n    }\n\n    arg.val=0;\n    if(semctl(id_sem,0,SETVAL,arg)==-1)\n    {\n        printf(\"Errore4\");\n        semctl(id_sem, -1, IPC_RMID,arg);\n        shmctl(id_sem, IPC_RMID, NULL);\n        shmdt(addr_mem);\n        return -1;\n    }\n    arg.val=1;\n    if(semctl(id_sem,1,SETVAL,arg)==-1)\n    {\n        printf(\"Errore5\");\n        semctl(id_sem, -1, IPC_RMID, arg);\n        shmctl(id_sem, IPC_RMID, NULL);\n        shmdt(addr_mem);\n        return -1;\n    }\n\n    while(1)\n    {\n        param[0].sem_num=0;\n        param[0].sem_op=-1;\n        param[0].sem_flg=0;\n\n        if(semop(id_sem,param,1)==-1)\n        {\n            printf(\"Errore6\");\n            return -1;\n        }\n\n        printf(\"Il messaggio scritto \u00c3\u00a8: %s\\n\",(char *)addr_mem);\n        param[0].sem_num=1;\n        param[0].sem_op=1;\n        param[0].sem_flg=0;\n        if(semop(id_sem,param,1)==-1)\n        {\n            printf(\"Errore7\");\n            return -1;\n        }\n    }\n\n}\n</code></pre>\n\n<p>My program should simply allow a producer process to write on shared memory and the consumer process to read shared memory.</p>\n\n<p>I first receive this \"warning\" and after that if I try to run the producer I get a \"Segmentation Fault\". I absolutely can't understand what's going on.</p>\n\n<p>I suppose that the shared memory is not really created, in fact if I delete the line <code>* ((char *) addr_mem) = '0';</code> I do not get the \"Segmentation Fault\", and it is clear that the \"Scanf\" is not writing anything.</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1560939631, "post_id": 56665034, "comment_id": 99898851, "body": "If you want to understand how the macro is implemented, then look up its definition in the .h file where it is defined."}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1560939663, "post_id": 56665034, "comment_id": 99898866, "body": "Hello and welcome to StackOverflow. Please take some time to read the <a href=\"https://stackoverflow.com/help\">help page</a>, especially the sections named <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>. You might also want to learn about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and how to <a href=\"https://stackoverflow.com/editing-help\">format your question</a>. Your question now makes no mention of what software you are editing so we can&#39;t help you."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11632342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585acad172fe982a079adebcf8d48a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan", "link": "https://stackoverflow.com/users/11632342/rajan"}, "edited": false, "score": 0, "creation_date": 1561021397, "post_id": 56678845, "comment_id": 99930814, "body": "You mean to say wake_up_all() will wake up those tasks that are in uninterruptible wait queue , and wake_up_interruptible() marco will wake up those tasks that are not in uninterruptible wait but waiting for interrupts to wake them up ...need some clarification in this."}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "reply_to_user": {"reputation": 23, "user_id": 11632342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585acad172fe982a079adebcf8d48a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan", "link": "https://stackoverflow.com/users/11632342/rajan"}, "edited": false, "score": 1, "creation_date": 1561041115, "post_id": 56678845, "comment_id": 99942023, "body": "@Rajan: <code>wake_up_all()</code> wakes up all tasks on the wait queue regardless of whether they&#39;re waiting interruptibly or uninterruptibly.  <code>wake_up_interruptible()</code> wakes up only those tasks in interruptible wait."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1561478087, "post_id": 56678845, "comment_id": 100073335, "body": "Also, <code>wake_up()</code> and <code>wake_up_interruptible()</code> only wake a single task waiting on the queue. There is a <code>wake_up_interruptible_all()</code> function to wake up all tasks that are waiting interruptibly on the queue."}], "tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 0, "last_activity_date": 1561040867, "last_edit_date": 1561040867, "creation_date": 1561003544, "answer_id": 56678845, "question_id": 56665034, "link": "https://stackoverflow.com/questions/56665034/why-use-wake-up-all-and-not-wake-up-interruptible/56678845#56678845", "title": "Why use wake_up_all() and not wake_up_interruptible()?", "body": "<p>When a task waits on a waitqueue in the Linux kernel it can be in either interruptible or uninterruptible wait.  The former will be woken by signals and the latter not.  The type of wait is controlled by the waiting task when it waits on the waitqueue.</p>\n\n<p>The <code>wake_up_all()</code> function will wake up every task waiting on the given wait queue, both those waiting interruptibly and uninterruptibly.  This code is using <code>wake_up_all()</code> because it supports tasks waiting uninterruptibly for this particular condition (see <code>ttm_read_lock()</code>).</p>\n\n<p>The <code>wake_up_interruptible()</code> function only wakes tasks waiting interruptibly, so would only be used if you did <em>not</em> want to wake tasks in uninterruptible wait.</p>\n"}], "owner": {"reputation": 23, "user_id": 11632342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/585acad172fe982a079adebcf8d48a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajan", "link": "https://stackoverflow.com/users/11632342/rajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 56678845, "answer_count": 1, "score": 0, "last_activity_date": 1561040867, "creation_date": 1560938490, "last_edit_date": 1560968124, "question_id": 56665034, "link": "https://stackoverflow.com/questions/56665034/why-use-wake-up-all-and-not-wake-up-interruptible", "title": "Why use wake_up_all() and not wake_up_interruptible()?", "body": "<p>I want to understand why <code>wake_up_all(&amp;lock-&gt;queue)</code> macro is used in the code below, and is this macro <code>wake_up_interruptible()</code> is same macro?</p>\n\n<p>Please guide me in this regard, thank you.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void ttm_read_unlock(struct ttm_lock *lock)\n{\n    spin_lock(&amp;lock-&gt;lock);\n    if (--lock-&gt;rw == 0)\n        wake_up_all(&amp;lock-&gt;queue);\n    spin_unlock(&amp;lock-&gt;lock);\n}\n\nstatic bool __ttm_read_lock(struct ttm_lock *lock)\n{\n    bool locked = false;\n\n      spin_lock(&amp;lock-&gt;lock);\n      if (unlikely(lock-&gt;kill_takers)) \n    {\n          send_sig(lock-&gt;signal, current, 0);\n          spin_unlock(&amp;lock-&gt;lock);\n        return false;\n       }\n      if (lock-&gt;rw &gt;= 0 &amp;&amp; lock-&gt;flags == 0) \n    {\n            ++lock-&gt;rw;\n            locked = true;\n      }\n      spin_unlock(&amp;lock-&gt;lock);\n      return locked;\n}\n\nint ttm_read_lock(struct ttm_lock *lock, bool interruptible)\n{\n    int ret = 0;\n\n      if (interruptible)\n          ret = wait_event_interruptible(lock-&gt;queue,__ttm_read_lock(lock));\n      else\n            wait_event(lock-&gt;queue, __ttm_read_lock(lock));\n      return ret;\n}\n</code></pre>\n"}, {"tags": ["c", "malloc"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5377005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754ae367899b7e83cd33628e6d5c8193?s=128&d=identicon&r=PG", "display_name": "user5377005", "link": "https://stackoverflow.com/users/5377005/user5377005"}, "edited": false, "score": 0, "creation_date": 1560936925, "post_id": 56664460, "comment_id": 99897266, "body": "Thanks for the first issue, thats fixed. But the second thing you mentioned, breaks the application further, I thought that too."}, {"owner": {"reputation": 77, "user_id": 5377005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754ae367899b7e83cd33628e6d5c8193?s=128&d=identicon&r=PG", "display_name": "user5377005", "link": "https://stackoverflow.com/users/5377005/user5377005"}, "edited": false, "score": 0, "creation_date": 1560937039, "post_id": 56664460, "comment_id": 99897327, "body": "If I follow your second suggestion, this is the output - <a href=\"https://gyazo.com/b9fd7cd6853742d931e62c52e4c4e01d\" rel=\"nofollow noreferrer\">gyazo.com/b9fd7cd6853742d931e62c52e4c4e01d</a>"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 77, "user_id": 5377005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754ae367899b7e83cd33628e6d5c8193?s=128&d=identicon&r=PG", "display_name": "user5377005", "link": "https://stackoverflow.com/users/5377005/user5377005"}, "edited": false, "score": 0, "creation_date": 1560937084, "post_id": 56664460, "comment_id": 99897352, "body": "@user5377005: If you want <code>str.data</code> to behave like a regular C string, you must append the null character, <code>&#39;\\0&#39;</code>. You must also reserve space for it."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 3, "last_activity_date": 1560938474, "last_edit_date": 1560938474, "creation_date": 1560936667, "answer_id": 56664460, "question_id": 56664354, "link": "https://stackoverflow.com/questions/56664354/problems-with-heap-corruption-c/56664460#56664460", "title": "Problems with Heap Corruption - C", "body": "<p>There are two problems with your reallocation. First of all, you're not assigning the result of the <code>realloc</code> to <code>str-&gt;data</code>, so if the memory was reallocated to a different place, <code>tr-&gt;data</code> points to invalid memory afterwards. Second, you're not adding the sizes of the string and the appended part, you're just taking the size of the part that you're appending.</p>\n\n<p>This here</p>\n\n<pre><code>realloc(str-&gt;data, charsLength);\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>str-&gt;data = realloc(str-&gt;data, charsLength + str-&gt;length + 1);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 5377005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754ae367899b7e83cd33628e6d5c8193?s=128&d=identicon&r=PG", "display_name": "user5377005", "link": "https://stackoverflow.com/users/5377005/user5377005"}, "edited": false, "score": 1, "creation_date": 1560937785, "post_id": 56664605, "comment_id": 99897775, "body": "I think i have fixed my code, with a couple of your recommendations. Here is a link too the new work - <a href=\"https://repl.it/repls/RosyAggressiveFact\" rel=\"nofollow noreferrer\">repl.it/repls/RosyAggressiveFact</a>"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 3, "last_activity_date": 1560937774, "last_edit_date": 1560937774, "creation_date": 1560937120, "answer_id": 56664605, "question_id": 56664354, "link": "https://stackoverflow.com/questions/56664354/problems-with-heap-corruption-c/56664605#56664605", "title": "Problems with Heap Corruption - C", "body": "<p>Apart from the blaze answer.\nThere are few more problems.</p>\n\n<pre><code>// for (int i = 0; i &lt; str-&gt;length; i++) \n// {\n//  if (i &lt; startIndex || i &gt; endIndex) {\n//      temp[i] = str-&gt;data[i];\n//  } \n// }\n</code></pre>\n\n<p>You will access out of bound for <code>temp</code>.\nYou need to maintain separate index for <code>temp</code>.</p>\n\n<pre><code>char * temp = malloc(newSize+1);\nint k=0;\nfor (int i = 0; i &lt; str-&gt;length; i++) \n {\n  if (i &lt; startIndex || i &gt; endIndex) {\n      temp[k++] = str-&gt;data[i];\n  } \n}\n temp[k] = '\\0'; \n free(str-&gt;data);\n str-&gt;length = newSize;\n str-&gt;data = temp;\n</code></pre>\n\n<p>And</p>\n\n<p>You are not <code>null</code> terminating the string after append.</p>\n\n<pre><code>str-&gt;data = realloc(str-&gt;data, str-&gt;length + charsLength +1); //current length + new length + \\0\nfor (int i = 0; i &lt; charsLength; i++) {\n    str-&gt;data[i + str-&gt;length] = characters[i];\n}\n str-&gt;data[i + str-&gt;length] = '\\0'; //null terminate the new string\nstr-&gt;length = str-&gt;length + charsLength;\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5377005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754ae367899b7e83cd33628e6d5c8193?s=128&d=identicon&r=PG", "display_name": "user5377005", "link": "https://stackoverflow.com/users/5377005/user5377005"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 56664605, "answer_count": 2, "score": 2, "last_activity_date": 1560938474, "creation_date": 1560936351, "last_edit_date": 1560937084, "question_id": 56664354, "link": "https://stackoverflow.com/questions/56664354/problems-with-heap-corruption-c", "title": "Problems with Heap Corruption - C", "body": "<p>I am making a \"simple\" print out string, append string and remove section from a string. The append and new string works sometimes, sometimes it outputs nothing.\nWhen i do:</p>\n\n<pre><code>char * temp = malloc(newSize);\n</code></pre>\n\n<p>It just stops outputting anything.</p>\n\n<p>I have commented everything out in sections, trying to find the problem. Can't seem to find the problem, but google keeps coming up with \"Heap Corruption\".</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct {\n    char * data;\n    int length;\n} String;\n\nint str_getLength(const char * characters)\n{\n    int index = 0;\n    while (1)\n    {\n        if (characters[index] == '\\0') break;\n        index++;\n    }\n    return index;\n}\n\nString str_new(const char * characters) \n{\n    String result;\n    result.length = str_getLength(characters);\n    result.data = malloc(result.length);\n    memcpy(result.data, characters, result.length);\n    return result;\n}\n\nvoid str_append(String * str, const char * characters) \n{\n    int charsLength = str_getLength(characters);\n    str-&gt;data = realloc(str-&gt;data, charsLength);\n    for (int i = 0; i &lt; charsLength; i++) {\n        str-&gt;data[i + str-&gt;length] = characters[i];\n    }\n    str-&gt;length = str-&gt;length + charsLength;\n}\n\nvoid str_remove(String * str, int startIndex, int endIndex) \n{\n    if (startIndex &lt; 0 || endIndex &gt; str-&gt;length || endIndex &lt; startIndex) {\n        return;\n    }\n    int chunkSize = endIndex - startIndex;\n    int newSize = str-&gt;length - chunkSize;\n\n    char * temp = malloc(newSize);\n    // for (int i = 0; i &lt; str-&gt;length; i++) \n    // {\n    //  if (i &lt; startIndex || i &gt; endIndex) {\n    //      temp[i] = str-&gt;data[i];\n    //  } \n    // }\n\n    // free(str-&gt;data);\n    // str-&gt;length = newSize;\n    // str-&gt;data = temp;\n}\n}\n\nint main() \n{\n    String str = str_new(\"Hello, \");\n    printf(\"%s\\n\", str.data);\n\n    str_append(&amp;str, \"this is my first C application.\");\n    printf(\"%s\\n\", str.data);\n\n    str_remove(&amp;str, 0, 3);\n    printf(\"%s\\n\", str.data);\n\n    free(str.data);\n\n    return 0;\n}\n</code></pre>\n\n<p>I expected it to output a modified string, it doesn't and sometimes it outputs nothing.\nI am a beginner, sorry if it's a quick fix.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1560936615, "post_id": 56664281, "comment_id": 99897093, "body": "the only chance to define different types in function of architecture is by using conditional  #define"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1560936619, "post_id": 56664281, "comment_id": 99897096, "body": "Portability is a big topic. Regarding types specifically, you should be using <code>stdint.h</code> and pick the type for each variable with care. Porting code containing small integer types to 8 bit MCUs takes quite a lot of C skill - why I recommend all beginners to stay clear of crap like Arduino."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1560936705, "post_id": 56664281, "comment_id": 99897145, "body": "See also <a href=\"https://stackoverflow.com/q/47697926/2173773\">BYTE, WORD and DWORD macros definition</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560937328, "post_id": 56664281, "comment_id": 99897509, "body": "Oh and also, keeping code portable between C and C++ is another major pain... so you might want to settle for pure C, as that gets significantly easier to port. Except then you can&#39;t port to Arduino..."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 2, "creation_date": 1560937473, "post_id": 56664281, "comment_id": 99897590, "body": "It is impossible and doesn&#39;t make sense to support <i>every platform</i>. Your code is never &quot;portable&quot; or &quot;not-portable&quot;, it is always portable to some degree which can be measured as a number of supported platforms. You need to understand what platforms you need to support before you start writing &quot;portable&quot; code."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1560937777, "post_id": 56664281, "comment_id": 99897769, "body": "First, decide if you are using C or C++ - coding to a &quot;common subset&quot; of the two makes portability harder to achieve. Use standard types (built-in or in the standard library) where you can, or types that can be created using them (structures, pointers, etc) - but account for implementation-defined properties. Failing that, use types that the standard specifies, but that are not guaranteed for all compilers (e.g. <code>int64_t</code>).  If you must define types differently for different compilers, do it sparingly, and use the preprocessor to detect each compiler and do definitions accordingly."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 3, "creation_date": 1560939589, "post_id": 56664281, "comment_id": 99898836, "body": "What do you expect from a type called <code>word</code>?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1560940396, "post_id": 56664281, "comment_id": 99899256, "body": "@eeronika - personally, I&#39;d expect to be able to check variables of that type with a spell-checker.  ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1560937404, "post_id": 56664618, "comment_id": 99897552, "body": "<code>bool</code> is not a reserved keyword in C.  It is in C++."}, {"owner": {"reputation": 1199, "user_id": 6356744, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c12512db0046c6637c3e4b084cff575?s=128&d=identicon&r=PG&f=1", "display_name": "tttapa", "link": "https://stackoverflow.com/users/6356744/tttapa"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1560937553, "post_id": 56664618, "comment_id": 99897636, "body": "@Peter You&#39;re right, I just assumed C++ here because it was the first tag, I updated my answer :)"}, {"owner": {"reputation": 75, "user_id": 5506984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3790e63edf14b2f538cf9bd1ea4705a?s=128&d=identicon&r=PG&f=1", "display_name": "Hneel", "link": "https://stackoverflow.com/users/5506984/hneel"}, "edited": false, "score": 0, "creation_date": 1561022279, "post_id": 56664618, "comment_id": 99931265, "body": "I&#39;ve decided to gonna use a section for each known compiler, like in the example."}], "tags": [], "owner": {"reputation": 1199, "user_id": 6356744, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c12512db0046c6637c3e4b084cff575?s=128&d=identicon&r=PG&f=1", "display_name": "tttapa", "link": "https://stackoverflow.com/users/6356744/tttapa"}, "is_accepted": true, "score": 5, "last_activity_date": 1560937511, "last_edit_date": 1560937511, "creation_date": 1560937157, "answer_id": 56664618, "question_id": 56664281, "link": "https://stackoverflow.com/questions/56664281/how-to-write-generic-compiler-independent-code/56664618#56664618", "title": "How to write generic compiler-independent code?", "body": "<p>All platforms should support <code>bool</code> as it is a reserved keyword for a built-in type in C++.</p>\n\n<p>The only platform I know of that has <code>byte</code> and <code>word</code> is Arduino. They are just typedef'ed aliases to <code>uint8_t</code> and <code>unsigned int</code> respectively. (<a href=\"https://github.com/arduino/ArduinoCore-avr/blob/b7c607663fecc232e598f2c0acf419ceb0b7078c/cores/arduino/Arduino.h#L121\" rel=\"noreferrer\">Source</a>)</p>\n\n<p>If you have existing Arduino code that uses <code>byte</code> and <code>word</code>, the easiest solution would be to check if your code runs in the Arduino environment, and define the Arduino types yourself if that's not the case:</p>\n\n<pre><code>#ifdef ARDUINO\n#include &lt;Arduino.h&gt;\n#else\n#include &lt;cstdint&gt;\ntypedef uint16_t word; // or unsigned int, depending on your needs\ntypedef uint8_t byte;\n#endif\n</code></pre>\n\n<p>However, my preferred solution is to just use the standard integers of <code>stdint.h</code> directly when I need a specific number of bits. Using <code>byte</code> and <code>word</code> just adds to the confusion, because it is non-standard. <code>uint16_t</code> tells you exactly what it is, you know exactly what the largest possible value is, and whether it's signed or not.</p>\n"}], "owner": {"reputation": 75, "user_id": 5506984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3790e63edf14b2f538cf9bd1ea4705a?s=128&d=identicon&r=PG&f=1", "display_name": "Hneel", "link": "https://stackoverflow.com/users/5506984/hneel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 56664618, "answer_count": 1, "score": 1, "last_activity_date": 1560937511, "creation_date": 1560936158, "question_id": 56664281, "link": "https://stackoverflow.com/questions/56664281/how-to-write-generic-compiler-independent-code", "title": "How to write generic compiler-independent code?", "body": "<p>In my work I work with many different compilers for many platforms (Windows, embedded microcontrollers, Arduino, etc). \nNow I want to write a generic routine that should work with all of them, but I'm getting conflicts with data types.\nIt's mostly low-level stuff, so I would like to work with types like 'byte', 'word', 'bool' etc.</p>\n\n<p>For some compilers these types are not yet defined, but for some they are and in these cases that will result in errors of conflicting types.</p>\n\n<p>I have learned that typedef are prefered above #define. \nAnd in <a href=\"https://stackoverflow.com/questions/6772802/in-c-c-is-there-a-directive-similar-to-ifndef-for-typedefs\">this question</a> it is made clear that there is no way to make a conditional typedef. </p>\n\n<p>I already thought of using unique types like for example:</p>\n\n<pre><code>typedef unsigned char mybyte\ntypedef unsigned short int myword\netc...\n</code></pre>\n\n<p>But that would make my sourcecode look very ugly IMHO.</p>\n"}, {"tags": ["c", "search", "data-structures", "linked-list", "random-access"], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 11369414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56815d852d9c9961a498c47996e904ea?s=128&d=identicon&r=PG&f=1", "display_name": "LLucas", "link": "https://stackoverflow.com/users/11369414/llucas"}, "is_accepted": true, "score": 4, "last_activity_date": 1560937083, "creation_date": 1560937083, "answer_id": 56664596, "question_id": 56664217, "link": "https://stackoverflow.com/questions/56664217/c-data-structure-suitable-for-fast-search-and-simple-add-remove/56664596#56664596", "title": "C data structure suitable for fast search and simple add/remove", "body": "<p>I would use AVL binary search tree </p>\n\n<p>For an example of binary search tree you can take a look at <a href=\"https://www.geeksforgeeks.org/avl-tree-set-1-insertion/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/avl-tree-set-1-insertion/</a> and <a href=\"https://www.geeksforgeeks.org/avl-tree-set-2-deletion/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/avl-tree-set-2-deletion/</a> </p>\n\n<p>It's well detailed, there is C code and schema. </p>\n\n<p>It's efficient to search in, and It allows you to add and delete values.\nIt works for both numeric values and some characters implementations (such as dictionnay). </p>\n"}], "owner": {"reputation": 57, "user_id": 10441620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4902f114ad47b32e604e5333c7a234f?s=128&d=identicon&r=PG&f=1", "display_name": "Mahdi.B", "link": "https://stackoverflow.com/users/10441620/mahdi-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 56664596, "answer_count": 1, "score": 1, "last_activity_date": 1560937083, "creation_date": 1560936019, "question_id": 56664217, "link": "https://stackoverflow.com/questions/56664217/c-data-structure-suitable-for-fast-search-and-simple-add-remove", "title": "C data structure suitable for fast search and simple add/remove", "body": "<p>As stated in the question header, I need a data structure suitable for fast and efficient searching. The data structure should also be able to add/remove elements to/from anywhere inside the data structure.</p>\n\n<p>Currently I'm using a linked-list. But the problem is that I should walk through the list to find a desired element. General searching algorithms (binary search, jump search and ...) are not directly usable in linked lists, as there is no random access to list elements. Sorting list elements needed in these algorithms is also a problem.\nOn the other hand, I can't use arrays as it's hard to add/remove an element to/from any desired index.</p>\n\n<p>I've looked for searching algorithms in linked lists and I came to 'skip lists'. Now I'm here to ask if there is a better data structure for my case, or if there is a better search algorithm for linked lists.</p>\n"}, {"tags": ["c", "file", "stream", "rename", "dirent.h"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1560936671, "post_id": 56664137, "comment_id": 99897125, "body": "Use <a href=\"http://man7.org/linux/man-pages/man3/opendir.3.html\" rel=\"nofollow noreferrer\">opendir(3)</a> and <a href=\"http://man7.org/linux/man-pages/man3/readdir.3.html\" rel=\"nofollow noreferrer\">readdir(3)</a>. Notice that C11 does not know about directories."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 2, "last_activity_date": 1560936460, "last_edit_date": 1560936460, "creation_date": 1560936151, "answer_id": 56664277, "question_id": 56664137, "link": "https://stackoverflow.com/questions/56664137/is-it-possible-to-rename-a-file-in-c-using-directory-streams/56664277#56664277", "title": "Is it possible to rename a file in C using directory streams?", "body": "<p><code>struct dirent</code> is to represent the directory structure in the program which you will read using <code>readdir</code>, modifying the contents of it, will not effect the actual structure of directory.</p>\n\n<p>The <code>structure</code> is meant to hold the certain information of particular file in the directory thus it has no link to the actual file.</p>\n\n<pre><code>   struct dirent {\n       ino_t          d_ino;       /* Inode number */\n       off_t          d_off;       /* Not an offset; see below */\n       unsigned short d_reclen;    /* Length of this record */\n       unsigned char  d_type;      /* Type of file; not supported\n                                      by all filesystem types */\n       char           d_name[256]; /* Null-terminated filename */\n   };\n</code></pre>\n\n<hr>\n\n<p>You can use <code>rename</code> system call to rename the actual <code>file</code>.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>  while(dp = readdir(dirp)){\n    if((dp-&gt;d_name[0])!='.'){\n      char oldPath[1024], newPath[1024];\n\n      sprintf(oldPath, \"%s/%s\",dir, dp-&gt;d_name);\n      sprintf(newPath, \"%s/%s\",dir, pathOne);\n      if (rename(oldPath, newPath) &lt; 0)\n        printf(\"rename error path=%s\", oldPath);\n    }\n  }\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11669223, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Weljc9_20y4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcokeCO-70hEWHzX1Sfayd_MH657Q/mo/photo.jpg?sz=128", "display_name": "Robin Butel", "link": "https://stackoverflow.com/users/11669223/robin-butel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 56664277, "answer_count": 1, "score": 1, "last_activity_date": 1560936460, "creation_date": 1560935743, "question_id": 56664137, "link": "https://stackoverflow.com/questions/56664137/is-it-possible-to-rename-a-file-in-c-using-directory-streams", "title": "Is it possible to rename a file in C using directory streams?", "body": "<p>I'm new to C.\nI've coded this program that allows me to batch rename files in a same directory (mostly shows). It's currently using the Rename function from stdio while using the dirent struct to find the \"old name\". However, that means having to add the \"new name\" and the \"old name\" to a \"path string\" so that Rename can find the files. I was hoping there was a way to alter file names directly using dirent.</p>\n\n<p>I tried changing dp->d_name to the \"new name\" but that did not change the file names.</p>\n\n<p>This is not my full working program but code I've been using to try to test other methods of renaming.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dirent.h&gt;\n\nint main(){\n\n  DIR *dirp;\n  struct dirent *dp;\n  char dir[500];\n  char pathOne[500] = \"Testing.txt\";\n  int i;\n\n\n  printf(\"\\nPlease enter the target directory :\\n\");\n  scanf(\"%[^\\n]s\",dir);\n\n  dirp = opendir(dir);\n\n  printf(dirp ? \"Directory Connection Successful\\n\\n\" : \"Directory Connection Failed\\n\\n\");\n  printf(\"%s\\n\", pathOne);\n\n  while(dp = readdir(dirp)){\n    if((dp-&gt;d_name[0])!='.'){\n      for(i = 0; dp-&gt;d_name[i] = pathOne[i]; i++);\n      printf(\"%s\\n\", dp-&gt;d_name);\n    }\n  }\n\n\n  return 0;\n}\n</code></pre>\n\n<pre><code>Please enter the target directory :\nH:\\Documents\\TestFolder\nDirectory Connection Successful\n\nTesting.txt\nTesting.txt\nTesting.txt\nTesting.txt\n\nPress any key to continue . . .\n</code></pre>\n\n<p>This is what I get in the console but the file names in the explorer were not changed.</p>\n"}, {"tags": ["c", "numbers"], "comments": [{"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1560943335, "post_id": 56663803, "comment_id": 99900759, "body": "@Blaze: you should make it a proper answer, so the answer is voted and the question answered ;) +1"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1560944384, "post_id": 56663803, "comment_id": 99901375, "body": "@virolino alright, I added it as an answer. I thought it was a bit too brief for an answer so I elaborated a bit on some parts. :)"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 3, "last_activity_date": 1560944294, "creation_date": 1560944294, "answer_id": 56666823, "question_id": 56663803, "link": "https://stackoverflow.com/questions/56663803/why-does-my-c-program-give-different-outputs-in-different-compilers/56666823#56666823", "title": "Why does my C program give different outputs in different compilers?", "body": "<p>Using the <code>%d</code> format specifier, you're reading an <code>int</code> into <code>iUserInput</code>. That's correct, but then you use <a href=\"https://en.cppreference.com/w/c/string/byte/isdigit\" rel=\"nofollow noreferrer\"><code>isdigit</code></a> to try to see whether the number is between <code>1</code> and <code>10</code>. However, this function is for finding out whether a <code>char</code> is between <code>'0'</code> and <code>'9'</code>. That's not the same - assuming ASCII those chars are equal to to <code>48</code> and <code>57</code> respectively. So You <code>isdigit</code> check most likely finds out whether the inputted number is between <code>48</code> and <code>57</code> (although there's no guarantee that ASCII is used, so a different encoding might lead to different results).</p>\n\n<p>Instead, the check should be:</p>\n\n<pre><code>if((iUserInput &gt;= 1) &amp;&amp; (iUserInput &lt;= 10)) {...}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11620688, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KOYAVRoqASA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf9WV066GlOypwZs3bS2lzgQvKLyQ/mo/photo.jpg?sz=128", "display_name": "Shubh Roy", "link": "https://stackoverflow.com/users/11620688/shubh-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56666823, "answer_count": 1, "score": 1, "last_activity_date": 1569584137, "creation_date": 1560934702, "last_edit_date": 1569584137, "question_id": 56663803, "link": "https://stackoverflow.com/questions/56663803/why-does-my-c-program-give-different-outputs-in-different-compilers", "title": "Why does my C program give different outputs in different compilers?", "body": "<p>The result from my program is not what I expect and it is different on different compilers.</p>\n\n<p>I have tried it on three compilers, two of which give the same result. But I want a combination of the two results.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int iRandomNum = 0;\n    int iUserInput = 0;\n    const int VIP = 7;\n    srand(time(NULL));\n    iRandomNum = (rand() % 10) + 1;\n\n    printf(\"\\nGuess a number between 1 to 10.\\n Make a wish and type in the number.\\n\");\n\n    scanf(\"%d\", &amp;iUserInput);\n\n    if(isdigit(iUserInput))\n    {\n         printf(\"\\n\\nYou did not enter a digit between 1 to 10.\\n\\n\");\n    }\n    else\n    {\n        if(iUserInput==iRandomNum || iUserInput==VIP)\n            printf(\"\\n\\nYou guessed it right!\\n\\n\\n\");\n        else\n            printf(\"\\n\\nSorry the right answer was %d.\\n\\n\\n\", iRandomNum);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When I choose any number, the program should only alert me if I have not chosen the correct number in this number guessing game. But in the case of 7, we always have the right answer. This happens in the two online compilers. But in clang, when I do this &amp; does not work. The isdigit function does not work then</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "edited": false, "score": 0, "creation_date": 1560934715, "post_id": 56663732, "comment_id": 99896027, "body": "Do you have some code to show?"}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1560936976, "post_id": 56663732, "comment_id": 99897293, "body": "you are going to need some hardware because 485 is a differential protocol."}, {"owner": {"reputation": 1, "user_id": 11430512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce5ff2ad96542d83200793de73de094b?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u0434\u0435\u043d\u0442\u0438\u043a\u043e\u043d", "link": "https://stackoverflow.com/users/11430512/%d0%98%d0%b4%d0%b5%d0%bd%d1%82%d0%b8%d0%ba%d0%be%d0%bd"}, "edited": false, "score": 0, "creation_date": 1560937302, "post_id": 56663732, "comment_id": 99897489, "body": "I have a ConverterRS485, but how to make RTS switch automatically"}], "answers": [{"tags": [], "owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1561052502, "last_edit_date": 1561052502, "creation_date": 1560961989, "answer_id": 56672260, "question_id": 56663732, "link": "https://stackoverflow.com/questions/56663732/how-to-transfer-data-using-rs485-to-beaglebone-black/56672260#56672260", "title": "How to transfer data using RS485 to BeagleBone Black", "body": "<p>First I would check if your hardware support automatic (hardware) half-duplex direction control.</p>\n\n<p>If not, then you can take a look at this <a href=\"https://stackoverflow.com/a/56106253/11476836\">answer</a>. In there you have all the details you need to compile and install <em>libmodbus</em> with support for toggling the line with software.</p>\n\n<p>I'm using this solution in my RPi and CHIP computers but you should be able to use it right away on your BBB. You might find a small caveat if the GPIO file name has a 3 or 4-digit number (take a look in <code>/sys/class/gpio</code>). If that's the case, take a look <a href=\"https://github.com/marcosgatcomputer/pylibmodbus/wiki/Libmodbus-tests-with-Raspberry-Pi-server---Pocket-Chip-Client\" rel=\"nofollow noreferrer\">here</a>, I had to modify the code to correct that problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 11430512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce5ff2ad96542d83200793de73de094b?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u0434\u0435\u043d\u0442\u0438\u043a\u043e\u043d", "link": "https://stackoverflow.com/users/11430512/%d0%98%d0%b4%d0%b5%d0%bd%d1%82%d0%b8%d0%ba%d0%be%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 793, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561052502, "creation_date": 1560934430, "last_edit_date": 1560936571, "question_id": 56663732, "link": "https://stackoverflow.com/questions/56663732/how-to-transfer-data-using-rs485-to-beaglebone-black", "title": "How to transfer data using RS485 to BeagleBone Black", "body": "<p>I need to transfer data to BeagleBone Black via Modbus RTU using Rs485. To work with Modbus RTU,but I don't know how to toggle rts in rs-485.HELP</p>\n\n<p>Modbus RTU data transmission code</p>\n\n<p>how to add RS485 code to this,to use the Modbus library libmodbus</p>\n\n<pre><code>#include \"modbus-rtu.h\"\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nint main(){\nint connected;\n    modbus_t *ctx;     \n    uint16_t tab_reg[64];    \n    int rc;     \n    int i;\n    ctx = modbus_new_rtu(\"/dev/ttyS4\", 9600, 'N', 8, 1);     \n    if(ctx == NULL) {   \n        fprintf(stderr, \"Unable to create the libmodbus context\\n\");\n\n    }\n    else {\n        modbus_set_slave(ctx, 1);     \n        modbus_set_debug(ctx, TRUE);     \n        connected = modbus_connect(ctx);    \n        printf(\"modbus_set_slave return: %d\\n\", rc);\n        if (rc != 0)\n        {\n            printf(\"modbus_set_slave: %s \\n\"modbus_strerror(errno));        \n        }\n            rc = modbus_read_registers(ctx, 0, 3, tab_reg);      \n        for (i = 0; i &lt; rc; i++) {\n            printf(\"reg[%d]=%d (0x%X)\\n\", i, tab_reg[i], tab_reg[i]);\n        }\n            if(rc == -1)\n            {\n                fprintf(stderr, \"%s\\n\", modbus_strerror(errno));\n            }               \n        modbus_close(ctx);     \n        modbus_free(ctx);     \n    }\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 3, "creation_date": 1560934644, "post_id": 56663576, "comment_id": 99895978, "body": "Where does <code>vettRis</code> point to?"}, {"owner": {"reputation": 11, "user_id": 11669045, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-miAWH84TV1I/AAAAAAAAAAI/AAAAAAAAHtI/Ho3Cvsm9uBE/photo.jpg?sz=128", "display_name": "Francesco Romeo", "link": "https://stackoverflow.com/users/11669045/francesco-romeo"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1560939707, "post_id": 56663576, "comment_id": 99898905, "body": "in the case should be the copy of rigaDs (in assembly code), in C is a empty vector"}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 4, "creation_date": 1560941923, "post_id": 56663576, "comment_id": 99900002, "body": "There is a typo in the first line of your assembly. Although this is unrelated to the segfault, it <i>does</i> make me wonder if this is really the version of your code that has been running into a segfault. It couldn&#39;t even pass the assembler."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1560974934, "post_id": 56663576, "comment_id": 99917561, "body": "The question &quot;Where does vettRis point to&quot; was supposed to be a hint ... it&#39;s not pointing anywhere because it&#39;s uninitialized. As such, you should not try to dereference it until you allocate some memory and assign to it."}, {"owner": {"reputation": 11, "user_id": 11669045, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-miAWH84TV1I/AAAAAAAAAAI/AAAAAAAAHtI/Ho3Cvsm9uBE/photo.jpg?sz=128", "display_name": "Francesco Romeo", "link": "https://stackoverflow.com/users/11669045/francesco-romeo"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1561014126, "post_id": 56663576, "comment_id": 99927205, "body": "@Jester Thank you for your answer. Now it&#39;s all clear! Thank you to mch and Ruud for your answer too!"}], "owner": {"reputation": 11, "user_id": 11669045, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-miAWH84TV1I/AAAAAAAAAAI/AAAAAAAAHtI/Ho3Cvsm9uBE/photo.jpg?sz=128", "display_name": "Francesco Romeo", "link": "https://stackoverflow.com/users/11669045/francesco-romeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560935340, "creation_date": 1560933923, "last_edit_date": 1560935340, "question_id": 56663576, "link": "https://stackoverflow.com/questions/56663576/how-can-fix-the-segmentation-fault-on-assembly", "title": "How can fix the segmentation fault on assembly?", "body": "<p>I need help in assembly. I have this code on C, I need to traslate it on Assembly and the resultate must be returnet to C code like a reference. When I do it, I have a Segmentation fault. Someone can help me?</p>\n\n<p>For more information: VettRis is the Array in which I put my result and it's builted making an addition with the element of another vector in input, called rigaDs</p>\n\n<p>I've tried to make a print for the only register XMM0 and it's all ok. But when I do the mov, I have a segmentation Fault</p>\n\n<pre><code>    float rigaDs[]={13.0, 2.0,71.8, 9.0};\n    float y[]={44.0, 1.4, 2.0, -4.0};\n    int dim=4;\n    float* vettRis; \n    centroGeo(rigaDs,dim, &amp;vettRis);\n    stampaVettore(vettRis,dim);\n</code></pre>\n\n<hr>\n\n<pre><code>seciton .data\n\n    rigaDs equ 8\n    dim equ 12\n    vettRis equ 16  \n\nsection .text\n\n    push ebp\n    mov ebp, esp\n    pushad\n    mov eax, [ebp+rigaDs]   \n    mov edi, [ebp+dim] \n    mov ebx, [ebp+vettRis]\n    xor esi, esi\n\nforI:\n\n    cmp esi, edi\n    jge end\n    movups xmm0, [eax+esi*4]\n    movups [ebx+esi*4], xmm0\n    inc esi\n    jmp forI\n\nend: \n\n    popad\n    mov esp, ebp\n    pop ebp \n    ret\n</code></pre>\n\n<p>the result should be 13.0, 2.0,71.8, 9.0</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1560934072, "post_id": 56663418, "comment_id": 99895651, "body": "&quot;What I assume to be reason of error is fork.&quot; How should we know? You do not show any code containing <code>fork</code>. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MCVE</a>. My magical crystal ball tells me you might have a stray <code>;</code> after <code>if ( fork .....)</code>"}], "owner": {"reputation": 172, "user_id": 8225914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6530a5d3ef1e2c672ee36fcf302efed?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Suh", "link": "https://stackoverflow.com/users/8225914/jimmy-suh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560933438, "creation_date": 1560933438, "question_id": 56663418, "link": "https://stackoverflow.com/questions/56663418/commands-and-results-printed-twice-after-invalid-command-to-execvp", "title": "Commands and results printed twice after invalid command to execvp", "body": "<p>I'm trying to create shell-like c code. It reads from the given file by each line, breaks it down to command token, create argv, and runs execvp. However, there is one problem. Whenever I put invalid command, It prints all the below commands and it's output twice. </p>\n\n<p>For example, if it's written</p>\n\n<pre><code>catdf\necho one\necho onetwo\n</code></pre>\n\n<p>It prints out </p>\n\n<pre><code>catdf: No such file or directory\necho one\none\necho onetwo\nonetwo\necho one\none\necho onetwo\nonetwo\n</code></pre>\n\n<p>which is not what I desire. (I want each command line and output to be printed only once)</p>\n\n<p>What I assume to be reason of error is fork.</p>\n\n<p>After fork, in child, I used</p>\n\n<pre><code>execvp(argv[0], argv);\nperror(argv[0]);\nexit(EXIT_FAILURE);\n</code></pre>\n\n<p>In parent, I used</p>\n\n<pre><code>while ((iPid=wait(&amp;status))&gt;0){\n    if (status!=0)\n        break; /*for current command line*/\n}\n</code></pre>\n\n<p>This code works well for errors such as</p>\n\n<pre><code>cat nonexistingfile\n</code></pre>\n\n<p>But for</p>\n\n<pre><code>nonexistingcommand\n</code></pre>\n\n<p>it prints all the below commands and outputs twice. </p>\n\n<p>Does it have something to do with perror in this case of nonexisting-command ? It works for existing command with invalid arguments. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "char", "int", "negative-number"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1560933467, "post_id": 56663408, "comment_id": 99895320, "body": "You mean something like <code>char c = (n&lt;0)? &#39;-&#39; : &#39;+&#39;;</code>?"}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1560933622, "post_id": 56663408, "comment_id": 99895398, "body": "@Blaze That should be an answer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1560933648, "post_id": 56663408, "comment_id": 99895414, "body": "@Blaze That&#39;s identical to what the OP has, just less readable."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1560933734, "post_id": 56663408, "comment_id": 99895470, "body": "There is no way. Even Blaze&#39;s suggestion involves an <code>if</code> (involves a condition check)."}, {"owner": {"reputation": 69, "user_id": 8258166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b66f2e03959134f898a017d504bb9?s=128&d=identicon&r=PG&f=1", "display_name": "ph7", "link": "https://stackoverflow.com/users/8258166/ph7"}, "edited": false, "score": 0, "creation_date": 1560933834, "post_id": 56663408, "comment_id": 99895521, "body": "That is similar what I am doing. Actualy I am looking for answer if it is posible to do it without if statment or conditional operator."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1560933953, "post_id": 56663408, "comment_id": 99895584, "body": "@NikosC. I didn&#39;t put it as an answer because I don&#39;t know what OP is trying to accomplish. Turns out he doesn&#39;t want a ternary conditional either."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1560934262, "post_id": 56663408, "comment_id": 99895753, "body": "What should the char&#39;s value be if the integer is not negative?"}, {"owner": {"reputation": 69, "user_id": 8258166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b66f2e03959134f898a017d504bb9?s=128&d=identicon&r=PG&f=1", "display_name": "ph7", "link": "https://stackoverflow.com/users/8258166/ph7"}, "edited": false, "score": 0, "creation_date": 1560934919, "post_id": 56663408, "comment_id": 99896141, "body": "Sorry, @ Nikos C.  it should be <code>+</code>. Code updated"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1560939450, "post_id": 56663408, "comment_id": 99898756, "body": "&quot;is there a way to do it without conditionals?&quot; is not a good coding goal.  Better to code for clarity. <code>char c = n &lt; 0 ? &#39;-&#39; : &#39;+&#39;;</code> is fine.  Perhaps terse code such as <code>char c = &quot;+-&quot;[n &lt; 0];</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1560944092, "post_id": 56663408, "comment_id": 99901209, "body": "@chux <code>char c = &quot;-+&quot;[(n &gt;&gt; 31)+1];</code> Logical shift sets <code>c</code> to <code>\\0</code>. For maximum portability you&#39;d do <code>&quot;-+-&quot;</code> but this is some seriously obscure code :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560952485, "post_id": 56663408, "comment_id": 99906331, "body": "@Lundin Yes <code>&quot;-+&quot;[(n &gt;&gt; 31)+1]</code> is amiss, yet clarity vs. obscurity is not of part of OP&#39;s goal.  <code>char c = n &lt; 0 ? &#39;-&#39; : &#39;+&#39;;</code> would be clear enough, yet OP wants &quot;without conditionals&quot; - for un-posted reasons.  If one is looking for constant time emitted code, one must be careful as C does not oblige seemingly constant time source code to emit constant time machine code.  IMO, &quot;best way to get integer&#39;s negative sign and store it as char&quot; and &quot;without conditionals&quot; are contradictory goals."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560934020, "post_id": 56663561, "comment_id": 99895612, "body": "X&lt;0 doesn&#39;t necessarily give branchless code though. I would expect it to translate to &quot;branch if negative&quot; on a lot of architectures."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560934136, "post_id": 56663561, "comment_id": 99895679, "body": "@Lundin Added &quot;on x86-64&quot;. The C side at least is certainly without an <code>if</code> or a <code>?:</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560934987, "post_id": 56663561, "comment_id": 99896191, "body": "Yeah but most of the C operators with a boolean result tend to get translated to branches (in particular the <code>&amp;&amp;</code> and <code>||</code>). I posted an uglier but possibly more portable version."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 5, "last_activity_date": 1560934041, "last_edit_date": 1560934041, "creation_date": 1560933880, "answer_id": 56663561, "question_id": 56663408, "link": "https://stackoverflow.com/questions/56663408/what-is-the-best-way-to-get-integers-negative-sign-and-store-it-as-char/56663561#56663561", "title": "What is the best way to get integer&#39;s negative sign and store it as char?", "body": "<p>This creates branchless code with gcc/clang on x86-64:</p>\n\n<pre><code>void storeneg(int X, char *C)\n{\n    *C='+';\n    *C += (X&lt;0)*('-'-'+');\n}\n</code></pre>\n\n<p><a href=\"https://gcc.godbolt.org/z/yua1go\" rel=\"nofollow noreferrer\">https://gcc.godbolt.org/z/yua1go</a></p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 8258166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b66f2e03959134f898a017d504bb9?s=128&d=identicon&r=PG&f=1", "display_name": "ph7", "link": "https://stackoverflow.com/users/8258166/ph7"}, "edited": false, "score": 0, "creation_date": 1560936287, "post_id": 56663865, "comment_id": 99896908, "body": "How I understand <code>uint32_t</code> is equal respectively to <code>unsigned_int</code>. Is that right?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 69, "user_id": 8258166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b66f2e03959134f898a017d504bb9?s=128&d=identicon&r=PG&f=1", "display_name": "ph7", "link": "https://stackoverflow.com/users/8258166/ph7"}, "edited": false, "score": 1, "creation_date": 1560936421, "post_id": 56663865, "comment_id": 99896987, "body": "@ph7 The type of the local variable in the function isn&#39;t really relevant here, it could be any integer type. I just typed uint32_t out of habit, but it has no relevance to the outcome of the code. The <code>1u</code> - which is of type unsigned int, is what matters."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1560937972, "post_id": 56663865, "comment_id": 99897880, "body": "I suppose you <a href=\"https://godbolt.org/z/2XyRIi\" rel=\"nofollow noreferrer\">took a look at what the compiler does</a> and then reversed it to C code? :-)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1560938975, "post_id": 56663865, "comment_id": 99898479, "body": "&quot;it won&#39;t risk getting translated into &quot;branch if negative&quot; instructions when ported.&quot; --&gt; Instead the conversion of an <code>unsigned</code> to a <code>bool</code>risks getting translated into a &quot;branch if (non) zero&quot; when ported."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1560942194, "post_id": 56663865, "comment_id": 99900132, "body": "@chux I considered that, but since optimizations are already done at the point of conversion, I don&#39;t think it is necessary. One can probably reduce the risk by right shifting instead though, will update the answer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1560943079, "post_id": 56663865, "comment_id": 99900615, "body": "<code>(unsigned int)n &gt;&gt; sign_bit_n</code> is better - had no modern porting concerns.  It does negate the need for narrowing done by <code>(_Bool)</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1560943652, "post_id": 56663865, "comment_id": 99900952, "body": "@chux Yeah at least I hope so, if the compiler realizes it can just copy the LS byte. When I tried both versions they resulted in the same machine code on x86, ARM and PowerPC though."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 5, "last_activity_date": 1560942369, "last_edit_date": 1560942369, "creation_date": 1560934892, "answer_id": 56663865, "question_id": 56663408, "link": "https://stackoverflow.com/questions/56663408/what-is-the-best-way-to-get-integers-negative-sign-and-store-it-as-char/56663865#56663865", "title": "What is the best way to get integer&#39;s negative sign and store it as char?", "body": "<p>There's the most efficient and portable way, but it doesn't win any beauty awards.</p>\n\n<p>We can assume that the MSB of a signed integer is always set if it is negative. This is a 100% portable assumption even when taking exotic signedness formats in account (one's complement, signed magnitude). Therefore the fastest way is to simply mask out the MSB from the integer.</p>\n\n<p>The MSB of any integer is found at location <code>CHAR_BIT * sizeof(n) - 1;</code>. On a typical 32 bit mainstream system, this would for example be <code>8 * 4 - 1</code> = 31.</p>\n\n<p>So we can write a function like this:</p>\n\n<pre><code>_Bool is_signed (int n)\n{\n  const unsigned int sign_bit_n = CHAR_BIT * sizeof(n) - 1;\n  return (_Bool) ((unsigned int)n &gt;&gt; sign_bit_n);\n}\n</code></pre>\n\n<p>On x86-64 gcc 9.1 (-O3), this results in very efficient code:</p>\n\n<pre><code>is_signed:\n        mov     eax, edi\n        shr     eax, 31\n        ret\n</code></pre>\n\n<p>The advantage of this method is also that, unlike code such as <code>x &lt; 0</code>, it won't risk getting translated into \"branch if negative\" instructions when ported. </p>\n\n<p>Complete example:</p>\n\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\n_Bool is_signed (int n)\n{\n  const unsigned int sign_bit_n = CHAR_BIT * sizeof(n) - 1;\n  return (_Bool) ((unsigned int)n &gt;&gt; sign_bit_n);\n}\n\nint main (void)\n{\n  int n = -1;\n\n  const char SIGNS[] = {' ', '-'};\n  char sign = SIGNS[is_signed(n)];\n  putchar(sign);\n}\n</code></pre>\n\n<p>Disassembly (x86-64 gcc 9.1 (-O3)):</p>\n\n<pre><code>is_signed:\n        mov     eax, edi\n        shr     eax, 31\n        ret\nmain:\n        sub     rsp, 8\n        mov     rsi, QWORD PTR stdout[rip]\n        mov     edi, 45\n        call    _IO_putc\n        xor     eax, eax\n        add     rsp, 8\n        ret\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 8258166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b66f2e03959134f898a017d504bb9?s=128&d=identicon&r=PG&f=1", "display_name": "ph7", "link": "https://stackoverflow.com/users/8258166/ph7"}, "edited": false, "score": 0, "creation_date": 1560938694, "post_id": 56664703, "comment_id": 99898339, "body": "I am using C and that trows me error <code>fatal error: cmath: No such file or directory #include &lt;cmath&gt;</code>"}, {"owner": {"reputation": 2895, "user_id": 2210478, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ccacd15a0f9c5580ae5c1af8fdad66e?s=128&d=identicon&r=PG", "display_name": "Chen OT", "link": "https://stackoverflow.com/users/2210478/chen-ot"}, "reply_to_user": {"reputation": 69, "user_id": 8258166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b66f2e03959134f898a017d504bb9?s=128&d=identicon&r=PG&f=1", "display_name": "ph7", "link": "https://stackoverflow.com/users/8258166/ph7"}, "edited": false, "score": 0, "creation_date": 1560938770, "post_id": 56664703, "comment_id": 99898371, "body": "maybe in C, you need math.h, <a href=\"https://en.cppreference.com/w/c/numeric/math/signbit\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/numeric/math/signbit</a>  But by document c&#39;s signbit only promise nonzero value instead of true or 1"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560942859, "post_id": 56664703, "comment_id": 99900492, "body": "Is <code>signbit</code> guaranteed to work for integers in C? Nothing in the standard seems to guarantee this, it just says that it is a macro of the pseudo-code form <code>int signbit(real-floating x);</code>. C++ is another story, because it uses overloaded functions instead of a macro, but this is tagged C."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560943127, "post_id": 56664703, "comment_id": 99900641, "body": "Looking at C libs implementation of <code>signbit</code>, it seems to always enforce a promotion to floating point. Newer versions of gcc refuse to even compile it. So... this is not a good idea."}], "tags": [], "owner": {"reputation": 2895, "user_id": 2210478, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ccacd15a0f9c5580ae5c1af8fdad66e?s=128&d=identicon&r=PG", "display_name": "Chen OT", "link": "https://stackoverflow.com/users/2210478/chen-ot"}, "is_accepted": false, "score": 1, "last_activity_date": 1560938835, "last_edit_date": 1560938835, "creation_date": 1560937391, "answer_id": 56664703, "question_id": 56663408, "link": "https://stackoverflow.com/questions/56663408/what-is-the-best-way-to-get-integers-negative-sign-and-store-it-as-char/56664703#56664703", "title": "What is the best way to get integer&#39;s negative sign and store it as char?", "body": "<pre><code>char c = 43 + signbit(n) * 2 ;\n</code></pre>\n\n<ul>\n<li><code>char 43</code> is <code>'+'</code></li>\n<li><code>char 45</code> is <code>'-'</code></li>\n<li>signbit(NEGATIVE INTEGER) is <code>true</code>, converted to <code>1</code></li>\n</ul>\n\n<p><code>int signbit(int)</code> is included in <a href=\"https://en.cppreference.com/w/cpp/numeric/math/signbit\" rel=\"nofollow noreferrer\"><code>cmath</code> in C++</a> and <a href=\"https://en.cppreference.com/w/c/numeric/math/signbit\" rel=\"nofollow noreferrer\"><code>math.h</code> in C</a></p>\n"}], "owner": {"reputation": 69, "user_id": 8258166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459b66f2e03959134f898a017d504bb9?s=128&d=identicon&r=PG&f=1", "display_name": "ph7", "link": "https://stackoverflow.com/users/8258166/ph7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56663865, "answer_count": 3, "score": 2, "last_activity_date": 1560942369, "creation_date": 1560933386, "last_edit_date": 1560934937, "question_id": 56663408, "link": "https://stackoverflow.com/questions/56663408/what-is-the-best-way-to-get-integers-negative-sign-and-store-it-as-char", "title": "What is the best way to get integer&#39;s negative sign and store it as char?", "body": "<p>How to get an integer's sign and store it in a char? One way is:</p>\n\n<pre><code>int n = -5\nchar c;\nif(n&lt;0)\n    c = '-';\nelse\n    c = '+';\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>char c = n &lt; 0 ? '-' : '+';\n</code></pre>\n\n<p>But is there a way to do it without conditionals?</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "thread-priority"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1560956663, "post_id": 56663366, "comment_id": 99908990, "body": "Why are you refusing to use a hammer to drive your nail?"}], "answers": [{"tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": false, "score": 0, "last_activity_date": 1561001683, "creation_date": 1561001683, "answer_id": 56678606, "question_id": 56663366, "link": "https://stackoverflow.com/questions/56663366/pthreads-stack-priority/56678606#56678606", "title": "Pthreads stack priority", "body": "<p>You are calling <code>pthread_join()</code> in the main thread immediately after creating each child thread.</p>\n\n<p>This means that you never have more than one child thread created at a time - after creating one child thread, the main thread will then block in <code>pthread_join()</code> until that child thread is complete.  Only <em>then</em> does it call <code>scanf()</code> again and potentially create another child thread.</p>\n\n<p>Thread priorities don't come into it.</p>\n"}], "owner": {"reputation": 1, "user_id": 9923527, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fYsmNo4_qjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1iIy7erMuA-S_-7tgEpPeO_F-6LQ/mo/photo.jpg?sz=128", "display_name": "Martin Vadura", "link": "https://stackoverflow.com/users/9923527/martin-vadura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1561001683, "creation_date": 1560933240, "question_id": 56663366, "link": "https://stackoverflow.com/questions/56663366/pthreads-stack-priority", "title": "Pthreads stack priority", "body": "<p>i have little trouble with pthread priority.I have set scheduler FIFO. I have 2 thread, each have diffretnt priority. On my project when i push A or B, one thread start working. Thats fine, but when one thread working and push again B(priority15) and then A(priority 20) my assumption is that thread A jumps before B in stack queue and after first thread will by next thread A with priority 20 and then thread B (15). Is that problem FIFO or something else? \nPS: I dont want use semaphore, i want to solve it just with priority and scheduler. Thanks</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;pthread.h&gt;\n#include&lt;semaphore.h&gt;\n#include&lt;unistd.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sched.h&gt;\n\nsem_t mutex;\n\nvoid* levelOnefunction(void *a)\n{\n    sem_wait(&amp;mutex);\n    int* b = (int *) a;\n    printf(\"Thread! next main!\\n\");\n    printf(\"sched prior:%d\\n\",*b);\n    sleep(3);\n    sem_post(&amp;mutex);\n    return 0;\n}\n\nint main()\n{\n    char s;\n    pthread_t t;\n    pthread_attr_t tattr;\n    struct sched_param param;\n\n    sem_init(&amp;mutex,0,1);\n    pthread_attr_init(&amp;tattr);\n\n    if(pthread_attr_setschedpolicy(&amp;tattr,SCHED_FIFO)!=0)\n        printf(\"ERROR FIFO!\\n\");\n    //pthread_setschedparam(t,SCHED_FIFO,&amp;param);\n\n    if(pthread_attr_getschedparam(&amp;tattr,&amp;param)!=0)\n        printf(\"ERROR attr get sheduler!\\n\");\n\n    /* int k =pthread_attr_setinheritsched(&amp;tattr,PTHREAD_EXPLICIT_SCHED);\n\n    if (k!=0)\n        printf(\"ERROR\\n\"); */\n\n    printf(\"Initial priority is %d \\n\",param.sched_priority);\n\n    int min = sched_get_priority_min(SCHED_FIFO);\n    int max = sched_get_priority_max(SCHED_FIFO);\n\n    printf(\"MIN - %d ---&gt; MAX - %d\\n\",min,max);\n\n    scanf(\"%c\",&amp;s);\n\n    while (s != '\\0') \n    {\n        if(s=='a')\n        {\n            printf(\"a\\n\");\n            param.sched_priority=20;\n            if(pthread_attr_setschedparam(&amp;tattr,&amp;param)!=0)\n            printf(\"ERROR attr_setschedul!\\n\");\n            printf(\"update priority is:%d\\n\",param.sched_priority);\n            if(pthread_create(&amp;t,&amp;tattr,levelOnefunction,(void *)&amp;param.sched_priority)!=0)\n                printf(\"ERROR thread1\\n\");\n\n            pthread_join(t,NULL);\n            printf(\"main finish!\\n\");\n            printf(\"%c end\\n\\n\",s);\n        }\n        else if(s=='b')\n        {\n            printf(\"b\\n\");\n            param.sched_priority=15;\n            if(pthread_attr_setschedparam(&amp;tattr,&amp;param)!=0)\n            printf(\"ERROR attr_setschedul!\\n\");\n            if(pthread_create(&amp;t,&amp;tattr,levelOnefunction,(void *)&amp;param.sched_priority)!=0)\n            printf(\"ERROR Thread 2 \");\n\n            pthread_join(t,NULL);\n            printf(\"main finish!\\n\");\n            printf(\"%c end\\n\\n\",s);\n        }\n        else if(s=='\\n')\n        {\n        }\n        else if (s!='a' &amp;&amp; s!='b')\n        {\n            printf(\"bad key\\n\");\n        }\n        scanf(\"%c\",&amp;s);\n    }             \n    sem_destroy(&amp;mutex);     \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "csv", "strtok"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1560933303, "post_id": 56663274, "comment_id": 99895228, "body": "One usually loops until <a href=\"https://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow noreferrer\"><code>strtok</code></a> returns a <code>NULL</code> pointer. But be aware of the shortcomings of <a href=\"https://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow noreferrer\"><code>strtok</code></a>, like how it can&#39;t handle consecutive separators the way you want in a CSV file. There are also many other problems and non-trivial special- and corner-cases that makes CSV files much harder to parse than it seems. Therefore I always recommend that you find a library that will do it for you."}, {"owner": {"reputation": 25, "user_id": 10243285, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217434920249343/picture?type=large", "display_name": "Ross Hanna", "link": "https://stackoverflow.com/users/10243285/ross-hanna"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1560934302, "post_id": 56663274, "comment_id": 99895778, "body": "I&#39;ll look into the loop aspect. I have seen that strtok can be awkward with data that is not just simple numbers in columns. If i was doing this for a purpose other than teaching myself C, then i think your right, why do development someone else has spent weeks on, However, anything i find that is a problem to solve can only help me learn!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10243285, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217434920249343/picture?type=large", "display_name": "Ross Hanna", "link": "https://stackoverflow.com/users/10243285/ross-hanna"}, "edited": false, "score": 0, "creation_date": 1561041413, "post_id": 56672958, "comment_id": 99942216, "body": "Forgive me if i have missed something, as my C knowledge is lacking, but i can&#39;t see where the values for what rows and columns are desired is entered or impemented. I am going to be implementing this principle on files that can have 1000-100,000 rows and over 360 columns. because of this i was looking into how i could choose for example ONLY the 5th and sixth column to reduce read time, perform my calculations and clear those values before moving onto the next section of calculations. is this possible? thanks for answering though"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 25, "user_id": 10243285, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217434920249343/picture?type=large", "display_name": "Ross Hanna", "link": "https://stackoverflow.com/users/10243285/ross-hanna"}, "edited": false, "score": 0, "creation_date": 1561053611, "post_id": 56672958, "comment_id": 99948488, "body": "@RossHanna You still have to read the whole lines, which of course means reading the whole file. Of course you can read a small part of a line, see if the wanted column is in that line, and if not read a little more, but this very quickly become very complicated and not at all trivial. The thing is, there&#39;s no guarantee that all elements in a record (row) are of the same size, have the same number of characters. Which of course also means that no two lines will be of the same size. You can&#39;t just find the position in the first line and assume it&#39;s the same for every line."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1560964878, "creation_date": 1560964878, "answer_id": 56672958, "question_id": 56663274, "link": "https://stackoverflow.com/questions/56663274/how-to-assign-subsequent-columns-in-csv-to-array-using-strtok-in-c/56672958#56672958", "title": "How to assign subsequent columns in csv to array using strtok in C", "body": "<p>For something simple where I know the input file will be well-formed and without \"empty\" values, then I might be doing something like this:</p>\n\n<pre><code>float values[rows][columns] = { 0 };  // Initialize all to zero\n\nchar line[512];  // Hopefully large enough\n\nunsigned r;  // Row index\n\n// Loop to get all rows, taking care to not go out of bounds\nfor (r = 0; r &lt; rows &amp;&amp; fgets(line, sizeof line, fp) != NULL; ++r)\n{\n    unsigned c = 0;  // Column index\n\n    // Get the first column value\n    char *current = strtok(line, \",\");\n\n    // Loop to get all columns\n    while (c &lt; columns &amp;&amp; current != NULL)\n    {\n        values[r][c] = atof(current);\n\n        ++c;  // Increase to next column\n        current = strtok(NULL, \",\");  // Get next (if any) column value\n    }\n}\n\n// Here the whole file will have been read and parsed, and the values\n// from the file will be in the array `values`.\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10243285, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217434920249343/picture?type=large", "display_name": "Ross Hanna", "link": "https://stackoverflow.com/users/10243285/ross-hanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560964878, "creation_date": 1560932998, "question_id": 56663274, "link": "https://stackoverflow.com/questions/56663274/how-to-assign-subsequent-columns-in-csv-to-array-using-strtok-in-c", "title": "How to assign subsequent columns in csv to array using strtok in C", "body": "<p>I am trying to write a simple program that will allow the user to extract data from a csv file after specifying what rows and columns they would like to extract. The program accepts inputs for the start row (can be any number, not necessarily 1) and the final row desired. The same principle applies for the columns. The output is then assigned to a multidimensional array that will later be passed to functions for calculations. </p>\n\n<p>I am having issues with using strtok to extract a column that is not the first as from my understanding, strtok has to read a file sequentially?</p>\n\n<p>i have been using this project to teach myself C, so have had many iterations of this principle to develop my knowledge. I have successfully read csv files, so i understand the basic principles of strtok in csv files.</p>\n\n<p>If i was using the first column to read from, then i can just use strtok as i have been;</p>\n\n<pre><code>var[i][0] = atof(strtok(buf, \",\"));\nvar[i][j] = atof(strtok(NULL, \",\"));\n</code></pre>\n\n<p>however to read from column 2 onwards, the above code still has to be used as strtok is sequential, but not assign column 0 to the variable. The only rough method i have working is to introduce a temporary variable, place all columns into that, and extract the columns specified by the use, but this is undesirable.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdint.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid CSV_Col_read(int r, int c, int start_row, int start_col, float var[r][c])\n{\n\nchar buf[1024];\nfloat temp[r][c];\n\n  FILE *fp = fopen(\"PV_Data.csv\", \"r\");\n\n  if(!fp)\n  {\n    printf(\"Could Not Open File\\n\");\n  }\n  int i = 0;\n  int index_row = 0;\n\n  while(fgets(buf, sizeof buf, fp))\n  {  \n      index_row++;\n      if (index_row &gt;= start_row){\n      if(i &gt;= r - start_row + 1){\n          break;\n      }\n\n      if (c == 1){\n      var[i][0] = atof(strtok(buf, \",\"));\n  }\n      else if(start_col &gt;= 2){\n          temp[i][0] = atof(strtok(buf, \",\"));\n\n      for (int j = 1; j &lt;= c-1; j++)\n      {       \n      temp[i][j] = atof(strtok(NULL, \",\"));\n      }\n\n      for (int I = -1; I &lt;= 2; I++){\n\n      var[i][I+1] = temp[i][start_col + I];\n      }\n      }\n      else{\n\n              var[i][0] = atof(strtok(buf, \",\"));\n\n      for (int j = 1; j &lt;= c-1; j++)\n      {       \n      var[i][j] = atof(strtok(NULL, \",\"));\n      }\n  }\n  i++;\n}\n  }\n        fclose(fp);\n}\n\nvoid printData(int r, int c, int start_row, int start_col, float var[r][c])\n{\nif ( c == 1){\nfor (int i = 1; i &lt;= (r - start_row); i++)\n    {\n    printf(\"%f\\n\", var[i][0]);\n    }\n}\nelse{\n    for(int i = 0; i &lt;= (r - start_row); i++)\n    {\n        printf(\"%f\", var[i][0]);\n\n\n        for(int j = 1; j &lt;= (c - start_col); j++)\n        {\n            printf(\"\\t\");\n            printf(\"%f\", var[i][j]);   \n    }\n    printf(\"\\n\");\n    }\n}\n}\nint main()\n{\n    int start_row = 705;\n    int start_col = 3;\n    int r = 720;\n    int c = 5;\n    float var[r][c];\n\n    (void) CSV_Col_read(r, c, start_row, start_col, var);\n\n    printData(r, c, start_row, start_col, var);\n}\n</code></pre>\n\n<p>the code above is not \"insert correct programming word for idiot proof\" however as i know i have only specfied the elseif() statement for one scenario. Is this method of a temporary variable the way to go or is there a much cleaner way to approach this? I am not asking for code to fix this and am perfectly happy with an answer that directs me to a learning resource.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1560934361, "post_id": 56663243, "comment_id": 99895819, "body": "Please describe the data structure you want to send more clearly - <b>with code</b> (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). It&#39;s best if you add what you have tried and where exactly you are stuck."}, {"owner": {"reputation": 41, "user_id": 7128936, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NQg20yuN0oY/AAAAAAAAAAI/AAAAAAAAAB0/t9-dCmBTiR0/photo.jpg?sz=128", "display_name": "user7128936", "link": "https://stackoverflow.com/users/7128936/user7128936"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1560935160, "post_id": 56663243, "comment_id": 99896293, "body": "I had changed this. Thanks for your remind."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1560935235, "post_id": 56663243, "comment_id": 99896337, "body": "First concentrate on ex. how to save and load it to a file. You have to loose pointers. Basically you have to write a way to serialize and deserialize your data."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1560936332, "post_id": 56663243, "comment_id": 99896945, "body": "How often do you need to transmit such 2000-leaves trees?"}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1560937142, "last_edit_date": 1560937142, "creation_date": 1560935516, "answer_id": 56664055, "question_id": 56663243, "link": "https://stackoverflow.com/questions/56663243/how-to-send-and-receive-a-binary-tree-using-mpi/56664055#56664055", "title": "How to send and receive a binary tree using MPI?", "body": "<p>Read more about <a href=\"https://en.wikipedia.org/wiki/Serialization\" rel=\"nofollow noreferrer\">serialization</a>. A 2000 nodes tree is, on current machines and networks, quite a small piece of data. If the average name length is a dozen of bytes, you need to transmit a few dozens of kilobytes (not a big deal today). Typical datacenter network bandwidth is 100Mbytes/sec, and <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">inter-process communication</a> (using e.g. some <a href=\"http://man7.org/linux/man-pages/man7/pipe.7.html\" rel=\"nofollow noreferrer\">pipe(7)</a> or <a href=\"http://man7.org/linux/man-pages/man7/unix.7.html\" rel=\"nofollow noreferrer\">unix(7)</a> <a href=\"https://en.wikipedia.org/wiki/Berkeley_sockets\" rel=\"nofollow noreferrer\">sockets</a> between cores of the same processor) is usually at least ten times faster. See also <a href=\"http://norvig.com/21-days.html\" rel=\"nofollow noreferrer\">http://norvig.com/21-days.html</a></p>\n\n<blockquote>\n  <p>Or do there have any fast algorithm to make this function?</p>\n</blockquote>\n\n<p>You probably need some <a href=\"https://en.wikipedia.org/wiki/Depth-first_search\" rel=\"nofollow noreferrer\">depth-first</a> traversal (and there is probably nothing faster).</p>\n\n<p>You might consider writing your tree in some textual format -or some <a href=\"https://en.wikipedia.org/wiki/Text-based_protocol\" rel=\"nofollow noreferrer\">text-based protocol</a>- such as (some customized variant using) <a href=\"https://json.org/\" rel=\"nofollow noreferrer\">JSON</a> (or XML or YAML or <a href=\"https://en.wikipedia.org/wiki/S-expression\" rel=\"nofollow noreferrer\">S-expressions</a>). Then take advantage of existing JSON libraries, such as <a href=\"https://jansson.readthedocs.io/en/\" rel=\"nofollow noreferrer\">Jansson</a>. They are capable of encoding and decoding your data (in some JSON format) in a dynamically allocated string buffer.</p>\n\n<p>If performance is critical, consider using some binary format, like <a href=\"https://en.wikipedia.org/wiki/External_Data_Representation\" rel=\"nofollow noreferrer\">XDR</a> or <a href=\"https://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One\" rel=\"nofollow noreferrer\">ASN-1</a>. Or simply compress the JSON (or other textual) encoding, using some existing compression library (perhaps <a href=\"https://zlib.net/\" rel=\"nofollow noreferrer\">zlib</a>).</p>\n\n<p>My guess is that in your case, it is not worth the trouble (using JSON is a lot simpler to code, and your development time has some cost and value). Your bottleneck is probably the network itself, not any software layers. But you need to benchmark.</p>\n"}, {"tags": [], "owner": {"reputation": 8043, "user_id": 491687, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2174f845b769ea2ad2242047f3118128?s=128&d=identicon&r=PG", "display_name": "Wesley Bland", "link": "https://stackoverflow.com/users/491687/wesley-bland"}, "is_accepted": false, "score": 0, "last_activity_date": 1561128190, "creation_date": 1561128190, "answer_id": 56705632, "question_id": 56663243, "link": "https://stackoverflow.com/questions/56663243/how-to-send-and-receive-a-binary-tree-using-mpi/56705632#56705632", "title": "How to send and receive a binary tree using MPI?", "body": "<p>MPI has a feature called datatypes. A full explanation would take a <em>really</em> long time, but you probably want to look at structs in there (though you might be able to get away with vectors depending on how your memory is laid out).</p>\n\n<p>However, you probably can't just use MPI datatypes because you'd just be transmitting a bunch of pointers which won't mean anything to the process on the other end. Instead you have to decide which parts you actually need to send and serialize them in a way that makes sense.</p>\n\n<p>So you have a few options I think.</p>\n\n<ol>\n<li><p>Change the way your tree is laid out in memory so it's an array of contiguous memory where all of the pointers you have above become indices in the array.</p>\n\n<ul>\n<li>This might not actually make sense in the context of your application, but it makes the \"tree\" very easy to transmit. At that point, you can either just send a large array of bytes or you can construct MPI datatypes to describe each cell in the array and send an array of 2000 of those.</li>\n</ul></li>\n<li><p>Re-create the tree on the other process from the source data (whether that's a file or something else).</p>\n\n<ul>\n<li>This is probably not the answer you were looking for and doesn't help if you've generated this data from anything non-trivial in the middle of your application.</li>\n</ul></li>\n<li><p>Use POSIX shared memory.</p>\n\n<ul>\n<li>Since you say \"core\" in the description of your question, I'm assuming you want to transfer data between OS processes on the same physical machine. If that's the case, you can use shared memory and you don't need to do message passing at all. Just open a shared memory region, attach to it with the other process and \"poof\" all of the data is available on the other end. As long as you share all of the memory that those pointers are pointing to, I think you'll be fine.</li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 41, "user_id": 7128936, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NQg20yuN0oY/AAAAAAAAAAI/AAAAAAAAAB0/t9-dCmBTiR0/photo.jpg?sz=128", "display_name": "user7128936", "link": "https://stackoverflow.com/users/7128936/user7128936"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561128190, "creation_date": 1560932877, "last_edit_date": 1560935053, "question_id": 56663243, "link": "https://stackoverflow.com/questions/56663243/how-to-send-and-receive-a-binary-tree-using-mpi", "title": "How to send and receive a binary tree using MPI?", "body": "<p>I want to send a binary tree from one core to another use some function\nlike MPI_Send(). Or do there have any fast algorithm to make this function?</p>\n\n<p>The data structure I use is</p>\n\n<pre><code>typedef struct BiNode{\n    struct BiNode *lchi,*rchi;\n    struct BiNode *parent;\n    char *name;\n}BiNode;\n</code></pre>\n\n<p>This binary tree have more than 2000 leaves.</p>\n"}, {"tags": ["c", "node.js"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1560932807, "post_id": 56663193, "comment_id": 99894973, "body": "<a href=\"https://en.wikipedia.org/wiki/Common_Gateway_Interface\" rel=\"nofollow noreferrer\">CGI</a> is maybe what you want"}], "answers": [{"comments": [{"owner": {"reputation": 1607, "user_id": 9907206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZMwXb.png?s=128&g=1", "display_name": "Pavan Skipo", "link": "https://stackoverflow.com/users/9907206/pavan-skipo"}, "edited": false, "score": 0, "creation_date": 1560933248, "post_id": 56663314, "comment_id": 99895191, "body": "for solution number 2, any package that u recommend?"}, {"owner": {"reputation": 41428, "user_id": 440564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e3dbcb5159c02d59f52159faa8437c97?s=128&d=identicon&r=PG", "display_name": "blue112", "link": "https://stackoverflow.com/users/440564/blue112"}, "reply_to_user": {"reputation": 1607, "user_id": 9907206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZMwXb.png?s=128&g=1", "display_name": "Pavan Skipo", "link": "https://stackoverflow.com/users/9907206/pavan-skipo"}, "edited": false, "score": 0, "creation_date": 1560933477, "post_id": 56663314, "comment_id": 99895326, "body": "<a href=\"https://stackoverflow.com/questions/20643470/execute-a-command-line-binary-with-node-js\" title=\"execute a command line binary with node js\">stackoverflow.com/questions/20643470/&hellip;</a>"}], "tags": [], "owner": {"reputation": 41428, "user_id": 440564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e3dbcb5159c02d59f52159faa8437c97?s=128&d=identicon&r=PG", "display_name": "blue112", "link": "https://stackoverflow.com/users/440564/blue112"}, "is_accepted": true, "score": 2, "last_activity_date": 1560933136, "creation_date": 1560933136, "answer_id": 56663314, "question_id": 56663193, "link": "https://stackoverflow.com/questions/56663193/node-js-and-c-communication/56663314#56663314", "title": "Node js and C communication", "body": "<p>There's a whole lot of a way to handle that.</p>\n\n<p>For instance :</p>\n\n<ul>\n<li>Start the C program as a server, and listen to JSON/binary/XML/whatever message from your nodejs app. You can even use HTTP if you wish, or listen to a Unix Socket.</li>\n<li>Start the program directly from the nodejs app, pass the arguments as parameters to the C program or using stdin.</li>\n<li>Write the parameters in some file, and pass the file path to the C program, or make the C program watch the directory and do the stuff you want it to do.</li>\n</ul>\n\n<p>There's no better way than another, it just depends on what you need, how many initialization stuff the C programs need to do, if it runs on the same machine...</p>\n"}], "owner": {"reputation": 1607, "user_id": 9907206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZMwXb.png?s=128&g=1", "display_name": "Pavan Skipo", "link": "https://stackoverflow.com/users/9907206/pavan-skipo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "closed_date": 1560933306, "accepted_answer_id": 56663314, "answer_count": 1, "score": -3, "last_activity_date": 1560933569, "creation_date": 1560932686, "last_edit_date": 1560933569, "question_id": 56663193, "link": "https://stackoverflow.com/questions/56663193/node-js-and-c-communication", "closed_reason": "Needs more focus", "title": "Node js and C communication", "body": "<p>I have a web application written in nodejs which needs to communicate with C binary to fetch and set some details, any idea on how to approach this?</p>\n\n<p>Edit: Because the question is too broad i will give an example</p>\n\n<p>consider this c program -> test.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(b){\n  int a = 5; \n  return a+b;\n}\n</code></pre>\n\n<p>now i want to execute this test.c from Nodejs and pass in the vaule of <strong>b</strong>(say b=5) and retrieve the final result as 10 </p>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 3, "creation_date": 1560931390, "post_id": 56662809, "comment_id": 99894293, "body": "<code>%s</code> is right, but <code>*pitchtomidi[0][4]</code> should be <code>pitchtomidi[0][4]</code> without the <code>*</code>"}, {"owner": {"reputation": 401, "user_id": 2168665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c4fbb66250f6a7df8d2513b8cf51c55?s=128&d=identicon&r=PG", "display_name": "Nakul Tiruviluamala", "link": "https://stackoverflow.com/users/2168665/nakul-tiruviluamala"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1560931626, "post_id": 56662809, "comment_id": 99894417, "body": "Thank you! That&#39;s the answer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1560931920, "post_id": 56662809, "comment_id": 99894550, "body": "Unrelated to the question, you should change the declaration to <code>const char *pitchtomidi[104][8]</code>."}, {"owner": {"reputation": 401, "user_id": 2168665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c4fbb66250f6a7df8d2513b8cf51c55?s=128&d=identicon&r=PG", "display_name": "Nakul Tiruviluamala", "link": "https://stackoverflow.com/users/2168665/nakul-tiruviluamala"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560932081, "post_id": 56662809, "comment_id": 99894627, "body": "@Lundin thanks, I made the change. I presume it&#39;s to be safe in case I unintentionally override the values when they are meant to remain the same."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1560932327, "post_id": 56662809, "comment_id": 99894760, "body": "@NakulTiruviluamala It needs to be <code>const</code> since you <i>can&#39;t</i> change the values, they are all read-only string literals."}], "answers": [{"tags": [], "owner": {"reputation": 401, "user_id": 2168665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c4fbb66250f6a7df8d2513b8cf51c55?s=128&d=identicon&r=PG", "display_name": "Nakul Tiruviluamala", "link": "https://stackoverflow.com/users/2168665/nakul-tiruviluamala"}, "is_accepted": false, "score": 1, "last_activity_date": 1560932272, "last_edit_date": 1560932272, "creation_date": 1560931759, "answer_id": 56662936, "question_id": 56662809, "link": "https://stackoverflow.com/questions/56662809/accessing-element-of-a-multidimensional-array-of-strings-in-c/56662936#56662936", "title": "Accessing element of a multidimensional array of strings in C", "body": "<p>As Blaze pointed out, <code>%s</code> is right, but <code>*pitchtomidi[0][4]</code> should be <code>pitchtomidi[0][4]</code> without the <code>*</code></p>\n"}], "owner": {"reputation": 401, "user_id": 2168665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c4fbb66250f6a7df8d2513b8cf51c55?s=128&d=identicon&r=PG", "display_name": "Nakul Tiruviluamala", "link": "https://stackoverflow.com/users/2168665/nakul-tiruviluamala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560932272, "creation_date": 1560931302, "question_id": 56662809, "link": "https://stackoverflow.com/questions/56662809/accessing-element-of-a-multidimensional-array-of-strings-in-c", "title": "Accessing element of a multidimensional array of strings in C", "body": "<p>I have this multidimensional array of strings in C and I want to access a specific value without doing a loop. Is it possible?</p>\n\n<p>I've tried accessing the strings in the array using \nprintf(\"Test %c\", *pitchtomidi[0][4]) but I'm always only given the first character of the string and not the whole string. I've tried replacing %c with %s but I get this error: </p>\n\n<pre><code>\"warning: format specifies type 'char ' but the argument has type 'char' [-Wformat]\"\n</code></pre>\n\n<p>Here's the array:</p>\n\n<pre><code>char *pitchtomidi[104][8] = {\n     {\"24\", \"32.7\", \"B#0\", \"ty0\", \"C1\", \"do1\", \"Dbb1\", \"ru1\"},\n     {\"25\", \"34.64444318554896\", \"C#1\", \"di1\", \"0\", \"0\", \"Db1\", \"ra1\"},\n     {\"26\", \"36.7045089797165\", \"Cx1\", \"dy1\", \"D1\", \"re1\", \"Ebb1\", \"mu1\"},\n     {\"27\", \"38.887072660588984\", \"D#1\", \"ri1\", \"0\", \"0\", \"Eb1\", \"me1\"},\n     {\"28\", \"41.19941833156236\", \"Dx1\", \"ry1\", \"E1\", \"mi1\", \"Fb1\", \"fu1\"},\n     {\"29\", \"43.64926323136014\", \"E#1\", \"my1\", \"F1\", \"fa1\", \"Gbb1\", \"su1\"},\n     {\"30\", \"46.24478348960022\", \"F#1\", \"fi1\", \"0\", \"0\", \"Gb1\", \"se1\"},\n     {\"31\", \"48.994641413867505\", \"Fx1\", \"fy1\", \"G1\", \"so1\", \"Abb1\", \"lu1\"},\n     {\"32\", \"51.90801439936015\", \"G#1\", \"si1\", \"0\", \"0\", \"Ab1\", \"le1\"},\n     {\"33\", \"54.99462555759296\", \"Gx1\", \"sy1\", \"A1\", \"la1\", \"Bbb1\", \"tu1\"},\n     {\"34\", \"58.264776166378226\", \"A#1\", \"li1\", \"0\", \"0\", \"Bb1\", \"te1\"},\n     {\"35\", \"61.7293800493828\", \"Ax1\", \"ly1\", \"B1\", \"ti1\", \"Cb2\", \"du2\"},\n     {\"36\", \"65.40000000000005\", \"B#1\", \"ty1\", \"C2\", \"do2\", \"Dbb2\", \"ru2\"},\n     {\"37\", \"69.28888637109796\", \"C#2\", \"di2\", \"0\", \"0\", \"Db2\", \"ra2\"},\n     {\"38\", \"73.40901795943304\", \"Cx2\", \"dy2\", \"D2\", \"re2\", \"Ebb2\", \"mu2\"},\n     {\"39\", \"77.77414532117801\", \"D#2\", \"ri2\", \"0\", \"0\", \"Eb2\", \"me2\"},\n     {\"40\", \"82.39883666312477\", \"Dx2\", \"ry2\", \"E2\", \"mi2\", \"Fb2\", \"fu2\"},\n     {\"41\", \"87.29852646272032\", \"E#2\", \"my2\", \"F2\", \"fa2\", \"Gbb2\", \"su2\"},\n     {\"42\", \"92.48956697920049\", \"F#2\", \"fi2\", \"0\", \"0\", \"Gb2\", \"se2\"},\n     {\"43\", \"97.98928282773505\", \"Fx2\", \"fy2\", \"G2\", \"so2\", \"Abb2\", \"lu2\"},\n     {\"44\", \"103.81602879872034\", \"G#2\", \"si2\", \"0\", \"0\", \"Ab2\", \"le2\"},\n     {\"45\", \"109.98925111518597\", \"Gx2\", \"sy2\", \"A2\", \"la2\", \"Bbb2\", \"tu2\"},\n     {\"46\", \"116.5295523327565\", \"A#2\", \"li2\", \"0\", \"0\", \"Bb2\", \"te2\"},\n     {\"47\", \"123.45876009876564\", \"Ax2\", \"ly2\", \"B2\", \"ti2\", \"Cb3\", \"du3\"},\n     {\"48\", \"130.80000000000015\", \"B#2\", \"ty2\", \"C3\", \"do3\", \"Dbb3\", \"ru3\"},\n     {\"49\", \"138.57777274219598\", \"C#3\", \"di3\", \"0\", \"0\", \"Db3\", \"ra3\"},\n     {\"50\", \"146.81803591886614\", \"Cx3\", \"dy3\", \"D3\", \"re3\", \"Ebb3\", \"mu3\"},\n     {\"51\", \"155.54829064235608\", \"D#3\", \"ri3\", \"0\", \"0\", \"Eb3\", \"me3\"},\n     {\"52\", \"164.7976733262496\", \"Dx3\", \"ry3\", \"E3\", \"mi3\", \"Fb3\", \"fu3\"},\n     {\"53\", \"174.5970529254407\", \"E#3\", \"my3\", \"F3\", \"fa3\", \"Gbb3\", \"su3\"},\n     {\"54\", \"184.97913395840104\", \"F#3\", \"fi3\", \"0\", \"0\", \"Gb3\", \"se3\"},\n     {\"55\", \"195.97856565547016\", \"Fx3\", \"fy3\", \"G3\", \"so3\", \"Abb3\", \"lu3\"},\n     {\"56\", \"207.63205759744073\", \"G#3\", \"si3\", \"0\", \"0\", \"Ab3\", \"le3\"},\n     {\"57\", \"219.978502230372\", \"Gx3\", \"sy3\", \"A3\", \"la3\", \"Bbb3\", \"tu3\"},\n     {\"58\", \"233.05910466551305\", \"A#3\", \"li3\", \"0\", \"0\", \"Bb3\", \"te3\"},\n     {\"59\", \"246.91752019753133\", \"Ax3\", \"ly3\", \"B3\", \"ti3\", \"Cb4\", \"du4\"},\n     {\"60\", \"261.60000000000036\", \"B#3\", \"ty3\", \"C4\", \"do4\", \"Dbb4\", \"ru4\"},\n     {\"61\", \"277.15554548439206\", \"C#4\", \"di4\", \"0\", \"0\", \"Db4\", \"ra4\"},\n     {\"62\", \"293.63607183773246\", \"Cx4\", \"dy4\", \"D4\", \"re4\", \"Ebb4\", \"mu4\"},\n     {\"63\", \"311.0965812847124\", \"D#4\", \"ri4\", \"0\", \"0\", \"Eb4\", \"me4\"},\n     {\"64\", \"329.5953466524994\", \"Dx4\", \"ry4\", \"E4\", \"mi4\", \"Fb4\", \"fu4\"},\n     {\"65\", \"349.1941058508816\", \"E#4\", \"my4\", \"F4\", \"fa4\", \"Gbb4\", \"su4\"},\n     {\"66\", \"369.95826791680236\", \"F#4\", \"fi4\", \"0\", \"0\", \"Gb4\", \"se4\"},\n     {\"67\", \"391.9571313109406\", \"Fx4\", \"fy4\", \"G4\", \"so4\", \"Abb4\", \"lu4\"},\n     {\"68\", \"415.26411519488175\", \"G#4\", \"si4\", \"0\", \"0\", \"Ab4\", \"le4\"},\n     {\"69\", \"439.95700446074426\", \"Gx4\", \"sy4\", \"A4\", \"la4\", \"Bbb4\", \"tu4\"},\n     {\"70\", \"466.1182093310264\", \"A#4\", \"li4\", \"0\", \"0\", \"Bb4\", \"te4\"},\n     {\"71\", \"493.83504039506295\", \"Ax4\", \"ly4\", \"B4\", \"ti4\", \"Cb5\", \"du5\"},\n     {\"72\", \"523.200000000001\", \"B#4\", \"ty4\", \"C5\", \"do5\", \"Dbb5\", \"ru5\"},\n     {\"73\", \"554.3110909687844\", \"C#5\", \"di5\", \"0\", \"0\", \"Db5\", \"ra5\"},\n     {\"74\", \"587.2721436754651\", \"Cx5\", \"dy5\", \"D5\", \"re5\", \"Ebb5\", \"mu5\"},\n     {\"75\", \"622.193162569425\", \"D#5\", \"ri5\", \"0\", \"0\", \"Eb5\", \"me5\"},\n     {\"76\", \"659.1906933049991\", \"Dx5\", \"ry5\", \"E5\", \"mi5\", \"Fb7\", \"fu7\"},\n     {\"77\", \"698.3882117017636\", \"E#5\", \"my5\", \"F5\", \"fa5\", \"Gbb5\", \"su5\"},\n     {\"78\", \"739.916535833605\", \"F#5\", \"fi5\", \"0\", \"0\", \"Gb5\", \"se5\"},\n     {\"79\", \"783.9142626218817\", \"Fx7\", \"fy7\", \"G5\", \"so5\", \"Abb5\", \"lu5\"},\n     {\"80\", \"830.5282303897641\", \"G#5\", \"si5\", \"0\", \"0\", \"Ab5\", \"le5\"},\n     {\"81\", \"879.9140089214892\", \"Gx5\", \"sy5\", \"0\", \"0\", \"A5\", \"la5\"},\n     {\"82\", \"932.2364186620536\", \"Bbb5\", \"tu5\", \"A#5\", \"li5\", \"Bb5\", \"te5\"},\n     {\"83\", \"987.6700807901268\", \"Ax5\", \"ly5\", \"B5\", \"ti5\", \"Cb6\", \"du6\"},\n     {\"84\", \"1046.400000000003\", \"B#5\", \"ty5\", \"C6\", \"do6\", \"Dbb6\", \"ru6\"},\n     {\"85\", \"1108.6221819375698\", \"C#6\", \"di6\", \"0\", \"0\", \"Db6\", \"ra6\"},\n     {\"86\", \"1174.5442873509314\", \"Cx6\", \"dy6\", \"D6\", \"re6\", \"Ebb6\", \"mu6\"},\n     {\"87\", \"1244.3863251388511\", \"D#6\", \"ri6\", \"0\", \"0\", \"Eb6\", \"me6\"},\n     {\"88\", \"1318.3813866099995\", \"Dx6\", \"ry6\", \"E6\", \"mi6\", \"Fb6\", \"fu6\"},\n     {\"89\", \"1396.7764234035285\", \"E#6\", \"my6\", \"F6\", \"fa6\", \"Gbb6\", \"su6\"},\n     {\"90\", \"1479.8330716672115\", \"F#6\", \"fi6\", \"0\", \"0\", \"Gb6\", \"se6\"},\n     {\"91\", \"1567.8285252437647\", \"Fx6\", \"fy6\", \"G6\", \"so6\", \"Abb6\", \"lu6\"},\n     {\"92\", \"1661.0564607795295\", \"G#6\", \"si6\", \"0\", \"0\", \"Ab6\", \"le6\"},\n     {\"93\", \"1759.8280178429798\", \"Gx6\", \"sy6\", \"A6\", \"la6\", \"Bbb6\", \"tu6\"},\n     {\"94\", \"1864.4728373241085\", \"A#6\", \"te6\", \"0\", \"0\", \"Bb6\", \"te6\"},\n     {\"95\", \"1975.340161580255\", \"Ax6\", \"ly6\", \"B6\", \"ti6\", \"Cb7\", \"du7\"},\n     {\"96\", \"2092.8000000000075\", \"B#6\", \"ty6\", \"C7\", \"do7\", \"Dbb7\", \"ru7\"},\n     {\"97\", \"2217.244363875141\", \"C#7\", \"di7\", \"0\", \"0\", \"Db7\", \"ra7\"},\n     {\"98\", \"2349.088574701864\", \"Cx7\", \"dy7\", \"D7\", \"re7\", \"Ebb7\", \"mu7\"},\n     {\"99\", \"2488.7726502777036\", \"D#7\", \"ri7\", \"0\", \"0\", \"Eb7\", \"me7\"},\n     {\"100\", \"2636.7627732200003\", \"Dx7\", \"ry7\", \"E7\", \"mi7\", \"Fb7\", \"fu7\"},\n     {\"101\", \"2793.5528468070584\", \"E#7\", \"my7\", \"F7\", \"fa7\", \"Gbb7\", \"su7\"},\n     {\"102\", \"2959.6661433344243\", \"F#7\", \"fi7\", \"0\", \"0\", \"Gb7\", \"se7\"},\n     {\"103\", \"3135.657050487531\", \"Fx7\", \"fy7\", \"G7\", \"so7\", \"Abb7\", \"lu7\"},\n     {\"104\", \"3322.1129215590604\", \"G#7\", \"si7\", \"0\", \"0\", \"Ab7\", \"le7\"},\n     {\"105\", \"3519.656035685961\", \"Gx7\", \"sy7\", \"A7\", \"la7\", \"Bbb7\", \"tu7\"},\n     {\"106\", \"3728.9456746482183\", \"A#7\", \"li7\", \"0\", \"0\", \"Bb7\", \"te7\"},\n     {\"107\", \"3950.6803231605113\", \"Ax7\", \"ly7\", \"B7\", \"ti7\", \"Cb8\", \"du8\"},\n     {\"108\", \"4185.600000000016\", \"B#7\", \"ty7\", \"C8\", \"do8\", \"Dbb8\", \"ru8\"},\n     {\"109\", \"4434.488727750283\", \"C#8\", \"di8\", \"0\", \"0\", \"Db8\", \"ra8\"},\n     {\"110\", \"4698.177149403729\", \"Cx8\", \"dy8\", \"D8\", \"re8\", \"Ebb8\", \"mu8\"},\n     {\"111\", \"4977.545300555408\", \"D#8\", \"ri8\", \"0\", \"0\", \"Eb8\", \"me8\"},\n     {\"112\", \"5273.525546440002\", \"Dx8\", \"ry8\", \"E8\", \"mi8\", \"Fb8\", \"fu8\"},\n     {\"113\", \"5587.105693614118\", \"E#8\", \"my8\", \"F8\", \"fa8\", \"Gbb8\", \"su8\"},\n     {\"114\", \"5919.3322866688495\", \"F#8\", \"fi8\", \"0\", \"0\", \"Gb8\", \"se8\"},\n     {\"115\", \"6271.3141009750625\", \"Fx8\", \"fy8\", \"G8\", \"so8\", \"Abb8\", \"lu8\"},\n     {\"116\", \"6644.225843118122\", \"G#8\", \"si8\", \"0\", \"0\", \"Ab8\", \"le8\"},\n     {\"117\", \"7039.312071371923\", \"Gx8\", \"sy8\", \"A8\", \"la8\", \"Bbb8\", \"tu8\"},\n     {\"118\", \"7457.8913492964375\", \"A#8\", \"li8\", \"0\", \"0\", \"Bb8\", \"te8\"},\n     {\"119\", \"7901.3606463210235\", \"Ax8\", \"ly8\", \"B8\", \"ti8\", \"Cb9\", \"du9\"},\n     {\"120\", \"8371.200000000033\", \"B#8\", \"ty8\", \"C9\", \"do9\", \"Dbb9\", \"ru9\"},\n     {\"121\", \"8868.977455500568\", \"C#9\", \"di9\", \"0\", \"0\", \"Db9\", \"ra9\"},\n     {\"122\", \"9396.35429880746\", \"Cx9\", \"dy9\", \"D9\", \"re9\", \"Ebb9\", \"mu9\"},\n     {\"123\", \"9955.090601110818\", \"D#9\", \"ri9\", \"0\", \"0\", \"Eb9\", \"me9\"},\n     {\"124\", \"10547.051092880005\", \"Dx9\", \"ry9\", \"E9\", \"mi9\", \"Fb9\", \"fu9\"},\n     {\"125\", \"11174.211387228237\", \"E#9\", \"my9\", \"F9\", \"fa9\", \"Gbb9\", \"su9\"},\n     {\"126\", \"11838.664573337703\", \"F#9\", \"fi9\", \"0\", \"0\", \"Gb9\", \"se9\"},\n     {\"127\", \"12542.628201950129\", \"Fx9\", \"fy9\", \"G9\", \"so9\", \"Abb9\", \"lu9\"}\n};\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "runtime-error", "segmentation-fault"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1560933102, "post_id": 56662682, "comment_id": 99895114, "body": "&quot;<i>On executing the code it sometimes gets executed successfully while sometimes it gives a SIGSEGV error</i>&quot; please edit your question to indicate the inputs used to produce the crash"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1560933361, "post_id": 56662682, "comment_id": 99895262, "body": "Every time you test for <code>x &gt; 10</code> you really want <code>x &gt;= 10</code>, because 10 is included in the cases with a carry. In some cases, this leads to overlong factorials, which, in turn, may exceed your 160 digits."}, {"owner": {"reputation": 9, "user_id": 11589107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i1aEtCFpqFs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reP-qSpx1sdRKAhRjwi4SkQmqTWNg/mo/photo.jpg?sz=128", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/11589107/unicorn"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1560935082, "post_id": 56662682, "comment_id": 99896249, "body": "thanks @MOehm, your suggestion solved it.."}], "owner": {"reputation": 9, "user_id": 11589107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i1aEtCFpqFs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reP-qSpx1sdRKAhRjwi4SkQmqTWNg/mo/photo.jpg?sz=128", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/11589107/unicorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 704, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560936377, "creation_date": 1560930900, "last_edit_date": 1560936377, "question_id": 56662682, "link": "https://stackoverflow.com/questions/56662682/getting-a-sigsegv-error-on-codechef-for-this-code", "title": "Getting a SIGSEGV error on codechef for this code", "body": "<p>Im trying to submit a solution for the problem FCTRL2(<a href=\"https://www.codechef.com/problems/FCTRL2\" rel=\"nofollow noreferrer\">https://www.codechef.com/problems/FCTRL2</a>) on codechef. On executing the code it sometimes gets executed successfully while sometimes it gives a SIGSEGV error. But when I submit it, it always shows wrong answer. Though the code gives correct answer when i run it on any other IDE.  </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\nusing namespace std;\n\nint main(void)\n{\n    int testCases, i, j, k, n, num, digits, carry = 0, temp;\n    scanf(\"%d\", &amp;testCases);\n    int testArr[160];\n\n    for (i = 0; i &lt; testCases; i++)\n    {\n        scanf(\"%d\", &amp;n);\n        num = n;\n        if (n == 0 || n == 1)\n        {\n            testArr[0] = 1;\n            digits = 1;\n        }\n        else\n        {\n            k = 0;\n            for (j = 10; n != 0; j = j * 10)\n            {\n                testArr[k] = n % j;\n                n = n / j;\n                k++;\n            }\n            digits = k;\n            for (j = 1; j &lt; num; j++)\n            {\n                for (k = 0; k &lt; digits; k++)\n                {\n                    temp = testArr[k] * j + carry;\n\n                    if (temp &gt; 10)\n                    {\n                        testArr[k] = temp % 10;\n                        carry = temp / 10;\n                    }\n                    else\n                    {\n                        testArr[k] = temp;\n                        carry = 0;\n                    }\n                }\n                if (carry &gt; 10)\n                {\n                    testArr[k] = carry % 10;\n                    k++;\n                    testArr[k] = carry / 10;\n                    digits = k + 1;\n                    carry = 0;\n                }\n                else if (carry &gt; 0)\n                {\n                    testArr[k] = carry;\n                    digits = k + 1;\n                    carry = 0;\n                }\n            }\n        }\n\n        for (k = (digits - 1); k &gt;= 0; k--)\n        {\n            printf(\"%d\", testArr[k]);\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arduino", "esp32"], "comments": [{"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1560931220, "post_id": 56662630, "comment_id": 99894213, "body": "Your callback is empty - so nothing will happen. Have you tried inserting a <code>Serial.println(&quot;Scan complete&quot;);</code> in the callback?"}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1560932264, "post_id": 56662630, "comment_id": 99894723, "body": "sure hope there is a bigger problem than no code inside the definition"}, {"owner": {"reputation": 380, "user_id": 5122089, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea1a3b5160d1cb5edd93da71d45cc656?s=128&d=identicon&r=PG&f=1", "display_name": "axa", "link": "https://stackoverflow.com/users/5122089/axa"}, "edited": false, "score": 0, "creation_date": 1560934577, "post_id": 56662630, "comment_id": 99895939, "body": "@ Tarick Welling Fear not. empty due to brevity"}], "answers": [{"comments": [{"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1560931516, "post_id": 56662749, "comment_id": 99894369, "body": "The <code>&amp;</code> is not required for a function pointer. See <a href=\"https://en.cppreference.com/w/cpp/language/pointer\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/pointer</a> -&gt; &#39;Pointers to functions&#39;."}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "reply_to_user": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1560932220, "post_id": 56662749, "comment_id": 99894696, "body": "the tags say C so if it is indeed not C++ then that&#39;s the problem"}, {"owner": {"reputation": 380, "user_id": 5122089, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea1a3b5160d1cb5edd93da71d45cc656?s=128&d=identicon&r=PG&f=1", "display_name": "axa", "link": "https://stackoverflow.com/users/5122089/axa"}, "edited": false, "score": 1, "creation_date": 1560935014, "post_id": 56662749, "comment_id": 99896204, "body": "well someone came by and added the C tag , what do i know... Ok thanks you guys solved this non mystery.  also i forgot to change the implementations return type to bool (the non call back variant gets something type &#39;scanResults&#39;) so that was also why it was not compiling. my bad"}], "tags": [], "owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "is_accepted": true, "score": 2, "last_activity_date": 1560931124, "creation_date": 1560931124, "answer_id": 56662749, "question_id": 56662630, "link": "https://stackoverflow.com/questions/56662630/how-to-define-the-callback-for-an-esp32-arduino-ble-scan-result/56662749#56662749", "title": "How to define the callback for an esp32 arduino ble scan result", "body": "<p>you need to add &amp; to <code>OnScanResults</code> because:</p>\n\n<pre><code>void (*scanCompleteCB)(BLEScanResults)\n</code></pre>\n\n<p>is a pointer to a function which takes a <code>BLEScanResults</code>, returns nothing and is called <code>scanCompleteCB</code></p>\n\n<p>So your call should be:</p>\n\n<pre><code>scanResults = scan-&gt;start(60, &amp;OnScanResults, true);\n</code></pre>\n\n<p>just as a pointer to a <code>int</code> points to the address of a <code>int</code></p>\n\n<pre><code>int pointedTo;\nint* ptr = &amp;pointedTo;\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 5122089, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea1a3b5160d1cb5edd93da71d45cc656?s=128&d=identicon&r=PG&f=1", "display_name": "axa", "link": "https://stackoverflow.com/users/5122089/axa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "accepted_answer_id": 56662749, "answer_count": 1, "score": 1, "last_activity_date": 1560931124, "creation_date": 1560930679, "last_edit_date": 1560931081, "question_id": 56662630, "link": "https://stackoverflow.com/questions/56662630/how-to-define-the-callback-for-an-esp32-arduino-ble-scan-result", "title": "How to define the callback for an esp32 arduino ble scan result", "body": "<p>The definition to start a BLE scan is:</p>\n\n<pre><code>bool start(uint32_t duration, void (*scanCompleteCB)(BLEScanResults), bool is_continue = false);\n</code></pre>\n\n<p>The second parameter seems to be the callback when a scan is complete, being somewhat new to this Im unsure how to define it.</p>\n\n<p>fwiw Ive tried this:</p>\n\n<pre><code>void OnScanResults(BLEScanResults scanResults)\n{ }\n</code></pre>\n\n<p>and used it like this:</p>\n\n<pre><code>scanResults = scan-&gt;start(60, OnScanResults, true);\n</code></pre>\n\n<p>but obvious to others, that didnt work.</p>\n\n<p>Please help me decypher that signature </p>\n\n<pre><code>void (*scanCompleteCB)(BLEScanResults)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1560929502, "post_id": 56662289, "comment_id": 99893381, "body": "Read this:  <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\"><b>Why is \u201cwhile (!feof(file))\u201d always wrong?</b></a>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1560929628, "post_id": 56662289, "comment_id": 99893446, "body": "Start by checking the <code>fsetpos</code> return value. Is it zero?"}, {"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "edited": false, "score": 0, "creation_date": 1560929693, "post_id": 56662289, "comment_id": 99893477, "body": "While the refered links are mainly correct, their arguments are in an <i>&quot;abstract, high-level perspective&quot;</i>. In fact this is a valid operation and you can use it without any problem in playground code. What is in <code>pp</code> before and after the call? Simply print it with a <code>printf</code>, or use a debugger."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1560929870, "post_id": 56662289, "comment_id": 99893568, "body": "How is <code>pp</code> initialized? By a <code>fgetpos</code> call?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1560929907, "post_id": 56662289, "comment_id": 99893579, "body": "Maybe you want to check out <code>fseek</code> - see for instance <a href=\"https://stackoverflow.com/questions/20510718/moving-file-pointer-back-to-string-it-already-read\" title=\"moving file pointer back to string it already read\">stackoverflow.com/questions/20510718/&hellip;</a> I&#39;m pretty sure that <code>fsetpos</code> is <b>not</b> what you want"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1560929942, "post_id": 56662289, "comment_id": 99893605, "body": "<i>I have set a file pointer to the particular location (say 400).</i>  You can&#39;t &quot;set&quot; a position for <code>fsetpos()</code> in that way.  You can only use it to return to a location and state obtained from <code>fgetpos()</code>.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.3\" rel=\"nofollow noreferrer\">the C standard</a>:  &quot;The <code>fsetpos</code> function sets the mbstate_t object (if any) and file position indicator for the stream pointed to by stream according to the value of the object pointed to by <code>pos</code>, <b>which shall be a value obtained from an earlier successful call to the fgetpos function on a stream associated with the same file</b>.&quot;"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "edited": false, "score": 0, "creation_date": 1560930100, "post_id": 56662289, "comment_id": 99893678, "body": "@peterh <i>What is in pp before and after the call? Simply print it with a printf, or use a debugger.</i> Read this answer:  <a href=\"https://stackoverflow.com/a/39587990/4756299\">stackoverflow.com/a/39587990/4756299</a>  The platform isn&#39;t specified.  You can&#39;t in general <code>printf()</code> an <code>fpos_t</code> value."}, {"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560930264, "post_id": 56662289, "comment_id": 99893737, "body": "@AndrewHenle Yes. We need to suspect as a <i>work hyphothesis</i> that it is an integer or similar. It has a quite high chance. If you have some language lawyer affinity, then I would say: the question indirectly states that it is an integer what can contain 400."}, {"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1560933187, "post_id": 56662289, "comment_id": 99895159, "body": "@AndrewHenle Oops, I&#39;ve read your comment just now! You are right. I think it could be a nice answer!"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1560933194, "post_id": 56662289, "comment_id": 99895163, "body": "Welcome to SO. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MCVE</a> that reproduces the problem. Your code is way too little to know what is going on."}, {"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1560933273, "post_id": 56662289, "comment_id": 99895205, "body": "@Gerhardh Meanwhile, Andrew Henle has answered it in a comment. This problem does not require MCVE, because it is not a debug problem (even if it looks so), instead it is a C standard api question."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "edited": false, "score": 2, "creation_date": 1560933698, "post_id": 56662289, "comment_id": 99895447, "body": "@peterh While it is very likely that Andrew Henle indeed is right, that comment is based on assumptions about what content might be used in <code>fsetpos</code>. A MCVE would show it."}], "owner": {"reputation": 15, "user_id": 13683064, "user_type": "registered", "profile_image": "https://graph.facebook.com/2267536456831996/picture?type=large", "display_name": "RaVi DuDi", "link": "https://stackoverflow.com/users/13683064/ravi-dudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560929558, "creation_date": 1560929375, "last_edit_date": 1560929558, "question_id": 56662289, "link": "https://stackoverflow.com/questions/56662289/fgets-does-not-read-from-given-location", "title": "Fgets does not read from given location", "body": "<p>I  want to read a file from a specified location. I have set a file pointer to the particular location (say 400). Now I am running a while loop till end of the file, and I am reading it line by line using fgets. But fgets reads the file from starting, and not from the specified location.</p>\n\n<pre><code>fsetpos(src,&amp;pp);\nwhile(!feof(src)) {\n     fgets(cpy_buff,sizeof(cpy_buff),src);\n     buffsize=strlen(cpy_buff);\n     fwrite(cpy_buff, 1,buffsize,dst);\n     memset(cpy_buff, 0, sizeof(cpy_buff));\n}\n</code></pre>\n"}, {"tags": ["c", "arduino"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560929257, "post_id": 56662192, "comment_id": 99893222, "body": "Do the Arduino libs handle de-bouncing? Otherwise that&#39;s one obvious problem."}, {"owner": {"reputation": 135, "user_id": 8814617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YgTq1.jpg?s=128&g=1", "display_name": "Steven Yu", "link": "https://stackoverflow.com/users/8814617/steven-yu"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560929772, "post_id": 56662192, "comment_id": 99893516, "body": "@Lundin No, and there is the answer provided. Thank you also"}, {"owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1560945926, "post_id": 56662192, "comment_id": 99902286, "body": "@Lundin: delay(500) handles debouncing."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "edited": false, "score": 0, "creation_date": 1560948437, "post_id": 56662192, "comment_id": 99903752, "body": "@datafiddler No, it doesn&#39;t. Since this code uses polling, it may read the button at any point in time and not just on an edge. The read might occur in the middle of a signal bounce, and then the button remains in the wrong position for 500ms."}, {"owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1561037723, "post_id": 56662192, "comment_id": 99939845, "body": "@Lundin There is no wrong position during bouncing! You get still the old one or already the new one. If I read a button only every 500 ms, I won&#39;t notice every change,and yes, it remains in the wrong position for 500 ms, but I don&#39;t have to care about bouncing."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "edited": false, "score": 0, "creation_date": 1561359563, "post_id": 56662192, "comment_id": 100021804, "body": "@datafiddler The user will notice it as a broken button, which sometimes fails to register button presses.That&#39;s as bad as no debouncing at all."}, {"owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "edited": false, "score": 0, "creation_date": 1561457949, "post_id": 56662192, "comment_id": 100061154, "body": "If the button is pressed for less than 0.5s, it will be either noticed for 0.5s or not at all. I agree, <code>delay(500);</code> is bad for interactive sketches."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 4, "last_activity_date": 1560929249, "creation_date": 1560929249, "answer_id": 56662264, "question_id": 56662192, "link": "https://stackoverflow.com/questions/56662192/same-code-but-different-output-in-arduino/56662264#56662264", "title": "Same code but different output in Arduino", "body": "<blockquote>\n  <p>How can i make the output of button1 same with the output of button2?</p>\n</blockquote>\n\n<p>You are getting <code>1 0 1 0 1 0 1 0</code> for <code>button 1</code> because first <code>if</code> and last <code>else</code> block will be executed each time when <code>button1</code> is pressed.</p>\n\n<p>Add <code>else</code> to second <code>if</code>.  </p>\n\n<pre><code>if (digitalRead(BUTTON1) == LOW) {\n    delay(500);\n    i = \"1\";\n    Serial.println(i);\n  } \n  else if (digitalRead(BUTTON2) == LOW) {\n    delay(500);\n    j = \"2\";\n    Serial.println(j);\n  } \n  else {\n    delay(500);\n    x = \"0\";\n    Serial.println(x);\n  }\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 8814617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YgTq1.jpg?s=128&g=1", "display_name": "Steven Yu", "link": "https://stackoverflow.com/users/8814617/steven-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56662264, "answer_count": 1, "score": 4, "last_activity_date": 1560929249, "creation_date": 1560929018, "question_id": 56662192, "link": "https://stackoverflow.com/questions/56662192/same-code-but-different-output-in-arduino", "title": "Same code but different output in Arduino", "body": "<p>Recently i'm develop a program by using Arduino UNO. The code i write for two button is totally same but the output different.</p>\n\n<p>Here is the code i write.</p>\n\n<pre><code>const int BUTTON1 = 6;\nconst int BUTTON2 = 7;\nString i, j, x;\n\nint ButtonState = 0;\n\nvoid setup() {\n  // put your setup code here, to run once:\n  Serial.begin(9600);\n  pinMode(BUTTON1, INPUT_PULLUP);\n  pinMode(BUTTON2, INPUT_PULLUP);\n}\n\nvoid loop() {\n  if (digitalRead(BUTTON1) == LOW) {\n    delay(500);\n    i = \"1\";\n    Serial.println(i);\n  } \n  if (digitalRead(BUTTON2) == LOW) {\n    delay(500);\n    j = \"2\";\n    Serial.println(j);\n  } \n  else {\n    delay(500);\n    x = \"0\";\n    Serial.println(x);\n  }\n}\n</code></pre>\n\n<p>When i keep pressing the button1, the output is\n1\n0\n1\n0\n1\n0\n1\n0</p>\n\n<p>And when i keep pressing the button2, the ouput is\n2\n2\n2\n2\n2\n2\n2</p>\n\n<p>How can i make the output of button1 same with the output of button2?</p>\n"}, {"tags": ["c", "memory-leaks", "clang"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 8220188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96012ad3bf37f9bc6debf4a7b3bcbcd?s=128&d=identicon&r=PG&f=1", "display_name": "dqmis", "link": "https://stackoverflow.com/users/8220188/dqmis"}, "edited": false, "score": 0, "creation_date": 1560929203, "post_id": 56662168, "comment_id": 99893187, "body": "Thank you! You saved my day! I thought that there has to be something with bad memory allocation."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1560928952, "creation_date": 1560928952, "answer_id": 56662168, "question_id": 56662038, "link": "https://stackoverflow.com/questions/56662038/getting-memory-memory-allocation-error-with-corrupted-top-size/56662168#56662168", "title": "Getting memory memory allocation error with corrupted top size", "body": "<p>Remember that the <a href=\"https://en.cppreference.com/w/c/memory/malloc\" rel=\"nofollow noreferrer\"><code>malloc</code></a> function takes the size in <em>bytes</em> to allocate, which means an allocation like e.g. <code>malloc(unit)</code> will be incorrect.</p>\n\n<p>You do it correctly in some places where you multiply the number of elements to allocate with the size of the type, but not in other places. You need to multiply in <em>all</em> places.</p>\n\n<p>For example</p>\n\n<pre><code>output[j] = (float *)malloc(unit);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>output[j] = malloc(unit * sizeof *output[j]);\n</code></pre>\n\n<p>There are a few places you do this mistake.</p>\n\n<p>Because of this, you don't allocate enough memory, and will go out of bounds of the allocated memory. That leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>. In your specific case you seem to overwrite some internal data used by the memory allocator, leading to problems when you attempt to use the allocator again (for example when you <code>free</code> the memory).</p>\n\n<p>Also note that in C you <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">should not cast the result of <code>malloc</code></a>.</p>\n"}], "owner": {"reputation": 409, "user_id": 8220188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96012ad3bf37f9bc6debf4a7b3bcbcd?s=128&d=identicon&r=PG&f=1", "display_name": "dqmis", "link": "https://stackoverflow.com/users/8220188/dqmis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1522, "favorite_count": 0, "accepted_answer_id": 56662168, "answer_count": 1, "score": 1, "last_activity_date": 1560928952, "creation_date": 1560928503, "question_id": 56662038, "link": "https://stackoverflow.com/questions/56662038/getting-memory-memory-allocation-error-with-corrupted-top-size", "title": "Getting memory memory allocation error with corrupted top size", "body": "<p>I am writing a C language program that process tensorflow-keras layers data and makes forward propagation to calculate neural nets output. I have to integrate neural nets to embedded system so I have to implement simple matrix multiplication i C. I am not an expert in this language and I am getting weir behavior while allocating an releasing memory. If I am using <code>prinf</code> before memory allocation, everything works, but if I don't use it, my program breaks for some reason and I am getting this error: <code>malloc(): corrupted top size</code>. Am I making memory allocation in bad way? What can I change to prevent this behavior?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct\n{\n    int layer_count;\n    int input, unit;\n    float *b;\n    float **w;\n} layer;\n\nvoid init_layer_types(layer* l, int layer_count, int input, int unit)\n{\n    l-&gt;input = input;\n    l-&gt;unit = unit;\n    l-&gt;layer_count = layer_count;\n\n    l-&gt;w = (float **)malloc(input * sizeof(float *));\n    for (int i=0; i &lt; input; i++)\n        l-&gt;w[i] = (float *)malloc(unit * sizeof(float));\n\n    l-&gt;b = (float *)malloc(unit * sizeof(float));\n}\n\nvoid read_layers(int layers_count, layer network[]) {\n    FILE* file = fopen(\"layers.txt\", \"r\");\n    int input, unit;\n    float val;\n    for (int i = 0; i &lt; layers_count; i++) {\n        layer l;\n        fscanf(file, \"%d\", &amp;input);\n        fscanf(file, \"%d\", &amp;unit);\n        init_layer_types(&amp;l, i, input, unit);\n\n        for (int j = 0; j &lt; input; j++) {\n            for (int k = 0; k &lt; unit; k++) {\n                fscanf(file, \"%f\", &amp;val);\n                l.w[j][k] = val;\n            }\n        }\n        for (int j = 0; j &lt; unit; j++) {\n            fscanf(file, \"%f\", &amp;val);\n            l.b[j] = val;\n        }\n        network[i] = l;\n    }\n}\n\nvoid dot(int m1, int m2, int n1, int n2, float **mat1, float **mat2, float **res)\n{\n    for (int i = 0; i &lt; m1; i++) {\n        for (int j = 0; j &lt; n2; j++)\n        {\n            res[i][j] = 0;\n            for (int x = 0; x &lt; m2; x++)\n                res[i][j] += mat1[i][x] * mat2[x][j];\n        }\n    }\n}\n\nvoid add(float **output, float *b, int m, int n)\n{\n    for (int i = 0; i &lt; m; i++)\n        for (int j = 0; j &lt; n; j++)\n            output[i][j] += b[i];\n}\n\nvoid read_inputs(int dim, float **inputs) {\n    float val;\n    FILE* file = fopen(\"inputs.txt\", \"r\");\n    for (int i = 0; i &lt; dim; i++) {\n        fscanf(file, \"%f\", &amp;val);\n        inputs[0][i] = val;\n    }\n}\n\nvoid free_memory(int n, float **arr) {\n    for (int i = 0; i &lt; n; i++)\n        free(arr[i]);\n    free(arr);\n    arr = NULL;\n}\n\nfloat **get_arr(int input_dim, int unit) {\n    float **output = (float **)malloc(input_dim * sizeof(float *));\n    for (int j = 0; j &lt; input_dim; j++)\n        output[j] = (float *)malloc(unit);\n    return output;\n}\n\nint main() {\n    const int input_dim = 1;\n    const int input_count = 5;\n    const int layer_count = 3;\n\n    float **inputs = get_arr(input_dim, input_count);\n    read_inputs(input_count, inputs);\n\n    layer *network = (layer *)malloc(layer_count * sizeof(layer));\n    read_layers(layer_count, network);\n\n    float  **output;\n    printf(\"Processing\\n\"); // &lt;-- Here if I delete this line, I get memory allocation error.\n    for (int i = 0; i &lt; layer_count; i++)\n    {\n        output = get_arr(input_dim, network[i].unit);\n\n        dot(input_dim, network[i].input, network[i].input, network[i].unit, inputs, network[i].w, output);\n        add(output, network[i].b, input_dim, network[i].unit);\n\n        free_memory(input_dim, inputs);\n        inputs = output;\n    }\n    float num = *(inputs[0]);\n    free_memory(input_dim, inputs);\n    printf(\"%f\", num);\n    return 0;\n}\n</code></pre>\n\n<p>My program is source file dependent, so here are data of them:\n<code>layers.txt</code>:  </p>\n\n<pre><code>5 16\n-0.27510703 0.05656046 0.21719019 0.36794823 -0.45897833 -0.15796176 0.42044222 0.12223288 -0.4054776 0.78101534 -0.2743374 -0.038984317 0.21881248 -0.57430464 0.06383126 -0.7321343 -0.27794576 -0.25287467 -0.586286 -0.057798754 -0.097728394 -0.16848974 -0.31734765 0.5382229 -0.19734482 -0.12539126 0.80764467 0.83615685 -0.15496157 0.6195798 -0.9146123 -0.57317895 0.059357792 0.05658521 -0.27737 -0.13202512 -0.31854483 0.2181433 -0.25090697 0.4077587 -0.5032105 0.041977283 0.03668945 0.3296285 0.19465968 0.420567 -0.70456696 -0.43721324 -0.3233525 0.17888355 -0.38667187 0.14075014 0.041260455 0.018714897 -0.565683 0.41157398 0.09909809 0.37904713 0.6497243 -0.19682685 -0.55571586 0.034314968 -0.69701445 -0.3313689 0.34335998 0.8097565 -0.5070784 0.4980565 -0.00498956 1.0258771 0.022312356 0.16200699 0.2964861 -0.15127556 0.6075885 0.012937768 0.63023937 0.37498713 -1.3245078 -0.07527774\n0.7297894 0.88037413 -0.49263608 0.88363385 0.7770243 0.9019361 0.57204115 0.94174325 0.7811348 0.3338186 0.6115855 0.9348049 0.98463 0.74922246 -0.2442382 0.7401446\n16 16\n0.5294986 0.095209315 0.5816423 0.011750876 0.79768986 0.18347172 0.5230593 -0.20458926 0.03238925 0.7263444 0.19537736 0.51469505 0.38453174 0.4792065 0.47070476 0.48203093 0.6408747 0.20587757 0.87248856 0.51753175 0.19367562 0.5328166 0.6011898 -0.9065597 0.95500827 0.33368462 0.53764784 0.45068842 0.12343783 -0.93090314 0.009520332 0.84407306 -0.4930213 -0.60485965 -0.113633305 -0.20889078 -1.1993133 -0.59244674 -0.14670648 0.5882502 -0.44252092 -0.9068741 -0.47101536 -0.6771671 -0.57774156 0.3202908 -0.6125743 -0.19555524 0.34589607 0.48220173 0.887751 -0.010264315 -0.53484684 0.9223027 -0.116944976 0.3552805 0.57485306 1.1548213 0.73101723 0.024920506 0.758325 0.33818895 0.46289825 0.75641644 0.5973245 0.58425486 0.6186228 0.27397043 -0.16205522 0.24053968 0.14349774 0.0682401 0.78229904 0.53935903 0.06586165 -0.036975164 0.14868408 0.114033416 0.21479316 0.33285123 0.82021 0.7476087 0.53433895 0.18636973 -0.004250426 0.80443674 0.35212353 -0.99279344 0.09624279 0.22507294 0.1551801 0.4401552 0.4344537 -1.0609607 0.2112829 0.73665375 0.30300483 0.43053505 -0.075404234 -0.46463633 -0.63602394 0.11983294 -0.1700229 0.12950262 0.037001535 0.14967114 0.2236458 0.23652838 -0.074841894 0.4731138 -0.1891633 0.5675689 0.5004651 0.7590372 0.3406028 -0.30780622 -0.4056706 0.054417405 0.014160816 -0.502301 0.6902765 0.5627833 0.6560702 0.14820565 0.44759235 -0.4517361 0.24475953 0.19302326 0.17013979 0.7032596 0.59683084 0.6487092 0.13578065 0.9571763 0.3489112 0.24147744 0.294642 0.91326237 0.02771005 0.30833304 0.8724447 -0.30238068 0.8733717 0.60625494 0.6640253 0.12542762 0.3752495 -0.14965096 -0.21784364 0.6297658 -0.1163313 0.14957857 0.59309405 0.029121447 0.22690158 -0.24634236 0.08391688 0.4665475 0.43288168 0.04094743 0.550001 -0.030953215 0.72441626 -0.5303838 -0.6599007 0.28969297 0.13298538 -0.97688687 0.10630749 0.7048332 -0.020065783 0.45250762 0.65564346 0.36419603 -0.15683183 0.56276035 0.13720869 0.5241819 0.32492644 0.41968134 0.0985914 0.8151626 0.16679804 -0.37237772 0.20443702 0.54484195 0.61047757 -0.29266858 0.83509314 -0.42326364 0.8025571 0.9248121 0.84348476 0.9041855 0.5863141 0.6110747 1.1242607 1.1184481 -0.27281645 0.122819185 0.62381345 0.65988976 0.6341375 -0.45514598 0.68389523 0.28733313 0.7390246 0.9125664 0.3933753 0.6393983 0.13370913 -0.5635324 0.23211549 0.5146912 0.14429328 -0.21532854 0.5479508 0.16717906 0.48443708 -0.07323354 0.3086167 -0.11754378 0.2828258 0.6764059 -0.68566364 0.14362451 -0.26707077 -0.053668447 -0.7462183 -0.71973497 -0.43526867 0.5410068 0.024889803 -0.5076304 0.062299147 -0.3323771 -0.6676218 0.08483551 -0.5460029 -0.66296375 0.6821926 0.301253 0.5014378 0.5700288 0.50235826 0.2884027 -0.710421 0.5061369 0.044829175 0.18046197 0.7125541 -0.5425324 0.33107722 0.16374299 0.24497494 0.33329406\n0.67616004 0.51669836 0.6583131 0.24366198 0.1501881 0.80439085 -0.16105098 0.011128932 0.5884628 0.77304965 0.54262626 -0.19401886 0.66081685 0.04697459 0.8041494 0.6982975\n16 1\n0.9814956 0.8053132 0.5269977 -0.8047956 -1.6299891 0.80752444 -0.8163326 -0.6561919 0.8894982 0.78555495 1.0655055 -0.47944012 1.1637385 -0.3714269 0.85063654 1.0498714\n0.40419745\n</code></pre>\n\n<p><code>inputs.txt</code>:</p>\n\n<pre><code>30.7 3.864 3.866 3.867 3.864\n</code></pre>\n\n<p>Thanks for yours time!</p>\n"}, {"tags": ["c", "windows-7-x64", "32-bit", "dll-injection", "createremotethread"], "comments": [{"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1560926251, "post_id": 56661351, "comment_id": 99891703, "body": "What does <code>GetLastError()</code> give when <code>CreateRemoteThread</code> fails?"}, {"owner": {"reputation": 21, "user_id": 3551678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2f68fb8be536aad87dd4a423d392e?s=128&d=identicon&r=PG&f=1", "display_name": "user3551678", "link": "https://stackoverflow.com/users/3551678/user3551678"}, "reply_to_user": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1560928376, "post_id": 56661351, "comment_id": 99892767, "body": "@GauravSehgal I edited the post. The GetLastError() method returns 5."}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1560929088, "post_id": 56661351, "comment_id": 99893123, "body": "<code>5</code> means <code>ACCESS DENIED</code>, what process are you trying to inject in? Check with different processes (may be running with lower privileges)."}, {"owner": {"reputation": 21, "user_id": 3551678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2f68fb8be536aad87dd4a423d392e?s=128&d=identicon&r=PG&f=1", "display_name": "user3551678", "link": "https://stackoverflow.com/users/3551678/user3551678"}, "reply_to_user": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1560929281, "post_id": 56661351, "comment_id": 99893239, "body": "@GauravSehgal I am injecting on many kinds of processes, but mainly testing on a java application. I run as administrator. I think this is not the case since When running the exact same java in 64 bit mode, it all works fine."}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1560931111, "post_id": 56661351, "comment_id": 99894152, "body": "It has to be something related to the 32-64 mismatch. Double check the processes and the dll you try to inject are of same architecture. Also keep in mind wow64 redirection, check with procmon to identify if some dll or its dependent dlls are getting accessed from 64 bit location(system32)."}, {"owner": {"reputation": 21, "user_id": 3551678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2f68fb8be536aad87dd4a423d392e?s=128&d=identicon&r=PG&f=1", "display_name": "user3551678", "link": "https://stackoverflow.com/users/3551678/user3551678"}, "reply_to_user": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1561210789, "post_id": 56661351, "comment_id": 99993884, "body": "So I have made some changes to isolate the issue. I have created a very simple injected dll code which only prints &quot;I am inside!&quot;, and I switched from java to a simple C console application with no code except getChar() to keep the console open. Still using the injection function above. I am still using the code above to inject, and no change. This question has been previously asked with no answer: <a href=\"https://social.msdn.microsoft.com/Forums/ie/en-US/8257aa1c-de97-4c47-9bf9-ca74c3d6fc8a/createremotethread-returning-access-denied?forum=windowsgeneraldevelopmentissues\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/ie/en-US/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 3551678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2f68fb8be536aad87dd4a423d392e?s=128&d=identicon&r=PG&f=1", "display_name": "user3551678", "link": "https://stackoverflow.com/users/3551678/user3551678"}, "is_accepted": false, "score": 2, "last_activity_date": 1561354662, "last_edit_date": 1561354662, "creation_date": 1561264044, "answer_id": 56721011, "question_id": 56661351, "link": "https://stackoverflow.com/questions/56661351/createremotethread-fails-on-windows7-64bit-for-32bit-applications/56721011#56721011", "title": "CreateRemoteThread fails on Windows7 64bit for 32bit applications", "body": "<p>The problem was that I had to add <code>PROCESS_QUERY_INFORMATION</code> to the <code>OpenProcess</code> flags. This was very tricky, since if you don't include this flag, it will still work everywhere except the case of Win7 64bit OS and 32bit application. </p>\n"}], "owner": {"reputation": 21, "user_id": 3551678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2f68fb8be536aad87dd4a423d392e?s=128&d=identicon&r=PG&f=1", "display_name": "user3551678", "link": "https://stackoverflow.com/users/3551678/user3551678"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561354662, "creation_date": 1560925772, "last_edit_date": 1560932073, "question_id": 56661351, "link": "https://stackoverflow.com/questions/56661351/createremotethread-fails-on-windows7-64bit-for-32bit-applications", "title": "CreateRemoteThread fails on Windows7 64bit for 32bit applications", "body": "<p>I have a code which injects a dll to a process. The process which executes the injection function is always in the same architecture (x86 or x64) as the injected process. But for some reason, the CreateRemoteThread function call fails on Win7 64 bit OS, when the injecting and injected processes are of x86 architecture. Surprisingly, when the OS is Win10 64bit. 32 bit processes work fine. The code also works well for Win7 64 bit with 64 bit processes, and for Win7 32 bit with 32 bit processes.</p>\n\n<p>I've looked over the internet for a possible cause and all I could find is that in Win7 there are sometimes issues with process sessions. I don't think this is the case since both the injecting and injected processes are \"user\" sessions.</p>\n\n<p>When running GetLastError() I get 5 (ERROR_ACCESS_DENIED)</p>\n\n<p>This is my injection function: </p>\n\n<pre><code>    DWORD Inject(DWORD PID, const char *dllname)\n    {\n        HANDLE hThread = NULL;\n        BOOL writeSucceed = false;\n        int cch = 0;\n\n        cout &lt;&lt; \"Injector.dll : Injecting \" &lt;&lt; dllname &lt;&lt; \" to \" &lt;&lt; PID &lt;&lt; endl;\n        DWORD hLibModule;\n\n        HMODULE hKernel32 = GetModuleHandle (TEXT (\"Kernel32\"));\n        void *hProcess = OpenProcess (PROCESS_CREATE_THREAD | PROCESS_VM_OPERATION |\n                                      PROCESS_VM_WRITE, false, PID);  \n\n        cch = strlen (dllname) + 1;\n\n        void *pLibRemote = VirtualAllocEx (hProcess, NULL, cch, MEM_COMMIT,\n            PAGE_READWRITE);\n\n        writeSucceed = WriteProcessMemory (hProcess, pLibRemote, (void *) dllname, cch, NULL);\n\n        hThread = CreateRemoteThread (hProcess, NULL, 0,\n                                            (PTHREAD_START_ROUTINE)\n                                            GetProcAddress (hKernel32,\n                                            \"LoadLibraryA\"),\n                                            pLibRemote, 0, NULL);\n\n        WaitForSingleObject (hThread, INFINITE);\n        GetExitCodeThread( hThread, &amp;hLibModule );\n        CloseHandle (hThread);\n\n        VirtualFreeEx (hProcess, pLibRemote, sizeof (dllname), MEM_RELEASE);\n\n        hThread = CreateRemoteThread (hProcess, NULL, 0,\n                                     (PTHREAD_START_ROUTINE) GetProcAddress (hKernel32,\n                                     \"FreeLibrary\"),\n                                     (void *) hLibModule, 0, NULL);\n        WaitForSingleObject (hThread, INFINITE);\n        CloseHandle (hThread);\n        return 0;\n    }\n\nIs there some special treatment I should do in code for Windows 7?\n</code></pre>\n"}, {"tags": ["mysql", "c", "packet-sniffers"], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 9065877, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=128&d=identicon&r=PG", "display_name": "user9065877", "link": "https://stackoverflow.com/users/9065877/user9065877"}, "is_accepted": false, "score": 0, "last_activity_date": 1561431603, "creation_date": 1561431603, "answer_id": 56746271, "question_id": 56661228, "link": "https://stackoverflow.com/questions/56661228/error-in-using-pcap-loop-with-mysql-con-as-my-argument/56746271#56746271", "title": "Error in using pcap loop with mysql con as My argument", "body": "<p>The \"user\" argument to <code>pcap_loop()</code>, <code>pcap_dispatch()</code>, and the callback probably <em>should</em> have been defined to be a <code>void *</code>, as it's a pointer to some arbitrary data that the callback understands, but it was defined to be a <code>u_char *</code> instead.</p>\n\n<p>So you should cast the <code>MYSQL *</code> to <code>u_char *</code>:</p>\n\n<pre><code>pcap_loop(handle, total_packet_count, my_packet_handler, (u_char *)con);\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11567179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3972ba92d51aa24e862353ee024997?s=128&d=identicon&r=PG&f=1", "display_name": "lonesome", "link": "https://stackoverflow.com/users/11567179/lonesome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561441327, "creation_date": 1560925344, "last_edit_date": 1561441327, "question_id": 56661228, "link": "https://stackoverflow.com/questions/56661228/error-in-using-pcap-loop-with-mysql-con-as-my-argument", "title": "Error in using pcap loop with mysql con as My argument", "body": "<p>I want to add the mysql connection with the pcap loop which I am using in the code</p>\n\n<pre><code>MYSQL *con;\nu_char *my_arguments = con;\npcap_loop(handle, total_packet_count, my_packet_handler, my_arguments);\n</code></pre>\n\n<p>but it is giving error</p>\n\n<blockquote>\n  <p>warning: initialization from incompatible pointer type\n  [-Wincompatible-pointer-types]\n          u_char *my_arguments = con;^~~</p>\n</blockquote>\n\n<p>SO what should I do help is needed please</p>\n\n<p>When I am directly putting value of con in pcap loop like pcap_loop(handle, total_packet_count, my_packet_handler, con); it is showing new error</p>\n\n<p>Error is   </p>\n\n<blockquote>\n  <p>passing argument 4 of \u2018pcap_loop\u2019 from incompatible pointer type\n  [-Wincompatible-pointer-types]\n          pcap_loop(handle, total_packet_count, my_packet_handler, con);</p>\n  \n  <p>note: expected \u2018u_char * {aka unsigned char *}\u2019 but argument is of type \u2018MYSQL * {aka struct st_mysql *}\u2019\n           PCAP_API int pcap_loop(pcap_t *, int, pcap_handler, u_char *);</p>\n</blockquote>\n\n<p>but I want it to be pushed in pcap loop</p>\n"}, {"tags": ["c", "stm32", "iar", "stm32l152"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1560929229, "post_id": 56660130, "comment_id": 99893206, "body": "Is it C++.? You do not have to worry or variables will have distinct storage locations"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1560929834, "post_id": 56660130, "comment_id": 99893550, "body": "Have linker generate the map file, and look what it says. What version of IAR is this?"}, {"owner": {"reputation": 3363, "user_id": 721597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea871c2fe4a4a4302034720f37d8b268?s=128&d=identicon&r=PG", "display_name": "Harikrishnan", "link": "https://stackoverflow.com/users/721597/harikrishnan"}, "edited": false, "score": 0, "creation_date": 1560934435, "post_id": 56660130, "comment_id": 99895864, "body": "I am using IAR 8.30, and it is C"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1560937125, "post_id": 56660130, "comment_id": 99897375, "body": "<code>0x20001488</code> is different from <code>0x20001489</code>, how can it mean they have the same address? <code>the processor is 32bit</code> - processor supports instructions operating on 32-bit registers, but the memory is byte-addressable."}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1560941171, "post_id": 56660130, "comment_id": 99899602, "body": "With the limited information presented in the question my guess is that it is a bug in the presentation of code in the ide, but without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> it can be nothing more than a guess. Have you considered contacting IAR support?"}, {"owner": {"reputation": 3363, "user_id": 721597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea871c2fe4a4a4302034720f37d8b268?s=128&d=identicon&r=PG", "display_name": "Harikrishnan", "link": "https://stackoverflow.com/users/721597/harikrishnan"}, "edited": false, "score": 0, "creation_date": 1561005483, "post_id": 56660130, "comment_id": 99924326, "body": "Thanks for the reply. It is a huge project, and I am not allowed to submit it. I will try with linked map file."}], "owner": {"reputation": 3363, "user_id": 721597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea871c2fe4a4a4302034720f37d8b268?s=128&d=identicon&r=PG", "display_name": "Harikrishnan", "link": "https://stackoverflow.com/users/721597/harikrishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1562292330, "creation_date": 1560919001, "last_edit_date": 1562292330, "question_id": 56660130, "link": "https://stackoverflow.com/questions/56660130/memory-allocation-clarification-required", "title": "Memory allocation clarification required", "body": "<p>Here is the picture of a variable placement in STM32L152VBX memory with IAR IDE (8.30). I am using C.</p>\n\n<ul>\n<li><code>_gprs_inited</code> is a static variable (8bit), </li>\n<li><code>send_data_with_gprs</code> is a function, </li>\n<li><code>_failed_gprs_counter</code> is a static variable (8bit) declared inside the function.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/umf46.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/umf46.png\" alt=\"memroy location\"></a></p>\n\n<p>Does this mean both the variables are allocated in the same address?</p>\n\n<p>I mean since both are 8 bit variables, and the processor is 32bit it can hold those two? </p>\n"}, {"tags": ["c", "arm", "armcc"], "comments": [{"owner": {"reputation": 8286, "user_id": 533037, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f711473fb27cd269ba5ad2064c15dcd3?s=128&d=identicon&r=PG", "display_name": "solidpixel", "link": "https://stackoverflow.com/users/533037/solidpixel"}, "edited": false, "score": 0, "creation_date": 1560930373, "post_id": 56660109, "comment_id": 99893795, "body": "&quot;this compiler feels quite old&quot; it definitely is - IIRC ADS 1.2 release was in 2001"}, {"owner": {"reputation": 73, "user_id": 11639540, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V1r5wWFkLq0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re4a3sXSt1jarBPX8ZEPxoUqhbxRA/mo/photo.jpg?sz=128", "display_name": "Idan Reed", "link": "https://stackoverflow.com/users/11639540/idan-reed"}, "reply_to_user": {"reputation": 8286, "user_id": 533037, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f711473fb27cd269ba5ad2064c15dcd3?s=128&d=identicon&r=PG", "display_name": "solidpixel", "link": "https://stackoverflow.com/users/533037/solidpixel"}, "edited": false, "score": 0, "creation_date": 1560958517, "post_id": 56660109, "comment_id": 99910221, "body": "I believe it isn&#39;t used for new projects, but unfortunately there is far too much dependent on it and too little reason to switch old projects from it (where I work)"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1560974480, "post_id": 56660109, "comment_id": 99917387, "body": "ads 1.2 produced much tighter code than gcc back then and gcc really has not improved much, isnt really a compiler for performance but more of a generic many targets compiler.   if ADS 1.2 is free and doesnt need a license its probably a good compiler for 32 bit arm instruction development.  thumb mode?  well its the original which is very portable.  no thumb2 extensions.   as far as your question  I dont work that way so wouldnt know how to do that on any compiler much less this one..."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1560974548, "post_id": 56660109, "comment_id": 99917423, "body": "granted back then I was using dhrystone, and benchmarks are BS in general because they are so easy to manipulate the results.   so I would have to spend time again, against llvm/clang and gnu to see how they stack up..."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 11639540, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V1r5wWFkLq0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re4a3sXSt1jarBPX8ZEPxoUqhbxRA/mo/photo.jpg?sz=128", "display_name": "Idan Reed", "link": "https://stackoverflow.com/users/11639540/idan-reed"}, "edited": false, "score": 0, "creation_date": 1560958832, "post_id": 56662623, "comment_id": 99910386, "body": "It does look like some of the processors I&#39;m working with do have the ability for ETM tracing. I do worry that using it would end up requiring a lot of work when (ideally) the profiling needs work across quite a few different processors. That&#39;s definitely something I will look into more and thanks for the help"}], "tags": [], "owner": {"reputation": 1469, "user_id": 2105592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0660c06174e5479ed2c6dcda818d0f?s=128&d=identicon&r=PG", "display_name": "Sean Houlihane", "link": "https://stackoverflow.com/users/2105592/sean-houlihane"}, "is_accepted": false, "score": 1, "last_activity_date": 1560930635, "creation_date": 1560930635, "answer_id": 56662623, "question_id": 56660109, "link": "https://stackoverflow.com/questions/56660109/ads-1-2-c-compiler-instrumentation-option/56662623#56662623", "title": "ADS 1.2 C compiler instrumentation option", "body": "<p>I don't think there is any better documentation (but legacy toolchains is not my area). </p>\n\n<p>Yes, the compiler is 2001 vintage. I think you're more likely to have success looking at ETM trace for non-intrusive profiling. At the time of this toolchain, there was not the spare CPU capacity in the target application areas to be able to afford software instrumentation. This use case is one of the target applications of ETM, and you ought to be able to build up the right sort of analysis using modern tools (since the architecture for this is reasonably standardised).</p>\n\n<p>It does rely on your hardware having ETM in the silicon, and a suitable trace capture port or embedded trace buffer.</p>\n"}], "owner": {"reputation": 73, "user_id": 11639540, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V1r5wWFkLq0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re4a3sXSt1jarBPX8ZEPxoUqhbxRA/mo/photo.jpg?sz=128", "display_name": "Idan Reed", "link": "https://stackoverflow.com/users/11639540/idan-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1560958350, "creation_date": 1560918829, "last_edit_date": 1560958350, "question_id": 56660109, "link": "https://stackoverflow.com/questions/56660109/ads-1-2-c-compiler-instrumentation-option", "title": "ADS 1.2 C compiler instrumentation option", "body": "<p>I'm attempting to add instrumenting/profiling calls to C source. Many compilers I have found have flags that let you do this (--gnu_instrument, -finsturment-functions, etc). Then you provide the definitions for the inserted function calls. From there you can do cool stuff with the resulting call graph and whatever metrics you decide to pull from the profiling calls.</p>\n\n<p>I'm however needing to instrument code compiled with ADS 1.2</p>\n\n<p><a href=\"https://developer.arm.com/tools-and-software/embedded/legacy-tools/rvds-and-ads\" rel=\"nofollow noreferrer\">Installer here</a></p>\n\n<p>(source is built with \\ARM\\ADSv1_2\\Bin\\armcc.exe)</p>\n\n<p><a href=\"http://infocenter.arm.com/help/topic/com.arm.doc.dui0067d/DUI0067.pdf\" rel=\"nofollow noreferrer\">Docs</a></p>\n\n<p>To be honest this compiler feels quite old to me and I'm having trouble finding much useful information. What I really want is just an entirely complete list of compiler options to check through, but I must be missing it. (The linked docs feels incomplete as far as options go)</p>\n\n<p>I did stumble upon using -instrument as an option which, while giving no errors (when an obviously bad flags does, -asdf), has no effect on the generated assembly when using -S. But I haven't been able to find -instrument in any docs or help menus so I could just be using it incorrectly. Or I suppose it could be a feature that was dropped but still lets you compile without errors, I really have no idea.</p>\n\n<p>If anyone has experience with this compiler or is just a better Google-er any help would be appreciated</p>\n"}, {"tags": ["c", "assembly", "elf", "memory-alignment", "objdump"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1560916957, "post_id": 56659867, "comment_id": 99889116, "body": "Why was this tagged NASM?  I&#39;m not aware of any C compilers that compile into NASM syntax."}, {"owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1560917059, "post_id": 56659867, "comment_id": 99889134, "body": "Sorry, mate, I really do not think you have. I checked only to have more visibility, in case someone program in assembly for the nasm monator, but anyway, I will remove."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1560917139, "post_id": 56659867, "comment_id": 99889141, "body": "Anyway, <code>alignof(char) == 1</code> and compilers don&#39;t choose to give extra alignment for string literals.  So you get no required alignment (<code>2</code> to the power <code>0</code> = <code>1</code> ) for alignment of that ELF section."}, {"owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1560918187, "post_id": 56659867, "comment_id": 99889314, "body": "Thanks for the answer, I think I&#39;ll have to study about memory alignment a bit more"}], "owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560916991, "creation_date": 1560916841, "last_edit_date": 1560916991, "question_id": 56659867, "link": "https://stackoverflow.com/questions/56659867/what-is-align-in-memory-sections-of-an-object-file", "title": "What is align in memory sections of an object file?", "body": "<p>I was using objdump here, and using the -x flag, I saw that the sections were with some 2 ** 0. What would somebody be? Has any practical effect on this align</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char *x = \"section\"; // .rodata algn 2**0 \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1560915294, "post_id": 56659654, "comment_id": 99888815, "body": "it doesn&#39;t matter whether you swap from start to end or from end to start"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1560915443, "post_id": 56659654, "comment_id": 99888840, "body": "This is wrong though: <code>int temp[n]; temp[n]=a[j];</code>. You are indexing <code>temp</code> out of bounds. You don&#39;t need a temp array to swap two ints. A temp int will suffice."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1560915784, "post_id": 56659654, "comment_id": 99888916, "body": "See <a href=\"https://en.wikipedia.org/wiki/Bubble_sort\" rel=\"nofollow noreferrer\">Bubblesort - wikipedia</a> and the external link <a href=\"https://www.scss.tcd.ie/publications/tech-reports/reports.05/TCD-CS-2005-57.pdf\" rel=\"nofollow noreferrer\">Sorting in the Presence of Branch Prediction and Caches</a> for an in-depth discussion of sort algorithms."}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1560915795, "post_id": 56659654, "comment_id": 99888917, "body": "ah yeah, made a mistake there. my bad. i just corrected that"}], "answers": [{"tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 2, "last_activity_date": 1560915993, "last_edit_date": 1560915993, "creation_date": 1560915298, "answer_id": 56659681, "question_id": 56659654, "link": "https://stackoverflow.com/questions/56659654/can-there-be-more-than-one-program-for-bubblesort/56659681#56659681", "title": "Can there be more than one program for bubblesort?", "body": "<p>At first glance, yes, barring subtle bugs, both of these are bubble sorts. There's nothing special about which way the bubbling goes; most implementations bubble \"up\" from left to right, but there is no hard and fast rule that bans bubbling \"down\" from right to left.</p>\n\n<p>As a general rule, if the question is \"Is there more than one way to do it?\", in programming, the answer is \"Yes\".</p>\n"}, {"tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1560923396, "last_edit_date": 1560923396, "creation_date": 1560916152, "answer_id": 56659787, "question_id": 56659654, "link": "https://stackoverflow.com/questions/56659654/can-there-be-more-than-one-program-for-bubblesort/56659787#56659787", "title": "Can there be more than one program for bubblesort?", "body": "<p>What you have there is not Bubble Sort. Bubble Sort looks like this:</p>\n\n<pre><code>do {\n   sorted = true\n   sweep through the array, swapping adjacent elements into sorted order\n   if we swap any elements, set sorted = false\n} while (sorted == false)\n</code></pre>\n\n<p>The true Bubble Sort doesn't have an outer limit with a fixed number of iterations, and it doesn't have an inner loop that performs fewer operations with increasing numbers of iterations of the outer loop.  Yes; those design aspects are silly, but that's what Bubble Sort is.</p>\n\n<p>There is a more serious algorithm related to Bubble Sort called Insertion Sort. Insertion sort is this:</p>\n\n<pre><code>dest_array = []   // start with empty destination array\nfor each element in source_array\n   insert element at appropriate spot in dest_array\n</code></pre>\n\n<p>Insertion Sort can be implemented within a single array. Originally the entire array consists of source_array[] and dest_array[] is a zero-length area at the end of source_array[]:</p>\n\n<pre><code>[...source_array...][] &lt;- dest array\n</code></pre>\n\n<p>. We begin the sort by removing an element <em>e</em> of source_array[] right at the boundary where dest_array[] starts:</p>\n\n<pre><code>[...source_array...][e][]   &lt;- [e] is removed from source_array\n\n[...source_array...][   ]   &lt;- dest_array acquires an empty spot\n\n[...source-array...][e]     &lt;- [e] is inserted into dest_array, in order\n</code></pre>\n\n<p>We keep repeating this: <code>source_array</code> keeps shrinking, and the sorted <code>dest_array</code> grows, until it takes up the entire space.</p>\n\n<p>Insertion Sort has a structure resembling your code: a triangular iteration with an outer loop that has a fixed number of iterations corresponding to the  number of elements, and an inner loop which gets longer (since <code>dest_array</code> grows longer). Inserting each element into the correct spot in <code>dest_array</code> can be carried out by a series of swaps of adjacent elements.</p>\n\n<p><strong>What you have implemented is called Selection Sort.</strong> You're repeatedy selecting the highest (or lowest) element of the remaining <code>source_array</code> partition and moving it to the end, thereby building up the <code>dest_array</code> partition in order.  You have two variations of Selection Sort: repeatedly moving the highest element into the upper partition, or repeatedly moving the lowest item into a lower partition. Either way, that upper or lower partition will take over the entire array, leaving it sorted.</p>\n\n<p>Selection Sort, Insertion Sort and Bubble Sort are distinct algorithms. Bubble Sort is a kind of joke on the other two. There is never any reason to implement Bubble Sort instead of Selection or Insertion sort. These two are respectable: they have their uses, like sorting a small number of things in a tiny space. (Say you had to sort some small table of values in a tiny piece of boot loader machine code or whatever.)</p>\n"}], "owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 56659681, "answer_count": 2, "score": 0, "last_activity_date": 1560923396, "creation_date": 1560915092, "last_edit_date": 1560915925, "question_id": 56659654, "link": "https://stackoverflow.com/questions/56659654/can-there-be-more-than-one-program-for-bubblesort", "title": "Can there be more than one program for bubblesort?", "body": "<p>okay so i am working with different sorting methods in C.\nthe most basic one is \"Bubble Sort\"\nSo the basic definition of bubble sort is swapping two consecutive boxes in an array depending upon which way you want to sort them.\nthere are a total of \"n elements\" that are checked to swap \"n-1\" times and the compiler runs the function one more time in the end to check if the sorting is done correctly so the time complexity is O(n^2).</p>\n\n<p>while making the program, i figured that this type of sorting can be done in two ways. My questions are:-</p>\n\n<blockquote>\n  <p>If the Both of the program can be considered bubble sort?\n  if Not then why?\n  I think the time complexity in both the cases is same. If i am wrong, Why?</p>\n</blockquote>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n        int n;\n        printf(\"Enter the size of Array: \");\n        scanf(\"%d\",&amp;n);\n        int a[n];\n        int i;\n        printf(\"Enter The Elements Of Array:\\n\");\n        for(i=0;i&lt;n;i++)\n        {\n                scanf(\"%d\",&amp;a[i]);\n        }\n        for(i=0;i&lt;n;i++)\n        {\n                int j;\n                for(j=n-1;j&gt;i;j--)\n                {\n                        if (a[j] &lt; a[j-1])\n                        {\n                                int temp;\n                                temp=a[j];\n                                a[j]=a[j-1];\n                                a[j-1]=temp;\n                        }\n                }\n        }\n        printf(\"\\n\\nSorted Array Is:  \");\n        for(i=0;i&lt;n;i++)\n        {\n                printf(\"%d  \",a[i]);\n        }\n        printf(\"\\n\");\n        return 0;\n}\n</code></pre>\n\n<p>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n        int n;\n        printf(\"Enter The Size Of Array: \");\n        scanf(\"%d\",&amp;n);\n        int a[n],i;\n        printf(\"Enter The Elements Of Array:\\n\");\n        for(i=0;i&lt;n;i++)\n        {\n                scanf(\"%d\",&amp;a[i]);\n        }\n        int temp;\n        for(i=0;i&lt;n-1;i++)\n        {\n                int j;\n                for(j=0;j&lt;n-i-1;j++)\n                {\n                        if(a[j]&gt;a[j+1])\n                        {\n                                temp=a[j];\n                                a[j]=a[j+1];\n                                a[j+1]=temp;\n                        }\n                }\n        }\n        printf(\"Sorted Array Is: \");\n        for(i=0;i&lt;n;i++)\n        {\n                printf(\"%d  \", a[i]);\n        }\n        printf(\"\\n\");\n        return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>In The First Program, The swapping is taking place from the end part.\n  The Bigger number is being pushed to the front one by one.\n  In the Second Program, The Swapping is taking place from the front.\n  The Smaller number is being pushed towards the end one by one</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560914254, "post_id": 56659539, "comment_id": 99888610, "body": "The C standard specifically states that: <code>fflush(stdin);</code>  is undefined behavior"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1560914577, "post_id": 56659539, "comment_id": 99888670, "body": "regarding: <code>scanf(&quot;%s&quot;, &amp;word);</code>  This causes the compiler to output the message: &quot;untitled.c:13:13: warning: format \u2018%s\u2019 expects argument of type \u2018char <i>\u2019, but argument 2 has type \u2018char (</i>)[20]\u2019 [-Wformat=]&quot;  to fix this, use: <code>scanf(&quot;%s&quot;, word);</code>  this is related to the fact that referencing an array name degrades to the address of the first byte of the array.   Also,  1)  always check the returned value (not the parameter values) to assure the operation was successful.  Note: the <code>scanf()</code> family of functions returns the number of successful input format conversions  (cont)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560914885, "post_id": 56659539, "comment_id": 99888733, "body": "(cont)  2) when using the format specifiers &#39;%s&#39; and/or &#39;%[...]&#39;  always include a MAX CHARACTERS modifier that is one less than the length of the input buffer because they always append a NUL byte to the input.  This also avoids any possibility of a buffer overflow and the resulting undefined behavior.  Suggest:  if( scanf(&quot;%s&quot;, &amp;word) != 1 ) { fprintf( stderr, &quot;scanf to input word failed\\n&quot; );`  Such a statement will usually be followed by &#39;cleanup&#39; and <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1560914953, "post_id": 56659539, "comment_id": 99888746, "body": "@user3629249 - you are right on the standard and <code>fflush(stdin)</code>, but the code contains <code>conio.h</code> - so, you can guess what MS allows as an <i>extension</i> to the C standard. See <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/fflush?view=vs-2019\" rel=\"nofollow noreferrer\">MS-docs <code>fflush</code></a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560914972, "post_id": 56659539, "comment_id": 99888750, "body": "the languages &#39;C&#39; and &#39;C++&#39; are two different languages.  Per the posted code, it is for the &#39;C&#39; language, so suggest removing the &#39;c++&#39; tag"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1560915073, "post_id": 56659539, "comment_id": 99888771, "body": "@DavidC.Rankin, The header file: <code>conio.h</code> is not what allows the <code>fflush( stdin )</code>  Rather the visual studio compiler allows it"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1560915128, "post_id": 56659539, "comment_id": 99888782, "body": "The reference to <code>conio.h</code> was to imply compiling on windows (with the VS compiler, <code>cl.exe</code>)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1560915155, "post_id": 56659539, "comment_id": 99888787, "body": "<code>strcpy(smallest_word, word);         smallest = strcmp(word, smallest_word);     }</code> is same as <code>strcpy(smallest_word, word);         smallest = 0;  }</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1560915444, "post_id": 56659539, "comment_id": 99888841, "body": "babySteps, Post input used, output seen and expected.  Without that, your post is unnecessarily unclear."}, {"owner": {"reputation": 39, "user_id": 11003835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NjxUzU4BOxY/AAAAAAAAAAI/AAAAAAAAABQ/3DvBTGCm_r8/photo.jpg?sz=128", "display_name": "babySteps", "link": "https://stackoverflow.com/users/11003835/babysteps"}, "edited": false, "score": 0, "creation_date": 1560915447, "post_id": 56659539, "comment_id": 99888843, "body": "bruh this is semantics, i need help with the actual logic of the program @everyone"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560915714, "post_id": 56659539, "comment_id": 99888897, "body": "on stackoverflow.com.  when asking a question about a run time problem, as this code is doing, you need to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>  Otherwise the question is &#39;off topic&#39;.  So it is not &#39;semantics&#39; but rather a requirement of the web site"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560916402, "post_id": 56659539, "comment_id": 99889015, "body": "regarding: <code>count++;</code>  This is executed every time through the loop, so in ~2gig words it will overflow.  in C, overflow of a signed integer is undefined behavior.  Lets&#39; not take that risk.  Suggest moving that statement to inside the <code>if()</code> that checks if the variable is 0"}, {"owner": {"reputation": 39, "user_id": 11003835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NjxUzU4BOxY/AAAAAAAAAAI/AAAAAAAAABQ/3DvBTGCm_r8/photo.jpg?sz=128", "display_name": "babySteps", "link": "https://stackoverflow.com/users/11003835/babysteps"}, "edited": false, "score": 0, "creation_date": 1560919208, "post_id": 56659539, "comment_id": 99889524, "body": "can anyone help?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11003835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NjxUzU4BOxY/AAAAAAAAAAI/AAAAAAAAABQ/3DvBTGCm_r8/photo.jpg?sz=128", "display_name": "babySteps", "link": "https://stackoverflow.com/users/11003835/babysteps"}, "edited": false, "score": 0, "creation_date": 1560919233, "post_id": 56659714, "comment_id": 99889530, "body": "doesnt help much"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 39, "user_id": 11003835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NjxUzU4BOxY/AAAAAAAAAAI/AAAAAAAAABQ/3DvBTGCm_r8/photo.jpg?sz=128", "display_name": "babySteps", "link": "https://stackoverflow.com/users/11003835/babysteps"}, "edited": false, "score": 0, "creation_date": 1561005647, "post_id": 56659714, "comment_id": 99924362, "body": "neither the OPs code nor my answer are actually trying to sort the strings.  They are only trying to determine which string is earliest (and latest) alphabetically  The main problem with the OPs code is trying to compare the return value from <code>strcmp()</code> to anything other than &gt; 0, =0, &lt;0"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1560915557, "creation_date": 1560915557, "answer_id": 56659714, "question_id": 56659539, "link": "https://stackoverflow.com/questions/56659539/sorting-strings-largest-and-smallest/56659714#56659714", "title": "sorting strings largest and smallest", "body": "<p>regarding:</p>\n\n<pre><code>if (strcmp(word, smallest_word)&lt;smallest)\n</code></pre>\n\n<p>and</p>\n\n<p>if (strcmp(word, largest_word) > longest)</p>\n\n<p><code>strcmp()</code>  returns 0 or >0 or &lt;0.   It does not return a pointer to anything.  a returned value &lt;0 indicates that the first parameter comes alphabetically before the second parameter.  A returned value of 0 indicates the two parameters are equal.  A returned value of >0 indicates the first parameter comes alphabetically after the second parameter.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11668291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d507e656ce0aaa0534203d52430b426?s=128&d=identicon&r=PG&f=1", "display_name": "Doctorcode", "link": "https://stackoverflow.com/users/11668291/doctorcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1560925518, "creation_date": 1560925518, "answer_id": 56661291, "question_id": 56659539, "link": "https://stackoverflow.com/questions/56659539/sorting-strings-largest-and-smallest/56661291#56661291", "title": "sorting strings largest and smallest", "body": "<p>You can see the size of a string using <code>strlen()</code> from <code>string.h</code> library.</p>\n"}, {"tags": [], "owner": {"reputation": 395, "user_id": 6429769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87265877325905c20a26eb327351fa44?s=128&d=identicon&r=PG", "display_name": "Rishabh Ryber", "link": "https://stackoverflow.com/users/6429769/rishabh-ryber"}, "is_accepted": false, "score": 1, "last_activity_date": 1560928137, "creation_date": 1560928137, "answer_id": 56661923, "question_id": 56659539, "link": "https://stackoverflow.com/questions/56659539/sorting-strings-largest-and-smallest/56661923#56661923", "title": "sorting strings largest and smallest", "body": "<p>Both your logic and syntax have some problems. </p>\n\n<p>Here strcmp(src,dst) returns 0 if both strings are same else some positive or negative number when src>dst and dst>src respectively. </p>\n\n<p>And scanf() needs address of variable and array name itself gives the address of 1st element of the array so no need of using '&amp;'.</p>\n\n<p>And for logic part, you should continue the loop after increasing the value to avoid extra confusion and comparisons.</p>\n\n<pre><code>  if (count == 0)\n{\n    strcpy(smallest_word, word);\n    strcpy(largest_word, word);\n}\n</code></pre>\n\n<p>And there is no need of variables longest and smallest as instead of them both you can use zero.</p>\n\n<p>The completely working code I edited for you is </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;conio.h&gt;\n\nint main()\n{\nint finish = 0, longest=0, smallest=0, count =0;\nchar word[20], smallest_word[20], largest_word[20];\nwhile (0 == finish)\n{\n    printf(\"enter word:\\t\");\n    scanf(\"%s\", word);\n    if (count == 0)\n    {\n        strcpy(smallest_word, word);\n        strcpy(largest_word, word);\n        count++;\n        continue;   //To ensure in first time loop ends here \n    }\n\n\n    if (strcmp(word, smallest_word)&lt;0)\n        strcpy(smallest_word, word);\n    else if (strcmp(word, largest_word) &gt; 0)\n        strcpy(largest_word, word);\n\n\n\n    if (strlen(word) == 4)\n    {\n        finish++;\n    }\n    count++;\n}\nprintf(\"smallest word: %s\\n\", smallest_word);\nprintf(\"largest word: %s\\n\", largest_word);\n\ngetch();\nreturn 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/n3AiQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n3AiQ.png\" alt=\"Screenshot of output ::\"></a></p>\n\n<p>Happy Coding :)</p>\n"}, {"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1560930969, "creation_date": 1560930969, "answer_id": 56662703, "question_id": 56659539, "link": "https://stackoverflow.com/questions/56659539/sorting-strings-largest-and-smallest/56662703#56662703", "title": "sorting strings largest and smallest", "body": "<p>The header file <code>conio.h</code> and its <code>getch()</code> are not part of standard C and you should probably avoid using them.<br>\nSee <a href=\"https://stackoverflow.com/questions/36582070/why-is-getch-not-portable\">Why is getch not portable?</a> and <a href=\"https://stackoverflow.com/questions/21329485/why-must-we-refrain-from-using-conio-h-is-it-obsolete\">Why must we refrain from using conio.h? Is it obsolete?</a>.</p>\n\n<hr>\n\n<p>Your loop seem to go on till the user enters a word of length exactly 4. No need to use a separate variable like <code>finish</code> for it. Just use a <code>break</code> statement. <br>\nie, instead of </p>\n\n<pre><code>if (strlen(word) == 4)\n{\n    finish++;\n}\n</code></pre>\n\n<p>do</p>\n\n<pre><code>if (strlen(word) == 4)\n{\n    break;\n}\n</code></pre>\n\n<p>and you can get rid of that <code>finish</code> variable.</p>\n\n<hr>\n\n<p><code>scanf()</code> expects pointers to buffers where the scanned input need be stored as parameters after the format string. With </p>\n\n<pre><code>scanf(\"%s\", &amp;word);\n</code></pre>\n\n<p>you are giving pointer to a pointer as <code>word</code> itself is a pointer since array names in C decay into pointers to their first element. So <code>word</code> by itself points to the first character stored in the <code>word[]</code> array.</p>\n\n<p>Use </p>\n\n<pre><code>scanf(\"%19s\", &amp;word);\n</code></pre>\n\n<p>instead. 19 is the width specifier. 19 was chosen since the size of <code>word</code> is <code>20</code> and we need <code>1</code> character space to store the <code>\\0</code> denoting the end of string. This can help avoid buffer overflow.</p>\n\n<p>You may also want to check the return value of <code>scanf()</code>. It returns the number of successful assigments like</p>\n\n<pre><code>if( scanf(\"%19s\", &amp;word)!=1 ) {\n    //Something went wrong.\n}\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/53332187/what-happens-if-i-use-with-string-in-scanf-function\">What happens if I use &quot;&amp;&quot; with string in scanf function?</a>.</p>\n\n<hr>\n\n<p>Usage of <code>fflush()</code> on <code>stdin</code> leads to undefined behaviour in C as it is meant to be used only on output streams. See <a href=\"https://stackoverflow.com/questions/2979209/using-fflushstdin\">Using fflush(stdin)</a>.</p>\n\n<hr>\n\n<p><a href=\"https://en.cppreference.com/w/c/string/byte/strcmp\" rel=\"nofollow noreferrer\"><code>strcmp()</code></a> just returns a negative number if the first argument is lesser than the second and a positive number if first argument is greater than the other. These numbers could be anything. You need not save the return value of <code>strcmp()</code>.</p>\n\n<p>So instead of </p>\n\n<pre><code>if (strcmp(word, smallest_word)&lt;smallest)\n{\n    strcpy(smallest_word, word);\n    smallest = strcmp(word, smallest_word);\n}\nif (strcmp(word, largest_word) &gt; longest)\n{\n    strcpy(largest_word, word);\n    longest = strcmp(word, largest_word);\n}\n</code></pre>\n\n<p>do</p>\n\n<pre><code>if (strcmp(word, smallest_word) &lt; 0)\n{\n    strcpy(smallest_word, word);\n}\n\nif (strcmp(word, largest_word) &gt; 0)\n{\n    strcpy(largest_word, word);\n}\n</code></pre>\n\n<hr>\n\n<p>So, you could change the program to</p>\n\n<pre><code>char word[20], smallest_word[20], largest_word[20];\nfor(int count=0; ; ++count)\n{\n    printf(\"enter word:\");\n    scanf(\"%19s\", word);\n    if (count == 0)\n    {\n        strcpy(smallest_word, word);\n        strcpy(largest_word, word);\n    }\n\n    if (strcmp(word, smallest_word) &lt; 0)\n    {\n        strcpy(smallest_word, word);\n    }\n\n    if (strcmp(word, largest_word) &gt; 0)\n    {\n        strcpy(largest_word, word);\n    }\n\n    if (strlen(word) == 4)\n    {\n        break;\n    }\n}\nprintf(\"smallest word: %s\\n\", smallest_word);\nprintf(\"largest word: %s\\n\", largest_word);\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11003835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NjxUzU4BOxY/AAAAAAAAAAI/AAAAAAAAABQ/3DvBTGCm_r8/photo.jpg?sz=128", "display_name": "babySteps", "link": "https://stackoverflow.com/users/11003835/babysteps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 56662703, "answer_count": 4, "score": 0, "last_activity_date": 1560930969, "creation_date": 1560914032, "last_edit_date": 1560915232, "question_id": 56659539, "link": "https://stackoverflow.com/questions/56659539/sorting-strings-largest-and-smallest", "title": "sorting strings largest and smallest", "body": "<p>i cant get the program to properly sort the strings into largest and smallest of all the user inputs</p>\n\n<p>im having issues with the if statements and how they are recording the smallest and largest</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;conio.h&gt;\n\nint main()\n{\nint finish = 0, longest=0, smallest=0, count =0;\nchar word[20], smallest_word[20], largest_word[20];\nwhile (0 == finish)\n{\n    printf(\"enter word:\");\n    fflush(stdin);\n    scanf(\"%s\", &amp;word);\n    if (count == 0)\n    {\n        strcpy(smallest_word, word);\n        strcpy(largest_word, word);\n    }\n\n\n    if (strcmp(word, smallest_word)&lt;smallest)\n    {\n        strcpy(smallest_word, word);\n        smallest = strcmp(word, smallest_word);\n    }\n    if (strcmp(word, largest_word) &gt; longest)\n    {\n        strcpy(largest_word, word);\n\n        longest = strcmp(word, largest_word);\n\n    }\n\n\n    if (strlen(word) == 4)\n    {\n        finish++;\n    }\n    count++;\n}\nprintf(\"smallest word: %s\\n\", smallest_word);\nprintf(\"largest word: %s\\n\", largest_word);\n\ngetch();\nreturn 0;\n}\n</code></pre>\n\n<p>program runs just doesn't record the largest and smallest values correctly</p>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1560914485, "post_id": 56659536, "comment_id": 99888655, "body": "You can&#39;t. However this is C++, not C, isn&#39;t it? In C++ you can use a function template."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1560914587, "post_id": 56659536, "comment_id": 99888673, "body": "You will have to cast it, there&#39;s no other way. Sure, the whole point of using such a pointer is that it&#39;s generic, but it&#39;s generic to the user - someone somewhere eventually has to write the code which allows it to be generic."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1560914726, "post_id": 56659536, "comment_id": 99888697, "body": "@immibis: Nothing in this code precludes it from being C (other than the obvious dereference of the pointer to <code>void</code> which isn&#39;t valid C++ either)."}, {"owner": {"reputation": 121, "user_id": 10309689, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o2OtDmI0hoo/AAAAAAAAAAI/AAAAAAAAJWo/4HwaGFTZKrA/photo.jpg?sz=128", "display_name": "Alex Stiles", "link": "https://stackoverflow.com/users/10309689/alex-stiles"}, "edited": false, "score": 0, "creation_date": 1560914756, "post_id": 56659536, "comment_id": 99888707, "body": "It&#39;s C++ (Arduino IDE, so C++ with lots of extra libraries), but I am trying to only use C."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1560914759, "post_id": 56659536, "comment_id": 99888710, "body": "@PaulGriffiths &quot;Serial.println&quot; plus the fact I happen to already know the Arduino IDE uses C++."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1560914761, "post_id": 56659536, "comment_id": 99888711, "body": "Note that <code>void*</code> is not a completely generic pointer as it may be insufficient  to encode a function pointer."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1560914843, "post_id": 56659536, "comment_id": 99888723, "body": "@immibis: <code>Serial.println()</code> can be perfectly valid C, but fair enough if you specifically recognize the interface."}, {"owner": {"reputation": 121, "user_id": 10309689, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o2OtDmI0hoo/AAAAAAAAAAI/AAAAAAAAJWo/4HwaGFTZKrA/photo.jpg?sz=128", "display_name": "Alex Stiles", "link": "https://stackoverflow.com/users/10309689/alex-stiles"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1560916620, "post_id": 56659536, "comment_id": 99889052, "body": "@PaulGriffiths How could that be valid C? That to me (not knowing C++, but python), looks like a method operating on an object? What does this mean in C? I would assume it is a function member of a struct named &quot;Serial&quot; but I didn&#39;t know you could have struct function members?"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1560919540, "post_id": 56659536, "comment_id": 99889590, "body": "@AlexStiles structs in C can have members that are function pointers (e.g. <code>typedef struct pstring_t {     char * chars;     int (* length)(); } PString;</code>)"}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1560949143, "post_id": 56659536, "comment_id": 99904216, "body": "@AlexStiles: Exactly as @bigwillydos said. <code>Serial</code> could be a <code>struct</code> defined at file scope, with a couple of function pointer members."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 10309689, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o2OtDmI0hoo/AAAAAAAAAAI/AAAAAAAAJWo/4HwaGFTZKrA/photo.jpg?sz=128", "display_name": "Alex Stiles", "link": "https://stackoverflow.com/users/10309689/alex-stiles"}, "edited": false, "score": 0, "creation_date": 1560916825, "post_id": 56659650, "comment_id": 99889089, "body": "Is there a way I could try casting the void pointer to different types and seeing if it is &quot;successful&quot; or will it forcefully cast the pointer to that type?"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "reply_to_user": {"reputation": 121, "user_id": 10309689, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o2OtDmI0hoo/AAAAAAAAAAI/AAAAAAAAJWo/4HwaGFTZKrA/photo.jpg?sz=128", "display_name": "Alex Stiles", "link": "https://stackoverflow.com/users/10309689/alex-stiles"}, "edited": false, "score": 0, "creation_date": 1560919687, "post_id": 56659650, "comment_id": 99889617, "body": "@AlexStiles you can cast it to <code>int *</code>, <code>float *</code>, <code>double *</code>, <code>char *</code> but the problem is that if the size of what you cast it to is larger than the size of what the pointer was originally pointing to then you will be accessing memory outside of that variable and that could be very bad. I think the solution you&#39;re looking for is the <code>_Generic</code> keyword that was introduced in the C11 standard. Read more about it here: <a href=\"http://www.robertgamble.net/2012/01/c11-generic-selections.html\" rel=\"nofollow noreferrer\">robertgamble.net/2012/01/c11-generic-selections.html</a>"}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 1, "creation_date": 1560949737, "post_id": 56659650, "comment_id": 99904588, "body": "For the sake of completeness, it&#39;s not just the size that matters, but the representation too. An <code>int *</code> and a <code>float *</code>, for example, may both be 8 bytes in size themselves, and may both point to objects which are 4 bytes in size, but you&#39;re not going to be able to do anything with the pointed-to value unless you know which of the two underlying types it is, because until you know that you can&#39;t decide what the bits mean."}], "tags": [], "owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "is_accepted": true, "score": 3, "last_activity_date": 1560915058, "creation_date": 1560915058, "answer_id": 56659650, "question_id": 56659536, "link": "https://stackoverflow.com/questions/56659536/how-to-pass-pointer-of-unknown-type-to-function/56659650#56659650", "title": "How to pass pointer of unknown type to function?", "body": "<p>The answer is that you have to cast it despite not wanting to. You are trying to dereference a pointer which points to some memory location, but you aren't giving the compiler any semblance of what the size of that information is when it is <code>void *</code> so it has no way of translating that to the proper assembly instruction for accessing that memory.</p>\n"}], "owner": {"reputation": 121, "user_id": 10309689, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o2OtDmI0hoo/AAAAAAAAAAI/AAAAAAAAJWo/4HwaGFTZKrA/photo.jpg?sz=128", "display_name": "Alex Stiles", "link": "https://stackoverflow.com/users/10309689/alex-stiles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "accepted_answer_id": 56659650, "answer_count": 1, "score": 0, "last_activity_date": 1560915058, "creation_date": 1560914003, "question_id": 56659536, "link": "https://stackoverflow.com/questions/56659536/how-to-pass-pointer-of-unknown-type-to-function", "title": "How to pass pointer of unknown type to function?", "body": "<p>I want to pass a variable by value (I used pointers only to avoid giving the parameter a type) into a function so that it can be used by another function contained within. The inner function can be given a variable of any type. </p>\n\n<p>I have already tried using a generic pointer (void*) but it tells me that \"'void*' is not a pointer-to-object type\". I don't want to cast the pointer because the whole point of using a pointer is that it is generic.</p>\n\n<pre><code>void print_string(char *string, void *variable) {\n  Serial.print(string);\n  Serial.print(\": \");\n  Serial.print(*variable); # This takes a variable of any type (int, float, double, char *);\n  Serial.println();\n}\n</code></pre>\n\n<p>I want to be able to provide an int, double, float or string (char*).</p>\n"}, {"tags": ["c#", "c", "struct", "dllimport"], "comments": [{"owner": {"reputation": 657, "user_id": 3219115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Minijack", "link": "https://stackoverflow.com/users/3219115/minijack"}, "edited": false, "score": 2, "creation_date": 1560912240, "post_id": 56659269, "comment_id": 99888207, "body": "Can you show the C# Code that calls the C Function?"}], "owner": {"reputation": 21, "user_id": 3216752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75fbefb34930e22bea07c513e2e05e0?s=128&d=identicon&r=PG&f=1", "display_name": "phazer", "link": "https://stackoverflow.com/users/3216752/phazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560945021, "creation_date": 1560911413, "last_edit_date": 1560945021, "question_id": 56659269, "link": "https://stackoverflow.com/questions/56659269/importing-c-struct-to-c-program", "title": "Importing C struct to C# program", "body": "<h2>The Sctruct</h2>\n\n<p>I am not much of a C# or C programmer and have not found much guidance on specifying pointers and structs within a struct. I am attempting to import the following from a C dll into a C# program:</p>\n\n<pre><code>#define MAXFILENAME     259 \n\nstruct IDentry {\n    char* IDname;\n    int length;\n};\ntypedef struct IDentry idEntry;\n\n\nstruct SMOutputAPI {\n    char name[MAXFILENAME + 1];     \n    FILE* file;                     \n\n    struct IDentry *elementNames;   \n\n    long Nperiods;                  \n    int FlowUnits;                  \n\n    int Nsubcatch;                  \n    int Nnodes;                     \n    int Nlinks;                     \n    int Npolluts;                   \n\n    int SubcatchVars;               \n    int NodeVars;                   \n    int LinkVars;                   \n    int SysVars;                    \n\n    double StartDate;               \n    int    ReportStep;              \n\n    __int64 IDPos;                  \n    __int64 ObjPropPos;             \n    __int64 ResultsPos;               \n    __int64 BytesPerPeriod;           \n};\n</code></pre>\n\n<p>I am not sure how to handle the <code>*elementsNames</code>, <code>file</code> or <code>name</code> properties. What I have so far in C# is:</p>\n\n<pre><code>int MAXFILENAME = 259 \n\n[StructLayout(LayoutKind.Sequential)]\npublic struct SMOutputAPI\n{\n    [MarshalAs(UnmanagedType.ByValArray, SizeConst = MAXFILENAME+1)]\n    public string name;\n\n    IntPtr file;\n\n    IntPtr elementNames;\n\n    public long Nperiods;   \n    public int FlowUnits;   \n\n    public int Nsubcatch;   \n    public int Nnodes;      \n    public int Nlinks;      \n    public int Npolluts;    \n\n    public int SubcatchVars;\n    public int NodeVars;    \n    public int LinkVars;    \n    public int SysVars;     \n\n    public double StartDate;\n    public int ReportStep;  \n\n    public int IDPos;       \n    public int ObjPropPos;              \n    public int ResultsPos;              \n    public int BytesPerPeriod;          \n};\n</code></pre>\n\n<p>The C# application builds fine, but when I call the C initialization function that should return a new SMOutputAPI struct I get an error:</p>\n\n<pre><code>System.Runtime.InteropServices.MarshalDirectiveException \nMethod's type signature is not PInvoke compatible. \n</code></pre>\n\n<p>Any thoughts on how to properly specify this struct in C# would be much appreciated. Thanks!</p>\n\n<h2>Initializing the Struct</h2>\n\n<p>The struct is initialized in the c-code with:</p>\n\n<pre><code>SMOutputAPI* DLLEXPORT SMO_init(void)\n//\n//  Purpose: Returns an initialized pointer for the opaque SMOutputAPI\n//    structure.\n//\n{\n    SMOutputAPI *smoapi = malloc(sizeof(struct SMOutputAPI));\n    smoapi-&gt;elementNames = NULL;\n\n    return smoapi;\n}\n</code></pre>\n\n<p>The corresponding c# code is:</p>\n\n<pre><code>[DllImport(\"swmm-output.dll\")]\nstatic extern SMOutputAPI SMO_init();\n\n\nstatic void Main(string[] args)\n{\n    Console.Write(\"Hello World!\");\n\n    SMOutputAPI SMO = SMO_init();\n}\n</code></pre>\n"}, {"tags": ["c", "modulo", "128-bit"], "comments": [{"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 3, "creation_date": 1560911125, "post_id": 56659224, "comment_id": 99888025, "body": "Have you written <i>anything</i> so far?"}, {"owner": {"reputation": 1, "user_id": 11667622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e2c8bdde478302ec27fe478d0e8530?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11667622/mark"}, "reply_to_user": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1560912097, "post_id": 56659224, "comment_id": 99888184, "body": "I&#39;ve attempted the code from <a href=\"https://stackoverflow.com/a/20114154/11667622\">stackoverflow.com/a/20114154/11667622</a> but I couldn&#39;t figure out how to change the variables to structs and apply the shift logic to all 3 variables"}, {"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 1, "creation_date": 1560912288, "post_id": 56659224, "comment_id": 99888218, "body": "It seems to me you have not attempted anything yourself so far but continued scavenging code off of SO. So let&#39;s turn to another avenue. Do you understand how to go about implementing the two mod operations between given 3 numbers?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1560913711, "post_id": 56659224, "comment_id": 99888510, "body": "&quot;Perform a modulo expression x^e mod m when all 3 variables, x, \u0117, and m are all u128b structs&quot; --&gt; <a href=\"https://codereview.stackexchange.com/q/187257/29485\">Modular exponentiation without range restriction</a> uses C code and lays out how to do that without a wider type."}, {"owner": {"reputation": 1, "user_id": 11667622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e2c8bdde478302ec27fe478d0e8530?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11667622/mark"}, "edited": false, "score": 0, "creation_date": 1560913833, "post_id": 56659224, "comment_id": 99888526, "body": "So i know there&#39;s multiple ways - just Modulo exponentiation formula can help separate it out A^B mod C = ( (A mod C)^B ) mod C which might be easier to calculate, but with the sheer size of the bits and the structs cause a problem. Even reducing it down to 2 struct variables A mod C you have A.hi and A.lo and C.hi and C.lo. I wrote code that modulo&#39;d one side A.lo and just right shift bit by bit so A.hi would trickle right to A.lo but that was with the assumption C was uint64_t. I&#39;m not sure how to mod even a simple number by a large number 3 mod [128b struct]"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1560920897, "post_id": 56659224, "comment_id": 99889850, "body": "&quot;shifting bits across hi and lo?&quot; - well I guess you&#39;ll have to write a 128-bit shift function won&#39;t you?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1560924112, "post_id": 56659224, "comment_id": 99890815, "body": "<a href=\"https://www.google.com/search?q=github+128bit+opeartions\" rel=\"nofollow noreferrer\">google.com/search?q=github+128bit+opeartions</a> <a href=\"https://github.com/davidminor/uint128\" rel=\"nofollow noreferrer\">github.com/davidminor/uint128</a> <a href=\"https://github.com/calccrypto/uint128_t\" rel=\"nofollow noreferrer\">github.com/calccrypto/uint128_t</a> And <a href=\"https://github.com/maxwellsayles/liboptarith/blob/master/u128_c.h#L171\" rel=\"nofollow noreferrer\">this</a> looks ready to use library."}], "owner": {"reputation": 1, "user_id": 11667622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e2c8bdde478302ec27fe478d0e8530?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11667622/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560912054, "creation_date": 1560910966, "last_edit_date": 1560912054, "question_id": 56659224, "link": "https://stackoverflow.com/questions/56659224/how-do-you-modulo-128-bit-struts-in-c", "title": "How do you modulo 128 bit struts in c?", "body": "<p>I have a c struct as</p>\n\n<pre><code>typedef struct u128b {\n    uint64_t hi, \n    uint64_t lo\n} u128b\n</code></pre>\n\n<p>How would I perform a modulo expression x^e mod m when all 3 variables, x, \u0117, and m are all u128b structs?</p>\n\n<p>I've attempted to run the code from <a href=\"https://stackoverflow.com/a/20114154/11667622\">https://stackoverflow.com/a/20114154/11667622</a></p>\n\n<pre><code>u128b mul_mod(u128b a, u128b b, u128b m)\n{\n    if (m == 0)\n        return a * b;\n\n    u128b r = {0, 0};\n\n    while(a &gt; 0)\n    {\n        if (a &amp; 1)\n            if ((r += b) &gt; m) r %= m;\n        a &gt;&gt;= 1;\n        if ((b &lt;&lt;= 1) &gt; m) b %= m;\n    }\n    return r;\n}\n\n//https://stackoverflow.com/questions/20111827/various-questions-about-rsa-encryption/20114154#20114154\nu128b pow_mod(u128b base, u128b expon, u128b mod)\n{\n    u128b remainder = {0, 1};\n\n    while (expon &gt; 0) {\n        if (expon &amp; 1)\n            remainder = mul_mod(r, base, mod);\n        base = mul_mod(base, base, mod);\n        expon &gt;&gt;= 1;\n    }\n    return remainder;\n}\n</code></pre>\n\n<p>This works when all the parameters and variables are uint64_t but how would I apply this to two separate 64 bit variables hi and low for all 3 variables?\nshifting bits across hi and lo? and how would the modulo work with the hi and lo bits?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1560909518, "post_id": 56659087, "comment_id": 99887738, "body": "i figured out the logical error for the 2*2 matrix so that part is done. that error is at the part D=D1-D2+D3."}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1560909594, "post_id": 56659087, "comment_id": 99887750, "body": "i tried using recursion but i just can&#39;t get the (-/+) signs right."}, {"owner": {"reputation": 73, "user_id": 5503753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8383023ef31b2c0f36a1a31f31dfb6?s=128&d=identicon&r=PG&f=1", "display_name": "Abdul kareem", "link": "https://stackoverflow.com/users/5503753/abdul-kareem"}, "edited": false, "score": 2, "creation_date": 1560909706, "post_id": 56659087, "comment_id": 99887770, "body": "<a href=\"https://stackoverflow.com/questions/41384020/c-program-to-calculate-the-determinant-of-a-nxn-matrix\" title=\"c program to calculate the determinant of a nxn matrix\">stackoverflow.com/questions/41384020/&hellip;</a>"}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "reply_to_user": {"reputation": 73, "user_id": 5503753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8383023ef31b2c0f36a1a31f31dfb6?s=128&d=identicon&r=PG&f=1", "display_name": "Abdul kareem", "link": "https://stackoverflow.com/users/5503753/abdul-kareem"}, "edited": false, "score": 0, "creation_date": 1560909730, "post_id": 56659087, "comment_id": 99887772, "body": "also the program is working perfectly fine in case of a 3*3 matrix."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1560910663, "post_id": 56659087, "comment_id": 99887941, "body": "You do not have a recursive function in your given code. What work have you done towards recursion?"}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1560910982, "post_id": 56659087, "comment_id": 99887997, "body": "i only put up the working code. i tried using a recursive program on pen/paper first but i couldn&#39;t get it right"}], "owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560909467, "creation_date": 1560909467, "question_id": 56659087, "link": "https://stackoverflow.com/questions/56659087/to-find-the-determinant-of-a-user-defined-matrix-using-recursion", "title": "to find the determinant of a user defined matrix using recursion", "body": "<p>So i was hoping to make a C program to find the determinant of a \"user defined\" matrix. the matrix can be of any order (say 2*2 or 3*3 or 4*4.....n*n)\ni tried making a simple program to find the determinant of any 2*2 or 3*3 matrix\nthere are two things i need help with</p>\n\n<blockquote>\n  <p>correct the logical error in the program because the determinant of 2*2 matrix is wrong.\n  and add recursion to the program so we can find the determinant of an infinite matrix.</p>\n</blockquote>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n        int a,b;\n        printf(\"enter the rows and columns of matrix\\n\");\n        scanf(\"%d%d\",&amp;a,&amp;b);\n        int c[a][b];\n        printf(\"Enter Elements In The Matrix:\\n\");\n        for(int i=0;i&lt;b;i++)\n        {\n                for(int j=0;j&lt;a;j++)\n                {\n                        scanf(\"%d\",&amp;c[i][j]);\n                }\n        }\n        printf(\"\\nYour Matrix Is:\\n\");\n        for(int p=0;p&lt;b;p++)\n        {\n                for(int k=0;k&lt;a;k++)\n                {\n                        printf(\"%d\\t\",c[p][k]);\n                }\n                printf(\"\\n\\n\");\n        }\n        if(a==b)\n        {\n                printf(\"\\nDeterminent Of Marix Is: \");\n                int D1=0,D2=0,D3=0,D;\n                for(int n=0;n&lt;a;n++)\n                {\n                        for(int m=0;m&lt;b;m++)\n                        {\n                                if(n==0 &amp;&amp; m==0)\n                                {\n                                        D1=c[n][m]*(c[n+1][m+1]*c[n+2][m+2] - c[n+2][m+1]*c[n+1][m+2]);\n                                }\n                                if(n==0 &amp;&amp; m==1)\n                                {\n                                        D2=c[n][m]*(c[n+1][m-1]*c[n+2][m+1] - c[n+2][m-1]*c[n+1][m+1]);\n                                }\n                                if(n==0 &amp;&amp; m==2)\n                                {\n                                        D3=c[n][m]*(c[n+1][m-2]*c[n+2][m-1] - c[n+2][m-2]*c[n+1][m-1]);\n                                }\n                        } \n                }\n        D=D1-D2+D3;\n        printf(\"%d\\n\",D);\n        }\n else\n        {\n                printf(\"The Matrix Is Not A Square Matric So The \nDeterminent Cannot Be Calculated\\n\");\n        }\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1560898686, "post_id": 56658056, "comment_id": 99885822, "body": "Post all code here directly as text as an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1560899170, "post_id": 56658056, "comment_id": 99885930, "body": "Since the function return is type <code>void</code> you are not returning anything, so the only way you have of making any changes to parameters visible back in the calling function is to pass pointers as parameters and then update the values stored at those memory addresses within the function."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8973949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0e31e664be82ac4d6ab05538c60b46?s=128&d=identicon&r=PG&f=1", "display_name": "Aliasa Zarowny Pseudonymia", "link": "https://stackoverflow.com/users/8973949/aliasa-zarowny-pseudonymia"}, "edited": false, "score": 0, "creation_date": 1560899330, "post_id": 56658095, "comment_id": 99885956, "body": "Ah. good point! Just to be clear though, would you say that I have the right idea regarding input/output?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1560899421, "post_id": 56658095, "comment_id": 99885978, "body": "You have the right idea on your ability to update the values at the memory addresses passed by pointer so you can have those updated values back in the caller after the function returns -- which I take is your intent."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 57, "user_id": 8973949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0e31e664be82ac4d6ab05538c60b46?s=128&d=identicon&r=PG&f=1", "display_name": "Aliasa Zarowny Pseudonymia", "link": "https://stackoverflow.com/users/8973949/aliasa-zarowny-pseudonymia"}, "edited": false, "score": 1, "creation_date": 1560900149, "post_id": 56658095, "comment_id": 99886122, "body": "@AliasaZarownyPseudonymia Yes. The way you did it is a perfectly reasonable choice. I probably would have created a <code>struct</code> with three <code>double</code>s in it. But that&#39;s a matter of preference."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1560921494, "post_id": 56658095, "comment_id": 99890017, "body": "@David Schwartz I assume you think of returning the struct of 3 doubles? I would not say that is purely a matter of preference since returning the struct imposes a higher load on the stack than the OP&#39;s pointer version."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 0, "creation_date": 1560927428, "post_id": 56658095, "comment_id": 99892262, "body": "@GermanNerd How so? Returning a struct just means a hidden pointer is passed."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1560929787, "post_id": 56658095, "comment_id": 99893524, "body": "@melpomene AFAIK, in C structs are both passed and returned by value. Of course you can write the function to accept and return pointers, but you have to explicitly do so. So where is the &quot;hidden&quot; pointer?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 1, "creation_date": 1560970877, "post_id": 56658095, "comment_id": 99915871, "body": "@GermanNerd On e.g. x86(-64), return values are passed in <code>%eax</code> (<code>%rax</code>), not on the stack. A single register is not big enough for most structs. So what happens when you return a struct by value? The compiler silently rewrites your function <code>struct foo bar(...)</code> to take an extra output argument, a struct pointer (<code>void bar(struct foo *_ret, ...)</code>). Return statements in the function (<code>return x;</code>) become <code>*_ret = x; return;</code>. Any calls <code>x = bar(...)</code> are then rewritten as <code>bar(&amp;x, ...)</code>. <a href=\"https://godbolt.org/z/kZMUuW\" rel=\"nofollow noreferrer\">Live demo</a>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 0, "creation_date": 1560995508, "post_id": 56658095, "comment_id": 99922577, "body": "@GermanNerd I don&#39;t know what you mean by &quot;higher load on the stack&quot;. But it does seem to me that passing one pointer may be more efficient than three and, in any event, I trust the compiler/optimizer to do its job."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561051145, "post_id": 56658095, "comment_id": 99947393, "body": "@David Schwartz I had assumed that you suggested to <i>both</i> pass in a structure by value, as well as returning one. If, of course, you intended to just pass one pointer to such a structure as an in-out argument, that clearly is more efficient and might not even involve the stack."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1561051288, "post_id": 56658095, "comment_id": 99947463, "body": "@melpomene While what you say is true, it is 100% dependant both on the hardware architecture and the compiler implementation. When reasoning about source code in general (C strives to be hardware-agnostic) I would not consider that useful."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 0, "creation_date": 1561058078, "post_id": 56658095, "comment_id": 99950282, "body": "@GermanNerd His min/max/avg parameters are output only, so I would have the function return a <code>struct</code>. This might result in passing a hidden pointer to the function, but I&#39;d trust the compiler/optimizer to find the best way on my platform."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1561061023, "post_id": 56658095, "comment_id": 99951496, "body": "@David Schwartz Indeed, output only, thanks. That does not change much. Relying on optimizations seems to me more like the C++ frame of mind. When I look at C source code (without catering to a specific HW/OS setup), I try to think in the simplest possible machine terms conceivable or likely. Of course even the assumption that there might be something like a stack is unwarranted. But putting such assumptions on a scale, I&#39;d say that relying on a compiler to optimize the always feasible true memory usage, regardless of the implementation, with register usage instead is treading on thin ice."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 3, "last_activity_date": 1560898861, "creation_date": 1560898861, "answer_id": 56658095, "question_id": 56658056, "link": "https://stackoverflow.com/questions/56658056/is-there-anything-wrong-with-how-i-pass-pointer-arguments/56658095#56658095", "title": "Is there anything wrong with how I pass pointer arguments?", "body": "<p>Yes. My guess is that your instructor expected you to have three separate functions, one to find the lowest score, one to find the highest score, and one to find the average without the lowest and highest scores. This would allow each function to directly return a single result.</p>\n\n<pre><code>void returnfunc(float *low, float *average, float *high, float pointArray[],int judges)\n{\n    float small =pointArray[0];\n    float large =pointArray[0];\n    float total;\n\n    for(int i =0;i&lt;judges;i++){\n        if(small&gt;pointArray[i]){\n            small = pointArray[i];\n        }\n        if(large&lt;pointArray[i]){\n            large = pointArray[i];\n        }\n    }\n\n\n    for(int i = 0;i&lt;judges;i++){\n        total += pointArray[i];\n    }\n\n    *average = (total-(large+small))/(judges-2); //average without largest and smallest value\n    *high=large;\n    *low=small;\n}\n</code></pre>\n\n<p>One nitpick: Why do you iterate over the <code>pointArray</code> twice with two <code>for</code> loops when you could do everything in a single loop?</p>\n\n<p>One more nitpick: While <code>small&gt;pointArray[i]</code> means the same thing as <code>pointArray[i] &lt; small</code>, I think the latter better conveys the intent of the code.</p>\n\n<p>And one bug: You don't set <code>total</code> to zero before you start adding things to it. You could set <code>total</code> to <code>pointArray[0]</code> as well at the beginning and then start the loop at one.</p>\n"}, {"tags": [], "owner": {"reputation": 335, "user_id": 5177555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c85fc22daffc1d49bfc2ddaf3f0f861f?s=128&d=identicon&r=PG&f=1", "display_name": "slingeraap", "link": "https://stackoverflow.com/users/5177555/slingeraap"}, "is_accepted": false, "score": 0, "last_activity_date": 1560927067, "creation_date": 1560927067, "answer_id": 56661650, "question_id": 56658056, "link": "https://stackoverflow.com/questions/56658056/is-there-anything-wrong-with-how-i-pass-pointer-arguments/56661650#56661650", "title": "Is there anything wrong with how I pass pointer arguments?", "body": "<p>The constructor apparently remarks that it is unclear what is input and output of the function. This could be improved in the following ways:</p>\n\n<ul>\n<li>It is a widespread convention that in the function declaration, input parameters are listed first, then output parameters. In your example that order is reversed.</li>\n<li>When using pointers as parameters, they could be both an input parameter of pointer (or array) type, or an output parameter. Since the C syntax cannot make this discrimination unambiguously, another good practice is to add comments above the function declaration, explaining the role and purpose of all parameters.</li>\n</ul>\n\n<p>David Schwarz replies that he thinks your instructor may have expected multiple functions: one for the average, one for the low and one for the high point. From a performance point of view this does not seem attractive, since that would mean that all those functions must iterate over the points array, whilst one function could do it in one iteration. As already pointed out by others: your function could be improved by merging the two for loops into one.</p>\n"}], "owner": {"reputation": 57, "user_id": 8973949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0e31e664be82ac4d6ab05538c60b46?s=128&d=identicon&r=PG&f=1", "display_name": "Aliasa Zarowny Pseudonymia", "link": "https://stackoverflow.com/users/8973949/aliasa-zarowny-pseudonymia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560927067, "creation_date": 1560898594, "last_edit_date": 1560900841, "question_id": 56658056, "link": "https://stackoverflow.com/questions/56658056/is-there-anything-wrong-with-how-i-pass-pointer-arguments", "title": "Is there anything wrong with how I pass pointer arguments?", "body": "<p>The problem is not anything major, but I am unsure if I lack the knowledge to understand a specific comment given to me.</p>\n\n<p>This is part of a assigment where I have to use pointers. </p>\n\n<p>I recieved a comment from my instructor regarding a piece of code for the function <code>returnfunc</code> where  pointers are used. </p>\n\n<p>The comments reads as following: \"What input/output does the function have? The only  thing coming in is the judge points!\"</p>\n\n<p>I would ask for further clearifcation but the instructor is unavaible for the next 1-2 days. </p>\n\n<p>So instead of waiting I was hoping that somebody could take a look and maybe determine what is meant?</p>\n\n<p>The highlighted parts of the code is shown below:</p>\n\n<pre><code>//function declaration\nvoid returnfunc(float *low, float *average, float *high,  float array[],int judges);\n\n//calling function in the main function\nreturnfunc(&amp;low, &amp;average, &amp;high, pointArray,judges);\n\n\n//code for returnfunc function\nvoid returnfunc(float *low, float *average, float *high, float pointArray[],int judges){\n\n    float small =pointArray[0];\n    float large =pointArray[0];\n    float total;\n\n    for(int i =0;i&lt;judges;i++){\n        if(small&gt;pointArray[i]){\n            small = pointArray[i];\n        }\n        if(large&lt;pointArray[i]){\n            large = pointArray[i];\n        }\n    }\n\n\n    for(int i = 0;i&lt;judges;i++){\n        total += pointArray[i];\n    }\n\n    *average = (total-(large+small))/(judges-2); //average without largest and smallest value\n    *high=large;\n    *low=small;\n\n}\n</code></pre>\n\n<p><code>judges</code> is the amount of judges the user chooses.</p>\n\n<p><code>pointArray</code> is an array with the points given by each judge.</p>\n\n<p>My interpretation of the code is that the input is the adresses of <code>low</code>, <code>high</code> and <code>average</code> also the <code>pointArray</code> and  <code>judges</code>.</p>\n\n<p>The output would then be the updated varibles of <code>average</code>, <code>high</code> and <code>low</code></p>\n\n<p>Would you say that this is correct?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 335, "user_id": 11639518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHyIi.jpg?s=128&g=1", "display_name": "jhelphenstine", "link": "https://stackoverflow.com/users/11639518/jhelphenstine"}, "edited": false, "score": 0, "creation_date": 1560897353, "post_id": 56657850, "comment_id": 99885522, "body": "Is there a reason you don&#39;t fill ders when you fill variable and values? I&#39;m new to C as well, but I&#39;m wondering if you need to initialize ders before passing it to a function."}, {"owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 0, "creation_date": 1560897358, "post_id": 56657850, "comment_id": 99885523, "body": "What do you mean by &quot;it all breaks&quot;?"}, {"owner": {"reputation": 773, "user_id": 5407287, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49bdb5440d34f0cb4b0ad6c117e8a04e?s=128&d=identicon&r=PG&f=1", "display_name": "LivingRobot", "link": "https://stackoverflow.com/users/5407287/livingrobot"}, "reply_to_user": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 0, "creation_date": 1560897534, "post_id": 56657850, "comment_id": 99885563, "body": "@Tordek I mean that it compiles but doesn&#39;t run successfully (i.e. doesn&#39;t output anything)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1560897651, "post_id": 56657850, "comment_id": 99885594, "body": "Stack sizes are usually pretty small, i.e. only a few megabytes. So you need to be careful when declaring arrays as local variables. <code>double ders[100000*1]</code> uses 800Kbytes, so that&#39;s a bit big for a local variable. You can declare with the <code>static</code> keyword, or move it out of <code>main</code> (i.e. make it a global variable). <code>static</code> and global variables can use all of the memory, so they can be much bigger than local variables."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1560897806, "post_id": 56657850, "comment_id": 99885632, "body": "You never put any values into ders[], and you never print any values from it, so I&#39;m not sure what output you&#39;re expecting."}, {"owner": {"reputation": 773, "user_id": 5407287, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49bdb5440d34f0cb4b0ad6c117e8a04e?s=128&d=identicon&r=PG&f=1", "display_name": "LivingRobot", "link": "https://stackoverflow.com/users/5407287/livingrobot"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560897816, "post_id": 56657850, "comment_id": 99885634, "body": "@user3386109 - Thanks so much! You saved me much debugging!"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560897957, "post_id": 56657850, "comment_id": 99885668, "body": "@LivingRobot Glad I could help! Cheers! I&#39;ve re-posted the comment as an answer, since it seems to have been the issue."}], "answers": [{"comments": [{"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 2, "creation_date": 1560898289, "post_id": 56657999, "comment_id": 99885735, "body": "another recommendation would be to heap allocate it"}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 3, "last_activity_date": 1560898375, "last_edit_date": 1560898375, "creation_date": 1560898139, "answer_id": 56657999, "question_id": 56657850, "link": "https://stackoverflow.com/questions/56657850/passing-empty-array-to-function-not-working/56657999#56657999", "title": "Passing empty array to function - not working", "body": "<p>Stack sizes are usually pretty small, i.e. only a few megabytes. So you need to be careful when declaring arrays as local variables. </p>\n\n<p><code>double ders[N*num_vars];</code> translates to <code>double ders[100000*1];</code> and will use 800K bytes (assuming a <code>double</code> is 8 bytes). So that's a bit big for a local variable. </p>\n\n<p>You can declare with it the <code>static</code> keyword, or move it out of main (i.e. make it a global variable). <code>static</code> and global variables can use all of the memory, so they can be much bigger than local variables. You can also allocate the memory dynamically, e.g. using <code>malloc</code> or <code>calloc</code>.</p>\n"}], "owner": {"reputation": 773, "user_id": 5407287, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49bdb5440d34f0cb4b0ad6c117e8a04e?s=128&d=identicon&r=PG&f=1", "display_name": "LivingRobot", "link": "https://stackoverflow.com/users/5407287/livingrobot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56657999, "answer_count": 1, "score": 2, "last_activity_date": 1560898375, "creation_date": 1560897117, "last_edit_date": 1560897654, "question_id": 56657850, "link": "https://stackoverflow.com/questions/56657850/passing-empty-array-to-function-not-working", "title": "Passing empty array to function - not working", "body": "<p>I'm pretty new to C and am trying to do what I assume is very simple - but am getting stuck for some reason:</p>\n\n<p>I have a <code>main</code> in a file called <code>runnable.c</code> where I have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n#include \"utils.h\"\n#define N 100000\n#define num_vars 1\n\nint main() {\n    printf(\"I am running...\\n\");\n    double values[N*num_vars];\n    double ders[N*num_vars];\n    char variable[] = \"params.txt\"; \n    read_file_to_array(variable, values); // fills up values \n    test_values(values);\n    test_num_points(N);\n    test_ders(ders);\n    return 0;\n}\n</code></pre>\n\n<p>I then have <code>utils.h</code> which defines</p>\n\n<pre><code>void test_values(double values[]);\nvoid test_ders(double ders[]);\nvoid test_num_points(int num_points);\n</code></pre>\n\n<p>And <code>utils.c</code> which has </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid test_values(double values[]) {\n    printf(\"I am in test_values\\n\");\n}\n\nvoid test_num_points(int num_points) {\n    printf(\"I am in test_num_points\\n\");\n}\n\nvoid test_ders(double ders[]) {\n    printf(\"I am in test_ders\\n\");\n}\n</code></pre>\n\n<p>I'm compiling on my Windows machine using</p>\n\n<pre><code>cl runnable.c utils.c /link /out:program.exe\n</code></pre>\n\n<p>Everything works great when I just have <code>test_values</code> and <code>test_num_points</code> - but for some reason it doesn't run successfully when when I add <code>test_ders</code> into the mix. It still compiles correctly, but nothing is outputed. </p>\n\n<p>I'm having trouble getting the debugger to work on my Windows machine and was hoping somebody might be able to help me figure out what's going on. </p>\n"}, {"tags": ["c", "arguments", "shared-libraries", "main"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 4, "creation_date": 1560895113, "post_id": 56657527, "comment_id": 99885009, "body": "<code>man dlopen</code>, <code>man dlsym</code>, etc"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1560896093, "post_id": 56657527, "comment_id": 99885230, "body": "More specifically: <code>dlopen</code> is going to want a filename, as a string.  And the command line (<code>argv</code>) is a good way of passing strings in to a program."}], "answers": [{"tags": [], "owner": {"reputation": 39539, "user_id": 153430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a446e1fd338fb334fa68b3f7470cd65b?s=128&d=identicon&r=PG", "display_name": "Jim Lewis", "link": "https://stackoverflow.com/users/153430/jim-lewis"}, "is_accepted": true, "score": 6, "last_activity_date": 1560895281, "creation_date": 1560895281, "answer_id": 56657601, "question_id": 56657527, "link": "https://stackoverflow.com/questions/56657527/how-to-use-so-files-as-main-arguments-in-c/56657601#56657601", "title": "How to use .so files as main arguments in c?", "body": "<p>What you're trying to do is called \"dynamic loading\" of libraries.  On Unix-like operating systems, the call you're looking for is <a href=\"http://man7.org/linux/man-pages/man3/dlopen.3.html\" rel=\"noreferrer\">dlopen()</a> .  It takes a filename and some flags, and opens the specified shared library.  You can then use the <code>dlsym()</code> routine to look up individual symbols (like your function f()), which you can then call elsewhere in your program.</p>\n"}], "owner": {"reputation": 23, "user_id": 8973364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54fedf2c56389268970e70cdad6978bf?s=128&d=identicon&r=PG", "display_name": "user8973364", "link": "https://stackoverflow.com/users/8973364/user8973364"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 56657601, "answer_count": 1, "score": 2, "last_activity_date": 1560896126, "creation_date": 1560894762, "last_edit_date": 1560896126, "question_id": 56657527, "link": "https://stackoverflow.com/questions/56657527/how-to-use-so-files-as-main-arguments-in-c", "title": "How to use .so files as main arguments in c?", "body": "<p>I have to write a c program, that gets a .so file (shared-object) as an argument in the main method and call a function f on it. It expects a function f to exist on this library. My program has to work for any .so file, so I can't include them directly.</p>\n\n<p>so by calling</p>\n\n<pre><code>./myprogram myLibrary.so\n</code></pre>\n\n<p>myprogram has to do something like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(int argc, char *argv[]) {\n    return argv[1].f();\n }\n</code></pre>\n\n<p>How can I achieve this and what else do I have to consider when compiling my code?</p>\n"}, {"tags": ["c", "segmentation-fault", "qsort"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1560894100, "post_id": 56657345, "comment_id": 99884707, "body": "As I see it, <code>COUNT_OF(P)</code> is 10. But you&#39;ve only initialized 3 of the array entries. So I expect <code>qsort</code> to crash and burn."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1560896071, "post_id": 56657345, "comment_id": 99885225, "body": "Yeah, that could be an issue.  Get rid of the magic numbers and use a define for the length of your array and the condition on your loops."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1560901305, "post_id": 56657345, "comment_id": 99886339, "body": "Use a debugger to find the line that causes the segfault and update the question."}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1560931906, "last_edit_date": 1560931906, "creation_date": 1560930892, "answer_id": 56662680, "question_id": 56657345, "link": "https://stackoverflow.com/questions/56657345/how-to-fix-segmentation-fault-while-printing-string-of-struct/56662680#56662680", "title": "How to fix &quot;Segmentation fault&quot; while printing string of struct?", "body": "<p>You have a large number of problems, all stemming from your incorrect handling of your <em>array of pointers</em>:</p>\n\n<pre><code>    struct Person *P[10];\n</code></pre>\n\n<p>When you declare <code>P</code> above, you have an array of 10 pointers, NOT 10 <code>struct Person</code>. Your allocation, <code>P[i] = (struct Person *) malloc(sizeof(struct Person));</code> is fine, but See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a></p>\n\n<p>You then incorrectly use <code>COUNT_OF(x)</code> to set your loop limits (after hardcoding the 1st to <code>3</code>) which leaves you attempting to <code>qsort</code> and <code>free</code> elements <code>3-9</code> that are neither allocated or initialized leading to <em>Undefined Behavior</em>. (your SegFault can occur anywhere)</p>\n\n<p>Your <code>qsort</code> compare functions are wrong. They are off by one-level-of-indirection. You are sorting <code>P</code> which is an <em>array of pointers</em>. Since <code>qsort</code> passes a <em>pointer-to-element</em> to your compare function (remember your elements are <em>pointers</em> not struct), <code>qsort</code> is passing a <em>pointer-to-pointer-to-struct</em> as parameters to your compare function. Therefore your compare functions need to provide an additional level of indirection in the type of variable the <code>const void *</code> parameters are converted to. For example:</p>\n\n<pre><code>int Person_cmp_firstname(const void* x, const void* y) {\n    struct Person * const *ix = x;\n    struct Person * const * iy = y;\n    return strcmp((*ix)-&gt;firstname, (*iy)-&gt;firstname); \n}\n\n\nint Person_cmp_lastname(const void* x, const void* y ) {\n    struct Person * const *ix = x;\n    struct Person * const *iy = y;\n    return strcmp((*ix)-&gt;lastname, (*iy)-&gt;lastname); \n}\n\nint Person_cmp_age(const void* x, const void* y) {\n    struct Person * const *px = x;\n    struct Person * const *py = y;\n    return ((*px)-&gt;age &gt; (*py)-&gt;age) - ((*px)-&gt;age &lt; (*py)-&gt;age);\n}\n</code></pre>\n\n<p>(<strong>note:</strong> since the parameters are <code>void*</code> there is no need to cast the assignments within each compare function. Also <strong>note:</strong> a subtraction of conditionals is used to avoid potential for overflow, e.g. <code>(a &gt; b) - (a &lt; b)</code> rather than just <code>a - b</code> for <code>age</code>)</p>\n\n<p>In the remainder of your code, you need a counter to keep track of the number of elements filled, and use that counter as to pass to <code>qsort</code> and to print the sorted arrays (and <code>free</code> the pointers when done). A simple <code>n</code> counter is used below, e.g.</p>\n\n<pre><code> int main(){;\n    int choice, i, n;\n    struct Person *P[10];\n    printf(\"\\t***PROGRAM TO SORT PERSONS***\\n\\n\");\n    for(i=0; i&lt;3; i++){\n        P[i] = (struct Person *) malloc(sizeof(struct Person));\n        printf(\"Firstname: \");\n        scanf(\"%s\", P[i]-&gt;firstname);\n        printf(\"Lastname: \");\n        scanf(\"%s\", P[i]-&gt;lastname);\n        printf(\"Age: \");\n        scanf(\"%d\", &amp;P[i]-&gt;age);\n        printf(\"\\t***NEXT PERSON***\\n\\n\");\n    }\n    n = i;   /* saves the number of filled struct as n */\n    ...\n                qsort(P, n, sizeof *P, Person_cmp_firstname);\n                for(i=0; i&lt;n; i++){\n                    printf( \"Firstname: %s\\t| Lastname: %s\\t| Age: %d\\n\",\n                           P[i]-&gt;firstname, P[i]-&gt;lastname, P[i]-&gt;age );\n            ...\n            case 4:\n                printf(\"\\t***EXITING PROGRAM***\\n\\n\");\n                for (i = 0; i &lt; n; i++) {\n                    free(P[i]);\n                }\n                exit(0);\n</code></pre>\n\n<p>Now your code will work.</p>\n\n<p>Putting it altogether, you can do:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 2\n#define COUNT_OF(x) (sizeof(x) / sizeof(*x)) //length of arrays at compile time\n\nstruct Person {\n    char firstname[64];\n    char lastname[64];\n    int age;\n};\n\nint Person_cmp_firstname(const void* x, const void* y) {\n    struct Person * const *ix = x;\n    struct Person * const * iy = y;\n    return strcmp((*ix)-&gt;firstname, (*iy)-&gt;firstname); \n}\n\nint Person_cmp_lastname(const void* x, const void* y ) {\n    struct Person * const *ix = x;\n    struct Person * const *iy = y;\n    return strcmp((*ix)-&gt;lastname, (*iy)-&gt;lastname); \n}\n\nint Person_cmp_age(const void* x, const void* y) {\n    struct Person * const *px = x;\n    struct Person * const *py = y;\n    return ((*px)-&gt;age &gt; (*py)-&gt;age) - ((*px)-&gt;age &lt; (*py)-&gt;age);\n}\n\nint main(){;\n    int choice, i, n;\n    struct Person *P[10];\n    printf(\"\\t***PROGRAM TO SORT PERSONS***\\n\\n\");\n    for(i=0; i&lt;3; i++){\n        P[i] = (struct Person *) malloc(sizeof(struct Person));\n        printf(\"Firstname: \");\n        scanf(\"%s\", P[i]-&gt;firstname);\n        printf(\"Lastname: \");\n        scanf(\"%s\", P[i]-&gt;lastname);\n        printf(\"Age: \");\n        scanf(\"%d\", &amp;P[i]-&gt;age);\n        printf(\"\\t***NEXT PERSON***\\n\\n\");\n    }\n    n = i;\n    do{\n        printf(\"\\n\\t***CHOOSE HOW TO SORT***\\n\\n\\tBy firstname: 1\\n\\tBy lastname: 2\\n\\tBy age: 3\\n\\tExit Program: 4\\n\\n\");\n        scanf(\"%d\", &amp;choice);\n        switch(choice){\n            case 1:\n                printf(\"\\t***SORTING BY FIRSTNAME...***\\n\\n\");\n                qsort(P, n, sizeof *P, Person_cmp_firstname);\n                printf(\"\\t***DONE***\\n\\n\");\n                for(i=0; i&lt;n; i++){\n                    printf( \"Firstname: %s\\t| Lastname: %s\\t| Age: %d\\n\", P[i]-&gt;firstname, P[i]-&gt;lastname, P[i]-&gt;age );\n                }\n                break;\n            case 2:\n                printf(\"\\t***SORTING BY LASTNAME...***\\n\\n\");\n                qsort(P, n, sizeof *P, Person_cmp_lastname);\n                printf(\"\\t***DONE***\\n\\n\");\n                for(i=0; i&lt;n; i++){\n                    printf( \"Firstname: %s\\t| Lastname: %s\\t| Age: %d\\n\", P[i]-&gt;firstname, P[i]-&gt;lastname, P[i]-&gt;age );\n                }\n                break;\n            case 3:\n                printf(\"\\t***SORTING BY AGE...***\\n\\n\");\n                qsort(P, n, sizeof *P, Person_cmp_age);\n                printf(\"\\t***DONE***\\n\\n\");\n                for(i=0; i&lt;n; i++){\n                    printf( \"Firstname: %s\\t| Lastname: %s\\t| Age: %d\\n\",P[i]-&gt;firstname, P[i]-&gt;lastname, P[i]-&gt;age );\n                }\n                break;\n            case 4:\n                printf(\"\\t***EXITING PROGRAM***\\n\\n\");\n                for (i = 0; i &lt; n; i++) {\n                    free(P[i]);\n                }\n                exit(0);\n            default:\n                printf(\"\\t***INVALID OPTION***\\n\\n\");\n                break;\n        }\n    }while(1);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/person_struct\n        ***PROGRAM TO SORT PERSONS***\n\nFirstname: Porky\nLastname: Pig\nAge: 83\n        ***NEXT PERSON***\n\nFirstname: Daffy\nLastname: Duck\nAge: 93\n        ***NEXT PERSON***\n\nFirstname: Mickey\nLastname: Mouse\nAge: 100\n        ***NEXT PERSON***\n\n\n        ***CHOOSE HOW TO SORT***\n\n        By firstname: 1\n        By lastname: 2\n        By age: 3\n        Exit Program: 4\n\n2\n        ***SORTING BY LASTNAME...***\n\n        ***DONE***\n\nFirstname: Daffy        | Lastname: Duck        | Age: 93\nFirstname: Mickey       | Lastname: Mouse       | Age: 100\nFirstname: Porky        | Lastname: Pig | Age: 83\n\n        ***CHOOSE HOW TO SORT***\n\n        By firstname: 1\n        By lastname: 2\n        By age: 3\n        Exit Program: 4\n\n3\n        ***SORTING BY AGE...***\n\n        ***DONE***\n\nFirstname: Porky        | Lastname: Pig | Age: 83\nFirstname: Daffy        | Lastname: Duck        | Age: 93\nFirstname: Mickey       | Lastname: Mouse       | Age: 100\n\n        ***CHOOSE HOW TO SORT***\n\n        By firstname: 1\n        By lastname: 2\n        By age: 3\n        Exit Program: 4\n\n4\n        ***EXITING PROGRAM***\n</code></pre>\n\n<p>(<strong>note:</strong> your input routine is horribly fragile and you fail to check the <strong>return</strong> of every <code>scanf</code>, further inviting <em>Undefined Behavior</em> with the slip of a single keystroke. Always <strong><em>validate</em></strong> Every user-input and Every allocation)</p>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/person_struct\n==2078== Memcheck, a memory error detector\n==2078== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==2078== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==2078== Command: ./bin/person_struct\n==2078==\n        ***PROGRAM TO SORT PERSONS***\n\nFirstname: John\nLastname: Wayne\nAge: 91\n        ***NEXT PERSON***\n\nFirstname: Jane\nLastname: Doe\nAge: 101\n        ***NEXT PERSON***\n\nFirstname: Mickey\nLastname: Mouse\nAge: 99\n        ***NEXT PERSON***\n\n\n        ***CHOOSE HOW TO SORT***\n\n        By firstname: 1\n        By lastname: 2\n        By age: 3\n        Exit Program: 4\n\n1\n        ***SORTING BY FIRSTNAME...***\n\n        ***DONE***\n\nFirstname: Jane | Lastname: Doe | Age: 101\nFirstname: John | Lastname: Wayne       | Age: 91\nFirstname: Mickey       | Lastname: Mouse       | Age: 99\n\n        ***CHOOSE HOW TO SORT***\n\n        By firstname: 1\n        By lastname: 2\n        By age: 3\n        Exit Program: 4\n\n2\n        ***SORTING BY LASTNAME...***\n\n        ***DONE***\n\nFirstname: Jane | Lastname: Doe | Age: 101\nFirstname: Mickey       | Lastname: Mouse       | Age: 99\nFirstname: John | Lastname: Wayne       | Age: 91\n\n        ***CHOOSE HOW TO SORT***\n\n        By firstname: 1\n        By lastname: 2\n        By age: 3\n        Exit Program: 4\n\n3\n        ***SORTING BY AGE...***\n\n        ***DONE***\n\nFirstname: John | Lastname: Wayne       | Age: 91\nFirstname: Mickey       | Lastname: Mouse       | Age: 99\nFirstname: Jane | Lastname: Doe | Age: 101\n\n        ***CHOOSE HOW TO SORT***\n\n        By firstname: 1\n        By lastname: 2\n        By age: 3\n        Exit Program: 4\n\n4\n        ***EXITING PROGRAM***\n\n==2078==\n==2078== HEAP SUMMARY:\n==2078==     in use at exit: 0 bytes in 0 blocks\n==2078==   total heap usage: 3 allocs, 3 frees, 396 bytes allocated\n==2078==\n==2078== All heap blocks were freed -- no leaks are possible\n==2078==\n==2078== For counts of detected and suppressed errors, rerun with: -v\n==2078== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n"}], "owner": {"reputation": 37, "user_id": 11516821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66466542d02df60649fbfb70032d890c?s=128&d=identicon&r=PG&f=1", "display_name": "mesun_99", "link": "https://stackoverflow.com/users/11516821/mesun-99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560931906, "creation_date": 1560893545, "question_id": 56657345, "link": "https://stackoverflow.com/questions/56657345/how-to-fix-segmentation-fault-while-printing-string-of-struct", "title": "How to fix &quot;Segmentation fault&quot; while printing string of struct?", "body": "<p>I wrote a code that stores details of persons in a struct which has a dynamically allocated array of pointers (pointing to structures). These structs are sorted via qsort and should be printed afterwards, but it displays \"segmentation fault\" right before printing. I assume the problem lies within the printf function and I would be very grateful if someone could explain to me what I have done wrong.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define MAX 2\n#define COUNT_OF(x) (sizeof(x) / sizeof(0[x])) //length of arrays at compile time\n\nstruct Person {\nchar firstname[64];\nchar lastname[64];\nint age;\n};\n\nint Person_cmp_firstname(const void* x, const void* y) {\n    struct Person *ix = (struct Person *)x;\n    struct Person *iy = (struct Person *)y;\n    return strcmp(ix-&gt;firstname, iy-&gt;firstname); \n    }\n\n\nint Person_cmp_lastname(const void* x, const void* y ) {\n    struct Person *ix = (struct Person *)x;\n    struct Person *iy = (struct Person *)y;\n    return strcmp(ix-&gt;lastname, iy-&gt;lastname); \n}\nint Person_cmp_age(const void* x, const void* y) {\n    struct Person *px = (struct Person *) x;\n    struct Person *py = (struct Person *) y;\n    return px-&gt;age - py-&gt;age;\n}\n\nint main(){;\n    int choice;\n    struct Person *P[10];\n    printf(\"\\t***PROGRAM TO SORT PERSONS***\\n\\n\");\n    for(int i=0; i&lt;3; i++){\n        P[i] = (struct Person *) malloc(sizeof(struct Person));\n        printf(\"Firstname: \");\n        scanf(\"%s\", P[i]-&gt;firstname);\n        printf(\"Lastname: \");\n        scanf(\"%s\", P[i]-&gt;lastname);\n        printf(\"Age: \");\n        scanf(\"%d\", &amp;P[i]-&gt;age);\n        printf(\"\\t***NEXT PERSON***\\n\\n\");\n    }\n    do{\n        printf(\"\\n\\t***CHOOSE HOW TO SORT***\\n\\n\\tBy firstname: 1\\n\\tBy lastname: 2\\n\\tBy age: 3\\n\\tExit Program: 4\\n\\n\");\n        scanf(\"%d\", &amp;choice);\n        switch(choice){\n            case 1:\n                printf(\"\\t***SORTING BY FIRSTNAME...***\\n\\n\");\n                qsort(P, COUNT_OF(P), sizeof(struct Person), Person_cmp_firstname);\n                printf(\"\\t***DONE***\\n\\n\");\n                for(unsigned int i=0; i&lt;3; i++){\n                    printf( \"Firstname: %s\\t| Lastname: %s\\t| Age: %d\\n\", P[i]-&gt;firstname, P[i]-&gt;lastname, P[i]-&gt;age );\n                }\n                break;\n            case 2:\n                printf(\"\\t***SORTING BY LASTNAME...***\\n\\n\");\n                qsort(P, COUNT_OF(P), sizeof(struct Person ), Person_cmp_lastname);\n                printf(\"\\t***DONE***\\n\\n\");\n                for(unsigned int i=0; i&lt;3; i++){\n                    printf( \"Firstname: %s\\t| Lastname: %s\\t| Age: %d\\n\", P[i]-&gt;firstname, P[i]-&gt;lastname, P[i]-&gt;age );\n                }\n                break;\n            case 3:\n                printf(\"\\t***SORTING BY AGE...***\\n\\n\");\n                qsort(P, COUNT_OF(P), sizeof(struct Person), Person_cmp_age);\n                printf(\"\\t***DONE***\\n\\n\");\n                for(unsigned int i=0; i&lt;3; i++){\n                    printf( \"Firstname: %s\\t| Lastname: %s\\t| Age: %d\\n\",P[i]-&gt;firstname, P[i]-&gt;lastname, P[i]-&gt;age );\n                }\n                break;\n            case 4:\n                printf(\"\\t***EXITING PROGRAM***\\n\\n\");\n                for (int j = 0; j &lt; 3; j++) {\n                    free(P[j]);\n                }\n                exit(0);\n            default:\n                printf(\"\\t***INVALID OPTION***\\n\\n\");\n                break;\n        }\n    }while(1);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "visual-c++", "x86-64", "compiler-optimization", "integer-division"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1561073892, "post_id": 56657236, "comment_id": 99955233, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/195308/discussion-on-question-by-george-robinson-how-can-i-tell-the-msvc-compiler-to-us\">moved to chat</a>."}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1562200717, "post_id": 56657236, "comment_id": 100307213, "body": "have you considered using <a href=\"https://libdivide.com\" rel=\"nofollow noreferrer\">libdivide.com</a>"}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "reply_to_user": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1562226911, "post_id": 56657236, "comment_id": 100313869, "body": "@JosephWood: I looked at it but it does not offer the control of the hardware division width."}], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560934565, "post_id": 56659086, "comment_id": 99895932, "body": "...but the dividend <code>b</code> must be scaled up ( shifted left by 32 bits or multiplied by 2^32 ) BEFORE the division.  Your example has only a 16 bit shift, which changes things considerably when the dividend is originally 32 bits wide. See: <a href=\"https://godbolt.org/z/1MK73-\" rel=\"nofollow noreferrer\">godbolt.org/z/1MK73-</a>"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560935193, "post_id": 56659086, "comment_id": 99896310, "body": "What do you expect if you shift 32-bit number left by 32 bit in C? 0 or undefined?"}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560935406, "post_id": 56659086, "comment_id": 99896436, "body": "I expect a zero or garbage.  That&#39;s why I wrote in the original comment, that the dividend must be casted.  Although I did not want to suggest a specific casting (as this might be a solution) I have edited the OP and added the minimal casting now because its lack was causing too much confusion."}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560936295, "post_id": 56659086, "comment_id": 99896913, "body": "Instruction <code>div</code> can have divisor size 8, 16, 32, or 64-bit. Dividend accordingly twice the size of divisor: 16, 32, 64, or 128-bit. 64/128 instruction exists only in the x64 set of instruction. This is why when you switched to  64-bit arguments in x86 it is a function call instead of  <code>div</code> instruction. The size of divisor defines the type of <code>div</code>: <code>int8_t a</code>, ..., or <code>int64_t a</code>"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 1, "creation_date": 1560938245, "post_id": 56659086, "comment_id": 99898051, "body": "The comment above is for <code>div</code> instruction in assembly. In C: dividend and divisor cast to the higher bit number. This is why you get 128/64 div when one of them is 64-bit."}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560938390, "post_id": 56659086, "comment_id": 99898158, "body": "Yes, I know. Originally I wrote that this is for the x86-64 target so we can keep it narrowed down to that architecture.  In my function the input argument (the divisor) is 32-bit wide so I would like the type of <code>div</code> to be 64bit/32bit. Without casting the dividend it will not compile correctly.  Right now I am patching the opcodes in the binary executable to <code>div r32</code> (and getting a significant performance increase), but I really would like to do this in a legal and portable manner.  How can I update my original question to make it more clear?"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 2, "creation_date": 1560941101, "post_id": 56659086, "comment_id": 99899561, "body": "_udiv64 intrinsic is available starting in Visual Studio 2019 RTM or you can write a separate assembly file."}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560944563, "post_id": 56659086, "comment_id": 99901469, "body": "OK, I guess I&#39;ll have to upgrade to VS2019 and live with the compiler intrinsic <code>_udiv64</code>. It is either that ...or binary patching...  BTW: Did you see that weird pair of <code>shl</code> and <code>shr</code> instructions that the compiler has generated, when only <code>xor eax,eax</code> and <code>div ecx</code> would have been sufficient ?"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560946422, "post_id": 56659086, "comment_id": 99902551, "body": "Yes, I did notice that in x86 they don&#39;t use shit instruction at all, but in x64 do extra heavy shifting ;-)"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560950714, "post_id": 56659086, "comment_id": 99905208, "body": "Another option could be Intel C++ Compiler (ICC) if you use Intel CPU. It is integrated with VS: easy to switch from VSC to ICC. It has the inline assembly for x64. It will probably produce the fastest optimized code."}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560975617, "post_id": 56659086, "comment_id": 99917863, "body": "I forgot about the Intel C++ Compiler integration with VS !  Does it have an intrinsic for the unsigned 64bit/32bit division ?"}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560977415, "post_id": 56659086, "comment_id": 99918530, "body": "Check your last UPDATED godbolt.org link. It stopped working!"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1560997027, "post_id": 56659086, "comment_id": 99922826, "body": "Yes, it stopped because of gotbolt: they removed all msvc compilers from the list. I didn&#39;t find an intrinsic for a single division but two/four divisions:  _mm_div_epu64/ _mm256_div_epu64. Calculates quotient of a division operation. Vector variant of div() function for unsigned 64-bit integer arguments."}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561003719, "post_id": 56659086, "comment_id": 99924004, "body": "Added a solution with Intel C++ Compiler."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 1, "creation_date": 1561057030, "post_id": 56659086, "comment_id": 99949857, "body": "@GeorgeRobinson: <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> does still have WINE versions of MSVC for C and C++.  Weird that Matt removed the other MSVC versions though; they&#39;ll hopefully be back."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 1, "creation_date": 1561057256, "post_id": 56659086, "comment_id": 99949932, "body": "@GeorgeRobinson and Alex: <code>_mm256_div_epu64</code> isn&#39;t a real intrinsic, it&#39;s a (slow) helper function.  If you want repeated division by the <i>same</i> divisor, look at <a href=\"https://libdivide.com/\" rel=\"nofollow noreferrer\">libdivide.com</a>.  You might need to hand-roll your own stuff for this left-shifted-dividend thing, because that probably factors out when using a multiplicative inverse for division, but the libdivide library functions probably don&#39;t have a way to handle just 32-bit high-half-only SIMD inputs."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1561057622, "post_id": 56659086, "comment_id": 99950079, "body": "@AlexLopatin: the whole first half of this answer is useless, and probably left over from a badly written first version of the question.  The only useful part is <code>_udiv64</code>.  Also, your first 2 asm output blocks are from un-optimized code.  That&#39;s why it&#39;s spilling the args to the shadow space and reloading.  That&#39;s not useful."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1561058729, "post_id": 56659086, "comment_id": 99950558, "body": "Update: compiler-explorer with up-to-date MSVC is still available run by Microsoft on <a href=\"https://www.godbolt.ms/\" rel=\"nofollow noreferrer\">godbolt.ms</a>.  Normally Matt Godbolt&#39;s <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> proxies to that site for Windows installs of MSVC (Explanation at <a href=\"https://github.com/mattgodbolt/compiler-explorer/issues/1168#issuecomment-485438416\" rel=\"nofollow noreferrer\">github.com/mattgodbolt/compiler-explorer/issues/&hellip;</a>).  That&#39;s the part that&#39;s currently down, but you can use x64 MSVC 19.20 on <a href=\"https://www.godbolt.ms/\" rel=\"nofollow noreferrer\">godbolt.ms</a> directly."}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1561066409, "post_id": 56659086, "comment_id": 99953506, "body": "@PeterCordes: Thank you for the valuable input and editing my answer. Sorry, I can&#39;t upvote the answer but can do this to your comments :-)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1561066568, "post_id": 56659086, "comment_id": 99953566, "body": "Glad you liked my edit.  I&#39;m not worried about rep.  If I was, I&#39;d have posted my own answer. :P  I thought it was more useful for SO to have one good answer, and the good answer was right there buried inside your existing one."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561093045, "post_id": 56659086, "comment_id": 99958597, "body": "@GeorgeRobinson and Alex: a <code>naked</code> function can&#39;t inline.  <code>call</code>/<code>ret</code> overhead is probably less bad than bouncing the inputs through memory, but both ways suck.  (And <code>naked</code> isn&#39;t 100% obviously better, because <code>asm</code> inside a regular function can inline into a loop.  It still can only take its inputs as memory operands, though.)  If you only care about ICC, not 32-bit MSVC, <b>ICC supports GNU C inline asm syntax</b> which is lets you avoid both overheads.  It still blocks constant-propagation, but see <a href=\"//stackoverflow.com/a/10781271\">this example</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1561094278, "post_id": 56659086, "comment_id": 99958893, "body": "See also <a href=\"//stackoverflow.com/a/35959859\">What is the difference between &#39;asm&#39;, &#39;__asm&#39; and &#39;__asm__&#39;?</a> for an example wrapping 64-bit / 32-bit =&gt; 32-bit <code>idiv</code>.  (Use it for <code>div</code> by just changing the mnemonic and the types to unsigned.)"}], "tags": [], "owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "is_accepted": true, "score": 6, "last_activity_date": 1561093202, "last_edit_date": 1561093202, "creation_date": 1560909450, "answer_id": 56659086, "question_id": 56657236, "link": "https://stackoverflow.com/questions/56657236/how-can-i-instruct-the-msvc-compiler-to-use-a-64bit-32bit-division-instead-of-th/56659086#56659086", "title": "How can I instruct the MSVC compiler to use a 64bit/32bit division instead of the slower 128bit/64bit division?", "body": "<p>No current compilers (gcc/clang/ICC/MSVC) will do this optimization from portable ISO C source, even if you let them prove that <code>b &lt; a</code> so the quotient will fit in 32 bits.  (For example with GNU C <code>if(b&gt;=a) __builtin_unreachable();</code> <a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdint.h%3E%0A%23include+%3Cx86intrin.h%3E%0A%0A//+pre-condition:+a+%3E+b+else+64/32-bit+division+overflows%0Auint32_t+ScaledDiv(uint32_t+a,+uint32_t+b)+%0A%7B%0A++++if+(b%3E%3Da)+__builtin_unreachable()%3B%0A+++%09uint32_t+remainder%3B%0A+++%09uint64_t+d+%3D+((uint64_t)+b)+%3C%3C+32%3B%0A+++%09//return+_udiv64(d,+a,+%26remainder)%3B%0A++++return+d/a%3B%0A%7D%0A%0Aint+main()+%7B%0A%09uint32_t+a+%3D+5%3B%0A%09uint32_t+b+%3D+4%3B%0A%09uint32_t+c+%3D+ScaledDiv(a,+b)%3B%0A%09return+c%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:27.550232201588344,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g91,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;0&#39;,intel:&#39;0&#39;,libraryCode:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+9.1+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:22.44976779841166,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:clang800,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;0&#39;,intel:&#39;0&#39;,libraryCode:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+8.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),k:24.999999999999996,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:icc191,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;0&#39;,intel:&#39;0&#39;,libraryCode:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+icc+19.0.1+(Editor+%231,+Compiler+%233)+C%2B%2B&#39;,t:&#39;0&#39;)),k:25,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">on Godbolt</a>).   This is a missed optimization; until that's fixed, you have to work around it with intrinsics or inline asm.</p>\n\n<p>(Or use a GPU or SIMD instead; if you have the same divisor for many elements see <a href=\"https://libdivide.com/\" rel=\"nofollow noreferrer\">https://libdivide.com/</a> for SIMD to compute a multiplicative inverse once and apply it repeatedly.)</p>\n\n<hr>\n\n<p><a href=\"https://docs.microsoft.com/en-us/cpp/intrinsics/udiv64?view=vs-2019\" rel=\"nofollow noreferrer\"><strong><code>_udiv64</code></strong> is available</a> starting in Visual Studio 2019 RTM.</p>\n\n<p>In C mode (<code>-TC</code>) it's apparently always defined.  In C++ mode, you need to <code>#include &lt;immintrin.h&gt;</code>, as per the Microsoft docs.  or <code>intrin.h</code>.</p>\n\n<p><a href=\"https://godbolt.org/z/vVZ25L\" rel=\"nofollow noreferrer\">https://godbolt.org/z/vVZ25L</a>  (Or <a href=\"https://www.godbolt.ms/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdint.h%3E%0D%0A%23include+%3Cimmintrin.h%3E%0D%0A%0D%0A//+pre-condition:+a+%3E+b+else+64/32-bit+division+overflows%0D%0Auint32_t+ScaledDiv(uint32_t+a,+uint32_t+b)+%0D%0A%7B%0D%0A+++%09uint32_t+remainder%3B%0D%0A+++%09uint64_t+d+%3D+((uint64_t)+b)+%3C%3C+32%3B%0D%0A+++%09return+_udiv64(d,+a,+%26remainder)%3B%0D%0A%7D%0D%0A%0D%0Aint+main()+%7B%0D%0A%09uint32_t+a+%3D+5%3B%0D%0A%09uint32_t+b+%3D+4%3B%0D%0A%09uint32_t+c+%3D+ScaledDiv(a,+b)%3B%0D%0A%09return+c%3B%0D%0A%7D%0D%0A%0D%0A/*%0D%0Avoid+test_autovec(uint32_t+*a,+uint32_t+*b)+%7B%0D%0A++++for(int+i%3D0+%3B+i%3C1024+%3B+i%2B%2B)+%7B%0D%0A++++++++a%5Bi%5D+%3D+ScaledDiv(a%5Bi%5D,+b%5Bi%5D)%3B%0D%0A++++%7D%0D%0A%7D%0D%0A*/%0D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:50,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:vcpp_v19_20_x64,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-TC+-Ox+-arch:AVX2&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x64+msvc+v19.20+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:50,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">on Godbolt.ms</a> because recent MSVC on the main Godbolt site is not working<sup>1</sup>.)</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;immintrin.h&gt;       // defines the prototype\n\n// pre-condition: a &gt; b else 64/32-bit division overflows\nuint32_t ScaledDiv(uint32_t a, uint32_t b) \n{\n    uint32_t remainder;\n    uint64_t d = ((uint64_t) b) &lt;&lt; 32;\n    return _udiv64(d, a, &amp;remainder);\n}\n\nint main() {\n    uint32_t c = ScaledDiv(5, 4);\n    return c;\n}\n</code></pre>\n\n<p>_udiv64 will produce 64/32 div. The two shifts left and right are a missed optimization.</p>\n\n<pre><code>;; MSVC 19.20 -O2 -TC\na$ = 8\nb$ = 16\nScaledDiv PROC                                      ; COMDAT\n        mov     edx, edx\n        shl     rdx, 32                             ; 00000020H\n        mov     rax, rdx\n        shr     rdx, 32                             ; 00000020H\n        div     ecx\n        ret     0\nScaledDiv ENDP\n\nmain    PROC                                            ; COMDAT\n        xor     eax, eax\n        mov     edx, 4\n        mov     ecx, 5\n        div     ecx\n        ret     0\nmain    ENDP\n</code></pre>\n\n<p>So we can see that MSVC doesn't do constant-propagation through <code>_udiv64</code>, even though in this case it doesn't overflow and it could have compiled <code>main</code> to just <code>mov eax, 0ccccccccH</code> / <code>ret</code>.</p>\n\n<hr>\n\n<p><strong>UPDATE #2</strong> <a href=\"https://godbolt.org/z/n3Dyp-\" rel=\"nofollow noreferrer\">https://godbolt.org/z/n3Dyp-</a>\nAdded a solution with Intel C++ Compiler, but this is less efficient and will defeat constant-propagation because it's inline asm.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n__declspec(regcall, naked) uint32_t ScaledDiv(uint32_t a, uint32_t b) \n{\n    __asm mov edx, eax\n    __asm xor eax, eax\n    __asm div ecx\n    __asm ret\n    // implicit return of EAX is supported by MSVC, and hopefully ICC\n    // even when inlining + optimizing\n}\n\nint main()\n{\n    uint32_t a = 3 , b = 4, c = ScaledDiv(a, b);\n    printf( \"(%u &lt;&lt; 32) / %u = %u\\n\", a, b, c);\n    uint32_t d = ((uint64_t)a &lt;&lt; 32) / b;\n    printf( \"(%u &lt;&lt; 32) / %u = %u\\n\", a, b, d);\n    return c != d;\n}\n</code></pre>\n\n<hr>\n\n<p>Footnote 1:  Matt Godbolt's main site's non-WINE MSVC compilers are temporarily(?) gone.  Microsoft runs <a href=\"https://www.godbolt.ms/\" rel=\"nofollow noreferrer\">https://www.godbolt.ms/</a> to host the recent MSVC compilers on real Windows, and normally the main Godbolt.org site relayed to that for MSVC.)</p>\n\n<p>It seems godbolt.ms will generate short links, but not expand them again!  Full links are better anyway for their resistance to link-rot.</p>\n"}, {"comments": [{"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "edited": false, "score": 0, "creation_date": 1561071321, "post_id": 56694538, "comment_id": 99954768, "body": "Intel says it is &quot;Intrinsics for Division Operations&quot;. So, why you refer to the Intel site and say it is not intrinsic?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "edited": false, "score": 0, "creation_date": 1561071416, "post_id": 56694538, "comment_id": 99954787, "body": "@AlexLopatin: Because it&#39;s really a function.  Intel doesn&#39;t distinguish between real intrinsics (for CPU instructions) vs. their SVML library functions, but the difference in performance is very real.  I guess I disagree with Intel over the meaning of the word &quot;intrinsic&quot;.  <code>_mm_sin_ps</code> is clearly not an intrinsic, for example.  <code>_mm_set_epi32(a, b, c, d)</code> is not really an intrinsic (there&#39;s no instruction that reads 4 integer registers or memory locations), but there&#39;s no algorithm or computation that it&#39;s emulating so we might as well call it an intrinsic."}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "edited": false, "score": 0, "creation_date": 1561072582, "post_id": 56694538, "comment_id": 99955008, "body": "Ok, I see - the prototypes. But Intel already has the hardware according to <a href=\"https://en.wikipedia.org/wiki/AVX-512\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/AVX-512</a> and here is one <a href=\"https://www.intel.com/content/www/us/en/products/processors/core/x-series/i9-7980xe.html\" rel=\"nofollow noreferrer\">intel.com/content/www/us/en/products/processors/core/x-serie&zwnj;&#8203;s/&hellip;</a> for $1803"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "edited": false, "score": 0, "creation_date": 1561073610, "post_id": 56694538, "comment_id": 99955190, "body": "@AlexLopatin: what AVX512 instruction are you talking about?  AVX512 still only has SIMD <i>FP</i> division which can&#39;t emulate <code>_mm_div_epu64</code> exactly.  You can convert unsigned 64-bit integers to <code>double</code>  with AVX512, but that introduces rounding.  Oh and re: &quot;intrinsics&quot;: those division functions are under the parent heading &quot;Intrinsics for Short Vector Math Library Operations&quot;.  I guess it makes sense to call them intrinsics if the compiler understands what they do and how to optimize / transform them, even though they don&#39;t map to a single instruction."}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561074266, "post_id": 56694538, "comment_id": 99955312, "body": "@Peter Cordes: My embedded Windows system does not have a GPU and I prefer not to mix floats with integers, The entire DSP algorithm is done on integers."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561074420, "post_id": 56694538, "comment_id": 99955346, "body": "@GeorgeRobinson: Not even an Intel integrated GPU?  I assume it is an Intel CPU from the benchmark speedup you got, though.  An iGPU can be used for OpenCL.  Anyway, some parts of this answer are only going to be useful to future readers with the same problem in a different context, not you."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561074570, "post_id": 56694538, "comment_id": 99955379, "body": "@GeorgeRobinson: <i>I prefer not to mix floats with integers</i>  Enjoy integer division being slow, then.  If you want to take advantage of the SIMD hardware dividers, you need to use <code>float</code> or <code>double</code>.  (Converting to <code>double</code> makes division slower, and fewer elements per vector, so the possible speedup is lower.  But it might be possible to get results that are exact for every possible pair of 32-bit inputs.)"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "edited": false, "score": 0, "creation_date": 1561075160, "post_id": 56694538, "comment_id": 99955497, "body": "@PeterCordes: Yes, you are right about _mm_div_epu64. I cannot find any correspondent instruction in AVX-512 set. Intel confused me with putting it under &quot;Intrinsics for Intel&#174; Advanced Vector Extensions 512 (Intel&#174; AVX-512) Instructions&quot; umbrella in &quot;Intel&#174; C++ Compiler 19.0 Developer Guide and Reference&quot; document"}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 1, "creation_date": 1561075956, "post_id": 56694538, "comment_id": 99955678, "body": "@PeterCordes Might want to get used to it. FP-phobia is a thing and people are willing to sacrifice an order of magnitude in performance to avoid floating-point - even when the usage is provably correct. Just don&#39;t tell people that the integer divide is implemented in hardware using the floating-point divide."}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561077337, "post_id": 56694538, "comment_id": 99955979, "body": "@Mystical:  I&#39;d like to read more about this FP-phobia. Do you know of any good articles?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561077414, "post_id": 56694538, "comment_id": 99955994, "body": "@GeorgeRobinson: You&#39;re commenting under the wrong answer.  But anyway, inline asm is not a great idea; you don&#39;t want call/ret overhead inside a hot loop.  That&#39;s worse than letting MSVC emit it&#39;s stupid shifts.  I didn&#39;t delete it from Alex&#39;s answer but I wouldn&#39;t recommend it.  Compile a function containing a <code>_udiv64</code> loop with MSVC and call it from ICC if you want to use ICC for the rest of your program.  Or hand-write the loop in asm instead of using compile-generated code that&#39;s full of missed optimizations anyway (like MSVC&#39;s shifts).  Or write a whole loop in asm for ICC."}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561077434, "post_id": 56694538, "comment_id": 99956001, "body": "@Peter.  I don&#39;t think it has a GPU. It is an old Intel Pentium in a R&amp;S ZVL-3 Network Analyzer."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561077801, "post_id": 56694538, "comment_id": 99956066, "body": "@GeorgeRobinson: Interesting!  I assumed you had a &quot;normal&quot; mini-ITX or something.  But what kind of Pentium?  Clearly it&#39;s not a P5 Pentium from 1993, that don&#39;t have 64-bit mode.  Is it a Sandybridge Pentium?  64-bit Pentium 4 (Nocona)?  Anyway, either way even if it&#39;s a Skylake Pentium, it won&#39;t have AVX unfortunately.  So you can only use 128-bit SIMD vectors at best, and maybe without SSE4.1 (which some compilers use when auto-vectorizing uint32_t &lt;-&gt; float)"}, {"owner": {"reputation": 642, "user_id": 2286254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eCNnw.jpg?s=128&g=1", "display_name": "Alex Lopatin", "link": "https://stackoverflow.com/users/2286254/alex-lopatin"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561092926, "post_id": 56694538, "comment_id": 99958566, "body": "@GeorgeRobinson: updated my code with <code>__declspec(regcall, naked)</code>. Thank you! I assumed that you will compile with <code>inline</code> but always good to know some extra tricks."}, {"owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561116096, "post_id": 56694538, "comment_id": 99968238, "body": "@Peter: The CPU is the Pentium4 model 505.  I am sorry for making a comment in the wrong section.  It was a simple oversight. I have deleted it. I agree with you that a naked function with <code>ret</code> will prevent beneficial inlining. Do you know how to force ICC x86-64 to pass the function arguments in registers without creating a stack frame and generaly without mucking with the stack inside the function, unnecessarily? <code>-Oy</code> does not work."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "edited": false, "score": 0, "creation_date": 1561134880, "post_id": 56694538, "comment_id": 99977940, "body": "@GeorgeRobinson: If you decide to use inline asm, use GNU C inline asm as described in this answer, instead of the inefficient MSVC inline asm.  A GNU C inline asm wrapper function can inline to a single instruction inside a loop that the compiler can optimize around.  It&#39;s designed for wrapping single instructions efficiently."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 4, "last_activity_date": 1561094553, "last_edit_date": 1561094553, "creation_date": 1561068799, "answer_id": 56694538, "question_id": 56657236, "link": "https://stackoverflow.com/questions/56657236/how-can-i-instruct-the-msvc-compiler-to-use-a-64bit-32bit-division-instead-of-th/56694538#56694538", "title": "How can I instruct the MSVC compiler to use a 64bit/32bit division instead of the slower 128bit/64bit division?", "body": "<p>@Alex Lopatin's answer shows how to use <code>_udiv64</code> to get non-terrible scalar code (despite MSVC's stupid missed optimization shifting left/right).</p>\n\n<p>For compilers that support GNU C inline asm (including ICC), you can use that instead of the inefficient MSVC inline asm syntax that has a lot of overhead for wrapping a single instruction.  See <a href=\"//stackoverflow.com/a/35959859\">What is the difference between 'asm', '__asm' and '__asm__'?</a> for an example wrapping 64-bit / 32-bit => 32-bit <code>idiv</code>.  (Use it for <code>div</code> by just changing the mnemonic and the types to unsigned.)  GNU C doesn't have an intrinsic for 64 / 32 or 128 / 64 division; it's supposed to optimize pure C.  But unfortunately GCC / Clang / ICC have missed optimizations for this case even using <code>if(a&lt;=b) __builtin_unreachable();</code> to promise that <code>a&gt;b</code>.</p>\n\n<hr>\n\n<p>But that's still scalar division, with pretty poor throughput.</p>\n\n<p>Perhaps you can a GPU for your DSP task?  If you have a large enough batch of work (and the rest of your algorithm is GPU-friendly) then it's probably worth the overhead of the communication round trip to the GPU.</p>\n\n<p>If you're using the CPU, then anything we can suggest will benefit from parallelizing over multiple cores, so do that for more throughput.</p>\n\n<hr>\n\n<p><strong>x86 SIMD (SSE4/AVX2/AVX512*) doesn't have SIMD integer division in hardware</strong>.  The Intel SVML functions <a href=\"https://software.intel.com/en-us/cpp-compiler-developer-guide-and-reference-mm-div-epu64-mm256-div-epu64\" rel=\"nofollow noreferrer\"><code>_mm_div_epu64</code> and <code>_mm256_div_epu64</code></a> are <em>not</em> intrinsics for a real instruction, they're slow functions that maybe unpack to scalar or compute multiplicative inverses.  Or whatever other trick they use; possibly the 32-bit division functions convert to SIMD vectors of <code>double</code>, especially if AVX512 is available.  (Intel still calls them \"intrinsics\" maybe because they're like built-in function that it understands and can do constant-propagation through.  They're probably as efficient as they can be, but that's \"not very\", and they need to handle the general case, not just your special case with the low half of one divisor being all zero and the quotient fitting in 32 bits.)</p>\n\n<p><strong>If you have the same divisor for many elements</strong>, see <a href=\"https://libdivide.com/\" rel=\"nofollow noreferrer\">https://libdivide.com/</a> for SIMD to compute a multiplicative inverse once and apply it repeatedly.  (You should adapt that technique to bake in the shifting of the dividend without actually doing it, leaving the all-zero low half implicit.)</p>\n\n<p>If your divisor is always varying, and this isn't a middle step in some larger SIMD-friendly algorithm, scalar division may well be your best bet if you need exact results.</p>\n\n<hr>\n\n<h2>You could get big speedups from using SIMD <code>float</code> if 24-bit mantissa precision is sufficient</h2>\n\n<pre><code>uint32_t ScaledDiv(uint32_t a, uint32_t b) \n{\n    return ((1ULL&lt;&lt;32) * (float)b) / a;\n}\n</code></pre>\n\n<p><code>(float)(1ULL&lt;&lt;32)</code> is a compile-time constant <code>4294967296.0f</code>.</p>\n\n<p><strong>This does auto-vectorize over an array</strong>, with gcc and clang even without <code>-ffast-math</code> (but not MSVC).  <a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(fontScale:1.2899450879999999,j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdint.h%3E%0A%23include+%3Cimmintrin.h%3E%0A%0A//+use+int32_t+for+much+more+efficient+non-AVX512+auto-vectorization%0A//+and+for+MSVC+to+auto-vectorize+at+all%0Auint32_t+ScaledDiv(uint32_t+a,+uint32_t+b)+%0A%7B%0A++++return+((1ULL%3C%3C32)+*+(float)b)+/+a%3B%0A%0A/*%0A//+pre-condition:+a+%3E+b+else+64/32-bit+division+overflows%0A+++%09uint32_t+remainder%3B%0A+++%09uint64_t+d+%3D+((uint64_t)+b)+%3C%3C+32%3B%0A+++%09return+_udiv64(d,+a,+%26remainder)%3B%0A*/%0A%7D%0A%0Avoid+foo(uint32_t+*a,+uint32_t+*b)+%7B%0A++++for(int+i%3D0+%3B+i%3C1024+%3B+i%2B%2B)+%7B%0A++++++++a%5Bi%5D+%3D+ScaledDiv(a%5Bi%5D,+b%5Bi%5D)%3B%0A++++%7D%0A%7D%0A%0Aint+main()+%7B%0A%09uint32_t+a+%3D+5%3B%0A%09uint32_t+b+%3D+4%3B%0A%09uint32_t+c+%3D+ScaledDiv(a,+b)%3B%0A%09return+c%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:35.563973063973066,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:clang800,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3+-xc+-Wall+-march%3Dskylake&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+8.0.0+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:50,l:&#39;4&#39;,m:49.652900075720325,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:cl_new_64,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!(),options:&#39;-O2+-TC+-arch:AVX2&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x64+msvc+v19.14+(WINE)+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:50,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:64.43602693602693,l:&#39;2&#39;,m:100.00000000000001,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">See it on Godbolt</a>.  You could port gcc or clang's asm back to intrinsics for MSVC; they use some FP tricks for packed-conversion of unsigned integers to/from float without AVX512.  Non-vectorized scalar FP will probably be slower than plain integer on MSVC, as well as less accurate.</p>\n\n<p>For example, Skylake's <code>div r32</code> throughput is 1 per 6 cycles.  But its AVX <code>vdivps ymm</code> throughput is one instruction (of 8 <code>float</code>s) per 5 cycles.  Or for 128-bit SSE2, <code>divps xmm</code> has one per 3 cycle throughput.  <strong>So you get about 10x the division throughput</strong> from AVX on Skylake. (8 * 6/5 = 9.6)  Older microarchitectures have much slower SIMD FP division, but also somewhat slower integer division.  In general the ratio is smaller because older CPUs don't have as wide SIMD dividers, so 256-bit <code>vdivps</code> has to run the 128-bit halves through separately.  But there's still plenty of gain to be had, like better than a factor of 4 on Haswell.  And Ryzen has <code>vdivps ymm</code> throughput of 6c, but <code>div 32</code> throughput of 14-30 cycles.  So that's an even bigger speedup than Skylake.</p>\n\n<p>If the rest of your DSP task can benefit from SIMD, the overall speedup should be very good.  <code>float</code> operations have higher latency, so out-of-order execution has to work harder to hide that latency and overlap execution of independent loop iterations.  So <strong>IDK whether it would be better for you to just convert to float and back for this one operation, or to change your algorithm to work with <code>float</code> everywhere</strong>.  It depends what else you need to do with your numbers.</p>\n\n<hr>\n\n<p><strong>If your unsigned numbers actually fit into <em>signed</em> 32-bit integers, you can use direct hardware support for packed SIMD int32 -> float conversion</strong>.  Otherwise you need AVX512F for packed <code>uint32</code> -> float with a single instruction, but that can be emulated with some loss of efficiency.  That's what gcc/clang do when auto-vectorizing with AVX2, and why MSVC <em>doesn't</em> auto-vectorize.</p>\n\n<p>MSVC does auto-vectorize with <code>int32_t</code> instead of <code>uint32_t</code> (and gcc/clang can make more efficient code), so prefer that if the highest bit of your integer inputs and/or outputs can't be set.  (i.e. the 2's complement interpretation of their bit-patterns will be non-negative.)</p>\n\n<p>With AVX especially, <code>vdivps</code> is slow enough to mostly hide the throughput costs of converting from integer and back, unless there's other useful work that could have overlapped instead.</p>\n\n<hr>\n\n<h3>Floating point precision:</h3>\n\n<p>A <code>float</code> stores numbers as <code>significand * 2^exp</code> where the significand is in the range <code>[1.0, 2.0)</code>.  (Or <code>[0, 1.0)</code> for subnormals).  A single-precision <code>float</code> has 24-bits of significand precision, including the 1 implicit bit.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Single-precision_floating-point_format</a></p>\n\n<p>So the 24 most-significant digits of an integer can be represented, the rest lost to rounding error.  An integer like <code>(uint64_t)b &lt;&lt; 32</code> is no problem for <code>float</code>; that just means a larger exponent.  The low bits are all zero.</p>\n\n<p>For example, <code>b = 123105810</code> gives us <code>528735427897589760</code> for <code>b64 &lt;&lt; 32</code>.  Converting that to <code>float</code> directly from 64-bit integer gives us <code>528735419307655168</code>, a rounding error of 0.0000016%, or about 2^-25.8.  That's unsurprising: the max rounding error is 0.5ulp (units in the last place), or 2^-25, and this number was even so it had 1 trailing zero anyway.  That's the same relative error we'd get from converting <code>123105810</code>; the resulting <code>float</code> is also the same except for its exponent field (which is higher by 32).</p>\n\n<p>(I used <a href=\"https://www.h-schmidt.net/FloatConverter/IEEE754.html\" rel=\"nofollow noreferrer\">https://www.h-schmidt.net/FloatConverter/IEEE754.html</a> to check this.)</p>\n\n<p><code>float</code>'s max exponent is large enough to hold integers outside the <code>INT64_MIN</code> to  <code>INT64_MAX</code> range.  The low bits of the large integers that <code>float</code> can represent are all zero, but that's exactly what you have with <code>b&lt;&lt;32</code>.  So you're only losing the low 9 bits of <code>b</code> in the worst case where it's full-range and odd.</p>\n\n<p><strong>If the important part of your result is the most-significant bits, and having the low ~9 integer bits = rounding error is ok after converting back to integer, then <code>float</code> is perfect for you.</strong></p>\n\n<h3>If <code>float</code> doesn't work, <code>double</code> may be an option.</h3>\n\n<p><code>divpd</code> is about twice as slow as <code>divps</code> on many CPUs, and only does half as much work (2 <code>double</code> elements instead of 4 <code>float</code>).  So you lose a factor of 4 throughput this way.</p>\n\n<p>But <strong>every 32-bit integer can be represented exactly as a <code>double</code>.</strong>  And by converting back with truncation towards zero, I think you get exact integer division for all pairs of inputs, unless <a href=\"https://www.exploringbinary.com/double-rounding-errors-in-floating-point-conversions/\" rel=\"nofollow noreferrer\">double-rounding is a problem (first to nearest <code>double</code>, then truncation)</a>.  You can test it with</p>\n\n<pre><code>// exactly correct for most inputs at least, maybe all.\nuint32_t quotient = ((1ULL&lt;&lt;32) * (double)b) / a;\n</code></pre>\n\n<p>The unsigned long long constant <code>(1ULL&lt;&lt;32)</code> is converted to <code>double</code>, so you have 2x u32 -> double conversions (of <code>a</code> and <code>b</code>), a double multiply, a double divide, and a double -> u32 conversion.  x86-64 can do all of these efficiently with scalar conversions (by zero extending <code>uint32_t</code> into <code>int64_t</code>, or ignoring the high bits of a double->int64_t conversion), but it will probably still be slower than <code>div r32</code>.</p>\n\n<p>Converting u32 -> double and back (without AVX512) is maybe even more expensive that converting u32 -> float, but clang <em>does</em> auto-vectorize it. \n (Just change <code>float</code> to <code>double</code> in the godbolt link above).  Again it would help a lot if your inputs were all <code>&lt;= INT32_MAX</code> so they could be treated as signed integers for FP conversion.</p>\n\n<p>If double-rounding is a problem, you could maybe set the FP rounding mode to truncation instead of the default round-to-nearest, if you don't use FP for anything else in the thread where your DSP code is running.</p>\n"}], "owner": {"reputation": 1281, "user_id": 9242492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBHcC.gif?s=128&g=1", "display_name": "George Robinson", "link": "https://stackoverflow.com/users/9242492/george-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 56659086, "answer_count": 2, "score": 4, "last_activity_date": 1573315105, "creation_date": 1560892961, "last_edit_date": 1573315105, "question_id": 56657236, "link": "https://stackoverflow.com/questions/56657236/how-can-i-instruct-the-msvc-compiler-to-use-a-64bit-32bit-division-instead-of-th", "title": "How can I instruct the MSVC compiler to use a 64bit/32bit division instead of the slower 128bit/64bit division?", "body": "<p>How can I tell the MSVC compiler to use the 64bit/32bit division operation to compute the result of the following function for the x86-64 target:</p>\n\n<pre><code>#include &lt;stdint.h&gt; \n\nuint32_t ScaledDiv(uint32_t a, uint32_t b) \n{\n  if (a &gt; b)\n        return ((uint64_t)b&lt;&lt;32) / a;   //Yes, this must be casted because the result of b&lt;&lt;32 is undefined\n  else\n        return uint32_t(-1);\n}\n</code></pre>\n\n<p>I would like the code, when the <code>if</code> statement is true, to compile to use the 64bit/32bit division operation, e.g. something like this:</p>\n\n<pre><code>; Assume arguments on entry are: Dividend in EDX, Divisor in ECX\nmov edx, edx  ;A dummy instruction to indicate that the dividend is already where it is supposed to be\nxor eax,eax\ndiv ecx   ; EAX = EDX:EAX / ECX\n</code></pre>\n\n<p>...however the x64 MSVC compiler insists on using the 128bit/64bit <code>div</code> instruction, such as:</p>\n\n<pre><code>mov     eax, edx\nxor     edx, edx\nshl     rax, 32                             ; Scale up the dividend\nmov     ecx, ecx\ndiv rcx   ;RAX = RDX:RAX / RCX\n</code></pre>\n\n<p>See: <a href=\"https://www.godbolt.org/z/VBK4R7\" rel=\"nofollow noreferrer\">https://www.godbolt.org/z/VBK4R7</a><a href=\"https://www.godbolt.org/z/VBK4R7\" rel=\"nofollow noreferrer\">1</a></p>\n\n<p>According to the answer to <a href=\"https://stackoverflow.com/questions/56655383/can-128bit-64bit-hardware-unsigned-division-be-faster-in-some-cases-than-64bit-3\">this question</a>, the 128bit/64bit <code>div</code> instruction is <strong>not faster</strong> than the 64bit/32bit <code>div</code> instruction.</p>\n\n<p>This is a problem because it unnecessarily slows down my DSP algorithm which makes millions of these scaled divisions.</p>\n\n<p>I tested this optimization by patching the executable to use the 64bit/32bit div instruction: <strong>The performance increased 28%</strong> according to the two timestamps yielded by the <code>rdtsc</code> instructions.</p>\n\n<p>(Editor's note: presumably on some recent Intel CPU.  AMD CPUs don't need this micro-optimization, as explained in the linked Q&amp;A.)</p>\n"}, {"tags": ["c", "arduino", "raspberry-pi", "embedded", "can-bus"], "comments": [{"owner": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "edited": false, "score": 0, "creation_date": 1560928512, "post_id": 56656994, "comment_id": 99892819, "body": "From the MPC_CAN_lib github, it says : &quot;The readMsgBuf() functions bring in the message ID. The getCanId() function is obsolete and no longer exists, don&#39;t use it.&quot;. Are you using an older version?"}, {"owner": {"reputation": 757, "user_id": 1895422, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/6f848a38041cd29214f4b2897675b710?s=128&d=identicon&r=PG", "display_name": "gandalfml", "link": "https://stackoverflow.com/users/1895422/gandalfml"}, "reply_to_user": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "edited": false, "score": 0, "creation_date": 1561024439, "post_id": 56656994, "comment_id": 99932424, "body": "I&#39;m using the newest version of <a href=\"https://github.com/Seeed-Studio/CAN_BUS_Shield/\" rel=\"nofollow noreferrer\">github.com/Seeed-Studio/CAN_BUS_Shield</a> it seems that <a href=\"https://github.com/coryjfowler/MCP_CAN_lib\" rel=\"nofollow noreferrer\">github.com/coryjfowler/MCP_CAN_lib</a> is some newer version of the lib. I&#39;ll try it tomorrow. Thanks for a suggestion"}, {"owner": {"reputation": 757, "user_id": 1895422, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/6f848a38041cd29214f4b2897675b710?s=128&d=identicon&r=PG", "display_name": "gandalfml", "link": "https://stackoverflow.com/users/1895422/gandalfml"}, "reply_to_user": {"reputation": 356, "user_id": 11529570, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R-mpcH1QMhg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfNaFZxNZiJnErSywAwf6gumCEMoQ/mo/photo.jpg?sz=128", "display_name": "Beno&#238;t", "link": "https://stackoverflow.com/users/11529570/beno%c3%aet"}, "edited": false, "score": 1, "creation_date": 1561243506, "post_id": 56656994, "comment_id": 100000611, "body": "Sorry for late response, the new library (<a href=\"https://github.com/coryjfowler/MCP_CAN_lib\" rel=\"nofollow noreferrer\">github.com/coryjfowler/MCP_CAN_lib</a>) worked out of the box :) thank you :) I can write some more complete answer to this later"}], "owner": {"reputation": 757, "user_id": 1895422, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/6f848a38041cd29214f4b2897675b710?s=128&d=identicon&r=PG", "display_name": "gandalfml", "link": "https://stackoverflow.com/users/1895422/gandalfml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560929665, "creation_date": 1560891726, "last_edit_date": 1560929665, "question_id": 56656994, "link": "https://stackoverflow.com/questions/56656994/cannot-send-can-messages-between-two-arduino", "title": "Cannot send CAN messages between two arduino", "body": "<p>I'm trying to set up local CAN bus between two Arduino boards (mega and pro micro). But I cannot make them receive any message from each other...</p>\n\n<p>For both boards, I'm using this CAN module: <a href=\"https://rads.stackoverflow.com/amzn/click/com/B015W4D9WY\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">https://www.amazon.com/CHENBO-Electronics-Receiver-Controller-Development/dp/B015W4D9WY/ref=sr_1_3</a></p>\n\n<p>The connection between the Arduino board and CAN is done in the following way:</p>\n\n<p>ProMicro:</p>\n\n<ul>\n<li>VCC on the module - VCC from micro</li>\n<li>GND on the module - GND from micro</li>\n<li>CS on the module -PIN 10 on board</li>\n<li>SO on the module -PIN 14 on board</li>\n<li>SI on the module - PIN 16 on board</li>\n<li>SCK on the module - PIN 15 on board</li>\n</ul>\n\n<p>Mega 2560:</p>\n\n<ul>\n<li>VCC on the module - 5V VCC from micro</li>\n<li>GND on the module - GND from micro</li>\n<li>CS on the module -PIN 53 on board</li>\n<li>SO on the module -PIN 50 on board</li>\n<li>SI on the module - PIN 51 on board</li>\n<li>SCK on the module - PIN 52 on board</li>\n</ul>\n\n<p>Both boards are connected to the PC and attached to the Serial monitor.</p>\n\n<p>I have also a raspberry PI for debugging purposes with this module: <a href=\"https://www.waveshare.com/rs485-can-hat.htm\" rel=\"nofollow noreferrer\">https://www.waveshare.com/rs485-can-hat.htm</a></p>\n\n<p>From the software, I'm using this Arduino library: <a href=\"https://github.com/Seeed-Studio/CAN_BUS_Shield\" rel=\"nofollow noreferrer\">https://github.com/Seeed-Studio/CAN_BUS_Shield</a>\nand this one for Raspberry: <a href=\"https://github.com/sebi2k1/node-can\" rel=\"nofollow noreferrer\">https://github.com/sebi2k1/node-can</a></p>\n\n<p>This is the code for Arduino micro:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define DEBUG_EN 1\n#include &lt;SPI.h&gt;\n#include \"mcp_can.h\"\n\nconst int SPI_CS_PIN = 10;\n\nlong unsigned int rxId;\nunsigned char len = 0;\nunsigned char buf[8];\n\nlong unsigned int txID = 0xF0;\nunsigned char stmp[8] = {0, 9, 8, 7, 6, 5, 4, 3};\n\nMCP_CAN CAN(SPI_CS_PIN);\n\nvoid setup()\n{\n  Serial.begin(9600);\n  delay(1000);\n\n  while (CAN_OK != CAN.begin(CAN_500KBPS, MCP_8MHz))\n  {\n    Serial.println(\"CAN BUS Module Failed to Initialize\");\n    Serial.println(\"Retrying....\");\n    delay(200);\n  }\n  Serial.println(\"CAN BUS Module Initialized!\");\n  Serial.println(\"PGN\\t\\tByte0\\tByte1\\tByte2\\tByte3\\tByte4\\tByte5\\tByte6\\tByte7\");\n}\n\nvoid loop()\n{\n  if (CAN_MSGAVAIL == CAN.checkReceive())\n  {\n    Serial.println(\"I have something on micro...\");\n    CAN.readMsgBuf(&amp;len, buf);\n    rxId = CAN.getCanId();\n\n    Serial.print(\"0x\");\n    Serial.print(rxId, HEX);\n    Serial.print(\"\\t\");\n\n    for (int i = 0; i &lt; len; i++)\n    {\n      if (buf[i] &gt; 15)\n      {\n        Serial.print(\"0x\");\n        Serial.print(buf[i], HEX);\n      }\n      else\n      {\n        Serial.print(\"0x0\");\n        Serial.print(buf[i], HEX);\n      }\n      Serial.print(\"\\t\");\n    }\n    Serial.println();\n\n    Serial.println(\"sending message...\");\n    CAN.sendMsgBuf(txID, 1, 8, stmp);\n  }\n}\n</code></pre>\n\n<p>Almost the same for Arduino mega:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;mcp_can.h&gt;\n#include &lt;SPI.h&gt;\n\nconst int SPI_CS_PIN = 53;\n\nunsigned char len = 0;\nunsigned char buf[8];\nlong unsigned int rxId;\n\nlong unsigned int txID = 0xFF;\nunsigned char stmp[8] = {1, 2, 3, 4, 5, 6, 7, 8};\n\nMCP_CAN CAN(SPI_CS_PIN);\n\nvoid setup()\n{\n  Serial.begin(9600);\n  delay(1000);\n\n  while (CAN_OK != CAN.begin(CAN_500KBPS, MCP_8MHz))\n  {\n    Serial.println(\"CAN BUS Module Failed to Initialize\");\n    Serial.println(\"Retrying....\");\n    delay(200);\n  }\n  Serial.println(\"CAN BUS Module Initialized!\");\n  Serial.println(\"PGN\\t\\tByte0\\tByte1\\tByte2\\tByte3\\tByte4\\tByte5\\tByte6\\tByte7\");\n}\n\nvoid loop()\n{\n  if (CAN_MSGAVAIL == CAN.checkReceive())\n  {\n    Serial.println(\"I have something no mega...\");\n    CAN.readMsgBuf(&amp;len, buf);\n    rxId = CAN.getCanId();\n\n    Serial.print(\"0x\");\n    Serial.print(rxId, HEX);\n    Serial.print(\"\\t\");\n\n    for (int i = 0; i &lt; len; i++)\n    {\n      if (buf[i] &gt; 15)\n      {\n        Serial.print(\"0x\");\n        Serial.print(buf[i], HEX);\n      }\n      else\n      {\n        Serial.print(\"0x0\");\n        Serial.print(buf[i], HEX);\n      }\n      Serial.print(\"\\t\");\n    }\n    Serial.println();\n\n    Serial.println(\"sending...\");\n    CAN.sendMsgBuf(txID, 1, 8, stmp);\n  }\n}\n</code></pre>\n\n<p>And debug code on raspberry:</p>\n\n<pre><code>var can = require(\"socketcan\");\n\nvar channel = can.createRawChannel(\"can0\", true);\n\n// Log any message\nchannel.addListener(\"onMessage\", function(msg) {\n    console.log(msg);\n});\n\nchannel.start();\nconsole.log(\"Sending initial message...\");\nchannel.send({id: 0x0F, ext: 1, rtr: false, data: Buffer.from([1, 1, 1, 1, 1, 1, 1, 1])});\nconsole.log(\"Listening to messages\");\n</code></pre>\n\n<p>Before starting the test I'm executing those commands on Raspberry:</p>\n\n<pre><code>sudo ip link set can0 type can bitrate 500000\nsudo ifconfig can0 up\n</code></pre>\n\n<p>And those are the outputs:</p>\n\n<p>from Raspberry:</p>\n\n<pre><code>Sending initial message...\nListening to messages\n{ ts_sec: 1560890627,\n  ts_usec: 297829,\n  id: 240,\n  ext: true,\n  data: &lt;Buffer 00 09 08 07 06 05 04 03&gt; }\n{ ts_sec: 1560890627,\n  ts_usec: 318244,\n  id: 255,\n  ext: true,\n  data: &lt;Buffer 01 02 03 04 05 06 07 08&gt; }\n</code></pre>\n\n<p>which means that both Arduino boards are sending correct data to CAN bus...</p>\n\n<p>from Arduino Micro:</p>\n\n<pre><code>lib is working....\nEnter setting mode success \nset rate success!!\nEnter Normal Mode Success!!\nCAN BUS Module Initialized!\nPGN     Byte0   Byte1   Byte2   Byte3   Byte4   Byte5   Byte6   Byte7\nI have something on micro...\n0xF 0x01    0x01    0x01    0x01    0x01    0x01    0x01    0x01    \nsending message...\n</code></pre>\n\n<p>Here I'm missing a message from Arduino Mega</p>\n\n<p>and from Arduino Mega</p>\n\n<pre><code>lib is working....\nEnter setting mode success \nset rate success!!\nEnter Normal Mode Success!!\nCAN BUS Module Initialized!\nPGN     Byte0   Byte1   Byte2   Byte3   Byte4   Byte5   Byte6   Byte7\nI have something no mega...\n0xF 0x01    0x01    0x01    0x01    0x01    0x01    0x01    0x01    \nsending...\n</code></pre>\n\n<p>Here also the problem is that there is no message from Arduino Micro</p>\n\n<p>How I can make Arduino boards to receive all messages from the CAN bus?</p>\n"}, {"tags": ["c", "compiler-construction"], "comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 3, "creation_date": 1560891507, "post_id": 56656914, "comment_id": 99883834, "body": "what do you mean by <code>the compiler has no knowledge that setjmp&#47;longjmp are special functions</code> ?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1560892189, "post_id": 56656914, "comment_id": 99884075, "body": "Statement 1: <i>&quot;I think that is a perfectly valid thing for a compiler to do.&quot;</i> Statement 2: <i>&quot;But since setjmp returns twice this corrupts the variable while the C standard say it should not.&quot;</i> Statement 2 is correct that the C standard says it should not. Therefore statement 1 is false, it is <b><i>not</i></b> a perfectly valid thing for a compiler to do."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1560892746, "post_id": 56656914, "comment_id": 99884275, "body": "BTW: the statement <i>&quot;lets say the compiler has no knowledge that setjmp/longjmp are special functions&quot;</i> is also problematic. The <code>setjmp</code> and and <code>longjmp</code> functions are defined by the standard, and <i>are</i> special in the sense that they don&#39;t behave like other function calls. So if the compiler doesn&#39;t treat them as special, then the compiler must treat <i>all</i> function calls as if they were calls to <code>setjmp</code> or <code>longjmp</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1560893116, "post_id": 56656914, "comment_id": 99884391, "body": "Which brings us to the heart of the matter. Where did you get that assembly code? Is that something that you just made up? Or is that the output of an actual compiler (that was given the exact C code shown in the question)?"}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1560893591, "post_id": 56656914, "comment_id": 99884559, "body": "It&#39;s what I get when I naively translate the C code by hand."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1560893761, "post_id": 56656914, "comment_id": 99884608, "body": "@alinsoar The compiler doesn&#39;t have an <code>if (ident==&quot;setjmp&quot;) { &#47;&#47; generate code special for setjmp calls } else { &#47;&#47; generate code the normal way }</code>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1560894434, "post_id": 56656914, "comment_id": 99884793, "body": "@GoswinvonBrederlow Actually, the compiler probably does have that. Or some other special marker. The <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.7.0/gcc/Function-Attributes.html\" rel=\"nofollow noreferrer\">GCC manual</a> says that setjmp should have a special marker <code>__attribute__((returns_twice))</code>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1560922649, "post_id": 56656914, "comment_id": 99890336, "body": "<code>setjmp</code> is a macro, not a function, although the macro could be implemented using a function, even a function with the same name. But a programmer is not allowed to bypass the macro, say by #undef, even if there happens to be a function of the same name. So there is an expectation that a given C implementation might need to do something non-standard."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1560931721, "post_id": 56656914, "comment_id": 99894455, "body": "@rici That helps and I would accept that as answer. A compiler that uses push/pop to save automatic variables across function calls like my example above would need setjmp as macro that saves all regs without function call that triggers those push/pop operations and the problem would go away."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1560976575, "post_id": 56656914, "comment_id": 99918236, "body": "@goswin: ok, i tried to expand that comment into an answer."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1561008170, "post_id": 56656914, "comment_id": 99924987, "body": "It&#39;s hard to believe in the existence of a C compiler that provides <code>setjmp()</code> in its headers and/or runtime library but doesn&#39;t know what its semantics are."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1561113484, "post_id": 56656914, "comment_id": 99967100, "body": "@user207421 On linux setjmp is provided by glibc as a plain function. Doesn&#39;t even have <code>__attribute__((returns_twice))</code>. The verry basic compiler I&#39;m writing for fun so far has no special case for setjmp. So start believing. My compiler design simply isn&#39;t compatible with glibc&#39;s implementation of setjmp. Not every combination of compiler and libc can work."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1561130993, "post_id": 56656914, "comment_id": 99976122, "body": "&quot;Not every combination of compiler and libc can work.&quot; This. An implementation can be viewed as consisting of a compiler, a linker and the standard library to be linked; the components are not independent of each other (and do not even need to be separate components).  <code>setjmp</code> is far from the only standard library facility which cannot be expressed in portable standard C."}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1560922404, "post_id": 56658565, "comment_id": 99890268, "body": "You have an example of an architecture which doesn&#39;t support setjmp? It&#39;s part of the C standard, so its only optional in a freestanding environment."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1560932137, "post_id": 56658565, "comment_id": 99894661, "body": "This is a non-answer. I already stated in the question that the resulting code behaves wrong. I&#39;m looking for something more constructive than: It&#39;s wrong because it&#39;s wrong. Rici&#39;s comment on the question nailed it for me."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1560903512, "creation_date": 1560903512, "answer_id": 56658565, "question_id": 56656914, "link": "https://stackoverflow.com/questions/56656914/why-is-this-compiler-output-wrong-when-setjmp-is-involved/56658565#56658565", "title": "Why is this compiler output wrong when setjmp is involved?", "body": "<blockquote>\n  <p>Why is this compiler output wrong when setjmp is involved?</p>\n</blockquote>\n\n<p>Because the compiler is not standard conforming. Because the side effects produced upon execution of the generated machine code do not correspond with the specification of the abstract machine as laid down in the C standard. Your code is an easy example, as <code>printf</code> produces a side effect. The compilers (only) job is generally to translate sentences from one language to another, so that side effects stay the same. If it fails to do that, well, it's broken.</p>\n\n<p>The <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.13.2.1p3\" rel=\"nofollow noreferrer\">C11 7.13.2.1p3</a> says:</p>\n\n<blockquote>\n  <p>All accessible objects have values, and all other components of the abstract machine have state, as of the time the longjmp function was called, except that the values of objects of automatic storage duration that are local to the function containing the invocation of the corresponding setjmp macro that do not have volatile-qualified type and have been changed between the setjmp invocation and longjmp call are indeterminate.</p>\n</blockquote>\n\n<p><code>x</code> has automatic storage duration and is a local variable in a function and is not volatile, but it wasn't modified between the calls <code>setjmp</code> and <code>longjmp</code>. So, if <code>x</code> had some value before calling <code>longjmp</code>, it has to have the same value after calling <code>longjmp</code>.</p>\n\n<p>A compiler that generates assembly code that does not conform to this specification is a not-conforming C compiler, or, in harsher words, it is not a C compiler at all.</p>\n\n<p>There are compilers and architectures that just do not support <code>setjmp</code>/<code>longjmp</code> calls, and, well, it's fine. Such compilers explicitly state that they do not support <code>setjmp</code> and for example they can lack <code>setjmp.h</code> header, so that using it is impossible.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 2, "last_activity_date": 1560976527, "creation_date": 1560976527, "answer_id": 56675476, "question_id": 56656914, "link": "https://stackoverflow.com/questions/56656914/why-is-this-compiler-output-wrong-when-setjmp-is-involved/56675476#56675476", "title": "Why is this compiler output wrong when setjmp is involved?", "body": "<p><code>setjmp</code> is a macro, not a function, which is a recognition by the standard that on certain implementations it might require features not available to normal functions. </p>\n\n<p>The standard explicitly allows the macro to simply expand to a function of the same name, for the case of implementations in which it can be implemented with a function using standard call semantics. However, if an application program attempts to bypass the macro, either with #undef or by using <code>(setjmp)(jmpbuf)</code>, it incurs Undefined Behaviour. This is the opposite of normal standard library functions which can also be implemented as macros as well as functions, but which can be accessed using the above techniques to avoid macro expansion.</p>\n\n<p>Also, the fact that <code>setjmp</code> is specified to be a macro means that <code>&amp;setbuf</code> is also undefined behaviour. In fact, the standard only allows a call to <code>setbuf</code> in two contexts:</p>\n\n<ol>\n<li><p>As a complete expression statement, possibly with an explicit cast to <code>void</code></p></li>\n<li><p>In the condition of an <code>if</code> or loop statement, and only when the condition is</p>\n\n<ul>\n<li><p>The <code>setjmp</code> call itself</p></li>\n<li><p>The operator <code>!</code> with the <code>setjmp</code> call as its argument</p></li>\n<li><p>A comparison between the <code>setjmp</code> call and an integer constant.</p></li>\n</ul></li>\n</ol>\n\n<p>In other words, the value of the call to <code>setjmp</code> cannot be saved or participate in arithmetic, and no other computation can be performed inside the sequence points which surround the context of the call.</p>\n\n<p>So the standards gives an implementation has lots of latitude for the implementation of <code>setjmp</code>.</p>\n"}], "owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 56675476, "answer_count": 2, "score": -1, "last_activity_date": 1560976527, "creation_date": 1560891319, "question_id": 56656914, "link": "https://stackoverflow.com/questions/56656914/why-is-this-compiler-output-wrong-when-setjmp-is-involved", "title": "Why is this compiler output wrong when setjmp is involved?", "body": "<p>Given this C code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;setjmp.h&gt;\nvoid foo(int x) {\n  jmp_buf env;\n  if (setjmp(env) == 0) {\n    printf(\"%d\\n\", 23);\n    longjmp(env, 1);\n  } else {\n    printf(\"%d\\n\", x);\n  }\n}\n</code></pre>\n\n<p>The result should be that it prints 23 and then x and it should be all well defined.</p>\n\n<p>But lets say the compiler has no knowledge that setjmp/longjmp are special functions and it generates the following code:</p>\n\n<pre><code>;function foo\n;r0 : int x\n\nfoo:\n    sub sp, sp, #sizeof(jmp_buf) ; reserve space for env\n    push r0         ; save x for later\n    add r0, sp, #4  ; load address of env\n    call setjmp\n    pop r1          ; restore SP, move x to r1 &lt;&lt;== corrupt after jongjmp\n    cmp r0, #0      ; if (setjmp(env) == 0)\n    bne 1f\n    lea r0, \"%d\\n\"  ; printf(\"%d\\n\", 23)\n    mov r1, #23\n    call printf\n    mov r0, sp  ; load address of env\n    mov r1, #1\n    call longjmp\n    b 2f\n1:\n    lea r0, \"%d\\n\"      ; printf(\"%\\dn\", x), x already in r1\n    call printf\n2:\n    add sp, sizeof(jmp_buf)\n    ret\n</code></pre>\n\n<p>This will print 23 as expected but then it prints the retrun address of the longjmp call, i.e. the address of the 1 label.</p>\n\n<p>The variable x is only temporarily stored on the stack to preserve it across the setjmp function call (r0, being an argument register, is caller saved). I think that is a perfectly valid thing for a compiler to do. But since setjmp returns twice this corrupts the variable while the C standard say it should not.</p>\n"}, {"tags": ["c", "h.264", "rtsp", "rtp"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "edited": false, "score": 0, "creation_date": 1562619780, "post_id": 56656837, "comment_id": 100425062, "body": "thank you. I looking for understand the h264 data that wrap with rtp. Is in h264  data is there sequence number and/timestamp for each packet or those data only in rtp data?"}], "tags": [], "owner": {"reputation": 10998, "user_id": 1458617, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0790c4e75c14c45344fef4937aac2e8a?s=128&d=identicon&r=PG", "display_name": "Rudolfs Bundulis", "link": "https://stackoverflow.com/users/1458617/rudolfs-bundulis"}, "is_accepted": false, "score": 1, "last_activity_date": 1560892453, "last_edit_date": 1560892453, "creation_date": 1560890952, "answer_id": 56656837, "question_id": 56656633, "link": "https://stackoverflow.com/questions/56656633/identify-idr-packet-in-h264-over-rtp/56656837#56656837", "title": "Identify idr packet in h264 over rtp", "body": "<p>The code you posted does not cover all the cases. You should actually start by reading the <a href=\"https://tools.ietf.org/html/rfc3984\" rel=\"nofollow noreferrer\">rfc</a> on RTP payload format for H.264. Depending on the RTP packetization the IDR can come in different RTP packet types:</p>\n\n<ul>\n<li>Single nal unit packet</li>\n<li>STAP-A/STAP-B packet</li>\n<li>MTAP packet</li>\n<li>FU-A/FU-B packet.</li>\n</ul>\n\n<p>The code you posted actually handles FU-A/FU-B (via the <code>(fragment_type == 28 || fragment_type == 29) &amp;&amp; nal_type == 5 &amp;&amp; start_bit == 128)</code> check) and single nal unit case (via the <code>fragment_type == 5</code> check). RTP actually does not use the <code>00 00 00 01</code> and <code>00 00 01</code> prefixes, those are used in Annex B format. So you just need to be able to determine the type of the packet and contained NAL unit type from the RTP header. How to do that should be clear after reading the RFC.</p>\n"}], "owner": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560892453, "creation_date": 1560889814, "last_edit_date": 1592644375, "question_id": 56656633, "link": "https://stackoverflow.com/questions/56656633/identify-idr-packet-in-h264-over-rtp", "title": "Identify idr packet in h264 over rtp", "body": "<p>I tried to Identify idr packet in c from h264 over rtp.</p>\n<p>I follow this <a href=\"https://stackoverflow.com/questions/24884827/possible-locations-for-sequence-picture-parameter-sets-for-h-264-stream\">answer</a> but I don't understand.</p>\n<p>Do I need to search <code>00 00 01</code> or <code>00 00 00 01</code> and than 0x65 mean start code of idr?</p>\n<p>Because I saw a table of all defined NALUs</p>\n<blockquote>\n<p>Type Name</p>\n<pre><code>0 [unspecified]\n\n1 Coded slice\n2 Data Partition A\n\n3 Data Partition B\n4 Data Partition C\n\n5 IDR (Instantaneous Decoding Refresh) Picture\n6 SEI (Supplemental Enhancement Information)\n7 SPS (Sequence Parameter Set)\n8 PPS (Picture Parameter Set)\n9 Access Unit Delimiter    10 EoS (End of Sequence)    11 EoS (End of Stream)    12 Filter Data 13-23 [extended] 24-31 [unspecified]\n</code></pre>\n</blockquote>\n<p>And this code that looking about another conditions (type=5 and more)</p>\n<pre><code>public static bool \nisH264iFrame(byte[] paket)\n{\n    int RTPHeaderBytes = 0;\n\n    int fragment_type = paket[RTPHeaderBytes + 0] &amp; 0x1F;\n    int nal_type = paket[RTPHeaderBytes + 1] &amp; 0x1F;\n    int start_bit = paket[RTPHeaderBytes + 1] &amp; 0x80;\n\n    if (((fragment_type == 28 || fragment_type == 29) &amp;&amp; nal_type == 5 &amp;&amp; start_bit == 128) || fragment_type == 5)\n    {\n        return true;\n    }\n\n    return false;\n}\n</code></pre>\n<p>So how do identify idr packet?</p>\n"}, {"tags": ["c", "list", "linked-list", "nodes"], "answers": [{"comments": [{"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1560888525, "post_id": 56656223, "comment_id": 99882612, "body": "he cannot remove it; the address of oldRoot is not the same as the address of the outside <code>root</code> of the list.  They are different pointers poiting to the same address.  If you remove the double pointer it will not mutate the outside address."}], "tags": [], "owner": {"reputation": 644, "user_id": 7817501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HoU4f.gif?s=128&g=1", "display_name": "Kevin Pastor", "link": "https://stackoverflow.com/users/7817501/kevin-pastor"}, "is_accepted": false, "score": 2, "last_activity_date": 1560887894, "creation_date": 1560887894, "answer_id": 56656223, "question_id": 56656169, "link": "https://stackoverflow.com/questions/56656169/linked-list-add-new-root-element/56656223#56656223", "title": "Linked list add new root element", "body": "<p>I am pretty sure you could just remove the double pointer since you are, in the end, dereferencing the double pointer. </p>\n\n<pre><code>void elementAsRoot(Element *oldRoot, Element *newRoot) {\n  newRoot-&gt;next = oldRoot;\n  oldRoot = newRoot;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 1, "last_activity_date": 1560888910, "last_edit_date": 1560888910, "creation_date": 1560887940, "answer_id": 56656234, "question_id": 56656169, "link": "https://stackoverflow.com/questions/56656169/linked-list-add-new-root-element/56656234#56656234", "title": "Linked list add new root element", "body": "<p>I answer you by commenting.  Here is what happens inside <code>elementAsRoot</code>.</p>\n\n<blockquote>\n  <p><code>oldRoot</code> is a pointer to the location/address of the variable that keeps the root of the list in the calling function.  You want to mutate this root inside the <code>elementAsRoot</code> and this is why you pass the address of a pointer.</p>\n</blockquote>\n\n<pre><code>void elementAsRoot(Element **oldRoot, Element *newRoot){\n</code></pre>\n\n<blockquote>\n  <p>first you initialize newRoot to point to the old root</p>\n</blockquote>\n\n<pre><code>  newRoot -&gt; next = *oldRoot;\n</code></pre>\n\n<blockquote>\n  <p>next, you mutate the old root (defined externally to this function) to point to the new added node.</p>\n</blockquote>\n\n<pre><code>  *oldRoot = newRoot;\n\n}\n</code></pre>\n\n<p>The calling function looks something like</p>\n\n<pre><code>Element *root, *newroot;\n....  \nnewroot = malloc(sizeof Element);\n// here your list look like root=A =&gt; rest .\n// This call will mutate root to be new.\nelementAsRoot(&amp;root, new);\n// here your list look like root=new =&gt; A =&gt; rest\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 1, "last_activity_date": 1560900277, "creation_date": 1560900277, "answer_id": 56658251, "question_id": 56656169, "link": "https://stackoverflow.com/questions/56656169/linked-list-add-new-root-element/56658251#56658251", "title": "Linked list add new root element", "body": "<pre><code>void elementAsRoot(Element **oldRoot, Element *newRoot){\n  newRoot -&gt; next = *oldRoot;\n  *oldRoot = newRoot;\n}\n</code></pre>\n\n<p>This function is meant to be called like so:</p>\n\n<pre><code>Element *list = ...some linked list...;\nelementAsRoot(&amp;list, ...some new element...);\n// now 'list' points to the new first element, not the old one (which is now second)\n</code></pre>\n\n<p>To update a variable from the caller, the function needs a pointer to the variable. If the first parameter was just <code>list</code>, not <code>&amp;list</code>, then the function would not be able to update the value of <code>list</code> and so it wouldn't be able to do its job.</p>\n"}], "owner": {"reputation": 149, "user_id": 9730610, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XG8e1wigdVw/AAAAAAAAAAI/AAAAAAAAADo/WjzBKeJKdXo/photo.jpg?sz=128", "display_name": "Rugo", "link": "https://stackoverflow.com/users/9730610/rugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1560900277, "creation_date": 1560887638, "question_id": 56656169, "link": "https://stackoverflow.com/questions/56656169/linked-list-add-new-root-element", "title": "Linked list add new root element", "body": "<p>I'm trying to add a new root element to my linked list. I already know the correct answer but I dont understand why there's a double pointer to the current root element. Here's the correct code: </p>\n\n<pre><code>void elementAsRoot(Element **oldRoot, Element *newRoot){\n  newRoot -&gt; next = *oldRoot;\n  *oldRoot = newRoot;\n}\n</code></pre>\n"}, {"tags": ["c", "http", "post"], "comments": [{"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 1, "creation_date": 1560889887, "post_id": 56656143, "comment_id": 99883171, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22077802/simple-c-example-of-doing-an-http-post-and-consuming-the-response\">Simple C example of doing an HTTP POST and consuming the response</a>"}, {"owner": {"reputation": 1, "user_id": 5172767, "user_type": "registered", "profile_image": "https://graph.facebook.com/944736068911421/picture?type=large", "display_name": "Giuseppe Tufano", "link": "https://stackoverflow.com/users/5172767/giuseppe-tufano"}, "reply_to_user": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1560894865, "post_id": 56656143, "comment_id": 99884944, "body": "I don&#39;t think it is a duplicate of that one. There the content is sent as &quot;Key1=Value1&amp;Key2=Value2&quot; cause the url is like &quot;api.somesite.com/apikey=ARG1&amp;command=ARG2&quot;. How can i send the content if the url is &quot;meswebapptest.hermanmiller.com/mes/rest/r2Label/print/Biess&zwnj;&#8203;e/105/1B6D0X-----112&zwnj;&#8203;25105/112251/Q0161B8&zwnj;&#8203;&quot;?"}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1560917361, "post_id": 56656143, "comment_id": 99889188, "body": "<code>char request[] = &quot;POST &#47;mes&#47;rest&#47;r2Label&#47;print&#47;Biesse&#47;105&#47;1B6D0X-----11225105&#47;11225&zwnj;&#8203;1&#47;Q0161B8 HTTP&#47;1.1\\r\\nHost: meswebapptest.hermanmiller.com\\r\\nContent-Lenght:9\\r\\n\\r\\nna&zwnj;&#8203;me=nina&quot;;</code>"}], "owner": {"reputation": 1, "user_id": 5172767, "user_type": "registered", "profile_image": "https://graph.facebook.com/944736068911421/picture?type=large", "display_name": "Giuseppe Tufano", "link": "https://stackoverflow.com/users/5172767/giuseppe-tufano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 712, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560916912, "creation_date": 1560887536, "last_edit_date": 1560891899, "question_id": 56656143, "link": "https://stackoverflow.com/questions/56656143/how-to-send-http-post-request-in-c", "title": "How to send HTTP POST request in C", "body": "<p>I know there are lot of questions similar to this, but no one helped me.</p>\n\n<p>I have to make a <code>C</code> program, using <code>socket</code> and no external lib, that sends an HTTP POST request to a web server and manage its JSON answer. </p>\n\n<p>The URL is like this: </p>\n\n<blockquote>\n  <p>meswebapptest.hermanmiller.com/mes/rest/r2Label/print/userId/company/unitId/prodOrder/printer</p>\n</blockquote>\n\n<p>i.e.</p>\n\n<blockquote>\n  <p>meswebapptest.hermanmiller.com/mes/rest/r2Label/print/Biesse/105/1B6D0X-----11225105/112251/Q0161B8</p>\n</blockquote>\n\n<p>So my question is: How the string should be formatted to match that URL?</p>\n\n<p>Thanks in advice.</p>\n"}, {"tags": ["c", "ubuntu-16.04"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1560887374, "post_id": 56656061, "comment_id": 99882108, "body": "<code>struct request rq = {0x00000001, 0}</code> - which fields do you expect it to initialize?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1560887387, "post_id": 56656061, "comment_id": 99882119, "body": "<code>*buff</code> is a char. Not an integer."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1560887575, "post_id": 56656061, "comment_id": 99882205, "body": "You might try <code>*(int *)(buff + sizeof rq)</code>."}, {"owner": {"reputation": 13, "user_id": 11666294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cacdd3525e3fb1d35a0f8e703f406bd?s=128&d=identicon&r=PG&f=1", "display_name": "StrollingOx", "link": "https://stackoverflow.com/users/11666294/strollingox"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1560887809, "post_id": 56656061, "comment_id": 99882315, "body": "Wow, thank you @LeeDanielCrocker!!! It worked!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560887911, "post_id": 56656061, "comment_id": 99882360, "body": "the posted code will only work if the size of <code>int</code> is 32 bits.  I.E. there will be problems if a <code>int</code> is 64 bits"}], "answers": [{"tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": true, "score": 0, "last_activity_date": 1560887909, "last_edit_date": 1560887909, "creation_date": 1560887846, "answer_id": 56656217, "question_id": 56656061, "link": "https://stackoverflow.com/questions/56656061/value-from-the-pointer-is-not-displaying-correctly/56656217#56656217", "title": "Value from the pointer is not displaying correctly", "body": "<p>You're dereferencing <code>buff+sizeof(rq)</code>, which is a <code>char *</code>.  Since 512 is <code>0x 02 00</code>, if you dereference it as a <code>char *</code> you get <code>0x00</code>.  If you look in <code>buff+sizeof(rq) + 1</code>, you get the other <code>0x02</code>.</p>\n\n<p>On the other hand, if you cast the pointer to <code>int *</code>, then you get the full <code>0x0200</code>. </p>\n\n<pre><code>printf(\"Int value: %d\\n\", *(int *)(buff+sizeof(rq)));\n</code></pre>\n\n<p>outputs 512.</p>\n"}], "owner": {"reputation": 13, "user_id": 11666294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cacdd3525e3fb1d35a0f8e703f406bd?s=128&d=identicon&r=PG&f=1", "display_name": "StrollingOx", "link": "https://stackoverflow.com/users/11666294/strollingox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56656217, "answer_count": 1, "score": 0, "last_activity_date": 1560887909, "creation_date": 1560887221, "question_id": 56656061, "link": "https://stackoverflow.com/questions/56656061/value-from-the-pointer-is-not-displaying-correctly", "title": "Value from the pointer is not displaying correctly", "body": "<p>I try to assign some information to 'char' data (one structure and one integer value), but after i assign it i can't read it back. Any solution? I work on Ubuntu 16.04 installed on virtualbox</p>\n\n<pre><code>struct opcode_struct{\n    uint8_t a;\n    uint8_t b;\n    uint8_t c;\n    uint8_t d;\n};\n\nunion opcode{\n    uint32_t uint32code;\n    struct opcode_struct code;\n};\n\nstruct request{\n    //4\n    union opcode opc;\n    //4\n    uint32_t id;\n};\n\n\nint main()\n{\n    char *buff = (char*)malloc(32);\n\n    struct request rq = {0x00000001, 0}, *ptr_rq = &amp;rq;\n    int val = 512, *ptr_int = &amp;val;\n\n    memcpy(buff, ptr_rq, sizeof(rq));\n    memcpy((buff+sizeof(rq)), ptr_int, sizeof(int));\n\n    printf(\"Request opcode: 0x%08x\\n\", *buff);\n    printf(\"Request id: %d\\n\", *(buff+sizeof(uint32_t)));\n    printf(\"Int value: %d\\n\", *(buff+sizeof(rq)));\n\n    free(buff);\n    return 0;\n}\n</code></pre>\n\n<p>Displayed text:\nRequest opcode: 0x00000001\nRequest id: 0\nInt value: 0</p>\n\n<p>but Int value should be equal to '512'</p>\n"}, {"tags": ["c", "environment-variables", "installation"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4190411, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gdV_-H2usxA/AAAAAAAAAAI/AAAAAAAADTQ/FS_zraTVHVU/photo.jpg?sz=128", "display_name": "Wendell Pereira", "link": "https://stackoverflow.com/users/4190411/wendell-pereira"}, "edited": false, "score": 0, "creation_date": 1578583527, "post_id": 56668060, "comment_id": 105493228, "body": "Worked on macOs 10.14 also!"}, {"owner": {"reputation": 1481, "user_id": 3835653, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/00763a70467aa3e5fa0920f34fa42a90?s=128&d=identicon&r=PG&f=1", "display_name": "ThePumpkinMaster", "link": "https://stackoverflow.com/users/3835653/thepumpkinmaster"}, "edited": false, "score": 0, "creation_date": 1590702785, "post_id": 56668060, "comment_id": 109789173, "body": "How can I get this to work even when I restart my computer? When I restart my computer, the variables get set to nothing"}, {"owner": {"reputation": 1802, "user_id": 950933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64851acb3be2e49b25291faceb49a98b?s=128&d=identicon&r=PG", "display_name": "siva", "link": "https://stackoverflow.com/users/950933/siva"}, "edited": false, "score": 0, "creation_date": 1597921991, "post_id": 56668060, "comment_id": 112293172, "body": "i am not able to read the env variable using System.getenv if set through launchctl. is there a way to update the existing env variable."}], "tags": [], "owner": {"reputation": 94, "user_id": 9236336, "user_type": "registered", "profile_image": "https://graph.facebook.com/1474696245976462/picture?type=large", "display_name": "Abhi Kulshrestha", "link": "https://stackoverflow.com/users/9236336/abhi-kulshrestha"}, "is_accepted": true, "score": 5, "last_activity_date": 1560949486, "last_edit_date": 1560949486, "creation_date": 1560948580, "answer_id": 56668060, "question_id": 56656031, "link": "https://stackoverflow.com/questions/56656031/how-do-i-set-an-environment-variable-on-macos-mojave/56668060#56668060", "title": "How do I set an environment variable on macOs Mojave?", "body": "<p>To set an environment variable on Mac OSX, first open a terminal window.\nIf you are setting the environment variable to run jobs from the command line, use the following command:</p>\n\n<p><code>export variable=value</code></p>\n\n<p>where variable is the name of the environment variable (such as programmer) and value is the value you want to assign to the variable, (such as /opt/programmer/suites2013). You can find out which environment variables have been set with the env command.</p>\n\n<p>If you are setting the environment variable globally to use with applications, use the commands given below. The environment variables set by these commands are inherited by any shell or application.\nOS X 10.10</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code># To set an environment variable, enter the following command:\nlaunchctl setenv variable \"value\"\n\n# To find out if an environment variable is set, use the following command:\nlaunchctl getenv variable\n\n# To clear an environment variable, use the following command:\nlaunchctl unsetenv variable\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11331047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca4f349d75e92638442b3f4f105b726c?s=128&d=identicon&r=PG&f=1", "display_name": "phhhy", "link": "https://stackoverflow.com/users/11331047/phhhy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1432, "favorite_count": 0, "accepted_answer_id": 56668060, "answer_count": 1, "score": 2, "last_activity_date": 1560949486, "creation_date": 1560887071, "question_id": 56656031, "link": "https://stackoverflow.com/questions/56656031/how-do-i-set-an-environment-variable-on-macos-mojave", "title": "How do I set an environment variable on macOs Mojave?", "body": "<p>I'm installing 'THERMUS: A Thermal Model Package for ROOT' on macOs Mojave. One of the steps is (after unzipping) the following: \"Set an environment variable `THERMUS' to point at the top-level directory containing the THERMUS code\". I really don't know what to do. \nI've seen the other post on stackoverflow: <a href=\"https://stackoverflow.com/questions/24792260/no-rule-to-make-target-with-no-reason\">&#39;no rule to make target&#39; with no reason</a>, but, as I am a beginner, I really don't understand how I should set it. Please help me</p>\n"}, {"tags": ["c", "assembly", "printf", "masm"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1560884158, "post_id": 56655313, "comment_id": 99880741, "body": "you use static crt code (<i>libcmt.lib</i>) but not initialize it. you need call <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/initterm-initterm-e?view=vs-2019\" rel=\"nofollow noreferrer\"><i>_initterm</i></a> first"}, {"owner": {"reputation": 285, "user_id": 6717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1672d4ebeb0c7008b38afd43bf68533?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/6717400/samantha"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1560884501, "post_id": 56655313, "comment_id": 99880878, "body": "@RbMm Could you give a code example how that would look like?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1560884591, "post_id": 56655313, "comment_id": 99880915, "body": "are you really want use <b>static</b> crt with asm ?! may be better dynamic ? or you sure that you need crt at all ?"}, {"owner": {"reputation": 285, "user_id": 6717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1672d4ebeb0c7008b38afd43bf68533?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/6717400/samantha"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1560884699, "post_id": 56655313, "comment_id": 99880965, "body": "@RbMm I could use a dynamic, I am just trying to get hello world to work, I did not find any examples where they were using dynamic libs"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1560885050, "post_id": 56655313, "comment_id": 99881109, "body": "in this case you need declare <code>extern __imp_printf:QWORD</code> and call <code>call __imp_printf</code> also you must <code>call __imp_ExitProcess</code> at the end, where <code>extern __imp_printf:QWORD</code>. also you need use <code>includelib msvcrt.lib</code> and also <code>kernel32.lib</code>"}, {"owner": {"reputation": 285, "user_id": 6717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1672d4ebeb0c7008b38afd43bf68533?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/6717400/samantha"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1560886788, "post_id": 56655313, "comment_id": 99881851, "body": "@RbMm I have done as you said, includelib msvcrt.lib includelib kernel32.lib, but I am getting unresolved external symbol __imp_printf.  What is the different between __imp_printf:QWORD and printf, and why do I need to call exitProcess?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1560887007, "post_id": 56655313, "comment_id": 99881948, "body": "because if you use <b>import</b> symbol from some dll - you need declare symbol as <code>extern __imp_&lt;symbol_name&gt;:QWORD</code> (or <code>DWORD</code> for x86) - because you call it via pointer variable. why do I need to call <code>ExitProcess</code> ? but this need for process exit"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1560887221, "post_id": 56655313, "comment_id": 99882039, "body": "ok - in your case - <i>__imp_printf</i> inside <i>includelib legacy_stdio_definitions.lib</i> - use it. also it ask <i>legacy_stdio_wide_specifiers.lib</i> include. i use another crt, where <code>__imp_printf</code> inside <i>msvcrt.lib</i>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1560888186, "post_id": 56655313, "comment_id": 99882463, "body": "you need code look like <a href=\"https://pastebin.com/7KWPefVT\" rel=\"nofollow noreferrer\">pastebin.com/7KWPefVT</a> and use <code>ep</code> as program entry point, and <i>legacy_stdio_definitions.lib legacy_stdio_wide_specifiers.lib ucrt.lib</i> libs"}, {"owner": {"reputation": 285, "user_id": 6717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1672d4ebeb0c7008b38afd43bf68533?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/6717400/samantha"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1560888606, "post_id": 56655313, "comment_id": 99882644, "body": "@RbMm thanks for all the help:) My code looks like this now, <a href=\"https://pastebin.com/vuG8Xd6g\" rel=\"nofollow noreferrer\">pastebin.com/vuG8Xd6g</a> it compiles but still crashes on the same place"}, {"owner": {"reputation": 285, "user_id": 6717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1672d4ebeb0c7008b38afd43bf68533?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/6717400/samantha"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1560888841, "post_id": 56655313, "comment_id": 99882742, "body": "@RbMm linking ucrt.lib did it:) thanks, what is the different between ucrt.lib and libucrt?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1560894594, "post_id": 56655313, "comment_id": 99884858, "body": "libucrt is static lib - code will be append to your binary. ucrt.lib is import library (<i>_imp</i> symbols) - code is in windows dll will be, not in your exe (which is will be small in this case, but have external dependencies)"}, {"owner": {"reputation": 673, "user_id": 2443849, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/bsS1R.jpg?s=128&g=1", "display_name": "Naeem Baghi", "link": "https://stackoverflow.com/users/2443849/naeem-baghi"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1584638612, "post_id": 56655313, "comment_id": 107504738, "body": "Samantha you are the best, I was struggling with this thing for a few hours, no sources, no other things, I needed to add the ucrt.lib to my project too, after that printf worked fine. Also thanks @RbMm."}], "owner": {"reputation": 285, "user_id": 6717400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1672d4ebeb0c7008b38afd43bf68533?s=128&d=identicon&r=PG&f=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/6717400/samantha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1560883848, "creation_date": 1560883848, "question_id": 56655313, "link": "https://stackoverflow.com/questions/56655313/access-violation-calling-printf-from-assembly", "title": "Access violation calling printf from assembly", "body": "<p>I'm using Visual Studio 2019 and compiling this assembly program in 64 bits.\nIt compiles and links without any warnings but when I call the c function <code>printf</code>, I get <code>Access violation writing location 0x0000000000000024</code>?</p>\n\n<pre><code>extern printf: PROC\n\nincludelib libcmt.lib\nincludelib libvcruntime.lib\nincludelib libucrt.lib\nincludelib legacy_stdio_definitions.lib\n\n.data\nmsg db 'hello world', 0Ah, 00\n\n.code\nmain proc\n    sub rsp, 40\n    lea rcx, msg\n    call printf\n    add rsp, 40\n    ret\nmain endp\n\nEnd\n</code></pre>\n"}, {"tags": ["c++", "c", "ssl", "encryption", "openssl"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1560882632, "post_id": 56654789, "comment_id": 99880071, "body": "Why are you using global variables, and obsolete function definitions?"}, {"owner": {"reputation": 21, "user_id": 6233867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J1NUbwiINhs/AAAAAAAAAAI/AAAAAAAAAAA/RSNfahdmav8/photo.jpg?sz=128", "display_name": "krishhlive", "link": "https://stackoverflow.com/users/6233867/krishhlive"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1560929316, "post_id": 56654789, "comment_id": 99893269, "body": "what do you mean by obsolete?These are still used right?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1560930759, "post_id": 56654789, "comment_id": 99893965, "body": "Only for compatibility with legacy code. These days we write <code>void initSSL(void)</code> if that&#39;s what is intended."}, {"owner": {"reputation": 21, "user_id": 6233867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J1NUbwiINhs/AAAAAAAAAAI/AAAAAAAAAAA/RSNfahdmav8/photo.jpg?sz=128", "display_name": "krishhlive", "link": "https://stackoverflow.com/users/6233867/krishhlive"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1560943684, "post_id": 56654789, "comment_id": 99900972, "body": "apart from initSSL , how do you write per session specific application data which are to be used in verify callback functions,"}], "owner": {"reputation": 21, "user_id": 6233867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J1NUbwiINhs/AAAAAAAAAAI/AAAAAAAAAAA/RSNfahdmav8/photo.jpg?sz=128", "display_name": "krishhlive", "link": "https://stackoverflow.com/users/6233867/krishhlive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560881805, "creation_date": 1560881361, "last_edit_date": 1560881805, "question_id": 56654789, "link": "https://stackoverflow.com/questions/56654789/ssl-get-ex-new-index-ssl-ctx-get-ex-data-ssl-ctx-set-ex-data-return-wrong-value", "title": "SSL_get_ex_new_index,SSL_CTX_get_ex_data, SSL_CTX_set_ex_data return wrong value", "body": "<p>I have situation where a single client initiates SSL session with two servers.\nDuring <code>SSL_CTX_set_verify</code> callback function verification I am trying to use <code>SSL_CTX_set_ex_data</code> / <code>SSL_CTX_get_ex_data</code>.</p>\n\n<p>Mine is a single threaded process with two different SSL sessions.\nI am fetching index value from <code>SSL_get_ex_new_index</code> and saving application data in that index using 1st sessions <code>SSL*</code>.\nLikewise it is done for 2nd session with its corresponding <code>SSL*</code>.  </p>\n\n<pre><code>static int mydata_index=-1;//declared globally\n\ninitSSL()\n\n{\n\n//setting data from 1st sessions class scope followed by 2nd session\n\nSSL_set_ex_data(m_ssl,mydata_index,remote_ip);\n\nmydata_index = SSL_get_ex_new_index(0,NULL, NULL, NULL, NULL);\n.............................\n...............................\n\n}\n\n//fetching app data during verify_callback\n\nverify_callback()\n\n{\n...................\n\nSSL *ssl;\n\nssl =(SSL*)X509_STORE_CTX_get_ex_data(ctx, SSL_get_ex_data_X509_STORE_CTX_idx());\n\nchar *mydata_ssl =(char*)SSL_get_ex_data(ssl,mydata_index);\n\n}\n</code></pre>\n\n<p>While retrieving app data using <code>SSL_CTX_get_ex_data</code> using the (global index,1st session SSL*) I am getting the 2nd sessions data.</p>\n"}, {"tags": ["c", "newline", "fgets", "c-strings", "null-terminated"], "comments": [{"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 0, "creation_date": 1560881035, "post_id": 56654689, "comment_id": 99879354, "body": "Related : <a href=\"https://stackoverflow.com/questions/1660228/does-fgets-always-terminate-the-char-buffer-with-0\" title=\"does fgets always terminate the char buffer with 0\">stackoverflow.com/questions/1660228/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1560881250, "post_id": 56654689, "comment_id": 99879442, "body": "There is a reason why <code>fgets()</code> retains the final newline. If it is not present in the input, the input was truncated and the rest of it is still in the input buffer (unless it&#39;s the last line of a file and lacks a newline). BTW in the usual case, you will need to <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input\">remove that newline</a>. To fix it, use a bigger array, or dynamically allocate memory, or exit the program because it can&#39;t hold the data you entered."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1560882863, "post_id": 56654689, "comment_id": 99880170, "body": "What do you mean by &quot;fix it&quot;?  It appears to be working correctly."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1560883038, "post_id": 56654689, "comment_id": 99880248, "body": "No arrays are being overwritten.  You gave input of 10 &#39;a&#39;s and a newline.  9 of those &#39;a&#39;s were written into dog.name, one of the &#39;a&#39;s and the newline were put into dog.breed."}, {"owner": {"reputation": 3, "user_id": 11666164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8b94504fca886dae6f56012df5c260?s=128&d=identicon&r=PG&f=1", "display_name": "Yogsoth", "link": "https://stackoverflow.com/users/11666164/yogsoth"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1560883498, "post_id": 56654689, "comment_id": 99880441, "body": "@WilliamPursell The problem is that it skips the next fgets statement if I input more than ten a&#39;s."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560883966, "post_id": 56654689, "comment_id": 99880658, "body": "with <code>fgets()</code> only a max of (in this case) 9 characters will be input and the 10th position in the array will be set to <code>&#39;\\0&#39;</code>  So there are still characters &#39;a&#39; in <code>stdin</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560884272, "post_id": 56654689, "comment_id": 99880781, "body": "in function: <code>makeDog()</code>  regarding: <code>Dog dog;</code> and <code>return dog;</code>   Since the strut `Dog is on the stack, and will &#39;go out of scope&#39; when the function exits.  Accessing it in the calling function is undefined behavior"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1560884316, "post_id": 56654689, "comment_id": 99880800, "body": "It doesn&#39;t skip the statement.  The second call to fgets reads the rest of the line.  If you want to discard that data, you need to write some code to do so."}, {"owner": {"reputation": 3, "user_id": 11666164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8b94504fca886dae6f56012df5c260?s=128&d=identicon&r=PG&f=1", "display_name": "Yogsoth", "link": "https://stackoverflow.com/users/11666164/yogsoth"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560884608, "post_id": 56654689, "comment_id": 99880921, "body": "@user3629249 Thank you. How would I go about discarding the characters still left in stdin before calling fgets again?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560886828, "post_id": 56654689, "comment_id": 99881865, "body": "@user3629249 No.  If a pointer to the variable is returned, that would be a problem.  But this is no different than a function returning int doing <code>int f; f = 5; return f;</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560886865, "post_id": 56654689, "comment_id": 99881884, "body": "regarding: <i>How would I go about discarding the characters still left in stdin before calling fgets again?</i>   Please read/understand my answer.  Then IF the read dog-&gt;name does not contains a &#39;\\n&#39; (newline)  then use: <code>int ch;  while( (ch = getchar()) != EOF &amp;&amp; ch != &#39;\\n&#39; ){;}</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1560887075, "post_id": 56654689, "comment_id": 99881976, "body": "@WilliamPursell, are you referring to the &#39;undefined behavior&#39;?   an individual/native field will be returned in 1 or 2 CPU registers.  However, for larger items to return, like the 20 byte <code>struct dog</code>, problems will arise.  That is why I suggest, in my answer, to use dynamic memory allocation and return a pointer to that dynamic memory"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1561005846, "post_id": 56654689, "comment_id": 99924408, "body": "to understand what is wrong with the OPs code, you need to read/understand all the details abut the <code>fgets()</code> function.  All the C library functions are completely described in the MAN pages.  If you don&#39;t have the MAN pages on your computer, then search &quot;syntax of &lt;functionName&gt; in c&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11666164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8b94504fca886dae6f56012df5c260?s=128&d=identicon&r=PG&f=1", "display_name": "Yogsoth", "link": "https://stackoverflow.com/users/11666164/yogsoth"}, "edited": false, "score": 0, "creation_date": 1560888313, "post_id": 56655841, "comment_id": 99882526, "body": "Thank you for the effort even though this is a bit too complex for me at my current level of C. I will do my best to try to understand it."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1560886209, "creation_date": 1560886209, "answer_id": 56655841, "question_id": 56654689, "link": "https://stackoverflow.com/questions/56654689/why-does-multiple-fgets-statements-overwrite-character-arrays/56655841#56655841", "title": "Why does multiple fgets statements overwrite character arrays?", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>exits if dog name too long</li>\n<li>removes newline at end of dog name</li>\n<li>removes newline at end of dog breed</li>\n<li>does not check validity of dog breed length</li>\n<li>properly cleans up after using dynamic memory</li>\n<li>avoids using 'magic' numbers</li>\n<li>properly allocates dynamic memory and checks/handles any error</li>\n<li>uses: 'max 8 characters' to allow room for trailing newline and terminating NUL character</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_NAME_LEN  10\n#define MAX_BREED_LEN 10\n\ntypedef struct Dog \n{\n    char name[ MAX_NAME_LEN ];\n    char breed[ MAX_BREED_LEN ];\n} Dog;\n\nDog * makeDog() \n{\n    Dog *dog = malloc( sizeof( Dog ) );\n    if( !dog )\n    {\n        perror( \"malloc for struct Dog failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    printf(\"Dog's name? max 8 characters \");\n    if( !fgets(dog-&gt;name, MAX_NAME_LEN, stdin) )\n    {\n        perror( \"fgets for dog name failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    if( dog-&gt;name[ strlen( dog-&gt;name ) -1 ] != '\\n' )\n    {\n        puts( \"dog name too long, aborting\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // remove trailing newline\n    dog-&gt;name[ strcspn( dog-&gt;name, \"\\n\" ) ] = '\\0';\n\n    printf(\"Dog's breed? max 8 characters\");\n    if( !fgets(dog-&gt;breed, MAX_BREED_LEN, stdin) )\n    {\n        perror( \"fgets for dog breed failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // remove trailing newline\n    dog-&gt;breed[ strcspn( dog-&gt;name, \"\\n\" ) ] = '\\0';\n\n    return dog;\n}\n\nint main() {\n    printf(\"\\n\");\n\n    Dog *dog = makeDog();\n\n    printf(\"\\n\");\n\n    printf(\"Dog's name: %s\\n\", dog-&gt;name);\n    printf(\"Dog's breed: %s\\n\", dog-&gt;breed);\n\n    free( dog );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1560886684, "last_edit_date": 1560886684, "creation_date": 1560886307, "answer_id": 56655864, "question_id": 56654689, "link": "https://stackoverflow.com/questions/56654689/why-does-multiple-fgets-statements-overwrite-character-arrays/56655864#56655864", "title": "Why does multiple fgets statements overwrite character arrays?", "body": "<p>The character array <code>name</code> is declared with <code>10</code> elements</p>\n\n<pre><code>char name[10];\n</code></pre>\n\n<p>If you are using the following call of <code>fgets</code></p>\n\n<pre><code>fgets(dog.name, 10, stdin);\n</code></pre>\n\n<p>after entering <code>10</code> characters <code>'a'</code> then the fgets call reads only <code>9</code> characters from the input buffer and appends the array with the terminating zero character <code>'\\0'</code>.</p>\n\n<p>So the array will contain the string <code>\"aaaaaaaaa\"</code>. It is the same as to initialize the array the following way</p>\n\n<pre><code>char name[10[ = { 'a', 'a', 'a', 'a', 'a', 'a', 'a', 'a', 'a', '\\0' };\n</code></pre>\n\n<p>After that the input buffer will contain one character <code>'a'</code> and the new line character <code>'\\n'</code>. These characters will be read by the next call</p>\n\n<pre><code>fgets(dog.breed, 10, stdin);\n</code></pre>\n\n<p>As result the array <code>bread</code> will contain the string <code>\"a\\n\"</code>.</p>\n\n<p>It is the same as to initialize the array the following way</p>\n\n<pre><code>char bread[10[ = { 'a', '\\n', '\\0' };\n</code></pre>\n\n<p>If you want to store in the arrays strings with more characters you should enlarge the arrays.</p>\n\n<p>For example if you want to enter for the array name a string of <code>10</code> characters <code>'a'</code> you have tfo declare the array as having <code>12</code> elements. Why <code>12</code>? Because apart from <code>10</code> characters <code>'a'</code> and the terminating zero character the function <code>fgets</code> also will try to read the new line character <code>'\\n'</code> from the input buffer. Otherwise this character will be read by a second call of <code>fgets</code>.</p>\n\n<p>To remove the new line character from an array you can use the following approach</p>\n\n<pre><code>#include &lt;string.h&gt;\n\n//...\n\nfgets( dog.name, 12, stdin );\ndog.name[strcspn( dog.name, \"\\n\" )] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11666164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8b94504fca886dae6f56012df5c260?s=128&d=identicon&r=PG&f=1", "display_name": "Yogsoth", "link": "https://stackoverflow.com/users/11666164/yogsoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 56655841, "answer_count": 2, "score": 0, "last_activity_date": 1560886874, "creation_date": 1560880865, "last_edit_date": 1560886874, "question_id": 56654689, "link": "https://stackoverflow.com/questions/56654689/why-does-multiple-fgets-statements-overwrite-character-arrays", "title": "Why does multiple fgets statements overwrite character arrays?", "body": "<p>The following code works, but if I input more than 10 characters (let's say 10 a's), the output turns into something like this:</p>\n\n<p>\"Dog's name? aaaaaaaaaDog's breed?Dog's name: aaaaaaaaaDog's breed:\"</p>\n\n<p>Why is this? And how can I fix it?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Dog {\n    char name[10];\n    char breed[10];\n} Dog;\n\nDog makeDog() {\n    Dog dog;\n\n    printf(\"Dog's name? \");\n    fgets(dog.name, 10, stdin);\n\n    printf(\"Dog's breed? \");\n    fgets(dog.breed, 10, stdin);\n\n    return dog;\n}\n\nint main() {\n    printf(\"\\n\");\n\n    Dog dog = makeDog();\n\n    printf(\"\\n\");\n\n    printf(\"Dog's name: %s\", dog.name);\n    printf(\"Dog's breed: %s \\n\", dog.breed);\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "pointers", "c-strings"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 5, "creation_date": 1560878702, "post_id": 56654184, "comment_id": 99878343, "body": "Please don&#39;t write <code>*(pointer+index)</code>. There is a readable shorthand for it: <code>pointer[index]</code>."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1560878744, "post_id": 56654184, "comment_id": 99878367, "body": "You should do  <code>char vowels[MAX_STR_LEN] = {0};</code> otherwise you won&#39;t have a null terminator"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1560878822, "post_id": 56654184, "comment_id": 99878404, "body": "Also remember that arrays naturally decay to pointer to their first element. So the expression <code>stringy</code> is exactly equal to <code>&amp;stringy[0]</code>. You use both, as well as the above mentioned explicit pointer arithmetic. Please stick to <i>one</i> consistent style. It will make your code easier to read."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 6, "creation_date": 1560878834, "post_id": 56654184, "comment_id": 99878413, "body": "Note that you will need to keep track of <i>two different indices</i>, rather than indexing into both arrays with the same index."}, {"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "reply_to_user": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 1, "creation_date": 1560879070, "post_id": 56654184, "comment_id": 99878529, "body": "Vowels array at the beginning is initialized to garbage. Say, for the sake of argument that the first element of vowels is the null termination char, then, you write nothing on it because the first char in stringy is not a vowel. For printf your char* is empty. Secondly, if you do not want spaces in Vowels  you want another index, not i. Three suggestions: 1. Initialize the array to zero, as @Gillespie noted 2. have another index for the vowels that get incremented only for vowels  so you avoid having spaces."}], "answers": [{"tags": [], "owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "is_accepted": false, "score": 0, "last_activity_date": 1560879816, "last_edit_date": 1560879816, "creation_date": 1560879206, "answer_id": 56654312, "question_id": 56654184, "link": "https://stackoverflow.com/questions/56654184/how-can-i-move-all-vowels-from-a-string-to-a-different-array/56654312#56654312", "title": "How can I move all vowels from a string to a different array", "body": "<p>To keep track of the offset in the destination string you can either introduce a new variable - or just increment the pointer itself.</p>\n\n<h3>Option 1</h3>\n\n<p>In this case you need a separate variable to keep track of the offset in the destination string. In your <code>moveVowels()</code> function, add a new variable</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int j = 0;\n</code></pre>\n\n<p>and change</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>*(string_2 + i) = *(string_1 + i);\n</code></pre>\n\n<p>to</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>*(string_2 + j++) = *(string_1 + i);\n</code></pre>\n\n<p>At end of <code>moveVowels()</code> function, add a NULL terminator to the destination string:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>*(string_2 + j) = '\\0';\n</code></pre>\n\n<h3>Option 2</h3>\n\n<p>In this case you just increment the pointer every time you add a new vowel:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>*(string_2++) = *(string_1 + i);\n</code></pre>\n\n<p>Again, don't forget the null terminator:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>*string_2 = '\\0';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560880690, "post_id": 56654456, "comment_id": 99879213, "body": "Per the OP, no string functions allowed.  I.E. no <code>strlen()</code> and no <code>strchr()</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1560880740, "post_id": 56654456, "comment_id": 99879230, "body": "@user3629249 It is his task to substitute the functions for some kind of loops."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1560925025, "last_edit_date": 1560925025, "creation_date": 1560879834, "answer_id": 56654456, "question_id": 56654184, "link": "https://stackoverflow.com/questions/56654184/how-can-i-move-all-vowels-from-a-string-to-a-different-array/56654456#56654456", "title": "How can I move all vowels from a string to a different array", "body": "<p>We, beginners, should help each other.:)</p>\n\n<p>Here you are.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAX_STR_LEN 2048\n\nchar * moveVowels( char *s1, const char *s2 )\n{\n    const char *vowels = \"aeiou\";\n\n    size_t n = strlen( s2 );\n\n    for ( char *p = s1; *s2 != '\\0'; ++s2 )\n    {\n        if ( strchr( vowels, tolower( ( unsigned char )*s2 ) ) != NULL )\n        {\n            s1[n++] = *s2;\n            *p++ = ' ';\n        }\n        else\n        {\n            *p++ = *s2;\n        }\n    }\n\n    s1[n] = '\\0';\n\n    return s1;\n}\n\nint main(void) \n{\n    char s1[MAX_STR_LEN] =\n    {\n        \"but they also had a secret, and their greatest fear\"\n    };\n\n    char s2[MAX_STR_LEN];   \n\n    puts( s1 );\n    puts( moveVowels( s2, s1 ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>but they also had a secret, and their greatest fear\nb t th y  ls  h d   s cr t,  nd th  r gr  t st f  rueaoaaeeaeieaeea\n</code></pre>\n\n<p>Take into account that the destination character array must have enough space to accomodate vowels in the tail of the source string.</p>\n\n<p>If you want to insert the new line character between the source string and vowels then the function can look the following way.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAX_STR_LEN 2048\n\nchar * moveVowels( char *s1, const char *s2 )\n{\n    const char *vowels = \"aeiou\";\n\n    size_t n = strlen( s2 );\n\n    s1[n++] = '\\n';\n\n    for ( char *p = s1; *s2 != '\\0'; ++s2 )\n    {\n        if ( strchr( vowels, tolower( ( unsigned char )*s2 ) ) != NULL )\n        {\n            s1[n++] = *s2;\n            *p++ = ' ';\n        }\n        else\n        {\n            *p++ = *s2;\n        }\n    }\n\n    s1[n] = '\\0';\n\n    return s1;\n}\n\nint main(void) \n{\n    char s1[MAX_STR_LEN] =\n    {\n        \"but they also had a secret, and their greatest fear\"\n    };\n\n    char s2[MAX_STR_LEN];   \n\n    puts( s1 );\n    puts( moveVowels( s2, s1 ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output in this case is</p>\n\n<pre><code>but they also had a secret, and their greatest fear\nb t th y  ls  h d   s cr t,  nd th  r gr  t st f  r\nueaoaaeeaeieaeea\n</code></pre>\n\n<p>If you are not allowed to use standard C string functions then you can substitute their calls for loops.</p>\n\n<p>For example the declaration</p>\n\n<pre><code>size_t n = strlen( s2 );\n</code></pre>\n\n<p>can be substitute for this code snippet</p>\n\n<pre><code>size_t n = 0;\n\nwhile ( s2[n] ) ++n;\n</code></pre>\n\n<p>So what you need is substitute the function <code>strchr</code> for a loop by yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1560881249, "creation_date": 1560881249, "answer_id": 56654755, "question_id": 56654184, "link": "https://stackoverflow.com/questions/56654184/how-can-i-move-all-vowels-from-a-string-to-a-different-array/56654755#56654755", "title": "How can I move all vowels from a string to a different array", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>does not use any of the string functions</li>\n<li>performs the desired functionality</li>\n<li>avoids <code>printf()</code> as it is very CPU intensive</li>\n<li>avoids expressions like: <code>*(string_1 + i)</code></li>\n<li>makes use of the <code>ctype.h</code> header file that exposes <code>toupper()</code></li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAX_STR_LEN 2048\n\nvoid moveVowels(char *str, char *extractedVowels)\n{\n    for( size_t j = 0, i = 0; string_1[i]; i++ )\n    {\n        int temp = toupper( str[i] );\n        if (   temp == 'A' \n            || temp == 'E' \n            || temp == 'I' \n            || temp == 'O' \n            || temp == 'U')\n        {\n            extractedVowels[j] = str[i];\n            j++;\n            str[i] = ' ';\n        }\n    }\n}\n\n\nint main( void )\n{\n    char stringy[MAX_STR_LEN]=\"but they also had a secret, and their greatest fear\";\n    char vowels[MAX_STR_LEN] = {'\\0'};\n\n    puts( stringy );\n\n    moveVowels(&amp;stringy[0],&amp;vowels[0]);\n\n    puts( stringy );\n    puts( vowels );\n\n    return 0;\n}\n</code></pre>\n\n<p>running the proposed code results in:</p>\n\n<pre><code>but they also had a secret, and their greatest fear\nb t th y  ls  h d   s cr t,  nd th  r gr  t st f  r\nueaoaaeeaeieaeea\n</code></pre>\n\n<p>However, the OPs code (and the proposed code) fail to handle when a trailing 'y' is also a vowel.</p>\n"}], "owner": {"reputation": 29, "user_id": 11286307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f777e155bc26983450a361e0f357b64?s=128&d=identicon&r=PG&f=1", "display_name": "Shrek.Spongebob", "link": "https://stackoverflow.com/users/11286307/shrek-spongebob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 56654456, "answer_count": 3, "score": 1, "last_activity_date": 1560925025, "creation_date": 1560878572, "last_edit_date": 1560880223, "question_id": 56654184, "link": "https://stackoverflow.com/questions/56654184/how-can-i-move-all-vowels-from-a-string-to-a-different-array", "title": "How can I move all vowels from a string to a different array", "body": "<p>I am trying to write a function in C that takes 2 parameters (char *string_1, char *string_2), which will move all vowels from string_1 to string_2. I wrote a function to do this, but the output is not what I expected. The contents of string_2 seem to be quite random and sometimes contain non-vowels.</p>\n\n<p>I wrote a while loop to iterate over string_1, with an if statement to check for vowels. Using pointers, I tried set the contents of string_2 + i to the vowel. Then I made the spot where the vowel used to be in string_1 equal to \n' '. I tried several different algorithms, and traced them too, but I'm not sure where the problem is. Also, I am not permitted to use the string library. Any help is greatly appreciated. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define MAX_STR_LEN 2048\n\nvoid moveVowels(char *string_1, char *string_2)\n{\n\n int i;\n i=0;\n while (*(string_1 + i) != '\\0')\n {\n    if (*(string_1 + i) == 'a' || *(string_1 + i) == 'A' || *(string_1 + \n    i) == 'e' || *(string_1 + i) == 'E' || *(string_1 + i) == 'i' ||\n    *(string_1 + i) == 'I' || *(string_1 + i) == 'o' || *(string_1 + i) == \n    'O' || *(string_1 + i) == 'u' || *(string_1 + i) == 'U')\n    {\n    *(string_2 + i) = *(string_1 + i);\n    *(string_1 + i) = ' ';\n    }\n    i++;\n }\n}\n\n\nint main()\n{\n char stringy[MAX_STR_LEN]=\"but they also had a secret, and their greatest \n fear\";\n char vowels[MAX_STR_LEN];\n printf(\"%s\\n\",stringy);\n moveVowels(&amp;stringy[0],&amp;vowels[0]);\n printf(\"%s\\n\", stringy);\n printf(\"%s\\n\", vowels);\n\n return 0;\n\n}\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>but they also had a secret, and their greatest fear\nb t th y  ls  h d   s cr t,  nd th  r gr  t st f  r\nueaoaaeeaeieaeea\n</code></pre>\n\n<p>Actual Output:</p>\n\n<pre><code>but they also had a secret, and their greatest fear\nb t th y  ls  h d   s cr t,  nd th  r gr  t st f  r\n\\u]\n</code></pre>\n"}]