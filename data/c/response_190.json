[{"tags": ["c", "struct", "static"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 8, "creation_date": 1535582620, "post_id": 52087025, "comment_id": 91124317, "body": "It&#39;s a data type, it&#39;s only visible in the compilation unit where it&#39;s defined. That&#39;s why you put it in a header if you want to share it accross compilation units."}, {"owner": {"reputation": 562, "user_id": 6647506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qX1Q1.png?s=128&g=1", "display_name": "Jacquen", "link": "https://stackoverflow.com/users/6647506/jacquen"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1535583079, "post_id": 52087025, "comment_id": 91124459, "body": "@nicomp: so you&#39;re saying that a struct declaration, or any data type declaration for that matter, already has the behavior I want, that of not being in the global namespace, without the use of &#39;static&#39;, as long as it&#39;s not put in a header?"}, {"owner": {"reputation": 307, "user_id": 8716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/105196db6d398c854e1f0300b3702a00?s=128&d=identicon&r=PG&f=1", "display_name": "whatthefish", "link": "https://stackoverflow.com/users/8716085/whatthefish"}, "edited": false, "score": 3, "creation_date": 1535583355, "post_id": 52087025, "comment_id": 91124544, "body": "The word <code>static</code> applies to the variable declared with it, not the type. For example: <code>static struct timeval startw</code>, here <code>startw</code> would be considered static not <code>timeval</code>. <a href=\"https://stackoverflow.com/questions/22270950/c-static-struct\">Reference</a>"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1535583739, "post_id": 52087025, "comment_id": 91124617, "body": "Yes, I am saying that. You can&#39;t &#39;extern&#39; a user-defined data type."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1535583838, "post_id": 52087025, "comment_id": 91124643, "body": "Also, there is no namespace in C as far as I know, but someone will scurry off to the xyz standards document and send me straight."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1535583969, "post_id": 52087025, "comment_id": 91124670, "body": "@nicomp &quot;Namespace&quot; in C just refers to the idea that normally visible object/function/typedef names, the tags following a <code>struct</code> or <code>enum</code> keyword, labels in a function, and struct members are separate classifications of identifiers that do not collide."}, {"owner": {"reputation": 250, "user_id": 10118785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBK6yjyiX5Y/AAAAAAAAAAI/AAAAAAAAAE8/GSDei6J9J18/photo.jpg?sz=128", "display_name": "Leon Trotsky", "link": "https://stackoverflow.com/users/10118785/leon-trotsky"}, "edited": false, "score": 0, "creation_date": 1535584882, "post_id": 52087025, "comment_id": 91124904, "body": "&gt;static struct  {     int number; }thing; Something like this would be valid."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1535586948, "post_id": 52087025, "comment_id": 91125350, "body": "Is thing being declared in a header file?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1535587510, "post_id": 52087025, "comment_id": 91125454, "body": "Another suggestion would be to use <code>typedef struct { int number; } thing;</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1535589729, "post_id": 52087025, "comment_id": 91125859, "body": "As far as I can tell the standard doesn&#39;t define the behaviour of the OP code. There isn&#39;t any text like &quot;<code>static</code> is ignored except where it has defined meaning&quot;. So it would be undefined behaviour by omission."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1535590867, "post_id": 52087025, "comment_id": 91126057, "body": "@M.M I&#39;m not sure this would fall under the &quot;omission of any explicit definition of behavior&quot; clause. The Standard says things about effects of the keyword on the objects or function declared by a declaration containing it, and for this declaration the number of objects and functions declared happens to be zero.  I note clang++, g++, and MSVC all agree the code is acceptable but worth a warning."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1535599074, "post_id": 52087025, "comment_id": 91127676, "body": "@aschepler this is a C question. Can you indicate which clause would cover the behaviour of <code>static</code> in this code?"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1535600617, "post_id": 52087025, "comment_id": 91127964, "body": "@M.M Oops, I meant clang, gcc, and MSVC in C mode (which I did use for the test, just typed the wrong names here). And no, I can&#39;t really quote anything that directly supports my interpretation. I&#39;m just vaguely unconvinced that this is a &quot;behavior&quot; (though certainly &quot;behavior&quot; can cover some aspects of translation, not just execution)."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1535601174, "post_id": 52087025, "comment_id": 91128076, "body": "@M.M Or actually, there&#39;s 6.7/6 &quot;The declaration specifiers consist of a sequence of specifiers that indicate the linkage, storage duration, and part of the type of the entities that the declarators denote.&quot; The specifiers in that declaration do indicate the linkage and storage duration, and influence the type, of all zero declarators. This is considered okay for at least the &quot;part of the type&quot; phrase..."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1535621579, "post_id": 52087025, "comment_id": 91137247, "body": "@aschepler That&#39;s what I said."}], "answers": [{"comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1535587154, "post_id": 52087317, "comment_id": 91125385, "body": "I am amazed you attempted to cover this without mentioning scope. Linkage only applies to objects, not types. The OP is trying to hide a type, therefore they must control its scope."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1535589640, "post_id": 52087317, "comment_id": 91125843, "body": "@jwdonahue scope has nothing to do with this question. Also your claim &quot;linkage only applies to objects&quot; is incorrect; it applies to objects and functions. Nor is it clear why you try to point out that linkage doesn&#39;t apply to types, since that fact is the basis of most of this answer.  Maybe you could write your own answer"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1535590023, "post_id": 52087317, "comment_id": 91125912, "body": "@jwdonahue Sure, in some cases it might help to define a struct within a function. But that&#39;s not an option if you want to use the struct in multiple functions and/or in parameter or return types of static functions."}], "tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 1, "last_activity_date": 1535584971, "creation_date": 1535584971, "answer_id": 52087317, "question_id": 52087025, "link": "https://stackoverflow.com/questions/52087025/c-compiler-ignores-static-for-declaration-of-struct/52087317#52087317", "title": "C compiler ignores &#39;static&#39; for declaration of struct", "body": "<p>You can't use <code>static</code> on this way to control the linkage of a type like you could for a function or object, because in C types never have linkage anyway.</p>\n\n<p>\"Global namespace\" isn't quite the term you want here. C describes names of objects and functions as having \"external linkage\" if the same name can be declared in different translation units to mean the same thing (like the default for functions), \"internal linkage\" if the same name can be redeclared within the same translation unit to mean the same thing (like declarations marked <code>static</code>), or \"no linkage\" when a declaration names a different object or function from any other declaration (like variables defined within a function body). (A translation unit, roughly speaking, is one *.c file together with the contents of the headers it includes.) But none of this applies to types.</p>\n\n<p>So if you want to use a struct type that's essentially private to one source file, just define it within that source file. Then you don't need to worry about another usage of the same name colliding with yours, unless maybe somebody adds it to a header file that the source file was including.</p>\n\n<p>(And just in case a C++ user comes across this Q&amp;A, note the rules for this in C++ are very different.)</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 6, "last_activity_date": 1535586432, "creation_date": 1535586432, "answer_id": 52087459, "question_id": 52087025, "link": "https://stackoverflow.com/questions/52087025/c-compiler-ignores-static-for-declaration-of-struct/52087459#52087459", "title": "C compiler ignores &#39;static&#39; for declaration of struct", "body": "<p>You cant define the storage without defining the actual object.</p>\n\n<pre><code>static struct thing {\n    int number;\n}obj1,obj2;\n</code></pre>\n\n<p>is ok and:</p>\n\n<pre><code>struct thing {\n    int number;\n};\n\nstatic struct thing x,y;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1535590001, "creation_date": 1535590001, "answer_id": 52087824, "question_id": 52087025, "link": "https://stackoverflow.com/questions/52087025/c-compiler-ignores-static-for-declaration-of-struct/52087824#52087824", "title": "C compiler ignores &#39;static&#39; for declaration of struct", "body": "<p>Struct tags (and typedef names) have <em>no linkage</em>, which means they are not shared across translation units.  You might use the term \"private\" to describe this. It is perfectly fine for two different units to define their own <code>struct thing</code>.  </p>\n\n<p>There would only be a problem if it was attempted to make a cross-unit call of a function with external linkage that accepts a <code>struct thing</code> or type derived from that.   You can  minimize the chance of this happening by ensuring that functions with external linkage are only called via prototypes in header files (i.e. don't use local prototypes).</p>\n"}], "owner": {"reputation": 562, "user_id": 6647506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qX1Q1.png?s=128&g=1", "display_name": "Jacquen", "link": "https://stackoverflow.com/users/6647506/jacquen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 52087824, "answer_count": 3, "score": 2, "last_activity_date": 1535590001, "creation_date": 1535582479, "last_edit_date": 1592644375, "question_id": 52087025, "link": "https://stackoverflow.com/questions/52087025/c-compiler-ignores-static-for-declaration-of-struct", "title": "C compiler ignores &#39;static&#39; for declaration of struct", "body": "<p>In C, if I declare a structure like so:</p>\n<pre><code>static struct thing {\n    int number;\n};\n</code></pre>\n<p>and compile it (with gcc in this case), the compiler prints this warning:</p>\n<blockquote>\n<p>warning: 'static' ignored on this declaration</p>\n<p>[-Wmissing-declarations]</p>\n</blockquote>\n<p>Why is this?</p>\n<p>My intention in making the struct static would be to keep <code>thing</code> out of the global namespace so that another file could declare its own <code>thing</code> if it wanted.</p>\n"}, {"tags": ["c", "fortran", "fft", "fftw", "dft"], "comments": [{"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 1, "creation_date": 1535606359, "post_id": 52086568, "comment_id": 91129287, "body": "Welcome, please always use tag <a href=\"https://stackoverflow.com/questions/tagged/fortran\">fortran</a>. Note that magic numbers 4 and 8 in kind=4 and kind=8 are ugly and not portable. I did loads of similar stuff and mostly my eigenvalues were wrong. Double check them, try how different wavelenght inputs are affected. Make sure which wavelenght is stored in which array index in the transformed array."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 1, "creation_date": 1535614765, "post_id": 52086568, "comment_id": 91132998, "body": "Furthermore, your test for the c2r - r2c version is not complete, it is very incomplete in fact. You must test a right hand side with multiple wavenumbers present. Not just a simple sine wave. One sine wave demonstrates you have one eigenvalue correct. You must test several of them."}], "answers": [{"tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": false, "score": 1, "last_activity_date": 1536013770, "creation_date": 1536013770, "answer_id": 52156761, "question_id": 52086568, "link": "https://stackoverflow.com/questions/52086568/poisson-equation-solver-in-3-d-sine-transform-of-r2r-type-using-fftw-in-fortran/52156761#52156761", "title": "Poisson equation solver in 3-D Sine transform of r2r type using FFTW in Fortran", "body": "<p>The use of real-to-real transforms to solve the Poisson's equation is very attractive, as it allows using various boundary conditions. Nevertheless, the sensing points do not exacly correspond to those considered for periodic boundary conditions.</p>\n\n<p>For periodic boundary conditions, sensing points are on a regular grid, say 0,1..,n-1. If the size of the unit cell is Lx, then the spacing between the points is Lx/n. End of the story.</p>\n\n<p>Now, let's consider boundary conditions such that the DST III is to be used for forward transform, i.e. flag RODFT01. As shown <a href=\"https://en.wikipedia.org/wiki/Discrete_sine_transform#/media/File:DST-symmetries.svg\" rel=\"nofollow noreferrer\">there</a>, it is signaled in the <a href=\"http://www.fftw.org/fftw3_doc/Real-even_002fodd-DFTs-_0028cosine_002fsine-transforms_0029.html#Real-even_002fodd-DFTs-_0028cosine_002fsine-transforms_0029\" rel=\"nofollow noreferrer\">documentation of FFTW</a> that :</p>\n\n<blockquote>\n  <p>FFTW_RODFT01 (DST-III): odd around j=-1 and even around j=n-1. </p>\n</blockquote>\n\n<p>The sensing points are still 0,1..,n-1. If the length is Lx, the spacing is still  dx=Lx/(n). <strong>But the input functions and base functions of the DST III are odd around j=-1 and even around j=n-1. This explains a discrepency of magnitude</strong>:</p>\n\n<pre><code>in_dst(i,j,k) = 27.0d0*sin(3.0d0*x(i))*sin(3.0d0*y(j))*sin(3.0d0*z(k))\n</code></pre>\n\n<p>Indeed, this input is not odd around i=-1 and even around i=n-1. It is odd around both i=0 and i=n. As a consequence, the following actions could be helpful:</p>\n\n<ul>\n<li>Making sure that the considered forward transform is the right one. For odd-odd boundary conditions, it could be <code>FFTW_RODFT00 (DST-I): odd around j=-1 and odd around j=n.</code>.</li>\n<li>Evaluate the input at the correct sensing points. For DST-I, using n points, dx=Lx/(n+1) and x_i=dx*(i+1) for i=0,1,..,n-1 if the function is odd at 0 and Lx.</li>\n<li>Compute the frequencies in the transformed space. The way <a href=\"http://www.fftw.org/fftw3_doc/1d-Real_002dodd-DFTs-_0028DSTs_0029.html\" rel=\"nofollow noreferrer\">the inverse transform writes</a> helps finding these frequencies. Since the inverse of DST I is DST I, the first frequency (k=0) corresponds to a period of 2Lx; the second (k=1) corresponds to Lx, k-st frequencies corresponds to a period of 2Lx/(k+1).</li>\n</ul>\n\n<p>Finally, a scalling of the output may be needed, as the <a href=\"http://www.fftw.org/fftw3_doc/Real-even_002fodd-DFTs-_0028cosine_002fsine-transforms_0029.html#Real-even_002fodd-DFTs-_0028cosine_002fsine-transforms_0029\" rel=\"nofollow noreferrer\">FFTW transforms are not normalized.</a> For DST-I, FFTW_RODFT00, it's <code>N=2(n+1)</code>. The advice of VladimirF undoubtly is a good one. Indeed, while testing a single frequency is ideal to understand and implement the algorithm, the final test must cover multiple frequencies to ensure that the program is reliable.  </p>\n"}], "owner": {"reputation": 53, "user_id": 10286665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dHqZTLDHtjs/AAAAAAAAAAI/AAAAAAAAAAw/dEKokXal_9k/photo.jpg?sz=128", "display_name": "Jagannath Mahapatra", "link": "https://stackoverflow.com/users/10286665/jagannath-mahapatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1536013770, "creation_date": 1535579525, "last_edit_date": 1535614634, "question_id": 52086568, "link": "https://stackoverflow.com/questions/52086568/poisson-equation-solver-in-3-d-sine-transform-of-r2r-type-using-fftw-in-fortran", "title": "Poisson equation solver in 3-D Sine transform of r2r type using FFTW in Fortran", "body": "<p>I have written following code in Fortran to solve Poisson's equation using r2r (real to real) type FFTW sin transform. In this code, first I have done normal FFTW i.e. r2c (real to complex) type of a mathematical function <code>27*sin(3x)*sin(3y)*sin(3z)</code> and then divide it by 27 (3*3+3*3+3*3) to calculate second derivative of input function. A 3-D plot of amplitude of input function shows it's correct amplitude.<a href=\"https://i.stack.imgur.com/KNNn1.png\" rel=\"nofollow noreferrer\">amplitude along z-axis against x-,y- co-ordinate</a>. <br/>\n Then inverse FFTW of c2r (complex to real) type regenerates the input function but the amplitude now reduced to 1 as shown in 3-D plot <a href=\"https://i.stack.imgur.com/JLhzI.png\" rel=\"nofollow noreferrer\">2</a>. This says my code for Poisson equation solver works fine in case of normal FFTW.</p>\n\n<pre><code>Program Derivative\n\n! To run this code: gcc dst_3d.c -c -std=c99 &amp;&amp; gfortran derivative.f95 dst_3d.o -lfftw3 &amp;&amp; ./a.out\n\nimplicit none\n\ninclude \"fftw3.f\"\n\ninteger ( kind = 4 ), parameter :: Nx = 64\ninteger ( kind = 4 ), parameter :: Ny = 64\ninteger ( kind = 4 ), parameter :: Nz = 64\n\nreal ( kind = 8 ), parameter :: pi=3.14159265358979323846d0\n\ninteger ( kind = 4 ) i,j,k\nreal ( kind = 8 ) Lx,Ly,Lz,dx,dy,dz,kx,ky,kz\nreal ( kind = 8 ) x(Nx),y(Ny),z(Nz)\n\nreal ( kind = 8 ) in_dst(Nx,Ny,Nz),out_dst(Nx,Ny,Nz) ! DST\nreal ( kind = 8 ) in_k_dst(Nx,Ny,Nz),out_k_dst(Nx,Ny,Nz) ! DST\n\nreal ( kind = 8 ) in_dft(Nx,Ny,Nz),out_dft(Nx,Ny,Nz) ! DFT\ncomplex ( kind = 8 ) in_k_dft(Nx/2+1,Ny,Nz),out_k_dft(Nx/2+1,Ny,Nz) ! DFT\ninteger ( kind = 8 ) plan_forward,plan_backward ! DFT\n\n! System Size.\nLx = 2.0d0*pi; Ly = 2.0d0*pi; Lz = 2.0d0*pi \n\n! Grid Resolution.\ndx = Lx/dfloat(Nx); dy = Ly/dfloat(Ny); dz = Lz/dfloat(Nz)\n\n! =================================== INPUT ===========================================\n\n! Initial Profile Details.\ndo i = 1, Nx\n  x(i) = dfloat(i-1)*dx\n  do j = 1, Ny\n    y(j) = dfloat(j-1)*dy\n    do k = 1, Nz\n      z(k) = dfloat(k-1)*dz\n      in_dst(i,j,k) = 27.0d0*sin(3.0d0*x(i))*sin(3.0d0*y(j))*sin(3.0d0*z(k))\n      in_dft(i,j,k) = in_dst(i,j,k)\n      write(10,*) x(i), y(j), z(k), in_dft(i,j,k)\n    enddo\n  enddo\nenddo\n\n! =================================== 3D DFT ===========================================\n\n  call dfftw_plan_dft_r2c_3d_ (plan_forward, Nx, Ny, Nz, in_dft, in_k_dft, FFTW_ESTIMATE)\n  call dfftw_execute_ (plan_forward)\n  call dfftw_destroy_plan_ (plan_forward)\n\ndo i = 1, Nx/2+1\n  do j = 1, Ny/2\n    do k = 1, Nz/2\n      kx = 2.0d0*pi*dfloat(i-1)/Lx\n      ky = 2.0d0*pi*dfloat(j-1)/Ly\n      kz = 2.0d0*pi*dfloat(k-1)/Lz\n      out_k_dft(i,j,k) = in_k_dft(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo \n    do k = Nz/2+1, Nz\n      kx = 2.0d0*pi*dfloat(i-1)/Lx\n      ky = 2.0d0*pi*dfloat(j-1)/Ly\n      kz = 2.0d0*pi*dfloat((k-1)-Nz)/Lz\n      out_k_dft(i,j,k) = in_k_dft(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo\n  enddo\n  do j = Ny/2+1, Ny\n    do k = 1, Nz/2\n      kx = 2.0d0*pi*dfloat(i-1)/Lx\n      ky = 2.0d0*pi*dfloat((j-1)-Ny)/Ly\n      kz = 2.0d0*pi*dfloat(k-1)/Lz\n      out_k_dft(i,j,k) = in_k_dft(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo\n    do k = Nz/2+1, Nz\n      kx = 2.0d0*pi*dfloat(i-1)/Lx\n      ky = 2.0d0*pi*dfloat((j-1)-Ny)/Ly\n      kz = 2.0d0*pi*dfloat((k-1)-Nz)/Lz\n      out_k_dft(i,j,k) = in_k_dft(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo\n  enddo   \nenddo\n\nout_k_dft(1,1,1) = in_k_dft(1,1,1)\n\n  call dfftw_plan_dft_c2r_3d_ (plan_backward, Nx, Ny, Nz, out_k_dft, out_dft, FFTW_ESTIMATE)\n  call dfftw_execute_ (plan_backward)\n  call dfftw_destroy_plan_ (plan_backward)\n\ndo i = 1, Nx\n  do j = 1, Ny\n    do k = 1, Nz\n    out_dft(i,j,k) = out_dft(i,j,k)/dfloat(Nx*Ny*Nz)\n    write(20,*) x(i), y(j), z(k), out_dft(i,j,k)    \n    enddo\n  enddo   \nenddo\n\n! =================================== 3D DST ===========================================\n\n  call Forward_FFT(Nx, Ny, Nz, in_dst, in_k_dst)\n\ndo k = 1, Nz\n  do j = 1, Ny/2\n    do i = 1, Nx/2\n      kz = 2.0d0*pi*dfloat((k-1))/Lz\n      ky = 2.0d0*pi*dfloat((j-1))/Ly\n      kx = 2.0d0*pi*dfloat((i-1))/Lx\n      out_k_dst(i,j,k) = in_k_dst(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo \n    do i = Nx/2+1, Nx\n      kz = 2.0d0*pi*dfloat((k-1))/Lz\n      ky = 2.0d0*pi*dfloat((j-1))/Ly\n      kx = 2.0d0*pi*dfloat(Nx-(i-1))/Lx\n      out_k_dst(i,j,k) = in_k_dst(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo\n  enddo  \n  do j = Ny/2+1, Ny\n    do i = 1, Nx/2\n      kz = 2.0d0*pi*dfloat((k-1))/Lz\n      ky = 2.0d0*pi*dfloat(Ny-(j-1))/Ly\n      kx = 2.0d0*pi*dfloat((i-1))/Lx\n      out_k_dst(i,j,k) = in_k_dst(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo\n    do i = Nx/2+1, Nx\n      kz = 2.0d0*pi*dfloat((k-1))/Lz\n      ky = 2.0d0*pi*dfloat(Ny-(j-1))/Ly\n      kx = 2.0d0*pi*dfloat(Nx-(i-1))/Lx\n      out_k_dst(i,j,k) = in_k_dst(i,j,k)/(kx*kx+ky*ky+kz*kz)\n    enddo\n  enddo   \nenddo\n\nout_k_dst(1,1,1) = in_k_dst(1,1,1)\n\n  call Backward_FFT(Nx, Ny, Nz, out_k_dst, out_dst)  \n\ndo i = 1, Nx\n  do j = 1, Ny\n    do k = 1, Nz\n    out_dst(i,j,k) = out_dst(i,j,k)/dfloat(8*Nx*Ny*Nz)\n    write(30,*) x(i), y(j), z(k), out_dst(i,j,k)\n    enddo\n  enddo   \nenddo\n\nend program Derivative\n\n! ================================== FFTW SUBROUTINES \n====================================================\n\n! ================================================================= !\n! Wrapper Subroutine to call forward fftw c functions for 3d arrays !\n! ================================================================= !\n\nsubroutine Forward_FFT(Nx, Ny, Nz, in, out)\nimplicit none\ninteger ( kind = 4 ) Nx,Ny,Nz,i,j,k\nreal ( kind = 8 ) in(Nx, Ny, Nz),out(Nx, Ny, Nz),dum(Nx*Ny*Nz)\n\ndo i = 1, Nx\n  do j = 1, Ny\n    do k = 1, Nz\n    dum(((i-1)*Ny+(j-1))*Nz+k) = in(i,j,k)\n    enddo\n  enddo\nenddo\n\n  call dst3f(Nx, Ny, Nz, dum)\n\ndo i = 1, Nx\n  do j = 1, Ny\n    do k = 1, Nz\n    out(i,j,k) = dum(((i-1)*Ny+(j-1))*Nz+k)\n    enddo\n  enddo\nenddo\n\nend subroutine\n\n! ================================================================== !\n! Wrapper Subroutine to call backward fftw c functions for 3d arrays !\n! ================================================================== !\n\nsubroutine Backward_FFT(Nx, Ny, Nz, in, out)\nimplicit none\ninteger ( kind = 4 ) Nx,Ny,Nz,i,j,k\nreal ( kind = 8 ) in(Nx, Ny, Nz),out(Nx, Ny, Nz),dum(Nx*Ny*Nz)\n\ndo i = 1, Nx\n  do j = 1, Ny\n    do k = 1, Nz\n    dum(((i-1)*Ny+(j-1))*Nz+k) = in(i,j,k)\n    enddo\n  enddo\nenddo\n\n  call dst3b(Nx, Ny, Nz, dum)\n\ndo i = 1, Nx\n  do j = 1, Ny\n    do k = 1, Nz\n    out(i,j,k) = dum(((i-1)*Ny+(j-1))*Nz+k)\n    enddo\n  enddo\nenddo\n\nend subroutine\n! ==================================================================\n</code></pre>\n\n<p>This code uses below C-wrapper to calculate forward 3D FFTW sine transform and backward 3D FFTW sine transform,</p>\n\n<pre><code>#include &lt;fftw3.h&gt;\n\nint dst3f_(int *n0, int *n1, int *n2, double *in3cs)\n{\n    double *out3cs;\n    out3cs = (double*) fftw_malloc(sizeof(double) * (*n0) * (*n1) * (*n2));\n    fftw_plan p3cs;\n    p3cs = fftw_plan_r2r_3d(*n0, *n1, *n2, in3cs, out3cs, FFTW_RODFT10, FFTW_RODFT10, FFTW_RODFT10, FFTW_ESTIMATE);\n\n    fftw_execute(p3cs);\n    fftw_destroy_plan(p3cs);\n\n    for(int i0=0;i0&lt;*n0;i0++) {\n        for(int i1=0;i1&lt;*n1;i1++) {\n            for(int i2=0;i2&lt;*n2;i2++) {\n                in3cs[(i0*(*n1)+i1)*(*n2)+i2] = out3cs[(i0*(*n1)+i1)*(*n2)+i2];\n            }\n        }\n    }\n\n    return 0;\n}\n\nint dst3b_(int *n0, int *n1, int *n2, double *in3cs)\n{\n    double *out3cs;\n    out3cs = (double*) fftw_malloc(sizeof(double) * (*n0) * (*n1) * (*n2));\n    fftw_plan p3cs;\n    p3cs = fftw_plan_r2r_3d(*n0, *n1, *n2, in3cs, out3cs, FFTW_RODFT01, FFTW_RODFT01, FFTW_RODFT01, FFTW_ESTIMATE);\n\n    fftw_execute(p3cs);\n    fftw_destroy_plan(p3cs);\n\n    for(int i0=0;i0&lt;*n0;i0++) {\n        for(int i1=0;i1&lt;*n1;i1++) {\n            for(int i2=0;i2&lt;*n2;i2++) {\n                in3cs[(i0*(*n1)+i1)*(*n2)+i2] = out3cs[(i0*(*n1)+i1)*(*n2)+i2];\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Then I have tried to solve the same Poisson equation now using sine transform FFTW i.e. r2r (real to real) type. When I do a 3-D plot of output as shown here <a href=\"https://i.stack.imgur.com/WQYUU.png\" rel=\"nofollow noreferrer\">3</a>, the amplitude is now reduced to less than 1.  I couldn't find out where is my mistake in the code because of which this amplitude is reduced in case of sine transform.   </p>\n"}, {"tags": ["c", "segmentation-fault", "structure"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1535578312, "post_id": 52086312, "comment_id": 91123020, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a> <b>No.</b>"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1535578428, "post_id": 52086312, "comment_id": 91123063, "body": "Are you sure <code>neuralnet</code> should contain 4 arrays of length <b>zero</b> containing pointers to <code>float</code>? One could be part of the struct hack (which was replaced by flexible array members in 1999, when dynamically-sized automatic arrays which you also used were introduced), but four..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1535578838, "post_id": 52086312, "comment_id": 91123212, "body": "Even then, a structure can have at-most <i>one</i> flexible array member, and it must be at the <i>end</i> of the structure. This is one of those times when one-out-of-two isn&#39;t good enough. From what I see, I don&#39; understand why you&#39;re not just using simple pointers and writing serialize mechanics."}, {"owner": {"reputation": 23, "user_id": 8666243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f216d3724556c4b2fddf8b0664ae24?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Paulusma", "link": "https://stackoverflow.com/users/8666243/mauricio-paulusma"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1535579271, "post_id": 52086312, "comment_id": 91123350, "body": "@Deduplicator Aah thanks for the cast tip, didn&#39;t knew it was unnecessary and even a risk for potential errors. With regards to the struct hack, I really do mean to have 4 arrays. But as you and WhozCraig point out you can only use one variable member array in a structure, so more is absolutely not possible? In that case four would not be possible and I have to stick with Code A (just arrays with variable length)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535579380, "post_id": 52086312, "comment_id": 91123380, "body": "How do you expect multiple flexible members to work? How is it supposed to know where <code>pwl</code> ends and <code>pbl</code> begins if you haven&#39;t declared a length?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535579493, "post_id": 52086312, "comment_id": 91123416, "body": "The reason the flexible array member has to be at the end is because it depends on the fact that C doesn&#39;t prevent you from accessing outside the bounds of the struct, so you can allocate more memory with <code>malloc()</code> than is needed for the struct, and use the extra space for the last array."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535579539, "post_id": 52086312, "comment_id": 91123431, "body": "Note <code>pwl[0]</code> and <code>pbl[0]</code> are never assigned."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535579610, "post_id": 52086312, "comment_id": 91123450, "body": "<code>float *pwl[0];</code> is not a valid member declaration.  What compiler/options are you using?"}, {"owner": {"reputation": 23, "user_id": 8666243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f216d3724556c4b2fddf8b0664ae24?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Paulusma", "link": "https://stackoverflow.com/users/8666243/mauricio-paulusma"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535579686, "post_id": 52086312, "comment_id": 91123474, "body": "@Barmar, I&#39;m not sure actually. I thought maybe the OS fixes something in the memory at run time and keeps track of everything. But I actually have no idea. I&#39;m still a student, so I&#39;m not an expert as you may have noticed ;). However it works with just the arrays of variable length (without the struct) so why would it not be possible with a struct in it?"}, {"owner": {"reputation": 23, "user_id": 8666243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f216d3724556c4b2fddf8b0664ae24?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Paulusma", "link": "https://stackoverflow.com/users/8666243/mauricio-paulusma"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535579731, "post_id": 52086312, "comment_id": 91123493, "body": "@chux, gcc at macOS"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535579734, "post_id": 52086312, "comment_id": 91123495, "body": "It only does what you tell it to do. If you tell it the size of the array is 0, that&#39;s how much memory it uses for it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535579854, "post_id": 52086312, "comment_id": 91123533, "body": "With members <code>float *pwl[0];   float *pbl[0];</code>, I&#39;d expect that <code>pwl</code> and <code>pbl</code> overlay each other.  Do not use an array size of 0`."}, {"owner": {"reputation": 23, "user_id": 8666243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f216d3724556c4b2fddf8b0664ae24?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Paulusma", "link": "https://stackoverflow.com/users/8666243/mauricio-paulusma"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535580781, "post_id": 52086312, "comment_id": 91123800, "body": "@Barmar Aah I get it now. So the struct hack works because the last member just uses the extra memory allocated with malloc. Now that I&#39;m using multiple pointer arrays with size 0 as my &quot;last member&quot; they probably overlap each other and will thus use the same extra memory from malloc."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1535580805, "post_id": 52086312, "comment_id": 91123807, "body": "If you really want to allocate those arrays along with the struct, there are ways to do it but accessing them will become more complicated (flexible array member might work for one, but not four of them).  It&#39;s probably easier just to use <code>float **</code> and allocate the arrays separately (inside <code>create_neuralnet()</code>)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535584651, "post_id": 52086312, "comment_id": 91124851, "body": "Arrays of size 0 are always illegal in C - an array does have to have at least one member. It was how you did the struct hack <i>before</i> in <i>some compilers</i>. Now you&#39;re supposed to use a flexible array member, i.e. empty brackets <code>[]</code>."}], "owner": {"reputation": 23, "user_id": 8666243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51f216d3724556c4b2fddf8b0664ae24?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Paulusma", "link": "https://stackoverflow.com/users/8666243/mauricio-paulusma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535578089, "creation_date": 1535578089, "question_id": 52086312, "link": "https://stackoverflow.com/questions/52086312/structure-with-variable-member-length-results-in-segmentation-fault-11", "title": "Structure with variable member length results in &quot;Segmentation fault 11&quot;", "body": "<p>I'm working on some code that initialises a couple of blocks of memory with random values. I will use these blocks of memory as matrices for the weights and biases in a neural net later on but that is not the point of this question.</p>\n\n<p>I have two pieces off code (Code A &amp; Code B) which does essentially the same thing, namely initialising a block of memory with random values. Both pieces of code compile just fine, however when I execute Code B I get a segmentation fault 11 error and the code stops executing. Code B works with a structure of variable member length and I believe this creates the problem. However i don't know how to fix this.</p>\n\n<p><strong>My question:</strong> Does someone know what the problem causes and how to fix it? I would really love to have Code B working since this is convenient in the code later on. I have pasted both pieces of code below. The system where I have this code tested is macOS.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p><strong>Code A:</strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define DEBUG\n\n/*\n  Function prototypes\n*/\nvoid init_rand(float *p, int size);\n\n\nint main(int argc, char const *argv[])\n{\n\n  int neurons [] = {10,10,10}; // use this array to define the neuralnet\n  int layers = sizeof(neurons)/sizeof(int); // this calculates the amount of layers in the neuralnet (i.e. the amount of members in the array 'neurons')\n\n  // array of pointers for the memory given by malloc\n  float *pwl[layers];\n  float *pbl[layers];\n  float *pzl[layers];\n  float *pal[layers];\n\n  for (int i = 1; i &lt; layers; i++) // create memory for the matrices and assign the start adress of each matrix to the pointers\n  {\n    pwl[i] = (float *)malloc(neurons[i]*neurons[(i-1)]*sizeof(float));\n    pbl[i] = (float *)malloc(neurons[i]*sizeof(float));\n    pzl[i] = (float *)malloc(neurons[i]*sizeof(float));\n    pal[i] = (float *)malloc(neurons[i]*sizeof(float));\n  }\n\n  for (int i = 1; i &lt; layers; i++) // initialize the weights and the biases with random values\n  {\n    init_rand(pwl[i], neurons[i]*neurons[i-1]);\n    init_rand(pbl[i], neurons[i]);\n  }\n\n  return 0;\n}\n\n/*\n  Random generator with a gaussian distribution. Mean = 0, Variance = 1\n*/\ndouble gaussrand()\n{\n    static double V1, V2, S;\n    static int phase = 0;\n    double X;\n\n  if(phase == 0)\n  {\n        do\n    {\n            double U1 = (double)rand() / RAND_MAX;\n            double U2 = (double)rand() / RAND_MAX;\n\n            V1 = 2 * U1 - 1;\n            V2 = 2 * U2 - 1;\n            S = V1 * V1 + V2 * V2;\n            } while(S &gt;= 1 || S == 0);\n\n        X = V1 * sqrt(-2 * log(S) / S);\n    } else\n        X = V2 * sqrt(-2 * log(S) / S);\n\n    phase = 1 - phase;\n\n    return X;\n}\n\n/*\n  This function initializes a float array with random gaussian distributed numbers\n*/\nvoid init_rand(float *p, int size)\n{\n  for (int i = 0; i &lt; size; i++, p++)\n  {\n    *p = (float)gaussrand();\n\n#ifdef DEBUG\n    printf(\"%d:*p = %f\\n\", i, *p); //\n#endif\n  }\n}\n</code></pre>\n\n<p><strong>Code B:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define DEBUG\n\nstruct neuralnet\n{\n  int struct_size;\n  float *pwl[0];\n  float *pbl[0];\n  float *pzl[0];\n  float *pal[0];\n};\n\n/*\n  Function prototypes\n*/\nvoid init_rand(float *p, int size);\nstruct neuralnet* create_neuralnet(struct neuralnet* pnet, int layers);\n\n\nint main(int argc, char const *argv[])\n{\n\n  int neurons [] = {10,10,10}; // use this array to define the neuralnet\n  int layers = sizeof(neurons)/sizeof(int); // this calculates the amount of layers in the neuralnet\n\n  struct neuralnet *pnet; // create a struct neuralnet pointer\n\n  pnet = create_neuralnet(pnet, layers); // this function will create a neuralnet structure with variable size members\n\n  for (int i = 1; i &lt; layers; i++) // create memory for the matrices and assign the start adress of each matrix to the pointers\n  {\n    pnet-&gt;pwl[i] = (float *)malloc(neurons[i]*neurons[(i-1)]*sizeof(float));\n    pnet-&gt;pbl[i] = (float *)malloc(neurons[i]*sizeof(float));\n    pnet-&gt;pzl[i] = (float *)malloc(neurons[i]*sizeof(float));\n    pnet-&gt;pal[i] = (float *)malloc(neurons[i]*sizeof(float));\n  }\n\n  for (int i = 1; i &lt; layers; i++) // initialize the weights and the biases with random values\n  {\n    init_rand(pnet-&gt;pwl[i], neurons[i]*neurons[i-1]);\n    init_rand(pnet-&gt;pbl[i], neurons[i]);\n  }\n\n  return 0;\n}\n\n/*\n  Random generator with a gaussian distribution. Mean = 0, Variance = 1\n*/\ndouble gaussrand()\n{\n    static double V1, V2, S;\n    static int phase = 0;\n    double X;\n\n    if(phase == 0)\n  {\n        do\n    {\n            double U1 = (double)rand() / RAND_MAX;\n            double U2 = (double)rand() / RAND_MAX;\n\n            V1 = 2 * U1 - 1;\n            V2 = 2 * U2 - 1;\n            S = V1 * V1 + V2 * V2;\n            } while(S &gt;= 1 || S == 0);\n\n        X = V1 * sqrt(-2 * log(S) / S);\n    } else\n        X = V2 * sqrt(-2 * log(S) / S);\n\n    phase = 1 - phase;\n\n    return X;\n}\n\n/*\n  This function initializes a float array with random gaussian distributed numbers\n*/\nvoid init_rand(float *p, int size)\n{\n  for (int i = 0; i &lt; size; i++, p++)\n  {\n    *p = (float)gaussrand();\n\n#ifdef DEBUG\n    printf(\"%d:*p = %f\\n\", i, *p); //\n#endif\n  }\n}\n\n/*\n    This function creates the structure with members of variable length\n*/\nstruct neuralnet* create_neuralnet(struct neuralnet *pnet, int layers)\n{\n  pnet = (struct neuralnet *)malloc(sizeof(*pnet) + sizeof(float *) * layers * 4);\n  return pnet;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1535575717, "post_id": 52085849, "comment_id": 91122010, "body": "&quot;Segmentation fault&quot; = Time to open this code in your debugger and see what happens just prior to failure. Have you stepped through it yet? These buffers look really tiny and in one case completely unnecessary. Use <code>char buf* = &quot;...&quot;</code> instead of some arbitrary 20-character buffer with fixed contents. When manipulating paths be sure you can accommodate <code>MAX_PATH</code>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 3, "creation_date": 1535575908, "post_id": 52085849, "comment_id": 91122085, "body": "I see too many problems in your code."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535575958, "post_id": 52085849, "comment_id": 91122111, "body": "<code>szFilePath1</code> is declared <code>const</code>, so you can&#39;t use it as the destination of <code>snprintf()</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535576025, "post_id": 52085849, "comment_id": 91122136, "body": "You can&#39;t use the same variable as the source and destination in <code>snprintf()</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1535576067, "post_id": 52085849, "comment_id": 91122162, "body": "If you want to append to a string, use <code>strncat()</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535578119, "post_id": 52085849, "comment_id": 91122958, "body": "The consecutive lines <code>filectx ctx;</code> and    <code>ctx.filePath = &quot;&#47;usr&#47;bin&#47;abc.txt&quot;;</code> should not compile; you should be using <code>strcpy()</code> to copy a string, or initializing the variable with <code>filectx ctx = { &quot;&#47;usr&#47;bin&#47;abc.txt&quot; };</code>.  There are a myriad other problems too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535580228, "post_id": 52085849, "comment_id": 91123638, "body": "The 1 major problem is that code is compiled without all warnings enable - or is a weak compiler.  pavikirthi, save time.  Enable all warning - faster feedback than posting on SO."}], "answers": [{"tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": true, "score": 0, "last_activity_date": 1535575965, "creation_date": 1535575965, "answer_id": 52085913, "question_id": 52085849, "link": "https://stackoverflow.com/questions/52085849/using-snprintf-to-concatenate-giving-segmentation-fault-in-c/52085913#52085913", "title": "Using snprintf to concatenate giving segmentation fault in c", "body": "<p>With</p>\n\n<pre><code>const char szFilePath1[200] = \"/local/\"; \nconst char szFilePath2[200] = \"/local/\";\n</code></pre>\n\n<p>as well as others as your function arguments, you declare those variables <code>const</code>. You then try to write to them with <code>snprintf</code>. Don't make these <code>const</code>.</p>\n\n<p>You also can't reuse a variable as source and destination in <code>snprintf</code>.</p>\n\n<p>I'm surprised that the compiler allowed you to compile this.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535580093, "post_id": 52085938, "comment_id": 91123602, "body": "Yes <code>const char ** szFileName2 ... snprintf(szFileName2, sizeof(szFileName2), &quot;%s%s&quot;, szFileName2, buf);</code> is bad - wrong number of <code>*</code>."}], "tags": [], "owner": {"reputation": 11, "user_id": 10292054, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OSoY_81FcY0/AAAAAAAAAAI/AAAAAAAAAYA/wZpyzdxj_GQ/photo.jpg?sz=128", "display_name": "Kranthi Kiran Konganti", "link": "https://stackoverflow.com/users/10292054/kranthi-kiran-konganti"}, "is_accepted": false, "score": 1, "last_activity_date": 1535576093, "creation_date": 1535576093, "answer_id": 52085938, "question_id": 52085849, "link": "https://stackoverflow.com/questions/52085849/using-snprintf-to-concatenate-giving-segmentation-fault-in-c/52085938#52085938", "title": "Using snprintf to concatenate giving segmentation fault in c", "body": "<p>I think the problem here is with the arguments you pass to snprintf(). \nsnprintf() expects an argument of type string  (\"char *\"), but not \"char **\". </p>\n\n<p>Here you are passing a pointer instead of the actual string. So when it tries to access the address it gives segmentation fault.</p>\n\n<p>Change the parameters in the functions filename1() and filename2() to \"char *\" type and see. It should work.</p>\n\n<p>Hope this helps.</p>\n\n<p>Kranthi</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10289566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkFfo.jpg?s=128&g=1", "display_name": "Mint Lover", "link": "https://stackoverflow.com/users/10289566/mint-lover"}, "edited": false, "score": 0, "creation_date": 1535589609, "post_id": 52087671, "comment_id": 91125835, "body": "pavikirthi, are you a c programmer? I am asking since your code looks as if you tried to apply concepts from over languages in c."}], "tags": [], "owner": {"reputation": 33, "user_id": 10289566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkFfo.jpg?s=128&g=1", "display_name": "Mint Lover", "link": "https://stackoverflow.com/users/10289566/mint-lover"}, "is_accepted": false, "score": 0, "last_activity_date": 1535589105, "last_edit_date": 1535589105, "creation_date": 1535588460, "answer_id": 52087671, "question_id": 52085849, "link": "https://stackoverflow.com/questions/52085849/using-snprintf-to-concatenate-giving-segmentation-fault-in-c/52087671#52087671", "title": "Using snprintf to concatenate giving segmentation fault in c", "body": "<p>Although snprintf() doesn't work in your case, why don't you use strcat() or strncat()?\nInstead of</p>\n\n<blockquote>\n  <p>snprintf(szFilePath1, sizeof(szFilePath1), \"%s%s\", szFilePath1, szFileName1);</p>\n</blockquote>\n\n<p>you can write</p>\n\n<pre><code>strncat(szFilePath1, szFileName1, strlen(szFilePath1));\n</code></pre>\n\n<p>And by the way:\n<strong>WHY</strong> did you write </p>\n\n<blockquote>\n  <p>sizeof(szFilePath1)</p>\n</blockquote>\n\n<p>?\nSo, points to improve</p>\n\n<ol>\n<li>In the very beginning:</li>\n</ol>\n\n<blockquote>\n  <p>*szFileName1 = ctx->filepath;</p>\n</blockquote>\n\n<p>Not a nice thing to do. It's better to use strcpy()/strncpy(). And passing char ** argument also looks pretty strange.</p>\n\n<ol start=\"2\">\n<li>Stated above. Usage of snprintf's</li>\n</ol>\n"}], "owner": {"reputation": 1461, "user_id": 5641188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9bab5cda330ff2a8e1f909f3c2ac7700?s=128&d=identicon&r=PG&f=1", "display_name": "pavikirthi", "link": "https://stackoverflow.com/users/5641188/pavikirthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52085913, "answer_count": 3, "score": -1, "last_activity_date": 1535589105, "creation_date": 1535575644, "last_edit_date": 1535575728, "question_id": 52085849, "link": "https://stackoverflow.com/questions/52085849/using-snprintf-to-concatenate-giving-segmentation-fault-in-c", "title": "Using snprintf to concatenate giving segmentation fault in c", "body": "<p>I am trying to compare szFileName1 and szFileName2 , if they are not same, then I am renaming it, but when I am trying to concatenate using snprintf it's giving segmentation fault.what mistake am I doing here?</p>\n\n<pre><code>typedef struct{\n  char filePath[100];\n} filectx;\n\nvoid filename1(filectx *ctx, const char ** szFileName1){\n    *szFileName1 = ctx-&gt;filepath;\n}\n\n\nvoid filename2(const char ** szFileName2){\n    char buf[20] = \"/usr/bin/abb.txt\";\n    snprintf(szFileName2, sizeof(szFileName2), \"%s%s\", szFileName2, buf);\n}\n\nint main(){\n\n   const char* szFileName1 = NULL;\n   const char *szFileName2 = malloc(100);\n   filectx ctx;\n   ctx.filePath = \"/usr/bin/abc.txt\";\n   filename1(&amp;ctx, &amp;szFileName1);\n   filename2(&amp;szFileName2);\n\n   if(strcmp(szFileName1, szFileName2) != 0){\n       const char szFilePath1[200] = \"/local/\"; \n       const char szFilePath2[200] = \"/local/\";\n       snprintf(szFilePath1, sizeof(szFilePath1), \"%s%s\", szFilePath1, szFileName1);\n       snprintf(szFilePath2, sizeof(szFilePath2), \"%s%s\", szFilePath2, szFileName2);\n       int ret = rename(szFilePath1, szFilePath2);\n   }\n\n   free(szFileName2);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1535575661, "post_id": 52085818, "comment_id": 91121985, "body": "What value does <a href=\"https://en.cppreference.com/w/cpp/io/c/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code></a> return? Also why are you asking for <code>%1f</code> instead of <code>%f</code>?"}, {"owner": {"reputation": 21, "user_id": 10292040, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UMNz9Nq0Y3k/AAAAAAAAAAI/AAAAAAAAK6s/0lACZZCjB94/photo.jpg?sz=128", "display_name": "Theo Marshall", "link": "https://stackoverflow.com/users/10292040/theo-marshall"}, "edited": false, "score": 0, "creation_date": 1535576279, "post_id": 52085818, "comment_id": 91122249, "body": "Thanks everyone, hard to tell the difference between an l and an 1"}], "answers": [{"tags": [], "owner": {"reputation": 538, "user_id": 7170162, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7aFQixASqRA/AAAAAAAAAAI/AAAAAAAAA40/OlNpaKToYa0/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/7170162/sam"}, "is_accepted": true, "score": 2, "last_activity_date": 1535575744, "creation_date": 1535575744, "answer_id": 52085875, "question_id": 52085818, "link": "https://stackoverflow.com/questions/52085818/printf-printing-zero-when-printing-a-double/52085875#52085875", "title": "printf printing zero when printing a double", "body": "<p>Change <code>%1f</code> to <code>%lf</code>. </p>\n\n<p>Like so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    double pi = 3.1415926;\n    double z = 0.0;\n    printf(\"What is the radius of the circle? \\n \");\n    scanf(\"%lf\", &amp;z);\n    double c =  2.0 * pi * z;\n    printf(\"The circumference is %lf\", c);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1174, "user_id": 3393672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hB2MZ.png?s=128&g=1", "display_name": "tif", "link": "https://stackoverflow.com/users/3393672/tif"}, "is_accepted": false, "score": 0, "last_activity_date": 1535575754, "creation_date": 1535575754, "answer_id": 52085877, "question_id": 52085818, "link": "https://stackoverflow.com/questions/52085818/printf-printing-zero-when-printing-a-double/52085877#52085877", "title": "printf printing zero when printing a double", "body": "<p>For reading into <code>z</code>, a double, you have to use <code>scanf(\"%lf\", &amp;z)</code> instead of <code>\"%1f\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 5142683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14a0f0da445af827c3f7f2708c2f218?s=128&d=identicon&r=PG&f=1", "display_name": "pizzapants184", "link": "https://stackoverflow.com/users/5142683/pizzapants184"}, "edited": false, "score": 1, "creation_date": 1535664706, "post_id": 52085902, "comment_id": 91162304, "body": "The <code>%f</code> specifier is used for <code>float</code>s, <code>double</code>s need the <code>%lf</code> specifier (with a lowercase L). The code provided in your answer doesn&#39;t produce the &#39;correct&#39; answer and may invoke undefined behavior. <a href=\"https://tio.run/##VY7LDoIwFET3fMUEgxGiDSiYGF8/YeLGDV6KNIHS9LHB@O1YHwu9u7mTOTOk1OJGNI4TIal1FcfO2Er0rDkEQlp0pZCzOLgH8Ff17tpyKIE9VizLs2KzXG9/rcE7KUs/P6U9oZ6F56a0EAa24dBlJZxBX78VCU0tP@IiEcafkKFS@kyU1eEc0yH@w5PHY8lSJK8RCYb/otMX6bqaay6Jv1oj9kbRl6S5dVrCT3xgHHNWPAE\" title=\"C++ (gcc) \u2013 Try It Online\" rel=\"nofollow noreferrer\">Try it online</a>"}], "tags": [], "owner": {"reputation": 68, "user_id": 7818130, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A9zOcqd6DVU/AAAAAAAAAAI/AAAAAAAADBA/CJK0iSKoO4U/photo.jpg?sz=128", "display_name": "Cihan Adrian Towery", "link": "https://stackoverflow.com/users/7818130/cihan-adrian-towery"}, "is_accepted": false, "score": 0, "last_activity_date": 1535575916, "creation_date": 1535575916, "answer_id": 52085902, "question_id": 52085818, "link": "https://stackoverflow.com/questions/52085818/printf-printing-zero-when-printing-a-double/52085902#52085902", "title": "printf printing zero when printing a double", "body": "<p>You were very close. try this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    double pi = 3.1415926;\n    double z = 0.0;\n    printf(\"What is the radius of the circle? \\n \");\n    scanf(\"%1f\", &amp;z);\n    double c =  2.0 * pi * z;\n    printf(\"The circumference is %.1f\", c);\n    return 0;\n} \n</code></pre>\n\n<p>your logic is telling the float that it needs a whole number, but no decimals afterwards</p>\n"}], "owner": {"reputation": 21, "user_id": 10292040, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UMNz9Nq0Y3k/AAAAAAAAAAI/AAAAAAAAK6s/0lACZZCjB94/photo.jpg?sz=128", "display_name": "Theo Marshall", "link": "https://stackoverflow.com/users/10292040/theo-marshall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "closed_date": 1535576661, "accepted_answer_id": 52085875, "answer_count": 3, "score": 0, "last_activity_date": 1535577812, "creation_date": 1535575518, "last_edit_date": 1535577812, "question_id": 52085818, "link": "https://stackoverflow.com/questions/52085818/printf-printing-zero-when-printing-a-double", "closed_reason": "Duplicate", "title": "printf printing zero when printing a double", "body": "<p>I have a piece of code in C, which is supposed to compute the circumference. \nNo matter what I put in for variable Z when asked for it, it always prints <code>0.000000</code></p>\n\n<p>Any ideas?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    double pi = 3.1415926;\n    double z = 0.0;\n    printf(\"What is the radius of the circle? \\n \");\n    scanf(\"%1f\", &amp;z);\n    double c =  2.0 * pi * z;\n    printf(\"The circumference is %1f\", c);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "swift3.2"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1535575560, "post_id": 52085763, "comment_id": 91121932, "body": "Have you tried using posix_spawn or NSTask? It&#39;s telling you that <code>system</code>s is unavailable in Swift."}, {"owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1535576128, "post_id": 52085763, "comment_id": 91122187, "body": "I am not getting how to use posix_spawn"}, {"owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1535660839, "post_id": 52085763, "comment_id": 91160863, "body": "@Thomas can you please help me here?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1535662321, "post_id": 52085763, "comment_id": 91161476, "body": "Have you tried initializing the variables?"}], "answers": [{"comments": [{"owner": {"reputation": 350, "user_id": 5331699, "user_type": "registered", "profile_image": "https://graph.facebook.com/1068700263148545/picture?type=large", "display_name": "Pawe\u0142 Zgoda-Ferchmin", "link": "https://stackoverflow.com/users/5331699/pawe%c5%82-zgoda-ferchmin"}, "edited": false, "score": 0, "creation_date": 1580381978, "post_id": 52190322, "comment_id": 106082604, "body": "Hi, could you share the code of your working implementation? Did you use the code from the question?"}], "tags": [], "owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "is_accepted": true, "score": 1, "last_activity_date": 1536167488, "creation_date": 1536167488, "answer_id": 52190322, "question_id": 52085763, "link": "https://stackoverflow.com/questions/52085763/call-c-function-in-swift3-fork-system/52190322#52190322", "title": "Call C function in swift3 fork(), system()", "body": "<p>I got it!</p>\n\n<p><strong>After initializing pid to -1 and status to 0.</strong></p>\n\n<p>For <strong>jailbroken</strong> device pid value is greater than 0 whereas for <strong>non jailbroken</strong> device pid value remains unchanged.</p>\n"}], "owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 52190322, "answer_count": 1, "score": -1, "last_activity_date": 1536167488, "creation_date": 1535575258, "last_edit_date": 1535660814, "question_id": 52085763, "link": "https://stackoverflow.com/questions/52085763/call-c-function-in-swift3-fork-system", "title": "Call C function in swift3 fork(), system()", "body": "<p>How to call fork() and system() in swift?</p>\n\n<p>var pid = fork() // Error: Missing argument for parameter #1 in call</p>\n\n<p>var r = system() <strong>//Error: fork()' is unavailable: Please use threads or posix_spawn*()</strong></p>\n\n<p>Tried  </p>\n\n<pre><code>var param: Int8\nvar s = system(&amp;param)\n</code></pre>\n\n<p>as well but it is giving different error - <strong>'system' is unavailable in Swift: Use posix_spawn APIs or NSTask instead.</strong></p>\n\n<p>I tried to use posix_param.\nBut getting another error\nhere is my code:-</p>\n\n<pre><code>var pid: pid_t\n\nvar status: Int32\nposix_spawn(&amp;pid, \"\", nil, nil, [], nil);\nwaitpid(pid, &amp;status, WEXITED);\nif pid &gt;= 0 {\n    return true\n\n}\n</code></pre>\n\n<p><strong>Errors:</strong> \n1) Address of variable 'pid' taken before it is initialized.\n2) Address of variable 'status' taken before it is initialized.</p>\n\n<p>Objective C version of this code which is working.</p>\n\n<pre><code>int pid = fork();\nif(!pid){\n    exit(0);\n }\n if(pid&gt;=0)\n  {\n     return YES;\n  }\n</code></pre>\n\n<p><a href=\"https://github.com/sat2eesh/ios-jailBroken/blob/master/JBroken.m\" rel=\"nofollow noreferrer\">Here</a></p>\n"}, {"tags": ["c", "file", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": false, "score": 0, "last_activity_date": 1535587203, "creation_date": 1535587203, "answer_id": 52087548, "question_id": 52085090, "link": "https://stackoverflow.com/questions/52085090/reading-certain-part-of-a-bin-file-eg-from-11th-23rd-hex-into-int-char-str/52087548#52087548", "title": "Reading certain part of a .bin file (eg. from 11th 23rd): hex into int, char string. C", "body": "<p><code>sscanf()</code> is not the correct tool to use for processing binary data like this.</p>\n\n<p>You will get far better results working from something that looks like your last section of code, where you index each character in the buffer directly, and process it on a character by character basis.</p>\n\n<p>Note that this is written assuming buffer is a pointer to characters, not a character array.</p>\n\n<p>What you'll need to do is read four characters to get the length:</p>\n\n<pre><code>struct student_t result;\nint length = 0;\nint i;\n// Progress backwards down data since it's stored \"little endian\"\nfor (i = 3; i &gt;= 0; i--)\n{\n     length = (length &lt;&lt; 8) + (buffer[i] &amp; 255);\n}\n</code></pre>\n\n<p>We've just consumed four bytes, move the buffer pointer forward to skip over them:</p>\n\n<pre><code>buffer += 4;\n</code></pre>\n\n<p>We have the length, and our buffer pointer now addresses the first character of the name.  Read that many characters and save them:</p>\n\n<pre><code>for (i = 0; i &lt; length; i++)\n{\n    result.name[i] = *buffer++;\n}\n// Add a NUL byte to terminate the string.\nresult.name[i] = '\\0';\n</code></pre>\n\n<p>That'll read the name, and in so doing it's moved the buffer pointer to address the first byte of the next length value.  All you then do is reset length to zero, and repeat the above to read in the surname.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 10076095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7638fd4df66c69330ab2016bdd1b03?s=128&d=identicon&r=PG&f=1", "display_name": "Immo", "link": "https://stackoverflow.com/users/10076095/immo"}, "edited": false, "score": 0, "creation_date": 1535807401, "post_id": 52087784, "comment_id": 91207300, "body": "I&#39;ll just post cpp check report (though the method is very educating, thanks a lot!): <code>(warning) %d in format string (no. 1) requires &#39;int&#39; but the argument type is &#39;unsigned int&#39;. (warning) %d in format string (no. 1) requires &#39;int&#39; but the argument type is &#39;unsigned int&#39;. [invalidPrintfArgType_sint] (warning) Size of pointer &#39;pRecord&#39; used instead of size of its data. This is likely to lead to a buffer overflow. You probably intend to write &#39;sizeof(*pRecord)&#39;. [pointerSize] (style) Variable &#39;readBytes&#39; is assigned a value that is never used. [unreadVariable]</code> Thanks a lot!"}, {"owner": {"reputation": 17, "user_id": 10076095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7638fd4df66c69330ab2016bdd1b03?s=128&d=identicon&r=PG&f=1", "display_name": "Immo", "link": "https://stackoverflow.com/users/10076095/immo"}, "edited": false, "score": 0, "creation_date": 1535808257, "post_id": 52087784, "comment_id": 91207523, "body": "in function clearRecord(), there should be <code>memset(pRecord, 0, sizeof(*pRecord));</code> instead of &quot;pRecord&quot;. (based on cppcheck)"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 17, "user_id": 10076095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7638fd4df66c69330ab2016bdd1b03?s=128&d=identicon&r=PG&f=1", "display_name": "Immo", "link": "https://stackoverflow.com/users/10076095/immo"}, "edited": false, "score": 0, "creation_date": 1535815247, "post_id": 52087784, "comment_id": 91209331, "body": "Thank you for the note. It was a typo (that could lead to segfaults if  <code>clearRecord</code>  would be applied repeatedly on the same object)."}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 0, "last_activity_date": 1535815050, "last_edit_date": 1535815050, "creation_date": 1535589530, "answer_id": 52087784, "question_id": 52085090, "link": "https://stackoverflow.com/questions/52085090/reading-certain-part-of-a-bin-file-eg-from-11th-23rd-hex-into-int-char-str/52087784#52087784", "title": "Reading certain part of a .bin file (eg. from 11th 23rd): hex into int, char string. C", "body": "<p>Considering that I saved your exact binary data in a file called <em>data.bin</em>, here's an example:</p>\n\n<p><em>code.c</em>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;errno.h&gt;\n\n#define FILE_NAME \"data.bin\"\n\n\ntypedef struct Record_ {\n    uint32_t nameLen, surnameLen;\n    char *name, *surname;\n} Record;\n\n\nvoid printRecord(Record record) {\n    printf(\"\\nPrinting record:\\n  Name length: %u\\n  Name: [\", record.nameLen);\n    if ((record.nameLen != 0) &amp;&amp; (record.name != NULL)) {\n        char *pc;\n        for (pc = record.name; pc &lt; record.name + record.nameLen; pc++) {\n            printf(\"%c\", *pc);\n        }\n    }\n    printf(\"]\\n  Surname length: %u\\n  Surname: [\", record.surnameLen);\n    if ((record.surnameLen != 0) &amp;&amp; (record.surname != NULL)) {\n        char *pc;\n        for (pc = record.surname; pc &lt; record.surname + record.surnameLen; pc++) {\n            printf(\"%c\", *pc);\n        }\n    }\n    printf(\"]\\n\");\n}\n\n\nvoid clearRecord(Record *pRecord) {\n    free(pRecord-&gt;name);\n    free(pRecord-&gt;surname);\n    memset(pRecord, 0, sizeof(Record));\n}\n\n\nint readRecord(FILE *pFile, Record *pRecord) {\n    size_t readBytes = fread(&amp;pRecord-&gt;nameLen, sizeof(pRecord-&gt;nameLen), 1, pFile);\n    if (pRecord-&gt;nameLen != 0) {\n        pRecord-&gt;name = malloc(pRecord-&gt;nameLen);\n        readBytes= fread(pRecord-&gt;name, 1, pRecord-&gt;nameLen, pFile);\n    }\n    readBytes = fread(&amp;pRecord-&gt;surnameLen, sizeof(pRecord-&gt;surnameLen), 1, pFile);\n    if (pRecord-&gt;surnameLen != 0) {\n        pRecord-&gt;surname = malloc(pRecord-&gt;surnameLen);\n        readBytes = fread(pRecord-&gt;surname, 1, pRecord-&gt;surnameLen, pFile);\n    }\n    return 0;\n}\n\n\nint main() {\n    FILE *fp = fopen(FILE_NAME, \"r+b\");\n    if (fp == NULL)\n    {\n        printf(\"Error opening file: %d\\n\", errno);\n        return 1;\n    }\n    Record record = {0, 0, NULL, NULL};\n    printRecord(record);\n    int ret = readRecord(fp, &amp;record);\n    if (ret)\n    {\n        printf(\"readRecord returned %d\\n\", ret);\n        fclose(fp);\n        return 2;\n    }\n    printRecord(record);\n    clearRecord(&amp;record);\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Notes</strong>:</p>\n\n<ul>\n<li><blockquote>\n  <p>After loading entire .bin file to buffer exactly like presented here</p>\n</blockquote>\n\n<p>Usually, this is not a very good idea. Only read as much as you need. Imagine that you want to read 10 bytes from a file hundreds of <em>MiB</em>s large. That would be a complete waste of resources, and sometimes might even lead to crashes</p></li>\n<li><p>It seems that you have a simple protocol here:</p>\n\n<ol>\n<li><strong><em>4</em></strong> bytes for <em>name length</em> - this is an <code>uint32_t</code></li>\n<li>A variable number of bytes given by the name length for <em>name</em> - this is a <code>char *</code>, as its length is not known at compile time (you could have an array like: <code>char[SOME_MAX_NAME_LENGTH]</code> where you know for sure that in the previous field there will never be a value greater than <code>SOME_MAX_NAME_LENGTH</code>, but I like this approach better)</li>\n<li>Same thing from <strong><em>#1.</em></strong> applied for <em>surname length</em></li>\n<li>Same thing from <strong><em>#2.</em></strong> applied for <em>surname</em></li>\n</ol>\n\n<p><br>This maps over the <code>Record</code> structure (yes the member order is not important, only the initialization order). Things could be taken even further, since the data for <em>surname</em> is a duplicate of the one for <em>name</em>, there could have been an inner structure containing the <em>name</em> data, and <code>Record</code> to contain only an array with 2 elements of that structure. <br>But even if things would be simpler that way (and also the code in functions would be shorter - without duplication), I didn't do it because it would probably be less obvious</p></li>\n<li><p><code>printRecord</code> - displays <code>Record</code> data in a user-friendly manner (you can notice the pointer logic here when <code>printf</code>ing the characters individually)</p></li>\n<li><p><code>clearRecord</code> - frees the memory occupied by the <code>char *</code> members and initializes everything to <strong><em>0</em></strong></p></li>\n<li><p><code>readRecord</code> - reads data from file and populates the record</p>\n\n<ul>\n<li>It does <strong>not</strong> have any error handling, since code is already pretty long. But you should <strong>always check and handle errors</strong> (function return codes: e.g. <code>fread</code>)</li>\n<li>Be careful when reconstructing (integer) values from individual bytes, as you might get unexpected results due to <em>endianness</em>. Check <a href=\"https://stackoverflow.com/questions/37990060/python-struct-pack-behavior/38003729#38003729\">[SO]: Python struct.pack() behavior\n(@CristiFati's answer)</a> (or of course, <em>Google</em>) for more info on this topic</li>\n<li>Read 4 bytes for the size, then (allocate and) read \"<em>size</em>\" bytes for the string (I might be wrong here, but I don't think that <code>sscanf</code> (functions family) is supposed to work with binary data (except for strings))</li>\n</ul></li>\n</ul>\n\n<p><strong>Output</strong>:</p>\n\n<blockquote>\n<pre><code>[cfati@cfati-ubtu16x64-0:~/Work/Dev/StackOverflow/q052085090]&gt; gcc code.c -o code.exe &amp;&amp; ./code.exe\n\nPrinting record:\n  Name length: 0\n  Name: []\n  Surname length: 0\n  Surname: []\n\nPrinting record:\n  Name length: 2\n  Name: [F.]\n  Surname length: 13\n  Surname: [MurrayAbraham]\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 10076095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7638fd4df66c69330ab2016bdd1b03?s=128&d=identicon&r=PG&f=1", "display_name": "Immo", "link": "https://stackoverflow.com/users/10076095/immo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 52087784, "answer_count": 2, "score": 0, "last_activity_date": 1535815050, "creation_date": 1535572140, "question_id": 52085090, "link": "https://stackoverflow.com/questions/52085090/reading-certain-part-of-a-bin-file-eg-from-11th-23rd-hex-into-int-char-str", "title": "Reading certain part of a .bin file (eg. from 11th 23rd): hex into int, char string. C", "body": "<p>I want to <strong>read eg. between 11th and 23rd number from hex .bin file</strong> looking like this: <a href=\"https://imgur.com/b4RzPjw\" rel=\"nofollow noreferrer\">https://imgur.com/b4RzPjw</a>, <strong>print some parts as intiger or other parts as a name (string)</strong>. (preferably without using any <code>[ ]</code>, only operations on pointers)<br/></p>\n\n<p>My example .bin file contains: first 4 hex numbers (blue highlight) is the length of name, then 2 numbers is name in ASCII. Next 4 numbers (blue underline) is the length of surname (red underline), and the last one is index.</p>\n\n<p>My attempt: <br/>\nAfter loading entire .bin file to buffer exactly like presented here: <a href=\"http://www.cplusplus.com/reference/cstdio/fread/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdio/fread/</a> , I miserably tried in many ways to assign parts of this buffer to variables (or a structure) and then, printf it using formatting, just to see what got assigned.</p>\n\n<pre><code> char *name_length = malloc(4);\n char *pEnd;\n for(*buffer=0; *buffer&lt;4; *buffer++) {\n     sscanf(buffer, \"%s\", name_length);\n     long int i = strtol (buffer, &amp;pEnd, 16);\n     printf(\"%x\", i);\n }\n</code></pre>\n\n<p>Above (wrong) code prints 0000 (I imagine it is completely rotten from it's roots, though I don't know why); in case there was an elegant way to load buffer parts already to structure, here's declaration:</p>\n\n<pre><code> struct student_t\n{\n    char name[20];\n    char surname[40];\n    int index;\n};\n</code></pre>\n\n<p>The \"closest\" result I Could get is another code, which prints \"2000.\" from my .bin file: \"<code>02 00 00 46 2E</code>\" which means \"<code>2</code> 0 0 0 /length/ <code>F.</code> /string/\"</p>\n\n<pre><code>  for(int i=0; i&lt;4; i++)\n  printf(\"%d\", buffer[i]); //it's supposed to print first 4 hex digits...\n  for(int j=5; j&lt;7; j++)\n  printf(\"%s\", &amp;buffer[j]); //it's supposed to print from 5th to 7th...\n</code></pre>\n\n<p>Thanks a lot for all the help and guidance.</p>\n"}, {"tags": ["c", "factorial"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1535571558, "post_id": 52084912, "comment_id": 91120127, "body": "Is this a question about C or CodeChef?  Have you tried compiling and executing this program locally, using GCC for example?"}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1535572093, "post_id": 52084912, "comment_id": 91120381, "body": "how about a <code>uint64</code> instead of <code>double</code>?"}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1535572731, "post_id": 52084912, "comment_id": 91120648, "body": "Is this not accepted because of time out or because the answer was incorrect"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1535572753, "post_id": 52084912, "comment_id": 91120658, "body": "Why doesn&#39;t the code &quot;get accepted on CodeChef&quot;? Are there error messages?"}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1535572888, "post_id": 52084912, "comment_id": 91120709, "body": "There are some inefficiencies, you use tail recursions which could easily be changed into a loop and you can implement a lookup table so that you are not recomputing factorials over and over again. If the error in integer overflow I recommend using python or something similar to avoid the issue"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535573735, "post_id": 52085405, "comment_id": 91121141, "body": "If OP want to avoid the learning experience, simple enough to search for a coded solution - I will not add one here as OP did not ask for that."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1535849978, "last_edit_date": 1535849978, "creation_date": 1535573492, "answer_id": 52085405, "question_id": 52084912, "link": "https://stackoverflow.com/questions/52084912/program-to-find-factorials-for-given-test-cases/52085405#52085405", "title": "Program to find factorials for given test cases", "body": "<blockquote>\n  <p>I have typed the code below and it doesn't get accepted on codechef.<br>\n  I don't know why.</p>\n</blockquote>\n\n<p>OP's code fails as <code>double</code> lacks precision for this task. Given \"containing a single integer n, 1&lt;=n&lt;=100.\" and <code>fact(100)</code>, the printed result needs far more precision than afforded by <code>double</code>.</p>\n\n<hr>\n\n<p>100! is exactly </p>\n\n<blockquote>\n  <p>93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000</p>\n</blockquote>\n\n<p><code>double</code> (precision) and <code>uint64_t</code> (range) are both insufficient for this task.  Need new approach.  Something that extends exact integer multiplication.  </p>\n\n<p>Perhaps create a function that multiplies a <em>string</em>?  <code>mult_str(char *s, int n)</code>?  <code>\"1\"</code> * 2 --> <code>\"2\"</code>. </p>\n\n<p>Do-able in about 30 lines of C code without special libraries.</p>\n"}, {"tags": [], "owner": {"reputation": 231, "user_id": 5988148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c103a6234e60ea3c2c3fe3b54f0a12?s=128&d=identicon&r=PG&f=1", "display_name": "Have Compiler -- Will Travel", "link": "https://stackoverflow.com/users/5988148/have-compiler-will-travel"}, "is_accepted": false, "score": 0, "last_activity_date": 1535848643, "last_edit_date": 1535848643, "creation_date": 1535820241, "answer_id": 52130241, "question_id": 52084912, "link": "https://stackoverflow.com/questions/52084912/program-to-find-factorials-for-given-test-cases/52130241#52130241", "title": "Program to find factorials for given test cases", "body": "<p>This seemed like an interesting short program so I wrote it up and submitted it to CodeChef. It was accepted on the first attempt -- not bad for BOTE (Back of the Envelope) code.</p>\n\n<pre><code>/* FCTRL2.c\n\n   CodeChef Problem Code: FCTRL2 (Small Factorials)\n*/\n\n#include &lt;stdio.h&gt;\n\n#define LEN         158\n\nint nextFactorial (const int n, char fact[], int limit)\n{\n    int carry = 0;\n    for ( int index = LEN - 1; index &gt;= limit; --index ) {\n        int product = fact[index] * n + carry;\n        fact[index] = product % 10;\n        carry = 0;\n        if ( product &gt; 9 ) {\n            carry = product / 10;\n            if ( index == limit )\n                --limit;\n        }\n    }\n\n    return limit;\n}\n\nvoid displayFactorial (const char fact[], const int limit)\n{\n    for ( int index = limit; index &lt; LEN; ++index )\n        printf (\"%c\", fact[index] + '0');\n    printf (\"\\n\");\n}\n\nint main (void)\n{\n    int count;\n    scanf (\"%i\", &amp;count);\n\n    int n[count];\n    for ( int i = 0; i &lt; count; ++i )\n        scanf (\"%i\", &amp;n[i]);\n\n    for ( int i = 0; i &lt; count; ++i ) {\n        char fact[LEN] = { [LEN - 1] = 1 }; \n        int limit = LEN - 1;\n        for ( int j = 2; j &lt;= n[i]; ++j )\n            limit = nextFactorial (j, fact, limit);\n        displayFactorial (fact, limit);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9273342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea6424d48c4d3a6675c99f495e2be3ca?s=128&d=identicon&r=PG", "display_name": "Samin Momin", "link": "https://stackoverflow.com/users/9273342/samin-momin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "accepted_answer_id": 52085405, "answer_count": 2, "score": -2, "last_activity_date": 1535849978, "creation_date": 1535571388, "last_edit_date": 1535571652, "question_id": 52084912, "link": "https://stackoverflow.com/questions/52084912/program-to-find-factorials-for-given-test-cases", "title": "Program to find factorials for given test cases", "body": "<p>Input<br>\nAn integer t, 1&lt;=t&lt;=100, denoting the number of test cases, followed by t lines, each containing a single integer n, 1&lt;=n&lt;=100.</p>\n\n<p>Output<br>\nFor each integer n given at input, display a line with the value of n!</p>\n\n<p>I have typed the code below and it doesn't get accepted on codechef.<br>\nI don't know why.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\ndouble fact(int n);\nvoid disp(double t);\n\nint main() {\n  int a, i, c[100];\n  scanf(\"%d\", &amp;a);\n  for (i = 0; i &lt; a; i++) {\n    scanf(\"%d\", &amp;c[i]);\n  }\n  for (i = 0; i &lt; a; i++) {\n    disp(fact(c[i]));\n  }\n  return 0;\n}\n\ndouble fact(int n) {\n  double f;\n  if (n == 1 || n == 0)\n    f = (double) 1;\n  else\n    f = (double) n * fact(n - 1);\n  return f;\n}\n\nvoid disp(double t) {\n  printf(\"%f\\n\", t);\n}\n</code></pre>\n"}, {"tags": ["c", "command", "exec"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535571531, "post_id": 52084867, "comment_id": 91120114, "body": "The shell expands <code>~&#47;foo.txt</code> for you before running the command. You therefore have to do that expansion if you want it to work \u2014 or use a shell to do the expansion for you. <code>execvp</code> has no problem with <code>~</code>; there simply isn&#39;t a directory called <code>~</code> in the current directory (and therefore there isn&#39;t a file called <code>foo.txt</code> in the non-existent directory).  It&#39;s not all that hard to write the code to do the job (though doing it properly per POSIX requires attention to detail \u2014 see <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_01\" rel=\"nofollow noreferrer\">Tilde expansion</a>)."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535571537, "post_id": 52084867, "comment_id": 91120118, "body": "<code>~</code> only expands in the <i>shell</i> AFAIK. So it will not expand in a custom <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> program. I mean, <code>program ~&#47;xxx</code> in the shell will expand <code>~</code> and not <code>program</code>."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1535571675, "creation_date": 1535571675, "answer_id": 52084998, "question_id": 52084867, "link": "https://stackoverflow.com/questions/52084867/running-wc-using-execvp-recognizes-home-usr-foo-txt-but-not-foo-txt/52084998#52084998", "title": "Running &#39;wc&#39; using execvp() recognizes /home/usr/foo.txt but not ~/foo.txt", "body": "<p>Tilde (<code>~</code>) expansion is done/understood by shells only - it's not expanded in C programs. So <code>execvp</code> attempts to interpret <code>~</code> as part of the filename (argument to <code>wc</code>).</p>\n\n<p>What you can do is get the <code>HOME</code> directory value using <code>getenv</code> and prefix it with the filename (e.g., using <code>snprintf</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1535577772, "last_edit_date": 1535577772, "creation_date": 1535577326, "answer_id": 52086171, "question_id": 52084867, "link": "https://stackoverflow.com/questions/52084867/running-wc-using-execvp-recognizes-home-usr-foo-txt-but-not-foo-txt/52086171#52086171", "title": "Running &#39;wc&#39; using execvp() recognizes /home/usr/foo.txt but not ~/foo.txt", "body": "<p>When you type a file name such as <code>~/foo.txt</code> at the command line, the shell expands it for you before running the command. You therefore have to do that expansion in your C code if you want it to work \u2014 or use a shell to do the expansion for you. Neither the <code>execvp()</code> function nor the <code>wc</code> command has any problem with <code>~</code>; there simply isn't a directory called <code>~</code> in the current directory (and therefore there isn't a file called <code>foo.txt</code> in the non-existent directory).</p>\n\n<p>It's not all that hard to write the code to do the job (though doing it properly per POSIX requires attention to detail \u2014 see <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_01\" rel=\"nofollow noreferrer\">Tilde expansion</a>).</p>\n\n<p>However, there are also standard POSIX functions that can help and do that job, notably <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/wordexp.html\" rel=\"nofollow noreferrer\"><code>wordexp()</code></a>.  Although the standard doesn't explicitly mention tilde expansion, it does mention <code>WRDE_NOCMD</code> to suppress <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_03\" rel=\"nofollow noreferrer\">command substitution</a>, so it is supposed to do a thorough job and tilde expansion should be included in a conforming implementation.</p>\n\n<p>Here is some simple test code exercising the function:</p>\n\n<pre><code>#include \"stderr.h\"\n#include &lt;stdio.h&gt;\n#include &lt;wordexp.h&gt;\n\n/*\nint wordexp(const char *restrict words, wordexp_t *restrict pwordexp,\n       int flags);\nvoid wordfree(wordexp_t *pwordexp);\n*/\n\nstatic void do_wordexp(const char *name)\n{\n    wordexp_t wx = { 0 };\n    if (wordexp(name, &amp;wx, WRDE_NOCMD) != 0)\n        err_remark(\"Failed to expand word [%s]\\n\", name);\n    else\n    {\n        printf(\"Expansion of [%s]:\\n\", name);\n        for (size_t i = 0; i &lt; wx.we_wordc; i++)\n            printf(\"%zu: [%s]\\n\", i+1, wx.we_wordv[i]);\n        wordfree(&amp;wx);\n    }\n}\n\nint main(int argc, char **argv)\n{\n    err_setarg0(argv[0]);\n\n    if (argc &lt;= 1)\n        do_wordexp(\"~/.profile\");\n    else\n    {\n        for (int i = 1; i &lt; argc; i++)\n            do_wordexp(argv[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>And here are a couple of sample runs (program <code>wexp19</code> built from <code>wexp19.c</code>):</p>\n\n<pre><code>$ wexp19\nExpansion of [~/.profile]:\n1: [/Users/jonathanleffler/.profile]\n$ wexp19 '~informix/bin/oninit' '~/bin/rfmt'  '~/bin/al ~/bin/b?' '~/bin/f?' '$IXD/bin/onstat' ' ~/bin/ow '\nExpansion of [~informix/bin/oninit]:\n1: [/Users/informix/bin/oninit]\nExpansion of [~/bin/rfmt]:\n1: [/Users/jonathanleffler/bin/rfmt]\nExpansion of [~/bin/al ~/bin/b?]:\n1: [/Users/jonathanleffler/bin/al]\n2: [/Users/jonathanleffler/bin/bk]\nExpansion of [~/bin/f?]:\n1: [/Users/jonathanleffler/bin/fd]\n2: [/Users/jonathanleffler/bin/fl]\n3: [/Users/jonathanleffler/bin/fm]\nExpansion of [$IXD/bin/onstat]:\n1: [/opt/informix/12.10.FC6/bin/onstat]\nExpansion of [ ~/bin/ow ]:\n1: [/Users/jonathanleffler/bin/ow]\n$\n</code></pre>\n\n<p>Note in particular the result of expanding the quote-enclosed command line argument <code>'~/bin/al ~/bin/b?'</code>; it is split and the words are separately expanded.  The next to last argument expands the environment variable <code>$IXD</code> from my environment, too, and the last example shows blanks are removed.  The single quotes on the command line are necessary to stop the shell from doing what I want to demonstrate <code>wordexp()</code> doing.</p>\n\n<p>Tests run on a Mac running macOS 10.13.6 High Sierra, and using GCC 8.2.0.  YMMV!</p>\n"}], "owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 52084998, "answer_count": 2, "score": 0, "last_activity_date": 1537719251, "creation_date": 1535571170, "last_edit_date": 1537719251, "question_id": 52084867, "link": "https://stackoverflow.com/questions/52084867/running-wc-using-execvp-recognizes-home-usr-foo-txt-but-not-foo-txt", "title": "Running &#39;wc&#39; using execvp() recognizes /home/usr/foo.txt but not ~/foo.txt", "body": "<p>I have a program where I want to run the command <code>wc</code> using execvp(). </p>\n\n<p>The important bits are here:</p>\n\n<pre><code>char *argvNew[5];\nargvNew[0] = \"wc\";\nargvNew[1] = \"/home/user/foo.txt\";\nargvNew[2] = NULL;\nexecvp(argvNew[0], arvgNew);\n</code></pre>\n\n<p>This works just fine and the terminal displays the output from <code>wc</code>. However, when I change the line to: </p>\n\n<pre><code>argvNew[1] = \"~/foo.txt\"\n</code></pre>\n\n<p>I get this error in the terminal:</p>\n\n<pre><code>wc: '~/foo.txt': No such file or directory\n</code></pre>\n\n<p>Running <code>wc ~/foo.txt</code> directly from the terminal behaves exactly as running <code>wc /home/user/foo.txt</code>. Why does <code>execvp</code> have an issue with the <code>~/</code> part?</p>\n"}, {"tags": ["c", "pid", "kill"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535570991, "post_id": 52084779, "comment_id": 91119880, "body": "For <code>atoi</code> you need <i>stdlib.h</i>"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1535571220, "post_id": 52084830, "comment_id": 91119975, "body": "I think MinGW will make most or all of POSIX available, I guess <code>kill()</code> will be translated internally my MinGW."}, {"owner": {"reputation": 413, "user_id": 9515617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158cbda5e9028112d9c974559f56194f?s=128&d=identicon&r=PG", "display_name": "Cl00e9ment", "link": "https://stackoverflow.com/users/9515617/cl00e9ment"}, "edited": false, "score": 0, "creation_date": 1535571370, "post_id": 52084830, "comment_id": 91120039, "body": "I don&#39;t mentioned it, but I need to kill the process &quot;softly&quot;, with SIGINT."}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535571757, "post_id": 52084830, "comment_id": 91120216, "body": "@IharobAlAsimi I hadn&#39;t considered this and you may be correct."}], "tags": [], "owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "is_accepted": false, "score": 1, "last_activity_date": 1535577879, "last_edit_date": 1535577879, "creation_date": 1535571041, "answer_id": 52084830, "question_id": 52084779, "link": "https://stackoverflow.com/questions/52084779/kill-a-process-given-its-pid/52084830#52084830", "title": "kill a process given its PID", "body": "<p><code>kill</code> is a POSIX function. Since you are on Windows, you will need to find how to kill a process using WINAPI. This is a bit more complicated but this should get you started: <a href=\"https://stackoverflow.com/questions/1916574/how-to-effectively-kill-a-process-in-c-win32\">How to effectively kill a process in C++ (Win32)?</a></p>\n"}], "owner": {"reputation": 413, "user_id": 9515617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158cbda5e9028112d9c974559f56194f?s=128&d=identicon&r=PG", "display_name": "Cl00e9ment", "link": "https://stackoverflow.com/users/9515617/cl00e9ment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535577879, "creation_date": 1535570845, "question_id": 52084779, "link": "https://stackoverflow.com/questions/52084779/kill-a-process-given-its-pid", "title": "kill a process given its PID", "body": "<p>I never programmed in C before, but I need a C program that kills a process given its PID. I know this question was a lot asked, but I encounter a compilation error that I don't understand. Here is the code built with the things that I could find on the Internet:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;signal.h&gt;\n\nint main (int argc, char *argv[]){\n\n    if (argc != 2 ) return 1;\n\n    int pid = atoi (argv[1]);\n    kill (pid, SIGINT);\n\n    return 0;\n}\n</code></pre>\n\n<p>And the logs:</p>\n\n<pre><code>-------------- Build: Debug in processKiller (compiler: GNU GCC Compiler)---------------\n\nmingw32-gcc.exe -Wall -g  -c \"D:\\.Ce PC\\Desktop\\ws processKiller\\processKiller\\main.c\" -o obj\\Debug\\main.o\nD:\\.Ce PC\\Desktop\\ws processKiller\\processKiller\\main.c: In function 'main':\nD:\\.Ce PC\\Desktop\\ws processKiller\\processKiller\\main.c:8:5: warning: implicit declaration of function 'atoi' [-Wimplicit-function-declaration]\n     int pid = atoi (argv[1]);\n     ^\nD:\\.Ce PC\\Desktop\\ws processKiller\\processKiller\\main.c:9:5: warning: implicit declaration of function 'kill' [-Wimplicit-function-declaration]\n     kill (pid, SIGINT);\n     ^\nmingw32-g++.exe  -o bin\\Debug\\processKiller.exe obj\\Debug\\main.o   \nobj\\Debug\\main.o: In function `main':\nD:/.Ce PC/Desktop/ws processKiller/processKiller/main.c:9: undefined reference to `kill'\ncollect2.exe: error: ld returned 1 exit status\nProcess terminated with status 1 (0 minute(s), 0 second(s))\n2 error(s), 2 warning(s) (0 minute(s), 0 second(s))\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "assembly", "gdb", "x86-64", "disassembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1535570776, "post_id": 52084756, "comment_id": 91119787, "body": "That <b>is</b> the address loaded into <code>rcx</code> why do you think otherwise? Your friendly disassembler even put it there for you in a comment. Where did you get the <code>0x403ff3</code> from?"}, {"owner": {"reputation": 1, "user_id": 9648868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b9da7681d5d566f764498298da4c45?s=128&d=identicon&r=PG&f=1", "display_name": "muhm", "link": "https://stackoverflow.com/users/9648868/muhm"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1535570998, "post_id": 52084756, "comment_id": 91119889, "body": "When I check the content of the rip address it says: 0x401564 and I tried to add the 0x2a8f but that will result in 0x403ff3, but why?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1535571149, "post_id": 52084756, "comment_id": 91119945, "body": "It should not say <code>0x401564</code>. It should say <code>0x40156a</code> but even that won&#39;t work because the cpu will use the address of the next instruction, hence you need to add <code>0x401571+0x2a8f=0x404000</code>. The disassembler has done that for you and printed it as comment. Also you could just look at the actual value in <code>rcx</code> to verify."}, {"owner": {"reputation": 1, "user_id": 9648868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b9da7681d5d566f764498298da4c45?s=128&d=identicon&r=PG&f=1", "display_name": "muhm", "link": "https://stackoverflow.com/users/9648868/muhm"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1535571399, "post_id": 52084756, "comment_id": 91120047, "body": "Thank you so much! that makes more sense I just realized that I should have actually stepped through but it did not make sense with 0x40156a again! Your explanation makes sense! Another question though: Is the <code>rip</code> actually increased before any instruction is done? Because it seems like this is the case here"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1535571560, "post_id": 52084756, "comment_id": 91120132, "body": "The debugger will print the current value but yes, the cpu will use the incremented value. That&#39;s for historical reasons. Nowadays cpus are out of order so the classical incrementation does not really apply directly."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1535573531, "post_id": 52084756, "comment_id": 91121032, "body": "The historical reason is pretty easy to explain: in a classic <a href=\"https://en.wikipedia.org/wiki/Classic_RISC_pipeline\" rel=\"nofollow noreferrer\">five-stage pipeline</a>, the &quot;instruction fetch&quot; stage owns the program counter, and it&#39;s already gone on to the next instruction by the time &quot;instruction decode&quot; (which also reads values out of registers) starts happening.  So it&#39;s natural for each instruction that can observe the PC to observe it as holding the address of the next instruction. Early x86es didn&#39;t exactly use this pipeline but it was similar enough for the same principle to apply."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1535588004, "post_id": 52084756, "comment_id": 91125532, "body": "<a href=\"https://stackoverflow.com/a/52023005\">Does Program Counter hold current address or the address of the next instruction?</a>"}], "owner": {"reputation": 1, "user_id": 9648868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b9da7681d5d566f764498298da4c45?s=128&d=identicon&r=PG&f=1", "display_name": "muhm", "link": "https://stackoverflow.com/users/9648868/muhm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535571254, "creation_date": 1535570721, "last_edit_date": 1535571254, "question_id": 52084756, "link": "https://stackoverflow.com/questions/52084756/why-is-there-a-bunch-of-0s-when-i-follow-back-the-disassembly-address-of-a-stri", "title": "Why is there a bunch of 0&#39;s when I follow back the disassembly address of a string", "body": "<p>So I tried to debug my first program with gdb on the console. I was able to make sense of what has been put out, but I couldn't figure out why this address gets moved into the rcx register if it starts with bunch of 0's? So I tried to look further down the address line and the actual string appears 14 bytes off from the address that gets moved into the rcx register. But why? I know there is an address from GDB put there \"0x404000\" and that is actually the place where the string starts, but why doesn't this address get moved into the rcx register? I hope I get an answer here!</p>\n\n<p>The source code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i;\n    for(i = 0; i &lt; 10; ++i)\n    {\n        printf(\"Hello, world!\\n\");\n    }\n}\n</code></pre>\n\n<p>Here is the disassembly of main:</p>\n\n<pre><code>Dump of assembler code for function main():\n0x0000000000401550 &lt;+0&gt;:     push   rbp\n0x0000000000401551 &lt;+1&gt;:     mov    rbp,rsp\n0x0000000000401554 &lt;+4&gt;:     sub    rsp,0x30\n0x0000000000401558 &lt;+8&gt;:     call   0x401640 &lt;__main&gt;\n0x000000000040155d &lt;+13&gt;:    mov    DWORD PTR [rbp-0x4],0x0\n0x0000000000401564 &lt;+20&gt;:    cmp    DWORD PTR [rbp-0x4],0x9\n0x0000000000401568 &lt;+24&gt;:    jg     0x40157c &lt;main()+44&gt;\n0x000000000040156a &lt;+26&gt;:    lea    rcx,[rip+0x2a8f]        # 0x404000\n0x0000000000401571 &lt;+33&gt;:    call   0x402a70 &lt;puts&gt;\n0x0000000000401576 &lt;+38&gt;:    add    DWORD PTR [rbp-0x4],0x1\n0x000000000040157a &lt;+42&gt;:    jmp    0x401564 &lt;main()+20&gt;\n0x000000000040157c &lt;+44&gt;:    mov    eax,0x0\n0x0000000000401581 &lt;+49&gt;:    add    rsp,0x30\n0x0000000000401585 &lt;+53&gt;:    pop    rbp\n0x0000000000401586 &lt;+54&gt;:    ret\nEnd of assembler dump.\n\n0x403ff3:       0 '\\000'        0 '\\000'        0 '\\000'        0 '\\000'        0 '\\000'        0 '\\000'        0 '\\000'        0 '\\000'\n0x403ffb:       0 '\\000'        0 '\\000'        0 '\\000'        0 '\\000'        0 '\\000'        72 'H'  101 'e' 108 'l'\n0x404003:       108 'l' 111 'o' 44 ','  32 ' '  119 'w' 111 'o' 114 'r' 108 'l'\n0x40400b:       100 'd' 33 '!'\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535569621, "post_id": 52084469, "comment_id": 91119282, "body": "Without looking too much at your code using <code>strcat()</code> like that indicates that you don&#39;t know c very much. Also <code>sizeof()</code> may not be doing what you think, it&#39;s certainly not allocating less space."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1535569950, "post_id": 52084469, "comment_id": 91119425, "body": "You have concatenated <code>user</code> twice but not allowed any length at all - nor for the terminating <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535569984, "post_id": 52084469, "comment_id": 91119439, "body": "Use <code>snprintf()</code> and consider that <code>sizeof</code> a array of <code>char</code> that was initialized with a string literal will include the <code>null</code> terminator. So the correct length of a string that is initialized like that is <code>sizeof(string) - 1</code>, it&#39;s the same as <code>strlen(string)</code> which is the correct way to compute the length of a string. If they weren&#39;t <code>char</code> arrays then the code would be very wrong."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535570041, "post_id": 52084469, "comment_id": 91119456, "body": "@WeatherVane The OP used <code>sizeof</code> and that will include each of the <code>null</code> terminators of all the involved strings. But certainly did not allocate space for the <code>user</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535570080, "post_id": 52084469, "comment_id": 91119470, "body": "@IharobAlAsimi good point."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1535570486, "post_id": 52084469, "comment_id": 91119662, "body": "Note that all that is needed to search google is <code>google.com&#47;search?q=&lt;query here&gt;</code>; the other info in the URL can be omitted"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1535571702, "post_id": 52084469, "comment_id": 91120181, "body": "I bet that if you used <code>snprintf</code> to put everything together into <code>temp</code>, and passed in the size that you think you need, that <code>snprintf</code> will return a larger value than you&#39;re expecting."}, {"owner": {"reputation": 3, "user_id": 7582589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/99ee03aa66d1d2c2664270afe8f5b728?s=128&d=identicon&r=PG&f=1", "display_name": "Linkstus", "link": "https://stackoverflow.com/users/7582589/linkstus"}, "edited": false, "score": 1, "creation_date": 1535572663, "post_id": 52084469, "comment_id": 91120620, "body": "I have got it working, ty to all. I am still learning a lot about c."}], "owner": {"reputation": 3, "user_id": 7582589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/99ee03aa66d1d2c2664270afe8f5b728?s=128&d=identicon&r=PG&f=1", "display_name": "Linkstus", "link": "https://stackoverflow.com/users/7582589/linkstus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535572005, "creation_date": 1535569490, "last_edit_date": 1535572005, "question_id": 52084469, "link": "https://stackoverflow.com/questions/52084469/trying-to-do-a-google-search-with-c-and-user-input-and-url-keeps-being-put-on-a", "title": "trying to do a google search with c and user input and url keeps being put on a new line", "body": "<p>I am trying to take in a user input and open up a google search based on that user input, but when I go to print the URL saved in <code>temp</code> to see if it concatenated properly it prints them on separate lines.</p>\n\n<pre><code>char google[] = \"start https:\";\n\nchar first_half[] = \"www.google.com/search?biw=1368&amp;bih=776&amp;ei=Mn6FW9nHDpKyzwKC8prQDw&amp;q=\";\nchar mid_section[] = \"&amp;oq=\";\nchar last_half[] = \"&amp;gs_l=psy-ab.3..35i39k1l2j0i67k1l3j0i131i67k1j0i67k1l4.4561.8093.0.8902.33.11.0.0.0.0.344.826.0j1j0j2.4.0....0...1c.1.64.psy-ab..30.3.748.6..0i22i30k1.231.EO1qOJO2LYY\";\n\nchar user[100];\n\nputs(\"What would you like to search? \");\ngetchar();\nfgets(user, sizeof(user), stdin);\n\nchar temp[sizeof(google) + sizeof(first_half) + sizeof(mid_section) + sizeof(last_half)];\n\nstrcpy(temp, google);\nstrcat(temp, first_half);\nstrcat(temp, user);\nstrcat(temp, mid_section);\nstrcat(temp, user);\nstrcat(temp, last_half);\n\nprintf(\"%s\", temp);\n</code></pre>\n"}, {"tags": ["c", "eclipse", "error-handling", "mingw"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535568212, "post_id": 52084158, "comment_id": 91118665, "body": "Then perhaps you need to install <code>cmake</code>."}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1535570359, "post_id": 52084158, "comment_id": 91119613, "body": "can you add a little more detail? how are you starting your c program? are you importing a cmake project?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 12523630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114043076a8cb4177d0c28b478edb28b?s=128&d=identicon&r=PG&f=1", "display_name": "Inga Rotman", "link": "https://stackoverflow.com/users/12523630/inga-rotman"}, "is_accepted": false, "score": 0, "last_activity_date": 1583220523, "creation_date": 1583220523, "answer_id": 60502106, "question_id": 52084158, "link": "https://stackoverflow.com/questions/52084158/eclipse-photonc-program-not-runningerror-build-command-cmake-not-foundfailu/60502106#60502106", "title": "ECLIPSE PHOTON:C program not running(Error: build command &#39;cmake&#39; not foundFailure running cmake:", "body": "<p>Window -> Preferences -> C/C++ -> Build -> Environment::Add your path, restart</p>\n"}], "owner": {"reputation": 11, "user_id": 10291607, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w36ARIqmUaE/AAAAAAAAAAI/AAAAAAAAQPo/lr6GLlF-Vr8/photo.jpg?sz=128", "display_name": "Vaibhav Bahel", "link": "https://stackoverflow.com/users/10291607/vaibhav-bahel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583220523, "creation_date": 1535568043, "last_edit_date": 1535579289, "question_id": 52084158, "link": "https://stackoverflow.com/questions/52084158/eclipse-photonc-program-not-runningerror-build-command-cmake-not-foundfailu", "title": "ECLIPSE PHOTON:C program not running(Error: build command &#39;cmake&#39; not foundFailure running cmake:", "body": "<p>I just installed eclipse photon and installed the <code>minGW</code> compiler. I can't run any program. When I try to run my C program I get this error</p>\n\n<blockquote>\n  <p>Error: build command 'cmake' not foundFailure running cmake</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568525, "post_id": 52084121, "comment_id": 91118805, "body": "Why do you save the <code>err</code> value but never do anything with it? did you remove the lines handling the errors? Keep them, they will not bother us."}, {"owner": {"reputation": 51, "user_id": 9685982, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9685982/john"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568631, "post_id": 52084121, "comment_id": 91118854, "body": "Yes i removed to not post large code :-) so we can focus on the problem"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1535568654, "post_id": 52084121, "comment_id": 91118862, "body": "You never call <code>accept()</code> on <code>socket_fd</code> to finish establishing the new connection, so the socket is always showing up as readable since it has a pending connection."}, {"owner": {"reputation": 51, "user_id": 9685982, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9685982/john"}, "edited": false, "score": 0, "creation_date": 1535568847, "post_id": 52084121, "comment_id": 91118955, "body": "Shawn! that give sense  :D - e.udata most contain the accept function? can you show how to extract it from the event_loop??"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1535568857, "post_id": 52084121, "comment_id": 91118960, "body": "Adding to @Shawn if you used <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\"><code>select(2)</code></a> then you can make a distintion between <code>accept()</code> and when the socket is readable. I&#39;ve implemented such event system in the past."}, {"owner": {"reputation": 51, "user_id": 9685982, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9685982/john"}, "edited": false, "score": 0, "creation_date": 1535569081, "post_id": 52084121, "comment_id": 91119054, "body": "Select have a timeout and you have to loop it to check, but kqueue will notify you about changes"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1535569422, "post_id": 52084121, "comment_id": 91119197, "body": "Extract? You mean remove the listening socket from the kevent queue? You can do that with <code>EV_DELETE</code> (Or <code>EV_DISABLE</code>). There&#39;s also <code>EV_ONESHOT</code> to only trigger the notification once. But the usual workflow would be, when the listening socket comes up as readable, to accept a new socket from it, and add that to the kqueue so you know when there&#39;s data waiting to be read from it, and leave the listening socket in the kqueue so that you get notified of additional connections."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1535569583, "post_id": 52084121, "comment_id": 91119265, "body": "I&#39;d also suggest, if you&#39;re just using sockets and not any of kqueue&#39;s other notification types, to use a higher level event loop library like libevent, libev, libuv, etc. to manage things. Adds handy features you&#39;d have to write yourself otherwise, and portable to non-BSD OSes."}, {"owner": {"reputation": 51, "user_id": 9685982, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9685982/john"}, "edited": false, "score": 0, "creation_date": 1535569987, "post_id": 52084121, "comment_id": 91119441, "body": "Thank you to both :-) it works now after accepting the clients ! thank you will look the event loop library  it&#39;s just so nice to try make it ourself"}], "owner": {"reputation": 51, "user_id": 9685982, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9685982/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535567901, "creation_date": 1535567901, "question_id": 52084121, "link": "https://stackoverflow.com/questions/52084121/event-loop-trigger-on-socket-connection", "title": "Event loop - Trigger on socket connection", "body": "<p>I'm trying to learn more about event loops and to fully understand it so i have tried to make something basic. I'm on Mac so i'm using <strong>kqueue</strong>. </p>\n\n<p>The idea is to trigger the event loop only on new socket connections. The event loop get triggered on socket connection, but it wont stop on the next cycle. It keep printing after the first connections:</p>\n\n<pre><code>NEW CLIENT\nNEW CLIENT\nNEW CLIENT\nNEW CLIENT\nNEW CLIENT\n</code></pre>\n\n<p>etc...</p>\n\n<p>It supossed to only print \" NEW CLIENT \" on new socket connection.</p>\n\n<p>Here is the full source code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/event.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;errno.h&gt;\n\n\nstruct kevent e;\nstatic struct sockaddr_in server;\nstatic int server_fd, queue;\n\n\nstatic void event_server_listen (int port) {\n    int err, flags;\n\n    queue = kqueue();\n\n    server_fd = socket(AF_INET, SOCK_STREAM, 0);\n\n\n    server.sin_family = AF_INET;\n    server.sin_port = htons(port);\n    server.sin_addr.s_addr = htonl(INADDR_ANY);\n\n    int opt_val = 1;\n    setsockopt(server_fd, SOL_SOCKET, SO_REUSEADDR, &amp;opt_val, sizeof(opt_val));\n\n    err = bind(server_fd, (struct sockaddr *) &amp;server, sizeof(server));\n\n    flags = fcntl(server_fd, F_GETFL, 0);\n\n\n    err = fcntl(server_fd, F_SETFL, flags | O_NONBLOCK);\n\n\n    err = listen(server_fd, SOMAXCONN);\n\n}\n\n\nstatic void event_change (int ident, int filter, int flags, void *udata) {\n\n    e.ident = ident;\n    e.filter = filter;\n    e.flags = flags;\n    e.fflags = 0;\n    e.data = 0;\n    e.udata = udata;\n}\n\nstatic void event_loop () {\n\n    while (1) {\n\n\n        int nev = kevent(queue, &amp;e, 1, &amp;e, 1, NULL);\n\n        if (nev == -1) { exit(0); }\n\n\n        printf(\"NEW CLIENT\\n\");\n\n\n    }\n}\n\n\n\n\n\nint main (int argc, char *argv[]) {\n\n\n    int port = 8899;\n\n    event_server_listen(port);\n    event_change(server_fd, EVFILT_READ, EV_ADD | EV_ENABLE, NULL);\n    event_loop();\n\n    return 0;\n}\n</code></pre>\n\n<p>Can someone please explain why that is happening and show me how to fix it please? </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1535568061, "post_id": 52084120, "comment_id": 91118589, "body": "Pointer to char (<code>char*</code>) is a <b>pointer</b> (an address), which is different than <code>char</code>. Any pointer (not just to char) has 8 bytes (or 4 bytes on 32bit programs) - and thus can store lots of values. If you want the <i>pointed value</i> (which in this case is the <code>char</code>) back from the pointer, you must <i>dereference</i> it (<code>printf(&quot;dereferenced pointer=%c\\n&quot;, *p);</code>)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1535568117, "post_id": 52084120, "comment_id": 91118615, "body": "Please <i>have the text verbatim in the question - both the code and the output</i>, not a screenshot."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535568374, "post_id": 52084120, "comment_id": 91118737, "body": "Aside: please note that you should not try to print a pointer as an <code>int</code>. It should be <code>printf(&quot;p=%p\\n&quot;, (void*)p);</code>"}, {"owner": {"reputation": 13, "user_id": 7223256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155541461619937/picture?type=large", "display_name": "Manoj Kumar Pandit", "link": "https://stackoverflow.com/users/7223256/manoj-kumar-pandit"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1535568891, "post_id": 52084120, "comment_id": 91118977, "body": "Hi @CristiFati : Actually i wanted to know how does pointer internally works ? like if char variable can only store 1 byte --&gt; 255 , then how does pointer variable works interanlly to store more than 255 ?? how does it work internally"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1535569798, "post_id": 52084120, "comment_id": 91119357, "body": "The pointer is a <b>different</b> variable (<code>p</code> which is 8 bytes long). The only link between the pointer and the pointee (in our case the <code>char</code> variable) is that the pointer variable value is the pointee&#39;s address. I&#39;m sure <i>Google</i> would yield tons of tutorials regarding this matter."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1535568132, "creation_date": 1535568132, "answer_id": 52084178, "question_id": 52084120, "link": "https://stackoverflow.com/questions/52084120/range-in-a-pointer-variable-in-c/52084178#52084178", "title": "Range in a pointer variable in C", "body": "<p>Addresses represent a location in memory where an object resides.  It is distinct from the actual type it points to, and need not be the same size.</p>\n\n<p>A pointer to a <code>char</code> wouldn't be much use if it could only hold 256 values.  That would mean there are only 256 bytes worth of characters that could be addressed.</p>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568401, "post_id": 52084189, "comment_id": 91118760, "body": "Why did you escape the single quote? Also, you could prove that size of two pointers is the same regardless of their types."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568513, "post_id": 52084189, "comment_id": 91118800, "body": "@IharobAlAsimi: 1. It&#39;s good practice 2. The C standard only guarantees that <code>char *</code> and <code>void *</code> have the same internal representation and size; other pointer types may not necessarily"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568528, "post_id": 52084189, "comment_id": 91118806, "body": "@IharobAlAsimi good point except Govind is not comparing the size of different pointer types."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535568597, "post_id": 52084189, "comment_id": 91118838, "body": "@WeatherVane I know, but that could help the OP understanding ... I guess."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568688, "post_id": 52084189, "comment_id": 91118884, "body": "@GovindParmar I am not 100% sure but ... If any pointer is convertible to <code>void *</code> and viceversa then I suspect they will all have the same size. Or else, the conversion would not be possible. In that case then casting <code>malloc()</code>&#39;s return value would be mandatory, perhaps. To put an example of a very controvertial good practice not to cast <code>malloc()</code>&#39;s return value. It&#39;s actually the most famous <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> question on SO."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568860, "post_id": 52084189, "comment_id": 91118963, "body": "@IharobAlAsimi C standard &#167; 6.2.5.27:  <code>A pointer to void shall have the same representation and alignment requirements as a pointer to a character type.pointers to structure types shall have the same representation and alignment requirements as each other. All pointers to union types shall have the same representation and alignment requirements as each other. Pointers to other types need not have the same representation or alignment requirements</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535568989, "post_id": 52084189, "comment_id": 91119019, "body": "@IharobAlAsimi <a href=\"https://stackoverflow.com/questions/1241205/are-all-data-pointers-the-same-size-in-one-platform-for-all-data-types\">please see this</a> and it is a good reason for the cast in <code>printf(&quot;p=%p\\n&quot;, (void*)p);</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535569099, "post_id": 52084189, "comment_id": 91119068, "body": "@WeatherVane Very interesting, thanks. There was an example of a case where this is actually true."}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1535568167, "creation_date": 1535568167, "answer_id": 52084189, "question_id": 52084120, "link": "https://stackoverflow.com/questions/52084120/range-in-a-pointer-variable-in-c/52084189#52084189", "title": "Range in a pointer variable in C", "body": "<p>A pointer to a type is not bound by the size restrictions of the type itself.</p>\n\n<p>Simple proof:</p>\n\n<pre><code>if(sizeof(char *)==sizeof(char))\n{\n     printf(\"I\\'ll never get anything done like this.\\n\");\n}\nelse\n{\n     printf(\"Life is good!\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7223256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155541461619937/picture?type=large", "display_name": "Manoj Kumar Pandit", "link": "https://stackoverflow.com/users/7223256/manoj-kumar-pandit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 1, "answer_count": 2, "score": -4, "last_activity_date": 1535568167, "creation_date": 1535567900, "question_id": 52084120, "link": "https://stackoverflow.com/questions/52084120/range-in-a-pointer-variable-in-c", "title": "Range in a pointer variable in C", "body": "<p>i have a basic question,\nLike C says a char object will be 1 byte \nso in case of an unsigned char the range is from 0 to 255</p>\n\n<p>But in case of a char pointer how 1 byte variable can store more than 255 ??</p>\n\n<p>like in the below program as illustration\ni find the a character pointer p store a value of 2358855 > 255 ??</p>\n\n<p>(where i know the value 2358855 is the address, but how can a 1 byte object store more than 255 )?? </p>\n\n<p>Can any one help on this ??<a href=\"https://i.stack.imgur.com/X7vdk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X7vdk.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "performance", "x86", "cpu-architecture", "tsc"], "comments": [{"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1536248132, "post_id": 52083481, "comment_id": 91364517, "body": "The compiler probably doesn&#39;t bother reading from the array because it&#39;s not <code>volatile</code> and the value isn&#39;t used (optimiser would/should ignore it completely); and the cost of an <code>lfence</code> depends on the surrounding code (e.g. how many loads were in flight at the time) and can&#39;t be measured under one set of conditions and assumed to be the same for a different set of conditions."}, {"owner": {"reputation": 18934, "user_id": 859227, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2fd61c62e97e72a9dc6b0b58d60a3da1?s=128&d=identicon&r=PG", "display_name": "mahmood", "link": "https://stackoverflow.com/users/859227/mahmood"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1536248759, "post_id": 52083481, "comment_id": 91364945, "body": "Yes. I forgot to add <code>volatile</code>. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 18934, "user_id": 859227, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2fd61c62e97e72a9dc6b0b58d60a3da1?s=128&d=identicon&r=PG", "display_name": "mahmood", "link": "https://stackoverflow.com/users/859227/mahmood"}, "edited": false, "score": 0, "creation_date": 1535570430, "post_id": 52084451, "comment_id": 91119641, "body": "Yes <code>array[33]</code> has about a hit latency, similar to the second access to <code>array[30]</code>. I will investigate more about prefetch to other levels. Thanks for the tip."}], "tags": [], "owner": {"reputation": 49, "user_id": 5066109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vUQGk.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/5066109/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1535569412, "creation_date": 1535569412, "answer_id": 52084451, "question_id": 52083481, "link": "https://stackoverflow.com/questions/52083481/memory-latency-measurement-with-time-stamp-counter/52084451#52084451", "title": "Memory latency measurement with time stamp counter", "body": "<p>Some ideas:</p>\n\n<ul>\n<li>Perhaps a[70] was prefetched into some level of cache besides L1? </li>\n<li>Perhaps some optimization in DRAM causes this access to be fast, for instance maybe the row buffer is left open after accessing a[30]. </li>\n</ul>\n\n<p>You should investigate other access besides a[30] and a[70] to see if you get different numbers. E.g. do you get the same timings for hit on a[30] followed by a[31] (which should be fetched in the same line as a[30], if you use <a href=\"https://en.cppreference.com/w/c/memory/aligned_alloc\" rel=\"nofollow noreferrer\">aligned_alloc</a> with 64 byte alignment). And do other elements like a[69] and a[71] give the same timings as a[70]?</p>\n"}, {"comments": [{"owner": {"reputation": 18934, "user_id": 859227, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2fd61c62e97e72a9dc6b0b58d60a3da1?s=128&d=identicon&r=PG", "display_name": "mahmood", "link": "https://stackoverflow.com/users/859227/mahmood"}, "edited": false, "score": 0, "creation_date": 1536241530, "post_id": 52086874, "comment_id": 91360087, "body": "Sorry for the late response. Please see UPDATE1 in the post. I wonder how did you get the correct results. Can you run my code?"}, {"owner": {"reputation": 18934, "user_id": 859227, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2fd61c62e97e72a9dc6b0b58d60a3da1?s=128&d=identicon&r=PG", "display_name": "mahmood", "link": "https://stackoverflow.com/users/859227/mahmood"}, "edited": false, "score": 0, "creation_date": 1536248704, "post_id": 52086874, "comment_id": 91364902, "body": "Excuse me I forgot to add <code>volatile</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1538226546, "post_id": 52086874, "comment_id": 92074348, "body": "It&#39;s not safe to assume that two separate <code>&quot;=r&quot;(tmp)</code> and <code>&quot;r&quot;(tmp)</code> operands will use the same register.  These constraints are describing the asm black box to the compiler as a copy-and-whatever.  You modify the input operand and leave the output operand unwritten, unless the compiler happens to pick the same register for both.  You want a single <code>&quot;+r&quot;</code> constraint, or a matching constraint for the input like <code>&quot;0&quot;(tmp)</code> (same location as the <code>%0</code> input).  Or you need to use <code>lea 1(%1), %0</code> ; <code>add $1, %0</code> ; ..."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538236583, "post_id": 52086874, "comment_id": 92076855, "body": "@PeterCordes Thanks. My goal was to just create a dep chain with the load, so I think <code>&quot;=r&quot; (tmp)</code> can be completely dropped. The fact that the asm statement is volatile prevents the compiler from optimizing it away."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538239380, "post_id": 52086874, "comment_id": 92077564, "body": "@HadiBrais: Just use <code>&quot;+r&quot;(tmp)</code>, that does exactly what you want.  I see now that <code>tmp</code> isn&#39;t used later anywhere, but modifying a register in an asm statement with no outputs seems like a terrible idea."}], "tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": true, "score": 3, "last_activity_date": 1538239691, "last_edit_date": 1538239691, "creation_date": 1535581349, "answer_id": 52086874, "question_id": 52083481, "link": "https://stackoverflow.com/questions/52083481/memory-latency-measurement-with-time-stamp-counter/52086874#52086874", "title": "Memory latency measurement with time stamp counter", "body": "<p>First, note that the two calls to <code>printf</code> after measuring <code>diff1</code> and <code>diff2</code> may perturb the state of the L1D and even the L2. On my system, with <code>printf</code>, the reported values for <code>diff3-ov</code> range between 4-48 cycles (I've configured my system so that the TSC frequency is about equal to the core frequency). The most common values are those of the L2 and L3 latencies. If the reported value is 8, then we've got our L1D cache hit. If it is larger than 8, then most probably the preceding call to <code>printf</code> has kicked out the target cache line from the L1D and possibly the L2 (and in some rare cases, the L3!), which would explain the measured latencies that are higher than 8. @PeterCordes have <a href=\"https://stackoverflow.com/questions/51963834/using-time-stamp-counter-and-clock-gettime-for-cache-miss\">suggested</a> to use <code>(void) *((volatile int*)array + i)</code> instead of <code>temp = array[i]; printf(temp)</code>. After making this change, my experiments show that most reported measurements for <code>diff3-ov</code> are exactly 8 cycles (which suggests that the measurement error is about 4 cycles), and the only other values that get reported are 0, 4, and 12. So Peter's approach is strongly recommended.</p>\n\n<p>In general, the main memory access latency depends on many factors including the state of the MMU caches and the impact of the page table walkers on the data caches, the core frequency, the uncore frequency, the state and configuration of the memory controller and the memory chips with respect to the target physical address, uncore contention, and on-core contention due to hyperthreading. <code>array[70]</code> might be in a different virtual page (and physical page) than <code>array[30]</code> and their IPs of the load instructions and the addresses of the target memory locations may interact with the prefetchers in complex ways. So there can be many reasons why <code>cache miss1</code> is different from <code>cache miss2</code>. A thorough investigation is possible, but it would require a lot of effort as you might imagine. Generally, if your core frequency is larger than 1.5 GHz (which is smaller than the <a href=\"https://stackoverflow.com/questions/13772567/get-cpu-cycle-count/51907627#51907627\">TSC frequency</a> on high-perf Intel processors), then an L3 load miss will take at least 60 core cycles. In your case, both miss latencies are over 100 cycles, so these are most likely L3 misses. In some extremely rare cases though, <code>cache miss2</code> seems to be close to the L3 or L2 latency ranges, which would be due to prefetching.</p>\n\n<hr>\n\n<p>I've determined that the following code gives a statistically more accurate measurement on Haswell:</p>\n\n<pre><code>t1 = __rdtscp(&amp;dummy);\ntmp = *((volatile int*)array + 30);\nasm volatile (\"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n              \"add $1, %1\\n\\t\"\n          : \"+r\" (tmp));          \nt2 = __rdtscp(&amp;dummy);\nt2 = __rdtscp(&amp;dummy);\nloadlatency = t2 - t1 - 60; // 60 is the overhead\n</code></pre>\n\n<p>The probability that <code>loadlatency</code> is 4 cycles is 97%. The probability that <code>loadlatency</code> is 8 cycles is 1.7%. The probability that <code>loadlatency</code> takes other values is 1.3%. All of the other values are larger than 8 and multiple of 4. I'll try to add an explanation later.</p>\n"}], "owner": {"reputation": 18934, "user_id": 859227, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2fd61c62e97e72a9dc6b0b58d60a3da1?s=128&d=identicon&r=PG", "display_name": "mahmood", "link": "https://stackoverflow.com/users/859227/mahmood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 1, "accepted_answer_id": 52086874, "answer_count": 2, "score": 3, "last_activity_date": 1549305246, "creation_date": 1535565058, "last_edit_date": 1536254102, "question_id": 52083481, "link": "https://stackoverflow.com/questions/52083481/memory-latency-measurement-with-time-stamp-counter", "title": "Memory latency measurement with time stamp counter", "body": "<p>I have written the following code which first flushes two array elements and then tries to read elements in order to measure the hit/miss latencies.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;x86intrin.h&gt;\n#include &lt;time.h&gt;\nint main()\n{\n    /* create array */\n    int array[ 100 ];\n    int i;\n    for ( i = 0; i &lt; 100; i++ )\n        array[ i ] = i;   // bring array to the cache\n\n    uint64_t t1, t2, ov, diff1, diff2, diff3;\n\n    /* flush the first cache line */\n    _mm_lfence();\n    _mm_clflush( &amp;array[ 30 ] );\n    _mm_clflush( &amp;array[ 70 ] );\n    _mm_lfence();\n\n    /* READ MISS 1 */\n    _mm_lfence();           // fence to keep load order\n    t1 = __rdtsc();         // set start time\n    _mm_lfence();\n    int tmp = array[ 30 ];   // read the first elemet =&gt; cache miss\n    _mm_lfence();\n    t2 = __rdtsc();         // set stop time\n    _mm_lfence();\n\n    diff1 = t2 - t1;        // two fence statements are overhead\n    printf( \"tmp is %d\\ndiff1 is %lu\\n\", tmp, diff1 );\n\n    /* READ MISS 2 */\n    _mm_lfence();           // fence to keep load order\n    t1 = __rdtsc();         // set start time\n    _mm_lfence();\n    tmp = array[ 70 ];      // read the second elemet =&gt; cache miss (or hit due to prefetching?!)\n    _mm_lfence();\n    t2 = __rdtsc();         // set stop time\n    _mm_lfence();\n\n    diff2 = t2 - t1;        // two fence statements are overhead\n    printf( \"tmp is %d\\ndiff2 is %lu\\n\", tmp, diff2 );\n\n\n    /* READ HIT*/\n    _mm_lfence();           // fence to keep load order\n    t1 = __rdtsc();         // set start time\n    _mm_lfence();\n    tmp = array[ 30 ];   // read the first elemet =&gt; cache hit\n    _mm_lfence();\n    t2 = __rdtsc();         // set stop time\n    _mm_lfence();\n\n    diff3 = t2 - t1;        // two fence statements are overhead\n    printf( \"tmp is %d\\ndiff3 is %lu\\n\", tmp, diff3 );\n\n\n    /* measuring fence overhead */\n    _mm_lfence();\n    t1 = __rdtsc();\n    _mm_lfence();\n    _mm_lfence();\n    t2 = __rdtsc();\n    _mm_lfence();\n    ov = t2 - t1;\n\n    printf( \"lfence overhead is %lu\\n\", ov );\n    printf( \"cache miss1 TSC is %lu\\n\", diff1-ov );\n    printf( \"cache miss2 (or hit due to prefetching) TSC is %lu\\n\", diff2-ov );\n    printf( \"cache hit TSC is %lu\\n\", diff3-ov );\n\n\n    return 0;\n}\n</code></pre>\n\n<p>And output is</p>\n\n<pre><code># gcc -O3 -o simple_flush simple_flush.c\n# taskset -c 0 ./simple_flush\ntmp is 30\ndiff1 is 529\ntmp is 70\ndiff2 is 222\ntmp is 30\ndiff3 is 46\nlfence overhead is 32\ncache miss1 TSC is 497\ncache miss2 (or hit due to prefetching) TSC is 190\ncache hit TSC is 14\n# taskset -c 0 ./simple_flush\ntmp is 30\ndiff1 is 486\ntmp is 70\ndiff2 is 276\ntmp is 30\ndiff3 is 46\nlfence overhead is 32\ncache miss1 TSC is 454\ncache miss2 (or hit due to prefetching) TSC is 244\ncache hit TSC is 14\n# taskset -c 0 ./simple_flush\ntmp is 30\ndiff1 is 848\ntmp is 70\ndiff2 is 222\ntmp is 30\ndiff3 is 46\nlfence overhead is 34\ncache miss1 TSC is 814\ncache miss2 (or hit due to prefetching) TSC is 188\ncache hit TSC is 12\n</code></pre>\n\n<p>There are some problems with the output for reading <code>array[70]</code>. The TSC is neither hit nor miss. I had flushed that item similar to <code>array[30]</code>. One possibility is that when <code>array[40]</code> is accessed, the HW prefetcher brings <code>array[70]</code>. So, that should be a hit. However, the TSC is much more than a hit. You can verify that the hit TSC is about 20 when I try to read <code>array[30]</code> for the second time.</p>\n\n<p>Even, if <code>array[70]</code> is not prefetched, the TSC should be similar to a cache miss.</p>\n\n<p>Is there any reason for that?</p>\n\n<p>UPDATE1:</p>\n\n<p>In order to make an array read, I tried <code>(void) *((int*)array+i)</code> as suggested by Peter and Hadi. </p>\n\n<p>In the output I see many negative results. I mean the overhead seems to be larger than <code>(void) *((int*)array+i)</code></p>\n\n<p>UPDATE2:</p>\n\n<p>I forgot to add <code>volatile</code>. The results are now meaningful.</p>\n"}, {"tags": ["c", "language-lawyer", "declaration", "definition", "c11"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535565102, "post_id": 52083473, "comment_id": 91117202, "body": "It means that you cannot declare an enumeration constant without also defining it.  It also means you can&#39;t forward declare enumeration constants.  However, scoping still applies so you could have: <code>enum { NAME1, NAME2 }; void function(void) { enum { NAME1 = 37, NAME2 = -57 }; \u2026 }</code>."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 9771101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebe84778b81ac518fb8d2f76ffe71d5?s=128&d=identicon&r=PG&f=1", "display_name": "Sinushyperbolikus", "link": "https://stackoverflow.com/users/9771101/sinushyperbolikus"}, "edited": false, "score": 0, "creation_date": 1535566238, "post_id": 52083609, "comment_id": 91117762, "body": "So it&#39;s 2.? Because 1. would not make any sense."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 111, "user_id": 9771101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebe84778b81ac518fb8d2f76ffe71d5?s=128&d=identicon&r=PG&f=1", "display_name": "Sinushyperbolikus", "link": "https://stackoverflow.com/users/9771101/sinushyperbolikus"}, "edited": false, "score": 0, "creation_date": 1535566316, "post_id": 52083609, "comment_id": 91117805, "body": "@Sinushyperbolikus Correct.  Since there can be only one declaration (which is also the definition) it doesn&#39;t make sense to talk about multiple declarations."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1535569100, "last_edit_date": 1535569100, "creation_date": 1535565570, "answer_id": 52083609, "question_id": 52083473, "link": "https://stackoverflow.com/questions/52083473/enumeration-constant-declaration-vs-definition-c-standard/52083609#52083609", "title": "Enumeration constant declaration vs. definition - C standard", "body": "<p>It means that declaring an enumeration constant also defines it.</p>\n\n<p>As a result, an enum constant cannot appear more than once in a scope within a translation unit.  For example, the code below is invalid as it redeclares an enum constant:</p>\n\n<pre><code>enum a {\n    AAA,\n    BBB\n};\n\nenum b {\n    BBB,   // error, redeclaration\n    CCC\n};\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 9771101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebe84778b81ac518fb8d2f76ffe71d5?s=128&d=identicon&r=PG&f=1", "display_name": "Sinushyperbolikus", "link": "https://stackoverflow.com/users/9771101/sinushyperbolikus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535569100, "creation_date": 1535565027, "last_edit_date": 1535565154, "question_id": 52083473, "link": "https://stackoverflow.com/questions/52083473/enumeration-constant-declaration-vs-definition-c-standard", "title": "Enumeration constant declaration vs. definition - C standard", "body": "<p>The C11 standard specifies in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7p5\" rel=\"nofollow noreferrer\">section 6.7/5</a>:</p>\n\n<blockquote>\n  <p>C11 6.7/5</p>\n  \n  <p>A definition of an identifier is a declaration for that identifier\n  that:</p>\n  \n  <p>(...)</p>\n  \n  <p>\u2014 for an enumeration constant, is the (only) declaration of the\n  identifier;</p>\n  \n  <p>(...)</p>\n</blockquote>\n\n<p>Does the wording of the above paragraph state that</p>\n\n<ol>\n<li><p>A definition of an enumeration constant is a declaration that is the (only) declaration</p></li>\n<li><p>A definition of an enumeration constant is the (only) declaration?</p></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535562894, "post_id": 52082850, "comment_id": 91116051, "body": "In any case, <i>warning: passing argument 2 of \u2018strcpy\u2019 makes pointer from integer without a cast</i> all over, please check the types. Doesn&#39;t your compiler issue any diagnostics?"}, {"owner": {"reputation": 3, "user_id": 10291163, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XK9Pb3i3Y7E/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPD8vo47nh4B81ULA98vL7He4lK0A/mo/photo.jpg?sz=128", "display_name": "anand jarvis", "link": "https://stackoverflow.com/users/10291163/anand-jarvis"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535563682, "post_id": 52082850, "comment_id": 91116486, "body": "no warning in any case as u mention @AnttiHaapala"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535563726, "post_id": 52082850, "comment_id": 91116508, "body": "Then you might consider getting another C compiler. A proper C compiler which points out errors in your code is priceless when it comes to writing C code that actually works."}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1535563780, "post_id": 52082850, "comment_id": 91116539, "body": "Hi, you appear to be using Turbo C. Not a lot of people still use Turbo C, and it is notorious for non conformance to the C standard. Strongly advise you to try a more modern dev env"}, {"owner": {"reputation": 3, "user_id": 10291163, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XK9Pb3i3Y7E/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPD8vo47nh4B81ULA98vL7He4lK0A/mo/photo.jpg?sz=128", "display_name": "anand jarvis", "link": "https://stackoverflow.com/users/10291163/anand-jarvis"}, "reply_to_user": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1535563913, "post_id": 52082850, "comment_id": 91116598, "body": "i am using dev c++  @Srini"}, {"owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1535564127, "post_id": 52082850, "comment_id": 91116700, "body": "In that case, you have to modify this program. Stuff like <code>conio.h</code> if I remember correctly is a Borland exclusive header. Dev C++, albeit old, still used GCC which doesn&#39;t have a definition for <code>conio.h</code>. Please read <a href=\"http://www.bloodshed.net/dev/faq.html#conio\" rel=\"nofollow noreferrer\">this</a>. In any case it appears to be working fore you. Just a pointer that stuff may not work the same way you expect them to"}, {"owner": {"reputation": 3, "user_id": 10291163, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XK9Pb3i3Y7E/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPD8vo47nh4B81ULA98vL7He4lK0A/mo/photo.jpg?sz=128", "display_name": "anand jarvis", "link": "https://stackoverflow.com/users/10291163/anand-jarvis"}, "reply_to_user": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "edited": false, "score": 0, "creation_date": 1535564571, "post_id": 52082850, "comment_id": 91116914, "body": "after removal of conio.h same output only first block is ececuting and program is terminating u can try running on your system @Srini"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1535573220, "post_id": 52082850, "comment_id": 91120876, "body": "Please don&#39;t post screenshots. They can be difficult or impossible to read, and can&#39;t be searched."}], "answers": [{"tags": [], "owner": {"reputation": 1551, "user_id": 806802, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5kFde.jpg?s=128&g=1", "display_name": "Srini", "link": "https://stackoverflow.com/users/806802/srini"}, "is_accepted": true, "score": 0, "last_activity_date": 1535569231, "creation_date": 1535569231, "answer_id": 52084422, "question_id": 52082850, "link": "https://stackoverflow.com/questions/52082850/need-help-debugging-segfault/52084422#52084422", "title": "Need help debugging segfault", "body": "<p>The reason is suspected <code>conio.h</code> and other outdated headers is this.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n// #include&lt;conio.h&gt;\n#include&lt;string.h&gt;\n\nchar* strrev(char *str)\n{\n      char *p1;\n      int i, j;\n      //puts(\"Reversing\");\n      //puts(str);\n      p1 = (char*)malloc(strlen(str) * sizeof(char));\n      for( i = strlen(str)-1, j =0; i &gt;=0; i--, j++) {\n        p1[j] = str[i];\n      }\n      p1[j] = '\\0';\n      puts(p1);\n      //puts(\"Done\");\n      return p1;\n}\n\nvoid main()\n{\n    char *arr[1][3]= {{\"aABb\",\"c\",\"d\"}};\n    char input[15]= {'\\0'};\n    char temp[15]= {'\\0'};\n    char stack[15]= {'$','S'};\n    int ip=0;\n    int ct=0;\n    int top,i;\n    char x;\n\n    printf(\"\\t\\t\\t Predictive parser\\t\\t\\t\\n\");\n    printf(\"___________________________________________________\\n\\n\");\n    printf(\"The grammar is :\\n\");\n    printf(\"\\t\\tS--&gt;aABb\\n\");\n    printf(\"\\t\\tA--&gt;c\\n\");\n    printf(\"\\t\\tB--&gt;d\\n\\n\");\n    printf(\"You have follow some rules\\n\");\n    printf(\"The string must end with $\\n\");\n    printf(\"Enter  the String  : \");\n    gets(input);\n    top=(strlen(stack))-1;\n    x=stack[top];\n    printf(\"_______________________________________________________\\n\");\n    printf(\"stack\\t\\t\\t input\\t\\t\\t production\\n\");\n    printf(\"________________________________________________________\\n\");\n    while(x!='\\0')\n    {\n        if(x=='S'&amp;&amp;input[ct]=='a')\n        {\n            printf(\"\\n\");\n            for(i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t\");\n            for(i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\tderivation using S--&gt;aABb\\n\");\n            stack[top]='\\0';\n            strcpy(temp,strrev(arr[0][0]));\n            strcat(stack,temp);\n            top=strlen(stack)-1;\n        }\n        else if(x=='A'&amp;&amp;input[ct]=='c')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            strcpy(temp,strrev(arr[0][1]));\n            strcat(stack,temp);\n            top=strlen(stack)-1;\n            printf(\"\\t\\t derivation usingA--&gt;c\\n\");\n        }\n        else if(x=='B'&amp;&amp;input[ct]=='d')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            strcpy(temp,strrev(arr[0][2]));\n            strcat(stack,temp);\n            top=strlen(stack)-1;\n            printf(\"\\t\\t derivation using B--&gt;d\\n\");\n        }\n        else if(x=='a'&amp;&amp;input[ct]=='a')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping a from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='c'&amp;&amp;input[ct]=='c')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping c from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='d'&amp;&amp;input[ct]=='d')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping d from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='b'&amp;&amp;input[ct]=='b')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping b from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='$'&amp;&amp;input[ct]=='$')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            printf(\"\\t\\tSuccessfull\\n\");\n        }\n        else\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            printf(\"\\t\\tUnsuccessfull\\n\");\n            getchar();\n            exit(1);\n        }\n        x=stack[top];\n    }\n    printf(\"\\n____________________ Exit program__________________\");\n    getchar();\n}\n</code></pre>\n\n<p><strong>The above is your code with some tiny modifications</strong></p>\n\n<ol>\n<li>Used a custom <code>strrev</code> , very naive implementation with bad memory practices, but it works.</li>\n<li>got rid of <code>conio</code></li>\n<li>Added <code>stdlib.h</code> for <code>malloc</code> </li>\n<li>got rid of <code>getch</code> in favor of <code>getchar</code></li>\n<li>got rid of <code>clrscr()</code></li>\n</ol>\n\n<p>Nobody knows what bugs <code>conio</code> and the old Borland headers have. They might erroneously redescribe some std functions.</p>\n\n<p>When I run the above with input <code>acdb$</code> I get</p>\n\n<pre><code>                        Predictive parser\n___________________________________________________\n\nThe grammar is :\n                S--&gt;aABb\n                A--&gt;c\n                B--&gt;d\n\nYou have follow some rules\nThe string must end with $\nEnter  the String  : acdb$\n_______________________________________________________\nstack                    input                   production\n________________________________________________________\n\n$S                      acdb$           derivation using S--&gt;aABb\nbBAa\n\n$bBAa                    acdb$           popping a from the stack\n$bBA                      cdb$c\n                 derivation usingA--&gt;c\n\n$bBc                      cdb$           popping c from the stack\n$bB                        db$d\n                 derivation using B--&gt;d\n\n$bd                        db$           popping d from the stack\n$b                          b$           popping b from the stack\n$                            $          Successfull\n\n____________________ Exit program__________________\n</code></pre>\n\n<p>Start using either gcc/clang and use gdb/lldb to debug these programs. </p>\n\n<p><a href=\"https://www.cs.umd.edu/~srhuang/teaching/cmsc212/gdb-tutorial-handout.pdf\" rel=\"nofollow noreferrer\">here</a>'s a nice guide.</p>\n\n<p>If you compile with these options you can see your program is rife with bad programming patterns</p>\n\n<pre><code>gcc -Werror -Wall -Wextra -pedantic parser.c -o parser\nparser.c: In function \u2018strrev\u2019:\nparser.c:9:4: error: C++ style comments are not allowed in ISO C90 [-Werror]\nparser.c:9:4: error: (this will be reported only once per input file) [-Werror]\nparser.c:11:4: error: implicit declaration of function \u2018malloc\u2019 [-Werror=implicit-function-declaration]\nparser.c:11:16: error: incompatible implicit declaration of built-in function \u2018malloc\u2019 [-Werror]\nparser.c: At top level:\nparser.c:21:6: error: return type of \u2018main\u2019 is not \u2018int\u2019 [-Werror=main]\nparser.c: In function \u2018main\u2019:\nparser.c:52:23: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:66:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:80:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:94:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:108:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:122:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:136:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:150:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:161:24: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]\nparser.c:169:13: error: implicit declaration of function \u2018exit\u2019 [-Werror=implicit-function-declaration]\nparser.c:169:13: error: incompatible implicit declaration of built-in function \u2018exit\u2019 [-Werror]\ncc1: all warnings being treated as errors\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10291163, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XK9Pb3i3Y7E/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPD8vo47nh4B81ULA98vL7He4lK0A/mo/photo.jpg?sz=128", "display_name": "anand jarvis", "link": "https://stackoverflow.com/users/10291163/anand-jarvis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 52084422, "answer_count": 1, "score": -4, "last_activity_date": 1535570065, "creation_date": 1535562659, "last_edit_date": 1535570065, "question_id": 52082850, "link": "https://stackoverflow.com/questions/52082850/need-help-debugging-segfault", "title": "Need help debugging segfault", "body": "<p>I do not know whats wrong with my code.  It is compiling correctly but at output it shows second image.  Output tell me what is wrong with code and it must give output as shown in first image.</p>\n\n<p>The code must run like this:\n<a href=\"https://i.stack.imgur.com/UDCHB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UDCHB.png\" alt=\"code must run like this\"></a></p>\n\n<p>But shows this:\n<a href=\"https://i.stack.imgur.com/en3XK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/en3XK.png\" alt=\"but shows this\"></a></p>\n\n<p>I do not know what is wrong in which block.  It is a code which is used to check whether the input string will get accepted or not .</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;string.h&gt;\nvoid main()\n{\n    char *arr[1][3]= {{\"aABb\",\"c\",\"d\"}};\n    char input[15]= {'\\0'};\n    char temp[15]= {'\\0'};\n    char stack[15]= {'$','S'};\n    int ip=0;\n    int ct=0;\n    int top,i;\n    char x;\n    clrscr();\n    printf(\"\\t\\t\\t Predictive parser\\t\\t\\t\\n\");\n    printf(\"___________________________________________________\\n\\n\");\n    printf(\"The grammar is :\\n\");\n    printf(\"\\t\\tS--&gt;aABb\\n\");\n    printf(\"\\t\\tA--&gt;c\\n\");\n    printf(\"\\t\\tB--&gt;d\\n\\n\");\n    printf(\"You have follow some rules\\n\");\n    printf(\"The string must end with $\\n\");\n    printf(\"Enter  the String  : \");\n    gets(input);\n    top=(strlen(stack))-1;\n    x=stack[top];\n    printf(\"_______________________________________________________\\n\");\n    printf(\"stack\\t\\t\\t input\\t\\t\\t production\\n\");\n    printf(\"________________________________________________________\\n\");\n    while(x!='\\0')\n    {\n        if(x=='S'&amp;&amp;input[ct]=='a')\n        {\n            printf(\"\\n\");\n            for(i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t\");\n            for(i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\tderivation using S--&gt;aABb\\n\");\n            stack[top]='\\0';\n            strcpy(temp,strrev(arr[0][0]));\n            strcat(stack,temp);\n            top=strlen(stack)-1;\n        }\n        else if(x=='A'&amp;&amp;input[ct]=='c')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            strcpy(temp,strrev(arr[0][1]));\n            strcat(stack,temp);\n            top=strlen(stack)-1;\n            printf(\"\\t\\t derivation usingA--&gt;c\\n\");\n        }\n        else if(x=='B'&amp;&amp;input[ct]=='d')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            strcpy(temp,strrev(arr[0][2]));\n            strcat(stack,temp);\n            top=strlen(stack)-1;\n            printf(\"\\t\\t derivation using B--&gt;d\\n\");\n        }\n        else if(x=='a'&amp;&amp;input[ct]=='a')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping a from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='c'&amp;&amp;input[ct]=='c')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping c from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='d'&amp;&amp;input[ct]=='d')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping d from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='b'&amp;&amp;input[ct]=='b')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            printf(\"\\t\\t popping b from the stack\");\n            input[ct]=' ';\n            ct++;\n            stack[top]='\\0';\n            top--;\n        }\n        else if(x=='$'&amp;&amp;input[ct]=='$')\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            printf(\"\\t\\tSuccessfull\\n\");\n        }\n        else\n        {\n            printf(\"\\n\");\n            for (i=0; i&lt;=strlen(stack); i++)\n                printf(\"%c\",stack[i]);\n            printf(\"\\t\\t\\t \");\n            for (i=ip; i&lt;6; i++)\n                printf(\"%c\",input[i]);\n            stack[top]='\\0';\n            printf(\"\\t\\tUnsuccessfull\\n\");\n            getch();\n            exit(1);\n        }\n        x=stack[top];\n    }\n    printf(\"\\n____________________ Exit program__________________\");\n    getch();\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1535562396, "post_id": 52082709, "comment_id": 91115762, "body": "What is wrong with this code?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1535562471, "post_id": 52082709, "comment_id": 91115822, "body": "<code>main</code> does not return anything."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1535562620, "post_id": 52082709, "comment_id": 91115901, "body": "<code>size_t</code> is unsigned so the difference cannot be &lt; 0."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 3, "creation_date": 1535562722, "post_id": 52082709, "comment_id": 91115962, "body": "@Osiris <code>main</code> does not have to explicitly return anything, it is the only function returning a value that is exempt."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535562863, "post_id": 52082709, "comment_id": 91116041, "body": "@WeatherVane You are right, i did not know that."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535563601, "post_id": 52082709, "comment_id": 91116449, "body": "@WeatherVane in fact it can be signed too, if <code>size_t</code> has conversion rank less than <code>int</code>..."}, {"owner": {"reputation": 29, "user_id": 10291178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Xy8GEiBP7LE/AAAAAAAAAAI/AAAAAAAAFdQ/drLbVKCOJ3Y/photo.jpg?sz=128", "display_name": "Pavi", "link": "https://stackoverflow.com/users/10291178/pavi"}, "edited": false, "score": 0, "creation_date": 1535563904, "post_id": 52082709, "comment_id": 91116590, "body": "if i print (strlen(s)-strlen(t)) then i wil get -5 so its returning ant int value"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535564221, "post_id": 52082709, "comment_id": 91116744, "body": "@Pavi that depends oh <i>how</i> you print it. Which format specifier? If for example you used <code>%d</code> then <code>printf</code> <i>believes</i> what you tell it. You should use <code>%zu</code> for a <code>size_t</code> type."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535564552, "post_id": 52082709, "comment_id": 91116907, "body": "@AnttiHaapala can you cite that? I can only find in C11 &quot;7.19 2 The types are . . . <b>size_t</b> which is the unsigned integer type of the result of the sizeof operator;&quot;"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1535564770, "post_id": 52082709, "comment_id": 91117020, "body": "@WeatherVane I mean that the result of the subtraction can be signed if <code>size_t</code> maps to say <code>unsigned short</code>, and all of values of <code>unsigned short</code> are representable in an <code>int</code> then that&#39;s where the integer promotions take them to. Nothing in the C standard says that it cannot be <code>unsigned short</code> - on the contrary, the only thing that is said is that it shouldn&#39;t be greater than <code>unsigned long</code> <i>except when necessary</i>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535564879, "post_id": 52082709, "comment_id": 91117080, "body": "@weathervane: right; nothing requires <code>size_t</code> to be as wide as an <code>int</code>. And if it is narrower, integer promotion of the operands to the subtraction will convert it to an <code>int</code>, not an <code>unsigned int</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535564908, "post_id": 52082709, "comment_id": 91117094, "body": "@AnttiHaapala promoting <code>unsigned short</code> to <code>int</code> does not make <code>size_t</code> negative, although a difference can be. How does that help OP understand his problem?"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1535565639, "post_id": 52082709, "comment_id": 91117458, "body": "The strictly correct answer, I think, is because the two strings are not the same length. Unless you have a very unusual compiler, your <code>if</code> statement is checking whether an unsigned integer is greater than zero. It certainly isn&#39;t going to be less."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535566276, "post_id": 52082709, "comment_id": 91117783, "body": "One thing wrong with the code is that it doesn&#39;t <code>#include &lt;string.h&gt;</code> so <code>strlen()</code> is an undeclared function.  C99 and beyond says that isn&#39;t allowed; older versions of C interpreted the function name as a function returning <code>int</code>.  However, the result you claim is not consistent with this \u2014 what warnings did your compiler give?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10291178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Xy8GEiBP7LE/AAAAAAAAAAI/AAAAAAAAFdQ/drLbVKCOJ3Y/photo.jpg?sz=128", "display_name": "Pavi", "link": "https://stackoverflow.com/users/10291178/pavi"}, "edited": false, "score": 0, "creation_date": 1535564071, "post_id": 52082837, "comment_id": 91116666, "body": "Yeah i knw this will work but i have to know why -5&gt;0 condition is not working"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 29, "user_id": 10291178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Xy8GEiBP7LE/AAAAAAAAAAI/AAAAAAAAFdQ/drLbVKCOJ3Y/photo.jpg?sz=128", "display_name": "Pavi", "link": "https://stackoverflow.com/users/10291178/pavi"}, "edited": false, "score": 0, "creation_date": 1535564396, "post_id": 52082837, "comment_id": 91116827, "body": "@Pavi As said since the type is unsigned the result of the subtraction can not be negative. Unsigned ints can only be in range of <code>0</code> to <code>UINT_MAX</code>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 29, "user_id": 10291178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Xy8GEiBP7LE/AAAAAAAAAAI/AAAAAAAAFdQ/drLbVKCOJ3Y/photo.jpg?sz=128", "display_name": "Pavi", "link": "https://stackoverflow.com/users/10291178/pavi"}, "edited": false, "score": 2, "creation_date": 1535564650, "post_id": 52082837, "comment_id": 91116951, "body": "@Pavi Because you don&#39;t actually have -5 on the left side.  You probably have 2^64 - 5 due to the result being unsigned."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535564916, "post_id": 52082837, "comment_id": 91117096, "body": "this is not <code>UINT_MAX</code> here but <code>SIZE_MAX</code>"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535565079, "post_id": 52082837, "comment_id": 91117191, "body": "@AnttiHaapala Yes it should be <code>size_t</code> instead of <code>unsigned int</code> and <code>SIZE_MAX</code> instead of <code>UINT_MAX</code>."}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 6, "last_activity_date": 1535564436, "last_edit_date": 1535564436, "creation_date": 1535562628, "answer_id": 52082837, "question_id": 52082709, "link": "https://stackoverflow.com/questions/52082709/how-subtraction-of-two-strlen-function-works/52082837#52082837", "title": "how subtraction of two strlen() function works", "body": "<p>Return type of <code>strlen</code> is <code>size_t</code> which is an unsigned type. The result of the subtraction is also <code>size_t</code> and can therefore only be positive.</p>\n\n<p>Just use </p>\n\n<pre><code>if(strlen(s) &gt; strlen(t))\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10291178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Xy8GEiBP7LE/AAAAAAAAAAI/AAAAAAAAFdQ/drLbVKCOJ3Y/photo.jpg?sz=128", "display_name": "Pavi", "link": "https://stackoverflow.com/users/10291178/pavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "closed_date": 1535569418, "answer_count": 1, "score": 0, "last_activity_date": 1535569606, "creation_date": 1535562199, "last_edit_date": 1535565042, "question_id": 52082709, "link": "https://stackoverflow.com/questions/52082709/how-subtraction-of-two-strlen-function-works", "closed_reason": "Duplicate", "title": "how subtraction of two strlen() function works", "body": "<p>Why does the shorter string (<code>\"paid\"</code>) get printed by this program?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char s[] = \"paid\", t[] = \"paviDboss\";\n    if ((strlen(s) - strlen(t)) &gt; 0)\n        printf(\"%s\\n\", s);\n    else\n        printf(\"%s\\n\", t);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "putchar"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1535562158, "post_id": 52082630, "comment_id": 91115621, "body": "<code>putchar(*(ptr+1)+2);</code> shouldn&#39;t compile, since the parameter is of type <code>char *</code>. You should enable strict compliance mode in your compiler settings, it should&#39;ve yelled at you for that."}, {"owner": {"reputation": 866, "user_id": 4648976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GGoxE.png?s=128&g=1", "display_name": "mustangDC", "link": "https://stackoverflow.com/users/4648976/mustangdc"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1535562236, "post_id": 52082630, "comment_id": 91115671, "body": "It compiles in gcc and shows garbage <code>?</code> @HolyBlackCat"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1535562236, "post_id": 52082630, "comment_id": 91115672, "body": "<code>note: expected \u2018int\u2019 but argument is of type \u2018char *\u2019</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535562308, "post_id": 52082630, "comment_id": 91115709, "body": "@IharobAlAsimi not &quot;it should issue a warning because... they are...&quot; - it shows the warning because they are <b>not</b> interconvertible and the code is not legal C, containing a constraint violation."}, {"owner": {"reputation": 866, "user_id": 4648976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GGoxE.png?s=128&g=1", "display_name": "mustangDC", "link": "https://stackoverflow.com/users/4648976/mustangdc"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535562390, "post_id": 52082630, "comment_id": 91115759, "body": "@AnttiHaapala: But why? <code>(ptr+1)</code> only depicts the location"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535562456, "post_id": 52082630, "comment_id": 91115809, "body": "@mustangDC this is C not assembly. There is <i>nothing</i> that &quot;only depicts a location&quot; - every pointer in C is declared in terms of the <b>type</b> of the variable it points to."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535562564, "post_id": 52082630, "comment_id": 91115867, "body": "@IharobAlAsimi it is strictly an error. There is nothing non-strict about it. A C compiler is still allowed to try to make sense of the gibberish it is being fed, it doesn&#39;t make the code C though."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535562631, "post_id": 52082630, "comment_id": 91115904, "body": "Like, I can still continue to discuss with you and try to understand you even though obviously you don&#39;t know what is right or wrong about C. It doesn&#39;t prove that you&#39;ve got a point however ;)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535563282, "post_id": 52082630, "comment_id": 91116276, "body": "Just that a C compiler <i>accepts</i> a program and compiles it, doesn&#39;t mean that the program is indeed written in C. A hosted program that does <code>#include &lt;stdio.h&gt;</code> and then <code>putchar((void*)0 + &#39;x&#39;);</code> isn&#39;t legal C even though some C compiler might compile it with only uttering warnings."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1535563379, "post_id": 52082630, "comment_id": 91116339, "body": "Also, as a general guidance, <code>*(ptr+1)</code> is better written as <code>ptr[1]</code>! Then you&#39;d notice that <code>*(*(ptr+1)+2)</code> equals <code>ptr[1][2]</code>... and knowing that  <code>&amp;*</code> cancel each other out, that <code>*(ptr+1)+2</code> will equal <code>&amp;*(*(ptr + 1) + 2)</code>, and following the other rule, <code>&amp;ptr[1][2]</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535564888, "post_id": 52082630, "comment_id": 91117084, "body": "Without <code>-pedantic-errors</code> it&#39;s just a warning. As I said initially ."}], "answers": [{"comments": [{"owner": {"reputation": 866, "user_id": 4648976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GGoxE.png?s=128&g=1", "display_name": "mustangDC", "link": "https://stackoverflow.com/users/4648976/mustangdc"}, "edited": false, "score": 0, "creation_date": 1535562762, "post_id": 52082734, "comment_id": 91115983, "body": "Great. When I converted the <code>char</code> to <code>int</code> I got a location, which is far off the designated indices. Is there any content or article which would explain the pointer complexities better?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 866, "user_id": 4648976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GGoxE.png?s=128&g=1", "display_name": "mustangDC", "link": "https://stackoverflow.com/users/4648976/mustangdc"}, "edited": false, "score": 1, "creation_date": 1535563180, "post_id": 52082734, "comment_id": 91116212, "body": "@mustangDC, that&#39;s not what&#39;s happening. The error is not accessing an array using an out of bounds index. The error is that a pionter gets converted to an <code>int</code>, which gets converted to a <code>char</code>. I learned by C from the classic -- &quot;The C Programming Language&quot; by K&amp;R.There are other books listed at <a href=\"https://www.thecrazyprogrammer.com/2015/04/5-best-c-programming-books.html\" rel=\"nofollow noreferrer\">thecrazyprogrammer.com/2015/04/5-best-c-programming-books.ht&zwnj;&#8203;ml</a>."}, {"owner": {"reputation": 866, "user_id": 4648976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GGoxE.png?s=128&g=1", "display_name": "mustangDC", "link": "https://stackoverflow.com/users/4648976/mustangdc"}, "edited": false, "score": 0, "creation_date": 1535564147, "post_id": 52082734, "comment_id": 91116709, "body": "Does is significantly mean (*(*ptr+1)+2) = &amp;ptr[1][2], which does not make sense. As mentioned by Anti Hapala in one of the comment.. or just , how should i map the the pointers to exact indices"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 866, "user_id": 4648976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GGoxE.png?s=128&g=1", "display_name": "mustangDC", "link": "https://stackoverflow.com/users/4648976/mustangdc"}, "edited": false, "score": 1, "creation_date": 1535564457, "post_id": 52082734, "comment_id": 91116857, "body": "@mustangDC, that comment tries to explain why <code>*(ptr+1)+2</code> is equal to <code>&amp;ptr[1][2]</code>, not <code>(*(*ptr+1)+2)</code>. You have to be very careful with the <code>*</code>s, the parenthesis, and the <code>&amp;</code>s :)"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 5, "last_activity_date": 1535562271, "creation_date": 1535562271, "answer_id": 52082734, "question_id": 52082630, "link": "https://stackoverflow.com/questions/52082630/pointer-to-two-dimensional-array/52082734#52082734", "title": "Pointer to two dimensional array", "body": "<p>You are passing the wrong type to <code>putchar</code> in the last line.</p>\n\n<p>Type of <code>(ptr+1)</code> is <code>char (*)[4]</code>.<br>\nType of <code>*(ptr+1)</code> is <code>char [4]</code>, which decays to <code>char*</code>.<br>\nType of <code>*(ptr+1)+2</code> is <code>char*</code>.</p>\n\n<p>The pointer gets converted to some strange <code>int</code>, which explains the output -- or garbage as you put it more clearly.</p>\n\n<p>When in doubt, it is better to simplify your code than to wonder what's happening.</p>\n\n<p>Using</p>\n\n<pre><code>char c = *(ptr+1)+2;\nputchar(c);\n</code></pre>\n\n<p>might have revealed the problem sooner.</p>\n"}], "owner": {"reputation": 866, "user_id": 4648976, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GGoxE.png?s=128&g=1", "display_name": "mustangDC", "link": "https://stackoverflow.com/users/4648976/mustangdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52082734, "answer_count": 1, "score": 0, "last_activity_date": 1535562271, "creation_date": 1535561929, "question_id": 52082630, "link": "https://stackoverflow.com/questions/52082630/pointer-to-two-dimensional-array", "title": "Pointer to two dimensional array", "body": "<p>Considering the following code:</p>\n\n<pre><code>int main()\n{\n    static char wer[3][4] = {\"bag\",\"let\",\"bud\"};\n    char (*ptr)[4] = wer;\n\n    putchar(*(*(ptr+1)+2));\n    putchar(*(wer[1]+2));\n    putchar(*(ptr+1)+2);\n\n    return 0;\n}\n</code></pre>\n\n<p>the first and second putchar() statement points to the 1st row's 1st element i.e <code>e</code> (considering 0 as the base location), whereas in the 3rd putchar() statement, it shows a garbage value.\n<br>\nBut as far as the statement says, <code>(*(ptr+1))</code> clearly means point to the 2nd row. Why does it happens so? <br>\nIs it due to some <code>putchar()</code> norm, or am I complete off the pointer concept?</p>\n"}, {"tags": ["c", "algorithm", "binary-search-tree"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1535560926, "post_id": 52082359, "comment_id": 91115042, "body": "Welcome to stackoverflow.com. Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535560929, "post_id": 52082359, "comment_id": 91115045, "body": "Please post the code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1535560946, "post_id": 52082359, "comment_id": 91115057, "body": "And please don&#39;t post images of code (or text in general). Copy-paste it into the question instead."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1535561072, "post_id": 52082359, "comment_id": 91115103, "body": "You should really read <code>strtok()</code>&#39;s manual. Also, since <code>root</code> is a pointer you could instead check <code>if (root == NULL) ... create_root();</code> instead of using such a confusing <code>i</code> variable."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1535561161, "post_id": 52082359, "comment_id": 91115148, "body": "Each line read from file overwrites the previous line and so the pointers obtained from <code>strtok</code> become useless."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1535561279, "post_id": 52082359, "comment_id": 91115197, "body": "Another aside: <code>fgets(. . .) &gt; 0</code> should be <code>fgets(. . .) != NULL</code>"}, {"owner": {"reputation": 29, "user_id": 10291142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZMfGhsaLFs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaN03WkNfFa8vNNQRCTe4YmoHDsC_g/mo/photo.jpg?sz=128", "display_name": "Coco Kneer", "link": "https://stackoverflow.com/users/10291142/coco-kneer"}, "edited": false, "score": 0, "creation_date": 1535561406, "post_id": 52082359, "comment_id": 91115238, "body": "What should I do to resolve the overwriting issue?Thank you"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1535561425, "post_id": 52082359, "comment_id": 91115251, "body": "By making copies of each data item, such as with <code>strdup</code> although it is not a standard function."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535561509, "post_id": 52082359, "comment_id": 91115301, "body": "@CocoKneer please read the documentation of <a href=\"http://man7.org/linux/man-pages/man3/strtok_r.3.html\" rel=\"nofollow noreferrer\"><code>man strtok(3)</code></a> throughly. That way you would understand why data is overwritten. If you don&#39;t understand after reading it, then I suggest studying pointers again. I would also suggest a <code>parse_line_and_set_node_data()</code> function to help you write more readable code. Inside the loop there should only be code related to the BST and nothing more."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1535561581, "post_id": 52082359, "comment_id": 91115337, "body": "We need the definition of <code>Node</code> and <code>Data</code>. Without it we cannot help you."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1535561629, "post_id": 52082359, "comment_id": 91115356, "body": "You need to read about <code>strtok</code>. I always say &quot;<i>If nothing helps, read the manual!</i>&quot;"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1535561769, "post_id": 52082359, "comment_id": 91115431, "body": "Once you battle through why your nodes point to the same things, you&#39;ll hit the road block where <code>addNode</code> is broken (and believe me; it&#39;s broken; it doesn&#39;t hang new nodes in the tree; rather it&#39;s a memory leak machine that does nothing to the provided tree). A <i>debugger</i> will be monumental in discovering why."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1535570123, "post_id": 52082359, "comment_id": 91119495, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How To Debug Small Programs</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535672298, "post_id": 52082359, "comment_id": 91164231, "body": "to help us assist you, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>  Only posting parts of the code leaves us guessing about the missing parts"}], "answers": [{"tags": [], "owner": {"reputation": 1368, "user_id": 10291310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ejlRX.jpg?s=128&g=1", "display_name": "Nilesh", "link": "https://stackoverflow.com/users/10291310/nilesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1535569973, "creation_date": 1535569973, "answer_id": 52084582, "question_id": 52082359, "link": "https://stackoverflow.com/questions/52082359/why-does-my-root-node-change-when-i-insert-item-in-bst/52084582#52084582", "title": "Why does my root node change when I insert item in BST?", "body": "<p>As pointed out by various other experts, there are multiple issues with your code snippet. I'll list down a few:</p>\n\n<ol>\n<li><p>Incorrect usage of <code>strtok</code>: strtok returns a <em>pointer</em> to the beginning of the discovered token and at the same time also <em>modifies</em> the input char array which in your case is <code>buff</code>. I've prepared a small code snippet which will help you to better understand the behaviour of the function, <a href=\"https://ideone.com/6NCcrR\" rel=\"nofollow noreferrer\">https://ideone.com/6NCcrR</a>. Consider using <code>strcpy</code> to create a copy of the returned string instead of assigning it directly.</p></li>\n<li><p>Prefer <code>fgets(...) != NULL</code> over <code>fgets(...) &gt; 0</code>, you can understand more about the return value of <code>fgets</code> from <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm\" rel=\"nofollow noreferrer\">here</a>.</p></li>\n<li><p>Your logic for the function <code>addNode</code> is incorrect. Though it's not the most neatest way to proceed, but changing the <code>break;</code> in your function to <code>return newNode;</code> should help a bit. This will avoid the line <code>currentNode = newNode;</code> to be executed every time the function is called which is the problem in your case.</p></li>\n</ol>\n\n<p>Please feel free to cross-question me or correct me if I'm wrong.</p>\n"}], "owner": {"reputation": 29, "user_id": 10291142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QZMfGhsaLFs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaN03WkNfFa8vNNQRCTe4YmoHDsC_g/mo/photo.jpg?sz=128", "display_name": "Coco Kneer", "link": "https://stackoverflow.com/users/10291142/coco-kneer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535569973, "creation_date": 1535560861, "last_edit_date": 1535561194, "question_id": 52082359, "link": "https://stackoverflow.com/questions/52082359/why-does-my-root-node-change-when-i-insert-item-in-bst", "title": "Why does my root node change when I insert item in BST?", "body": "<p>I'm trying to construct a BST from data in a csv file. My code works just fine when I tested it with hardcoded the input, but when I read from the csv file, the root node keep changing to the newly added node for some reason,so I assume there is nothing wrong with my addNode() function but something wrong with my main. What is wrong with my code? Please help.</p>\n\n<pre><code>int main()\n{\n\n    char buff[512];\n    Node* root = makeNode(\"CC\",\"ID 100985\");\n    FILE* fp= fopen(\"athlete_test.csv\",\"r\");\n    int i = 0;\n    while(fgets(buff, 512, (FILE*)fp)&gt;0){\n        Data* data = malloc(sizeof(Data));\n        data-&gt;ID = strtok(buff,\",\");\n        char* Name = strtok(NULL,\",\");\n        data-&gt;Sex = strtok(NULL,\",\");\n        data-&gt;Age = strtok(NULL,\",\");\n        data-&gt;Height = strtok(NULL,\",\");\n        data-&gt;Weight = strtok(NULL,\",\");\n        data-&gt;Team = strtok(NULL,\",\");\n        data-&gt;NOC = strtok(NULL,\",\");\n        data-&gt;Games = strtok(NULL,\",\");\n        data-&gt;Year = strtok(NULL,\",\");\n        data-&gt;Season = strtok(NULL,\",\");\n        data-&gt;City = strtok(NULL,\",\");\n        data-&gt;Sport = strtok(NULL,\",\");\n        data-&gt;Event = strtok(NULL,\",\");\n        data-&gt;Medal = strtok(NULL,\",\");;\n        if (i==0)\n        {\n            root = makeNode(Name,data);\n            i++;\n            printNode(root);\n        }else\n        {\n           addNode(root,Name,data);\n           printNode(root);\n        }\n    }\n    return 0;\n}\n\nNode* makeNode(char* key,Data* data)\n{\n\n    Node* newNode = malloc(sizeof(Node));\n    newNode-&gt;key = key;\n    newNode-&gt;data = data;\n    newNode-&gt;leftNode = NULL;\n    newNode-&gt;rightNode = NULL;\n    return newNode;\n}\n\nNode* addNode(Node* root,char* key,Data* data)\n{\n\n    Node* newNode = makeNode(key,data);\n\n    Node* currentNode = root;\n    while(currentNode != NULL)\n    {\n        if (strcmp(currentNode-&gt;key,newNode-&gt;key)&gt;=0)\n        {\n            if(currentNode-&gt;leftNode == NULL)\n            {\n                currentNode-&gt;leftNode = newNode;\n                break;\n            }\n            currentNode = currentNode-&gt;leftNode;\n        }\n        else\n        {\n            if(currentNode-&gt;rightNode == NULL)\n            {\n                currentNode-&gt;rightNode = newNode;\n                break;\n            }\n            currentNode = currentNode-&gt;rightNode;\n        }\n    }\n    currentNode = newNode;\n    return newNode;\n\n}\n</code></pre>\n\n<p>Theoretically whenever I print root it will be the same, but in reality my result is every single node I added in order.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "go", "system-calls"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1535565165, "post_id": 52081841, "comment_id": 91117244, "body": "One thing to note here is that <i>the library functions</i> will never <i>reset/clear</i> <code>errno</code> - it is the caller&#39;s responsibility to do that."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1535646820, "post_id": 52081841, "comment_id": 91154331, "body": "@Antti: Additionally, in Go, library funtions don\u2019t touch errno at all."}], "answers": [{"comments": [{"owner": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 0, "creation_date": 1535568185, "post_id": 52082560, "comment_id": 91118654, "body": "Thank you so much for your decent answer, it solves all my doubts regarding write call :)"}, {"owner": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 0, "creation_date": 1535635023, "post_id": 52082560, "comment_id": 91146427, "body": "Maybe a follow-up question, what if the <code>writeAll</code>&#39;s <code>write</code> call is interrupted by CPU and another syscall get scheduled (maybe called in another goroutine) and failed, is it possible to receive the <code>errno</code> triggered from the other goroutine in the next <code>write</code> call?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 0, "creation_date": 1535646700, "post_id": 52082560, "comment_id": 91154264, "body": "No, that is not possible."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 0, "creation_date": 1536571172, "post_id": 52082560, "comment_id": 91456620, "body": "Are you checking that the read is complete? Without source code there is not much for me to say."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 6, "last_activity_date": 1535562109, "last_edit_date": 1535562109, "creation_date": 1535561636, "answer_id": 52082560, "question_id": 52081841, "link": "https://stackoverflow.com/questions/52081841/differences-between-c-write-call-and-go-syscall-write/52082560#52082560", "title": "Differences between C write call and Go syscall.Write", "body": "<p>With <code>write</code>, there are only two cases to consider:</p>\n\n<ol>\n<li>If it fails, the result is -1 and <code>errno</code> is set.</li>\n<li>If it succeeds, the result is 0 or larger and <code>errno</code> is not set.</li>\n</ol>\n\n<p>There are no other cases to consider, unless you are interested in historical Unix implementations (see: <a href=\"https://stackoverflow.com/questions/2176443/is-a-return-value-of-0-from-write2-in-c-an-error\">Is a return value of 0 from write(2) in C an error?</a>).</p>\n\n<p>The reason that <code>write</code> may return 0 is because the input buffer may be empty.</p>\n\n<blockquote>\n  <p>However, the man page of C <code>write</code> call roughly describes <code>errno</code> <strong>may</strong> also be set but unspecified if we write zero length buffer without explaining any detail.</p>\n</blockquote>\n\n<p>All this means is that it's possible for a 0-length write to fail. If it fails, it returns -1 and sets <code>errno</code>. If it succeeds, it returns 0 and does not set <code>errno</code>. This is the same behavior for any other write, it's just mentioned in the man page because people may find it surprising that a 0-length write could fail.</p>\n\n<blockquote>\n  <p>What is the status of <code>errno</code> if <code>write</code> call returning 0 for a file, a non-blocking socket, or a blocking socket?</p>\n</blockquote>\n\n<p>In this case, <code>errno</code> is not set, because <code>write</code> did not fail. This will only happen if the input buffer is zero bytes.</p>\n\n<blockquote>\n  <p>When and how <code>write</code> call returning 0 and <code>errno</code> is not 0?</p>\n</blockquote>\n\n<p>This does not happen. Either <code>errno</code> is set and the return is -1, or <code>errno</code> is not set and the return is 0 or larger.</p>\n\n<blockquote>\n  <p>What is the status of <code>errno</code> if <code>write</code> call returning positive? Will it be negative?</p>\n</blockquote>\n\n<p>The <code>errno</code> value will not be set. It will have the same value as it did before the <code>write</code> call.</p>\n\n<blockquote>\n  <p>Is there any other syscall may encounter the same situation?</p>\n</blockquote>\n\n<p>In general, system calls will either return an error <em>or</em> they will succeed. They won't do some mixture of both. Look at the Return Value section of other man pages and you will see that they are mostly the same as <code>write</code>.</p>\n\n<h2>Code</h2>\n\n<p>This code is safe.</p>\n\n<pre><code>func writeAll(fd int, buffer []byte) bool {\n    length := len(buffer)\n    for length &gt; 0 {\n        written, err := syscall.Write(fd, buffer)\n        if err != nil { // here\n            return false\n        }\n        length -= written\n        buffer = buffer[written:]\n    }\n    return true\n}\n</code></pre>\n\n<p>Note that it's a bit redundant, we can just do this:</p>\n\n<pre><code>func writeAll(fd int, buf []byte) bool {\n    for len(buf) &gt; 0 {\n        n, err := syscall.Write(fd, buf)\n        if err != nil {\n            return false\n        }\n        buf = buf[n:]\n    }\n    return true\n}\n</code></pre>\n\n<h2>A note about C</h2>\n\n<p>Technically, <code>write</code> is both a system call and a C function (at least on many systems). However, the C function is just a stub which invokes the system call. Go does not call this stub, it invokes the system call directly, which means that C is not involved here (well, not until you get into the kernel).</p>\n\n<p>The man page shows the calling conventions and behavior of the C stub, <code>write</code>. Go chooses to copy that behavior in its own stub, <code>syscall.Write</code>. The actual system call itself only has an assembly language interface.</p>\n"}], "owner": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 1, "accepted_answer_id": 52082560, "answer_count": 1, "score": 1, "last_activity_date": 1535562109, "creation_date": 1535558781, "question_id": 52081841, "link": "https://stackoverflow.com/questions/52081841/differences-between-c-write-call-and-go-syscall-write", "title": "Differences between C write call and Go syscall.Write", "body": "<p>syscall <code>write</code> returns -1 and set <code>errno</code> is a trivial case. I am interested in the status of <code>errno</code> if C <code>write</code> call returning zero or positive. The wrapper <code>syscall.Write</code> in Go simply returns <code>err</code> if <code>errno</code> is not zero for any case, which also includes the case of <code>write</code> call returns positive.</p>\n\n<p><a href=\"https://github.com/golang/go/blob/3cb64ea39e0d71fe2af554cbf4e99d14bc08d41b/src/syscall/zsyscall_linux_386.go#L1007\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/3cb64ea39e0d71fe2af554cbf4e99d14bc08d41b/src/syscall/zsyscall_linux_386.go#L1007</a></p>\n\n<p>However, the <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\">man page of C <code>write</code> call</a> roughly describes <code>errno</code> <strong>may</strong> also be set but unspecified if we write zero length buffer without explaining any detail.</p>\n\n<p>Thus, the following cases seem unclear:</p>\n\n<ol>\n<li>What is the status of <code>errno</code> if <code>write</code> call returning 0 for a file, a non-blocking socket, or a blocking socket?</li>\n<li>When and how <code>write</code> call returning 0 and <code>errno</code> is not 0?</li>\n<li>What is the status of <code>errno</code> if <code>write</code> call returning positive? Will it be negative?</li>\n<li>Is there any other syscall may encounter the same situation?</li>\n</ol>\n\n<p>I think the above description points to the difference between C <code>write</code> call and Go <code>syscall.Write</code>, which is unclear for developers, here are my thoughts:</p>\n\n<p>According to the man page, returning zero is clearly defined in C <code>write</code> call for to files and for non-blocking sockets, but it's unclear whether there are non-error conditions for a blocking socket which would result in a <code>write()</code> not blocking, returning 0, and (presumably) possibly succeeding later if retried.</p>\n\n<p>Indeed Go directly wraps system call <code>write</code>. However, the following code snippet seems not safe because <code>written</code> equals to zero is a case that may trigger <code>err</code> but we don't want to break the loop:</p>\n\n<pre><code>func writeAll(fd int, buffer []byte) bool {\n    length := len(buffer)\n    for length &gt; 0 {\n        written, err := syscall.Write(fd, buffer)\n        if err != nil { // here\n            return false\n        }\n        length -= written\n        buffer = buffer[written:]\n    }\n    return true\n}\n</code></pre>\n\n<p>Is there any wrong in my suspicion?</p>\n"}, {"tags": ["c", "macos", "unix", "malloc", "free"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1535558510, "post_id": 52081734, "comment_id": 91113787, "body": "There are no leaks created by <code>stat</code>. Why do you think there are? did you use <i>valgrind</i>?"}, {"owner": {"reputation": 21, "user_id": 10180087, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SOoxcg9QCFs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oqEA9Ste5OG0saH8QVQI1qSPbVxQ/mo/photo.jpg?sz=128", "display_name": "johnson dubula", "link": "https://stackoverflow.com/users/10180087/johnson-dubula"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1535558715, "post_id": 52081734, "comment_id": 91113922, "body": "i put the program to sleep, and i used the ps command on my mac, then used leaks to find leaks"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1535559337, "post_id": 52081734, "comment_id": 91114240, "body": "man getpwuid:  &#39;The return value may point to a static area&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 3, "creation_date": 1535559366, "post_id": 52081734, "comment_id": 91114258, "body": "@johnsondubula details like this should be in the question itself."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1535559414, "post_id": 52081734, "comment_id": 91114281, "body": "If you want recursive, thread-safe operation, there is getpwuid_r()"}], "answers": [{"comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1535571297, "post_id": 52084620, "comment_id": 91120016, "body": "<code>sd[i]-&gt;d_name[0] == &#39;.&#39;</code>might be <i>underkill</i> <code>.bashrc</code>starts with a period, for instance. BTW: <code>strncmp(sd[i]-&gt;d_name, &quot;.&quot;, 1)</code> has the same problem,"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1535571524, "post_id": 52084620, "comment_id": 91120111, "body": "@wildplasser OP said he&#39;s writing a version of ls, which filters out dotfiles by default. (Adding support for the <code>-a</code> option requires some trivial changes to avoid that check that aren&#39;t worth including here, especially when the main point is fixing the memory leak.)"}, {"owner": {"reputation": 21, "user_id": 10180087, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SOoxcg9QCFs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oqEA9Ste5OG0saH8QVQI1qSPbVxQ/mo/photo.jpg?sz=128", "display_name": "johnson dubula", "link": "https://stackoverflow.com/users/10180087/johnson-dubula"}, "edited": false, "score": 0, "creation_date": 1535710603, "post_id": 52084620, "comment_id": 91176969, "body": "thank you guys, its resolved, the dot files where not freed"}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": false, "score": 0, "last_activity_date": 1535570957, "last_edit_date": 1535570957, "creation_date": 1535570153, "answer_id": 52084620, "question_id": 52081734, "link": "https://stackoverflow.com/questions/52081734/how-do-i-fix-leaks-created-by-man-2-stat-members-in-c/52084620#52084620", "title": "how do i fix leaks created by man 2 stat members in c", "body": "<pre><code>while (strncmp(sd[i]-&gt;d_name, \".\", 1) == 0)\n            i++;\n// code\nfree(sd[i]);\n</code></pre>\n\n<p>There's the cause of your memory leak. You're never freeing the elements of sd whose filenames start with a period.</p>\n\n<p>Also, I'd use <code>sd[i]-&gt;d_name[0] == '.'</code> for that comparison. <code>strncmp()</code> is overkill for this. A fixed version of your loop:</p>\n\n<pre><code>for (int i = 0; i &lt; n; i += 1) {\n   while (i &lt; n &amp;&amp; sd[i]-&gt;d_name[0] == '.') {\n       free(sd[i++]);\n   }\n   if (i == n) {\n      break;\n   }\n\n    // code\n\n    free(sd[i]);\n}\nfree(sd);\n</code></pre>\n\n<p>In addition, this handles cases where <em>every</em> file returned is a dotfile, where your original one would result in reading past the end of the <code>sd</code> array in that situation.</p>\n"}], "owner": {"reputation": 21, "user_id": 10180087, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SOoxcg9QCFs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oqEA9Ste5OG0saH8QVQI1qSPbVxQ/mo/photo.jpg?sz=128", "display_name": "johnson dubula", "link": "https://stackoverflow.com/users/10180087/johnson-dubula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1535570957, "creation_date": 1535558413, "question_id": 52081734, "link": "https://stackoverflow.com/questions/52081734/how-do-i-fix-leaks-created-by-man-2-stat-members-in-c", "title": "how do i fix leaks created by man 2 stat members in c", "body": "<p>i am re-implimenting the unix ls command, but when i test for leaks it says:Process 44151: 248 nodes malloced for 45 KB, Process 44151: 28 leaks for 560 total leaked bytes. so i tried to free the pwd, and grp. but it says the i am freeing memory that was never allocated.</p>\n\n<pre><code>static int      one(const struct dirent *unused)\n{\n    (void)unused;\n    return (1);\n}\n\nvoid            ls_l(void)\n{\n    struct stat     statbuf;\n    struct group    *grp;\n    struct passwd   *pwd;\n    struct dirent   **sd;\n    int             n;\n    int             i;\n\n    pwd = getpwuid((geteuid()));\n    n = scandir(\".\", &amp;sd, one, alphasort);\n    i = 1;\n    while (i &lt; n)\n    {\n        while (strncmp(sd[i]-&gt;d_name, \".\", 1) == 0)\n            i++;\n        if (stat(sd[i]-&gt;d_name, &amp;statbuf) == 0)\n        {\n            ft_perm(sd[i]-&gt;d_name);\n            ft_printf(\" %-2d %4s  \", statbuf.st_nlink, pwd-&gt;pw_name);\n            if ((grp = getgrgid(statbuf.st_gid)) != NULL)\n                ft_printf(\" %-8.8s %5d %s %s\\n\",grp-&gt;gr_name,\n                        (int)statbuf.st_size,ft_group(ctime(&amp;statbuf.st_mtime)),\n                        sd[i]-&gt;d_name);\n            else\n                ft_printf(\" %-8d %5d %s %s\\n\", statbuf.st_gid,\n                        (int)statbuf.st_size,ft_group(ctime(&amp;statbuf.st_mtime)),\n                        sd[i]-&gt;d_name);\n        }\n        free(sd[i]);\n        i++;\n    }\n    free(sd);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "unix", "io", "kernel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535558534, "post_id": 52081739, "comment_id": 91113806, "body": "Thanks. In &quot;If that descriptor is the last one referring to the corresponding open file description&quot;, what do you mean by &quot;descriptor&quot; and &quot;open file description&quot;?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535558889, "post_id": 52081739, "comment_id": 91114001, "body": "When you open a file (or create a socket, accept a connection, etc.), a new <i>open file description</i> is created. It carries properties like the current seek position, whether it&#39;s set to non-blocking or append mode (the flags you can set with <code>fcntl</code>&#39;s <code>F_SETFL</code>), etc. A file <i>descriptor</i> is just a number that serves as a process-local handle referencing the open file description (OFD). Calling <code>dup</code>, <code>fork</code>ing, etc. create situations where more than one fd refers to the same OFD."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535558900, "post_id": 52081739, "comment_id": 91114007, "body": "@Tim a file can be access by more that one file descriptor. For exemple one can duplicate with dup a file descriptor."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535563324, "post_id": 52081739, "comment_id": 91116298, "body": "@R.. Thanks. If that descriptor is NOT the last one referring to the corresponding open file description, then what will happen? Does <code>close</code> do nothing?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 2, "creation_date": 1535564581, "post_id": 52081739, "comment_id": 91116918, "body": "@Tim It doesn&#39;t do anything <i>to the open file description</i> except maybe decrement a reference count.  But it does invalidate the <i>file descriptor</i> and make that descriptor number available for use by a subsequent <code>dup</code>, <code>open</code>, <code>pipe</code>, <code>socket</code>, etc."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 4, "last_activity_date": 1535558441, "creation_date": 1535558441, "answer_id": 52081739, "question_id": 52081604, "link": "https://stackoverflow.com/questions/52081604/does-closefd-destroy-the-file-table-entry-and-or-the-vnode-table-entry/52081739#52081739", "title": "Does `close(fd)` destroy the file table entry and/or the vnode table entry?", "body": "<p><code>close</code> closes the file <em>descriptor</em>. If that descriptor is the last one referring to the corresponding <em>open file description</em>, then the latter will be closed, which might entail further side effects. This is in terms of the modern meaning of Unix, in terms of the Single Unix Specification/POSIX.</p>\n\n<p>I'm not sure what vnode means; I assume it's part of one historical unix and has some correspondence to open file descriptions.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535562150, "post_id": 52082421, "comment_id": 91115615, "body": "Thanks, but you missed the meanings of file table entry and vnode. For &quot;process file descriptor table&quot;, &quot;(kernel) file  table&quot;, &quot;vnode&quot;, see <a href=\"http://www.cs.rpi.edu/academics/courses/fall04/os/c18/\" rel=\"nofollow noreferrer\">cs.rpi.edu/academics/courses/fall04/os/c18</a>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535563330, "post_id": 52082421, "comment_id": 91116302, "body": "@Tim: That&#39;s one possible implementation (from BSD, I think) but it is not universal. Other unix-likes might use slightly different datastructures, giving them very different names. Posix does not standardise anything except the values returned by <code>stat</code> (or <code>fstat</code>)."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1535566278, "post_id": 52082421, "comment_id": 91117784, "body": "Tim, whether vnode, inode, fat or ntfs: they are file systems with which the standard library interfaces. You have nothing to with what happens in the filesystem, except be assured your function calls will be reliable executed."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1535567443, "post_id": 52082421, "comment_id": 91118319, "body": "Tim, I followed your link and tried to give some answers."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1535567421, "last_edit_date": 1535567421, "creation_date": 1535561105, "answer_id": 52082421, "question_id": 52081604, "link": "https://stackoverflow.com/questions/52081604/does-closefd-destroy-the-file-table-entry-and-or-the-vnode-table-entry/52082421#52082421", "title": "Does `close(fd)` destroy the file table entry and/or the vnode table entry?", "body": "<p>You may assume that the following functions from the standard library: <code>open, read, write, seek</code> and <code>close</code>, form an <em>interface</em> to the operating system. In that interface it maintains some data structures. Those data structures are of no interest to the user of the standard library.</p>\n\n<p>The functions mentioned do not operate on the file system. Hence no vnodes or inodes are modified by these functions. They will be operated on/modified by the filesystem part of the operating system, if such modification is required by the operations. For example, writing may require new blocks on disk to be allocated, which must be registered in an inode.</p>\n\n<p>The <code>unlink</code> function of the standard library instructs the operating system to remove a file. If the OS can remove the file (i.e. it is not protected, is not open by another process, etc.) it will remove the file from the filesystem, thus modifying inodes. (Filesystems with lazy deletes move the file to a recycle bin).</p>\n\n<p>So: it is <em>not</em> correct that <code>close(fd)</code> also destroys the file table entry associated with <code>fd</code>, if with \"file table entry\" you mean the entry in the filesystem, except possibly for short lived, temporary files (however, those may never have had an entry anyway, depending on the filesystem software of the OS),</p>\n\n<p>and: no, <code>close(fd)</code> does <em>not</em> destroy \"the vnode table entry associated with the vnode table entry\" (which is strange sentence anyway ), if with vnode you mean some type of inode.\n<hr>\nEDIT:</p>\n\n<p>With reference to your course material:</p>\n\n<blockquote>\n  <p>Is it correct that close(fd) must also destroy the file table entry associated with fd? Yes, even if there is another file descriptor referring to the same file table entry?</p>\n</blockquote>\n\n<p>No, that is not correct. <code>close</code> will destroy the entry in the Process File Descriptor Table of the process. The Kernel File Table must maintain a reference count (not shown in your course material) and when that gets to zero, the entry of the KFT can be deleted. So the <code>close</code> causes only the reference count in the KFT to be decremented.</p>\n\n<blockquote>\n  <p>Does <code>close(fd)</code> also destroy the vnode table entry associated with the vnode table entry, or not necessarily? Yes, even if there is another file table entry referring to the same vnode table entry?</p>\n</blockquote>\n\n<p>I find this question not relevant or I don't understand it. There is no vnode table entry. There is only a vnode identifier in the KFT. Managing vnodes (i.e. storage allocation and deallocation) is beyond the scope of your course.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1535567421, "creation_date": 1535558049, "last_edit_date": 1535562091, "question_id": 52081604, "link": "https://stackoverflow.com/questions/52081604/does-closefd-destroy-the-file-table-entry-and-or-the-vnode-table-entry", "title": "Does `close(fd)` destroy the file table entry and/or the vnode table entry?", "body": "<p>In Unix</p>\n\n<pre><code>#include &lt;unistd.h&gt;\nint close(int fd);\n</code></pre>\n\n<ul>\n<li><p>Is it correct that <code>close(fd)</code> must also destroy  the file table entry associated with <code>fd</code>? Yes, even if there is another file descriptor referring to the same file table entry?</p></li>\n<li><p>Does <code>close(fd)</code> also destroy the vnode table entry associated with the vnode table entry, or not necessarily? Yes, even if there is another file table entry referring to the same vnode table entry?</p></li>\n</ul>\n\n<p>Thanks.</p>\n\n<p>For \"process file descriptor table\", \"(kernel) file  table\", \"vnode\", see <a href=\"http://www.cs.rpi.edu/academics/courses/fall04/os/c18/\" rel=\"nofollow noreferrer\">http://www.cs.rpi.edu/academics/courses/fall04/os/c18/</a></p>\n\n<p>Note: My question comes from APUE.  I am actually interested in Linux, but Linux doesn't have vnode, but general inode structure. So for \"vnode\" still to apply, I have to ask for Unix.</p>\n"}, {"tags": ["c", "segmentation-fault"], "answers": [{"tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": true, "score": 1, "last_activity_date": 1535557009, "last_edit_date": 1535557009, "creation_date": 1535556398, "answer_id": 52081147, "question_id": 52080994, "link": "https://stackoverflow.com/questions/52080994/shows-an-error-zsh-segmentation-fault-how-to-change/52081147#52081147", "title": "Shows an error zsh: segmentation fault . How to change?", "body": "<p>You don't stop your while loop and end up accessing somewhere you shouldn't.</p>\n\n<p>argv is an array of string which size is \"argc\", so \"j\" should not be equal or greater than \"argc\".</p>\n\n<p>But in reality, argv is an array of size \"argc + 1\", the last value being NULL.\nSo you could simply loop until \"argv[j]\" is NULL.</p>\n"}, {"comments": [{"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535556491, "post_id": 52081148, "comment_id": 91112410, "body": "given the function name &quot;ft_putchar&quot;, this is a student a the &quot;42&quot; school that don&#39;t allow for loop. Yes .... I know ...."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535556592, "post_id": 52081148, "comment_id": 91112487, "body": "@Tom&#39;s Wow never heard of such a thing.  I suppose he could change the first <code>while</code> loop to something like <code>while (argv[j])</code>"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535556773, "post_id": 52081148, "comment_id": 91112623, "body": "Yes ... Sadly, this madness come from &quot;Epitech&quot;. And the shcool &quot;Etna&quot; and &quot;42&quot; are like copy/paste of Epitech. A lot of ink have bleed over this senseless rule, and it appear that forbidding the for loop is because some student abused it by making monstruous for loop (and because &quot;it&#39;s possible with a while loop, so why it bother you ?&quot; ...). Yes ... I know ...."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1535556874, "last_edit_date": 1535556874, "creation_date": 1535556409, "answer_id": 52081148, "question_id": 52080994, "link": "https://stackoverflow.com/questions/52080994/shows-an-error-zsh-segmentation-fault-how-to-change/52081148#52081148", "title": "Shows an error zsh: segmentation fault . How to change?", "body": "<p>When <code>argc</code> is <code>3</code> for example argv[3] is <code>NULL</code> so your <code>segfault</code> is accessing <code>argv[3][i]</code><br>\nLoop instead <code>for (j=0; j&lt;argc; j++)</code></p>\n\n<p>If for <i>some</i> reason you can't use a <code>for</code> loop this code should help;</p>\n\n<pre><code>int     main(int argc, char **argv)\n{\n\n    int i;\n    int j;\n    i = 0;\n    j = 1;\n    if (argc &gt;= 1)\n    {\n        while (argv[j])\n        {\n            while (argv[j][i] != '\\0')\n            {\n                ft_putchar(argv[j][i]);\n                i++;\n            }\n            j++;\n            i = 0;\n            ft_putchar('\\n');\n        }\n    }\n    return (0);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10290798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p5sYBI_EPY8/AAAAAAAAAAI/AAAAAAAAABQ/FzBPbWgUB9I/photo.jpg?sz=128", "display_name": "Aynozerov Sergey", "link": "https://stackoverflow.com/users/10290798/aynozerov-sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2274, "favorite_count": 0, "accepted_answer_id": 52081147, "answer_count": 2, "score": -3, "last_activity_date": 1535557009, "creation_date": 1535555942, "last_edit_date": 1535556157, "question_id": 52080994, "link": "https://stackoverflow.com/questions/52080994/shows-an-error-zsh-segmentation-fault-how-to-change", "title": "Shows an error zsh: segmentation fault . How to change?", "body": "<p>i try to create a program that displays its given arguments.\nwhen i start a compiled programm, \ni write test1 test2 test3 test4</p>\n\n<p>it displays:</p>\n\n<pre><code>-\n\ntest1\ntest2\ntest3\ntest4\nzsh: segmentation fault  ./a.out test1 test2 test3 test4\n\n-\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>int     main(int argc, char **argv)\n{\n\n    int i;\n    int j;\n    i = 0;\n    j = 1;\n    if (argc &gt;= 1)\n    {\n        while (argv[j][i] != '\\0')\n        {\n            while (argv[j][i] != '\\0')\n            {\n                ft_putchar(argv[j][i]);\n                i++;\n            }\n            j++;\n            i = 0;\n            ft_putchar('\\n');\n        }\n    }\n    return (0);\n}\n</code></pre>\n\n<p>What should i change in my code?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "malloc", "free"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1535555363, "post_id": 52080766, "comment_id": 91111633, "body": "The problem is probably in the part where you &quot;use them in the program&quot;, which you don&#39;t show us. So please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> to show us."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1535555514, "post_id": 52080766, "comment_id": 91111763, "body": "Can you proof that all three pointers are non-NULL at the point of freeing and have not changed, e.g. to left=left+1... and most importantly have not already been freed?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535555569, "post_id": 52080766, "comment_id": 91111818, "body": "Please don&#39;t tell a story, but provide the MCVE and all information as specified by <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535555611, "post_id": 52080766, "comment_id": 91111845, "body": "<code>sizeof(char)</code> is always equal to 1, so you can skip it. You don&#39;t check if malloc failed (but that&#39;s not the problem, free(NULL) is ok to do). So, the code you showing us should &quot;working&quot;. Your bug lies somewhere on code that you don&#39;t show us. Provide an MVCE please."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535557309, "post_id": 52080766, "comment_id": 91112999, "body": "@Tom&#39;s: <code>T-&gt;\u2026</code> will invoke UB nevertheless. But OP seems not to be interested to provide all required information and a MCVE, so we should let it be."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535557605, "post_id": 52080766, "comment_id": 91113190, "body": "@toohonestforthissite Aaaaah, I forgot the case if the malloc of T failed, you&#39;re rigth."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 250, "user_id": 10118785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBK6yjyiX5Y/AAAAAAAAAAI/AAAAAAAAAE8/GSDei6J9J18/photo.jpg?sz=128", "display_name": "Leon Trotsky", "link": "https://stackoverflow.com/users/10118785/leon-trotsky"}, "edited": false, "score": 0, "creation_date": 1535557724, "post_id": 52080766, "comment_id": 91113272, "body": "@LeonTrotsky: You better had checked the type of <code>T</code> before posting this."}, {"owner": {"reputation": 1, "user_id": 10290693, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xejGP3qyuHM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO2SC-e3dsQJKnVnjHfGtnCFRGnvA/mo/photo.jpg?sz=128", "display_name": "Mario", "link": "https://stackoverflow.com/users/10290693/mario"}, "edited": false, "score": 0, "creation_date": 1535557872, "post_id": 52080766, "comment_id": 91113372, "body": "Yes sorry if i didn&#39;t provide all the informations."}, {"owner": {"reputation": 1, "user_id": 10290693, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xejGP3qyuHM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO2SC-e3dsQJKnVnjHfGtnCFRGnvA/mo/photo.jpg?sz=128", "display_name": "Mario", "link": "https://stackoverflow.com/users/10290693/mario"}, "edited": false, "score": 0, "creation_date": 1535558419, "post_id": 52080766, "comment_id": 91113724, "body": "I added the part after which it goes in Segmentation fault."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1535558669, "post_id": 52080766, "comment_id": 91113890, "body": "what do you expect <code>malloc(string2 + x)</code> to do? malloc neesa number as input, not a pointer to a string"}, {"owner": {"reputation": 1, "user_id": 10290693, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xejGP3qyuHM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO2SC-e3dsQJKnVnjHfGtnCFRGnvA/mo/photo.jpg?sz=128", "display_name": "Mario", "link": "https://stackoverflow.com/users/10290693/mario"}, "edited": false, "score": 0, "creation_date": 1535558759, "post_id": 52080766, "comment_id": 91113944, "body": "whoops ,edited ..."}, {"owner": {"reputation": 180, "user_id": 8385942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97f635b936a791ee6b06b2bff8df8871?s=128&d=identicon&r=PG&f=1", "display_name": "satyaGolladi", "link": "https://stackoverflow.com/users/8385942/satyagolladi"}, "edited": false, "score": 0, "creation_date": 1535600822, "post_id": 52080766, "comment_id": 91128006, "body": "sizeof(string2) is the sizeof char pointer. you can try using strlen(string2) instead"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10290693, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xejGP3qyuHM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO2SC-e3dsQJKnVnjHfGtnCFRGnvA/mo/photo.jpg?sz=128", "display_name": "Mario", "link": "https://stackoverflow.com/users/10290693/mario"}, "edited": false, "score": 0, "creation_date": 1535558541, "post_id": 52081651, "comment_id": 91113813, "body": "sorry for not providing the code . i edited to show where i get the problem"}], "tags": [], "owner": {"reputation": 180, "user_id": 8385942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97f635b936a791ee6b06b2bff8df8871?s=128&d=identicon&r=PG&f=1", "display_name": "satyaGolladi", "link": "https://stackoverflow.com/users/8385942/satyagolladi"}, "is_accepted": false, "score": 0, "last_activity_date": 1535558177, "creation_date": 1535558177, "answer_id": 52081651, "question_id": 52080766, "link": "https://stackoverflow.com/questions/52080766/problems-using-free-for-a-struct-of-dynamic-arrays/52081651#52081651", "title": "problems using free for a struct of dynamic arrays", "body": "<p>As @Yunnosch mentioned in comment section, before free dynamic memory you might have modified the pointer.</p>\n\n<p>For example below code gives Segmentation fault</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n\ntypedef struct Tcell {\n    char* left;\n    char* right;\n    struct Tcell* next;\n} Tcell;\n\n\nint main(){\n    Tcell *T;\n    T=malloc(sizeof(Tcell));\n    assert(T != NULL);\n    T-&gt;right=malloc(sizeof(char)*10);\n    assert(T-&gt;right != NULL);\n    T-&gt;left=malloc(sizeof(char)*11);\n    assert(T-&gt;left != NULL);\n\n    printf(\"check\\n\");\n    T = T-&gt; next;\n\n    free(T-&gt;left);\n    free(T-&gt;right);\n    free(T);\n    return 0;\n}\n</code></pre>\n\n<p>When you remove the line</p>\n\n<blockquote>\n<pre><code>T = T-&gt; next;\n</code></pre>\n</blockquote>\n\n<p>it goes fine. </p>\n\n<p>So like this you might have modified your T in your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 10290693, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xejGP3qyuHM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO2SC-e3dsQJKnVnjHfGtnCFRGnvA/mo/photo.jpg?sz=128", "display_name": "Mario", "link": "https://stackoverflow.com/users/10290693/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1535558727, "creation_date": 1535555193, "last_edit_date": 1535558727, "question_id": 52080766, "link": "https://stackoverflow.com/questions/52080766/problems-using-free-for-a-struct-of-dynamic-arrays", "title": "problems using free for a struct of dynamic arrays", "body": "<p>I can't undestand why it gives me a Seg-Fault while processing the following code in C:</p>\n\n<p>here is the type and declaration:</p>\n\n<pre><code>typedef struct Tcell { char* left;\n             char* right;\n            struct Tcell* next;} Tcell;\n\n\nTcell* T;\n\nT=malloc(sizeof(Tcell));\nT-&gt;right=malloc(sizeof(string2) + sizeof(char)*10); //string2 is a dynamic string of chars.\nT-&gt;left=malloc(sizeof(char)*11);\nstrcpy(L-&gt;right, string2); \nL-&gt;left=\"_\";\nfree(T-&gt;left);\nfree(T-&gt;right);\nfree(T);\n</code></pre>\n\n<p>aaaaand i get a Seg-Fault at the first (and the second free)</p>\n\n<p>Can't seem to find the answer anywhere :S</p>\n"}, {"tags": ["c", "strftime"], "comments": [{"owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 3, "creation_date": 1535555126, "post_id": 52080673, "comment_id": 91111436, "body": "You must set the locale for Spanish first and then format the date string. See setlocale function."}, {"owner": {"reputation": 71, "user_id": 2792958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474355d754b56d0089d92e440a480989?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime T", "link": "https://stackoverflow.com/users/2792958/jaime-t"}, "reply_to_user": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1535555412, "post_id": 52080673, "comment_id": 91111680, "body": "Thank you. Will give it a try. If the locale is changed multiple times, can that cause issues with the OS?"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 2792958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474355d754b56d0089d92e440a480989?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime T", "link": "https://stackoverflow.com/users/2792958/jaime-t"}, "edited": false, "score": 0, "creation_date": 1535555421, "post_id": 52080781, "comment_id": 91111692, "body": "Thank you. Will give it a try. If the locale is changed multiple times, can that cause issues with the OS?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 71, "user_id": 2792958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474355d754b56d0089d92e440a480989?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime T", "link": "https://stackoverflow.com/users/2792958/jaime-t"}, "edited": false, "score": 1, "creation_date": 1535555548, "post_id": 52080781, "comment_id": 91111796, "body": "@JaimeT Setting the locale with <code>setlocale</code> only affects the current process, and only the given locale category."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1535559462, "last_edit_date": 1535559462, "creation_date": 1535555228, "answer_id": 52080781, "question_id": 52080673, "link": "https://stackoverflow.com/questions/52080673/display-month-in-spanish-using-strftime/52080781#52080781", "title": "Display Month in Spanish using strftime?", "body": "<p>The <code>strftime</code> function formats dates based on the current locale.  So you'll need to set the locale for <code>LC_TIME</code> first:</p>\n\n<pre><code>setlocale(LC_TIME, \"es_ES-UTF_8\");\n</code></pre>\n\n<p>See <a href=\"https://docs.microsoft.com/en-gb/cpp/c-runtime-library/reference/setlocale-wsetlocale?view=vs-2017\" rel=\"nofollow noreferrer\"><code>setlocale</code></a> for more information.</p>\n"}], "owner": {"reputation": 71, "user_id": 2792958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474355d754b56d0089d92e440a480989?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime T", "link": "https://stackoverflow.com/users/2792958/jaime-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 52080781, "answer_count": 1, "score": 0, "last_activity_date": 1535559462, "creation_date": 1535554983, "question_id": 52080673, "link": "https://stackoverflow.com/questions/52080673/display-month-in-spanish-using-strftime", "title": "Display Month in Spanish using strftime?", "body": "<p>I am trying to get the format a date from 2018-09-01 to September 1, 2018.\nI have been using:</p>\n\n<pre><code>strftime(displayDate, sizeof(displayDate), \"%B %d %Y\", &amp;date_obj);\n</code></pre>\n\n<p>It works perfectly, but, is there a way to format the Month to be in Spanish?</p>\n"}, {"tags": ["c", "file", "sorting"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1535553150, "post_id": 52079958, "comment_id": 91109967, "body": "Please see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is <code>while ( !feof (file) )</code> always wrong?</a> The loop could be improved as <code>while (fgets(one, 255, fpointer) != NULL) { printf(&quot;%s&quot;, one); }</code>"}, {"owner": {"reputation": 73, "user_id": 10290511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53833521f6fd45a67f7c75670782209?s=128&d=identicon&r=PG&f=1", "display_name": "Jack022", "link": "https://stackoverflow.com/users/10290511/jack022"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535553325, "post_id": 52079958, "comment_id": 91110085, "body": "Thank you, i&#39;m editing it!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1535553366, "post_id": 52079958, "comment_id": 91110112, "body": "BTW it&#39;s a good idea not to edit the code posted here, or comments won&#39;t make any sense."}, {"owner": {"reputation": 73, "user_id": 10290511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53833521f6fd45a67f7c75670782209?s=128&d=identicon&r=PG&f=1", "display_name": "Jack022", "link": "https://stackoverflow.com/users/10290511/jack022"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535553437, "post_id": 52079958, "comment_id": 91110173, "body": "Got it, changed only the original one!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535554204, "post_id": 52079958, "comment_id": 91110713, "body": "You could search each input string from the end, to find the beginning of the number, and apply <code>sscanf</code> to extract it."}, {"owner": {"reputation": 73, "user_id": 10290511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53833521f6fd45a67f7c75670782209?s=128&d=identicon&r=PG&f=1", "display_name": "Jack022", "link": "https://stackoverflow.com/users/10290511/jack022"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535554393, "post_id": 52079958, "comment_id": 91110870, "body": "But where could i store each record after it? An array?"}, {"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1535555446, "post_id": 52079958, "comment_id": 91111714, "body": "Maybe you can get some inspiration from the Unix command sort: <a href=\"https://github.com/coreutils/coreutils/blob/master/src/sort.c\" rel=\"nofollow noreferrer\">github.com/coreutils/coreutils/blob/master/src/sort.c</a>"}, {"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1535555526, "post_id": 52079958, "comment_id": 91111781, "body": "For a shorter implementation have look a busybox sort: <a href=\"https://git.busybox.net/busybox/tree/coreutils/sort.c\" rel=\"nofollow noreferrer\">git.busybox.net/busybox/tree/coreutils/sort.c</a>"}, {"owner": {"reputation": 73, "user_id": 10290511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53833521f6fd45a67f7c75670782209?s=128&d=identicon&r=PG&f=1", "display_name": "Jack022", "link": "https://stackoverflow.com/users/10290511/jack022"}, "edited": false, "score": 0, "creation_date": 1535562978, "post_id": 52079958, "comment_id": 91116095, "body": "I&#39;ll look into it, thanks!"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1535565292, "post_id": 52079958, "comment_id": 91117310, "body": "Are you familiar with <code>struct</code>? If you save these to a file in binary, you can read them back wholesale in binary. Look at <code>fread()</code> for more details."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1535565350, "post_id": 52079958, "comment_id": 91117331, "body": "This is actually quite broad task, if you don&#39;t know C or programming. You could start by creating following separate programs. 1. just read and print each line. 2. read each line and store it to a buffer allocated with <code>malloc</code> and print it from the buffer. 3. read each line, parse the number from it and print that (write a function which takes the line, and returns integer). 4. Have an array of char pointers to lines, and read all the lines to buffers allocated with <code>malloc</code>, and put them to the array, then print the lines from the array. 5. Add sorting on top of 4 by using 3."}, {"owner": {"reputation": 73, "user_id": 10290511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53833521f6fd45a67f7c75670782209?s=128&d=identicon&r=PG&f=1", "display_name": "Jack022", "link": "https://stackoverflow.com/users/10290511/jack022"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1535578365, "post_id": 52079958, "comment_id": 91123040, "body": "Thank you @hyde!"}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 6716734, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8IT4-SqVd_k/AAAAAAAAAAI/AAAAAAAAAMg/SjqlcMUYn2g/photo.jpg?sz=128", "display_name": "Verma Aman", "link": "https://stackoverflow.com/users/6716734/verma-aman"}, "is_accepted": true, "score": 0, "last_activity_date": 1535565476, "last_edit_date": 1535565476, "creation_date": 1535564764, "answer_id": 52083407, "question_id": 52079958, "link": "https://stackoverflow.com/questions/52079958/how-can-i-sort-records-in-a-text-file-in-c/52083407#52083407", "title": "How can i sort records in a text file in C?", "body": "<p>Instead of bubble you can go for Insertion Sort.\nFirstly, scan whole file and store each field of the line in array(you can use <code>fscanf()</code> for that). Like, an array <code>user</code> that stores values <code>User Three;</code>, <code>User Two;</code>, <code>User One;</code>, another one that stores <code>Test</code> and similarly for third field.\nAfter getting arrays full of file's content you can easily implement Insertion Sort on last field and accordingly sort all arrays and then write back the arrays to original or another file.\nIf you need help with Insertion sort you can check <a href=\"https://www.geeksforgeeks.org/insertion-sort/\" rel=\"nofollow noreferrer\">this</a> out.\nFor <a href=\"https://www.geeksforgeeks.org/strcmp-in-c-cpp/\" rel=\"nofollow noreferrer\">string comparison</a> use <code>strcmp()</code></p>\n\n<p>Hope this helps.</p>\n\n<p>EDIT: to scan each line in 3 array do something like: </p>\n\n<pre><code>fscanf(\"%s%s%s\", &amp;user[i], &amp;test[i], &amp;num[i], fpointer);\n</code></pre>\n\n<p>run this inside a loop and aftter file reading operation you'll get all the data in the arrays.</p>\n"}], "owner": {"reputation": 73, "user_id": 10290511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53833521f6fd45a67f7c75670782209?s=128&d=identicon&r=PG&f=1", "display_name": "Jack022", "link": "https://stackoverflow.com/users/10290511/jack022"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1561, "favorite_count": 0, "accepted_answer_id": 52083407, "answer_count": 1, "score": 1, "last_activity_date": 1535565476, "creation_date": 1535552968, "last_edit_date": 1535553370, "question_id": 52079958, "link": "https://stackoverflow.com/questions/52079958/how-can-i-sort-records-in-a-text-file-in-c", "title": "How can i sort records in a text file in C?", "body": "<p>I created a program supposed to take inputs from the user and write them on a text file. Now i'm making another program to read those records from the file and sort them.</p>\n\n<p>So i have, for example:</p>\n\n<pre><code>User three; Test three; 30\nUser one; Test; 51\nUser two; Test two; 40\n</code></pre>\n\n<p>The program should sort these records according to the number at the end of it, so it should be:</p>\n\n<pre><code>User one; Test; 51\nUser two; Test two; 40\nUser three; Test three; 30\n</code></pre>\n\n<p>This is my current effort, basically i created a <code>char one</code> variable which will store the data given from <code>fgets</code> and print it. Two problems: <code>char one</code> has a fixed variable (255), so if the record will be longer than 255, there will be an error.</p>\n\n<p>The second problem is that i don't know how to treat each record of the file has a variable, i can print the whole file but i don't know how to compare the data according to the last  number, any advice? I was looking forward to using a bubble sort for it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n\n    char one[255];\n\n    FILE * fpointer = fopen(\"record.txt\", \"r\");\n\n    while (!feof (fpointer) ) {\n    fgets(one, 255, fpointer);\n    printf(\"%s\", one);\n    }\n\n    fclose(fpointer);\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["python", "c", "cpython", "python-c-api"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535570780, "post_id": 52079835, "comment_id": 91119790, "body": "... I would appreciate it if the people closevoting this question as &quot;too broad&quot; would explain why they think so.  It seems like a sensibly scoped question to me!"}, {"owner": {"reputation": 8541, "user_id": 8366499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9t89.jpg?s=128&g=1", "display_name": "divibisan", "link": "https://stackoverflow.com/users/8366499/divibisan"}, "edited": false, "score": 0, "creation_date": 1535572585, "post_id": 52079835, "comment_id": 91120581, "body": "I agree. It&#39;s got a clear scope and topic and, since you&#39;ve answered it, we know it&#39;s not too broad to answer. If you really think the question is too broad to help people find the answer, it&#39;d be better to edit it to be more specific rather than throwing it out altogether."}], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 3, "last_activity_date": 1535552692, "creation_date": 1535552692, "answer_id": 52079836, "question_id": 52079835, "link": "https://stackoverflow.com/questions/52079835/embedding-cpython-how-do-you-constuct-python-callables-to-wrap-c-callback-point/52079836#52079836", "title": "Embedding CPython: how do you constuct Python callables to wrap C callback pointers?", "body": "<p>To define an extension type that is \u201ccallable\u201d in the sense Python uses that\nterm, you fill the <code>tp_call</code> slot of the type object, which is the C equivalent of the <code>__call__</code> special method.  The function that goes in that slot will be a glue routine that calls the actual C callback.  Here\u2019s code for the simplest case, when the C callback takes no arguments and returns nothing.</p>\n\n<pre><code>typedef struct {\n    PyObject_HEAD\n    /* Type-specific fields go here. */\n    void (*cfun)(void);  /* or whatever parameters it actually takes */\n} CallbackObj;\n\nstatic PyObject *Callback_call(PyObject *self, PyObject *args, PyObject *kw)\n{\n    /* check that no arguments were passed */\n    const char no_kwargs[] = { 0 };\n    if (!PyArg_ParseTupleAndKeywords(args, kw, \"\", no_kwargs))\n        return 0;\n\n    CallbackObj *cself = (CallbackObj *)self;\n    cself-&gt;cfun();\n    Py_RETURN_NONE;\n}\n\nstatic PyTypeObject CallbackType = {\n    PyVarObject_HEAD_INIT(NULL, 0)\n    .tp_name = \"mymodule.Callback\",\n    .tp_doc = \"Callback function passed to foo, bar, and baz.\",\n    .tp_basicsize = sizeof(CallbackObj),\n    .tp_itemsize = 0,\n    .tp_flags = Py_TPFLAGS_DEFAULT,\n    .tp_new = PyType_GenericNew,\n    .tp_call = Callback_call,\n};\n</code></pre>\n\n<p>Instantiate the type object with <code>PyType_Ready</code> as usual.  Don\u2019t put it in any module visible to Python, though, because Python code can\u2019t correctly create instances of this type.  (Because of this, I haven\u2019t bothered with a <code>tp_init</code> function; just make sure you always initialize <code>-&gt;cfun</code> after creating instances from C, or <code>Callback_call</code> will crash.)</p>\n\n<p>Now, suppose the actual function you need to call is named <code>real_callback</code>, and the Python function that you want to pass it to is named <code>function_to_call</code>.  First you create one of the callback objects, by\ncalling the type object, as usual, and initialize its <code>-&gt;cfun</code> field:</p>\n\n<pre><code> PyObject *args = PyTuple_New(0);\n CallbackObj *cb = (CallbackObj *)PyObject_CallObject(\n     (PyObject *)CallbackType, args);\n Py_DECREF(args);\n cb-&gt;cfun = real_callback;\n</code></pre>\n\n<p>Then you put <code>cb</code> into an argument tuple, and call the Python function\nobject with that, as usual.</p>\n\n<pre><code> args = Py_BuildValue(\"(O)\", cb);\n PyObject *ret = PyObject_CallObject(function_to_call, args);\n Py_DECREF(args);\n Py_DECREF(cb);\n // do stuff with ret, here, perhaps\n Py_DECREF(ret);\n</code></pre>\n\n<p>Extending this to more complex cases, where the C callback needs to take arguments and/or return values and/or raise Python exceptions on error and/or receive \u201cclosure\u201d information from the outer context, is left as an exercise.  </p>\n"}, {"tags": [], "owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "is_accepted": false, "score": 2, "last_activity_date": 1535893966, "last_edit_date": 1535893966, "creation_date": 1535879757, "answer_id": 52135550, "question_id": 52079835, "link": "https://stackoverflow.com/questions/52079835/embedding-cpython-how-do-you-constuct-python-callables-to-wrap-c-callback-point/52135550#52135550", "title": "Embedding CPython: how do you constuct Python callables to wrap C callback pointers?", "body": "<p>I'd be tempted to use the standard library <a href=\"https://docs.python.org/3/library/ctypes.html\" rel=\"nofollow noreferrer\">ctypes module</a> since it already contains appropriate wrappers for C function pointers, and can automatically deal with conversions from Python types to C types for wide variety of arguments.</p>\n\n<p>I've written a working example in Cython since it's an easy way of mixing Python and C, but it should show how to use these objects:</p>\n\n<pre><code>cdef extern from *:\n    \"\"\"\n    int f(int x) {\n       return x*2;\n    }\n    \"\"\"\n    int f(int f)\n</code></pre>\n\n<p>I define an example function <code>f</code> (in the docstring, which Cython incorporates directly into the compiled file).</p>\n\n<pre><code>import ctypes\nfrom libc.stdint cimport intptr_t\n\ndef make_f_wrapper():\n    func_type = ctypes.CFUNCTYPE(ctypes.c_int, ctypes.c_int)\n    cdef intptr_t f_ptr = &lt;intptr_t&gt;&amp;f\n    return func_type(f_ptr)\n</code></pre>\n\n<p>This is a Cython (pretty close to Python syntax) version of the creation of a ctypes pointer to <code>f</code>. I define the arguments of the function, convert the <code>f</code> pointer to an appropriately sized integer, then initialize the wrapper object with that integer.</p>\n\n<pre><code>cdef extern from *:\n    \"\"\"\n    PyObject* make_f_wrapper_c_impl() {\n        PyObject *ctypes_module = NULL, *CFUNCTYPE = NULL, *c_int = NULL, \n                 *func_type = NULL, *ptr_value = NULL, *result = NULL;\n\n        ctypes_module = PyImport_ImportModule(\"ctypes\");\n        if (ctypes_module == NULL) goto cleanup;\n        CFUNCTYPE = PyObject_GetAttrString(ctypes_module,\"CFUNCTYPE\");\n        if (CFUNCTYPE == NULL) goto cleanup;\n        c_int = PyObject_GetAttrString(ctypes_module,\"c_int\");\n        if (c_int == NULL) goto cleanup;\n        func_type = PyObject_CallFunctionObjArgs(CFUNCTYPE,c_int,c_int,NULL);\n        if (func_type == NULL) goto cleanup;\n        ptr_value = PyLong_FromVoidPtr(&amp;f);\n        if (ptr_value == NULL) goto cleanup;\n        result = PyObject_CallFunctionObjArgs(func_type,ptr_value,NULL);\n\n        cleanup:\n        Py_XDECREF(ptr_value);\n        Py_XDECREF(func_type);\n        Py_XDECREF(c_int);\n        Py_XDECREF(CFUNCTYPE);\n        Py_XDECREF(ctypes_module);\n        return result;\n    }\n    \"\"\"\n    object make_f_wrapper_c_impl()\n\ndef make_f_wrapper_c():\n    return make_f_wrapper_c_impl()\n</code></pre>\n\n<p>The code above is a C translation of the Pythony code above - it does exactly the same thing but is a bit more convoluted since it uses the C API. It just uses the ctypes module through its Python interface. Once again the C code is embedded in a Cython file through a docstring; however similar code could be used in a directly written C API module.</p>\n\n<p>(All these Cython snippets combine to form one long working example)</p>\n"}], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 3, "answer_count": 2, "score": 2, "last_activity_date": 1535893966, "creation_date": 1535552692, "question_id": 52079835, "link": "https://stackoverflow.com/questions/52079835/embedding-cpython-how-do-you-constuct-python-callables-to-wrap-c-callback-point", "title": "Embedding CPython: how do you constuct Python callables to wrap C callback pointers?", "body": "<p>Suppose I am embedding the CPython interpreter into a larger program, written in C.  The C component of the program occasionally needs to call functions written in Python, supplying callback functions to them as arguments.</p>\n\n<p>Using the CPython <a href=\"https://docs.python.org/3/extending/\" rel=\"nofollow noreferrer\">extending and embedding</a> APIs, how do I construct a Python \"callable\" object that wraps a C pointer-to-function, so that I can pass that object to Python code and have the Python code successfully call back into the C code?</p>\n\n<blockquote>\n  <p><em>Note: this is a revised version of a question <a href=\"https://stackoverflow.com/questions/50381150/extending-python-with-c-passing-callback-function-of-c-to-python-and-invoking-c/50382792\">originally posted</a> by user <a href=\"https://stackoverflow.com/users/1489866/dhanasubbu\">dhanasubbu</a>, which I answered, but which was then deleted.  I think it was actually a good question, so I have converted what I wrote into a self-answer to my own statement of the question.  Alternative answers are welcome.</em></p>\n</blockquote>\n"}, {"tags": ["c", "timer", "clock", "teensy"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1535552755, "post_id": 52079648, "comment_id": 91109666, "body": "The context in which this will be used isn\u2019t clear.  Will this be part of a bigger program, or will it be a command run when the user wants the time elapsed. The key values are the reference time (<code>before</code>) and the current time. The rest is bookkeeping."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1535558382, "post_id": 52079648, "comment_id": 91113704, "body": "It might be operating system specific. You don&#39;t want busy waiting. On Linux, see  <a href=\"http://man7.org/linux/man-pages/man7/time.7.html\" rel=\"nofollow noreferrer\">time(7)</a>. Use at least <code>sleep</code> and perhaps <a href=\"http://man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">poll(2)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "is_accepted": false, "score": 0, "last_activity_date": 1535557976, "creation_date": 1535557976, "answer_id": 52081575, "question_id": 52079648, "link": "https://stackoverflow.com/questions/52079648/a-mmss-timer-c/52081575#52081575", "title": "A mm:ss timer C", "body": "<p>Not sure about your purpose here, to just count seconds until you reach the trigger and then convert to mm:ss? You could just count the seconds until trigger is reached and express trigger as mm:ss, it's basically the same thing.</p>\n\n<p>Just by guessing, is something like this what you are looking for?</p>\n\n<pre><code>unsigned int minutes = 0;\nunsigned int seconds = 0;\n\nunsigned int trigger = 360;\nunsigned int elapsed_seconds = 0;\n\n/* Count the seconds until #trigger seconds are reached (?)*/\nclock_t start = clock();\n\ndo {\n\n  clock_t difference = clock() - start;\n  elapsed_seconds = difference * 1000 / CLOCKS_PER_SEC;\n\n  /* Stop at trigger (?)*/\n} while ( elapsed_seconds &lt; trigger );\n\n/* Express in minutes and seconds */\nminutes = elapsed_seconds / 60;\nseconds = elapsed_seconds % 60;\n\nprintf(\"Time: %02d:%02d\\n\", minutes, seconds);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 8123906, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3CH--Xxcvj4/AAAAAAAAAAI/AAAAAAAAABE/9lNHR1r7AXo/photo.jpg?sz=128", "display_name": "Twisted Fate", "link": "https://stackoverflow.com/users/8123906/twisted-fate"}, "is_accepted": true, "score": 1, "last_activity_date": 1554236820, "last_edit_date": 1554236820, "creation_date": 1554207997, "answer_id": 55474761, "question_id": 52079648, "link": "https://stackoverflow.com/questions/52079648/a-mmss-timer-c/55474761#55474761", "title": "A mm:ss timer C", "body": "<p>A timer can be initiated using the Teensy system using its overflows and interrupts. The below code will set up and initiate a timer which will count up in. A struct is used to initiate a boolean value (among other possible things within the program) which can be used to control whether or not the overflow of the timer counts, effectively pausing the timer.</p>\n\n<p>A function to draw a string</p>\n\n<pre><code> // Render a string of printable ASCII characters into the screen buffer.\n // Parameters:\n // x - The horizontal position of the top-left corner of the displayed text.\n // y - The vertical position of the top-left corner of the displayed text.\n // character - The ASCII code of the character to render. Valid values range from \n 0x20 == 32 to 0x7f == 127.\n // colour - The colour, FG_COLOUR or BG_COLOUR. If colour is BG_COLOUR,\n the text is rendered as an inverse video block.\n\nvoid draw_string(int top_left_x, int top_left_y, char *text, colour_t colour) {\n    // Draw each character until the null terminator is reached\n    for ( uint8_t x = top_left_x, i = 0; text[i] != 0; x += CHAR_WIDTH, i++ ) {\n        draw_char(x, top_left_y, text[i], colour);\n        // Add a column of spaces here if you want to space out the lettering.\n        // (see lcd.c for a hint on how to do this)\n    }\n}\n</code></pre>\n\n<p>Below is a formatting function using the above function to draw a string, the formatting function is used to get the mm:ss layout</p>\n\n<pre><code>// a formatting function to assist with printing to the screen\nvoid draw_formatted(int x, int y, const char * format, ...) {\n    va_list args;\n    va_start(args, format);\n    char buffer[1000];\n    vsprintf(buffer, format, args);\n    draw_string(x, y, buffer, FG_COLOUR);\n}\n</code></pre>\n\n<p>With the formatting sorted, a struct should be created to initiate the values requiredto operate the timer, and the timer initiated</p>\n\n<pre><code>// initiates a struct for the timer, which includes a minute, second and \n// validator accessed using tim\nstruct val_store {\n    bool timer_validator;\n    uint8_t time_passed\n    uint8_t min;\n    uint8_t sec;\n} tim;\n\n// initiates timer parameters, essentially setting up the timer to be able to function, \n// sets timer to begin, this should be included in the initial setup of a program\nTCCR1A = 0;\nTCCR1B = 2; \nTIMSK1 = 1;\nsei();\ntim.timer_validator = true;\n</code></pre>\n\n<p>Below is the hidden part of the timer, this is the heart, it creates the values which are the basis of this entire question, it is very important, and it will not work unless TCCR1A, TCCR1B, TIMSK1 and sei() are initiated beforehand, the values can vary from 0, 2, 1 respectively, however, the values used in the below timer must be adjusted accordingly using a bit chart</p>\n\n<pre><code>// Create a volatile global variable called over_flow_count\nvolatile unsigned int over_flow_count = 0;\n//  interrupt service routine to process timer overflow\n//  interrupts for Timer 1.\nISR(TIMER1_OVF_vect) {\n    // checks if timer is active or not\n    if (tim.timer_validator) {\n    over_flow_count++;\n    }\n}\n// elapsed time since program start\n// use float instead of double to save memory\nfloat elapsed_time(void) {\n    float current_time = (float)\n        ( ( over_flow_count * 65536.0 + TCNT1 ) * 8.0  / 8000000 );\n    return current_time;\n}\n</code></pre>\n\n<p>Finally, the code that works with the above timer to produce an output in mm:ss format is simple due to the timer above doing all the work, all that remains is the formatting. time passed calls the previously created function, which is the total passed time frame, min and sec are then found using division and modulo, and formatted using the previously made formatting function</p>\n\n<pre><code>tim.time_passed = elapsed_time();\ntim.min = time_passed / 60;\ntim.sec = time_passed % 60;\ndraw_formatted(x, y, \"Time: %02d:%02d\", tim.min, tim.sec);\n</code></pre>\n\n<p>A pause can be created by using similar</p>\n\n<pre><code>if (BIT_VALUE(PINB, 0)) {\n    // buffer before and after to prevent a single press activating\n    // multiple instances of a joystick press, cheap interrupt\n    _delay_ms(250);\n\n    // pauses timer by setting the boolean to false, preventing the if statement passing\n    tim.timer_validator = false;\n\n    while(true) {\n        clear_screen();\n        #Put processes to occur while paused here\n\n        // checks to see if the pause should resume\n        if (BIT_VALUE(PINB, 0)) {\n            break;\n        }\n\n    // continue timer\n    tim.timer_validator = true;\n\n    // once again a buffer for good measure\n    _delay_ms(250);\n    }\n</code></pre>\n\n<p>If the program is correctly created, the timer should retroactively update itself!\nHope it helps!</p>\n\n<p>Relevant includes, not all includes may be used.</p>\n\n<pre><code>// includes\n#include &lt;assert.h&gt;\n#include &lt;avr/interrupt.h&gt;\n#include &lt;avr/io.h&gt;\n#include &lt;cpu_speed.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;util/delay.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 8123906, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3CH--Xxcvj4/AAAAAAAAAAI/AAAAAAAAABE/9lNHR1r7AXo/photo.jpg?sz=128", "display_name": "Twisted Fate", "link": "https://stackoverflow.com/users/8123906/twisted-fate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2220, "favorite_count": 0, "accepted_answer_id": 55474761, "answer_count": 2, "score": -1, "last_activity_date": 1554236820, "creation_date": 1535552156, "last_edit_date": 1554205659, "question_id": 52079648, "link": "https://stackoverflow.com/questions/52079648/a-mmss-timer-c", "title": "A mm:ss timer C", "body": "<p>Trying to make a timer in C which counts up in mm:ss format, I don't necessarily need to print the value, just have it exist to reference. </p>\n\n<p>The idea is a \"time elapsed\" clock on a teensy device, every second passed the timer goes up by 1 second, at 60 seconds, the minutes' timer ticks up by 1 and the seconds' timer resets to 0. The timer runs in the background updating itself every second to act as a sort of continuous stopwatch. </p>\n\n<p>Similar to the image below, however, the timer does not start or stop at will, it starts when the program is initialized, and simply increases its counter every second, minutes do not need to convert and can go up to 99, as by this time the program should have ended.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jRIug.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jRIug.gif\" alt=\"enter image description here\"></a></p>\n\n<p>An example is a clock showing time elapsed since beginning the level of a game, showing the user how long they have taken to completed the level.</p>\n\n<p>I've had a go at it below, but because of I'm unfamiliar with how C and C based languages work I'm unsure if I'm even going in the right direction. </p>\n\n<pre><code>int minutes = 0;\nint seconds = 0, trigger = 1000;\nclock_t start = clock();\ndo {\n  if(seconds == 60) {\n    seconds = 0;\n    minutes += 1;\n  }\n  clock_t difference = clock() - start;\n  seconds = difference * 1000 / CLOCKS_PER_SEC;\n  i++;\n} while ( seconds &lt; trigger );\n</code></pre>\n\n<p>For example, say x seconds have passed;</p>\n\n<ul>\n<li><p>89 seconds (1 min 9 sec)</p>\n\n<pre><code>Time: 01:19\n</code></pre></li>\n<li><p>360 seconds (6 min 0 sec)</p>\n\n<pre><code>Time: 06:00\n</code></pre></li>\n<li><p>27 seconds (0 min 27 sec)</p>\n\n<pre><code>Time: 00:27\n</code></pre></li>\n<li><p>4893 seconds (81 min 33 sec)</p>\n\n<pre><code>Time: 81:33\n</code></pre></li>\n</ul>\n\n<p>the timer should return similar to as above.</p>\n\n<p>Windows system.</p>\n\n<p>Can anyone help with this? You can make up whatever variables you want or whatever, for all I know what I have done doesn't even lead anywhere. Thanks in advance.</p>\n"}, {"tags": ["c", "csv"], "comments": [{"owner": {"reputation": 4644, "user_id": 1431720, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5a1388d4d3b2bf03b11bb5658c68c29?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1431720/robert"}, "edited": false, "score": 4, "creation_date": 1535554708, "post_id": 52079579, "comment_id": 91111121, "body": "Hi, I&#39;ve edited your post for clarity. Please format your code next time and keep the question separate, not as comment in the code. Refrain from including the same pointless comment over and over, that&#39;s just distracting. Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> of the site to understand how to ask good questions that will get good answers. Then come back and <a href=\"https://stackoverflow.com/posts/52079579/edit\">edit</a> your question; best would be a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. &quot;does not work&quot; is not a helpful problem description. What happens when you run it? What did you expect to happen? Any errors? Also fix the title, it&#39;s pretty pointless."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1535554892, "post_id": 52079579, "comment_id": 91111259, "body": "What does <code>sscanf()</code> return?  And which one is line 137?  I doubt anyone is going to count that many lines of code."}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 0, "creation_date": 1535555735, "post_id": 52079579, "comment_id": 91111919, "body": "I think you never initialize <code>data_struct-&gt;name</code>. Copying data into memory referenced by an uninitialized pointer, will cause undefined behavior."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1535557544, "post_id": 52079579, "comment_id": 91113147, "body": "Mandatory read: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How To Debug Small Programs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1535557333, "creation_date": 1535557333, "answer_id": 52081404, "question_id": 52079579, "link": "https://stackoverflow.com/questions/52079579/sos-i-am-crazy-but-havent-found-the-reason-why-the-line-137-doesnt-work/52081404#52081404", "title": "SOS I am crazy but haven&#39;t found the reason why the line 137 doesn&#39;t work", "body": "<p>When you allocate a new structure <code>node_t</code>, its member <code>name</code> is an uninitialized pointer that cannot be initialized by <code>ini_struct()</code> with <code>strcpy(data_struct-&gt;name, \"\");</code> This has undefined behavior, and the same problem occurs in <code>insert_to_struct()</code>. A simple solution is to define <code>name</code> as an array of <code>char</code> like the members of <code>data</code>:</p>\n\n<pre><code>typedef struct {\n    char name[MAX_STR];\n    data_t data;\n} athlete_t;\n</code></pre>\n\n<p>Note also that function <code>insert_to_struct</code> does not need line continuation characters <code>\\</code>. It would be more readable as:</p>\n\n<pre><code>/* insert each value separated by comma into the struct we define */\nvoid insert_to_struct(athlete_t *data_struct, char *new_line) {\n    sscanf(new_line,\n           \"%[^,],%[^,],%[^,],%[^,],%[^,],\"\n           \"%[^,],%[^,],%[^,],%[^,],%[^,],\"\n           \"%[^,],%[^,],%[^,],%[^,],%[^,]\",\n           data_struct-&gt;data.id, data_struct-&gt;name,\n           data_struct-&gt;data.sex,\n           data_struct-&gt;data.age, data_struct-&gt;data.height,\n           data_struct-&gt;data.weight,data_struct-&gt;data.team,\n           data_struct-&gt;data.noc, data_struct-&gt;data.games,\n           data_struct-&gt;data.year, data_struct-&gt;data.season,\n           data_struct-&gt;data.city, data_struct-&gt;data.sport,\n           data_struct-&gt;data.event, data_struct-&gt;data.medal);\n}\n</code></pre>\n\n<p>Note how a string constant can be broken in smaller chunks by just writing them one after the other without an operator. The compile will automatically glue these strings into a single literal.</p>\n\n<p>Furthermore, it would be safer to specify the maximum number of characters to store into each of the destination arrays and verify that the 15 fields have been parsed correctly:</p>\n\n<pre><code>/* insert each value separated by comma into the struct we define */\nint insert_to_struct(athlete_t *data_struct, char *new_line) {\n    return sscanf(new_line,\n                  \"%127[^,],%127[^,],%127[^,],%127[^,],%127[^,],\"\n                  \"%127[^,],%127[^,],%127[^,],%127[^,],%127[^,],\"\n                  \"%127[^,],%127[^,],%127[^,],%127[^,],%127[^,]\",\n                  data_struct-&gt;data.id, data_struct-&gt;name,\n                  data_struct-&gt;data.sex,\n                  data_struct-&gt;data.age, data_struct-&gt;data.height,\n                  data_struct-&gt;data.weight,data_struct-&gt;data.team,\n                  data_struct-&gt;data.noc, data_struct-&gt;data.games,\n                  data_struct-&gt;data.year, data_struct-&gt;data.season,\n                  data_struct-&gt;data.city, data_struct-&gt;data.sport,\n                  data_struct-&gt;data.event, data_struct-&gt;data.medal) == 15;\n}\n</code></pre>\n\n<p>Note also that this rudimentary parser does not handle quotes strings, strings with embedded quotes and/or commas, nor does it accept empty fields. A hand coded parser would be needed to read the file properly.</p>\n"}], "owner": {"reputation": 7, "user_id": 10290363, "user_type": "registered", "profile_image": "https://graph.facebook.com/282946442323164/picture?type=large", "display_name": "\u738b\u6587\u6770", "link": "https://stackoverflow.com/users/10290363/%e7%8e%8b%e6%96%87%e6%9d%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1535557496, "creation_date": 1535552005, "last_edit_date": 1535557496, "question_id": 52079579, "link": "https://stackoverflow.com/questions/52079579/sos-i-am-crazy-but-havent-found-the-reason-why-the-line-137-doesnt-work", "title": "SOS I am crazy but haven&#39;t found the reason why the line 137 doesn&#39;t work", "body": "<p>The code is intended to read the each line from a CSV file (which is separated by comma), and then insert each line as a value into a binary tree.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_CHAR 128\n#define MAX_LINE 512\n#define COMMA \",\"\n\ntypedef struct node node_t;\ntypedef struct {\n    node_t *root;\n    int (*cmp)(void *, void *);\n} tree_t;\n\ntypedef struct {\n    char id[MAX_CHAR];\n    char sex[MAX_CHAR];\n    char age[MAX_CHAR];\n    char height[MAX_CHAR];\n    char weight[MAX_CHAR];\n    char team[MAX_CHAR];\n    char noc[MAX_CHAR];\n    char games[MAX_CHAR];\n    char year[MAX_CHAR];\n    char season[MAX_CHAR];\n    char city[MAX_CHAR];\n    char sport[MAX_CHAR];\n    char event[MAX_CHAR];\n    char medal[MAX_CHAR];\n} data_t;\n\ntypedef struct {\n    char *name;\n    data_t data;\n} athlete_t;\n\nstruct node {\n    athlete_t *data;\n    node_t *left;\n    node_t *right;\n};\n\ntree_t *make_empty_tree(int func(void *, void *));\nvoid insert_to_struct(athlete_t *, char *);\ntree_t *read_file(char*, tree_t *);\nint cmp(void *p1, void *p2);\ntree_t *insert_in_order(tree_t *, athlete_t *);\nnode_t *recursive_insert(node_t *, node_t *, int cmp(void *, void *));\nvoid traverse_tree(tree_t *, void action(void *));\nvoid recursive_traverse(node_t *, void action(void *));\nvoid action(void *);\nvoid ini_struct(athlete_t *);\n\nint main(int argc, char **argv) {\n    tree_t *tree = make_empty_tree(cmp);\n    tree = read_file(argv[1], tree);\n    printf(\"%s\\n\", tree-&gt;root-&gt;data-&gt;name);\n    traverse_tree(tree, action);\n    return 0;\n}\n\n/* Read each line from a file, and assume max length of line is 512 chars*/\ntree_t *read_file(char *filename, tree_t *tree) {\n    FILE *fp_data;\n    char new_line[MAX_LINE];\n    athlete_t *data_struct;\n\n    fp_data = fopen(filename, \"r\");\n    if (fp_data == NULL) {\n        fprintf(stderr, \"Cannot open %s\\n\", filename);\n        exit(EXIT_FAILURE);\n    }\n    while (fgets(new_line, MAX_LINE, fp_data) != NULL) {\n        data_struct = (athlete_t *)malloc(sizeof(*data_struct));\n        ini_struct(data_struct);\n        insert_to_struct(data_struct, new_line);\n        tree = insert_in_order(tree, data_struct);\n        printf(\"%s\\n\", new_line);\n    }\n    printf(\"%s \\n\", new_line);\n    fclose(fp_data);\n    return tree;\n}\n\n/* initialize the struct */\nvoid ini_struct(athlete_t *data_struct) {\n    strcpy(data_struct-&gt;data.id, \"\");\n    strcpy(data_struct-&gt;name, \"\");\n    strcpy(data_struct-&gt;data.sex, \"\");\n    strcpy(data_struct-&gt;data.age, \"\");\n    strcpy(data_struct-&gt;data.height, \"\");\n    strcpy(data_struct-&gt;data.weight, \"\");\n    strcpy(data_struct-&gt;data.team, \"\");\n    strcpy(data_struct-&gt;data.noc, \"\");\n    strcpy(data_struct-&gt;data.games, \"\");\n    strcpy(data_struct-&gt;data.year, \"\");\n    strcpy(data_struct-&gt;data.season, \"\");\n    strcpy(data_struct-&gt;data.city, \"\");\n    strcpy(data_struct-&gt;data.sport, \"\");\n    strcpy(data_struct-&gt;data.event, \"\");\n    strcpy(data_struct-&gt;data.medal, \"\");\n}\n\n/* make a empty tree */\ntree_t *make_empty_tree(int func(void *, void *)) {\n    tree_t *tree;\n    tree = (tree_t *)malloc(sizeof(*tree));\n    assert(tree != NULL);\n    tree-&gt;root = NULL;\n    tree-&gt;cmp = func;\n    return tree;\n}\n\n/* insert each value separated by comma into the struct we define */\nvoid insert_to_struct(athlete_t *data_struct, char *new_line) {\n    sscanf(new_line, \\\n           \"%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,],%[^,]\", \\\n           data_struct-&gt;data.id, data_struct-&gt;name, data_struct-&gt;data.sex, \\\n           data_struct-&gt;data.age, data_struct-&gt;data.height,\\\n           data_struct-&gt;data.weight,data_struct-&gt;data.team, \\\n           data_struct-&gt;data.noc, data_struct-&gt;data.games, \\\n           data_struct-&gt;data.year, data_struct-&gt;data.season, \\\n           data_struct-&gt;data.city, data_struct-&gt;data.sport, \\\n           data_struct-&gt;data.event, data_struct-&gt;data.medal);\n}\n\nint cmp(void *p1, void *p2) {\n    char *s1 = (char *)p1;\n    char *s2 = (char *)p2;\n\n    return strcmp(s1, s2);\n}\n\n/* insert the struct into the tree */\ntree_t *insert_in_order(tree_t *tree, athlete_t *value) {\n    node_t *new;\n    new = malloc(sizeof(node_t));\n    assert(new != NULL);\n    new-&gt;data = value;\n    new-&gt;left = new-&gt;right = NULL;\n    tree-&gt;root = recursive_insert(tree-&gt;root, new, tree-&gt;cmp);\n    return tree;\n}\n\nnode_t *recursive_insert(node_t *root, node_t *new, int cmp(void*, void*)) {\n    if (root == NULL) {\n        return new;\n    } else if (cmp(new-&gt;data-&gt;name, root-&gt;data-&gt;name) &lt;= 0) {\n        root-&gt;left = recursive_insert(root-&gt;left, new, cmp);\n    } else {\n        root-&gt;right = recursive_insert(root-&gt;right, new, cmp);\n    }\n    return root;\n}\n\nvoid recursive_traverse(node_t *root, void action(void *)) {\n    if (root != NULL) {\n        recursive_traverse(root-&gt;left, action);\n        action(root-&gt;data-&gt;name);\n        recursive_traverse(root-&gt;right, action);\n    }\n}\n\nvoid traverse_tree(tree_t *tree, void action(void *)) {\n    assert(tree != NULL);\n    recursive_traverse(tree-&gt;root, action);\n}\n\nvoid action(void *p1) {\n    printf(\"%s\\n\", (char*)p1);\n}\n</code></pre>\n\n<p>The tricky thing happened in the <code>make_empty_tree</code> function, when I use <code>malloc</code> to create a pointer called new, but it doesn't work when I am debugging, but I think it should work!</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1535550785, "post_id": 52079064, "comment_id": 91108246, "body": "do you know about <code>qsort()</code>?"}, {"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "reply_to_user": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1535551148, "post_id": 52079064, "comment_id": 91108536, "body": "@Fureeish No, I&#39;ll look it up."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535551216, "post_id": 52079064, "comment_id": 91108591, "body": "If the order is based on the length it may fail. Example: if you have <code>&quot;&#47;dev&#47;shm&quot;</code> and <code>&quot;&#47;somenonnested&quot;</code>, latter will be unmounted before <code>&quot;&#47;dev&#47;shm&quot;</code> because it&#39;s length is longer..."}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 0, "creation_date": 1535551535, "post_id": 52079064, "comment_id": 91108788, "body": "Duplicate of <a href=\"https://stackoverflow.com/a/27003340/4288486\">stackoverflow.com/a/27003340/4288486</a> ?"}, {"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535551664, "post_id": 52079064, "comment_id": 91108867, "body": "@Jabberwocky Good point. I&#39;ll probably leave <code>&#47;dev</code> in tact, now that I think about it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535551702, "post_id": 52079064, "comment_id": 91108894, "body": "You should probably take into account the number of <code>&#47;</code> characters rather than the string length. But the sorting problems itself remains the same. If you have more than 2  nesting levels you may need to build a tree and unmount the leaves bottum up."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535552220, "post_id": 52079064, "comment_id": 91109278, "body": "Usually, sorting the names in reverse order gives you the result you require."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1535552662, "post_id": 52079064, "comment_id": 91109592, "body": "<code>&quot;&#47;path&quot;</code> will always be lexicographically less than <code>&quot;&#47;path&#47;contained&quot;</code> where <code>&#47;path</code> is a directory, and <code>contained</code> is something in that directory.   So it is not necessary to sort by string length - sorting in reverse-lexicographical order will be sufficient"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535552879, "post_id": 52079064, "comment_id": 91109753, "body": "Can you record the path names in the array in the sequence of mounting, and then unmount in reverse order?"}, {"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1535556181, "post_id": 52079064, "comment_id": 91112211, "body": "@WeatherVane No, this program is only responsible for unmounting, not mounting."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535556399, "post_id": 52079064, "comment_id": 91112345, "body": "@jabberwocky: if you have <code>&#47;foo&#47;bar</code>, <code>&#47;foo</code> and <code>&#47;unrelatedlongname</code>, why would it be a problem if the last one were unmounted first? The only order dependence is between the first two."}, {"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535556522, "post_id": 52079064, "comment_id": 91112431, "body": "@rici I think that @jabberwocky was pointing out that certain long paths are probably dependent on <code>&#47;dev</code> (i.e. block devices), but I decided not to unmount <code>&#47;dev</code> so you&#39;re right, it won&#39;t be a problem."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535556781, "post_id": 52079064, "comment_id": 91112625, "body": "@billy: although I wouldn&#39;t recommend unmounting <code>&#47;dev</code>, there is no dependency. Devices don&#39;t exist because they are in <code>&#47;dev</code>. The devices are there, regardless. <code>&#47;dev</code> lets you refer to them, nothing more."}, {"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535577429, "post_id": 52079064, "comment_id": 91122698, "body": "@rici Good to know. I always wondered about that, since <code>&#47;</code> can&#39;t be unmounted I thought that must have meant that <code>&#47;dev</code> couldn&#39;t have been either."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535584126, "post_id": 52079064, "comment_id": 91124713, "body": "@billy: actually you can unmount the filesystem mounted on <code>&#47;</code>, but that doesn&#39;t make <code>&#47;</code> go away. If you were to unmount <code>&#47;dev</code>, you&#39;d probably find that there still is a <code>&#47;dev</code>, which will be an ordinary (and probably empty) directory in the root filesystem."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535584183, "post_id": 52079064, "comment_id": 91124730, "body": "Of course, to unmount the root filesystem, you&#39;d first have to make sure no process was using it. That would be tricky. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535551892, "post_id": 52079408, "comment_id": 91109041, "body": "He wants the sorting based on string lengths (which may not be the right choice btw, see my comment to the question), not based on string comparision."}], "tags": [], "owner": {"reputation": 300, "user_id": 9646936, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9wJ3MEStnjw/AAAAAAAAAAI/AAAAAAAAAC4/_aggduvRnM0/photo.jpg?sz=128", "display_name": "Ahmed Agiza", "link": "https://stackoverflow.com/users/9646936/ahmed-agiza"}, "is_accepted": true, "score": 3, "last_activity_date": 1535551589, "creation_date": 1535551589, "answer_id": 52079408, "question_id": 52079064, "link": "https://stackoverflow.com/questions/52079064/sort-string-array-by-string-length-in-c/52079408#52079408", "title": "Sort String Array by String Length in C", "body": "<p>You can just use <code>qsort</code> with a custom comparator:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint cmp(const void *first, const void *second) { \n    const char **firstCast = (const char ** )first;\n    const char **secondCast = (const char **) second;\n    return strcmp(*secondCast, *firstCast);\n}\nint main(void) {\n    const char *a[3];\n    a[0] = \"longest\";\n    a[1] = \"short\";\n    a[2] = \"medium\";\n    qsort(a, 3, sizeof(char *), cmp);\n    for (int i = 0 ; i &lt; 3; i++) {\n        printf(\"%s\\n\", a[i]);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535556191, "post_id": 52079651, "comment_id": 91112220, "body": "qsort is included in the <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.22.5.2\" rel=\"nofollow noreferrer\">C standard</a> so there is no question about it being available."}], "tags": [], "owner": {"reputation": 250, "user_id": 10207394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgM4w.png?s=128&g=1", "display_name": "Johnny Johansson", "link": "https://stackoverflow.com/users/10207394/johnny-johansson"}, "is_accepted": false, "score": 1, "last_activity_date": 1535553605, "last_edit_date": 1535553605, "creation_date": 1535552163, "answer_id": 52079651, "question_id": 52079064, "link": "https://stackoverflow.com/questions/52079064/sort-string-array-by-string-length-in-c/52079651#52079651", "title": "Sort String Array by String Length in C", "body": "<p>If you don't want to depend on anything \"external\" like qsort, which may or not be available in your environment, this should do it:</p>\n\n<pre><code>for (int j = 0; j &lt; i; ++j) sort[j] = j;\n\nfor (int j = 0; j &lt; i - 1; ++j) {\n    int longest = j;\n    for (int k = j + 1; k &lt; i; ++k) {\n        if (length[sort[k]] &gt; length[sort[longest]]) longest = k;\n    }\n    int tmp = sort[longest];\n    sort[longest] = sort[j];\n    sort[j] = tmp;\n}\n</code></pre>\n"}], "owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "accepted_answer_id": 52079408, "answer_count": 2, "score": 4, "last_activity_date": 1535556437, "creation_date": 1535550651, "last_edit_date": 1535556437, "question_id": 52079064, "link": "https://stackoverflow.com/questions/52079064/sort-string-array-by-string-length-in-c", "title": "Sort String Array by String Length in C", "body": "<p>I have an array of strings in C. These strings store the paths of filesystems that need to be unmounted. </p>\n\n<pre><code>For example...\nmountlist[0] = \"/proc\"\nmountlist[1] = \"/dev\"\nmountlist[2] = \"/dev/shm\"\nand so on...\n</code></pre>\n\n<p>I need to unmount the nested filesystems before the filesystems they are mounted over (so <code>/dev/shm</code> needs to be unmounted before <code>/dev</code>). I was thinking that the easiest way to do this would be to sort the strings by length, longest first. I have the number of strings in the array stored in the integer <code>i</code>.</p>\n\n<p>With the code that I've been able to come up with so far, given that <code>strnum</code> is an integer of the string I need to access, the strings are accessible with <code>mountlist[strnum]</code> and the corresponding length is stored in <code>length[strnum]</code>.</p>\n\n<p>In conclusion, how can I sort the strings in array by greatest to least length? I don't need to actually sort the strings, I just need to access them in the right order. I can't figure out how to write it, but I was thinking of code that creates an int array with the number of each string array in the right order (the example above would be {2, 0, 1}), so if that array was named <code>sort</code> then <code>mountlist[sort[0]]</code> would be the longest string. With such an array, the corresponding <code>for</code> loop would be:</p>\n\n<pre><code>for (int q = 0; q &lt; i; q++) {\n    umount(mountlist[sort[q]]);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1535549921, "post_id": 52078796, "comment_id": 91107630, "body": "Why shouldn&#39;t what be 4?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1535549952, "post_id": 52078796, "comment_id": 91107652, "body": "The difference is in units of what the pointer is pointing to. In your case in units of <code>sizeof *arr</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1535550162, "post_id": 52078796, "comment_id": 91107801, "body": "<code>arr + 1 - arr</code> = <code>arr - arr + 1</code> = <code>0 - 1</code>, why would that be any different :?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535551105, "post_id": 52078796, "comment_id": 91108502, "body": "Sidenote: the difference between two pointers yields a <code>ptrdiff_t</code>, not an <code>int</code>. Your conversion type specifier invokes undefined behaviour. And why do you assume <code>sizeof(int) == 4</code>?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535551384, "post_id": 52078796, "comment_id": 91108699, "body": "@toohonestforthissite The output of the two <code>%p</code> values shared by the OP have a difference of 4"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1535553455, "post_id": 52078796, "comment_id": 91110186, "body": "@GovindParmar: Even this does not imply what I wrote."}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 5, "last_activity_date": 1535550435, "last_edit_date": 1535550435, "creation_date": 1535549945, "answer_id": 52078845, "question_id": 52078796, "link": "https://stackoverflow.com/questions/52078796/how-do-arithmetic-operators-work-with-addresses-in-c/52078845#52078845", "title": "how do arithmetic operators work with addresses in c?", "body": "<p>Think this expression <code>(arr+1)-arr</code> as    </p>\n\n<pre><code>0x7ffe583f4ba0 + 1 - 0x7ffe583f4ba0\n</code></pre>\n\n<p>it will give <code>1</code>.  </p>\n\n<p>When you subtract two pointers pointing to the same array then it gives the number of elements between those pointers.<br>\nBy the same logic, if you increment a pointer to an array of <code>int</code> by 1 then it will point to it's next element (one unit) and not to the next <code>sizeof(int)</code> element.  </p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1535550064, "creation_date": 1535550064, "answer_id": 52078877, "question_id": 52078796, "link": "https://stackoverflow.com/questions/52078796/how-do-arithmetic-operators-work-with-addresses-in-c/52078877#52078877", "title": "how do arithmetic operators work with addresses in c?", "body": "<p>When you perform pointer arithmetic with <code>+</code> and <code>-</code> the size of the type pointed to is taken into account:</p>\n\n<pre><code>int main() {\n    int arr[2] = { 1, 2 };\n    int *p = arr;\n    printf(\"%p -&gt; %d\\n\", (void *)p, *p);\n    p++;\n    printf(\"%p -&gt; %d\\n\", (void *)p, *p);\n    return 0;\n}\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>0115FCCC -&gt; 1\n0115FCD0 -&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 8221180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VvhOZwCc5PI/AAAAAAAAAAI/AAAAAAAAABg/iJm3ZocIFXk/photo.jpg?sz=128", "display_name": "Vivek", "link": "https://stackoverflow.com/users/8221180/vivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1535550031, "accepted_answer_id": 52078845, "answer_count": 2, "score": 0, "last_activity_date": 1535550435, "creation_date": 1535549819, "last_edit_date": 1535549848, "question_id": 52078796, "link": "https://stackoverflow.com/questions/52078796/how-do-arithmetic-operators-work-with-addresses-in-c", "closed_reason": "Duplicate", "title": "how do arithmetic operators work with addresses in c?", "body": "<pre><code>int main(void){\n   int arr[] = {1, 2, 3, 4, 5, 6};\n   printf(\"%p\\t%p\\t%d\\n\",arr,arr+1,(arr+1)-arr);\n   return 0;\n }\n</code></pre>\n\n<p>output : </p>\n\n<pre><code>  0x7ffe583f4ba0    0x7ffe583f4ba4  1\n</code></pre>\n\n<p>why is the difference 1? Shouldn't it be 4.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 4, "creation_date": 1535548473, "post_id": 52078338, "comment_id": 91106623, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\"><i>How To Debug Small Programs</i></a>. StackOverflow is not a do-my-work service. Read also carefully the reference of every standard function you are using (e.g. of <a href=\"https://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow noreferrer\">strlen</a>, of <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">scanf</a>, etc...)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 4, "creation_date": 1535548525, "post_id": 52078338, "comment_id": 91106658, "body": "This does not make sense: <code>s1[strlen(s1)]=&#39;\\0&#39;;</code> If there was something different than <code>&#39;\\0&#39;</code> at that position, <code>strlen</code> would have returned another value. You need to use index <code>j</code> and <code>k</code> to put the terminating 0 byte"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1535549354, "post_id": 52078338, "comment_id": 91107240, "body": "You must read this FAQ: <a href=\"https://stackoverflow.com/questions/571945/getting-a-stack-overflow-exception-when-declaring-a-large-array\">Getting a stack overflow exception when declaring a large array</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535549151, "post_id": 52078413, "comment_id": 91107091, "body": "last test case is not passing"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535549182, "post_id": 52078413, "comment_id": 91107114, "body": "it is saying that process terminated due to timeout"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535549216, "post_id": 52078413, "comment_id": 91107134, "body": "can anyone tell me the solution"}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1535549228, "post_id": 52078413, "comment_id": 91107142, "body": "What are your test strings ?plz share"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535549337, "post_id": 52078413, "comment_id": 91107223, "body": "<a href=\"https://hr-testcases-us-east-1.s3.amazonaws.com/18927/input09.txt?AWSAccessKeyId=AKIAJ4WZFDFQTZRGO3QA&amp;Expires=1535556477&amp;Signature=Tp3ZBOxcfxs27DzY99sc55c%2FLkw%3D&amp;response-content-type=text%2Fplain\" rel=\"nofollow noreferrer\">hr-testcases-us-east-1.s3.amazonaws.com/18927/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535549388, "post_id": 52078413, "comment_id": 91107262, "body": "this is my final test case in which i am failing it contains nearly 1 billion characters in a string"}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1535549451, "post_id": 52078413, "comment_id": 91107314, "body": "Ok, I will look in to this and will update you. For now make sure that char s[10000],s1[10000],s2[100000]; are big enough to hold the strings. As I see first 2 are 10000 and last one is 100000."}, {"owner": {"reputation": 250, "user_id": 10118785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBK6yjyiX5Y/AAAAAAAAAAI/AAAAAAAAAE8/GSDei6J9J18/photo.jpg?sz=128", "display_name": "Leon Trotsky", "link": "https://stackoverflow.com/users/10118785/leon-trotsky"}, "edited": false, "score": 1, "creation_date": 1535549532, "post_id": 52078413, "comment_id": 91107371, "body": "You want to store one billion characters in a char array?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535549586, "post_id": 52078413, "comment_id": 91107411, "body": "sorry in constraint length of string is max 10000"}, {"owner": {"reputation": 250, "user_id": 10118785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBK6yjyiX5Y/AAAAAAAAAAI/AAAAAAAAAE8/GSDei6J9J18/photo.jpg?sz=128", "display_name": "Leon Trotsky", "link": "https://stackoverflow.com/users/10118785/leon-trotsky"}, "edited": false, "score": 0, "creation_date": 1535549687, "post_id": 52078413, "comment_id": 91107476, "body": "Declaring arbitrarily huge arrays to avoid buffer overflows is bad practice. If you really don&#39;t know in advance how large a buffer needs to be, use malloc or realloc to dynamically allocate and extend the buffer as necessary, possibly using a smaller, fixed-sized buffer as an intermediary."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535550047, "post_id": 52078413, "comment_id": 91107723, "body": "but how can i use malloc if user is directly entering the string"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535550107, "post_id": 52078413, "comment_id": 91107765, "body": "if user will enter the number of character first then i can use malloc"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535550161, "post_id": 52078413, "comment_id": 91107799, "body": "or if i can use malloc in this case? then how"}, {"owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "edited": false, "score": 0, "creation_date": 1535550216, "post_id": 52078413, "comment_id": 91107846, "body": "Please correct size of the arrays as suggested in last comment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "edited": false, "score": 0, "creation_date": 1535550526, "post_id": 52078413, "comment_id": 91108032, "body": "I got it thanx you rizwan sir"}], "tags": [], "owner": {"reputation": 1844, "user_id": 8238512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ouYe.jpg?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/8238512/rizwan"}, "is_accepted": true, "score": 5, "last_activity_date": 1535548607, "creation_date": 1535548607, "answer_id": 52078413, "question_id": 52078338, "link": "https://stackoverflow.com/questions/52078338/print-even-odd-characters-separately-in-a-string/52078413#52078413", "title": "print even odd characters separately in a string", "body": "<pre><code>   s1[strlen(s1)]='\\0';\n   s2[strlen(s2)]='\\0';\n</code></pre>\n\n<p>This line is erroneous. Replace it with</p>\n\n<pre><code>   s1[j]='\\0';\n   s2[k]='\\0';\n</code></pre>\n\n<p>This is because <code>strlen()</code> only works with checking <code>null</code> in a <code>null</code> terminated string. And at this point your generated string is not yet <code>null</code> terminated.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10238745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 52078413, "answer_count": 1, "score": -1, "last_activity_date": 1535561565, "creation_date": 1535548387, "last_edit_date": 1535561565, "question_id": 52078338, "link": "https://stackoverflow.com/questions/52078338/print-even-odd-characters-separately-in-a-string", "title": "print even odd characters separately in a string", "body": "<p>Here is my code what I have tried,</p>\n\n<p>I have to take a string from the user and as output i have to print the characters at even places  and at odd places separated by a space</p>\n\n<p>MY PROBLEM:\nIn every test case i am assigning to both the strings at end a null character to conclude that my string has ended. Lets suppose i enter 2 test cases and  now if enter  a smaller string than first test case in result it is printing my character of 2nd test case but also printing the characters of test case because first string was larger than second</p>\n\n<p>I want to ask how it can be possible if i have ended the string with a null character in every test case?</p>\n\n<p>so why it is printing the value after the null character because that were the characters of previous test case because that string was larger and its character are still there in array but it should print till null character  Please help me to achieve this.    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n   int t,i,j,k;\n   scanf(\"%d \",&amp;t);\n   while(t&gt;0){\n       char s[10000],s1[10000],s2[100000];\n      scanf(\"%s\",s);\n       for( i=0,j=0,k=0;i&lt;strlen(s);i++){\n           if(i%2==0)\n               s1[j++]=s[i];\n           else\n                s2[k++]=s[i];\n\n\n       }\n       s1[strlen(s1)]='\\0';\n       s2[strlen(s2)]='\\0';\n       printf(\"%s %s\\n\",s1,s2);\n       t--;\n\n   }\n}\n</code></pre>\n"}, {"tags": ["c", "audio", "ffmpeg", "libav"], "owner": {"reputation": 11, "user_id": 10289383, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QuK32kiFU_Y/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNUQfS0zupBC3ljE0H1vv8uXRuUEA/mo/photo.jpg?sz=128", "display_name": "volatile", "link": "https://stackoverflow.com/users/10289383/volatile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535544745, "creation_date": 1535544745, "question_id": 52077168, "link": "https://stackoverflow.com/questions/52077168/how-to-open-a-sw-file-using-libav-library-in-c-language", "title": "How to open a .sw file using libav library in c language?", "body": "<p>I created a .sw(16 bit pcm) file by passing an audio file. Now I am trying to get back the original audio(.mp3) by passing the .sw file as an input to the following file. </p>\n\n<p>How can I read the .sw file content so that I can get back the mp3 file. Below is the code,</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;libavcodec/avcodec.h&gt;\n#include &lt;libavformat/avformat.h&gt;\n\n#include &lt;libavutil/channel_layout.h&gt;\n#include &lt;libavutil/common.h&gt;\n#include &lt;libavutil/frame.h&gt;\n#include &lt;libavutil/samplefmt.h&gt;\n\n/* check that a given sample format is supported by the encoder */\nstatic int check_sample_fmt(const AVCodec *codec, enum AVSampleFormat sample_fmt)\n{\n    const enum AVSampleFormat *p = codec-&gt;sample_fmts;\n\n    while (*p != AV_SAMPLE_FMT_NONE) {\n        if (*p == sample_fmt)\n            return 1; \n        p++;\n    }\n    return 0;\n}\n\n/* just pick the highest supported samplerate */\nstatic int select_sample_rate(const AVCodec *codec)\n{\n    const int *p;\n    int best_samplerate = 0;\n\n    if (!codec-&gt;supported_samplerates)\n        return 44100;\n\n    p = codec-&gt;supported_samplerates;\n    while (*p) {\n        if (!best_samplerate || abs(44100 - *p) &lt; abs(44100 - best_samplerate))\n            best_samplerate = *p;\n        p++;\n    }\n    return best_samplerate;\n}\n\n/* select layout with the highest channel count */\nstatic int select_channel_layout(const AVCodec *codec)\n{\n    const uint64_t *p;\n    uint64_t best_ch_layout = 0;\n    int best_nb_channels   = 0;\n\n    if (!codec-&gt;channel_layouts)\n        return AV_CH_LAYOUT_STEREO;\n\n    p = codec-&gt;channel_layouts;\n    while (*p) {\n        int nb_channels = av_get_channel_layout_nb_channels(*p);\n\n        if (nb_channels &gt; best_nb_channels) {\n            best_ch_layout    = *p;\n            best_nb_channels = nb_channels;\n        }\n        p++;\n    }\n    return best_ch_layout;\n}\n\nstatic void encode(AVCodecContext *ctx, AVFrame *frame, AVPacket *pkt,\n                   FILE *output)\n{\n    int ret;\n\n   /* send the frame for encoding */\n   ret = avcodec_send_frame(ctx, frame);\n   if (ret &lt; 0) {\n       fprintf(stderr, \"Error sending the frame to the encoder\\n\");\n       exit(1);\n   }\n\n   /* read all the available output packets (in general there may be any\n    * number of them */\n   while (ret &gt;= 0) {\n       ret = avcodec_receive_packet(ctx, pkt);\n       if (ret == AVERROR(EAGAIN) || ret == AVERROR_EOF)\n           return;\n       else if (ret &lt; 0) {\n           fprintf(stderr, \"Error encoding audio frame\\n\");\n           exit(1);\n       }\n\n       fwrite(pkt-&gt;data, 1, pkt-&gt;size, output);\n       av_packet_unref(pkt);\n   }\n}\n\nint main(int argc, char **argv)\n{\n   const char *filename;\n   const AVCodec *codec;\n   AVCodecContext *c= NULL;\n   AVFrame *frame;\n   AVPacket *pkt;\n   int i, j, k, ret;\n   FILE *f;\n   uint16_t *samples;\n   float t, tincr;\n\n   av_register_all();\n   avcodec_register_all();\n\n   if (argc &lt;= 1) {\n       fprintf(stderr, \"Usage: %s &lt;output file&gt;\\n\", argv[0]);\n       return 0;\n   }\n   filename = argv[1];\n\n   /* find the MP2 encoder */\n   codec = avcodec_find_encoder(AV_CODEC_ID_MP3);\n   if (!codec) {\n       fprintf(stderr, \"Codec not found\\n\");\n       exit(1);\n   }\n\n   c = avcodec_alloc_context3(codec);\n   if (!c) {\n       fprintf(stderr, \"Could not allocate audio codec context\\n\");\n       exit(1);\n   }\n\n   /* put sample parameters */\n   c-&gt;bit_rate = 64000;\n\n   /* check that the encoder supports s16 pcm input */\n   c-&gt;sample_fmt = AV_SAMPLE_FMT_S16P;\n   if (!check_sample_fmt(codec, c-&gt;sample_fmt)) {\n       fprintf(stderr, \"Encoder does not support sample format %s\",\n               av_get_sample_fmt_name(c-&gt;sample_fmt));\n       exit(1);\n   }\n\n   /* select other audio parameters supported by the encoder */\n   c-&gt;sample_rate    = select_sample_rate(codec);\n   c-&gt;channel_layout = select_channel_layout(codec);\n   c-&gt;channels       = av_get_channel_layout_nb_channels(c-&gt;channel_layout);\n\n   /* open it */\n   if (avcodec_open2(c, codec, NULL) &lt; 0) {\n       fprintf(stderr, \"Could not open codec\\n\");\n       exit(1);\n   }\n\n   f = fopen(filename, \"wb\");\n   if (!f) {\n       fprintf(stderr, \"Could not open %s\\n\", filename);\n       exit(1);\n   }\n\n   /* packet for holding encoded output */\n   pkt = av_packet_alloc();\n   if (!pkt) {\n       fprintf(stderr, \"could not allocate the packet\\n\");\n       exit(1);\n   }\n\n   /* frame containing input raw audio */\n   frame = av_frame_alloc();\n   if (!frame) {\n       fprintf(stderr, \"Could not allocate audio frame\\n\");\n       exit(1);\n   }\n\n   frame-&gt;nb_samples     = c-&gt;frame_size;\n   frame-&gt;format         = c-&gt;sample_fmt;\n   frame-&gt;channel_layout = c-&gt;channel_layout;\n\n   /* allocate the data buffers */\n   ret = av_frame_get_buffer(frame, 0);\n   if (ret &lt; 0) {\n       fprintf(stderr, \"Could not allocate audio data buffers\\n\");\n       exit(1);\n   }\n\n   /* encode a single tone sound */\n   t = 0;\n   tincr = 2 * M_PI * 440.0 / c-&gt;sample_rate;\n   for (i = 0; i &lt; 200; i++) {\n       /* make sure the frame is writable -- makes a copy if the encoder\n        * kept a reference internally */\n       ret = av_frame_make_writable(frame);\n       if (ret &lt; 0)\n           exit(1);\n       samples = (uint16_t*)frame-&gt;data[0];\n\n       for (j = 0; j &lt; c-&gt;frame_size; j++) {\n           samples[2*j] = (int)(sin(t) * 10000);\n\n           for (k = 1; k &lt; c-&gt;channels; k++)\n               samples[2*j + k] = samples[2*j];\n           t += tincr;\n       }\n       encode(c, frame, pkt, f);\n   }\n\n   /* flush the encoder */\n   encode(c, NULL, pkt, f);\n\n   fclose(f);\n\n   av_frame_free(&amp;frame);\n   av_packet_free(&amp;pkt);\n   avcodec_free_context(&amp;c);\n\n   return 0;\n}\n</code></pre>\n\n<p>I just want to know, where and how the .sw file is reading in the above audio encoding code?</p>\n"}, {"tags": ["c", "windows", "runtime-error"], "comments": [{"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 0, "creation_date": 1535544357, "post_id": 52076961, "comment_id": 91103722, "body": "Their executions are not equivalent. In the second example, in the second <code>for</code> loop, <code>k</code> is always the last value of <code>i</code> you got in the first <code>for</code> loop."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535544689, "post_id": 52076961, "comment_id": 91103941, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in the question, not as external link"}, {"owner": {"reputation": 509, "user_id": 9133878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9aa235de735796e038c0bf88dcd6269?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9133878/mike"}, "reply_to_user": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 1, "creation_date": 1535545477, "post_id": 52076961, "comment_id": 91104456, "body": "@joaomlneto the first for breaks on the first time you get a value for k"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1535545560, "post_id": 52076961, "comment_id": 91104500, "body": "The second piece of code assumes that the first &quot;hit&quot; in the first loop is one of the elements you want to swap, the first piece doesn&#39;t."}, {"owner": {"reputation": 509, "user_id": 9133878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9aa235de735796e038c0bf88dcd6269?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9133878/mike"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1535546584, "post_id": 52076961, "comment_id": 91105218, "body": "@molbdnilo I might be stupid, but I have no clue what you mean"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 1, "creation_date": 1535547512, "post_id": 52076961, "comment_id": 91105924, "body": "@Mike What happen if <code>strcmp(s[i], s[i + 1]) &lt; 0</code> is alway false ? With the nested for loop, the second loop is not executed. With the consecutive for loop, the second for is executed ... with a value of &quot;k&quot; undetermined."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535548884, "post_id": 52076961, "comment_id": 91106922, "body": "@Mike So k is initialized with -1. So when all your string is sorted, you have your bug as I have previously say."}, {"owner": {"reputation": 509, "user_id": 9133878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9aa235de735796e038c0bf88dcd6269?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9133878/mike"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535549206, "post_id": 52076961, "comment_id": 91107130, "body": "@Tom&#39;s yep, you are right. If you can post that, I&#39;ll accept it as an answer."}, {"owner": {"reputation": 509, "user_id": 9133878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9aa235de735796e038c0bf88dcd6269?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9133878/mike"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1535549475, "post_id": 52076961, "comment_id": 91107342, "body": "@JohnBollinger it was just some short code because I&#39;m trying to get used to C. But I need to compare the whole string since it&#39;s not a substring of something."}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1535546579, "creation_date": 1535546579, "answer_id": 52077783, "question_id": 52076961, "link": "https://stackoverflow.com/questions/52076961/c-code-hits-unexpected-runtime-error-if-i-execute-for-loops-sequentially-instead/52077783#52077783", "title": "C code hits unexpected runtime error if I execute for loops sequentially instead of nested", "body": "<p>You cannot just replace nested <code>for</code> loops with consecutive <code>for</code> loops if the inner <code>for</code> loop is in some way dependent on the controlling expression of the outer <code>for</code> loop.</p>\n\n<p>In this case, the controlling expression of the inner <code>for</code> loop is dependant on <code>k</code> which is equal to <code>i</code> and the controlling expression of the outer loop is dependant on <code>i</code>.</p>\n\n<p>Try this out with simple for loops and you will understand.\nThe runtime error in the second case is probably caused because of some out-of-bounds memory access as the value of <code>k</code> is no longer regulated by the value of <code>i</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": true, "score": 1, "last_activity_date": 1535549971, "last_edit_date": 1535549971, "creation_date": 1535549637, "answer_id": 52078739, "question_id": 52076961, "link": "https://stackoverflow.com/questions/52076961/c-code-hits-unexpected-runtime-error-if-i-execute-for-loops-sequentially-instead/52078739#52078739", "title": "C code hits unexpected runtime error if I execute for loops sequentially instead of nested", "body": "<p>The root of your problem is that when <code>if (strcmp(s[i], s[i + 1]) &lt; 0)</code> is always false, your nested loop behave correctly (the inner for loop is not executed), but your consecutive for loop will trigger a bug, because the following for will be executed with a value of \"k\" equal to -1 (since you say you initialize k with -1) and you will do an out-of-boud array access (str[-1]).</p>\n\n<p>The if condition you added to fix your consecutive for loop is exactly what the first nested loop do implicitly : if not found, do nothing.</p>\n"}], "owner": {"reputation": 509, "user_id": 9133878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9aa235de735796e038c0bf88dcd6269?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9133878/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 52078739, "answer_count": 2, "score": -2, "last_activity_date": 1535549971, "creation_date": 1535544081, "last_edit_date": 1535548706, "question_id": 52076961, "link": "https://stackoverflow.com/questions/52076961/c-code-hits-unexpected-runtime-error-if-i-execute-for-loops-sequentially-instead", "title": "C code hits unexpected runtime error if I execute for loops sequentially instead of nested", "body": "<p>Full code <a href=\"https://gist.github.com/thMike/9e99d03fe99fa8d3bd58610dc9d6aa7a\" rel=\"nofollow noreferrer\">here</a>. Initial problem <a href=\"https://www.hackerrank.com/challenges/permutations-of-strings/problem\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For some reason, this code runs perfectly:</p>\n\n<pre><code>for (int i = n - 2; i &gt; -1 ; i--)\n{\n    if (strcmp(s[i], s[i + 1]) &lt; 0)\n    {\n        k = i;\n        for (int j = n - 1; j &gt; k; j--)\n        {\n           if (strcmp(s[k], s[j]) &lt; 0)\n           {\n              l = j;\n              swap(s, k, l);\n              reverse_sequence(s, k + 1, n - 1);\n              return 1;\n           }\n        }\n    }\n}\n\nreturn 0;\n</code></pre>\n\n<p>While replacing the inner for with a break and writing it after the first for like this:</p>\n\n<pre><code>for (int i = n - 2; i &gt; -1 ; i--)\n{\n    if (strcmp(s[i], s[i + 1]) &lt; 0)\n    {\n        k = i;\n        break;\n    }\n}\nfor (int j = n - 1; j &gt; k; j--)\n{\n    if (strcmp(s[k], s[j]) &lt; 0)\n    {\n        l = j;\n        swap(s, k, l);\n        reverse_sequence(s, k + 1, n - 1);\n        return 1;\n    }\n}\nreturn 0;\n</code></pre>\n\n<p>Hits a runtime error. Both print the permutations correctly.</p>\n\n<p>What is even happening here?</p>\n\n<p>Edit: If I add</p>\n\n<pre><code>if (i == 0 &amp;&amp; k == -1)\n        return 0;\n</code></pre>\n\n<p>after the if in the first loop, it behaves as intended. So it's clear that what happens is that it compares s[-1] (k is initialized to -1) with something and it crashes.</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 2, "creation_date": 1535544034, "post_id": 52076910, "comment_id": 91103511, "body": "no timeout for me"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 1, "creation_date": 1535544035, "post_id": 52076910, "comment_id": 91103512, "body": "Are you sure it&#39;s the <b>compiler</b> that show a &quot;time out&quot; error ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1535544038, "post_id": 52076910, "comment_id": 91103513, "body": "I doubt the <i>compiler</i> show a timeout. Rather I believe that it&#39;s an online judge/competition site that times out."}, {"owner": {"reputation": 725, "user_id": 8155350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de477406a8408e6ac59c1a3ee2ffa282?s=128&d=identicon&r=PG&f=1", "display_name": "fdafadf", "link": "https://stackoverflow.com/users/8155350/fdafadf"}, "edited": false, "score": 0, "creation_date": 1535544115, "post_id": 52076910, "comment_id": 91103564, "body": "Which compiler?"}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 1, "creation_date": 1535544156, "post_id": 52076910, "comment_id": 91103594, "body": "With a <code>O(n&#179;)</code> algorithm, if you&#39;re submitting to an online judge system, it&#39;s very much possible you can get a timeout."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1535544182, "post_id": 52076910, "comment_id": 91103608, "body": "The error is that you have used an algorithm that is too slow. There are better ways to remove duplicates from a string. Since this is a challenge problem, giving you the solution is inappropriate. The goal is for you to think about alternate ways of solving the problem."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1535544240, "post_id": 52076910, "comment_id": 91103643, "body": "Incidentally, are you sure the strings supplied in input are limited to 100 characters?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1535544671, "post_id": 52076910, "comment_id": 91103928, "body": "Aside: are you sure the judge will like you printing a prompt, and printing leading newlines and extra spaces? The output must be <i>exactly</i> how the problem describes it."}, {"owner": {"reputation": 1, "user_id": 8608145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5d33a8e1bf2a2b313a695b07a7d30da?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld0409", "link": "https://stackoverflow.com/users/8608145/helloworld0409"}, "edited": false, "score": 0, "creation_date": 1535544958, "post_id": 52076910, "comment_id": 91104138, "body": "Thanks for your reply guys!@EricPostpischil ill try another way to solve this challenge thank you"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 1, "creation_date": 1535545077, "post_id": 52076910, "comment_id": 91104207, "body": "@AishwaryaGanesh Well, you could copy only the non duplicate letter, not shifting the entire string each time. When you for loop the string, you have a char (str[i]). If this char is not between str[0] and str[i - 1], you copy it, if it is, you don&#39;t copy it. If you copy it in the same string like you do, you have to keep another iterator (k, for example) and incremetn it each time you copy a new char."}], "answers": [{"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1535545575, "creation_date": 1535545575, "answer_id": 52077444, "question_id": 52076910, "link": "https://stackoverflow.com/questions/52076910/how-to-solve-timeout-error-in-c/52077444#52077444", "title": "How to solve timeout error in c?", "body": "<p>There are fast memory-efficient algorithms for solving the problem.</p>\n\n<p>Here is one, described in text/pseudocode. Memory requirement is constant and only depends on the number of bits in <code>char</code>. Time Complexity is O(n).</p>\n\n<pre><code>Create and initialize an array of flags that keep track of characters encountered.\n\nLoop:\n  Read the next character. End loop if there was no more input.\n\n  If the character is flagged in the array then \n    continue.\n  Else \n    Flag the character in the array.\n    Print the character.\nEnd loop\n</code></pre>\n\n<p>Hint:\nOn some systems <code>char</code> is signed. Be sure to use <code>unsigned</code> values to index the array. </p>\n"}], "owner": {"reputation": 1, "user_id": 8608145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5d33a8e1bf2a2b313a695b07a7d30da?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld0409", "link": "https://stackoverflow.com/users/8608145/helloworld0409"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1201, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1535548761, "creation_date": 1535543950, "last_edit_date": 1535548761, "question_id": 52076910, "link": "https://stackoverflow.com/questions/52076910/how-to-solve-timeout-error-in-c", "title": "How to solve timeout error in c?", "body": "<p>I was running this code to remove the duplicates of a string.    </p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n\n    int main()\n    {\n        char str[100];\n        int i, j, k;\n\n        printf(\"\\n Please Enter any String :  \");\n        scanf(\"%s\",str);\n\n        for(i = 0; i &lt; strlen(str); i++)\n        {\n            for(j = i + 1; str[j] != '\\0'; j++)\n            {\n                if(str[j] == str[i])  \n                {\n                    for(k = j; str[k] != '\\0'; k++)\n                    {\n                        str[k] = str[k + 1];\n                    }\n                }\n            }\n        }\n\n        printf(\"\\n %s \", str);\n\n        return 0;\n    }\n</code></pre>\n\n<p>When i run this program the compiler shows a Time-out error. Can anyone help me out solve this error!</p>\n"}, {"tags": ["python", "c", "opencv", "computer-vision", "camera-calibration"], "comments": [{"owner": {"reputation": 533, "user_id": 8500357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d4b5bce7c62482fb5427ca87787a5d?s=128&d=identicon&r=PG&f=1", "display_name": "JulianWgs", "link": "https://stackoverflow.com/users/8500357/julianwgs"}, "edited": false, "score": 0, "creation_date": 1535543126, "post_id": 52075881, "comment_id": 91102941, "body": "What exactly can be seen in the picture with just the colored dots? Why are there somewhere else than in the picture above?"}, {"owner": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "reply_to_user": {"reputation": 533, "user_id": 8500357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d4b5bce7c62482fb5427ca87787a5d?s=128&d=identicon&r=PG&f=1", "display_name": "JulianWgs", "link": "https://stackoverflow.com/users/8500357/julianwgs"}, "edited": false, "score": 0, "creation_date": 1535653025, "post_id": 52075881, "comment_id": 91157161, "body": "The picture I show is the result of my code. If I use the undistorsion function to the points I drawed in the first image this is the output I get. I was expecting anyone could help me make it work."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "edited": false, "score": 0, "creation_date": 1535671349, "post_id": 52077737, "comment_id": 91164060, "body": "Hi Hein Wessels. Thank you for your answer. It didn&#39;t work either. I updated the post so you can see the output of using the opencv undistortPoints function.Thank you for your help!"}, {"owner": {"reputation": 809, "user_id": 9466270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UGJdFqyAs24/AAAAAAAAAAI/AAAAAAAAAEE/JCJU2OmxEk0/photo.jpg?sz=128", "display_name": "Hein Wessels", "link": "https://stackoverflow.com/users/9466270/hein-wessels"}, "reply_to_user": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "edited": false, "score": 0, "creation_date": 1535696721, "post_id": 52077737, "comment_id": 91169744, "body": "Can you show your code from the <code>calibrateCamera</code> to <code>undistortPoints</code>?"}, {"owner": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "edited": false, "score": 0, "creation_date": 1535709717, "post_id": 52077737, "comment_id": 91176491, "body": "you mean &quot;how do I obtain optic_camera_matrix and distorsion_coeffs&quot;? This code must be right because these 2 parameters work properly when undistorting the full image (see the first img)."}, {"owner": {"reputation": 809, "user_id": 9466270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UGJdFqyAs24/AAAAAAAAAAI/AAAAAAAAAEE/JCJU2OmxEk0/photo.jpg?sz=128", "display_name": "Hein Wessels", "link": "https://stackoverflow.com/users/9466270/hein-wessels"}, "reply_to_user": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "edited": false, "score": 0, "creation_date": 1535710547, "post_id": 52077737, "comment_id": 91176934, "body": "Yes, I agree, but something somewhere is going wrong. A few weeks back used the <code>undistortPoints</code> function just as you, and it worked fine. So the next step is to read your code."}, {"owner": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "edited": false, "score": 0, "creation_date": 1535715032, "post_id": 52077737, "comment_id": 91179445, "body": "I updated the post as you requested! Thank you for your help!"}, {"owner": {"reputation": 809, "user_id": 9466270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UGJdFqyAs24/AAAAAAAAAAI/AAAAAAAAAEE/JCJU2OmxEk0/photo.jpg?sz=128", "display_name": "Hein Wessels", "link": "https://stackoverflow.com/users/9466270/hein-wessels"}, "reply_to_user": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "edited": false, "score": 2, "creation_date": 1551351407, "post_id": 52077737, "comment_id": 96612835, "body": "If you&#39;re still struggling with this (probably not XD), I updated my answer. Sorry for the long delay."}], "tags": [], "owner": {"reputation": 809, "user_id": 9466270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UGJdFqyAs24/AAAAAAAAAAI/AAAAAAAAAEE/JCJU2OmxEk0/photo.jpg?sz=128", "display_name": "Hein Wessels", "link": "https://stackoverflow.com/users/9466270/hein-wessels"}, "is_accepted": false, "score": 1, "last_activity_date": 1551351348, "last_edit_date": 1551351348, "creation_date": 1535546461, "answer_id": 52077737, "question_id": 52075881, "link": "https://stackoverflow.com/questions/52075881/cannot-undistort-points-using-opencv-undistortpoints-method/52077737#52077737", "title": "Cannot undistort points using OpenCv undistortPoints method", "body": "<p>If I understand correctly, the <code>getOptimalNewCameraMatrix</code> function is only for when you don't want to the black sides while undistorting an entire image (see <a href=\"http://answers.opencv.org/question/101398/what-does-the-getoptimalnewcameramatrix-function-does/\" rel=\"nofollow noreferrer\">this</a> question), and not for when you are undistorting individual points. Also, it seems <code>P</code> and <code>R</code> in <code>undistortPoints</code> are only for stereo vision things.</p>\n\n<p>I would simplify it, and just say:</p>\n\n<pre><code>undistorted_points =  cv2.undistortPoints(np.array(points), optical_camera_matrix, d) \n</code></pre>\n\n<p>where <code>optical_camera_matrix</code> is the matrix directly from the <code>calibrateCamera</code> function. Just make sure that <code>points</code> are a <a href=\"https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#undistortpoints\" rel=\"nofollow noreferrer\"><code>1xN or Nx1 2-channel</code></a> array.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I realized what the problem was. The secret is the sentence on this <a href=\"https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#undistortpoints\" rel=\"nofollow noreferrer\">website</a>.</p>\n\n<blockquote>\n  <p>Also the function performs a reverse transformation to projectPoints() </p>\n</blockquote>\n\n<p>As I understand it (please correct me if I'm wrong) the undistorted points are normalized. In order to put them back in pixel units simply do the following (in pseudo code):</p>\n\n<pre><code>for each point in undistorted_points:\n    point = point * focal_length + boresight\n</code></pre>\n\n<p>I hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 8320723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2d056008ac2e51bb3236a3e6aff13d?s=128&d=identicon&r=PG&f=1", "display_name": "xczhang", "link": "https://stackoverflow.com/users/8320723/xczhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1611417264, "creation_date": 1611417264, "answer_id": 65861232, "question_id": 52075881, "link": "https://stackoverflow.com/questions/52075881/cannot-undistort-points-using-opencv-undistortpoints-method/65861232#65861232", "title": "Cannot undistort points using OpenCv undistortPoints method", "body": "<p>For the output space is normalized case, you can set the P=optic_camera_matrix. It is written in the document that &quot;If matrix P is identity or omitted, dst will contain normalized point coordinates&quot;:\n<a href=\"http://amroamroamro.github.io/mexopencv/matlab/cv.undistortPoints.html\" rel=\"nofollow noreferrer\">http://amroamroamro.github.io/mexopencv/matlab/cv.undistortPoints.html</a></p>\n"}], "owner": {"reputation": 81, "user_id": 8332206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0943ce1c0a0c8b4452bc2bb669dacade?s=128&d=identicon&r=PG&f=1", "display_name": "BigDataSaurius", "link": "https://stackoverflow.com/users/8332206/bigdatasaurius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1990, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1611417264, "creation_date": 1535540546, "last_edit_date": 1535714954, "question_id": 52075881, "link": "https://stackoverflow.com/questions/52075881/cannot-undistort-points-using-opencv-undistortpoints-method", "title": "Cannot undistort points using OpenCv undistortPoints method", "body": "<p>I'm trying to undistort certain points of an image using the \"undistort points\" method of OpenCV, but without success.\n<a href=\"https://i.stack.imgur.com/200Xy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/200Xy.jpg\" alt=\"Here an example where I undistort all the whole picture\"></a></p>\n\n<p>These will be my undistorsion coefficients</p>\n\n<pre><code>  optic_camera_matrix: [[710.52285,  0.0,      882.14702],\n                        [0.0,        713.9636, 638.8421],\n                        [0.0,        0.0,      1.0]],\n\n  distorsion_coeffs: [[-0.4176419401669212,\n                                 0.15978235598732332,\n                                 -8.299875092923166e-05,\n                                 -0.001784191694247801,\n                                 -0.027396621999692457]],\n</code></pre>\n\n<p>Even though I am capable of undistorting the whole image, in order to optimize the camera processing time, if I undistort just the corner points (red points of the image):</p>\n\n<pre><code>distorted_border_points = np.array([[[584,1415],\n                                        [576,457],\n                                        [1956,415],\n                                        [1996,1422],\n                                        [1261,242],\n                                        [1281,1594]]],np.float32)\n\nundistorted_points =  cv2.undistortPoints(distorted_border_points, optic_camera_matrix, distorsion_coeffs)\n</code></pre>\n\n<p>I get this in return: </p>\n\n<pre><code>[[[ -6.40190065e-01   1.66883194e+00]\n  [ -4.87006754e-01  -2.88225353e-01]\n  [ -1.82562262e-01   3.74070629e-02]\n  [ -5.28450182e-04  -3.51850584e-04]\n  [  8.09574544e-01  -8.40054870e-01]\n  [ -5.28259724e-02  -1.22379906e-01]]]\n</code></pre>\n\n<p>If plotted, they don't align in a rectangle, like in the first image.</p>\n\n<p>I believe the undistorsion coefficients are well calcualted (since undistorsion works on the first image), but here I attach the code of the cam</p>\n\n<pre><code>import glob\nimport cv2\nimport numpy as np\nimport os\nimport json\nimport numpy as np\n\ndirectory = os.path.dirname(__file__)\n\n\ndef get_optic_calibration_parameters(device,config_folder=None):\n    if config_folder is None:\n        optic_calibration_path = directory + '/../config/' + \\\n            device + '/optic_calibration.json'\n    else:\n        optic_calibration_path = config_folder + device + '/optic_calibration.json'\n\n    if not os.path.exists(optic_calibration_path):\n        os.makedirs(optic_calibration_path[:-22])\n\n    with open(optic_calibration_path) as optic_calibration_file:\n        optic_calibration = json.load(optic_calibration_file)\n\n    optic_camera_matrix = optic_calibration['optic_camera_matrix']\n    distorsion_coeffs = optic_calibration['distorsion_coeffs']\n    optic_resolution = optic_calibration['optic_resolution']\n\n    return optic_camera_matrix, distorsion_coeffs, optic_resolution\n\n\ndef _save_calibration_parameters(camera_matrix, distorsion_coeffs, optic_resolution, device, config_folder=None):\n\n    if config_folder is None:\n        optic_calibration_path = directory + '/../config/' + \\\n            device + '/optic_calibration.json'\n    else:\n        optic_calibration_path = config_folder + device + '/optic_calibration.json'\n\n    if not os.path.exists(optic_calibration_path):\n        os.makedirs(optic_calibration_path[:-22])\n\n    optic_calibration_parameters = {'optic_camera_matrix': camera_matrix.tolist(),\n                                    'distorsion_coeffs': distorsion_coeffs.tolist(),\n                                    'optic_resolution': optic_resolution}\n\n    with open(optic_calibration_path, 'wb') as optic_calibration_file:\n        json.dump(optic_calibration_parameters, optic_calibration_file)\n\n    return\n\n\ndef _get_image_points(plot=False, dim=(4, 5), input_dir='calibration_samples',extension='jp'):\n    criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 30, 0.001)\n\n    # prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)\n    objp = np.zeros((dim[0] * dim[1], 3), np.float32)\n    objp[:, :2] = np.mgrid[0:dim[1], 0:dim[0]].T.reshape(-1, 2)\n\n    # Arrays to store object points and image points from all the images.\n    objpoints = []  # 3d point in real world space\n    imgpoints = []  # 2d points in image plane.\n\n    images = glob.glob(input_dir + '*.'+extension+'*')\n    for fname in images:\n        img = cv2.imread(fname)\n        gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n\n        # Find the chess board corners\n        ret, corners = cv2.findChessboardCorners(gray, (dim[1], dim[0]), None)\n\n        # If found, add object points, image points (after refining them)\n        if ret == True:\n            objpoints.append(objp)\n\n            corners2 = cv2.cornerSubPix(\n                gray, corners, (11, 11), (-1, -1), criteria)\n            imgpoints.append(corners2)\n\n            # Draw and display the corners\n            if plot:\n                img = cv2.drawChessboardCorners(\n                    img, (dim[1], dim[0]), corners2, ret)\n                cv2.imshow('img', img)\n                cv2.waitKey(500)\n\n    resolution = (img.shape[1], img.shape[0])\n\n    return imgpoints, objpoints, resolution\n\n\ndef calibrate_camera(optic_resolution, imgpoints, objpoints, device, config_folder=None):\n\n    _, camera_matrix, distorsion_coeffs, _, _ = cv2.calibrateCamera(\n        objpoints, imgpoints, optic_resolution, None, None)\n\n    _save_calibration_parameters(\n        camera_matrix, distorsion_coeffs, optic_resolution, device, config_folder=config_folder)\n\n    return\n</code></pre>\n\n<p>To execute the function I loaded different images:</p>\n\n<pre><code>imgpoints, objpoints, optic_resolution = _get_image_points(plot=False, dim=(4,5), input_dir=calibration_samples)\n_show_N_chessborders(N=3, dim=(4,5), input_dir=calibration_samples)\ncalibrate_camera(optic_resolution, imgpoints, objpoints,device, config_folder=config_folder)\n</code></pre>\n\n<p>And that's how I store the json config files</p>\n\n<p>I would appreciate it if anyoce could help me with a solution. Thank you!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1535540557, "post_id": 52075838, "comment_id": 91101283, "body": "Are you familiar with the concept of a histogram?"}, {"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1535540758, "post_id": 52075838, "comment_id": 91101423, "body": "@StoryTeller Little bit"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1535541237, "post_id": 52075838, "comment_id": 91101762, "body": "What StoryTeller intended to say: Make an array which provides as much elements as you want to check. Initialize it with all 0&#39;s. When you check a character you increment the corresponding cell in the array. If you check a cell in that array it tells you how often the corresponding character appeared."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1535541552, "post_id": 52075838, "comment_id": 91101952, "body": "Yet another hint: <code>&#39;A&#39;</code> ... <code>&#39;Z&#39;</code> form a consecutive range [64 + 1, 64 + 26], as well as <code>&#39;a&#39;</code> ... <code>&#39;z&#39;</code> a consecutive range [96 + 1, 96 + 26] assuming that your platform supports <a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">ASCII</a>. Alternatively, you can use an array of 256 elements and simply count every character you read from input where (value of) character is simply used as index in array."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1535541761, "post_id": 52075838, "comment_id": 91102101, "body": "<a href=\"https://stackoverflow.com/questions/29845805/i-want-to-count-frequency-or-occurrence-of-a-every-letter-in-a-string-c-program\" title=\"i want to count frequency or occurrence of a every letter in a string c program\">stackoverflow.com/questions/29845805/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1535541937, "post_id": 52075838, "comment_id": 91102208, "body": "I kinda figured it out, now I have a problem with assigning two characters(z,Z) to char."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535542027, "post_id": 52075838, "comment_id": 91102259, "body": "@Arthuoff what exactly is the program supposed to do?"}, {"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535542406, "post_id": 52075838, "comment_id": 91102485, "body": "@Jabberwocky To count if at least two times some character has shown up, in this example it&#39;s (z or Z)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1535542910, "post_id": 52075838, "comment_id": 91102808, "body": "@Arthuoff You can also use <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.4.2.1\" rel=\"nofollow noreferrer\"><code>toupper()</code> or <code>tolower()</code></a> to simplify your code by converting the character read to a consistent case so all you have to to is compare it once.  For example:  <code>if ( &#39;Z&#39; == toupper( c ) ) zbrojz++;</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1535543052, "post_id": 52075838, "comment_id": 91102893, "body": "Also, <code>while((c = getchar()) != &#39;\\n&#39;) ...</code> will go into an infinite loop if you hit <code>EOF</code> before you reach a <code>\\n</code> character."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1535542624, "post_id": 52076419, "comment_id": 91102627, "body": "This is good example, but it counts total of z or Z. I need it to print only if it appeared at least two times, else it won&#39;t print anything."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1535542725, "post_id": 52076419, "comment_id": 91102698, "body": "@Arthuoff it shouldn&#39;t be too hard to figure out that one. Hint: do the <code>printf</code> only if <code>zbrojz</code> is larger than 2."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1535542237, "creation_date": 1535542237, "answer_id": 52076419, "question_id": 52075838, "link": "https://stackoverflow.com/questions/52075838/at-least-two-times/52076419#52076419", "title": "At least two times", "body": "<p>If I guessed right what the program is supposed to do (show the number of 'Z' or 'z' occuring in your input), the condition is wrong.</p>\n\n<p>It should be:</p>\n\n<pre><code>  while ((c = getchar()) != '\\n')\n  {\n    if ((c == 'Z') || (c == 'z')) {   /// &lt;&lt;&lt; changes on this line\n      zbrojz++;\n    }\n  }\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>abcZzdeZ\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Z ili z je se pojavilo: 3 puta\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "edited": false, "score": 0, "creation_date": 1535543016, "post_id": 52076613, "comment_id": 91102878, "body": "yes it&#39;s like this, solved it by previous hint, thanks anyway"}], "tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1535542891, "creation_date": 1535542891, "answer_id": 52076613, "question_id": 52075838, "link": "https://stackoverflow.com/questions/52075838/at-least-two-times/52076613#52076613", "title": "At least two times", "body": "<p>Because you can't predict during the loop just how many 'z'/'Z' characters your program will receive, you need to count all occurrences of 'z' or 'Z' and then test the count before outputting anything:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int c;\n    unsigned long int zbrojz=0;\n\n    while((c = getchar()) != '\\n')\n      if(c == 'Z' || c == 'z')\n            zbrojz++;\n\n    if(zbrojz &gt;= 2)\n      printf(\"Z ili z je se pojavilo: %lu puta\\n\", zbrojz);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10171787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DM9Qh.png?s=128&g=1", "display_name": "Arthuoff", "link": "https://stackoverflow.com/users/10171787/arthuoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52076419, "answer_count": 2, "score": 0, "last_activity_date": 1535543617, "creation_date": 1535540439, "last_edit_date": 1535540595, "question_id": 52075838, "link": "https://stackoverflow.com/questions/52075838/at-least-two-times", "title": "At least two times", "body": "<p>I'm doing part where I just can't figure out how can I count if at least 2 times some character has shown up.       </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    int c;\n    unsigned long int zbrojz=0;\n\n    while((c = getchar()) != '\\n')\n    {\n      if((c == 'Z' &gt;= 2) || (c == 'z' &gt;= 2)){\n            zbrojz++;\n      }\n    }\n    printf(\"Z ili z je se pojavilo: %lu puta\", zbrojz);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "time.h"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 4, "last_activity_date": 1535539666, "creation_date": 1535539666, "answer_id": 52075583, "question_id": 52075465, "link": "https://stackoverflow.com/questions/52075465/incorrect-result-for-finding-which-day-of-the-week-that-the-first-day-of-a-month/52075583#52075583", "title": "Incorrect result for finding which day of the week that the first day of a month falls to", "body": "<p>There's a trap in the definition of <code>struct tm</code>:</p>\n\n<pre><code>int tm_mday; // day of the month \u2014 [1, 31]\nint tm_mon;  // months since January \u2014 [0, 11]\n</code></pre>\n\n<p>That is, <code>tm_mday</code> is 1-based, but <code>tm_mon</code> is 0-based. Setting it to <code>8</code> means you're looking at September 1, not August 1 (and 2018-09-01 is indeed a Saturday).</p>\n\n<p>Try</p>\n\n<pre><code>tm.tm_mon = month - 1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41428, "user_id": 440564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e3dbcb5159c02d59f52159faa8437c97?s=128&d=identicon&r=PG", "display_name": "blue112", "link": "https://stackoverflow.com/users/440564/blue112"}, "is_accepted": false, "score": 1, "last_activity_date": 1535539776, "creation_date": 1535539776, "answer_id": 52075615, "question_id": 52075465, "link": "https://stackoverflow.com/questions/52075465/incorrect-result-for-finding-which-day-of-the-week-that-the-first-day-of-a-month/52075615#52075615", "title": "Incorrect result for finding which day of the week that the first day of a month falls to", "body": "<p><a href=\"http://www.cplusplus.com/reference/ctime/tm/\" rel=\"nofollow noreferrer\">You can see here</a> that <code>tm_mon</code> has a 0-11 range.</p>\n\n<p>So you need to subtract 1 to <code>tm_mon</code> when assignating it.</p>\n\n<pre><code>tm.tm_mon = month - 1;\n</code></pre>\n\n<p>This should solve your problem.</p>\n"}], "owner": {"reputation": 65, "user_id": 9959444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d393e87066f26a55b42f5f6df132a29b?s=128&d=identicon&r=PG&f=1", "display_name": "Lambchop123", "link": "https://stackoverflow.com/users/9959444/lambchop123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1535539776, "creation_date": 1535539308, "question_id": 52075465, "link": "https://stackoverflow.com/questions/52075465/incorrect-result-for-finding-which-day-of-the-week-that-the-first-day-of-a-month", "title": "Incorrect result for finding which day of the week that the first day of a month falls to", "body": "<p>I have the following C code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\nstruct tm tm;\nint startDayOfWeek;\nint findStartDateInMonth(int month,int year)       \n{\n    tm.tm_mon = month;\n    tm.tm_year = year - 1900;\n    tm.tm_mday = 1;\n    tm.tm_hour = tm.tm_min = tm.tm_sec = 0;\n    tm.tm_isdst = -1;\n    if(mktime(&amp;tm) != -1)\n    {\n        startDayOfWeek = tm.tm_wday;\n    }\n    return startDayOfWeek;\n}\nint main(void) {\n\nchar *wday[] = {\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\",\n        \"Thursday\", \"Friday\", \"Saturday\"};\nint a = findStartDateInMonth(8,2018);\nif(mktime(&amp;tm) != -1)\n    printf(\"%s\\n\", wday[tm.tm_wday]);\n  return 0;\n}\n</code></pre>\n\n<p>The code returns Saturday, which is wrong since August 1st, 2018 is Wednesday. </p>\n\n<p>I would really appreciate any help.</p>\n"}, {"tags": ["c", "freertos", "rtos"], "comments": [{"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1535632246, "post_id": 52075094, "comment_id": 91144415, "body": "One problem is that you are not using <code>vTaskDelayUntil()</code> correctly.  You are only setting <code>xLastWakeTime</code> once outside of the while loops.  But if you want to use <code>vTaskDelayUntil()</code> then you should be setting <code>xLastWakeTime</code> every loop.  Try using <code>vTaskDelay()</code> instead of <code>vTaskDelayUntil()</code> and forget about <code>xLastWakeTime</code>."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1535632832, "post_id": 52075094, "comment_id": 91144835, "body": "Another critique is that aborting a delay seems like an awkward inter-task signalling mechanism to me.  Wouldn&#39;t a semaphore make more sense?  One task could wait for the semaphore for up to a maximum timeout.  The other task could post the semaphore to signal the first task to run.  I&#39;m unsure though, because it&#39;s unclear to me what your actually trying to do."}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1535637625, "post_id": 52075094, "comment_id": 91148305, "body": "It could be interesting to see what happens in <code>test_data_handle</code> and why it is being run from <code>button_task_check</code> with a <code>xTaskAbortDelay</code>. In that case, synchronisation tools such as events or semaphores are much better (although I have no idea what <code>button_task_check</code> does)."}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1535637632, "post_id": 52075094, "comment_id": 91148312, "body": "Regarding your goal, it is better a semaphore instead of &quot;forcing&quot; a task to run through <code>xTaskAbortDelay</code>. <code>led_task_check</code> is being executed periodically and when the event or resource is available (in that case, let&#39;s consider the resource as the hex value), it will execute the code related to that (blink the LEDs in a different way or whatever). The producer will be the task which is checking the hex value (<code>button_task_check</code> ?), and the consumer is <code>led_task_check</code>."}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 2, "creation_date": 1535637639, "post_id": 52075094, "comment_id": 91148318, "body": "One last comment, think about the use of <code>nrf_delay_ms</code>, I don&#39;t know if this function is releasing the cpu or not, but it looks like you are not using the advantages of an RTOS (you could create tasks to manage the LEDs, instead of dummy loops from the RTOS point of view)."}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "reply_to_user": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1535695525, "post_id": 52075094, "comment_id": 91169276, "body": "@kkrambo I think when we use the Lastupdate time inside the while loop, it executes only one task and after the completion of task  it moves ahead with other tasks(Which totally oppposes the puprose of RTOS which is Running multiple tasks simultaneoulsy) . Correct me if i am wrong !"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1535718285, "post_id": 52075094, "comment_id": 91181299, "body": "From the FreeRTOS documentation: &quot;vTaskDelayUntil() specifies an <i>absolute</i> time at which the task wishes to unblock.&quot;  It doesn&#39;t make any sense to call <code>vTaskDelayUntil()</code> multiple times with the same parameter values.  You&#39;re specifying the same absolute time every time.  After the first time <code>vTaskDelayUntil()</code> wakes that absolute time is in the past.  And every subsequent call to <code>vTaskDelayUntil()</code> that original absolute time is <i>still in the past</i> and <code>vTaskDealyUntil()</code> will return immediately, without delay."}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "reply_to_user": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1535959235, "post_id": 52075094, "comment_id": 91239445, "body": "@kkrambo When i print the values of xLastWakeTime , it keeps on incrementing by 122880. Is there something wrong. Will it cause overflow at certain time?"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1535977619, "post_id": 52075094, "comment_id": 91249479, "body": "I&#39;m sorry, my original comment is wrong.  I didn&#39;t realize that <code>xLastWakeTime</code> gets incremented within <code>vTaskDelayUntil()</code> so you don&#39;t have to increment it yourself.  But that increment is what you want to avoid specifying the same absolute time repeatedly.  Yes, it will overflow at some point but that is not a problem because the timer counter value returned by <code>xTaskGetTickCount()</code> will also overflow at the same time.  In other words the value of <code>xLastWakeTime</code> tracks the value returned by <code>xTaskGetTickCount()</code> and they will overflow together and continue to track."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535626718, "post_id": 52077867, "comment_id": 91140641, "body": "I have uploaded the snippet of the code thats causing issue."}, {"owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "reply_to_user": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535628763, "post_id": 52077867, "comment_id": 91141997, "body": "What is your tick frequency? Meaning how much time &quot;122880&quot; is? Is it shorter than 4 seconds (approx running time of LED task)? Because if so.... that would explain it:  <code>*xLastWakeTime + 122880</code> is already in the past by the time <code>vTaskDelayUntil()</code> is called.  Maybe also print <code>xTaskGetTickCount()</code>  alongside TEST TASK: SEGGER_RTT_printf(0,&quot;%s %d&quot;,&quot;TEST TASK\\r\\n&quot;, xTaskGetTickCount());`. That would reveal if my assumption is correct."}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535628970, "post_id": 52077867, "comment_id": 91142169, "body": "This value denotes 2 minutes (122880) , 1024 is value for 1 second :)"}, {"owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "reply_to_user": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535629382, "post_id": 52077867, "comment_id": 91142458, "body": "What is the definition of TickType_t on your system (size), can it overflow?"}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535629491, "post_id": 52077867, "comment_id": 91142533, "body": "The print value of xTaskGetTickCount is 0 in first run, 122880 in second run and then so on. :)"}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535629658, "post_id": 52077867, "comment_id": 91142642, "body": "The defintion of TickType_t is uint32_t , so i think its big enough"}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535629819, "post_id": 52077867, "comment_id": 91142751, "body": "If i make the value of xLastWakeTime=0 inside the task while loop, it seems to work fine. BUt i doubt that its a better way to do it."}, {"owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "reply_to_user": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535633143, "post_id": 52077867, "comment_id": 91145042, "body": "Are you using preemptive or cooperative scheduler? Because if it is preemptive, then the higher priority button_task_check() will wake up every second, preempt the lower prio led taskr and reactivate the lower priority led_task_check() while it&#39;s still running (4 seconds run time)."}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535706635, "post_id": 52077867, "comment_id": 91174712, "body": "I am using preemotive , but i don&#39;t know how to use cooperative . Can You guide me to some link on how to use it?"}, {"owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "reply_to_user": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535706838, "post_id": 52077867, "comment_id": 91174860, "body": "Sure, find the file named FreeRTOSConfig.h, the first definition there is <code>#define configUSE_PREEMPTION                    1</code> set that to 0 and rebuild.  See <a href=\"https://www.freertos.org/a00110.html\" rel=\"nofollow noreferrer\">freertos.org/a00110.html</a>  Not sure if this is what you want for the rest of your application. I just suggested as a test to check my assumption: the higher priority button_task_check() will wake up <i>every second</i>, preempt the lower prio led task and reactivate it (all this before it finished it&#39;s job - 4 seconds run time)."}, {"owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "reply_to_user": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535707273, "post_id": 52077867, "comment_id": 91175102, "body": "However, non-preemptive means that you won&#39;t be &quot;Running multiple tasks simultaneoulsy&quot;, but one after the other, therefore it may not be best. For example, button_task_check() won&#39;t be able to execute until the led task finishes, meaning button_task_check() will execute at ~4 second intervals only."}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535713341, "post_id": 52077867, "comment_id": 91178466, "body": "I think its better with the Premptive scheduling then :D"}, {"owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "edited": false, "score": 0, "creation_date": 1535713469, "post_id": 52077867, "comment_id": 91178531, "body": "We have actually dropped the idea of this, because there are other important tasks that need to be run. We did this: We changed the time according to the BLE rxed data. If the LED task was previously blinking after 5 minutes then we made one global variable in which BLE rxed data is stored. If a particular hex value is recived from BLE then we Change the parameter of vTaskDelay() and it is running fine :).   Not very professonal, but it works"}], "tags": [], "owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "is_accepted": false, "score": 0, "last_activity_date": 1535547497, "last_edit_date": 1535547497, "creation_date": 1535546813, "answer_id": 52077867, "question_id": 52075094, "link": "https://stackoverflow.com/questions/52075094/what-is-the-purpose-of-xtaskabortdelay-function-in-free-rtos/52077867#52077867", "title": "What is the purpose of xTaskAbortDelay function in free rtos?", "body": "<p>Reputation to low to comment. From what you say, everything is working as you said. Need more information: </p>\n\n<ol>\n<li>What does the LED task looks like?</li>\n<li>Do you use preemptive or cooperative scheduler (<code>#define configUSE_PREEMPTION 1</code> in freertosconfig.h file).</li>\n<li>What are the priorities of the three tasks?</li>\n</ol>\n\n<p>Something else to consider is: do you put the task back in BLOCKED state after it has served it's purose? You should check that first. How do you block the task in the first place?</p>\n\n<p>Maybe try using calling <code>vTaskResume( &lt;LED task handle&gt; )</code> from the bluetooth tasks and calling <code>vTaskSuspend()</code> from the LED task once it has finished it's job. I don't personally think this is the best approach, but it should work.</p>\n"}], "owner": {"reputation": 13, "user_id": 10232988, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kWQPCVuvIgk/AAAAAAAAAAI/AAAAAAAAABs/85A3JELLKhs/photo.jpg?sz=128", "display_name": "In-terra Weekend Projects", "link": "https://stackoverflow.com/users/10232988/in-terra-weekend-projects"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535632722, "creation_date": 1535538038, "last_edit_date": 1535632722, "question_id": 52075094, "link": "https://stackoverflow.com/questions/52075094/what-is-the-purpose-of-xtaskabortdelay-function-in-free-rtos", "title": "What is the purpose of xTaskAbortDelay function in free rtos?", "body": "<p>I have two task in which i am receving data from bluetooth and if i receive a particular hex value , i want a task(which is Toggling LED State) to run on the basis of the received data.</p>\n\n<p>If there was no data received , then both task should run as per they are scheduled.</p>\n\n<p>I have been trying to use xTaskAbortDelay function , the task does run from the input from bluetooth data, however , after that the LED task is running continously.</p>\n\n<p>Does xTaskAbortDelay creating some problem here?\nShould I use something else to achieve the same functionality?</p>\n\n<pre><code>TaskHandle_t  lora_send_data_handle;\nTaskHandle_t  ble_send_data_handle;\nTaskHandle_t  test_data_handle;\n\nstatic void button_task_check(void * pvParameter)\n{\n    TickType_t xLastWakeTime;\n    const TickType_t xFrequency = 1024;\n    xLastWakeTime = xTaskGetTickCount();\n    while(1)\n    {\n        nrf_delay_ms(100);\n        SEGGER_RTT_printf(0,\"%s\",\"INSIDE SWITCHING\\r\\n\");\n        xTaskAbortDelay(test_data_handle);\n\n        vTaskDelayUntil( &amp;xLastWakeTime, (TickType_t) 1024);\n    }\n}\n\n\n/*TASK TO RUN LEDS CHECK */\nstatic void led_task_check(void * pvParameter)\n{\n    TickType_t xLastWakeTime;\n    const TickType_t xFrequency = 122880;\n    xLastWakeTime = xTaskGetTickCount();\n\n    while(1)\n    {\n        SEGGER_RTT_printf(0,\"%s\",\"TEST TASK\\r\\n\");\n        nrf_gpio_pin_write(RED,1);\n        nrf_gpio_pin_write(GREEN,1);\n        nrf_gpio_pin_write(BLUE,1);\n\n        nrf_gpio_pin_write(RED,0);\n        nrf_gpio_pin_write(GREEN,1);\n        nrf_gpio_pin_write(BLUE,1);\n        nrf_delay_ms(1000);\n        nrf_gpio_pin_write(RED,1);\n        nrf_gpio_pin_write(GREEN,0);\n        nrf_gpio_pin_write(BLUE,1);\n        nrf_delay_ms(1000);\n        nrf_gpio_pin_write(RED,1);\n        nrf_gpio_pin_write(GREEN,1);\n        nrf_gpio_pin_write(BLUE,0);\n        nrf_delay_ms(1000);\n\n        nrf_gpio_pin_write(RED,0);\n        nrf_gpio_pin_write(GREEN,0);\n        nrf_gpio_pin_write(BLUE,0);\n        nrf_delay_ms(1000);\n\n        vTaskDelayUntil( &amp;xLastWakeTime, (TickType_t) 122880);\n    }\n}\n\n\nint main(void)\n{\n\n    uint8_t rx_qspi[255];\n    SEGGER_RTT_printf(0,\"%s\",\"reset\\r\\n\");\n\n    nrf_delay_ms(100);\n\n    xQueue1 = xQueueCreate(1, 30);\n\n    ret_code_t err_code;\n    err_code = nrf_drv_clock_init();\n    SEGGER_RTT_WriteString(0, err_code);\n\n    UNUSED_VARIABLE(xTaskCreate( button_task_check, \"t\", \\            \n        configMINIMAL_STACK_SIZE + 200, NULL,3,  &amp;lora_send_data_handle));\n    UNUSED_VARIABLE(xTaskCreate(led_task_check, \"et\", \\\n        configMINIMAL_STACK_SIZE + 200, NULL, 2, &amp;test_data_handle));\n\n    vTaskStartScheduler();\n\n    while(1);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1535536562, "post_id": 52074382, "comment_id": 91098770, "body": "Fyi, the order of your multipart boolean eval in your <code>fgets</code> loop is backward. the <code>i</code> check should be <i>first</i>."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1535536600, "post_id": 52074382, "comment_id": 91098801, "body": "Why do you have <code>sizeof(float)*8</code> as the size of the shared memory, when you&#39;re not storing floats in it?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1535536634, "post_id": 52074382, "comment_id": 91098814, "body": "... and where are these <i>4 strings</i> you mention in your question?"}, {"owner": {"reputation": 23, "user_id": 10287376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r6HO_K-uNIo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTa8YttfzLLbaOmyGuAeHF03odTQ/mo/photo.jpg?sz=128", "display_name": "Samuel Malik", "link": "https://stackoverflow.com/users/10287376/samuel-malik"}, "edited": false, "score": 0, "creation_date": 1535537361, "post_id": 52074382, "comment_id": 91099245, "body": "sorry, the strings are stored in words."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10287376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r6HO_K-uNIo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTa8YttfzLLbaOmyGuAeHF03odTQ/mo/photo.jpg?sz=128", "display_name": "Samuel Malik", "link": "https://stackoverflow.com/users/10287376/samuel-malik"}, "edited": false, "score": 0, "creation_date": 1535588762, "post_id": 52074757, "comment_id": 91125663, "body": "When I change the for loop to your suggestion, it gets the first char from each line an then continues print out the remaining characters of the last line"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 23, "user_id": 10287376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r6HO_K-uNIo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTa8YttfzLLbaOmyGuAeHF03odTQ/mo/photo.jpg?sz=128", "display_name": "Samuel Malik", "link": "https://stackoverflow.com/users/10287376/samuel-malik"}, "edited": false, "score": 0, "creation_date": 1535608468, "post_id": 52074757, "comment_id": 91129879, "body": "Try the following and let me know: <code>for(int j = 0, k = 0; j &lt; i; j++) {      strcpy((mem + k),words[j]); k = strlen(words[j]);  }</code>"}, {"owner": {"reputation": 23, "user_id": 10287376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r6HO_K-uNIo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTa8YttfzLLbaOmyGuAeHF03odTQ/mo/photo.jpg?sz=128", "display_name": "Samuel Malik", "link": "https://stackoverflow.com/users/10287376/samuel-malik"}, "edited": false, "score": 0, "creation_date": 1535619186, "post_id": 52074757, "comment_id": 91135639, "body": "That prints lines 1 and 4 four times, it misses out on lines 2/3. Could there be an issue with my loop in the client program: <code>for(int i = 0; i &lt; 4; i++){ printf(&quot;%s\\n&quot;,mem);}</code> Thankyou for your help"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 23, "user_id": 10287376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r6HO_K-uNIo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTa8YttfzLLbaOmyGuAeHF03odTQ/mo/photo.jpg?sz=128", "display_name": "Samuel Malik", "link": "https://stackoverflow.com/users/10287376/samuel-malik"}, "edited": false, "score": 0, "creation_date": 1535633465, "post_id": 52074757, "comment_id": 91145286, "body": "Actually the statement should be <code>k += strlen(words[j]);</code>. At each iteration it should add to the previous length."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1535634613, "last_edit_date": 1535634613, "creation_date": 1535537036, "answer_id": 52074757, "question_id": 52074382, "link": "https://stackoverflow.com/questions/52074382/strcpy-only-storing-last-string/52074757#52074757", "title": "strcpy() only storing last string", "body": "<p>This looks like a copy-paste mistake. </p>\n\n<p>In this <code>while</code> loop, <code>i</code> gets updated.  </p>\n\n<pre><code> while(fgets(words[i],600,ptr_fp )&amp;&amp; i &lt;600) {\n     i++;\n }\n</code></pre>\n\n<p>In the <code>for</code> loop, <code>j</code> should be compared to <code>i</code> in the controlling expression, instead it is compared with <code>1</code></p>\n\n<pre><code> for(int j = 0; j &lt; 1; j++) {\n     strcpy(mem,words);\n }\n</code></pre>\n\n<p>I think the above should be changed to:  </p>\n\n<pre><code> for(int j = 0, k = 0; j &lt; i; j++) {\n     strcpy((mem + k),words[j]); \n     k = k+ strlen(words[j]); \n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10287376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r6HO_K-uNIo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTa8YttfzLLbaOmyGuAeHF03odTQ/mo/photo.jpg?sz=128", "display_name": "Samuel Malik", "link": "https://stackoverflow.com/users/10287376/samuel-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "accepted_answer_id": 52074757, "answer_count": 1, "score": 0, "last_activity_date": 1535634613, "creation_date": 1535535944, "question_id": 52074382, "link": "https://stackoverflow.com/questions/52074382/strcpy-only-storing-last-string", "title": "strcpy() only storing last string", "body": "<p>I want to store elements of an array containing strings to make it accessible via a shared memory segment. I am currently using strcpy(), but it is obviously only storing the last string in the array. How would I make it store all 4 strings in the array? Currently I can only choose which line I would like to send (e.g. the first line with the two loops below:</p>\n\n<p>Here is my loop in the server program:</p>\n\n<pre><code>for(int j = 0; j &lt; 1;j++){\n            strcpy(mem,words);\n}\n</code></pre>\n\n<p>and the client program:</p>\n\n<pre><code>for(int i = 0; i &lt; 1; i++){\n    printf(\"%s\\n\",mem);\n}\n</code></pre>\n\n<p>here is the full server program:</p>\n\n<pre><code>int main() {\n    const key_t key = 12345678;\n    FILE *ptr_fp;\n    char words[600][600];\n    char *mem;\n    int i = 0;  \n    ptr_fp = fopen(\"words.txt\",\"r\");  \n\n    int shmid = shmget(key, sizeof(float)*8, 0644 | IPC_CREAT);\n\n    if (shmid &lt; 0) {\n        perror(\"shmget\");\n        exit(1);\n    } \n\n    if (ptr_fp != NULL){\n        while(fgets(words[i],600,ptr_fp )&amp;&amp; i &lt;600){\n            i++;\n        }\n    }\n\n    mem = (char *)shmat(shmid,NULL,0);\n\n    if(mem == (char *)-1){\n        perror(\"shmat error\\n\");\n        exit(1);\n    } else {\n        for(int j = 0; j &lt; 1;j++){\n            strcpy(mem,words);\n        }\n        printf(\"Memory is attached\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1535534646, "post_id": 52073943, "comment_id": 91097529, "body": "You have a pointer <code>CopiedByte</code>, but <i>where does it point?!</i>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1535534728, "post_id": 52073943, "comment_id": 91097584, "body": "Also, don&#39;t forget that <code>char</code> strings in  are really called <b><i>null-terminated</b> byte strings</i>. That <i>null-terminator</i> is really important for all functions handling strings. If you forget it then string functions will go out of bounds looking for it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535534766, "post_id": 52073943, "comment_id": 91097604, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 0, "creation_date": 1535534819, "post_id": 52073943, "comment_id": 91097635, "body": "So which is the easiest way? To use char array instead pointer?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1535534831, "post_id": 52073943, "comment_id": 91097638, "body": "Lastly, you never change where <code>CopiedByte</code> points, so you will overwrite the same location over and over."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535535014, "post_id": 52073943, "comment_id": 91097737, "body": "your code doesn&#39;t compile .... missing at least &quot;;&quot; at the end of the first line."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535535039, "post_id": 52073943, "comment_id": 91097756, "body": "@Dim <i>To use char array instead pointer?</i>: it doesn&#39;t matter it&#39;s very similar. But your problem is not about using pointers or arrays, it&#39;s about your code being wrong (see previous comments) and your code being incomplete. You need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 0, "creation_date": 1535535385, "post_id": 52074093, "comment_id": 91098001, "body": "But also i can&#39;t see anything in output."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 1, "creation_date": 1535535465, "post_id": 52074093, "comment_id": 91098059, "body": "@Dim You will be able to see now."}, {"owner": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 0, "creation_date": 1535535588, "post_id": 52074093, "comment_id": 91098122, "body": "Neither now...."}, {"owner": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 0, "creation_date": 1535535769, "post_id": 52074093, "comment_id": 91098234, "body": "Is it more suiable and easy to use Array in my case? Or it doesnt matter?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 0, "creation_date": 1535536041, "post_id": 52074093, "comment_id": 91098407, "body": "@Dim arrays or pointers, it&#39;s a matter of personal preference here."}, {"owner": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 0, "creation_date": 1535536131, "post_id": 52074093, "comment_id": 91098471, "body": "What takes more memory? Both have same use?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "edited": false, "score": 0, "creation_date": 1535536134, "post_id": 52074093, "comment_id": 91098473, "body": "@Dim One example is If array is declared inside the function it&#39;s scope ends within the function. Only overhead you need to free the pointer once allocated with pointers."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1535535640, "last_edit_date": 1535535640, "creation_date": 1535535061, "answer_id": 52074093, "question_id": 52073943, "link": "https://stackoverflow.com/questions/52073943/removing-spaces-from-char-with-pointer/52074093#52074093", "title": "Removing spaces from char with pointer", "body": "<p>You have not allocated memory to <code>CopiedByte</code> and once you copy the char from <code>byte</code> to <code>CopiedByte</code> you need to increment the <code>CopiedByte</code> to point to next location.\nImportant note: Once you copy all the data put the <code>NULL</code> terminator.</p>\n\n<p>Memory allocated using <code>malloc</code>(dynamically) need to be freed otherwise there will be <code>memory leaks</code>.</p>\n\n<pre><code> char * byte=\"a b c d\";\n char * CopiedByte = malloc(strlen(byte) +1);\n int i=0;\n for (;*byte;++byte)\n   {\n    if(*byte!=' ')\n    {\n      CopiedByte[i]=*byte;\n      i++;\n    }\n  }\n  CopiedByte[i] = '\\0';\n\n /* do your work*/\n\n  free(CopiedByte);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10216029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832659a916421914e6f9227ad390864b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/10216029/dim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1535539015, "answer_count": 1, "score": 0, "last_activity_date": 1535535640, "creation_date": 1535534592, "question_id": 52073943, "link": "https://stackoverflow.com/questions/52073943/removing-spaces-from-char-with-pointer", "closed_reason": "Duplicate", "title": "Removing spaces from char with pointer", "body": "<p>I'm trying to remove empty spaces from a char with pointer.</p>\n\n<pre><code> char * byte=\"a b c d\"\n char * CopiedByte;\n for (;*byte;++byte)\n   {\n    if(*byte!=' ')\n      *CopiedByte=*byte;\n\n\n  }\n printf(\"%s\",CopiedByte);\n</code></pre>\n\n<p>But i dont get anything in output</p>\n"}, {"tags": ["c++", "c", "macros", "c-preprocessor", "compiler-directives"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1535533282, "post_id": 52073433, "comment_id": 91096660, "body": "While it&#39;s true that a C compiler used to be compromised of a few smaller programs, that&#39;s rarely the case today. Due to how <a href=\"https://en.cppreference.com/w/c/language/translation_phases\" rel=\"nofollow noreferrer\">translation phases</a> are specified it&#39;s usually a single program. If so there are usually options to stop after preprocessing though."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1535533364, "post_id": 52073433, "comment_id": 91096700, "body": "<i>&quot;..The C++ source file is processed by the compiler <b>as if</b> the following phases take place, in this exact order:..&quot;</i> <a href=\"https://en.cppreference.com/w/cpp/language/translation_phases\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/translation_phases</a>  <b>As if</b> is the key phrase here most compilers (these days) are just a single executable ."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1535533557, "post_id": 52073433, "comment_id": 91096837, "body": "It&#39;s also common for a compiler to have options to run the preprocessor only, or at least to save the preprocessor output. If that&#39;s what you&#39;re looking for consult the documentaiton for your compiler."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1535533619, "post_id": 52073433, "comment_id": 91096880, "body": "Oh and while the actual compiler usually is a single program, it&#39;s unusual to invoke it directly. Instead there&#39;s a &quot;front-end&quot; program (like <code>gcc</code> or <code>g++</code> for GCC) that invokes the actual compiler and then possibly the linker."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 1, "creation_date": 1535534873, "post_id": 52073433, "comment_id": 91097663, "body": "Any of this is specific to exactly which compiler you&#39;re using.  None of it is specified by the C++ standard."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1535539435, "post_id": 52073433, "comment_id": 91100587, "body": "No, your comments are not correct.   Different compilers do this differently.   The C and C++ standards each specify a number of translation phases, one of which is essentially the preprocessor.    And, in a number of compiler suites, the preprocessing phase is/was performed by a separate program from other phases.   However, that is an implementation choice, and a number of vendors have made different implementation choices."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1535536399, "post_id": 52074176, "comment_id": 91098672, "body": "most modern compilers generate the assembler output which is assembled to the object file file by assembler proram"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1535543201, "post_id": 52074176, "comment_id": 91102989, "body": "@P__J__: Such as? Only GCC does, AFAIK. It&#39;s a slow step, serializing the textual representation of the instructions only for the assembler to turn it back into binary. MSVC for instance doesn&#39;t bother."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1535535310, "creation_date": 1535535310, "answer_id": 52074176, "question_id": 52073433, "link": "https://stackoverflow.com/questions/52073433/which-program-in-the-compiler-takes-care-of-the-preprocessors/52074176#52074176", "title": "Which program in the compiler takes care of the preprocessors?", "body": "<p>There is nothing saying how a compiler should/must be designed internally, so it will be different from compiler to compiler.</p>\n\n<p>Traditionally however, they are divided into pre-processor, compiler and linker. These may be inside the same executable, or in several. </p>\n\n<p>The pre-processor does everything that needs to be done before the compiler starts checking the actual language syntax. The compiler is checking if the source is valid C, does it make sense? And then translates the source code into an executable program, which behaves as specified by the C standard.</p>\n\n<p>Some compilers give the output in the form of a hardware-independent \"object file\", in which case a linker is needed to translate one or several object files into machine code. But the compiler may as well give the output as machine code, in which case the only task of the linker is to put all different parts (<em>translation units</em>) of the program together, including libraries, and check if all identifiers (variables, functions etc) used by the program are present - if not, you will get a linker error.</p>\n\n<p>The C standard (C17 5.1.1.2) only speaks of <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.1.2\" rel=\"nofollow noreferrer\"><em>translation phases</em></a>, which is mostly dictating the order of pre-processing. Roughly, translation phases 1 to 6 are what we would call \"pre-processing\", step 7 is \"compiling\", and step 8 is \"linking\".</p>\n"}], "owner": {"reputation": 27, "user_id": 10133060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c111550c8b4ae87166c8e770e740dc1f?s=128&d=identicon&r=PG&f=1", "display_name": "Pratik P", "link": "https://stackoverflow.com/users/10133060/pratik-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1535543773, "accepted_answer_id": 52074176, "answer_count": 1, "score": -1, "last_activity_date": 1535535310, "creation_date": 1535533117, "question_id": 52073433, "link": "https://stackoverflow.com/questions/52073433/which-program-in-the-compiler-takes-care-of-the-preprocessors", "closed_reason": "Needs more focus", "title": "Which program in the compiler takes care of the preprocessors?", "body": "<p>Compiler is a combination of many programs. So which program takes care of which part during compilation? I read somewhere that the preprocessor program takes care of the C preprocessor directives(macros). Is that correct?</p>\n"}, {"tags": ["c++", "c", "file", "io"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1535533399, "post_id": 52073379, "comment_id": 91096723, "body": "Add <code>fflush(fd_test);</code> after every <code>fprintf(fd_test, ...</code> Its important with logging code to flush immediately otherwise the output may not appear as expected."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1535533408, "post_id": 52073379, "comment_id": 91096732, "body": "First make sure you flush the output with <code>fflush(fd_test)</code> every time you print some debugging, otherwise the debugging output could be buffered and not shown. You are also running <code>cw_diag ksta</code> , but in your other example you are only running <code>ksta</code> (perhaps you ran <code>cw_diag</code> as a standalone command first, and if you do this in 2 steps, it might be very different).  If you manually run <code>cw_diag ksta</code> as one command, do you get the expected output ? It could even be that the <code>cw_diag</code> command is only designed to be run from an actual terminal."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1535533573, "post_id": 52073379, "comment_id": 91096842, "body": "Well, a few problems: If the <code>popen()</code> returns <code>NULL</code>, you never close your <code>fd_test</code> logfile (Nor do you log anything about the failure). The command you&#39;re trying to run via popen is different than in your first snippet? You&#39;re using <code>fclose()</code> instead of <code>pclose()</code> to close <code>fd</code>. You&#39;re probably getting warnings about const pointers. You&#39;re using <code>strncpy()</code>. You seem to be copying into an uninitialized pointer (<code>value</code>), which is not going to end well.... Always compile with a healthy set of warnings (<code>-Wall -Wextra</code>) and pay attention to them. It helps."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1535533598, "post_id": 52073379, "comment_id": 91096865, "body": "Did the <code>popen</code> call succeed ? Why the <code>cw_diag</code> ? Does <code>ksta</code> depend on any environment hat might not be available ? Does your process have the appropriate permissions ? Does <code>ksta</code> write to stdout ? A lot of possible causes ..."}, {"owner": {"reputation": 351, "user_id": 5570764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/81166bd56dc65e7ee350592c6cf0ea01?s=128&d=identicon&r=PG&f=1", "display_name": "ajfbiw.s", "link": "https://stackoverflow.com/users/5570764/ajfbiw-s"}, "edited": false, "score": 0, "creation_date": 1535533670, "post_id": 52073379, "comment_id": 91096915, "body": "ksta is an alias for cw_diag ksta. I have tried cw_diag ksta &gt; file.txt inside popen and it works."}, {"owner": {"reputation": 351, "user_id": 10270446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d380ddf5bbaed0b244a1e9cb8be0b264?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Janney", "link": "https://stackoverflow.com/users/10270446/jim-janney"}, "edited": false, "score": 0, "creation_date": 1535674128, "post_id": 52073379, "comment_id": 91164612, "body": "Possibly the <code>cw_diag ksta</code> command is failing for some reason, printing to stderr, and exiting without ever printing to stdout. Try changing the command to <code>cw_diag ksta 2&gt;&amp;1</code> as described in <a href=\"https://stackoverflow.com/questions/6900577/c-popen-wont-catch-stderr\">this question</a>"}], "owner": {"reputation": 351, "user_id": 5570764, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/81166bd56dc65e7ee350592c6cf0ea01?s=128&d=identicon&r=PG&f=1", "display_name": "ajfbiw.s", "link": "https://stackoverflow.com/users/5570764/ajfbiw-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535533269, "creation_date": 1535532960, "last_edit_date": 1535533269, "question_id": 52073379, "link": "https://stackoverflow.com/questions/52073379/fgets-not-reading-anything-from-popen-fd", "title": "fgets not reading anything from popen fd", "body": "<p>The output of the ksta command is as follows:</p>\n\n<pre><code>PU423E3X16003871# ksta\nRadio 1 client count 1\n    MAC:4c:66:41:11:5d:a9 ip:60.60.70.6 ip_proto:ip ip_age:130 host:android-8710a239e8a8a97c vci:dhcpcd-5.5.6\n        vlanid:0 Auth:Yes channel:136 rate:86Mbps rssi:35dB idle:3600s\n        Rx bytes:12715 Tx bytes:4034 Rx rate:86Mbps Tx rate:86Mbps Rx last:130s Tx last:131s\n        AssocID:1 Mode:normal Flags:0 PauseCnt:0 intf wl1.1 AssocTime: 2316s\n</code></pre>\n\n<p>Below is a parser that runs the ksta command and gets the values of 8 specified fields from the output. For each value, it runs a CFG_set function to register the variable.</p>\n\n<p>The problem right now is that nothing is read from the fd. The first time fgets() is called, buf seems to be empty, and the function exits without actually reading anything.</p>\n\n<p>Sometimes when I run this code, absolutely nothing is printed to the debug file.</p>\n\n<p>Does anyone see what the issues are with my code?</p>\n\n<pre><code>static int set_sta_info()\n{\n    FILE * fd;\n    FILE * fd_test;\n    FILE * fd3;\n    char buf[CMD_BUF_LENGTH];\n    char* key_val;\n    char* start;\n    char* value;\n    char* key;\n    int i;\n    char* keys[8] = {\"MAC\", \"ip\", \"host\", \"vci\", \"vlanid\", \"Auth\", \"rssi\", \"AssocTime\"};\n    //fd = popen(\"ksta &gt; /tmp/ksta_output.txt\", \"r\");\n    fd = popen(\"cw_diag ksta\", \"r\");\n    fd_test = fopen(\"/tmp/sta_info_debug.txt\", \"a\");\n    fprintf(fd_test, \"entering set_sta_info()\\n\");\n    if (!fd) return -1;\n    // Station Mac, Ip, Hostname, vlanid, Auth, Rate, rssi, interface (wl1.1), Assoc Time.\n    while (1)\n    {   fprintf(fd_test, \"inside while loop\");\n        buf[0] = 0;\n        for (i = 0; i &lt; CMD_BUF_LENGTH; i++){\n            buf[i] = 0;\n        }\n        fgets(buf, sizeof(buf), fd);\n        fprintf(fd_test, \" line is %s\\n\", buf);\n        if (buf[0] == 0) break;\n        fprintf(fd_test, \"buf is not empty, didn't break\\n\");\n        key_val = strtok(buf, ' ');\n        fprintf(fd_test, \"line 2808.\\n\");\n        while (key_val) {\n            fprintf(fd_test, \"current element examining: %s\\n\", key_val);\n            for (i = 0; i &lt; 8; i++){\n                fprintf(fd_test, \"looking at key %s\\n\", keys[i]);\n                if (strstr(key_val, keys[i])){\n                    fprintf(fd_test, \"%s is found in %s\\n\", keys[i], key_val);\n                    start = strstr(buf, ':');\n                    if (!start){\n                        fprintf(fd_test, \"but, there is no :, so skipped.\\n\");\n                        continue;\n                    }\n                    start ++;\n                    while (*start &amp;&amp; (*start == ' ' || *start == '\\t')) start++;\n                    fprintf(fd_test, \"the word to be copied is %s\\n\", start);\n                    strncpy(value, start, MAX_NAME_LEN);\n                    CFG_set_by_name(keys[i], value);\n                    fprintf(fd_test, \"key is %s, value is %s\\n\", keys[i], value);\n                }\n            }\n            key_val = strtok(NULL, ' ');\n        }\n    }\n    fclose(fd);\n         fclose(fd_test);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "c", "jvm", "java-native-interface"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1535534615, "post_id": 52073251, "comment_id": 91097510, "body": "Please indent your code consistently.  What you have posted is unreadable."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1535537294, "post_id": 52073251, "comment_id": 91099213, "body": "So which line of code does that address correspond to? By the way, that global <code>JNIEnv*</code> variable seems like a bad idea, since a <code>JNIEnv</code> must not be shared across threads. A <code>JavaVM*</code> on the other hand <i>is</i> safe to cache, and can be used to obtain a valid <code>JNIEnv*</code> whenever one is needed."}, {"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1535538896, "post_id": 52073251, "comment_id": 91100243, "body": "If you build your JNI library with Visual Studio you can attach its debugger to your Java process to see where it fails exactly (Debug-&gt;Attach to process; make sure it says &quot;Native code&quot; above the process list)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1535543257, "post_id": 52073251, "comment_id": 91103013, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12420463/keeping-a-global-reference-to-the-jnienv-environment\">Keeping a global reference to the JNIEnv environment</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1535543430, "post_id": 52073251, "comment_id": 91103122, "body": "@Michael <i>By the way, that global <code>JNIEnv*</code> variable seems like a bad idea</i>  It&#39;s worse than a &quot;bad idea&quot;.  It&#39;s <a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/invocation.html\" rel=\"nofollow noreferrer\">pretty much forbidden behavior</a>:  &quot;The JNI interface pointer (<code>JNIEnv</code>) is valid only in the current thread. Should another thread need to access the Java VM, it must first call <code>AttachCurrentThread()</code> ...&quot;"}, {"owner": {"reputation": 91, "user_id": 3235815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0567230e828845712ce4bba3124c3399?s=128&d=identicon&r=PG&f=1", "display_name": "user3235815", "link": "https://stackoverflow.com/users/3235815/user3235815"}, "edited": false, "score": 0, "creation_date": 1535829500, "post_id": 52073251, "comment_id": 91213285, "body": "i change the code but not solve my problem"}, {"owner": {"reputation": 91, "user_id": 3235815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0567230e828845712ce4bba3124c3399?s=128&d=identicon&r=PG&f=1", "display_name": "user3235815", "link": "https://stackoverflow.com/users/3235815/user3235815"}, "edited": false, "score": 0, "creation_date": 1536698383, "post_id": 52073251, "comment_id": 91515923, "body": "can anyone debug my c++ code?"}], "owner": {"reputation": 91, "user_id": 3235815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0567230e828845712ce4bba3124c3399?s=128&d=identicon&r=PG&f=1", "display_name": "user3235815", "link": "https://stackoverflow.com/users/3235815/user3235815"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536698326, "creation_date": 1535532471, "last_edit_date": 1536698326, "question_id": 52073251, "link": "https://stackoverflow.com/questions/52073251/crash-jvm-when-call-native-code-with-jni", "title": "crash jvm when call native code with jni?", "body": "<p>i write a program in java that use jni to call native code,when i try to call native code jvm crash?\nEXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x0000000076f39958, pid=4376, tid=4388\nsiginfo: EXCEPTION_ACCESS_VIOLATION (0xc0000005), reading address 0x0000000012004926</p>\n\n<p>bwm_shutdownEvent.h</p>\n\n<pre><code>/* DO NOT EDIT THIS FILE - it is machine generated */\n#include &lt;jni.h&gt;\n/* Header for class bwm_shutdownEvent */\n\n#ifndef _Included_bwm_shutdownEvent\n#define _Included_bwm_shutdownEvent\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n/*\n* Class:     bwm_shutdownEvent\n* Method:    registerEvent\n* Signature: ()V\n*/\nJNIEXPORT void JNICALL Java_bwm_shutdownEvent_registerEvent\n(JNIEnv *, jobject);\n\n#ifdef __cplusplus\n}\n#endif\n#endif\n</code></pre>\n\n<p>shutdownEvent.cpp</p>\n\n<pre><code>#include &lt;jni.h&gt;\n#include \"bwm_shutdownEvent.h\"\n#include &lt;windows.h&gt;\n#include &lt;signal.h&gt;\nJavaVM *jvm=NULL;\nconst char g_szClassName[] = \"bwm\";\nvoid callCallBack() {\nJNIEnv *env;\njvm-&gt;AttachCurrentThread((void **)&amp;env, NULL);\njclass cls=env-&gt;FindClass(\"bwm/shutdownEvent\");\njmethodID mid=env-&gt;GetStaticMethodID(cls,\"callback\",\"()V\");      \nenv-&gt;CallStaticVoidMethod(cls, mid);\njvm-&gt;DetachCurrentThread();\n}\nvoid callReload() {\nJNIEnv *env;\njvm-&gt;AttachCurrentThread((void **)&amp;env, NULL);\njclass cls=env-&gt;FindClass(\"bwm/shutdownEvent\");\njmethodID mid=env-&gt;GetStaticMethodID(cls,\"reload\",\"()V\");      \nenv-&gt;CallStaticVoidMethod(cls, mid);\njvm-&gt;DetachCurrentThread();\n}\n\nLRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam,LPARAM lParam)\n{\n\nswitch(msg) {\n    case WM_CREATE:\n        break;\n    case WM_POWERBROADCAST:\n        if (wParam==PBT_APMSUSPEND){/*go to sleep and hibernate*/\n          callCallBack(); \n        }\n        if(wParam==PBT_APMRESUMESUSPEND){/*wake up*/ \n           // callReload();\n        }\n        break;\n    case WM_ENDSESSION:/*shut down and log off*/\n        callCallBack();\n         PostQuitMessage(0);\n        break; \n    case WM_CLOSE:\n        PostQuitMessage(0);\n        break;    \n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n    default:\n    break;\n}\nreturn DefWindowProc(hwnd, msg, wParam, lParam);\n}\nvoid registerw() {\nWNDCLASSEX wc;\nHWND hwnd;\nMSG Msg;\n//Step 1: Registering the Window Class\nwc.cbSize        = sizeof(WNDCLASSEX);\nwc.style         = 0;\nwc.lpfnWndProc   = WndProc;\nwc.cbClsExtra    = 0;\nwc.cbWndExtra    = 0;\nwc.hIcon         = LoadIcon(NULL, IDI_APPLICATION);\nwc.hCursor       = LoadCursor(NULL, IDC_ARROW);\nwc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);\nwc.lpszMenuName  = NULL;\nwc.lpszClassName = g_szClassName;\nwc.hIconSm       = LoadIcon(NULL, IDI_APPLICATION);\n\nif(!RegisterClassEx(&amp;wc))\n{\n    MessageBox(NULL, \"Window Registration Failed!\", \"Error!\",\n        MB_ICONEXCLAMATION | MB_OK);\n    return;\n}\n\n// Step 2: Creating the Window\nhwnd = CreateWindowEx(\n    WS_EX_CLIENTEDGE,\n    g_szClassName,\n    \"The title of my window\",\n    WS_OVERLAPPEDWINDOW,\n    CW_USEDEFAULT, CW_USEDEFAULT, 24, 12,\n    NULL, NULL, NULL, NULL);\n\nif(hwnd == NULL)\n{\n    MessageBox(NULL, \"Window Creation Failed!\", \"Error!\",\n        MB_ICONEXCLAMATION | MB_OK);\n    return;\n}\n\nShowWindow(hwnd, 1);\nUpdateWindow(hwnd);\n// Step 3: The Message Loop\nwhile(GetMessage(&amp;Msg, NULL, 0, 0) &gt; 0)\n{\n    TranslateMessage(&amp;Msg);\n    DispatchMessage(&amp;Msg);\n}\n}\nJNIEXPORT void JNICALL Java_bwm_shutdownEvent_registerEvent\n(JNIEnv *env, jobject){ \njint rs = env-&gt;GetJavaVM(&amp;jvm);\nregisterw();/* Creates window &amp; enters message loop */\n} \n</code></pre>\n\n<p>shutdownEvent.java</p>\n\n<pre><code> public class shutdownEvent {\n  /**\n * @param args the command line arguments\n */\nstatic{\n    try{\n\n\n\n  System.loadLibrary(\"shutdownEvent.dll\");\n    }\ncatch(Exception e){\n     System.out.println(\"can not find dll\");  \n    }\n}\npublic native void registerEvent();\nprivate static void callback() throws IOException{\n  System.out.println(\"ok that is ok\"); \n  Alert alert=new Alert(Alert.AlertType.ERROR);\n  alert.setContentText(\"hi\");\n }\n private static void reload(){\n\n }\n}\n</code></pre>\n"}, {"tags": ["c", "type-conversion", "function-pointers"], "comments": [{"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1535532433, "post_id": 52073223, "comment_id": 91096124, "body": "About what you said @Lundin."}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1535534477, "post_id": 52073459, "comment_id": 91097427, "body": "So, in other words, if I&#39;ve understood correctly, correct me if I&#39;m wrong, you can sort of transport around a function pointer of type A as a function pointer of type B and then when you need it (typeA) you convert it back."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1535534492, "post_id": 52073459, "comment_id": 91097441, "body": "So for the previous matter, discussed <a href=\"https://stackoverflow.com/questions/52070882/c-how-to-access-a-function-pointer-stored-in-a-void-pointer-void\">here</a>, what should have been done is, create an array of &#39;generic function pointers&#39;, convert the functions into this generic type and store them as such in the array to then convert them back when needed for use... ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1535535375, "post_id": 52073459, "comment_id": 91097992, "body": "@notAymen Indeed, though you must keep track of the actual types of the functions somehow."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 7, "last_activity_date": 1535533199, "creation_date": 1535533199, "answer_id": 52073459, "question_id": 52073223, "link": "https://stackoverflow.com/questions/52073223/c-what-even-is-function-pointer-conversion/52073459#52073459", "title": "C: What even is function pointer conversion?", "body": "<p>It means that if you have two different function pointer types, such as for example:</p>\n\n<pre><code>int (*i)(int);\nvoid (*v)(void);\n</code></pre>\n\n<p>Then you can make a conversion from one type to the other by using an explicit cast:</p>\n\n<pre><code>v = (void(*)(void))i;\n</code></pre>\n\n<p>This is allowed, but calling <code>v()</code> won't work. The standard says this, C17 6.3.2.3 \u00a78:</p>\n\n<blockquote>\n  <p>A pointer to a function of one type may be converted to a pointer to a function of another type and\n  back again; the result shall compare equal to the original pointer. If a converted pointer is used to\n  call a function whose type is not compatible with the referenced type, the behavior is undefined.</p>\n</blockquote>\n\n<p>So if you try to call the function by <code>v();</code> then it is likely undefined behavior. You can however convert back to the original type <code>int(*)(int)</code> without losing information. </p>\n\n<p>This allows you to use a specific function pointer type as a \"generic type\". Rather than using <code>void*</code>, which isn't ok, as discussed <a href=\"https://stackoverflow.com/a/52070955/584518\">here</a>.</p>\n\n<hr>\n\n<p>Notably, all code with function pointers get much easier to read if you use typedefs:</p>\n\n<pre><code>typedef int int_func (int);\ntypedef void void_func (void);\n\nint main() \n{\n  int_func*  i;\n  void_func* v;\n\n  v = (void_func*) i;\n\n  i = (int_func*) v;\n}\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "closed_date": 1535547895, "accepted_answer_id": 52073459, "answer_count": 1, "score": 2, "last_activity_date": 1535612558, "creation_date": 1535532397, "last_edit_date": 1592644375, "question_id": 52073223, "link": "https://stackoverflow.com/questions/52073223/c-what-even-is-function-pointer-conversion", "closed_reason": "Needs details or clarity", "title": "C: What even is function pointer conversion?", "body": "<p>Let's say one wanted to <strong>create an array that could hold multiple function pointers &amp; of different types</strong>.. how would he go about doing so ? Perhaps an array of void pointers could work ?... Well as it turns out, no since in order to use the functions stored in the void pointers you'd have to convert/cast them (the void pointers) back to function pointers and...</p>\n<blockquote>\n<p>&quot;A conversion between a function pointer and a void pointer is not possible. void* was never a generic pointer type for function pointers, only for object pointers. They are not compatible types.</p>\n<p>[...] you can cast between void* and a function pointer, but what will happen is undefined behavior. You will be relying on system-specific non-standard extensions.&quot;</p>\n<p>-@Lundin (<a href=\"https://stackoverflow.com/a/52070955/9302544\">here</a>)</p>\n</blockquote>\n<p>Instead...</p>\n<blockquote>\n<p>Slightly better would be to use a function pointer type such as void (*)(void) as the generic pointer. You can <strong>convert to/from different function pointers</strong>, what will happen is compiler-specific (implementation-defined behavior). That is, the code will still be non-portable, but at least you don't risk a program crash from invoking undefined behavior.</p>\n<p>-@Lundin (<a href=\"https://stackoverflow.com/a/52070955/9302544\">here</a>)</p>\n</blockquote>\n<hr />\n<p>That said, what does it even mean to <strong>convert from one function pointer to another</strong> ?</p>\n<p>Could someone explain it. With an example perhaps.</p>\n"}, {"tags": ["c", "filepath"], "comments": [{"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 0, "creation_date": 1535532489, "post_id": 52073194, "comment_id": 91096172, "body": "Please provide the code you got so far with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It would help us to help you."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 4, "creation_date": 1535532492, "post_id": 52073194, "comment_id": 91096173, "body": "I don&#39;t think there&#39;s a standard function for going in this direction, so basically you have to come up with your own algorithm to do it. Finding the common prefix and replacing each directory in it with <code>&quot;..&#47;&quot;</code> seems to come close."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1535532832, "post_id": 52073194, "comment_id": 91096382, "body": "Duplicates : <a href=\"https://stackoverflow.com/questions/29055511/how-to-find-relative-path-given-two-absolute-paths\">How to find relative path given two absolute paths?</a>, <a href=\"https://stackoverflow.com/questions/9663845/how-to-convert-absolute-path-to-relative-in-c-linux\">How to convert absolute path to relative in c linux</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535532849, "post_id": 52073194, "comment_id": 91096391, "body": "You write <i>&quot;If possible I would like this to work even if given paths and resolved path does not exist.&quot;</i>: of course it is possible, the problem can be resolved purely by string manipulation as uwind already has suggested."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1535532867, "post_id": 52073194, "comment_id": 91096401, "body": "potentially interesting : <a href=\"https://stackoverflow.com/questions/2564634/convert-absolute-path-into-relative-path-given-a-current-directory-using-bash\">Convert absolute path into relative path given a current directory using Bash</a>"}, {"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 0, "creation_date": 1535533093, "post_id": 52073194, "comment_id": 91096537, "body": "The shell command realpath could also be used with <code>realpath --relative-to=&lt;current-dir&gt; &lt;final-dir&gt;</code> -&gt; returns the relatice path"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1535533289, "post_id": 52073194, "comment_id": 91096664, "body": "The problem boils down to the <i>longest common prefix terminated by</i> <code>&#39;&#47;&#39;</code>. One approach would be to take <code>fullpath</code> and loop with <code>strrchr</code> looking for <code>&#39;&#47;&#39;</code> as your character, use difference between the returned pointer and <code>fullpath</code> and call <code>strncmp</code> on both until it is satisfied or the return of <code>strrchr</code> equals <code>fullpath</code> or is <code>NULL</code>."}, {"owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "edited": false, "score": 0, "creation_date": 1535541189, "post_id": 52073194, "comment_id": 91101735, "body": "updated post with use and example"}], "owner": {"reputation": 73, "user_id": 7276564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a460e716c1ec1064566b5eac96dfc3fc?s=128&d=identicon&r=PG&f=1", "display_name": "PSP CODER", "link": "https://stackoverflow.com/users/7276564/psp-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 1, "closed_date": 1535533021, "answer_count": 0, "score": 2, "last_activity_date": 1535543799, "creation_date": 1535532292, "last_edit_date": 1535543799, "question_id": 52073194, "link": "https://stackoverflow.com/questions/52073194/linux-c-how-to-convert-two-full-paths-to-a-relative-path-updated", "closed_reason": "Duplicate", "title": "LINUX C how to convert two full path&#39;s to a relative path (updated)", "body": "<p>I would like to convert a full path to a relative path based on a given directory, kinda like this</p>\n\n<p><code>realpath -m /home/mobile_c/relpath/CCR/Headers/gc.h --relative-to=/home/mobile_c/relpath/CCR/UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h</code></p>\n\n<p>except coded in C\nbut im not sure how i would do so</p>\n\n<p>my original intended result is from x file, resolved to x file</p>\n\n<p>so it would expected to be, for example:</p>\n\n<p>from <code>~/CCR/Headers/gc.h</code></p>\n\n<p>to <code>~/CCR/UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h</code></p>\n\n<p>relative_path (from > to) = <code>../UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h</code></p>\n\n<p>relative_path (to > from) = <code>../../../../Headers/gc.h</code></p>\n\n<p>this is what i currently have</p>\n\n<pre><code>#define ps(x) printf(\"%s = %s\\n\", #x, x)\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;libgen.h&gt;\n\nvoid pathCanonicalize (char *path)\n{\n    size_t i;\n    size_t j;\n    size_t k;\n\n    //Move to the beginning of the string\n    i = 0;\n    k = 0;\n\n    //Replace backslashes with forward slashes\n    while (path[i] != '\\0') {\n        //Forward slash or backslash separator found?\n        if (path[i] == '/' || path[i] == '\\\\') {\n            path[k++] = '/';\n            while (path[i] == '/' || path[i] == '\\\\')\n                i++;\n        } else {\n            path[k++] = path[i++];\n        }\n    }\n\n    //Properly terminate the string with a NULL character\n    path[k] = '\\0';\n\n    //Move back to the beginning of the string\n    i = 0;\n    j = 0;\n    k = 0;\n\n    //Parse the entire string\n    do {\n        //Forward slash separator found?\n        if (path[i] == '/' || path[i] == '\\0') {\n            //\".\" element found?\n            if ((i - j) == 1 &amp;&amp; !strncmp (path + j, \".\", 1)) {\n                //Check whether the pathname is empty?\n                if (k == 0) {\n                    if (path[i] == '\\0') {\n                        path[k++] = '.';\n                    } else if (path[i] == '/' &amp;&amp; path[i + 1] == '\\0') {\n                        path[k++] = '.';\n                        path[k++] = '/';\n                    }\n                } else if (k &gt; 1) {\n                    //Remove the final slash if necessary\n                    if (path[i] == '\\0')\n                        k--;\n                }\n            }\n            //\"..\" element found?\n            else if ((i - j) == 2 &amp;&amp; !strncmp (path + j, \"..\", 2)) {\n                //Check whether the pathname is empty?\n                if (k == 0) {\n                    path[k++] = '.';\n                    path[k++] = '.';\n\n                    //Append a slash if necessary\n                    if (path[i] == '/')\n                        path[k++] = '/';\n                } else if (k &gt; 1) {\n                    //Search the path for the previous slash\n                    for (j = 1; j &lt; k; j++) {\n                        if (path[k - j - 1] == '/')\n                            break;\n                    }\n\n                    //Slash separator found?\n                    if (j &lt; k) {\n                        if (!strncmp (path + k - j, \"..\", 2)) {\n                            path[k++] = '.';\n                            path[k++] = '.';\n                        } else {\n                            k = k - j - 1;\n                        }\n\n                        //Append a slash if necessary\n                        if (k == 0 &amp;&amp; path[0] == '/')\n                            path[k++] = '/';\n                        else if (path[i] == '/')\n                            path[k++] = '/';\n                    }\n                    //No slash separator found?\n                    else {\n                        if (k == 3 &amp;&amp; !strncmp (path, \"..\", 2)) {\n                            path[k++] = '.';\n                            path[k++] = '.';\n\n                            //Append a slash if necessary\n                            if (path[i] == '/')\n                                path[k++] = '/';\n                        } else if (path[i] == '\\0') {\n                            k = 0;\n                            path[k++] = '.';\n                        } else if (path[i] == '/' &amp;&amp; path[i + 1] == '\\0') {\n                            k = 0;\n                            path[k++] = '.';\n                            path[k++] = '/';\n                        } else {\n                            k = 0;\n                        }\n                    }\n                }\n            } else {\n                //Copy directory name\n                memmove (path + k, path + j, i - j);\n                //Advance write pointer\n                k += i - j;\n\n                //Append a slash if necessary\n                if (path[i] == '/')\n                    path[k++] = '/';\n            }\n\n            //Move to the next token\n            while (path[i] == '/')\n                i++;\n            j = i;\n        }\n        else if (k == 0) {\n            while (path[i] == '.' || path[i] == '/') {\n                j++,i++;\n            }\n        }\n    } while (path[i++] != '\\0');\n\n    //Properly terminate the string with a NULL character\n    path[k] = '\\0';\n}\n\nchar * fullpath(char * path) {\n    char * buf = malloc(4096);\n    if (path[0] != '/') {\n        getcwd(buf, 4096);\n        strcat(buf, \"/\");\n        strcat(buf, path);\n        pathCanonicalize(buf);\n        return buf;\n    }\n    else {\n        strcpy(buf, path);\n        return buf;\n    }\n}\n\nchar * resolve(char * from, char * to) {\n    printf(\"resolving from \\\"%s\\\" to \\\"%s\\\"\\n\", from, to);\n    puts(\"first, convert all paths to absolute paths\");\n    from = fullpath(from);\n    to = fullpath(to);\n    ps(from);\n    ps(to);\n    puts(\"next, we attempt to convert to relative path\");\n    free(from);\n    free(to);\n    return NULL;\n}\n\nint main ( int argc, char *argv[] )\n{\n    char * to = \"./CCR/Headers/gc.h\";\n    char * from = \"./CCR/UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h\";\n    resolve(to,from);\n    resolve(from,to);\n    return 0;\n}\n</code></pre>\n\n<p>and the output:</p>\n\n<pre><code>mobile_c@Mobile-C:~/relpath$ gcc ./rel.c &amp;&amp; ./a.out\nresolving from \"./CCR/Headers/gc.h\" to \"./CCR/UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h\"\nfirst, convert all paths to absolute paths\nfrom = /home/mobile_c/relpath/CCR/Headers/gc.h\nto = /home/mobile_c/relpath/CCR/UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h\nnext, we attempt to convert to relative path\nresolving from \"./CCR/UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h\" to \"./CCR/Headers/gc.h\"\nfirst, convert all paths to absolute paths\nfrom = /home/mobile_c/relpath/CCR/UserFiles/ccr_resources/Scripts/Garbage_Collector/gc.h\nto = /home/mobile_c/relpath/CCR/Headers/gc.h\nnext, we attempt to convert to relative path\nmobile_c@Mobile-C:~/relpath$ \n</code></pre>\n"}, {"tags": ["c", "windows", "assembly", "porting"], "comments": [{"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "edited": false, "score": 3, "creation_date": 1535532110, "post_id": 52073080, "comment_id": 91095924, "body": "Take a look at <a href=\"https://msdn.microsoft.com/en-us/library/a3140177.aspx\" rel=\"nofollow noreferrer\">this piece of Microsoft Documentation</a> - Winodws has byte-swapping functions. You may also find <a href=\"https://docs.microsoft.com/en-gb/cpp/assembler/inline/asm?view=vs-2017\" rel=\"nofollow noreferrer\">this</a> helpful, it talks about <code>__asm</code> in Visual Studio."}], "answers": [{"tags": [], "owner": {"reputation": 217, "user_id": 1029462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290e269c9535090ea7a9fae42578f358?s=128&d=identicon&r=PG", "display_name": "Darkiwi", "link": "https://stackoverflow.com/users/1029462/darkiwi"}, "is_accepted": true, "score": 3, "last_activity_date": 1535535876, "creation_date": 1535535876, "answer_id": 52074356, "question_id": 52073080, "link": "https://stackoverflow.com/questions/52073080/asm-bswap-in-c-windows-code/52074356#52074356", "title": "Asm bswap in C Windows code", "body": "<p>Thanks to @Ankush, I used <code>_byteswap_ulong</code> and <code>_byteswap_uint64</code>, as documented <a href=\"https://msdn.microsoft.com/en-us/library/a3140177.aspx\" rel=\"nofollow noreferrer\">here</a>, and its seems to be working ok. Thanks!</p>\n"}], "owner": {"reputation": 217, "user_id": 1029462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290e269c9535090ea7a9fae42578f358?s=128&d=identicon&r=PG", "display_name": "Darkiwi", "link": "https://stackoverflow.com/users/1029462/darkiwi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "closed_date": 1535544663, "accepted_answer_id": 52074356, "answer_count": 1, "score": 2, "last_activity_date": 1535544671, "creation_date": 1535531942, "question_id": 52073080, "link": "https://stackoverflow.com/questions/52073080/asm-bswap-in-c-windows-code", "closed_reason": "Duplicate", "title": "Asm bswap in C Windows code", "body": "<p>I'm porting C code where there are direct <code>__asm__</code> calls from Linux to Windows. Those calls are not supported by the Visual Studio compiler so I'm looking for a Windows version of the following GCC call:</p>\n\n<p><code>__asm__(\"bswapl %0\" : \"=r\" (val) : \"0\" (val))</code></p>\n\n<p>Could someone help me? Thanks!</p>\n"}, {"tags": ["c++", "c", "architecture", "software-design", "clean-architecture"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1535532456, "post_id": 52073002, "comment_id": 91096143, "body": "I find the statement a bit strange, that inward means higher. I would say &quot;downward&quot; and to mean using only lower level building blocks. Looking at the statement in this way then a C header file can be seen as an interface provided by a lower level building block."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1535532472, "post_id": 52073002, "comment_id": 91096152, "body": "Different books might define the term <i>interface</i> differently according to what they are trying to say. Yes, <i>header files</i> are <i>interfaces</i> in what used to be referred to as <i>modular programming</i>. But are they <i>interfaces</i> according to how <i>interfaces</i> are usually defined in Object Oriented Design (for example)? No, because that defines interfaces as special types of <code>class</code>. Don&#39;t get too hung up over the word <i>interface</i> your book just seems to be discussing how interfaces should look in some arbitrary paradigm that presumably provides X, Y, Z benefits."}, {"owner": {"reputation": 132, "user_id": 4018232, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000538106506/picture?type=large", "display_name": "Ruslan R. Laishev", "link": "https://stackoverflow.com/users/4018232/ruslan-r-laishev"}, "edited": false, "score": 0, "creation_date": 1535533389, "post_id": 52073002, "comment_id": 91096715, "body": "Sure. .H - is an interface."}], "answers": [{"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1535536742, "creation_date": 1535536742, "answer_id": 52074653, "question_id": 52073002, "link": "https://stackoverflow.com/questions/52073002/can-a-c-header-file-be-considered-as-an-interface/52074653#52074653", "title": "Can a C header file be considered as an interface?", "body": "<p>In computing, an \"interface\" is a common boundary across which two or more components or subsystems exchange information. </p>\n\n<p>A header file in C or C++ is a text file that contains a set of declarations and (possibly) macros that can be inserted into a compilation unit (a separate unit of source code, such as a source file), and allow that compilation unit to use those declarations and macros.   In other words <code>#include \"headerfile\"</code> within a source file is replaced by the content of <code>headerfile</code> by the C or C++ preprocessor before subsequent compilation.</p>\n\n<p>Based on these definitions, I would not describe a header file as an interface.</p>\n\n<p>A header file may define data types, declare variables, and declare functions.  Multiple source files may include that header, and each will be able to use the data types, variables, and functions that are declared in that header.   One compilation unit may include that header, and then define some (or all) of the functions declared in the header.</p>\n\n<p>However types, variables, and functions need not be placed in a header file.   A programmer who is determined enough can manually copy declarations and macros into every source file that uses them, and never use a header file.   A C or C++ compiler cannot tell the difference - because all the preprocessor does is text substitution.    </p>\n\n<p>The logical grouping of declarations and macros is actually what represents an interface, not the means by which information about the interface is made available to compilation units.    A header file is simply one (optional) means by which a set of declarations and macros can be made available to compilation units.</p>\n\n<p>Of course, a header file is often practically used to avoid errors in using a set of declarations and macros - so can help make it easier to manage the interface represented by those declarations and macros.   Every compilation unit that <code>#include</code>s a header file receives the same content (unless affected by other preprocessor macros).   This is much less error prone than the programmer manually copying declarations into every source file that needs them.   It is also easier to maintain - editing a header file means all compilation units can be rebuilt and have visibility of the changes.   Whereas, manually updating declarations and macros into every source file can introduce errors, because programmers are error prone - for example, by editing the declarations inconsistently between source files.</p>\n"}, {"tags": [], "owner": {"reputation": 414, "user_id": 5853141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce8326b6ce3356066944f644e5c0ba0c?s=128&d=identicon&r=PG&f=1", "display_name": "Frederik De Ruyck", "link": "https://stackoverflow.com/users/5853141/frederik-de-ruyck"}, "is_accepted": false, "score": 1, "last_activity_date": 1535986863, "last_edit_date": 1535986863, "creation_date": 1535545584, "answer_id": 52077448, "question_id": 52073002, "link": "https://stackoverflow.com/questions/52073002/can-a-c-header-file-be-considered-as-an-interface/52077448#52077448", "title": "Can a C header file be considered as an interface?", "body": "<p>I think the reason why you would want an interface for a timer is indeed to break dependencies. Since the Scheduler uses the Timer, every location Scheduler.o is linked to, Timer.o must be linked to as well provided you use scheduler symbols that depend on timer symbols.</p>\n\n<p>If you would have used an interface for Timer, no linking from Scheduler.o to Timer.o (or Scheduler.so to Timer.so if you want) is required nor useful. You will create an instance of Timer at runtime, likely pass it to the constructor of Scheduler, Timer.o will be linked to elsewhere.</p>\n\n<p>Now why would that be useful? Unit testing is one example: you can pass a Timer stub class to Scheduler's ctor and link to TimerTestStub.o etc. You can see that this way of working does break dependencies. Scheduler.o does require a Timer, but which one is not a requirement at the build time level of scheduler.so but higher up. You pass the Timer instance as an argument of Scheduler's ctor.</p>\n\n<p>This is also very useful to lower the amount of build-time dependencies when using libraries. The real trouble starts when creating a dependency chain. Scheduler requires Timer, Timer requires class X, class X requires class Y, class Y requires class Z ...\nThis may look still ok to you but know that every class could be in another library.\nYou then want to use Scheduler but are forced to drag a ton of includepath settings and likely do a ton of linking.\nYou can break dependencies by only exposing the functionality of Scheduler you really need in its interface, of course you can use multiple interfaces.</p>\n\n<p>You should make your own demo, write 10 classes, put them in 10 shared libs, make sure every class requires 3 other classes out of those 10. Now include 1 of those class headers in your main.cpp and see what you need to do to get it build properly.\nNow you need to think on breaking those dependencies.</p>\n"}], "owner": {"reputation": 3238, "user_id": 405539, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/327dba4594d5ff5d6796266f39402839?s=128&d=identicon&r=PG", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/405539/ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1417, "favorite_count": 0, "closed_date": 1535545798, "answer_count": 2, "score": 3, "last_activity_date": 1535986863, "creation_date": 1535531682, "question_id": 52073002, "link": "https://stackoverflow.com/questions/52073002/can-a-c-header-file-be-considered-as-an-interface", "closed_reason": "Opinion-based", "title": "Can a C header file be considered as an interface?", "body": "<p>I am learning about architecture from Robert C. Martin's book <strong>Clean Architecture</strong>. One of the main rules emphasized through the book is the DIP rule that states <em>Source code dependencies must point only inwards, toward higher-level policies</em> . Trying to translate this in the embedded domain assume 2 components <code>scheduler</code> and <code>timer</code> . The scheduler is high-level policy which relies on the low level timer driver and needs to call the APIs <code>get_current_time()</code> and <code>set_timeout()</code> , simply I would split the module into an implementation file <code>timer.c</code> and a header(an interface?) <code>timer.h</code> and the <code>scheduler.c</code> could simply include <code>timer.h</code> to use these APIs . Reading the book portrayed the previous scenario as breaking of the dependency rule and implied that an interface between the 2 components should be implemented to break the dependency. </p>\n\n<p>To imitate that in c for example <code>timer_abstract</code> can include a generic structure with pointers to functions \n<code>struct timer_drv {\n   uint32 (*get_current_time)(void); \n   void (*set_timeout)(uint32 t);\n}</code></p>\n\n<p>This to me looks like over-design. Isn't a simple header file sufficient ? Can a C header file be considered as an interface ?</p>\n"}, {"tags": ["c", "unions"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 5, "creation_date": 1535529971, "post_id": 52072287, "comment_id": 91094588, "body": "That should really be <code>int_or_str* bogus = malloc(sizeof(int_or_str) * 43);</code>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1535530078, "post_id": 52072287, "comment_id": 91094654, "body": "This seems a bit like XY problem. It&#39;s unclear what the you mean by 3 and with last paragraph. Please expand on them. Your example &quot;works&quot; in some cases, but I am afraid that you might draw wrong conclusions from that."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1535530135, "post_id": 52072287, "comment_id": 91094681, "body": "you will probably be interested in this question : <a href=\"https://stackoverflow.com/questions/18577404/how-can-a-mixed-data-type-int-float-char-etc-be-stored-in-an-array\">How can a mixed data type (int, float, char, etc) be stored in an array?</a>"}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1535530560, "post_id": 52072287, "comment_id": 91094977, "body": "@PaulOgilvie fixed, I typed the example here, so, sorry for typos."}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1535530742, "post_id": 52072287, "comment_id": 91095091, "body": "@SanderDeDycker yeah, that would work, but it wastes memory on tags, and, in my case, often times I can tell in advance that all union members are going to be of the same time."}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1535530881, "post_id": 52072287, "comment_id": 91095184, "body": "@user694733 Essentially, I&#39;m more curious about how it works rather than having a solution to my problem (I can solve it, but in possibly less efficient way). What I really want to know is: is memory allocated per unions is aligned to some value (eg. of the largest union member), or can it be sized differently based on member&#39;s size?"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1535531239, "post_id": 52072287, "comment_id": 91095395, "body": "<code>int_or_str* bogus = malloc(sizeof(*bogus) * 43);</code> is better (if you change the type of bogus, the line is still valid). Yes, when allocation an union, the size is the size of the biggest member in the union, no matter what you use after. Your code should work, but be carefull (pointeur are not set to NULL, you can&#39;t know if the value in your union is an int or a char since you don&#39;t store that data, etc etc)."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1535532111, "post_id": 52072287, "comment_id": 91095926, "body": "based on your &quot;what I really want to know&quot; comment, this question is answered here : <a href=\"https://stackoverflow.com/questions/740577/sizeof-a-union-in-c-c\">sizeof a union in C/C++</a>"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 2, "last_activity_date": 1535531949, "creation_date": 1535531949, "answer_id": 52073083, "question_id": 52072287, "link": "https://stackoverflow.com/questions/52072287/random-access-to-members-of-array-of-unions/52073083#52073083", "title": "Random access to members of array of unions", "body": "<p>ad 1: Yes it will work.</p>\n\n<p>ad 2: yes, it is perfectly defined.</p>\n\n<p>ad 3: yes it is legal.</p>\n\n<p>The whole idea of a <code>union</code> is that it can hold different types of elements. The size of the union will be the size of the largest element in the union. On a 64 bit system, that will probably be the size of the <code>char *</code>.</p>\n\n<p>So no, the compiler will not assume that all elements are char pointers. That is why you have to use the dot nottion to tell the compile in your statement which type of element you want to access, and the compiler will generate the access.</p>\n\n<p>But as Tom said, you can't know what type of element is currently stored; there must be an external reason (information)  by which you know that. If it is important to know it, you should store the information in the data structure, for example:</p>\n\n<pre><code>typedef struct {\n    int whatisthis;\n    union {\n        int foo;\n        char *bar;\n    } u;\n} int_or_str;\n</code></pre>\n\n<p>and set it like:</p>\n\n<pre><code>int_or_str example;\nexample.whatisthis= 1;\nexample.u.foo= 1;\n\nexample.whatisthis= 2;\nexample.u.bar= \"test\";\n</code></pre>\n\n<p>and access like:</p>\n\n<pre><code>if (example.whatisthis==1) printf(\"%d\\n\", example.u.foo);\nif (example.whatisthis==2) printf(\"%s\\n\", example.u.bar);\n</code></pre>\n"}], "owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 52073083, "answer_count": 1, "score": 2, "last_activity_date": 1535531949, "creation_date": 1535529185, "last_edit_date": 1535530573, "question_id": 52072287, "link": "https://stackoverflow.com/questions/52072287/random-access-to-members-of-array-of-unions", "title": "Random access to members of array of unions", "body": "<p>Simplified example:</p>\n\n<pre><code>typedef union {\n    int foo;\n    char* bar;\n} int_or_str;\n\nvoid baz() {\n    int_or_str* bogus = malloc(sizeof(int_or_str) * 43);\n    bogus[42].bar = \"test\";\n    printf(\"%s\\n\", bogus[42].bar);\n}\n</code></pre>\n\n<ol>\n<li>Should this work, will the compiler assume all 42 members of <code>bogus</code> are char pointers? (Obviously, I could try this, but emphasis on \"should\").</li>\n<li>Is it even defined what happens when you access an array of unions in such a way?</li>\n<li>Suppose, I wanted an array of unions which actually hold differently sized values, is it legal?  (I could store a layout separately, and compute the offset, if I was sure how union members are laid out in memory).</li>\n</ol>\n\n<hr>\n\n<p>If you are wondering about motivation for this question: basically, I'm trying to come up with a solution for a run-time defined struct.  My idea was to have an array of unions to represent struct fields, plus some meta-data recording how to access those fields.</p>\n"}, {"tags": ["c", "arrays", "segmentation-fault"], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1535529250, "creation_date": 1535529250, "answer_id": 52072301, "question_id": 52072267, "link": "https://stackoverflow.com/questions/52072267/segfault-and-uninitialized-data-when-generating-a-random-array-in-c/52072301#52072301", "title": "Segfault and uninitialized data when generating a random array in C", "body": "<p>The primary problem here is, <code>array</code> is a local variable in the <code>randomArray()</code> function scope. Once the function returns, the returned address becomes <strong><em>invalid</em></strong>. Any further attempt to use the memory will lead to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Moreover, from your approach, you are trying to overwrite the allocated memory by the address being returned from the function call, which will cause memory leak. Rather, change your design, pass the allocated memory to the function as the argument and just fill the elements using the <code>rand()</code> call.</p>\n"}, {"tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": false, "score": 0, "last_activity_date": 1535529262, "creation_date": 1535529262, "answer_id": 52072306, "question_id": 52072267, "link": "https://stackoverflow.com/questions/52072267/segfault-and-uninitialized-data-when-generating-a-random-array-in-c/52072306#52072306", "title": "Segfault and uninitialized data when generating a random array in C", "body": "<pre><code>int *randomArray(void)\n{\n    int array[len] = { 0 };\n    //...\n    return array;\n }\n</code></pre>\n\n<p><code>array</code> goes out of scope at <code>}</code> and accessing this returned pointer is UB.\nMoreover <code>rArray = randomArray();</code> leaks memory since now you cannot free the malloc'd memory. You should pass the <code>rArray</code> to a function, which will be responsible for filing it.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1535529430, "post_id": 52072345, "comment_id": 91094250, "body": "True, but in this case, passing size would be redundant, as it is defined as a MACRO already. Just saying."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1535529514, "post_id": 52072345, "comment_id": 91094308, "body": "@SouravGhosh When passing a pointer to an &quot;array&quot; it&#39;s always a good habit to pass the size of it as well. The size might not always be available as a macro. :)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1535529459, "last_edit_date": 1535529459, "creation_date": 1535529360, "answer_id": 52072345, "question_id": 52072267, "link": "https://stackoverflow.com/questions/52072267/segfault-and-uninitialized-data-when-generating-a-random-array-in-c/52072345#52072345", "title": "Segfault and uninitialized data when generating a random array in C", "body": "<p>The <code>randomArray</code> return a pointer to the first element of the <strong><em>local array</em></strong> <code>array</code>.</p>\n\n<p>That pointer becomes invalid immediately once the function returns as the variable goes out of scope. Using it in any way will lead to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n\n<p>What makes it even worse is that you <em>reassign</em> the pointer <code>rArray</code>, making you lose the original memory you allocated. That means your call to <code>free</code> <em>again</em> will lead to UB.</p>\n\n<p>To solve both problems, pass the pointer and the size as arguments to the <code>randomArray</code> function:</p>\n\n<pre><code>void randomArray(int *array, int size)\n{\n    for (int i = 0; i &lt; size; ++i)\n    {\n        array[i] = rand() % size;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 10278161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/852cdd8f9c9bc3414b51d8eb5b5d0728?s=128&d=identicon&r=PG&f=1", "display_name": "Prem", "link": "https://stackoverflow.com/users/10278161/prem"}, "is_accepted": false, "score": 0, "last_activity_date": 1535529435, "creation_date": 1535529435, "answer_id": 52072361, "question_id": 52072267, "link": "https://stackoverflow.com/questions/52072267/segfault-and-uninitialized-data-when-generating-a-random-array-in-c/52072361#52072361", "title": "Segfault and uninitialized data when generating a random array in C", "body": "<p>In randomArray() function, you are returning the array that is allocated on stack.  That array will be freed when returning from randomArray() function.  Instead, you can do this:</p>\n\n<pre><code>void randomArray(int * array)\n{\n    // Remove this int array[len] = { 0 };\n    for (int i = 0; i &lt; len; i++) {\n        array[i] = rand() % len;\n    }\n    // Remove this .. return array;\n}\n</code></pre>\n\n<p>And call randomArray(rArray) from main()</p>\n"}], "owner": {"reputation": 243, "user_id": 9807062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003216fd0dc9e2efba50b25da4f35c16?s=128&d=identicon&r=PG&f=1", "display_name": "Platon Makovsky", "link": "https://stackoverflow.com/users/9807062/platon-makovsky"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "closed_date": 1535570331, "accepted_answer_id": 52072301, "answer_count": 4, "score": -3, "last_activity_date": 1535570346, "creation_date": 1535529111, "last_edit_date": 1535529636, "question_id": 52072267, "link": "https://stackoverflow.com/questions/52072267/segfault-and-uninitialized-data-when-generating-a-random-array-in-c", "closed_reason": "Duplicate", "title": "Segfault and uninitialized data when generating a random array in C", "body": "<pre><code>#include \"stdafx.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#define len 10\n\nint *randomArray(void);\n\nint main()\n{\n    srand(time(NULL));\n    int *rArray = (int *)malloc(sizeof(int) * len);\n    rArray = randomArray();\n    for (int i = 0; i &lt; len; i++) {\n        printf(\"%d \", *(rArray+i));\n    }\n    puts(\"\");\n    free(rArray);\n}\n\nint *randomArray(void)\n{\n    int array[len] = { 0 };\n    for (int i = 0; i &lt; len; i++) {\n        array[i] = rand() % len;\n    }\n    return array;\n}\n</code></pre>\n\n<p>Task is to create an array of <code>int</code>s and have a function fill that array with random numbers. The function <code>randomArray()</code> works just fine, but for some reason the assignment <code>rArray = randomArray()</code> doesn't work correctly, although some elements of <code>rArray</code> are valid numbers not gibberish. Also, the last main line <code>free(rArray);</code> crashes the program which is just mind numbing for me, it doesn't make any sense. If I remove the line the program doesn't crash but we all know you need to <code>free()</code> a <code>malloc()</code>-ed array. </p>\n"}, {"tags": ["c", "gcc", "assembly", "gdb", "disassembly"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1535528737, "post_id": 52072013, "comment_id": 91093846, "body": "Because the code has not been <i>linked</i>, the destination address for the call is just <code>00 00 00 00</code>. The linker will patch this when you link your executable."}], "answers": [{"tags": [], "owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "is_accepted": true, "score": 3, "last_activity_date": 1535529502, "last_edit_date": 1535529502, "creation_date": 1535529191, "answer_id": 52072289, "question_id": 52072013, "link": "https://stackoverflow.com/questions/52072013/gcc-objdump-assembly-debugging/52072289#52072289", "title": "gcc objdump assembly debugging", "body": "<p>When you run the <code>objdump</code> command you are not disassembling the final executable, you are disassembling the object file produced by the compiler (<code>test.o</code>). I performed similar steps (using your code) to you (compiling and running <code>objdump</code> and <code>dissas</code> in GDB) except I performed the <code>objdump</code> on the linked executable <em>not</em> on the object file (this means I did not compile with the <code>-c</code> flag). The outputs are below:</p>\n\n<pre><code>objdump -dS a.out:\n1140:       55                      push   %rbp\n1141:       48 89 e5                mov    %rsp,%rbp\n1144:       48 83 ec 10             sub    $0x10,%rsp\n1148:       48 8d 3d b5 0e 00 00    lea    0xeb5(%rip),%rdi        # 2004 &lt;_IO_stdin_used+0x4&gt;\n114f:       c7 45 fc 00 00 00 00    movl   $0x0,-0x4(%rbp)\n1156:       b0 00                   mov    $0x0,%al\n1158:       e8 d3 fe ff ff          callq  1030 &lt;printf@plt&gt;\n115d:       31 c9                   xor    %ecx,%ecx\n115f:       89 45 f8                mov    %eax,-0x8(%rbp)\n1162:       89 c8                   mov    %ecx,%eax\n1164:       48 83 c4 10             add    $0x10,%rsp\n1168:       5d                      pop    %rbp\n1169:       c3                      retq   \n116a:       66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1)\n</code></pre>\n\n<p>GDB:</p>\n\n<pre><code>(gdb) disas main\nDump of assembler code for function main:\n   0x0000000000001140 &lt;+0&gt;:     push   %rbp\n   0x0000000000001141 &lt;+1&gt;:     mov    %rsp,%rbp\n   0x0000000000001144 &lt;+4&gt;:     sub    $0x10,%rsp\n   0x0000000000001148 &lt;+8&gt;:     lea    0xeb5(%rip),%rdi        # 0x2004\n   0x000000000000114f &lt;+15&gt;:    movl   $0x0,-0x4(%rbp)\n   0x0000000000001156 &lt;+22&gt;:    mov    $0x0,%al\n   0x0000000000001158 &lt;+24&gt;:    callq  0x1030 &lt;printf@plt&gt;\n   0x000000000000115d &lt;+29&gt;:    xor    %ecx,%ecx\n   0x000000000000115f &lt;+31&gt;:    mov    %eax,-0x8(%rbp)\n   0x0000000000001162 &lt;+34&gt;:    mov    %ecx,%eax\n   0x0000000000001164 &lt;+36&gt;:    add    $0x10,%rsp\n   0x0000000000001168 &lt;+40&gt;:    pop    %rbp\n   0x0000000000001169 &lt;+41&gt;:    retq   \nEnd of assembler dump.\n</code></pre>\n\n<p>As you can see, the two disassemblies are the same, except for some minor syntax differences (e.g. GDB prefixes it's addresses with <code>0x</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 32308, "user_id": 20270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37335856df5e5e73d82bca5a805bd647?s=128&d=identicon&r=PG", "display_name": "Hasturkun", "link": "https://stackoverflow.com/users/20270/hasturkun"}, "is_accepted": false, "score": 2, "last_activity_date": 1535535462, "creation_date": 1535535462, "answer_id": 52074229, "question_id": 52072013, "link": "https://stackoverflow.com/questions/52072013/gcc-objdump-assembly-debugging/52074229#52074229", "title": "gcc objdump assembly debugging", "body": "<p>What you're missing with <code>objdump</code> by default is relocations.</p>\n\n<p>Running <code>objdump</code> with the <code>-r</code> flag lets you see these. e.g.</p>\n\n<pre><code>objdump -Sr foo.o\n\nfoo.o:     file format elf64-x86-64\n\n\nDisassembly of section .text:\n\n0000000000000000 &lt;main&gt;:\n   0:   55                      push   %rbp\n   1:   48 89 e5                mov    %rsp,%rbp\n   4:   bf 00 00 00 00          mov    $0x0,%edi\n            5: R_X86_64_32  .rodata\n   9:   e8 00 00 00 00          callq  e &lt;main+0xe&gt;\n            a: R_X86_64_PC32    puts-0x4\n   e:   b8 00 00 00 00          mov    $0x0,%eax\n  13:   5d                      pop    %rbp\n  14:   c3                      retq   \n</code></pre>\n\n<p>Shows us that the call will use a PC relative address, pointing to <code>puts</code></p>\n"}], "owner": {"reputation": 33, "user_id": 7700612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb7f94474fb1f5d889d72e5660d97193?s=128&d=identicon&r=PG&f=1", "display_name": "0 joon", "link": "https://stackoverflow.com/users/7700612/0-joon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7257, "favorite_count": 1, "accepted_answer_id": 52072289, "answer_count": 2, "score": 3, "last_activity_date": 1535535462, "creation_date": 1535528302, "question_id": 52072013, "link": "https://stackoverflow.com/questions/52072013/gcc-objdump-assembly-debugging", "title": "gcc objdump assembly debugging", "body": "<p>I'm trying to change C code to assembly code.</p>\n\n<p>At first, i used gcc and objdump function to extract assembly code from c code.</p>\n\n<p>The C code was just simple printf code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    printf(\"this\\n\");\n    return 0;\n}\n\n\ngcc -c -S -O0 test.c\nobjdump -dS test.o &gt; test.txt\n\n0000000000000000 &lt;main&gt;:\n   0:   55                      push   %rbp\n   1:   48 89 e5                mov    %rsp,%rbp\n   4:   bf 00 00 00 00          mov    $0x0,%edi\n   9:   e8 00 00 00 00          callq  e &lt;main+0xe&gt;\n   e:   b8 00 00 00 00          mov    $0x0,%eax\n  13:   5d                      pop    %rbp \n  14:   c3                      retq \n</code></pre>\n\n<p>in this assembly code, \ni was curious why callq instructions destination is e </p>\n\n<p>so i run this code in gdb using </p>\n\n<p>disas main</p>\n\n<pre><code>    (gdb) disas main\nDump of assembler code for function main:\n   0x0000000000400526 &lt;+0&gt;: push   %rbp\n   0x0000000000400527 &lt;+1&gt;: mov    %rsp,%rbp\n   0x000000000040052a &lt;+4&gt;: mov    $0x4005c4,%edi\n   0x000000000040052f &lt;+9&gt;: callq  0x400400 &lt;puts@plt&gt;\n   0x0000000000400534 &lt;+14&gt;: mov    $0x0,%eax\n   0x0000000000400539 &lt;+19&gt;: pop    %rbp\n   0x000000000040053a &lt;+20&gt;: retq \n</code></pre>\n\n<p>in this code, i assumed that 0x400400 is the address of printf function.</p>\n\n<p>Why does objdump and gdb's assembly code show different result?</p>\n\n<p>How can i make objdump result shows the right callq destination?</p>\n"}, {"tags": ["c", "pointers", "memory", "segmentation-fault"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 7, "creation_date": 1535527598, "post_id": 52071756, "comment_id": 91093169, "body": "&quot;How can I write to read-only memory?&quot; - Uh ... you can&#39;t. <b>That&#39;s the point!</b>"}], "answers": [{"comments": [{"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "edited": false, "score": 3, "creation_date": 1535527848, "post_id": 52071819, "comment_id": 91093328, "body": "Note that the string should be <code>free()</code>&#39;ed why it is no longer needed to avoid memory leaks."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 4, "creation_date": 1535530308, "post_id": 52071819, "comment_id": 91094789, "body": "Note that <code>strdup()</code> is a POSIX function, commonly available, but not part of the official C Standard. Some users may need to <a href=\"http://man7.org/linux/man-pages/man3/strdup.3.html\" rel=\"nofollow noreferrer\">enable <code>strdup()</code> with a feature test macro</a>, and others may need to write their own function."}], "tags": [], "owner": {"reputation": 387, "user_id": 10263994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/983e9b8d00cbbecacd2f3da19be600fa?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis.F", "link": "https://stackoverflow.com/users/10263994/yanis-f"}, "is_accepted": false, "score": 3, "last_activity_date": 1535528647, "last_edit_date": 1535528647, "creation_date": 1535527686, "answer_id": 52071819, "question_id": 52071756, "link": "https://stackoverflow.com/questions/52071756/how-to-write-to-a-pointer-in-read-only-memory-in-c/52071819#52071819", "title": "How to write to a pointer in read only memory in C", "body": "<p>You can't <strong>write</strong> in a <strong>read-only</strong> memory, but you can always store you string in the heap ( <strong>not readonly</strong> memory )<br>\nThis is the way I would go :</p>\n\n<blockquote>\n  <p>e = trim(strdup(\"hello  \"));</p>\n</blockquote>\n\n<p>It will copy the readonly string to a writable memory</p>\n\n<hr>\n\n<p>EDIT: @Ankush pointed out the fact that the string is allocated, thus it will have to be <strong>freed</strong></p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1535528924, "last_edit_date": 1535528924, "creation_date": 1535528034, "answer_id": 52071939, "question_id": 52071756, "link": "https://stackoverflow.com/questions/52071756/how-to-write-to-a-pointer-in-read-only-memory-in-c/52071939#52071939", "title": "How to write to a pointer in read only memory in C", "body": "<p>Since <strong>read-only</strong> memory is READ ONLY, you can use a <code>char</code> array instead of a string constant as an argument to <code>trim</code>.</p>\n\n<pre><code>char f[] = \"Hello  \";\ne = trim(f);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 10093131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c6dbab030b10326f16c5a6459919d4?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/10093131/new-learner"}, "is_accepted": false, "score": 1, "last_activity_date": 1535535064, "creation_date": 1535535064, "answer_id": 52074096, "question_id": 52071756, "link": "https://stackoverflow.com/questions/52071756/how-to-write-to-a-pointer-in-read-only-memory-in-c/52074096#52074096", "title": "How to write to a pointer in read only memory in C", "body": "<p>Pointer is not stored into the code memory , it depends on which \ntype_qualifiers you are using to declare the pointer .</p>\n\n<pre><code>1 . char *ptr = \"Stack overflow\" ;\n</code></pre>\n\n<p>Now the ptr is stored into the stack memory and pointing towards the \ncode memory , pointing in the sence it is storing the address of code memory .</p>\n\n<pre><code>2 . char *ptr = malloc(15);\n    strcpy(ptr,\"stack overflow\");\n</code></pre>\n\n<p>Now also your pointer is stored in the stack memory and pointing towards the\n heap section(which is nothing but a extended data memory).</p>\n\n<pre><code>3 . char arr[15] , *ptr;\n    strcpy(arr,\"Stack overflow\");\n    ptr = arr ;\n</code></pre>\n\n<p>Now your pointer is stored into the stack and also pointing towards \nthe array which is also stored into the stack section .</p>\n\n<p>in case 1 , user is not allow to modify the string because the pointer is pointing to the code memory , but whereas in case 2 and case 3 ,\npointer can modify the string .</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 8883176, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/jI9Cv.jpg?s=128&g=1", "display_name": "mehrdad", "link": "https://stackoverflow.com/users/8883176/mehrdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1535553715, "creation_date": 1535553715, "answer_id": 52080243, "question_id": 52071756, "link": "https://stackoverflow.com/questions/52071756/how-to-write-to-a-pointer-in-read-only-memory-in-c/52080243#52080243", "title": "How to write to a pointer in read only memory in C", "body": "<p>in general string literals are stored in a read-only section (it depends on platform).\nThe C standard says that <strong>string literals have static storage duration</strong>, any attempt at modifying them gives <strong>undefined behavior</strong> , so <strong>NEVER</strong> attempt to modify string literals!</p>\n\n<p>but you can do the followigs:</p>\n\n<p>1 - initialize char array from string literal :</p>\n\n<pre><code>char ch_array[256] = \"hello \";\n</code></pre>\n\n<p>2 - dynamically allocate memory for string:</p>\n\n<pre><code>    char* str = malloc(sizeof(char) * 256);\n    strcpy(str, \"hello \");\n\n    .\n    .\n    .\n    free(str);\n</code></pre>\n\n<p>3 - or use strdup() function( Keeping in mind it's actually not part of the ISO C standard itself, it's POSIX)</p>\n"}], "owner": {"reputation": 9, "user_id": 8333297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U-LqtuqZTpo/AAAAAAAAAAI/AAAAAAAAKso/-Ps4Yz1urQc/photo.jpg?sz=128", "display_name": "Navaneeth", "link": "https://stackoverflow.com/users/8333297/navaneeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1535553715, "creation_date": 1535527506, "question_id": 52071756, "link": "https://stackoverflow.com/questions/52071756/how-to-write-to-a-pointer-in-read-only-memory-in-c", "title": "How to write to a pointer in read only memory in C", "body": "<p>I'm trying to write a particular character to the middle of a string pointed to by another pointer so that I can truncate the string. My program tries to eliminate leading/trailing spaces from the input. Since the pointer gets stored into read only memory, how can I go around it and add a '/0' character in between. Following is my code and i get a segmentation error at line 22 because of the afore mentioned problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;ctype.h&gt;\n\nchar *trim(char *s)\n{\n    while(isspace(*s))\n        s++;\n    char *end = s + strlen(s) - 1;\n    while(end&gt;=s &amp;&amp; isspace(*end))\n    {\n        end--;\n    }\n    *(end + 1) = '\\0'; //Line causing segmentation fault\n    return s;\n\n}\n\nint main()\n{\n    char *e = NULL;\n    e = trim(\"hello  \");\n    printf(\"%s\", e);\n    printf(\"hi\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1535525022, "post_id": 52071064, "comment_id": 91091741, "body": "The <code>%d</code> part is <i>undefined behavior</i> - your result cannot be a <code>double</code> and an <code>int</code> at the same time"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1535525594, "post_id": 52071107, "comment_id": 91092026, "body": "Good explanation, you could also add why the second result is casted as double and not as Integer in the OP`s question"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1535526561, "post_id": 52071107, "comment_id": 91092589, "body": "@Alan : I&#39;m unsure what you mean. The third parameter <i>is</i> a <code>double</code> (due to the <a href=\"https://en.cppreference.com/w/c/language/conversion\" rel=\"nofollow noreferrer\">usual arithmetic conversions</a>), just like the second parameter (it is the same expression after all)."}, {"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1535526712, "post_id": 52071107, "comment_id": 91092687, "body": "My question was, as you cast the second result to (double) (int) what`s the precedence, why does It get casted double and not int"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1535526947, "post_id": 52071107, "comment_id": 91092812, "body": "@Alan : you should really ask your own question for that, but simply put : <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">type casts are right-to-left associative</a>"}, {"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1535527164, "post_id": 52071107, "comment_id": 91092929, "body": "Got it thanks Sander!"}], "tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": false, "score": 2, "last_activity_date": 1535525476, "last_edit_date": 1535525476, "creation_date": 1535525160, "answer_id": 52071107, "question_id": 52071064, "link": "https://stackoverflow.com/questions/52071064/c-printf-lf-d-different-result/52071107#52071107", "title": "c printf %lf %d different result", "body": "<p>Refer to the <a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>printf</code></a> reference to find that the <code>\"%d\"</code> format specifier expects an <code>int</code> as parameter. Yet, you pass it a <code>double</code>. This is <a href=\"https://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\">undefined behavior</a>, meaning anything can happen, including the result you get (for more details on what's likely happening, refer to eg. <a href=\"https://stackoverflow.com/questions/7480097/what-happens-to-a-float-variable-when-d-is-used-in-a-printf\">What happens to a float variable when %d is used in a printf?</a>).</p>\n\n<p>Instead, try adding a cast to <code>int</code> :</p>\n\n<pre><code>printf(\"result1 : %lf %d\\n\", (1 - (double)((int)1)), (int) (1 - (double)((int)1)));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "is_accepted": false, "score": 1, "last_activity_date": 1535525965, "last_edit_date": 1535525965, "creation_date": 1535525294, "answer_id": 52071137, "question_id": 52071064, "link": "https://stackoverflow.com/questions/52071064/c-printf-lf-d-different-result/52071137#52071137", "title": "c printf %lf %d different result", "body": "<p>The type of the arguments passed to <code>printf</code> have nothing inherently to do with the format string. It is your responsibility to make sure the types match up. In this case, you are passing two <code>double</code> values. However, the format string is attempting to interpret the second one as an integer. This is undefined behavior.</p>\n\n<p>While the behavior is undefined in the general case, it is likely that you are seeing the sign bit of the IEEE 754 double in a little-endian interpretation of an integer.</p>\n"}], "owner": {"reputation": 35, "user_id": 9526026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\ucd5c\uc6b0\uc601", "link": "https://stackoverflow.com/users/9526026/%ec%b5%9c%ec%9a%b0%ec%98%81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "closed_date": 1535550039, "answer_count": 2, "score": -1, "last_activity_date": 1535525965, "creation_date": 1535524975, "question_id": 52071064, "link": "https://stackoverflow.com/questions/52071064/c-printf-lf-d-different-result", "closed_reason": "Not suitable for this site", "title": "c printf %lf %d different result", "body": "<h3>MyCode</h3>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n  printf(\"result1 : %lf %d\\n\", (1 - (double)((int)1)), (1 - (double)((int)1)));\n  return 1;\n}\n</code></pre>\n\n<h3>Result</h3>\n\n<pre><code>result1 : 0.000000, 1\n</code></pre>\n\n<p>I dont't understand this result.</p>\n\n<h3>I think when printf(\"%d\"), this result must be zero!</h3>\n"}, {"tags": ["c", "pointers", "function-pointers", "void-pointers", "typecasting-operator"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1535524447, "post_id": 52070882, "comment_id": 91091464, "body": "Why would you store function pointers in an array of pointers to void? <b>Especially</b> if you are going to try to call them."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1535524784, "post_id": 52070882, "comment_id": 91091624, "body": "Well idk, maybe this isn&#39;t the way to do this, but i was thinking if you had functions with different return types and/or that take different arguments.. you could store them all in 1 array."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1535524833, "post_id": 52070882, "comment_id": 91091647, "body": "refer to <a href=\"https://stackoverflow.com/questions/26917194/can-void-be-used-to-store-function-pointers\">can void* be used to store function pointers?</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1535525061, "post_id": 52070882, "comment_id": 91091766, "body": "How would you meaningfully call a function if you do not know its return type?"}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1535525243, "post_id": 52070924, "comment_id": 91091848, "body": "Thanks for the answers and useful tips Some programmer dude, @Lundin. It works now, at least on my system.. but will definitely be taking the portability issue into consideration and change it."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 5, "last_activity_date": 1535524426, "creation_date": 1535524426, "answer_id": 52070924, "question_id": 52070882, "link": "https://stackoverflow.com/questions/52070882/c-how-to-access-a-function-pointer-stored-in-a-void-pointer-void/52070924#52070924", "title": "C: How to access a function pointer stored in a void pointer (void *)?", "body": "<p>It's a matter of <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"noreferrer\"><em>operator precedence</em></a>: The function call operator have higher precedence than the casting operator.</p>\n\n<p>That means your expression <code>(int (*)(int)) functions[0](x)</code> is really equal to <code>(int (*)(int)) (functions[0](x))</code>.</p>\n\n<p>You need to explicitly add parentheses in the correct places to cast the pointer: <code>((int (*)(int)) functions[0])(x)</code>.</p>\n\n<hr>\n\n<p>A much better solution IMO would be to have an array of pointers <em>to functions</em>, so the array elements already is of the correct type:</p>\n\n<pre><code>typedef int (*function_ptr)(int);\n\nfunction_ptr functions[] = { ... };\n</code></pre>\n\n<p>Then no casting is needed: <code>functions[0](x)</code>.</p>\n\n<p>Then you also would be safe from the issues mentioned in <a href=\"https://stackoverflow.com/a/52070955/440558\">the answer by Lundin</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "edited": false, "score": 0, "creation_date": 1535536989, "post_id": 52070955, "comment_id": 91099014, "body": "Got it... and as for &#39;converting to/from different function pointers&#39; that would be done in the manner that you&#39;ve explained <a href=\"https://stackoverflow.com/a/52073459/9302544\">here</a>. Thanks!"}, {"owner": {"reputation": 320, "user_id": 4794536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2653257b7af136b0627b2b588931c4e0?s=128&d=identicon&r=PG", "display_name": "thysultan", "link": "https://stackoverflow.com/users/4794536/thysultan"}, "edited": false, "score": 0, "creation_date": 1589777989, "post_id": 52070955, "comment_id": 109417522, "body": "Is the opposite safe? Converting from function pointer to void* pointer?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 320, "user_id": 4794536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2653257b7af136b0627b2b588931c4e0?s=128&d=identicon&r=PG", "display_name": "thysultan", "link": "https://stackoverflow.com/users/4794536/thysultan"}, "edited": false, "score": 0, "creation_date": 1589786831, "post_id": 52070955, "comment_id": 109420570, "body": "@thysultan &quot;Between&quot; means that both ways are invalid. If X is not compatible with Y, then Y is not compatible with X."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 8, "last_activity_date": 1535524558, "creation_date": 1535524558, "answer_id": 52070955, "question_id": 52070882, "link": "https://stackoverflow.com/questions/52070882/c-how-to-access-a-function-pointer-stored-in-a-void-pointer-void/52070955#52070955", "title": "C: How to access a function pointer stored in a void pointer (void *)?", "body": "<p>Strictly speaking, you can't. A conversion between a function pointer and a <code>void</code> pointer is not possible. <code>void*</code> was never a generic pointer type for function pointers, only for object pointers. They are not compatible types.</p>\n\n<p>In practice, any pointer will very likely have the size required by the address bus of the system, so object pointers and function pointers will very likely have the same representation. Not guaranteed by the standard though, and there are some exotic systems where this equivalence doesn't hold true. So you can cast between <code>void*</code> and a function pointer, but what will happen is undefined behavior. You will be relying on system-specific non-standard extensions.</p>\n\n<p>Slightly better would be to use a function pointer type such as <code>void (*)(void)</code> as the generic pointer. You can convert to/from different function pointers, what will happen is compiler-specific (implementation-defined behavior). That is, the code will still be non-portable, but at least you don't risk a program crash from invoking undefined behavior.</p>\n"}], "owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 52070924, "answer_count": 2, "score": 0, "last_activity_date": 1535524558, "creation_date": 1535524272, "question_id": 52070882, "link": "https://stackoverflow.com/questions/52070882/c-how-to-access-a-function-pointer-stored-in-a-void-pointer-void", "title": "C: How to access a function pointer stored in a void pointer (void *)?", "body": "<p>Confused as to how one can access a function pointer stored in a void pointer (void *).</p>\n\n<hr>\n\n<p>Let's say you have this:</p>\n\n<pre><code>void *functions[] =\n{\n    &amp;sqrt,         // int ft_sqrt(int nb);\n    &amp;power,\n    &amp;logN,\n    &amp;factorial;\n};\n\n// An array of void pointers, each storing a function pointer.\n</code></pre>\n\n<hr>\n\n<p>If I wanted to access the <code>sqrt</code> function, my guess would be the following:</p>\n\n<p><code>(int (*)(int)) functions[0](x)</code></p>\n\n<p>But my guess is wrong:</p>\n\n<p><code>error: called object type 'void *' is not a function or function pointer</code> </p>\n\n<hr>\n\n<p>So how would one access one of these functions ?</p>\n"}, {"tags": ["c", "linux", "centos", "valgrind"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1535523034, "post_id": 52070477, "comment_id": 91090807, "body": "While it works for you in this case, there&#39;s a logical flaw in your code when printing the error. The value of <code>errno</code> is only valid directly after the failed function call. If you call any other function the value of <code>errno</code> becomes undefined. Since you call <code>printf</code> before you call <code>perror</code> the value of <code>errno</code> thus becomes undefined."}, {"owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1535523506, "post_id": 52070477, "comment_id": 91091034, "body": "some edits to remove the perror/errno behavior stuff"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1535523641, "post_id": 52070477, "comment_id": 91091091, "body": "Is it possible that you and the kernel, or you and valgrind, disagree on the size of the <code>rlimit</code> structure?"}, {"owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 0, "creation_date": 1535523831, "post_id": 52070477, "comment_id": 91091176, "body": "so If I recompile everything ( Valgrind and this program here ) on the same box that should negate any size mismatch ( if any ) right ?"}, {"owner": {"reputation": 6731, "user_id": 725163, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Kgxeq.jpg?s=128&g=1", "display_name": "e.dan", "link": "https://stackoverflow.com/users/725163/e-dan"}, "edited": false, "score": 3, "creation_date": 1535524602, "post_id": 52070477, "comment_id": 91091523, "body": "This might help: <a href=\"https://sourceforge.net/p/valgrind/mailman/message/32904445/\" rel=\"nofollow noreferrer\">sourceforge.net/p/valgrind/mailman/message/32904445</a>"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 3, "creation_date": 1535526927, "post_id": 52070477, "comment_id": 91092806, "body": "You cannot increase the limit beyond the hard limit. Perhaps Valgrind has already set the hard limit to a lower value. Retrieve the current limit and find out!"}, {"owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 0, "creation_date": 1535531438, "post_id": 52070477, "comment_id": 91095523, "body": "I&#39;ve added few more details to question, not much improvement yet"}, {"owner": {"reputation": 12424, "user_id": 33204, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6fMZI.png?s=128&g=1", "display_name": "slm", "link": "https://stackoverflow.com/users/33204/slm"}, "edited": false, "score": 0, "creation_date": 1535547190, "post_id": 52070477, "comment_id": 91105675, "body": "Looking through the limitations of valgrind I noticed this prop. RLIMIT_DATA - <a href=\"http://valgrind.org/docs/manual/manual-core.html\" rel=\"nofollow noreferrer\">valgrind.org/docs/manual/manual-core.html</a>. It&#39;s unclear if this has anything to do w/ rlimits."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1535562323, "post_id": 52070477, "comment_id": 91115716, "body": "This may be relevant <a href=\"https://github.com/memcached/memcached/issues/420\" rel=\"nofollow noreferrer\">github.com/memcached/memcached/issues/420</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3079, "user_id": 3035584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3f84eebae0cfccb50e3be86dad24f1?s=128&d=identicon&r=PG&f=1", "display_name": "phd", "link": "https://stackoverflow.com/users/3035584/phd"}, "is_accepted": false, "score": 3, "last_activity_date": 1535577995, "creation_date": 1535577995, "answer_id": 52086289, "question_id": 52070477, "link": "https://stackoverflow.com/questions/52070477/setrlimit-fails-with-operation-not-permitted-when-run-under-valgrind/52086289#52086289", "title": "setrlimit fails with Operation not permitted when run under valgrind", "body": "<p>Of the allowed range of fd 0 .. hard_limit,\nvalgrind reserves a set of fd for its own purposes at the end of the range\ni.e.  the range hard_limit - 11 .. hard_limit,\nand then simulates a new hard limit which is hard_limit - 12.</p>\n\n<p>It then forbids the guest application to change this (simulated) hard limit.\nHere is the piece of code that handles the setrlimit simulation:</p>\n\n<pre><code> if (((struct vki_rlimit *)(Addr)ARG2)-&gt;rlim_cur &gt; VG_(fd_hard_limit) ||\n      ((struct vki_rlimit *)(Addr)ARG2)-&gt;rlim_max != VG_(fd_hard_limit)) {\n     SET_STATUS_Failure( VKI_EPERM );\n  }\n</code></pre>\n\n<p>As you can see, if the provided rlim_max is different of the simulated VG_(fd_hard_limit), valgrind makes the setrlimit fails.\nWhen accepted, valgrind will change the simulated soft limit.</p>\n\n<p>I am not too sure to understand why the above code does not\naccept a lower hard limit and set it into the simulated VG_(fd_hard_limit).\nI think it is because this (not changeable) VG_(fd_hard_limit) is used\nby valgrind to find the difference between the valgrind reserved fds and\nthe guest fds.</p>\n\n<p>To bypass the problem, you should get the limit, and then only change\nthe soft limit below the hard limit as changing the hard limit will\nbe rejected by the valgrind setrlimit simulation.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "is_accepted": false, "score": 0, "last_activity_date": 1538337521, "creation_date": 1538337521, "answer_id": 52581624, "question_id": 52070477, "link": "https://stackoverflow.com/questions/52070477/setrlimit-fails-with-operation-not-permitted-when-run-under-valgrind/52581624#52581624", "title": "setrlimit fails with Operation not permitted when run under valgrind", "body": "<p>It seems that this is one of the limitations of Valgrind, namely a limitation of <code>setrlimit</code> for hard limit when run under Valgrind. See in <a href=\"http://valgrind.org/docs/manual/dist.news.old.html\" rel=\"nofollow noreferrer\">news for release 2.1.2</a>:</p>\n\n<blockquote>\n  <ul>\n  <li>Implement an emulated soft limit for file descriptors in addition\n  to   the current reserved area, which effectively acts as a hard\n  limit. The   setrlimit system call now simply updates the emulated\n  limits as best   as possible - the hard limit is not allowed to move\n  at all and just   returns EPERM if you try and change it.  This should\n  stop reductions   in the soft limit causing assertions when valgrind\n  tries to allocate   descriptors from the reserved area.   (This\n  actually came from bug #83998).</li>\n  </ul>\n</blockquote>\n\n<p>Note that you are not the only one who hit this Valgrind limitation, see this <a href=\"https://github.com/memcached/memcached/issues/420\" rel=\"nofollow noreferrer\">github issue</a> for example.</p>\n"}], "owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4825, "favorite_count": 2, "answer_count": 2, "score": 15, "last_activity_date": 1538337521, "creation_date": 1535522682, "last_edit_date": 1535547519, "question_id": 52070477, "link": "https://stackoverflow.com/questions/52070477/setrlimit-fails-with-operation-not-permitted-when-run-under-valgrind", "title": "setrlimit fails with Operation not permitted when run under valgrind", "body": "<p>I may be missing something or may be not but the <code>setrlimit</code> function is failing consistently when run under valgrind</p>\n\n<pre><code>int main()\n{\n        const struct rlimit file_limits = { .rlim_cur = 65536, .rlim_max = 65536 };\n        if ( setrlimit( RLIMIT_NOFILE, &amp;file_limits ) )\n        {\n                printf(\" Failed  %d\", errno );\n                perror(\" More \" );\n        }\n        else\n        {\n                printf(\" Success \");\n        }\n        printf(\"\\n\");\n        return 0;\n}\n</code></pre>\n\n<h3>Here are the sample runs</h3>\n\n<p>Normal run</p>\n\n<pre><code>sh-4.2# ulimit -H -n\n800000\nsh-4.2# ulimit -S -n\n500000\nsh-4.2# ./rlimit\n Success\nsh-4.2#\n</code></pre>\n\n<p>under valgrind</p>\n\n<pre><code>sh-4.2#\nsh-4.2# valgrind ./rlimit\n==28974== Memcheck, a memory error detector\n==28974== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==28974== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==28974== Command: ./rlimit\n==28974==\n More : Operation not permitted\n Failed  1\n==28974==\n==28974== HEAP SUMMARY:\n==28974==     in use at exit: 0 bytes in 0 blocks\n==28974==   total heap usage: 1 allocs, 1 frees, 568 bytes allocated\n==28974==\n==28974== All heap blocks were freed -- no leaks are possible\n==28974==\n==28974== For counts of detected and suppressed errors, rerun with: -v\n==28974== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\nsh-4.2#\n</code></pre>\n\n<p>Any hints on this would be great. <strong>NOTE:</strong> this is on CentOS release 7.4 (Final).</p>\n\n<h3>Edits #1</h3>\n\n<p>With minimal working code:</p>\n\n<pre><code>int main()\n{\n        const struct rlimit file_limits = { .rlim_cur = 65536, .rlim_max = 65536 };\n        setrlimit( RLIMIT_NOFILE, &amp;file_limits ) ;\n        perror(\" wrong ?? \" );\n        printf(\"\\n\");\n        return 0;\n}\n</code></pre>\n\n<p>corresponding outputs:</p>\n\n<pre><code>[root@localhost kk]# valgrind ./rlimit\n==29179== Memcheck, a memory error detector\n==29179== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==29179== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==29179== Command: ./rlimit\n==29179==\n wrong ?? : Operation not permitted\n\n==29179==\n==29179== HEAP SUMMARY:\n==29179==     in use at exit: 0 bytes in 0 blocks\n==29179==   total heap usage: 1 allocs, 1 frees, 568 bytes allocated\n==29179==\n==29179== All heap blocks were freed -- no leaks are possible\n==29179==\n==29179== For counts of detected and suppressed errors, rerun with: -v\n==29179== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n[root@localhost kk]# ./rlimit\n wrong ?? : Success\n</code></pre>\n\n<p>this <strong>wrong ?? : Operation not permitted</strong> is driving me crazy :(</p>\n\n<h3>Edit #2</h3>\n\n<p>So based on some suggestion I tried to retrieve existing limits and see if there is something wrong with that, turns out the behavior beyond my comprehension</p>\n\n<pre><code>int main()\n{\n        const struct rlimit file_limits = { .rlim_cur = 65536, .rlim_max = 65536 };\n        struct rlimit limit;\n        getrlimit(RLIMIT_NOFILE,&amp;limit);\n        printf(\"%d \\n\",limit.rlim_max);\n\n        setrlimit( RLIMIT_NOFILE, &amp;file_limits ) ;\n        perror(\" wrong ?? \" );\n        printf(\"\\n\");\n\n        getrlimit(RLIMIT_NOFILE,&amp;limit);\n        printf(\"%d \\n\",limit.rlim_max);\n        return 0;\n}\n</code></pre>\n\n<p>1st run, the limit is set to 65590 and the executable is able to alter the limits to 65536, viz is expected</p>\n\n<pre><code>[root@localhost kk]# ulimit -n\n65590\n[root@localhost kk]# ./rlimit\n65590\n wrong ?? : Success\n\n65536\n[root@localhost kk]#\n</code></pre>\n\n<p>2nd run, under valgrind</p>\n\n<pre><code>[root@localhost kk]# ulimit -n\n65590\n[root@localhost kk]# valgrind ./rlimit\n==17595== Memcheck, a memory error detector\n==17595== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==17595== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==17595== Command: ./rlimit\n==17595==\n65578\n wrong ?? : Operation not permitted\n\n65578\n==17595==\n==17595== HEAP SUMMARY:\n==17595==     in use at exit: 0 bytes in 0 blocks\n==17595==   total heap usage: 1 allocs, 1 frees, 568 bytes allocated\n==17595==\n==17595== All heap blocks were freed -- no leaks are possible\n==17595==\n==17595== For counts of detected and suppressed errors, rerun with: -v\n==17595== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n[root@localhost kk]#\n</code></pre>\n\n<p>I'm probably inclined to say that may be valgrind reserves a few files descriptors for its use <a href=\"https://sourceforge.net/p/valgrind/mailman/message/32904445/\" rel=\"noreferrer\">based on discussion here</a> let's say in this case it 12?? Thus setting the limit to 65578?? Which is still more that what the program is trying to reserve 65536.</p>\n\n<p>Any more suggestions to follow?</p>\n"}, {"tags": ["c", "linux-kernel"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 5518300, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PeMDlGROv_g/AAAAAAAAAAI/AAAAAAAAlto/MDId6DM4cC0/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/5518300/mark"}, "edited": false, "score": 0, "creation_date": 1535525825, "post_id": 52078201, "comment_id": 91106269, "body": "the third argument is the name of the container structure member to which the pointer points, not its type"}], "tags": [], "owner": {"reputation": 2021, "user_id": 4500798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a935dafe246dd0e2c216542f50073cbe?s=128&d=identicon&r=PG", "display_name": "Stephen Kitt", "link": "https://stackoverflow.com/users/4500798/stephen-kitt"}, "is_accepted": true, "score": 1, "last_activity_date": 1535548674, "last_edit_date": 1535548674, "creation_date": 1535523237, "answer_id": 52078201, "question_id": 52078200, "link": "https://stackoverflow.com/questions/52078200/container-of-sample-code-in-lwn-net/52078201#52078201", "title": "container_of sample code in lwn.net", "body": "<p>The given code is correct: the third argument is the name of the container structure member to which the pointer points, not its type, so <code>kobj</code> is right. The example is somewhat confusing since the first <code>kobj</code> doesn\u2019t correspond to the same thing as the second <code>kobj</code>: the first is the pointer in the caller\u2019s scope.</p>\n\n<p>Here\u2019s a diagram to hopefully clarify the parameters of <code>container_of</code>:</p>\n\n<pre><code>container_of(kobj, struct my_object, kobj)\n              |            |          |\n              |            |          |\n              \\------------+----------+--------------------------------\\\n                           |          |                                |\n                           |          |                                |\n         /-----------------/          |                                |\n         |                            |                                |\n         V              /-------------/                                |\n+------------------+    |                                              |\n| struct my_object | {  |                                              |\n+------------------+    V                                              V\n                   +------+                                         +------+\n    struct kobject | kobj |; &lt;-- You have a pointer to this, called | kobj |\n                   +------+                                         +------+\n    ...\n};\n</code></pre>\n\n<p><code>container_of</code> allows you to pass around a <code>kobject</code> pointer and find the containing object (as long as you know what the containing object is) \u2014 it allows you to use your knowledge of \u201cwhat\u201d to answer \u201cwhere\u201d.</p>\n\n<p>It\u2019s worth pointing out that <code>container_of</code> is a macro, which is how it can do seemingly impossible things (for developers not used to meta-programming).</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1535547951, "question_id": 465425}, "owner": {"reputation": 313, "user_id": 5518300, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PeMDlGROv_g/AAAAAAAAAAI/AAAAAAAAlto/MDId6DM4cC0/photo.jpg?sz=128", "display_name": "Mark", "link": "https://stackoverflow.com/users/5518300/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52078201, "answer_count": 1, "score": 0, "last_activity_date": 1535549093, "creation_date": 1535522583, "last_edit_date": 1535549093, "question_id": 52078200, "link": "https://stackoverflow.com/questions/52078200/container-of-sample-code-in-lwn-net", "title": "container_of sample code in lwn.net", "body": "<p>When seeing:</p>\n\n<pre><code>void my_object_release(struct kobject *kobj)\n{\n   struct my_object *mine = container_of(kobj, struct my_object, kobj);\n\n   /* Perform any additional cleanup on this object, then... */\n   kfree (mine);\n}\n</code></pre>\n\n<p>in <a href=\"https://lwn.net/Articles/51437/\" rel=\"nofollow noreferrer\">LWN\u2019s <em>The zen of kobjects</em></a>, it seems incorrect in the third parameter <code>kobj</code>. I think it should be <code>kobject</code>.</p>\n"}, {"tags": ["c", "matrix", "pointer-arithmetic"], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1535523703, "last_edit_date": 1535523703, "creation_date": 1535523326, "answer_id": 52070620, "question_id": 52070095, "link": "https://stackoverflow.com/questions/52070095/implementing-a-function-with-matrix-differences/52070620#52070620", "title": "implementing a function with matrix - differences", "body": "<p>The reason is the C operator precedence. A cast is stronger than a <code>+</code></p>\n\n<pre><code>(int*)mat + 1 is the same as ((int*)mat) + 1\n</code></pre>\n\n<p>so <code>mat</code> is casted to <code>int*</code> before adding 1 (hence you increment a \"pointer to int\")</p>\n\n<p>Here <code>mat+1</code> you don't have a cast so it will act like a \"row increment\" because in this expression <code>mat</code> acts as a \"pointer to an array of 3 ints\".</p>\n\n<p>BTW: Notice that your code have undefined behavior as it is now.</p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1535535069, "last_edit_date": 1535535069, "creation_date": 1535526373, "answer_id": 52071446, "question_id": 52070095, "link": "https://stackoverflow.com/questions/52070095/implementing-a-function-with-matrix-differences/52071446#52071446", "title": "implementing a function with matrix - differences", "body": "<p>This has to do with <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a>.</p>\n\n<p>The (type) operator is ahead of the binary addition operator (+) in precedence.\nIf you want the <em>second way</em> to be the same as the <em>third way</em>, put\n<code>mat + 1</code> in parenthesis <code>()</code> in the second way.</p>\n\n<p>Then,  </p>\n\n<pre><code>printMat((int*)(mat+1), 6);   //second way//\n</code></pre>\n\n<p>will be same as:   </p>\n\n<pre><code>printMat(mat+1, 6);         //third way//\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9215210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df603686e9611074cc87d950009388d7?s=128&d=identicon&r=PG&f=1", "display_name": "DonaldT", "link": "https://stackoverflow.com/users/9215210/donaldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1550501090, "creation_date": 1535520904, "last_edit_date": 1550501090, "question_id": 52070095, "link": "https://stackoverflow.com/questions/52070095/implementing-a-function-with-matrix-differences", "title": "implementing a function with matrix - differences", "body": "<p>I have the following function which prints a matrix:</p>\n\n<pre><code>void printMat(int* mat, int size)\n{\n    int i;\n    for (i=0 ; i &lt; size ; i++)\n        printf(\"%d \", mat[i]);\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Now, suppose I have a certain matrix and I want to implement the print of it by passing it to the function above in three ways:</p>\n\n<pre><code>void main()\n{\n    int mat[2][3] = { {1,2,3}, {4,5,6} };\n\n    printMat((int*)mat, 6);     //first way//\n    printMat((int*)mat+1, 6);   //second way//\n    printMat(mat+1, 6);         //third way//\n}\n</code></pre>\n\n<p>In the <strong>first</strong> way, the function actually gets the starting address of the matrix. That I understand.</p>\n\n<p>However, I don't understand why in the first way the function actually gets the <strong>address of the second element</strong> in the matrix, and not the <strong>address of the second line</strong> in the matrix (<strong>whereas the latter is being implemented actually by the third way</strong>).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 3, "creation_date": 1535519954, "post_id": 52069899, "comment_id": 91089625, "body": "What is the error?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1535520083, "post_id": 52069899, "comment_id": 91089685, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This includes copies of your entire program and the actual error messages you&#39;ve got. My crystall ball says the error is in not null-terminating new_s. And why <code>i &lt; len - 1</code>?"}, {"owner": {"reputation": 195, "user_id": 4432916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f5c33058603089e08b3f435dabde3?s=128&d=identicon&r=PG&f=1", "display_name": "thomachan", "link": "https://stackoverflow.com/users/4432916/thomachan"}, "edited": false, "score": 0, "creation_date": 1535520188, "post_id": 52069899, "comment_id": 91089730, "body": "valgrind will show an error if you don&#39;t free the memory that you &#39;malloc&#39;ed."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1535520377, "post_id": 52069899, "comment_id": 91089804, "body": "Probably not the error, but I&#39;m not sure why you used <code>len - 1</code> instead of <code>len</code> in the loop condition. Also, you haven&#39;t NUL-terminated <code>new_s</code> after copying"}, {"owner": {"reputation": 11, "user_id": 10287983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WiDiao0_3L4/AAAAAAAAAAI/AAAAAAAAHos/Vb7OJc2pv6Y/photo.jpg?sz=128", "display_name": "Ryan Franks", "link": "https://stackoverflow.com/users/10287983/ryan-franks"}, "edited": false, "score": 1, "creation_date": 1535520596, "post_id": 52069899, "comment_id": 91089872, "body": "Just added in the other bits of info, sorry this is my first time posting :)"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1535520870, "post_id": 52069899, "comment_id": 91089970, "body": "Oh, the error is about <code>strlen</code> in library code, not your code \u2013 when you do <code>printf(&quot;%s\\n&quot;, s);</code>. (Compiling with <code>-Og -g</code> flags before running valgrind should get you line numbers to help with that.) As people have mentioned, the problem is that <code>new_s</code> isn\u2019t terminated."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1535520880, "post_id": 52069899, "comment_id": 91089977, "body": "Try NUL-terminating <code>new_s</code> (<code>new_s[inc] = &#39;\\0&#39;</code>) after the loop and see if the error still persists."}, {"owner": {"reputation": 11, "user_id": 10287983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WiDiao0_3L4/AAAAAAAAAAI/AAAAAAAAHos/Vb7OJc2pv6Y/photo.jpg?sz=128", "display_name": "Ryan Franks", "link": "https://stackoverflow.com/users/10287983/ryan-franks"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1535521481, "post_id": 52069899, "comment_id": 91090207, "body": "@CoolGuy that was it thank you. seems trivial now haha"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1535521610, "post_id": 52069899, "comment_id": 91090248, "body": "1) <code>return new_s;</code> ==&gt; <code>new_s[inc] = &#39;\\0&#39;; return new_s;</code> 2) <code>i &lt; len - 1;</code> ==&gt; <code>i &lt; len;</code> 3) <code>malloc(len + 1);</code> ==&gt; <code>malloc((len + 3)&#47;2);</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1535532650, "post_id": 52069899, "comment_id": 91096271, "body": "@4386427 - the <code>malloc((len + 3)&#47;2);</code> is clever for the specific loop incrementing <code>i+=2</code>, but may be confusing to those learning dynamical allocation, and may be overlooked when changing the loop conditions. Good rule of thumb for character strings is always <code>len + 1</code>. I&#39;d rather over-allocate by <code>10K</code> than under-allocate by <code>1 :)</code> (if you are on an embedded system with memory critically short, sure, but otherwise for a 5-character gamble, it may add more complication than it saves memory)"}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1535523531, "creation_date": 1535523531, "answer_id": 52070674, "question_id": 52069899, "link": "https://stackoverflow.com/questions/52069899/using-dynamic-memory-get-every-second-element-in-a-char-array-into-another/52070674#52070674", "title": "Using Dynamic Memory get every second element in a char array into another", "body": "<p>Why is Valgrind reporting this error?</p>\n\n<p>From the Valgrind <a href=\"http://valgrind.org/docs/manual/mc-manual.html#mc-manual.uninitvals\" rel=\"nofollow noreferrer\">online manual</a> on the <a href=\"http://valgrind.org/docs/manual/mc-manual.html#mc-manual.bad-syscall-args\" rel=\"nofollow noreferrer\">use of uninitialised or unaddressable values in system calls</a>:  </p>\n\n<blockquote>\n  <p>Sources of <strong>uninitialised data</strong> tend to be:<br>\n  - Local variables in procedures which have not been initialised.<br>\n  - <strong>The contents of heap blocks (allocated with malloc, new, or a similar function)</strong>        before you (or a constructor) write something there. </p>\n</blockquote>\n\n<p>Valgrind will complain if:  </p>\n\n<blockquote>\n  <p>the program has <strong>written uninitialised junk from the heap block to the standard output</strong>.</p>\n</blockquote>\n\n<p>Since you have used <code>s</code> in <code>printf</code> without null-terminating it, it caused the error.</p>\n"}], "owner": {"reputation": 11, "user_id": 10287983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WiDiao0_3L4/AAAAAAAAAAI/AAAAAAAAHos/Vb7OJc2pv6Y/photo.jpg?sz=128", "display_name": "Ryan Franks", "link": "https://stackoverflow.com/users/10287983/ryan-franks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535523531, "creation_date": 1535519734, "last_edit_date": 1535520994, "question_id": 52069899, "link": "https://stackoverflow.com/questions/52069899/using-dynamic-memory-get-every-second-element-in-a-char-array-into-another", "title": "Using Dynamic Memory get every second element in a char array into another", "body": "<p>I've been tasked with getting writing a function that uses dynamic memory and will take a string <code>s</code> and pull out every second element of the string, and then return a new string with those elements. So far my code is:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\nchar* skipping(const char* s)\n{\n    int inc = 0; //new list incrementer\n    int len = strlen(s);\n    char* new_s = malloc(len + 1); \n    for (int i = 0; i &lt; len - 1; i+=2) {\n        new_s[inc] = s[i];\n        inc++;\n    }\n    return new_s;\n}\n\nint main(void)\n{\n    char* s = skipping(\"0123456789\");\n    printf(\"%s\\n\", s);\n    free(s);\n    return 0;\n}\n</code></pre>\n\n<p>This works, however when I run it using Valgrind I get told I have an error, which comes from using <code>strlen</code>, but I can't seem to fix it. Any help would be awesome!</p>\n\n<p>Error messages: (in valgrind)</p>\n\n<pre><code>==4596== \n==4596== Conditional jump or move depends on uninitialised value(s)\n\n==4596==    at 0x4C32D08: strlen (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n\n==4596==    by 0x4EBC9D1: puts (ioputs.c:35)\n\n==4596==    by 0x1087B4: main (in /home/ryan/ENCE260/lab6)\n\n==4596== \n\n02468             //this is the expected output\n\n==4596== \n\n==4596== HEAP SUMMARY:\n\n==4596==     in use at exit: 0 bytes in 0 blocks\n\n==4596==   total heap usage: 2 allocs, 2 frees, 1,035 bytes allocated\n\n==4596== \n\n==4596== All heap blocks were freed -- no leaks are possible\n\n==4596== \n\n==4596== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "linux", "file"], "comments": [{"owner": {"reputation": 89, "user_id": 7746260, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nqisD.jpg?s=128&g=1", "display_name": "Vinie", "link": "https://stackoverflow.com/users/7746260/vinie"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1535520474, "post_id": 52069861, "comment_id": 91089837, "body": "@SteveSummit chmod is used to set file permissions. But it does not change attributes like immutable. I need the file to be immutable. That is the user is not supposed to delete the file."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1535520760, "post_id": 52069861, "comment_id": 91089941, "body": "Sorry, my mistake."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1535521281, "post_id": 52069861, "comment_id": 91090115, "body": "If you&#39;re asking about the <code>i</code> attribute, the <a href=\"https://linux.die.net/man/1/chattr\" rel=\"nofollow noreferrer\">man page</a> says that &quot;Only the superuser or a process possessing the CAP_LINUX_IMMUTABLE capability can set or clear this attribute.&quot;  So if you can give yourself the CAP_LINUX_IMMUTABLE capability, you don&#39;t need to be superuser."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1535521412, "post_id": 52069861, "comment_id": 91090166, "body": "I&#39;m not sure if it would meet your needs, but if a user doesn&#39;t have write permission on the directory containing a file, they can&#39;t delete the file."}, {"owner": {"reputation": 89, "user_id": 7746260, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nqisD.jpg?s=128&g=1", "display_name": "Vinie", "link": "https://stackoverflow.com/users/7746260/vinie"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1535522190, "post_id": 52069861, "comment_id": 91090459, "body": "@SteveSummit Yeah. Changing the permission of directory makes the file undeletable. Unfortunately I cant change the permission of the whole directory. instead I need it for the specific file, if there is any possibility to do so."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1535522369, "post_id": 52069861, "comment_id": 91090524, "body": "And I suppose you can&#39;t put the file in its own, protected directory, because there&#39;s some precedent forcing it to remain where it is."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 3, "creation_date": 1535523833, "post_id": 52069861, "comment_id": 91091178, "body": "You can make a hardlink to the file in a different directory. The user could still unlink the file from the directory it&#39;s in, but the link could be recreated automatically. I don&#39;t know your real problem so I can&#39;t tell if that&#39;s a possible fit."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1535547875, "post_id": 52069861, "comment_id": 91106200, "body": "@user <i>Unfortunately I cant change the permission of the whole directory. instead I need it for the specific file, if there is any possibility to do so.</i>  That&#39;s one thing that the immutable flag is for.  That&#39;s what the OS already provides."}], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "is_accepted": true, "score": 1, "last_activity_date": 1535547443, "creation_date": 1535547443, "answer_id": 52078045, "question_id": 52069861, "link": "https://stackoverflow.com/questions/52069861/alternate-method-for-chattr-in-linux/52078045#52078045", "title": "Alternate method for chattr in Linux", "body": "<p>You can use a function called <code>ioctl</code>. You can refer to the following discussion on StackExchange itself. It poses a solution to a very similar problem.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/32465756/setting-immutable-flag-using-ioctl-in-]\">Setting Immutable Flag using ioctl() in C</a></p>\n\n<p>Hope I could help.</p>\n"}, {"tags": [], "owner": {"reputation": 41428, "user_id": 440564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e3dbcb5159c02d59f52159faa8437c97?s=128&d=identicon&r=PG", "display_name": "blue112", "link": "https://stackoverflow.com/users/440564/blue112"}, "is_accepted": false, "score": 0, "last_activity_date": 1535547631, "creation_date": 1535547631, "answer_id": 52078105, "question_id": 52069861, "link": "https://stackoverflow.com/questions/52069861/alternate-method-for-chattr-in-linux/52078105#52078105", "title": "Alternate method for chattr in Linux", "body": "<p>To set the immutable flag you can either:</p>\n\n<ul>\n<li>Be root</li>\n<li>Have the <code>CAP_LINUX_IMMUTABLE</code> capability on the process</li>\n</ul>\n\n<p>In either way, you can't do it with simple user level permissions.</p>\n"}], "owner": {"reputation": 89, "user_id": 7746260, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nqisD.jpg?s=128&g=1", "display_name": "Vinie", "link": "https://stackoverflow.com/users/7746260/vinie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 52078045, "answer_count": 2, "score": 2, "last_activity_date": 1535547631, "creation_date": 1535519539, "question_id": 52069861, "link": "https://stackoverflow.com/questions/52069861/alternate-method-for-chattr-in-linux", "title": "Alternate method for chattr in Linux", "body": "<p>Is there any method to make a file immutable from a C program which is to be run with user privilege level on Linux? I have tried chattr but this system call requires super user permission.</p>\n"}, {"tags": ["c++", "c", "node.js", "node.js-napi"], "comments": [{"owner": {"reputation": 11, "user_id": 10287832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49GxI.jpg?s=128&g=1", "display_name": "wyericso", "link": "https://stackoverflow.com/users/10287832/wyericso"}, "edited": false, "score": 0, "creation_date": 1535685955, "post_id": 52069832, "comment_id": 91166746, "body": "I started to think if <code>module.cpp</code> was actually calling <code>Camellia_Ekeygen</code> from another built-in library instead of the one I gave in another .cpp source file. I&#39;m investigating this and will post if there&#39;s any update."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10287832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49GxI.jpg?s=128&g=1", "display_name": "wyericso", "link": "https://stackoverflow.com/users/10287832/wyericso"}, "is_accepted": true, "score": 0, "last_activity_date": 1536041865, "creation_date": 1536041865, "answer_id": 52159905, "question_id": 52069832, "link": "https://stackoverflow.com/questions/52069832/calling-a-c-function-with-node-js-n-api-shows-output-not-expected/52159905#52159905", "title": "Calling a C function with Node.js N-API shows output not expected", "body": "<p>I'm sure now the <code>Camellia_Ekeygen</code> actually called was not the one in the C++ source file I provided.</p>\n\n<p>I renamed the function to <code>Camellia_Ekeygen1</code> in <code>module.cpp</code>, <code>camellia.h</code> and the C++ source file and then the output was expected.</p>\n\n<p>Thanks a lot for your time reading this.</p>\n"}], "owner": {"reputation": 11, "user_id": 10287832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49GxI.jpg?s=128&g=1", "display_name": "wyericso", "link": "https://stackoverflow.com/users/10287832/wyericso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 52159905, "answer_count": 1, "score": 1, "last_activity_date": 1536041865, "creation_date": 1535519322, "last_edit_date": 1535520112, "question_id": 52069832, "link": "https://stackoverflow.com/questions/52069832/calling-a-c-function-with-node-js-n-api-shows-output-not-expected", "title": "Calling a C function with Node.js N-API shows output not expected", "body": "<p>I'm new to Node.js N-API. Let me go straight to the question.</p>\n\n<p>I'm trying to call a C function <code>Camellia_Ekeygen</code> with N-API, but the output of the function <code>m_uKttWork</code> is different from calling the same function directly with C++ code.</p>\n\n<p>Here're the codes and outputs for references.</p>\n\n<h1>Using N-API</h1>\n\n<h2>module.cpp</h2>\n\n<pre><code>#include &lt;node_api.h&gt;\n#include \"camellia.h\"\n\nnapi_value MyFunction(napi_env env, napi_callback_info info) {\n    typedef unsigned int KEY_TABLE_TYPE[68];\n    typedef unsigned char BYTE;\n\n    BYTE m_byCurrentWorkKey[16] {};\n    KEY_TABLE_TYPE m_uKttWork {};\n\n    napi_status status;\n\n    Camellia_Ekeygen( 128, m_byCurrentWorkKey, m_uKttWork );\n\n    napi_value result;\n    status = napi_create_array(env, &amp;result);\n\n    napi_value num_result;\n    for (int i = 0; i &lt; 68; i++) {\n        status = napi_create_uint32(env, m_uKttWork[i], &amp;num_result);\n        status = napi_set_element(env, result, i, num_result);\n    }\n\n    return result;\n}\n\nnapi_value Init(napi_env env, napi_value exports) {\n    napi_status status;\n    napi_value fn;\n\n    status = napi_create_function(env, NULL, 0, MyFunction, NULL, &amp;fn);\n    status = napi_set_named_property(env, exports, \"my_function\", fn);\n\n    return exports;\n}\n\nNAPI_MODULE(NODE_GYP_MODULE_NAME, Init)\n</code></pre>\n\n<h2>module.js</h2>\n\n<pre><code>const addon = require('./build/Release/module');\nconsole.log(addon.my_function());\n</code></pre>\n\n<h2>Output</h2>\n\n<pre><code>$ node module.js\n[ 0,\n  0,\n  0,\n  0,\n  1827423791,\n  382301878,\n  1852628593,\n  3123771802,\n  0,\n  0,\n  0,\n  0,\n  588766488,\n  3143317110,\n  1865976676,\n  2093823798,\n  4002168422,\n  2604339595,\n  1169317293,\n  2610640796,\n  0,\n  0,\n  0,\n  0,\n  523455949,\n  2294675270,\n  0,\n  0,\n  2800143847,\n  4221767577,\n  1724826722,\n  292329323,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  1169317293,\n  2610640796,\n  4002168422,\n  2604339595,\n  0,\n  0,\n  0,\n  0,\n  3143317110,\n  1865976676,\n  2093823798,\n  588766488,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0 ]\n(node:3475) Warning: N-API is an experimental feature and could change at any time.\n$ \n</code></pre>\n\n<h1>Calling <code>Camellia_Ekeygen</code> directly</h1>\n\n<h2>test.cpp</h2>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"camellia.h\"\n\nint main() {\n    typedef unsigned char BYTE;\n    typedef unsigned int KEY_TABLE_TYPE[68];\n\n    BYTE m_byCurrentWorkKey[16] {};\n    KEY_TABLE_TYPE m_uKttWork {};\n\n    Camellia_Ekeygen( 128, m_byCurrentWorkKey, m_uKttWork );\n\n    for (int i = 0; i &lt; 68; i++) {\n        std::cout &lt;&lt; m_uKttWork[i] &lt;&lt; \" \";\n    }\n\n    std::cout &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<h2>Output</h2>\n\n<pre><code>$ g++ -std=c++11 -o test test.cpp Camellia.c \n$ ./test \n382301878 1827423791 0 0 1546120148 3860271694 623942010 872017868 1546120148 3860271694 1290497688 4155529454 4122759699 2305910053 1290497688 4155529454 2604339595 4002168422 2610640796 1169317293 4283709980 2844888938 4139420567 2122284241 0 0 3011048906 3223194901 2723350903 3007290908 1170374237 3194057156 0 0 0 0 1821862673 456472600 694825438 3002140226 3073371509 739572990 694825438 3002140226 3073371509 739572990 3672780383 4194169671 1865976676 3143317110 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \n$ \n</code></pre>\n\n<p>Is there anything I should be looking at in this case?? I've been looking for clues in these few days but still have no idea so far. Any troubleshooting direction or reference is appreciated.</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1535516975, "post_id": 52069397, "comment_id": 91088776, "body": "Have you checked what factor is after this line? <code>factor = floor(1&#47;f);</code> That&#39;s integer division, so it&#39;s almost certainly zero. If you&#39;re going to sample every 2 or 3 or 4 pixels, you want your factor to be 2,3,4j just like when you&#39;re making it larger, but instead of writing N pixels per source pixel you ignore N source pixels between samples and writes."}, {"owner": {"reputation": 25, "user_id": 10287827, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160980683970454/picture?type=large", "display_name": "Enrique Guadarrama", "link": "https://stackoverflow.com/users/10287827/enrique-guadarrama"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1535517450, "post_id": 52069397, "comment_id": 91088899, "body": "Thank you for the reply, that line works, for instance, f=0.25 will return 4"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1535517563, "post_id": 52069397, "comment_id": 91088941, "body": "You&#39;re right, I didn&#39;t see that f was a float. Since I don&#39;t know what your source image or dest image look like it&#39;s hard to guess at the issue.  If you have a padding problem the first line will be right and then each line after will be offset by some amount, and if it isn&#39;t an even amount the colors will shift too. Try a bmp with a white background and vertical black stripes. That would make a padding issue very obvious"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10287827, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160980683970454/picture?type=large", "display_name": "Enrique Guadarrama", "link": "https://stackoverflow.com/users/10287827/enrique-guadarrama"}, "edited": false, "score": 0, "creation_date": 1535840398, "post_id": 52122614, "comment_id": 91215631, "body": "Thank you so much Retired Ninja, I\u2019ll give it a shot when I get home!"}], "tags": [], "owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "is_accepted": true, "score": 1, "last_activity_date": 1535749768, "creation_date": 1535749768, "answer_id": 52122614, "question_id": 52069397, "link": "https://stackoverflow.com/questions/52069397/cs50-pset4-resize-more-cant-figure-out-how-to-make-it-smaller/52122614#52122614", "title": "Cs50 Pset4. Resize More. Cant figure out how to make it smaller", "body": "<p>The issue I found with your code was that iterating over the source width/height and trying to read/write as you go would end up writing more data than it should, and potentially getting the file pointers out of sync.</p>\n\n<p>As an example, with a 512x512 source image and a factor of 3 you end up writing extra pixels per line, both because 512 * 0.33 is not the same as 512 / 3, and 512 % 3 != 0;</p>\n\n<p>The way I would normally do it is to load the data into memory and iterate over the destination width/height assigning the proper pixels from the source.</p>\n\n<p>I don't have bmp.h so I included Windows.h instead, and I switched to opening the files in binary mode, since you don't want any line endings getting translated. I'm also compiling in C++ mode, so there's a few casts you may not need if you're compiling as C.</p>\n\n<pre><code>#define WIN32_LEAN_AND_MEAN\n#include &lt;Windows.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    float f = 0.33f;\n    int factor = 1 / f;\n    FILE *inptr = fopen(\"infile.bmp\", \"rb\");\n    FILE *outptr = fopen(\"outfile.bmp\", \"wb\");\n\n    BITMAPFILEHEADER bf, bfn;\n    fread(&amp;bf, sizeof(BITMAPFILEHEADER), 1, inptr);\n    bfn = bf;\n    BITMAPINFOHEADER bi, bin;\n    fread(&amp;bi, sizeof(BITMAPINFOHEADER), 1, inptr);\n    bin = bi;\n\n    if (bf.bfType != 0x4d42 || bf.bfOffBits != 54 || bi.biSize != 40 || bi.biBitCount != 24 || bi.biCompression != 0)\n    {\n        fclose(outptr);\n        fclose(inptr);\n        fprintf(stderr, \"Unsupported file format.\\n\");\n        return 4;\n    }\n\n    bin.biWidth *= f;\n    bin.biHeight *= f;\n    int srcStride = (bi.biWidth * sizeof(RGBTRIPLE) + 3) &amp; ~3;\n    int dstStride = (bin.biWidth * sizeof(RGBTRIPLE) + 3) &amp; ~3;\n\n    bin.biSizeImage = dstStride * abs(bin.biHeight);\n    bfn.bfSize = bin.biSizeImage + sizeof(BITMAPFILEHEADER) + sizeof(BITMAPINFOHEADER);\n    fwrite(&amp;bfn, sizeof(BITMAPFILEHEADER), 1, outptr);\n    fwrite(&amp;bin, sizeof(BITMAPINFOHEADER), 1, outptr);\n\n    char* srcData = (char*)calloc(1, bi.biSizeImage);\n    fread(srcData, bi.biSizeImage, 1, inptr);\n    char* dstData = (char*)calloc(1, bin.biSizeImage);\n\n    for (int i = 0, binHeight = abs(bin.biHeight); i &lt; binHeight; i++)\n    {\n        RGBTRIPLE* src = (RGBTRIPLE*)&amp;srcData[srcStride * i * factor];\n        RGBTRIPLE* dst = (RGBTRIPLE*)&amp;dstData[dstStride * i];\n        for (int j = 0; j &lt; bin.biWidth; j++)\n        {\n            dst[j] = src[j * factor];\n        }\n    }\n    fwrite(dstData, bin.biSizeImage, 1, outptr);\n    fclose(inptr);\n    fclose(outptr);\n    free(srcData);\n    free(dstData);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10287827, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160980683970454/picture?type=large", "display_name": "Enrique Guadarrama", "link": "https://stackoverflow.com/users/10287827/enrique-guadarrama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 1, "accepted_answer_id": 52122614, "answer_count": 1, "score": 0, "last_activity_date": 1536106476, "creation_date": 1535516203, "last_edit_date": 1536106476, "question_id": 52069397, "link": "https://stackoverflow.com/questions/52069397/cs50-pset4-resize-more-cant-figure-out-how-to-make-it-smaller", "title": "Cs50 Pset4. Resize More. Cant figure out how to make it smaller", "body": "<p>I figured out how to make an image bigger, but for the life of me I cant figure out how to make it smaller. The current code will make a bitmap the right size but fill it with random colors. The current code makes sense to me, i think the problem might be with the headers or the padding. Please Help!\n<a href=\"https://i.stack.imgur.com/rkxzC.jpg\" rel=\"nofollow noreferrer\">Original vs output</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;math.h&gt;\n\n#include \"bmp.h\"\n\nint main(int argc, char *argv[])\n{\n    // ensure proper usage\n    if (argc != 4)\n    {\n        fprintf(stderr, \"Usage: ./resize f infile outfile\\n\");\n        return 1;\n    }\n\n    /* GET FACTOR */\n    float f = atof( argv[1]);\n    if (f &lt; 0.0 || f &gt; 100.0)\n    {\n        fprintf(stderr, \"The factor is out of bounds\\n\");\n        return 5;\n    }\n\n    //check if we are making it bigger\n    bool big = true;\n    int factor = 0;\n    if ( f &lt;= 1.0)\n    {\n        big = false;\n        factor = floor(1/f);\n    }\n    else\n    {\n        big = true;\n        factor = floor(f);\n    }\n    /**/\n\n    // remember filenames\n    char *infile = argv[2];\n    char *outfile = argv[3];\n\n    // open input file\n    FILE *inptr = fopen(infile, \"r\");\n    if (inptr == NULL)\n    {\n        fprintf(stderr, \"Could not open %s.\\n\", infile);\n        return 2;\n    }\n\n    // open output file\n    FILE *outptr = fopen(outfile, \"w\");\n    if (outptr == NULL)\n    {\n        fclose(inptr);\n        fprintf(stderr, \"Could not create %s.\\n\", outfile);\n        return 3;\n    }\n\n    // read infile's BITMAPFILEHEADER\n    BITMAPFILEHEADER bf, bfn;\n    fread(&amp;bf, sizeof(BITMAPFILEHEADER), 1, inptr);\n    bfn=bf;\n\n    // read infile's BITMAPINFOHEADER\n    BITMAPINFOHEADER bi,bin;\n    fread(&amp;bi, sizeof(BITMAPINFOHEADER), 1, inptr);\n    bin=bi;\n\n    // ensure infile is (likely) a 24-bit uncompressed BMP 4.0\n    if (bf.bfType != 0x4d42 || bf.bfOffBits != 54 || bi.biSize != 40 ||\n        bi.biBitCount != 24 || bi.biCompression != 0)\n    {\n        fclose(outptr);\n        fclose(inptr);\n        fprintf(stderr, \"Unsupported file format.\\n\");\n        return 4;\n    }\n\n    /*Original pad*/\n    int oldpadding = (4 - (bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n    /**/\n\n    /*CHANGE THE INFOHEADER W&amp;H SIZE*/\n    bin.biWidth= floor(bi.biWidth * f);\n    bin.biHeight= floor(bi.biHeight * f);\n\n     /*NEW PADDING*/\n     int padding = (4 - (bin.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n    /*GET NEW SIZE*/\n    bin.biSizeImage = ((sizeof(RGBTRIPLE) * bin.biWidth) + padding) * abs(bin.biHeight);\n    bfn.bfSize = bin.biSizeImage + sizeof(BITMAPFILEHEADER) + sizeof(BITMAPINFOHEADER);\n    /**/\n\n\n\n\n    // write outfile's BITMAPFILEHEADER\n    fwrite(&amp;bfn, sizeof(BITMAPFILEHEADER), 1, outptr);\n\n    // write outfile's BITMAPINFOHEADER\n    fwrite(&amp;bin, sizeof(BITMAPINFOHEADER), 1, outptr);\n\n\n\n    if(big)\n    {\n        // iterate over infile's scanlines\n       for (int i = 0, biHeight = abs(bi.biHeight); i &lt; biHeight; i++)\n        {\n\n            for(int w = 0; w &lt; factor; w++)\n            {\n                // temporary storage\n                RGBTRIPLE triple;\n\n\n                // iterate over pixels in scanline\n                for (int j = 0; j &lt; bi.biWidth; j++)\n                {\n                    // read RGB triple from infile\n                    fread(&amp;triple, sizeof(RGBTRIPLE), 1, inptr);\n\n                    for(int x = 0 ; x &lt; factor ; x++)\n                    {\n                        // write RGB triple to outfile\n                        fwrite(&amp;triple, sizeof(RGBTRIPLE), 1, outptr);\n                    }\n\n                }\n                for (int k = 0; k &lt; padding; k++)\n                {\n                    fputc(0x00, outptr);\n                }\n                fseek(inptr, -1*sizeof(RGBTRIPLE)*bi.biWidth, SEEK_CUR);\n            }\n            // skip over padding, if any\n            fseek(inptr, sizeof(RGBTRIPLE)*bi.biWidth+oldpadding, SEEK_CUR);\n        }\n    }\n    else\n    {\n        for (int i = 0, biHeight = abs(bi.biHeight); i &lt; biHeight; i++)\n        {\n            // iterate over pixels in scanline\n            for (int j = 0; j &lt; bi.biWidth; j++)\n            {\n                // temporary storage\n                RGBTRIPLE triple;\n\n                // read RGB triple from infile\n                fread(&amp;triple, sizeof(RGBTRIPLE), 1, inptr);\n                if(i%factor==0&amp;&amp;j%factor==0)\n                {\n\n                    // write RGB triple to outfile\n                    fwrite(&amp;triple, sizeof(RGBTRIPLE), 1, outptr);\n                }\n            }\n\n            // skip over padding, if any\n            fseek(inptr, oldpadding, SEEK_CUR);\n\n            // then add it back (to demonstrate how)\n            for (int k = 0; k &lt; padding; k++)\n            {\n                fputc(0x00, outptr);\n            }\n        }\n    }\n\n    // close infile\n    fclose(inptr);\n\n    // close outfile\n    fclose(outptr);\n\n    // success\n    return 0;\n}\n`\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1535660155, "post_id": 52068914, "comment_id": 91160559, "body": "Why don&#39;t you read the whole discussion from APUE and not just part of it? Or, search for past discussions based on the keywords you learned?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535512772, "post_id": 52068965, "comment_id": 91087856, "body": "Thanks. (1) Do you mean the buffer in FILE object, or the buffer in kernel, or both? (2) In APUE or other references, I didn&#39;t find that &quot;fseek, fsetpos, or rewind&quot; and &quot;an input operation that encounters an end of \ufb01le&quot; call fflush() or fsync(), or am I missing it?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 1, "creation_date": 1535513032, "post_id": 52068965, "comment_id": 91087919, "body": "@Tim I believe it&#39;s in the <code>FILE</code> object, since the library functions use the <code>open</code>, <code>read</code>, and <code>write</code> system calls internally.  I&#39;m not familiar with APUE, but the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> does mention the above restrictions in section 7.21.5.3p7."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535513171, "post_id": 52068965, "comment_id": 91087944, "body": "Do you mean it is sufficient to flush from FILE&#39;s buffer to kernel&#39;s buffer, and it doesn&#39;t matter whether flush from kernel&#39;s buffer to disk?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535513287, "post_id": 52068965, "comment_id": 91087968, "body": "@Tim A <code>FILE</code> object performs its own buffering, so there are restrictions on how it&#39;s used.  The lower level file descriptors don&#39;t have that restriction.  How the kernel handles things is basically transparent to the user."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535513442, "post_id": 52068965, "comment_id": 91087995, "body": "Why wasn&#39;t the C standard library also  made transparent in the same sense, so that I don&#39;t have to fflush() between output and input?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535513540, "post_id": 52068965, "comment_id": 91088018, "body": "@Tim That&#39;s the way the standard is written.  It probably has to do with the level of detachment between kernel space and user space along with the kernel&#39;s own threads."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 1, "creation_date": 1535520206, "post_id": 52068965, "comment_id": 91089735, "body": "@Tim I believe the Standard was written that way to reflect longstanding practice.  The legacy implementations all worked that way, and no one wanted the Standard to invalidate them all."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 2, "creation_date": 1535520323, "post_id": 52068965, "comment_id": 91089779, "body": "@Tim Also, there&#39;s a sense that the restriction isn&#39;t onerous.  Very few programs seem to need to read, then switch to writing at the same spot, or vice versa.  Most random-access programs, that both read then write, tend to naturally have to seek to a new spot when changing from reading to writing, anyway."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535650938, "post_id": 52068965, "comment_id": 91156225, "body": "Thanks. @dbush For Linux API, can <code>read()</code> be directly followed by <code>write()</code> and <code>write()</code> by <code>read()</code>? If yes, why is such a difference between Linux API and C library IO API?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1535667260, "post_id": 52068965, "comment_id": 91163118, "body": "@dbush  7.21.5.3p7 in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">the C standard</a> doesn&#39;t say file positioning functions internally flush output to device or clear input cache. I was wondering why the file positioning functions (if not <code>fflush</code>) should be called  between output and input?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1535512544, "creation_date": 1535512544, "answer_id": 52068965, "question_id": 52068914, "link": "https://stackoverflow.com/questions/52068914/why-cant-an-output-be-followed-by-an-input-and-vice-versa/52068965#52068965", "title": "Why can&#39;t an output be followed by an input and vice versa?", "body": "<p>When working with a <code>FILE</code> stream, there is a single internal buffer used when either reading from or writing to the file.  </p>\n\n<p>When switching between reading and writing, that buffer <strong>must</strong> be cleared before switching modes, otherwise data loss could potentially occur.  Each of the operations mentioned above perform the required flushing of the buffer.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1535654889, "creation_date": 1535512069, "last_edit_date": 1535654889, "question_id": 52068914, "link": "https://stackoverflow.com/questions/52068914/why-cant-an-output-be-followed-by-an-input-and-vice-versa", "title": "Why can&#39;t an output be followed by an input and vice versa?", "body": "<p>From APUE</p>\n\n<blockquote>\n  <p>When  a  \ufb01le  is  opened  for  reading  and  writing  (the  plus  sign\n  in  the type),  two restrictions apply.</p>\n  \n  <p>\u2022 Output  cannot  be  directly  followed  by  input  without  an \n  intervening fflush, fseek, fsetpos, or rewind.</p>\n  \n  <p>\u2022 Input  cannot  be  directly  followed  by  output  without  an \n  intervening fseek, fsetpos, or rewind, or an input operation that\n  encounters an end of \ufb01le.</p>\n</blockquote>\n\n<p>Why \"fseek, fsetpos, or rewind\" in both cases?</p>\n\n<p>Why \"an input operation that encounters an end of \ufb01le\" in the second case?</p>\n\n<p>Thanks.</p>\n\n<p>A similar question for Linux API is <a href=\"https://stackoverflow.com/questions/52103562/can-read-be-directly-followed-by-write-and-write-by-read\">Can `read()` be directly followed by `write()` and `write()` by `read()`?</a></p>\n"}, {"tags": ["c", "logic"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1535512533, "post_id": 52068891, "comment_id": 91087819, "body": "You aren&#39;t checking the return value from <code>scanf</code>. You requested 1 conversion, so the return value should be 1. If it&#39;s anything other than 1, then something went terribly wrong."}, {"owner": {"reputation": 10067, "user_id": 7734643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q8g6Y.jpg?s=128&g=1", "display_name": "Rakesha Shastri", "link": "https://stackoverflow.com/users/7734643/rakesha-shastri"}, "edited": false, "score": 0, "creation_date": 1535512706, "post_id": 52068891, "comment_id": 91087843, "body": "Why do you need the last isdigit condition?"}, {"owner": {"reputation": 1489, "user_id": 2371840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f6ec83c6c9cc12729498b7902f3777?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Rourke", "link": "https://stackoverflow.com/users/2371840/michael-rourke"}, "edited": false, "score": 2, "creation_date": 1535512919, "post_id": 52068891, "comment_id": 91087890, "body": "I would recommend reading a line of text at a time, then use sscanf to parse that line. That way you have better control over invalid input."}, {"owner": {"reputation": 1, "user_id": 10287562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa13e2a42cd3a46168a796f21b7baf9?s=128&d=identicon&r=PG&f=1", "display_name": "Senile Old Fart", "link": "https://stackoverflow.com/users/10287562/senile-old-fart"}, "edited": false, "score": 0, "creation_date": 1535538330, "post_id": 52068891, "comment_id": 91099891, "body": "Ok, I have switched to using fgets and sscanf instead. It is working better but not perfectly yet. If the input via stdin is longer than what I&#39;ve defined for the fgets, it loops through my code until all the input is exhausted. It would seem I need a way to clear out what is buffered in stdin. I&#39;m thinking if there&#39;s more than one character and a newline in stdin, I need to loop through a second fgets to pull off one character at a time until it is null. Here&#39;s my current code:"}, {"owner": {"reputation": 1, "user_id": 10287562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa13e2a42cd3a46168a796f21b7baf9?s=128&d=identicon&r=PG&f=1", "display_name": "Senile Old Fart", "link": "https://stackoverflow.com/users/10287562/senile-old-fart"}, "edited": false, "score": 0, "creation_date": 1535538436, "post_id": 52068891, "comment_id": 91099958, "body": "#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;ctype.h&gt; #include &lt;string.h&gt;  int main() {     int timeframe;     char query1[10];     int query1rc1;     int query1rc2;     int querylen;     querylen = 10;     int len1;     do     {   timeframe = 0;         printf(&quot;     time frame is %d\\n&quot;, timeframe);         printf(&quot;Select statistics set required:\\n&quot;);         printf(&quot;   1. Daily period statistics\\n&quot;);         printf(&quot;   2. Monthly period statistics\\n&quot;);         printf(&quot;   3. Custom period statistics\\n&quot;);         query1rc1 = fgets(query1, querylen, stdin);"}, {"owner": {"reputation": 1, "user_id": 10287562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa13e2a42cd3a46168a796f21b7baf9?s=128&d=identicon&r=PG&f=1", "display_name": "Senile Old Fart", "link": "https://stackoverflow.com/users/10287562/senile-old-fart"}, "edited": false, "score": 0, "creation_date": 1535538471, "post_id": 52068891, "comment_id": 91099978, "body": "len1 = strlen(query1);         if (len1 &gt; 2)             {             timeframe = 0;             printf (&quot;\\nInvalid response.\\n\\n&quot;);             }         else         {         query1rc2 = sscanf(query1, &quot;%d&quot;, &amp;timeframe);         if (timeframe != 1 &amp;&amp; timeframe != 2 &amp;&amp; timeframe != 3)             {             timeframe = 0;             printf (&quot;\\nInvalid response.\\n\\n&quot;);             }         }     }     while(timeframe != 1 &amp;&amp; timeframe != 2 &amp;&amp; timeframe != 3);      return 0; }"}, {"owner": {"reputation": 1, "user_id": 10287562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa13e2a42cd3a46168a796f21b7baf9?s=128&d=identicon&r=PG&f=1", "display_name": "Senile Old Fart", "link": "https://stackoverflow.com/users/10287562/senile-old-fart"}, "edited": false, "score": 0, "creation_date": 1535539082, "post_id": 52068891, "comment_id": 91100367, "body": "oops, my apologies. I think I should have put the four spaces first. Now it seems it&#39;s been too long and I can&#39;t edit now. Still learning my way around here."}], "owner": {"reputation": 1, "user_id": 10287562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa13e2a42cd3a46168a796f21b7baf9?s=128&d=identicon&r=PG&f=1", "display_name": "Senile Old Fart", "link": "https://stackoverflow.com/users/10287562/senile-old-fart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "closed_date": 1535512783, "answer_count": 0, "score": 0, "last_activity_date": 1535512556, "creation_date": 1535511896, "last_edit_date": 1535512556, "question_id": 52068891, "link": "https://stackoverflow.com/questions/52068891/how-do-i-sanitize-user-input-in-an-interactive-console-based-c-program", "closed_reason": "Duplicate", "title": "How do I sanitize user input in an interactive, console-based C program?", "body": "<p>Ok, I'm very rusty at C. I want to display text prompts and grab the user's response. Only when the response is valid (the numbers 1, 2 or 3) do I want to continue. The code below works fine as long as the input is numeric integers. Non-numeric input throws the Do While into a loop (like the scanf is ignored) and non-integer numbers get truncated. I think I may also want to test for EOF for null inputs too. Can someone kindly take a 2x4 to the side of my head and tell me what basic mistake I am making?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\n    int timeframe;\n    do\n    {   timeframe = 0;\n        printf(\"Select statistics set required:\\n\");\n        printf(\"   1. Daily period statistics\\n\");\n        printf(\"   2. Monthly period statistics\\n\");\n        printf(\"   3. Custom period statistics\\n\");\n        scanf(\"%d\", &amp;timeframe);\n    }\n    while(timeframe != 1 &amp;&amp; timeframe != 2 &amp;&amp; timeframe != 3 &amp;&amp; !isdigit(timeframe));\n    printf(\"time frame is %d\\n\", timeframe);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pthreads", "cbmc"], "answers": [{"tags": [], "owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "is_accepted": false, "score": 1, "last_activity_date": 1540190021, "creation_date": 1540190021, "answer_id": 52923519, "question_id": 52068850, "link": "https://stackoverflow.com/questions/52068850/cbmc-detected-an-assert-error-in-my-pthreads-program-is-it-correct/52923519#52923519", "title": "CBMC detected an assert error in my Pthreads program, is it correct?", "body": "<p>This looks to be a false positive on CBMC's part.</p>\n\n<p>We can see that the main thread will modify <code>a[0]</code>, <code>a[1]</code>, <code>b[0]</code>, and <code>b[1]</code>. </p>\n\n<p>Thread <code>thr1</code> modifies <code>a[2]</code>, <code>a[3]</code>, <code>b[2]</code>, and <code>b[3]</code>.</p>\n\n<p>There is actually no overlapping accesses between the the threads and so this program should behave as if it is being run sequentially.</p>\n\n<p>The error trace produced by CBMC does not make much sense either:</p>\n\n<pre><code>Counterexample:\n\nState 19 file test.c line 27 function main thread 0\n----------------------------------------------------\n  thr1=1ul (00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001)\n\nState 22 file test.c line 28 function main thread 0\n----------------------------------------------------\n  thread=&amp;thr1!0@1 (00000010 00000000 00000000 00000000 00000000 00000000 00000000 00000000)\n\nState 23 file test.c line 28 function main thread 0\n----------------------------------------------------\n  attr=((union pthread_attr_t { char __size[56l]; signed long int __align; } *)NULL) (00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000)\n\nState 24 file test.c line 28 function main thread 0\n----------------------------------------------------\n  start_routine=func1 (00000011 00000000 00000000 00000000 00000000 00000000 00000000 00000000)\n\nState 25 file test.c line 28 function main thread 0\n----------------------------------------------------\n  arg=NULL (00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000)\n\nState 47 file test.c line 29 function main thread 0\n----------------------------------------------------\n  me=NULL (00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000)\n\nState 48 file test.c line 8 function func thread 0\n----------------------------------------------------\n  i=0 (00000000 00000000 00000000 00000000)\n\nState 49 file test.c line 9 function func thread 0\n----------------------------------------------------\n  i=0 (00000000 00000000 00000000 00000000)\n\nState 51 file test.c line 10 function func thread 0\n----------------------------------------------------\n  b[0l]=0 (00000000 00000000 00000000 00000000)\n\nState 52 file test.c line 10 function func thread 0\n----------------------------------------------------\n  a[0l]=0 (00000000 00000000 00000000 00000000)\n\nState 54 file test.c line 9 function func thread 0\n----------------------------------------------------\n  i=1 (00000000 00000000 00000000 00000001)\n\nState 57 file test.c line 10 function func thread 0\n----------------------------------------------------\n  b[1l]=1 (00000000 00000000 00000000 00000001)\n\nState 58 file test.c line 20 function func1 thread 1\n----------------------------------------------------\n  b[2l]=2 (00000000 00000000 00000000 00000010)\n\nState 59 file test.c line 20 function func1 thread 1\n----------------------------------------------------\n  a[2l]=2 (00000000 00000000 00000000 00000010)\n\nState 61 file test.c line 19 function func1 thread 1\n----------------------------------------------------\n  i=3 (00000000 00000000 00000000 00000011)\n\nState 64 file test.c line 10 function func thread 0\n----------------------------------------------------\n  a[1l]=0 (00000000 00000000 00000000 00000000)\n\nViolated property:\n  file test.c line 11 function func\n  assertion a[i] == i\n  a[(signed long int)i] == i\n\n\nVERIFICATION FAILED\n</code></pre>\n\n<p>This counter example claims that <code>a[1] == 0</code>. However, state 64 shows <code>0</code> being assigned to <code>a[1]</code> even though the last written value to <code>b[1]</code> is <code>1</code> in state 57.</p>\n"}], "owner": {"reputation": 71, "user_id": 9688676, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bailin Lu", "link": "https://stackoverflow.com/users/9688676/bailin-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1540190021, "creation_date": 1535511463, "question_id": 52068850, "link": "https://stackoverflow.com/questions/52068850/cbmc-detected-an-assert-error-in-my-pthreads-program-is-it-correct", "title": "CBMC detected an assert error in my Pthreads program, is it correct?", "body": "<p>I use <strong>CBMC</strong> to verify my <strong>Pthreads</strong> program, it detected some <strong>assert errors</strong> which I don't think would exist. The error only occur when I run the two threads at the same time. That is to say, when I put one of the statement which calls the thread function(<code>func</code> or <code>func1</code>) into comment, CBMC can then verify it successful. Is there any conflict in the assignment of array <code>a</code> and <code>b</code>? </p>\n\n<pre><code>int a[4], b[4];\n\nstatic void * func(void * me)\n{\n  int i;\n  for(i=0; i&lt;2; i++){\n    a[i] = b[i] = i;\n    assert( a[i] == i ); //failed\n  }\n  return ((void *) 0);\n}\n\nstatic void * func1(void * me)\n{\n  int i;\n  for(i=2; i&lt;4; i++){\n    a[i] = b[i] = i;\n    assert( a[i] == i ); //failed\n  } \n  return ((void *) 0);\n}\n\nint main(){\n  pthread_t thr1;\n  pthread_create(&amp;thr1, NULL, func1, (void *)0);\n  (*func)(0);\n  pthread_join(thr1,NULL);\n\n  return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>The output of CBMC is as following:</p>\n</blockquote>\n\n<pre><code>Violated property:\n  file pthreads4.c line 25 function func1\n  assertion a[i] == i\n  a[(signed long int)i] == i\n\nVERIFICATION FAILED\n</code></pre>\n"}, {"tags": ["c", "return", "boolean", "printf", "conditional-statements"], "comments": [{"owner": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "edited": false, "score": 0, "creation_date": 1535510478, "post_id": 52068727, "comment_id": 91087415, "body": "How is there a <code>bool</code> in C?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "edited": false, "score": 2, "creation_date": 1535510591, "post_id": 52068727, "comment_id": 91087431, "body": "@Deanie C has has a boolean type since the 1999 standard. <a href=\"https://en.cppreference.com/w/c/types/boolean\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/types/boolean</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1535510768, "post_id": 52068727, "comment_id": 91087473, "body": "Maybe you mistakenly think <code>return true;</code> is part of the <code>if</code> condition?"}, {"owner": {"reputation": 373, "user_id": 5921021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/419FT.png?s=128&g=1", "display_name": "PYB", "link": "https://stackoverflow.com/users/5921021/pyb"}, "edited": false, "score": 0, "creation_date": 1535510768, "post_id": 52068727, "comment_id": 91087474, "body": "speller.c calls a header in which &lt;stdbool.h&gt; is #include-d"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1535510795, "post_id": 52068727, "comment_id": 91087478, "body": "Are you trying to compare different strings using <code>==</code>? Also, your function always returns true the first time through that while loop. (Modern versions of gcc, at least, will warn you about confusing indentation)"}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 1, "creation_date": 1535510889, "post_id": 52068727, "comment_id": 91087496, "body": "<code>if(trav-&gt;word == word)</code> looks suspiciously wrong.  That&#39;s not how you compare a string, unless of course you can guarantee that every unique &quot;word&quot; in your system has a unique pointer."}, {"owner": {"reputation": 373, "user_id": 5921021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/419FT.png?s=128&g=1", "display_name": "PYB", "link": "https://stackoverflow.com/users/5921021/pyb"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1535510899, "post_id": 52068727, "comment_id": 91087500, "body": "@M.M What do you mean?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1535511423, "post_id": 52068727, "comment_id": 91087601, "body": "This is why style guides almost universally insist on all conditional and loop bodies being brace-surrounded blocks. At least while you&#39;re learning, it&#39;s worth the trouble to obey such a style guide. (And you&#39;ll probably grow to like it). Also, <i>always</i> ask the compiler to warn you about questionable constructs. Many compilers these days will recognize incorrectly indented code such as yours, and warn you about misleading indentation."}, {"owner": {"reputation": 373, "user_id": 5921021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/419FT.png?s=128&g=1", "display_name": "PYB", "link": "https://stackoverflow.com/users/5921021/pyb"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1535511641, "post_id": 52068727, "comment_id": 91087646, "body": "@Shawn Thanks, figured out that I needed strcpy instead. Appreciate the pointer ;)"}, {"owner": {"reputation": 373, "user_id": 5921021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/419FT.png?s=128&g=1", "display_name": "PYB", "link": "https://stackoverflow.com/users/5921021/pyb"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535511741, "post_id": 52068727, "comment_id": 91087668, "body": "@rici Yeah I think I learned my lesson, will brace-surround everything moving forward."}], "answers": [{"tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 1, "last_activity_date": 1535510854, "creation_date": 1535510854, "answer_id": 52068777, "question_id": 52068727, "link": "https://stackoverflow.com/questions/52068727/bool-function-returns-true-without-meeting-condition-ignores-printf/52068777#52068777", "title": "Bool function returns true without meeting condition - ignores printf()", "body": "<p>This code block:</p>\n\n<pre><code>    if(trav-&gt;word == word)\n        printf(\"%s found in the dictionary\\n\", word);\n        return true;\n</code></pre>\n\n<p>Doesn't do what you think it does - add <code>{}</code> around everything you want to be included in the <code>if</code> statement:</p>\n\n<pre><code>if(trav-&gt;word == word) \n{\n    printf(\"%s found in the dictionary\\n\", word);\n    return true;\n}\n</code></pre>\n\n<p>Otherwise that <code>return true</code> happens every time (and as you saw, without necessarily printing).</p>\n"}, {"comments": [{"owner": {"reputation": 373, "user_id": 5921021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/419FT.png?s=128&g=1", "display_name": "PYB", "link": "https://stackoverflow.com/users/5921021/pyb"}, "edited": false, "score": 0, "creation_date": 1535511589, "post_id": 52068779, "comment_id": 91087635, "body": "Thanks a lot. I forgot to add the curly braces after I added a line for debugging. Regarding strcmp, I completely forgot about that function and how comparing strings doesn&#39;t work with ==. Cheers"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 373, "user_id": 5921021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/419FT.png?s=128&g=1", "display_name": "PYB", "link": "https://stackoverflow.com/users/5921021/pyb"}, "edited": false, "score": 0, "creation_date": 1535511676, "post_id": 52068779, "comment_id": 91087657, "body": "@PYB That&#39;s why you should always use curly braces for inner blocks, even if it&#39;s just one line."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1535510886, "creation_date": 1535510886, "answer_id": 52068779, "question_id": 52068727, "link": "https://stackoverflow.com/questions/52068727/bool-function-returns-true-without-meeting-condition-ignores-printf/52068779#52068779", "title": "Bool function returns true without meeting condition - ignores printf()", "body": "<p>Look closely:</p>\n\n<pre><code>while (trav != NULL)\n{\n    if(trav-&gt;word == word)\n        printf(\"%s found in the dictionary\\n\", word);\n        return true;\n    trav = trav-&gt;next;\n}\n</code></pre>\n\n<p>There are no curly braces around the <code>if</code> block.  So with proper indentation what you really have is:</p>\n\n<pre><code>while (trav != NULL)\n{\n    if(trav-&gt;word == word)\n        printf(\"%s found in the dictionary\\n\", word);\n    return true;\n    trav = trav-&gt;next;\n}\n</code></pre>\n\n<p>So you always return true on the first loop iteration.</p>\n\n<p>Also, you don't want to use <code>==</code> to compare strings.  What you end up doing is comparing the <em>pointer values</em>, which will almost always be not equal.  Use <code>strcmp</code> to compare strings instead.</p>\n\n<p>The fixed code:</p>\n\n<pre><code>while (trav != NULL)\n{\n    if(!strcmp(trav-&gt;word, word)) {\n        printf(\"%s found in the dictionary\\n\", word);\n        return true;\n    }\n    trav = trav-&gt;next;\n}\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 5921021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/419FT.png?s=128&g=1", "display_name": "PYB", "link": "https://stackoverflow.com/users/5921021/pyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 1, "accepted_answer_id": 52068779, "answer_count": 2, "score": 0, "last_activity_date": 1535510886, "creation_date": 1535510399, "last_edit_date": 1535510644, "question_id": 52068727, "link": "https://stackoverflow.com/questions/52068727/bool-function-returns-true-without-meeting-condition-ignores-printf", "title": "Bool function returns true without meeting condition - ignores printf()", "body": "<p>I've been working 5 days straight on this program, and can't figure out why it's acting like this. Thanks for helping me out.</p>\n\n<p>There is code in the file speller.c that calls 4 functions in the file dictionary.c<br>\nIn speller.c, it calls a certain function:</p>\n\n<pre><code>bool misspelled = !check(word);\n</code></pre>\n\n<p>If misspelled is false, it means the check function returned true.</p>\n\n<p>Here is the check function, in dictionary.c:</p>\n\n<pre><code>bool check(const char *word)\n{\n    int key = hash(word);\n    printf(\"Word: %s    position: %i\\n\", word, key);\n    node* trav = dictArray[key];\n\n    while (trav != NULL)\n    {\n        if(trav-&gt;word == word)\n            printf(\"%s found in the dictionary\\n\", word);\n            return true;\n        trav = trav-&gt;next;\n    }\n    printf(\"%s NOT found in the dictionary\\n\", word);\n    return false;\n</code></pre>\n\n<p>Check() will go check in a hash table if it can find the word passed as argument in a hash table, and prints each word and it's key. If it finds it, it prints a message and return <code>true</code>. If not, prints a message saying so, and return <code>false</code>.\nThe hash table is an array of 26 elements, each are a struct with 2 elements, one being a string, the other a pointer to the next struct (node) in the list.\nNodes are added to lists depending on the first letter of the word.</p>\n\n<p>The problem is that I have tested every word that gets added to the array, and even when the word is not there, the function still returns <code>true</code>.\nIn fact, it returns <code>true</code> for every word passed as argument.</p>\n\n<p>Now the really puzzling behavior is that check() has to print something to the screen, just before returning either <code>true</code> or <code>false</code>. Either <code>...found ...</code> or <code>... NOT found ...</code>.\nWell it doesn't. But it still returns 'true', which confuses me.</p>\n\n<p>Any help?\nShould I paste the whole code from both file?</p>\n"}, {"tags": ["c", "eclipse-plugin"], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 8228924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qyYyiiVaOTI/AAAAAAAAAAI/AAAAAAAAABI/IH2uWw8fH3o/photo.jpg?sz=128", "display_name": "Slahuddin Chaudhary", "link": "https://stackoverflow.com/users/8228924/slahuddin-chaudhary"}, "is_accepted": false, "score": 1, "last_activity_date": 1535526178, "last_edit_date": 1535526178, "creation_date": 1535506762, "answer_id": 52068335, "question_id": 52068287, "link": "https://stackoverflow.com/questions/52068287/i-think-i-didnt-correctly-install-c-c/52068335#52068335", "title": "I think I didn&#39;t correctly install C/C++", "body": "<p>Steps for installing C or C++ on eclipse are following.</p>\n\n<p>1) Install MinGW GCC or Cygwin GCC.</p>\n\n<p>2) Install Eclipse C/C++ Development Tool (CDT)</p>\n\n<p><strong>you must have GCC to run C/C++ on your system</strong></p>\n\n<p>Check the below given link for more details:</p>\n\n<p><a href=\"https://www.tutorialspoint.com/How-do-I-set-up-C-Cplusplus-on-Eclipse-in-Windows\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/How-do-I-set-up-C-Cplusplus-on-Eclipse-in-Windows</a></p>\n"}], "owner": {"reputation": 5, "user_id": 9545551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b72daa237bd02f6ec790b145d7f6405?s=128&d=identicon&r=PG&f=1", "display_name": "bill", "link": "https://stackoverflow.com/users/9545551/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "closed_date": 1535544011, "answer_count": 1, "score": -3, "last_activity_date": 1535526178, "creation_date": 1535506218, "last_edit_date": 1535525440, "question_id": 52068287, "link": "https://stackoverflow.com/questions/52068287/i-think-i-didnt-correctly-install-c-c", "closed_reason": "Needs details or clarity", "title": "I think I didn&#39;t correctly install C/C++", "body": "<p><a href=\"https://i.stack.imgur.com/qSgBq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qSgBq.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm unsure exactly what this means tried installing C plug in to eclipse.</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1535505360, "post_id": 52068178, "comment_id": 91086403, "body": "you can do your second thing - <code>malloc(i *...</code>. The first one is a non standard c extension (variable length array)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1535505535, "post_id": 52068178, "comment_id": 91086447, "body": "Look up <code>realloc</code>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535506022, "post_id": 52068178, "comment_id": 91086566, "body": "4k (or 8k on 64-bit systems) ain&#39;t gonna break the bank. I&#39;d say you&#39;ve already wasted enough time here. But you should learn about <code>realloc</code> if you&#39;re going to code in C."}, {"owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535506111, "post_id": 52068178, "comment_id": 91086576, "body": "@rici I agree that what I have here is probably pointless and the code I have now is fine, I just posted it as I couldn&#39;t find an answer so that now there will be one for other people in a similar situation."}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 1, "creation_date": 1535506115, "post_id": 52068178, "comment_id": 91086577, "body": "It&#39;s only 1024 times sizeof(char *). You could simply realloc (downwards) afterwards."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1535507111, "post_id": 52068178, "comment_id": 91086743, "body": "depending on your further usage, you could be better off using a linked list instead fo the array. This way you can allocate as many entries as you really need."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535509165, "post_id": 52068178, "comment_id": 91087181, "body": "Is 1024 an upper bound?"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1535505756, "creation_date": 1535505756, "answer_id": 52068230, "question_id": 52068178, "link": "https://stackoverflow.com/questions/52068178/dynamically-allocate-memory-for-string-array-in-c/52068230#52068230", "title": "Dynamically Allocate Memory for String Array in C", "body": "<p>You can use <code>realloc</code> to change the size of an allocated memory block:</p>\n\n<pre><code>int i = 0;\nint len = 10;\nchar **mountslist = malloc(len * sizeof(char *));\n\nwhile ((ent = getmntent(mounts)) != NULL) {\n    if (i &gt;= len) {\n        len *= 2;\n        char **tmp = realloc(mountslist, len * sizeof(char *));\n        if (tmp) {\n            mountslist = tmp;\n        }\n    }\n    mountslist[i] = strdup(ent-&gt;mnt_dir);\n    i++;\n}\n</code></pre>\n\n<p>As shown above, a good rule is to double the amount of space you allocate when you run out of space.  That prevents excessive calls to <code>realloc</code> which may move the allocated memory each time.</p>\n"}], "owner": {"reputation": 714, "user_id": 5849262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aea9a350d929ede34c328ca570d84487?s=128&d=identicon&r=PG&f=1", "display_name": "Billy", "link": "https://stackoverflow.com/users/5849262/billy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 52068230, "answer_count": 1, "score": 3, "last_activity_date": 1535505756, "creation_date": 1535505254, "question_id": 52068178, "link": "https://stackoverflow.com/questions/52068178/dynamically-allocate-memory-for-string-array-in-c", "title": "Dynamically Allocate Memory for String Array in C", "body": "<p>I'm trying to store a list of every mount point on a Linux system in a string array with C. I'm focused on this piece of code.</p>\n\n<pre><code>int i = 0;\nchar **mountslist = malloc(1024 * sizeof(char *));\n\n/*\n * Make sure that the number entries in the array are less than the allocated\n * 1024 in the absurd case that the system has that many mount points.\n */\nwhile (i &lt; 1024 &amp;&amp; (ent = getmntent(mounts))) {\n    /*\n     * The output of getmntent(mounts) goes down to\n     * the next mount point every time it is called.\n     */\n    mountslist[i] = strdup(ent-&gt;mnt_dir);\n    i++;\n}\n</code></pre>\n\n<p>I was wondering how I could dynamically allocate the number of entries in the <code>mountslist</code> array (currently statically set at 1024) to avoid that limit and wasting memory. If I had the final value of <code>i</code> when declaring <code>mountslist</code> I could use <code>char *mountslist[i];</code> or <code>char **mountslist = malloc(i * sizeof(char *));</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1535504056, "post_id": 52068024, "comment_id": 91086153, "body": "This misunderstands the function calling syntax for C. You don&#39;t name the return type when you&#39;re calling a function. <code>totalLoanBalance = pow(...</code> is correct."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10287309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6xdP6C3ghng/AAAAAAAAAAI/AAAAAAAAAHg/O3-vsOu_PSE/photo.jpg?sz=128", "display_name": "Dominic Pelini", "link": "https://stackoverflow.com/users/10287309/dominic-pelini"}, "edited": false, "score": 0, "creation_date": 1535504330, "post_id": 52068054, "comment_id": 91086208, "body": "When i take out the double, I get this error message then                                             In function <code>main&#39;: loans.c:(.text+0xaf): undefined reference to </code>pow&#39; collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 10287309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6xdP6C3ghng/AAAAAAAAAAI/AAAAAAAAAHg/O3-vsOu_PSE/photo.jpg?sz=128", "display_name": "Dominic Pelini", "link": "https://stackoverflow.com/users/10287309/dominic-pelini"}, "edited": false, "score": 0, "creation_date": 1535504388, "post_id": 52068054, "comment_id": 91086220, "body": "@DominicPelini That&#39;s because you didn&#39;t link in the math library, which is where <code>pow</code> resides.  Add <code>-lm</code> to the command line when compiling."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 10287309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6xdP6C3ghng/AAAAAAAAAAI/AAAAAAAAAHg/O3-vsOu_PSE/photo.jpg?sz=128", "display_name": "Dominic Pelini", "link": "https://stackoverflow.com/users/10287309/dominic-pelini"}, "edited": false, "score": 0, "creation_date": 1535504730, "post_id": 52068054, "comment_id": 91086282, "body": "@DominicPelini Glad I could help.  Feel free to <a href=\"https://stackoverflow.com/help/accepted-answer\">accept this answer</a> if you found it useful."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1535504142, "creation_date": 1535504142, "answer_id": 52068054, "question_id": 52068024, "link": "https://stackoverflow.com/questions/52068024/error-expected-expression-before-double-cant-get-power-function-to-work/52068054#52068054", "title": "error: expected expression before \u2018double\u2019. Can&#39;t get power function to work", "body": "<p>You don't specify the return type of a function when you call it, only when it's defined or declared.</p>\n\n<pre><code>totalLoanBalance = pow(interestRateAndPrincipal, yearsOutstanding) * LoansTaken;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10287309, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6xdP6C3ghng/AAAAAAAAAAI/AAAAAAAAAHg/O3-vsOu_PSE/photo.jpg?sz=128", "display_name": "Dominic Pelini", "link": "https://stackoverflow.com/users/10287309/dominic-pelini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 777, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1535504142, "creation_date": 1535503969, "question_id": 52068024, "link": "https://stackoverflow.com/questions/52068024/error-expected-expression-before-double-cant-get-power-function-to-work", "title": "error: expected expression before \u2018double\u2019. Can&#39;t get power function to work", "body": "<p>I am making a basic program the will give you the interest rate of my loans after\na designated amount of years.  to do so, I need to use the power formula.</p>\n\n<pre><code>    totalLoanBalance = Double pow(interestRateAndPrincipal, yearsOutstanding) * LoansTaken;\n</code></pre>\n\n<p>but when I enter this information, I get this error</p>\n\n<pre><code>    error: expected expression before \u2018double\u2019\n totalLoanBalance = double pow(interestRateAndPrincipal, yearsOutstanding) * loansTaken;\n                    ^\n</code></pre>\n\n<p>I have tried putting double in front of the variables in parentheses, and a few other strategies, but I can't seem to fix it.  I also don't grasp what the error is telling me.  Thanks for your help.</p>\n"}, {"tags": ["php", "c", "swig"], "comments": [{"owner": {"reputation": 2107, "user_id": 7451787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lNcOE.jpg?s=128&g=1", "display_name": "bcperth", "link": "https://stackoverflow.com/users/7451787/bcperth"}, "edited": false, "score": 0, "creation_date": 1535504564, "post_id": 52067865, "comment_id": 91086248, "body": "I suggest show more, such as full signature of getBytes() and maybe the process steps to build the PHP extension and how you are using in PHP."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1535570964, "post_id": 52067865, "comment_id": 91119870, "body": "Also return the length as an argument? <code>char* getBytes(size_t *pLen)</code> or probably better <code>size_t *getBytes(char *pData)</code>."}], "owner": {"reputation": 55, "user_id": 8338496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be30c1f52345535b5275b434a35906f6?s=128&d=identicon&r=PG&f=1", "display_name": "ppmag", "link": "https://stackoverflow.com/users/8338496/ppmag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535502442, "creation_date": 1535502442, "question_id": 52067865, "link": "https://stackoverflow.com/questions/52067865/swig-php-7-how-to-pass-binary-data-from-c-to-php-non-zero-terminated", "title": "SWIG &amp; PHP 7 - how to pass binary data from C to PHP (non zero-terminated)?", "body": "<p>C function <code>getBytes()</code> internally allocates n bytes (raw data, may include zeroes).</p>\n\n<p>When specifying it in interface as <code>char* getBytes()</code>, at PHP side data looks truncated at first zero byte.</p>\n\n<p>What is SWIG way of returning arbitrary binary data (length is known at C side) to scripting languages?\nPortable solution is preferred, but PHP is a must.</p>\n"}, {"tags": ["c", "fgets"], "comments": [{"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1535502705, "post_id": 52067856, "comment_id": 91085901, "body": "Your analysis of the behavior of <code>fgets()</code> and <code>gets_s()</code> is correct.  It&#39;s usually stated that both of them add a trailing <code>&#39;\\0&#39;</code> to the string, but that <code>fgets()</code> also includes the trailing newline as well.  As for how to handle this, that&#39;s largely up to you.  A common pattern is to strip the trailing newline from the input if you&#39;re using <code>fgets()</code>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1535505285, "post_id": 52067856, "comment_id": 91086387, "body": "This behavior is described in the manual <a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\">linux.die.net/man/3/fgets</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1535521562, "post_id": 52067856, "comment_id": 91090231, "body": "Another nice trick for stripping the newline is <code>strtok(line, &#39;\\n&#39;)</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535673655, "post_id": 52067856, "comment_id": 91164517, "body": "I prefer a more &#39;fool proof&#39; method of stripping (a possible) trailing newline by:  <code>char input[ 1024];  fgets( input, sizeof( input), stdin );  input[ strcspn( input, &quot;\\n&quot; ) ] = &#39;\\0&#39;;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1535504344, "last_edit_date": 1535504344, "creation_date": 1535503817, "answer_id": 52068004, "question_id": 52067856, "link": "https://stackoverflow.com/questions/52067856/how-does-fgets-treat-enter-key-press/52068004#52068004", "title": "How does fgets treat enter key press?", "body": "<blockquote>\n  <p>How does fgets treat enter key press?</p>\n</blockquote>\n\n<p>Just like any other key, other than it is 1 of 4 reasons to stop reading more.</p>\n\n<hr>\n\n<p>\" fgets takes the string till an enter key is pressed, \" is a causal explanation.</p>\n\n<p>Let us go deeper</p>\n\n<p><code>char *fgets(char *s, int n, FILE *stream);</code> does not read a <em>string</em> as C defines a <em>string</em> (characters up to and including the <em>null character</em>).  <code>fgets()</code> reads a <em>line</em> of characters (characters up to and including the <code>'\\n'</code>).  It reads them up to a certain point - leaving the rest for later.</p>\n\n<ol>\n<li>A <code>'\\n'</code> is read (and saved).</li>\n<li>The input buffer is nearly full.  (all but 1)</li>\n<li>End of file occurs.</li>\n<li>Rare input error occurs.</li>\n</ol>\n\n<p>In cases 1, 2 and 3 (if at least something was read), a <em>null character</em> is appended to the input.  Now the input is certainly a <em>string</em> and the function return <code>s</code>.  In other cases the function returns <code>(char *) NULL</code>.</p>\n\n<p>Note the if <code>fgets()</code> reads <em>null characters</em>, they are treated like any other non-<code>'\\n'</code>.</p>\n\n<hr>\n\n<p><kbd>Enter</kbd> causes <code>'\\n'</code>:  That is a character too.</p>\n\n<p>The <code>'\\n'</code> might need to be discarded for later processing.  In that case simply lop it off.  Since the input might not contain <code>'\\n'</code>, robust code does not rely on its presence.  Nor does robust code assume the first character is not a <em>null character</em>.</p>\n\n<pre><code>size_t len = strlen(s);\nif (len &gt; 0 &amp;&amp; s[len-1] == '\\n') {\n  s[--len] = '\\0';\n}\n\n// OR\n\ns[strcspsn(s, \"\\n\")] = '\\0';\n</code></pre>\n\n<hr>\n\n<p>OP's explanation of <code>gets_s()</code> has similar detail missing in OP's desciption: special functionality on buffer full, end-of-file and error.</p>\n"}], "owner": {"reputation": 69, "user_id": 10262257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xxA7TSpLO10/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOrckxBxgKUrgbZuthzTglSWGcQBA/mo/photo.jpg?sz=128", "display_name": "Bhawandeep Singh", "link": "https://stackoverflow.com/users/10262257/bhawandeep-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2273, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535504344, "creation_date": 1535502371, "last_edit_date": 1535502582, "question_id": 52067856, "link": "https://stackoverflow.com/questions/52067856/how-does-fgets-treat-enter-key-press", "title": "How does fgets treat enter key press?", "body": "<p>What I am seeing is that while accepting a string - fgets takes the string till an enter key is pressed, and in the end it DOES NOT replace the enter key with \\0 - rather appends \\0 to the string including enter key.\nIn comparison, gets_s takes the string till enter key is pressed and in the end - replaces the last enter key with \\0.</p>\n\n<p>Is this correct. Please add, correct, confirm.\nAlso does this mean. my string handling operations that operate character by character till they encounter a \\0 - will now - with fgets - operate on a newline character as well ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nint main()\n{\n\n    char i[32];\n\n    printf(\"Enter a string of size 32 or less characters \\n\");\n    gets_s(i, sizeof(i));\n    //fgets(i, sizeof(i), stdin);\n\n    printf(\"With right justification, field width = 32 and precision = 10 -&gt; i = ||%32.10s||\\n\", i);\n    printf(\"With left justification, field width = 32 and precision = 10 -&gt; i = ||%-32.10s||\\n\", i);\n    printf(\"With right justification, field width = 10 and precision = 32 -&gt; i = ||%10.32s||\\n\", i);\n    printf(\"With left justification, field width = 10 and precision = 32 -&gt; i = ||%-10.32s||\\n\", i);\n\n\n    _getch();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1535499885, "creation_date": 1535499885, "answer_id": 52067582, "question_id": 52067542, "link": "https://stackoverflow.com/questions/52067542/questions-about-pointer-to-pointer/52067582#52067582", "title": "Questions about pointer to pointer", "body": "<p>You have <code>hashnode</code> set up as an array of pointers.  So you want to assign a pointer to a given array element, not the address of a pointer:</p>\n\n<pre><code>hasht.hashnode[key] = node;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "edited": false, "score": 0, "creation_date": 1535539507, "post_id": 52069543, "comment_id": 91100626, "body": "Can you explain why hashnode[key] is only a pointer to a struct Node? any tutorials i can reference? Thanks a lot for your help. I get a bit confused when it is relates to pointer to pointer."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "edited": false, "score": 0, "creation_date": 1535539863, "post_id": 52069543, "comment_id": 91100852, "body": "Here is a good resource that can help you: <a href=\"https://www.studytonight.com/c/pointers-with-array.php\" rel=\"nofollow noreferrer\">studytonight.com/c/pointers-with-array.php</a>"}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1535517273, "creation_date": 1535517273, "answer_id": 52069543, "question_id": 52067542, "link": "https://stackoverflow.com/questions/52067542/questions-about-pointer-to-pointer/52069543#52069543", "title": "Questions about pointer to pointer", "body": "<blockquote>\n  <p>any idea what i did wrong? What am i conceptually wrong?</p>\n</blockquote>\n\n<p>Although <code>hashnode</code> is a pointer to pointer to a <code>struct Node</code>, <code>hashnode[key]</code> is only a pointer to a <code>struct Node</code>.\nBut <code>&amp;node</code> is again an address (or pointer) to a pointer to a <code>struct Node</code>. So the following assignment fails:  </p>\n\n<pre><code>hasht.hashnode[key] = &amp;node;\n</code></pre>\n\n<p>And the compiler complains rightly.</p>\n\n<p>You have to do the following:  </p>\n\n<pre><code>hasht.hashnode[key] = node;\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 52069543, "answer_count": 2, "score": 1, "last_activity_date": 1535517273, "creation_date": 1535499599, "last_edit_date": 1535499959, "question_id": 52067542, "link": "https://stackoverflow.com/questions/52067542/questions-about-pointer-to-pointer", "title": "Questions about pointer to pointer", "body": "<p>i would like to link the hashnode with the node. As <code>hashnode</code> is the <code>Node**</code> (a pointer to pointer of node), hence the value of <code>hashnode</code> should be the address of node pointer (i.e. <code>&amp;node</code>). my code is below.</p>\n\n<p>However, it shows an error to me that incompatible pointer types assigning to <code>struct Node *</code> from <code>Node **</code> (aka <code>struct Node **</code>); remove &amp;.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Hashnode\n{\n    int size;\n    struct Node** hashnode;\n}Hashtable;\n\n\ntypedef struct Node\n{\n    char* word;\n    struct Node* next;\n}Node;\n\nint main(void)\n{\n    Node* node = malloc(sizeof(Node));\n    node-&gt;word = \"Elvin\";\n    node-&gt;next = NULL;\n    printf(\"First Node created successfully!...\\n\");\n\n    Hashtable hasht;\n\n    hasht.size = 10;\n    hasht.hashnode = malloc(sizeof(*hasht.hashnode)*hasht.size);\n    for (int i = 0; i &lt; hasht.size; i++)\n    {\n        hasht.hashnode[i] = NULL;\n        printf(\"the address of the %i hashnode is: %p\\n\", i, hasht.hashnode[i]);\n    }\n    printf(\"The hashtable is created successfully!...\\n\");\n\n    int key = 3;\n    hasht.hashnode[key] = &amp;node;\n}\n</code></pre>\n\n<p>any idea what i did wrong? What am i conceptually wrong?</p>\n"}, {"tags": ["c", "gcc", "static"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 3, "creation_date": 1535498281, "post_id": 52067353, "comment_id": 91085079, "body": "Nonsense code - nonsense  messages"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1535499584, "post_id": 52067353, "comment_id": 91085334, "body": "Interesting fact: It compiles with clang, but not gcc."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 3, "creation_date": 1535502611, "post_id": 52067353, "comment_id": 91085880, "body": "I&#39;m surprised at clang&#39;s behavior given <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.9.2p3\" rel=\"nofollow noreferrer\">6.9.2p3</a> &quot;If the declaration of an identifier for an object is a tentative definition and has internal linkage, the declared type shall not be an incomplete type.&quot;"}, {"owner": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 3, "creation_date": 1535504225, "post_id": 52067353, "comment_id": 91086183, "body": "The end of <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.9.2p2\" rel=\"nofollow noreferrer\">6.9.2p2</a> gives the behavior if a tentative definition is unresolved by the end of the translation unit---it is instantiated as &quot;a file scope declaration of that identifier [...] with an initializer equal to 0&quot;; The case of a missing array dimension is explicitly covered in an example at <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.9.2p5\" rel=\"nofollow noreferrer\">6.9.2p5</a> where the implicit initializer is interpreted to give it dimension 1 (as in the OP&#39;s second case).    Perhaps <code>gcc</code> failed to actually render the final definition because it lacked the dim?"}, {"owner": {"reputation": 351, "user_id": 10270446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d380ddf5bbaed0b244a1e9cb8be0b264?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Janney", "link": "https://stackoverflow.com/users/10270446/jim-janney"}, "edited": false, "score": 1, "creation_date": 1535522761, "post_id": 52067353, "comment_id": 91090684, "body": "The version with the static definition fails to compile with <code>gcc -pedantic</code>."}, {"owner": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 1, "creation_date": 1535597230, "post_id": 52067353, "comment_id": 91127328, "body": "If you supply the implicit interpretation explicitly at the end of the file, then gcc accepts it.  I.e., add <code>static int arr[1] = {0};</code> as the last line in unit.c.  So it seems like <code>gcc</code> really is just failing to resolve the tentative definition.  File it as a bug and see what they say."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 1, "creation_date": 1535883402, "post_id": 52067353, "comment_id": 91221732, "body": "@lockcmpxchg8b 6.9.2p3  &quot;If the declaration of an identifier for an object is a tentative definition and has internal linkage, the declared type shall not be an incomplete type&quot;."}, {"owner": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1535895755, "post_id": 52067353, "comment_id": 91224811, "body": "@n.m. interesting point.  And clearly from <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.2.2p3\" rel=\"nofollow noreferrer\">6.2.2p3</a> the OP&#39;s variable has internal linkage.  I don&#39;t know how to rectify that with either p2, or the example at p5.  Especially since they say &quot;declared type&quot; and not &quot;composite type&quot;."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 0, "creation_date": 1536068234, "post_id": 52067353, "comment_id": 91285134, "body": "@lockcmpxchg8b, the reconciliation is that the example in 6.9.2/5 applies to a declaration of an object with <i>external</i> linkage.  Per 6.9.2/3, the corresponding declaration with internal linkage is non-conforming, so the situation described in 6.9.2/5 can never be achieved in that case.  GCC rejects the latter when the <code>-pedantic</code> option is in effect."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 1955, "user_id": 8967928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0acd9a5526f9cfc04266e4e2b83f60?s=128&d=identicon&r=PG&f=1", "display_name": "lockcmpxchg8b", "link": "https://stackoverflow.com/users/8967928/lockcmpxchg8b"}, "edited": false, "score": 0, "creation_date": 1552418267, "post_id": 52067353, "comment_id": 96999883, "body": "@lockcmpxchg8b - see more <a href=\"https://stackoverflow.com/a/55109661/4025095\">discussion about an alternative (and, IMHO, much more harmonious) interpretation for section 6.9.2.3</a>."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1536066355, "post_id": 52167016, "comment_id": 91283760, "body": "It is possible that these non-standard extensions were removed from the default gnu11 somewhere along the way, in newer gcc versions. I don&#39;t know that."}, {"owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1536067783, "post_id": 52167016, "comment_id": 91284799, "body": "Thank you for the info and interesting bits of history!"}, {"owner": {"reputation": 326, "user_id": 4975230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQ8VO.jpg?s=128&g=1", "display_name": "jrh", "link": "https://stackoverflow.com/users/4975230/jrh"}, "edited": false, "score": 0, "creation_date": 1536330658, "post_id": 52167016, "comment_id": 91398367, "body": "I know this is tagged gcc, but just to give another example, winapi (and thus Microsoft&#39;s C compiler) makes use of the &quot;struct hack&quot; often as well. It&#39;s not limited to the GNU world and unfortunately the APIs requiring the &quot;struct hack&quot; in Windows aren&#39;t going away any time soon; I&#39;d imagine this impacts WINE as well."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 12, "last_activity_date": 1536069570, "last_edit_date": 1536069570, "creation_date": 1536066245, "answer_id": 52167016, "question_id": 52067353, "link": "https://stackoverflow.com/questions/52067353/why-is-this-statement-producing-a-linker-error-with-gcc/52167016#52167016", "title": "Why is this statement producing a linker error with gcc?", "body": "<p>Empty arrays <code>static int arr[];</code> and zero-length arrays <code>static int arr[0];</code> were <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"noreferrer\">gcc non-standard extensions</a>. </p>\n\n<p>The intention of these extensions were to act as a fix for the old \"struct hack\". Back in the C90 days, people wrote code such as this:</p>\n\n<pre><code>typedef struct\n{\n  header stuff;\n  ...\n  int data[1]; // the \"struct hack\"\n} protocol;\n</code></pre>\n\n<p>where <code>data</code> would then be used as if it had variable size beyond the array depending on what's in the header part. Such code was buggy, wrote data to padding bytes and invoked array out-of-bounds undefined behavior in general.</p>\n\n<p>gcc fixed this problem by adding empty/zero arrays as a compiler extension, making the code behave without bugs, although it was no longer portable.</p>\n\n<p>The C standard committee recognized that this gcc feature was useful, so they added <em>flexible array members</em> to the C language in 1999. Since then, the gcc feature is to be regarded as obsolete, as using the C standard flexible array member is to prefer. </p>\n\n<p>As recognized by the linked gcc documentation:</p>\n\n<blockquote>\n  <p>Declaring zero-length arrays in other contexts, including as interior members of structure objects or as non-member objects, is discouraged.</p>\n</blockquote>\n\n<p>And this is what your code does.</p>\n\n<p>Note that gcc with no compiler options passed defaults to <code>-std=gnu90</code> (gcc &lt; 5.0) or <code>-std=gnu11</code>(gcc > 5.0). This gives you all the non-standard extensions enabled, so the program compiles but does not link.</p>\n\n<p>If you want standard compliant behavior, you must compile as</p>\n\n<pre><code>gcc -std=c11 -pedantic-errors\n</code></pre>\n\n<p>The <code>-pedantic</code> flag disables gcc extensions, and the linker error switches to a compiler error as expected. For an empty array as in your case, you get:</p>\n\n<blockquote>\n  <p>error: array size missing in 'arr'</p>\n</blockquote>\n\n<p>And for a zero-length array you get:</p>\n\n<blockquote>\n  <p>error: ISO C forbids zero-size array 'arr' [-Wpedantic]</p>\n</blockquote>\n\n<hr>\n\n<p>The reason why <code>int arr[]</code> works, is because this is an array declaration of <a href=\"https://stackoverflow.com/questions/3095861/about-tentative-definition\"><em>tentative definition</em></a> with external linkage (see C17 6.9.2). It is valid C and can be regarded as a forward declaration. It means that elsewhere in the code, the compiler (or rather the linker) should expect to find for example <code>int arr[10]</code>, which is then referring to the same variable. This way, <code>arr</code> can be used in the code before the size is known. (I wouldn't recommend using this language feature, as it is a form of \"spaghetti programming\".)</p>\n\n<p>When you use <code>static</code> you block the possibility to have the array size specified elsewhere, by forcing the variable to have internal linkage instead.</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 10315540, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tfKuXL0DQ6U/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMJoywZbPodrtt_er-33xRqUKKivQ/mo/photo.jpg?sz=128", "display_name": "Andreas Kretzer", "link": "https://stackoverflow.com/users/10315540/andreas-kretzer"}, "is_accepted": false, "score": 0, "last_activity_date": 1536075254, "creation_date": 1536075254, "answer_id": 52169796, "question_id": 52067353, "link": "https://stackoverflow.com/questions/52067353/why-is-this-statement-producing-a-linker-error-with-gcc/52169796#52169796", "title": "Why is this statement producing a linker error with gcc?", "body": "<p>Maybe one reason for this behavior is that the compiler issues a warning resulting in a non-accessed <code>static</code> variable and optimizes it away - the linker will complain!</p>\n\n<p>If it is not static, it cannot simply be ignored, because other modules might reference it - so the linker can at least find that symbol <code>arr</code>.</p>\n"}], "owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 2, "accepted_answer_id": 52167016, "answer_count": 2, "score": 13, "last_activity_date": 1547213412, "creation_date": 1535497890, "last_edit_date": 1547213412, "question_id": 52067353, "link": "https://stackoverflow.com/questions/52067353/why-is-this-statement-producing-a-linker-error-with-gcc", "title": "Why is this statement producing a linker error with gcc?", "body": "<p>I have this extremely trivial piece of C code:</p>\n\n<pre><code>static int arr[];\nint main(void) {\n    *arr = 4;\n    return 0;\n}\n</code></pre>\n\n<p>I understand that the first statement is illegal (I've declared a file-scope array with static storage duration and file linkeage but no specified size), but why is it resulting in a linker error? : </p>\n\n<pre><code>/usr/bin/ld: /tmp/cch9lPwA.o: in function `main':\nunit.c:(.text+0xd): undefined reference to `arr'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Shouldn't the compiler be able to catch this before the linker?</p>\n\n<p>It is also strange to me that, if I omit the <code>static</code> storage class, the compiler simply assumes array is of length <code>1</code> and produces no error beyond that:</p>\n\n<pre><code>int arr[];\nint main(void) {\n    *arr = 4;\n    return 0;\n}\n</code></pre>\n\n<p>Results in: </p>\n\n<pre><code>unit.c:5:5: warning: array 'arr' assumed to have one element\n int arr[];\n</code></pre>\n\n<p>Why does omitting the storage class result in different behavior here and why does the first piece of code produce a linker error? Thanks.</p>\n"}, {"tags": ["c++", "c", "ascii", "special-characters", "clipboard"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1535498516, "post_id": 52067338, "comment_id": 91085126, "body": "The clipboard doesn&#39;t contain anything different. Whatever you&#39;re using to display it isn&#39;t configured to use the proper font. You need to use one that uses the ASCII (OEM) character set, such as the Terminal font on Windows."}, {"owner": {"reputation": 71, "user_id": 8389189, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d68fe6ccd723d9e784386160b308f1bb?s=128&d=identicon&r=PG&f=1", "display_name": "JH_WK", "link": "https://stackoverflow.com/users/8389189/jh-wk"}, "edited": false, "score": 0, "creation_date": 1535498592, "post_id": 52067338, "comment_id": 91085140, "body": "The problem is, directly copying it from TS (using select and crtl + c) can show the character just fine."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1535498601, "post_id": 52067338, "comment_id": 91085143, "body": "Are you sure it&#39;s just <code>&#226;</code> and not <code>&#226;\u2022</code>?"}, {"owner": {"reputation": 71, "user_id": 8389189, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d68fe6ccd723d9e784386160b308f1bb?s=128&d=identicon&r=PG&f=1", "display_name": "JH_WK", "link": "https://stackoverflow.com/users/8389189/jh-wk"}, "edited": false, "score": 0, "creation_date": 1535498668, "post_id": 52067338, "comment_id": 91085161, "body": "Duskwuff, for char you are correct, not for WCHAR though. Your comment seems like you understand why this is happening and how to fix it, any ideas?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1535531986, "post_id": 52067338, "comment_id": 91095842, "body": "@JH_WK: You have to understand that ultimately, characters are numbers. Different character sets have different characters for the same number."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1535499831, "post_id": 52067464, "comment_id": 91085392, "body": "Nah. We&#39;ll just anonymously downvote you and leave no hints as to why. Mu. Mhuhu. Mhuhahahahahaha! Power! Unlimited power!"}, {"owner": {"reputation": 71, "user_id": 8389189, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d68fe6ccd723d9e784386160b308f1bb?s=128&d=identicon&r=PG&f=1", "display_name": "JH_WK", "link": "https://stackoverflow.com/users/8389189/jh-wk"}, "edited": false, "score": 0, "creation_date": 1535532253, "post_id": 52067464, "comment_id": 91096019, "body": "That worked, thanks! But for some odd reason the WINAPI solution threw a compiler error. Appearently the function doesn&#39;t like a pointer to an WCHAR array, but rather wants an allocated WCHAR* pointer. <code>WCHAR* text = (WCHAR*)malloc(140 * sizeof(WCHAR));</code> <code>MultiByteToWideChar(CP_UTF8, 0, tx, -1, text, 140);</code>"}, {"owner": {"reputation": 8101, "user_id": 9199167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqdLV.jpg?s=128&g=1", "display_name": "Max Vollmer", "link": "https://stackoverflow.com/users/9199167/max-vollmer"}, "reply_to_user": {"reputation": 71, "user_id": 8389189, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d68fe6ccd723d9e784386160b308f1bb?s=128&d=identicon&r=PG&f=1", "display_name": "JH_WK", "link": "https://stackoverflow.com/users/8389189/jh-wk"}, "edited": false, "score": 0, "creation_date": 1535534536, "post_id": 52067464, "comment_id": 91097465, "body": "@JH_WK No need to dynamically allocate it. Removing the <code>&amp;</code> should suffice. I updated my answer."}], "tags": [], "owner": {"reputation": 8101, "user_id": 9199167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqdLV.jpg?s=128&g=1", "display_name": "Max Vollmer", "link": "https://stackoverflow.com/users/9199167/max-vollmer"}, "is_accepted": true, "score": 4, "last_activity_date": 1535534546, "last_edit_date": 1535534546, "creation_date": 1535498885, "answer_id": 52067464, "question_id": 52067338, "link": "https://stackoverflow.com/questions/52067338/windows-clipboard-wont-preserve-ascii-character/52067464#52067464", "title": "Windows Clipboard won&#39;t preserve ASCII character", "body": "<p><code>wchar_t</code> is <code>UTF-16</code> encoded, but the data you get is <code>UTF-8</code> encoded. You don't convert between these two encodings, you simply reinterpret the bytes.</p>\n\n<p>Looking at the code points for those characters it should become obvious what's happening: The UTF-8 code point for <code>\u2560</code> is <code>0xE2 0x95 0xA0</code> and the UTF-16 code point for <code>\u00e2</code> is <code>0x00 0xE2</code>, while the UTF-16 code point for <code>\u2560</code> is <code>0x25 0x60</code>.</p>\n\n<p><code>swprintf(text, 140, L\"%hs\", tx);</code> &lt;- This simply converts each <code>char</code> into a <code>wchar_t</code>, turning the 3 byte <code>UTF-8</code> code point <code>0xE2 0x95 0xA0</code> into three 2 byte <code>UTF-16</code> code points: <code>0x00 0xE2</code>, <code>0x00 0x95</code> and <code>0x00 0xA0</code>.</p>\n\n<p>To get <code>0x25 0x60</code> from <code>0xE2 0x95 0xA0</code> you need to actually convert the data:</p>\n\n<pre><code>std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;char16_t&gt;&gt; converter;\nstd::wstring text = converter.from_bytes(tx);\n</code></pre>\n\n<p>Alternatively, since you are using WINAPI already, you can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar\" rel=\"nofollow noreferrer\"><code>MultiByteToWideChar</code></a>:</p>\n\n<pre><code>WCHAR text[140];\nint length = MultiByteToWideChar(CP_UTF8, 0, tx, -1, (LPWSTR)text, 140);\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8389189, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d68fe6ccd723d9e784386160b308f1bb?s=128&d=identicon&r=PG&f=1", "display_name": "JH_WK", "link": "https://stackoverflow.com/users/8389189/jh-wk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 52067464, "answer_count": 1, "score": -1, "last_activity_date": 1535534546, "creation_date": 1535497774, "question_id": 52067338, "link": "https://stackoverflow.com/questions/52067338/windows-clipboard-wont-preserve-ascii-character", "title": "Windows Clipboard won&#39;t preserve ASCII character", "body": "<p>I am writing a plugin for the TS3 Client, but I ran into an issue...</p>\n\n<p>One of the channel names has a special sign (\u2560) in it, which is a special character from the extended ascii table I think.</p>\n\n<p>When logging it INSIDE teamspeak, the character shows fine, but when trying to copy it to the windows clipboard using its C interface it returns a whole different character (\u00e2).</p>\n\n<p>I have tried converting it to WCHAR after I read that the extended ascii table uses more bytes than the regular char, but that didn't work either.</p>\n\n<p>I use the following code to copy the char* to the clipboard which I found somewhere and altered with some other code I found for using WCHAR:</p>\n\n<pre><code>void SaveClipboard(char* tx)\n{\n    WCHAR text[140];\n    swprintf(text, 140, L\"%hs\", tx);\n\n    if(OpenClipboard(NULL))\n    {\n        EmptyClipboard();\n        HGLOBAL global = GlobalAlloc(GMEM_DDESHARE, 2 * (wcslen(text) + 1)); //text size + \\0 character\n\n        WCHAR* pchData;\n        pchData = (WCHAR*)GlobalLock(global);\n        wcscpy(pchData, text);\n        GlobalUnlock(pchData);\n\n        SetClipboardData(CF_UNICODETEXT, global);\n        CloseClipboard();\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arm", "callstack", "stack-frame"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1535498459, "post_id": 52067217, "comment_id": 91085118, "body": "The registers <code>r0-r3</code> are caller-saved, so the values of these registers have to be saved before calling any function if they are still needed after the function call."}, {"owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1535498618, "post_id": 52067217, "comment_id": 91085148, "body": "I don&#39;t think I understand. Register <code>r3</code> is not saved in the caller stack frame from what I can tell, it&#39;s saved in the callee stack frame. Or am I misinterpreting the last <code>info frame</code> output I show where the saved registers are that of the callee stack frame and not the caller stack frame?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505125, "post_id": 52067217, "comment_id": 91086349, "body": "this is not a cortex-m0 thing specifically it is the abi or calling convention used by the toolchain.  While arm recommends one the compiler authors are free to do whatever they want, so this is not a C thing this is a what compiler are you using thing.  As far as exceptions/interrupts, yes arm logic does have a known list of things they preserve in order on the stack so that the handler doesnt have to.  and if the compiler used to generate the handler doesnt conform to a convention that the logic supports then the programmer or the compiler has to wrap the handler with more code."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505223, "post_id": 52067217, "comment_id": 91086370, "body": "you are better off examining functions not named main().  as some compilers latch on to that name and implement that function differently from the rest, causing more confusion than understanding."}, {"owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505279, "post_id": 52067217, "comment_id": 91086384, "body": "@old_timer so does this mean that my assumption in my update is correct? What about the question I had about the return address and the link register being offset by one byte?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505433, "post_id": 52067217, "comment_id": 91086420, "body": "the cortex-m is a thumb mode only machine, the full sized arms from armv4t to the armv7 support arm mode and thumb mode.  How you switch between modes is a certain list if instructions can be used and the least significant bit determines the mode you are branching into.  So for consistency your lsbit needs to be set for thumb mode, I assume that is what you mean by offset by one byte."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505480, "post_id": 52067217, "comment_id": 91086432, "body": "you are also trying to examine this stuff ina  debugger with a breakpoint so you are within an exception, just compile then disassemble...to see what is really going on as far as the stack goes."}, {"owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505564, "post_id": 52067217, "comment_id": 91086457, "body": "@old_timer I was referring to the line <code>saved pc 0x8002dd2</code> in the first <code>info frame</code> that I executed. This value, by my understanding, is the return address. However the link register is set to <code>0x8002dd3</code>."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505651, "post_id": 52067217, "comment_id": 91086481, "body": "exactly what I was referring to.  How is the link register used to return?  Look up that instruction see what it says."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535505856, "post_id": 52067217, "comment_id": 91086534, "body": "Using the debugger and a breakpoint will not show you how a compiler uses stack frames.  assuming the compiler is burning a frame pointer to make a stack frame anyway (gcc doesnt usually unless you ask)."}, {"owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535506472, "post_id": 52067217, "comment_id": 91086636, "body": "@old_timer I think I understand what you&#39;re saying. After reading a bit on the purpose of the lease significant bit of the LR, I think it&#39;s safe for me to assume that the line <code>saved pc 0x8002dd2</code> is referring to the actual return address while the <code>LR</code> is referring to the actual return address, including the instruction set used based off of the least significant bit of the <code>LR</code>."}, {"owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1535580731, "post_id": 52067217, "comment_id": 91123779, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/179061/discussion-between-eddie-garcia-and-old-timer\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "is_accepted": false, "score": 0, "last_activity_date": 1535502162, "creation_date": 1535502162, "answer_id": 52067831, "question_id": 52067217, "link": "https://stackoverflow.com/questions/52067217/why-are-local-variables-of-caller-stack-saved-in-registers-in-callee-stack/52067831#52067831", "title": "Why Are Local Variables of Caller Stack Saved in Registers in Callee Stack?", "body": "<p>On ARM systems, many auto's are stored in registers, rather than allocating space on the stack. ARM has a lot of registers, compared to other processors. When a function (context) calls into another function, those registers could be overwritten. Compiler writers have two choices, 1) save all registers on entry into (at the top of) every function, or 2) save the registers that function is using at whatever point it calls into another function.</p>\n\n<p>The caller has full context, so it is more efficient to save only the registers that are in use. The <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.subset.swdev.abi/index.html\" rel=\"nofollow noreferrer\">ARM ABI</a> defines the conventions that most compilers use. This enables function libraries from different compilers to inter-operate.</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "edited": false, "score": 0, "creation_date": 1535580046, "post_id": 52068913, "comment_id": 91123586, "body": "thanks a lot! This really helps understanding how stack frames are built. I don&#39;t understand 100% of it, but I&#39;ll dissect it and study up on the parts I&#39;m unfamiliar with. Thanks again!"}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": true, "score": 3, "last_activity_date": 1535512064, "creation_date": 1535512064, "answer_id": 52068913, "question_id": 52067217, "link": "https://stackoverflow.com/questions/52067217/why-are-local-variables-of-caller-stack-saved-in-registers-in-callee-stack/52068913#52068913", "title": "Why Are Local Variables of Caller Stack Saved in Registers in Callee Stack?", "body": "<blockquote>\n  <p>I'm trying my best to learn about the call stack and how stack frames\n  are structured in an ARM Cortex-M0</p>\n</blockquote>\n\n<p>So based on that quote, first off the arm cortex-m0 does not have stack frames, processors are really really dumb logic.  The compiler generates stack frames which are a compiler thing, not an instruction set thing.  The notion of a function is a compiler thing not really anything lower.  A compiler uses a calling convention or some basic set of rules designed so that for that language the caller and callee functions know exactly where parameters are, return values, and nobody trashes the others data.</p>\n\n<p>The compiler authors are free to do whatever they want so long as it works and fits withing the rules of the instruction set, as in the logic not assembly language.  (An assembler author is free to make up whatever assembly language they want, mnemonics whatever so long as the machine code conforms to the rules of the logic).  And they used to do that, the processor vendors have started making recommendations lets say, and the compilers are conforming to them.  Its not about sharing objects across compilers as much as it is 1) I dont have to come up with my own 2) we are trusting the ip vendor with their processor and hope that their calling convention was designed for performance and other reasons that we desire.</p>\n\n<p>gcc so far has attempted to conform with ARMs ABI as it evolves and gcc evolves. </p>\n\n<p>When you have \"many\" registers, what many means is a matter of opinion, but you will see that the convention will use registers first then the stack for passed parameters.  You will also see that some registers will be designated as volatile within a function to improve performance over having to use memory (the stack) so much. </p>\n\n<p>By using a debugger and a breakpoint you are looking in the wrong place your statement was you want to understand about the call stack and stack frames which is a compiler thing, not about how exceptions are handled in the logic.  Unless that is really what you were after your question wasnt accurate enough to understand.</p>\n\n<p>Compilers like GCC have optimizers and despite them creating confusion with respect to dead code learning from the optimized version is easier than the non-optimized version.  Lets dive in</p>\n\n<pre><code>extern unsigned int more_fun ( unsigned int, unsigned int );\nunsigned int fun ( unsigned int a, unsigned int b )\n{\n    return(a+b);\n}\n</code></pre>\n\n<p>Optimized</p>\n\n<pre><code> &lt;fun&gt;:\n   0:   1840        adds    r0, r0, r1\n   2:   4770        bx  lr\n</code></pre>\n\n<p>not</p>\n\n<pre><code>00000000 &lt;fun&gt;:\n   0:   b580        push    {r7, lr}\n   2:   b082        sub sp, #8\n   4:   af00        add r7, sp, #0\n   6:   6078        str r0, [r7, #4]\n   8:   6039        str r1, [r7, #0]\n   a:   687a        ldr r2, [r7, #4]\n   c:   683b        ldr r3, [r7, #0]\n   e:   18d3        adds    r3, r2, r3\n  10:   0018        movs    r0, r3\n  12:   46bd        mov sp, r7\n  14:   b002        add sp, #8\n  16:   bd80        pop {r7, pc}\n</code></pre>\n\n<p>First off why is the function at address zero?  Because I disassembled the object not a linked binary, maybe I will later.  And why disassemble vs compile to assembly?  If the disassembler is any good, then you actually get to see what was produced rather than the assembly which will contain, certainly with compiled code, a lot of non-instruction language as well as pseudo code that gets changed when finally assembled.  </p>\n\n<p>A stack frame IMO is when there is a second pointer, a frame pointer.  You often see this with instruction sets that have instructions or limitations that lean toward this.  For example an instruction set might have a stack pointer register but you cant address from it, there may be another frame register pointer and that you can. So the typical entry would be to save the frame pointer on the stack because the caller may have been using it for their frame and we want to return it as found, then copy the address of the stack pointer to the frame pointer, then move the stack pointer as far as needed for this function so that interrupts or calls to other functions the stack pointer is on the boundary between used and unused stack space, as it should be at all times.  The frame pointer would be used in this case to access any passed in parameters or return addresses in a frame pointer plus offset fashion (for downward growing stacks) and in the negative offset direction for local data.</p>\n\n<p>Now it does look like the compiler is using a frame pointer, what a waste, lets ask it not to:</p>\n\n<pre><code>00000000 &lt;fun&gt;:\n   0:   b082        sub sp, #8\n   2:   9001        str r0, [sp, #4]\n   4:   9100        str r1, [sp, #0]\n   6:   9a01        ldr r2, [sp, #4]\n   8:   9b00        ldr r3, [sp, #0]\n   a:   18d3        adds    r3, r2, r3\n   c:   0018        movs    r0, r3\n   e:   b002        add sp, #8\n  10:   4770        bx  lr\n</code></pre>\n\n<p>so first off the compiler determined there were 8 bytes of things to save on the stack.  Unoptimized pretty much everything gets a place on the stack, the passed parameters as well as local variables, there werent any locals in this case so we just have the passed in ones, two 32 bit numbers, so 8 bytes.  The calling convention used attempts to use r0 for the first parameter and r1 for the second if they fit, in this case they do.  so the stack frame is formed when 8 is subtracted from the stack pointer, the stack frame pointer is the stack pointer in this case.  The calling convention used here allows for r0-r3 to be volatile in the function.  The compiler does not have to return to the caller with those registers as they were found, they can be used within the function at will.  The compiler chose in this case to pull from the stack the addition operands using the next to registers rather than the first to free ones.  Once r0 and r1 are saved to the stack then the \"pool\" of free registers one would assume start with r0,r1,r2,r3.  So yes it does appear to be broken, but it is what it is, it is functionally correct and that is the job of a compiler to produce code that functionally implements the compiled code.  The calling convention used by this compiler states that the return value goes in r0 if it fits, which it does.  </p>\n\n<p>So the stack frame is setup, 8 is subtracted from sp.  Passed in parameters are saved to the stack.  Now the function starts by pulling the passed in parameters from the stack, adding them, and placing the result in the return register.</p>\n\n<p>Then bx lr is used to return, look that instruction up along with pop (for armv6m, for armv4t pop cant be used to switch modes so compilers will if they can pop to lr then bx lr).</p>\n\n<p>armv4t thumb, cant use pop to return in case this code is mixed with arm, so the return pops into a volatile register and does a bx lr, you cant pop directly into lr in thumb.  It is possible that you might be able to tell the compiler I am not mixing this with arm code so its save to use pop to return.  Depends on the compiler.</p>\n\n<pre><code>00000000 &lt;fun&gt;:\n   0:   b580        push    {r7, lr}\n   2:   b082        sub sp, #8\n   4:   af00        add r7, sp, #0\n   6:   6078        str r0, [r7, #4]\n   8:   6039        str r1, [r7, #0]\n   a:   687a        ldr r2, [r7, #4]\n   c:   683b        ldr r3, [r7, #0]\n   e:   18d3        adds    r3, r2, r3\n  10:   0018        movs    r0, r3\n  12:   46bd        mov sp, r7\n  14:   b002        add sp, #8\n  16:   bc80        pop {r7}\n  18:   bc02        pop {r1}\n  1a:   4708        bx  r1\n</code></pre>\n\n<p>to see a frame pointer</p>\n\n<pre><code>00000000 &lt;fun&gt;:\n   0:   b580        push    {r7, lr}\n   2:   b082        sub sp, #8\n   4:   af00        add r7, sp, #0\n   6:   6078        str r0, [r7, #4]\n   8:   6039        str r1, [r7, #0]\n   a:   687a        ldr r2, [r7, #4]\n   c:   683b        ldr r3, [r7, #0]\n   e:   18d3        adds    r3, r2, r3\n  10:   0018        movs    r0, r3\n  12:   46bd        mov sp, r7\n  14:   b002        add sp, #8\n  16:   bd80        pop {r7, pc}\n</code></pre>\n\n<p>first off you save the frame pointer to the stack as the caller or the callers caller, etc may be using it, its a regisiter we have to preserve.  now some calling convention comes into play right off the start.  We know that the compiler knows that we are not calling another function so we dont need to preserve the return address (stored in the link register r14), so why push it on the stack why waste the space and the clock cycles?  Well the convention changed not long ago to say the stack should be 64 bit aligned, so you basically push and pop in pairs of registers (an even number of registers).  Sometimes they use more than one instruction for a pair as we see in the armv4t return.  So the compiler needed to push another register, it could and you will see sometimes that it does just pick some register it is not using and push that on the stack, maybe we can get that to do this here in a bit.  In this case being armv6-m you can switch modes with a pop so it is safe to generate a return using a pop pc, so you save an instruction by using the link register here instead of some other register.  A little optimization despite being unoptimized code.</p>\n\n<p>save the frame pointer then associate the frame pointer with the stack pointer, in this case it moves the stack pointer first and makes the frame pointer match the stack pointer then uses the frame pointer for stack accesses. Oh how wasteful, even for unoptimized code.  But perhaps this compiler defaults to a frame pointer when told to compile like this.</p>\n\n<p>While here one of your questions and I have commented on this thus far indirectly.  The full sized arm processors armv4t through armv7 support both arm instructions and thumb instructions.  Not everyone supports every one there was an evolution, but you can have arm and thumb instructions coexist as part of the rules defined by the logic for that core.  The ARM design to support this is since arm instructions have to be word aligned, the lower two bits of the address of an arm instruction are always zeros.  A desired 16 bit instruction set, also aligned, would always have the lower bit of the address zero.  So why not use the lsbit of the address as a way to switch modes.  And that is what they chose to do. With a few instructions at first, then became more that are allowed by the armv7 architecture, if the address of the branch (look up bx first, branch exchange) has an lsbit of 1 then the processor switches to thumb mode when it begins to fetch instructions at that address, the program counter does not retain this one, it is stripped by the instruction, it is just a signal used to tell the instruction to switch modes.  if the lsbit is a 0 then the processor switches to arm mode.  If it was already in the said mode it just stays in that mode.</p>\n\n<p>Now comes these cortex-m cores which are thumb only machines, no arm mode.  The tools are in place, it all works no reason to change, if you try to go into arm mode on a cortex-m you get a fault.</p>\n\n<p>now look at the code above, sometimes we return with a bx lr and sometimes a pop pc, in both cases lr held the \"return address\".  for the bx lr case to have worked the lsbit of lr must be set.  The caller cant know which instruction we are going to use for the return, and the caller doesnt have to but likely used a bl to make the call so the logic actually set the bit not the compiler.  That is why your return address is off by one byte.</p>\n\n<p>If you want to learn about compilers and stack frames though, while unoptimized definitely uses the stack as you can see, optimized code if you have a compiler with decent optimization can be easier to understand the compilers output once you learn not to make dead code.</p>\n\n<pre><code>00000000 &lt;fun&gt;:\n   0:   1840        adds    r0, r0, r1\n   2:   4770        bx  lr\n</code></pre>\n\n<p>r0 and r1 are the passed in parameters, r0 is where the return value goes, link register is the return address.  This is what you would hope a compiler would produce for a function like that.</p>\n\n<p>So now lets try something more complicated.</p>\n\n<pre><code>extern unsigned int more_fun ( unsigned int, unsigned int );\nunsigned int fun ( unsigned int a, unsigned int b )\n{\n    return(more_fun(a,b));\n}\n\n00000000 &lt;fun&gt;:\n   0:   b510        push    {r4, lr}\n   2:   f7ff fffe   bl  0 &lt;more_fun&gt;\n   6:   bd10        pop {r4, pc}\n</code></pre>\n\n<p>a few things things, first why didnt the optimizer do this:</p>\n\n<pre><code>fun:\n   b more_fun\n</code></pre>\n\n<p>I dont know.</p>\n\n<p>why does it say bl 0, more fun is not at zero?  This is an object not linked code, once linked the linker will modify that bl instruction to point at more_fun().</p>\n\n<p>Third we already got the compiler to push a register we didnt use.  It is pushing and popping r4 so that it can keep the stack aligned per the calling convention used by this compiler. It could have chosen almost any one of the registers, and you may find a gcc or llvm/clang version that uses say r3 instead of r4.  gcc has been using r4 for a bit now. its the first in the list of registers you have to preserve first in the list of registers that if they want to preserve something across a call they will use (as we will see in a second).  so perhaps thats why, who knows ask the author.</p>\n\n<pre><code>extern unsigned int more_fun ( unsigned int, unsigned int );\nunsigned int fun ( unsigned int a, unsigned int b )\n{\n    more_fun(a,b);\n    return(a);\n}\n\n00000000 &lt;fun&gt;:\n   0:   b510        push    {r4, lr}\n   2:   0004        movs    r4, r0\n   4:   f7ff fffe   bl  0 &lt;more_fun&gt;\n   8:   0020        movs    r0, r4\n   a:   bd10        pop {r4, pc}\n</code></pre>\n\n<p>Now we are making progress.  So we tell the compiler it has to save the passed in parameter across a function call.  Each function starts the rules over, so each function called can trash r0-r3, so if you are using r0-r3 for something you need to save them somewhere.  So a very wise choice, instead of saving the passed in parameter on the stack and possibly having to do multiple costly memory cycles to access it.  Instead save a callee or callee's callee, etc value on the stack and use a register within our function to save that parameter, as a design it saves a lot of wasted cycles.  We needed the stack to be aligned anyway so this all worked  out preserve r4 and save the return address since we are making a call ourselves which will trash it.  Save the parameter we need after the call into r4.  Make the call place the return value in the return register and return.  Cleaning up the stack as you go.  So the stack frame here is minimal if at all.  Not using the stack much.</p>\n\n<pre><code>extern unsigned int more_fun ( unsigned int, unsigned int );\nunsigned int fun ( unsigned int a, unsigned int b )\n{\n    b&lt;&lt;=more_fun(a,b);\n    return(a+b);\n}\n\n00000000 &lt;fun&gt;:\n   0:   b570        push    {r4, r5, r6, lr}\n   2:   0005        movs    r5, r0\n   4:   000c        movs    r4, r1\n   6:   f7ff fffe   bl  0 &lt;more_fun&gt;\n   a:   4084        lsls    r4, r0\n   c:   1960        adds    r0, r4, r5\n   e:   bd70        pop {r4, r5, r6, pc}\n</code></pre>\n\n<p>we did it again we got the compiler to have to save a register we didnt use to keep the alignment.  And we are using more of the stack but would you call that a stack frame?  We forced the compiler to have to preserve both incoming parameters through a subroutine call.</p>\n\n<pre><code>extern unsigned int more_fun ( unsigned int, unsigned int );\nunsigned int fun ( unsigned int a, unsigned int b, unsigned int c, unsigned int d )\n{\n    b&lt;&lt;=more_fun(b,c);\n    c&lt;&lt;=more_fun(c,d);\n    d&lt;&lt;=more_fun(b,d);\n    return(a+b+c+d);\n}\n\n\n 0: b5f8        push    {r3, r4, r5, r6, r7, lr}\n   2:   000c        movs    r4, r1\n   4:   0007        movs    r7, r0\n   6:   0011        movs    r1, r2\n   8:   0020        movs    r0, r4\n   a:   001d        movs    r5, r3\n   c:   0016        movs    r6, r2\n   e:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  12:   0029        movs    r1, r5\n  14:   4084        lsls    r4, r0\n  16:   0030        movs    r0, r6\n  18:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  1c:   0029        movs    r1, r5\n  1e:   4086        lsls    r6, r0\n  20:   0020        movs    r0, r4\n  22:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  26:   4085        lsls    r5, r0\n  28:   19a4        adds    r4, r4, r6\n  2a:   19e4        adds    r4, r4, r7\n  2c:   1960        adds    r0, r4, r5\n  2e:   bdf8        pop {r3, r4, r5, r6, r7, pc}\n</code></pre>\n\n<p>what is it going to take?  we at least did get it to save r3 to even out the stack.  I bet we can push it now...</p>\n\n<pre><code>extern unsigned int more_fun ( unsigned int, unsigned int );\nunsigned int fun ( unsigned int a, unsigned int b, unsigned int c, unsigned int d, unsigned int e, unsigned int f )\n{\n    b&lt;&lt;=more_fun(b,c);\n    c&lt;&lt;=more_fun(c,d);\n    d&lt;&lt;=more_fun(b,d);\n    e&lt;&lt;=more_fun(e,d);\n    f&lt;&lt;=more_fun(e,f);\n    return(a+b+c+d+e+f);\n}\n\n00000000 &lt;fun&gt;:\n   0:   b5f0        push    {r4, r5, r6, r7, lr}\n   2:   46c6        mov lr, r8\n   4:   000c        movs    r4, r1\n   6:   b500        push    {lr}\n   8:   0011        movs    r1, r2\n   a:   0007        movs    r7, r0\n   c:   0020        movs    r0, r4\n   e:   0016        movs    r6, r2\n  10:   001d        movs    r5, r3\n  12:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  16:   0029        movs    r1, r5\n  18:   4084        lsls    r4, r0\n  1a:   0030        movs    r0, r6\n  1c:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  20:   0029        movs    r1, r5\n  22:   4086        lsls    r6, r0\n  24:   0020        movs    r0, r4\n  26:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  2a:   4085        lsls    r5, r0\n  2c:   9806        ldr r0, [sp, #24]\n  2e:   0029        movs    r1, r5\n  30:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  34:   9b06        ldr r3, [sp, #24]\n  36:   9907        ldr r1, [sp, #28]\n  38:   4083        lsls    r3, r0\n  3a:   0018        movs    r0, r3\n  3c:   4698        mov r8, r3\n  3e:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  42:   9b07        ldr r3, [sp, #28]\n  44:   19a4        adds    r4, r4, r6\n  46:   4083        lsls    r3, r0\n  48:   19e4        adds    r4, r4, r7\n  4a:   1964        adds    r4, r4, r5\n  4c:   4444        add r4, r8\n  4e:   18e0        adds    r0, r4, r3\n  50:   bc04        pop {r2}\n  52:   4690        mov r8, r2\n  54:   bdf0        pop {r4, r5, r6, r7, pc}\n  56:   46c0        nop         ; (mov r8, r8)\n</code></pre>\n\n<p>Okay thats that is how it is going to be...</p>\n\n<pre><code>extern unsigned int more_fun ( unsigned int, unsigned int );\nextern void not_dead ( unsigned int *);\nunsigned int fun ( unsigned int a, unsigned int b )\n{\n    unsigned int x[16];\n    unsigned int ra;\n    for(ra=0;ra&lt;16;ra++)\n    {\n        x[ra]=more_fun(a+ra,b);\n    }\n    not_dead(x);\n    return(ra);\n}\n\n\n00000000 &lt;fun&gt;:\n   0:   b5f0        push    {r4, r5, r6, r7, lr}\n   2:   0006        movs    r6, r0\n   4:   b091        sub sp, #68 ; 0x44\n   6:   0004        movs    r4, r0\n   8:   000f        movs    r7, r1\n   a:   466d        mov r5, sp\n   c:   3610        adds    r6, #16\n   e:   0020        movs    r0, r4\n  10:   0039        movs    r1, r7\n  12:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  16:   3401        adds    r4, #1\n  18:   c501        stmia   r5!, {r0}\n  1a:   42b4        cmp r4, r6\n  1c:   d1f7        bne.n   e &lt;fun+0xe&gt;\n  1e:   4668        mov r0, sp\n  20:   f7ff fffe   bl  0 &lt;not_dead&gt;\n  24:   2010        movs    r0, #16\n  26:   b011        add sp, #68 ; 0x44\n  28:   bdf0        pop {r4, r5, r6, r7, pc}\n  2a:   46c0        nop         ; (mov r8, r8)\n</code></pre>\n\n<p>And there is your stack frame but it doesnt really have a frame pointer and doesnt use the stack to access stuff.  Would have to keep working harder to see that, very doable.  But hopefully by now you see my point.  Your question is about stack frames are structured in compiled code, in particular how a compiler might implement that for a particular target.</p>\n\n<p>BTW this is what clang did with that code.</p>\n\n<pre><code>00000000 &lt;fun&gt;:\n   0:   b5b0        push    {r4, r5, r7, lr}\n   2:   af02        add r7, sp, #8\n   4:   b090        sub sp, #64 ; 0x40\n   6:   460c        mov r4, r1\n   8:   4605        mov r5, r0\n   a:   f7ff fffe   bl  0 &lt;more_fun&gt;\n   e:   9000        str r0, [sp, #0]\n  10:   1c68        adds    r0, r5, #1\n  12:   4621        mov r1, r4\n  14:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  18:   9001        str r0, [sp, #4]\n  1a:   1ca8        adds    r0, r5, #2\n  1c:   4621        mov r1, r4\n  1e:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  22:   9002        str r0, [sp, #8]\n  24:   1ce8        adds    r0, r5, #3\n  26:   4621        mov r1, r4\n  28:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  2c:   9003        str r0, [sp, #12]\n  2e:   1d28        adds    r0, r5, #4\n  30:   4621        mov r1, r4\n  32:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  36:   9004        str r0, [sp, #16]\n  38:   1d68        adds    r0, r5, #5\n  3a:   4621        mov r1, r4\n  3c:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  40:   9005        str r0, [sp, #20]\n  42:   1da8        adds    r0, r5, #6\n  44:   4621        mov r1, r4\n  46:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  4a:   9006        str r0, [sp, #24]\n  4c:   1de8        adds    r0, r5, #7\n  4e:   4621        mov r1, r4\n  50:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  54:   9007        str r0, [sp, #28]\n  56:   4628        mov r0, r5\n  58:   3008        adds    r0, #8\n  5a:   4621        mov r1, r4\n  5c:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  60:   9008        str r0, [sp, #32]\n  62:   4628        mov r0, r5\n  64:   3009        adds    r0, #9\n  66:   4621        mov r1, r4\n  68:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  6c:   9009        str r0, [sp, #36]   ; 0x24\n  6e:   4628        mov r0, r5\n  70:   300a        adds    r0, #10\n  72:   4621        mov r1, r4\n  74:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  78:   900a        str r0, [sp, #40]   ; 0x28\n  7a:   4628        mov r0, r5\n  7c:   300b        adds    r0, #11\n  7e:   4621        mov r1, r4\n  80:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  84:   900b        str r0, [sp, #44]   ; 0x2c\n  86:   4628        mov r0, r5\n  88:   300c        adds    r0, #12\n  8a:   4621        mov r1, r4\n  8c:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  90:   900c        str r0, [sp, #48]   ; 0x30\n  92:   4628        mov r0, r5\n  94:   300d        adds    r0, #13\n  96:   4621        mov r1, r4\n  98:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  9c:   900d        str r0, [sp, #52]   ; 0x34\n  9e:   4628        mov r0, r5\n  a0:   300e        adds    r0, #14\n  a2:   4621        mov r1, r4\n  a4:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  a8:   900e        str r0, [sp, #56]   ; 0x38\n  aa:   350f        adds    r5, #15\n  ac:   4628        mov r0, r5\n  ae:   4621        mov r1, r4\n  b0:   f7ff fffe   bl  0 &lt;more_fun&gt;\n  b4:   900f        str r0, [sp, #60]   ; 0x3c\n  b6:   4668        mov r0, sp\n  b8:   f7ff fffe   bl  0 &lt;not_dead&gt;\n  bc:   2010        movs    r0, #16\n  be:   b010        add sp, #64 ; 0x40\n  c0:   bdb0        pop {r4, r5, r7, pc}\n</code></pre>\n\n<p>Now you used the term call stack.  The calling convention used by this compiler says that use r0-r3 when possible to pass in the first parameters then use the stack after that.</p>\n\n<pre><code>unsigned int fun ( unsigned int a, unsigned int b, unsigned int c, unsigned int d, unsigned int e )\n{\n    return(a+b+c+d+e);\n}\n00000000 &lt;fun&gt;:\n   0:   b510        push    {r4, lr}\n   2:   9c02        ldr r4, [sp, #8]\n   4:   46a4        mov r12, r4\n   6:   4463        add r3, r12\n   8:   189b        adds    r3, r3, r2\n   a:   185b        adds    r3, r3, r1\n   c:   1818        adds    r0, r3, r0\n   e:   bd10        pop {r4, pc}\n</code></pre>\n\n<p>so having more than four parameters the first four are in r0-r3 and then the \"call stack\" assuming that is what you were referring to is the fifth parameter.  The thumb instruction set uses bl as its main call instruction which uses r14 as the return address, unlike other instruction sets that might use the stack to store the return address, arm uses a register.  And the popular arm calling conventions use registers for the first few operands then use the stack after that.</p>\n\n<p>You would want to look at other instruction sets to see more of a call stack</p>\n\n<pre><code>00000000 &lt;_fun&gt;:\n   0:   1d80 0008       mov 10(sp), r0\n   4:   6d80 000a       add 12(sp), r0\n   8:   6d80 0006       add 6(sp), r0\n   c:   6d80 0004       add 4(sp), r0\n  10:   6d80 0002       add 2(sp), r0\n  14:   0087            rts pc\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 1, "accepted_answer_id": 52068913, "answer_count": 2, "score": 3, "last_activity_date": 1535512064, "creation_date": 1535496781, "last_edit_date": 1535505338, "question_id": 52067217, "link": "https://stackoverflow.com/questions/52067217/why-are-local-variables-of-caller-stack-saved-in-registers-in-callee-stack", "title": "Why Are Local Variables of Caller Stack Saved in Registers in Callee Stack?", "body": "<p>I'm trying my best to learn about the call stack and how stack frames are structured in an ARM Cortex-M0, it's proving to be a little difficult, but with patience I'm learning. I have several questions throughout this one question, so hopefully you guys can help me out in all areas. The questions I have will be highlighted in bold throughout this explanation.</p>\n\n<p>I'm using an ARM Cortex-M0 with GDB and a simply program to debug. Here is my program:</p>\n\n<pre><code>int main(void) {\n    static uint16_t myBits;\n    myBits = 0x70;\n\n    halInit();\n\n    return 0;\n}\n</code></pre>\n\n<p>I have a breakpoint set on <code>halInit()</code>. I then execute the command <code>info frame</code> on my GDB terminal to get this output:</p>\n\n<pre><code>Stack level 0, frame at 0x20000400:\npc = 0x80000d8 in main (src/main.c:63); saved pc 0x8002dd2\nsource language c.\nArglist at 0x200003e8, args: \nLocals at 0x200003e8, Previous frame's sp is 0x20000400\nSaved registers:\n r0 at 0x200003e8, r1 at 0x200003ec, r4 at 0x200003f0, r5 at 0x200003f4, r6 at 0x200003f8, lr at 0x200003fc\n</code></pre>\n\n<p>I will explain how I am interpreting this, please let me know if I am correct.</p>\n\n<p><code>Stack level 0</code>: Current level of the stack frame. <code>0</code> will always represent the top of the stack, in other words the current stack frame being used.</p>\n\n<p><code>frame at 0x20000400</code>: This represents the location of the stack frame in flash memory.</p>\n\n<p><code>pc = 0x80000d8 in main (src/main.c:63);</code>: This represents the next execution to be executed, i.e. the program counter value. Since the program counter always represents the next instruction to be executed.</p>\n\n<p><code>saved pc 0x8002dd2</code>: This one is a little confusing to me, but I think it means the return address, essentially the instruction to be executed when it returns from executing the <code>halInit()</code> function. However, if I type the command <code>info reg</code> into my GDB terminal I see that the link register is not this value, but the next address instead: <code>lr 0x8002dd3</code>. <strong>Why is that?</strong></p>\n\n<p><code>source language c.</code>: This represents the language being used.</p>\n\n<p><code>Arglist at 0x200003e8, args:</code>: This represents the starting address of my arguments that were passed to the stack frame. Since <code>args:</code> is blank, that means no arguments were passed. Which makes since for two reasons: this is the first stack frame in the call stack and my function doesn't have any arguments <code>int main(void)</code>. </p>\n\n<p><code>Locals at 0x200003e8</code>: This is the starting address of my local variables. As you can see in my original code snippet, I should have one local variables <code>myBits</code>. We'll come back to that later.</p>\n\n<p><code>Previous frame's sp is 0x20000400</code>: This is the stack pointer which points to the top of the callers stack frame. Since this is the first stack frame, I expect this value should equal the current frame's address which it does.</p>\n\n<pre><code>Saved registers:\nr0 at 0x200003e8\nr1 at 0x200003ec\nr4 at 0x200003f0\nr5 at 0x200003f4\nr6 at 0x200003f8\nlr at 0x200003fc\n</code></pre>\n\n<p>These are registers that have been pushed to the stack to be saved for use later by the current stack frame. <strong>This part I am curious about because it's the first stack frame so why would it save so many registers?</strong> If I execute the command <code>info reg</code> I get the following output:</p>\n\n<pre><code>r0             0x20000428   0x20000428\nr1             0x0  0x0\nr2             0x0  0x0\nr3             0x70 0x70\nr4             0x80000c4    0x80000c4\nr5             0x20000700   0x20000700\nr6             0xffffffff   0xffffffff\nr7             0xffffffff   0xffffffff\nr8             0xffffffff   0xffffffff\nr9             0xffffffff   0xffffffff\nr10            0xffffffff   0xffffffff\nr11            0xffffffff   0xffffffff\nr12            0xffffffff   0xffffffff\nsp             0x200003e8   0x200003e8\nlr             0x8002dd3    0x8002dd3\npc             0x80000d8    0x80000d8 &lt;main+8&gt;\nxPSR           0x21000000   0x21000000\n</code></pre>\n\n<p>This tells me that if I check the values stored in each of the memory addresses of the saved registers by executing the command <code>p/x *(register)</code>, then the values should be equal to that of the values shown in the output above. </p>\n\n<pre><code>Saved registers:\nr0 at 0x200003e8 -&gt; 0x20000428\nr1 at 0x200003ec -&gt; 0x0\nr4 at 0x200003f0 -&gt; 0x80000c4\nr5 at 0x200003f4 -&gt; 0xffffffff\nr6 at 0x200003f8 -&gt; 0xffffffff\nlr at 0x200003fc -&gt; 0x8002dd3\n</code></pre>\n\n<p>It works, the values in each address represent the values shown by the <code>info reg</code> command. However, I notice one thing. I have one local variable <code>myBits</code> with a value of <code>0x70</code> and this appears to be stored in <code>r3</code>. However <code>r3</code> is not pushed to the stack for saving.</p>\n\n<p>If we step into the next instruction, a new stack frame is created for the function <code>halInit()</code>. This is shown by executing the command <code>bt</code> on my terminal. It generates the following output:</p>\n\n<pre><code>#0  halInit () at src/hal/src/hal.c:70\n#1  0x080000dc in main () at src/main.c:63\n</code></pre>\n\n<p>If I execute the command <code>info frame</code> then I get the following output: </p>\n\n<pre><code>Stack level 0, frame at 0x200003e8:\npc = 0x8001842 in halInit (src/hal/src/hal.c:70); saved pc 0x80000dc\ncalled by frame at 0x20000400\nsource language c.\nArglist at 0x200003e0, args: \nLocals at 0x200003e0, Previous frame's sp is 0x200003e8\nSaved registers:\n r3 at 0x200003e0, lr at 0x200003e4\n</code></pre>\n\n<p>Now we see that register <code>r3</code> was pushed onto this stack frame. This register holds the value of the variable <code>myBits</code>. <strong>Why is</strong> <code>r3</code> <strong>pushed onto this stack frame if the caller stack frame is what needs this register?</strong></p>\n\n<p>Sorry for the long post, I just want to cover all areas of required information.</p>\n\n<h1>Update</h1>\n\n<p>I think I might know why <code>r3</code> was pushed onto the callee stack and not onto the caller stack even though the caller is the one that needs this value. </p>\n\n<p><strong>Is it because the function</strong> <code>halInit()</code> <strong>will be modifying the value in</strong> <code>r3</code><strong>?</strong></p>\n\n<p>In other words, the callee stack frame knows that the caller stack frame requires this register value, so it will push it onto its own stack frame so that it can modify <code>r3</code> for its own purpose, then when the stack frame is popped it will restore the value <code>0x70</code> that was pushed onto the stack frame back into <code>r3</code> for the caller to use again. <strong>Is this correct and if so, how did the callee stack frame know that the caller stack frame will need this value?</strong></p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1535494868, "post_id": 52066943, "comment_id": 91084240, "body": "It is not destroyed. Only the pointer has automatic storage duration."}, {"owner": {"reputation": 8689, "user_id": 224508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf26d2aa09d1b345ee4fe7fac03f500?s=128&d=identicon&r=PG", "display_name": "vanza", "link": "https://stackoverflow.com/users/224508/vanza"}, "edited": false, "score": 0, "creation_date": 1535494876, "post_id": 52066943, "comment_id": 91084243, "body": "It&#39;s a <code>FILE</code> pointer that must be free&#39;d with <code>fclose(3)</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535495827, "post_id": 52066943, "comment_id": 91084443, "body": "It obviously can&#39;t be an automatic variable (read about stoarage duration, if you knew, you wouldn&#39;t ask). Why do you care about the rest? Sidenote: <code>return</code> is not a function, but a statement. The result value should not be parenthtised (ti was not uncommon in the 70ies/early 80ies, but not since C89)."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1535496715, "post_id": 52066943, "comment_id": 91084683, "body": "You can confirm the allocation by the system associated with <code>fopen</code> easily with a memory checking program like <code>valgrind</code> (on Linux). If I recall correctly, the system will allocate <code>~1024 bytes</code> for the handling of the <code>FILE*</code> object returned by <code>fopen()</code>. At least on Linux, that memory is still reported as in use unless a corresponding <code>fclose()</code> is called on the file stream. (though note with <code>valgrind &gt; 3.12</code> the exclusion files no longer account for all system allocated memory, so some allocated memory is likely to be reported as in use, even if you free all you allocate)"}, {"owner": {"reputation": 148, "user_id": 1407110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93908139827bacf89ac7811b0c67f01?s=128&d=identicon&r=PG&f=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/1407110/vicky"}, "edited": false, "score": 0, "creation_date": 1535601249, "post_id": 52066943, "comment_id": 91128090, "body": "Though not directly related to this question but discussion <a href=\"https://stackoverflow.com/questions/8175827/what-happens-if-i-dont-call-fclose-in-a-c-program\" title=\"what happens if i dont call fclose in a c program\">stackoverflow.com/questions/8175827/&hellip;</a> especially answer by &quot;Adam Rosenfield&quot; give you enough pointer to conclude the type of FILE object return by fopen()."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1535496524, "post_id": 52066974, "comment_id": 91084629, "body": "<code>FILE</code> is not required to be a <code>struct</code>. And there is no stack in C. It&#39;s not a good idea in general to mix abstraction levels; better stick to the one in the question, i.e. the abstract machine."}], "tags": [], "owner": {"reputation": 59, "user_id": 10267028, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s2qu8KS8N2I/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMpkWmnX4uSPf13kbwpr_2Ro3gauQ/mo/photo.jpg?sz=128", "display_name": "codeandkey", "link": "https://stackoverflow.com/users/10267028/codeandkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1535494913, "creation_date": 1535494913, "answer_id": 52066974, "question_id": 52066943, "link": "https://stackoverflow.com/questions/52066943/is-a-file-object-created-and-returned-by-fopen-a-dynamic-or-static-variabl/52066974#52066974", "title": "Is a `FILE` object created and returned by `fopen()` a dynamic or static variable?", "body": "<p>The <code>FILE*</code> value returned from fopen() is a <em>pointer</em> to a structure allocated by the system. While the pointer itself will be automatically popped of the stack when the function returns the data it points to will not.</p>\n\n<p>You must call <code>fclose()</code> to free the data allocated by <code>fopen()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1535496403, "post_id": 52066975, "comment_id": 91084605, "body": "I don&#39;t think it&#39;s specified by the standard what <code>FILE</code> actually is and what the functions return (as long they return a null pointer value on failure).."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535497752, "post_id": 52066975, "comment_id": 91084983, "body": "@toohonestforthissite: Indeed, I did not find a proper quote from the C11 Standard... My answer is rooted in experience and knowledge of actual implementations, and the conclusion seems valid. The Standard does say that the pointer must be considered invalid after a call to <code>fclose()</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535498149, "post_id": 52066975, "comment_id": 91085055, "body": "&quot;<code>FILE</code> which is an object type capable of recording all the information needed to control a stream \u2026&quot; - Afaik in some early implementations it was even a macro, hence the all-uppercase relic. I could easily imagine implementations which use a simple integer handle converted to a pointer, e.g. if the underlying system already handles all stream aspects."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1535494915, "creation_date": 1535494915, "answer_id": 52066975, "question_id": 52066943, "link": "https://stackoverflow.com/questions/52066943/is-a-file-object-created-and-returned-by-fopen-a-dynamic-or-static-variabl/52066975#52066975", "title": "Is a `FILE` object created and returned by `fopen()` a dynamic or static variable?", "body": "<p>The <code>FILE</code> object to which a pointer is returned by <code>fopen()</code> is either allocated from the heap or a static object. In both cases it can be used until the file is closed by <code>fclose()</code>. Returning it from <code>open_data()</code> is perfectly OK.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1535496244, "last_edit_date": 1535496244, "creation_date": 1535495193, "answer_id": 52067006, "question_id": 52066943, "link": "https://stackoverflow.com/questions/52066943/is-a-file-object-created-and-returned-by-fopen-a-dynamic-or-static-variabl/52067006#52067006", "title": "Is a `FILE` object created and returned by `fopen()` a dynamic or static variable?", "body": "<p><code>open_data</code>, as well as <code>fopen</code>, does not return a <code>FILE</code> object but a <strong>pointer</strong> to a <code>FILE</code> object.  This object was allocated either statically or dynamically by <code>fopen</code>.  </p>\n\n<p>Had it been allocated automatically (i.e. as a local variable in <code>fopen</code>) then its address would not be valid.</p>\n"}, {"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1535496118, "post_id": 52067037, "comment_id": 91084529, "body": "Probably should paraphrase the first sentence. I meant: &#39;The fp a pointer to FILE object. The fp is a pointer with automatic storage duration.&#39;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535496151, "post_id": 52067037, "comment_id": 91084539, "body": "Sidenote: there is nothing like &quot;dynamic storage duration&quot;. <code>malloc</code> etc. returned objects have allocated storage duration. Other measn than <code>malloc</code> could also be used, it&#39;s simply not specified by the standard. <code>FILE</code> could as well be an integer handle converted to a pointer."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535496198, "post_id": 52067037, "comment_id": 91084552, "body": "Right. There is allocated storage duration in C99. Dynamic is in C++"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1535498588, "post_id": 52067037, "comment_id": 91085138, "body": "Not that it would change something about this, but FYI: C standard is C17 (==C11 with corrigenda)."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 2, "last_activity_date": 1535496156, "last_edit_date": 1535496156, "creation_date": 1535495386, "answer_id": 52067037, "question_id": 52066943, "link": "https://stackoverflow.com/questions/52066943/is-a-file-object-created-and-returned-by-fopen-a-dynamic-or-static-variabl/52067037#52067037", "title": "Is a `FILE` object created and returned by `fopen()` a dynamic or static variable?", "body": "<p>The <code>fp</code> is a pointer to <code>FILE</code> object. The <code>fp</code> variable has automatic storage duration in <code>FILE *open_data(void)</code> function block.  </p>\n\n<p>The data to which the <code>fp</code> pointer points to, the <code>FILE</code> object, is dependent on <code>fopen()</code> implementation. It may be data with static storage duration on some systems implementations, ie. <code>static FILE obj; FILE *fopen() { return &amp;obj; }</code>, but it may be data with allocated storage duration allocated and deallocated using dynamic memory allocation functions inside <code>fopen()</code> and <code>fclose()</code> calls. For example, look at openbsd, there is from  <a href=\"https://github.com/freebsd/freebsd/blob/master/lib/libc/stdio/fopen.c#L62\" rel=\"nofollow noreferrer\">fopen() call to __sfp()</a> which should <a href=\"https://github.com/lattera/freebsd/blob/master/lib/libc/stdio/findfp.c#L128\" rel=\"nofollow noreferrer\">find free FILE object from list</a> or if not found it should <a href=\"https://github.com/lattera/freebsd/blob/master/lib/libc/stdio/findfp.c#L134\" rel=\"nofollow noreferrer\">allocate next FILE object</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1535497965, "creation_date": 1535494725, "last_edit_date": 1535497965, "question_id": 52066943, "link": "https://stackoverflow.com/questions/52066943/is-a-file-object-created-and-returned-by-fopen-a-dynamic-or-static-variabl", "title": "Is a `FILE` object created and returned by `fopen()` a dynamic or static variable?", "body": "<p>Is  a <code>FILE</code> object created and returned by <code>fopen()</code> a dynamic or static variable or something else?</p>\n\n<p>In the following example,</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\nFILE *open_data(void) {\n    FILE *fp;\n    if ((fp = fopen(\"datafile\", \"r\")) == NULL)\n        return (NULL);\n    return (fp);   \n}\n</code></pre>\n\n<p>Is the <code>FILE</code> object created and returned by <code>open_data()</code> an automatic variable? If not, what is its storage duration and linkage?</p>\n\n<p>when a call to <code>open_data()</code> returns, will the <code>FILE</code> object created and returned by <code>open_data()</code> be destroyed?</p>\n"}, {"tags": ["c", "date", "gcc", "printf"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1535494452, "post_id": 52066849, "comment_id": 91084110, "body": "It is just warning you that <code>&quot;%d&#47;%d&#47;%d&quot;</code> could contain more than 11 bytes and therefore could overflow."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535494470, "post_id": 52066849, "comment_id": 91084119, "body": "What  happens when <code>tm.tm_year == INT_MAX</code>?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1535494491, "post_id": 52066849, "comment_id": 91084123, "body": "Probably difference in the range of values represented by <code>int</code> changing the number of bytes it may take to fit your printed ints?"}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 1, "creation_date": 1535494510, "post_id": 52066849, "comment_id": 91084131, "body": "As Osiris said; also it&#39;s advised to use <code>snprintf()</code> :-)"}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1535494610, "post_id": 52066849, "comment_id": 91084168, "body": "I dont think there is a printf specifier for max width (there could be, I just don&#39;t know about it) but a %d can print width up to INT_MAX which is a 10 digit number on common arches..."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1535494623, "post_id": 52066849, "comment_id": 91084174, "body": "Use snprintf, and &quot;%2d&quot;, then there&#39;s no reason for the compiler to warn you."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1535494701, "post_id": 52066849, "comment_id": 91084199, "body": "@LeeDanielCrocker <code>&quot;%2d&quot;</code> vs <code>&quot;%d&quot;</code> does not help. 2 is a minimum width."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1535494946, "post_id": 52066849, "comment_id": 91084265, "body": "Chux is right, %2d won&#39;t fix the issue, but it might give a hint to the compiler to make it suppress the warning. I don&#39;t know--seems like a pretty extreme warning in the first place."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1535495364, "post_id": 52066849, "comment_id": 91084351, "body": "Hmm, on second thought, even a system with 16-bit <code>int</code> types would have no problem overflowing the buffer.  Curious why it only warns on one system.  Different versions of GCC?"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 2, "creation_date": 1535495433, "post_id": 52066849, "comment_id": 91084363, "body": "%d/%d/%d (month/day/year) is rarely a good representation for a date. Try to use YYYY-MM-DD per ISO 8601. Also see <a href=\"https://xkcd.com/1179/\" rel=\"nofollow noreferrer\">xkcd.com/1179</a>"}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 1, "creation_date": 1535609545, "post_id": 52066849, "comment_id": 91130302, "body": "If your question is about the difference in compilation results, please include the compiler versions (<code>gcc -v</code>)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1535639477, "post_id": 52066849, "comment_id": 91149663, "body": "You have complained about the three answers which have suggested ways to fix potential problems in your code.  One out of two compilers has chosen to warn you about some of the very same potential problems.  The other compiler has not.  Why are they different?  Because different compilers are different.  Why do you care?  Do you suspect that your code is right, that the compiler that did not warn is right not to warn, and that the compiler that did warn, and the answers here that warned, are all wrong, or what?"}], "answers": [{"comments": [{"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 0, "creation_date": 1535494891, "post_id": 52066964, "comment_id": 91084251, "body": "For some braindead reason I thought this was the name of a file &gt;_&gt;"}], "tags": [], "owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "is_accepted": false, "score": -1, "last_activity_date": 1535494858, "creation_date": 1535494858, "answer_id": 52066964, "question_id": 52066849, "link": "https://stackoverflow.com/questions/52066849/compiling-the-same-program-on-different-systems-produces-different-results/52066964#52066964", "title": "Compiling the same program on different systems produces different results?", "body": "<p>As Osiris said, <code>sprintf()</code> may write more than <code>DATE_SIZE+1</code> bytes into <code>date</code>.</p>\n\n<p>If you want to store a filename, I suggest using <a href=\"http://www.cplusplus.com/reference/cstdio/FILENAME_MAX/\" rel=\"nofollow noreferrer\"><code>FILENAME_MAX</code></a> for the size of the buffer -- it's guaranteed to be <em>big enough</em>.</p>\n\n<p>Also, use <code>snprintf()</code> to limit the amount of characters written in the buffer. This avoids memory management issues, which in other cases may lead to security vulnerabilities.</p>\n\n<p>Check the return value of <code>snprintf()</code> and confirm the whole string has been written (i.e. your <code>date</code> was big enough.</p>\n\n<pre><code>char date[FILENAME_MAX];\nint rv = sprintf(date, sizeof(date), \"%d/%d/%d\",\n                 tm.tm_mon + 1, tm.tm_mday, tm.tm_year - 100);\nif (rv &lt; 0) printf(\"encoding error\\n\");\nif (rv == sizeof(date)) printf(\"not big enough\\n\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": -1, "last_activity_date": 1535495858, "last_edit_date": 1535495858, "creation_date": 1535495370, "answer_id": 52067034, "question_id": 52066849, "link": "https://stackoverflow.com/questions/52066849/compiling-the-same-program-on-different-systems-produces-different-results/52067034#52067034", "title": "Compiling the same program on different systems produces different results?", "body": "<p>The 2nd compiler is your friend.</p>\n\n<p>It has properly warned </p>\n\n<blockquote>\n  <p>'sprintf' output between 6 and 36 bytes into a destination of size 11</p>\n</blockquote>\n\n<p>If <code>tm.tm_year</code> is a large value, the buffer will overflow.</p>\n\n<p>There is little gained with coding such a scant buffer size of 11.</p>\n\n<hr>\n\n<p>An <code>int</code> can take up to <code>ceil(log10(INT_MAX))</code> digits.  Together with a sign, that is no more than:</p>\n\n<pre><code>//                   sign v--- value bits -------v *log10(2)  round\n#define INT_DEC_LEN (1 + (sizeof(int)*CHAR_BIT - 1)*302/100 + 1)\n</code></pre>\n\n<p>Consider a buffer large enough, no matter the contents of <code>struct tm tm</code>.  What is a few extra bytes between friends?</p>\n\n<pre><code>struct tm tm = *localtime(&amp;t);\n#define DMY_FMT \"%d/%d/%d\"\n#define DMY_SIZE (sizeof(DMY_FMT) + 3*INT_DEC_LEN + 1)\n\nchar date[DMY_SIZE] = {0};\n\nif(sprintf(date, \"%d/%d/%d\", tm.tm_mon + 1, tm.tm_mday, tm.tm_year - 100) &lt; 0)\n</code></pre>\n\n<hr>\n\n<p>Code can go the <code>snprintf()</code> route too.  Note a negative or large return value indicates a problem.</p>\n\n<pre><code>int cnt = snprintf(date, sizeof data, \"%d/%d/%d\", tm.tm_mon + 1, tm.tm_mday, tm.tm_year - 100);\nif (cnt &lt; 0 || cnt &gt;= sizeof data) {\n  // Handle error\n}\n</code></pre>\n\n<hr>\n\n<p>Following <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO-8601</a> is a good idea for dates. <a href=\"https://stackoverflow.com/questions/52066849/compiling-the-same-program-on-different-systems-produces-different-results/52067034#comment91084363_52066849\">@jarmod</a></p>\n\n<p>Needs something like </p>\n\n<pre><code>\"%04d-%02d-%02d\", tm.tm_year + 1900, tm.tm_mon + 1, tm.tm_mday);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": -1, "last_activity_date": 1535497437, "creation_date": 1535497437, "answer_id": 52067299, "question_id": 52066849, "link": "https://stackoverflow.com/questions/52066849/compiling-the-same-program-on-different-systems-produces-different-results/52067299#52067299", "title": "Compiling the same program on different systems produces different results?", "body": "<p>Three things:</p>\n\n<ol>\n<li><p>That definition <code>#define DATE_SIZE 10</code> is way too small.  Just make it 100.  Memory is cheap these days, and life's too short to spend time trying to decide whether 10 is big enough or maybe you need 11, and then chasing bugs after you wrongly choose 10 but it turns out it really did need to be 11 after all.</p></li>\n<li><p>Don't call <code>sprintf</code>.  Call <code>snprintf(date, sizeof(date), ...)</code> (or <code>snprintf(date, DATE_SIZE, ...)</code>) instead. That way you definitively won't overflow your <code>date</code> array.  (In your code, you checked the return value from <code>sprintf</code> as if to catch that sort of error, but plain <code>sprintf</code> does <em>not</em> catch that sort of error.)</p></li>\n<li><p>Please don't compute <code>tm.tm_year - 100</code>.  It'll work today, but it wouldn't have worked 18 years ago, and it won't work 82 years from now, and that may not sound like a big deal, but it's still wrong.  If you can get away with it, please compute and print <code>tm.tm_year + 1900</code>.  If you simply <em>must</em> print an old-fashioned pre-Y2K two-digit year, you can use <code>tm.tm_year % 100</code>.</p></li>\n</ol>\n"}], "owner": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1535503481, "creation_date": 1535494241, "last_edit_date": 1535503481, "question_id": 52066849, "link": "https://stackoverflow.com/questions/52066849/compiling-the-same-program-on-different-systems-produces-different-results", "title": "Compiling the same program on different systems produces different results?", "body": "<p>Here is the program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;libgen.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define DATE_SIZE   10\n\n// Declare global variables.\nchar *program_name = NULL;\n\nint main (int argc, char *argv[])\n{\n// Declare variables.\n    time_t t = time(NULL);\n    struct tm tm = *localtime(&amp;t);\n    char date[DATE_SIZE + 1] = {0};\n\n// Store today's date in a string for comparison.\n    if(sprintf(date, \"%d/%d/%d\", tm.tm_mon + 1, tm.tm_mday, tm.tm_year - 100) &lt; 0)\n    {\n        fprintf(stderr, \"%s: main error: sprintf failed.\\n\", program_name);\n        exit(EXIT_FAILURE);\n    }\n\n// Print date to user.\n    printf(\"Date: %s\\n\", date);\n\n// Exit gracefully.\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Which is compiled with the following:</p>\n\n<pre><code>gcc -Wall -Werror -O3 -o program program.c\n</code></pre>\n\n<p>I also have 2 machines both running <strong>Arch linux</strong>:</p>\n\n<blockquote>\n  <p>Linux laptop 4.15.7-1-ARCH #1 SMP PREEMPT Wed Feb 28 19:01:57 UTC 2018\n  x86_64 GNU/Linux</p>\n  \n  <p>Linux storage 4.14.66-1-ARCH #1 SMP Sat Aug 25 01:09:50 UTC 2018\n  armv6l GNU/Linux</p>\n</blockquote>\n\n<p>When I compile on my laptop, it's clean and it runs perfectly.  When I compile on my storage server, I get the following error:</p>\n\n<pre><code>program.c: In function 'main':\nprogram.c:20:5: error: '/' directive writing 1 byte into a region of size between 0 and 10 [-Werror=format-overflow=]\n  if(sprintf(date, \"%d/%d/%d\", tm.tm_mon + 1, tm.tm_mday, tm.tm_year - 100) &lt; 0)\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nprogram.c:20:5: note: directive argument in the range [-2147483648, 2147483547]\nprogram.c:20:5: note: 'sprintf' output between 6 and 36 bytes into a destination of size 11\ncc1: all warnings being treated as errors\n</code></pre>\n\n<p>Why is there a difference?</p>\n\n<p>UPDATE</p>\n\n<hr>\n\n<p>All the comments seem to be dealing with how to fix the error.  First off, you need to know that this is a minimized program.  The date I create is compared to another that I didn't create.  Hence the mm/dd/yy format.  Also, most functions that the include an 'n' in the name (strncpy, snprintf...) are for when you don't know the data or it is user generated.  I look at it as lazy programming, because you are not aware of the data you are working with.  Also, I know for a fact this program won't be used in 82 years.</p>\n\n<p>No, my question has to deal with the difference in compilation results.</p>\n"}, {"tags": ["c", "global-variables", "header-files"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1535493880, "post_id": 52066780, "comment_id": 91083945, "body": "Is that because you declare <code>global_val</code> and reference <code>global_int</code>?"}, {"owner": {"reputation": 250, "user_id": 10118785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBK6yjyiX5Y/AAAAAAAAAAI/AAAAAAAAAE8/GSDei6J9J18/photo.jpg?sz=128", "display_name": "Leon Trotsky", "link": "https://stackoverflow.com/users/10118785/leon-trotsky"}, "edited": false, "score": 0, "creation_date": 1535493988, "post_id": 52066780, "comment_id": 91083965, "body": "Get some sleep my friend."}, {"owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "edited": false, "score": 0, "creation_date": 1535494170, "post_id": 52066780, "comment_id": 91084024, "body": "Sorry, I made a mistake when typing out the simplified code. I just checked my actual code and there are no typos like this. I&#39;ve edited the original post."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1535494779, "post_id": 52066780, "comment_id": 91084225, "body": "Never ever <b>define</b> variables in header files! Headers onyl should have variable <i>declarations</i> only, not definitions."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1535495076, "post_id": 52066780, "comment_id": 91084298, "body": "Note that only one source file in your program can successfully include your header given that every time it is included, it defines the global variable.  If more than one file includes the header, then there will be multiple definitions when you try to link them together. The rules of the game are different in C++ \u2014 but you have this marked as C and not C++.  If you feel you must do it in the header, make it <code>static const int global_val = 10;</code> but expect to get &#39;unused variable&#39; warnings from the compiler if you include the header but don&#39;t reference the variable.  So, don&#39;t do it!"}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1535502714, "post_id": 52066899, "comment_id": 91085902, "body": "As your approach is 100% wrong, we should keep this answer to show readers how it should not be done.  You had comment already- do not  put any code or data into the header files!!"}], "tags": [], "owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "is_accepted": false, "score": -1, "last_activity_date": 1535494458, "creation_date": 1535494458, "answer_id": 52066899, "question_id": 52066780, "link": "https://stackoverflow.com/questions/52066780/c-file-cannot-see-variable-defined-in-included-header-file/52066899#52066899", "title": "C file cannot see variable defined in #include&#39;d header file", "body": "<p>I found the problem. I deleted all my <code>.o</code>, <code>.gch</code>, and executable files and the code started compiling again. My guess is that the precompiled headers (which I don't even remember making) were tricking the compiler.</p>\n\n<p>Instead of closing the question, I decided to leave this answer it case it helps someone.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1535502888, "creation_date": 1535502888, "answer_id": 52067904, "question_id": 52066780, "link": "https://stackoverflow.com/questions/52066780/c-file-cannot-see-variable-defined-in-included-header-file/52067904#52067904", "title": "C file cannot see variable defined in #include&#39;d header file", "body": "<p>You should have two files. </p>\n\n<p>A.h</p>\n\n<pre><code>  #ifndef A_H\n  #define A_H 1\n\n  extern const int global_val;\n\n  #endif\n</code></pre>\n\n<p>and</p>\n\n<p>A.c</p>\n\n<pre><code>  #include \"A.h\"\n\n\n  const int global_val = 10;\n</code></pre>\n"}], "owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1535502888, "creation_date": 1535493746, "last_edit_date": 1535494122, "question_id": 52066780, "link": "https://stackoverflow.com/questions/52066780/c-file-cannot-see-variable-defined-in-included-header-file", "title": "C file cannot see variable defined in #include&#39;d header file", "body": "<p>In <code>a.h</code> I have</p>\n\n<pre><code>#ifndef A_H\n#define A_H 1\n\nconst int global_val = 10;\n\n#endif\n</code></pre>\n\n<p>And in <code>a.c</code> I have</p>\n\n<pre><code>#include \"a.h\"\n\nint someFunc() {\n    return global_val;\n}\n</code></pre>\n\n<p>But the compiler (gcc) throws an <code>error: 'global_int' undeclared</code> when compiling <code>a.c</code>. How can it possibly be undeclared when I've included the header file?</p>\n"}, {"tags": ["c++", "c", "c++11", "return"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1535493062, "post_id": 52066644, "comment_id": 91083668, "body": "there is no language called C/C++"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1535493073, "post_id": 52066644, "comment_id": 91083673, "body": "Just <code>return B();</code> is all you need.  There isn&#39;t any reason to store the return in a local variable if you are just going to return it."}, {"owner": {"reputation": 4290, "user_id": 311314, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9098882126e0907a9df39856ef1b5bfa?s=128&d=identicon&r=PG", "display_name": "Nathan Ernst", "link": "https://stackoverflow.com/users/311314/nathan-ernst"}, "edited": false, "score": 2, "creation_date": 1535493093, "post_id": 52066644, "comment_id": 91083680, "body": "Any decent compiler will optimize them to the same code (at least when optimizations are on). The former style is usually seen in people that prefer 1 return statement in a function while the latter is, in my opinion, clearer, more succinct and far less to type."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1535493108, "post_id": 52066644, "comment_id": 91083687, "body": "Also, if do not already have one I suggest you get a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1535493111, "post_id": 52066644, "comment_id": 91083690, "body": "Go for the one that is easiest to read and hardest to get wrong. For me that&#39;s <code>return B();</code>"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1535493187, "post_id": 52066644, "comment_id": 91083718, "body": "There will be no significant difference.  Choose the one that expresses your intent the clearest and that you will easily understand if you come back to the code in 2 years time."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 3, "creation_date": 1535493222, "post_id": 52066644, "comment_id": 91083730, "body": "The parens around the return expression is superfluous, and I recommend against using those superfluous parens unless there is a reason to use them in a particular case.  Keyword <code>return</code> is not a function."}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "edited": false, "score": 4, "creation_date": 1535493523, "post_id": 52066644, "comment_id": 91083843, "body": "NOTABENE : When a function has trailing return type speciifcation of decltype(auto) then using parenthesis in the return statement will return a reference instead of a value. UB lurking !"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 7, "creation_date": 1535493660, "post_id": 52066644, "comment_id": 91083877, "body": "Decide on learning one of C++ or C."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1535636161, "post_id": 52066644, "comment_id": 91147215, "body": "One other consideration that might apply. Assigning the value to a local variable makes it easier to inspect that value while debugging, because the function call / assignment and the return are on separate lines. Typically you&#39;d step over <code>a = B();</code>, look at the value of <code>a</code>, and if it is unexpected, you can set the call to <code>B()</code> as the next statement, then trace into it, to find out what&#39;s going on."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1535639106, "post_id": 52066644, "comment_id": 91149383, "body": "Write your code for maintainability.  When you profile your code, and determine that you have to change an implementation to improve the performance at the cost of legibility of that function, add a big comment as why the function was intentionally butchered -- perhaps keeping the &quot;readable but inefficient&quot; routine for posterity and unit tests as a reference routine."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1535493112, "creation_date": 1535493112, "answer_id": 52066677, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return/52066677#52066677", "title": "Function calls within return()", "body": "<p>If you plan on doing something with the return value of <code>B</code> before returning from <code>A</code>, go ahead and store it.  If the return value of <code>B</code> <strong>will</strong> be the return value of <code>A</code>, then just <code>return B()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 10267028, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s2qu8KS8N2I/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMpkWmnX4uSPf13kbwpr_2Ro3gauQ/mo/photo.jpg?sz=128", "display_name": "codeandkey", "link": "https://stackoverflow.com/users/10267028/codeandkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1535493251, "creation_date": 1535493251, "answer_id": 52066703, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return/52066703#52066703", "title": "Function calls within return()", "body": "<p>Both methods are common and it is a matter of preferred coding style.</p>\n\n<p>There will be no significant speed difference between them.</p>\n\n<p>As dbush mentioned one reason to use the first method is if you need to do something with the result of B() before returning it.</p>\n"}, {"tags": [], "owner": {"reputation": 4121, "user_id": 4290866, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0727d9acdc35a0359d0703da9e11f239?s=128&d=identicon&r=PG&f=1", "display_name": "user32434999", "link": "https://stackoverflow.com/users/4290866/user32434999"}, "is_accepted": false, "score": 1, "last_activity_date": 1535493632, "last_edit_date": 1535493632, "creation_date": 1535493258, "answer_id": 52066706, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return/52066706#52066706", "title": "Function calls within return()", "body": "<p>This is going to be the least of your problems and will break down to personal choice. A good compiler will be able to optimize in such a way that there is not going to be a difference (in most cases).</p>\n\n<p>However, C++17 guarantees for the second case Return-Value-Optimization which could in some cases be better.</p>\n\n<p>Return-Value-Optimization (RVO) is a process, where the returned object is never stored in a temporary object.</p>\n\n<p><strong>So how should you decide:</strong></p>\n\n<p>If you want to make use of the result of <code>B()</code> within the scope of <code>A</code>, than store it. Otherwise directly write <code>return B();</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1535493487, "post_id": 52066712, "comment_id": 91083834, "body": "You may be using the term class where you mean to use function."}], "tags": [], "owner": {"reputation": 2648, "user_id": 1057007, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/PMZNq.jpg?s=128&g=1", "display_name": "xzegga", "link": "https://stackoverflow.com/users/1057007/xzegga"}, "is_accepted": false, "score": 2, "last_activity_date": 1535493292, "creation_date": 1535493292, "answer_id": 52066712, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return/52066712#52066712", "title": "Function calls within return()", "body": "<p>You can return just B() but, the class does not make any sense if you put only this statement in A class. In that case, call B() instead of A() and remove A()</p>\n"}, {"comments": [{"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1535496833, "post_id": 52066727, "comment_id": 91084721, "body": "Playing devil&#39;s advocate for a moment, the one advantage of separating this into <code>bool a = B();</code> <code>return a;</code> is that it makes it much easier when single stepping though a debug non-optimized build to see what <code>B()</code> actually returned.  And as you&#39;ve noted, any half way decent optimizing compiler will compress those two statements to one for an optimized release build."}], "tags": [], "owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "is_accepted": false, "score": 2, "last_activity_date": 1535493369, "creation_date": 1535493369, "answer_id": 52066727, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return/52066727#52066727", "title": "Function calls within return()", "body": "<p>The compiler will (probably) optimize your <code>bool a = B(); return a;</code> into <code>return B()</code> anyways -- so you're wasting your time. The compiler may even just <em>place</em> <code>B()</code> in places where you wrote <code>A()</code>.</p>\n\n<p>Don't spend too much time optimizing unless you have (or expect to have) a problem. Keep a focus on making it work correctly and keeping the code clear.</p>\n\n<p>It's quite common (and perfectly fine) to return the result from other function.</p>\n"}, {"comments": [{"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 0, "creation_date": 1535494149, "post_id": 52066814, "comment_id": 91084019, "body": "Can you give an example on how this leads to problems in C++14 due to the return-type deduction?"}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "edited": false, "score": 1, "creation_date": 1535494418, "post_id": 52066814, "comment_id": 91084099, "body": "@joaomineto: When a function has trailing return type speciifcation of decltype(auto) then using parenthesis in the return statement will return a reference instead of a value. That is most likely not what you want and easily leads to UB (references to locals or temporaries)."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 0, "last_activity_date": 1535494925, "last_edit_date": 1535494925, "creation_date": 1535493939, "answer_id": 52066814, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return/52066814#52066814", "title": "Function calls within return()", "body": "<p>Well, there are bad points for both:</p>\n\n<ol>\n<li>The first is unnecessarily chatty. If in doubt, prefer brevity.<br>\nIn C or C++11, that's it, in C++17 it looses out on <em>guaranteed</em> copy-elision, which might matter with a more complicated type.</li>\n<li><p>The second uses extra-parentheses, making it look like <code>return</code> is a function-call.<br>\nIn C or C++11, that's it, but in C++14 with <code>decltype(auto)</code> return-type-deduction, that results in deducing references.</p>\n\n<pre><code>// C++14 examples:\ndecltype(auto) returns_value(int i) { return i; }\ndecltype(auto) returns_dangling_reference(int i) { return (i); }\n</code></pre></li>\n</ol>\n\n<p>In the end, it should have been simply:</p>\n\n<pre><code>return B();\n</code></pre>\n\n<p>So you get all the advantages and avoid all the pitfalls.</p>\n"}, {"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 1, "last_activity_date": 1535500860, "creation_date": 1535500860, "answer_id": 52067692, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return/52067692#52067692", "title": "Function calls within return()", "body": "<p>There is no difference in terms of code. The compiler should be able to optimize these to the same thing when building a release build.</p>\n\n<p>But there is a slight advantage to using a variable in debug build. You can easily place a break point at the return then query the state of the variable before returning.</p>\n\n<pre><code>bool A (blah, blah)\n{\n    bool a = B();\n    return a;        // Set break point here.\n}                    // In debugger you can see the value of a\n                     // before telling the compiler to continue.\n</code></pre>\n"}], "owner": {"reputation": 232, "user_id": 9867311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8987fb82181f0e60e832600d8076123?s=128&d=identicon&r=PG&f=1", "display_name": "Rudra", "link": "https://stackoverflow.com/users/9867311/rudra"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "closed_date": 1535502807, "accepted_answer_id": 52066677, "answer_count": 7, "score": -3, "last_activity_date": 1535500860, "creation_date": 1535492925, "last_edit_date": 1535494217, "question_id": 52066644, "link": "https://stackoverflow.com/questions/52066644/function-calls-within-return", "closed_reason": "Needs more focus", "title": "Function calls within return()", "body": "<p>I am currently self-learning C and C++.<br>\nI couldn't find a similar question but I would like some good explanation with a focus on C and C++ design practices.</p>\n\n<ol>\n<li>Is it a good coding practice to call a function with a return type from <code>return()</code>?</li>\n<li>Is this something I should even be thinking of or is this a silly question to ask?</li>\n</ol>\n\n<p>To illustrate:</p>\n\n<pre><code>bool A (blah, blah)\n{\n    bool a = false;\n    a = B(); // B returns bool type\n    return a;\n\n    // OR\n\n    return (B());\n}\n</code></pre>\n\n<ol start=\"3\">\n<li>Both compile and run obviously but is one better than the other in terms of some metric such as speed, memory efficient etc..?</li>\n<li>What could be the reasons to use one or the other or am I wasting my time by asking this question?</li>\n</ol>\n"}, {"tags": ["c", "arrays", "pointers", "memory"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1535492846, "post_id": 52066591, "comment_id": 91083597, "body": "How do you figure the size of an array with one element to be zero?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1535493474, "post_id": 52066591, "comment_id": 91083825, "body": "Note <a href=\"https://stackoverflow.com/a/33353256/1708801\">zero length arrays are undefined behavior</a> although supported as an extension, this particular use case does not seem useful."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535493793, "post_id": 52066591, "comment_id": 91083916, "body": "Only GCC (and Clang emulating GCC) allow zero-size arrays.  The C standard does not allow them."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1535493670, "post_id": 52066752, "comment_id": 91083885, "body": "<code>int contents[];</code> would be a <i>flexible array member</i>.  <code>int contents[0];</code> is not a FAM."}, {"owner": {"reputation": 59, "user_id": 10267028, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s2qu8KS8N2I/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMpkWmnX4uSPf13kbwpr_2Ro3gauQ/mo/photo.jpg?sz=128", "display_name": "codeandkey", "link": "https://stackoverflow.com/users/10267028/codeandkey"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535494026, "post_id": 52066752, "comment_id": 91083974, "body": "I agree, more consistency is better here. After more research it seems they are more of a historical extension now made obsolete by flexible array members."}], "tags": [], "owner": {"reputation": 59, "user_id": 10267028, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s2qu8KS8N2I/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMpkWmnX4uSPf13kbwpr_2Ro3gauQ/mo/photo.jpg?sz=128", "display_name": "codeandkey", "link": "https://stackoverflow.com/users/10267028/codeandkey"}, "is_accepted": false, "score": 2, "last_activity_date": 1535493997, "last_edit_date": 1535493997, "creation_date": 1535493542, "answer_id": 52066752, "question_id": 52066591, "link": "https://stackoverflow.com/questions/52066591/how-is-an-array-of-size-0-stored-in-memory/52066752#52066752", "title": "How is an array of size 0 stored in memory?", "body": "<p>Zero-length arrays are not technically supported by the C standard. However some compilers such as gcc allow them as an extension.</p>\n\n<p>They are a pre-C99 way of creating flexible array members, as shown here:</p>\n\n<pre><code>typedef struct {\n    int len;\n    int contents[0];\n} arr;\n</code></pre>\n\n<p>Then, you can initialize as much space as you'd want for the array at the end:</p>\n\n<pre><code>arr* a = malloc(sizeof(*a) + sizeof(a-&gt;contents) * 10); /* for a length-10 array */\na-&gt;len = 10;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 4, "last_activity_date": 1535493702, "creation_date": 1535493702, "answer_id": 52066777, "question_id": 52066591, "link": "https://stackoverflow.com/questions/52066591/how-is-an-array-of-size-0-stored-in-memory/52066777#52066777", "title": "How is an array of size 0 stored in memory?", "body": "<blockquote>\n  <p>If I have an array of only one element, we can say it is the same as a\n  pointer</p>\n</blockquote>\n\n<p>No we cannot. Arrays and pointers are different types and they are represented differently internally. This is true regardless of the array size. Now it is also true that in certain situations (most of the situations actually) an array decays to a pointer to it's first element.</p>\n\n<p>Arrays of size <code>0</code> are illegal as per standard, however some major compilers like gcc allow them as an extension.</p>\n\n<p>Read this question to see the difference between internal representations of arrays and pointers: <a href=\"https://stackoverflow.com/questions/21972465/difference-between-dereferencing-pointer-and-accessing-array-elements\">Difference between dereferencing pointer and accessing array elements</a></p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1535494436, "creation_date": 1535494436, "answer_id": 52066890, "question_id": 52066591, "link": "https://stackoverflow.com/questions/52066591/how-is-an-array-of-size-0-stored-in-memory/52066890#52066890", "title": "How is an array of size 0 stored in memory?", "body": "<p>Strictly speaking, an array is not allowed to have a size of 0.  This is dictated in section 6.7.6.2p1 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p>In addition to optional type qualifiers and the keyword static , the [\n  and ] may delimit an expression or\n  * . If they delimit an expression (which specifies the size of an array), the expression shall have an integer type.  <strong>If the expression\n  is a constant expression, it shall have a value greater than zero.</strong> \n  The element type shall not be an incomplete or function type.   The \n  optional  type  qualifiers  and  the  keyword static shall  appear \n  only  in  a declaration  of  a  function  parameter  with  an  array \n  type,  and  then  only  in  the  outermost array type derivation</p>\n</blockquote>\n\n<p>Some compilers do support this as an extension, for example <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow noreferrer\">GCC</a>:</p>\n\n<blockquote>\n  <p>Declaring zero-length arrays is allowed in GNU C as an extension. A\n  zero-length array can be useful as the last element of a structure\n  that is really a header for a variable-length object:</p>\n\n<pre><code>struct line {\n  int length;\n  char contents[0];\n};\n\nstruct line *thisline = (struct line *)\n  malloc (sizeof (struct line) + this_length);\nthisline-&gt;length = this_length;\n</code></pre>\n  \n  <p>Although the size of a zero-length array is zero, an array member of\n  this kind may increase the size of the enclosing type as a result of\n  tail padding. The offset of a zero-length array member from the\n  beginning of the enclosing structure is the same as the offset of an\n  array with one or more elements of the same type. The alignment of a\n  zero-length array is the same as the alignment of its elements.</p>\n</blockquote>\n"}], "owner": {"reputation": 53, "user_id": 8063044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4b00ab7eb4b9aaec59cfafbf31e10f?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Deleuze", "link": "https://stackoverflow.com/users/8063044/rafael-deleuze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 2, "answer_count": 3, "score": 4, "last_activity_date": 1535494436, "creation_date": 1535492681, "last_edit_date": 1535494009, "question_id": 52066591, "link": "https://stackoverflow.com/questions/52066591/how-is-an-array-of-size-0-stored-in-memory", "title": "How is an array of size 0 stored in memory?", "body": "<p>If I have an array of only one element, we can say it is the same as a pointer. \nBut how's an array of size zero represented in the memory?</p>\n\n<p>What is happening when I declare a variable <code>int * table[0]</code>?</p>\n"}, {"tags": ["c", "bitmap", "size", "padding"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1535492820, "post_id": 52066558, "comment_id": 91083592, "body": "What compiler are you using?  What options?"}, {"owner": {"reputation": 916, "user_id": 4987083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIf0f.jpg?s=128&g=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/4987083/alessandro"}, "edited": false, "score": 0, "creation_date": 1535492921, "post_id": 52066558, "comment_id": 91083629, "body": "I&#39;m correctly getting 14 bytes printed. As chux said, please provide some more info about your compiler."}, {"owner": {"reputation": 250, "user_id": 10118785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EBK6yjyiX5Y/AAAAAAAAAAI/AAAAAAAAAE8/GSDei6J9J18/photo.jpg?sz=128", "display_name": "Leon Trotsky", "link": "https://stackoverflow.com/users/10118785/leon-trotsky"}, "edited": false, "score": 0, "creation_date": 1535492923, "post_id": 52066558, "comment_id": 91083630, "body": "The size should be 14 bytes, i don&#39;t think sizeof is accurate here. Try to use a char pointer and see exactly what the size is."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535492943, "post_id": 52066558, "comment_id": 91083636, "body": "I suspect the padding now exist at the end.  Perhaps the <code>__attribute__((packed))</code> only handled inter-member padding?"}, {"owner": {"reputation": 13, "user_id": 7433532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13def48895633632028cf7c25642230?s=128&d=identicon&r=PG&f=1", "display_name": "Maher kassem", "link": "https://stackoverflow.com/users/7433532/maher-kassem"}, "edited": false, "score": 1, "creation_date": 1535492970, "post_id": 52066558, "comment_id": 91083644, "body": "I am using codeblocks ."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535493121, "post_id": 52066558, "comment_id": 91083694, "body": "Better to use <code>&quot;%zu&quot;</code> than <code>&quot;%i&quot;</code> with <code>sizeof</code> to avoid UB, yet I think some other issue exist."}, {"owner": {"reputation": 13, "user_id": 7433532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13def48895633632028cf7c25642230?s=128&d=identicon&r=PG&f=1", "display_name": "Maher kassem", "link": "https://stackoverflow.com/users/7433532/maher-kassem"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535493145, "post_id": 52066558, "comment_id": 91083708, "body": "@chux I tried to add the __attribute__((packed))  to every element in the structure still the same ."}, {"owner": {"reputation": 13, "user_id": 7433532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13def48895633632028cf7c25642230?s=128&d=identicon&r=PG&f=1", "display_name": "Maher kassem", "link": "https://stackoverflow.com/users/7433532/maher-kassem"}, "reply_to_user": {"reputation": 916, "user_id": 4987083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIf0f.jpg?s=128&g=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/4987083/alessandro"}, "edited": false, "score": 0, "creation_date": 1535493174, "post_id": 52066558, "comment_id": 91083715, "body": "@Alessandro where did you compile ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1535493435, "post_id": 52066558, "comment_id": 91083808, "body": "Although you will certainly get an answer, consider an alternative to the higher level coding goal and form a solution that does not require compiler extensions like <code>__attribute__((packed))</code>.  <code>BITMAPFILEHEADER</code> is commonly a padding problem."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1535493476, "post_id": 52066558, "comment_id": 91083826, "body": "code::blocks is an IDE, not a compiler.  It supports many different compilers, and it potentially matters which one you&#39;re using."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1535493661, "post_id": 52066558, "comment_id": 91083878, "body": "Your program compiles cleanly for me with GCC 4.8.5, and when the result is run, it prints &quot;14&quot;.  This is what I would expect from GCC, based on its documentation of <code>__attribute__((packed))</code>.  Note that the whole attribute system is a GCC invention, not a provision of the standard.  If other compilers support it, then it is not certain that they provide the same semantics."}, {"owner": {"reputation": 13, "user_id": 7433532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13def48895633632028cf7c25642230?s=128&d=identicon&r=PG&f=1", "display_name": "Maher kassem", "link": "https://stackoverflow.com/users/7433532/maher-kassem"}, "edited": false, "score": 0, "creation_date": 1535494379, "post_id": 52066558, "comment_id": 91084088, "body": "The compiler is GNU GCC ."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1535496927, "post_id": 52066558, "comment_id": 91084752, "body": "@Maherkassem What version, and how <b>exactly</b> is it being called?"}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 2, "last_activity_date": 1535518019, "creation_date": 1535518019, "answer_id": 52069654, "question_id": 52066558, "link": "https://stackoverflow.com/questions/52066558/why-is-the-size-of-this-structure-16-byte/52069654#52069654", "title": "Why is the size of this structure 16 Byte?", "body": "<p>A bug was reported on the same problem in GCC 4.8.1. </p>\n\n<p><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61813\" rel=\"nofollow noreferrer\"><strong>attribute</strong>((<strong>packed</strong>)) does not pack struct containing uint16_t with uint32_t</a></p>\n\n<p>A comment on the bug report states that:</p>\n\n<blockquote>\n  <p>(<strong>attribute</strong>((packed)) doesn't work on mingw32 targets since ms-bitfields became the default).</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 7433532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13def48895633632028cf7c25642230?s=128&d=identicon&r=PG&f=1", "display_name": "Maher kassem", "link": "https://stackoverflow.com/users/7433532/maher-kassem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 52069654, "answer_count": 1, "score": 1, "last_activity_date": 1535525482, "creation_date": 1535492462, "last_edit_date": 1535525482, "question_id": 52066558, "link": "https://stackoverflow.com/questions/52066558/why-is-the-size-of-this-structure-16-byte", "title": "Why is the size of this structure 16 Byte?", "body": "<p>The size of <code>BITMAPFILEHEADER</code> should be 14 bytes, but when I run the code I get 16 bytes. I thought, it was because of padding so I added the <code>__attribute__((packed))</code>, but I still get 16 bytes. Why? </p>\n\n<pre><code>#include&lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef uint8_t  BYTE;\ntypedef uint32_t DWORD;\ntypedef int32_t  LONG;\ntypedef uint16_t WORD;\n\n\ntypedef struct\n{\nWORD bfType;\nWORD bfReserved1;\nWORD bfReserved2;\nDWORD bfSize;\nDWORD bfOffBits;\n} __attribute__((packed))\nBITMAPFILEHEADER;\n\nint main(void){\n\nprintf(\" %i \\n\",sizeof(BITMAPFILEHEADER));\nreturn 0;\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "android-ndk", "standards", "qmake", "c11"], "answers": [{"tags": [], "owner": {"reputation": 378, "user_id": 10146018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdcRa.png?s=128&g=1", "display_name": "noone", "link": "https://stackoverflow.com/users/10146018/noone"}, "is_accepted": false, "score": 1, "last_activity_date": 1535492364, "creation_date": 1535492364, "answer_id": 52066550, "question_id": 52066490, "link": "https://stackoverflow.com/questions/52066490/set-c-standard-in-qmake/52066550#52066550", "title": "set C standard in qmake", "body": "<p>I am able to solve it this way </p>\n\n<p>QMAKE_CFLAGS += -std=gnu11</p>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 10731523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8df731a2cda740534ce49382e4c6f91?s=128&d=identicon&r=PG&f=1", "display_name": "Rabter", "link": "https://stackoverflow.com/users/10731523/rabter"}, "is_accepted": false, "score": 0, "last_activity_date": 1575832810, "creation_date": 1575832810, "answer_id": 59239047, "question_id": 52066490, "link": "https://stackoverflow.com/questions/52066490/set-c-standard-in-qmake/59239047#59239047", "title": "set C standard in qmake", "body": "<p>If I understand you correctly, you try to force qmake to <code>c++11</code>, but you still have the same errors as it is not <code>c++11</code>.  Try</p>\n\n<pre><code>#incude &lt;iostream&gt;\n\nint main()\n{\n  std::cout &lt;&lt; __cplusplus;\n}\n</code></pre>\n\n<p>Compiler that supports <code>\u0421++98/03</code> builds a program that prints 199711\nFor <code>\u0421++11</code> the output is 201103\nFor <code>\u0421++14</code> it is 201300 or 201402<br>\n<strong>You have to rebuid your project after editing .pro file</strong></p>\n"}], "owner": {"reputation": 378, "user_id": 10146018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdcRa.png?s=128&g=1", "display_name": "noone", "link": "https://stackoverflow.com/users/10146018/noone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1575832810, "creation_date": 1535492061, "question_id": 52066490, "link": "https://stackoverflow.com/questions/52066490/set-c-standard-in-qmake", "title": "set C standard in qmake", "body": "<p>For android purpose I am forced to use qmake instead of cmake.\nI can set C++ standard to C++11 using </p>\n\n<pre><code>CONFIG += c++11\n</code></pre>\n\n<p>but I also have some C files which uses C11 . when I compile them I get errors like </p>\n\n<p>error: blahblah only allowed in C99 or C11 mode</p>\n\n<p>So I tried </p>\n\n<pre><code>CONFIG += c11 \n</code></pre>\n\n<p>which is also not working . what can I do set it to gnu11 or c11</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1535491677, "post_id": 52066414, "comment_id": 91083218, "body": "<code>strtok</code> accepts a <code>char*</code> as its first parameter but you&#39;re passing in an unassigned <code>char</code> value. Your code shouldn&#39;t even compile."}, {"owner": {"reputation": 1721, "user_id": 9070959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fc72be4dddc4ff4156a7d875912d67?s=128&d=identicon&r=PG&f=1", "display_name": "emsimpson92", "link": "https://stackoverflow.com/users/9070959/emsimpson92"}, "edited": false, "score": 0, "creation_date": 1535491731, "post_id": 52066414, "comment_id": 91083234, "body": "<code>atoi</code> should work"}, {"owner": {"reputation": 99, "user_id": 7998256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YkoLd.jpg?s=128&g=1", "display_name": "Rando", "link": "https://stackoverflow.com/users/7998256/rando"}, "edited": false, "score": 0, "creation_date": 1535491857, "post_id": 52066414, "comment_id": 91083268, "body": "can you help me convert this to an atoi example?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1535492057, "post_id": 52066414, "comment_id": 91083330, "body": "Strings are neither signed nor unsigned, and a string containing a text representation of an integer, regardless of signedness, is not a <code>char</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535492062, "post_id": 52066414, "comment_id": 91083331, "body": "@rando, Post needs more context.  Suggest posting how <code>credit1</code> get assigned its  <i>signed string</i>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1535497075, "post_id": 52066414, "comment_id": 91084798, "body": "<i>&quot;signed char credit1 or credit2&quot;</i> -- <code>credit1</code> and <code>credit2</code> are <i>pointers to char</i> not <code>char</code> -- did you mean <code>course1</code> and <code>course2</code>??"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1535497256, "post_id": 52067144, "comment_id": 91084848, "body": "If you&#39;re going to recommend <code>strtol()</code>, you need to get it right.  It&#39;s declared as <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.22.1.4\" rel=\"nofollow noreferrer\"><code>long int strtol( const char *restrict nptr, char ** restrict endptr, int base);</code></a>.  Your current posted usage ignores the converted value of the string, tries to use an <code>int *</code> where a <code>char **</code> should be and not only will print out the wrong result, it might fail badly as it&#39;s undefined behavior."}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1535541854, "post_id": 52067144, "comment_id": 91102155, "body": "You&#39;re totally right. Momentary brain damage :-P sorry!"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1535542409, "post_id": 52067144, "comment_id": 91102486, "body": "We&#39;ve all been there... :-)"}, {"owner": {"reputation": 99, "user_id": 7998256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YkoLd.jpg?s=128&g=1", "display_name": "Rando", "link": "https://stackoverflow.com/users/7998256/rando"}, "edited": false, "score": 0, "creation_date": 1535548857, "post_id": 52067144, "comment_id": 91106897, "body": "What are you declaring with the argument <code>n=long int strtol(str,NULL,10);</code>"}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "edited": false, "score": 0, "creation_date": 1535549712, "post_id": 52067144, "comment_id": 91107494, "body": "Long story short, it will parse the string <code>str</code> as a base-<code>10</code> integer and return its value (which is then stored in <code>n</code>)."}], "tags": [], "owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "is_accepted": false, "score": 1, "last_activity_date": 1535541974, "last_edit_date": 1535541974, "creation_date": 1535496270, "answer_id": 52067144, "question_id": 52066414, "link": "https://stackoverflow.com/questions/52066414/converting-a-signed-char-to-an-int-in-c/52067144#52067144", "title": "Converting a signed char to an int in c", "body": "<p>Use <a href=\"http://www.cplusplus.com/reference/cstdlib/strtol/\" rel=\"nofollow noreferrer\"><code>strtol</code></a> (which is the safer version of <a href=\"http://www.cplusplus.com/reference/cstdlib/atoi/\" rel=\"nofollow noreferrer\"><code>atoi</code></a>).</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n  char *str = \"5\";\n  int n;\n  n = strtol(str, NULL, 10);\n  printf(\"n+1 is %d\\n\", n+1);\n}\n</code></pre>\n\n<p>Using <code>atoi</code>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n  char *str = \"1\";\n  int n;\n  n = atoi(str);\n  printf(\"n+1 is %d\\n\", n+1);\n}\n</code></pre>\n\n<p>If instead of converting the digits in the string into an integer, you'd rather use the numerical value of the character, you can:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char c = 'a';\n    printf(\"ascii code of %c is %hhu\\n\", c, c);\n    printf(\"after %c is %c with ascii code %u\", c, c+1, c+1);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 7998256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YkoLd.jpg?s=128&g=1", "display_name": "Rando", "link": "https://stackoverflow.com/users/7998256/rando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1536752594, "answer_count": 1, "score": -1, "last_activity_date": 1535541974, "creation_date": 1535491604, "question_id": 52066414, "link": "https://stackoverflow.com/questions/52066414/converting-a-signed-char-to-an-int-in-c", "closed_reason": "Needs details or clarity", "title": "Converting a signed char to an int in c", "body": "<p>Im having an issue converting a signed string into an int.</p>\n\n<pre><code>char *crn1, *crn2, *credit1, credit2;\nchar course1, course2;\n\ncrn1=strtok(course1,\"/\");\ncredit1=strtok(NULL,\"/\");\n\ncrn2 = strtok(course2,\"/\");\ncredit2 = strtok(NULL,\"/\");\n</code></pre>\n\n<p>Im trying to convert the signed char credit1 or credit2 to an integer for math used later on in my code. I either get a huge number or an error. </p>\n"}, {"tags": ["c", "makefile", "undefined-symbol", ".so"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1535481142, "post_id": 52064206, "comment_id": 91078923, "body": "you need to link with the library as well. How did you link?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1535482302, "post_id": 52064206, "comment_id": 91079466, "body": "<i>&quot;But while linking I am getting undefined reference error.&quot;</i>  It would be most useful if you were to post the link command and the error message verbatim (i.e. copy &amp; paste exactly as they appear in the console)."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1535482721, "post_id": 52064206, "comment_id": 91079684, "body": "Read Drepper&#39;s <a href=\"https://www.akkadia.org/drepper/dsohowto.pdf\" rel=\"nofollow noreferrer\"><i>How to write shared libraries</i></a> paper. It explains that in details"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1535548361, "post_id": 52064206, "comment_id": 91106547, "body": "Please improve your question to show some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Without one, your question is unclear (and both answers have understood it differently). So <b>edit your question</b> to show a full (simplified) source code and all the compilation command you are using"}], "answers": [{"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1535548323, "post_id": 52064519, "comment_id": 91106522, "body": "Order of arguments to <code>gcc</code> matters a lot"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1535560191, "post_id": 52064519, "comment_id": 91114675, "body": "@BasileStarynkevitch : Fixed, I think.  Feel free to edit otherwise.  Thanks.  Note that the command line examples remain minimal - in practice other arguments are likely necessary."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1535560158, "last_edit_date": 1535560158, "creation_date": 1535482165, "answer_id": 52064519, "question_id": 52064206, "link": "https://stackoverflow.com/questions/52064206/how-does-so-file-lookup-for-symbols/52064519#52064519", "title": "how does .so file lookup for symbols?", "body": "<p>You appear to have a misunderstanding on how shared libraries work.  The .so file <em>contains</em> the definition, as does the .o file.  One is for dynamic linking, and the other for static linking.  You need to use on or the other, but not both.</p>\n\n<p>Say for example given your shared shared library <code>libcpld-cmd.so</code>, and you wish to link it to your code with source <code>main.c</code> for example, then:</p>\n\n<pre><code>gcc main.c -lcpld-cmd.so -o myprogram\n</code></pre>\n\n<p>The linker will process cpld-cmd.so to resolve symbols, but will not actually link the object code therein - that would be a static link.</p>\n\n<p>When you then run <code>myprogram</code>, the library must be available, and the OS loader will <em>dynamically</em> link the library code at runtime.  </p>\n\n<p>Ref: <a href=\"http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html\" rel=\"nofollow noreferrer\">http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html</a></p>\n\n<p>If on the other hand you wanted to statically link, you would link <code>cpld-cmd.o</code>, and the .so file plays no part and is not required - all the code is statically linked into <code>myprogram</code>.</p>\n\n<pre><code>gcc main.c cpld-cmd.o -o myprogram\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1535547916, "creation_date": 1535547916, "answer_id": 52078187, "question_id": 52064206, "link": "https://stackoverflow.com/questions/52064206/how-does-so-file-lookup-for-symbols/52078187#52078187", "title": "how does .so file lookup for symbols?", "body": "<blockquote>\n  <p>I have a .so file which has some extern function declarations. Definition of these functions are in a binary to which I am linking .so file. But while linking I am getting undefined reference error.</p>\n</blockquote>\n\n<p>Then you should link your main program (which is calling <a href=\"http://man7.org/linux/man-pages/man3/dlopen.3.html\" rel=\"nofollow noreferrer\">dlopen(3)</a>, or which is linking with your library) with the <code>-rdynamic</code>  flag (and of course the <code>-ldl</code> library providing <code>dlopen</code>, if you use that).</p>\n\n<p>Read also Drepper's <a href=\"https://www.akkadia.org/drepper/dsohowto.pdf\" rel=\"nofollow noreferrer\"><em>How To Write Shared Libraries</em></a> paper.</p>\n"}], "owner": {"reputation": 11, "user_id": 4348877, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-N4IiagbiIVs/AAAAAAAAAAI/AAAAAAAAAGg/z43KOTLfbyM/photo.jpg?sz=128", "display_name": "Umang Akash", "link": "https://stackoverflow.com/users/4348877/umang-akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1535560158, "creation_date": 1535480816, "last_edit_date": 1535481069, "question_id": 52064206, "link": "https://stackoverflow.com/questions/52064206/how-does-so-file-lookup-for-symbols", "title": "how does .so file lookup for symbols?", "body": "<p>I have a .so file which has some <code>extern</code> function declarations.\nDefinition of these functions are in a binary to which I am \nlinking .so file. But while linking I am getting undefined reference\nerror.</p>\n\n<p>Is there any way to provide some path in makefile of .so for symbol lookup.</p>\n\n<p>I used <code>objdump</code> to list symbols in .so(extern declaration) and .o(actual definition-different directory) , and I see same symbol is there in both places.</p>\n\n<pre><code>/homes/uakash/cmd/usr/lib64$ objdump -T libcpld-cmd.so.0 | grep Parent\n\n:::::\n\n0000000000000000      D  *UND*  0000000000000000              _Z29getParentCpldIFDOFromPreviousSt10shared_ptrIN3net74cpld14ParentCpldIFDOEERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE\n::::\n\n/homes/uakash/src/usr/sbin/l$ objdump -t cpld_cmd.o | grep Parent\n\n::::\n00000000000000d0 g     F .text  0000000000000600  _Z29getParentCpldIFDOFromPreviousSt10shared_ptrIN3net74cpld14ParentCpldIFDOEERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE\n::::\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 4, "creation_date": 1535478772, "post_id": 52063712, "comment_id": 91077842, "body": "It&#39;s undefined behavior if the declared type doesn&#39;t match the type of the definition."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1535479016, "post_id": 52063712, "comment_id": 91077941, "body": "That the return type is implicitly taken as <code>int</code> does not mean that you can expect your <code>float</code> to be <i>converted</i> to <code>int</code>.  It means that the caller will assume that it already <i>is</i> an <code>int</code>.  When that&#39;s not actually the case, the language does not specify what happens."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1535479020, "post_id": 52063712, "comment_id": 91077944, "body": "The fact that it defaulted to the type doesn&#39;t matter. The same thing would happen if you put the <code>int</code> return type explicitly. It still doesn&#39;t match the actual type that the function returns, so it&#39;s undefined behavior."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1535479083, "post_id": 52063712, "comment_id": 91077982, "body": "Moreover, modern C no longer has implicit typing at any level.  Compilkers that accept it do so only for backwards compatibility.  Do not write code that relies on it."}], "answers": [{"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1535483063, "post_id": 52063914, "comment_id": 91079841, "body": "I am not aware of <i>any</i> compiler that doesn&#39;t accept implicit <code>int</code> and implicit function declarations, even in the mode that is allegedly strictly conforming to the latest version of the C standard. (There may be an option to error out specifically on these constructs, but it&#39;s usually documented as making a warning into an error.) As such I think it is too harsh to describe these features as &quot;removed from the C language&quot;, even though you are correct per the letter of the standard."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535488223, "post_id": 52063914, "comment_id": 91082013, "body": "@zwol <a href=\"https://godbolt.org/z/2WQ1YA\" rel=\"nofollow noreferrer\">You&#39;d be surprised</a>, and -pedantic-errors means exactly that, error out on actual violations of the standard. Not turn all warning to errors, not turn one specific warning to an error, but <i>diagnose errors as errors</i>."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535494704, "post_id": 52063914, "comment_id": 91084201, "body": "Argh, no, not this misconception again.  <code>-pedantic-errors</code> is just an older name for <code>-Werror=pedantic</code>, i.e. turn the warnings about constructs forbidden by the C standard, where the GCC developers in the early 1990s thought forbidding them was silly, into errors.  GCC&#39;s strictly conforming mode is documented to be <code>-std=cXX -Wall -Wpedantic</code>, don&#39;t confuse people by contradicting the manual on this point."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535516638, "post_id": 52063914, "comment_id": 91088690, "body": "@zwol &quot;Argh, no, not this misconception again. -pedantic-errors is just an older name for -Werror=pedantic&quot; No it is not. The GCC manual says that very clearly, I quote, <b>This is not equivalent to -Werror=pedantic</b>."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535552861, "post_id": 52063914, "comment_id": 91109741, "body": "That is a bug. Weird that they chose to document the bug rather than fixing it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535554364, "post_id": 52063914, "comment_id": 91110852, "body": "@zwol I have no idea why you are calling a useful feature &quot;a bug&quot;."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535555489, "post_id": 52063914, "comment_id": 91111743, "body": "The bug is that <code>-pedantic-errors</code> and <code>-(W)pedantic</code> enable different sets of diagnostics. There is no way to make that make sense to people who just want to use the dang thing and don&#39;t want to memorize the C standard first. The Right Thing would be individual -W switches for each diagnostic that could be turned on or off in the first place, and then reevaluate which diagnostics ought to be included in <code>-Wpedantic</code>, <code>-Wall</code>, or on by default, and make <code>-pedantic-errors</code> genuinely just a backward compatibility name for <code>-Werror=pedantic</code>. I&#39;d have done this years ago if I still worked on GCC."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535558027, "post_id": 52063914, "comment_id": 91113467, "body": "@zwol -pedantic-errors does the right thing for me. I don&#39;t really care that other non-equivalent options are out there, and I also don&#39;t care how the option is spelled. If you think the set of diagnostics emitted by by -Werror=pedantic should be changed to match that of -pedantic-errors, go ahead, more power to you, I may switch to the more consistent spelling. If you thing the other way around, then please no."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 7, "last_activity_date": 1535479464, "creation_date": 1535479464, "answer_id": 52063914, "question_id": 52063712, "link": "https://stackoverflow.com/questions/52063712/clarification-regarding-default-return-type-at-global-space/52063914#52063914", "title": "Clarification regarding default return type at global space", "body": "<p>Implicit <code>int</code> and implicit function declarations are <strong>removed</strong> from the C language. They are no more. The program is <strong>ill-formed</strong>. If your compiler accepts it, then you are dealing with a vendor extension \u2014 or a compiler for an outdated version of C.</p>\n\n<p>Before these things were removed, the program had <strong>undefined behaviour</strong>. All editions of the standard require that all declarations of an entity in a program must be compatible, regardless of whether anything in them is implicit or not. Violations of this rule lead to undefined behaviour, with no diagnostic required. </p>\n"}], "owner": {"reputation": 274, "user_id": 8977486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7II8r.png?s=128&g=1", "display_name": "infinite", "link": "https://stackoverflow.com/users/8977486/infinite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52063914, "answer_count": 1, "score": 0, "last_activity_date": 1535479586, "creation_date": 1535478680, "question_id": 52063712, "link": "https://stackoverflow.com/questions/52063712/clarification-regarding-default-return-type-at-global-space", "title": "Clarification regarding default return type at global space", "body": "<p>While making a function <code>atof</code>, I splitted the entire work into two separate translational units:</p>\n\n<hr>\n\n<p><strong>m.c</strong></p>\n\n<pre><code>  #include&lt;stdio.h&gt;\n\n  extern  fun(char[]);  //return type not mentioned on purpose\n\n\n  int main()\n  {\n     printf(\"%d\\n\",fun(\"+123.980\")); //%f would also display 0.000000\n     return 0;\n  }\n</code></pre>\n\n<hr>\n\n<p><strong>n.c</strong></p>\n\n<pre><code>   #include&lt;ctype.h&gt;\n\n   float fun(char c[])\n   {\n       float val=0, pow=1;\n       int i;\n       int sign;\n\n       for(i=0;isspace(c[i]);i++); //SKIPPING WHITESPACE IF ANY\n\n       if(c[i]=='+')\n           sign = 1;\n       if(c[i]=='-')\n           sign =-1;\n       ++i;\n\n       for(;c[i]!='.';i++)\n           val = val*10 + (c[i]-'0');\n       ++i;\n\n       while(isdigit(c[i]))\n       {\n            val = val*10 + (c[i]-'0');\n            pow=pow*10;\n            ++i;\n       }\n\n       return sign*val/pow;   \n   }\n</code></pre>\n\n<p>The warning says that the type of function will default to <code>int</code> in this case since every variable/function type at global space without any return type mentioned explicitly defaults to int. </p>\n\n<p>I was expecting the output to be <code>int</code> version of <strong>+123.980</strong> i.e <strong>123</strong> only.\nBut instead it shows 0 (otherwise function works fine). Why?</p>\n"}, {"tags": ["c", "floating-point", "standard-library"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535477772, "post_id": 52063370, "comment_id": 91077380, "body": "I can tell you that IEEE 754-2008 (as incorporated into C by ISO/IEC TS 18661) adds exactly the single-parameter functions you suggest would be ideal, under the names <code>nextup</code> and <code>nextdown</code>. I can also tell you that the <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=math/s_nextafter.c;hb=HEAD\" rel=\"nofollow noreferrer\">glibc implementation of <code>nextafter</code></a> is not doing anything clever, and that it only cares about whether its second argument is greater or less than its first argument, not the magnitude of the difference. I don&#39;t know why <code>nextafter</code> was specified the way it was in the first place."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1535478160, "post_id": 52063370, "comment_id": 91077557, "body": "I also don&#39;t know how expensive this operation is.  The glibc implementation does bit-twiddling on the binary representation using integer instructions, which is often fairly heavyweight just because you have to copy from float to integer registers and back, but that&#39;s just a guess.  Also, there may not be any better way to do this, short of adding it as a primitive operation to the CPU&#39;s instruction set."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1535481669, "post_id": 52063370, "comment_id": 91079168, "body": "<code>nextafter( double from, double to )</code>   always has a well defined answer.  <code>AnT_nextafter(a)</code> does not on a system without  a code-able infinity.  Example:  <code>AnT_nextafter(DBL_MAX)</code>?  Still a good question.  This corner case if the only advantage I see to <code>nextafter(from, to)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1535490838, "post_id": 52065974, "comment_id": 91082970, "body": "To be clear about the footnote: If you have -0.0, the value representation is <code>0x80000000 00000000</code>. Just adding 1 to the representation will yield <code>0x80000000 00000001</code>, which is <code>-FLT_MIN</code>, whereas the correct value is <code>0x00000000 00000001</code>. So in this particular corner case, you need to flip the sign bit before adding the one. If the words were confusing, please let me know so I can try to write it better."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 4, "last_activity_date": 1535490924, "last_edit_date": 1535490924, "creation_date": 1535489143, "answer_id": 52065974, "question_id": 52063370, "link": "https://stackoverflow.com/questions/52063370/nextafter-and-nexttoward-why-this-particular-interface/52065974#52065974", "title": "`nextafter` and `nexttoward`: why this particular interface?", "body": "<p>With IEEE-754 binary floating point representations, if both arguments of <code>nextafter</code> are finite and the two arguments are not equal, then the result can be computed by either adding one to or subtracting one from the representation of the number reinterpreted as an unsigned integer [Note 1]. The (slight) complexity results from correctly dealing with the corner cases which do not meet those preconditions, but in general you'll find that it is extremely fast.</p>\n\n<p>Aside from NaNs, the only thing that matters about the second argument is whether it is greater than, less than, or equal to the first argument. </p>\n\n<p>The interface basically provides additional clarity for the corner case results, but it is also sometimes useful. In particular, the usage <code>nextafter(x, 0)</code>, which truncates regardless of sign, is often convenient. You can also take advantage of the fact that <code>nextafter(x, x);</code> is <code>x</code> to clamp the result at an arbitrary value.</p>\n\n<p>The difference between <code>nextafter</code> and <code>nexttowards</code> is that the latter allows you to use the larger dynamic range of <code>long double</code>; again, that helps with certain corner cases.</p>\n\n<hr>\n\n<ol>\n<li>Strictly speaking, if the first argument is a zero of some sign and the other argument is a valid non-zero number of the opposite sign, then the argument needs to have its sign bit flipped before the increment. But it seemed too much legalese to add that to the list, and it is still hardly a complicated transform.</li>\n</ol>\n"}], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 52065974, "answer_count": 1, "score": 4, "last_activity_date": 1535490924, "creation_date": 1535477066, "last_edit_date": 1535478300, "question_id": 52063370, "link": "https://stackoverflow.com/questions/52063370/nextafter-and-nexttoward-why-this-particular-interface", "title": "`nextafter` and `nexttoward`: why this particular interface?", "body": "<p>What exactly is the reason behind this peculiar interface of <code>nextafter</code> (and <code>nexttoward</code>) <a href=\"https://en.cppreference.com/w/c/numeric/math/nextafter\" rel=\"nofollow noreferrer\">functions</a>? We specify the <em>direction</em> by specifying the value we want to move <em>toward</em>. </p>\n\n<p>At the first sight it feels as if something non-obvious is hidden behind this idea. In my (naive) opinion the first choice for such functions would be something like a pair of single-parameter functions <code>nextafter(a)</code>/<code>nextbefore(a)</code>. The next choice would be a two-parameter function <code>nextafter(a, dir)</code> in which the direction <code>dir</code> is specified explicitly (<code>-1</code> and <code>+1</code>, some standard enum, etc.). </p>\n\n<p>But instead we have to specify a <em>value</em> we want to move <em>toward</em>. Hence a number of questions</p>\n\n<ol>\n<li><p>(A vague one). There might be some clever idea or idiomatic pattern that is so valuable that it influenced this choice of interface in these standard functions. Is there?</p></li>\n<li><p>What if decide to just blindly use <code>-DBL_MAX</code> and <code>+DBL_MAX</code> as the second argument for <code>nextafter</code> to specify the negative and positive direction respectively. Are there any pitfalls in doing so?</p></li>\n<li><p>(A refinement of 2). If I know for sure that <code>b</code> is [slightly] greater than <code>a</code>, is there any reason to prefer <code>nextafter(a, b)</code> over <code>nextafter(a, DBL_MAX)</code>? E.g. is there a chance of better performance for <code>nextafter(a, b)</code> version?</p></li>\n<li><p>Is <code>nextafter</code> generally a <em>heavy</em> operation? I know that it is implementation-dependent. But, again, assuming an implementation that is based in IEEE 754 representations, is it fairly \"difficult\" to find the adjacent floating-point value?</p></li>\n</ol>\n"}, {"tags": ["c", "linux-kernel", "kernel-module"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1535475514, "post_id": 52062949, "comment_id": 91076269, "body": "Please provide a more concrete example, what do you mean by &quot;directly returning a value&quot;? And who says that there is space saved either way, compilers use registers for these things?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1535475555, "post_id": 52062949, "comment_id": 91076290, "body": "You always directly returning a value."}, {"owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1535475611, "post_id": 52062949, "comment_id": 91076325, "body": "@Osiris but on obe you return without the need to come all the way to the end of the function"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1535475725, "post_id": 52062949, "comment_id": 91076387, "body": "Often there is some resource management to deal with between when <code>ret</code> is set and returned \u2014 that&#39;s a common reason for using a variable instead of some sort of constant. Sometimes, the return value is itself the result of a function call; that might be <code>return function(args);</code> or <code>ret = function(args);</code> and later <code>return ret;</code>. The difference isn&#39;t likely to measurable and isn&#39;t significant. There are other much bigger things to worry about for performance. Another factor is that the original schools of thought on structured programming advocated a single return point from functions."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1535475983, "post_id": 52062949, "comment_id": 91076531, "body": "95 times out of 100, the compiler can optimise better than you can. So if you think &quot;oh but this variable just wastes space&quot;, the compiler has probably already eliminated it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1535476025, "post_id": 52062949, "comment_id": 91076554, "body": "Often, a local variable is used because it makes debugging MUCH easier as the value is displayable."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1535482741, "post_id": 52062949, "comment_id": 91079694, "body": "The point at which the return value is determined, need not be the point at which you need to return.  There may be required operations that do not affect the return value."}], "answers": [{"comments": [{"owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "edited": false, "score": 0, "creation_date": 1535476842, "post_id": 52063246, "comment_id": 91076967, "body": "I should learn more about compiler optimizations..."}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "reply_to_user": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "edited": false, "score": 1, "creation_date": 1535500229, "post_id": 52063246, "comment_id": 91085477, "body": "@Garmekain <i>&quot;I should learn more about compiler optimizations&quot;</i> -- No, you would be better off learning structured programming and Linux <a href=\"https://www.kernel.org/doc/html/v4.10/process/coding-style.html\" rel=\"nofollow noreferrer\">kernel coding style</a>.  Note that section 7, <a href=\"https://www.kernel.org/doc/html/v4.10/process/coding-style.html#centralized-exiting-of-functions\" rel=\"nofollow noreferrer\">Centralized exiting of functions</a> is related to your question."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1535476536, "creation_date": 1535476536, "answer_id": 52063246, "question_id": 52062949, "link": "https://stackoverflow.com/questions/52062949/why-on-many-drivers-the-return-value-of-functions-is-handled-with-variables/52063246#52063246", "title": "Why on many drivers, the return value of functions is handled with variables?", "body": "<p>In general, a code structure that looks complicated and is nested with a structure such as:</p>\n\n<pre><code>Calculate some things, look up some things.\nif (one thing)\n{\n    Get some more things.\n    if (another thing)\n        \u2026\n}\nelse\n{\n    Get different things.\n    if (that thing)\n        \u2026\n    else\n        \u2026\n            \u2026\n                if (yet another decision)\n                    retval = SURE_THAT_IS_FINE;\n                else\n                    \u2026\n            \u2026\n        \u2026\n    \u2026\n}\n</code></pre>\n\n<p>will be exactly equivalent to the same code with the <code>retval =</code> replaced by <code>return SURE_THAT_IS_FINE</code>. That is because any compiler of normal quality constructs, among other things, a flow graph for the code. Whether the code has a <code>return</code> statement deep inside the nested structure or merely falls out of the nested structure, the very next thing executed is a return from the function. Even with the assignment statement, the compiler will see that <code>retval</code> is used only to return a value from the function, so the compiler will optimize away the assignment\u2014it will merely put the value in the appropriate place to return it from the function and not actually write it to separate memory allocated for <code>retval</code>.</p>\n\n<p>So, a far as the compiler and the generated code is concerned, there will be no difference between these two choices. Then why might we pick one over the other?</p>\n\n<p>Software grows to become complicated, and humans are prone to making mistakes when working with complicated code. One way to reduce errors is to create regular patterns to follow. If we figure out patterns that work, and we follow those patterns when writing our code, then we relieve ourselves of some of the need to analyze all the code while we are writing or modifying it\u2014we can follow the pattern instead of retracing all the codes in our minds multiple times to figure it out. Programming does not require us to follow patterns, but using patterns is a tool to make our work easier or better.</p>\n\n<p>In this case, driver developers may have established a pattern of always assigning <code>retval</code>and falling through to the end of the driver routine. In some drivers, there might be some final processing code just before the <code>return</code>. For example, there might be code to release resources that were allocated or code to trigger certain things if an error code is being returned. Even there was no such code in the particular drivers you looked at, there may be in others. And following the pattern of always falling through to the end of the routine instead of returning directly serves the purpose of ensuring that this final processing code is always executed, not bypassed.</p>\n\n<p>That is just one example. There could be other reasons for using this pattern.</p>\n"}], "owner": {"reputation": 674, "user_id": 6911731, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6469fc87e72fcca5073e6916afafb908?s=128&d=identicon&r=PG", "display_name": "Garmekain", "link": "https://stackoverflow.com/users/6911731/garmekain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1535497306, "accepted_answer_id": 52063246, "answer_count": 1, "score": 0, "last_activity_date": 1535476536, "creation_date": 1535475320, "question_id": 52062949, "link": "https://stackoverflow.com/questions/52062949/why-on-many-drivers-the-return-value-of-functions-is-handled-with-variables", "closed_reason": "Opinion-based", "title": "Why on many drivers, the return value of functions is handled with variables?", "body": "<p>I see in a lot of drivers code like</p>\n\n<pre><code>static rettype fun(argtype arg) {\n    rettype ret;\n    // do some stuff and change ret accordingly\n    return ret;\n}\n</code></pre>\n\n<p>couldn't that be handled faster when directly returning a value or gotoing when possible? That way you save the space of the return value and an assignation for ret that you'd need to do at least. I'm confused, every help would be nice. Thanks.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 5, "creation_date": 1535474846, "post_id": 52062779, "comment_id": 91075907, "body": "<code>scanf()</code> has a return value that will help you"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535474918, "post_id": 52062779, "comment_id": 91075932, "body": "you could use the macros defined in the header file <code>ctype.h</code> and/or you could make use of the functions like <code>strtol()</code> which will tell you if a problem occurred"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535475120, "post_id": 52062779, "comment_id": 91076042, "body": "for ease of readability and understanding: 1) consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces.  2)  variable names should indicate <code>content</code> or <code>usage</code> (or better, both).  Names like a, b, c are meaningless, even in the current context"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1535475205, "post_id": 52062779, "comment_id": 91076096, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value to assure the operation was successful.  Note: those functions return a count of how many input conversions were successfully performed"}], "answers": [{"tags": [], "owner": {"reputation": 2361, "user_id": 3917161, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4eec7fe572407b99eb30199b0a96a2dc?s=128&d=identicon&r=PG&f=1", "display_name": "J3soon", "link": "https://stackoverflow.com/users/3917161/j3soon"}, "is_accepted": false, "score": 1, "last_activity_date": 1535475503, "last_edit_date": 1535475503, "creation_date": 1535475024, "answer_id": 52062868, "question_id": 52062779, "link": "https://stackoverflow.com/questions/52062779/how-to-check-an-input-for-a-specific-data-type/52062868#52062868", "title": "How to check an input for a specific data type?", "body": "<p>You should use the return value of scanf.</p>\n\n<blockquote>\n  <p>int std::scanf( const char* format, ... );</p>\n  \n  <p><strong>Return value</strong></p>\n  \n  <p>Number of receiving arguments successfully assigned.</p>\n  \n  <p>--- from <a href=\"https://en.cppreference.com/w/cpp/io/c/fscanf\" rel=\"nofollow noreferrer\">cppreference</a></p>\n</blockquote>\n\n<p>Full Code:</p>\n\n<pre><code># include &lt;stdio.h&gt;\nint main()\n{\n    int a, b, c;\n\n    printf(\"Enter no. 1 \\n\");\n    while(scanf(\"%d\", &amp;a) != 1)\n        getchar();\n\n    printf(\"Enter no. 2 \\n\");\n    while(scanf(\"%d\", &amp;b) != 1)\n        getchar();\n\n    c = a + b;\n    printf(\"The sum is %d\\n\", c);\n    return 0;\n}\n</code></pre>\n\n<p>So when <code>scanf</code> fails to read a decimal, it'll return <code>0</code>. So we need to use <code>getchar</code> to remove the non-decimal character and continue to receive the decimal input.</p>\n\n<p>The strange <code>c</code> value you got is because of the failing <code>scanf</code>, it'll keep the <code>a</code> value unassigned, so it will be some garbage value.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1535478357, "last_edit_date": 1535478357, "creation_date": 1535478037, "answer_id": 52063573, "question_id": 52062779, "link": "https://stackoverflow.com/questions/52062779/how-to-check-an-input-for-a-specific-data-type/52063573#52063573", "title": "How to check an input for a specific data type?", "body": "<blockquote>\n  <p>How to check an input for a specific data type?<br>\n  ... when i entered a string it came out something like this. ...<br>\n  how to check if the input gained is an integer ...</p>\n</blockquote>\n\n<p>User input is not <em>strings</em> nor integer nor some specific type.  User input is <em>text</em> (a sequence of characters) including control codes like <code>'\\n'</code>.  <code>scanf()</code> takes this text and converts it.  </p>\n\n<p>How <code>scanf()</code>converts depends on the <em>format</em> string.</p>\n\n<p><code>scanf(\"%d\",&amp;a);</code> will attempt to consume the input text and convert to an <code>int</code> and save that value to the place pointed to by <code>&amp;a</code>.  If text is entered that does not conform to a expected sequence like <em>optional spaces</em> + <em>optional sign</em> + <em>digits</em>, then input is left in <code>stdin</code> for the next input operation.</p>\n\n<p>Code can detect conversion success by the return value of <code>scanf()</code> which is usually the number of completed conversions.</p>\n\n<pre><code>int completed_conversions = scanf(\"%d\",&amp;a);\nif (completed_conversions == 1) {\n  puts(\"An `int` was read\");\n} else if (completed_conversions == 0) {\n  puts(\"Non numerical input detected, nothing read, `a` unchanged\");\n} else if (completed_conversions == EOF) {\n  puts(\"End-of-file or rare input error occurred\");\n}\n</code></pre>\n\n<p>Now what to do if text input does not make sense for an <code>int</code>?  Perhaps throw away all input until the end of the line (or end-of-file) and try again.</p>\n\n<pre><code>while (scanf(\"%d\",&amp;a) != 1) {\n  int ch;\n  puts(\"Let us try again.\");\n  while ((ch = fgetc(stdin)) != '\\n') {\n    if (ch == EOF) {\n      puts(\"End of file or error - let's go home.\");\n      return EXIT_FAILURE;\n    } \n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7527717, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-C07esfwpMUs/AAAAAAAAAAI/AAAAAAAACF4/bsEg2bPTIRU/photo.jpg?sz=128", "display_name": "Nehit Verma", "link": "https://stackoverflow.com/users/7527717/nehit-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1535478357, "creation_date": 1535474614, "last_edit_date": 1535476056, "question_id": 52062779, "link": "https://stackoverflow.com/questions/52062779/how-to-check-an-input-for-a-specific-data-type", "title": "How to check an input for a specific data type?", "body": "<p>I am at very and i mean very beginnings of C programming, but i have a question that is prohibiting me to move further.</p>\n\n<p>I was making an addition of two numbers program in C and i used the following code :</p>\n\n<pre><code># include &lt;stdio.h&gt;\nint main()\n{\n    int a,b,c;\n\n    printf(\"Enter no. 1 \\n\");\n    scanf(\"%d\",&amp;a);\n\n    printf(\"Enter no. 2 \\n\");\n    scanf(\"%d\",&amp;b);\n\n    {\n        c=a+b;\n    }\n    printf(\"The sum is %d\\n\", c);\n\n    return (0);\n}\n</code></pre>\n\n<p>Now, as i ran the program with a few inputs, it ran just fine.\nBut when i entered a string it came out something like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Q9hz.png\" rel=\"nofollow noreferrer\">Output addition_int</a></p>\n\n<p>Can anyone please tell me how to check if the input gained is an integer and add it as an argument. A possible if else statement ? \nThanks in advance</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 3, "creation_date": 1535474539, "post_id": 52062706, "comment_id": 91075749, "body": "You need to dereference it twice, since it&#39;s a 2D array: <code>*(*(arr+2))</code>"}, {"owner": {"reputation": 191, "user_id": 9993995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e18682060d986b994b99b793257ef6?s=128&d=identicon&r=PG&f=1", "display_name": "dave", "link": "https://stackoverflow.com/users/9993995/dave"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1535474753, "post_id": 52062706, "comment_id": 91075862, "body": "@GovindParmar Would you please explain why?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1535474755, "post_id": 52062706, "comment_id": 91075863, "body": "<code>arr[2]</code> and <code>*(arr + 2)</code> are the same by definition in the language (C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.2.1p2\" rel=\"nofollow noreferrer\">&#167;6.5.2.1 Array subscripting &#182;2</a>).  And you get odd results because you&#39;re printing an address, not the value of a cell in the array.  That&#39;s officially undefined behaviour; you pass an address to <code>printf()</code> but tell it that it&#39;s got an unsigned integer to work on.  You might be OK on a 32-bit platform, sort of, more or less.  Results are not remotely reliable on a 64-bit platform."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535474841, "post_id": 52062706, "comment_id": 91075904, "body": "The double dereference is necessary because it is a 2D array.  <code>arr[2]</code> is a pointer to an array of 2 <code>int</code>; <code>arr[2][0]</code> and <code>arr[2][1]</code> are the two values.  <code>*arr[2]</code> would reference the <code>3</code> too."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1535475011, "post_id": 52062706, "comment_id": 91075977, "body": "technically you&#39;re getting UB since <code>%u</code> is not for printing pointers. <a href=\"https://stackoverflow.com/q/9053658/995714\">You have to use <code>%zu</code></a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 7, "creation_date": 1535475171, "post_id": 52062706, "comment_id": 91076073, "body": "@phuclv: You&#39;re right that <code>%u</code> is UB, but so is using <code>%zu</code> (that&#39;s for printing <code>size_t</code>).  You should either use <code>%p</code> and cast the pointer to a <code>void *</code>, or use <code>&lt;inttypes.h&gt;</code> and <code>PRIuPTR</code> (or <code>PRIXPTR</code> for upper-case hex) plus a cast to <code>uintptr_t</code>."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1535475742, "post_id": 52062706, "comment_id": 91076400, "body": "<code>printf</code>-ing pointer values with <code>%u</code> triggers undefined behavior. End of story. Your preceived &quot;equivalence&quot; is nothing more than an illusion created by an invalid format specifier in <code>printf</code>."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1535475798, "post_id": 52062706, "comment_id": 91076434, "body": "@phuclv: How is <code>%zu</code> better than <code>%u</code>??? <code>%zu</code> is intended for <code>size_t</code> arguments. Pointers are not <code>size_t</code>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1535475893, "post_id": 52062706, "comment_id": 91076481, "body": "@AnT yes that&#39;s a typo. The linked question already said that it should be <code>%p</code>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1535475898, "post_id": 52062706, "comment_id": 91076482, "body": "@phuclv : False. <code>%zu</code> requires a <code>size_t</code> argument. Any incompatible type will trigger undefined behavior. Pointer arguments will trigger undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 9993995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e18682060d986b994b99b793257ef6?s=128&d=identicon&r=PG&f=1", "display_name": "dave", "link": "https://stackoverflow.com/users/9993995/dave"}, "edited": false, "score": 0, "creation_date": 1535519880, "post_id": 52062846, "comment_id": 91089608, "body": "<code>*(*(arr + 2));</code> throws <code>[Error] expected &#39;)&#39; before &#39;;&#39; token</code> but <code>*(*(arr + 1) + 1));</code> prints <code>3</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 191, "user_id": 9993995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e18682060d986b994b99b793257ef6?s=128&d=identicon&r=PG&f=1", "display_name": "dave", "link": "https://stackoverflow.com/users/9993995/dave"}, "edited": false, "score": 1, "creation_date": 1535541673, "post_id": 52062846, "comment_id": 91102037, "body": "@dave <code>*(*(arr + 2))</code> works properly for me.  You&#39;re probably missing a closing brace for your <code>printf</code> call.  Also, <code>*(*(arr + 1) + 1))</code> is choosing a different array element which happens to have the same value as the one you&#39;re attempting to print.  <code>arr[2][0]</code> and <code>arr[1][1]</code> both contain the value 3."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 14, "last_activity_date": 1535475993, "last_edit_date": 1535475993, "creation_date": 1535474923, "answer_id": 52062846, "question_id": 52062706, "link": "https://stackoverflow.com/questions/52062706/arr-2-is-equivalent-to-arr-2-how/52062846#52062846", "title": "(arr + 2) is equivalent to *(arr + 2) . How?", "body": "<p>A 2D array is really an array of arrays.</p>\n\n<p>The expression <code>arr + 2</code> has type <code>int (*)[2]</code>, while <code>*(arr + 2)</code> has type <code>int [2]</code>.  When printing the former, you have a pointer so that value of the pointer is printed.  In the latter case, you have an array which decays to a pointer to the first element.  So <code>*(arr + 2)</code> decays into <code>arr + 2</code>, which is the same as the first expression.</p>\n\n<p>Going into more detail on <code>arr + 2</code>, <code>arr</code> has type <code>int [3][2]</code>.  When you add an integer value to it, it decays to a pointer to the first member, so <code>arr</code> decays to type <code>int (*)[2]</code>, and <code>arr + 2</code> also has that type, and points to the subarray containing <code>{ 3, 4 }</code>.</p>\n\n<p>Also note that pointers should be printed with the <code>%p</code> format specifier, and that the pointer must be casted to <code>void *</code>, otherwise you invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>.  In this case you were \"lucky\" that they happened to print the same thing.</p>\n\n<p>To get the output of 3 you were expecting, you need to dereference one more time:</p>\n\n<pre><code>*(*(arr + 2))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1535475247, "creation_date": 1535475247, "answer_id": 52062928, "question_id": 52062706, "link": "https://stackoverflow.com/questions/52062706/arr-2-is-equivalent-to-arr-2-how/52062928#52062928", "title": "(arr + 2) is equivalent to *(arr + 2) . How?", "body": "<p><code>arr</code> is an array of arrays of <code>int</code>. On almost any use an array is converted to a pointer to its first element. So <code>arr</code> gets converted to a pointer to an array of <code>int</code>.</p>\n\n<p>OK, <code>arr</code> gets converted to a pointer to an array of <code>int</code>, so <code>(arr+2)</code> is of the same type, that is, a pointer to an array of <code>int</code>.</p>\n\n<p>Now <code>*(arr+2)</code> is the thing <code>(arr+2)</code> points to. That is, an array of <code>int</code>.</p>\n\n<p>Now since it's an array of <code>int</code>, it gets converted to a pointer to its first element. So  <code>*(arr+2)</code> gets converted to a pointer to <code>int</code>. Note it is <em>not</em> an <code>int</code> and is unlikely to be equal to <code>3</code>.</p>\n\n<p>Now how come <code>(arr+2)</code> and <code>*(arr+2)</code> dosplay the same? They are a pointer to an array and a pointer to its first element. Although these pointets are of different types, they represent the same address, because the address of any array is the same as the address of its first element.</p>\n"}, {"tags": [], "owner": {"reputation": 346, "user_id": 6709711, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/8tZM5.jpg?s=128&g=1", "display_name": "SynAck", "link": "https://stackoverflow.com/users/6709711/synack"}, "is_accepted": false, "score": 1, "last_activity_date": 1535475633, "creation_date": 1535475633, "answer_id": 52063016, "question_id": 52062706, "link": "https://stackoverflow.com/questions/52062706/arr-2-is-equivalent-to-arr-2-how/52063016#52063016", "title": "(arr + 2) is equivalent to *(arr + 2) . How?", "body": "<p><code>arr</code> is the pointer to the first array of the type <code>int[2]</code>.<code>(arr + 2)</code> is the pointer to the third such array.<br>\nWhereas <code>*(arr + 2)</code> is the pointer to the first element of the <code>(arr +2)</code> array.\n<br>\nBoth of these will hence have the same address since they are pointing to the same position.The only difference being in their type.<code>(arr+2)</code> is of the type <code>int(*)[2]</code> whereas <code>*(arr + 2)</code> is of the type <code>int *</code>.</p>\n"}], "owner": {"reputation": 191, "user_id": 9993995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e18682060d986b994b99b793257ef6?s=128&d=identicon&r=PG&f=1", "display_name": "dave", "link": "https://stackoverflow.com/users/9993995/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 1, "accepted_answer_id": 52062846, "answer_count": 3, "score": 9, "last_activity_date": 1535481244, "creation_date": 1535474417, "last_edit_date": 1535474536, "question_id": 52062706, "link": "https://stackoverflow.com/questions/52062706/arr-2-is-equivalent-to-arr-2-how", "title": "(arr + 2) is equivalent to *(arr + 2) . How?", "body": "<p>I am studying how to display elements of 2D array with the help of pointers. Here is the code I tried:</p>\n\n<pre><code>#include&lt;stdio.h&gt;  \n\nint main(){\n\n    int arr[3][2] = {  \n\n    {7, 8},\n    {6,3},\n    {3,4}\n    };\n\n    printf(\"%u\\n\", (arr + 2));\n    printf(\"%u\\n\", *(arr + 2)); \n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>6487616\n6487616\n</code></pre>\n\n<p>I am expecting output of <code>*(arr + 2)</code> to be <code>3</code>. How is it the same as <code>(arr + 2)</code>?</p>\n"}, {"tags": ["c", "system", "memory-address"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1535474408, "post_id": 52062646, "comment_id": 91075684, "body": "<code>byte</code> only holds the last value after the loop. So yes you should store it in an array. You also have to define it outside of the for loop if you want to use it after."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1535474446, "post_id": 52062646, "comment_id": 91075700, "body": "How are you populating <code>byte[]</code> in your second code snippet? Please include an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535474596, "post_id": 52062646, "comment_id": 91075772, "body": "regarding: <code>int x = 2271560481;</code>  This causes the compiler to output: <code>untitled.c:5:9: warning: overflow in implicit constant conversion [-Woverflow]</code>  so the result is not what your expecting."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535475011, "post_id": 52062646, "comment_id": 91075978, "body": "@user3629249 Why? <code>&amp;x</code> is casted to <code>unsigned char *</code>. Type cast has higher precedence than addition."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535475790, "post_id": 52062646, "comment_id": 91076427, "body": "Your right, my error.  I deleted the incorrect comment"}], "answers": [{"comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1535475222, "post_id": 52062724, "comment_id": 91076101, "body": "Should be <code>unsigned char *bytePtr = ...</code> no?"}, {"owner": {"reputation": 1, "user_id": 10285886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df16a61b1c9c0af16063cdc650b45d74?s=128&d=identicon&r=PG&f=1", "display_name": "Algorisum", "link": "https://stackoverflow.com/users/10285886/algorisum"}, "edited": false, "score": 0, "creation_date": 1535477129, "post_id": 52062724, "comment_id": 91077113, "body": "@pm100 You put &quot;i&quot; as type size_t should the printf be %zu instead of %d ?"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 2, "last_activity_date": 1535475235, "last_edit_date": 1535475235, "creation_date": 1535474466, "answer_id": 52062724, "question_id": 52062646, "link": "https://stackoverflow.com/questions/52062646/how-to-check-the-condition-of-individual-bytes-stored-in-an-address/52062724#52062724", "title": "How to check the condition of individual bytes stored in an address?", "body": "<p>Your code is loading one byte at a time into <code>byte</code> , its not a pointer so you cannot index off it. Do</p>\n\n<pre><code>unsigned char *bytePtr = ((unsigned char *)&amp;x);\n\nfor (size_t i = 0; i &lt; sizeof(x); ++i) {\nprintf(\"Byte %d = %u\\n\", i, bytePtr[i]);\n}\n</code></pre>\n\n<p>now you can do your test function using bytePtr</p>\n"}, {"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1535474736, "last_edit_date": 1535474736, "creation_date": 1535474526, "answer_id": 52062746, "question_id": 52062646, "link": "https://stackoverflow.com/questions/52062646/how-to-check-the-condition-of-individual-bytes-stored-in-an-address/52062746#52062746", "title": "How to check the condition of individual bytes stored in an address?", "body": "<p>Your <code>byte</code> will hold last value. If you want to store all the values you need array.\nConsider below example. </p>\n\n<pre><code>  #include &lt;stdio.h&gt;\n\n    int main(){\n\n    int x = 2271560481; // 0x87654321\n    size_t i =0;\n    unsigned char byte[sizeof x];\n    for (i = 0; i &lt; sizeof(x); ++i) {\n\n        byte[i] = *((unsigned char *)&amp;x + i);\n\n        printf(\"Byte %d = %u\\n\", i, (unsigned)byte[i]);\n      }\n\n      if (byte[0] == 33 &amp;&amp; byte[1] == 67 &amp;&amp; byte[2] == 101 &amp;&amp; byte[3] == 135) \n      {\n        return 1;\n      }\n      return 0;\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10285886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df16a61b1c9c0af16063cdc650b45d74?s=128&d=identicon&r=PG&f=1", "display_name": "Algorisum", "link": "https://stackoverflow.com/users/10285886/algorisum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 52062724, "answer_count": 2, "score": 0, "last_activity_date": 1535573289, "creation_date": 1535474198, "last_edit_date": 1535573289, "question_id": 52062646, "link": "https://stackoverflow.com/questions/52062646/how-to-check-the-condition-of-individual-bytes-stored-in-an-address", "title": "How to check the condition of individual bytes stored in an address?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\nint x = 2271560481; // 0x87654321\n\nfor (size_t i = 0; i &lt; sizeof(x); ++i) {\n\nunsigned char byte = *((unsigned char *)&amp;x + i);\n\n\nprintf(\"Byte %d = %u\\n\", i, (unsigned)byte);\n}\n\n\nreturn 0; \n</code></pre>\n\n<p>}</p>\n\n<p>For example I have this code right here displaying an output of :</p>\n\n<pre><code>Byte 0 = 33\nByte 1 = 67\nByte 2 = 101\nByte 3 = 135\n</code></pre>\n\n<p>How do I check the condition to see if the value is stored in the address?</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1535473255, "post_id": 52062338, "comment_id": 91075090, "body": "<code>printf</code> doesn&#39;t change the result at all. You could calculate it in any other context and you&#39;d get the same result."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535474305, "post_id": 52062338, "comment_id": 91075637, "body": "regarding: <code>float a=5.0;</code>  the literal <code>5.0</code> is a <code>double</code>, but the code is trying to place that double into a float.  Suggest: <code>float a=5.0f;</code>  (Note the trailing <code>f</code> in the literal)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1535474401, "post_id": 52062338, "comment_id": 91075681, "body": "integer division drops any fraction.   It seems your expecting the fraction to be kept"}], "answers": [{"tags": [], "owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "is_accepted": false, "score": 10, "last_activity_date": 1535473414, "last_edit_date": 1535473414, "creation_date": 1535473238, "answer_id": 52062380, "question_id": 52062338, "link": "https://stackoverflow.com/questions/52062338/under-printf-arithmetic-operation-precedence/52062380#52062380", "title": "Under Printf arithmetic operation precedence", "body": "<p><code>7/5</code> is 1. That's integer division. Everything after that should be clear.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1535476010, "post_id": 52062538, "comment_id": 91076545, "body": "Detail: &quot;change to 7.0/5.0 &quot; will provide a <code>double</code> result, not float - yet the approach is sound."}], "tags": [], "owner": {"reputation": 1041, "user_id": 781515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EaC6A.jpg?s=128&g=1", "display_name": "Ron Davis", "link": "https://stackoverflow.com/users/781515/ron-davis"}, "is_accepted": false, "score": 0, "last_activity_date": 1535473789, "creation_date": 1535473789, "answer_id": 52062538, "question_id": 52062338, "link": "https://stackoverflow.com/questions/52062338/under-printf-arithmetic-operation-precedence/52062538#52062538", "title": "Under Printf arithmetic operation precedence", "body": "<p>Your 7/5 gives an integer result, in this case 1. If you want to get 1.4 you need to change to 7.0/5.0 to get a float result, which will change the result.</p>\n"}], "owner": {"reputation": 37, "user_id": 10285841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iqxkcoc9C3o/AAAAAAAAAAI/AAAAAAAAnT4/tbiBV_l_Vas/photo.jpg?sz=128", "display_name": "Anil Choudhary", "link": "https://stackoverflow.com/users/10285841/anil-choudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1535480098, "creation_date": 1535473099, "last_edit_date": 1535480098, "question_id": 52062338, "link": "https://stackoverflow.com/questions/52062338/under-printf-arithmetic-operation-precedence", "title": "Under Printf arithmetic operation precedence", "body": "<pre><code>#include&lt;stdio.h&gt; \nint main() \n{\n    float a=5.0;\n    printf(\"The Output is %.2f\",(7/5)*a+12);\n } \n</code></pre>\n\n<p>I thought the output is 19.00 but the output is 17.00. How this is possible?. Please guide me how the output is 17.00 came....</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1535472658, "post_id": 52062190, "comment_id": 91074768, "body": "Welcome to Stack Overflow. What part do you need help with? What are the errors and warnings you get?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1535473121, "post_id": 52062190, "comment_id": 91075016, "body": "You can&#39;t use the address of a local variable outside of its scope."}], "answers": [{"comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1535473597, "post_id": 52062420, "comment_id": 91075254, "body": "<code>array[0][0]=b;</code> The pointer was never initialized, so i think this leads to undefined behavior."}, {"owner": {"reputation": 458, "user_id": 8420233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5JX6a.png?s=128&g=1", "display_name": "absoluteAquarian", "link": "https://stackoverflow.com/users/8420233/absoluteaquarian"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1535473683, "post_id": 52062420, "comment_id": 91075297, "body": "true, though i did use <code>*char[]</code> for 2d char arrays often, hence my reasoning"}], "tags": [], "owner": {"reputation": 458, "user_id": 8420233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5JX6a.png?s=128&g=1", "display_name": "absoluteAquarian", "link": "https://stackoverflow.com/users/8420233/absoluteaquarian"}, "is_accepted": false, "score": 1, "last_activity_date": 1535473386, "creation_date": 1535473386, "answer_id": 52062420, "question_id": 52062190, "link": "https://stackoverflow.com/questions/52062190/pass-by-reference-an-array-of-pointers-in-c/52062420#52062420", "title": "Pass by reference an array of pointers in c", "body": "<p>Arrays in <strong>C</strong> are broken down into a pointer to the first element when used as a parameter.</p>\n\n<p>Just pass the array itself.  There's no need for a pointer to it.</p>\n\n<p>Also, like <strong>Osiris</strong> said, you can't use the address of a local variable outside its scope.</p>\n\n<pre><code>void func (char *array[], char b){  /* Changed &amp;b to b */\n    array[0][0]=b; /* Changed array[0] to array[0][0], assuming that array is a 2D array */\n}\nint main () {\n    char *array_in_main[SIZE];\n    char b_in_main='b';\n    func (array_in_main, b_in_main); /* Changed *array_in_main to array_in_main */\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 10285727, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E3-lwi7DaZ8/AAAAAAAAAAI/AAAAAAAAANo/NdH2RAs5mK8/photo.jpg?sz=128", "display_name": "ilacollie", "link": "https://stackoverflow.com/users/10285727/ilacollie"}, "edited": false, "score": 0, "creation_date": 1535639183, "post_id": 52062441, "comment_id": 91149442, "body": "ok but in this way is array_in_main still modified when func() ends in the main? I don&#39;t understand if pass array in function is like pass a simple variable or not."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 47, "user_id": 10285727, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E3-lwi7DaZ8/AAAAAAAAAAI/AAAAAAAAANo/NdH2RAs5mK8/photo.jpg?sz=128", "display_name": "ilacollie", "link": "https://stackoverflow.com/users/10285727/ilacollie"}, "edited": false, "score": 0, "creation_date": 1535909282, "post_id": 52062441, "comment_id": 91228483, "body": "@ilacollie Yes it is still modified."}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 5, "last_activity_date": 1535473460, "creation_date": 1535473460, "answer_id": 52062441, "question_id": 52062190, "link": "https://stackoverflow.com/questions/52062190/pass-by-reference-an-array-of-pointers-in-c/52062441#52062441", "title": "Pass by reference an array of pointers in c", "body": "<p>You have a view problems here.</p>\n\n<p>First you passing the wrong type to your function. If you want to modify an array in a function you do not have to pass it with a pointer to the array since the array decays to a pointer to its first element.</p>\n\n<p>Second you attempt to use the address of <code>b</code> which is a local variable and its scope ends with the function <code>func</code>, you can not use it outside.</p>\n\n<p>This code will work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define SIZE 10\n\nvoid func (char *array[], char *b)\n{\n    array[0]=b;\n}\n\nint main () \n{\n    char *array_in_main[SIZE];\n    char b_in_main='b';\n    func (array_in_main, &amp;b_in_main);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "is_accepted": false, "score": 0, "last_activity_date": 1535473786, "creation_date": 1535473786, "answer_id": 52062535, "question_id": 52062190, "link": "https://stackoverflow.com/questions/52062190/pass-by-reference-an-array-of-pointers-in-c/52062535#52062535", "title": "Pass by reference an array of pointers in c", "body": "<p>This is probably closer to what you're trying to do, no?</p>\n\n<p>In addition to the compilation issues (already explained in <a href=\"https://stackoverflow.com/a/52062420/4288486\">Tau's answer</a> and in <a href=\"https://stackoverflow.com/a/52062441/4288486\">Osiris' answer</a>), it's worth noting that arrays are already pointers themselves.</p>\n\n<p>Just declare in main <code>char array_in_main[SIZE]</code>. Afterwards you can just specify <code>char array[]</code> as the argument and pass <code>array_in_main</code> directly. What is passed to the function is the address of the first position in the array <code>&amp;(array_in_main[0])</code>, so the array can be effectively updated from the function.</p>\n\n<p>The code:</p>\n\n<pre><code>#define SIZE 10\n\nvoid func(char array[], char b) {\n  array[0] = b;\n}\n\nint main () {\n  char array_in_main[SIZE];\n  char b_in_main='x';\n  func(array_in_main, b_in_main);\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "is_accepted": false, "score": 0, "last_activity_date": 1535477802, "last_edit_date": 1535477802, "creation_date": 1535477357, "answer_id": 52063444, "question_id": 52062190, "link": "https://stackoverflow.com/questions/52062190/pass-by-reference-an-array-of-pointers-in-c/52063444#52063444", "title": "Pass by reference an array of pointers in c", "body": "<p>You need to understand the mechanism of how an <code>array</code> is passed to a function in C programming language. When you pass an array to a function in C, pointer (address) to first element of the array is passed to the function and since you have a reference to it, you can modify the content of the array in the function (but you can't change the memory location to which array is pointing). I recommend to have a look at this <a href=\"https://stackoverflow.com/questions/19646512/passing-an-array-by-reference-in-c\">question</a>.</p>\n\n<p>The program below has two functions. <code>rightFunc</code> function is a simple and correct approach to achieve what you have been trying to do. However, I have provided <code>func</code> which shows the way of passing pointer (or reference) to an array of pointers.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define SIZE 100\n\nvoid rightFunc(char *array[], char *b)\n{\n    array[0] = b;\n}\n\nvoid func(char *(*array)[], char *b)\n{\n    (*array)[0] = b;\n}\n\nint main(int argc, char *argv[]) \n{\n    char *array_in_main[SIZE];\n    char b_in_main = 'b';\n\n    func(&amp;array_in_main, &amp;b_in_main);\n    printf(\"Character is %c\\r\\n\", *array_in_main[0]);\n\n    b_in_main = 'c';\n    rightFunc(array_in_main, &amp;b_in_main);\n    printf(\"Character is %c\\r\\n\", *array_in_main[0]);\n    return 0;\n}\n</code></pre>\n\n<p>I would like to point out one error in your program. You can get address of local variable (<code>automatic storage class</code>) but that address will not be valid outside the function (when function has exited). To rectify the issue in your program, I have modified the functions to take <code>pointer to char</code> in your program.</p>\n"}], "owner": {"reputation": 47, "user_id": 10285727, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E3-lwi7DaZ8/AAAAAAAAAAI/AAAAAAAAANo/NdH2RAs5mK8/photo.jpg?sz=128", "display_name": "ilacollie", "link": "https://stackoverflow.com/users/10285727/ilacollie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1535477802, "creation_date": 1535472574, "question_id": 52062190, "link": "https://stackoverflow.com/questions/52062190/pass-by-reference-an-array-of-pointers-in-c", "title": "Pass by reference an array of pointers in c", "body": "<p>I think to pass my array in a wrong way by reference cause I have lot of warning for its. Could you help me?</p>\n\n<pre><code>void func (char **array[], char b){\n*array[0]=&amp;b;\n}\n\nint main () {\n\nchar *array_in_main[SIZE];\nchar b_in_main='b';\nfunc (*array_in_main, b_in_main);\nreturn 0;\n\n}\n</code></pre>\n\n<p>Yes, I know. It's a no-sense example but my doubt is on syntax. Check it please!</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 111, "user_id": 10285850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327a796b855684479e7eb32e953f8c60?s=128&d=identicon&r=PG&f=1", "display_name": "CrossRoads", "link": "https://stackoverflow.com/users/10285850/crossroads"}, "edited": false, "score": 0, "creation_date": 1535472894, "post_id": 52062185, "comment_id": 91074895, "body": "Using which language? C++, I don&#39;t think so, unless you call a function and hide the looping in the function."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 111, "user_id": 10285850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327a796b855684479e7eb32e953f8c60?s=128&d=identicon&r=PG&f=1", "display_name": "CrossRoads", "link": "https://stackoverflow.com/users/10285850/crossroads"}, "edited": false, "score": 1, "creation_date": 1535473650, "post_id": 52062185, "comment_id": 91075279, "body": "@CrossRoads I would assume C since OP tagged his question as such and used <code>printf</code> in their example code"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535478518, "post_id": 52062185, "comment_id": 91077724, "body": "Note: <code>printf(&quot;%s&quot;,array);</code> does not print a whole char array.  Output stops once a <i>null character</i> is encountered."}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1535473088, "creation_date": 1535473088, "answer_id": 52062334, "question_id": 52062185, "link": "https://stackoverflow.com/questions/52062185/is-there-a-quick-way-to-print-a-whole-int-array/52062334#52062334", "title": "Is there a &quot;quick way&quot; to print a whole int array?", "body": "<p>Not out of the box in standard C.</p>\n\n<p>When you pass an array of any type as an argument to a function like <code>printf</code> then it decays to a pointer to its first element, losing information about its length.</p>\n\n<p>Strings stored as <code>char</code> arrays are special in C, since they are null-terminated. Library functions can take pointers to <code>char</code> arrays as parameters and increment the pointer to the null-terminator to determine its length.</p>\n\n<p>If you want to create an extension of <code>printf</code> that has a new format specifier for arrays of type <code>int</code>, you will need to pass length information to it as well. It's simpler to just have a helper function that also takes the length print out the entire array using a <code>for</code> loop, and use that to hide the looping in the calling code.</p>\n"}], "owner": {"reputation": 425, "user_id": 10161504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43494ce2c398140ce5415200a3a36b6e?s=128&d=identicon&r=PG&f=1", "display_name": "wattbatt", "link": "https://stackoverflow.com/users/10161504/wattbatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 52062334, "answer_count": 1, "score": 0, "last_activity_date": 1535473088, "creation_date": 1535472545, "question_id": 52062185, "link": "https://stackoverflow.com/questions/52062185/is-there-a-quick-way-to-print-a-whole-int-array", "title": "Is there a &quot;quick way&quot; to print a whole int array?", "body": "<p>I wonder, just like there is</p>\n\n<p><code>printf(\"%s\",array);</code></p>\n\n<p>to print a whole char array, is there a way to print a whole int array with one command instead of a for cycle printing it one by one?</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 2331, "user_id": 2333010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7134e36891735da054e22fbe01e903c2?s=128&d=identicon&r=PG", "display_name": "Ricardo Costeira", "link": "https://stackoverflow.com/users/2333010/ricardo-costeira"}, "edited": false, "score": 2, "creation_date": 1535471094, "post_id": 52061636, "comment_id": 91073817, "body": "<code>minSum</code> is uninitialized. When you try to compare it to <code>sum</code>, you&#39;ll get undefined behaviour. Initialize it with a high value, eg. INT_MAX."}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 2331, "user_id": 2333010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7134e36891735da054e22fbe01e903c2?s=128&d=identicon&r=PG", "display_name": "Ricardo Costeira", "link": "https://stackoverflow.com/users/2333010/ricardo-costeira"}, "edited": false, "score": 1, "creation_date": 1535471807, "post_id": 52061636, "comment_id": 91074292, "body": "to elaborate on the comment from @rcosteira , in C an uninitialized variable takes on the value that just happens to be in the spot in memory that gets reserved for storing that variable; that&#39;s why the behavior with uninitialized values is undefined;  in C, it&#39;s crucial to initialize variables before relying on their value in your logic;  you will often see, e.g.,  <code>int qtySocks = 0;</code>    ... for a <code>min</code> value, start with a very large initial value so that your inputs are sure to be less than that;  HTH"}], "answers": [{"tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": false, "score": 4, "last_activity_date": 1535472266, "last_edit_date": 1535472266, "creation_date": 1535471491, "answer_id": 52061879, "question_id": 52061636, "link": "https://stackoverflow.com/questions/52061636/why-this-function-is-not-showing-the-correct-result-as-output/52061879#52061879", "title": "Why this function is not showing the correct result as output?", "body": "<p>Look carefully at <code>minSum</code>.  You don't explicitly initialize it before using it in this test:</p>\n\n<pre><code>if (sum &lt; minSum)\n</code></pre>\n\n<p>Therefore, if you're running a debug build and it gets initialized to zero, it'll never change unless sum is &lt; 0.</p>\n\n<p>Note that referencing an uninitialized value is undefined behavior, something that should be avoided at all costs.</p>\n\n<ol>\n<li><p>Try this entering all numbers as negative.</p></li>\n<li><p>Try setting it to INT_MAX and try again.  Note that this is the correct solution to the problem.</p></li>\n</ol>\n\n<p>As another editorial remark, it's probably not a good idea to modify the dimensions of the array.  As declared in <code>main()</code> <code>m</code> is 50 by 50.  But you're effectively viewing it as 3 by 3 in <code>findRowWithMinimalSum()</code>.  That's not a good habit to get into, I can pretty much guarantee that doing so will cause problems for you at some point in the future.</p>\n\n<p>Finally get yourself a debugger.  This would have jumped right off the screen at you if you'd single stepped through <code>findRowWithMinimalSum()</code> watching how the variables change as the program progresses.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 10285514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UKzxG.jpg?s=128&g=1", "display_name": "ELOUASSIF Abdellah", "link": "https://stackoverflow.com/users/10285514/elouassif-abdellah"}, "is_accepted": true, "score": 0, "last_activity_date": 1535471877, "creation_date": 1535471877, "answer_id": 52061980, "question_id": 52061636, "link": "https://stackoverflow.com/questions/52061636/why-this-function-is-not-showing-the-correct-result-as-output/52061980#52061980", "title": "Why this function is not showing the correct result as output?", "body": "<p>this will work </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid findRowWithMinimalSum(int row, int col, int A[row][col]){\n    int i,j,sum,minSum,position;\n\n  for(i=0; i&lt;row; i++){\n    printf(\"\\nGive the elements of row %d:\\n\", i+1);\n    for(j=0; j&lt;col; j++)\n        scanf(\"%d\", &amp;A[i][j]);\n  }\n\n  for(i=0; i&lt;row; i++){\n    for(j=0; j&lt;col; j++)\n        printf(\"%d\", A[i][j]);\n    printf(\"\\n\");\n  }\n\n   for(i=0; i&lt;row; i++){\n    sum=0;\n    for(j=0; j&lt;col; j++){\n        sum = sum + A[i][j];\n    }\n\n\n    if(i==0){\n        minSum = sum;\n        position = i;\n    }\n    else if(sum&lt;minSum){\n        minSum = sum;\n        position = i;\n    }\n   }\n   printf(\"\\nThe row with minimal sum is %d whose sum is %d\", position+1, minSum);\n  }\n\nint main(){\n int row, column, m[50][50];\n\n //function call\n findRowWithMinimalSum(3,3,m);\n  return 0;\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1909, "user_id": 2225619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/286a6578091bb7b170a254eb8b5c100d?s=128&d=identicon&r=PG", "display_name": "Capricorn", "link": "https://stackoverflow.com/users/2225619/capricorn"}, "edited": false, "score": 0, "creation_date": 1535477022, "post_id": 52062843, "comment_id": 91077057, "body": "Thank you for this code snippet, which might provide some limited, immediate help. A <a href=\"https://meta.stackexchange.com/q/114762/349538\">proper explanation</a> would greatly improve its long-term value by showing why this is a good solution to the problem and would make it more useful to future readers with other, similar questions. Please <a href=\"https://stackoverflow.com/posts/52062843/edit\">edit</a> your answer to add some explanation, including the assumptions you\u2019ve made."}], "tags": [], "owner": {"reputation": 1, "user_id": 8176157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246ccccb416cb843293171efdd85db13?s=128&d=identicon&r=PG&f=1", "display_name": "Thetchina Moorthy", "link": "https://stackoverflow.com/users/8176157/thetchina-moorthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1535474901, "creation_date": 1535474901, "answer_id": 52062843, "question_id": 52061636, "link": "https://stackoverflow.com/questions/52061636/why-this-function-is-not-showing-the-correct-result-as-output/52062843#52062843", "title": "Why this function is not showing the correct result as output?", "body": "<pre><code>void findRowWithMinimalSum(int row, int col, int A[50][50])\n{\n  int i,j,sum=0,minSum=0,position,f=0;\n\n for(i=0; i&lt;row; i++){\n printf(\"\\nGive the elements of row %d:\\n\", i+1);\n    for(j=0; j&lt;col; j++)\nscanf(\"%d\", &amp;A[i][j]);\n  }\n\n  for(i=0; i&lt;row; i++){\n  for(j=0; j&lt;col; j++)\nprintf(\"%d \", A[i][j]);\n  printf(\"\\n\");\n }\n\n  for(i=0; i&lt;row; i++){\n  sum=0;\n for(j=0; j&lt;col; j++){\nsum = sum + A[i][j];\n    }\n    if(f==0)\n    {\n    minSum=sum;\n f++;\n  }\n if(sum&lt;minSum){\nminSum = sum;\nposition = i;\n    }\n }\n printf(\"\\nThe row with minimal sum is %d whose sum is %d\", position+1, minSum);\n }\n\nint main(){\n int row, column, m[50][50];\n\n//function call\nindRowWithMinimalSum(3,3,m);\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10092719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7083b4ef07ea9c3bb3a569efba680c02?s=128&d=identicon&r=PG&f=1", "display_name": "Arsel Doe", "link": "https://stackoverflow.com/users/10092719/arsel-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 52061980, "answer_count": 3, "score": 0, "last_activity_date": 1535474901, "creation_date": 1535470559, "question_id": 52061636, "link": "https://stackoverflow.com/questions/52061636/why-this-function-is-not-showing-the-correct-result-as-output", "title": "Why this function is not showing the correct result as output?", "body": "<p>The output of this function everytime is:</p>\n\n<blockquote>\n  <p>The row with minimal sum is 1 whose sum is 0.</p>\n</blockquote>\n\n<p>But I want it to calculate the sum of each row and then display the min row with its sum.\nIt displays the correct result if I use this code as a program, and not inside the function(as in this case).</p>\n\n<pre><code>void findRowWithMinimalSum(int row, int col, int A[row][col]){\n    int i,j,sum,minSum,position;\n\n  for(i=0; i&lt;row; i++){\n    printf(\"\\nGive the elements of row %d:\\n\", i+1);\n    for(j=0; j&lt;col; j++)\n        scanf(\"%d\", &amp;A[i][j]);\n  }\n\n  for(i=0; i&lt;row; i++){\n    for(j=0; j&lt;col; j++)\n        printf(\"%d\", A[i][j]);\n    printf(\"\\n\");\n  }\n\n   for(i=0; i&lt;row; i++){\n    sum=0;\n    for(j=0; j&lt;col; j++){\n        sum = sum + A[i][j];\n    }\n    if(sum&lt;minSum){\n        minSum = sum;\n        position = i;\n    }\n   }\n   printf(\"\\nThe row with minimal sum is %d whose sum is %d\", position+1, minSum);\n  }\n\nint main(){\n int row, column, m[50][50];\n\n //function call\n findRowWithMinimalSum(3,3,m);\n  return 0;\n }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1535469907, "post_id": 52061424, "comment_id": 91073051, "body": "<code>hasht.hashnode</code> isn&#39;t initialized."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535472463, "post_id": 52061424, "comment_id": 91074653, "body": "please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  so we can reproduce the problem."}, {"owner": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535472620, "post_id": 52061424, "comment_id": 91074741, "body": "@user3629249 I have copied the full code for the follow up questions. Thanks for your advice."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535472929, "post_id": 52061424, "comment_id": 91074918, "body": "when compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu17</code> )  Note: other compilers use different option to obtain the same thing"}, {"owner": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "edited": false, "score": 0, "creation_date": 1535473101, "post_id": 52061424, "comment_id": 91075006, "body": "I have the below error and i have no idea how to fix it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535473148, "post_id": 52061424, "comment_id": 91075029, "body": "when calling any of the heap allocation functions: <code>malloc</code> <code>calloc</code> <code>realloc</code>, always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "edited": false, "score": 0, "creation_date": 1535473275, "post_id": 52061424, "comment_id": 91075100, "body": "Same errors even i have put a check !=NULL on the malloc function. Seems the malloc has conducted successfully. But the issue i have is on the hasht.hashnode[key] = &amp;node which i dunno how to fix"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1535473738, "post_id": 52061424, "comment_id": 91075324, "body": "note this field definition: <code>struct Node** hashnode;</code>  which is being set as a pointer to an array of <code>struct node</code>  by the call to <code>malloc()</code>.  Suggest modifying to: <code>struct Node* hashnode;</code>  ( note only a single <code>*</code> )"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "edited": false, "score": 0, "creation_date": 1535472065, "post_id": 52061460, "comment_id": 91074452, "body": "may i have the follow up questions on above? thanks a lot !!"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 2, "last_activity_date": 1535469976, "creation_date": 1535469976, "answer_id": 52061460, "question_id": 52061424, "link": "https://stackoverflow.com/questions/52061424/memory-cannot-be-printed-note-pointer-points-here/52061460#52061460", "title": "&lt;memory cannot be printed&gt; note: pointer points here", "body": "<p>you're forgetting to initialize the table of pointers:</p>\n\n<pre><code>hasht.size = 10;\n// you need to allocate the array of pointers\nhasht.hashnode = malloc(sizeof(*hasht.hashnode)*hasht.size);\n// now proceed with your loop\nfor (int i = 0; i &lt; hasht.size; i++)\n{\n</code></pre>\n\n<p>so when trying to initialize your pointers, you write in <s>the woods</s> an undefined location: undefined behaviour.</p>\n"}], "owner": {"reputation": 91, "user_id": 9003793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef15c34d254337904beb14e28c3b8c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin Pang", "link": "https://stackoverflow.com/users/9003793/elvin-pang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 52061460, "answer_count": 1, "score": 0, "last_activity_date": 1535472584, "creation_date": 1535469832, "last_edit_date": 1535472584, "question_id": 52061424, "link": "https://stackoverflow.com/questions/52061424/memory-cannot-be-printed-note-pointer-points-here", "title": "&lt;memory cannot be printed&gt; note: pointer points here", "body": "<p>I am a beginner in c.</p>\n\n<p>I am trying to create a simple hashtable with the below code. However, error of below occurs. Anyone can explain why to me?</p>\n\n<p>runtime error: store to misaligned address 0x0000ffffffff for type 'struct Node *', which requires 8 byte alignment\n0x0000ffffffff: note: pointer points here\n\nSegmentation fault</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Hashnode\n{\n    int size;\n    struct Node** hashnode;\n}Hashtable;\n\n\ntypedef struct Node\n{\n    char* word;\n    struct Node* next;\n}Node;\n\nint main(void)\n{\n    Node* node = malloc(sizeof(Node));\n    node-&gt;word = \"Elvin\";\n    node-&gt;next = NULL;\n    printf(\"First Node created successfully!...\\n\");\n\n    Hashtable hasht;\n\n    hasht.size = 10;\n    for (int i = 0; i &lt; hasht.size; i++)\n    {\n        hasht.hashnode[i] = NULL;\n        printf(\"the address of the %i hasnode is: %p\\n\", i, hasht.hashnode[i]);\n    }\n    printf(\"The hashtable is created successfully!...\\n\");\n</code></pre>\n\n<p>Follow up questions</p>\n\n<p>After correcting above code, i would like to link the hashnode with the node. As hashnode is the Node** (a pointer to pointer of node), hence the value of hasnode should be the address of node pointer (i.e. &amp;node). my code is below.</p>\n\n<p>However, it shows an error to me that incompatible pointer types assigning to 'struct Node *' from 'Node **' (aka 'struct Node **'); remove &amp;.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Hashnode\n{\n    int size;\n    struct Node** hashnode;\n}Hashtable;\n\n\ntypedef struct Node\n{\n    char* word;\n    struct Node* next;\n}Node;\n\nint main(void)\n{\n    Node* node = malloc(sizeof(Node));\n    node-&gt;word = \"Elvin\";\n    node-&gt;next = NULL;\n    printf(\"First Node created successfully!...\\n\");\n\n    Hashtable hasht;\n\n    hasht.size = 10;\n    hasht.hashnode = malloc(sizeof(*hasht.hashnode)*hasht.size);\n    for (int i = 0; i &lt; hasht.size; i++)\n    {\n        hasht.hashnode[i] = NULL;\n        printf(\"the address of the %i hashnode is: %p\\n\", i, hasht.hashnode[i]);\n    }\n    printf(\"The hashtable is created successfully!...\\n\");\n\n    int key = 3;\n    hasht.hashnode[key] = &amp;node;\n}\n</code></pre>\n\n<p>any idea what i did wrong?</p>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1535467343, "post_id": 52060526, "comment_id": 91071351, "body": "You need to pass a function pointer in to your function call as an argument.  instead, you are attempting to call a function and pass the results in as an argument."}, {"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 0, "creation_date": 1535467659, "post_id": 52060526, "comment_id": 91071585, "body": "probably because your function <code>add</code> returns <code>void</code> instead of <code>void*</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535468120, "post_id": 52060526, "comment_id": 91071877, "body": "Your question title must be in english, not in french"}, {"owner": {"reputation": 35, "user_id": 10279759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxy7c.jpg?s=128&g=1", "display_name": "E.Ayman", "link": "https://stackoverflow.com/users/10279759/e-ayman"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535469596, "post_id": 52060526, "comment_id": 91072824, "body": "ok @Jabberwocky, yes chrisitian , i was doing it wrong, thanks you all."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1535470187, "post_id": 52060526, "comment_id": 91073241, "body": "@E.Ayman nothing prevents you from <a href=\"https://stackoverflow.com/posts/52060526/edit\">edit</a>ing your question"}], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 3, "last_activity_date": 1535468737, "last_edit_date": 1535468737, "creation_date": 1535467705, "answer_id": 52060697, "question_id": 52060526, "link": "https://stackoverflow.com/questions/52060526/error-compilation-function-pointer/52060697#52060697", "title": "error compilation, function pointer", "body": "<p>I'm not completely certain as to what you are trying to do with your function, but I took a stab at what I think you might be attempting to do:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid add(int *nb)\n{\n    *nb += 1;\n}\n\nint f(int nb, void (*function)(int *))\n{\n    function(&amp;nb);\n    if (nb &lt; 5)\n        f(nb, function);\n    return (nb);\n}\n\nint main() {\n    int b = 5;\n    int a = f(b, add);\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n\n<p>Now your function <code>f</code> accepts a function-pointer to a void function that takes an <code>int *</code> as an argument (I renamed this argument to <code>function</code> so it doesn't conflict with your existing function <code>add</code>).  It proceeds to call said function and pass in a pointer to <code>nb</code> to <code>function</code>.</p>\n\n<p>What you were doing was passing in the result of <code>add(&amp;nb)</code> into the function <code>f</code> as an argument (which said function is a void so it does not return anything) instead of passing in a pointer to the function.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1535467734, "creation_date": 1535467734, "answer_id": 52060709, "question_id": 52060526, "link": "https://stackoverflow.com/questions/52060526/error-compilation-function-pointer/52060709#52060709", "title": "error compilation, function pointer", "body": "<p>Passing <code>add(&amp;nb)</code> as an argument passes the <em>returned value</em> of <code>add</code> with the argument <code>&amp;nb</code>. The function signature for <code>f</code> requires a function pointer, which can be passed as:</p>\n\n<pre><code>f(nb, add)\n</code></pre>\n\n<p>Also, even if you were actually trying to pass the returned value of <code>add</code>, that would be undefined behavior since it is of type <code>void</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1535467810, "creation_date": 1535467810, "answer_id": 52060734, "question_id": 52060526, "link": "https://stackoverflow.com/questions/52060526/error-compilation-function-pointer/52060734#52060734", "title": "error compilation, function pointer", "body": "<p>The line <code>f(nb, add(&amp;nb));</code> doesn't make sense. You need to call the function somewhere, but not on the same line as where you pass the function pointer on, recursively.</p>\n\n<p>Overall the program doesn't make much sense. I have no idea what you are trying to do, perhaps something similar to this?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid add(int *nb)\n{\n    *nb += 1;\n}\n\nvoid f(int* nb, void (*add)(int *))\n{\n    add(nb);\n\n    if (*nb &lt; 5)\n    {\n        f(nb, add);\n    }\n}\n\nint main() {\n    int a = 5;\n    f(&amp;a, add);\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n\n<p>Will print 6 since the <code>add</code> is called once. The name <code>add</code> as function parameter to <code>f</code> is also mighty confusing, so better come up with another name for it.</p>\n"}, {"tags": [], "owner": {"reputation": 5167, "user_id": 4862613, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1583232551699623/picture?type=large", "display_name": "Maldus", "link": "https://stackoverflow.com/users/4862613/maldus"}, "is_accepted": false, "score": 0, "last_activity_date": 1535468049, "creation_date": 1535468049, "answer_id": 52060823, "question_id": 52060526, "link": "https://stackoverflow.com/questions/52060526/error-compilation-function-pointer/52060823#52060823", "title": "error compilation, function pointer", "body": "<p>As Christian pointed out in the comments, the problem is on the recursive call line:</p>\n\n<pre><code> f(nb, add(&amp;nb));\n</code></pre>\n\n<p>If I understand correctly you are trying to increase <code>nb</code> using the function you receive as a pointer; here however you first pass <code>nb</code> unchanged (and as a value, not by reference), and then call the add function.</p>\n\n<p>In the second argument the compiler is expecting a function pointer, but instead it receives the return value of the <code>add(&amp;nb)</code> function call, which is <code>void</code>.</p>\n\n<p>Also, in case nb is &lt; 5 you need to return the recursive call.</p>\n\n<p>The correct procedure would be:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid add(int *nb)\n{\n    *nb += 1;\n}\n\nint f(int nb, void (*add)(int *))\n{\n    if (nb &lt; 5) {\n        add(&amp;nb);\n        return f(nb, add);\n    }\n    return (nb);\n}\n\nint main() {\n    int b = 1;\n    int a = f(b, add);\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n\n<p>It almost seems like you're trying to use lazy evaluation, but C doesn't have that!</p>\n"}], "owner": {"reputation": 35, "user_id": 10279759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxy7c.jpg?s=128&g=1", "display_name": "E.Ayman", "link": "https://stackoverflow.com/users/10279759/e-ayman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52060734, "answer_count": 4, "score": 0, "last_activity_date": 1535475743, "creation_date": 1535467217, "last_edit_date": 1535475743, "question_id": 52060526, "link": "https://stackoverflow.com/questions/52060526/error-compilation-function-pointer", "title": "error compilation, function pointer", "body": "<p>i have a simple program like this : </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid add(int *nb)\n{\n    *nb += 1;\n}\n\nint f(int nb, void (*add)(int *))\n{\n    if (nb &lt; 5)\n        f(nb, add(&amp;nb));\n    return (nb);\n}\n\nint main() {\n    int b = 5;\n    int a = f(b, add);\n    printf(\"%d\\n\", a);\n}\n</code></pre>\n\n<p>i want to call f recursively until nb become greater or equal to 5, but when i compile the program , the gcc compiler show something like this :</p>\n\n<pre><code>error: passing 'void' to parameter of incompatible type 'void (*)(int *)'\n</code></pre>\n\n<p>can anyone help me please?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 7, "creation_date": 1535464421, "post_id": 52059554, "comment_id": 91069415, "body": "Ternary operator only has one type. In your example <code>short int</code> is promoted to <code>float</code>."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 2, "creation_date": 1535464532, "post_id": 52059554, "comment_id": 91069490, "body": "<code>sizeof</code> isn&#39;t a function so it can&#39;t evaluate a runtime value like <code>x == 2</code>"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 2, "creation_date": 1535464684, "post_id": 52059554, "comment_id": 91069606, "body": "@cleblanc The ternary operator has a defined type at compile time. <code>sizeof</code> is not evaluated (except for VLAs)."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1535464753, "post_id": 52059554, "comment_id": 91069660, "body": "@Osiris sure it does and that&#39;s why it compiles, I&#39;m just pointing out that it won&#39;t do what she seems to want which is evaluate <code>x == 2</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 2, "last_activity_date": 1535465198, "creation_date": 1535465198, "answer_id": 52059863, "question_id": 52059554, "link": "https://stackoverflow.com/questions/52059554/i-dont-understand-how-the-size-is-equal-to-float-and-not-short-int-as-the-size/52059863#52059863", "title": "I don&#39;t understand how the size is equal to float and not short int as the size of i is short int", "body": "<p>The type of a conditional expression is always defined at compile time. \nThe expression <code>(x == 2) ? f : i</code> is of type <code>float</code> since <code>i</code> is promoted.</p>\n\n<p><code>sizeof</code> is not evaluated (except for VLAs), so it is not even checked if <code>x == 2</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10285101, "user_type": "registered", "profile_image": "https://graph.facebook.com/2470607193165641/picture?type=large", "display_name": "Harshu Panwar", "link": "https://stackoverflow.com/users/10285101/harshu-panwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1535465944, "answer_count": 1, "score": -1, "last_activity_date": 1535466121, "creation_date": 1535464313, "last_edit_date": 1535466121, "question_id": 52059554, "link": "https://stackoverflow.com/questions/52059554/i-dont-understand-how-the-size-is-equal-to-float-and-not-short-int-as-the-size", "closed_reason": "Duplicate", "title": "I don&#39;t understand how the size is equal to float and not short int as the size of i is short int", "body": "<p>I don't understand how the size is equal to <code>float</code> and not <code>short int</code> as the size of i is <code>short int</code>. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int x = 1;\n    short int i = 2;\n    float f = 3;\n    if (sizeof((x == 2) ? f : i) == sizeof(float))\n        printf(\"float\\n\");\n    else if (sizeof((x == 2) ? f : i) == sizeof(short int))\n        printf(\"short int\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "fgets", "feof"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1535461427, "post_id": 52058590, "comment_id": 91067424, "body": "Your check for end-of-file is flawed. You should check what <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc</code></a> <i>returns</i> first of all."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1535461642, "post_id": 52058590, "comment_id": 91067570, "body": "Also note that your code both printing and sending the data doesn&#39;t care about the actual length of the input. You need to check for the end of the string (with the help of e.g. <code>strlen</code>)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1535461837, "post_id": 52058590, "comment_id": 91067704, "body": "<code>c = fgetc(f);         if (feof(f))</code> is curious code.  Should <code>fgetc()</code> return <code>EOF</code> due to a rare error, loop will not exit.  Suggest &quot;c = fgetc(f);   if (c == EOF)`."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535462148, "post_id": 52058590, "comment_id": 91067914, "body": "Code does <code>write(sockfd, to_send, BUFFER_LENGTH);</code>, yet never sets <code>to_send[BUFFER_LENGTH - 1]</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1535462294, "post_id": 52058590, "comment_id": 91068014, "body": "Overall, <code>feof</code> and <code>ferror</code> are not primary-use functions.  You should detect when no more data will be available from a stream by observing the return values of functions that perform I/O, such as <code>fgetc</code>.  The main use of <code>feof</code> and <code>ferror</code> is to distinguish, <i>after the fact</i>, between the natural end of the string having been reached and an error having occurred on the stream."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1535463373, "post_id": 52058590, "comment_id": 91068727, "body": "@Someprogrammerdude Using <code>strlen()</code> is not a robust approach here as <code>fgetc(f)</code> may include <i>null characters</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1535463903, "post_id": 52058590, "comment_id": 91069057, "body": "Posting output text as <i>text</i> rather than only a picture makes for a better question.  Posting text only a a pic attacks down-votes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1535464339, "post_id": 52058590, "comment_id": 91069366, "body": "Dasonic, <b>specifically</b>, what do you see as wrong with the output?  Code intentionally  prints <code>&quot;EOF\\n&quot;</code> before printing the last line.  Is it that <code>&quot;EOF&quot;</code> that is of concern?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1535465064, "post_id": 52058590, "comment_id": 91069884, "body": "Dasonic, on a plus side, code does attempt at some error checking - good.  Note: the appended <code>&quot;EOF\\n&quot;</code> in one place (4  characters) differs from the 3 character <code>write(sockfd, &quot;EOF&quot;, 3)</code>.  I assume that was for de-bugging, yet it is an asymmetry."}, {"owner": {"reputation": 315, "user_id": 8606837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3e0a439995cb470b0a3e681c9252f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dasonic", "link": "https://stackoverflow.com/users/8606837/dasonic"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1535506887, "post_id": 52058590, "comment_id": 91086697, "body": "@chux Thanks for all the help. It works fine now. Yes I was confused why EOF was printing early, but that my mistake in not actually paying attention to what my code did but what I thought it did.   And yes the printf(&quot;EOF\\n&quot;) was just for debugging, and all printing of the text is to be removed."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 8606837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3e0a439995cb470b0a3e681c9252f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dasonic", "link": "https://stackoverflow.com/users/8606837/dasonic"}, "edited": false, "score": 0, "creation_date": 1535464399, "post_id": 52059090, "comment_id": 91069404, "body": "Sorry much of my confusion was from why EOF was printing early, then I realised that was just how I wrote it, and that the function was performing how it was meant to, and it was my server that was misbehaving.  The edit was because I still thought I had an issue after the advice, when infact I did not and I am an idiot."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 315, "user_id": 8606837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3e0a439995cb470b0a3e681c9252f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dasonic", "link": "https://stackoverflow.com/users/8606837/dasonic"}, "edited": false, "score": 1, "creation_date": 1535464657, "post_id": 52059090, "comment_id": 91069590, "body": "@Dasonic No need for apology or self-depreciation.  Instead, <a href=\"https://en.wikipedia.org/wiki/Pay_it_forward\" rel=\"nofollow noreferrer\">pay it forward</a>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1535464226, "last_edit_date": 1535464226, "creation_date": 1535462790, "answer_id": 52059090, "question_id": 52058590, "link": "https://stackoverflow.com/questions/52058590/feof-becomes-true-prematurely/52059090#52059090", "title": "feof becomes true prematurely", "body": "<p>Code needs to track how many characters read and then <code>printf(), write()</code> that many characters.</p>\n\n<pre><code>while (end_loop == 1) {\n    ...\n    // for (int i = 0; i &lt; BUFFER_LENGTH - 1; i++) {\n    int i;\n    for (i = 0; i &lt; BUFFER_LENGTH - 1; i++) { \n      ...\n    }\n    // for (int i = 0; i &lt; BUFFER_LENGTH - 1; i++) {\n    //    printf(\"%c\", to_send[j]);\n    for (int j = 0; j &lt; i; j++) {\n      ...\n    // n = write(sockfd, to_send, BUFFER_LENGTH);\n    n = write(sockfd, to_send, i);\n    ...\n}\n</code></pre>\n\n<p>Other problems include</p>\n\n<p>Test for <code>EOF</code>, not only <code>feof(f)</code></p>\n\n<pre><code>    c = fgetc(f);\n    // if (feof(f)) { // If end of file break loop \n    if (c == EOF) { // If end of file break loop **or input error**\n</code></pre>\n\n<p>No need for -1 when filling a <code>char</code> array.  A -1 might be useful with strings, but using strings here is not the best idea here either as <code>fgetc()</code> may return a <em>null character</em>.</p>\n\n<pre><code>//                                   vvv \n// for (int i = 0; i &lt; BUFFER_LENGTH - 1; i++)\nfor (int i = 0; i &lt; BUFFER_LENGTH; i++)\n// or better \nsize_t i; \nfor (i = 0; i &lt; sizeof to_send; i++)\n</code></pre>\n\n<hr>\n\n<p>OP amended code mid-answer Hmmmmmmmm.</p>\n\n<p>Do not use <code>for (int i = 0; i &lt; strlen(to_send); i++) {</code>. Data read may include <em>null characters</em> which negates good use of <em>strings</em> here.</p>\n\n<hr>\n\n<p>If OP does not want to see <code>\"EOF\\n\"</code> before the last line, print <code>\"EOF\\n\"</code> after the <code>while</code> loop.</p>\n"}], "owner": {"reputation": 315, "user_id": 8606837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3e0a439995cb470b0a3e681c9252f5?s=128&d=identicon&r=PG&f=1", "display_name": "Dasonic", "link": "https://stackoverflow.com/users/8606837/dasonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 52059090, "answer_count": 1, "score": 1, "last_activity_date": 1535464226, "creation_date": 1535461290, "last_edit_date": 1535462909, "question_id": 52058590, "link": "https://stackoverflow.com/questions/52058590/feof-becomes-true-prematurely", "title": "feof becomes true prematurely", "body": "<p>I am trying to send a file over a socket by reading one character at a time until the buffer (an array of chars) is full, sending it, then repeating until the end of the file.  But for some reason feof becomes true before the file ends (I believe it might be when the buffer array is full).</p>\n\n<pre><code>int c;\nint end_loop = 1;\nchar to_send[BUFFER_LENGTH];\nwhile (end_loop == 1) { //For the entire file\n    printf(\"creating next data\\n\");\n    bzero(to_send, BUFFER_LENGTH);\n    for (int i = 0; i &lt; BUFFER_LENGTH - 1; i++) { // read data from file until buffer full or EOF\n        c = fgetc(f);\n        if (c == EOF) { // If end of file break loop\n            printf(\"EOF\\n\");\n            end_loop = 0;\n            break;\n        }\n        to_send[i] = c;\n    }\n    for (int i = 0; i &lt; strlen(to_send); i++) {\n        printf(\"%c\", to_send[i]);\n    }\n    n = write(sockfd, to_send, strlen(to_send));\n    if (n &lt; 0) {\n        perror(\"ERROR writing to socket\");\n        exit(1);\n    }\n}\nn = write(sockfd, \"EOF\", 3);\nif (n &lt; 0) {\n    perror(\"ERROR writing to socket\\n\");\n    exit(1);\n}\n</code></pre>\n\n<p>This is the output from a simple file\n<a href=\"https://i.stack.imgur.com/Tna98.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tna98.png\" alt=\"client output\"></a></p>\n\n<p>It is possible feof is not the issue, since the code seems to keep looping despite \"EOF\" being met.</p>\n\n<p>EDIT: Added suggestions from the comments. Error still occurs.</p>\n"}, {"tags": ["c", "data-structures", "concurrency", "b-tree"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1535460546, "post_id": 52058099, "comment_id": 91066775, "body": "You may get some interesting ideas by looking at <a href=\"https://runshenzhu.github.io/618-final/\" rel=\"nofollow noreferrer\">Palm Trees</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1535461363, "post_id": 52058099, "comment_id": 91067387, "body": "You need to overcome the problem that insertions and deletions can both affect multiple nodes.  It is therefore insufficient to lock only one node at a time when you are modifying the tree."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1535461636, "post_id": 52058099, "comment_id": 91067564, "body": "As a starting point, consider a read / write lock for the whole tree.  You can refine that into read / write locks for each node, where a mutation operation will end up taking out write locks on all the nodes along the path to the mutation point.  Ultimately, you could probably refine that to allow mutations to recognize when it is safe to eagerly release write locks earlier in the path to the mutation point."}], "answers": [{"comments": [{"owner": {"reputation": 10561, "user_id": 5052365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pfifn.jpg?s=128&g=1", "display_name": "Adam.Er8", "link": "https://stackoverflow.com/users/5052365/adam-er8"}, "edited": false, "score": 0, "creation_date": 1573633228, "post_id": 52916281, "comment_id": 103940987, "body": "awesome reference! That&#39;s a really good presentation, and the fact the video is freely available on YouTube is amazing."}, {"owner": {"reputation": 101, "user_id": 363844, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c0a747b4b5e6291cf37ca5c066cc64b?s=128&d=identicon&r=PG", "display_name": "Dmitry Sychov", "link": "https://stackoverflow.com/users/363844/dmitry-sychov"}, "edited": false, "score": 0, "creation_date": 1579910896, "post_id": 52916281, "comment_id": 105937110, "body": "@DarkZero What about trying to get a read-latches first for insertion and if we&#39;ll find later that the nodes are indeed pending for update, upgrade the read latches to write latches? Will it result in more concurrency for deletes/inserts?"}, {"owner": {"reputation": 1799, "user_id": 4622058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/5Bl8C.jpg?s=128&g=1", "display_name": "DarkZero", "link": "https://stackoverflow.com/users/4622058/darkzero"}, "edited": false, "score": 0, "creation_date": 1580181491, "post_id": 52916281, "comment_id": 106004338, "body": "I understand your statement as, when you are doing insertion, you reach a node A, if node A is full, then you want to grab a Read latch on it because you don&#39;t know whether it will actually split. But this is meaningless, because if one of the later nodes are not full, then node A is safe, so you can release its latch. Otherwise, every node in your path after A is full, it means A must split. Therefore, you don&#39;t have a chance to upgrade a latch. Please correct me if I&#39;m wrong!"}], "tags": [], "owner": {"reputation": 1799, "user_id": 4622058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/5Bl8C.jpg?s=128&g=1", "display_name": "DarkZero", "link": "https://stackoverflow.com/users/4622058/darkzero"}, "is_accepted": false, "score": 3, "last_activity_date": 1540131713, "creation_date": 1540131713, "answer_id": 52916281, "question_id": 52058099, "link": "https://stackoverflow.com/questions/52058099/making-a-btree-concurrent-c/52916281#52916281", "title": "making a b+tree concurrent (c)", "body": "<p>I have just finished one project on implementing a concurrent B+ tree. You can find some intuition from CMU 15-445 (Database Systems):</p>\n\n<p><a href=\"https://15445.courses.cs.cmu.edu/fall2018/slides/09-indexconcurrency.pdf\" rel=\"nofollow noreferrer\">https://15445.courses.cs.cmu.edu/fall2018/slides/09-indexconcurrency.pdf</a> (Slides)\n<a href=\"https://www.youtube.com/watch?v=6AiAR_giC6A&amp;list=PLSE8ODhjZXja3hgmuwhf89qboV1kOxMx7&amp;index=9\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=6AiAR_giC6A&amp;list=PLSE8ODhjZXja3hgmuwhf89qboV1kOxMx7&amp;index=9</a> (Video)</p>\n\n<p>One way to do this is called \"latch crabbing\". Basically, you need an RWLock for each node. </p>\n\n<p>When you are searching for a leaf node, you add a Read(Search) or Write(Insert/Delete) lock on each of the node you visit. Once you discovered a node is \"safe\" (i.e. it won't split for insert, or it won't merge/redistribute with neighbors in delete), you can release the locks of its ancestors since you know the modification is limited to under this node. In this way, you are acquiring locks in the front and releasing locks on the back, walking like a crab, that's why it is called \"latch crabbing\" (I am misusing \"latch\" and \"lock\" here)</p>\n\n<p>This can be hard to implement, good lock :) </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9237024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540131713, "creation_date": 1535459753, "last_edit_date": 1535460550, "question_id": 52058099, "link": "https://stackoverflow.com/questions/52058099/making-a-btree-concurrent-c", "title": "making a b+tree concurrent (c)", "body": "<p>I am currently attempting to make a b+ tree concurrent.</p>\n\n<p>So far the approach I had in mind as a starting point would be to iterate through the tree when inserting, locking each node (each node has its own lock) and unlocking once gotten the lock to the next node in the tree until a node which has a child who has the order of the b+ tree - 1 keys as anything under that node can be modified, after which all the necessary insert operations are ran and the node is unlocked.</p>\n\n<p>This is obviously a very naive approach and doesnt offer much in the way of concurrency so I was wondering if there is a better way to go about this? Any inputs whatsoever would be greatly appreciated!</p>\n"}]