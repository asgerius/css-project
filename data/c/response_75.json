[{"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1466034607, "creation_date": 1466034607, "answer_id": 37847631, "question_id": 37847597, "link": "https://stackoverflow.com/questions/37847597/assigning-value-of-variable-through-pointer/37847631#37847631", "title": "Assigning value of variable through pointer", "body": "<p>Because <code>1/2</code> is <code>0</code>. On the other hand, <code>1.0/2.0</code> is <code>0.5</code>. The rule is, if both operands are integral, the division is integral as well. It then gets assigned to a float storage, and then gets printed as a float; but by that time, it's too late.</p>\n\n<p>Nothing to do with pointers, really.</p>\n"}, {"tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": false, "score": 1, "last_activity_date": 1466034639, "creation_date": 1466034639, "answer_id": 37847637, "question_id": 37847597, "link": "https://stackoverflow.com/questions/37847597/assigning-value-of-variable-through-pointer/37847637#37847637", "title": "Assigning value of variable through pointer", "body": "<p>Because you are dividing two integers.</p>\n\n<pre><code>1/2;\n</code></pre>\n\n<p>The result of 1 / 2 is an integer result, zero.  To correct this:</p>\n\n<pre><code>1.0 / 2.0;\n</code></pre>\n\n<p>This will return a floating point result.</p>\n"}], "owner": {"reputation": 125, "user_id": 5451893, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0e27598e211a00aa9b619ee4de9c4616?s=128&d=identicon&r=PG&f=1", "display_name": "Tam Lam", "link": "https://stackoverflow.com/users/5451893/tam-lam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1466034698, "answer_count": 2, "score": -1, "last_activity_date": 1466034639, "creation_date": 1466034314, "question_id": 37847597, "link": "https://stackoverflow.com/questions/37847597/assigning-value-of-variable-through-pointer", "closed_reason": "Duplicate", "title": "Assigning value of variable through pointer", "body": "<p>Why the output of x in the programming is 0 instead of 1/2?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{   \n        double *xp,x;\n        xp = &amp;x;\n        *xp = 1/2;\n        printf(\"%f\\n\",x);\n        return 0;\n}\n</code></pre>\n\n<p>give the result of </p>\n\n<pre><code>0.000000\n</code></pre>\n"}, {"tags": ["c", "http", "http-request"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6244963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3eb2c00270d90b23c5dbbc7bd90bedcb?s=128&d=identicon&r=PG&f=1", "display_name": "EdTed", "link": "https://stackoverflow.com/users/6244963/edted"}, "edited": false, "score": 0, "creation_date": 1466029852, "post_id": 37846776, "comment_id": 63153806, "body": "That was exactly what I was looking for. Thanks a lot."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1466034468, "post_id": 37846776, "comment_id": 63155105, "body": "There is also an issue if <code>size_data</code> is smaller than 4."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 2, "last_activity_date": 1466037384, "last_edit_date": 1466037384, "creation_date": 1466029232, "answer_id": 37846776, "question_id": 37846698, "link": "https://stackoverflow.com/questions/37846698/more-optimal-way-to-find-a-specific-word-in-a-string-buffers-c/37846776#37846776", "title": "More optimal way to find a specific word in a string buffers C", "body": "<p>Since you only want to check for the string \"POST\" at the beginning of the packet, you can use the <code>strncmp</code> function, e.g.</p>\n\n<pre><code>if ( strncmp( re, \"POST \", 5 ) == 0 )\n{\n    // this is a POST packet\n}\n</code></pre>\n\n<p>As noted by @jxh in the comments, the <code>strncpy</code> may cause problems, since it won't null terminate the string unless the string length is less than <code>size_data</code>. To make sure the string is properly terminated, the code should look like this</p>\n\n<pre><code>char re[size_data+1];\nstrncpy(re,data,size_data);\nre[size_data] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6244963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3eb2c00270d90b23c5dbbc7bd90bedcb?s=128&d=identicon&r=PG&f=1", "display_name": "EdTed", "link": "https://stackoverflow.com/users/6244963/edted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 37846776, "answer_count": 1, "score": 0, "last_activity_date": 1466037384, "creation_date": 1466028835, "question_id": 37846698, "link": "https://stackoverflow.com/questions/37846698/more-optimal-way-to-find-a-specific-word-in-a-string-buffers-c", "title": "More optimal way to find a specific word in a string buffers C", "body": "<p>I've made an app that parses HTTP headers. I'm trying to find if there is a better way to filter HTTP packets by POST method than the one I've come up with. What I am trying to accomplish is to take advantage of the fact that I know that all the POST methods packet strings start with \"POST\". Is there a way to search for the first word of a string, store it and then use a condition with it? My code works but I would prefer not to search for the whole packet for a \"POST\" - you never know when you get the word \"POST\" inside a GET packet, for example.   </p>\n\n<pre><code>   char re[size_data];\n   strncpy(re,data,size_data);   //data is the buffer and size_data the buffer size\n   char * check;\n   check = strstr(re,\"POST\"); \n   if(check!= NULL)\n  { *something happens* }\n</code></pre>\n"}, {"tags": ["c", "linear-algebra", "lapack"], "comments": [{"owner": {"reputation": 1285, "user_id": 5003848, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12b681a7a5cab103fa1ea1165685555b?s=128&d=identicon&r=PG&f=1", "display_name": "tonysdg", "link": "https://stackoverflow.com/users/5003848/tonysdg"}, "edited": false, "score": 0, "creation_date": 1466030043, "post_id": 37846564, "comment_id": 63153876, "body": "I&#39;m just shooting from the hip here (I&#39;ve never used lapack), but that looks like a floating-point rounding problem to me. See <a href=\"http://stackoverflow.com/questions/588004/is-floating-point-math-broken\" title=\"is floating point math broken\">stackoverflow.com/questions/588004/&hellip;</a> for more information."}, {"owner": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 0, "creation_date": 1466034170, "post_id": 37846564, "comment_id": 63155028, "body": "Related? <a href=\"http://icl.cs.utk.edu/lapack-forum/viewtopic.php?f=2&amp;t=1769\" rel=\"nofollow noreferrer\">icl.cs.utk.edu/lapack-forum/viewtopic.php?f=2&amp;t=1769</a> I tried using LAPACK.geev!() in Julia for the same matrix, and it gave non-orthogonal eigenvectors for degenerate pairs."}, {"owner": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "reply_to_user": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 0, "creation_date": 1466035671, "post_id": 37846564, "comment_id": 63155353, "body": "@roygvib, yes, that definitely helped. I switched to DSYEVD and that does print out orthogonal eigenvectors (but it does require a symmetric matrix). I will investigate whether a nonsymmetric matrix was possible, because I thought it was, but maybe that is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1466031256, "last_edit_date": 1495541308, "creation_date": 1466031256, "answer_id": 37847154, "question_id": 37846564, "link": "https://stackoverflow.com/questions/37846564/lapack-dgeev-degenerate-eigenvectors-nonorthogonal/37847154#37847154", "title": "Lapack dgeev degenerate eigenvectors nonorthogonal", "body": "<p>Try printing with <code>%lf</code>, like this:</p>\n\n<pre><code>printf(\"\\n Dot product between v1 and v6 %lf\\n\",sum);\n</code></pre>\n\n<p>like described here: <a href=\"https://stackoverflow.com/questions/19952200/scanf-printf-double-variable-c\">Scanf/Printf double variable C</a></p>\n\n<hr>\n\n<p>If that doesn't help, then I am guessing this is a floating point issue (since their dot product is small).</p>\n"}], "owner": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466031615, "creation_date": 1466028195, "last_edit_date": 1466031615, "question_id": 37846564, "link": "https://stackoverflow.com/questions/37846564/lapack-dgeev-degenerate-eigenvectors-nonorthogonal", "title": "Lapack dgeev degenerate eigenvectors nonorthogonal", "body": "<p>I am making a program which makes extensive use of eigenvalues and eigenvectors. While testing the program, I ran into a case where two eigenvectors with the same eigenvalue are not quite orthogonal. I know that in the case of degenerate eigenvectors, the solution is not unique and the solve routine is not guaranteed to produce a certain vector, since a linear combination of the degenerate eigenvectors is still an eigenvector with the same eigenvalue. However, I did expect the two of them to be orthogonal.</p>\n\n<p>Is this a bug? Should all eigenvectors produced by dgeev be orthogonal? Is there another routine that will always print out orthogonal vectors? </p>\n\n<p>Here is a test case in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid ctofortran(double *matrix,double *fortranMatrix,int numberOfRows,int numberOfColumns)\n{\n/******************************************************************/\n/* This function converts a row-major C matrix into a column-major*/\n/* fortran \"array\".                                               */\n/******************************************************************/\nint columnNumber,rowNumber;\nfor (columnNumber = 0;columnNumber&lt;numberOfColumns ;columnNumber++ )\n{\n    for (rowNumber = 0;rowNumber&lt;numberOfRows ;rowNumber++ )\n    {\n        fortranMatrix[rowNumber+numberOfRows*columnNumber] = *(matrix + columnNumber+numberOfColumns*rowNumber);\n    }\n}\n}\n\n\nint main(int argc, char **argv)\n{\ndouble matrix[] = {4,   -1, 0,  -1, 0,  0,  0,  0,  \n                  -1,   4,  -1, 0,  0,  0,  0,  0,  \n                   0,   -1, 4,  0,  -1, 0,  0,  0,  \n                  -1,   0,  0,  4,  0,  -1, 0,  0,  \n                   0,   0,  -1, 0,  4,  0,  0,  -1,     \n                   0,   0,  0,  -1, 0,  4,  -1, 0,  \n                   0,   0,  0,  0,  0,  -1, 4,  -1,     \n                   0,   0,  0,  0,  -1, 0,  -1, 4 };\nint rows = 8, columns = 8;\ndouble *fortranmatrix = malloc(rows*columns*sizeof(double));\nctofortran(matrix,fortranmatrix,rows,columns);\n\n\n\nchar jobvl ='v';\nchar jobvr = 'n';\n//This symbolizes that the left eigenvectors will be found\ndouble *realEigenValues,*imaginaryEigenValues;\nrealEigenValues = malloc(rows*sizeof(double));\nimaginaryEigenValues = malloc(rows*sizeof(double));\ndouble *leftEigenVectors = malloc(rows*columns*sizeof(double));\nint lwork = rows * 4;\ndouble *work = malloc(lwork*sizeof(double));\n//This allocates workspace to be used by dgeev. The recomended space is 4 times the dimension\nint info = 0;//After dgeev info = 0 if the calculation went correctly   \n\n\ndgeev_(&amp;jobvl,&amp;jobvr,&amp;rows,fortranmatrix,&amp;rows,realEigenValues,imaginaryEigenValues,leftEigenVectors,&amp;rows,NULL,&amp;rows,work,&amp;lwork,&amp;info);\n\nint index;\nfor(index = 0;index&lt;rows;index++)\nprintf(\"Eigenvalue %d %g + %g * i\\n\",index,*(realEigenValues+index), *(imaginaryEigenValues+index));\n\nint v1 = 1, v6 = 6;\ndouble sum = 0;\nprintf(\"\\nv1\\tv6\\n\");\nfor(index = 0;index&lt;rows;index++)\n{\nprintf(\"%g\\t%g\\n\",*(leftEigenVectors+v1*rows+index),*(leftEigenVectors+v6*rows+index));\nsum += *(leftEigenVectors+v1*rows+index) * *(leftEigenVectors+v6*rows+index);\n}\nprintf(\"\\n Dot product between v1 and v6 %g\\n\",sum);\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>And here is the output:</p>\n\n<pre><code>Eigenvalue 0 2 + 0 * i\nEigenvalue 1 2.58579 + 0 * i\nEigenvalue 2 4 + 0 * i\nEigenvalue 3 6 + 0 * i\nEigenvalue 4 5.41421 + 0 * i\nEigenvalue 5 5.41421 + 0 * i\nEigenvalue 6 2.58579 + 0 * i\nEigenvalue 7 4 + 0 * i\n\nv1          v6\n-0.499878   0\n-0.345657   0.353553\n0.0110458   0.5\n-0.361278   -0.353553\n0.361278    0.353553\n-0.0110458  -0.5\n0.345657    -0.353553\n0.499878    -9.88042e-16\n\nDot product between v1 and v6 0.0220917\n</code></pre>\n\n<p>v6 looks more \"normal\" to me. </p>\n\n<p>*This matrix was symmetric, but it will not always be so. </p>\n"}, {"tags": ["c", "multidimensional-array", "typedef"], "comments": [{"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "edited": false, "score": 0, "creation_date": 1466031584, "post_id": 37846445, "comment_id": 63154314, "body": "Somehow I do not see question about <code>typedef</code> being duplication of the by question about initialization."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "edited": false, "score": 0, "creation_date": 1466033720, "post_id": 37846445, "comment_id": 63154892, "body": "@sg7 using typedef makes the language somehow different from the way was written ?"}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1466034376, "post_id": 37846445, "comment_id": 63155074, "body": "@Michi - Well, judging by PC Luddite comments under my post it was ALL about <code>typedef</code> not about practical solution and initialization. First I understood the question in terms of solution and solving the problem. But after being down-voted on my post I realized that one can have different point of view. It can be about <code>typedef</code> or it can be about dynamic array. See: <i>&quot;The asker was writing about typedefs though, not really about the creation of dynamically sized arrays... \u2013 PC Luddite&quot;</i>"}, {"owner": {"reputation": 1768, "user_id": 5198934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d551503989912c9490ac78638ff7c597?s=128&d=identicon&r=PG&f=1", "display_name": "fullofsquirrels", "link": "https://stackoverflow.com/users/5198934/fullofsquirrels"}, "edited": false, "score": 0, "creation_date": 1466087804, "post_id": 37846445, "comment_id": 63181734, "body": "why not just use <code>typedef char **grid;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466031412, "post_id": 37846612, "comment_id": 63154255, "body": "I strongly doubt you can specify the inner dimension as <code>*</code>. How would the compiler know the length?"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466031688, "post_id": 37846612, "comment_id": 63154342, "body": "@Olaf: It would assume, that size is taken from the precedecing parameter(s). In this case (an single <code>int</code>), both sizes has to be evaluated using that parameter (can be arbitratry expresions like <code>2*size</code>, but the parameter must be present within them). AFAIR there is an GNU extension, that allows to put size <i>after</i> the array parameter(s)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466032873, "post_id": 37846612, "comment_id": 63154676, "body": "I know that about the VLA with an expression in the brackets but for the <code>*</code>-only version, I did not find anything supporting it is allowed in an inner dimension. See 6.7.6.2p4: &quot;If the size is * instead of being an expression, the array type is a variable length array type of unspecified size, which can only be used in declarations or type names with function prototype scope&quot;. The inner dimensions are <b>not</b> at function prototype scope, but at the scope of the outer dimension. Difference to <code>[]</code> is it is a complete type and you can <code>typedef int arr[*][123];</code>, but use only for parameter."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466033757, "post_id": 37846612, "comment_id": 63154901, "body": "@Olaf: This could be a valid point for a DR. But I believe, that intent was that <code>[*][*]</code> is perfectly valid. See 6.7.6.3/p21 (Example 5)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466038618, "post_id": 37846612, "comment_id": 63155969, "body": "Hmm, you are right. I really wonder how that is supposed to work. At least it is a bad idea from a documentation view. Actually I never use that star-syntax. OTOH it is the only way to <code>typedef</code> such an array type for arguments. Re. defect: I&#39;d say it takes the lengths from the other arguments, left to right. Which implies there is a problem is you don&#39;t pass them and what if you mix with other types. Strange syntax, though, I just use the &quot;normal&quot; VLA syntax. (Wonder how/if Doxygen can handle this)"}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": true, "score": 2, "last_activity_date": 1466031961, "last_edit_date": 1466031961, "creation_date": 1466028428, "answer_id": 37846612, "question_id": 37846445, "link": "https://stackoverflow.com/questions/37846445/is-it-possible-to-typedef-a-multidimensional-array-of-uncertain-size-c/37846612#37846612", "title": "Is it possible to typedef a multidimensional array of uncertain size? [C]", "body": "<p>The <code>typedef</code> declaration <code>char grid[][]</code> is illegal, because you cannot omit the righmost indice. In general (three and more dimensions), you can omit only the leftmost one.</p>\n\n<p>The C99 standard introduced a way to declare and define functions with multidimensional arrays of unknown size (known as VLAs<sup>1</sup>). The proper form to declare such function would be:</p>\n\n<pre><code>void drawGrid(int, char pascal[*][*]);\n</code></pre>\n\n<p>or if you prefer to keep parameters' names:</p>\n\n<pre><code>void drawGrid(int size, char pascal[size][size]);\n</code></pre>\n\n<p>The latter (and only the latter) can be used for a defintion too.</p>\n\n<p>Note that the <code>typedef</code> declaration cannot be applied to VLAs at file scope (that is, outside of any function). Refering to C11 (N1570 draft), \u00a76.7.8/2 <em>Type definitions</em>:</p>\n\n<blockquote>\n  <p>If a typedef name specifies a variably modified type then it shall\n  have block scope.</p>\n</blockquote>\n\n<hr>\n\n<p><sup>1)</sup> Of course, VLAs could be one-dimensional as well, like <code>int n = 100; int a[n] = {0};</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6451351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "closed_date": 1466029549, "accepted_answer_id": 37846612, "answer_count": 1, "score": 1, "last_activity_date": 1522692802, "creation_date": 1466027639, "last_edit_date": 1466029509, "question_id": 37846445, "link": "https://stackoverflow.com/questions/37846445/is-it-possible-to-typedef-a-multidimensional-array-of-uncertain-size-c", "closed_reason": "Duplicate", "title": "Is it possible to typedef a multidimensional array of uncertain size? [C]", "body": "<p>I am trying currently to solve a specific task. For this task I try to exercise all the skills I have learned so far. Since I am dealing with a multidimensional array a lot I wanted to typedef it as usual.</p>\n\n<p>This time the array has to be editable by the program in size.</p>\n\n<pre><code>typedef char grid[][];\n</code></pre>\n\n<p>this is what I tried in my special header file. I am getting the error </p>\n\n<pre><code>error: array type has incomplete element type\n</code></pre>\n\n<p>I post the complete code if it is necessary to see more details:</p>\n\n<p>main.c </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#include \"functions.h\"\n#include \"tester.h\"\n#include \"magic.h\"\n\nint main(int argc, char **argv)\n{\n    int size = getSize();\n    grid pascal[size][size];\n    drawGrid(pascal, size);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>functions.c</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include \"magic.h\"\n#include &lt;math.h&gt;\n\n/*  C array: Pascal triangle exercise\n*  By using two-dimensional array, write C program to display\n*  a table that represents a Pascal triangle of any size.\n*\n*  In Pascal triangle, the first and the second rows are set to 1.\n*  Each element of the triangle (from the third row downward) is the sum\n*  of the element directly above it and the element to the left of the\n*  element directly above it. See the example Pascal triangle(size=5) below:\n*\n*\n*  1\n*  1    1\n*  1    2   1\n*  1    3   3   1\n*  1    4   6   4   1\n*\n*/\n\nint getSize(void)\n{\n    int size;\n    printf(\"Please enter the size of the Pascal Triangle:\");\n    scanf(\"%d\",&amp;size);\n    printf(\"\\n\");\n\n    size = (int) sqrt(size);\n    printf(\"Pascal Triangle will be %d big\", (size*size));\n    return size;\n}\n\nvoid createVoid(grid pascal, int size)\n{\n    int i = 0;\n    int j = 0;\n\n    while(i &lt; size){\n        while (j &lt; size){\n            if (j &gt; i){\n                pascal[i][j] = ' ';\n            }\n            j++;\n       }\n       i++;\n    }\n}\n\nvoid createNumbers(grid pascal, int size)\n{\n    int i = 0;\n    int j = 0;\n\n    while(i &lt; size){\n        while (j &lt; size){\n            if (j &lt;= i){\n                if (i == 0){\n                    pascal[i][j] = '1';\n                }else if (i == j){\n                    pascal[i][j] = '1'\n                }else{\n                    pascal[i][j] = pascal[i][j-1] - VALUE_ZERO + pascal[i-1][j];\n                }\n            }\n            j++;\n        }\n        i++;\n    }\n}\n\nvoid printGrid(grid pascal)\n{\n    int i = 0;\n    int j = 0;\n    while (i &lt; size){\n        while (j &lt; size){\n            printf (\"%3c\", pascal[i][j]);\n            j++;\n        }\n        i++;\n    }\n}\n\nvoid drawGrid(grid pascal, int size)\n{\n    createVoid(pascal, size);\n    createNumbers(pascal, size);\n    printGrid(pascal);\n}\n</code></pre>\n\n<p>functions.h</p>\n\n<pre><code>#ifndef FUNCTIONS_H\n#define FUNCTIONS_H\n#include \"magic.h\"\n\nint getSize(void);\nvoid drawGrid(grid pascal, int size);\nvoid createVoid(grid pascal, int size);\nvoid createNumbers(grid pascal, int size);\nvoid printGrid(grid pascal, int size);\n\n#endif // FUNCTIONS_H\n</code></pre>\n\n<p>magic.h</p>\n\n<pre><code>#ifndef MAGIC_H\n#define MAGIC_H\n#include &lt;stdlib.h&gt;\n\n#define VALUE_ZERO '0'\n\ntypedef char grid[][];\n\n#endif // MAGIC_H\n</code></pre>\n"}, {"tags": ["c", "performance", "struct", "initialization", "arm"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466027844, "post_id": 37846391, "comment_id": 63153146, "body": "The least space likely would take to use a simple initialiser and not to call that function at all, considering the overhead for passing all fields to the function which seems to do nothing else than store the parameters to the fields anyway. Otherwise, your question is too broad. This is no discussion forum."}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1466027859, "post_id": 37846391, "comment_id": 63153152, "body": "Try both, see which works out best in practice (for whatever appropriate definition of &#39;best&#39;); it depends on more factors than it&#39;s possible to reason about at this level."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1466036036, "post_id": 37846391, "comment_id": 63155426, "body": "Presumably, the <code>PageName</code> parameter and <code>BoxName</code> variable are meant to be one and the same (in the macro initializer)."}, {"owner": {"reputation": 21, "user_id": 6231022, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-1syMBwWII_A/AAAAAAAAAAI/AAAAAAAABUw/naCfWX3HO94/photo.jpg?sz=128", "display_name": "Bradley bare", "link": "https://stackoverflow.com/users/6231022/bradley-bare"}, "edited": false, "score": 0, "creation_date": 1466036240, "post_id": 37846391, "comment_id": 63155457, "body": "Well I just tested it and it seems like the function requires less code. I don&#39;t know why but I still think I will use the define. Does that sound like a good idea?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6231022, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-1syMBwWII_A/AAAAAAAAAAI/AAAAAAAABUw/naCfWX3HO94/photo.jpg?sz=128", "display_name": "Bradley bare", "link": "https://stackoverflow.com/users/6231022/bradley-bare"}, "edited": false, "score": 0, "creation_date": 1466041911, "post_id": 37847984, "comment_id": 63156717, "body": "I only need to initialize them once, but there could be up to hundreds of these objects. Most of the structures are the same with x, y, w, h, and pointers. I used the similarity to create void pointer functions to move things around. I am big on code size and I found it increased my code. I don&#39;t know if it will matter in the end because initialization happens at the beginning so maybe I can deal with the slower function to initialize."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1466037124, "creation_date": 1466037124, "answer_id": 37847984, "question_id": 37846391, "link": "https://stackoverflow.com/questions/37846391/initialize-struct-when-declaring-or-in-separate-function/37847984#37847984", "title": "Initialize struct when declaring or in separate function", "body": "<p>How many of these particular initializations will you be doing? How many variations on these initializations will you be doing?  That may affect what gives you the least code.  Which of these need to be applicable to variables at global (file) scope?  You can use the macro at file scope; you can't use the function at file scope \u2014 the function call must be made within the body of a function, which also leads to questions about \"when is the variable initialized\".</p>\n\n<p>Note that the macro version means you write:</p>\n\n<pre><code>GUI_CreateBox(box1, 23, 45, 20, 30, 20, COLOUR_BLUE);\n</code></pre>\n\n<p>but the function version means you can write:</p>\n\n<pre><code>struct GUI_Box box2;\nGUI_InitBox(&amp;box2, 23, 45, 20, 30, 20, COLOUR_GREEN);\n\u2026some code using box2\u2026\nGUI_InitBox(&amp;box2, 32, 54, 2, 3, 2, COLOUR_PURPLE);\n\u2026more code using box2\u2026\n</code></pre>\n\n<p>That also leaves you an option of not initializing the structure; that may not be a good idea.</p>\n\n<p>Your choice.  There isn't a lot to choose between them.</p>\n\n<p>You might consider a compound literal too:</p>\n\n<pre><code>#define GUI_INITBOX(x, y, z, h, w, c) \\\n    (struct GUI_BOX){ .x = (x), .y = (y), .z = (z), .h = (h), .w = (w), .color = (c) }\n</code></pre>\n\n<p>Then you'd write:</p>\n\n<pre><code>struct GUI_BOX box1 = GUI_INITBOX(23, 45, 20, 30, 20, COLOUR_BLUE);\n</code></pre>\n\n<p>to declare and initialize, and you could write:</p>\n\n<pre><code>struct GUI_BOX box2;\n\u2026code\u2026;\nbox2 = GUI_INITBOX(23, 45, 20, 30, 20, COLOUR_GREEN);\n</code></pre>\n\n<p>to assign (not initialize) <code>box2</code> later.  Compound literals (and designated initializers) are part of C99 and hence also C11.</p>\n"}, {"tags": [], "owner": {"reputation": 597, "user_id": 2558056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0549be54a5ca0ad7babefe1271d7a681?s=128&d=identicon&r=PG", "display_name": "engineer14", "link": "https://stackoverflow.com/users/2558056/engineer14"}, "is_accepted": false, "score": 0, "last_activity_date": 1466045895, "creation_date": 1466045895, "answer_id": 37849160, "question_id": 37846391, "link": "https://stackoverflow.com/questions/37846391/initialize-struct-when-declaring-or-in-separate-function/37849160#37849160", "title": "Initialize struct when declaring or in separate function", "body": "<p>You have to consider the fact that you are not going to be initializing but once. As far as code size is concerned, since your initialization routine has ONLY assignments, the macro would be smaller. Also with the fact that you don't have to use a function call nor pass in a bunch or arguments, you save on your stack size and also your throughput.</p>\n\n<p>But one main thing you would want to consider is how many people would be using your library. I've ran into this quite a few times when people use libraries which are comprised of a lot of macros. There is no protection (parameter type checking) for your arguments, which could obviously lead to bad object initialization.</p>\n\n<p>For that point alone, I would always err on the side of safety and go with doing this inside a function, especially when you consider that</p>\n\n<p>And while this doesn't apply to your example, if you plan on reusing a single parameter multiple times in a function like macro, you could get some unexpected side effects for people who prefer to do an operation in the argument.</p>\n"}], "owner": {"reputation": 21, "user_id": 6231022, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-1syMBwWII_A/AAAAAAAAAAI/AAAAAAAABUw/naCfWX3HO94/photo.jpg?sz=128", "display_name": "Bradley bare", "link": "https://stackoverflow.com/users/6231022/bradley-bare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1466045895, "creation_date": 1466027408, "last_edit_date": 1466035863, "question_id": 37846391, "link": "https://stackoverflow.com/questions/37846391/initialize-struct-when-declaring-or-in-separate-function", "title": "Initialize struct when declaring or in separate function", "body": "<p>I am working with a bunch of structs in C as I begin my GUI library. I am having a difficult time deciding how to initialize the structs. Here are the two cases:</p>\n\n<pre><code>#define GUI_CreateBox(PageName,x,y,z,w,h,color) \\\n  struct GUI_BOX BoxName = {x,y,z,w,h,color}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>static void GUI_InitBox(struct GUI_BOX *box,uint32_t x, ... uint32_t color)\n{\n  init code\n}\n</code></pre>\n\n<p>My question is, which one would use the least code space? I figured the function would be better. I wanted to use the define because it would be much faster than dereferencing the struct pointer a bunch of times. I just do not understand how the initialization of structs works and wanted a second opinion before I proceed.</p>\n\n<p>What does everyone think?</p>\n\n<p>Also some background info. I will be working on ARM Cortex M-4 devices. I want a nice library.</p>\n"}, {"tags": ["c++", "c", "visual-c++", "assembly", "x86"], "comments": [{"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1466026573, "post_id": 37846117, "comment_id": 63152636, "body": "What makes you think this is faster than just writing it in C or C++? And it doesn&#39;t really matter how fast it is, given that a Caesar cipher can be broken in milliseconds."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1466028755, "post_id": 37846117, "comment_id": 63153445, "body": "Is <code>DWORD dwsKey</code> a typo. Seems like the extra <code>s</code> is a mistake? and then remove the local variable <code>DWORD dwKey;</code> ?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1466048523, "post_id": 37846117, "comment_id": 63158133, "body": "What&#39;s the point of this code?  Are you on purpose writing slow asm to stop the compiler from using a 4-byte xor, or SSE2 PXOR?"}], "answers": [{"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1466031225, "post_id": 37846238, "comment_id": 63154205, "body": "I believe that <code>__asm</code> takes care of saving and restoring the registers that are used within the <code>__asm</code> statement if need be. MSVC analyzes the __asm to determine register usage. About the only registers (besides selectors) that need to be dealt with manually (preserved) are ESP and EBP. GCC doesn&#39;t analyze inline assembler statements, but MSVC does."}, {"owner": {"reputation": 734, "user_id": 2387521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bf0d528ab74149a60fb059d8cdf380?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2387521/steven"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 2, "creation_date": 1466032864, "post_id": 37846238, "comment_id": 63154673, "body": "&quot;When using __asm to write assembly language in C/C++ functions, you don&#39;t need to preserve the EAX, EBX, ECX, EDX, ESI, or EDI registers&quot; (<a href=\"https://msdn.microsoft.com/en-us/library/k1a8ss06.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/k1a8ss06.aspx</a>).  The page also implies it does the analysis Michael mentions in order to optimize which registers it needs to save/restore automatically."}], "tags": [], "owner": {"reputation": 734, "user_id": 2387521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bf0d528ab74149a60fb059d8cdf380?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2387521/steven"}, "is_accepted": true, "score": 4, "last_activity_date": 1466027204, "last_edit_date": 1466027204, "creation_date": 1466026776, "answer_id": 37846238, "question_id": 37846117, "link": "https://stackoverflow.com/questions/37846117/c-c-inline-asm-improper-operand-type/37846238#37846238", "title": "C/C++ Inline asm improper operand type", "body": "<p>I think you have two problems.  </p>\n\n<p>First, \"xor\" can't take two memory operands (ds:[eax] is a memory location and dwKey is a memory location); secondly, you've used \"byte ptr\" to indicate you want a byte, but you're trying to use a DWORD and assembly can't automatically convert those.</p>\n\n<p>So, you'll probably have to load your value into an 8-bit register and then do it.  For example:</p>\n\n<pre><code>void XorBlock(DWORD dwStartAddress, DWORD dwSize, DWORD dwsKey)\n{\n    DWORD dwKey;\n    __asm\n    {\n        push eax\n        push ecx\n        mov ecx, dwStartAddress          // Move Start Address to ECX\n        add ecx, dwSize                  // Add the size of the function to ECX\n        mov eax, dwStartAddress          // Copy the Start Address to EAX\n        mov ebx, dwKey                   // &lt;---- LOAD dwKey into EBX\n\n        crypt_loop :                         // Start of the loop\n            xor byte ptr ds : [eax], bl     // XOR The current byte with the low byte of EBX\n            inc eax                         // Increment EAX with dwStartAddress++\n            cmp eax, ecx                     // Check if every byte is XORed\n            jl crypt_loop;                      // Else jump back to the start label\n\n        pop ecx // pop ECX from stack\n        pop eax // pop EAX from stack\n    }\n}\n</code></pre>\n\n<p>Although, it also looks like dwKey is uninitialized in your code; maybe you should just \"mov bl, 0x42\".  I'm also not sure you need to push and pop the registers; I can't remember what registers you are allowed to clobber with MSVC++ inline assembler.</p>\n\n<p>But, in the end, I think Alan Stokes is correct in his comment: it is very unlikely assembly is actually faster than C/C++ code in this case.  The compiler can easily generate this code on its own, and you might find the compiler actually does unexpected optimizations to make it run even faster than the \"obvious\" assembly does (for example, <a href=\"https://en.wikipedia.org/wiki/Loop_unrolling\" rel=\"nofollow\">loop unrolling</a>).</p>\n"}], "owner": {"reputation": 51, "user_id": 6454141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb7fa6bc82e142d9a7d24b8acc1b9bc?s=128&d=identicon&r=PG&f=1", "display_name": "Zer0Mem0ry", "link": "https://stackoverflow.com/users/6454141/zer0mem0ry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 0, "accepted_answer_id": 37846238, "answer_count": 1, "score": 0, "last_activity_date": 1466029959, "creation_date": 1466026206, "last_edit_date": 1466029959, "question_id": 37846117, "link": "https://stackoverflow.com/questions/37846117/c-c-inline-asm-improper-operand-type", "title": "C/C++ Inline asm improper operand type", "body": "<p>I have the following code, that is supposed to XOR a block of memory:</p>\n\n<pre><code>void XorBlock(DWORD dwStartAddress, DWORD dwSize, DWORD dwsKey)\n{\nDWORD dwKey;\n__asm\n{\n    push eax\n    push ecx\n    mov ecx, dwStartAddress          // Move Start Address to ECX\n    add ecx, dwSize                  // Add the size of the function to ECX\n    mov eax, dwStartAddress          // Copy the Start Address to EAX\n\n    crypt_loop:                         // Start of the loop\n        xor byte ptr ds:[eax], dwKey     // XOR The current byte with 0x4D\n        inc eax                         // Increment EAX with dwStartAddress++\n        cmp eax,ecx                     // Check if every byte is XORed\n    jl crypt_loop;                      // Else jump back to the start label\n\n    pop ecx // pop ECX from stack\n    pop eax // pop EAX from stack\n}\n}\n</code></pre>\n\n<p>However, the argument dwKey gives me an error. The code works perfectly if for example the dwKey is replaced by 0x5D.</p>\n"}, {"tags": ["c", "vb.net", "dll"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466024066, "post_id": 37845554, "comment_id": 63151415, "body": "I don&#39;t know VB, but does it support pointers? What do you think a <code>char **</code> actually is?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1466024472, "post_id": 37845554, "comment_id": 63151670, "body": "<a href=\"http://whathaveyoutried.com\" rel=\"nofollow noreferrer\">What have you tried so far?</a> Please <a href=\"https://stackoverflow.com/posts/37845554/edit\">edit</a> your question to show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of the code that you are having problems with, then we can try to help with the specific problem. You should also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1466025588, "post_id": 37845554, "comment_id": 63152185, "body": "The first result on Goolge: <a href=\"https://support.microsoft.com/en-us/kb/106553\" rel=\"nofollow noreferrer\">How To Write C DLLs and Call Them from Visual Basic</a>."}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466034056, "post_id": 37845554, "comment_id": 63154989, "body": "@Olaf : VB/VB.NET doesn&#39;t support pointers. C# does however."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1466038181, "post_id": 37845554, "comment_id": 63155886, "body": "@VisualVincent: The question is about VB. So simple answer would be &quot;you can&#39;t&quot;. Anyway, I&#39;m out, not my world."}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466072986, "post_id": 37845554, "comment_id": 63170959, "body": "@Olaf : I know it&#39;s in VB, but my point was to answer your question and include an alternative that actually <i>does</i> support pointers. Even though you/the OP don&#39;t use C# it is never wrong to be aware of little extra information. It might also help someone that actually is using the language :). -- Besides, even though C#&#39;s and VB&#39;s syntax is different, they&#39;re still very much alike due to that they&#39;re .NET Framework languages. It would have been one thing if I said C++ which is completely different. -- Anyway, I&#39;m not to start a discussion about this. Good luck in the future. :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466073853, "post_id": 37845554, "comment_id": 63171513, "body": "@I knew the other languages do (ok, a bit surprised about C#, but I&#39;m not interested in that language anyway). Re &quot;they are very much alike&quot; due to using the same run-time interpreter - sorry, but that is nonsense. With the same you could state Cython, Brainfuck, APL/1, Ada and C are much the same as they all use the same CPU instruction set after compilation. Or C and C++ are the same because they even use the similar syntax (but not necessarily identical semantics even for the same constructs). Anyway, thanks for the explanations."}, {"owner": {"reputation": 1, "user_id": 6471627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeaf39d7337bffb381a5eedf6f97af5b?s=128&d=identicon&r=PG&f=1", "display_name": "user6471627", "link": "https://stackoverflow.com/users/6471627/user6471627"}, "edited": false, "score": 0, "creation_date": 1466181078, "post_id": 37845554, "comment_id": 63227274, "body": "Hi! The C DLL function that I want to call from VB is:  void app::Request(const string&amp; input, string&amp; output) { \tchar* outputBuffer = nullptr; \tExecuteRequest(input.c_str(), &amp;outputBuffer); \tif (outputBuffer) \t\toutput = outputBuffer; }  But, I can&#39;t receive the output correctly...  Thank you everybody."}], "owner": {"reputation": 1, "user_id": 6471627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeaf39d7337bffb381a5eedf6f97af5b?s=128&d=identicon&r=PG&f=1", "display_name": "user6471627", "link": "https://stackoverflow.com/users/6471627/user6471627"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466023953, "creation_date": 1466023953, "question_id": 37845554, "link": "https://stackoverflow.com/questions/37845554/returning-char-from-c-dll-to-vb", "title": "returning char** from C DLL to VB", "body": "<p>Please, I am developing a VB app to call a C DLL function and I need to pass from VB to C DLL a char** to receive the reply. How can I do that? Thanks everybody!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 3, "creation_date": 1466023411, "post_id": 37845360, "comment_id": 63151077, "body": "I see you&#39;ve allocated 30 character buffers for your 30 byte files and processing them as strings... did you leave enough room for the null terminator?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1466023571, "post_id": 37845360, "comment_id": 63151165, "body": "<code>aktualis = malloc(sizeof(db));</code> should probably be <code>aktualis = malloc(db);</code> ?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1466023625, "post_id": 37845360, "comment_id": 63151187, "body": "In addition to above comments: <code>fread(aktualis, 1, db, fp); printf(&quot; Az aktualis sor: %s\\n&quot;, aktualis); fprintf(fptemp, &quot;%s&quot;, aktualis);</code>. The data in <code>aktualis</code> is not a C string. Reading from a text file with <code>fread</code> will never produce a C string (unless you explicitly NUL terminate the buffer after reading). You cannot treat it as such."}, {"owner": {"reputation": 21, "user_id": 6410901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac6f50bbaf281ce41c8e45701f08bbb?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/6410901/g%c3%a1bor-micsk%c3%b3"}, "edited": false, "score": 0, "creation_date": 1466023636, "post_id": 37845360, "comment_id": 63151195, "body": "Bloody hell mate.. thanks for the tip."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1466029190, "post_id": 37845360, "comment_id": 63153594, "body": "Splitting on bytes vs characters (utf8 codepoints). The language in the code looks like Hungarian, which has some characters that are not a single byte but are multibyte utf8 sequences (i.e. a character can be 1-4 bytes). If the data in the file is the same, a raw split on a given number of bytes might split a utf8 sequence in the middle and you have fileN ending with a garbage/wrong sequence and fileN+1 starting with the same. Consider your own name. It is utf8: Instead of <code>Gabor</code> (5 bytes), it is <code>G&lt;C3&gt;&lt;A1&gt;bor</code> (6 bytes). Try splitting it on two <i>bytes</i> ;-)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1466034973, "post_id": 37845360, "comment_id": 63155216, "body": "This is a new spin on Hungarian notation."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1466038392, "post_id": 37845360, "comment_id": 63155924, "body": "<code>strcpy(tmp,filenev);</code> may invoke <i>undefined behavior</i>. Do not forget to null-terminate &quot;strings&quot; before passing it to string-manipuration functions such as <code>strcpy()</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466231194, "post_id": 37845360, "comment_id": 63241901, "body": "when calling <code>fread()</code>, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466231254, "post_id": 37845360, "comment_id": 63241918, "body": "when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466231461, "post_id": 37845360, "comment_id": 63241974, "body": "the posted code contains several &#39;magic&#39; numbers. &#39;magic&#39; numbers are numbers with no basis.   Some of those &#39;magic&#39; numbers are 60, 30, 5, 3. &#39;magic&#39; numbers make the code much more difficult to understand, debug, maintain.  Suggest using an <code>enum</code> statement or <code>#define</code> statements to give those &#39;magic&#39; numbers meaningful names, then use those meaningful names throughout the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466231566, "post_id": 37845360, "comment_id": 63241990, "body": "the posted code opens several files, but fails to call <code>fclose()</code> for each of those files, before exiting."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466231686, "post_id": 37845360, "comment_id": 63242010, "body": "when calling any of the memory allocation functions (malloc, calloc, realloc), always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466231994, "post_id": 37845360, "comment_id": 63242079, "body": "When there is the error that the command line did not contain the correct number of parameters.  1) output the error message to <code>stderr</code> using <code>fprint( stderr, ....)</code>  and the format string should be a USAGE statement, similar to: <code>&quot;USAGE: %s &lt;parm1&gt; &lt;parm2&gt; &lt;parm3&gt;\\n&quot;</code> followed by the parameter: <code>argv[0] );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466232200, "post_id": 37845360, "comment_id": 63242119, "body": "when outputting a error message, driven by the returned value from a call to a system function, 1) output the error message to <code>stderr</code> 2) include the system error message, similar to: <code>perror( &quot;fopen for input file failed&quot; );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466232355, "post_id": 37845360, "comment_id": 63242153, "body": "these lines: ` for(i=0; i&lt;strlen(argv[2])-4; i++) {          filenev[j++] = argv[2][i];      }` can be replaced with: <code>strcpy( filenev, argv[2] );</code>"}], "owner": {"reputation": 21, "user_id": 6410901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac6f50bbaf281ce41c8e45701f08bbb?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/6410901/g%c3%a1bor-micsk%c3%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466023210, "creation_date": 1466023210, "question_id": 37845360, "link": "https://stackoverflow.com/questions/37845360/weird-character-when-writing-to-file", "title": "Weird character when writing to file", "body": "<p>This is the code I have written to split the file into parts. The language in the code is irrelevant, I'll show you the relevant part.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\nlong meret(FILE* fajl) {\n\n    long jelenlegi = ftell(fajl);\n    long meret;\n\n    fseek(fajl, 0L, SEEK_END);\n\n    meret = ftell(fajl);\n\n    fseek(fajl, jelenlegi, SEEK_SET);\n\n    return meret;\n\n}\n\nint main(int argc, char* argv[])\n{\n    FILE *fp, *fptemp;\n    long size, tmpsize;\n    int db;\n    int ct = 1, i = 0, index = 0, j, z;\n    char temp[30];\n    char temp2[30];\n    char actual[30];\n    char filenev[30];\n    char s[60];\n    char *tmp;\n    char filenevsorsz[5];\n    char *aktualis, ment[30];\n\n    printf(\"A hasznalat: \\n\");\n    printf(\"------------\\n\\n\");\n    printf(\"Elso parancssori argumentum: -d\\n\");\n    printf(\"Masodik: a file elerhetosege\\n\");\n    printf(\"Harmadik: darabolasban a darabok maximalis merete byte-ban!\\n\\n\");\n\n    if(argc != 4) {\n\n        printf(\"Nem jo a hasznalat! Olvasd el a hasznalati utmutatot!\");\n        return;\n\n    }\n\n    fp = fopen(argv[2], \"rt\");\n\n    if(!fp) {\n\n        printf(\"Hiba a file megnyitasakor...\");\n        return;\n    }\n\n    printf(\"\\n\\n\");\n    size = meret(fp);\n    printf(\"A file merete: %d byte\\n\", size);\n    printf(\"A megadott darabolasi parameter: %s\\n\\n\", argv[3]);\n    db = atoi(argv[3]);\n    printf(\"Osszesen %d file-ra kell szamitanunk.\\n\", (size/30)+1);\n    j = 0;\n\n    for(i=0; i&lt;strlen(argv[2])-4; i++) {\n\n        filenev[j++] = argv[2][i];\n\n    }\n\n    tmp = malloc(sizeof(filenev));\n    strcpy(tmp,filenev);\n    aktualis = malloc(sizeof(db));\n    i = 1;\n\n    while(i&lt;=3) {\n        printf(\"Most csinalom a %d. fajlt...\", i);\n        strcpy(filenev, tmp);\n        fread(aktualis, 1, db, fp);\n        printf(\" Az aktualis sor: %s\\n\", aktualis);\n        strcat(filenev, \"00\");\n        sprintf(filenevsorsz, \"%d\", i);\n        strcat(filenev, filenevsorsz);\n        strcat(filenev, \".txt\");\n        fptemp = fopen(filenev, \"a\");\n        fprintf(fptemp, \"%s\", aktualis);\n        printf(\"A filenev: %s\", filenev);\n        tmpsize = meret(fptemp);\n        printf(\"\\nA meret: %ld byte\\n\", tmpsize);\n        printf(\"\\n\");\n        i++;\n    }\n\n\n}\n</code></pre>\n\n<p>What this does: it reads a file, it reads X bytes (command line arg) from the file, and creates sub files from it.</p>\n\n<p>For example: test.txt contains 30 bytes. If I set to split by 10 bytes each, it will give me: \ntest001.txt\ntest002.txt\ntest003.txt</p>\n\n<p>This is the relevant part: </p>\n\n<pre><code>while(i&lt;=3) {\n        printf(\"Most csinalom a %d. fajlt...\", i);\n        strcpy(filenev, tmp);\n        fread(aktualis, 1, db, fp);\n        printf(\" Az aktualis sor: %s\\n\", aktualis);\n        strcat(filenev, \"00\");\n        sprintf(filenevsorsz, \"%d\", i);\n        strcat(filenev, filenevsorsz);\n        strcat(filenev, \".txt\");\n        fptemp = fopen(filenev, \"a\");\n        fprintf(fptemp, \"%s\", aktualis);\n        printf(\"A filenev: %s\", filenev);\n        tmpsize = meret(fptemp);\n        printf(\"\\nA meret: %ld byte\\n\", tmpsize);\n        printf(\"\\n\");\n        i++;\n    }\n</code></pre>\n\n<p>It copies to all file fine (into 10 bytes each) EXCEPT the first one. It will give me some weird characters and the whole file will be 4 bytes shorter with every single file I tried. But whenever I try to print the read line (30 byte) it will print it fine, EXCEPT when printing it to file, it gives me this random character. Any suggestions?</p>\n"}, {"tags": ["c", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 275, "user_id": 3053477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf683c7cfda5cfa01557f78152b800?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/3053477/will"}, "edited": false, "score": 1, "creation_date": 1466095537, "post_id": 37847838, "comment_id": 63186949, "body": "Thank you. Using GNU screen or Tmux solves the problem."}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 7, "last_activity_date": 1466067574, "last_edit_date": 1490005096, "creation_date": 1466036060, "answer_id": 37847838, "question_id": 37845244, "link": "https://stackoverflow.com/questions/37845244/acs-characters-not-working-in-putty-even-with-export-ncurses-no-utf8-acs-1/37847838#37847838", "title": "ACS characters not working in putty even with export NCURSES_NO_UTF8_ACS=1", "body": "<p>It is a combination of things.  The recommended <code>TERM</code> for PuTTY is <a href=\"http://invisible-island.net/ncurses/terminfo.src.html#tic-putty\" rel=\"noreferrer\">\"putty\"</a>, but due to inertia, most people use <a href=\"http://invisible-island.net/ncurses/terminfo.src.html#tic-xterm\" rel=\"noreferrer\">\"xterm\"</a>.  The line-drawing support in the xterm terminal description is different from PuTTY's assumptions because <a href=\"http://invisible-island.net/xterm/xterm.html\" rel=\"noreferrer\">xterm</a> supports <a href=\"http://invisible-island.net/luit/luit.html\" rel=\"noreferrer\">luit</a>, which has some limitations with the way the alternate character set is managed (see <a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=254316\" rel=\"noreferrer\">Debian Bug report #254316: \nncurses-base: workaround for screen's handling of register sgr0 isn't quite right</a>).</p>\n\n<p>If you use <code>infocmp</code> to compare, you may see these lines which deal with the alternate character set:</p>\n\n<pre><code>    acsc: '``aaffggiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz{{||}}~~', '``aaffggjjkkllmmnnooppqqrrssttuuvvwwxxyyzz{{||}}~~'.\n    enacs: NULL, '\\E(B\\E)0'.\n    rmacs: '\\E(B', '^O'.\n    smacs: '\\E(0', '^N'.\n</code></pre>\n\n<p>VT100s can have two character sets \"designated\", referred to as G0 and G1:</p>\n\n<ul>\n<li>The \"xterm\" line-drawing works by changing the designation of G0 between the ASCII and line-drawing characters,</li>\n<li>the \"putty\" line-drawing works by designating ASCII in G0 and line-drawing in G1 and switching between the two with the shift-in/shift-out control characters.</li>\n</ul>\n\n<p>Although both are VT100-compatible, the xterm scheme does not work with PuTTY.  Because of the tie-in with <code>luit</code>, the normal terminal description for <code>xterm</code> will not change (unless it proves possible to modify <code>luit</code> to solve the problem for its users), so a workaround is needed for users of PuTTY:</p>\n\n<ul>\n<li><p>use a different terminal description as recommended, e.g., <code>TERM=putty</code>.  PuTTY's settings dialog lets you set environment variables to pass to the remote machine.</p>\n\n<p>This has the drawback that some systems do not have the full ncurses terminal database installed, due to \"size\" (it is 6.8Mb on my local machine).  Also, <code>TERM</code> may not be on the list of allowed ssh environment variables.</p></li>\n<li><p>you can compile your own terminfo entry with ncurses' tic, e.g.,</p>\n\n<p><code>cat &gt;foo &lt;&lt;\"EOF\"\nxterm|my terminfo entry,\n        enacs=\\E(B\\E)0,\n        rmacs=^O,\n        smacs=^N,\n        use=xterm-new,\nEOF\ntic foo</code></p></li>\n<li><p>use GNU screen.  It does its own fixes, and happens to compensate for PuTTY's problems.</p></li>\n</ul>\n\n<p>Further reading</p>\n\n<ul>\n<li><a href=\"http://vt100.net/docs/vt100-ug/chapter3.html#SCS\" rel=\"noreferrer\">SCS \u2013 Select Character Set</a> (VT100 manual)</li>\n<li><a href=\"http://vt100.net/docs/vt220-rm/chapter4.html\" rel=\"noreferrer\">4.4 Character Set Selection (SCS)</a> (VT220 manual)</li>\n<li><a href=\"http://invisible-island.net/ncurses/ncurses.faq.html#big_terminfo\" rel=\"noreferrer\">The terminfo database is big\u2014do I need all of that?</a> (ncurses FAQ)</li>\n<li><a href=\"https://superuser.com/questions/708742/putty-login-execute-command-change-environment-variable-and-do-not-close-the\">Putty: login, execute command/change environment variable, and do NOT close the session</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2397, "user_id": 996142, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/22f659c828b9c60e26aa2359387cebfb?s=128&d=identicon&r=PG", "display_name": "user996142", "link": "https://stackoverflow.com/users/996142/user996142"}, "is_accepted": false, "score": 2, "last_activity_date": 1554214639, "creation_date": 1554214639, "answer_id": 55477054, "question_id": 37845244, "link": "https://stackoverflow.com/questions/37845244/acs-characters-not-working-in-putty-even-with-export-ncurses-no-utf8-acs-1/55477054#55477054", "title": "ACS characters not working in putty even with export NCURSES_NO_UTF8_ACS=1", "body": "<p>I want to make some additions. I faced same issue: many ncurses-based tools like <code>dialog</code>, <code>menuconfig</code> and <code>nconfig</code> from Linux kenrel sources, even <code>mc</code> is broken when built with ncurses (although <code>mc</code> is built using Slang on many OSes and not affected).</p>\n\n<p><em>Here is what happened</em></p>\n\n<p>ncurses uses <code>smacs</code> record from terminfo to switch to \"alternative charset\" and then it uses <code>acsc</code> to draw boxes. It sends <code>a</code> which is box-drawing character in alternative charset (ACS).\nThis is VT100 graphics.</p>\n\n<p>Some terminal emulators nowadays do not support ACS when in UTF-8 because apps have ability to send real box-drawing codepoints. </p>\n\n<p>There is unofficial capability <code>U8</code> (capital U!) in <code>terminfo</code> that tells ncurses: \"Instead of ACS use real box-drawing codepoints.\"</p>\n\n<p>I have this capability <code>infocmp -x xterm-utf</code> and for putty aswell, but not for <code>xterm</code>.</p>\n\n<p>As you can read in <code>ncurses(3)</code> (<a href=\"https://invisible-island.net/ncurses/man/ncurses.3x.html\" rel=\"nofollow noreferrer\">https://invisible-island.net/ncurses/man/ncurses.3x.html</a>), <code>ncurses</code> is aware of Linux console and GNU screen (and tmux, which also uses <code>screen</code> as <code>TERM</code>) and always behave like if <code>U8</code> were set.</p>\n\n<p>For other terminals that do not support ACS when in UTF, you can set <code>NCURSES_NO_UTF8_ACS</code>.</p>\n\n<p>Unfortunatelly, ncurses is not aware of putty.</p>\n\n<p>There is also <code>luit</code> that may convert ACS to Unicode points.</p>\n\n<p>So, here is what we can do to run ncurses + putty in UTF-8:</p>\n\n<ul>\n<li><p>Use terminal with <code>U8#1</code> capability. This one is set for putty (btw, I suggest to use <code>putty-256color</code> instead). You can create your own entry with <code>U8#1</code> and <code>colors#256</code> and compile it with <code>tic -x</code>. Be carefull that mouse may not work on terminals that do not start with <code>xterm</code> (see <code>mouseinterval(3)</code>, BUGS section). This is why I do not use <code>putty</code> terminal. I suggest to copy <code>xterm-utf8</code>, add <code>colors#256</code>, compile and stay with it: it works perfectly with putty, mouse and utf8.</p></li>\n<li><p>You can set <code>NCURSES_NO_UTF8_ACS</code> in your profile.</p></li>\n<li><p>You can run <code>screen</code> or <code>tmux</code>: it will set <code>TERM</code> to <code>screen</code> and fix <code>ncurses</code></p></li>\n<li><p>You can run <code>luit</code>: it will do all convertions for you.</p></li>\n<li><p>Since putty 0.71 you can ask putty to support ACS drawings even in UTF-8</p>\n\n<p><a href=\"https://i.stack.imgur.com/M3T3K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M3T3K.png\" alt=\"Since putty 0.71 you can ask putty to support ACS drawings even in UTF-8\"></a></p></li>\n</ul>\n"}], "owner": {"reputation": 275, "user_id": 3053477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf683c7cfda5cfa01557f78152b800?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/3053477/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3098, "favorite_count": 4, "accepted_answer_id": 37847838, "answer_count": 2, "score": 7, "last_activity_date": 1554214639, "creation_date": 1466022769, "question_id": 37845244, "link": "https://stackoverflow.com/questions/37845244/acs-characters-not-working-in-putty-even-with-export-ncurses-no-utf8-acs-1", "title": "ACS characters not working in putty even with export NCURSES_NO_UTF8_ACS=1", "body": "<p>I am developing an ncurses application myself in C. The problem is that putty displays alternative character set characters like ACS_VLINE as letters. My locale is</p>\n\n<pre><code>LANG=en_US.UTF-8\n</code></pre>\n\n<p>and I have set </p>\n\n<pre><code>export NCURSES_NO_UTF8_ACS=1\n</code></pre>\n\n<p>I have also set putty to UTF-8 and tried different fonts. The characters display fine on the tty on the actual machine so I think the issue is with putty. I have also tried linking ncursesw instead of ncurses.</p>\n"}, {"tags": ["c", "visual-studio", "posix", "deprecated", "msvcrt"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1466023199, "post_id": 37845163, "comment_id": 63150983, "body": "<a href=\"http://stackoverflow.com/a/7582741/315052\">stackoverflow.com/a/7582741/315052</a> is the answer to your question. Microsoft views POSIX co-opting C and C++ reserved prefixes as a violation."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1466026147, "post_id": 37845371, "comment_id": 63152443, "body": "That&#39;s not about being &quot;!fossilised&quot;, but POSIX being C-based, not C++. And C just does not have custom namespaces."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466060636, "post_id": 37845371, "comment_id": 63162857, "body": "@Olaf: POSIX could have decided to define alternative C++ bindings, there is no technical reason why they had to restrict themselves to one language. Boost stepped into that void, in a sense, and Boost shows much more signs of life."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1466073240, "post_id": 37845371, "comment_id": 63171119, "body": "POSIX just focuses on providing the foundations. It leaves higher abstraction to other libraries. This actually follows the ideas behind Unix and C. These is common and good practice (modularisation). This is a proven approach. Feel free to engage in a new ISO or IEC/etc. commitee to standardize boost or other OOP lib or maybe start POSIX-3 to cover this layer."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466074357, "post_id": 37845371, "comment_id": 63171826, "body": "@Olaf: No need for an additional ISO committee to standardize Boost, WG21 already does so. Just check C++11/14/17."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 2, "last_activity_date": 1466023248, "creation_date": 1466023248, "answer_id": 37845371, "question_id": 37845163, "link": "https://stackoverflow.com/questions/37845163/what-is-the-purpose-of-microsofts-underscore-c-functions/37845371#37845371", "title": "What is the purpose of Microsoft&#39;s underscore C functions?", "body": "<p>Names starting with an underscore, like <code>_isatty</code> are reserved for the implementation. They do not have a meaning defined by ISO C++, nor by ISO C, and you can't use them for your own purposes. So Microsoft is entirely right in using this prefix, and POSIX is actually wrong.</p>\n\n<p>C++ has namespaces, so a hypthetical \"Posix C++\" could define <code>namespace posix</code>, but POSIX has essentially become fossilized - no new innovation in that area. </p>\n"}, {"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 0, "last_activity_date": 1466023354, "creation_date": 1466023354, "answer_id": 37845398, "question_id": 37845163, "link": "https://stackoverflow.com/questions/37845163/what-is-the-purpose-of-microsofts-underscore-c-functions/37845398#37845398", "title": "What is the purpose of Microsoft&#39;s underscore C functions?", "body": "<p><code>isatty</code> &amp; co., although POSIX, are not standard C, and are provided as \"extensions\" by the VC++ runtime<sup>1</sup>.</p>\n\n<p>As such, they are prefixed with an underscore supposedly to avoid name clashes - as names starting with an underscore followed by a lowercase letter are reserved for implementation-defined stuff at global scope. So if, for example, you wanted to use an actual POSIX compatibility layer providing its own versions of these functions, they wouldn't have to fight with the VC++-provided \"fake\" ones for the non-underscored names.</p>\n\n<hr>\n\n<ol>\n<li>Extensions which have no presumption to be actually POSIX-compliant, by the way.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 16354, "user_id": 189247, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87284d140d3aea831234f77ef4f9e64?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rn Lindqvist", "link": "https://stackoverflow.com/users/189247/bj%c3%b6rn-lindqvist"}, "edited": false, "score": 0, "creation_date": 1466024452, "post_id": 37845537, "comment_id": 63151662, "body": "So <i>technically</i> MS is correct and all Unix C runtimes are bugged? But wouldn&#39;t that apply for <i>all</i> C functions in the runtime then, not just the POSIX-mandated ones? <code>tmpfile_s</code> and <code>wcrtomb_s</code> appears to not be in the C standard and they don&#39;t have any underscores."}, {"owner": {"reputation": 734, "user_id": 2387521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bf0d528ab74149a60fb059d8cdf380?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2387521/steven"}, "reply_to_user": {"reputation": 16354, "user_id": 189247, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87284d140d3aea831234f77ef4f9e64?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rn Lindqvist", "link": "https://stackoverflow.com/users/189247/bj%c3%b6rn-lindqvist"}, "edited": false, "score": 2, "creation_date": 1466024703, "post_id": 37845537, "comment_id": 63151780, "body": "I think that&#39;s right.  Technically, the Unix C runtimes are not ISO-compliant (they&#39;re POSIX-compliant).  As for tmpfile_s, I think you&#39;re correct that there was ummm... some hypocrisy... when those functions were first added.  Although, now, I think a lot of the functions have been added to the C++ standard; for example, <a href=\"http://en.cppreference.com/w/c/io/tmpfile\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/io/tmpfile</a> indicates tmpfile_s is part of the C11 standard"}, {"owner": {"reputation": 734, "user_id": 2387521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bf0d528ab74149a60fb059d8cdf380?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2387521/steven"}, "reply_to_user": {"reputation": 16354, "user_id": 189247, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87284d140d3aea831234f77ef4f9e64?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rn Lindqvist", "link": "https://stackoverflow.com/users/189247/bj%c3%b6rn-lindqvist"}, "edited": false, "score": 1, "creation_date": 1466025108, "post_id": 37845537, "comment_id": 63151959, "body": "Oh, I do think &quot;bugged&quot; is too strong of a word.  It&#39;d be more accurate to say the Unix C runtimes aren&#39;t actually trying to be 100% ISO-compliant in the first place; they&#39;re more interested in POSIX-compliance."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466073507, "post_id": 37845537, "comment_id": 63171299, "body": "That somewhat contradicts the &quot;extensions&quot; MS added themselves to the C library. It looks more hypocritical to me. Primary reason is more likely MS has dropped POSIX support for the rest of the system and tries/tried (such companies take some time to change direction) to bind programmers tighter to their platform. Considering the partly contradicting concepts of POSIX and Windows, this even makes sense from a maintenance view of the libs/system."}], "tags": [], "owner": {"reputation": 734, "user_id": 2387521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bf0d528ab74149a60fb059d8cdf380?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2387521/steven"}, "is_accepted": true, "score": 12, "last_activity_date": 1466023893, "creation_date": 1466023893, "answer_id": 37845537, "question_id": 37845163, "link": "https://stackoverflow.com/questions/37845163/what-is-the-purpose-of-microsofts-underscore-c-functions/37845537#37845537", "title": "What is the purpose of Microsoft&#39;s underscore C functions?", "body": "<p>The fact that _isatty() is ISO C++ conformant makes sense if you think of it like a \"language lawyer\".</p>\n\n<p>Under ISO C++, the compiler is only supposed to provide the functions in the standard (at least for the standard headers) -- they're not allowed to freely add extra  functions, because it could conflict with functions declared in the code being compiled.  Since isatty() is not listed in the standard, providing an isatty() function in a standard header would not be ISO C++ compliant.</p>\n\n<p>However, the standard does allow the compiler to provide <em>any</em> function it wants as long as the function starts with a single underscore.  So -- language lawyer time -- _isatty() <em>is</em> compliant with ISO C++.</p>\n\n<p>I believe that's the logic that leads to the error message being phrased the way it is.</p>\n\n<p>(Now, in this specific case, isatty() was provided in io.h, which is not actually a C++ standard header, so technically Microsoft <em>could</em> provide it and still claim to be standards-conformant.  But, they had other non-compliant functions like strcmpi() in string.h, which is a standard header.  So, for consistency, they deprecated all of the POSIX functions the same way and they all report the same error message.)</p>\n"}], "owner": {"reputation": 16354, "user_id": 189247, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87284d140d3aea831234f77ef4f9e64?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rn Lindqvist", "link": "https://stackoverflow.com/users/189247/bj%c3%b6rn-lindqvist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 0, "accepted_answer_id": 37845537, "answer_count": 3, "score": 10, "last_activity_date": 1466023893, "creation_date": 1466022457, "last_edit_date": 1495542149, "question_id": 37845163, "link": "https://stackoverflow.com/questions/37845163/what-is-the-purpose-of-microsofts-underscore-c-functions", "title": "What is the purpose of Microsoft&#39;s underscore C functions?", "body": "<p>This question is about the same subject as <a href=\"https://stackoverflow.com/questions/7582394/strdup-or-strdup\">strdup or _strdup?</a> but it is not the same. That question asks how to <strong>work around</strong> MS's renamings, this question asks <strong>why they did it in the first place</strong>. </p>\n\n<p>For some reason Microsoft has taken a whole slew of POSIX C functions and have deprecated and replaced them with <code>_</code>-prefixed variants. One example of many is <code>isatty</code>:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms235388.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ms235388.aspx</a></p>\n\n<pre><code>This POSIX function is deprecated. Use the ISO C++ conformant _isatty instead.\n</code></pre>\n\n<p>What exactly is ISO C++ conformant about <code>_isatty</code>? It appears to me that the MSDN help is totally wrong. </p>\n\n<p>The other questions answer explained how to deal with this problem. You add the <code>_CRT_NONSTDC_NO_DEPRECATE</code> define. Fine. But I want to know what Microsoft's thinking is. What was their point in renaming and deprecating functions? Was it just to make C programmers lives even harder? </p>\n"}, {"tags": ["c", "macos"], "comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 2, "creation_date": 1466022675, "post_id": 37845139, "comment_id": 63150741, "body": "<code>.so</code> files are not OSX. <code>-l libapi.so</code> ? Try <code>-lapi</code> flag. You may also have to provide search path for a non-standard library <code>-L.&#47;</code> (this means it is in the current directory)."}, {"owner": {"reputation": 429, "user_id": 1795794, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9541c33aba61aeefe4a1fcb0a6250fce?s=128&d=identicon&r=PG", "display_name": "Bing Bang", "link": "https://stackoverflow.com/users/1795794/bing-bang"}, "edited": false, "score": 0, "creation_date": 1466022757, "post_id": 37845139, "comment_id": 63150781, "body": "If the so file is in your current directory try -l ./libapi.so"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466028236, "post_id": 37845139, "comment_id": 63153277, "body": "As asked, this is not related to embedded systems!"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1466029331, "post_id": 37845139, "comment_id": 63153647, "body": "Maybe this would help: <a href=\"http://stackoverflow.com/a/2339910/929459\">stackoverflow.com/a/2339910/929459</a> ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1466034790, "post_id": 37845139, "comment_id": 63155172, "body": "Generally speaking, Mac OS X uses <code>.dylib</code> and <code>.bundle</code> for shared libraries (with <code>.dylib</code> being dynamic libraries loaded when the program starts and <code>.bundle</code> being libraries loaded via <code>dlopen()</code> etc after the program starts \u2014 at least in theory).  It seems likely that the <code>.so</code> file is incorrect for OS X.  What do you get when you run <code>file libapi.so</code> and what does <code>otool -L libapi.so</code> have to say?  If the answers don&#39;t include <code>Mach-O</code>, then you&#39;re likely to need to go back to the supplier (for source or object code for OS X). Try: <code>gcc -o demo demo.c libapi.so</code> (no <code>-l</code>); it might work."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1466035694, "post_id": 37845139, "comment_id": 63155357, "body": "Note that using linker options <code>-l xyz</code> means that the linker should look for <code>libxyz.dylib</code> or <code>libxyz.a</code> on OS X.  Specifying <code>-l libapi.so</code> means that the linker is looking for <code>liblibapi.so.dylib</code> or <code>liblibapi.so.a</code> and (not very surprisingly) is not finding either."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1466028204, "post_id": 37846051, "comment_id": 63153265, "body": "There might be other systems which use <code>.so</code> extension."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1466034856, "post_id": 37846051, "comment_id": 63155190, "body": "Solaris uses <code>.so</code> for shared objects; so does modern AIX, IIRC.  And the normal extension on Mac OS X are <code>.dylib</code> and <code>.bundle</code>."}], "tags": [], "owner": {"reputation": 1247, "user_id": 4670367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b47a1128985c28a96eed666c8af7a701?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4670367/george"}, "is_accepted": true, "score": -1, "last_activity_date": 1466025950, "creation_date": 1466025950, "answer_id": 37846051, "question_id": 37845139, "link": "https://stackoverflow.com/questions/37845139/how-to-compile-c-h-so-file/37846051#37846051", "title": "How to compile .c .h .so file?", "body": "<p>*.so is  \"shared object\" it works only on Linux. The Windows counterpart of *.so is DLL.These are combiled object code.</p>\n\n<p>What you have to do is \n1] \"compile\" your .c to .o [object file]\n2] \"Link\"  the new .o file with the .so</p>\n"}], "owner": {"reputation": 13, "user_id": 6157757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TMME20j27rk/AAAAAAAAAAI/AAAAAAAAABM/akZxHKrlxlM/photo.jpg?sz=128", "display_name": "Weijie Shi", "link": "https://stackoverflow.com/users/6157757/weijie-shi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 37846051, "answer_count": 1, "score": 0, "last_activity_date": 1466028184, "creation_date": 1466022340, "last_edit_date": 1466028184, "question_id": 37845139, "link": "https://stackoverflow.com/questions/37845139/how-to-compile-c-h-so-file", "title": "How to compile .c .h .so file?", "body": "<p>Another company gives me three files(demo.c,api.h,libapi.so). they told me that't enough for develop. I'm confuse how to build these thing together. \nI use gcc demo.c -o demo -l libapi.so . But's it's said \"ld: library not found\". I use Mac OS system. Some websites said i should use Linux to use .so file. what should I do?</p>\n"}, {"tags": ["c", "dll", "winsock", "winsock2"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466020371, "post_id": 37844471, "comment_id": 63149548, "body": "where is <code>main</code>? Please post <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>. If it is the antivirus - turn it off and see what happens. If it is not - remove the tag."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466021180, "post_id": 37844471, "comment_id": 63149974, "body": "Posting main wouldn&#39;t help much, given that the code is in a game and no socket calls are made until fairly deep into the code. I could post a link to the repository if that would help? its not exactly minimal though. As for minimal, I have added my entire tcp.c file, along with the header I use it with. I make use of all the specified functions."}, {"owner": {"reputation": 100, "user_id": 1771409, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ca01a734bc2ccd89e9446269702605?s=128&d=identicon&r=PG", "display_name": "rom1nux", "link": "https://stackoverflow.com/users/1771409/rom1nux"}, "edited": false, "score": 0, "creation_date": 1466022603, "post_id": 37844471, "comment_id": 63150714, "body": "What compiler did you use ?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1466022774, "post_id": 37844471, "comment_id": 63150793, "body": "The correct DLL is <code>ws2_32.dll</code>, which you don&#39;t need to include with your app as it is already included in the OS itself."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 0, "creation_date": 1466023520, "post_id": 37844471, "comment_id": 63151134, "body": "I checked and my ws2_32.dll seems to be working. Also I compiled it with gcc from MinGW. I am currently trying to produce a minimal sample to cause the issue, but so far every sample I write from scratch doesn&#39;t have the issue, while every sample I reduce to does have it no matter how much I take out."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "edited": false, "score": 0, "creation_date": 1467049451, "post_id": 37844471, "comment_id": 63559036, "body": "Ok, so I fixed the issue. It was definitely a DLL that was incorrect. I just deleted all the relevant DLLs I had and added all combinations of them back in. Yep, 2^9 total combinations, but that&#39;s how stuck I was. Turns out one of my SDL dll&#39;s was conflicting with ws2_32.dll. Still haven&#39;t figured out which one though."}], "owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466026704, "creation_date": 1466020077, "last_edit_date": 1466026704, "question_id": 37844471, "link": "https://stackoverflow.com/questions/37844471/winsock-code-produces-0xc0000022-error", "title": "Winsock code produces 0xc0000022 error", "body": "<p>I recently ported a linux application I wrote that uses BSD sockets extensively to winsock. The code seems to work perfectly fine on linux, and it compiles fine on windows, however when the executable is run I get a message box with the following content:</p>\n\n<pre><code>The application was unable to start correctly (0xc0000022). Click OK to close the application.\n</code></pre>\n\n<p>Of course I googled around about that error and mostly was pointed to antivirus issues. I gathered that the application is having trouble reading a dll somehow, so I tried downloading a copy of winsock.dll and tossing it in the runpath of my executable, to no avail. I also ran dependency walker on the executable which gave a long list of errors. Most errors were just warnings (multiple CPU types found for example) but I did notice <code>Error: A circular dependency was detected</code> which raised an eyebrow. </p>\n\n<p>As I said, the code works as-is on linux. Here is my tcp.c:</p>\n\n<pre><code>    #include \"tcp.h\"\n\n#define BUFSIZE 2048\n\n#if defined(_WIN32)\n    #include &lt;winsock2.h&gt;\n    typedef int socklen_t;\n\n    struct pollfd {\n        SOCKET fd;\n        short events;\n        short revents;\n    };\n\n    #define poll(X,Y,Z) winpoll(X,Y,Z)\n    #define POLLOUT 1\n    #define POLLIN 0\n\nstatic int winpoll(struct pollfd *pfd, int ignored, int ignored2) {\n    fd_set rfds;\n    struct timeval zero = {0};\n\n    int retval;\n\n    FD_ZERO(&amp;rfds);\n    FD_SET(pfd-&gt;fd, &amp;rfds);\n\n    if (pfd-&gt;events == POLLOUT) {\n        retval = select(1,NULL,&amp;rfds,NULL,&amp;zero);\n    } else {\n        retval = select(1,&amp;rfds,NULL,NULL,&amp;zero);\n    }\n\n    if (retval &lt; 0) {\n        perror(\"select\");\n    }\n\n    return retval;\n}\n#else\n    #include &lt;sys/socket.h&gt;\n    #include &lt;netinet/in.h&gt;\n    #include &lt;fcntl.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;sys/poll.h&gt;\n    #include &lt;netinet/tcp.h&gt;\n    #include &lt;arpa/inet.h&gt;\n    #include &lt;netinet/ip.h&gt;\n    #include &lt;netdb.h&gt;\n    #include &lt;ifaddrs.h&gt;\n#endif\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n\n#define BIND(SOCK,ADDR) bind(SOCK,(struct sockaddr*)&amp;(ADDR),sizeof(struct sockaddr_in))\n#define CONN(SOCK,ADDR) connect(SOCK,(struct sockaddr*)&amp;(ADDR),sizeof(struct sockaddr_in))\n\nvoid tcp_wrapup(void) \n{\n#if defined(_WIN32)\n    WSACleanup();\n#endif\n}\n\nvoid tcp_setup(void)\n{\n#if defined(_WIN32)\n    WSADATA wsaData;\n    WSAStartup(MAKEWORD(2,2),&amp;wsaData);\n#endif\n}\n\nstatic void set_nonblocking(int fd) \n{\n#if defined(_WIN32)\n    unsigned long mode = 1; /* non-blocking */\n    ioctlsocket(fd, FIONBIO, &amp;mode);\n#else\n    fcntl(fd,F_SETFL,fcntl(fd,F_GETFL,0)|O_NONBLOCK);\n#endif\n}\n\nint tcp_server_init(unsigned short port)\n{\n    int server_sock;\n    struct sockaddr_in server_addr = {0};\n\n\n    server_sock = socket(AF_INET, SOCK_STREAM, 0);\n    if (server_sock &lt; 0) { perror(\"sock\"); return -1; }\n\n    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_port = htons(port);\n\n    if (BIND(server_sock,server_addr) &lt; 0) { perror(\"bind\"); return -1; }\n\n    set_nonblocking(server_sock);\n\n    if (listen(server_sock, 0) &lt; 0) { perror(\"listen\"); return -1; }\n\n    return server_sock;\n}\n\nint tcp_server_poll(int server_sock)\n{\n    int client_sock;\n\n    client_sock = accept(server_sock,NULL,NULL);\n    if (client_sock &lt; 0) {\n        return -1;\n    }\n    return client_sock;\n}\n\nint tcp_client_init(unsigned int ip, unsigned short port)\n{\n    int client_sock;\n    struct sockaddr_in client_addr = {0};\n\n    client_sock = socket(AF_INET, SOCK_STREAM, 0);\n    if (client_sock &lt; 0) { perror(\"socket\"); return -1; }\n\n    client_addr.sin_family = AF_INET;\n    client_addr.sin_addr.s_addr = htonl(ip);\n    client_addr.sin_port = htons(port);\n\n    set_nonblocking(client_sock);\n\n    /* Note: WILL fail, operation in progress, non-blocking sockets wait for\n     * handshake. */\n    CONN(client_sock,client_addr);\n\n    return client_sock;\n}\n\nvoid tcp_send(int sock, const char *msg) \n{\n    int status;\n    struct pollfd myfd;\n    myfd.fd = sock;\n    myfd.events = POLLOUT;\n\n    status = poll(&amp;myfd,1,0);\n\n    if (status == 1) {\n        if (send(sock, msg, strlen(msg)+1, 0) &lt; 0) {\n            perror(\"send\");\n        }\n    }\n}\n\nint tcp_recv(int sock, char *buf, int max)\n{\n    int status;\n    struct pollfd myfd;\n    myfd.fd = sock;\n    myfd.events = POLLIN;\n\n    status = poll(&amp;myfd,1,0);\n\n    if (status == 1) {\n        int ret;\n        if ((ret = recv(sock,buf,max,0)) &lt; 0) {\n            return 0;\n        }\n        return ret;\n    }\n    return 0;\n}\n\nvoid tcp_close(int sock)\n{\n#if defined(_WIN32)\n    closesocket(sock);\n#else\n    if (close(sock) &lt; 0) {\n        perror(\"close\");\n    }\n#endif\n}\n\nunsigned int tcp_str_to_ip(const char *ip)\n{\n#if defined(_WIN32)\n    int bytes[4];\n    sscanf(ip,\"%d.%d.%d.%d\",&amp;bytes[0],&amp;bytes[1],&amp;bytes[2],&amp;bytes[3]);\n\n    return ntohl(((bytes[0]&lt;&lt;24) &amp; 0xFF) |\n                 ((bytes[1]&lt;&lt;16) &amp; 0xFF) | \n                 ((bytes[2]&lt;&lt;8) &amp; 0xFF) |\n                 (bytes[3] &amp; 0xFF));\n#else\n    struct addrinfo *cursor;\n    struct addrinfo *server = NULL;\n    getaddrinfo(ip,NULL,NULL,&amp;server);\n\n    for (cursor = server; cursor; cursor = cursor-&gt;ai_next) {\n        if (cursor-&gt;ai_family == AF_INET) {\n            struct sockaddr_in *addr = (struct sockaddr_in *)cursor-&gt;ai_addr;\n            return ntohl(addr-&gt;sin_addr.s_addr);\n        }\n    }\n\n    return ntohl((unsigned int)inet_addr(ip));\n#endif\n}\n\nchar *tcp_ip_to_str(unsigned int ip)\n{\n    struct in_addr addr;\n    addr.s_addr = htonl(ip);\n    return inet_ntoa(addr);\n}\n\nunsigned short tcp_get_port(int sock)\n{\n    struct sockaddr_in addr;\n    socklen_t len = sizeof(struct sockaddr_in);\n\n    if (getpeername(sock,(struct sockaddr *)&amp;addr,&amp;len) &lt; 0) {\n        perror(\"getpeername\");\n        return -1;\n    }\n\n    return ntohs(addr.sin_port);\n}\n\nunsigned int tcp_get_ip(int sock)\n{\n    struct sockaddr_in addr;\n    socklen_t len = sizeof(struct sockaddr_in);\n\n    if (getpeername(sock,(struct sockaddr *)&amp;addr,&amp;len) &lt; 0) {\n        perror(\"getpeername\");\n        return -1;\n    }\n\n    return ntohl(addr.sin_addr.s_addr);\n}\n\nunsigned short tcp_get_local_port(int sock)\n{\n    struct sockaddr_in addr;\n    socklen_t len = sizeof(struct sockaddr_in);\n\n    if (getsockname(sock,(struct sockaddr *)&amp;addr,&amp;len) &lt; 0) {\n        perror(\"getsockname\");\n        return -1;\n    }\n\n    return ntohs(addr.sin_port);\n}\n\nunsigned int tcp_get_local_ip(int sock)\n{\n    struct sockaddr_in addr;\n    socklen_t len = sizeof(struct sockaddr_in);\n\n    if (getsockname(sock,(struct sockaddr *)&amp;addr,&amp;len) &lt; 0) {\n        perror(\"getsockname\");\n        return -1;\n    }\n\n    return ntohl(addr.sin_addr.s_addr);\n}\n</code></pre>\n\n<p>My tcp.h header:</p>\n\n<pre><code>#ifndef _TCP_H\n#define _TCP_H\n\ntypedef int TCP_Socket;\n\n/* &lt;0 means no connection, try again */\nTCP_Socket tcp_server_init(unsigned short);\nTCP_Socket tcp_server_poll(TCP_Socket);\nTCP_Socket tcp_client_init(unsigned int, unsigned short); \n\nvoid tcp_send(TCP_Socket, const char *); \nint tcp_recv(TCP_Socket, char *, int); /* 0 = no data */\n\nvoid tcp_close(TCP_Socket);\n\nunsigned int tcp_str_to_ip(const char *);\nchar *tcp_ip_to_str(unsigned int); /* in static buf */\n\nunsigned short tcp_get_port(TCP_Socket);\nunsigned int tcp_get_ip(TCP_Socket);\nunsigned short tcp_get_local_port(TCP_Socket);\nunsigned int tcp_get_local_ip(TCP_Socket);\n\n/* Windows needs wrapup code. */\nvoid tcp_wrapup(void);\nvoid tcp_setup(void);\n#endif /* _TCP_H */\n</code></pre>\n\n<p>As for the command line, the windows version just adds <code>-lwsock32</code> to the end of the command that the linux version uses. Any idea how to get my code working? </p>\n\n<h1>Note</h1>\n\n<p>I tried compiling with debug mode, which still provides the same error code. I ran gdb with break main and before it could even hit the main breakpoint it crashed saying <code>During startup program exited with code 0xc0000022</code>. This leads me to believe that it may be an issue outside of the code? or perhaps with the permissions of the code?</p>\n"}, {"tags": ["c", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1466018216, "post_id": 37843912, "comment_id": 63148356, "body": "Declarations are not causing segfaults."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1466018245, "post_id": 37843912, "comment_id": 63148372, "body": "@EugeneSh.: They do - if the compiler has a bug and segfaults :-)"}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466018295, "post_id": 37843912, "comment_id": 63148403, "body": "Yes, but it is after commenting a single declaration (the one mentioned above), that I resolved the issue."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 3, "creation_date": 1466018325, "post_id": 37843912, "comment_id": 63148414, "body": "You likely have undefined behavior in the previous code that only rears its ugly head when you included this new declaration. The above code is not causing your problem."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1466018335, "post_id": 37843912, "comment_id": 63148423, "body": "Welcome to the wonderful world of <i>undefined behavior</i>."}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1466018339, "post_id": 37843912, "comment_id": 63148427, "body": "@StefanN What value <code>NB_MAX_PARTICIPANTS</code> does have?"}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466018389, "post_id": 37843912, "comment_id": 63148452, "body": "@Olaf if this was the case, how would I fix it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1466018411, "post_id": 37843912, "comment_id": 63148464, "body": "@StefanN This is not the case, I promise you."}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "reply_to_user": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1466018465, "post_id": 37843912, "comment_id": 63148505, "body": "@Jacajack I just edited my question"}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 1, "creation_date": 1466018503, "post_id": 37843912, "comment_id": 63148522, "body": "Umm, guys... I compiled those declarations and they throw segfault indeed..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1466018540, "post_id": 37843912, "comment_id": 63148536, "body": "@Jacajack Can you show what have you compiled and with which compiler?"}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466018601, "post_id": 37843912, "comment_id": 63148566, "body": "By the way, I used gcc on ubuntu"}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466018640, "post_id": 37843912, "comment_id": 63148583, "body": "@EugeneSh. There it is: <a href=\"http://paste.ubuntu.com/17376144/\" rel=\"nofollow noreferrer\">paste.ubuntu.com/17376144</a> I just copied those code samples and used <code>gcc</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 1, "creation_date": 1466018701, "post_id": 37843912, "comment_id": 63148618, "body": "@Jacajack Well, you are trying to define a large data structure on stack. This is not included in the question. And a valid cause for memory corruption. not a compiler bug."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1466018842, "post_id": 37843912, "comment_id": 63148695, "body": "@StefanN: Chances you discovered a compiler bug is near zero. Concentgrate on reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and finally providing the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You have been ask multiple times! Without that a good answer is not possible and all is speculation. Notice this is not a hindsight site; crystal balls are out today, too."}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 1, "creation_date": 1466018860, "post_id": 37843912, "comment_id": 63148705, "body": "UPDATE! I changed the size of NB_MAX_PARTICIPANTS to 10 instead of 1000 and it compiled."}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466018960, "post_id": 37843912, "comment_id": 63148763, "body": "@EugeneSh. I know this is not a compiler bug, I just wanted to verify if segmentation fault is actually caused by this declaration, and it is. I think Steven sorted everything out in his answer"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1466019141, "post_id": 37843912, "comment_id": 63148852, "body": "@Jacajack It&#39;s <i>definition</i>, not declaration. There is a difference."}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466019270, "post_id": 37843912, "comment_id": 63148937, "body": "@EugeneSh. I know, sorry for bad habits. I &#39;m just used to calling all those &#39;declarations&#39;"}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466019319, "post_id": 37843912, "comment_id": 63148978, "body": "@Olaf I don&#39;t understand. What is wrong with my question?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466020280, "post_id": 37843912, "comment_id": 63149502, "body": "You are looking at the wrong place."}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466020481, "post_id": 37843912, "comment_id": 63149600, "body": "@alk Could you please elaborate?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1466021100, "post_id": 37843912, "comment_id": 63149931, "body": "In C definitions rarely crash the program,  the  rest of the code does."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466027649, "post_id": 37843912, "comment_id": 63153075, "body": "@alk - In this case, however, declaring and defining <code>les_participants</code> as an <code>auto</code> variable <i>does</i> cause a segfault (at least it does on the SLES 10 system I&#39;m working on).  It&#39;s easily fixed by making it <code>static</code>, but it really is the definition that crashes the program."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1466058548, "post_id": 37843912, "comment_id": 63161698, "body": "@JohnBode: I read <code>changed ... to 1000 instead of 10</code>  instead of  <code>changed ... to 10 instead of 1000</code> :} So it might very well be one of those &quot;<i>rare</i>&quot; cases."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466018679, "post_id": 37844053, "comment_id": 63148607, "body": "Too much speculation. You really should ask for a MCVE before such speculation. Btw, stack size of desktop/server OS is typically some MiB."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1466018748, "post_id": 37844053, "comment_id": 63148640, "body": "The example struct given will be around 240Mb."}, {"owner": {"reputation": 549, "user_id": 4019966, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-7FZVt2CjsaM/AAAAAAAAAAI/AAAAAAAABZg/zIQSN85peEM/photo.jpg?sz=128", "display_name": "Jacajack", "link": "https://stackoverflow.com/users/4019966/jacajack"}, "edited": false, "score": 0, "creation_date": 1466018770, "post_id": 37844053, "comment_id": 63148658, "body": "Well, <code>sizeof( Participant )</code> returns 251508, though"}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466019102, "post_id": 37844053, "comment_id": 63148837, "body": "@Steven I am not an experienced developer, how do I integrate this into my code?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466019192, "post_id": 37844053, "comment_id": 63148880, "body": "Allocating such a size on heap is not very wise as well."}, {"owner": {"reputation": 734, "user_id": 2387521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bf0d528ab74149a60fb059d8cdf380?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2387521/steven"}, "reply_to_user": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 2, "creation_date": 1466019400, "post_id": 37844053, "comment_id": 63149028, "body": "@StefanN: It&#39;s kind of hard to explain if you&#39;re not used to pointers, but you could try looking for a C tutorial on &quot;pointers&quot; and &quot;malloc&quot;; something like: <a href=\"https://www.codingunit.com/c-tutorial-the-functions-malloc-and-free\" rel=\"nofollow noreferrer\">codingunit.com/c-tutorial-the-functions-malloc-and-free</a>.  Eugene has a good point; you&#39;re allocating a very, very large, inefficient structure and you&#39;ll eventually run into problems on the heap as well (if not with a 1000 participants, then 2000 or 10000, or once your allocate a bunch of memory for something else) -- but if this is a &quot;learning&quot; program, you might want to tackle one issue at a time and this is probably ok."}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466019552, "post_id": 37844053, "comment_id": 63149110, "body": "@Steven I volunteered to develop a program to be used by a non-profit organization. I need eventually to have enough space for 10 000 participants because I am simulating a real life structure."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466019841, "post_id": 37844053, "comment_id": 63149273, "body": "@StefanN: It is a good idea to first learn programming before you start something like that. If you store personal information like names, addresses, bank accounds/credit card information, etc., there are legal aspects to observe, too. Would not be the first (non-profit) organisation going bankrupt due to legal issues and compensations paid for data leaks."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 2, "creation_date": 1466019845, "post_id": 37844053, "comment_id": 63149275, "body": "@StefanN Before going into programming one should know about different data structures. Data structure is not necessarily consisting of a huge single contiguous  block of memory, which is hard to allocate, but often from many distinct chunks of data linked with each other. See <i>linked lists</i> for a simplest example."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1466019939, "post_id": 37844053, "comment_id": 63149320, "body": "@Ben: We don&#39;t see the definition, so it still is not clear if the size is actually the problem. Also a simple array is possibly a bad container for whatever OP wants to accomplish anyway."}, {"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466019987, "post_id": 37844053, "comment_id": 63149346, "body": "@Olaf I understand. It is not a serious program and does not contain any sensitive information."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 1, "creation_date": 1466020076, "post_id": 37844053, "comment_id": 63149389, "body": "@StefanN: Whatever you call &quot;sensitive information&quot;, that might not what a lawyer would say. If you store names, this already <b>is</b> sensitive. The exact difenrtiation is subject of local laws, of course. IANAL, just caught some stuff from some friends who work in that area."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466026686, "post_id": 37844053, "comment_id": 63152691, "body": "@StefanN: If you need to store that many entries, then you will definitely want to use a list or tree structure, rather than an array.  It might be worth your while to look at C++ or Java or C#, which provide these kinds of structures as predefined container types, rather than doing it the hard way in C."}], "tags": [], "owner": {"reputation": 734, "user_id": 2387521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bf0d528ab74149a60fb059d8cdf380?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2387521/steven"}, "is_accepted": true, "score": 5, "last_activity_date": 1466018458, "creation_date": 1466018458, "answer_id": 37844053, "question_id": 37843912, "link": "https://stackoverflow.com/questions/37843912/why-would-i-have-a-segmentation-fault-when-declaring-a-variable-in-a-c-program/37844053#37844053", "title": "Why would I have a segmentation fault when declaring a variable in a C program?", "body": "<p>It's probably just that your variable is too big for the available stack size on your platform.  The code is technically fine for C (so, not a compile-time error), but in practice the operating system does not reserve enough stack space to make this possible.</p>\n\n<p>After all, your langues_parles field takes, on its own, 250 * 500 bytes of space; i.e. 125kB.  You've got three fields like that, and then some other fields, so each instance of the structure takes around 380kB.</p>\n\n<p>Now, you haven't shown the value of NB_MAX_PARTICIPANTS, but my guess is that 380kB * NB_MAX_PARTICIPANTS is just too big.  For example, on Windows, the default stack size is only 1MB, so if NB_MAX_PARTICIPANTS is bigger than 2, then the variable is too big (and that's assuming there is nothing else on the stack).</p>\n\n<p>You will have to allocate your structure on the heap using malloc() or a similar function:</p>\n\n<pre><code>Ens_participants* les_participants = malloc(sizeof(Ens_participants));\n/* ... */\nfree(les_participants);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466030467, "post_id": 37845929, "comment_id": 63153993, "body": "Seeing as how this is getting complicated in C. How would you suggest I do it in C++? I need to store information of 1000 participants read from a file (email, name, languages spoken, etc.) and then filter through this information. Or should I learn Python from scratch?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466035798, "post_id": 37845929, "comment_id": 63155374, "body": "@StefanN: See my edit.  Don&#39;t take this as an example of <i>good</i> C++ code (I&#39;m more hack than hacker), but it should at least steer you in the right direction."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "edited": false, "score": 0, "creation_date": 1466091512, "post_id": 37845929, "comment_id": 63184498, "body": "@StefanN: And in the cold light of day I see a few immediate issues; <code>s &gt;&gt; universite</code> won&#39;t work for names like &quot;Texas State University&quot;; only &quot;Texas&quot; will be saved to <code>universite</code>.  So you&#39;ll have to use something different for any strings that need to contain whitespace."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1466035755, "last_edit_date": 1466035755, "creation_date": 1466025464, "answer_id": 37845929, "question_id": 37843912, "link": "https://stackoverflow.com/questions/37843912/why-would-i-have-a-segmentation-fault-when-declaring-a-variable-in-a-c-program/37845929#37845929", "title": "Why would I have a segmentation fault when declaring a variable in a C program?", "body": "<p><strong>Edit 2</strong></p>\n\n<p>Here's a <em>very</em> simplistic example in C++, pretty much off the top of my head and untested, so there are undoubtedly going to be some errors.  </p>\n\n<p>We're going to use the standard <code>map</code>, <code>vector</code>, and <code>string</code> data types for\nstoring our participant data.  The <code>map</code> type is an associative data structure,\nstoring items indexed by an arbitrary key.  A <code>vector</code> is a linear container\nlike an array, except that its size is not fixed, and a <code>string</code> is, well, a string.  All of these types do their own memory management, so you don't have to worry about allocating or freeing memory as items are added or removed.  </p>\n\n<p>First, we need define the <code>Participant</code> type:</p>\n\n<pre><code>#include &lt;string&gt; \n#include &lt;vector&gt;\n\n// By default, all members of a struct type are public.\nstruct Participant \n{\n  std::string nom;\n  std::string prenom;\n  std::string email;\n  std::string nationalite;\n  std::vector&lt; std::string &gt; langues_parles;\n  std::vector&lt; std::string &gt; langues_cherches;\n  int age;\n  char sexe;\n  std::string universite;\n  std::string disponible;\n\n  // Generate a key for the participant based on nom and prenom.\n  // The const keyword indicates that this method will not change\n  // any of the non-static members of the class.\n  std::string genkey() const \n  {\n    return nom + ',' + prenom;\n  }\n\n  // Overload the stream input operator; we're going to assume\n  // a file structure where each item is on it's own line, and where\n  // the number of languages read and spoken is explicitly specified.\n  // We're also going to assume the input is always well-behaved and\n  // never needs validating (which is not going to be true in the real\n  // world, of course\n  std::istream operator&gt;&gt;( std::istream&amp; s )\n  {\n    s &gt;&gt; nom;\n    // repeat for prenom, email, nationalite\n    int nlang;\n    s &gt;&gt; nlang;\n    for( size_t i = 0; i &lt; nlang; i++ )\n    {\n      std::string lang;\n      s &gt;&gt; lang;\n      langues_parles.push_back( lang );\n    }\n    // repeat for langues_cherches\n    // read remaining items\n    return s;\n  }\n\n  // Overload the stream output operator, write in the same format\n  // that we read.\n  std::ostream&amp; operator&lt;&lt;( std::ostream&amp; s )\n  {\n    s &lt;&lt; nom &lt;&lt; std::endl;\n    // repeat for prenom, email, nationalite;\n    s &lt;&lt; langues_parles.size() &lt;&lt; std::endl;\n    for ( std::vector&lt; std::string &gt;::iterator it = langues_parles.begin();\n          it != langues_parles.end(); ++it )\n      s &lt;&lt; *it &lt;&lt; std::endl;\n    // repeat for langues_cherches\n    // write remaining items\n    return s; \n  }\n};\n</code></pre>\n\n<p>Once the <code>Participants</code> type is defined, we can instantiate our map structure:</p>\n\n<pre><code>#include &lt;map&gt;\n\n/**\n * I normally wouldn't use a typedef here since I don't want to\n * hide the \"map-ness\" of the implementation, but this will save\n * some typing later on.\n */ \ntypedef std::map&lt; std::string, Participant &gt; Ens_participants; \nEns_participants les_participants;\n</code></pre>\n\n<p>Once that's all done, we can read data from our input file:</p>\n\n<pre><code>std::ifstream s( data_file );\nParticipant p;\n\n// use the overloaded stream input operator to read from our data file;\n// keep reading until we hit EOF or an error.\nwhile ( s &gt;&gt; p ) \n{\n  // add the new participant to the map\n  les_participants.insert( std::make_pair( p.genkey(),  p ) );\n}\n</code></pre>\n\n<p>To find a specific entry in the map, use the <code>find</code> method:</p>\n\n<pre><code>std::string key = \"Bode,John\";\n\nEns_participants::iterator it = les_participants.find( key );\nif ( it == les_participants.end() )\n  std::cerr &lt;&lt; \"Could not find John Bode in the list of participants!\" &lt;&lt; std::endl;\nelse\n  // process entry\n</code></pre>\n\n<p>To iterate through the map, do the following:</p>\n\n<pre><code>for ( Ens_participants::iterator it = les_participants.begin(); it != les_participants.end(); ++it )\n{\n  std::cout &lt;&lt; \"key  = \" &lt;&lt; it-&gt;first &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"data = \" &lt;&lt; it-&gt;second;\n}\n</code></pre>\n\n<p>The <code>find()</code>, <code>begin()</code>, and <code>end()</code> methods return <em>iterators</em>, which look and behave a lot like pointers.  The iterator returned by the <code>end()</code> function serves basically the same purpose as the <code>NULL</code> pointer value; it acts as a well-defined \"there is no data here\" value.  </p>\n\n<p>Notice that the bulk of the work is setting up the <code>Participant</code> type.  Storing and accessing the data is simply a matter of using the built-in <code>map</code> container and its methods.  </p>\n\n<p>I'll leave it there, since I don't know exactly what you want to do.  Again, none of that code is tested, so there are almost certainly some errors, and the style isn't the best in the world.  But, the main intent is to show you how C++ can make this kind of application much easier to write than in C.  For one thing, you don't have to specify an explicit size for anything; the strings, vectors, and the map will grow or shrink as necessary without any action on your part.  There are some even slicker tools in the standard library, but that should be enough to get you started.  </p>\n\n<p>Make sure you find a <em>good</em> C++ reference before starting, though.  </p>\n\n<p><strong>Edit</strong></p>\n\n<p>Based on additional comments from the OP, I'm going to suggest that he look at a different language for implementing this system.  C is pretty much the worst language to implement a system like this, especially if you're not that experienced in programming.  Even C++ would make this task <em>much</em> easier.  It might be worth investigating what Python has to offer.  </p>\n\n<p><strong>Original</strong> </p>\n\n<p>A single instance of <code>Ens_participants</code> is almost 240 MiB wide.  Most systems that I'm familiar with will yak if you try to allocate an object that large as an <code>auto</code> (local) variable.  </p>\n\n<p>Before doing anything else, do some analysis and figure out how big <code>TMAX_MOT</code>, <code>LMAX</code>, and <code>NB_MAX_PARTICIPANTS</code> <em>really</em> need to be.  Do you really expect to have 1000 participants?  Do you really expect any of your participant names to be 250 characters long, or for them to have email addresses that long?  Do you really expect any of your participants to be able to read or speak 50 different languages (and for any of the language names to be 250 characters long)?  And so on.  </p>\n\n<p>If that analysis shows that yes, your arrays really need to be that big, then there are several ways to get around this problem, in increasing order of difficulty, and all with significant disadvantages:</p>\n\n<ol>\n\n<li>Add the <code>static</code> keyword to the declaration of <code>les_participants</code>:\n<pre><code>static Ens_participants les_participants;\n</code></pre>\nThis will set aside storage from somewhere other than the runtime stack (typically from within the program image, meaning your executable may get a little bigger).  The disadvantage of this is that only a single instance of <code>les_participants</code> is ever created, and it's created as soon as the program starts; you're not creating a <em>new</em> instance of the variable every time you enter the function declaring it.  If you only ever intend to have a single instance of it, though, this is probably the easiest way to go.\n\nIf you need to pass it to any function, you will <em>have</em> to pass a pointer to it whether the called function needs to modify the contents of it or not.\n<pre><code>void dump( Ens_participants *lp )\n{\n  for ( size_t i = 0; i cardinal; i++ )\n  {\n    printf( \"Participant %zu: nom %s, prenom %s\\n\", i, lp-tab[i].nom, lp->tab[i].prenom);\n    // print remaining fields\n  }\n}\n\nint main( void )\n{\n  static Ens_participants les_participants;\n  ...\n  dump( &les_participants );\n  ...\n}\n</code></pre>\n<li>Allocate <code>les_participants</code> dynamically using <code>malloc</code> or <code>calloc</code>.  Such a large request isn't guaranteed to succeed, though, especially if your heap is badly fragmented:\n<pre><code>int main( void )\n{\n  /**\n   * calloc initializes the allocated memory to all 0s, which is\n   * useful since you are going to be storing a lot of 0-terminated\n   * strings\n   */\n  Ens_participants *les_participants = calloc( NB_MAX_PARTICIPANTS, sizeof *les_participants );\n  if ( les_participants )\n  {\n    /**\n     * use the -> operator to access members of les_participants, like so:\n     */\n    les_participants->cardinal = some_value;\n    les_participants->tab[i].age = 24;\n    ...\n    /**\n     * Make sure to release the memory when you are done\n     */\n    free( les_participants );\n  }\n}\n</code></pre>\n<li>Declare the <code>tab</code> element of <code>Ens_participants</code> as an array of <em>pointers</em> to <code>Participant</code>, and dynamically allocate each instance of <code>Participant</code> as necessary:\n<pre><code>typedef struct \n{\n  int cardinal;\n  Participant *tab[NB_MAX_ENTRIES];\n} Ens_participants;\n\n/**\n * This particular implementation assumes that participant data\n * is manually entered from standard input\n */\nParticipant *newParticipant( void )\n{\n  /**\n   * Dynamically allocate a single instance of a Participant,\n   * calloc initializes all elements to 0\n   */\n  Participant *p = calloc( 1, sizeof *p );\n  if ( p )\n  {\n    printf( \"nom: \" );\n    fgets( p->nom, sizeof p->nom, stdin );\n    printf( \"prenom: \" );\n    fgets( p->prenom, sizeof p->prenom, stdin );\n    ...\n  }\n  return p;\n}\n\nint main( void )\n{\n  Ens_participants les_participants = {0}; // make sure everything is initialized to 0 or NULL.\n\n  printf( \"Add participant [y/n]: \" );\n  while ( tolower( getchar() ) == 'y' && les_participants.cardinal &lt; NB_MAX_ENTRIES )\n  {\n    les_participants.tab[les_participants.cardinal++] = newParticipant();\n    printf( \"Add another participant [y/n] \" );\n  }\n</code></pre>\n\nWhen you're done, you'll need to clean up after yourself:\n<pre><code>\nwhile ( les_participants.cardinal )\n  free( les_participants.tab[--les_participants.cardinal] );\n</code></pre>\n\nYou've traded the iffiness of the single large memory allocation for managing a bunch of smaller memory allocations.  The code is a bit more complex now, with more points of failure.  \n<li>Implement the <code>tab</code> element of <code>Ens_participants</code> as a list or tree, rather than an array.  This is a <em>lot</em> more work, and you may not be up for it (even a simple example would make this already-too-big answer unreadably huge).  Like the previous suggestion, you're making a bunch of smaller memory allocation requests rather than a single very large allocation request, with a bonus that you can order your entries as they're being inserted.  Extra bonus, you're not limited to a fixed number of entries (as in the previous suggestion).  This significantly increases the amount and complexity of the code you have to write, however.  \n  \n</ol>\n"}], "owner": {"reputation": 125, "user_id": 4858253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54b0918fe8a218917c631bf4f76db5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan N", "link": "https://stackoverflow.com/users/4858253/stefan-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2831, "favorite_count": 0, "accepted_answer_id": 37844053, "answer_count": 2, "score": 1, "last_activity_date": 1466035755, "creation_date": 1466017935, "last_edit_date": 1592644375, "question_id": 37843912, "link": "https://stackoverflow.com/questions/37843912/why-would-i-have-a-segmentation-fault-when-declaring-a-variable-in-a-c-program", "title": "Why would I have a segmentation fault when declaring a variable in a C program?", "body": "<p>After having a segmentation fault in a C program I am developing, I realized the error came from my declaration of a variable.</p>\n<p>It is the first time I tried to declare a variable of  data type Ens_participants defined below:</p>\n<pre><code>typedef struct \n{\n    int cardinal;\n    Participant tab[NB_MAX_PARTICIPANTS];\n} Ens_participants;\n</code></pre>\n<p>And Participant is another data type I created defined below:</p>\n<pre><code>typedef struct \n{ \n    char nom[TMAX_MOT];\n    char prenom[TMAX_MOT];\n    char email[TMAX_MOT];\n    char nationalite[TMAX_MOT];\n    char langues_parles[LMAX][TMAX_MOT];\n    char langues_cherches[LMAX][TMAX_MOT];\n    int age;\n    char sexe;\n    char universite[TMAX_MOT];\n    char disponible[TMAX_MOT];\n} Participant; \n</code></pre>\n<p>With TMAX_MOT, NB_MAX_PARTICIPANTS, and  LMAX being constants :</p>\n<pre><code>#define TMAX_MOT 250\n#define LMAX 500\n\n#define NB_MAX_PARTICIPANTS 1000\n</code></pre>\n<p>This is the line that cause my segmentation fault:</p>\n<pre><code>Ens_participants les_participants; \n</code></pre>\n<p>Did I properly create and declare these variables? How can a single declaration cause a segmentation fault? If it helps, with the gdb debugger, I was told that the error came two lines before this declaration :</p>\n<pre><code>int ligne_valide = 1;\n</code></pre>\n<p>However, this is false as the program worked well with the above line. It is as soon as I tried to declare this new variable that I started having issues.</p>\n<h1>UPDATE NO1</h1>\n<p>When I changed the value of the constant NB_MAX_PARTICIPANTS to 10 instead of 1000, the program compiled perfectly.</p>\n<h1>UPDATE NO2</h1>\n<p>I apologize for this question since, as @alk suggested, my problem lies elsewhere. I have rewritten just the types of the program and experimented. The problem is not where I thought it was. The variable definitions and declarations are not causing any issues in the new program.</p>\n"}, {"tags": ["c", "node.js", "linux"], "owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1466017371, "creation_date": 1466017371, "question_id": 37843761, "link": "https://stackoverflow.com/questions/37843761/having-node-stringprep-with-node-4-x", "title": "having node-stringprep with node 4.x", "body": "<p>I have this <code>package.json</code> no a <code>centos</code> box.</p>\n\n<pre><code>$cat package.json \n{\n  \"name\": \"module-name\",\n  \"version\": \"10.3.1\",\n  \"dependencies\": {\n    \"node-stringprep\": \"^0.7.0\"\n  }\n}\n</code></pre>\n\n<p>with node <code>0.12.6</code> i can run <code>npm install</code> with no problem.  I have to run it now due to circumstances under node <code>4.x</code> (I also tried with <code>node-stringprep 0.8.0</code> i tried with a few and with all of them i get error i understand that node-stringprep says: <code>\"node\": \"&gt;=0.8 &lt;=0.12\"</code> i'm still trying to have my server run while its dependant on it on node 4.x.</p>\n\n<p>error specifically for example <code>4.4.4</code>:</p>\n\n<pre><code># npm install\nnpm WARN package.json module-name@10.3.1 No description\nnpm WARN package.json module-name@10.3.1 No repository field.\nnpm WARN package.json module-name@10.3.1 No README data\nnpm WARN package.json module-name@10.3.1 No license field.\nnpm WARN engine node-stringprep@0.7.3: wanted: {\"node\":\"&gt;=0.8 &lt;=0.12\"} (current: {\"node\":\"4.4.4\",\"npm\":\"2.15.1\"})\n-\n&gt; node-stringprep@0.7.3 install /root/tmp/test/node_modules/node-stringprep\n&gt; node-gyp rebuild\nmake: Entering directory `/root/tmp/test/node_modules/node-stringprep/build'\n  CXX(target) Release/obj.target/node_stringprep/node-stringprep.o\nIn file included from ../node-stringprep.cc:1:0:\n../node_modules/nan/nan.h:261:25: error: redefinition of 'template&lt;class T&gt; v8::Local&lt;T&gt; _NanEnsureLocal(v8::Local&lt;T&gt;)'\n NAN_INLINE v8::Local&lt;T&gt; _NanEnsureLocal(v8::Local&lt;T&gt; val) {\n                         ^\n../node_modules/nan/nan.h:256:25: error: 'template&lt;class T&gt; v8::Local&lt;T&gt; _NanEnsureLocal(v8::Handle&lt;T&gt;)' previously declared here\n NAN_INLINE v8::Local&lt;T&gt; _NanEnsureLocal(v8::Handle&lt;T&gt; val) {\n                         ^\n../node_modules/nan/nan.h:661:13: error: 'node::smalloc' has not been declared\n     , node::smalloc::FreeCallback callback\n             ^\n../node_modules/nan/nan.h:661:35: error: expected ',' or '...' before 'callback'\n     , node::smalloc::FreeCallback callback\n                                   ^\n../node_modules/nan/nan.h: In function 'v8::Local&lt;v8::Object&gt; NanNewBufferHandle(char*, size_t, int)':\n../node_modules/nan/nan.h:665:50: error: 'callback' was not declared in this scope\n         v8::Isolate::GetCurrent(), data, length, callback, hint);\n                                                  ^\n../node_modules/nan/nan.h:665:60: error: 'hint' was not declared in this scope\n         v8::Isolate::GetCurrent(), data, length, callback, hint);\n                                                            ^\n../node_modules/nan/nan.h: In function 'v8::Local&lt;v8::Object&gt; NanNewBufferHandle(const char*, uint32_t)':\n../node_modules/nan/nan.h:672:67: error: call of overloaded 'New(v8::Isolate*, const char*&amp;, uint32_t&amp;)' is ambiguous\n     return node::Buffer::New(v8::Isolate::GetCurrent(), data, size);\n                                                                   ^\n../node_modules/nan/nan.h:672:67: note: candidates are:\nIn file included from ../node_modules/nan/nan.h:25:0,\n                 from ../node-stringprep.cc:1:\n/root/.node-gyp/4.4.4/include/node/node_buffer.h:31:40: note: v8::MaybeLocal&lt;v8::Object&gt; node::Buffer::New(v8::Isolate*, v8::Local&lt;v8::String&gt;, node::encoding) &lt;near match&gt;\n NODE_EXTERN v8::MaybeLocal&lt;v8::Object&gt; New(v8::Isolate* isolate,\n                                        ^\n/root/.node-gyp/4.4.4/include/node/node_buffer.h:31:40: note:   no known conversion for argument 3 from 'uint32_t {aka unsigned int}' to 'node::encoding'\n/root/.node-gyp/4.4.4/include/node/node_buffer.h:43:40: note: v8::MaybeLocal&lt;v8::Object&gt; node::Buffer::New(v8::Isolate*, char*, size_t) &lt;near match&gt;\n NODE_EXTERN v8::MaybeLocal&lt;v8::Object&gt; New(v8::Isolate* isolate,\n                                        ^\n/root/.node-gyp/4.4.4/include/node/node_buffer.h:43:40: note:   no known conversion for argument 2 from 'const char*' to 'char*'\nIn file included from ../node-stringprep.cc:1:0:\n../node_modules/nan/nan.h: In function 'v8::Local&lt;v8::Object&gt; NanNewBufferHandle(uint32_t)':\n../node_modules/nan/nan.h:676:61: error: could not convert 'node::Buffer::New(v8::Isolate::GetCurrent(), ((size_t)size))' from 'v8::MaybeLocal&lt;v8::Object&gt;' to 'v8::Local&lt;v8::Object&gt;'\n     return node::Buffer::New(v8::Isolate::GetCurrent(), size);\n                                                             ^\n../node_modules/nan/nan.h: In function 'v8::Local&lt;v8::Object&gt; NanBufferUse(char*, uint32_t)':\n../node_modules/nan/nan.h:683:12: error: 'Use' is not a member of 'node::Buffer'\n     return node::Buffer::Use(v8::Isolate::GetCurrent(), data, size);\n            ^\nmake: *** [Release/obj.target/node_stringprep/node-stringprep.o] Error 1\nmake: Leaving directory `/root/tmp/test/node_modules/node-stringprep/build'\ngyp ERR! build error \ngyp ERR! stack Error: `make` failed with exit code: 2\ngyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:276:23)\ngyp ERR! stack     at emitTwo (events.js:87:13)\ngyp ERR! stack     at ChildProcess.emit (events.js:172:7)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:200:12)\ngyp ERR! System Linux 2.6.32-573.3.1.el6.x86_64\ngyp ERR! command \"/usr/local/bin/node\" \"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\"\ngyp ERR! cwd /root/tmp/test/node_modules/node-stringprep\ngyp ERR! node -v v4.4.4\ngyp ERR! node-gyp -v v3.3.1\ngyp ERR! not ok \nnpm ERR! Linux 2.6.32-573.3.1.el6.x86_64\nnpm ERR! argv \"/usr/local/bin/node\" \"/usr/local/bin/npm\" \"install\"\nnpm ERR! node v4.4.4\nnpm ERR! npm  v2.15.1\nnpm ERR! code ELIFECYCLE\nnpm ERR! node-stringprep@0.7.3 install: `node-gyp rebuild`\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the node-stringprep@0.7.3 install script 'node-gyp rebuild'.\nnpm ERR! This is most likely a problem with the node-stringprep package,\nnpm ERR! not with npm itself.\nnpm ERR! Tell the author that this fails on your system:\nnpm ERR!     node-gyp rebuild\nnpm ERR! You can get information on how to open an issue for this project with:\nnpm ERR!     npm bugs node-stringprep\nnpm ERR! Or if that isn't available, you can get their info via:\nnpm ERR! \nnpm ERR!     npm owner ls node-stringprep\nnpm ERR! There is likely additional logging output above.\n</code></pre>\n\n<p>anyone knows if there is a way for me to resolve it?</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1466017213, "post_id": 37843706, "comment_id": 63147779, "body": "What exactly is stopping you from priniting it?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1466017383, "post_id": 37843706, "comment_id": 63147883, "body": "What&#39;s your input and the observed output?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1466017597, "post_id": 37843706, "comment_id": 63148001, "body": "Note: <code>return</code> is not a function, but a statement. The parenthesis are deprecated as they can shadow a typo and make the statement look like a function. They are actually part of the expression and serve no purpose. Don&#39;t use them for simple expressions (for more complicated they can enhance readbility, though)."}, {"owner": {"reputation": 31, "user_id": 6471146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ff23a5f8ff3757e15bb0885483df1c?s=128&d=identicon&r=PG&f=1", "display_name": "Alivarvan", "link": "https://stackoverflow.com/users/6471146/alivarvan"}, "edited": false, "score": 0, "creation_date": 1466017779, "post_id": 37843706, "comment_id": 63148106, "body": "i&#39;m not sure how to pass the entered character from main to convert. so convert can then be used to display the entered character."}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 2, "creation_date": 1466017861, "post_id": 37843706, "comment_id": 63148154, "body": "Your output (<a href=\"http://i.stack.imgur.com/Izl6f.jpg\" rel=\"nofollow noreferrer\">from the last screenshot</a>) looks correct to me. What&#39;s wrong? If you want to print from <code>convert</code> instead of <code>main</code>, you can move the <code>printf</code> from main to <code>convert</code> (replacing the <code>upper</code> variable by <code>result</code>), putting that line just before the <code>return</code>, and you&#39;re done."}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 1, "creation_date": 1466018123, "post_id": 37843706, "comment_id": 63148308, "body": "From your update, I see you&#39;re missing a <code>\\n</code>. If you don&#39;t use <code>\\n</code>, your output will be buffered and not printed immediately."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466022033, "post_id": 37843706, "comment_id": 63150408, "body": "Better to post textual versions of your output than pictures of text."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6471146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ff23a5f8ff3757e15bb0885483df1c?s=128&d=identicon&r=PG&f=1", "display_name": "Alivarvan", "link": "https://stackoverflow.com/users/6471146/alivarvan"}, "edited": false, "score": 0, "creation_date": 1466018288, "post_id": 37843943, "comment_id": 63148401, "body": "ohhh I see,I wrote those two lines but I was trying to call the function again in main() to have that printed. didn&#39;t know you could do that. thank you!"}, {"owner": {"reputation": 11856, "user_id": 2873538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gayoG.png?s=128&g=1", "display_name": "Ajeet Shah", "link": "https://stackoverflow.com/users/2873538/ajeet-shah"}, "reply_to_user": {"reputation": 31, "user_id": 6471146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ff23a5f8ff3757e15bb0885483df1c?s=128&d=identicon&r=PG&f=1", "display_name": "Alivarvan", "link": "https://stackoverflow.com/users/6471146/alivarvan"}, "edited": false, "score": 0, "creation_date": 1466018699, "post_id": 37843943, "comment_id": 63148616, "body": "You are using <code>upper = convert(lower);</code> in <code>main</code> to call <code>convert</code> function and passing the value of <code>lower</code> to this function. So, inside the function <code>convert</code>, you get a copy of value of <code>lower</code> in argument <code>a1</code> of this function."}], "tags": [], "owner": {"reputation": 11856, "user_id": 2873538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gayoG.png?s=128&g=1", "display_name": "Ajeet Shah", "link": "https://stackoverflow.com/users/2873538/ajeet-shah"}, "is_accepted": true, "score": 0, "last_activity_date": 1466018042, "creation_date": 1466018042, "answer_id": 37843943, "question_id": 37843706, "link": "https://stackoverflow.com/questions/37843706/passing-value-entered-by-user-in-main-to-another-function-using-c/37843943#37843943", "title": "Passing value entered by user in main() to another function using C", "body": "<p>You need to add below line-1 and line-2 to your function <code>convert</code>:</p>\n\n<pre><code>char convert(char a1)\n{\n    char result;\n    printf(\"Converting to uppercase ...\\n\");  // line-1\n    printf(\"(from function) Entered character is: %c\\n\", a1);  // line-2\n    result = toupper(a1);\n    return (result);\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Please enter a lowercase character: t\nConverting to uppercase ...\n(from function) Entered character is: t\n(from main) Uppercase character: T\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6471146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ff23a5f8ff3757e15bb0885483df1c?s=128&d=identicon&r=PG&f=1", "display_name": "Alivarvan", "link": "https://stackoverflow.com/users/6471146/alivarvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 37843943, "answer_count": 1, "score": 2, "last_activity_date": 1466018192, "creation_date": 1466017159, "last_edit_date": 1466018054, "question_id": 37843706, "link": "https://stackoverflow.com/questions/37843706/passing-value-entered-by-user-in-main-to-another-function-using-c", "title": "Passing value entered by user in main() to another function using C", "body": "<p>I am trying to write a C main() program with a function. the program asks for a character in main(), then passes it to a function which then prints the character entered and returns that character in uppercase to main(). In main() the new uppercase character is printed.</p>\n\n<p>I am able to read the character and convert it to uppercase, but can't get it to print the entered character from the function \"convert\". Here is what the output should look like:<a href=\"http://i.stack.imgur.com/tlXkb.jpg\" rel=\"nofollow\">Sample output</a>. Following is what I have done so far. Any help appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nchar convert(char a1);\n\nint main (void)\n{\n    char lower, upper;\n    printf(\"Please enter a lowercase character: \");\n    scanf(\"%c\",&amp;lower);\n\n    upper = convert(lower);\n    printf(\"(from main) Uppercase character: %c\\n\",upper);\n    return(0);\n}\nchar convert(char a1)\n{\n    char result;\n    printf(\"Entered character: %c\",lower); /*This statement is to be printed*/\n    result = toupper(a1);\n    return (result);\n}\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/Izl6f.jpg\" rel=\"nofollow\">Here is my output</a></p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466016563, "post_id": 37843509, "comment_id": 63147427, "body": "<code>struct node</code> is a type name. That&#39;s it."}], "answers": [{"tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": false, "score": 0, "last_activity_date": 1466016690, "creation_date": 1466016690, "answer_id": 37843565, "question_id": 37843509, "link": "https://stackoverflow.com/questions/37843509/use-of-struct-keyword-inside-of-struct/37843565#37843565", "title": "Use of struct keyword inside of struct", "body": "<p><code>struct node*</code> (note the <code>*</code>) is a <em>pointer</em> (<code>*</code>) to a <code>struct node</code>.  That means that one node can connect to another, via the pointer, without including the other.</p>\n\n<p>This is referred to as a \"linked list\" structure.  I found a <a href=\"http://cslibrary.stanford.edu/103/\" rel=\"nofollow\">Stanford University tutorial</a> that looks like it covers the subject fairly thoroughly.</p>\n"}, {"tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": false, "score": 5, "last_activity_date": 1466018920, "last_edit_date": 1466018920, "creation_date": 1466017058, "answer_id": 37843677, "question_id": 37843509, "link": "https://stackoverflow.com/questions/37843509/use-of-struct-keyword-inside-of-struct/37843677#37843677", "title": "Use of struct keyword inside of struct", "body": "<blockquote>\n  <p>In the code there is <code>struct node* next</code> inside the <code>struct node</code>. I\n  don't understand the meaning of it.</p>\n</blockquote>\n\n<p><strong>Explanation :</strong></p>\n\n<p>A <strong>node</strong> is a general term used to refer a <a href=\"http://www.how2lab.com/programming/c/link-list1.php\" rel=\"nofollow\"><strong>self referential structure</strong></a>.<em>(click on link to know more)</em></p>\n\n<p>and going by definition,</p>\n\n<blockquote>\n  <p>A <strong>self referential structure</strong> is a typical structure whose definition has one or\n  more of its member as a pointer to its own type.</p>\n</blockquote>\n\n<p>Here in your code <code>next</code> is such a member of the structure <code>struct node</code> which is a pointer to it's own type therefore you see it as a pointer to itself in this manner inside of struct :</p>\n\n<p><code>struct node* next;</code></p>\n\n<p>That's the reason why <strong>struct keyword is used inside of struct</strong></p>\n\n<hr>\n\n<p><strong>Purpose</strong> of using <strong>self referential structures</strong> : </p>\n\n<p><strong>self referential structures</strong> are very much helpful in building data structures such a <a href=\"https://en.wikipedia.org/wiki/Linked_list\" rel=\"nofollow\"><strong>linked lists</strong></a>... and in fact the variable <code>next</code> is the very member which is useful in making links between <strong>nodes</strong> in a <strong>linked list</strong>  :) </p>\n"}, {"tags": [], "owner": {"reputation": 250, "user_id": 4600108, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/9466b74b715909a4d9032ddaac51da58?s=128&d=identicon&r=PG&f=1", "display_name": "user905", "link": "https://stackoverflow.com/users/4600108/user905"}, "is_accepted": false, "score": 0, "last_activity_date": 1466018039, "creation_date": 1466018039, "answer_id": 37843941, "question_id": 37843509, "link": "https://stackoverflow.com/questions/37843509/use-of-struct-keyword-inside-of-struct/37843941#37843941", "title": "Use of struct keyword inside of struct", "body": "<p>In simple words, it means that next would also be of the same structure as that of node. So next will also have a field int n and another next.. Also this is dynamic so you don't have to allocate any memory before hand.. you can keep on adding as many node as you want ( you still have to assign memory to each node though -- search for how to use malloc to allocate memory to struct node )\nAnd as it is of pointer type ( struct node* next ) it means you can store the address of your next node in to it and link nodes..\nSee the linked list implementation for better understanding..\nI hope it helps :) </p>\n"}], "owner": {"reputation": 343, "user_id": 6430026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b74662c821862b4a7932c778e7fcdb93?s=128&d=identicon&r=PG&f=1", "display_name": "Deeven", "link": "https://stackoverflow.com/users/6430026/deeven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1466020613, "creation_date": 1466016537, "last_edit_date": 1466020613, "question_id": 37843509, "link": "https://stackoverflow.com/questions/37843509/use-of-struct-keyword-inside-of-struct", "title": "Use of struct keyword inside of struct", "body": "<pre><code>typedef struct node\n{\n    int n;\n    struct node* next;\n}\nnode;\n</code></pre>\n\n<p>In the above code there is <code>struct node* next</code> inside the <code>struct node</code>. I don't understand the meaning of it.</p>\n"}, {"tags": ["c", "file", "input"], "comments": [{"owner": {"reputation": 120, "user_id": 2781739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea8ff017a339a67c4bdb96d6ce22508?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Jain", "link": "https://stackoverflow.com/users/2781739/gaurav-jain"}, "edited": false, "score": 0, "creation_date": 1466016274, "post_id": 37843193, "comment_id": 63147255, "body": "what do you want to ask? could you be more clear?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1466016625, "post_id": 37843193, "comment_id": 63147466, "body": "You keep casting to and from <code>int</code>. Just stick with <code>int</code>, as returned by <code>getc</code>, for the function type too.."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466017933, "post_id": 37843193, "comment_id": 63148195, "body": "Just think twice want it could mean that you need to use the casting hammer here: <code>return (char) c;</code>. A general rule of thumb in C: If you see yourself confronted with the need to cast your are either dump or smart. Normally you need to cast only under <i>very rare</i> circumstances."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1466018220, "post_id": 37843193, "comment_id": 63148357, "body": "<code>getc()</code> returns an <code>int</code> by intention. Just not ignore this."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1466018652, "post_id": 37843193, "comment_id": 63148590, "body": "1) Insure <code>char read_character(FILE *infile)</code> is declared/defined before usage in <code>main()</code>.  2) Post content of the input file.  3) post output seen"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466061530, "post_id": 37843193, "comment_id": 63163440, "body": "this line: <code>while (ch != EOF) {</code> may or may not work, depending on if your C compiler implements a <code>signed char</code> or an <code>unsigned char</code> (due to sign extension if a signed char.)  Strongly suggest: 1) return an <code>int, from </code>read_character()` rather than a <code>char</code>.  Note: <code>EOF</code> is <code>-1</code> which is an <code>int</code>, not a <code>char</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466061684, "post_id": 37843193, "comment_id": 63163527, "body": "the posted code: 1) is missing the <code>#include</code> statements.  Are we expected to guess what the OP actually included?  2) The prototype for <code>read_character()</code> is missing, so the compiler will ( depends somewhat on the version of the C standard used) assume all passed parameters and returned value are <code>int</code> where the function is called."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466061785, "post_id": 37843193, "comment_id": 63163605, "body": "a <code>\\n</code> is not a printable character.  Strongly suggest using <code>%x</code> to print it."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1466017730, "post_id": 37843475, "comment_id": 63148077, "body": "With these changes there&#39;s no need for the <code>get_character</code> function in the first place, it&#39;s identical to <code>getc</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466017800, "post_id": 37843475, "comment_id": 63148121, "body": "This cast here <code>int d = (int)ch;</code> is useless."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1466017823, "post_id": 37843475, "comment_id": 63148128, "body": "@Barmer - true.  Not sure if more value to change here, or leave for OP to do."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466017854, "post_id": 37843475, "comment_id": 63148150, "body": "@alk - agree&#39;d, your are referring to the comment, right?  It is part of OPs original code.  I left in for contrast against changes."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466018007, "post_id": 37843475, "comment_id": 63148239, "body": "I am referring to the code you show."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466018112, "post_id": 37843475, "comment_id": 63148298, "body": "@alk - LOL, yes, I finally saw it, now commented.  Thanks."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1466018073, "last_edit_date": 1466018073, "creation_date": 1466016450, "answer_id": 37843475, "question_id": 37843193, "link": "https://stackoverflow.com/questions/37843193/reading-new-line-in-c/37843475#37843475", "title": "Reading new line in C", "body": "<p>You can detect a newline with minor changes to your existing code:</p>\n\n<pre><code>int main(void) {\n    FILE *fp;\n    fp = open_input_file();\n    if (fp != 0) {\n        int ch = read_character(fp);//change to int return (getc() returns int)\n        if(ch == '\\n') //A simple comparison here will detect newline\n        {\n            printf(\"Found Newline: %d\\n\", ch);\n        }\n        ///int d = (int)ch;// not necessary with current changes\n        while (ch != EOF) {\n            //printf(\"%d\\n\", d);\n            ch = read_character(fp);\n            if(ch == '\\n')//Note: ASCII for \\n is value 10, or hex A\n            {\n                printf(\"Found newline: %d\\n\", ch);\n            }\n\n            //d = (int)ch;\n        }\n    }\n    getch();\n    return 0;\n}\n\nint read_character(FILE *infile) \n{  //changed prototype to return int\n\n    int c;\n    c = getc(infile);\n\n    return c;//modified return value to int\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5901467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e936cf992349c3e1aa99c2c2827e1a97?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/5901467/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "closed_date": 1466018526, "answer_count": 1, "score": 0, "last_activity_date": 1466018073, "creation_date": 1466015542, "question_id": 37843193, "link": "https://stackoverflow.com/questions/37843193/reading-new-line-in-c", "closed_reason": "Duplicate", "title": "Reading new line in C", "body": "<p>So I'm currently trying to read a input file character by character and I'm trying to see when a new line occurs. I get all the characters fine, but instead of a '\\n' for a new line I get '\u00e1' or -97 if I cast it to an int. Here's my code and I'm using VS 2015.</p>\n\n<pre><code>int main(void) {\n    FILE *fp;\n    fp = open_input_file();\n    if (fp != 0) {\n        char ch = read_character(fp);\n        int d = (int)ch;\n        while (ch != EOF) {\n            printf(\"%d\\n\", d);\n            ch = read_character(fp);\n            d = (int)ch;\n        }\n    }\n    getch();\n    return 0;\n}\nchar read_character(FILE *infile) {\n\n    int c;\n    c = getc(infile);\n\n    return (char) c;\n}\n</code></pre>\n"}, {"tags": [".net", "c", "f#", "mono", "pinvoke"], "comments": [{"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 4, "creation_date": 1466015641, "post_id": 37843094, "comment_id": 63146870, "body": "<code>CallingConvention = CallingConvention.Cdecl</code> is exactly the correct solution (I doubt you want <code>SetLastError=true</code> but it shouldn&#39;t cause any problems). How are you actually invoking <code>wiringPiISR</code>? The most likely issue is that you are not correctly ensuring the lifetime of the delegate you pass in."}, {"owner": {"reputation": 119, "user_id": 3617057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1122680262/picture?type=large", "display_name": "Jack Chidley", "link": "https://stackoverflow.com/users/3617057/jack-chidley"}, "reply_to_user": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 0, "creation_date": 1466016032, "post_id": 37843094, "comment_id": 63147100, "body": "<code>let callback : ISRCallback =              ISRCallback(                 fun () -&gt;                 let now = NodaTime.SystemClock.Instance.Now                 hotWaterAgent.Update (agentEvent, now)             )</code>  the <code>now = NodaTime.SystemClock.Instance.Now                 hotWaterAgent.Update (agentEvent, now)</code> part must be OK because that is exactly how the working version does things"}, {"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 4, "creation_date": 1466016152, "post_id": 37843094, "comment_id": 63147177, "body": "To quote the answerer of your previous question, &quot;<i>You should keep in mind that delegates in .NET are subject to garbage collection. It is the responsibility of the developer to ensure that the delegate doesn&#39;t &quot;go out of scope&quot; until your native library no longer needs the function callback.</i>&quot; You&#39;re not doing this, so when the WiringPi library tries to call your function, it&#39;s been GCed and you get the segfault."}, {"owner": {"reputation": 119, "user_id": 3617057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1122680262/picture?type=large", "display_name": "Jack Chidley", "link": "https://stackoverflow.com/users/3617057/jack-chidley"}, "reply_to_user": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 0, "creation_date": 1466018567, "post_id": 37843094, "comment_id": 63148550, "body": "Hmmm... thus betraying my inexperience as I have no idea how to do that!"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1466052373, "post_id": 37843094, "comment_id": 63159222, "body": "To keep an object from garbage collection, put a reference to it in a field of some object that you know won&#39;t be collected itself. One obvious solution is a static field, but that may not be ideal."}, {"owner": {"reputation": 2663, "user_id": 797223, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/VKSSD.jpg?s=128&g=1", "display_name": "Bent Tranberg", "link": "https://stackoverflow.com/users/797223/bent-tranberg"}, "edited": false, "score": 1, "creation_date": 1466167654, "post_id": 37843094, "comment_id": 63218811, "body": "To keep a referenced object from garbage collection, call GC.KeepAlive with the reference. I like this best, because it&#39;s very obvious what you want to achieve. But Fyodor Soikin&#39;s suggestion also works of course."}, {"owner": {"reputation": 2697, "user_id": 83202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/67ae8cb38fcfb5b5609906c9d83dc15c?s=128&d=identicon&r=PG", "display_name": "Curt Nichols", "link": "https://stackoverflow.com/users/83202/curt-nichols"}, "edited": false, "score": 2, "creation_date": 1466189642, "post_id": 37843094, "comment_id": 63231632, "body": "GC.KeepAlive keeps the object referenced only up to the KeepAlive statement; past that it may be eligible for collection. For callbacks you likely need to manually keep a reference while the callback may be called."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 3617057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1122680262/picture?type=large", "display_name": "Jack Chidley", "link": "https://stackoverflow.com/users/3617057/jack-chidley"}, "is_accepted": true, "score": 1, "last_activity_date": 1466253829, "last_edit_date": 1495540351, "creation_date": 1466250409, "answer_id": 37896565, "question_id": 37843094, "link": "https://stackoverflow.com/questions/37843094/f-delegate-using-pinvoke-with-c-function-callback-on-linux-arm/37896565#37896565", "title": "F# delegate using pinvoke with C function callback on Linux / ARM", "body": "<p>The segmentation fault, as noted in the comments and as suggested in the answer to my original question, is caused by the garbage collection of the callback function.</p>\n\n<p>Adding <code>GC.StayAlive (MyFunctionDoingCallBack)</code> at the right place in my code makes it clear to anyone reviewing the code - me - when it is safe for the callback garbage collected.  This solution was easier than working out why the callback was going out of scope and thus how to keep it in scope.  I realise this reflects badly on me as a programmer ;-(.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/763724/dllimport-preserversig-and-setlasterror-attributes\">This answer</a> explains why SetLastError=false is correct.  The native code definitely does not return a Win32 Error, it's running on Linux anyway, so I'd only be getting garbage from the error code.</p>\n\n<p>Setting <code>CallingConvention.Cdecl</code> on the DLLImport attribute works.  Perhaps the quote \"<em>The clr supports only the std calling convention for marshalling function pointers</em>\" is wrong for my system (mono on Linux) or I misunderstood the quote.</p>\n\n<p>Setting <code>[&lt;UnmanagedFunctionPointer(CallingConvention.Cdecl)&gt;]</code> on the delegate appears to be redundant as is <code>EntryPoint = \"wiringPiISR\"</code> part of the <code>DLLImport</code> attribute.  For clarity I removed both. </p>\n\n<p>There is a series of articles about DDLImport and DLLExport on the <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20060727-04/?p=30333\" rel=\"nofollow noreferrer\">OldNewThing blog at MSDN</a></p>\n\n<p>Thanks  @FyodorSoikin,  @ildjarn, @BentTranberg, @CurtNichols and @vcsjones</p>\n"}], "owner": {"reputation": 119, "user_id": 3617057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1122680262/picture?type=large", "display_name": "Jack Chidley", "link": "https://stackoverflow.com/users/3617057/jack-chidley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 37896565, "answer_count": 1, "score": 4, "last_activity_date": 1466253829, "creation_date": 1466015227, "last_edit_date": 1495541775, "question_id": 37843094, "link": "https://stackoverflow.com/questions/37843094/f-delegate-using-pinvoke-with-c-function-callback-on-linux-arm", "title": "F# delegate using pinvoke with C function callback on Linux / ARM", "body": "<p>Can you help me use a C function, from F#, that expects a callback?  I am using F#, mono and Arch Linux, on the ARM processor based Raspberry Pi 2.</p>\n\n<p>My original problem, understanding the signature to use for the callback, was <a href=\"https://stackoverflow.com/questions/34030005/platform-invoke-f-callback-functions\">answered</a> which you can read for more context.</p>\n\n<p>I have reached an impasse.  When using the library, the program crashes with a segmentation fault.  </p>\n\n<p>I believe that this is because of a marshalling mismatch.  The \"the clr supports only the std calling convention for marshalling function pointers\" according to the book <em>Expert F# 3.0</em>.  The CLR assumes that the <em>callee will clean the stack</em> (StdCall) and the C library expects that the <em>caller will clean the stack</em> (Cdecl) according to the definition on <a href=\"https://msdn.microsoft.com/en-us/library/z6f9ef9d(vs.71).aspx\" rel=\"nofollow noreferrer\">MSDN</a>.  Hence the memory leak.</p>\n\n<p>Sadly, I can find no way to make the CLR use Cdecl for this delegate nor for C to use StdCall on an ARM processor.  I haven't written the C library but I do have access to the source code.</p>\n\n<p>Here is the function signature in C</p>\n\n<pre><code>int wiringPiISR (int pin, int edgeType,  void (*function)(void)) ;\n</code></pre>\n\n<p>and part of my F# code:</p>\n\n\n\n<pre class=\"lang-ml prettyprint-override\"><code>type ISRCallback = delegate of unit -&gt; unit\n\n[&lt;DllImport(wiringPiLib, EntryPoint = \"wiringPiISR\", CallingConvention = CallingConvention.Cdecl, SetLastError=true)&gt;]\n    extern int wiringPiISR(int pin, int mode, [&lt;MarshalAs(UnmanagedType.FunctionPtr)&gt;]ISRCallback callBack);\n</code></pre>\n\n<p>Decorating the delegate with <code>[&lt;UnmanagedFunctionPointer(CallingConvention.Cdecl)&gt;]</code> doesn't help.  The compiler silently ignores it, which I think is how these attributes are designed to work.</p>\n\n<p>Is there another way to do this - perhaps editing the C code, or wrapping it in another way?  (C++ perhaps?)</p>\n\n<p>Note: there is an interesting article on the mono-project website titled <a href=\"http://www.mono-project.com/docs/advanced/pinvoke/\" rel=\"nofollow noreferrer\">Interop with Native Libraries</a></p>\n\n<p>In the meantime, I have written a little loop to poll the GPIO pins.  Not ideal but it works.</p>\n\n<p><strong>EDIT:</strong> I was wrong in my memory leak assumption but, thanks to the comments and the research it prompted, I learnt a lot and found answers.</p>\n"}, {"tags": ["c", "data-structures", "hashtable"], "comments": [{"owner": {"reputation": 4759, "user_id": 5055063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pMVf4.jpg?s=128&g=1", "display_name": "Nick Zuber", "link": "https://stackoverflow.com/users/5055063/nick-zuber"}, "edited": false, "score": 0, "creation_date": 1466018464, "post_id": 37843090, "comment_id": 63148504, "body": "Did you try using a debugger?"}, {"owner": {"reputation": 113, "user_id": 4872584, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/95f973554a76efdd77533e620ecdc7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chihaia", "link": "https://stackoverflow.com/users/4872584/alex-chihaia"}, "reply_to_user": {"reputation": 4759, "user_id": 5055063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pMVf4.jpg?s=128&g=1", "display_name": "Nick Zuber", "link": "https://stackoverflow.com/users/5055063/nick-zuber"}, "edited": false, "score": 0, "creation_date": 1466019278, "post_id": 37843090, "comment_id": 63148942, "body": "@NickZuber Yes, i did, and i see that after deleting memory list remains with 0xdddd and that;s why i am getting error. I mean that block of free functions in stergeNodHashTable function"}, {"owner": {"reputation": 113, "user_id": 4872584, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/95f973554a76efdd77533e620ecdc7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chihaia", "link": "https://stackoverflow.com/users/4872584/alex-chihaia"}, "reply_to_user": {"reputation": 4759, "user_id": 5055063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pMVf4.jpg?s=128&g=1", "display_name": "Nick Zuber", "link": "https://stackoverflow.com/users/5055063/nick-zuber"}, "edited": false, "score": 0, "creation_date": 1466019359, "post_id": 37843090, "comment_id": 63149005, "body": "@NickZuber I want to say that my list is not going null, after free even if i put it null(hash.vector[pozitie]=NULL)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1466019509, "post_id": 37843090, "comment_id": 63149085, "body": "<code>void main</code> is wrong. <code>while (!feof(...))</code> is wrong."}], "owner": {"reputation": 113, "user_id": 4872584, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/95f973554a76efdd77533e620ecdc7ea?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Chihaia", "link": "https://stackoverflow.com/users/4872584/alex-chihaia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466015218, "creation_date": 1466015218, "question_id": 37843090, "link": "https://stackoverflow.com/questions/37843090/trying-to-delete-all-the-elements-from-hashtable-with-the-status-marked-as-close", "title": "Trying to delete all the elements from HashTable with the status marked as closed", "body": "<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\n\nenum Stare {DESCHIS=10, LUCRU=20, DUPLICAT=30, REZOLVAT=40, INCHIS=50};\nstruct Task\n{\n\n    char *idTask;\n    char *data;\n    char *numeInginer;\n    int nivelComplexitate;\n    Stare stare;\n};\n\nstruct List\n{\n    Task *task;\n    List*next;\n};\n\nstruct HashTable\n{\n    List** vector;\n    int size;\n\n};\n\nList* creareNodLista(Task *task)\n{\n    List*nod = (List*)malloc(sizeof(List));\n    nod-&gt;task = task;\n    nod-&gt;next = NULL;\n    return nod;\n}\n\nvoid initHashTable(HashTable &amp;hTable, int size)\n{\n    hTable.vector = (List**)malloc(sizeof(List*)*size);\n    hTable.size = size;\n    memset(hTable.vector, 0, sizeof(List*)*size);\n}\n\nint fhash(char c, int l)\n{\n    return c%l;\n}\n\nvoid inserareNodLista(List*&amp;list, List*nod)\n{\n    nod-&gt;next = list;\n    list = nod;\n}\n\nvoid inserareNodHashTable(HashTable hTable, List*nod)\n{   //determinarea pozitiei pe care se face inserarea\n    int index = fhash(nod-&gt;task-&gt;numeInginer[0],hTable.size);\n    //obtinerea listei in care se face inserarea\n    List*list = hTable.vector[index];\n    //inserare element nou in lista\n    inserareNodLista(list, nod);\n    //actualizare element in hashTable\n    hTable.vector[index] = list;\n\n}\n\nList* getHashTable(HashTable ht, char cheie)\n{\n    int f = fhash(cheie, ht.size);\n    return ht.vector[f];\n}\n\nvoid printHashTable(HashTable ht)\n{\n    for (char c = 'A'; c &lt; 'Z'; c++)\n    {\n        List*lista = getHashTable(ht, c);\n        int count = 0;\n        while (lista)\n        {   \n            count++;\n            printf(\"%d\", count);\n            printf(\"%s\\n\", lista-&gt;task-&gt;idTask);\n            printf(\"%s\\n\", lista-&gt;task-&gt;data);\n            printf(\"%s\\n\", lista-&gt;task-&gt;numeInginer);\n            printf(\"%d\\n\", lista-&gt;task-&gt;nivelComplexitate);\n            printf(\"%d\\n\", lista-&gt;task-&gt;stare);\n            lista = lista-&gt;next;\n        }\n        if (count&gt;1)\n            printf(\"\\nColiziune\\n\\n\");\n    }\n}\n\nint stergeNodHashTable(HashTable hTable, char*numeInginer)\n{\n    int pozitie = 0;\n    pozitie = fhash(numeInginer[0], hTable.size);\n    if (hTable.vector[pozitie] == NULL)\n        return -1;\n    else\n    {\n        if (strcmp(hTable.vector[pozitie]-&gt;task-&gt;numeInginer, numeInginer) == 0)\n        {\n            if (hTable.vector[pozitie]-&gt;next == NULL)\n            {\n                free(hTable.vector[pozitie]-&gt;task-&gt;idTask);\n                free(hTable.vector[pozitie]-&gt;task-&gt;data);\n                free(hTable.vector[pozitie]-&gt;task-&gt;numeInginer);\n                free(hTable.vector[pozitie]-&gt;task);\n                free(hTable.vector[pozitie]);\n                hTable.vector[pozitie] = NULL;\n            }\n            else\n            {\n                List*lista = hTable.vector[pozitie];\n                hTable.vector[pozitie] = lista-&gt;next;\n                free(lista-&gt;task-&gt;idTask);\n                free(lista-&gt;task-&gt;data);\n                free(lista-&gt;task-&gt;numeInginer);\n                free(lista-&gt;task);\n                free(lista);\n                lista-&gt;next = NULL;\n                lista = NULL;\n            }\n        }\n        else\n        {\n            List*tmp = hTable.vector[pozitie];\n            while (tmp-&gt;next != NULL &amp;&amp; strcmp(tmp-&gt;next-&gt;task-&gt;numeInginer, numeInginer) != 0)\n                tmp = tmp-&gt;next;\n            List*list = tmp-&gt;next;\n            if (list-&gt;next == NULL)\n            {\n                free(list-&gt;task-&gt;idTask);\n                free(list-&gt;task-&gt;numeInginer);\n                free(list-&gt;task-&gt;data);\n                free(list-&gt;task);\n                free(list);\n                tmp-&gt;next = NULL;\n                list = NULL;\n\n            }\n            else\n            {\n                List*tmp = list;\n                list = list-&gt;next;\n                free(tmp-&gt;task-&gt;idTask);\n                free(tmp-&gt;task-&gt;data);\n                free(tmp-&gt;task-&gt;numeInginer);\n                free(tmp-&gt;task);\n                free(tmp);\n                tmp-&gt;next = NULL;\n                tmp = NULL;\n            }\n        }\n    }\n    return pozitie;\n\n}\n\n\nvoid main()\n{\n    FILE *pFile = fopen(\"Text.txt\", \"r\");\n    Task *task = NULL;\n    HashTable ht;\n    initHashTable(ht, 29);\n    if (pFile)\n    {\n        while (!feof(pFile))\n        {\n            task = (Task*)malloc(sizeof(Task));\n            char id[50];\n            fscanf(pFile, \"%s\", &amp;id);\n            task-&gt;idTask = (char*)malloc(strlen(id) + 1);\n            strcpy(task-&gt;idTask, id);\n            char data[50];\n            fscanf(pFile, \"%s\", data);\n            task-&gt;data = (char*)malloc(strlen(data) + 1);\n            strcpy(task-&gt;data, data);\n            char numeInfiner[50];\n            fscanf(pFile, \"%s\", numeInfiner);\n            task-&gt;numeInginer = (char*)malloc(strlen(numeInfiner) + 1);\n            strcpy(task-&gt;numeInginer, numeInfiner);\n            fscanf(pFile, \"%d\", &amp;task-&gt;nivelComplexitate);\n            fscanf(pFile, \"%d\", &amp;task-&gt;stare);\n            //creare element lista\n            List*nod = creareNodLista(task);\n            //inserare element in hashTable\n            inserareNodHashTable(ht, nod);\n\n        }\n        fclose(pFile);\n        for (char c = 'A'; c &lt; 'Z'; c++)\n        {\n            List *lista = getHashTable(ht, c);\n\n                while (lista)\n                {\n                    if (lista-&gt;task-&gt;stare == 50)\n\n                        stergeNodHashTable(ht, lista-&gt;task-&gt;numeInginer);\n\n\n                }\n\n\n        }\n        printHashTable(ht);\n    }\n\n}\n</code></pre>\n\n<p>I am trying to delete from hashTable all the elements with status marked as closed. The delete function is working fine but when i call it for al the hashtable, it got me error: lista->task was 0xDDDDDD. I cant understand why. Please help me!</p>\n\n<p><a href=\"https://i.stack.imgur.com/WoIo6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WoIo6.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466015478, "post_id": 37842945, "comment_id": 63146761, "body": "I don&#39;t understand why you need to concatenate each song title with the playlist number. Seeing as the playlist number must be a single digit (or you won&#39;t be able to distinguish playlist num and title), the max number of playlists is 10, which can be the index of each array of titles. So <code>array[3][0]</code> would be a pointer to the first song in playlist 3, etc."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466015641, "post_id": 37842945, "comment_id": 63146871, "body": "BTW better not to hardcode the <code>newline</code> character, better to have <code>token = strtok(plBuffer, &quot;\\n&quot;);</code>"}, {"owner": {"reputation": 123, "user_id": 4904392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7nnQf.png?s=128&g=1", "display_name": "jc__", "link": "https://stackoverflow.com/users/4904392/jc"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466015643, "post_id": 37842945, "comment_id": 63146873, "body": "The max number of playlists will be 4. The user will select one of the four playlists or all of the play lists to do the &#39;work&#39; on. I am thinking that I could do a &#39;if&#39; against the first char (the playlist) to determine if work need to be done against that playlist."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466015821, "post_id": 37842945, "comment_id": 63146977, "body": "I see the problem of using a jagged list though. Perhaps better to have an array of 4 <code>struct</code> which tells you the number of songs in each playlist, the max number that can be held, and an array of pointers to those titles, which can be <code>realloc</code>ed when they grow. Those pointers could be set by <code>strdup(token);</code>"}, {"owner": {"reputation": 123, "user_id": 4904392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7nnQf.png?s=128&g=1", "display_name": "jc__", "link": "https://stackoverflow.com/users/4904392/jc"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466015956, "post_id": 37842945, "comment_id": 63147059, "body": "So... What would be the 2nd song in playlist 3? Not array[3][1] because that would be the second char of the first song..."}, {"owner": {"reputation": 123, "user_id": 4904392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7nnQf.png?s=128&g=1", "display_name": "jc__", "link": "https://stackoverflow.com/users/4904392/jc"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466016077, "post_id": 37842945, "comment_id": 63147128, "body": "Am I correct in thinking that if I have an array of pointers to the song name I would need an variable for that name first? example song 5 on playlist 2 would need a variable to hold the name $song53..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1466016362, "post_id": 37842945, "comment_id": 63147311, "body": "It is getting too complicated without actually writing it for you. But I suggest an array of structs."}, {"owner": {"reputation": 123, "user_id": 4904392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7nnQf.png?s=128&g=1", "display_name": "jc__", "link": "https://stackoverflow.com/users/4904392/jc"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466016631, "post_id": 37842945, "comment_id": 63147474, "body": "Thanks for your time. @Weather Vane. Please someone correct me if I am wrong, but In a struct one of the items would be an array of pointers to the song titles. Since I do not know the number of songs in the list I cannot create a spot for the song title array to point to... I need to grasp the theory first. Maybe not. Reading more."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1466016771, "post_id": 37842945, "comment_id": 63147555, "body": "You <code>malloc</code> the array first, and then <code>realloc</code> the array when you run out."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466019591, "post_id": 37842945, "comment_id": 63149136, "body": "The code misses to allocate space for the C-&quot;string&quot;&#39;s <code>0</code>-terminator here: <code>array_playlist[array_length_working] = calloc(song_name_length, sizeof(char));</code> <i>sigh</i> Use <code>array_playlist[array_length_working] = calloc(song_name_length + 1, 1);</code> <code>sizeof(char)</code> is <code>1</code> by definition. Or do <code>array_playlist[array_length_working] = calloc(song_name_length + 1, sizeof  *array_playlist[array_length_working] ;</code>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466019831, "post_id": 37842945, "comment_id": 63149269, "body": "Also you want to initialise <code>array_length_working</code> to <code>0</code> like this <code>int array_length_working = 0;</code> C does not necessarily do the for you,"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466019917, "post_id": 37842945, "comment_id": 63149308, "body": "And finally make all those <code>int</code> typed index-counters <code>size_t</code>, or, if not available, make them at least <code>unsigned</code>. You do not need negative indexes."}, {"owner": {"reputation": 123, "user_id": 4904392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7nnQf.png?s=128&g=1", "display_name": "jc__", "link": "https://stackoverflow.com/users/4904392/jc"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1466102120, "post_id": 37842945, "comment_id": 63190785, "body": "Thank you @alk for the corrections, and yes it now works."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 4904392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7nnQf.png?s=128&g=1", "display_name": "jc__", "link": "https://stackoverflow.com/users/4904392/jc"}, "edited": false, "score": 0, "creation_date": 1466102006, "post_id": 37844159, "comment_id": 63190730, "body": "Thank you so much for taking the time to explain something that I need to know."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1466018871, "creation_date": 1466018871, "answer_id": 37844159, "question_id": 37842945, "link": "https://stackoverflow.com/questions/37842945/populating-a-jagged-char-array-in-c-from-an-unknow-size-list/37844159#37844159", "title": "Populating a jagged char array in C from an unknow size list", "body": "<p>This shows how you might build an array of play lists, each containing an array of song titles. It's not good practice to use global arrays, but for simplicity I have done so.</p>\n\n<p>Each playlist has an array of song title pointers. When that array is full, it is extended. In practice the program would be more efficient with a larger value for <code>SONGS</code>.</p>\n\n<p>I leave you to extract the data from file. Because the titles pointed to by your <code>token</code> will get overwritten, I used <code>strdup</code> or <code>_strdup</code> in MSVC (which calls <code>malloc</code>) to make a copy of each title. At the end of your program, you should iterate the array, to <code>free</code> each title's memory, and then <code>free</code> each pointer array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define LISTS   4                   // number of play lists\n#define SONGS   3                   // incremental number of songs per list\n\ntypedef struct {\n    int numsongs;                   // number of songs in list\n    int maxsongs;                   // maximum possible songs in list\n    char **song;                    // base of array of pointers\n} list_t;\n\nlist_t lib[LISTS] = { {0} };\n\nvoid addsong(int listnum, char *title)\n{\n    list_t *ptr;\n    char **arr;\n    if (listnum &lt; 1 || listnum &gt; LISTS) {\n        exit(1);                    // or other error checking\n    }\n    ptr = &amp;lib[listnum-1];          // for convenience, and arrays are 0-based\n    if (ptr-&gt;numsongs &gt;= ptr-&gt;maxsongs) {\n        // extend the song titles array\n        arr = realloc(ptr-&gt;song, (ptr-&gt;maxsongs + SONGS) * sizeof(char*));\n        if(arr == NULL) {\n            exit(1);                // or other error checking\n        }\n        ptr-&gt;song = arr;            // new bigger array\n        ptr-&gt;maxsongs += SONGS;     // more capacity\n    }\n    // save a pointer to a copy of the song title\n    ptr-&gt;song[ ptr-&gt;numsongs ] = _strdup(title); \n    ptr-&gt;numsongs++;\n}\n\nint main(void)\n{\n    int i, j;\n\n    // add songs to playlists in random order\n    addsong(2, \"Song two/one\");\n    addsong(1, \"Song one/one\");\n    addsong(4, \"Song four/one\");\n    addsong(2, \"Song two/two\");\n    addsong(1, \"Song one/two\");\n    addsong(2, \"Song two/three\");\n    addsong(2, \"Song two/four\");\n    addsong(2, \"Song two/five\");\n    addsong(1, \"Song one/three\");\n\n    // show what we've got\n    for(i=0; i&lt;LISTS; i++) {\n        printf(\"Playlist %d\\n\", i + 1);\n        for(j=0; j&lt;lib[i].numsongs; j++) {\n            printf(\"   %s\\n\", lib[i].song[j]);\n        }\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>Playlist 1\n   Song one/one\n   Song one/two\n   Song one/three\nPlaylist 2\n   Song two/one\n   Song two/two\n   Song two/three\n   Song two/four\n   Song two/five\nPlaylist 3\nPlaylist 4\n   Song four/one\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4904392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7nnQf.png?s=128&g=1", "display_name": "jc__", "link": "https://stackoverflow.com/users/4904392/jc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 37844159, "answer_count": 1, "score": 1, "last_activity_date": 1466018871, "creation_date": 1466014749, "question_id": 37842945, "link": "https://stackoverflow.com/questions/37842945/populating-a-jagged-char-array-in-c-from-an-unknow-size-list", "title": "Populating a jagged char array in C from an unknow size list", "body": "<p><strong>C program.</strong> \nWill be compiled for linux 32 bit and windows 32 bit.</p>\n\n<pre><code>gcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4\n\ni686-w64-mingw32-gcc (GCC) 4.8.2\n</code></pre>\n\n<p><strong>Goal:</strong></p>\n\n<p>To break a single char array that contains a list of songs into an multi-dimensional char array.\nI will 'walk' this array and compare to another list then do 'work' on it such as delete songs or convert songs.</p>\n\n<p><em>buffer and song names are an unknown size.</em></p>\n\n<p>buffer contains \u201c[playlist1]\\n12345\\n54321\\n[playlist2]\\n6789\\n9876\\n[playlist3]\\nlonger song name\\n\u201d</p>\n\n<p><em>Need an array that contains the playlist # and the song name.</em></p>\n\n<p>112345</p>\n\n<p>154321</p>\n\n<p>26789</p>\n\n<p>29876</p>\n\n<p>3longer song name</p>\n\n<p>array[0][0] should contain 1 (int 48)</p>\n\n<p>array[0][2] should contain 2 (int 50)\n...</p>\n\n<p><strong>Work:</strong></p>\n\n<p>I have counted the number of \u2018\\n\u2019 to get an array total row size (ignore the \u201c[playlist1] for now)</p>\n\n<pre><code>int array_length_all_songs = 0;\nint index;\nfor (index = 0; index&lt;plLength; index++)\n{\n    if (plBuffer[index] == '\\n')\n    {\n        array_length_all_songs++;\n    }\n}\n</code></pre>\n\n<p>created an array of char type</p>\n\n<pre><code>char **array_playlist = calloc(array_length_all_songs, sizeof(char *));\n</code></pre>\n\n<p>populate array</p>\n\n<pre><code>char *token; /* \"\\x0a\" == \"\\n\"  */\nchar pl_num; /* remember a char is an int */\nint array_length_working;\nint song_name_length;\ntoken = strtok(plBuffer,\"\\x0a\");\nwhile(token != NULL)\n    /* set playlist number */\n    if(strncmp(token,\"[Playlist\",9) == 0)\n    {\n        //printf(\"token: %s\\n\",token);\n        pl_num = (unsigned char)token[9];\n        //printf(\"pl: %c\\n\",pl_num);\n    }\n    else\n    {\n        array_length_working++;\n\n        switch (pl_num)\n        {\n            case '1':\n                if(strncmp(token,\"[Playlist\",9) != 0)\n                {\n                    song_name_length = strlen(token);\n                    array_playlist[array_length_working] = calloc(song_name_length, sizeof(char));\n                    strcpy(&amp;array_playlist[array_length_working], token);\n\n                }   \n                break;\n            case '2':\n</code></pre>\n\n<p>...</p>\n\n<p>This code does not work because of pointer and type casting that I am struggling with.</p>\n\n<pre><code>strcpy(&amp;array_playlist[array_length_working], token);\n</code></pre>\n\n<p>I have decided on this method of creating the array even though I must walk the buffer once to get a size.\nI believe this method is called an <em>Iliffe vector</em>.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Am I approaching this all wrong or inefficient for memory limited computers?</p>\n\n<p>if not...</p>\n\n<p>I need to figure out how to copy the $token to the array $array[123][0]\nsince the token is an array of characters (int) must I copy each character or can I copy the whole \u2018string\u2019 into the new location?</p>\n\n<p>I cannot create a variable on the fly $song1 so I cannot put the pointer of the song name into the array. Therefor I must copy the all the individual char to the array. $array[123][n++]. Right?</p>\n\n<p>I have hacked around with programming for many years, but c programming is new to me and seems to require a different way of thinking, and I am still working on that.</p>\n\n<p>I have read so many books and help questions but I seem to be going in circles.</p>\n\n<p>If my approach is wrong an over view might help.</p>\n"}, {"tags": ["c", "microcontroller", "cortex-m", "jtag", "segger-jlink"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466013573, "post_id": 37842538, "comment_id": 63145722, "body": "Probably you have some kind of hardware or configuration problem. But it would be nearly impossible to diagnose it here."}, {"owner": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "edited": false, "score": 0, "creation_date": 1466055763, "post_id": 37842538, "comment_id": 63160379, "body": "What kind of software is running in it ? Can you try to program it with a very simple software and to reprogram it without to hold the reset button ? There are some power states where the debug interface is not available until you reset the uC."}, {"owner": {"reputation": 458, "user_id": 5312070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e7f26feb830b626b459d5122315035?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Esaulenko", "link": "https://stackoverflow.com/users/5312070/alexey-esaulenko"}, "edited": false, "score": 0, "creation_date": 1466181145, "post_id": 37842538, "comment_id": 63227319, "body": "1. please describe your hardware. what lines connected to debugger?"}, {"owner": {"reputation": 458, "user_id": 5312070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e7f26feb830b626b459d5122315035?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Esaulenko", "link": "https://stackoverflow.com/users/5312070/alexey-esaulenko"}, "edited": false, "score": 0, "creation_date": 1466182490, "post_id": 37842538, "comment_id": 63228023, "body": "2. Try J-Flash tool, it has a friendly GUI. For example, in command-line J-Link utility, for writing data to flash, you should repeat sequences like in-application-programming: write your data to RAM, and then write command to specific registers in flash controller (see &quot;Flash Memory Module&quot; section in Freescale Reference Manual)."}], "owner": {"reputation": 341, "user_id": 3361380, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ce454f53dea3c037b3cd33c8a7e8cb1b?s=128&d=identicon&r=PG&f=1", "display_name": "realityinabox", "link": "https://stackoverflow.com/users/3361380/realityinabox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 458, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1584304999, "creation_date": 1466013467, "last_edit_date": 1584304999, "question_id": 37842538, "link": "https://stackoverflow.com/questions/37842538/trying-to-flash-a-k64f-cpu-could-not-be-halted", "title": "Trying to flash a K64F, CPU Could Not Be Halted", "body": "<p>I am trying to program a Cortex M4 that was placed on a custom board.  The processor is the MK64FN1M0VLL12.  I wrote the code using the FRDM-K64F dev board, which uses OpenSDA to load the bin via USB. The code was written in mbed, which as far as I know doesn\u2019t have any support for loading the program to the processor.   For the production board, I was planning on loading the program via a J-Link programmer, since I didn\u2019t include the OpenSDA interface.</p>\n\n<p>Using the J-Link Commander tool, I\u2019ve found that I have to hold the reset button down on the board in order to get any sort of response.  When I don\u2019t hold down reset, I get the follow: \n<a href=\"https://i.stack.imgur.com/ERoSB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ERoSB.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I do hold down reset, I get:\n<a href=\"https://i.stack.imgur.com/xkTDq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xkTDq.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I try to load the bin, I get messages about the CPU not halting.  I get this whether I\u2019m still holding down reset or not:\n<a href=\"https://i.stack.imgur.com/G17B6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G17B6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The O.K. message is a little misleading.  I tried uploading a program with just a blinking LED, but the LED isn\u2019t blinking.  </p>\n\n<p>I\u2019m not sure where to go from here.  Several days of Googling hasn\u2019t led me anywhere fruitful.</p>\n"}, {"tags": ["c", "pthreads", "semaphore"], "comments": [{"owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 4, "creation_date": 1466011694, "post_id": 37841932, "comment_id": 63144740, "body": "Please show us <a href=\"http://stackoverflow.com/help/mcve\">an MVCE</a>, and check for errors.  Perhaps <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/sem_getvalue.html\" rel=\"nofollow noreferrer\"><code>sem_getvalue</code></a> is returning ENOSYS (because you&#39;re on, e.g., OS X) or EINVAL (because the semaphore is not initialized correctly or is otherwise corrupted)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1466013666, "post_id": 37841932, "comment_id": 63145776, "body": "Your code works for me when I put a complete program around it."}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1466019758, "post_id": 37841932, "comment_id": 63149230, "body": "@JohnBollinger Any idea what could be causing this problem ??"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 0, "creation_date": 1466020304, "post_id": 37841932, "comment_id": 63149513, "body": "Play, @pilcrow has already given you some likely suggestions.  Have you checked them?"}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1466023108, "post_id": 37841932, "comment_id": 63150945, "body": "@JohnBollinger just did"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1466025946, "post_id": 37841932, "comment_id": 63152351, "body": "I am not sure your question makes sense. You have a thread waiting on a semaphore, and you seem to be upset when that semaphore becomes available. But why?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1466026608, "post_id": 37841932, "comment_id": 63152654, "body": "Another comment: You seem to be using sem_getvalue for reasons other than debugging and statistics ... you can&#39;t do that. A semaphore is an atomic integer, essentially. By the time your code has read its value with sem_getvalue, it could have been incremented or decremented an arbitrary number of times by other threads. And if you have protected it with a mutex lock, then just use an ordinary integer. If you are trying to do lock-free programming you&#39;ll need a lot more than semaphores, this code here is not even close."}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1466033406, "post_id": 37841932, "comment_id": 63154810, "body": "@ZanLynx  Thanks. yeah, just for debugging. Because it was my goal, now I need to change it without touching ConsumerFunc. I need to fill the whole buffer and empty it entirely before pass the processor to the other..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1466034155, "post_id": 37841932, "comment_id": 63155024, "body": "The only way to change the behavior without changing <code>ConsumerFunc()</code> is to defer starting the thread in which <code>ConsumerFunc()</code> runs until after <code>ProducerFunc()</code> has filled the buffer.  And of course that only works for the first fill.  One thread cannot unilaterally force another thread to cooperate."}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1466034545, "post_id": 37841932, "comment_id": 63155117, "body": "@JohnBollinger I&#39;m trying to re-do the <code>ConsumerFunc()</code> then apply it to the previous goal (same thing but no need to consume and fill the whole buff at each interation)."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1466097045, "last_edit_date": 1466097045, "creation_date": 1466026409, "answer_id": 37846160, "question_id": 37841932, "link": "https://stackoverflow.com/questions/37841932/how-can-i-prevent-a-thread-from-decrementing-a-semaphore-until-another-thread-is/37846160#37846160", "title": "How can I prevent a thread from decrementing a semaphore until another thread is ready?", "body": "<p>The whole point of waiting on a semaphore is that the thread doing so can proceed immediately as soon as the semaphore's value is greater than zero.  Therefore, if you don't want the consumer to proceed immediately when the producer posts to your semaphore, then you must ensure that the consumer is not waiting on that semaphore at that time.</p>\n\n<p>I suspect that you are trying to use semaphores in a way that they are not designed to support.  The <em>only</em> information that a semaphore's value should be interpreted to convey is the number of times that semaphore can be decremented before the next increment without blocking.  It is generally a bad idea to try to make any further interpretation of that data.  Moreover, that data must be considered stale as soon as it is returned.  Use shared variables (accessed with appropriate synchronization) to convey any other needed data.</p>\n\n<p>With that said, you do have a second semaphore that you name \"mutex\".  The details of what you're doing with it look pretty fishy, but if you really want to prevent the consumer from proceeding until the producer is ready, and the producer's readiness is not adequately conveyed by the <code>sem_posTaken</code> semaphore, then the immediately apparent solution is to use a separate semaphore to do so -- maybe <code>mutex</code>.</p>\n"}], "owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1466097045, "creation_date": 1466011485, "last_edit_date": 1466025489, "question_id": 37841932, "link": "https://stackoverflow.com/questions/37841932/how-can-i-prevent-a-thread-from-decrementing-a-semaphore-until-another-thread-is", "title": "How can I prevent a thread from decrementing a semaphore until another thread is ready?", "body": "<p>I'm doing a <code>sem_post()</code> inside a loop but it does not appear to increase the target semaphore's value.  Here's the code:</p>\n\n<pre><code>void* producerFunc(void* arg)\n{\n    int x, d, i, semValue, semTaken;\n\n    sem_getvalue(&amp;sem_posTaken, &amp;semTaken);\n    sem_getvalue(&amp;sem_posAvaliable, &amp;semValue);\n    while(n_insertions &lt; N_PRODUCTS)\n    {\n        sem_wait(&amp;sem_posAvaliable);    //Verifica se tem espa\u00e7o vazio no buffer\n        sem_getvalue(&amp;sem_posAvaliable, &amp;semValue);\n        x = produce_item();\n        sem_wait(&amp;db);\n        insert_buffer(x);\n        sem_post(&amp;db);\n\n        printf(\"n_insertions: %d\\n\", n_insertions);\n        if(n_insertions % 5 == 0){\n            sem_getvalue(&amp;sem_posTaken, &amp;semValue);\n            for(i=0; i&lt; Buffer_Size; i++)\n            {\n                sem_getvalue(&amp;sem_posTaken, &amp;semTaken);\n                printf(\"VOU DAR POST %d\\n\", semTaken);\n                sem_post(&amp;sem_posTaken);   //Sinaliza para o consumidor que j\u00e1 tem item no buffer\n                sem_getvalue(&amp;sem_posTaken, &amp;semTaken);\n                printf(\"DEI POST %d\\n\", semTaken);\n            }\n        }\n    }\n    pthread_exit(NULL);\n}\n</code></pre>\n\n<p>After initially posting the question I traced down the problem to the behavior of another thread running this code:</p>\n\n<pre><code>void* consumerFunc(void* arg)\n{\n    int d;\n    struct sConsumer* cons = (struct sConsumer*) arg;\n    while(n_consumed &lt; N_PRODUCTS)\n    {\n        n_consumed++;\n        sem_wait(&amp;sem_posTaken); //Verifica se j\u00e1 tem item dentro do Buffer_Size\n        sem_wait(&amp;mutex);       //Garante acesso exclusivo\n        consumers++;\n        if(consumers == 1)\n            sem_wait(&amp;db);\n        remove_buffer(cons-&gt;id);\n        sem_getvalue(&amp;sem_posTaken, &amp;d);\n        printf(\"Taken: %d\\n\", d);\n        sem_post(&amp;mutex);\n        sem_post(&amp;sem_posAvaliable);\n        sem_wait(&amp;mutex);\n        consumers--;\n        if(consumers == 0)\n            sem_post(&amp;db);\n        sem_post(&amp;mutex);\n\n    }\n    pthread_exit(NULL);\n</code></pre>\n\n<p>I intend for the thread running <code>ProducerFunc</code> to fill the whole buffer and then increment the <code>sem_postaken</code> semaphore to a value corresponding to the number of occupied slots.  Upon the producer's <code>sem_post()</code>, however, the consumer, which was blocked waiting on that semaphore, proceeds, decrementing the semaphore and looping around to wait again.  This explains why the producer never sees a value greater than zero when it performs a <code>sem_getvalue()</code>.</p>\n\n<p>How can I prevent the consumer from decrementing the semaphore until the producer has performed all the increments it intends to do?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1466011598, "post_id": 37841872, "comment_id": 63144690, "body": "Using <code>static</code> means that <code>queue</code> isn&#39;t visible in other translation units. That&#39;s the entire point of that use of the keyword."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 3, "creation_date": 1466011607, "post_id": 37841872, "comment_id": 63144695, "body": "Your objective is analogous to: &quot;I have a secret bank account. I don&#39;t anybody to know about it but I want some people to be able to put money in it.&quot;"}, {"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1466012587, "post_id": 37841872, "comment_id": 63145188, "body": "If you can live with changing <code>A.h, A.cpp</code>... then you can always use the function <code>B&amp; getQueue() { return *queue; }</code> which you define inside <code>A.cpp</code> and declare inside <code>A_priviliged.h</code>. But really, you should be asking yourself how you got yourself into this situation."}, {"owner": {"reputation": 63, "user_id": 6470797, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17b28a4d62eae7b0094f9f06f065d6cd?s=128&d=identicon&r=PG&f=1", "display_name": "Shunning Jiang", "link": "https://stackoverflow.com/users/6470797/shunning-jiang"}, "edited": false, "score": 0, "creation_date": 1466013651, "post_id": 37841872, "comment_id": 63145763, "body": "Someone else wrote this code and maybe he was wishing that the queue is only initiated once, and the code package has been distributed everywhere. I&#39;m adding functionality to reset the whole context. Then I sadly found that the whole context includes the queue and it turned out to be a big problem for me."}, {"owner": {"reputation": 307, "user_id": 4955266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/unvkm.jpg?s=128&g=1", "display_name": "Fuseteam", "link": "https://stackoverflow.com/users/4955266/fuseteam"}, "edited": false, "score": 0, "creation_date": 1466038186, "post_id": 37841872, "comment_id": 63155888, "body": "Being static queue is only available in class b. queue is assigned to next in class b. so if you want the value of queue you should first initiate d b than retrieve it using b.next or was it b-&gt;next."}], "answers": [{"comments": [{"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1466012109, "post_id": 37842059, "comment_id": 63144948, "body": "Maybe I&#39;m overlooking something, but what about creating a function that returns a reference to the pointer and then exporting that function in the header. Then you can abuse the fact that a reference returned by a function is an l-value. And l-values can be assigned. Like so: <code>B&amp; getQueue() { return *queue; }</code>"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 2, "creation_date": 1466012197, "post_id": 37842059, "comment_id": 63144991, "body": "@Centril How will you do that &quot;without changing A.h and A.cpp&quot; (which is stipulated in the question)?"}, {"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 0, "creation_date": 1466012338, "post_id": 37842059, "comment_id": 63145064, "body": "oh, I missed that part of the question... Thanks for saving me from an embarrassing SO answer ;) For those interested,here&#39;s the stuff about l-values: // <a href=\"http://stackoverflow.com/questions/6111905/c-is-return-value-a-l-value\" title=\"c is return value a l value\">stackoverflow.com/questions/6111905/c-is-return-value-a-l-va&zwnj;&#8203;lue</a>"}, {"owner": {"reputation": 63, "user_id": 6470797, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17b28a4d62eae7b0094f9f06f065d6cd?s=128&d=identicon&r=PG&f=1", "display_name": "Shunning Jiang", "link": "https://stackoverflow.com/users/6470797/shunning-jiang"}, "edited": false, "score": 0, "creation_date": 1466012615, "post_id": 37842059, "comment_id": 63145201, "body": "alright, I have to find other ways to solve the problem lol. Thank you very much!"}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 4, "last_activity_date": 1466011968, "creation_date": 1466011968, "answer_id": 37842059, "question_id": 37841872, "link": "https://stackoverflow.com/questions/37841872/access-some-static-variable-that-are-defined-in-cpp-while-its-class-type-is-als/37842059#37842059", "title": "Access some static variable that are defined in .cpp while its class type is also defined in .cpp", "body": "<p>There is <strong>no way</strong> to access <code>queue</code> outside of <code>A.cpp</code>. <code>static</code> gives the variable internal linkage, making it invisible outside the translation unit. Period.</p>\n"}, {"tags": [], "owner": {"reputation": 1843, "user_id": 2333421, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d71746648032a935232edf43e3b8a7ce?s=128&d=identicon&r=PG", "display_name": "Daniel Fru\u017cy\u0144ski", "link": "https://stackoverflow.com/users/2333421/daniel-fru%c5%bcy%c5%84ski"}, "is_accepted": false, "score": 0, "last_activity_date": 1466013229, "creation_date": 1466013229, "answer_id": 37842480, "question_id": 37841872, "link": "https://stackoverflow.com/questions/37841872/access-some-static-variable-that-are-defined-in-cpp-while-its-class-type-is-als/37842480#37842480", "title": "Access some static variable that are defined in .cpp while its class type is also defined in .cpp", "body": "<p>You cannot access this variable directly from your code - there is no \"magic syntax\" which allows this. However there is a way around - you can use debugging information generated by compiler. By using it you should be able to access that variable like debugger does. After quick Google search I found <a href=\"http://www.gnu.org/software/gdb/papers/libgdb/libgdb.html\" rel=\"nofollow\" title=\"libgdb\">libgdb</a>. You can try to use it to access that variable, or at least as an example how to load and use debug information.</p>\n"}], "owner": {"reputation": 63, "user_id": 6470797, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17b28a4d62eae7b0094f9f06f065d6cd?s=128&d=identicon&r=PG&f=1", "display_name": "Shunning Jiang", "link": "https://stackoverflow.com/users/6470797/shunning-jiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 37842059, "answer_count": 2, "score": 1, "last_activity_date": 1466013229, "creation_date": 1466011226, "question_id": 37841872, "link": "https://stackoverflow.com/questions/37841872/access-some-static-variable-that-are-defined-in-cpp-while-its-class-type-is-als", "title": "Access some static variable that are defined in .cpp while its class type is also defined in .cpp", "body": "<p>I guess I've fallen into a situation that I need to modify something that is \"protected\" in some sense. I worked around and didn't find a proper solution, or it is actually unsolvable.</p>\n\n<p>A.h</p>\n\n<pre><code>class A\n{\n    static void append(int x);\n}\n</code></pre>\n\n<p>A.cpp</p>\n\n<pre><code>class B;\nstatic B *queue = 0;\n\nclass B\n{\n    friend class A;\n\n    int value;\n    B* next;\n\n    B(int x)\n    {\n        value = x;\n        next = queue;\n        queue = this;\n    }\n}\n\nvoid A::append(int x)\n{\n  new B(x);\n}\n</code></pre>\n\n<p>What I want to do is basically finding a way to manipulate the queue externally in another source file without changing A.h and A.cpp, since class A and B don't provide methods to manipulate the queue.</p>\n\n<p>C.cpp</p>\n\n<pre><code>#include \"A.h\"\n\n&lt;whatever magic declaration&gt;\n\nvoid C()\n{\n    queue = 0;\n}\n</code></pre>\n\n<p>Thank you very much for any comments!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1466010555, "post_id": 37841617, "comment_id": 63144109, "body": "Because <code>gets</code> is not a part of <code>c99</code> standard and should not be used. So it is excluded from the standard libraries."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1466010903, "post_id": 37841617, "comment_id": 63144309, "body": "@EugeneSh.: The <code>gets</code> standard function is perfectly valid part of C99 standard. It has become obsolescent (deprecated) in C99 and it was removed in C11."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466010999, "post_id": 37841617, "comment_id": 63144354, "body": "Really? I guess I&#39;ve confused the standards. Sorry then."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1466011224, "post_id": 37841617, "comment_id": 63144499, "body": "@EugeneSh: Precisely, deprecation of <code>gets</code> was added in C99 TC3 (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1235.pdf\" rel=\"nofollow noreferrer\">N1235</a>)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 7, "creation_date": 1466011253, "post_id": 37841617, "comment_id": 63144506, "body": "The message &quot;implicit declaration of function &#39;gets&#39; is invalid&quot; suggests there is no function prototype in <code>stdio.h</code> (and an implicit declaration assumes <code>int</code> argument)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1466014327, "post_id": 37841617, "comment_id": 63146109, "body": "Perhaps the code is compiled with a flag that disables declarations of deprecated functions."}, {"owner": {"reputation": 11856, "user_id": 2873538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gayoG.png?s=128&g=1", "display_name": "Ajeet Shah", "link": "https://stackoverflow.com/users/2873538/ajeet-shah"}, "edited": false, "score": 2, "creation_date": 1466015686, "post_id": 37841617, "comment_id": 63146905, "body": "use <code>scanf</code> instead. using <code>gets</code> is dangerous."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 4, "creation_date": 1466017425, "post_id": 37841617, "comment_id": 63147908, "body": "Function <code>gets()</code> is deprecated. You are discouraged from using it because it is considered <i>insecure</i>.  What does it mean? In your program you pass it just a name of a <i>receiver array</i>, and it is impossible to know how long the input will be. If your user bears in mind that (s)he shouldn&#39;t write names longer than 20 characters, it&#39;s OK. However, if (s)he goes past that limit, so will <code>gets()</code>: <b>it will continue writing past the array boundary into memory it doesn&#39;t own</b>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466086565, "post_id": 37841617, "comment_id": 63180807, "body": "in C, when calling any of the memory allocation functions: (malloc, calloc, realloc),  1)  do not cast the returned value.  The returned value has type <code>void*</code> so can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, maintain. 2) always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1466086667, "post_id": 37841617, "comment_id": 63180894, "body": "strongly suggest using: <code>fgets()</code>  rather than <code>gets()</code>  as <code>fgets()</code> has a max length parameter, so does not allow input buffer overruns like <code>gets()</code> does."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1470608878, "post_id": 37841617, "comment_id": 65005020, "body": "See <a href=\"http://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why <code>gets()</code> is so dangerous it should never be used</a>.  That doesn&#39;t explain why it was not declared when you have <code>&lt;stdio.h&gt;</code> included.  It should be, especially under C99 rules \u2014 it was a part of the C99 standard as of 1999, and was not deprecated until later, and was only removed from the standard in C11.  To understand what was happening, we&#39;d probably need more information about the platform you&#39;re using (o/s, version, C compiler, version, command line used to compile)."}, {"owner": {"reputation": 123, "user_id": 2192464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f59cf7ebcc4edd4d384f86405ce9542b?s=128&d=identicon&r=PG", "display_name": "YtvwlD", "link": "https://stackoverflow.com/users/2192464/ytvwld"}, "edited": false, "score": 0, "creation_date": 1560547027, "post_id": 37841617, "comment_id": 99786618, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49256131/why-is-implicit-declaration-of-gets-not-allowed-in-c99\">Why is implicit declaration of gets() not allowed in C99?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1531293994, "last_edit_date": 1592644375, "creation_date": 1531293994, "answer_id": 51279565, "question_id": 37841617, "link": "https://stackoverflow.com/questions/37841617/implicit-declaration-of-function-gets-is-invalid-in-c99/51279565#51279565", "title": "implicit declaration of function &#39;gets&#39; is invalid in C99", "body": "<p>It's a safe bet that, even though the error message <em>mentions</em> <code>C99</code>, you are in fact using a compiler following a <em>later</em> standard, one in which <code>gets</code> was <em>removed</em> rather than just deprecated.</p>\n<p>For example, when I try to compile the following simple program:</p>\n<pre><code>#include &lt;stdio.h&gt;\nchar buff[1000];\nint main(void) {\n    gets(buff);\n    return 0;\n}\n</code></pre>\n<p>with <code>clang</code> under Ubuntu 18.04:</p>\n<pre><code>clang -Werror --std=c11 -o qq qq.c\n</code></pre>\n<p>I get that <em>same</em> error:</p>\n<pre><code>qq.c:4:2: error: implicit declaration of function 'gets' is invalid in C99\n                 [-Werror,-Wimplicit-function-declaration]\n</code></pre>\n<p>This is actually only <em>tangentially</em> related to the deprecation and removal of <code>gets</code> (in that it's no longer declared anywhere). It's more to do with the fact you shouldn't be trying to use <em>any</em> function without an active declaration, as per <code>ISO C99 Foreword /5</code> (paraphrased):</p>\n<blockquote>\n<p>This second edition cancels and replaces C90, as amended and corrected by various other ISO gumpf. Major changes from the previous edition include:</p>\n<ul>\n<li><p><em><strong>remove implicit function declaration.</strong></em></p>\n</li>\n<li><p>lots of other stuff, irrelevant to this question.</p>\n</li>\n</ul>\n</blockquote>\n<p>You can see this if you replace <code>gets</code> with <code>xyzzy</code>, which results in the same error:</p>\n<pre><code>qq.c:4:2: error: implicit declaration of function 'xyzzy' is invalid in C99\n                 [-Werror,-Wimplicit-function-declaration]\n</code></pre>\n<p>In fact, if you actually try to use <code>gets</code> with the <code>C99</code> flags set, you'll get a totally <em>different</em> message (or none at all if your compiler implements C99 before they deprecated <code>gets</code> - that wasn't done until TC3):</p>\n<pre><code>qq.c:4:2: error: 'gets' is deprecated\n                 [-Werror,-Wdeprecated-declarations]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6470772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5be4dfd2d5e269332cf56c557eb152a?s=128&d=identicon&r=PG&f=1", "display_name": "H. Jay", "link": "https://stackoverflow.com/users/6470772/h-jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6861, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1531293994, "creation_date": 1466010355, "last_edit_date": 1470608533, "question_id": 37841617, "link": "https://stackoverflow.com/questions/37841617/implicit-declaration-of-function-gets-is-invalid-in-c99", "title": "implicit declaration of function &#39;gets&#39; is invalid in C99", "body": "<p>Why am I getting this error?</p>\n\n<pre><code>implicit declaration of function 'gets' is invalid in C99 [-Werror,-Wimplicit-function-declaration]\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct myStruct\n{\n    char name[20];\n    char tel[20];\n}contact;\n\nint main(void)\n{\n    contact *mycont[3];\n\n    for(int i=0; i&lt;3; i++)\n    {\n        mycont[i] = (contact*)malloc(sizeof(contact));\n        printf(\"Enter Name Of The Contact No.%d\\n\",i+1);\n        gets(mycont[i]-&gt;name);\n        printf(\"Enter The Contact Telephone Number\\n\");\n        gets(mycont[i]-&gt;tel);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "function", "pointers", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1466010363, "post_id": 37841524, "comment_id": 63143995, "body": "1) the pointer is not allocated. 2) Why are you (wrongly) using the dot (<code>.</code>) notation in <code>main</code>, while correctly using the arrow <code>-&gt;</code> notation in <code>inipunt</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1466010720, "post_id": 37841524, "comment_id": 63144202, "body": "That would work for <code>punt a; inipunt(&amp;a);</code> but <code>double b,n;</code> have not been initialised."}, {"owner": {"reputation": 43, "user_id": 6278413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed0f69cbe256965958c43404b775a7b?s=128&d=identicon&r=PG&f=1", "display_name": "l.arlev", "link": "https://stackoverflow.com/users/6278413/l-arlev"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1466011539, "post_id": 37841524, "comment_id": 63144664, "body": "So I tried a=malloc(sizeof(punt)); and it worked, thanks. Now you are saying I should do the same to allocate the pointer to taulaRectangle and in the void function allocate the pointer to rectangle and initializing the other variables @EugeneSh."}], "answers": [{"tags": [], "owner": {"reputation": 1289, "user_id": 1351528, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/19aacb01d087e246fc15a4ba7080c29f?s=128&d=identicon&r=PG", "display_name": "mid_kid", "link": "https://stackoverflow.com/users/1351528/mid-kid"}, "is_accepted": true, "score": 1, "last_activity_date": 1466012036, "last_edit_date": 1466012036, "creation_date": 1466011475, "answer_id": 37841930, "question_id": 37841524, "link": "https://stackoverflow.com/questions/37841524/initializing-a-pointer-to-a-structure-through-a-void-function-in-c/37841930#37841930", "title": "Initializing a pointer to a structure through a void function in C", "body": "<p>As Eugene pointed out in the comments, the pointer is not allocated.</p>\n\n<p>When you do <code>punt *a;</code>, you're only allocating a pointer to the structure, but it doesn't point to anything yet. It's not initialized.<br>\nKeep your uninitialized variables in check, as they could have any value. You have no idea what an uninitialized pointer could be pointing to.  </p>\n\n<p>You have two solutions for this problem:</p>\n\n<ul>\n<li>Allocate space for the structure in the stack, by doing <code>punt a;</code>. In this case <code>a</code> is the struct.</li>\n<li>Allocate space for the structure in the heap, by doing <code>punt *a = malloc(sizeof(punt))</code>. In this case <code>a</code> is a pointer to the struct.</li>\n</ul>\n\n<p>If you allocate the space in the stack, to get the pointer for a, you should do <code>&amp;a</code>.<br>\nKeep in mind that to access a struct behind a pointer, you use <code>-&gt;</code> instead of <code>.</code>.</p>\n\n<p>This should work:</p>\n\n<pre><code>void inipunt(punt *p) {\n    p-&gt;x = 0;\n    p-&gt;y = 1;\n}\nint main() {\n    punt a;\n    inipunt(&amp;a);\n    printf(\"%lf %lf\\n\", a.x, a.y);\n    punt *b = malloc(sizeof(punt));  // You should check if it returns NULL, in case of an error.\n    inipunt(b);\n    printf(\"%lf %lf\\n\", b-&gt;x, b-&gt;y);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6278413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed0f69cbe256965958c43404b775a7b?s=128&d=identicon&r=PG&f=1", "display_name": "l.arlev", "link": "https://stackoverflow.com/users/6278413/l-arlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 37841930, "answer_count": 1, "score": 0, "last_activity_date": 1466012036, "creation_date": 1466010054, "question_id": 37841524, "link": "https://stackoverflow.com/questions/37841524/initializing-a-pointer-to-a-structure-through-a-void-function-in-c", "title": "Initializing a pointer to a structure through a void function in C", "body": "<p>Let my structures be:</p>\n\n<pre><code>typedef struct{\n    double x;\n    double y;\n   } punt;\n\ntypedef struct{\n    char tip;\n    punt infEsq\n    punt supDret;\n   } rectangle;\n\ntypedef struct{\n    rectangle *llista;\n    int numRect;\n    int midaMax;\n   } taulaRectangle;\n</code></pre>\n\n<p>Contextualizing, </p>\n\n<p>\"Punt\" represents a point.</p>\n\n<p>\"Rectangle\", char indicates if it's a square [q] or a rectangle [r], the two points are the inferior left point (infEsq) and the superior right point (supDret) of the rectangle.</p>\n\n<p>\"TaulaRectangle\" maps a list (or table) of structures type \"rectangle\", indicating how many rectangles it has [numRect], and how many it can hold [midaMax] (which if I am not wrong indicates the dimension of [llista]).</p>\n\n<p>Now I want to code a function to initialize a pointer to \"taulaRectangle\" like this:</p>\n\n<pre><code>void initaula(taulaRectangle *t,int n) /*n is associated to midaMax*/\n</code></pre>\n\n<p>I will not post my intents in coding a valid initialization function because I believe they're not close to what I want to achieve although here is a similar scenario where I did try something alike:</p>\n\n<pre><code>    void inipunt(punt *b){\n    b-&gt;x=0;\n    b-&gt;y=1;\n    return;\n    }\n    int main (void){\n    double b,n;\n    punt *a;\n    inipunt(a);\n    puts(\"guay\");\n    a.x=b;\n    a.y=n;\n    printf(\"a.x=%lf a.y=%lf\",b,n); /*I know this association is not necessary\n                                     but if I directly print a.x a.y it does\n                                     not work either, also a fail is *(a.x),*\n                                     (a.y) */\n    return 0;\n    }\n</code></pre>\n\n<p>The compiler (gcc -ansi -Wall) returns:</p>\n\n<blockquote>\n  <p>final1.c:30:2: error: request for member \u2018x\u2019 in something not a\n  structure or union  a.x=b;   ^ final1.c:31:2: error: request for\n  member \u2018y\u2019 in something not a structure or union  a.y=n;   ^</p>\n</blockquote>\n\n<p>Synthesizing, I want to be able to declare a pointer to \"taulaRectangle\" and initialize it using \"void initaula()\", I typed the example above because I believe what I want to achieve in both functions is similar except in \"void inipunt()\" I do not have to allocate memory for a pointer in the structure, I think the problem has it's roots in how i treat the pointer to the structure in my void function.</p>\n\n<p>Sorry for the long question, if anyone can help It will be gladly appreciated.</p>\n"}, {"tags": ["c", "algorithm", "authentication", "encryption"], "comments": [{"owner": {"reputation": 2071, "user_id": 330700, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50a3ded5f2b92442bb5d11348c5fbc46?s=128&d=identicon&r=PG", "display_name": "ajduff574", "link": "https://stackoverflow.com/users/330700/ajduff574"}, "edited": false, "score": 0, "creation_date": 1466094425, "post_id": 37840890, "comment_id": 63186328, "body": "You might be better off asking in the crypto StackExchange network."}, {"owner": {"reputation": 2071, "user_id": 330700, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50a3ded5f2b92442bb5d11348c5fbc46?s=128&d=identicon&r=PG", "display_name": "ajduff574", "link": "https://stackoverflow.com/users/330700/ajduff574"}, "edited": false, "score": 0, "creation_date": 1466099686, "post_id": 37840890, "comment_id": 63189364, "body": "After a quick look, it appears that only 26 bits of r are stored in each 32 bit value. The top 6 bits are masked off. Similarly, the top 6 bits are masked off of the 32-bit values when the 128-bit message chunk is added to h. As to why it seems to use 26-bit chunks for everything (particularly when the intermediate values, d, are at 64-bit precision), I don&#39;t know. Compare, for example, OpenSSL&#39;s implementation: <a href=\"https://github.com/openssl/openssl/blob/master/crypto/poly1305/poly1305.c\" rel=\"nofollow noreferrer\">github.com/openssl/openssl/blob/master/crypto/poly1305/&hellip;</a>"}], "owner": {"reputation": 9, "user_id": 6470607, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206741564483170/picture?type=large", "display_name": "William Glanton", "link": "https://stackoverflow.com/users/6470607/william-glanton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466008005, "creation_date": 1466008005, "question_id": 37840890, "link": "https://stackoverflow.com/questions/37840890/how-does-the-poly1305-donna-algorithm-work", "title": "How does the poly1305-donna algorithm work", "body": "<p>Ive been looking at implementing a poly1305 algorithm in C and I came across this github project <a href=\"https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna-32.h\" rel=\"nofollow\">here</a></p>\n\n<p>One thing Ive never really done (but I need to do to implement this algorithm) is doing math operations on large numbers. The link above Implements this large number math but I can't seem to figure out how it works.</p>\n\n<p>The first step is to clamp r (clear specific bits) but I don't know why r, a 16 byte value, is stored in 32 bit number array of length 5, nor how the clamping is accomplished in this code. (U8TO32 is just a little endian load function)</p>\n\n<pre><code>/* r &amp;= 0xffffffc0ffffffc0ffffffc0fffffff */\nst-&gt;r[0] = (U8TO32(&amp;key[ 0])     ) &amp; 0x3ffffff;\nst-&gt;r[1] = (U8TO32(&amp;key[ 3]) &gt;&gt; 2) &amp; 0x3ffff03;\nst-&gt;r[2] = (U8TO32(&amp;key[ 6]) &gt;&gt; 4) &amp; 0x3ffc0ff;\nst-&gt;r[3] = (U8TO32(&amp;key[ 9]) &gt;&gt; 6) &amp; 0x3f03fff;\nst-&gt;r[4] = (U8TO32(&amp;key[12]) &gt;&gt; 8) &amp; 0x00fffff;\n</code></pre>\n\n<p>The multiplication, addition and mod steps are done here. h is just an accumulator, and will initially start as all zeros. and...well I just get completely lost after that.</p>\n\n<pre><code>s1 = r1 * 5;\ns2 = r2 * 5;\ns3 = r3 * 5;\ns4 = r4 * 5;\n\n/* h += m[i] */\n    h0 += (U8TO32(m+ 0)     ) &amp; 0x3ffffff;\n    h1 += (U8TO32(m+ 3) &gt;&gt; 2) &amp; 0x3ffffff;\n    h2 += (U8TO32(m+ 6) &gt;&gt; 4) &amp; 0x3ffffff;\n    h3 += (U8TO32(m+ 9) &gt;&gt; 6) &amp; 0x3ffffff;\n    h4 += (U8TO32(m+12) &gt;&gt; 8) | hibit;\n\n    /* h *= r */\n    d0 = ((unsigned long long)h0 * r0) + ((unsigned long long)h1 * s4) + ((unsigned long long)h2 * s3) + ((unsigned long long)h3 * s2) + ((unsigned long long)h4 * s1);\n    d1 = ((unsigned long long)h0 * r1) + ((unsigned long long)h1 * r0) + ((unsigned long long)h2 * s4) + ((unsigned long long)h3 * s3) + ((unsigned long long)h4 * s2);\n    d2 = ((unsigned long long)h0 * r2) + ((unsigned long long)h1 * r1) + ((unsigned long long)h2 * r0) + ((unsigned long long)h3 * s4) + ((unsigned long long)h4 * s3);\n    d3 = ((unsigned long long)h0 * r3) + ((unsigned long long)h1 * r2) + ((unsigned long long)h2 * r1) + ((unsigned long long)h3 * r0) + ((unsigned long long)h4 * s4);\n    d4 = ((unsigned long long)h0 * r4) + ((unsigned long long)h1 * r3) + ((unsigned long long)h2 * r2) + ((unsigned long long)h3 * r1) + ((unsigned long long)h4 * r0);\n\n    /* (partial) h %= p */\n                  c = (unsigned long)(d0 &gt;&gt; 26); h0 = (unsigned long)d0 &amp; 0x3ffffff;\n    d1 += c;      c = (unsigned long)(d1 &gt;&gt; 26); h1 = (unsigned long)d1 &amp; 0x3ffffff;\n    d2 += c;      c = (unsigned long)(d2 &gt;&gt; 26); h2 = (unsigned long)d2 &amp; 0x3ffffff;\n    d3 += c;      c = (unsigned long)(d3 &gt;&gt; 26); h3 = (unsigned long)d3 &amp; 0x3ffffff;\n    d4 += c;      c = (unsigned long)(d4 &gt;&gt; 26); h4 = (unsigned long)d4 &amp; 0x3ffffff;\n    h0 += c * 5;  c =                (h0 &gt;&gt; 26); h0 =                h0 &amp; 0x3ffffff;\n    h1 += c;\n</code></pre>\n"}, {"tags": ["c", "linux", "file"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1466006141, "post_id": 37840289, "comment_id": 63141435, "body": "Because the strings are written in ASCII?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1466006217, "post_id": 37840289, "comment_id": 63141489, "body": "Perhaps you better read the <code>od</code> manual?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 2, "creation_date": 1466006279, "post_id": 37840289, "comment_id": 63141521, "body": "You didn&#39;t write the actual bytes making up the integer... you wrote a string containing a text representation of the number in the integer, produced by <code>fprintf()</code>... so that&#39;s what you get when you view it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466006682, "post_id": 37840289, "comment_id": 63141818, "body": "I still can&#39;t see how the code shown can generate the output shown. Neither to console, nor to the file. Either you show only part of the output and program or you have another problem. As you don&#39;t chekc the results for <code>scanf</code> and <code>fopen</code>. Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. And there is no hex conversion specifier shown, so why do you think to get hex-codes?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466006718, "post_id": 37840289, "comment_id": 63141842, "body": "Use something like <code>fprintf(fp, &quot;%c%c&quot;, (i&gt;&gt;8)&amp;255, (i&gt;&gt;0)&amp;255);</code> or even better <code>fwrite()</code>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466007987, "post_id": 37840289, "comment_id": 63142690, "body": "@Olaf <code>-x</code> option for <code>od</code> gives two-byte units as hexadecimal"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1466008340, "post_id": 37840289, "comment_id": 63142879, "body": "@Dmitri: My fault. I didn&#39;t know about the <code>od</code> command, but thought that was OPs original program. Anyway, if the first row is the hex-codes for the data and the 2nd row the ASCII-codes, the output is still confusing, as the bytes seem to be swapped, but the ASCII-chars are not. That leave the quesdtion to being badly researched. OP just should read the man-page of <code>(f)printf</code>"}, {"owner": {"reputation": 161, "user_id": 6227686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c55dab7f1374a6737d916a1c40f3a22?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6227686/patrick"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466079900, "post_id": 37840289, "comment_id": 63175490, "body": "@Olaf I do not know why the bytes are swapped but that is exactly how my command line showed the output."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466080176, "post_id": 37840289, "comment_id": 63175698, "body": "@Patrick: I did not doubt <b>that</b> (once I checked the <code>od</code> command). It is just that you apparently did not even a bit of research what <code>printf</code> actually does. I can understand (still not accept) this for less common functions, but not for something every C book uses almost from the beginning. Please next time do at least some research (this is a requirement before asking and a valid reason to DV, btw.)"}, {"owner": {"reputation": 161, "user_id": 6227686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c55dab7f1374a6737d916a1c40f3a22?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6227686/patrick"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466080897, "post_id": 37840289, "comment_id": 63176250, "body": "@Olaf Alright! My bad. What do you mean by DV btw?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466080920, "post_id": 37840289, "comment_id": 63176276, "body": "@Patrick downvote."}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1466007604, "creation_date": 1466007604, "answer_id": 37840784, "question_id": 37840289, "link": "https://stackoverflow.com/questions/37840289/why-does-octal-dump-output-the-ascii-code-for-an-integer-variable-instead-of-the/37840784#37840784", "title": "Why does octal dump output the ascii code for an integer variable instead of the binary code?", "body": "<p><code>fprintf</code> formats all output <em>as text</em> - <code>fprintf( fp, \"%d\", 42 )</code> writes the character values <code>'4'</code> and <code>'2'</code> to the output stream, same as <code>fprintf( fp, \"%c%c\", '4', '2' )</code> and <code>fprintf( fp, \"%s\", \"42\" )</code>.</p>\n\n<p>If you want to write the binary representation of the integer to your output stream, then you need to use <code>fwrite( &amp;i, sizeof i, 1, fp );</code>.  </p>\n"}], "owner": {"reputation": 161, "user_id": 6227686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c55dab7f1374a6737d916a1c40f3a22?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6227686/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 37840784, "answer_count": 1, "score": 1, "last_activity_date": 1466007604, "creation_date": 1466006027, "question_id": 37840289, "link": "https://stackoverflow.com/questions/37840289/why-does-octal-dump-output-the-ascii-code-for-an-integer-variable-instead-of-the", "title": "Why does octal dump output the ascii code for an integer variable instead of the binary code?", "body": "<p>This is the code in C to input a character and integer variable to a file.</p>\n\n<pre><code>int main(void)\n{\n    FILE *fp;\n    char file[20];\n    int i = 40;\n\n    printf(\"Enter filename: \");\n    scanf(\"%s\", file);\n\n    fp = fopen(file, \"wb\");\n\n    fprintf(fp, \"%d\", i);\n    fprintf(fp, \"%c%c\", '4', '0');\n\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>So lets say the file name is text and the od command is invoked..</p>\n\n<pre><code>od -xc text\n</code></pre>\n\n<p>This is the output of the command</p>\n\n<pre><code>0000000    3034    3034\n            4 0     4 0\n</code></pre>\n\n<p>Why does it print the ASCII values for both of the value 40 and not the hex code 0028 for the integer variable?</p>\n"}, {"tags": ["c", "opencv"], "comments": [{"owner": {"reputation": 8123, "user_id": 4228275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K3MMo.png?s=128&g=1", "display_name": "Berriel", "link": "https://stackoverflow.com/users/4228275/berriel"}, "edited": false, "score": 0, "creation_date": 1466008395, "post_id": 37840262, "comment_id": 63142909, "body": "You tagged c++, but you are using C API"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1466016290, "post_id": 37840262, "comment_id": 63147266, "body": "Don&#39;t use obsolete C api!"}], "answers": [{"tags": [], "owner": {"reputation": 763, "user_id": 5690771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jIp1y.jpg?s=128&g=1", "display_name": "hariprasad", "link": "https://stackoverflow.com/users/5690771/hariprasad"}, "is_accepted": false, "score": 0, "last_activity_date": 1466049731, "creation_date": 1466049731, "answer_id": 37849695, "question_id": 37840262, "link": "https://stackoverflow.com/questions/37840262/cvmatchtemple-assertion-failed-error-vs2015opencv2/37849695#37849695", "title": "cvMatchTemple assertion failed error (VS2015+opencv2)", "body": "<p>this line is producing the error</p>\n\n<pre><code>IplImage *ftmp = cvCreateImage(cvSize(iwidth, iheight), 8,1);\n</code></pre>\n\n<p>it should be </p>\n\n<pre><code>IplImage *ftmp = cvCreateImage(cvSize(iwidth, iheight), 32,1);\n</code></pre>\n\n<p><code>MatchTemplate</code> needs result image should be of 32 bit floating point but you have given 8 bit.This is what error is saying </p>\n\n<pre><code>result.size() == cv::Size(std::abs(img.cols - te mpl.cols) + 1, std::abs(img.rows - templ.rows) + 1) &amp;&amp; result.type() == CV_32F\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 4608434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49093fb2c083dfc2d60c20c8ddba7271?s=128&d=identicon&r=PG&f=1", "display_name": "King Dinve", "link": "https://stackoverflow.com/users/4608434/king-dinve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466049731, "creation_date": 1466005975, "last_edit_date": 1466032389, "question_id": 37840262, "link": "https://stackoverflow.com/questions/37840262/cvmatchtemple-assertion-failed-error-vs2015opencv2", "title": "cvMatchTemple assertion failed error (VS2015+opencv2)", "body": "<p>I hope someone can figure it out.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>int iwidth = screenImage-&gt;width - templ-&gt;width+1;\nint iheight = screenImage-&gt;height - templ-&gt;height+1;\n\nIplImage *ftmp = cvCreateImage(cvSize(iwidth, iheight), 8,1);\ndouble max_val;\ndouble min_val;\nCvPoint min_loc;\nCvPoint max_loc;\ncvMatchTemplate(screenImage,templ,ftmp,0);\ncvMinMaxLoc(ftmp, &amp;min_val, &amp;max_val, &amp;min_loc, &amp;max_loc, NULL);\ncvRectangle(screenImage, cvPoint(min_loc.x, min_loc.y), cvPoint((min_loc.x + templ-&gt;width), (min_loc.y + templ-&gt;height)), CV_RGB(0, 255, 0), 1);\ncvNamedWindow(\"src\", 1);\ncvShowImage(\"src\", screenImage);\ncvWaitKey(0);\n</code></pre>\n\n<p>And when I ran it, I got an error:</p>\n\n<blockquote>\n  <p>OpenCV Error: Assertion failed (result.size() == cv::Size(std::abs(img.cols - te\n  mpl.cols) + 1, std::abs(img.rows - templ.rows) + 1) &amp;&amp; result.type() == CV_32F)\n  in cvMatchTemplate, file E:\\opencv\\opencv\\sources\\modules\\imgproc\\src\\templmatch\n  .cpp, line 1100 </p>\n</blockquote>\n"}, {"tags": ["c", "linux", "dynamic", "dynamic-linking"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1466005106, "post_id": 37839865, "comment_id": 63140671, "body": "&quot;since that should be impossible, right?&quot; Wrong."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1466005329, "post_id": 37839865, "comment_id": 63140842, "body": "Strange, the impossible works very well on my desktop and other computers, including mobile. You might want to do some research on your own about dynamic linking and how programs are initialised on Linux (and other modern OSs)."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 0, "last_activity_date": 1466009416, "last_edit_date": 1466009416, "creation_date": 1466007509, "answer_id": 37840756, "question_id": 37839865, "link": "https://stackoverflow.com/questions/37839865/how-does-dynamic-linker-changes-text-segment-of-process/37840756#37840756", "title": "How does dynamic linker changes text segment of process?", "body": "<p>The actual implementation is quite complex as it builds on top of ELF, which is quite complex as it tries to accommodate many scenarios, but conceptually it's quite simple.</p>\n\n<p>Basically (after the library dependencies are located and <code>open</code>ed) it's a couple of <em>mmap</em>s, <em>mprotect</em>s, some modifications to implement the linking by binding symbols (can be deferred), and then jump to code. </p>\n\n<p>Ideally, the linked shared libraries will be compiled with <code>-fpic</code>/<code>-fPIC</code> which will allow the linker to place them anywhere in the processes address space without having to write to the <code>.text</code> section (=executable code) of the library.\nSuch a library/executable will call functions from other libraries via a modifiable table, which the linker will fix up (probably lazily) to point to the actual locations where it has loaded the dependent library.\nAccess to variables from one shared library to another is similarly indirected.</p>\n\n<p>Limiting the modifying library data/code as much as possible allows marking sections of code to be marked read only (via the MMU / the <code>mprotect</code> system call) and mapped into memory that's shared among all processes that use that particular library.</p>\n\n<hr>\n\n<p>To get an idea of what happens at the syscall level, you can try e.g.:</p>\n\n<pre><code>strace /bin/echo hello world\n</code></pre>\n\n<p>and all the syscalls up to about <code>sbrk</code> included (=setting up the heap / <code>.data</code> segment) should be the doings of the dynamic linker. </p>\n\n<hr>\n\n<p>(<code>malloc</code> is indeed unavailable to the linker as <code>malloc</code> is a feature of the c library, not the system. <code>malloc</code> is about growing and managing the heap section and potentially <code>mmap</code>ping other separate blocks and managing those as well as the writable \"heap\", and the dynamic linker isn't concerned about these sections of a process image, mainly just its writable indirection tables and where it maps libraries).</p>\n"}], "owner": {"reputation": 23, "user_id": 6470408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6341f0fea10941d7388a6b69ee294b7c?s=128&d=identicon&r=PG&f=1", "display_name": "maplaz", "link": "https://stackoverflow.com/users/6470408/maplaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 1, "accepted_answer_id": 37840756, "answer_count": 1, "score": 1, "last_activity_date": 1466009416, "creation_date": 1466004960, "question_id": 37839865, "link": "https://stackoverflow.com/questions/37839865/how-does-dynamic-linker-changes-text-segment-of-process", "title": "How does dynamic linker changes text segment of process?", "body": "<p>If i understand correctly when user tries to execute dynamically linked\nexecutable (with <code>execve(\"foo\", \"\", \"\")</code>) instead of loading text segment of \"foo\" dynamic linker is loaded (ld-linux.so.2) and executed. It have to load\nlibraries required for program (\"foo\") to run and change some addresses \nin \"foo\" and pass control to foo, but how is this acomplished? </p>\n\n<p>How (what system call it uses) and where \ndoes dynamic loader load libraries and \"foo\"s code and data in memory (I am guessing it can't simply use\n malloc or mmap and then jump to code since that should be impossible,\n  right? It also seems unlikely that it creates temp file whith complete \n  executable (like staticlly linked one) and calls exceve again.).</p>\n"}, {"tags": ["c", "sockets", "tcp"], "answers": [{"tags": [], "owner": {"reputation": 1843, "user_id": 2333421, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d71746648032a935232edf43e3b8a7ce?s=128&d=identicon&r=PG", "display_name": "Daniel Fru\u017cy\u0144ski", "link": "https://stackoverflow.com/users/2333421/daniel-fru%c5%bcy%c5%84ski"}, "is_accepted": true, "score": 2, "last_activity_date": 1466014206, "last_edit_date": 1466014206, "creation_date": 1466013876, "answer_id": 37842674, "question_id": 37839444, "link": "https://stackoverflow.com/questions/37839444/accessing-tcp-header-fields-without-raw-socket-api/37842674#37842674", "title": "Accessing TCP header fields (without raw socket API)", "body": "<p>You can try to use libpcap to capture packets. This lib allows to specify packet filter using the same syntax as in Wireshark, so you could limit captured packets to one connection only. One downside is that you would have to receive packets in normal way too, what complicated things a bit and is an additional performance overhead.</p>\n\n<p>Update: you can also open raw socket and set Berkeley Packet Filter on it using socket option <code>SO_ATTACH_FILTER</code>. More details are here: <a href=\"https://www.kernel.org/doc/Documentation/networking/filter.txt\" rel=\"nofollow\">https://www.kernel.org/doc/Documentation/networking/filter.txt</a> . However you would have to implement TCP part of IP stack in your code too.</p>\n"}], "owner": {"reputation": 1617, "user_id": 247041, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/04e14b97476c57347bf1222cd9836964?s=128&d=identicon&r=PG&f=1", "display_name": "kirbo", "link": "https://stackoverflow.com/users/247041/kirbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 37842674, "answer_count": 1, "score": 1, "last_activity_date": 1466014206, "creation_date": 1466003836, "question_id": 37839444, "link": "https://stackoverflow.com/questions/37839444/accessing-tcp-header-fields-without-raw-socket-api", "title": "Accessing TCP header fields (without raw socket API)", "body": "<p>I am writing an application that needs to get access to TCP header fields, for example, a sequence number or a TCP timestamp field. </p>\n\n<p>Is it possible to get sequence numbers (or other header fields) by operating at the socket API without listening on a raw socket? (I want to avoid filtering out all the packets).</p>\n\n<p>I am looking at the TCP_INFO but it has a limited information. </p>\n\n<p>For example, after calling a recvmsg() and getting a data buffer, is it possible to know the sequence number of the segment that delivered the last byte in that received data buffer?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "main"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 401, "user_id": 2028385, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzXzP.png?s=128&g=1", "display_name": "JoulinRouge", "link": "https://stackoverflow.com/users/2028385/joulinrouge"}, "edited": false, "score": 2, "creation_date": 1466004223, "post_id": 37839438, "comment_id": 63140023, "body": "@JoulinRouge That oh-so-smart comment doesn&#39;t explain the <i>difference</i> between the two ways of using the identifier <code>main</code>, which seems to be the real question here."}, {"owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "edited": false, "score": 1, "creation_date": 1466004407, "post_id": 37839438, "comment_id": 63140148, "body": "Such as it may help with the thoroughly correct answers below: C allows a statement to be a mere expression \u2014 something that is evaluated but has no effect whatsoever on state. Modern compilers will usually issue a warning."}, {"owner": {"reputation": 401, "user_id": 2028385, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzXzP.png?s=128&g=1", "display_name": "JoulinRouge", "link": "https://stackoverflow.com/users/2028385/joulinrouge"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1466004855, "post_id": 37839438, "comment_id": 63140478, "body": "@underscore_d just posted for the &quot;did you mean: recursion&quot; thing. the difference has already been explained. Do you want me to remove it?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 401, "user_id": 2028385, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzXzP.png?s=128&g=1", "display_name": "JoulinRouge", "link": "https://stackoverflow.com/users/2028385/joulinrouge"}, "edited": false, "score": 1, "creation_date": 1466006215, "post_id": 37839438, "comment_id": 63141487, "body": "@JoulinRouge I confess I didn&#39;t even know Google had that joke, heh. I don&#39;t mind if you removed it or not; I was just clarifying that the question seemed to be about the difference, not &#39;why is this repeating&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1466006357, "post_id": 37839514, "comment_id": 63141579, "body": "Omitting the return value of <code>main</code> leads to <code>0</code> being assumed in C++ too, since it adopts that (like various, but not <i>all</i>, other things) from C99. I hadn&#39;t realised they differed in positions on recursion within <code>main()</code>... not that I would ever want to use that anyway!"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1466004023, "creation_date": 1466004023, "answer_id": 37839514, "question_id": 37839438, "link": "https://stackoverflow.com/questions/37839438/calling-main-inside-of-main-in-c/37839514#37839514", "title": "Calling main inside of main in c", "body": "<p><code>main();</code> will call the function recursively (and eventually crash due to a stack overflow, unless your compiler has cleverly optimised the recursion out to a loop).</p>\n\n<p><code>main</code> is an <em>expression</em> with a value equal to the <em>address</em> of the function <code>main()</code>. It's a no-op but nonetheless syntactically valid.</p>\n\n<p>(Note that the behaviour of calling <code>main</code> from itself is <em>undefined</em> in C++, but is valid in C. Omitting the return value from <code>main</code> is also well-defined in C: 0 is assumed).</p>\n"}, {"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1466004523, "post_id": 37839515, "comment_id": 63140225, "body": "I&#39;d add that a decent compiler should warn on the first case: <i>warning: statement with no effect</i>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1466005995, "post_id": 37839515, "comment_id": 63141315, "body": "@LPs: That would require enabling warnings. Something beginners tend to avoid, because they &quot;get too much irritating messages&quot; ... :-(( - Honestly, I got exactly that explanation from a student once!"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466006448, "post_id": 37839515, "comment_id": 63141647, "body": "@Olaf Hard to believe, right? I celebrate when my program generates no warnings. Or rather, when the only warning it generates is that one misdiagnosis due to some <code>g++</code> bug..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1466006844, "post_id": 37839515, "comment_id": 63141930, "body": "@underscore_d: I was literally speachless. And that really happens very rarely. Not to mention that student did not pass the course (for writing rubbish code and not knowing the language, not just for that attitude)."}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 5, "last_activity_date": 1466004024, "creation_date": 1466004024, "answer_id": 37839515, "question_id": 37839438, "link": "https://stackoverflow.com/questions/37839438/calling-main-inside-of-main-in-c/37839515#37839515", "title": "Calling main inside of main in c", "body": "<pre><code>int main() {\n    printf( \"Hello world\") ;\n    main ;\n}\n</code></pre>\n\n<p>The last statement <code>main ;</code> has virtually no meaning: it just take the function designator, have it converted to a pointer pointing at the function, then throw the result away.</p>\n\n<pre><code>int main() {\n    printf( \"Hello world\") ;\n    main() ;\n}\n</code></pre>\n\n<p>This code uses \"main-recursion\". The function <code>main()</code> is called inside <code>main()</code>. This recursive call will continue infinitely, and it may crash somewhere when the stack ran out or it may go until you stop by Ctrl+C or something if the compiler is smart enough to convert this tail recursion into a simple loop.</p>\n"}, {"tags": [], "owner": {"reputation": 14428, "user_id": 232566, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a027b477262bd8ab1308afe9e8bdb1c5?s=128&d=identicon&r=PG", "display_name": "RQDQ", "link": "https://stackoverflow.com/users/232566/rqdq"}, "is_accepted": false, "score": 1, "last_activity_date": 1466004036, "creation_date": 1466004036, "answer_id": 37839521, "question_id": 37839438, "link": "https://stackoverflow.com/questions/37839438/calling-main-inside-of-main-in-c/37839521#37839521", "title": "Calling main inside of main in c", "body": "<p>This is because:</p>\n\n<pre><code>main()\n</code></pre>\n\n<p>is a method call. You are recursively calling the main function repeatedly. This will run until the call stack overflows.</p>\n\n<pre><code>main\n</code></pre>\n\n<p>Is a function pointer, so you're not really doing much on this line. The function exits after printing \"Hello World\" once.</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 2924562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CbKx.jpg?s=128&g=1", "display_name": "Am33d", "link": "https://stackoverflow.com/users/2924562/am33d"}, "is_accepted": false, "score": 0, "last_activity_date": 1466006633, "creation_date": 1466006633, "answer_id": 37840503, "question_id": 37839438, "link": "https://stackoverflow.com/questions/37839438/calling-main-inside-of-main-in-c/37840503#37840503", "title": "Calling main inside of main in c", "body": "<p><code>main</code> is a function pointer whereas <code>main()</code> is function call. </p>\n\n<p>When you write <code>main</code> it's just a <em>statement</em>, you are not using it or modifying it anywhere but main() is function call which will be a recursive (infinite in this case) call.</p>\n"}], "owner": {"reputation": 119, "user_id": 5644911, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/199649753709921/picture?type=large", "display_name": "Stamatis Papadopoulos", "link": "https://stackoverflow.com/users/5644911/stamatis-papadopoulos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1375, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1466006633, "creation_date": 1466003829, "last_edit_date": 1466004646, "question_id": 37839438, "link": "https://stackoverflow.com/questions/37839438/calling-main-inside-of-main-in-c", "title": "Calling main inside of main in c", "body": "<p>I'd like to ask why when I have: </p>\n\n<pre><code>int main() {\n    printf( \"Hello world\") ;\n    main ;\n}\n</code></pre>\n\n<p>the compiler prints \"Hello world\", \nbut when I have main() instead of main, it prints repeatedly \"Hello world\".</p>\n"}, {"tags": ["c", "arrays", "function", "on-the-fly"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1466003804, "post_id": 37839379, "comment_id": 63139716, "body": "Yes.It is called compound literals"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1466003813, "post_id": 37839379, "comment_id": 63139722, "body": "Not studied well, Compound literals (<a href=\"http://chimera.roma1.infn.it/SP/COMMON/iso-iec-9899-1990.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.5.2.5) might be it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1466006125, "post_id": 37839379, "comment_id": 63141419, "body": "Why do beginners think all programming languages support the same (or similar) features?"}], "answers": [{"comments": [{"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1466004216, "post_id": 37839482, "comment_id": 63140020, "body": "Dang, it worked!  Want to give you an upvote but stackoverflow is making me wait.  Remind me if I don&#39;t get around to it.  Thanks!"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1466004985, "post_id": 37839482, "comment_id": 63140577, "body": "@bob.sacamento did you mean to accept the answer ?"}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1466005290, "post_id": 37839482, "comment_id": 63140811, "body": "@machine_1 Oh ... yeah, that was it.  But it&#39;s all done now."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 4, "last_activity_date": 1466004240, "last_edit_date": 1466004240, "creation_date": 1466003939, "answer_id": 37839482, "question_id": 37839379, "link": "https://stackoverflow.com/questions/37839379/is-it-possible-to-pass-an-on-the-fly-array-to-a-c-function/37839482#37839482", "title": "Is it possible to pass an &quot;on the fly&quot; array to a C function?", "body": "<p>Yes. It's possible using <em>compound literals</em> (since C99).</p>\n\n<p>E.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid fun(int *a)\n{\n    printf(\"%d\\n\", a[2]); //prints 72\n}\n\nint main(void)\n{\n    fun((int[]){1, 99, 72});\n}\n</code></pre>\n\n<p>You can find some more examples from the links as well:</p>\n\n<ol>\n<li><a href=\"http://www.drdobbs.com/the-new-c-compound-literals/184401404\" rel=\"nofollow\">The New C: Compound Literals</a></li>\n<li><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Compound-Literals.html\" rel=\"nofollow\">Compound Literals - gcc</a></li>\n</ol>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "closed_date": 1466004051, "accepted_answer_id": 37839482, "answer_count": 1, "score": 1, "last_activity_date": 1466004240, "creation_date": 1466003639, "question_id": 37839379, "link": "https://stackoverflow.com/questions/37839379/is-it-possible-to-pass-an-on-the-fly-array-to-a-c-function", "closed_reason": "Duplicate", "title": "Is it possible to pass an &quot;on the fly&quot; array to a C function?", "body": "<p>In Fortran, one can pass an array constructed on the fly to a subroutine:</p>\n\n<pre><code>call sub_that_wants_3_elm_array((/1,2,3/),output_arg)\n</code></pre>\n\n<p>Is it possible to do something analogous in C?  This seems awfully basic, but I haven't been able to find anything on this, either yes or no.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 5, "creation_date": 1466003119, "post_id": 37839153, "comment_id": 63139211, "body": "<code>realloc(input, (sizeof(char))); &#47;&#47;allocate more memory</code> This comment is wrong. Reallocating 1 byte to 1 byte is allocating no more memory. Ignoreing what is returned from <code>realloc()</code> is also bad."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1466003236, "post_id": 37839153, "comment_id": 63139299, "body": "Also don&#39;t forget to allocate space for the terminator."}, {"owner": {"reputation": 13, "user_id": 5326984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b171b826072f05089f082a23c327a2d?s=128&d=identicon&r=PG&f=1", "display_name": "t1msu", "link": "https://stackoverflow.com/users/5326984/t1msu"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1466003338, "post_id": 37839153, "comment_id": 63139381, "body": "This seems to work:    <code>realloc(input, (sizeof(char)*length+1)); </code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1466003453, "post_id": 37839153, "comment_id": 63139454, "body": "@t1msu <i>This seems to work: <code>realloc(input, (sizeof(char)*length+1));</code></i>  And what do you assign the returned pointed to?  Also, <code>getchar()</code> returns <code>int</code>, not <code>char</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1466004973, "post_id": 37839153, "comment_id": 63140571, "body": "Do not cast the return value of malloc and friends."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466008155, "post_id": 37840700, "comment_id": 63142776, "body": "On a side note, code should return <code>NULL</code> is the very first <code>getchar()</code> returns <code>EOF</code> to indicate to the calling code end-of-file."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1466007820, "last_edit_date": 1495542244, "creation_date": 1466007339, "answer_id": 37840700, "question_id": 37839153, "link": "https://stackoverflow.com/questions/37839153/c-read-string-into-dynamic-array/37840700#37840700", "title": "C: read string into dynamic array", "body": "<p><code>realloc(input, (sizeof(char))); //allocate more memory</code> only allocates 1 <code>char</code>.  Not 1 <em>more</em> <code>char</code>.  <a href=\"https://stackoverflow.com/questions/37839153/c-read-string-into-dynamic-array/37840700#comment63139211_37839153\">@MikeCAT</a></p>\n\n<p><code>(sizeof(char)*length+1)</code> is semantically wrong.  Should be <code>(sizeof(char)*(length+1))</code>, but since <code>sizeof (char) == 1</code>, it makes no functional difference.  </p>\n\n<p>Need space for the null character. <a href=\"https://stackoverflow.com/questions/37839153/c-read-string-into-dynamic-array/37840700#comment63139299_37839153\">@MikeCAT</a></p>\n\n<p>Should test for reallocation failure.</p>\n\n<p><code>char c</code> is insufficient to distinguish all 257 different responses from <code>getchar()</code>.  Use <code>int</code>.  <code>getchar()</code> may return <code>EOF</code>.  <a href=\"https://stackoverflow.com/questions/37839153/c-read-string-into-dynamic-array/37840700#comment63139454_37839153\">@Andrew Henle</a></p>\n\n<p>Minor: Better to use <code>size_t</code> for array indexes than <code>int</code>.  <code>int</code> maybe too narrow.</p>\n\n<p>In the end code needs to do something like:</p>\n\n<pre><code>size_t length = 0;\nchar *input = malloc(1);\nassert(input); \nint c;\n...\nwhile((c = getchar()) != '\\n' &amp;&amp; c != EOF) {\n  char *t = realloc(input, length + 1);\n  assert(t); \n  input = t;\n  input[length++] = c;\n}\n...\nreturn input;\n\nint main(void) {\n  ...\n  input = read_string_from_terminal();\n  printf(\"Output \\n %s\", input);\n  free(input);\n  return EXIT_SUCCESS;\n}    \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5326984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b171b826072f05089f082a23c327a2d?s=128&d=identicon&r=PG&f=1", "display_name": "t1msu", "link": "https://stackoverflow.com/users/5326984/t1msu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2247, "favorite_count": 0, "accepted_answer_id": 37840700, "answer_count": 1, "score": 0, "last_activity_date": 1466007820, "creation_date": 1466003051, "question_id": 37839153, "link": "https://stackoverflow.com/questions/37839153/c-read-string-into-dynamic-array", "title": "C: read string into dynamic array", "body": "<p>Hi im trying to read user input of \"unlimited\" length into an char array. It works fine for shorter strings, but for more than around 30 characters the programm crashes. Why does this happen and how can i fix this?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar* read_string_from_terminal()//reads a string of variable length and returns a pointer to it\n{\n    int length = 0; //counts number of characters\n    char c; //holds last read character\n    char *input;\n\n    input = (char *) malloc(sizeof(char)); //Allocate initial memory\n\n    if(input == NULL) //Fail if allocating of memory not possible\n    {\n        printf(\"Could not allocate memory!\");\n        exit(EXIT_FAILURE);\n    }\n\n    while((c = getchar()) != '\\n') //until end of line\n    {\n        realloc(input, (sizeof(char))); //allocate more memory\n        input[length++] = c; //save entered character\n    }\n\n    input[length] = '\\0'; //add terminator\n    return input;\n\n}\n\nint main()\n{\n    printf(\"Hello world!\\n\");\n    char* input;\n    printf(\"Input string, finish with Enter\\n\");\n    input = read_string_from_terminal();\n    printf(\"Output \\n %s\", input);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "security", "posix", "alloca"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1466003748, "post_id": 37838948, "comment_id": 63139671, "body": "<code>alloca()</code> is no more or less dangerous than using a variable-length array (VLA)."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1466003767, "post_id": 37838948, "comment_id": 63139690, "body": "Provided that you&#39;re not pushing the limits of your stack space already, it should be fine.  As long as the allocating function doesn&#39;t return before everything is done with the buffer, and as long as the function you pass it to doesn&#39;t free or resize it, there wouldn&#39;t be a problem."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1466003862, "post_id": 37838948, "comment_id": 63139762, "body": "Micro-optimizing error handling and reporting code is not useful, nobody can read that fast.  Just use the free store and you&#39;ll never have to be sorry."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1466004308, "post_id": 37838948, "comment_id": 63140081, "body": "@Dmitri What I&#39;m concerned with is whether the error message length could be (by an attacker) made extremely long, causing a stack overflow."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1466004459, "post_id": 37838948, "comment_id": 63140184, "body": "@HansPassant True, but using <code>malloc</code> is not that nice, because the application uses a garbage collected heap <i>and</i> is further processing that error message directly afterwards (storing a not NULL terminated copy of it). Currently there&#39;s a (large) fixed size buffer on the stack, I&#39;d like to make that a bit more elegant."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1466004627, "post_id": 37838948, "comment_id": 63140305, "body": "@DanielJour If you&#39;re concerned with an attacker causing a stack overflow, use a fixed-length array of a known safe size and either don&#39;t allow longer error messages to be generated or use <code>malloc()</code>/<code>free()</code> for longer messages."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1466004712, "post_id": 37838948, "comment_id": 63140369, "body": "@Dmitri Yes, but if the first invocation of <code>regerror</code> returns a huge size, I&#39;ll <code>alloca</code> too much on the stack (causing the overflow)."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1466004802, "post_id": 37838948, "comment_id": 63140438, "body": "Just check the length returned by the first call, and if it&#39;s ridiculously large use a smaller one and live with a truncated error message.. or fall back to a dynamically allocated buffer in that case.."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1466004804, "post_id": 37838948, "comment_id": 63140439, "body": "@AndrewHenle Yes, I guess that&#39;s what I&#39;m doing then. In the expected case, the messages are quite short, so this&#39;ll probably keep the buffer stack allocated unless somebody is actively trying to do harm."}], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466002514, "creation_date": 1466002514, "question_id": 37838948, "link": "https://stackoverflow.com/questions/37838948/is-it-safe-to-alloca-the-buffer-for-regerror", "title": "Is it safe to alloca the buffer for regerror?", "body": "<p><a href=\"http://linux.die.net/man/3/regerror\" rel=\"nofollow\"><code>regerror</code></a> returns the number of bytes that are needed to store the error message. Since the application I'm working with isn't going \"deep\" in the stack (i.e. no deeply nested function calls) I was thinking about using <a href=\"http://man7.org/linux/man-pages/man3/alloca.3.html\" rel=\"nofollow\"><code>alloca</code></a> (which the application is already using for other purposes) to acquire temporary storage for the error message on the stack (rather than the heap).</p>\n\n<p>Is it safe to assume that the error message (length) will be bounded, so that I don't run into a stack overflow?</p>\n\n<p>Does this open a security hole (by manipulating the used message catalog)?</p>\n\n<pre><code>size_t const length = regerror(status, regex, NULL, 0);\nchar * const buffer = alloca(length);\nsize_t const check_length = regerror(status, regex, buffer, length);\nassert(check_length == length);\n</code></pre>\n"}, {"tags": ["c", "sockets", "select", "nonblocking"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1466002000, "post_id": 37838490, "comment_id": 63138417, "body": "If you use <code>gcc</code> compile it with warnings enabled <code>-Wall -Wextra</code>, this way it finds more issues at compile time."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1466002384, "post_id": 37838490, "comment_id": 63138665, "body": "Note that you need to reconstruct the FD sets on each iteration; the call to <code>select</code> modifies the input/output parameters, destroying what you had set up. See <a href=\"https://stackoverflow.com/questions/4563577\">Is it necessary to reset the FD set between <code>select()</code> system calls?</a>, <a href=\"https://stackoverflow.com/questions/2421672\">Are there any platforms where using structure copy on an FD set doesn&#39;t work?</a>, <a href=\"https://stackoverflow.com/questions/3324078\">Why <code>select()</code> always returns 0 after the first timeout?</a>, <a href=\"https://stackoverflow.com/questions/14544621\">Why is <code>select</code> used on Linux?</a> \u2026"}, {"owner": {"reputation": 47, "user_id": 6398512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb9a6955c7225b209cba72fb37730c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter D", "link": "https://stackoverflow.com/users/6398512/peter-d"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1466002614, "post_id": 37838490, "comment_id": 63138835, "body": "@JonathanLeffler Could you please elaborate a bit more about reconstruct the FD sets? does it mean I have to use <code>FD_COPY</code>? Thanks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1466002855, "post_id": 37838490, "comment_id": 63139003, "body": "@PeterD: I&#39;ve added some links to semi-relevant questions which cover the issue.  If FD_COPY() is available (it isn&#39;t standardized by POSIX), then you should be OK using it.  See the question on using structure copy."}, {"owner": {"reputation": 47, "user_id": 6398512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb9a6955c7225b209cba72fb37730c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter D", "link": "https://stackoverflow.com/users/6398512/peter-d"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1466003200, "post_id": 37838490, "comment_id": 63139268, "body": "@JonathanLeffler I see. Thanks for the info."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6398512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb9a6955c7225b209cba72fb37730c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter D", "link": "https://stackoverflow.com/users/6398512/peter-d"}, "edited": false, "score": 0, "creation_date": 1466002280, "post_id": 37838689, "comment_id": 63138594, "body": "Sorry, I missed that when trying to simplify the actual code to post it here. It is set as <code>FD_SET(i, &amp;write_fds);</code>"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1466001904, "creation_date": 1466001904, "answer_id": 37838689, "question_id": 37838490, "link": "https://stackoverflow.com/questions/37838490/how-to-properly-set-a-flag-in-the-write-fds-and-select-in-c/37838689#37838689", "title": "How to properly set a flag in the write_fds and select() in C", "body": "<p>In:</p>\n\n<pre><code>FD_SET(i, write_fds);\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>FD_SET(i, &amp;write_fds);\n</code></pre>\n\n<p>(note the ampersand).</p>\n"}, {"comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1466003212, "post_id": 37839104, "comment_id": 63139277, "body": "Also he doesn&#39;t check the result of the <code>select()</code>."}, {"owner": {"reputation": 47, "user_id": 6398512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb9a6955c7225b209cba72fb37730c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter D", "link": "https://stackoverflow.com/users/6398512/peter-d"}, "edited": false, "score": 0, "creation_date": 1466003290, "post_id": 37839104, "comment_id": 63139333, "body": "Thanks, I&#39;ll look into it."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1466003586, "post_id": 37839104, "comment_id": 63139553, "body": "Also the check on the result of <code>send()</code> if the read flag is set is incorrect, it should read  <code>if ((sent &gt; 0 ||...</code>As it stands, it will only do the select on write if the read returns an error."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 1, "last_activity_date": 1466004096, "last_edit_date": 1466004096, "creation_date": 1466002954, "answer_id": 37839104, "question_id": 37838490, "link": "https://stackoverflow.com/questions/37838490/how-to-properly-set-a-flag-in-the-write-fds-and-select-in-c/37839104#37839104", "title": "How to properly set a flag in the write_fds and select() in C", "body": "<p>You should have <code>FD_ZERO</code> and <code>FD_SET</code>s before calling select function.</p>\n\n<p>E.g.</p>\n\n<pre><code>int res = 0;\nfor(;;){\n     FD_ZERO(&amp;read_fds);\n     FD_ZERO(&amp;write_fds);    \n\n     fdmax = 0;\n     size_t fd_index;\n     for (fd_index=0; fd_index&lt;num_of_fd; fd_index++)\n     {\n        FD_SET(fd_array[fd_index], &amp;read_fds);  \n        FD_SET(fd_array[fd_index], &amp;write_fds);  \n\n        if (fdmax &lt; fd_array[fd_index])\n           fdmax = fd_array[fd_index];\n     }\n\n    // write_fds = master;\n    res = select(fdmax+1, &amp;read_fds, &amp;write_fds, NULL, NULL);\n\n    if( res == 0 )\n    {\n       // TIMEOUT ...not your case\n    }\n    else if( res &lt; 0 )\n    {\n        perror(\"Select error: \");\n    }\n    else\n    {\n        // process your data\n    }\n</code></pre>\n\n<p>And you cannot write</p>\n\n<pre><code>read_fds = master;\n</code></pre>\n\n<p>because of <code>fd_set</code> is a complex struct.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>As @jeremyP commented <code>sent &lt; 0</code> should be <code>sent &gt; 0</code></p>\n"}], "owner": {"reputation": 47, "user_id": 6398512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb9a6955c7225b209cba72fb37730c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter D", "link": "https://stackoverflow.com/users/6398512/peter-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 37839104, "answer_count": 2, "score": 0, "last_activity_date": 1466004096, "creation_date": 1466001366, "last_edit_date": 1466002236, "question_id": 37838490, "link": "https://stackoverflow.com/questions/37838490/how-to-properly-set-a-flag-in-the-write-fds-and-select-in-c", "title": "How to properly set a flag in the write_fds and select() in C", "body": "<p>When the <code>send()</code> buffer is full, I set a flag in the write_fds for the given socket and the next iteration tries to send it by checking that write_fds is set.</p>\n\n<p>It works fine setting the flag in write_fds for one socket. But, if I do <code>FD_SET(i, write_fds)</code> for multiple sockets, only the last socket appears as set and only the last socket gets the data.</p>\n\n<p>If I do <code>write_fds = master;</code> right before <code>select(2)</code>, then all of them appear as set and all unsent data is sent to all sockets, but <code>select</code> always returns. </p>\n\n<p>I'm sure I must be doing something wrong.</p>\n\n<pre><code>FD_ZERO(&amp;master);\nFD_ZERO(&amp;read_fds);\nFD_ZERO(&amp;write_fds);\n\n// socket setting...\n// bind...\n// listen...\n\nFD_SET(listener, &amp;master);\nfdmax = listener; // so far, it's this one\nfor(;;){\n    read_fds = master; // copy it\n    // write_fds = master;\n    select(fdmax+1, &amp;read_fds, &amp;write_fds, NULL, NULL);\n\n    for(i = 0; i &lt;= fdmax; i++){\n        if(FD_ISSET(i, &amp;read_fds)) {\n            if(i == listener){\n                addrlen = sizeof remoteaddr;\n                newfd = accept(listener, (struct sockaddr * ) &amp; remoteaddr, &amp;addrlen);\n                FD_SET(newfd, &amp;master);\n                if(newfd &gt; fdmax)\n                    fdmax = newfd;\n                fcntl(newfd, F_SETFL, fcntl(newfd, F_GETFL, 0) | O_NONBLOCK);\n            }else{\n                // do some reading and then... send\n                sent = send(i, buf, len, 0);\n                if ((sent &lt; 0 || (sent == -1 &amp;&amp; errno == EWOULDBLOCK))\n                    FD_SET(i, &amp;write_fds);\n            }  \n        }  \n        else if(FD_ISSET(i, &amp;write_fds) &amp;&amp; i != listener){\n            if((sent = send(i, buf, len - sent, 0)) == len - sent)\n                FD_CLR(i, &amp;write_fds);\n        }  \n    }  \n}\n</code></pre>\n"}, {"tags": ["c", "naming-conventions", "atoi"], "comments": [{"owner": {"reputation": 2742, "user_id": 4892515, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/JHSqd.png?s=128&g=1", "display_name": "Antoine Pelletier", "link": "https://stackoverflow.com/users/4892515/antoine-pelletier"}, "edited": false, "score": 1, "creation_date": 1466002316, "post_id": 37838417, "comment_id": 63138619, "body": "Programmers used to be lazy, and they wanted short name for their functons so it was faster to write these with a keyboard. 4 letters was quite enough, it was even considered too long, but they kept it anyway, being too lazy to change them."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1466002344, "post_id": 37838417, "comment_id": 63138635, "body": "<b>a</b>rray to <b>i</b>nt"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "reply_to_user": {"reputation": 2742, "user_id": 4892515, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/JHSqd.png?s=128&g=1", "display_name": "Antoine Pelletier", "link": "https://stackoverflow.com/users/4892515/antoine-pelletier"}, "edited": false, "score": 0, "creation_date": 1466007417, "post_id": 37838417, "comment_id": 63142302, "body": "@AntoinePelletier I wouldn&#39;t say lazy, I would say memory constrained. Remember C was written on incredibly limited hardware (ram was measured in bytes or perhaps kilobytes). I believe C originally had an 8 character limit on function names.  I personally worked on a system that you couldn&#39;t chain compile and link on the same command line due to their being /only/ 64Kb of ram on the whole (multiuser) system !"}, {"owner": {"reputation": 2742, "user_id": 4892515, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/JHSqd.png?s=128&g=1", "display_name": "Antoine Pelletier", "link": "https://stackoverflow.com/users/4892515/antoine-pelletier"}, "reply_to_user": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1466011010, "post_id": 37838417, "comment_id": 63144357, "body": "@Neil i was just joking, i should have added a Chuck Norris fact through my post to make it obvious"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "reply_to_user": {"reputation": 2742, "user_id": 4892515, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/JHSqd.png?s=128&g=1", "display_name": "Antoine Pelletier", "link": "https://stackoverflow.com/users/4892515/antoine-pelletier"}, "edited": false, "score": 1, "creation_date": 1466069174, "post_id": 37838417, "comment_id": 63168368, "body": "@AntoinePelletier I missed that whooshing sound when your joke flew over my head :-)"}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1466002062, "post_id": 37838475, "comment_id": 63138458, "body": "The interesting fact is, that these functions would work for EBCDIC character tables equally well."}, {"owner": {"reputation": 50428, "user_id": 950427, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hq0mB.jpg?s=128&g=1", "display_name": "Jared Burrows", "link": "https://stackoverflow.com/users/950427/jared-burrows"}, "edited": false, "score": 2, "creation_date": 1466008839, "post_id": 37838475, "comment_id": 63143162, "body": "11/3/71 - wow. Do you have this book in real life?"}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 50428, "user_id": 950427, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hq0mB.jpg?s=128&g=1", "display_name": "Jared Burrows", "link": "https://stackoverflow.com/users/950427/jared-burrows"}, "edited": false, "score": 0, "creation_date": 1466018661, "post_id": 37838475, "comment_id": 63148594, "body": "@JaredBurrows I wasn&#39;t conceived even as a concept in my father&#39;s mind back then."}, {"owner": {"reputation": 50428, "user_id": 950427, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hq0mB.jpg?s=128&g=1", "display_name": "Jared Burrows", "link": "https://stackoverflow.com/users/950427/jared-burrows"}, "edited": false, "score": 0, "creation_date": 1466021068, "post_id": 37838475, "comment_id": 63149910, "body": "@101010 Alright. I was being serious because I still have a C book that my father gave me."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 50428, "user_id": 950427, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hq0mB.jpg?s=128&g=1", "display_name": "Jared Burrows", "link": "https://stackoverflow.com/users/950427/jared-burrows"}, "edited": false, "score": 1, "creation_date": 1466060878, "post_id": 37838475, "comment_id": 63163032, "body": "@JaredBurrows I guess is nice to have a father that lived the beginning of the Information Age, many things to talk about :). From where I come from though, my parents weren&#39;t such fortunate, at that time it would be an achievement if a kid would finish the primary. Books were rare and they didn&#39;t have electricity in many parts of the country. Thanks to USA the land of the free and the home of the brave we have the internet now and these books as many others are available for everyone online."}, {"owner": {"reputation": 50428, "user_id": 950427, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hq0mB.jpg?s=128&g=1", "display_name": "Jared Burrows", "link": "https://stackoverflow.com/users/950427/jared-burrows"}, "edited": false, "score": 0, "creation_date": 1466086055, "post_id": 37838475, "comment_id": 63180409, "body": "@101010 Awesome to here! Thanks for the great answer and the image."}], "tags": [], "owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "is_accepted": true, "score": 32, "last_activity_date": 1466004550, "last_edit_date": 1466004550, "creation_date": 1466001310, "answer_id": 37838475, "question_id": 37838417, "link": "https://stackoverflow.com/questions/37838417/what-do-atoi-atol-and-stoi-stand-for/37838475#37838475", "title": "What do atoi, atol, and stoi stand for?", "body": "<pre><code>atoi  -&gt; ASCII to integer.\natol  -&gt; ASCII to long.\natof  -&gt; ASCII to floating.\nstoi  -&gt; string to integer.\nstol  -&gt; string to long.\nstoll -&gt; string to long long.\nstof  -&gt; string to float. \nstod  -&gt; string to double.\nstold -&gt; string to long double.\n</code></pre>\n\n<p><code>atoi</code>, <code>atol</code>, <code>atof</code> come from <code>C</code> and its godfather most probably is considered to be <a href=\"https://en.wikipedia.org/wiki/Ken_Thompson\" rel=\"noreferrer\">Ken Thompson</a> the co-creator of the UNIX operating system and the creator of the <a href=\"https://en.wikipedia.org/wiki/B_(programming_language)\" rel=\"noreferrer\">B programming language</a> which is the predecessor of the C programming language. The names are mentioned in the first <a href=\"https://www.bell-labs.com/usr/dmr/www/man31.pdf\" rel=\"noreferrer\">UNIX Programmer's Manual November 3, 1971</a> and as you can see in the owner's label <code>ken</code> is mentioned which is the nickname of Ken Thomson:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MuppQ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MuppQ.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OMHfT.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/OMHfT.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"http://cm.bell-labs.com/7thEdMan/vol1/man3.bun\" rel=\"noreferrer\"></a></p>\n\n<p><code>stoi</code>, <code>stol</code>, <code>stoll</code>, <code>stof</code>, <code>stod</code> and <code>stold</code> got in C++ since C++11. Consequently, the naming must have been a unanimous decision of the C++ committee. The original proposal <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1803.html\" rel=\"noreferrer\">N1803</a> though dates back in 2005. I couldn't find in the proposal why the named these functions after these names. My guess is that probably they wanted to keep the uniformity with their C \"equivalents\" mentioned above. </p>\n"}], "owner": {"reputation": 763, "user_id": 2130376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45e7b072a367ac2ee2ee0a12b83248ec?s=128&d=identicon&r=PG", "display_name": "yesennes", "link": "https://stackoverflow.com/users/2130376/yesennes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6903, "favorite_count": 2, "closed_date": 1466010554, "accepted_answer_id": 37838475, "answer_count": 1, "score": 17, "last_activity_date": 1466022522, "creation_date": 1466001191, "last_edit_date": 1466022522, "question_id": 37838417, "link": "https://stackoverflow.com/questions/37838417/what-do-atoi-atol-and-stoi-stand-for", "closed_reason": "Duplicate", "title": "What do atoi, atol, and stoi stand for?", "body": "<p>I understand what said functions do, but I can't guess how their names were created, except that the last letter is from the return type.</p>\n"}, {"tags": ["c", "io", "mpi", "mpi-io"], "comments": [{"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1466006046, "post_id": 37838228, "comment_id": 63141358, "body": "Do you always know the header sizes upfront, and are they all identical (the sizes)? If so, you can create a view for process #0 that include the header and data, and another for the other processes that only includes the data. Then you&#39;d have only one call to make to <code>MPI_File_set_view()</code> and 2 calls to <code>MPI_File_write()</code> per iteration for rank #0 and one for the other ranks."}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1466008026, "post_id": 37838228, "comment_id": 63142705, "body": "@Gilles I know the header sizes upfront.  They are not all identical, unfortunately.  I can&#39;t change that.  Not my design."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1466068457, "post_id": 37838228, "comment_id": 63167873, "body": "There is a bug in your code: <code>end_of_hdr</code> is of type <code>MPI_Offset</code> and you are broadcasting it using <code>MPI_INT</code>. <code>MPI_Offset</code> is typically 64-bit while <code>MPI_INT</code> corresponds to <code>int</code>, which on LP64 Unix systems (*BSD, Linux, Solaris) is only 32-bit. On a big endian system, a very wrong offset will get broadcasted. Use <code>MPI_OFFSET</code> (if supported by the MPI implementation) or the corresponding C type (check your <code>mpi.h</code>)"}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1466086334, "post_id": 37838228, "comment_id": 63180611, "body": "@HristoIliev  Thank you.  I was wondering about that.  Couldn&#39;t find anything about &quot;MPI_OFFSET&quot; in the standard so I tried MPI_INT.  It worked, so I figured that must be the ticket.  But I guess not.  Will look into it.  Thanks again."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1466087575, "post_id": 37838228, "comment_id": 63181585, "body": "Strange, <code>MPI_AINT</code> and <code>MPI_OFFSET</code> are described together with all the other predefined MPI datatypes in section 3.2.2 (Message Data) of the standard at least since version 2.2."}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1466089889, "post_id": 37838228, "comment_id": 63183252, "body": "It didn&#39;t occur to me that MPI_OFFSET would be its own datatype.  My &quot;go to&quot; for this kind of thing is table 3.2, which doesn&#39;t mention it.  I was assuming that table was exhaustive."}], "answers": [{"comments": [{"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1466105732, "post_id": 37867640, "comment_id": 63192643, "body": "Thanks!  Re: your third bullet, I want only one proc to write the headers.  I wasn&#39;t able to figure out how to do that w/o isolating those calls to MPI_File_write.  Is there a way for everyone to call MPI_File_write, but only one proc do the actual writing?  Thanks again!"}, {"owner": {"reputation": 4724, "user_id": 1024740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1037d544b43c71c34225fac55e0c7750?s=128&d=identicon&r=PG", "display_name": "Rob Latham", "link": "https://stackoverflow.com/users/1024740/rob-latham"}, "reply_to_user": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 1, "creation_date": 1466105860, "post_id": 37867640, "comment_id": 63192736, "body": "absolutely.    It&#39;s fair to have N processes call a collective operation, but only one of them has data.  any process can pass in a 0 for the &#39;count&#39; parameter.  However, I was suggesting a single collective where rank 0 writes the header along with the array, while everyone else writes their portion of the array."}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1466106146, "post_id": 37867640, "comment_id": 63192906, "body": "understood.  Thanks once more."}, {"owner": {"reputation": 1464, "user_id": 6155350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d103f3a98e0e4e220200c8d81e755835?s=128&d=identicon&r=PG&f=1", "display_name": "David Henty", "link": "https://stackoverflow.com/users/6155350/david-henty"}, "edited": false, "score": 0, "creation_date": 1466156535, "post_id": 37867640, "comment_id": 63211526, "body": "You should use &quot;MPI_File_write_all&quot; when you write the array - I have seen orders of magnitude performance improvements for large data sets compared to MPI_File_write. Telling the IO library you are doing a collective write (_all) enables it to aggregate data from different processes before writing, e.g. leading to a small number of large IO transactions as opposed to a large number of small transactions, which can significantly improve performance."}], "tags": [], "owner": {"reputation": 4724, "user_id": 1024740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1037d544b43c71c34225fac55e0c7750?s=128&d=identicon&r=PG", "display_name": "Rob Latham", "link": "https://stackoverflow.com/users/1024740/rob-latham"}, "is_accepted": true, "score": 2, "last_activity_date": 1466104538, "creation_date": 1466104538, "answer_id": 37867640, "question_id": 37838228, "link": "https://stackoverflow.com/questions/37838228/mpi-i-o-mix-of-single-and-multiple-process-output/37867640#37867640", "title": "MPI I/O, mix of single- and multiple-process output", "body": "<p>Your approach is fine and if you need something right now to put bits in a file, go ahead and call yourself done.</p>\n\n<p>Here are some suggestions for more efficiency:</p>\n\n<ul>\n<li><p>You can consult the status object for how many bytes were written, instead of getting the position and translating into bytes.</p></li>\n<li><p>If you have the memory to hold all the data before you write, you could describe your I/O with an MPI datatype (admittedly, one that might end up being a pain to create).  Then all processes would issue a single collective call. </p></li>\n<li><p>You should use collective I/O instead of independent I/O.  A \"quality library\" should be able to give you equal if not better performance (and if not, you could raise the issue with your MPI implementation). </p></li>\n<li><p>If the processes have different amounts of data to write, MPI_EXSCAN is a good way to collect who has what data.  Then you can call MPI_FILE_WRITE_AT_ALL to the correct offset in the file.</p></li>\n</ul>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 37867640, "answer_count": 1, "score": 1, "last_activity_date": 1524153639, "creation_date": 1466000711, "last_edit_date": 1524153639, "question_id": 37838228, "link": "https://stackoverflow.com/questions/37838228/mpi-i-o-mix-of-single-and-multiple-process-output", "title": "MPI I/O, mix of single- and multiple-process output", "body": "<p>I need an MPI C code to write data to a binary file via MPI I/O.  I need process 0 to write a short header, then I need the whole range of processes to write their own pieces of the array indicated by the header.  Then I need process 0 to write another header, followed by all processes writing their pieces of the next array, etc.  I came up with the following test code which actually does what I want.  No one will be more surprised about that than me.  </p>\n\n<p>My question is, I am new at MPI I/O.  So am I \"getting it\"?  Am I doing this the \"right way\" or is there some more efficient or compact way to do it?  </p>\n\n<p>Code is:  (BTW, if you think of testing this, try it with 4 procs only.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include \"mpi.h\"\n\n#define ROWS 9\n#define COLS 10\n\nint main(int argc, char *argv[]) {\n\n   int size_mpi, rank_mpi, row_mpi, col_mpi;\n   int i,j,p,ttlcols;\n   int sizes[]= {2*ROWS,2*COLS};\n   int subsizes[]= {ROWS,COLS};\n   int starts[] = {0,0};\n   int vals[ROWS][COLS];\n   char hdr[] = \"This is just a header.\\n\";\n   MPI_Status stat_mpi;\n   MPI_Datatype subarray;\n   MPI_File fh;\n   MPI_Offset offset, end_of_hdr;\n   MPI_Info info_mpi;\n\n   MPI_Init(&amp;argc, &amp;argv);\n   MPI_Comm_size(MPI_COMM_WORLD,&amp;size_mpi);\n   MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank_mpi);\n\n   ttlcols = 2*COLS;\n   /* Where are we in the array of processes? */\n   col_mpi = rank_mpi%2;\n   row_mpi = rank_mpi/2;\n   /* Populate the array */\n   for (j=0; j&lt;ROWS; j++){\n      for (i=0; i&lt;COLS; i++){\n         vals[j][i] = ttlcols*(ROWS*row_mpi + j) +\n                      COLS*col_mpi + i;\n      }\n   } \n   /* MPI derived datatype for setting a file view */    \n   starts[0] = row_mpi*ROWS;\n   starts[1] = col_mpi*COLS;\n   MPI_Type_create_subarray(2, sizes, subsizes, starts,\n                            MPI_ORDER_C, MPI_INT,\n                            &amp;subarray); \n   MPI_Type_commit(&amp;subarray);\n   /* open the file */    \n   printf(\"opening file\\n\");\n   MPI_File_open(MPI_COMM_WORLD, \"arrdata.dat\", \n                 MPI_MODE_WRONLY | MPI_MODE_CREATE,\n                 MPI_INFO_NULL, &amp;fh);\n   printf(\"opened file\\n\");\n   /* set the initial file view */    \n   MPI_File_set_view(fh, 0, MPI_CHAR, MPI_CHAR, \"native\", MPI_INFO_NULL);\n   /* proc 0 writes first header */    \n   if (rank_mpi == 0) {\n      MPI_File_write(fh, (void*)hdr, strlen(hdr), MPI_CHAR, &amp;stat_mpi);\n      MPI_File_get_position(fh, &amp;offset);\n      MPI_File_get_byte_offset(fh, offset, &amp;end_of_hdr); \n   }\n   /* everybody has to know where proc 0 stopped writing */    \n   MPI_Bcast((void*)&amp;end_of_hdr, 1, MPI_INT, 0, MPI_COMM_WORLD);\n   /* re-set file view for writing first array */    \n   MPI_File_set_view(fh, end_of_hdr, MPI_INT,\n                     subarray, \"native\",\n                     MPI_INFO_NULL);\n   /* and write the array */    \n   MPI_File_write(fh, (void*)vals, ROWS*COLS, MPI_INT,\n                  &amp;stat_mpi);\n\n   /* now go through the whole thing again to test */\n   MPI_File_get_position(fh, &amp;offset);\n   MPI_File_get_byte_offset(fh, offset, &amp;end_of_hdr); \n   MPI_File_set_view(fh, end_of_hdr, MPI_CHAR, MPI_CHAR, \"native\", MPI_INFO_NULL);\n   if (rank_mpi == 0) {\n      MPI_File_write(fh, (void*)hdr, strlen(hdr), MPI_CHAR, &amp;stat_mpi);\n      MPI_File_get_position(fh, &amp;offset);\n      MPI_File_get_byte_offset(fh, offset, &amp;end_of_hdr); \n   }\n\n   MPI_Bcast((void*)&amp;end_of_hdr, 1, MPI_INT, 0, MPI_COMM_WORLD);\n\n   MPI_File_set_view(fh, end_of_hdr, MPI_INT,\n                     subarray, \"native\",\n                     MPI_INFO_NULL);\n   MPI_File_write(fh, (void*)vals, ROWS*COLS, MPI_INT,\n                  &amp;stat_mpi);\n   MPI_File_close(&amp;fh);\n\n   MPI_Finalize();\n\n   return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86", "inline-assembly", "fpic"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1466004136, "post_id": 37837918, "comment_id": 63139954, "body": "You shouldn&#39;t need to restore EBX.  A PIC compiled function should have something at the start of the function that sets it. (eg. a call to <code>__x86.get_pc_thunk.bx</code>)."}, {"owner": {"reputation": 75, "user_id": 5434731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc812be28276a178bf28e98c7c17e4a5?s=128&d=identicon&r=PG&f=1", "display_name": "Thilo Schulz", "link": "https://stackoverflow.com/users/5434731/thilo-schulz"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1466005050, "post_id": 37837918, "comment_id": 63140633, "body": "Holy cow you&#39;re right. I guess it makes sense, because each PIC object will come with its own symbol table. If you add your answer I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "is_accepted": true, "score": 4, "last_activity_date": 1466005914, "creation_date": 1466005914, "answer_id": 37840239, "question_id": 37837918, "link": "https://stackoverflow.com/questions/37837918/address-of-global-symbol-table-got-in-pic-pie-binaries/37840239#37840239", "title": "Address of global symbol table (GOT) in PIC/PIE binaries", "body": "<p>In the <a href=\"http://www.sco.com/developers/devspecs/abi386-4.pdf\" rel=\"nofollow\">System V i386 ABI</a> its the responsibility of the function being called to set EBX if necessary, so there shouldn't be any need to restore it when calling PIC/PIE compiled functions. As the ABI states:</p>\n\n<blockquote>\n  <p>Position-independent code uses the <code>%ebx</code> register to hold the address\n  of the global offset table. If a function needs the global offset\n  table\u2019s address, either directly or indirectly, it is responsible for\n  computing the value.</p>\n</blockquote>\n"}], "owner": {"reputation": 75, "user_id": 5434731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc812be28276a178bf28e98c7c17e4a5?s=128&d=identicon&r=PG&f=1", "display_name": "Thilo Schulz", "link": "https://stackoverflow.com/users/5434731/thilo-schulz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "accepted_answer_id": 37840239, "answer_count": 1, "score": 2, "last_activity_date": 1466007604, "creation_date": 1465999859, "last_edit_date": 1466007604, "question_id": 37837918, "link": "https://stackoverflow.com/questions/37837918/address-of-global-symbol-table-got-in-pic-pie-binaries", "title": "Address of global symbol table (GOT) in PIC/PIE binaries", "body": "<p>I am maintaining the <a href=\"https://github.com/thiloschulz/ioq3/blob/master/code/qcommon/vm_x86.c\" rel=\"nofollow\">JIT compiler for the virtual machine in ioquake3</a>. </p>\n\n<p>Recently someone tried to build a PIE binary from ioquake3, however compiled code makes extensive use of the EBX register which in PIC code and thus PIE binaries seems to be a fixed register containing the GOT address.</p>\n\n<p>The virtual machine may call into GCC-compiled code at a fixed point so there I will need to restore EBX to the GOT address.\nFor that the JIT-compiler code needs to know the GOT address so that it can emit code that restores EBX to that address.\nI imagine you could directly use inline assembly like so:</p>\n\n<pre><code>void *gotptr;\n\n__asm__ volatile(\"\\n\": \"=b\" (gotptr));\n</code></pre>\n\n<p>Compiled code is directly called from the JIT-compiler code so EBX should be the same at JIT compile and at the call into the VM. My question is: would this work, and is there a different way to retrieve the GOT address from C code, for instance, is there a symbol defined that specifies that address, or is there a function that returns it?</p>\n"}, {"tags": ["c", "debugging", "macros", "embedded", "printf"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1466003078, "post_id": 37837904, "comment_id": 63139186, "body": "Generally I would advise to forget all about stdio and roll out your own simple debug routines. The overhead that stdio comes with typically slaughter all free memory and CPU performance in any embedded system. On top of that, it is a dangerous library with non-existent type safety."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1466028581, "post_id": 37837904, "comment_id": 63153380, "body": "<code>printf</code> is not really debugging. In addition to what @Lundin wrote: use a debugger for debugging. However that UART is handled, it will eventually either loose text or block. Not to talk about how to <code>printf</code> from interrupt handlers."}], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "edited": false, "score": 0, "creation_date": 1466001732, "post_id": 37838016, "comment_id": 63138199, "body": "Why do you use &quot;do{}while(0)&quot; when DEBUG_LEVEL_0 is not defined? Do I use &quot;edi_Print_L0(...) printf(...)&quot;?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "edited": false, "score": 0, "creation_date": 1466001912, "post_id": 37838016, "comment_id": 63138350, "body": "I don&#39;t know which is your compiler but I&#39;m 99% sure it does not compile. BTW what do you think is the difference between <code>printf(...)</code> and <code>printf(__VA_ARGS__)</code>?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "edited": false, "score": 0, "creation_date": 1466008141, "post_id": 37838016, "comment_id": 63142768, "body": "@Federico : Yes but does your code compile!? If you want a macro to do nothing, then it should have no content at all (or the &quot;no-loop&quot; suggested or even just <code>(void)0</code>).  Calling printf with no arguments at all is probably an error, and even if you had <code>printf(&quot;&quot;)</code> you are still calling <code>printf</code> entirely unnecessarily.  See <a href=\"http://stackoverflow.com/questions/1306611/how-do-i-implement-no-op-macro-or-template-in-c\" title=\"how do i implement no op macro or template in c\">stackoverflow.com/questions/1306611/&hellip;</a>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1466008532, "post_id": 37838016, "comment_id": 63142976, "body": "@LPs: What do you believe <code>printf(##__VA_ARGS__)</code> will do? I think it will throw a syntax error after not being able to concatenate a parenthesis with the first token in the first argument of the argument list, if any. Perhaps you are thinking of the gcc extension which only applies if the <code>##</code> is following a comma?"}, {"owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1466060616, "post_id": 37838016, "comment_id": 63162844, "body": "@Clifford: Yes my code dosen&#39;t compile. To solve the problem I used the empty loop. Is it better to use no-loop or void function (for the coding style)?Thanks!"}, {"owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1466061087, "post_id": 37838016, "comment_id": 63163181, "body": "@Clifford: I use this statement &quot;#define edi_Print_L0(...) (void(0))&quot; I obtain a compiler error. Instead if I use &quot;#define edi_Print_L0(...) do{}while(0)&quot; everything works."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "edited": false, "score": 0, "creation_date": 1466066517, "post_id": 37838016, "comment_id": 63166577, "body": "@Federico : I&#39;d ask what compiler you were using and what error message you received and the exact code that provoked it, but that is a different question not suited to a comment on someone else&#39;s answer.  There are <i>very good</i> reasons for not using a blank definition as I have in my answer, but my in-house coding standard requires braces for even single statement conditionals so I <i>get away with it</i>."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1466061138, "last_edit_date": 1466061138, "creation_date": 1466000118, "answer_id": 37838016, "question_id": 37837904, "link": "https://stackoverflow.com/questions/37837904/multilevel-debug-with-printf-in-embedded-c/37838016#37838016", "title": "Multilevel debug with printf in embedded C", "body": "<ol>\n<li>I don't know your compiler but <code>printf(...)</code> generates a compiler\nerror.</li>\n<li>Your header cannot compile due to the multiple definition of functions with same names.</li>\n</ol>\n\n<p>To gives you an hint you can simply:</p>\n\n<pre><code>#ifdef DEBUG_LEVEL_0\n#define edi_Print_L0(format, ...) printf(format, ##__VA_ARGS__)\n#else\n#define edi_Print_L0(...) do{}while(0)\n#endif\n</code></pre>\n\n<p>But is better to rethink your header. I used to:</p>\n\n<pre><code>#define STRCAT(a, b, c, d, e) a b c d e\n#define DEBUG(level, message, color, ...) if (level &lt; DEBUG_LEVEL) fprintf(stdout, STRCAT(color, \"%s: %s - \", message, MH_END, \"\\n\"), __FILE__, __func__, ##__VA_ARGS__)\n</code></pre>\n\n<p>where color can b, e.g.:</p>\n\n<pre><code>#define MH_HGREEN   \"\\033[1m\\033[32m\"\n#define MH_END      \"\\033[m\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466009559, "post_id": 37840927, "comment_id": 63143553, "body": "Using concatenation like <code>&quot;\\nD2:%s::%s(%d) &quot; format</code> works fine when <code>format</code> is a string literal, but not when <code>format</code> is a variable.  Perhaps call <code>printf()</code> twice instead?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466010459, "post_id": 37840927, "comment_id": 63144043, "body": "@chux :  That is true, but using a variable for the format string is bad practice in any case due to the potential for format string exploits (or even accidental errors from strings that happen to contain format specifiers).  This implementation actively prevents you from introducing bugs in your debug code - which is always useful!  For example <code>printf( str )</code> would not behave as expected if <code>str</code> pointed to <code>&quot;100%correct&quot;</code> (implausibly perhaps, but you get the idea).  You should always use <code>printf( &quot;%s&quot;, str )</code> instead."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466014438, "post_id": 37840927, "comment_id": 63146172, "body": "Although I disagree with &quot;variable for the format string is bad practice&quot;, UV for a useful answer."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466014795, "post_id": 37840927, "comment_id": 63146362, "body": "@chux : I am surprised that you disagree; it is fairly conventional wisdom, and an essential secure coding practice, up there with not using <code>gets()</code> for example."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466015145, "post_id": 37840927, "comment_id": 63146543, "body": "You might find interesting another approach: <a href=\"http://codereview.stackexchange.com/q/115143/29485\">Formatted print without the need to specify type matching specifiers</a>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466019836, "post_id": 37840927, "comment_id": 63149272, "body": "@chux : Interesting.  An alternative solution is provided in GCC and some other compilers via the -Wformat switch allows type-match checking of format strings, and the <code>format</code> function attribute to add format checking to your own functions that use standard format specifiers."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466029770, "post_id": 37840927, "comment_id": 63153783, "body": "@chux: Nice approach, but more error prone and even more bloat for an embedded system. If you forget the wrapper-macro for the arguments, you are busted. Worse, the compiler cannot help detecting type errors as gcc and other modern compilers do for string literals (variable format strings are a no-go on embedded systems anyway, even iff the overhead of <code>printf</code> is acceptable). IMO, that is something not suited for C. If you really need such features, it might be better to use C++ or some HigherLL like Python."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1466066733, "post_id": 37840927, "comment_id": 63166699, "body": "Note:  There are good reasons for not using a blank definition as I have suggested above.  I&#39;ll leave that for the reader to consider.  If you are in the habit of writing single statement conditional blocks <i>without</i> braces, it will break your code if the statement is one of these &quot;empty&quot;  macros."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1466009584, "last_edit_date": 1466009584, "creation_date": 1466008151, "answer_id": 37840927, "question_id": 37837904, "link": "https://stackoverflow.com/questions/37837904/multilevel-debug-with-printf-in-embedded-c/37840927#37840927", "title": "Multilevel debug with printf in embedded C", "body": "<p>You will need to define <em>all</em> the macros regardless of what level is defined, otherwise any place you invoke a macros that is undefined will generate an error.  The macros you want to be inactive can simply be defined as empty statements.</p>\n\n<p>You also have redefinitions that won't work, for example if <code>DEBUG_LEVEL_0</code> is not defined but <code>DEBUG_LEVEL_1</code> is you have two different definitions of <code>edi_Print_L0()</code>.  Similarly if both <code>DEBUG_LEVEL_0</code> and <code>DEBUG_LEVEL_1</code> are defined you still have multiple definitions. You need to make the definitions <em>mutually exclusive</em>, or if multiple level macro definitions exist ensure only the highest level is active:</p>\n\n<pre><code>#if defined DEBUG_LEVEL_2\n    #define edi_Print_L0(...) printf(__VA_ARGS__)\n    #define edi_Print_L1(...) printf(__VA_ARGS__)\n    #define edi_Print_L2(...) printf(__VA_ARGS__)\n#elif defined DEBUG_LEVEL_1\n    #define edi_Print_L0(...) printf(__VA_ARGS__)\n    #define edi_Print_L1(...) printf(__VA_ARGS__)\n    #define edi_Print_L2(...)\n#elif defined DEBUG_LEVEL_0\n    #define edi_Print_L0(...) printf(__VA_ARGS__)\n    #define edi_Print_L1(...)\n    #define edi_Print_L2(...)\n#else\n    #define edi_Print_L0(...)\n    #define edi_Print_L1(...)\n    #define edi_Print_L2(...)\n#endif\n</code></pre>\n\n<p>I would also suggest a more useful definition for the debug macros such as:</p>\n\n<pre><code>#define edi_Print_L0( format, ... )   printf( \"\\nL0:%s::%s(%d) \" format, __FILE__, __FUNCTION__,  __LINE__, __VA_ARGS__ )\n#define edi_Print_L1( format, ... )   printf( \"\\nL1:%s::%s(%d) \" format, __FILE__, __FUNCTION__,  __LINE__, __VA_ARGS__ )\n#define edi_Print_L2( format, ... )   printf( \"\\nL2:%s::%s(%d) \" format, __FILE__, __FUNCTION__,  __LINE__, __VA_ARGS__ )\n</code></pre>\n\n<p>In that way for example, the line:</p>\n\n<pre><code>edi_Print_L2( \"counter=%d\", counter ) ;\n</code></pre>\n\n<p>in say line 24 of file main.c in function <code>main()</code> when <code>counter</code> equals 25 for example will do nothing at level 0 or 1, but at level 2 will output:</p>\n\n<pre><code>L2:main.c::main(24) counter=25\n</code></pre>\n\n<p>So you get the debug output you require with the exact location in the code and the debug level it was issued at.</p>\n\n<p>A better (more easily maintained) solution is to have a single macro <code>DEBUG_LEVEL</code> with a numeric value:</p>\n\n<pre><code>#if !defined DEBUG_LEVEL\n    #define DEBUG_LEVEL = -1\n#endif\n\n#if DEBUG_LEVEL &gt;= 2\n    #define edi_Print_L2( format, ... )   printf( \"\\nL2:%s::%s(%d) \" format, __FILE__, __FUNCTION__,  __LINE__, __VA_ARGS__ )\n#else\n    #define edi_Print_L2(...)\n#endif\n\n#if DEBUG_LEVEL &gt;= 1\n    #define edi_Print_L1( format, ... )   printf( \"\\nL1:%s::%s(%d) \" format, __FILE__, __FUNCTION__,  __LINE__, __VA_ARGS__ )\n#else\n    #define edi_Print_L1(...)\n#endif\n\n#if DEBUG_LEVEL &gt;= 0\n    #define edi_Print_L0( format, ... )   printf( \"\\nL0:%s::%s(%d) \" format, __FILE__, __FUNCTION__,  __LINE__, __VA_ARGS__ )\n#else\n    #define edi_Print_L0(...)\n#endif\n</code></pre>\n\n<p>This solution allows just one definition of each macro, so maintenance is a lot easier and less error prone.</p>\n"}, {"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1466011071, "post_id": 37841223, "comment_id": 63144404, "body": "I like this idea but it may need development.  How would you exclude all debug altogether for example?  You would have to explicitly define all possible <code>source</code> macros to zero to expand to <code>if( 0 &amp; 0x01</code>) for example, potentially generating &quot;always false&quot; or &quot;unreachable code&quot; warnings.  You need a means to exclude all the debug code from the source altogether, with an empty or null definition of <code>Log</code>."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1466021415, "post_id": 37841223, "comment_id": 63150095, "body": "@Clifford: yes, this was just an idea, but you&#39;re right about warnings. Regarding excluding logs by level, there could simple be an additional &quot;global enable&quot; flag in the <code>if</code> condition (i.e. <code>if (source &amp; level &amp; GlobalEnabledLevels)</code>), which would only pass certain levels. Regarding the warnings, I am not sure if there is a neat way to address this without pragmas, which are sometimes not so well supported inside macros. I will update my code with an example for Visual Studio (i.e. Microsoft&#39;s C99 compiler)."}, {"owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "edited": false, "score": 1, "creation_date": 1468314518, "post_id": 37841223, "comment_id": 64063812, "body": "@Groo: Sorry for the late reply but I was very busy! I followed your suggestion and my debug interface works very well!!!"}], "tags": [], "owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "is_accepted": true, "score": 2, "last_activity_date": 1466063233, "last_edit_date": 1466063233, "creation_date": 1466009060, "answer_id": 37841223, "question_id": 37837904, "link": "https://stackoverflow.com/questions/37837904/multilevel-debug-with-printf-in-embedded-c/37841223#37841223", "title": "Multilevel debug with printf in embedded C", "body": "<p>It would make more sense to pass the log level/source throughout the code, and then simply disable/enable individual levels or sources at one place.</p>\n\n<p>I.e. in your code, you would use:</p>\n\n<pre><code>Log(Log_Comm, LevelDebug, \"Some minor stuff\");\nLog(Log_Comm, LevelWarn, \"Something strange\");\nLog(Log_Comm, LevelError, \"Something seriously wrong\");\nLog(Log_System, LevelDebug, \"Some minor stuff\");\nLog(Log_System, LevelWarn, \"Something strange\");\nLog(Log_System, LevelError, \"Something seriously wrong\");\n</code></pre>\n\n<p>And then you simply have:</p>\n\n<pre><code>// log levels\n#define LevelDebug 0x01\n#define LevelInfo  0x02\n#define LevelWarn  0x04\n#define LevelError 0x08\n#define LevelAll   0x0F\n\n// enabled levels for individual log sources\n#define Log_Comm    (LevelWarn | LevelError)\n#define Log_System  (LevelAll)\n\n#define Log(source, level, message) do { \\\n   if (source &amp; level) { \\\n        sendToPort(message); \\\n   } \\\n} while (0)\n</code></pre>\n\n<p><strong>(edit)</strong></p>\n\n<p>As pointed out by @Clifford in comments, there might also be a need to globally disable a certain level, without having to go through all source defines. This can be done by specifying an additinal mask:</p>\n\n<pre><code>// if LevelDebug is omitted from this mask,\n// debug message will not be logged regardless\n// of individual source settings\n#define Global_Level_Mask (LevelWarn | LevelError)\n\n#define Log(source, level, message) do { \\\n    if (source &amp; level &amp; Global_Level_Mask) { \\\n       sendToPort(message); \\\n    } \\\n} while (0)\n</code></pre>\n\n<p>One additional concern might be a number of \"unreachable code\" warnings this will produce around your code. I am not sure how to fix this in other compilers, but, for example in Visual Studio, it can be resolved by adding a pragma around the <code>if</code> statement:</p>\n\n<pre><code>// visual studio will show a warning \n// C4127: \"conditional expression is constant\"\n// when compiling with all warnings enabled (-w4)\n\n// these pragmas will disable the warning around if's\n#define Log(source, level, message) do { \\\n__pragma(warning(push)) \\\n__pragma(warning(disable:4127)) \\\n    if (source &amp; level &amp; Global_Level_Mask) { \\\n__pragma(warning(pop)) \\\n        sendToPort(message); \\\n    } \\\n} while (0)\n</code></pre>\n\n<p>Not it looks a bit uglier, but IMHO it allows easy usage and much more control.</p>\n\n<p>Of course, nothing stops you from having a separate macro for each log level (perhaps simpler because you have one parameter less) i.e.:</p>\n\n<pre><code>#define LogDebug(source, message) Log(source, LevelDebug, message)\n#define LogInfo(source, message) Log(source, LevelInfo, message)\n#define LogWarn(source, message) Log(source, LevelWarn, message)\n\n// usage example:\nLogDebug(Log_Comm, \"Some minor stuff\");\nLogWarn(Log_System, \"Something strange\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 276, "user_id": 5551565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3pY4.jpg?s=128&g=1", "display_name": "user50619", "link": "https://stackoverflow.com/users/5551565/user50619"}, "is_accepted": false, "score": 0, "last_activity_date": 1537954771, "last_edit_date": 1537954771, "creation_date": 1537437547, "answer_id": 52422438, "question_id": 37837904, "link": "https://stackoverflow.com/questions/37837904/multilevel-debug-with-printf-in-embedded-c/52422438#52422438", "title": "Multilevel debug with printf in embedded C", "body": "<p>The real trick with re-directing printf on embedded systems is that\nprintf calls putch(unsigned char) for every byte it outputs.\nSee: \n<a href=\"https://www.quora.com/What-is-the-use-of-getch-putch-getchar-putchar-Cant-we-write-a-program-without-using-these-in-C-language\" rel=\"nofollow noreferrer\">https://www.quora.com/What-is-the-use-of-getch-putch-getchar-putchar-Cant-we-write-a-program-without-using-these-in-C-language</a></p>\n\n<p>If you make your own putch() function, it will override the \nsystem one (because the linker will have seen it first).</p>\n\n<p>You can then bung it down a UART or what ever.\nHere is a simple example in microchip xc8 C for a PIC18F2480\nmicro-controller. Obviously the port pins and RS232 BAUD rates were set up earlier.</p>\n\n<pre><code>/* printf will now write to the UART */\n\nvoid putch(char c)\n{\n    int count = 0;\n\n    while (!TRMT) // still transmitting, prob should not be \n        count++;\n    TXREG = c;\n    wait_us(1500); // wait 1.5mS if 9600 baud so as not to over run the dual buffer\n}\n</code></pre>\n"}], "owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 0, "accepted_answer_id": 37841223, "answer_count": 4, "score": 2, "last_activity_date": 1537954771, "creation_date": 1465999836, "question_id": 37837904, "link": "https://stackoverflow.com/questions/37837904/multilevel-debug-with-printf-in-embedded-c", "title": "Multilevel debug with printf in embedded C", "body": "<p>I'm working on embedded system, where I use printf to create log on UART.</p>\n\n<p>I would like to create a debug source file where I can set the type of debug I need.</p>\n\n<p>I defined this constant:</p>\n\n<ul>\n<li>DEBUG_LOG_0 for system log</li>\n<li>DEBUG_LOG_1 for system debugging</li>\n<li>DEBUG_LOG_2 for system advanced debugging</li>\n</ul>\n\n<p>Starting from this constant I defined this macro to wrap the standard printf:</p>\n\n<pre><code>    /* Define for debugging level 0 - System Logs */\n#ifdef DEBUG_LEVEL_0\n#define edi_Print_L0(...) printf(__VA_ARGS__)\n#endif\n\n#ifndef DEBUG_LEVEL_0\n#define edi_Print_L0(...) printf(...)\n#endif\n\n/* Define for debugging level 1 - Debug */\n#ifdef DEBUG_LEVEL_1\n#define edi_Print_L0(...) printf(__VA_ARGS__)\n#define edi_Print_L1(...) printf(__VA_ARGS__)\n#endif\n\n#ifndef DEBUG_LEVEL_1\n#define edi_Print_L0(...) printf(...)\n#define edi_Print_L1(...) printf(...)\n#endif\n\n/* Define for debugging level 2 - Advanced Debug */   \n#ifdef DEBUG_LEVEL_2\n#define edi_Print_L0(...) printf(__VA_ARGS__)\n#define edi_Print_L1(...) printf(__VA_ARGS__)\n#define edi_Print_L2(...) printf(__VA_ARGS__)\n#endif\n\n#ifndef DEBUG_LEVEL_2\n#define edi_Print_L0(...) printf(...)\n#define edi_Print_L1(...) printf(...)\n#define edi_Print_L2(...) printf(...)\n#endif\n</code></pre>\n\n<p>Next I would import the debug constant from a Header file in order to enable the selected level of debug.</p>\n\n<p>Any suggestion about the macro definition? Is there a smart way to achieve my scope?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "arrays", "iteration"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1465998536, "post_id": 37837357, "comment_id": 63135709, "body": "Do format your code properly and be careful about floating-point aritimetic errors."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1465999041, "post_id": 37837357, "comment_id": 63136106, "body": "Please show an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 23582, "user_id": 598289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b04c9074fed0dd215caec771c2a9ea98?s=128&d=identicon&r=PG", "display_name": "SJuan76", "link": "https://stackoverflow.com/users/598289/sjuan76"}, "edited": false, "score": 3, "creation_date": 1465999131, "post_id": 37837357, "comment_id": 63136185, "body": "What happens if <code>a[0]</code> is already <code>0</code>? (I am assuming all your numbers are positive)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1465999228, "post_id": 37837357, "comment_id": 63136234, "body": "What is the input? What is the expected result? What is the actual result?"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1465999248, "post_id": 37837357, "comment_id": 63136256, "body": "You have three possibilities: (1) minimal value is greater than zero; (2) minimal value is less than zero; (3) minimal value equals zero. In each possibility you have to deal with floating point arithmetic errors. Further on, it is not wise to initialize minimum to be equal to the first element of the array. I think you should re-work your question."}, {"owner": {"reputation": 1, "user_id": 6431929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3a1259bad524258bbd957cce809948?s=128&d=identicon&r=PG&f=1", "display_name": "M.Land", "link": "https://stackoverflow.com/users/6431929/m-land"}, "edited": false, "score": 2, "creation_date": 1465999550, "post_id": 37837357, "comment_id": 63136495, "body": "<a href=\"http://stackoverflow.com/questions/16651939/c-ignoring-a-value-while-scanning-an-array?rq=1\" title=\"c ignoring a value while scanning an array\">stackoverflow.com/questions/16651939/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "reply_to_user": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1466001495, "post_id": 37837357, "comment_id": 63138019, "body": "@user3078414 Thanks for your suggestion. Your tip about not initializing minimum to be equal to the first element of the array works"}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1465999992, "post_id": 37837681, "comment_id": 63136835, "body": "Assuming anything important is using the pre-zeroed value (not the case in the MCVE, but likely in real code), you should probably initialize <code>index</code> to <code>-1</code>, and check for that after the loop before setting anything to <code>0.0</code>. In the MCVE, you&#39;ll just rezero index 0 over and over, but it won&#39;t be distinguishable from the case where index 0 contained the lowest non-zero value vs. the whole array already being zero. Example case would be If the real code <code>return</code>-ed the index with the lowest non-zero value, and it was important to know if the value was really non-zero."}], "tags": [], "owner": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1465999377, "last_edit_date": 1465999377, "creation_date": 1465999249, "answer_id": 37837681, "question_id": 37837357, "link": "https://stackoverflow.com/questions/37837357/skip-ignore-array-index-that-contain-value-in-c/37837681#37837681", "title": "skip/ignore array index that contain value in c", "body": "<p>Your problem is, your code ignores case when <code>a[0]</code> is zero. Try assign to low some constant like DOUBLE_MAX and iterate through whole array instead (<code>i = 0</code> in <code>for</code> initialization statement instead of <code>i = 1</code>).</p>\n\n<pre><code>void find_minimum(double a[], int n) {\n\n    int i, index;\n    double low;    \n\n    index = 0;\n    low = DOUBLE_MAX;\n\n    for (i = 0; i &lt; n; i++) {\n        if ( a[i] &lt; low &amp;&amp; a[i] != 0.0) {\n            low = a[i];\n            index = i;\n        }\n    }\n    a[index] = 0.0;      \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "is_accepted": false, "score": 0, "last_activity_date": 1466000101, "creation_date": 1466000101, "answer_id": 37838009, "question_id": 37837357, "link": "https://stackoverflow.com/questions/37837357/skip-ignore-array-index-that-contain-value-in-c/37838009#37838009", "title": "skip/ignore array index that contain value in c", "body": "<p>You need to separate your minimum finder from the code which changes the data. You might need to find the minimum somewhere else for different purposes as well. Also, you find <code>low</code>, yet, you set the element at index to 0.</p>\n\n<pre><code>void find_minimum(double a[], int n) {\n\n    int i, index;\n    double low;    \n\n    index;\n    low = DOUBLE_MAX;\n\n    for (i = 0; i &lt; n; i++) {\n        if ((a[i]) &amp;&amp; (a[i] &lt; low)) {\n            low = a[i];\n            index = i;\n        }\n    }\n    return low;      \n}\n\n//...\nint main() {\n    //...\n    a[find_minimum(a, n)] = 0;\n    //...\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11856, "user_id": 2873538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gayoG.png?s=128&g=1", "display_name": "Ajeet Shah", "link": "https://stackoverflow.com/users/2873538/ajeet-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1466003478, "last_edit_date": 1466003478, "creation_date": 1466002373, "answer_id": 37838887, "question_id": 37837357, "link": "https://stackoverflow.com/questions/37837357/skip-ignore-array-index-that-contain-value-in-c/37838887#37838887", "title": "skip/ignore array index that contain value in c", "body": "<p>If you use <code>DOUBLE_MAX</code>, as suggested in other posts, you need to have some prior information of maximum possible value in the input array. </p>\n\n<p>But using the below code, you can solve this problem without any such prior information. <br>Read the in-line comments:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n#define SIZE 5    //  change the array size as per your requirement\n\nvoid find_minimum_set_zero(double a[]) {\n\n    int i, index;\n    double low;\n\n    index = 0;\n    low = a[index];\n\n    while(low == 0.0 &amp;&amp; index &lt; SIZE){    // This will make sure \"low\" is non-zero\n        index++;\n        low = a[index];\n    }\n\n    for (i = index+1; i &lt; SIZE; i++) {    // This loop starts with \"index+1\"\n        if ( (a[i] &lt; low) &amp;&amp; a[i] ) {\n            low = a[i];\n            index = i;\n        }\n    }\n    a[index] = 0.0;\n}\n\n\nint main(){\n\n    double a[SIZE];\n    int i;\n\n    for(i=0;i &lt; SIZE; i++){\n        scanf(\"%lf\", &amp;a[i]);\n    }\n\n    find_minimum_set_zero(a);\n\n    for(i=0;i &lt; SIZE; i++){\n        printf(\"%lf \", a[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><em>Sample Input (first line) and Output (second line):</em></p>\n\n<pre><code>99 98 95 96 97\n99.000000 98.000000 0.000000 96.000000 97.000000\n\n0 99 98 96 95\n0.000000 99.000000 98.000000 96.000000 0.000000\n\n99 0 98 0 97\n99.000000 0.000000 98.000000 0.000000 0.000000\n\n91 99 0 97 0\n0.000000 99.000000 0.000000 97.000000 0.000000\n</code></pre>\n\n<p><em>PS:</em> I changed the name of your function from <code>find_minimum</code> to <code>find_minimum_set_zero</code> just to improve readability.</p>\n"}], "owner": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1455, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1466003478, "creation_date": 1465998454, "last_edit_date": 1465998994, "question_id": 37837357, "link": "https://stackoverflow.com/questions/37837357/skip-ignore-array-index-that-contain-value-in-c", "title": "skip/ignore array index that contain value in c", "body": "<p>My goal is to create a C function that finds the minimum value of an array and set it to zero. So far, my function does that but I would like it to ignore/skip indexes that are already zero. </p>\n\n<pre><code>void find_minimum(double a[], int n) {\n\n    int i, index;\n    double low;    \n\n    index = 0;\n    low = a[0];\n\n    for (i = 1; i &lt; n; i++) {\n        if ( a[i] &lt; low &amp;&amp; a[i] != 0.0) {\n            low = a[i];\n            index = i;\n        }\n    }\n    a[index] = 0.0;      \n}\n</code></pre>\n\n<p>I also tried using a <code>continue</code> statement like this:</p>\n\n<pre><code>void find_minimum(double a[],  int n) {\n\n    int i, index;\n    double low;\n\n    index = 0;\n    low = a[0];\n\n    for (i = 1; i &lt; n; i++) {\n\n        if(a[i] == 0.0){\n          continue;\n        }\n        if ( a[i] &lt; low) {\n            low = a[i];\n            index = i;\n        }\n    }\n    a[index] = 0.0;\n}\n</code></pre>\n\n<p>What am I missing or messing up?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1465994890, "post_id": 37835909, "comment_id": 63132945, "body": "I don;t think you have the problem the way you say it..... the other one which the others are having is the actual problem."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1465995117, "post_id": 37835909, "comment_id": 63133103, "body": "scanf is never skipped.   To find out what the result of your scanf was, check its return value."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1465995136, "post_id": 37835909, "comment_id": 63133118, "body": "To get help with a specific piece of code, post a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> and also specify exactly what input you typed."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1465995180, "post_id": 37835909, "comment_id": 63133154, "body": "<a href=\"http://stackoverflow.com/questions/20306659/the-program-doesnt-stop-on-scanfc-ch-line-why\" title=\"the program doesnt stop on scanfc ch line why\">stackoverflow.com/questions/20306659/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 8, "last_activity_date": 1465994954, "creation_date": 1465994954, "answer_id": 37835962, "question_id": 37835909, "link": "https://stackoverflow.com/questions/37835909/why-this-c-scanf-is-automatically-skipped/37835962#37835962", "title": "Why this C scanf is automatically skipped?", "body": "<p>The <code>\"%d\"</code> format specifier includes skipping leading white-space. The <code>\"%c\"</code> format doesn't have that, it reads the next character in the input buffer no matter what kind of character it is.</p>\n\n<p>If you want to skip leading white-space using the <code>\"%c\"</code> format, you need to tell <code>scanf</code> explicitly to do so with a space in the format string, like e.g. <code>\" %c\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1465995223, "creation_date": 1465995223, "answer_id": 37836075, "question_id": 37835909, "link": "https://stackoverflow.com/questions/37835909/why-this-c-scanf-is-automatically-skipped/37836075#37836075", "title": "Why this C scanf is automatically skipped?", "body": "<p>This is the same problem as \"not able to take <code>char</code> after an <code>int</code>\", with a small twist. </p>\n\n<p>Recall that when you read an <code>int</code> from an input using <code>scanf</code> with <code>%d</code> format specifier, the characters representing the number are consumed, but the separator following it is not. Consider a buffer that looks like this (I use underscores to show spaces):</p>\n\n<pre><code>char     9 8 _ x _ 7 6\n         - - - - - - -\nposition 0 1 2 3 4 5 6\n</code></pre>\n\n<ul>\n<li>Before the first <code>scanf</code> call your buffer is positioned at zero.</li>\n<li>After the first call your buffer is positioned at 2.</li>\n<li>After the second call your buffer is positioned at 3, because space is read for your <code>char</code></li>\n</ul>\n\n<p>Now the problem becomes clear: the third <code>scanf</code> tries to read an <code>int</code>, but the buffer is at <code>x</code>, so the read is not possible.</p>\n"}], "owner": {"reputation": 4091, "user_id": 5674223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f059211e7c3ee8ebb957ab8c29331e71?s=128&d=identicon&r=PG&f=1", "display_name": "UmFraWJ1bCBJc2xhbQ", "link": "https://stackoverflow.com/users/5674223/umfrawj1bcbjc2xhbq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 1, "closed_date": 1465995523, "accepted_answer_id": 37835962, "answer_count": 2, "score": -2, "last_activity_date": 1566119055, "creation_date": 1465994791, "last_edit_date": 1566117761, "question_id": 37835909, "link": "https://stackoverflow.com/questions/37835909/why-this-c-scanf-is-automatically-skipped", "closed_reason": "Duplicate", "title": "Why this C scanf is automatically skipped?", "body": "<p>I am facing problem regarding <code>scanf</code> in C. When I run this:</p>\n\n<pre><code>char c;\nint a, b;\n\nscanf(\"%d\", &amp;a);\nscanf(\"%c\", &amp;c);\nscanf(\"%d\", &amp;b);\n</code></pre>\n\n<p>Then first two <code>scanf</code> were working properly but 3rd one is skipped completely. I searched different posts in this forum about this problem and found a lot of information, but want to know something else. </p>\n\n<p>I already found that the easiest solution would be:</p>\n\n<pre><code>scanf(\"%d %c %d\", &amp;a, &amp;c, &amp;b);\n</code></pre>\n\n<p>And another solution could be using:</p>\n\n<pre><code>getchar();\n</code></pre>\n\n<p>And I also found that the reason behind my problem is it writes an extra new line character <code>\\n</code> to the buffer, that's why the 3rd one was skipped. But for further researching I found that when I use another <code>scanf</code> of <code>char</code> type after 2nd <code>scanf</code> then it works. That means, in my case the problem occurs if I take input of any <code>integer</code> type after <code>char</code> type. Again I have seen many others were problem having opposite case, they couldn't take input of <code>char</code> after <code>integer</code>. Now I want to be clarified about the exact schemes those are supported in C for <code>scanf</code> that is when I will face similar problems and why <code>char</code> can be scanned after <code>char</code> but <code>integer</code> can't. Thanks to all.</p>\n"}, {"tags": ["c", "memory", "malloc", "free", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "edited": false, "score": 3, "creation_date": 1465993098, "post_id": 37835116, "comment_id": 63131627, "body": "&gt; Does it create new memories in heap every time,the pointer would point to the new memory and the old memory would then be wasted?  spot on - you answered your own question"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1465995327, "post_id": 37835116, "comment_id": 63133262, "body": "It would help to avoid saying &quot;malloc a pointer&quot;.  <code>malloc</code> allocates new space each time it is called. You might then store the address of that space in a pointer variable."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1465997441, "post_id": 37835116, "comment_id": 63134870, "body": "You don&#39;t &quot;<code>malloc</code> a pointer&quot;!"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 18, "last_activity_date": 1465995547, "last_edit_date": 1465995547, "creation_date": 1465992839, "answer_id": 37835154, "question_id": 37835116, "link": "https://stackoverflow.com/questions/37835116/what-happen-when-we-do-multiple-malloc-for-allocating-memory-to-a-single-destina/37835154#37835154", "title": "What happen when we do multiple malloc for allocating memory to a single destination pointer?", "body": "<p>In your code</p>\n\n<pre><code>ptr = malloc(sizeof(int));\n*ptr = 111;\nptr = malloc(sizeof(int));\n</code></pre>\n\n<p>The call to second <code>malloc()</code> stores the return value into the <em>same</em> variable. This way, you're overwriting the previously returned pointer. So, the second <code>malloc()</code> (storing the returned pointer in the same variable) causes <a href=\"https://en.wikipedia.org/wiki/Memory_leak\">memory leak</a>. </p>\n\n<p>You lose the actual pointer previously returned by <code>malloc()</code> and have no ways to <code>free()</code> that. So, you're right, the old memory is <em>wasted</em>, (<em>Note: not <code>free()</code>-d</em>).</p>\n\n<p>FWIW, every call to <code>malloc()</code>(<em>provided success</em>) gives you a <em>new</em> memory area. It does not <em>create</em> a memory as such, but it returns a pointer with requested memory size which can be used and <code>free()</code>-d later.</p>\n\n<p>To add to this, a(ny) modest memory checker tool will scream for the above code. Here's one of the widely-used one, <a href=\"http://valgrind.org/\">valgrind/memcheck</a></p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1465993397, "post_id": 37835235, "comment_id": 63131842, "body": "The last answer, <code>No</code>...can you explain? How does an inaccessible memory is <i>not</i> a wastage?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465993841, "post_id": 37835235, "comment_id": 63132171, "body": "<code>It would be free only when the task or process is ended, causing leaking of memory.</code>... you&#39;re contradicting yourself, if it is getting free-d how is there a <i>leak</i>?"}, {"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465993846, "post_id": 37835235, "comment_id": 63132174, "body": "By being wasted, I interpreted as &#39;Free&#39;, The memory would be there and no other malloc in this process can allocate that until freed. That&#39;s what I wanted to say before."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465993880, "post_id": 37835235, "comment_id": 63132202, "body": "FWIW, a <code>free()</code>-d memory is never <i>wasted</i>,, at least that is what I know."}, {"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465993989, "post_id": 37835235, "comment_id": 63132265, "body": "E.g. the plateform I am working has a heap of 64k for tasks. So if I am doing same thing again and again, a times come when I can&#39;t allocate more memory, so appearently I am using just one block out of heap, but in actually all the memory has been leaked. So when OS closes this task, all the memory would be freed then."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1465997723, "post_id": 37835235, "comment_id": 63135064, "body": "Inaccessible objects <b>are</b> leaks. Once an object becomes uncaessible from the program code, it leaks. Not after the program terminates. The final free&#39;ing is not part of the C language anymore, but a &quot;courtesy&quot; of the environment (not fully self-less, though)."}, {"owner": {"reputation": 337, "user_id": 3490804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd18e760451dc9e68e7ef7df90169a5?s=128&d=identicon&r=PG", "display_name": "Vivek Vijayan", "link": "https://stackoverflow.com/users/3490804/vivek-vijayan"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465998024, "post_id": 37835235, "comment_id": 63135323, "body": "@SouravGhosh The memory is indeed wasted if it cannot be used by any other process. In this case, the process would keep wasting heap memory until it runs out its quota and the process crashes. Then the OS would free up all the memory held by this process. But until then all this memory is unusable by another process. Hence termed memory-leak"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 337, "user_id": 3490804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd18e760451dc9e68e7ef7df90169a5?s=128&d=identicon&r=PG", "display_name": "Vivek Vijayan", "link": "https://stackoverflow.com/users/3490804/vivek-vijayan"}, "edited": false, "score": 0, "creation_date": 1465999009, "post_id": 37835235, "comment_id": 63136079, "body": "@VivekVijayan Correct.but what did you try to explain?"}, {"owner": {"reputation": 337, "user_id": 3490804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd18e760451dc9e68e7ef7df90169a5?s=128&d=identicon&r=PG", "display_name": "Vivek Vijayan", "link": "https://stackoverflow.com/users/3490804/vivek-vijayan"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1466071361, "post_id": 37835235, "comment_id": 63169909, "body": "@SouravGhosh I was replying to your comment &quot;<i>a <code>free()</code>-d memory is never wasted,, at least that is what I know</i>&quot;"}], "tags": [], "owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "is_accepted": false, "score": 3, "last_activity_date": 1465994140, "last_edit_date": 1465994140, "creation_date": 1465993025, "answer_id": 37835235, "question_id": 37835116, "link": "https://stackoverflow.com/questions/37835116/what-happen-when-we-do-multiple-malloc-for-allocating-memory-to-a-single-destina/37835235#37835235", "title": "What happen when we do multiple malloc for allocating memory to a single destination pointer?", "body": "<blockquote>\n  <p>What problem the program has, with regard to memory usage?</p>\n</blockquote>\n\n<p>You are using or allocating un-neccessory memory using malloc. You could have used single malloc. </p>\n\n<blockquote>\n  <p>What happen when you malloc the same pointer multiple of time?</p>\n</blockquote>\n\n<p>Each time you store the pointer of some memory block, allocated by malloc, in same pointer <code>ptr</code> , the <code>ptr</code> will point to most recent. </p>\n\n<blockquote>\n  <p>Does it create new memories in heap every time</p>\n</blockquote>\n\n<p>Yes each time you call malloc, a new block of memory is allocated. </p>\n\n<blockquote>\n  <p>the pointer would point to the new memory and the old memory would\n  then be wasted?</p>\n</blockquote>\n\n<p>A block of memory would still be reserved under your task or process until you explicitly free it, which you can't do after pointing the <code>ptr</code> to another block in this case. It would be free only when the task or process is ended, but before that memory is being leaked.</p>\n"}], "owner": {"reputation": 125, "user_id": 5451893, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0e27598e211a00aa9b619ee4de9c4616?s=128&d=identicon&r=PG&f=1", "display_name": "Tam Lam", "link": "https://stackoverflow.com/users/5451893/tam-lam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1977, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1465999997, "creation_date": 1465992732, "last_edit_date": 1465999997, "question_id": 37835116, "link": "https://stackoverflow.com/questions/37835116/what-happen-when-we-do-multiple-malloc-for-allocating-memory-to-a-single-destina", "title": "What happen when we do multiple malloc for allocating memory to a single destination pointer?", "body": "<p>What problem the program has, with regard to memory usage? What happens when you <code>malloc</code> the same pointer multiple times? Does it create new memory in heap every time, the pointer would point to the new memory and the old memory would then be wasted?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void)\n{\n    int *ptr;\n    ptr = malloc(sizeof(int));\n    *ptr = 111;\n    ptr = malloc(sizeof(int));\n    *ptr =-234;\n    printf(\u201c\\n%d\\n\u201d, *ptr);\n    free(ptr);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "algorithm"], "answers": [{"comments": [{"owner": {"reputation": 58970, "user_id": 71059, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/RRmlf.png?s=128&g=1", "display_name": "AakashM", "link": "https://stackoverflow.com/users/71059/aakashm"}, "edited": false, "score": 0, "creation_date": 1465998518, "post_id": 37835220, "comment_id": 63135699, "body": "+1. It&#39;s exactly the same as how mathematicians say a whole set is a subset of itself. A subset that is strictly smaller is called a <i>proper subset</i>, so I suppose we could use &quot;proper sub-array&quot; to refer to a sub-array which <i>isn&#39;t</i> the whole array."}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "reply_to_user": {"reputation": 58970, "user_id": 71059, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/RRmlf.png?s=128&g=1", "display_name": "AakashM", "link": "https://stackoverflow.com/users/71059/aakashm"}, "edited": false, "score": 0, "creation_date": 1466001408, "post_id": 37835220, "comment_id": 63137953, "body": "I think there is no need to separate solution for &quot;proper sub-arrays&quot;, because algorithm is intended for general case, and nobody claimed that requirement."}], "tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": true, "score": 3, "last_activity_date": 1465993311, "last_edit_date": 1465993311, "creation_date": 1465992991, "answer_id": 37835220, "question_id": 37834992, "link": "https://stackoverflow.com/questions/37834992/query-in-kadanes-algorithm/37835220#37835220", "title": "Query in Kadane&#39;s Algorithm", "body": "<p>Yes, any continuous sub-array could be a solution, including the whole array.</p>\n\n<p>Note that empty sub-array might be valid solution too (for all negative numbers algorithm gives max sum result 0)</p>\n"}], "owner": {"reputation": 109, "user_id": 3583842, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/848e1219b7246300ed96762cfcf11fab?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/3583842/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 37835220, "answer_count": 1, "score": 1, "last_activity_date": 1465993311, "creation_date": 1465992380, "question_id": 37834992, "link": "https://stackoverflow.com/questions/37834992/query-in-kadanes-algorithm", "title": "Query in Kadane&#39;s Algorithm", "body": "<p>I am going through the Kadane's Algorithm for Maximum sub-array problem.Now what I understand from the statement the algo that we have find a <strong>sub-array</strong> . Does sub-array include whole array itself.</p>\n\n<p>Actually I was trying following program</p>\n\n<pre><code>    int main(void)\n    {\n    int arr[9]={5,6,-4,-1,-2,1,5,3};\n\n    int i,n,max_last =0,max_mid =0;\n\n    for(i=0;i&lt;8;i++)\n    {\n      max_mid = max_mid + arr[i];\n      printf(\"max_mid =%d\\n\",max_mid); \n\n      if ( max_mid &lt; 0)\n              max_mid =0;\n\n      if( max_mid &gt; max_last)\n              max_last = max_mid;\n     }\n\n      printf(\"val=%d\",max_last);\n        return 0;\n     }\n</code></pre>\n\n<p>Here it is giving 13 as final answer which is the sum of all element of array.</p>\n"}, {"tags": ["c", "scanf", "fgetc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1465992312, "post_id": 37834937, "comment_id": 63131088, "body": "<code>Please give me a code.</code>...have a downvote instead."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1465992319, "post_id": 37834937, "comment_id": 63131095, "body": "Welcome to Stack Overflow! Please show your research effort till time. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1465992380, "post_id": 37834937, "comment_id": 63131134, "body": "Please offer me lots of money then I&#39;ll give you lots of code."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1465992563, "post_id": 37834937, "comment_id": 63131274, "body": "Why can&#39;t you use \u201cstraightforward <code>fscanf()</code>?\u201d Note that the <code>e</code> formatting directive does the right thing for all styles of floating point numbers."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1465992866, "post_id": 37834937, "comment_id": 63131474, "body": "There seems to be only one single integer in the input you show, and all the floating-point numbers have the same format. So I really don&#39;t see what the problem is. Please tell us what you have tried, edit your question and copy-paste the relevant code into the question body, elaborate on what works ad doesn&#39;t work with your show code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1465993152, "post_id": 37834937, "comment_id": 63131669, "body": "The input file is <i>always</i> one integer followed by 13 floating point values? Then you don&#39;t need any checking, just read the integer, and then in a <code>for</code> loop read the floating point values. All using e.g. <code>fscanf</code>."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1465993226, "post_id": 37834937, "comment_id": 63131721, "body": "You can also read the whole file into a double array and then copy it to an int array. <code>fscanf</code> with <code>%le</code> will skip all whitespaces."}], "answers": [{"tags": [], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1465993931, "last_edit_date": 1465993931, "creation_date": 1465993601, "answer_id": 37835423, "question_id": 37834937, "link": "https://stackoverflow.com/questions/37834937/how-to-read-these-mixture-of-data-in-c/37835423#37835423", "title": "How to read these mixture of data in C", "body": "<p>This program reads from the file and converts the tokens to floats. You should read an entire line and tokenize it. Then you just need to create an array and add to the array at the right place in the code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;memory.h&gt;\n\nint main(void) {\n    FILE *sp1;\n    char line[256];\n    double array[256];\n    int i = 0;\n\n    sp1 = fopen(\"data.txt\", \"r\");\n    while (1) {\n        if (fgets(line, 150, sp1) == NULL) break;\n        char *p = strtok(line, \" \");\n        while (p != NULL) {\n            double fd = atof(p);\n            array[i++] = fd;\n            p = strtok(NULL, \" \");\n        }\n    }\n\n    for(int j=0;j&lt;i;j++)\n        printf(\"%f\\n\", array[j]);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>data.txt</strong></p>\n\n<pre><code>120 5.0000000000000000E-01   -5.0000000000000000E-01  5.0000000000000000E-01\n5.0000000000000000E-01   -5.0000000000000000E-01  -5.0000000000000000E-01\n5.0000000000000000E-01   -5.0000000000000000E-01  1.6666666666999999E-01\n5.0000000000000000E-01   -5.0000000000000000E-01  -1.6666666666999999E-01\n-5.0000000000000000E-01\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>120.000000\n0.500000\n-0.500000\n0.500000\n0.500000\n-0.500000\n-0.500000\n0.500000\n-0.500000\n0.166667\n0.500000\n-0.500000\n-0.166667\n-0.500000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11856, "user_id": 2873538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gayoG.png?s=128&g=1", "display_name": "Ajeet Shah", "link": "https://stackoverflow.com/users/2873538/ajeet-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1465996440, "last_edit_date": 1465996440, "creation_date": 1465993799, "answer_id": 37835498, "question_id": 37834937, "link": "https://stackoverflow.com/questions/37834937/how-to-read-these-mixture-of-data-in-c/37835498#37835498", "title": "How to read these mixture of data in C", "body": "<p>Try the below code, it will read all the numbers from input file as doubles.</p>\n\n<p><em>White spaces between numbers do not matter</em>.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(){\n\n\n    FILE * fp;\n    double num;\n\n    fp = fopen(\"input.txt\", \"r\");\n\n    if (fp == NULL){\n        printf(\"Unable to open file, terminating ...\");\n        exit(1);\n    }\n    else {\n        while( fscanf(fp, \"%lf\", &amp;num) == 1){\n            printf(\"%lf %e\\n\", num, num);\n        }\n        fclose(fp);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>input.txt:</strong> (added a few more white-spaces and numbers in yours)</p>\n\n<pre><code>120 5.0000000000000000E-01     -5.0000000000000000E-01  5.0000000000000000E-01\n\n5.0000000000000000E-01  -5.0000000000000000E-01                 -5.0000000000000000E-01\n\n5.0000000000000000E-01   -5.0000000000000000E-01  1.6666666666999999E-01\n5.0000000000000000E-01   -5.0000000000000000E-01  -1.6666666666999999E-01   17.3 16.55511\n\n\n-5.0000000000000000E-01\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>120.000000 1.200000e+02\n0.500000 5.000000e-01\n-0.500000 -5.000000e-01\n0.500000 5.000000e-01\n0.500000 5.000000e-01\n-0.500000 -5.000000e-01\n-0.500000 -5.000000e-01\n0.500000 5.000000e-01\n-0.500000 -5.000000e-01\n0.166667 1.666667e-01\n0.500000 5.000000e-01\n-0.500000 -5.000000e-01\n-0.166667 -1.666667e-01\n17.300000 1.730000e+01\n16.555110 1.655511e+01\n-0.500000 -5.000000e-01\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6469022, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IXcMvV9EZqA/AAAAAAAAAAI/AAAAAAAAAEA/9GmA76oSYDI/photo.jpg?sz=128", "display_name": "Sagarmay Biswas", "link": "https://stackoverflow.com/users/6469022/sagarmay-biswas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1465996440, "creation_date": 1465992217, "last_edit_date": 1465993208, "question_id": 37834937, "link": "https://stackoverflow.com/questions/37834937/how-to-read-these-mixture-of-data-in-c", "title": "How to read these mixture of data in C", "body": "<p>I have to store each data in an array. How do I read these data from a file?</p>\n\n<pre><code>120 5.0000000000000000E-01   -5.0000000000000000E-01  5.0000000000000000E-01  \n5.0000000000000000E-01   -5.0000000000000000E-01  -5.0000000000000000E-01 \n5.0000000000000000E-01   -5.0000000000000000E-01  1.6666666666999999E-01  \n5.0000000000000000E-01   -5.0000000000000000E-01  -1.6666666666999999E-01 \n-5.0000000000000000E-01\n</code></pre>\n\n<p>The data is mixture of integers, floating points and exponentials. The spaces between consecutive data are not constant, hence I cannot use a straightforward fscanf(). I also have to change them to integer hence, I cannot find alternative to fscanf() as I can specify the type specifier as %e in fscanf() argument and later change them to integer. I have tried fgetc() as well. Please show me a way.</p>\n\n<p>edit.</p>\n\n<p>To use fscanf() I need to have constant number of spaces or commas or anything between consecutive data. Here, the number of spaces between each data are not constant. So, I need to also implement a space checker in between.That's why I used fgetc() at a part.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\nint i=0,c,a[13];\nFILE *fp;\nfp=fopen(\"test.txt\",\"r\");\nif(fp==NULL)\n{\n    printf(\"Error\");\n}\nelse\n{\n    i=0;\n    while(1)\n    {\n        c=fgetc(fp);\n        //printf(\"\\nc = %c\",c);\n        if(feof(fp))\n        {\n            break;\n        }\n        else if(c!=\" \")\n        {\n            fscanf(fp,\"%d\",&amp;a[i]);\n            printf(\"%d\\n\",a[i]);\n            i++;\n        }\n    }\n\n}\nfclose(fp);\nreturn 0;\n}\n</code></pre>\n\n<p>The data file is 2 m.b. I have just posted a part of it. Other parts have floating points, which are not exponentials like here.</p>\n"}, {"tags": ["c", "error-handling", "signals", "recv"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1465990497, "post_id": 37834101, "comment_id": 63129676, "body": "Red a little further... Under the third example it says &quot;EDIT: Please note that to make blocking fuctions like recv return EINTR you may have to use sigaction() with SA_RESTART set to zero instead of signal() on some operating systems.&quot; The semantics of the <code>signal</code> function is unfortunately different on different systems."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465990659, "post_id": 37834101, "comment_id": 63129820, "body": "This passage explains what would happen if EINTR didn&#39;t exist."}, {"owner": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1465991171, "post_id": 37834101, "comment_id": 63130247, "body": "@JoachimPileborg: I understand that, but presuming we stay on the same system and use <code>sigaction()</code> or that <code>signal()</code> call is enough to make recve return <code>EINTR</code>, the behavior of both snippets should be the same (whether they block or not block actually)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1465991426, "post_id": 37834101, "comment_id": 63130441, "body": "It would be <i>almost</i> the same, because in the first example (in your question) you do not check for errors, and will &quot;perform an action&quot; even if <code>recv</code> was interrupted."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1465992019, "post_id": 37834101, "comment_id": 63130852, "body": "Both examples shown here introduce a race. <code>SIGINT</code> would not necessarily break the loop in both cases. Signals (used alone) are a bad choice for synchronisation."}, {"owner": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1465996571, "post_id": 37834101, "comment_id": 63134212, "body": "@alk OK, so how would you solve this problem here?"}, {"owner": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1465996655, "post_id": 37834101, "comment_id": 63134280, "body": "@JoachimPileborg: again that&#39;s true, but at the same time it does not make a difference with the main problem here, i.e. does <code>recv</code> get interrupted with <code>EINTR</code> on program catching signal or not, no?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1465998971, "post_id": 37834101, "comment_id": 63136054, "body": "Regarding the return from a blocking call to <code>recv()</code> both snippets you show behave the same."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1466002459, "post_id": 37834101, "comment_id": 63138723, "body": "<code>stop</code> should be typed <code>sig_atomic_t</code> not <code>int</code>, BTW."}], "owner": {"reputation": 5095, "user_id": 2022518, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9366c006da5aca3fa94f7be13677042d?s=128&d=identicon&r=PG", "display_name": "LetMeSOThat4U", "link": "https://stackoverflow.com/users/2022518/letmesothat4u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1046, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465989924, "creation_date": 1465989924, "question_id": 37834101, "link": "https://stackoverflow.com/questions/37834101/eintr-and-blocking-recv-call", "title": "EINTR and blocking recv call", "body": "<p>I'm reading <a href=\"http://250bpm.com/blog:12\" rel=\"nofollow\">http://250bpm.com/blog:12</a> to understand how EINTR should/could be handled and I have trouble reconciling the second and third source code snippet with description.</p>\n\n<p>Second listing:</p>\n\n<pre><code>volatile int stop = 0;\n\nvoid handler (int)\n{\n    stop = 1;\n}\n\nvoid event_loop (int sock)\n{\n    signal (SIGINT, handler);\n\n    while (1) {\n        if (stop) {\n            printf (\"do cleanup\\n\");\n            return;\n        }\n        char buf [1];\n        recv (sock, buf, 1, 0);\n        printf (\"perform an action\\n\");\n    }\n}\n</code></pre>\n\n<p>Third listing:</p>\n\n<pre><code>volatile int stop = 0;\n\nvoid handler (int)\n{\n    stop = 1;\n}\n\nvoid event_loop (int sock)\n{\n    signal (SIGINT, handler);\n\n    while (1) {\n        if (stop) {\n            printf (\"do cleanup\\n\");\n            return;\n        }\n        char buf [1];\n        int rc = recv (sock, buf, 1, 0);\n        if (rc == -1 &amp;&amp; errno == EINTR)\n            continue;\n        printf (\"perform an action\\n\");\n    }\n}\n</code></pre>\n\n<p>Specifically:</p>\n\n<blockquote>\n  <p>POSIX specification defines that when signal (such as Ctrl+C) is caught, recv  returns EINTR error. That allows the event loop to wrap over and check the 'stop' variable:</p>\n</blockquote>\n\n<p>But the explanation given for supposed blocking in 2nd listing is that:</p>\n\n<blockquote>\n  <p>The problem is that recv is a blocking function. If Ctrl+C is pressed\n  while the event loop is blocked in recv, you'll get a kind of\n  deadlock: Signal handler is executed as expected, it sets 'stop' to 1,\n  but then the execution blocks. The event loop is stuck in recv and has\n  no opportunity to check whether 'stop' was set to 1.</p>\n</blockquote>\n\n<p>Well, signal handler is defined in both cases and so the <code>SIGINT</code> is caught, therefore it seems like <code>recv</code> should unblock in both cases, no? </p>\n"}, {"tags": ["c", "sockets", "tcp", "network-programming"], "comments": [{"owner": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "edited": false, "score": 0, "creation_date": 1465989940, "post_id": 37833632, "comment_id": 63129243, "body": "Does your &quot;Bad Address&quot; problem still exist after you made the change I suggested on CR?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1465990635, "post_id": 37833632, "comment_id": 63129791, "body": "This code does not exhibit the problem described, but the original code did."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466087109, "post_id": 37833632, "comment_id": 63181246, "body": "for ease of readability and understanding: 1) consistently indent the code.  Indent after every opening brace &#39;{&#39;.  un indent before each closing brace &#39;}&#39;..  2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466087195, "post_id": 37833632, "comment_id": 63181301, "body": "this comment: <code>&#47;&#47;  ASSIGNING A NAME TO THE SOCKET</code> is not correct.  What is actually being done is to &#39;bind&#39; the socket to a specific port number."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1466087759, "post_id": 37833632, "comment_id": 63181696, "body": "when compiling, always enable all the warnings, then fix those warnings.  (for <code>gcc</code> at a minimum use: <code>-Wall -Wextra -pedantic</code>  I also use: <code>-Wconversion -std=gnu99</code> ).   Amongst other things, the variable: <code>tcp_port</code> should be declared as <code>uint16_t</code> not as <code>int</code>"}], "answers": [{"comments": [{"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 1, "creation_date": 1465993955, "post_id": 37834020, "comment_id": 63132245, "body": "<code>cli_addr_size</code> should be declared as <code>socklen_t</code> (not <code>socket_t</code>) but otherwise, good answer"}], "tags": [], "owner": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "is_accepted": true, "score": 13, "last_activity_date": 1521269480, "last_edit_date": 1521269480, "creation_date": 1465989721, "answer_id": 37834020, "question_id": 37833632, "link": "https://stackoverflow.com/questions/37833632/tcp-client-server-bad-address-error-in-c/37834020#37834020", "title": "TCP Client-Server &quot;bad address&quot; error (in C)", "body": "<p>In your original question, your accept call looks like this:</p>\n\n<pre><code>cli_socket = accept(serv_socket,(struct sockaddr *) &amp;cli_addr,\n                   (socklen_t *) sizeof(cli_addr));\n</code></pre>\n\n<p>This passes \"<code>(socklen_t *) sizeof(cli_addr)</code>\" as the third parameter to accept.  This is expected to be a pointer to the size of the structure.  You should be passing in a pointer to a <code>socklen_t</code> containing the size of the structure passed as parameter two.  The size you're currently passing in is being interpreted as an address, which is then causing your program to crash when it is referenced.  The code should look like this:</p>\n\n<pre><code>socklen_t cli_addr_size = sizeof(cli_addr);\ncli_socket = accept(serv_socket,(struct sockaddr *) &amp;cli_addr,\n                   &amp;cli_addr_size);\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4809575, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c72329f445630e8fae179221608685fe?s=128&d=identicon&r=PG", "display_name": "fant0me", "link": "https://stackoverflow.com/users/4809575/fant0me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10271, "favorite_count": 1, "accepted_answer_id": 37834020, "answer_count": 1, "score": 1, "last_activity_date": 1521269480, "creation_date": 1465988717, "last_edit_date": 1465991264, "question_id": 37833632, "link": "https://stackoverflow.com/questions/37833632/tcp-client-server-bad-address-error-in-c", "title": "TCP Client-Server &quot;bad address&quot; error (in C)", "body": "<p>Although it seems to be correctly implemented, <strong>it keeps on returning me <em>ERROR</em> when I establish a connection using the loopback address</strong>(127.0.0.1).</p>\n\n<p>In addition to a simple TCP Client/Server connection, I have added an additional case:</p>\n\n<p>If the client tries to send data but <strong>finds the connection closed</strong>, it is closed too. I perform it by <strong>checking if received data is equal to 0 (recv)</strong>.</p>\n\n<p><strong>Given error</strong>:</p>\n\n<pre><code>CLIENT:\nWelcome to the Client mode\nPlease, enter the Server's IP Address and Port (eg. 192.128.192.0 1320) \n127.0.0.1 2700\nConnected to the server. Now you can send messages\nPlease, enter a message. Enter \"FINISH\" if you want to finish the connection\nECHO \nclient: connection closed -&gt;: Success\n (1 bytes)Closing the connection \n\nSERVER:\nHello and welcome to the Server mode\nPlease, enter the Server's Port (eg. 1320) \n2700\nServer socket successfully configured\nServer listening [Clients allowed: 5]\nserver: accept error: Bad address\n</code></pre>\n\n<p><strong>Client</strong> implementation:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/ip.h&gt;\n\n/**\n\n struct sockaddr{\n     uint8_t sa_len; // struct length\n     sa_family_t sa_family; //protocol family: AF_XXX\n     char sa_data[8]; //socket addr\n }\n\n */\n\n//void notConnected();\nint main(){\n\n    struct sockaddr_in  serv_addr;  //port + ip_addr\n    int                 my_socket, tcp_port;\n    char                serv_host_addr[30];\n\n    char                buffer[1024], inbuff[1024];\n    int                 io_buffer;\n\n    printf(\"Welcome to the Client mode\\n\");\n\n    //CONFIGURING THE CONNECTION\n    my_socket = socket(AF_INET, SOCK_STREAM, 0);//(2)\n    if(my_socket &lt; 0){\n        perror(\"client: socket() error -&gt;\");\n        exit(EXIT_FAILURE);\n    }\n\n    bzero(&amp;serv_addr, sizeof(serv_addr));//(4)\n    printf(\"Please, enter the Server's IP Address and Port (eg. 192.128.192.0 1320) \\n\");\n    scanf(\"%s %d\", serv_host_addr, &amp;tcp_port);//(1)\n\n\n    serv_addr.sin_family = AF_INET ;\n    serv_addr.sin_port = htons(tcp_port);\n    if(inet_pton(AF_INET,serv_host_addr,&amp;serv_addr.sin_addr) &lt; 1){\n        perror(\"client: inet_pton() error -&gt;\");\n        exit(EXIT_FAILURE);\n    }\n\n    if((connect(my_socket, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr) )) &lt; 0)//(5)\n    {\n        perror(\"client: connect() error -&gt;\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    //ONCE CONNECTED, START THE SENDING/RECEIVING\n    printf(\"Connected to the server. Now you can send messages\\n\");\n    bzero(&amp;buffer, sizeof(buffer));\n\n    while(strcmp(buffer, \"OK\\n\") != 0){\n\n        printf(\"Please, enter a message. Enter \\\"FINISH\\\" if you want to finish the connection\\n\");//(3)\n        bzero(&amp;buffer, sizeof(buffer));\n        fgets(buffer, sizeof(buffer), stdin);\n\n        io_buffer = send(my_socket, buffer, strlen(buffer),0);//(6)\n        if(io_buffer &lt; 0){\n            perror(\"client: send() error -&gt;\");\n            exit(EXIT_FAILURE);\n        }\n        printf(\"ECHO %s (%d bytes)\", buffer, io_buffer);\n\n\n        //RECEIVE AND CHECK IF CONNECTION HAS BEEN CLOSED\n        io_buffer = recv(my_socket, buffer, sizeof(buffer),0);\n        if(io_buffer &lt; 0){\n            perror(\"client: recv() error -&gt;\");\n            exit(EXIT_FAILURE);\n        }\n        else if(io_buffer == 0){    //THIS IS SERVER IS CLOSED\n            perror(\"client: connection closed -&gt;\");\n            break;\n        }\n        printf(\"ECHO %s (%d bytes)\", buffer, io_buffer);\n\n    }\n\n    printf(\"Closing the connection \\n\");\n    for(int i=0; i &lt; 5; i++){\n        printf(\". \");\n        usleep(500000);\n    }\n    close(my_socket);\n}\n</code></pre>\n\n<p><strong>Server</strong> implementation:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n#define LISTENQ 5\n\nint main()\n{\n    struct sockaddr_in  cli_addr, serv_addr;\n    char                buffer[1024];\n    int                 serv_socket, cli_socket, clilen, io_buffer;\n    int                 tcp_port;\n\nprintf(\"Hello and welcome to the Server mode\\n\");\n\n//  ASKING FOR PORT NUMBER\n    if((serv_socket = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0){\n        perror(\"server: can't open stream socket\");\n        exit(EXIT_FAILURE);\n    }\n\nprintf(\"Please, enter the Server's Port (eg. 1320) \\n\");\n    scanf(\"%d\", &amp;tcp_port);\n\n//  CONFIGURING THE CONNECTION\n    serv_addr.sin_family        = AF_INET;\n    serv_addr.sin_port          = htons(tcp_port);\n    serv_addr.sin_addr.s_addr   = htonl(INADDR_ANY);\n\n//  ASSIGNING A NAME TO THE SOCKET\n    if(bind(serv_socket,(struct sockaddr *) &amp;serv_addr,sizeof(serv_addr)) &lt; 0){\n        perror(\"server: can't assign a name to the socket\");\n        exit(EXIT_FAILURE);\n    }\nprintf(\"Server socket successfully configured\\n\");\n\nprintf(\"Server listening [Clients allowed: %d]\\n\", LISTENQ);\n    if(listen(serv_socket, LISTENQ) &lt; 0)\n    {\n        perror(\"server: fail to listen network\");\n        exit(EXIT_FAILURE);\n    }\n\n//  READ &amp; WRITE STREAM\n    while(1){\n        //returns a file descriptor for the client\n        cli_socket = accept(serv_socket,(struct sockaddr *) &amp;cli_addr,(socklen_t *) sizeof(cli_addr));\n\n        if(cli_socket &lt; 0){\n            perror(\"server: accept error\");\n            exit(EXIT_FAILURE);\n        }\n        printf(\"Server successfully connected to Client\\n\");\n\n        while(1)\n        {\n\n            if ((io_buffer=recv(cli_socket,buffer,sizeof(buffer),0))&lt;0){\n                perror(\"ERROR: recv\");\n                exit(EXIT_FAILURE);\n            }\n            printf(\"\\\"%s\\\" received from client\", buffer);\n\n            if(strcmp(buffer, \"FINISH\") == 0)\n            {\n                break;\n            }\n\n            if ((io_buffer=send(cli_socket,buffer,strlen(buffer),0))!=strlen(buffer)){\n                perror(\"ERROR: send\");\n                exit(EXIT_FAILURE);\n            }\n\n            bzero(buffer, sizeof(buffer));\n        }\n\n        strcpy(buffer, \"OK\");\n        if ((io_buffer=send(cli_socket, buffer, strlen(buffer), 0)) != strlen(buffer)){\n            perror(\"ERROR: send\");\n            exit(EXIT_FAILURE);\n        }\n        printf(\"\\\"OK\\\" message sent to the Client.\\n\");\n        printf(\"Closing the connection \\n\");\n        for(int i=0; i &lt; 5; i++)\n        {\n            printf(\". \");\n            usleep(500000);\n        }\n        close(cli_socket);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "file-io", "file-handling", "eof", "scanf"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1465987653, "post_id": 37833253, "comment_id": 63127658, "body": "Please add more detail about your problem"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1465990267, "post_id": 37833253, "comment_id": 63129496, "body": "Maybeunrelated, but your program is likely to crash if <code>fopen</code> returns NULL, because in that case you should not call <code>fclose</code>. And it will also most likely crash if there are more than 13 integers in your file."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1466001088, "post_id": 37833253, "comment_id": 63137686, "body": "<code>while((fscanf(fp,&quot;%d&quot;,&amp;a[i]))!=EOF &amp;&amp; i &lt; 13){\u2026}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6469022, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IXcMvV9EZqA/AAAAAAAAAAI/AAAAAAAAAEA/9GmA76oSYDI/photo.jpg?sz=128", "display_name": "Sagarmay Biswas", "link": "https://stackoverflow.com/users/6469022/sagarmay-biswas"}, "edited": false, "score": 0, "creation_date": 1465987865, "post_id": 37833311, "comment_id": 63127825, "body": "Thanks for the solution"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 41, "user_id": 6469022, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IXcMvV9EZqA/AAAAAAAAAAI/AAAAAAAAAEA/9GmA76oSYDI/photo.jpg?sz=128", "display_name": "Sagarmay Biswas", "link": "https://stackoverflow.com/users/6469022/sagarmay-biswas"}, "edited": false, "score": 2, "creation_date": 1465992505, "post_id": 37833311, "comment_id": 63131228, "body": "@SagarmayBiswas You&#39;re welcome. You can also <a href=\"http://meta.stackexchange.com/q/5234/244062\">consider accepting an answer that helped you</a>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1465992277, "last_edit_date": 1465992277, "creation_date": 1465987711, "answer_id": 37833311, "question_id": 37833253, "link": "https://stackoverflow.com/questions/37833253/program-crashes-after-fscanf-encounters-eof/37833311#37833311", "title": "Program crashes after fscanf() encounters EOF", "body": "<p>It's not about <code>fsanf()</code> returning <code>EOF</code>, rather, before that itself,, by providing a <em>longer</em> input sequence, you're overrunning the destination array <code>a</code>. Attempt to access out of bound memory invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>. Result can be <em>anything</em>.</p>\n\n<p>When you already have a fixed-length array, don't <em>allow</em> arbitrary number of inputs to be stored, limit the index by the array size (<code>arraysize-1</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1466004209, "creation_date": 1466004209, "answer_id": 37839583, "question_id": 37833253, "link": "https://stackoverflow.com/questions/37833253/program-crashes-after-fscanf-encounters-eof/37839583#37839583", "title": "Program crashes after fscanf() encounters EOF", "body": "<p>Your input has 14 elements which you try to read into 13 element array <code>a[13]</code>. That is why you have a crash.\nIncrease the size of the array or protect the array from overflow. For example</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n#define ARR_SIZE 14\n\nint main()\n{\n  int i;\n  int a[ARR_SIZE];\n  FILE *fp;\n\n  fp=fopen(\"test.txt\",\"r\");\n  if(fp==NULL)\n  {\n     printf(\"File open error\\n\");\n  }\n else\n {\n      i=0;\n      while ( (i&lt;ARR_SIZE) &amp;&amp; (fscanf(fp,\"%d\",&amp;a[i]))!=EOF)\n      {\n         printf(\"%d\\n\",a[i]);\n         i++;\n      }\n\n   printf(\"%d\",i);\n  }\n\n  fclose(fp);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6469022, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IXcMvV9EZqA/AAAAAAAAAAI/AAAAAAAAAEA/9GmA76oSYDI/photo.jpg?sz=128", "display_name": "Sagarmay Biswas", "link": "https://stackoverflow.com/users/6469022/sagarmay-biswas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466004209, "creation_date": 1465987584, "last_edit_date": 1465991718, "question_id": 37833253, "link": "https://stackoverflow.com/questions/37833253/program-crashes-after-fscanf-encounters-eof", "title": "Program crashes after fscanf() encounters EOF", "body": "<p>I'm not even sure if fscanf() actually encounters EOF. Here is my code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\nint i=0,a[13];\nFILE *fp;\nfp=fopen(\"test.txt\",\"r\");\nif(fp==NULL)\n{\n    printf(\"Error\");\n}\nelse\n{\n    i=0;\n    while((fscanf(fp,\"%d\",&amp;a[i]))!=EOF)\n    {\n        printf(\"%d\\n\",a[i]);\n        i++;\n    }\n    printf(\"%d\",i);\n}\nfclose(fp);\nreturn 0;\n}\n</code></pre>\n\n<p>Test input is: </p>\n\n<blockquote>\n  <p>12<br>32<br>45<br>65<br>92<br>-1<br>0<br>61<br>15<br>13<br>12<br>24<br>0<br>4</p>\n</blockquote>\n\n<p>I'm running it in code-blocks.</p>\n\n<p><a href=\"http://i.stack.imgur.com/KbvCA.jpg\" rel=\"nofollow\">This is the runtime condition</a></p>\n"}, {"tags": ["c", "memory", "memory-management", "shared-memory", "mmap"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1465987572, "post_id": 37832738, "comment_id": 63127603, "body": "You mean accessible by ISA DMA?"}, {"owner": {"reputation": 57, "user_id": 6271883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4ZmRF.jpg?s=128&g=1", "display_name": "Mondher123", "link": "https://stackoverflow.com/users/6271883/mondher123"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1465989506, "post_id": 37832738, "comment_id": 63128941, "body": "In my case i am using DMA to transfer data from EIM bus not ISA."}], "owner": {"reputation": 57, "user_id": 6271883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4ZmRF.jpg?s=128&g=1", "display_name": "Mondher123", "link": "https://stackoverflow.com/users/6271883/mondher123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465986345, "creation_date": 1465986345, "last_edit_date": 1495540370, "question_id": 37832738, "link": "https://stackoverflow.com/questions/37832738/share-memory-allocated-at-boot-time-to-user-space", "title": "share memory allocated at boot time to user space", "body": "<p>I am searching a solution to allocate memory from kernel to be accessible by the DMA and shared with user space for fast communication, According to <a href=\"https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiWz9ni5KnNAhXE0hoKHS9QCf8QFggeMAA&amp;url=http%3A%2F%2Fwww.oreilly.com%2Fopenbook%2Flinuxdrive3%2Fbook%2Fch08.pdf&amp;usg=AFQjCNGKLzUZByH93jx0KkSl5ePuaXssQA&amp;sig2=1AIstuu9NCcVsCOyFbwmyA\" rel=\"nofollow noreferrer\">chap08</a> of linux driver3 the only way to allocate huge memory is at boot time method using the function bellow: </p>\n\n<pre><code>#include &lt;linux/bootmem.h&gt;\nvoid *alloc_bootmem_low_pages(unsigned long size);\n</code></pre>\n\n<p>i don't know if this memory can be mapped to user space using mmap() like the memory allocated with kmalloc() ? </p>\n\n<p>i have seen those posts but still get no answer</p>\n\n<p><a href=\"https://stackoverflow.com/questions/25896231/allocating-a-physical-memory-buffer-in-linux\">Allocating a physical memory buffer in linux</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/37549510/allocating-statically-memory-at-kernel-boot-time\">Allocating (statically) memory at kernel boot time</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1465985659, "post_id": 37832235, "comment_id": 63126295, "body": "Do you mean you want to use the PC keyboard like a piano keyboard, to hold several keys at the same time? You might like to consider the WINAPI function <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646299(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetKeyboardState</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1465987209, "post_id": 37832235, "comment_id": 63127321, "body": "This is DOS programming, not Windows."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1465985746, "creation_date": 1465985746, "answer_id": 37832509, "question_id": 37832235, "link": "https://stackoverflow.com/questions/37832235/how-to-access-the-pc-keyboard-buffer-for-detecting-multiple-key-press-and-key-re/37832509#37832509", "title": "How to access the PC Keyboard Buffer for Detecting multiple key press and key release?", "body": "<p>As you include conio.h, the solution is already tied to a Windows (or MS/DOS) platform.</p>\n\n<p>Here as i assume you do not really need a command line program, the best way would be build a Windows GUI program having an event loop and directly processing the <code>WM_KEYDOWN</code> and <code>WM_KEYUP</code> messages to be alerted as soon as a key is pressed on released on the keyboard. To avoid any risk of loosing one change in the state of the key, you could even consistently use the <code>GetKeyboardState</code> API function to load the current state of all keys on the keyboard.</p>\n\n<p>I know this is more a hint that a precise answer, but a detailed answer would be much too long for a SO post.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1465988162, "last_edit_date": 1465988162, "creation_date": 1465987800, "answer_id": 37833343, "question_id": 37832235, "link": "https://stackoverflow.com/questions/37832235/how-to-access-the-pc-keyboard-buffer-for-detecting-multiple-key-press-and-key-re/37833343#37833343", "title": "How to access the PC Keyboard Buffer for Detecting multiple key press and key release?", "body": "<p>This shows how to use the Windows <code>GetAsyncKeyState</code> function. It does not need to be in a GUI - this console app works as shown. It will be up to you to examine the bit status flags <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646293(v=vs.85).aspx\" rel=\"nofollow\">as documented</a> to determine action. For example, auto-repeat is honoured when a key is pressed. You probably won't need to check every key either.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n\nint main(void)\n{\n    unsigned short buff[256] = {0};\n    unsigned short kval;\n    int i;\n    while (1) {\n        for(i=0; i&lt;256; i++) {\n            kval = GetAsyncKeyState(i);\n            if(kval != buff[i]) {\n                printf(\"%02X:%04X \", i, kval);\n                buff[i] = kval;\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>In this test, the first line was output before I pressed any key. The second line was output when I pressed and released <code>'A'</code>.</p>\n\n<pre><code>0D:0001 26:0001 45:0001 53:0001 54:0001 0D:0000 26:0000 45:0000 53:0000 54:0000\n41:8001 41:8000 41:0000\n</code></pre>\n\n<p>Note: linked with <code>user32.lib</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 4802474, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-9LLRb3HpGJ4/AAAAAAAAAAI/AAAAAAAAADg/gvR0mzHQsB0/photo.jpg?sz=128", "display_name": "DCP", "link": "https://stackoverflow.com/users/4802474/dcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 37833343, "answer_count": 2, "score": 0, "last_activity_date": 1465988162, "creation_date": 1465985030, "question_id": 37832235, "link": "https://stackoverflow.com/questions/37832235/how-to-access-the-pc-keyboard-buffer-for-detecting-multiple-key-press-and-key-re", "title": "How to access the PC Keyboard Buffer for Detecting multiple key press and key release?", "body": "<p>I am making a harmonium synthesizer software for PC in C language, for that I have to detect multiple keypress and keyrelease so that to play notes simultaneously accordingly. So, I am thinking that accessing the keyboard buffer would be helpful. But I don't know how to. So can anyone suggest the method to do so or some new idea to detect multiple keypress. For detecting single keypress and keyrelease I have made following C code using kbhit() and getch() functions:-</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;time.h&gt;\n\nvoid keypress(char);\nvoid delay(int);\n\nint flag=0;\n\nint main()\n{\n    char c;\n\n    while(1)\n    {\n        if(kbhit())\n        {\n            c=getch();\n\n            printf(\"\\nCharacter:%c\",c);\n\n            getch();\n\n            keypress(c);\n\n            printf(\"\\nKey Released\");\n\n        }\n    }\n\n    return 0;\n}\n\nvoid keypress(char ch)\n{\n    char c;\n\n    delay(50);\n\n    if(kbhit())\n    {\n        c=getch();\n\n        if(c==ch)\n        {\n            keypress(c);\n        }\n\n    }\n}\n\nvoid delay(int milliSeconds)\n{\n    clock_t final_time = milliSeconds + clock();\n    while (final_time &gt; clock());\n}\n</code></pre>\n\n<p>But it has some issues like:-</p>\n\n<p>1).Multiple keypress not detected </p>\n\n<p>2).It generates a very small delay</p>\n\n<p>So can anybody suggest Improvement to code to solve the above issue or some new techniques for detecting multiple key press and key release.</p>\n\n<p>Platform:-Windows 8.1</p>\n\n<p>It would be good if the solution would platform friendly.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c", "winapi", "keyboard", "keycode"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1465984503, "post_id": 37831799, "comment_id": 63125548, "body": "If you read the man page for <code>GetAsyncKeyState</code> you will see it <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646299(v=vs.85).aspx\" rel=\"nofollow noreferrer\">links you to GetKeyboardState</a>"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1465986153, "post_id": 37831799, "comment_id": 63126600, "body": "Depends on whether you are in a console app or a GUI app"}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1465985642, "post_id": 37832313, "comment_id": 63126280, "body": "It&#39;s <code>GetAsyncKeyState</code>, with a capital <code>G</code>. But you don&#39;t need to call it in a loop anyway, since there is <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646299.aspx\" rel=\"nofollow noreferrer\">GetKeyboardState</a> that returns the key states for the entire keyboard."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1465986216, "post_id": 37832313, "comment_id": 63126634, "body": "@IInspectable Yes, but <code>GetKeyboardState</code> matches <code>GetKeyState</code>, which has different semantics from <code>GetAsyncKeyState</code>. As to which semantics the asker needs, I don&#39;t think that we can be sure."}], "tags": [], "owner": {"reputation": 1580, "user_id": 5186897, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/1004543019596040/picture?type=large", "display_name": "Mattia F.", "link": "https://stackoverflow.com/users/5186897/mattia-f"}, "is_accepted": true, "score": 1, "last_activity_date": 1466000262, "last_edit_date": 1466000262, "creation_date": 1465985212, "answer_id": 37832313, "question_id": 37831799, "link": "https://stackoverflow.com/questions/37831799/how-i-can-determine-which-key-is-pressed-on-keyboard-c/37832313#37832313", "title": "How I can determine which key is pressed on keyboard? C++", "body": "<p>Loop over every character and try each one:</p>\n\n<pre><code>for (char i = 32; i &lt; 127; i++)\n    if (GetAsyncKeyState (i))\n         /* Do whatever you want with that character */;\n</code></pre>\n\n<p>In the example I loop just from ' ' to '~', modify it as you want.</p>\n"}], "owner": {"reputation": 31, "user_id": 6406430, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-LnjsSFx9EkQ/AAAAAAAAAAI/AAAAAAAABgY/4G07ye4V4Ts/photo.jpg?sz=128", "display_name": "Riv Shiell", "link": "https://stackoverflow.com/users/6406430/riv-shiell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "accepted_answer_id": 37832313, "answer_count": 1, "score": -2, "last_activity_date": 1466000262, "creation_date": 1465983909, "question_id": 37831799, "link": "https://stackoverflow.com/questions/37831799/how-i-can-determine-which-key-is-pressed-on-keyboard-c", "title": "How I can determine which key is pressed on keyboard? C++", "body": "<p>How I can determine which key is pressed on keyboard in C++ using WINAPI?</p>\n\n<p>I try to use <code>GetAsyncKeyState</code>, but it work just for exactly one key, and I need to choose which one, but I need to get key\u0441ode to it be send over tcp.</p>\n"}, {"tags": ["c", "java-native-interface", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1465985698, "post_id": 37831652, "comment_id": 63126325, "body": "&#39;I cannot achieve this&#39; is not a problem description."}, {"owner": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1465986251, "post_id": 37831652, "comment_id": 63126653, "body": "I am trying to allocate memory first time for 20 and then i am trying to reallocate it to 40. But It is not working for me. I tried the following: <code>jobjectArray tradeOriginalArray*; sizeofthearray = 20; tradeOriginalArray = malloc(sizeofthearray * sizeof(jobjectArray)); sizeofthearray = 40; tradeOriginalArray = realloc(tradeOriginalArray, sizeof(jobjectArray) * sizeofthearray);</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1465986635, "post_id": 37831652, "comment_id": 63126910, "body": "Why do you think you need to use JNI for this?  This would be a tedious problem to solve for someone familiar with JNI using something like a Java HashSet object.  Doing this with JNI is making an extra effort to take something easy and <b>make</b> it hard."}, {"owner": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 0, "creation_date": 1465986894, "post_id": 37831652, "comment_id": 63127101, "body": "Actually i need to return this object array to java code. Server code is return in C. So that we are using JNI. Is it possible to allocate the memory dynamically for the Object array in JNI?..."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 0, "creation_date": 1465985076, "post_id": 37831910, "comment_id": 63125922, "body": "Ok. Is there any way of allocating memory dynamically in JNI? I am trying to allocate memory first time for 20 and then i am trying to reallocate it to 40. But It is not working for me. I have tried the following:  <code>jobjectArray tradeOriginalArray = NULL; sizeofthearray = 20; tradeOriginalArray = malloc(sizeofthearray * sizeof(jobjectArray)); sizeofthearray = 40; tradeOriginalArray = realloc(tradeOriginalArray, sizeof(jobjectArray) *       sizeofthearray); </code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 0, "creation_date": 1465986508, "post_id": 37831910, "comment_id": 63126811, "body": "Java memory management is completely separate from that provided via <code>malloc()</code>, <code>realloc()</code>, etc."}, {"owner": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 0, "creation_date": 1465986684, "post_id": 37831910, "comment_id": 63126940, "body": "Ok. like allocating memory to pointers in C, can i allocate memory dynamically for object array in JNI?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 0, "creation_date": 1465986758, "post_id": 37831910, "comment_id": 63126989, "body": "No. Once the array is created - either in Java or in JNI using<code>NewObjectArray()</code> - its size is <i>fixed</i>.  If you want an array of a different size, you have to create a <i>new</i> one."}, {"owner": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 0, "creation_date": 1465987122, "post_id": 37831910, "comment_id": 63127270, "body": "I need to have a dynamic object array in JNI?. Is it possible to have?."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 1, "creation_date": 1465987321, "post_id": 37831910, "comment_id": 63127406, "body": "<b>After creation, its length is fixed.</b>  You can <b>NOT</b> resize a Java array."}, {"owner": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "edited": false, "score": 0, "creation_date": 1465989498, "post_id": 37831910, "comment_id": 63128930, "body": "Before creation itself, is it possible to have an array of varible size?. My requirement is, i need to store the values into an array dynamically."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1465984244, "creation_date": 1465984244, "answer_id": 37831910, "question_id": 37831652, "link": "https://stackoverflow.com/questions/37831652/how-to-dynamically-allocate-memory-for-jni-object-array/37831910#37831910", "title": "How to dynamically allocate memory for JNI object array", "body": "<p><em>According to my requirements the array size has to grown dynamically.</em></p>\n\n<p><a href=\"https://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html\" rel=\"nofollow\">You can't use an array.</a></p>\n\n<blockquote>\n  <p>An <em>array</em> is a container object that holds a fixed number of values\n  of a single type. The length of an array is established when the array\n  is created. After creation, its length is fixed.</p>\n</blockquote>\n\n<p>You have to use something other than a Java array to hold your data if its size has to change.</p>\n\n<p>Or you can allocate a <em>new</em> array each time the size needs to change and copy the array elements from the old array to the new array.</p>\n"}], "owner": {"reputation": 27, "user_id": 4906718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78439743f6293977219b4ed3fa0f00e9?s=128&d=identicon&r=PG&f=1", "display_name": "Shan Sundar", "link": "https://stackoverflow.com/users/4906718/shan-sundar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1465987643, "creation_date": 1465983504, "last_edit_date": 1465987643, "question_id": 37831652, "link": "https://stackoverflow.com/questions/37831652/how-to-dynamically-allocate-memory-for-jni-object-array", "title": "How to dynamically allocate memory for JNI object array", "body": "<p>I am working on JNI with C language. Here I have created an object array of size 4000. According to my requirements the array size has to grow dynamically. How can I allocate memory dynamically? I have tried using <code>malloc</code>. But I cannot achieve this.</p>\n\n<p>Here's what I have tried:</p>\n\n<pre><code>OriginalArray = (*env)-&gt;NewObjectArray(env, 4000, tradeObject, NULL);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "edited": false, "score": 0, "creation_date": 1465983288, "post_id": 37831498, "comment_id": 63124689, "body": "Probably, buffer size is insufficient. Try to give <code>char command[]</code> more bytes."}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "reply_to_user": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "edited": false, "score": 0, "creation_date": 1465983400, "post_id": 37831498, "comment_id": 63124767, "body": "I already do that increase the buf size to 512, but is the same problem"}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "reply_to_user": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "edited": false, "score": 0, "creation_date": 1465983646, "post_id": 37831498, "comment_id": 63124940, "body": "<a href=\"http://stackoverflow.com/questions/19913446/why-should-the-system-function-be-avoided-in-c-and-c\" title=\"why should the system function be avoided in c and c\">stackoverflow.com/questions/19913446/&hellip;</a>"}, {"owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "edited": false, "score": 0, "creation_date": 1465983651, "post_id": 37831498, "comment_id": 63124946, "body": "What is <code>get_name_from_conf</code>? Does that return a pointer to a constant? A value on the stack? Something on the heap?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1465983686, "post_id": 37831498, "comment_id": 63124973, "body": "<code>sprintf(path, &quot;&#47;etc&#47;config&#47;&quot;, d_file-&gt;d_name);</code> what is this?"}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "edited": false, "score": 0, "creation_date": 1465983699, "post_id": 37831498, "comment_id": 63124984, "body": "this link is explain why we have to avoid the use of system function"}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "edited": false, "score": 0, "creation_date": 1465983794, "post_id": 37831498, "comment_id": 63125050, "body": "@ Sourav Ghosh : the path variable will be use by stat function"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465983831, "post_id": 37831498, "comment_id": 63125081, "body": "@Anis_Stack please double-check, this does not do anything meaningful..."}, {"owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1465983858, "post_id": 37831498, "comment_id": 63125093, "body": "@Sourav Good point! @Anis_Stack, the second parameter to <code>sprintf()</code> needs some <code>%</code> modifiers: <code>&quot;&#47;etc&#47;config&#47;%s&quot;</code>"}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "edited": false, "score": 0, "creation_date": 1465984075, "post_id": 37831498, "comment_id": 63125239, "body": "&quot;/etc/config/%s&quot; is correct now"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1465984470, "post_id": 37831498, "comment_id": 63125523, "body": "Are you sure you can call <code>closedir (dir);</code> with <code>dir = NULL</code> ?"}, {"owner": {"reputation": 697, "user_id": 1020559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78516734de5c440b49559e47ab06e9ff?s=128&d=identicon&r=PG", "display_name": "DaV", "link": "https://stackoverflow.com/users/1020559/dav"}, "edited": false, "score": 2, "creation_date": 1465984494, "post_id": 37831498, "comment_id": 63125541, "body": "Post your <i>actual</i> code. <code>get_name_from_conf(&quot;&#47;etc&#47;config&quot;, &amp;name)</code> won&#39;t even compile."}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "edited": false, "score": 0, "creation_date": 1465985919, "post_id": 37831498, "comment_id": 63126465, "body": "you did not need get_name_from_conf"}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "edited": false, "score": 0, "creation_date": 1465985946, "post_id": 37831498, "comment_id": 63126484, "body": "you can use char *name = &quot;toto&quot;"}, {"owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "edited": false, "score": 0, "creation_date": 1465986624, "post_id": 37831498, "comment_id": 63126898, "body": "@Anis_Stack Do us a favour: replace the call <code>get_name_from_conf(...);</code> with <code>name = &quot;toto&quot;;</code> and run your program again. Does it work now? The reason I ask is that the rest <i>looks</i> OK, while that whole loop looks suspicious. You call <code>get_name_from_conf</code> once, then enter a loop calling <code>check_file_dir()</code> repeatedly on the same <code>name</code> over and over... Does your real code actually modify <code>name</code>? Should <code>get_name_from_conf</code> be called inside the loop?"}, {"owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "edited": false, "score": 0, "creation_date": 1465986935, "post_id": 37831498, "comment_id": 63127127, "body": "in fact is not the real code, but is the brief code"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1465993884, "post_id": 37831498, "comment_id": 63132203, "body": "@Anis_Stack Perhaps the actual error is in the real code. If it is, noone here will find it. So you are better off posting the real code."}], "answers": [{"tags": [], "owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "is_accepted": false, "score": -2, "last_activity_date": 1465987748, "last_edit_date": 1495542162, "creation_date": 1465986723, "answer_id": 37832905, "question_id": 37831498, "link": "https://stackoverflow.com/questions/37831498/c-system-function-cause-a-segmentation-fault/37832905#37832905", "title": "c system () function cause a segmentation fault", "body": "<p>according to this link \n<a href=\"https://stackoverflow.com/questions/19209141/how-do-i-execute-a-shell-built-in-command-with-a-c-function\">How do I execute a Shell built-in command with a C function?</a></p>\n\n<p>use execl(\"sh\", \"sh\", \"-c\", command, NULL) instead of system</p>\n"}, {"tags": [], "owner": {"reputation": 12533, "user_id": 931027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lWhaB.jpg?s=128&g=1", "display_name": "Kusalananda", "link": "https://stackoverflow.com/users/931027/kusalananda"}, "is_accepted": false, "score": 0, "last_activity_date": 1465993558, "creation_date": 1465993558, "answer_id": 37835413, "question_id": 37831498, "link": "https://stackoverflow.com/questions/37831498/c-system-function-cause-a-segmentation-fault/37835413#37835413", "title": "c system () function cause a segmentation fault", "body": "<p>I can't reproduce your issue because your code does not compile. This is a working version of your program with annotations of changes (and with <code>testdir</code> replacing <code>/etc/config</code>):</p>\n\n<pre><code>#include &lt;limits.h&gt; /* for PATH_MAX and LINE_MAX */\n#include &lt;stdio.h&gt;  /* header include was missing */\n#include &lt;stdlib.h&gt; /* header include was missing */\n#include &lt;time.h&gt;   /* header include was missing */\n\n#include &lt;dirent.h&gt;   /* header include was missing */\n#include &lt;sys/stat.h&gt; /* header include was missing */\n\nint check_file_dir(char *name)\n{\n    int i = 0;\n    char command[LINE_MAX];  /* standard max command line length */\n    /* path was wrong below */\n    sprintf(command, \"ls %s &amp;&gt; /dev/null\", name);\n    printf(\"====&gt; command =%s \\n\", command);\n    i = system(command);\n    return i;\n}\n\nvoid get_file_info()\n{\n    char name[PATH_MAX]; /* standard max path length */\n    struct dirent *d_file;\n    struct stat attr;\n    char path[PATH_MAX]; /* standard max path length */\n    char s_now[sizeof \"AAAA-MM-JJTHH:MM:SS.000Z\"];\n    DIR *dir;            /* declaration was missing */\n    int FILE_NUMBER = 0; /* declaration was missing */\n\n    if ((dir = opendir(\"testdir\")) == NULL)\n        return; /* no point to go on */\n\n    while ((d_file = readdir(dir)) != NULL) {\n        if (d_file-&gt;d_name[0] == '.')\n            continue;\n        sprintf(path, \"testdir/%s\", d_file-&gt;d_name);\n        stat(path, &amp;attr);\n        strftime(s_now, sizeof s_now, \"%Y-%m-%dT%H:%M:%S.000Z\",\n                 localtime(&amp;attr.st_mtime)); /* not used? */\n        ++FILE_NUMBER; /* assuming this is what you meant to do */\n    }\n    closedir(dir); /* was called even if !opendir() */\n\n    int j;\n    for (j = 0; j &lt; FILE_NUMBER; j++) {\n        sprintf(name, \"testdir/file%d\", j);\n        if (check_file_dir(name) != 0)\n            printf(\"file doesn't exist \\n\");\n    }\n}\n\nint main(void) /* int and (void) */\n{\n    get_file_info();\n    get_file_info();\n    return 0; /* was missing */\n}\n</code></pre>\n"}], "owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1230, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465993558, "creation_date": 1465983091, "last_edit_date": 1465987276, "question_id": 37831498, "link": "https://stackoverflow.com/questions/37831498/c-system-function-cause-a-segmentation-fault", "title": "c system () function cause a segmentation fault", "body": "<p>I use the <code>system</code> function to execute a linux command in my \ndevice which use openwrt distribution as embedded OS.</p>\n\n<blockquote>\n  <p>int system(const char *command);</p>\n</blockquote>\n\n<p>my program is like  below </p>\n\n<pre><code>int check_file_dir(char *name)\n{\n    int i = 0;\n    char command[128];\n    sprintf(command, \"ls /etc/config/%s &amp;&gt; /dev/null\", name);\n    printf(\"====&gt; command =%s \\n\", command);\n    i = system(command);\n    return i;\n}\n\nvoid get_file_info () \n{\nchar name[128]; \nstruct dirent *d_file;\nstruct stat attr;\nchar path[128];\nchar s_now[sizeof \"AAAA-MM-JJTHH:MM:SS.000Z\"];\n\n   if ((dir = opendir (\"/etc/config/\")) != NULL) \n   {\n        while ((d_file = readdir (dir)) != NULL) \n        {\n            if(d_file-&gt;d_name[0] == '.')\n                continue;\n            sprintf(path, \"/etc/config/%s\", d_file-&gt;d_name);\n            stat(path, &amp;attr);\n            strftime(s_now, sizeof s_now, \"%Y-%m-%dT%H:%M:%S.000Z\", localtime(&amp;attr.st_mtime));\n        }\n    }\n    closedir (dir);\n    int j;\n    for (j = 0; j&lt; FILE_NUMBER; j++)\n    {\n       sprintf(name, \"/etc/config/file%d\", j); \n       if(check_file_dir(name) !=0)\n           printf(\"file doesn't exist \\n\");\n    }\n}\n\n\n void main () \n{\nget_file_info();\nget_file_info();\n}\n</code></pre>\n\n<p>the problem is cause by <code>system</code> function when <code>get_file_info()</code> is called twice!</p>\n\n<p>they is any precautions to take to avoid system seg fault ?</p>\n"}, {"tags": ["c", "floating-point", "printf", "type-punning"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1465981917, "post_id": 37830827, "comment_id": 63123736, "body": "I presume this is C, though I get the same if I compile it as C++: a language tag might get more people looking"}, {"owner": {"reputation": 2050, "user_id": 6367213, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208200060392228/picture?type=large", "display_name": "Janez Kuhar", "link": "https://stackoverflow.com/users/6367213/janez-kuhar"}, "edited": false, "score": 0, "creation_date": 1465982134, "post_id": 37830827, "comment_id": 63123875, "body": "I only get compiler warnings, saying that printf expects an integer while I&#39;m feeding it a double. But it compiles and prints two sixes both times. What compiler are you using?"}, {"owner": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "reply_to_user": {"reputation": 2050, "user_id": 6367213, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208200060392228/picture?type=large", "display_name": "Janez Kuhar", "link": "https://stackoverflow.com/users/6367213/janez-kuhar"}, "edited": false, "score": 0, "creation_date": 1465982405, "post_id": 37830827, "comment_id": 63124055, "body": "@JanezKuhar Codeblocks"}, {"owner": {"reputation": 2050, "user_id": 6367213, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208200060392228/picture?type=large", "display_name": "Janez Kuhar", "link": "https://stackoverflow.com/users/6367213/janez-kuhar"}, "edited": false, "score": 0, "creation_date": 1465983193, "post_id": 37830827, "comment_id": 63124607, "body": "With gcc version 4.8.4 I get 4 sixes. However with gcc version 5.3.1 I get: 6 -1717986918 for the first <code>main()</code> and 6 6 for the second one."}, {"owner": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1465983435, "post_id": 37830827, "comment_id": 63124798, "body": "do u know why so ?"}, {"owner": {"reputation": 2050, "user_id": 6367213, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208200060392228/picture?type=large", "display_name": "Janez Kuhar", "link": "https://stackoverflow.com/users/6367213/janez-kuhar"}, "edited": false, "score": 0, "creation_date": 1466154541, "post_id": 37830827, "comment_id": 63210175, "body": "@SurajJain It is a mystery to me."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2050, "user_id": 6367213, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208200060392228/picture?type=large", "display_name": "Janez Kuhar", "link": "https://stackoverflow.com/users/6367213/janez-kuhar"}, "edited": false, "score": 1, "creation_date": 1486224249, "post_id": 37830827, "comment_id": 71258069, "body": "@JanezKuhar: it is not a mystery, it is <b>undefined behavior</b>. A program with undefined behavior can produce different output on different systems and even different output on the same system when invoked multiple times. Trying to explain the observed behavior for a specific instance is hardly useful. When investigating certain situation from forensic evidence, one can come up with a useful explanation and directions for improvement.  Think of plane crashes, computer virus analysis, email hacking..."}], "answers": [{"comments": [{"owner": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1465982365, "post_id": 37831064, "comment_id": 63124027, "body": "But in the second program %d is used for z still it is not outputting 6."}, {"owner": {"reputation": 2214, "user_id": 2607571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898b3ca6cbc371e33421d40a3ef20c49?s=128&d=identicon&r=PG", "display_name": "Simon Kirsten", "link": "https://stackoverflow.com/users/2607571/simon-kirsten"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1465982642, "post_id": 37831064, "comment_id": 63124231, "body": "This happens because printf uses varargs internally and for some reason the data is corrupted because of the wrong read. Please try this line again but with <code>6.4f</code> as the parameter. I suspect this is happening because the compiler passes 6.4 as an double and thus the second <code>%d</code> is reading the second half of that double. But I might be wrong."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1486107033, "post_id": 37831064, "comment_id": 71212213, "body": "passing the wrong type results in undefined behavior, period. <code>printf</code> might not even get the value from the data passed and later arguments will be in the wrong place too. Trying to elaborate on actual behavior is a moot point."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1486107127, "post_id": 37831064, "comment_id": 71212256, "body": "@SimonKirsten: <code>float</code> values are implicitly promoted to <code>double</code> when passed to vararg functions, your suggestion makes no difference, which does not means the output will be the same, since the code has undefined behavior, output might even be different for each invokation, and indeed <b>is</b> different on some architectures."}, {"owner": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1486214207, "post_id": 37831064, "comment_id": 71255002, "body": "@chqrlie You know , you can answer that it is an UB , a beginner does not know these things, he would have happily edited his question , but you just downvote."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "edited": false, "score": 0, "creation_date": 1486217971, "post_id": 37831064, "comment_id": 71256096, "body": "@SurajJain: I did not downvote at all, neither the question nor your answer. My comments were informative, your interpretation may or may not hold because ABIs differ from one environment to the other. It is essential for beginners to understand something about UB. Passing arguments inconsistent with the format string is a very good example of UB."}, {"owner": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1486221602, "post_id": 37831064, "comment_id": 71257298, "body": "@chqrlie oh , sorry for misunderstanding , you know actually my this question is getting downvoted once in a while , and i thought you commented so you did , thanks for the upvote , can we have a chat sometime ?"}], "tags": [], "owner": {"reputation": 2214, "user_id": 2607571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898b3ca6cbc371e33421d40a3ef20c49?s=128&d=identicon&r=PG", "display_name": "Simon Kirsten", "link": "https://stackoverflow.com/users/2607571/simon-kirsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1465982353, "last_edit_date": 1465982353, "creation_date": 1465981935, "answer_id": 37831064, "question_id": 37830827, "link": "https://stackoverflow.com/questions/37830827/how-does-printf-work-why-is-the-output-different/37831064#37831064", "title": "How does printf work? Why is the output different?", "body": "<p>You store <code>6.4</code> in an integer which will result in <code>z</code> being <code>6</code>. The 6 gets passed to <code>printf</code> which is <em>interpreting</em> the passed value as an decimal, thus the correct output was displayed.</p>\n\n<p>But if you pass a floating point number directly to <code>printf</code>, and specifying the format <code>%d</code>, it will also interpret it as an decimal which will result in the decimal interpretations of that float. </p>\n\n<p>This interpretation happens on a bit level. Float is internally stored in a rather complex format. But not like an integer.\nNow those bits get interpreter as an integer, and obviously the result is unreadable for humans. But the program could actually interpreted that integer as an float and reverse this action.</p>\n\n<p><a href=\"http://www.h-schmidt.net/FloatConverter/IEEE754.html\" rel=\"nofollow\">This</a> site will demonstrate how floats are stored on the bit level.</p>\n\n<p>And on <a href=\"http://www.binaryconvert.com\" rel=\"nofollow\">this</a> website you can convert the bits from the previous site to an signed integer which should output the negative number you specified in the question.</p>\n"}], "owner": {"reputation": 3817, "user_id": 5473170, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-TqTWy9pKa2g/AAAAAAAAAAI/AAAAAAAAASw/aJ0ynw2sjqM/photo.jpg?sz=128", "display_name": "Suraj Jain", "link": "https://stackoverflow.com/users/5473170/suraj-jain"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "closed_date": 1465982273, "answer_count": 1, "score": -2, "last_activity_date": 1487182408, "creation_date": 1465981413, "last_edit_date": 1487182408, "question_id": 37830827, "link": "https://stackoverflow.com/questions/37830827/how-does-printf-work-why-is-the-output-different", "closed_reason": "Duplicate", "title": "How does printf work? Why is the output different?", "body": "<p>Consider these two programs:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  int z = 6.4;\n  printf(\"%d %d\", z, 6.4);\n  return 0;\n}\n</code></pre>\n\n<p>Output is <code>6 -1717986918</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  int z = 6.4;\n  printf(\"%d %d\", 6.4, z);\n  return 0;\n}\n</code></pre>\n\n<p>Output is <code>-1717986918 1075419545</code>.</p>\n\n<p>Why does the output vary like that? When <code>z</code> was first then the output printed correct <code>z</code> value which was <code>6</code> as <code>z</code> is an integer, but when I reversed the arguments, the output is a different value.  Why does it behave like that?</p>\n"}, {"tags": ["c", "if-statement", "malloc"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1465981059, "post_id": 37830584, "comment_id": 63123160, "body": "Bad code. BTW is allocating <code>sizeof( struct ST_info)</code> byte into heap memory and assign the its address to  <code>st_cur</code> pointer. The it checks if the returned address is valid <code>!= NULL </code> Take a look at <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">the F...ine Man</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1465981059, "post_id": 37830584, "comment_id": 63123161, "body": "Break it down into smaller components. And remember that if <code>malloc</code> fails it returns <code>NULL</code> which is implicitly comparable to zero, and zero is equivalent to &quot;false&quot;, and also remember that the logical not operator <code>!</code> gives you &quot;true&quot; if the expression is &quot;false&quot;."}, {"owner": {"reputation": 39, "user_id": 6242699, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/adfb70c1e872db49396eb0f344233085?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/6242699/helloworld"}, "edited": false, "score": 0, "creation_date": 1465981396, "post_id": 37830584, "comment_id": 63123383, "body": "thanks for comments. I have one more question.  After run this code, should i free st_cur ? In other words, if i don&#39;t free st_cur, it causes memory leak?"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1465981397, "post_id": 37830584, "comment_id": 63123384, "body": "@LPs I wouldn&#39;t call this bad code, it&#39;s quite common practice (IIRC, K&amp;R also used similar constructs)."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1465981592, "post_id": 37830584, "comment_id": 63123518, "body": "@Leandros Using <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> cast of <code>malloc</code> return is not required and should be avoided. My personal opinion: assign into <code>if</code> statement make the code less friendly and check <code>!= NULL</code> is more readable."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1465981656, "post_id": 37830584, "comment_id": 63123567, "body": "@HelloWorld You shouldn&#39;t, you <b>have to</b> free heap allocated memory."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1465981691, "post_id": 37830584, "comment_id": 63123590, "body": "Means someone was fond of superfluous parenthesis. Just throw that code out the window and use: <code>st_cur = malloc(sizeof(struct ST_info)); if(st_cur == NULL) {   perror(&quot;malloc failed&quot;);   return 1; }</code>. (but with proper indention, obviously)"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1465986897, "post_id": 37830584, "comment_id": 63127104, "body": "@LPs Whether the result of <code>malloc</code> should be casted or not is totally based on opinion, neither way is &quot;correct&quot; nor &quot;incorrect&quot;. And yes, I totally agree that the check should&#39;ve been rewritten is <code>!= NULL</code>, it&#39;s a lot more readable!"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1465986930, "post_id": 37830584, "comment_id": 63127124, "body": "@Lundin They&#39;re not really superfluous, they&#39;re required due to the precedence of <code>=</code>."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1466595629, "post_id": 37830584, "comment_id": 63379687, "body": "If an answer solved your problem or helped you, please consider to accept it, see also: <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "is_accepted": false, "score": 0, "last_activity_date": 1465981247, "creation_date": 1465981247, "answer_id": 37830745, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37830745#37830745", "title": "Malloc in If Statement in C", "body": "<p>In <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a>, an assignment will always return the assigned value.</p>\n\n<p>In your specific case, <code>st_cur</code> is assigned, and after being assigned it's checked if it returned a valid value.</p>\n\n<p>It's equivalent to this.</p>\n\n<pre><code> st_cur = (struct ST_info*)malloc(sizeof(struct ST_info));\n if (!st_cur) {\n     perror(\"malloc failed\");\n     return 1;\n }\n</code></pre>\n\n<p>If you wonder, why there are so many parentheses, they're required due to <code>=</code> having the lowest precedence of all operators in C.</p>\n"}, {"tags": [], "owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "is_accepted": false, "score": 0, "last_activity_date": 1466595323, "last_edit_date": 1495542165, "creation_date": 1465981262, "answer_id": 37830754, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37830754#37830754", "title": "Malloc in If Statement in C", "body": "<p>This is an assignment:</p>\n\n<pre><code>st_cur = (struct ST_info *) malloc(sizeof(struct ST_info))\n</code></pre>\n\n<p>that allocates memory and returns the pointer to that chunk of memory. If the allocation fails, malloc returns NULL, which is equivalent to 0 (<a href=\"https://stackoverflow.com/questions/1296843/what-is-the-difference-between-null-0-and-0\">post</a> on NULL and 0). (BTW cast of malloc is pointless, see this <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">post</a>)</p>\n\n<p>Then the result of the assignement, stored in st_cur is tested, so we can se it like in the follwing:</p>\n\n<pre><code>if (! st_cur )\n</code></pre>\n\n<p>which is equivalent to:</p>\n\n<pre><code>if (st_cur == NULL)\n</code></pre>\n\n<p>And thus if the allcation fail the perror function is called and the code return with 1</p>\n\n<p>I would rewrite it:</p>\n\n<pre><code>st_cur = malloc(sizeof(struct ST_info));\nif (st_cur == NULL) {\n    perror( \"malloc failed\" );\n    return(1);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "edited": false, "score": 1, "creation_date": 1465981531, "post_id": 37830783, "comment_id": 63123479, "body": "0 is <code>false</code> and not-0 is <code>true</code>. Your answer implies the opposite."}], "tags": [], "owner": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1465981689, "last_edit_date": 1465981689, "creation_date": 1465981327, "answer_id": 37830783, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37830783#37830783", "title": "Malloc in If Statement in C", "body": "<p>Inside <code>if</code> condition there can be any statement, that has value, which can be identified 0 or not-0, false or true .</p>\n\n<p><code>st_cur = (struct ST_info *) malloc(sizeof( struct ST_info ) )</code></p>\n\n<p>In this statement <code>malloc</code> is called and it's return value is assigned to <code>st_cur</code>. Value of all statement is value of <code>st_cur</code>.\n<code>!st_cur</code> is true, when st_cur is <code>NULL</code>\nSo, equivalent code is</p>\n\n<pre><code>st_cur = (struct ST_info *) malloc(sizeof( struct ST_info ) ) \nif( ! st_cur )\n{\n    perror( \"malloc failed\" );\n    return( 1 );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1465981388, "last_edit_date": 1495540350, "creation_date": 1465981388, "answer_id": 37830813, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37830813#37830813", "title": "Malloc in If Statement in C", "body": "<ol>\n<li><code>malloc(sizeof( struct ST_info )</code> --> Allocate memory of given size.</li>\n<li><code>st_cur = (struct ST_info *) malloc...</code>  --> store the pointer returned by malloc in <code>st_cur</code>. Note that the cast <code>(struct ST_info *)</code> is unnecessary and sometimes dangerous. See more information <a href=\"https://stackoverflow.com/questions/1565496/specifically-whats-dangerous-about-casting-the-result-of-malloc\">at this answer.</a></li>\n<li><code>if( ! st_cur ..</code>  --> After the malloc has completed, check the value of <code>st_cur</code>. If it is 0 (NULL), then report an error, and return.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11856, "user_id": 2873538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gayoG.png?s=128&g=1", "display_name": "Ajeet Shah", "link": "https://stackoverflow.com/users/2873538/ajeet-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1465983016, "last_edit_date": 1465983016, "creation_date": 1465981905, "answer_id": 37831053, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37831053#37831053", "title": "Malloc in If Statement in C", "body": "<p><code>Malloc</code> function is used to dynamically allocate some memory as required. Syntax to use <code>malloc</code> function is as follows:</p>\n\n<pre><code>(void *) malloc(size_of_memory_block)\n</code></pre>\n\n<p>Where argument <code>size_of_memory_block</code> is the amount of memory requested in bytes which you can find using <code>sizeof(data_type)</code> function. And it returns a pointer (of type <code>void *</code>) to the block of memory allocated. </p>\n\n<p>In your case:</p>\n\n<pre><code>st_cur = (struct ST_info *) malloc( sizeof (struct ST_info) )\n</code></pre>\n\n<p>It allocates a memory block of size of your structure (<code>struct ST_info</code>) and returns a pointer to it which you are assigning to <code>st_cur</code>. Sometimes <code>Malloc</code> may fail (primarily due to system being out of memory) to allocate the memory size requested. Then it returns <code>NULL</code> which you are handling in your code with <code>if</code> condition.</p>\n\n<p><code>Malloc</code> functions return type is always <code>void *</code> which you can cast to the type as required. In your code, you are casting it to type <code>struct ST_info *</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 276, "user_id": 5043959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206925952405800/picture?type=large", "display_name": "Sulli", "link": "https://stackoverflow.com/users/5043959/sulli"}, "is_accepted": false, "score": 1, "last_activity_date": 1466697233, "last_edit_date": 1466697233, "creation_date": 1465982141, "answer_id": 37831133, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37831133#37831133", "title": "Malloc in If Statement in C", "body": "<p>Let's start by taking a look at the <a href=\"http://linux.die.net/man/3/malloc\" rel=\"nofollow\">malloc manual</a>:</p>\n\n<blockquote>\n  <p>The malloc() function allocates size bytes and returns a pointer to the allocated memory.</p>\n</blockquote>\n\n<p>If we dig in a little bit more and read the \"return value\" section of the manual:</p>\n\n<blockquote>\n  <p>The malloc() and calloc() functions return a pointer to the allocated memory that is suitably aligned for any kind of variable. On error, these functions return NULL.</p>\n</blockquote>\n\n<p>With that in mind, what your code does is:</p>\n\n<ul>\n<li>call malloc to allocate memory for the size of a struct ST_info.</li>\n<li>cast the return value of malloc (void *, or generic pointer) to a struct ST_info.</li>\n<li>assign it to the variable st_cur.</li>\n<li>checks whether st_cur is null (that's what the \"!\" is used for) in case malloc somehow failed, in which case the code within the curly braces is executed.</li>\n</ul>\n\n<p>As for all the parenthesis, they are here to ensure the code is executed in this order.</p>\n"}, {"tags": [], "owner": {"reputation": 8510, "user_id": 1292918, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/44cdb725bf1a393149554bae7f5f9d46?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/1292918/toby"}, "is_accepted": false, "score": 1, "last_activity_date": 1465986674, "creation_date": 1465986674, "answer_id": 37832885, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37832885#37832885", "title": "Malloc in If Statement in C", "body": "<p>Let's break it down a bit.</p>\n\n<pre><code>if( ! ( st_cur = (struct ST_info *) malloc(sizeof( struct ST_info ) ) ) )\n{\n    perror( \"malloc failed\" );\n    return( 1 );\n}\n</code></pre>\n\n<p>Is equivalent to:</p>\n\n<pre><code>struct ST_info * st_cur = NULL;\n//...\n\n/* Assign heap memory of native byte size equal to that \n * of struct ST_info and save a pointer to the allocated \n * memory. */\nst_cur = malloc( sizeof( struct ST_info ) ); \n\n/* If the malloc succeeded it will have returned a valid \n * pointer to some part of the heap, otherwise it returns \n * NULL so we check for NULL here. */\nif (st_cur == NULL) { \n    /* Print a relevant error message to stderr. */\n    perror(\"malloc failed\"); \n    /* Return a non-zero value to indicate that something failed. */\n    return(1); \n}\n</code></pre>\n\n<p>If you later wish to free the memory, which one should do for all dynamically allocated memory before finishing a program, you can use <code>free()</code>. here you do not need to first check for <code>NULL</code> as A) the <code>if</code> above should have caught it, and B) if passed <code>NULL</code> then <code>free</code> safely does nothing.</p>\n\n<p><code>malloc</code> can fail due to the system not being able to allocate the amount of memory requested. If the size passed to <code>malloc</code> is <em>zero</em> then the return value is implementation dependent but the returned pointer shall not be dereferenced.</p>\n\n<p>Additionally, it has become good practice to not explicitly cast the value returned by <code>malloc</code>, thus </p>\n\n<pre><code> st_cur = (struct ST_info *) malloc(sizeof( struct ST_info ) )\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code> st_cur = malloc(sizeof( struct ST_info ) )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 224, "user_id": 6466179, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d96ef709822aba09220e2c8ce558fadb?s=128&d=identicon&r=PG&f=1", "display_name": "ygongdev", "link": "https://stackoverflow.com/users/6466179/ygongdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1466026194, "creation_date": 1466026194, "answer_id": 37846116, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c/37846116#37846116", "title": "Malloc in If Statement in C", "body": "<p>In plain words, it is saying</p>\n\n<p>Hey malloc, give me enough memory for the size of the ST_info struct (Let's say ST_info struct has N bytes).</p>\n\n<p>If there isn't enough memory left for N bytes, malloc() will return NULL. But if there is enough, malloc() will return you a void pointer (void *) to the chunk of memory.</p>\n\n<p>Then you are casting that void pointer to a struct ST_Info pointer (struct ST_info *) and storing it in the variable st_cur. </p>\n\n<p>Then the ! is checking whether or not st_cur is NULL. If st_cur is NULL (meaning malloc() failed to give you memory), the if statement would be true and you would see perror() and return(1)</p>\n\n<p>If st_cur is not NULL, it means malloc() successfully allocated memory and the whole if statement is bypassed</p>\n"}], "owner": {"reputation": 39, "user_id": 6242699, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/adfb70c1e872db49396eb0f344233085?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/6242699/helloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1917, "favorite_count": 0, "answer_count": 8, "score": 0, "last_activity_date": 1466697233, "creation_date": 1465980808, "question_id": 37830584, "link": "https://stackoverflow.com/questions/37830584/malloc-in-if-statement-in-c", "title": "Malloc in If Statement in C", "body": "<p>i am new in c, and i can not understand  following piece of code. If anyone can explain it, i am really happy. Thanks in advance. </p>\n\n<pre><code> if( ! ( st_cur = (struct ST_info *) malloc(sizeof( struct ST_info ) ) ) )\n    {\n        perror( \"malloc failed\" );\n        return( 1 );\n    }\n</code></pre>\n"}, {"tags": ["c", "gtk3", "glib"], "comments": [{"owner": {"reputation": 260, "user_id": 8322623, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XtjmiGIeM-U/AAAAAAAAAAI/AAAAAAAAABw/RVDz5MYOGsk/photo.jpg?sz=128", "display_name": "Paul Childs", "link": "https://stackoverflow.com/users/8322623/paul-childs"}, "edited": false, "score": 0, "creation_date": 1538618330, "post_id": 37830489, "comment_id": 92208753, "body": "The question should not be entitled &quot;... and writing...&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 1, "last_activity_date": 1466378078, "creation_date": 1466378078, "answer_id": 37912790, "question_id": 37830489, "link": "https://stackoverflow.com/questions/37830489/loading-and-writing-binary-files-using-gtk3-in-c/37912790#37912790", "title": "Loading and writing binary files using gtk3 in c", "body": "<p><code>g_file_get_contents</code> reads the entire file, just like you want.  However, if you throw away the length and treat it as a string in C, then obviously you will have problems reading past the first null byte.</p>\n\n<p>The first thing you should do is save the length.  Change your call to <code>g_file_get_contents</code> to something like:</p>\n\n<pre><code>gsize length;\ng_file_get_contents(filename, &amp;contents, &amp;length, NULL);\n</code></pre>\n\n<p>In real-world code you should also check the return value and/or GError argument\u2026</p>\n\n<p>Now you have an array of bytes in <code>contents</code>, and the number of bytes in <code>length</code>.  Note that <code>length</code> is the size of the entire file, <em>not</em> the number of bytes up to the first null bytes.  You can do whatever you want with that data, just keep in mind that, in C, strings are null-terminated.  That means that if you choose to treat the buffer as a string, the first null byte is the end of that string.  If you want to keep reading, just start again at the next byte; as long as you don't go past the end of the file you should be fine.</p>\n"}], "owner": {"reputation": 1, "user_id": 6468420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b23e042230abd6b4ae664fadf9053b?s=128&d=identicon&r=PG&f=1", "display_name": "Vertika Bindal", "link": "https://stackoverflow.com/users/6468420/vertika-bindal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1466378078, "creation_date": 1465980572, "last_edit_date": 1465988760, "question_id": 37830489, "link": "https://stackoverflow.com/questions/37830489/loading-and-writing-binary-files-using-gtk3-in-c", "title": "Loading and writing binary files using gtk3 in c", "body": "<p>I am building an app to analyse scientific data using <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> <a href=\"/questions/tagged/gtk3\" class=\"post-tag\" title=\"show questions tagged &#39;gtk3&#39;\" rel=\"tag\">gtk3</a>. I am unable to load binary files and create new binary with some part of the content from the read file.</p>\n\n<p>I used <code>GFileoutputStream</code> and <code>g_file_load_contents</code> but as soon as zero comes it takes it as terminating character which i don't want. I want to read even zeros and then extract data bit wise. Any help would be highly appreciated.</p>\n\n<p>My code:</p>\n\n<pre><code> void file_selected(GtkWidget *filechooserbutton, gpointer data, GtkTextBuffer *buffer) {   \n    filename=gtk_file_chooser_get_filename(GTK_FILE_CHOOSER(filechooserbutton));\n    g_file_get_contents(filename, &amp;contents, NULL, NULL);\n\n    text1 = g_substr(contents,0,value);     \n\n    gint DataHeaderNum=96;\n    gint value2=value+DataHeaderNum;\n    text2 = g_substr(contents,value,value2);        \n\n    gchar *filler;\n    filler=g_strnfill (DataHeaderNum,'0');\n    //g_print(filler);\n    gint DataNum=2048-DataHeaderNum;\n    gint value3=value2+DataNum;\n    text3 = g_substr(contents,value,value3);\n    g_strlcat(filler,text3,2048);\n    text3=g_strdup(filler);\n    //g_print(text3);\n\n\n    gchar *full;\n    gchar *name=\"SpaceCraftHeader\";\n    gchar *name2=\"DataHeader\";\n    gchar *name3=\"Data\";\n\n    full=g_strdup(filename);\n    g_strlcat(full,name,50);\n\n    GFile *file=g_file_new_for_path(full);\n    GFileOutputStream *output=g_file_replace(\n                file,NULL,FALSE,\n                G_FILE_CREATE_NONE,\n                NULL,NULL);\n\n    g_output_stream_write(G_OUTPUT_STREAM(output),\n                text1,strlen(text1),NULL,NULL);\n\n    g_output_stream_close(G_OUTPUT_STREAM(output),NULL,NULL);\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "malloc", "sbrk", "brk"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1465980310, "post_id": 37830208, "comment_id": 63122627, "body": "It&#39;s just the way <code>malloc</code> is implemented. You should study the source code of  <code>malloc</code> in order to understand how it is implemented."}, {"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1465981685, "post_id": 37830208, "comment_id": 63123586, "body": "Where can I see the main code of malloc .please provide me the path to go through"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1465981850, "post_id": 37830208, "comment_id": 63123689, "body": "I just searched for &quot;malloc source code&quot; and see multiple good results. What did you try?"}, {"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465986412, "post_id": 37830208, "comment_id": 63126754, "body": "I was trying to check in glibc source"}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465980532, "post_id": 37830410, "comment_id": 63122773, "body": "But how the memory is getting allocated is through mmap ,correct me if I am wrong."}, {"owner": {"reputation": 47440, "user_id": 229410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e0014fcc07d184018d3b8185a85a09?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/229410/rohan"}, "reply_to_user": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465980667, "post_id": 37830410, "comment_id": 63122885, "body": "@harish, That <code>mmap&#39; might be due to other code like </code>printf()`."}, {"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465981732, "post_id": 37830410, "comment_id": 63123623, "body": "This may be a follish question but please give me some guidence in understanding like when will brk get called and when will sbrk get called in malloc internals is not clear"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1465982470, "post_id": 37830410, "comment_id": 63124110, "body": "It&#39;s an implementation detail that malloc is deliberately not exposing so you don&#39;t have to worry about it. If you <i>want</i> to worry about it, you need to read the implementation."}], "tags": [], "owner": {"reputation": 47440, "user_id": 229410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e0014fcc07d184018d3b8185a85a09?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/229410/rohan"}, "is_accepted": false, "score": 2, "last_activity_date": 1465980344, "creation_date": 1465980344, "answer_id": 37830410, "question_id": 37830208, "link": "https://stackoverflow.com/questions/37830208/multiple-malloc-calls-internally-calling-mmap-only-once/37830410#37830410", "title": "multiple malloc calls internally calling mmap only once", "body": "<p><code>malloc()</code> does not result into <code>mmap()</code> call. Generally it would result into <code>brk()</code>. However, not each call will result into <code>brk()</code>. It depends a lot on currently allocated pages, asked memory and other things.</p>\n"}, {"comments": [{"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1466137293, "post_id": 37831184, "comment_id": 63202253, "body": "But after commenting printf in my code I cant see any mmap in trace only brk is displayed twice.So what I am expecting is mmap is not having any relation with malloc"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "reply_to_user": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1466152771, "post_id": 37831184, "comment_id": 63209034, "body": "I said malloc <i>may</i> use <code>mmap</code>, for some allocations, in some implementations. It isn&#39;t mandatory. If you want to understand what&#39;s happening inside <i>your</i> implementation, read the code."}], "tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 2, "last_activity_date": 1465982279, "creation_date": 1465982279, "answer_id": 37831184, "question_id": 37830208, "link": "https://stackoverflow.com/questions/37830208/multiple-malloc-calls-internally-calling-mmap-only-once/37831184#37831184", "title": "multiple malloc calls internally calling mmap only once", "body": "<p>Your process' internal heap (accessed via malloc, free and realloc) manages memory as it sees fit - this includes:</p>\n\n<ul>\n<li>growing the heap by large or fixed increments to amortize the cost of expensive <code>brk</code>/<code>sbrk</code> syscalls over multiple (de)allocations</li>\n<li>dealing with smaller (de)allocations inside that heap area itself</li>\n<li>managing (de)fragmentation of allocated records</li>\n</ul>\n\n<p>It's also common to use different mechanisms for large and small allocations, for example small objects are allocated from that contiguous area managed by <code>brk</code>/<code>sbrk</code>, but individual large objects may be allocated directly with <code>mmap</code>.</p>\n"}], "owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1465982279, "creation_date": 1465979838, "last_edit_date": 1465981643, "question_id": 37830208, "link": "https://stackoverflow.com/questions/37830208/multiple-malloc-calls-internally-calling-mmap-only-once", "title": "multiple malloc calls internally calling mmap only once", "body": "<p>When I try the below code I am not clearly able to analyze malloc api internal calls.What I am not clear is about the system call mmap is called only once for 2 or more malloc calls.If I am assigning more then 4069 bytes also it is calling only one mmap internally(trace is identified by using strace -p processid ).</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nmain()\n{\nint *p,*q;\nsleep(20);\np=malloc(5096);\nprintf(\"p=%p\\n\",p);\nq=malloc(4096);\nprintf(\"q=%p\\n\",q);\nsleep(2);\nreturn 0;\n}\n</code></pre>\n\n<p>strace OUTPUT:</p>\n\n<pre><code>root@TEST:/home/harish# strace  -p 6109\nProcess 6109 attached\nrestart_syscall(&lt;... resuming interrupted call ...&gt;\n) = 0\nbrk(0)                                  = 0xeca000\nbrk(0xeec000)                           = 0xeec000\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 14), ...}) = 0\nmmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f10b7bc7000\nwrite(1, \"p=0xeca010\\n\", 11)            = 11\nrt_sigprocmask(SIG_BLOCK, [CHLD], [], 8) = 0\nrt_sigaction(SIGCHLD, NULL, {SIG_DFL, [], 0}, 8) = 0\nrt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0\nnanosleep({20, 0},\n0x7ffc34a51790)      = 0\nwrite(1, \"q=0xecb020\\n\", 11)            = 11\nrt_sigprocmask(SIG_BLOCK, [CHLD], [], 8) = 0\nrt_sigaction(SIGCHLD, NULL, {SIG_DFL, [], 0}, 8) = 0\nrt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0\nnanosleep({2, 0}, 0x7ffc34a51790)       = 0\nexit_group(0)                           = ?\n+++ exited with 0 +++\n</code></pre>\n\n<p>What I am looking is ,if malloc is used more then once will it call more then one mmap since memory is exceeding in two malloc's beyond 4096</p>\n"}, {"tags": ["c", "double", "overflow"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1465979886, "post_id": 37830178, "comment_id": 63122362, "body": "Although &quot;<i>double</i>&quot; the precision <b><i>is</i></b> limited."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1465980378, "post_id": 37830178, "comment_id": 63122671, "body": "By the time <code>0.5</code> has been aligned for the add, its significance will be lost through shifting the mantissa (to match the exponents), so it will just add <code>0</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1465980582, "post_id": 37830178, "comment_id": 63122815, "body": "If there are 52 bits in the mantissa, this will happen when the exponents of the two operands differ by more than 52. This is the case for addition or subttraction. When multiplying and dividing, it&#39;s a different matter."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1465980734, "post_id": 37830178, "comment_id": 63122936, "body": "try reading this <a href=\"http://stackoverflow.com/questions/2100490/floating-point-inaccuracy-examples\" title=\"floating point inaccuracy examples\">stackoverflow.com/questions/2100490/&hellip;</a>"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1465982204, "post_id": 37830178, "comment_id": 63123924, "body": "When you are a billionaire then inheriting a penny does not make you richer.  You would have to write 309 digits to see the result of that expression.  The <i>double</i> type can only store 15 significant digits."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 0, "last_activity_date": 1465980910, "creation_date": 1465980910, "answer_id": 37830627, "question_id": 37830178, "link": "https://stackoverflow.com/questions/37830178/why-no-overflow-when-using-double-variable/37830627#37830627", "title": "why no overflow when using double variable?", "body": "<p>Generally if you want to add a value to a double <code>x</code> the added value should be within the precision range for it to change the value at all. </p>\n\n<p>For a <code>double</code> you get a precision of ~16 digits. So, if the added value is less than (x/1E+16), then there will be no change in the result.</p>\n\n<p>With a little trial and error, in your case, adding a value of <code>1E+292</code>, to the given double, gives a result of +INF.</p>\n\n<pre><code>double x = 1.7976931348623157E+308; //this is the max value of double\n\nx = x + 1E+292;\nprintf (\"\\nx = %lf\",x);\n</code></pre>\n\n<p>Result</p>\n\n<blockquote>\n  <p>x = 1.#INF00</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1465982431, "creation_date": 1465982431, "answer_id": 37831241, "question_id": 37830178, "link": "https://stackoverflow.com/questions/37830178/why-no-overflow-when-using-double-variable/37831241#37831241", "title": "why no overflow when using double variable?", "body": "<p>Consider the analogy with exponent notation.</p>\n\n<p>Suppose you are allowed 4 significant digits, so the number <code>1234000.0</code> will be represented by <code>1.234e6</code>.</p>\n\n<p>Now try adding <code>0.5</code> which should be <code>1234000.5</code>.</p>\n\n<p>Even if the intermediate buffer is big enough to hold that significance, its representation within the proscribed limit is still <code>1.234e6</code>.</p>\n\n<p>But if the intermediate buffer can hold, say, only 7 digits, the aligned values to add are</p>\n\n<pre><code>1234000\n      0\n-------\n1234000\n</code></pre>\n\n<p>so the <code>0.5</code> loses its significance even before the addition is performed. In the case of <code>double</code> you can be quite sure the intermediate buffer cannot hold 308 digits equivalent.</p>\n"}], "owner": {"reputation": 31, "user_id": 3162308, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/608758356/picture?type=large", "display_name": "user3162308", "link": "https://stackoverflow.com/users/3162308/user3162308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1480, "favorite_count": 0, "accepted_answer_id": 37830627, "answer_count": 2, "score": 0, "last_activity_date": 1465982431, "creation_date": 1465979755, "question_id": 37830178, "link": "https://stackoverflow.com/questions/37830178/why-no-overflow-when-using-double-variable", "title": "why no overflow when using double variable?", "body": "<p>i'm trying to understand why in the following situation i don't get an overflow:</p>\n\n<pre><code>double x = 1.7976931348623157E+308; //this is the max value of double\n\nx = x + 0.5;\n</code></pre>\n\n<p>When checking the value of x after adding 0.5 i still get the <code>same result</code>.</p>\n\n<p>Anyone?</p>\n"}, {"tags": ["c", "gcc", "ld"], "answers": [{"tags": [], "owner": {"reputation": 456, "user_id": 3196247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wVD3A.jpg?s=128&g=1", "display_name": "Picodev", "link": "https://stackoverflow.com/users/3196247/picodev"}, "is_accepted": false, "score": 4, "last_activity_date": 1465979597, "creation_date": 1465979597, "answer_id": 37830114, "question_id": 37829699, "link": "https://stackoverflow.com/questions/37829699/hide-function-name-in-gcc-compilation/37830114#37830114", "title": "Hide function name in GCC compilation", "body": "<p>The utility <strong>strip</strong> discards symbols from object files.</p>\n\n<p>Consider :</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n\n static void static_func(void)\n {\n   puts(__FUNCTION__);\n }\n\n void func(void)\n {\n   puts(__FUNCTION__);\n }\n\n int main(void)\n {\n   static_func();\n   func();\n\n   return 0;\n }\n</code></pre>\n\n<p>readelf produces on a fresh compiled binary :</p>\n\n<pre><code>Symbol table '.symtab' contains 71 entries:\n   Num:    Value          Size Type    Bind   Vis      Ndx Name\n....\n   37: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hide.c\n   38: 0000000000400526    17 FUNC    LOCAL  DEFAULT   14 static_func\n....\n   61: 0000000000400537    17 FUNC    GLOBAL DEFAULT   14 func\n....\n   66: 0000000000400548    21 FUNC    GLOBAL DEFAULT   14 main\n....\n</code></pre>\n\n<p>And after stripping the binary the whole output is :</p>\n\n<pre><code>Symbol table '.dynsym' contains 4 entries:\n   Num:    Value          Size Type    Bind   Vis      Ndx Name\n     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND \n     1: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)\n     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)\n     3: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "edited": false, "score": 0, "creation_date": 1465987468, "post_id": 37830962, "comment_id": 63127519, "body": "Okay thanks. Is this symbole table called debug informations or is it something different?"}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "reply_to_user": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "edited": false, "score": 1, "creation_date": 1465994359, "post_id": 37830962, "comment_id": 63132556, "body": "@Bob5421 The symbol table is needed for linking. Once linked, it can be discarded. This means it is different from debug information. While you can remove debug info from object files without ill effects, you should not remove the symbol table from object files (they won&#39;t link with other files if you do)."}, {"owner": {"reputation": 1126, "user_id": 1100060, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0fOMO.jpg?s=128&g=1", "display_name": "Nathan B", "link": "https://stackoverflow.com/users/1100060/nathan-b"}, "edited": false, "score": 0, "creation_date": 1535295734, "post_id": 37830962, "comment_id": 91005113, "body": "The &quot;-s&quot; is the linker option to strip out the symbols"}], "tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 5, "last_activity_date": 1465981711, "creation_date": 1465981711, "answer_id": 37830962, "question_id": 37829699, "link": "https://stackoverflow.com/questions/37829699/hide-function-name-in-gcc-compilation/37830962#37830962", "title": "Hide function name in GCC compilation", "body": "<p>Use the <code>-s</code> option to strip the symbol table:</p>\n\n<pre><code>gcc -s -o hello hello.c\n</code></pre>\n"}], "owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2989, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1466255500, "creation_date": 1465978422, "last_edit_date": 1466255500, "question_id": 37829699, "link": "https://stackoverflow.com/questions/37829699/hide-function-name-in-gcc-compilation", "title": "Hide function name in GCC compilation", "body": "<p>I am compiling a c \"hello world\" program that juste include one simple function and a main function.</p>\n\n<p>I am using GCC under Linux.</p>\n\n<p>When I run <code>readelf</code> command on the binary, I can see symbol table and I can see function names in clear.</p>\n\n<ul>\n<li><p>Is there a way to tell GCC (or the linker) to not generate this symbol table? </p></li>\n<li><p>Is it possible to tell GCC to store only functions addresses, without storing function names in clear?</p></li>\n</ul>\n"}, {"tags": ["c", "avr", "stm32", "nodemcu"], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 5895811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bed50a2eb82fc748c4b0062e517eec5?s=128&d=identicon&r=PG&f=1", "display_name": "TZof", "link": "https://stackoverflow.com/users/5895811/tzof"}, "is_accepted": true, "score": 3, "last_activity_date": 1466089103, "last_edit_date": 1466089103, "creation_date": 1466082271, "answer_id": 37860126, "question_id": 37829430, "link": "https://stackoverflow.com/questions/37829430/stm32-hal-rx-interrupt-cant-get-bytes-correctly/37860126#37860126", "title": "STM32 HAL rx interrupt can&#39;t get bytes correctly", "body": "<p>check the function: <code>HAL_UART_Receive_IT(UART_HandleTypeDef *huart, uint8_t *pData, uint16_t Size)</code>;</p>\n\n<ol>\n<li>make a size enough longer like 16bytes for example;</li>\n<li><p>call your  <code>HAL_UART_RxCpltCallback</code> routine into the function <code>HAL_UART_Receive_IT(...)</code>. I suggest to you to add an end character (<code>\\n</code>) detection like this: </p>\n\n<pre><code>if ( (*huart-&gt;pRxBuffPtr) == '\\n') {\n    HAL_UART_RxCpltCallback(huart);  //-------------------------------------------/////////\n} else {\n    huart-&gt;pRxBuffPtr++;\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 365, "user_id": 3773632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003066080768/picture?type=large", "display_name": "user3773632", "link": "https://stackoverflow.com/users/3773632/user3773632"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "accepted_answer_id": 37860126, "answer_count": 1, "score": 1, "last_activity_date": 1489099455, "creation_date": 1465977595, "last_edit_date": 1489099455, "question_id": 37829430, "link": "https://stackoverflow.com/questions/37829430/stm32-hal-rx-interrupt-cant-get-bytes-correctly", "title": "STM32 HAL rx interrupt can&#39;t get bytes correctly", "body": "<p>Hi guys I am trying to make serial rx interrupt using stm32 HAL library and I got error what I dont know. </p>\n\n<p>It is really simple program. PC gives bytes to stm32 board and stm32 will take those bytes using rx interrupt routine.</p>\n\n<p>Problem is when i send over 4 bytes ,such as \"12345\", stm32 board only got 4 bytes and last one byte(5) is gone somewhere. Here is picture for better understanding. </p>\n\n<p><img src=\"https://i.stack.imgur.com/omwSS.png\" alt=\"enter image description here\"></p>\n\n<p>Here is my code in HAL_UART_RxCpltCallback routine:</p>\n\n<pre><code>HAL_UART_Transmit(&amp;huart4, &amp;receive1, 1, 1000);\nHAL_UART_Receive_IT(&amp;huart4, &amp;receive1, 1);\n</code></pre>\n\n<p>If you have any idea, please comment :)</p>\n"}, {"tags": ["c", "linux", "unix", "segmentation-fault", "signals"], "comments": [{"owner": {"reputation": 52680, "user_id": 1673391, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d0fdf8fc4fd7daa19b20cd3f76d2a1e0?s=128&d=identicon&r=PG", "display_name": "Grijesh Chauhan", "link": "https://stackoverflow.com/users/1673391/grijesh-chauhan"}, "edited": false, "score": 0, "creation_date": 1465978351, "post_id": 37829429, "comment_id": 63121366, "body": "avoid printf in signal handler, you will enjoy reading this <a href=\"http://www.ibm.com/developerworks/linux/library/l-reent/index.html#N101CA\" rel=\"nofollow noreferrer\">&quot;Use reentrant functions for safer signal handling&quot;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1465977808, "creation_date": 1465977808, "answer_id": 37829509, "question_id": 37829429, "link": "https://stackoverflow.com/questions/37829429/sigsegv-handler-can-not-exit/37829509#37829509", "title": "SIGSEGV handler can not exit", "body": "<p>Under controlled conditions it may be possible, but in general, no. The <code>exit</code> function tries to do a clean shutdown and requires the process to be in a sane state. Since a SIGSEGV was generated but not handled, the code is likely not in a sane state, so a clean shutdown is not guaranteed to work. Use <code>_exit</code> in these circumstances.</p>\n\n<p>Your call to <code>fprintf</code> is ill advised as well. Use <code>write</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 5, "last_activity_date": 1465978590, "last_edit_date": 1465978590, "creation_date": 1465977824, "answer_id": 37829515, "question_id": 37829429, "link": "https://stackoverflow.com/questions/37829429/sigsegv-handler-can-not-exit/37829515#37829515", "title": "SIGSEGV handler can not exit", "body": "<blockquote>\n  <p>Can't I use <code>exit()</code> to normal finish the process in the handler?</p>\n</blockquote>\n\n<p><code>exit()</code> should not be called from a signal handler as it isn't guaranteed to be async-signal-safe. Use <code>_exit()</code>, <code>_Exit()</code> or <code>abort()</code> instead.</p>\n\n<p>That said,  <code>printf()</code> should not be called from a signal handler for the same reason that applies to <code>exit()</code>.</p>\n\n<p>For a full list of functions being async-signal-safe or not please have look down on this pages: </p>\n\n<ul>\n<li>Linux: <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow\">http://man7.org/linux/man-pages/man7/signal.7.html</a></li>\n<li>POSIX: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03\" rel=\"nofollow\">http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03</a></li>\n</ul>\n\n<hr>\n\n<p>Moreover, the moment a segmentation violation occured the program is unstable, or even broken, the stack may me smashed, so there is no guarantee that anything may be called at all from that moment on.</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 4485680, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cadc58f70ceb76b0b2b02c69cf6d8c86?s=128&d=identicon&r=PG&f=1", "display_name": "wangbo15", "link": "https://stackoverflow.com/users/4485680/wangbo15"}, "edited": false, "score": 0, "creation_date": 1465981361, "post_id": 37830651, "comment_id": 63123364, "body": "Thanks a lot! I use <code>kill()</code> instead of <code>exit()</code>."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1465980974, "creation_date": 1465980974, "answer_id": 37830651, "question_id": 37829429, "link": "https://stackoverflow.com/questions/37829429/sigsegv-handler-can-not-exit/37830651#37830651", "title": "SIGSEGV handler can not exit", "body": "<p><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03\" rel=\"nofollow\">The list of functions POSIX requires</a> to be async-signal-safe are:</p>\n\n<blockquote>\n  <p>The following table defines a set of functions that shall be\n  async-signal-safe. Therefore, applications can invoke them, without\n  restriction, from signal-catching functions:</p>\n\n<pre><code>_Exit()\n_exit()\nabort()\naccept()\naccess()\naio_error()\naio_return()\naio_suspend()\nalarm()\nbind()\ncfgetispeed()\ncfgetospeed()\ncfsetispeed()\ncfsetospeed()\nchdir()\nchmod()\nchown()\nclock_gettime()\nclose()\nconnect()\ncreat()\ndup()\ndup2()\nexecl()\nexecle()\nexecv()\nexecve()\nfaccessat()\nfchdir()\nfchmod()\nfchmodat()\nfchown()\nfchownat()\nfcntl()\nfdatasync()\nfexecve()\nfork()\nfstat()\nfstatat()\nfsync()\nftruncate()\nfutimens()\ngetegid()\ngeteuid()\ngetgid()\ngetgroups()\ngetpeername()\ngetpgrp()\ngetpid()\ngetppid()\ngetsockname()\ngetsockopt()\ngetuid()\nkill()\nlink()\nlinkat()\nlisten()\nlseek()\nlstat()\nmkdir()\nmkdirat()\nmkfifo()\nmkfifoat()\nmknod()\nmknodat()\nopen()\nopenat()\npause()\npipe()\npoll()\nposix_trace_event()\npselect()\npthread_kill()\npthread_self()\npthread_sigmask()\nraise()\nread()\nreadlink()\nreadlinkat()\nrecv()\nrecvfrom()\nrecvmsg()\nrename()\nrenameat()\nrmdir()\nselect()\nsem_post()\nsend()\nsendmsg()\nsendto()\nsetgid()\nsetpgid()\nsetsid()\nsetsockopt()\nsetuid()\nshutdown()\nsigaction()\nsigaddset()\nsigdelset()\nsigemptyset()\nsigfillset()\nsigismember()\nsignal()\nsigpause()\nsigpending()\nsigprocmask()\nsigqueue()\nsigset()\nsigsuspend()\nsleep()\nsockatmark()\nsocket()\nsocketpair()\nstat()\nsymlink()\nsymlinkat()\ntcdrain()\ntcflow()\ntcflush()\ntcgetattr()\ntcgetpgrp()\ntcsendbreak()\ntcsetattr()\ntcsetpgrp()\ntime()\ntimer_getoverrun()\ntimer_gettime()\ntimer_settime()\ntimes()\numask()\nuname()\nunlink()\nunlinkat()\nutime()\nutimensat()\nutimes()\nwait()\nwaitpid()\nwrite()\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 181, "user_id": 4485680, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cadc58f70ceb76b0b2b02c69cf6d8c86?s=128&d=identicon&r=PG&f=1", "display_name": "wangbo15", "link": "https://stackoverflow.com/users/4485680/wangbo15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 37829515, "answer_count": 3, "score": 3, "last_activity_date": 1465980974, "creation_date": 1465977591, "last_edit_date": 1465980444, "question_id": 37829429, "link": "https://stackoverflow.com/questions/37829429/sigsegv-handler-can-not-exit", "title": "SIGSEGV handler can not exit", "body": "<p>I registered a handler of <code>SIGSEGV</code>, using <code>fprintf</code> to print some message then exit. The process prints the message but did not exit. It blocked before <code>exit()</code>. </p>\n\n<p>Can't I use <code>exit()</code> to finish the process normally in the handler?</p>\n\n<pre><code>void sigsegv__handler(){\n    fprintf(stderr, \"SIGSEGV , TID: %d,PID: %d\\n\", TEST_ID, getpid());\n    exit(1);\n}\n</code></pre>\n"}, {"tags": ["c", "bluetooth", "bluetooth-lowenergy", "android-bluetooth", "bluez"], "comments": [{"owner": {"reputation": 1485, "user_id": 1260543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kvnHz.jpg?s=128&g=1", "display_name": "gregoiregentil", "link": "https://stackoverflow.com/users/1260543/gregoiregentil"}, "edited": false, "score": 0, "creation_date": 1496764380, "post_id": 37829127, "comment_id": 75788909, "body": "I have the same problem. Did you figure out a solution?"}, {"owner": {"reputation": 73, "user_id": 2231572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5e600ee663ababbfd0fea88fca4006c2?s=128&d=identicon&r=PG", "display_name": "Narrator", "link": "https://stackoverflow.com/users/2231572/narrator"}, "reply_to_user": {"reputation": 1485, "user_id": 1260543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kvnHz.jpg?s=128&g=1", "display_name": "gregoiregentil", "link": "https://stackoverflow.com/users/1260543/gregoiregentil"}, "edited": false, "score": 0, "creation_date": 1496857928, "post_id": 37829127, "comment_id": 75837720, "body": "I was using same sock descriptor for reading the advertisement packets from other thread, try using dup of descriptor(sock) for reading and writing with original descriptor."}], "owner": {"reputation": 73, "user_id": 2231572, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5e600ee663ababbfd0fea88fca4006c2?s=128&d=identicon&r=PG", "display_name": "Narrator", "link": "https://stackoverflow.com/users/2231572/narrator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 906, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465976670, "creation_date": 1465976670, "question_id": 37829127, "link": "https://stackoverflow.com/questions/37829127/bluez-scan-enable-disable-connection-time-out", "title": "bluez scan enable/disable connection time out", "body": "<p>I was writing client were I'm continuously enabling and disabling scan after each constant time intervals(e.g every 4sec),</p>\n\n<p>Initially I will reset(down/up) the hci interface and adds filters then I will enable the scan using below API,</p>\n\n<pre><code> hci_le_set_scan_parameters(hci_ctlr.sock, stActive, htobs(Scan_Interval_Normal), htobs(Scan_Window_Normal),\n        own_type, filter_policy, 10000);\n hci_le_set_scan_enable(hci_ctlr.sock, 0x01, filter_dup, 10000);\n</code></pre>\n\n<p>After sometime I will disabling scan using following </p>\n\n<pre><code>hci_le_set_scan_enable(hci_ctlr.sock, 0x00, filter_dup, 10000);\n</code></pre>\n\n<p>For the First time enabling scan works fine but after some intervals or first interval of disabling scan returns \"time out error\" or while enabling scan after first interval also returns \"time out error\" sometimes.</p>\n\n<p>what might be the cause here ? Any suggestions?.</p>\n"}, {"tags": ["c", "c-preprocessor", "avr-gcc"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 2, "creation_date": 1465976633, "post_id": 37828923, "comment_id": 63120385, "body": "what is the #define for F_CPU?"}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1465976695, "post_id": 37828923, "comment_id": 63120423, "body": "Is it included twice?"}, {"owner": {"reputation": 305, "user_id": 2361988, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/c4132c719dd2cca7410a579825b6bc64?s=128&d=identicon&r=PG", "display_name": "Peder", "link": "https://stackoverflow.com/users/2361988/peder"}, "edited": false, "score": 0, "creation_date": 1465976723, "post_id": 37828923, "comment_id": 63120431, "body": "To produce exactly these two pragma lines, it is <code>#define F_CPU 32000000UL</code>"}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1465976745, "post_id": 37828923, "comment_id": 63120443, "body": "#define without parentheses is highly dangerous. You&#39;re aiming a gun right at your foot."}, {"owner": {"reputation": 305, "user_id": 2361988, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/c4132c719dd2cca7410a579825b6bc64?s=128&d=identicon&r=PG", "display_name": "Peder", "link": "https://stackoverflow.com/users/2361988/peder"}, "reply_to_user": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1465976834, "post_id": 37828923, "comment_id": 63120494, "body": "@dbrank0 It is included in the main file and in the USART.c file. But as I understand it, this needs to be done."}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 2, "creation_date": 1465976840, "post_id": 37828923, "comment_id": 63120500, "body": "And I only get BSEL &gt; 0 when turning your code to .c and adding F_CPU define."}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 3, "creation_date": 1465976900, "post_id": 37828923, "comment_id": 63120532, "body": "Peder: And for each include you get one printout. And something (F_CPU?) changes between inclusions."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1465977178, "post_id": 37828923, "comment_id": 63120690, "body": "I am also only getting BSEL&gt;0, after removing the avr/io.h include and adding the F_CPU #define. This is on gcc 4.9.3."}, {"owner": {"reputation": 305, "user_id": 2361988, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/c4132c719dd2cca7410a579825b6bc64?s=128&d=identicon&r=PG", "display_name": "Peder", "link": "https://stackoverflow.com/users/2361988/peder"}, "edited": false, "score": 0, "creation_date": 1465978329, "post_id": 37828923, "comment_id": 63121348, "body": "I&#39;m trying to update the compiler. Meanwhile, when I do <i>not</i> include this header file (USART.h) in USART.c, only one and the correct message appear. This raises two problems: 1) As far as I know I <i>have</i> to include the header file it in the c-file and 2) why are the results of the two messages different? (The c-file is empty except for the header inclusion.)"}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1465990388, "post_id": 37828923, "comment_id": 63129583, "body": "With given values, it results in <code>(16000000 &#47; 4800 - 8)</code>. The magnitude of the 1st summand and the 2nd summand in your macro is very different. It seems <code>BSEL &lt;= 0</code> will never occur?"}, {"owner": {"reputation": 414, "user_id": 4880090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9731995440b63d4cbf69257df481c87?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Kolokowsky", "link": "https://stackoverflow.com/users/4880090/steve-kolokowsky"}, "edited": false, "score": 0, "creation_date": 1466007545, "post_id": 37828923, "comment_id": 63142388, "body": "Since you didn&#39;t include your whole project, we have to guess.  My guess:  You include usart.h in multiple C files.  In one of those C files, F_CPU is defined, in another, it is undefined or 0.  There <i>should</i> be a warning about F_CPU being used when undefined, but you <i>could</i> be compiling with this (or all) warnings turned off."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 414, "user_id": 4880090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9731995440b63d4cbf69257df481c87?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Kolokowsky", "link": "https://stackoverflow.com/users/4880090/steve-kolokowsky"}, "edited": false, "score": 0, "creation_date": 1466007824, "post_id": 37828923, "comment_id": 63142583, "body": "@SteveKolokowsky: in an <code>#if</code> preprocessing directive, using a name which has not been <code>#define</code>d is not an error; the name is simply replaced with 0. I don&#39;t believe gcc will warn about this with any commonly-used <code>-W</code> setting"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1466007956, "post_id": 37828923, "comment_id": 63142669, "body": "@Peder: FYI: <code>-1*x</code> is parsed as though it were written <code>-(1*x)</code>, which is obviously the same as <code>-x</code>.  So you could just write <code>-USART_BSCALE</code> instead of <code>(-1*USART_BSCALE)</code>"}], "owner": {"reputation": 305, "user_id": 2361988, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/c4132c719dd2cca7410a579825b6bc64?s=128&d=identicon&r=PG", "display_name": "Peder", "link": "https://stackoverflow.com/users/2361988/peder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465976057, "creation_date": 1465976057, "last_edit_date": 1495535638, "question_id": 37828923, "link": "https://stackoverflow.com/questions/37828923/multiple-results-for-one-expression-in-c-preprocessor", "title": "Multiple results for one expression in C preprocessor", "body": "<p>trying to solve <a href=\"https://stackoverflow.com/questions/37814166/preprocessor-missing-binary-operator-before-token\">this problem</a>, I reduced my code to a minimum to find errors and check the results of expressions <code>F_CPU</code> is defined in the main file.</p>\n\n<pre><code>#ifndef USART_H_\n#define USART_H_\n\n#include &lt;avr/io.h&gt;\n\n\n\n#define USART_BAUDRATE          4800\n#define USART_BSCALE            -3\n\n#if USART_BSCALE &lt; 0\n    #define USART_BSEL          ((F_CPU / 16) * (1&lt;&lt;(-1*USART_BSCALE)) / USART_BAUDRATE - (1&lt;&lt;(-1*USART_BSCALE)))\n    #if (USART_BSEL &lt; 0)\n        #pragma message \"BSEL &lt; 0\"\n    #elif (USART_BSEL == 0)\n        #pragma message \"BSEL = 0\"\n    #elif (USART_BSEL &gt; 0)\n        #pragma message \"BSEL &gt; 0\"\n    #endif\n#endif\n\n#endif\n</code></pre>\n\n<p>The result of <code>USART_BSEL</code> - calculating with integers only - is 3325. The output is this:</p>\n\n<pre><code>#pragma message: BSEL &gt; 0\n#pragma message: BSEL &lt; 0\n</code></pre>\n\n<p>How can I get more than one message from this code? And how can they be different?</p>\n\n<p>The output is always two lines, but depending on my use of integer suffixes for <code>BAUDRATE</code> and <code>F_CPU</code> (I used L, UL and ULL), I get different pragma messages. Why is the preprocessor behaving that way?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1465975720, "post_id": 37828755, "comment_id": 63119818, "body": "dont do <code>fflush(stdin); </code>, it&#39;s UB."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465975793, "post_id": 37828755, "comment_id": 63119861, "body": "there&#39;s no <code>free()</code>...."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1465975793, "post_id": 37828755, "comment_id": 63119862, "body": "Did you allocate memory for <code>poleNazvu[count][ALOKACE_MALA-1]</code>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1465975811, "post_id": 37828755, "comment_id": 63119871, "body": "@Bathsheba :) see the commented out code...."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1465975949, "post_id": 37828755, "comment_id": 63119954, "body": "Hum. Them modern compilers tend to omit commented code..."}, {"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1465976183, "post_id": 37828755, "comment_id": 63120105, "body": "I am sorry I edited the question. To address the problem more specificaly. Does someone know what needs to be done?"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1465978887, "post_id": 37828755, "comment_id": 63121719, "body": "You commented out the <code>poleNazvu</code> allocation code yourself - so you left it uninitialized!"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1465976865, "post_id": 37828985, "comment_id": 63120517, "body": "When I remove the pointer in decladation it gives me &quot;passing argument 1 of &#39;strcpy&#39; makes pointer from integer without a cast&quot; on line with strcpy"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 1, "creation_date": 1465977087, "post_id": 37828985, "comment_id": 63120643, "body": "@Lance Please continue reading my (updated) answer."}, {"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1465977542, "post_id": 37828985, "comment_id": 63120892, "body": "The strdup is the solution. I need the two dimensional array because I am sorting the ladder later on and I am switching several values between the variables. Now do I need to free the variable poleNazvu somehow?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1465977926, "post_id": 37828985, "comment_id": 63121113, "body": "@Lance Yes, <code>strdup</code> calls <code>mallo</code> and you need to <code>free</code> that memory."}, {"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1466154038, "post_id": 37828985, "comment_id": 63209820, "body": "To update this. I used strcpy because strdup is &quot;not damn standard function&quot; When I allocated I used allocation according to strlen(of copied string) all warnings dissappeared and problem was solved. Thank you Joachim, you rock!"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1465976718, "last_edit_date": 1465976718, "creation_date": 1465976262, "answer_id": 37828985, "question_id": 37828755, "link": "https://stackoverflow.com/questions/37828755/segmentation-fault-when-strcpy/37828985#37828985", "title": "Segmentation fault when strcpy", "body": "<p>In the call</p>\n\n<pre><code>strcpy(poleNazvu[count][ALOKACE_MALA-1],levaStrana); //ITS HERE\n</code></pre>\n\n<p>the destination <code>poleNazvu[count][ALOKACE_MALA-1]</code> is an <strong><em>uninitialized</em></strong> pointer. It's value is <em>indeterminate</em> leading to <em>undefined behavior</em>.</p>\n\n<p>Either allocate memory for the pointer before copying, or use <code>strdup</code> instead (which does allocation and copying in a single call), or make <code>poleNazvu</code> not be an array of array of pointers to <code>char</code>.</p>\n\n<hr>\n\n<p>There are also some things that doesn't really make any sense, like why are you using <code>poleNazvu[count][ALOKACE_MALA-1]</code> as the destination? It will always copy the string to the same entry in the array arrays.</p>\n\n<p>Perhaps you are supposed to make <code>poleNazvu</code> an array of arrays of <code>char</code>, not an array of arrays of pointers to <code>char</code>? Like</p>\n\n<pre><code>char poleNazvu[ALOKACE_POLI][ALOKACE_MALA];\n</code></pre>\n\n<p>Then you would just do</p>\n\n<pre><code>strcpy(poleNazvu[count], levaStrana);\n</code></pre>\n\n<p>Of course this requires the length of the string in <code>levaStrana</code> be less than <code>ALOKACE_MALA</code> characters. So perhaps use <code>strncpy</code>  and explicit termination instead, like</p>\n\n<pre><code>strncpy(poleNazvu[count], levaStrana, ALOKACE_MALA - 2);\npoleNazvu[count][ALOKACE_MALA - 1] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "closed_date": 1465977306, "accepted_answer_id": 37828985, "answer_count": 1, "score": -1, "last_activity_date": 1465976718, "creation_date": 1465975620, "last_edit_date": 1465976072, "question_id": 37828755, "link": "https://stackoverflow.com/questions/37828755/segmentation-fault-when-strcpy", "closed_reason": "Duplicate", "title": "Segmentation fault when strcpy", "body": "<p>I am writing an semestral work in C but I am unable to recognize the problem here. When I run the code in debug, it gets me a segmentation fault. I am not sure what's wrong. Previously I alocated memory to poleNazvu but instead of segmentation fault it was giving me \"trying to free non heap object\" so this is not a way. Please tell me how to deal with the segmentation fault. Its happening on the line where I strcpy(poleNazvu... ) I marked it in the code. ALOKACE_POLI = 200 ; ALOKACE_MALA=20; What it does is that it takes a \"john 500\" and levaStrana gets \"john\" while pravaStrana gets \"500\" So I am trying to copy the levaStrana to poleNazvu and pravaStrana to poleKreditu. At the end of this code snip is the segmentation fault.</p>\n\n<pre><code>void menuHighlights(void)                                               //menu se zebricky uzivatelu\n{\n    char vyber3, * poleNazvu[ALOKACE_POLI][ALOKACE_MALA],line[ALOKACE_LINE];\n    char * prohodJmeno, * menic, * separator, * levaStrana, * pravaStrana;\n    int poleKreditu[ALOKACE_POLI], count=0, countMax=0, prohodCislo, d;\n    FILE *NACTENI;\n    //int alokace1=0, alokace2=0;                                                       //vytvoreni promenne pro soubor\n\n\n    fflush(stdin);                                                      //vyprazdneni bufferu\n    system(\"cls\");                                                      // vycisteni obrazovky\n    printf(\"\\nZebricek nejlepsich hracu:\\n\");                                               //tisk hlavicky\n    fflush(stdin);                                                      //buffer\n    NACTENI = fopen(SOUBOR_HRACU , \"r\");                                    //ulozeni otevreneho souboru do promenne\n    if(NACTENI == NULL) {                                            //jestlize v promenne nic neni\n        perror(\"Soubor nenalezen.\");                                    //vypis error\n        Sleep(HODNOTA_BIG_SLEEP);                                                   //nech uzivatel aby si to precetl\n        exit(1);    //a pak ukonci seanci\n    }\n\n    while (fgets(line, sizeof line, NACTENI) != NULL) {                 //pokud radek nacteny ze souboru nebude prazdny\n        fflush(stdin);                                                  //buffer\n        menic=line;                                                     //anti-decay opatreni promenne line\n        separator = \" \";\n        levaStrana = strtok(menic, separator);\n        pravaStrana = strtok(NULL, \"\");\n        //if ((poleNazvu[count][ALOKACE_MALA-1]=(char *)malloc(ALOKACE_PROHAZOVANI*sizeof(char)))==NULL) {\n        //    printf(\"Nedostatek pameti. Ukoncuji.\");\n        //    exit(1);\n        //}\n        //alokace1=1;\n        strcpy(poleNazvu[count][ALOKACE_MALA-1],levaStrana); //ITS HERE\n        poleKreditu[count]=atoi(pravaStrana);\n        if (countMax&lt;count) {\n            countMax=count;\n        }\n        count++;\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays", "loops", "traversal", "sub-array"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 6, "creation_date": 1465975262, "post_id": 37828553, "comment_id": 63119554, "body": "<code>Please look into the code</code>..... With this indentation: NO."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1465977580, "post_id": 37828553, "comment_id": 63120913, "body": "This code does not do what you expect, fine but you should give an example of input and the expected and obtained output. And you should describe the algorithm you tried to implement intead of just giving uncommented code. BTW, you should make sure <code>n &lt; 10</code>..."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465977805, "post_id": 37828553, "comment_id": 63121055, "body": "FYI, an acceptable solution is supposed to be linear time."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1465978720, "post_id": 37828553, "comment_id": 63121605, "body": "The logic is wrong: sum if badly calculated, not initialized in the correct place... Implementation is worse: <code>for(p=0;p&lt;n;p++) scanf(&quot;%d&quot;,&amp;A[i]);</code> only writes first element of array (i instead of p in loop). Show at least a little work before asking here."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1465988180, "post_id": 37828553, "comment_id": 63128036, "body": "<code>if(m==l)</code> should be tested above of <code>for(z=m...</code> not inside. If <code>for(z=m...</code> calculates the sum, <code>sum=0;</code> should be above this loop; If your array doesn&#39;t contain negative values, the result should always be <code>i==0 and j==n</code>"}, {"owner": {"reputation": 21, "user_id": 5894979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8c00f00aa18c47fef1e480b84af9e?s=128&d=identicon&r=PG&f=1", "display_name": "imyjalil", "link": "https://stackoverflow.com/users/5894979/imyjalil"}, "edited": false, "score": 0, "creation_date": 1466057774, "post_id": 37828553, "comment_id": 63161301, "body": "could figure it out.Thanks everyone :)"}], "answers": [{"tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": false, "score": 0, "last_activity_date": 1467832392, "last_edit_date": 1467832392, "creation_date": 1466011742, "answer_id": 37842003, "question_id": 37828553, "link": "https://stackoverflow.com/questions/37828553/find-a-largest-sum-contiguous-sub-array-from-a-given-array-consisting-of-integer/37842003#37842003", "title": "find a largest sum contiguous sub array from a given array consisting of integers", "body": "<p><strong>There are many problems in your code.</strong></p>\n\n<p>In the first <code>for</code> loop of <code>main</code> function, you have :</p>\n\n<pre><code>for(p=0;p&lt;n;p++)\n    scanf(\"%d\",&amp;A[i]);\n</code></pre>\n\n<ul>\n<li><p><code>i</code> is global variable and uninitialized, so you aren't even scanning the elements into your element properly</p></li>\n<li><p>You've messed up your <code>lsa</code> function which doesn't produce correct results even when  the above for loop is fixed</p></li>\n<li><p>and one of the limitations of your code is that it only works for arrays of size <code>10</code> or less</p></li>\n</ul>\n\n<hr>\n\n<p>I understand the way you want to find largest contiguous array.. as you said :</p>\n\n<blockquote>\n  <ul>\n  <li>the second loop runs from the first value keeping the value from the first loop fixed </li>\n  <li>and the third loop is to get the sum of the sub array</li>\n  </ul>\n</blockquote>\n\n<p>I'd say instead of making a third loop and making code look messy, it's better breaking it down into another function which calculates the sum of sub-array</p>\n\n<hr>\n\n<p><strong>Solution :</strong></p>\n\n<p>Here I've provided a solution which works for any size of array... Just using <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow\"><strong>Dynamic array allocation</strong></a></p>\n\n<blockquote>\n  <p><strong>Note</strong> :  <code>lsa</code> stands for <em>'largest contiguous sub-array'</em></p>\n</blockquote>\n\n<ul>\n<li>Here's the main function, function declarations and global variables :</li>\n</ul>\n\n<p><em>(description is given in comments)</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//array pointer\nint *array;\n//size of lsa and its starting index value, same as i,j in your code\nint lsa_size=1,lsa_start_index=0;\n\n//function to find sum of sub array\nint sum(int size_of_array, int start_index);\n\n//the lsa function in your code\nvoid lsaf(int *array,int size_of_array);\n\n//main funtion\nint main()\n{\n    int size, index;\n\n    //scanning size of input array\n    printf(\"enter size of array\\n\");\n    scanf(\"%d\",&amp;size);\n\n    //creates required amount of space for array\n    array=malloc(size*sizeof(int));\n    if(array==NULL) //check if successfully created or not\n    {\n        //if not successful exit by returning 1\n        printf(\" memory creation unsuccessful\\n enter any key to exit : \");\n        exit(1);\n    }\n\n    //input of array elements\n    printf(\"enter array elements\\n\");\n    for(index=0 ; index &lt; size ; index++)\n        scanf(\"%d\",&amp;array[index]);\n\n    //function call ... function described below\n    lsaf(array,size);\n\n    //printing largest contiguous sub-array\n    printf(\"answer : \");\n    for(index=0 ; index &lt; lsa_size ; index++)\n    {\n        printf(\"(%d)-&gt;\",array[lsa_start_index]);\n        lsa_start_index++;\n    }\n\n    printf(\"*end*\\n\\n\");\n\n    //freeing allocated memory\n    free(array);\n\n    return 0;\n}//main function\n</code></pre>\n\n<hr>\n\n<p>Now, <code>lsa</code> finding function (I've named it as <code>lsaf</code>) :</p>\n\n<pre><code>void lsaf(int *array,int size_of_array)\n{\n    int subarray_size,start_index,number_of_arrays;\n    int lsa_sum=sum(1,0);//initializing sum of lsa as first element\n    int subarray_sum;\n\n    for(subarray_size = 1; subarray_size &lt;= size_of_array ; subarray_size++)\n    {\n        number_of_arrays = size_of_array - subarray_size +1;\n        for(start_index=0;start_index &lt; number_of_arrays ; start_index++)\n        {\n            subarray_sum=sum( subarray_size,start_index);\n            if(subarray_sum &gt;= lsa_sum)\n            {\n                //updating lsa size and starting index\n                lsa_sum=subarray_sum;\n                lsa_size=subarray_size;\n                lsa_start_index=start_index;\n            }\n        }//start_index loop\n    }//subarray_size loop\n}//lsaf function\n</code></pre>\n\n<ul>\n<li>first loop decides the size of sub array</li>\n<li>second loop decides the starting index of the sub array</li>\n</ul>\n\n<p>and now instead of the third loop, I've created the function <code>sum()</code>, this calculates the sum of elements of sub array :</p>\n\n<pre><code>int sum(int size_of_array, int start_index)\n{\n    int add=0,index;\n    for(index=0; index &lt; size_of_array ; index++)\n    {\n        add+=array[start_index];\n        start_index++;\n    }\n    return add;\n}//sum function\n</code></pre>\n\n<ul>\n<li>so instead of making 3 loops, I've made a function for the third loop and I call it to calculate sum of sub array</li>\n</ul>\n\n<p>I hope you understand the above functions... if any doubts feel free to ask me via comments :)</p>\n\n<hr>\n\n<p>So putting all together your <strong>code</strong> would be :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//array pointer\nint *array;\n//size of lsa and its starting index value\nint lsa_size=1,lsa_start_index=0;\n\n//function to find sum of sub array\nint sum(int size_of_array, int start_index);\n\n//the lsa function\nvoid lsaf(int *array,int size_of_array);\n\n//main funtion\nint main()\n{\n    int size, index;\n\n    //scanning size of input array\n    printf(\"enter size of array\\n\");\n    scanf(\"%d\",&amp;size);\n\n    //creates required amount of space for array\n    array=malloc(size*sizeof(int));\n    if(array==NULL) //check if successfully created or not\n    {\n        //if not successful exit by returning 1\n        printf(\" memory creation unsuccessful\\n enter any key to exit : \");\n        exit(1);\n    }\n\n    //input of array elements\n    printf(\"enter array elements\\n\");\n    for(index=0 ; index &lt; size ; index++)\n        scanf(\"%d\",&amp;array[index]);\n\n    //function call\n    lsaf(array,size);\n\n    //printing largest contiguous sub-array\n    printf(\"answer : \");\n    for(index=0 ; index &lt; lsa_size ; index++)\n    {\n        printf(\"(%d)-&gt;\",array[lsa_start_index]);\n        lsa_start_index++;\n    }\n\n    printf(\"*end*\\n\\n\");\n\n    //freeing allocated memory\n    free(array);\n\n    return 0;\n}//main function\n\n\nint sum(int size_of_array, int start_index)\n{\n    int add=0,index;\n    for(index=0; index &lt; size_of_array ; index++)\n    {\n        add+=array[start_index];\n        start_index++;\n    }\n    return add;\n}//sum function\n\n\nvoid lsaf(int *array,int size_of_array)\n{\n    int subarray_size,start_index,number_of_arrays;\n    int lsa_sum=sum(1,0);//initializing sum of lsa as first element\n    int subarray_sum;\n\n    for(subarray_size = 1; subarray_size &lt;= size_of_array ; subarray_size++)\n    {\n        number_of_arrays = size_of_array - subarray_size +1;\n        for(start_index=0;start_index &lt; number_of_arrays ; start_index++)\n        {\n            subarray_sum=sum( subarray_size,start_index);\n            if(subarray_sum &gt;= lsa_sum)\n            {\n                //updating lsa size and starting index\n                lsa_sum=subarray_sum;\n                lsa_size=subarray_size;\n                lsa_start_index=start_index;\n            }\n        }//start_index loop\n    }//subarray_size loop\n}//lsaf function\n</code></pre>\n\n<hr>\n\n<p><strong>Sample input and output :</strong></p>\n\n<pre><code>enter size of array\n6\nenter array elements\n1\n-3\n0\n2\n11\n-90\nanswer : (0)-&gt;(2)-&gt;(11)-&gt;*end*\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5894979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e8c00f00aa18c47fef1e480b84af9e?s=128&d=identicon&r=PG&f=1", "display_name": "imyjalil", "link": "https://stackoverflow.com/users/5894979/imyjalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 551, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1467832392, "creation_date": 1465975009, "last_edit_date": 1466055928, "question_id": 37828553, "link": "https://stackoverflow.com/questions/37828553/find-a-largest-sum-contiguous-sub-array-from-a-given-array-consisting-of-integer", "title": "find a largest sum contiguous sub array from a given array consisting of integers", "body": "<p>I am writing a code to find the maximum sum contiguous sub array in C. The logic seems fine according to me, but still the output is not correct. Please look into the code.in the three loops the second loop runs from the first value keeing the value from the first loop fixed and the third loop is to get the sum of the sub array.Please look into the code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint A[10],i,j;\nvoid lsa(int A[],int n)\n{\n    int m,l,z,max=0,sum;\n    for(m=0;m&lt;n;m++)\n    {\n        sum=0;\n        for(l=0;l&lt;n;l++)\n        {\n            for(z=m;z&lt;=l;z++)\n            {\n                if(m==l)                 //maximum sum from a contiguous sub array\n                {\n                }\n               else\n                {\n                    sum=A[z]+A[l];\n                    if(sum&gt;max)\n                    {\n                        max=sum;\n                        i=m;\n                        j=l;\n                     }\n                 }\n             }\n        }\n    }\n}\nvoid main()\n{\n    int n,p;\n    printf(\"enter size of array\\n\");\n    scanf(\"%d\",&amp;n);\n    printf(\"enter array elements\\n\");        //creation of array\n    for(p=0;p&lt;n;p++)\n        scanf(\"%d\",&amp;A[p]);\n        lsa(A,n);\n        printf(\"sub array is\\n\");\n        for(p=i;p&lt;j;p++)\n        {\n             printf(\"%d \",A[p]);\n        }\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "embedded", "uart", "cortex-m"], "comments": [{"owner": {"reputation": 54937, "user_id": 16587, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9ed3482ccbb461fbf8796b251caf8f4d?s=128&d=identicon&r=PG", "display_name": "George Stocker", "link": "https://stackoverflow.com/users/16587/george-stocker"}, "edited": false, "score": 0, "creation_date": 1466118555, "post_id": 37828303, "comment_id": 63198233, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/114889/discussion-on-question-by-p-brand-bus-error-debugging-on-arm-cortex-m4\">moved to chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1465981393, "creation_date": 1465981393, "answer_id": 37830816, "question_id": 37828303, "link": "https://stackoverflow.com/questions/37828303/bus-error-debugging-on-arm-cortex-m4/37830816#37830816", "title": "Bus error debugging on arm cortex m4", "body": "<p><code>tmp</code> is uninitialized:</p>\n\n<pre><code>void uartPutInt(int32_t data) {\n    char buf[16] = {0};\n    uint32_t tmpData;\n    uint8_t neg = 0;\n    int8_t tmp;  // not initialized\n\n    if(data&lt;0) { // check negative\n        tmpData = -data;\n        neg=1;\n    }\n    else {\n        tmpData = data;\n    }\n\n    while(tmpData) { // convert to chars\n        uint8_t num = tmpData % 10;\n\n        // what's in tmp right now?!?!\n        buf[tmp++]=num+48;\n        tmpData/=10;\n    }\n\n    if(neg) { // add minus sign\n        buf[tmp++] = 45;\n    }\n\n    while(tmp&gt;=0) {\n        uartPutChar(buf[tmp--]);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6460717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3cb60cd2956a0a68c38d491744ff9f?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brand", "link": "https://stackoverflow.com/users/6460717/p-brand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1554993957, "creation_date": 1465974317, "last_edit_date": 1465981523, "question_id": 37828303, "link": "https://stackoverflow.com/questions/37828303/bus-error-debugging-on-arm-cortex-m4", "title": "Bus error debugging on arm cortex m4", "body": "<p>I am trying to debug a precise bus error on a Arm cortex m4 chip.\nThe board is a teensy 3.1 with a freescale MK20DX256VLH7. The error only happens when i actually send characters with the uart and results in a forced hard fault because i dont have buserror and memory error handlers. The fault happens after a random amount of time between 1 second and 1 minute when sending 30 integers per second with the uart. Also when i print the values in binary, not the uartPutInt() but the uartPutBin() function, the fault does not happen.</p>\n\n<p>I \"hacked\" the teensy so i can use SWD debugging.\nI use a arm-none-eabi toolchain gcc, gdb.</p>\n\n<p>I tried to double stack size but that doesn't help.\nI tried different itoa() approaches, doesn't help. </p>\n\n<p>full code can be accessed here:\n<a href=\"https://github.com/paulusbrand/tricopter\" rel=\"nofollow\">https://github.com/paulusbrand/tricopter</a></p>\n\n<p>The problem occurs in uartPutInt() function, its not the prettiest function but i tried different approaches and this one is the easiest to debug and understand.</p>\n\n<p>original:</p>\n\n<pre><code>void uartPutInt(int32_t data) {\n    char buf[16] = {0};\n    uint32_t tmpData;\n    uint8_t neg = 0;\n    int8_t tmp = 0;\n\n    if(data&lt;0) { // check negative\n        tmpData = -data;\n        neg=1;\n    }\n    else {\n        tmpData = data;\n    }\n\n    while(tmpData) { // convert to chars\n        uint8_t num = tmpData % 10;\n        buf[tmp++]=num+48;\n        tmpData/=10;\n    }\n\n    if(neg) { // add minus sign\n        buf[tmp++] = 45;\n    }\n\n    while(tmp&gt;=0) {\n        uartPutChar(buf[tmp--]);\n    }\n}\n</code></pre>\n\n<p>new version:</p>\n\n<pre><code>void uartPutInt(int32_t data) {\n    char buf[16] = {0};\n    uint32_t tmpData;\n    uint8_t neg = 0;\n    int8_t tmp = 0;\n\n    if(data&lt;0) { // check negative\n        tmpData = -data;\n        neg=1;\n    }\n    else {\n        tmpData = data;\n    }\n\n    do { // convert te chars\n        uint8_t num = tmpData % 10;\n        buf[tmp++]=num+'0';\n        tmpData/=10;\n    } while(tmpData);\n\n    if(neg) { // add minus sign\n        buf[tmp++] = '-';\n    }\n\n    while(tmp&gt;0) {\n        uartPutChar(buf[--tmp]);\n    }\n}\n</code></pre>\n\n<p>When the bus error occurs i check the CFSR register in the SCB and find precise bus error and BFAR valid.</p>\n\n<p>The value of BFAR and thus the problematic memory address is 0x01007fd2. Which is, as far as i can tell, in the code area of the memory but far beyond the end of the code. I not really sure what to do with this number.</p>\n\n<p>The program counter PC when the error occurs is 0x1033. Which is in the uartPutInt() function. Disassembled below.</p>\n\n<pre><code>00000f6c &lt;uartPutInt&gt;:\n f6c:   b580        push    {r7, lr}\n f6e:   b088        sub sp, #32\n f70:   af00        add r7, sp, #0\n f72:   6078        str r0, [r7, #4]\n f74:   f107 0308   add.w   r3, r7, #8\n f78:   2200        movs    r2, #0\n f7a:   601a        str r2, [r3, #0]\n f7c:   3304        adds    r3, #4\n f7e:   2200        movs    r2, #0\n f80:   601a        str r2, [r3, #0]\n f82:   3304        adds    r3, #4\n f84:   2200        movs    r2, #0\n f86:   601a        str r2, [r3, #0]\n f88:   3304        adds    r3, #4\n f8a:   2200        movs    r2, #0\n f8c:   601a        str r2, [r3, #0]\n f8e:   3304        adds    r3, #4\n f90:   2300        movs    r3, #0\n f92:   76fb        strb    r3, [r7, #27]\n f94:   687b        ldr r3, [r7, #4]\n f96:   2b00        cmp r3, #0\n f98:   da05        bge.n   fa6 &lt;uartPutInt+0x3a&gt;\n f9a:   687b        ldr r3, [r7, #4]\n f9c:   425b        negs    r3, r3\n f9e:   61fb        str r3, [r7, #28]\n fa0:   2301        movs    r3, #1\n fa2:   76fb        strb    r3, [r7, #27]\n fa4:   e001        b.n faa &lt;uartPutInt+0x3e&gt;\n fa6:   687b        ldr r3, [r7, #4]\n fa8:   61fb        str r3, [r7, #28]\n faa:   e01f        b.n fec &lt;uartPutInt+0x80&gt;\n fac:   69f9        ldr r1, [r7, #28]\n fae:   4b23        ldr r3, [pc, #140]  ; (103c &lt;uartPutInt+0xd0&gt;)\n fb0:   fba3 2301   umull   r2, r3, r3, r1\n fb4:   08da        lsrs    r2, r3, #3\n fb6:   4613        mov r3, r2\n fb8:   009b        lsls    r3, r3, #2\n fba:   4413        add r3, r2\n fbc:   005b        lsls    r3, r3, #1\n fbe:   1aca        subs    r2, r1, r3\n fc0:   4613        mov r3, r2\n fc2:   767b        strb    r3, [r7, #25]\n fc4:   7eba        ldrb    r2, [r7, #26]\n fc6:   b2d3        uxtb    r3, r2\n fc8:   3301        adds    r3, #1\n fca:   b2db        uxtb    r3, r3\n fcc:   76bb        strb    r3, [r7, #26]\n fce:   b253        sxtb    r3, r2\n fd0:   7e7a        ldrb    r2, [r7, #25]\n fd2:   3230        adds    r2, #48 ; 0x30\n fd4:   b2d2        uxtb    r2, r2\n fd6:   f107 0120   add.w   r1, r7, #32\n fda:   440b        add r3, r1\n fdc:   f803 2c18   strb.w  r2, [r3, #-24]\n fe0:   69fb        ldr r3, [r7, #28]\n fe2:   4a16        ldr r2, [pc, #88]   ; (103c &lt;uartPutInt+0xd0&gt;)\n fe4:   fba2 2303   umull   r2, r3, r2, r3\n fe8:   08db        lsrs    r3, r3, #3\n fea:   61fb        str r3, [r7, #28]\n fec:   69fb        ldr r3, [r7, #28]\n fee:   2b00        cmp r3, #0\n ff0:   d1dc        bne.n   fac &lt;uartPutInt+0x40&gt;\n ff2:   7efb        ldrb    r3, [r7, #27]\n ff4:   2b00        cmp r3, #0\n ff6:   d00b        beq.n   1010 &lt;uartPutInt+0xa4&gt;\n ff8:   7eba        ldrb    r2, [r7, #26]\n ffa:   b2d3        uxtb    r3, r2\n ffc:   3301        adds    r3, #1\n ffe:   b2db        uxtb    r3, r3\n1000:   76bb        strb    r3, [r7, #26]\n1002:   b253        sxtb    r3, r2\n1004:   f107 0220   add.w   r2, r7, #32\n1008:   4413        add r3, r2\n100a:   222d        movs    r2, #45 ; 0x2d\n100c:   f803 2c18   strb.w  r2, [r3, #-24]\n1010:   e00d        b.n 102e &lt;uartPutInt+0xc2&gt;\n1012:   7eba        ldrb    r2, [r7, #26]\n1014:   b2d3        uxtb    r3, r2\n1016:   3b01        subs    r3, #1\n1018:   b2db        uxtb    r3, r3\n101a:   76bb        strb    r3, [r7, #26]\n101c:   b253        sxtb    r3, r2\n101e:   f107 0220   add.w   r2, r7, #32\n1022:   4413        add r3, r2\n1024:   f813 3c18   ldrb.w  r3, [r3, #-24]\n1028:   4618        mov r0, r3\n102a:   f7ff ff87   bl  f3c &lt;uartPutChar&gt;\n102e:   f997 301a   ldrsb.w r3, [r7, #26]\n1032:   2b00        cmp r3, #0\n1034:   daed        bge.n   1012 &lt;uartPutInt+0xa6&gt;\n1036:   3720        adds    r7, #32\n1038:   46bd        mov sp, r7\n103a:   bd80        pop {r7, pc}\n103c:   cccccccd    stclgt  12, cr12, [ip], {205}   ; 0xcd\n</code></pre>\n\n<p>Can somebody please help me with this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c", "linux"], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1465975119, "last_edit_date": 1465975119, "creation_date": 1465974296, "answer_id": 37828294, "question_id": 37828119, "link": "https://stackoverflow.com/questions/37828119/calling-c-function-from-c/37828294#37828294", "title": "calling c++ function from c", "body": "<pre><code>gcc -o data main.c\n</code></pre>\n\n<p>Not sure <em>why</em> you have this line in your makefile since it will compile <code>main.c</code> <em>without</em> reference to the previously created library and hence cause an undefined-symbol error such as the one you're seeing.</p>\n\n<p>This is especially so, since you appear to have done it the <em>right</em> way on the preceding line:</p>\n\n<pre><code>gcc -L/home/oracle/Desktop/storage/ -Wall main.c -o data -ldb_manager\n</code></pre>\n\n<p>However, the entire point of using makefiles is so that it figures out the minimum necessary commands for you, based on dependencies. Lumping a large swathe of commands into a single rule tends to defeat that purpose. You would be better off making your rules a little more targeted, such as (untested but should be close):</p>\n\n<pre><code>all: data\n\ndata: main.o libdb_manager.so\n    gcc -o data main.o -ldb_manager\n\nmain.o: main.c\n    gcc -o main.o main.c\n\nlibdb_manager.so: db_manager.cpp\n    g++ -c -Wall -Werror -fPIC -o db_manager.o db_manager.cpp \n    g++ -shared -o libdb_manager.so db_manager.o\n</code></pre>\n\n<p>That way, if you make a small change to one part (like <code>main.c</code>), it doesn't have to go and compile/link everything in your build tree.</p>\n"}, {"comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1465974732, "post_id": 37828301, "comment_id": 63119237, "body": "Did you <i>want</i> to be passing C++ source to <code>gcc</code>? I don&#39;t think that works too well, since it will want <code>g++</code>."}, {"owner": {"reputation": 51, "user_id": 2025631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jBH2E.jpg?s=128&g=1", "display_name": "Sisay Zinabu", "link": "https://stackoverflow.com/users/2025631/sisay-zinabu"}, "edited": false, "score": 0, "creation_date": 1465977066, "post_id": 37828301, "comment_id": 63120629, "body": "@Paul R thanks for your response but the makefile which you suggest is not know the cpp library for example the error what i get is when i use your makefile db_manager.cpp:(.text+0xa): undefined reference to `std::cout&#39;"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 51, "user_id": 2025631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jBH2E.jpg?s=128&g=1", "display_name": "Sisay Zinabu", "link": "https://stackoverflow.com/users/2025631/sisay-zinabu"}, "edited": false, "score": 0, "creation_date": 1465978317, "post_id": 37828301, "comment_id": 63121343, "body": "@SisayZinabu: did you use <code>gcc</code> or <code>g++</code> in the makefile ?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1465979079, "post_id": 37828301, "comment_id": 63121852, "body": "@paxdiablo gcc will compile and link C++ just fine, it just doesn&#39;t automatically link the standard C++ library."}, {"owner": {"reputation": 51, "user_id": 2025631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jBH2E.jpg?s=128&g=1", "display_name": "Sisay Zinabu", "link": "https://stackoverflow.com/users/2025631/sisay-zinabu"}, "edited": false, "score": 0, "creation_date": 1465982992, "post_id": 37828301, "comment_id": 63124471, "body": "@Paul R i am using both my objective is to mix c and c++ to call function of c++ in c"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 51, "user_id": 2025631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jBH2E.jpg?s=128&g=1", "display_name": "Sisay Zinabu", "link": "https://stackoverflow.com/users/2025631/sisay-zinabu"}, "edited": false, "score": 0, "creation_date": 1465983074, "post_id": 37828301, "comment_id": 63124519, "body": "@SisayZinabu: yes, that&#39;s fine - you can still use g++ for mixed .c and .cpp builds. I&#39;ve updated the answer though to use separate compilation for the C and C++ source files now, if that helps."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1465983277, "last_edit_date": 1465983277, "creation_date": 1465974314, "answer_id": 37828301, "question_id": 37828119, "link": "https://stackoverflow.com/questions/37828119/calling-c-function-from-c/37828301#37828301", "title": "calling c++ function from c", "body": "<p>Your makefile seems to be completely broken and random, and you're not even linking the required object files. You can simplify this:</p>\n\n<pre><code>all:    \n    $(CC) -c -Wall -Werror -fPIC db_manager.cpp \n    $(CC) -shared -o libdb_manager.so db_manager.o\n    gcc -L/home/oracle/Desktop/storage/ -Wall main.c -o data -ldb_manager\n    gcc -o data main.c \n</code></pre>\n\n<p>to just this:</p>\n\n<pre><code>all:    \n    gcc -Wall -c main.c \n    g++ -Wall -c db_manager.cpp\n    g++ main.o db_manager.o -o data\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 249, "user_id": 883856, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/72d02f1455de21e593de0b1e4acdb969?s=128&d=identicon&r=PG", "display_name": "ade", "link": "https://stackoverflow.com/users/883856/ade"}, "is_accepted": false, "score": 0, "last_activity_date": 1479318244, "creation_date": 1479318244, "answer_id": 40638812, "question_id": 37828119, "link": "https://stackoverflow.com/questions/37828119/calling-c-function-from-c/40638812#40638812", "title": "calling c++ function from c", "body": "<p>this is what I needed to do:\nSupposing the C++ function is called Debug::Write(str) \nThen in your hpp file do the following:</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" void DebugTmp(char *str);\n#endif\n</code></pre>\n\n<p>Then in the corresponding cpp file do this:</p>\n\n<pre><code>void DebugTmp(char *str)\n{\n    Debug::Write(str);\n}\n</code></pre>\n\n<p>Then in your C file where you call DebugTmp define the prototype:</p>\n\n<pre><code>void DebugTmp(char *str);\n</code></pre>\n\n<p>then call it as below:</p>\n\n<pre><code>static void MyFunction( void )\n{\n    DebugTmp(\"This is debug trace\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2025631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jBH2E.jpg?s=128&g=1", "display_name": "Sisay Zinabu", "link": "https://stackoverflow.com/users/2025631/sisay-zinabu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 37828294, "answer_count": 3, "score": 0, "last_activity_date": 1479318244, "creation_date": 1465973813, "last_edit_date": 1465975042, "question_id": 37828119, "link": "https://stackoverflow.com/questions/37828119/calling-c-function-from-c", "title": "calling c++ function from c", "body": "<p>I need to access a C++ function from C but I get some error like :-</p>\n\n<pre><code>/tmp/ccUqcSZT.o: In function `main':\nmain.c:(.text+0x5): undefined reference to `load_alert_to_db'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>My main.c code is:-</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    extern void load_alert_to_db(void);     \n    int main(void){\n        /* Create empty queue */\n        load_alert_to_db(); \n        return 0;\n    }\n</code></pre>\n\n<p>C++ code implementation db_manager.cpp is:-</p>\n\n<pre><code>#include &lt;sstream&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;string&gt;\n#include &lt;ctime&gt;\n#include &lt;cstdlib&gt;\n#include &lt;algorithm&gt;\n#include &lt;time.h&gt;\n#include &lt;cstring&gt;\n#include &lt;fstream&gt;\n\n//using namespace oracle::occi;\n#include &lt;iostream&gt;\nusing namespace std;\nextern \"C\" void load_alert_to_db(void)\n{\n    cout&lt;&lt;\"db occi\"&lt;&lt;endl;\n}\n</code></pre>\n\n<p>makefile is:-</p>\n\n<pre><code>CC= g++\nall:    \n    $(CC) -c -Wall -Werror -fPIC db_manager.cpp \n    $(CC) -shared -o libdb_manager.so db_manager.o\n    gcc -L/home/oracle/Desktop/storage/ -Wall main.c -o data -ldb_manager\n    gcc -o data main.c \n\nclean:\n    rm -f *.o data\n</code></pre>\n\n<p>so please help me which one is my problem. I am also include </p>\n\n<pre><code>export LD_LIBRARY_PATH=/home/oracle/Desktop/storage/:$LD_LIBRARY_PATH\n</code></pre>\n\n<p>environmental variable in <code>.bash_profile</code></p>\n"}, {"tags": ["c", "linux", "module", "kernel"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1465972190, "post_id": 37827522, "comment_id": 63117952, "body": "No; in the kernel you have to be careful to use libraries designed for use in the kernel.  You absolutely cannot use just any old library."}, {"owner": {"reputation": 112081, "user_id": 2231815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1597c347e309f696ff1738128444702b?s=128&d=identicon&r=PG", "display_name": "rakib_", "link": "https://stackoverflow.com/users/2231815/rakib"}, "edited": false, "score": 1, "creation_date": 1465972464, "post_id": 37827522, "comment_id": 63118101, "body": "It&#39;s a terrible idea trying using standard library from kernel space. There are other ways of communication from userspace to kernelspace like. using <code>procfs</code> or <code>sysfs</code> entries."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6448560"}, "edited": false, "score": 0, "creation_date": 1465978014, "post_id": 37827522, "comment_id": 63121159, "body": "okay i see. if i want to read some value in a file directly without using device node, how can i do in the kernel module?"}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 2, "creation_date": 1465978631, "post_id": 37827522, "comment_id": 63121557, "body": "Use <a href=\"http://man7.org/linux/man-pages/man7/netlink.7.html\" rel=\"nofollow noreferrer\">netlink</a>. Also see <a href=\"http://stackoverflow.com/questions/3299386/how-to-use-netlink-socket-to-communicate-with-a-kernel-module\">this</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user6448560"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465971686, "creation_date": 1465971686, "question_id": 37827522, "link": "https://stackoverflow.com/questions/37827522/in-linux-kernel-module-programming-can-i-use-any-library", "title": "in linux kernel module programming can i use any library?", "body": "<p>is it possible that i use FILE I/O instead character device driver?</p>\n\n<p>in my kernel module code i used character device driver source code</p>\n\n<p>(ex. alloc_chrdev_region()....) it because i want to read any number from specific files and process them in module. but when i tried first time, i used FILE I/O in module code and it didn't work. okay.. simply..</p>\n\n<p>character device driver is only method for interacting with user application in kernel module programming?(it include with block, network)</p>\n"}, {"tags": ["c", "pointers", "memory-management"], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 4, "last_activity_date": 1465972116, "last_edit_date": 1465972116, "creation_date": 1465971422, "answer_id": 37827458, "question_id": 37827343, "link": "https://stackoverflow.com/questions/37827343/in-which-segment-are-string-constants-local-to-a-function-stored/37827458#37827458", "title": "In which segment are string constants local to a function stored?", "body": "<p>It's <em>probably</em> (though not necessarily) stored in a read-only section along with all other string constants, and <code>\"FooBar\"</code> simply resolves to the address of that string, something like (pseudo assembly language):</p>\n\n<pre><code>.sect readonly\n    foobar  ds 'FooBar', 0             ; constant strings\n.sect code\n    fun:    load retreg, &amp;foobar       ; load address of it\n            retn                       ; and just return\n</code></pre>\n\n<p>However, since the standard specifies <em>nothing</em> about where things are stored, this is totally down to the implementation. The standard tends to dictate <em>behaviour</em> rather than underlying methods to implement that behaviour.</p>\n\n<p>The behaviour in this case is dictated by <code>ISO C11 6.4.5 String literals</code>, section 6 (my italics):</p>\n\n<blockquote>\n  <p>The multibyte character sequence is then used to initialize an array of <em>static storage duration</em> and length just sufficient to contain the sequence.</p>\n</blockquote>\n\n<p>The fact that it is static storage durations means that it exists for the entire duration of the program, as per <code>5.1.2 Execution Environments</code>:</p>\n\n<blockquote>\n  <p>All objects with static storage duration shall be initialized (set to their\n  initial values) before program startup.</p>\n</blockquote>\n\n<p>and <code>6.2.4 Storage durations of objects</code> in section 3, discussing static storage duration:</p>\n\n<blockquote>\n  <p>Its lifetime is the <em>entire</em> execution of the program and its stored value is initialized only once, prior to program startup.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1465971712, "creation_date": 1465971712, "answer_id": 37827529, "question_id": 37827343, "link": "https://stackoverflow.com/questions/37827343/in-which-segment-are-string-constants-local-to-a-function-stored/37827529#37827529", "title": "In which segment are string constants local to a function stored?", "body": "<p>The C language standard doesn't use terms like \"segment\" or \"stack\". These terms are used by some implementations. </p>\n\n<p>A string literal represents an array of <em>static storage duration</em>, which means it lives during the entire execution of the program and is not confined to any block or function.</p>\n"}], "owner": {"reputation": 681, "user_id": 5594633, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/df57cddb88cae749606d7f67da0b84f6?s=128&d=identicon&r=PG&f=1", "display_name": "kauray", "link": "https://stackoverflow.com/users/5594633/kauray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1465973608, "answer_count": 2, "score": 1, "last_activity_date": 1465972116, "creation_date": 1465970923, "question_id": 37827343, "link": "https://stackoverflow.com/questions/37827343/in-which-segment-are-string-constants-local-to-a-function-stored", "closed_reason": "Duplicate", "title": "In which segment are string constants local to a function stored?", "body": "<p>Suppose we have the following piece of code</p>\n\n<pre><code>char * fun(){\n    //some code\n    return \"FooBar\";\n}\n</code></pre>\n\n<p>Where is the string \"FooBar\" store? In the data segment or in the local stack? If it is stored in the stack, would the pointer reference not become invalid since the string would be local to the function?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 7, "creation_date": 1465970497, "post_id": 37827212, "comment_id": 63117192, "body": "The simplest way, and almost the only way or the only good way is to create a temporary file, write the modified content to it and rename it."}, {"owner": {"reputation": 15, "user_id": 6418324, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154124625953326/picture?type=large", "display_name": "Oliver Sim", "link": "https://stackoverflow.com/users/6418324/oliver-sim"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1465970844, "post_id": 37827212, "comment_id": 63117333, "body": "Can i use struct function and structure to edit the items? How do i create a temporary file? I just want to change that part of segment like overwrite it with the input i entered."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1465972037, "post_id": 37827212, "comment_id": 63117870, "body": "You <i>can</i> overwrite the part of the file as long as the replacement material is exactly the same length as the original \u2014 you use <code>fseek()</code>, and maybe <code>ftell()</code> and related functions.  If the replacement text is shorter, you could blank pad to the original length (or use some other pad character).  If the replacement text is longer, you&#39;re snookered \u2014 you can&#39;t move data around in a file without copying the whole file.  The general solution, therefore, is to copy the file with modifications to a new file (as others said)."}, {"owner": {"reputation": 15, "user_id": 6418324, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154124625953326/picture?type=large", "display_name": "Oliver Sim", "link": "https://stackoverflow.com/users/6418324/oliver-sim"}, "edited": false, "score": 0, "creation_date": 1465972656, "post_id": 37827212, "comment_id": 63118192, "body": "So, the only, and simplest solution would be copy the file with modifications and write into a new file using &#39;w&#39; ? which have everything but the only changes would the editted segment string?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1465972974, "post_id": 37827212, "comment_id": 63118331, "body": "@OliverSim yes, exactly"}, {"owner": {"reputation": 15, "user_id": 6418324, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154124625953326/picture?type=large", "display_name": "Oliver Sim", "link": "https://stackoverflow.com/users/6418324/oliver-sim"}, "edited": false, "score": 0, "creation_date": 1465973538, "post_id": 37827212, "comment_id": 63118587, "body": "Then it comes to the part of algorithm that i do not understand. For example, if i entered BG002 and i want to change the name into &#39;Gardenia&#39; how can i copy everything above it and the line itself and below into a &#39;w&#39; text file?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6418324, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154124625953326/picture?type=large", "display_name": "Oliver Sim", "link": "https://stackoverflow.com/users/6418324/oliver-sim"}, "edited": false, "score": 0, "creation_date": 1465975205, "post_id": 37828405, "comment_id": 63119531, "body": "I&#39;ve done it already. And it seems that writing into a new file with editted variable works. How do i rename the text file?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 15, "user_id": 6418324, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154124625953326/picture?type=large", "display_name": "Oliver Sim", "link": "https://stackoverflow.com/users/6418324/oliver-sim"}, "edited": false, "score": 0, "creation_date": 1465975655, "post_id": 37828405, "comment_id": 63119784, "body": "You can rename with function <code>rename</code> <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_rename.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library/c_function_rename.htm</a>"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1465974598, "creation_date": 1465974598, "answer_id": 37828405, "question_id": 37827212, "link": "https://stackoverflow.com/questions/37827212/how-to-overwrite-content-in-text-file-edit-items/37828405#37828405", "title": "How to overwrite content in text file? (edit items)", "body": "<p>As suggested by iharob, you will probably need to create a temporary file, write the modified content to it and rename it. It will work for most cases.</p>\n\n<p>However, If this involves thousands or hundreds of thousands of entries, this method is not practical. Then, you will need a different file storage structure. Each field should have a maximum limit and be padded upto it's limit. The size of each line will become equal in each case, and can be easily replaced by another line.</p>\n\n<p>e.g.</p>\n\n<pre><code>AG001;July biscuits      ;005.035;090\nBG001;Maximu Bun         ;003.050;020 \nBG002;Lamli Burger       ;004.060;015\nCG001;TTT Candy          ;004.000;042\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "is_accepted": false, "score": 0, "last_activity_date": 1465980751, "last_edit_date": 1465980751, "creation_date": 1465978250, "answer_id": 37829649, "question_id": 37827212, "link": "https://stackoverflow.com/questions/37827212/how-to-overwrite-content-in-text-file-edit-items/37829649#37829649", "title": "How to overwrite content in text file? (edit items)", "body": "<p>I made an simplified example to show you how you can use structs and a 'temporary' file to achieve your goal. </p>\n\n<p>This is a shortend structure of your items. For simplicity i only used the item code and the item name:</p>\n\n<pre><code>typedef struct\n{\n  char item_code[10];\n  char item_name[50];\n} item;\n</code></pre>\n\n<p>First of all i would suggest to write a read an write fuction so you can easily write this struct to an file and read it from it. Something like this: </p>\n\n<pre><code>void write_items_to_file(FILE* fp, item* items, size_t size)\n{\n  if (!fp)\n  {\n    fprintf(stderr, \"File not open!\\n\");\n    return;\n  }\n\n  for (size_t i = 0; i &lt; size; i++)\n  {\n    fprintf(fp, \"%s;%s;\\n\", items[i].item_code, items[i].item_name);\n  }\n}\n\nsize_t read_items_from_file(FILE* fp, item* items, size_t max)\n{\n  if (!fp)\n  {\n    printf(\"File not open!\\n\");\n    return -1;\n  }\n\n  char line[MAX_LEN];\n  size_t current_item = 0;\n  while (fgets(line, MAX_LEN, fp) &amp;&amp; current_item &lt; max)\n  {\n    if (sscanf(line, \"%5[^;];%50[^;];\", (items[current_item].item_code), (items[current_item].item_name)) != 2) // change '2' to the amount of atributes of item\n    {\n      fprintf(stderr, \"Wrong internal file organization!\\n\");\n      return -2;\n    }\n    current_item++;\n  }\n  return current_item;\n}\n</code></pre>\n\n<p>Now we got this, lets face the changing part. Assume we have a file with two items:</p>\n\n<pre><code>AG001;July biscuits;\nBG001;Maximu Bun;\n</code></pre>\n\n<p>Now we can use the <code>read_items_from_file</code> function to get the items. If You now want to change <code>July biscuits</code> to <code>Gardenia</code> we can use <code>strncmp</code> to find the item with the name <code>July biscuits</code> and replace it.</p>\n\n<p>When we're finished with editing the items we write the to another file e.g. <code>\"items.txt.tmp\"</code> using the <code>write_items_to_file</code> function. After that we <code>rename</code> the 'temporary' file to the original file und thus replaced the name of the desired item in the original file. This is as others pointed out the easiest approach.</p>\n\n<p>Here ist the complete main of the scenario i described:  </p>\n\n<pre><code>int main()\n{\n  FILE *fp = fopen(\"items.txt\", \"r\");\n  item items_read[2]; \n\n  size_t read_values = read_items_from_file(fp, items_read, 2);\n\n  for (size_t i = 0; i &lt; read_values; i++)\n  {\n    if (strncmp(items_read[i].item_name, \"July biscuits\", 50) == 0)\n    {\n      strncpy(items_read[i].item_name,\"Gardenia\", 50);\n    }\n  }\n\n  if (fp)\n  {\n    fclose(fp);\n  }\n\n  // now create a new file\n  fp = fopen(\"items.txt.tmp\", \"w\");\n  if (fp)\n  {\n    write_items_to_file(fp, items_read, 2);\n    fclose(fp);\n\n    // now \"move\" the temp file to the original file using 'rename'\n    rename(\"items.txt.tmp\", \"items.txt\");\n  }\n}\n</code></pre>\n\n<p><strong>Note:</strong> Of course you have to change the <code>item struct</code> and the read and write functions according to your requirements.</p>\n"}], "owner": {"reputation": 15, "user_id": 6418324, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154124625953326/picture?type=large", "display_name": "Oliver Sim", "link": "https://stackoverflow.com/users/6418324/oliver-sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468073850, "creation_date": 1465970351, "last_edit_date": 1468073850, "question_id": 37827212, "link": "https://stackoverflow.com/questions/37827212/how-to-overwrite-content-in-text-file-edit-items", "title": "How to overwrite content in text file? (edit items)", "body": "<p>My problem would be, how can i edit the string value when i input my item code let's say for example: (this is inside a text file called gst.txt)</p>\n\n<pre><code>AG001;July biscuits;5.35;90\nBG001;Maximu Bun;3.50;20 \nBG002;Lamli Burger;4.60;15\nCG001;TTT Candy;4.00;42\nCG002;Cappuccino;7.80;30\nCG003;Queenz Cakes;14.00;5\nDG001;Donkey Donuts;3.80;24\nDG002;French Fries;4.30;11\n</code></pre>\n\n<p>the segment is follow as: (itemcode);(itemname);(itemprice);(itemquantity)</p>\n\n<p>When i entered the item code of <code>AG001</code>. I have option to choose, whether to edit the item name, item price of item quantity. When i choose the item name option, i entered the new name for the item. How can i overwrite the existing <code>July biscuits</code> into something like <code>Gardenia</code> while only change that segment of the text file?</p>\n\n<p>Here's my code: </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar itemcode[10];\nchar gst[256];\nchar gstcode[10], gstname[50];\nchar gstprice[10];\nchar gstquantity[5];\nchar selection[5];\nchar newname[50], newprice[10], newquantity[5];\n\nint main()\n{\n    FILE* fgst;\n    fgst = fopen(\"gst.txt\", \"r+\");\n\n    while (strcmp(itemcode, \"-1\") != 0) {\n\n        printf(\"Enter item code to be edited &lt;-1 to exit&gt;: \");\n        scanf(\"%s\", itemcode);\n\n        if (strcmp(itemcode, \"-1\") == 0)\n            break;\n\n        if (strcmp(itemcode, \"AG001\") == 0 || strcmp(itemcode, \"BG001\") == 0 || strcmp(itemcode, \"BG002\") == 0 || strcmp(itemcode, \"CG001\") == 0 || strcmp(itemcode, \"CG002\") == 0 || strcmp(itemcode, \"CG003\") == 0 || strcmp(itemcode, \"DG001\") == 0 || strcmp(itemcode, \"DG002\") == 0) {\n\n            while (fgets(gst, 256, fgst) != NULL) {\n\n                sscanf(gst, \"%5[^;];%29[^;];%10[^;];%5[^;]\", gstcode, gstname, gstprice, gstquantity);\n\n                if (strcmp(itemcode, gstcode) == 0) {\n\n                    printf(\"Enter &lt;1&gt; to edit item name, &lt;2&gt; for price, &lt;3&gt; for quantity: \");\n                    scanf(\"%s\", selection);\n\n                    if (strcmp(selection, \"1\") == 0) {\n\n                        printf(\"Enter the new item name: \");\n                        scanf(\"%s\", newname);\n                        fprintf(fgst, \"%s;%s;%s;%s\", gstcode, newname, gstprice, gstquantity);\n                        break;\n                    }\n                    else if (strcmp(selection, \"2\") == 0) {\n\n                        printf(\"Enter the new item price: \");\n                        scanf(\"%s\", newprice);\n                        fprintf(fgst, \"%s;%s;%s;%s\", gstcode, gstname, newprice, gstquantity);\n                        break;\n                    }\n\n                    else if (strcmp(selection, \"3\") == 0) {\n\n                        printf(\"Enter the new item quantity: \");\n                        scanf(\"%s\", newquantity);\n                        fprintf(fgst, \"%s;%s;%s;%s\", gstcode, gstname, gstprice, newquantity);\n                        break;\n                    }\n\n                    else {\n                        printf(\"Invalid input.\");\n                    }\n                }\n            }\n        }\n        else {\n\n            printf(\"Item not found.\\n\");\n            printf(\"Re-enter the correct item code.\\n\");\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "plugins", "shared-libraries"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1465969426, "post_id": 37826721, "comment_id": 63116745, "body": "You may use <code>nm</code> to parse the object files and observe if the required functions are defined?"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1465968796, "creation_date": 1465968796, "answer_id": 37826889, "question_id": 37826721, "link": "https://stackoverflow.com/questions/37826721/is-there-a-way-in-c-to-have-the-compiler-linker-give-an-error-if-a-function-is-n/37826889#37826889", "title": "Is there a way in C to have the compiler/linker give an error if a function is not defined?", "body": "<p>I don't think you can enforce that a function be defined at compile time. However, if you use gcc toolchain, you can use the <code>--undefined</code> flag when linking to enforce that a symbol be defined.</p>\n\n<pre><code>ld --undefined foo\n</code></pre>\n\n<p>will treat <code>foo</code> as though it is an undefined symbol that must be defined for the linker to succeed.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 2869327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TukRJ.jpg?s=128&g=1", "display_name": "LongBoolean", "link": "https://stackoverflow.com/users/2869327/longboolean"}, "edited": false, "score": 0, "creation_date": 1466036489, "post_id": 37830412, "comment_id": 63155500, "body": "Would you mind expanding your explanation a bit? I don&#39;t quite understand what your code example is showing. (for example I don&#39;t know what the import and export functions are doing) I also don&#39;t know if this code is suppose to be in the plugin or the main program. In other words what is the goal here? (I ask because I may be thinking differently about how to structure a plugin system, or maybe not, I am unsure)"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 31, "user_id": 2869327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TukRJ.jpg?s=128&g=1", "display_name": "LongBoolean", "link": "https://stackoverflow.com/users/2869327/longboolean"}, "edited": false, "score": 0, "creation_date": 1466061550, "post_id": 37830412, "comment_id": 63163449, "body": "@LongBoolean If I understood you correctly, you have a program which loads dynamic libraries at runtime (plugins, in your case), and your question was if it&#39;s possible to give you a compiler error if a function is not defined, am I right?"}, {"owner": {"reputation": 31, "user_id": 2869327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TukRJ.jpg?s=128&g=1", "display_name": "LongBoolean", "link": "https://stackoverflow.com/users/2869327/longboolean"}, "edited": false, "score": 0, "creation_date": 1466095997, "post_id": 37830412, "comment_id": 63187203, "body": "Correct, When the plugin is compiled I would like some kind of error. (I do not want an error when compiling the main program, thus me saying that compiling the main program and the plugins is separate from each other) I suppose a linker error would also be acceptable if there is no way to accomplish this task at compile time."}], "tags": [], "owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "is_accepted": false, "score": 0, "last_activity_date": 1465980700, "last_edit_date": 1465980700, "creation_date": 1465980351, "answer_id": 37830412, "question_id": 37826721, "link": "https://stackoverflow.com/questions/37826721/is-there-a-way-in-c-to-have-the-compiler-linker-give-an-error-if-a-function-is-n/37830412#37830412", "title": "Is there a way in C to have the compiler/linker give an error if a function is not defined?", "body": "<p>You cannot do that.</p>\n\n<p>It's common practice, to only define two exported functions in a library opened by <code>dlopen()</code>, one to import functions in your plugin and one to export functions of your plugin.</p>\n\n<p>A few lines of code are better than any explanation:</p>\n\n<pre><code>struct plugin_import {\n    void (*draw)(float);\n    void (*update)(float);\n};\nstruct plugin_export {\n    int (*get_version)(void);\n    void (*set_version)(int);\n};\n\nextern void import(struct plugin_import *);\nextern void export(struct plugin_export *);\n\nint setup(void)\n{\n    struct plugin_export out = {0};\n    struct plugin_import in;\n\n    /* give the plugin our function pointers */\n    in.draw = &amp;draw, in.update = &amp;update;\n    import(&amp;in);\n\n    /* get our functions out of the plugin */\n    export(&amp;out);\n\n    /* verify that all functions are defined */\n    if (out.get_version == NULL || out.set_version == NULL)\n        return 1;\n\n    return 0;\n}\n</code></pre>\n\n<p>This is very similar to the system Quake 2 used. You can look at the source <a href=\"https://github.com/id-Software/Quake-2/blob/372afde46e7defc9dd2d719a1732b8ace1fa096e/client/ref.h#L131\" rel=\"nofollow\">here</a>.\n<br> With the only difference, Quake 2 only exported a single function, which im- and exports the functions defined by the dynamic library at once.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 2869327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TukRJ.jpg?s=128&g=1", "display_name": "LongBoolean", "link": "https://stackoverflow.com/users/2869327/longboolean"}, "is_accepted": true, "score": 0, "last_activity_date": 1466552623, "last_edit_date": 1466552623, "creation_date": 1466471645, "answer_id": 37934132, "question_id": 37826721, "link": "https://stackoverflow.com/questions/37826721/is-there-a-way-in-c-to-have-the-compiler-linker-give-an-error-if-a-function-is-n/37934132#37934132", "title": "Is there a way in C to have the compiler/linker give an error if a function is not defined?", "body": "<p>Well after doing some research and asking a few people that I know of on IRC I have found the following solution:</p>\n\n<p>Since I am using gcc I am able to use a linker script. </p>\n\n<p>linker.script:</p>\n\n<pre><code>ASSERT(DEFINED(funcA), \"must define funcA\" ) ;\nASSERT(DEFINED(funcB), \"must define funcB\" ) ;\n</code></pre>\n\n<p>If either of those functions are not defined, then a custom error message will be output when the program tries to link. </p>\n\n<p>(more info on linker script syntax can be found here: <a href=\"http://www.math.utah.edu/docs/info/ld_3.html\" rel=\"nofollow\">http://www.math.utah.edu/docs/info/ld_3.html</a>)</p>\n\n<p>When compiling simply add the linker script file after the source file:</p>\n\n<pre><code>gcc -o test main.c linker.script\n</code></pre>\n\n<p>Another possibility:</p>\n\n<p>Something that I didn't think of (seems a bit obvious now) that was brought to my attention is you can create small program that loads your plugin and checks to see that you have valid function pointers to all of the functions that you want your plugin to have. Then incorporate this into your build system, be it a makefile or a script or whatever. This has the benefit that you are no longer limited to using a particular compiler to make this work. As well as you can do some more sophisticated checks for other other things. The only downside being you have a little more work to do to get it set up. </p>\n"}], "owner": {"reputation": 31, "user_id": 2869327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TukRJ.jpg?s=128&g=1", "display_name": "LongBoolean", "link": "https://stackoverflow.com/users/2869327/longboolean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 37934132, "answer_count": 3, "score": 3, "last_activity_date": 1466552623, "creation_date": 1465968036, "last_edit_date": 1466042022, "question_id": 37826721, "link": "https://stackoverflow.com/questions/37826721/is-there-a-way-in-c-to-have-the-compiler-linker-give-an-error-if-a-function-is-n", "title": "Is there a way in C to have the compiler/linker give an error if a function is not defined?", "body": "<p>In my case I am writing a simple plugin system in C using dlfcn.h (linux). The plugins are compiled separately from the main program and result in a bunch of .so files. </p>\n\n<p>There are certain functions that must be defined in the plugin in order for the the plugin to be called properly by the main program. Ideally I would like each plugin to have included in it a .h file or something that somehow states what functions a valid plugin must have, if these functions are not defined in the plugin I would like the plugin to fail compilation.  </p>\n"}, {"tags": ["c", "loops", "idioms"], "comments": [{"owner": {"reputation": 2461, "user_id": 2106328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rfFc5.jpg?s=128&g=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/2106328/nishant"}, "edited": false, "score": 1, "creation_date": 1465967516, "post_id": 37826566, "comment_id": 63115986, "body": "I think a better way would be <code>for(ch = getchar(); ch != EOF;ch = getchar())</code>"}, {"owner": {"reputation": 427, "user_id": 5450328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ikz0V.jpg?s=128&g=1", "display_name": "Mr. Branch", "link": "https://stackoverflow.com/users/5450328/mr-branch"}, "edited": false, "score": 0, "creation_date": 1465967553, "post_id": 37826566, "comment_id": 63116013, "body": "I&#39;d use for(ch=getchar(); ch != EOF; ch=getchar()) instead of the second case EDIT: ^^ Took the words out of my mouth"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 6, "creation_date": 1465968322, "post_id": 37826566, "comment_id": 63116313, "body": "The reason that your alternate form is not used is due to the <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\" rel=\"nofollow noreferrer\">DRY principle</a>. That also applies to the <code>for</code> loop solution that seems to be popular today."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1465977999, "post_id": 37826566, "comment_id": 63121149, "body": "The standard idiom is simply cleaner and clearer than repeating the <code>getchar</code> call as in the for-loop solution."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1466009015, "post_id": 37826566, "comment_id": 63143261, "body": "The 2 choices of the post omit the declaration of <code>ch</code>, which is unfortunate as 1) it should be <code>int</code> rather than the common error of <code>char</code> 2) It does not demonstrate the scoping of <code>ch</code> that is often a consideration of writing a loop."}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 4933391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/98evs.jpg?s=128&g=1", "display_name": "jamesh625", "link": "https://stackoverflow.com/users/4933391/jamesh625"}, "edited": false, "score": 0, "creation_date": 1465968478, "post_id": 37826611, "comment_id": 63116390, "body": "Do you have any idea why they proposed that particular form though? Presumably, it was due to memory constraints and wanting to be as succinct as possible with their code."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1465968799, "post_id": 37826611, "comment_id": 63116510, "body": "The <code>while ((ch = getchar()) != EOF)</code> only expands the macro form of <code>getchar()</code> once, rather than a couple of times; it is preferable."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 435, "user_id": 4933391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/98evs.jpg?s=128&g=1", "display_name": "jamesh625", "link": "https://stackoverflow.com/users/4933391/jamesh625"}, "edited": false, "score": 0, "creation_date": 1465973923, "post_id": 37826611, "comment_id": 63118805, "body": "@jamesh625 Because when the K&amp;R book was written, the authors did not yet know a single thing about what makes good programming practice and readable code. Industry de facto standards for proper program design and readable code had not yet settled. The book was written in the mid 70s, it is ancient and completely outdated."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 0, "last_activity_date": 1465993699, "last_edit_date": 1495535638, "creation_date": 1465967405, "answer_id": 37826611, "question_id": 37826566, "link": "https://stackoverflow.com/questions/37826566/why-is-while-ch-getchar-eof-the-common-idiom/37826611#37826611", "title": "Why is `while ((ch = getchar()) != EOF)` the common idiom?", "body": "<p>The code you show is common because it was put forth in the seminal K&amp;R C book.  You can see an example of a novice programmer confused by it right here: <a href=\"https://stackoverflow.com/questions/5260181/reading-krc-book-and-confusing-1st-chapter-code\">reading k&amp;r(c book) and confusing 1st chapter code</a></p>\n\n<p>My personal preference is either that way, or this:</p>\n\n<pre><code>for (int ch = getchar(); ch != EOF; ch = getchar())\n</code></pre>\n\n<p>Or this:</p>\n\n<pre><code>for (int ch; (ch = getchar()) != EOF; )\n</code></pre>\n\n<p>There are lots of ways to skin the cat.  But K&amp;R skinned it first.</p>\n"}], "owner": {"reputation": 435, "user_id": 4933391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/98evs.jpg?s=128&g=1", "display_name": "jamesh625", "link": "https://stackoverflow.com/users/4933391/jamesh625"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "closed_date": 1465968680, "accepted_answer_id": 37826611, "answer_count": 1, "score": 0, "last_activity_date": 1465993699, "creation_date": 1465967201, "question_id": 37826566, "link": "https://stackoverflow.com/questions/37826566/why-is-while-ch-getchar-eof-the-common-idiom", "closed_reason": "Opinion-based", "title": "Why is `while ((ch = getchar()) != EOF)` the common idiom?", "body": "<p>Why is </p>\n\n<pre><code>while ((ch = getchar()) != EOF) {\n   // stuff\n}\n</code></pre>\n\n<p>more common/preferred/considered better than the following?</p>\n\n<pre><code>ch = getchar();\nwhile (ch != EOF) {\n    // stuff\n    ch = getchar();\n}\n</code></pre>\n\n<p>I can think of some reasons for and against.</p>\n\n<p>For:</p>\n\n<ul>\n<li>Shorter. </li>\n<li>Everything is done in the condition.</li>\n<li>Can't forget to rewrite the condition before the loop and at the end\nof the loop.</li>\n</ul>\n\n<p>Against:</p>\n\n<ul>\n<li>Confusing.</li>\n<li>An assignment in a loop (confusing? Messy?).</li>\n<li>A potentially uninitialised variable in the loop's condition (it gets\nassigned, but this may not be immediately obvious).</li>\n<li>Comparison and assignment are kept neatly separated maintaining a\n\"one line, one task\" mentality in the second format.</li>\n<li>For every assignment there will be one comparison, so the complexity\nin both cases will be the same, hence the easier to understand form\nshould be preferred.</li>\n</ul>\n\n<p>Are there other examples where a similar structure is used?</p>\n\n<p>I have the feeling that this question will elicit opinions, so I would ask that they be backed up with some sort of reason. A cursory search revealed no duplicates to this question, so I hope it's not a duplicate!</p>\n"}, {"tags": ["c", "windows", "splice", "tee"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1465969758, "post_id": 37826505, "comment_id": 63116880, "body": "I think you have &#39;Unix&#39; and &#39;Linux&#39; confused.  The <a href=\"http://linux.die.net/man/2/tee\" rel=\"nofollow noreferrer\"><code>tee(2)</code></a> and <a href=\"http://linux.die.net/man/2/splice\" rel=\"nofollow noreferrer\"><code>splice(2)</code></a> system calls are specific to Linux and are not available on other Unix variants.  For instance, Mac OS X has neither <code>tee</code> nor <code>splice</code> in either section 2 or section 3 (system calls or library functions) of the manual.  You implement <code>tee</code> (the command) with the usual <code>read</code>, <code>write</code>, <code>open</code>, <code>close</code> system calls; there&#39;s nothing very fancy about it.  Those, or their direct analogues, would work on Windows just fine."}, {"owner": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1465969790, "post_id": 37826505, "comment_id": 63116888, "body": "OK I updated my question based on your comment.  I only mentioned the command because it&#39;s an illustrative example of the system calls."}], "answers": [{"comments": [{"owner": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "edited": false, "score": 0, "creation_date": 1466005881, "post_id": 37827725, "comment_id": 63141243, "body": "I just updated my question for clarity.  This question is specifically about transferring knowledge of Linux system calls to Windows.  The command itself is only used for ease of discussion."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "edited": false, "score": 0, "creation_date": 1466008183, "post_id": 37827725, "comment_id": 63142798, "body": "Then you need to give an example of how you intend to use those calls. The <code>tee</code> command doesn&#39;t (and cannot) use them, and the equivalent Windows calls are likely to depend on the exact application of <code>tee</code> and <code>splice</code>. (That is, there won&#39;t be a 1:1 mapping.)"}, {"owner": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "edited": false, "score": 0, "creation_date": 1466021198, "post_id": 37827725, "comment_id": 63149982, "body": "Why can&#39;t the <code>tee</code> command couldn&#39;t be implemented with the <code>tee</code> function--it splits stdin to stdout and a file[s]?  I just want to split a file descriptor without leaving kernel space."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "edited": false, "score": 0, "creation_date": 1466026608, "post_id": 37827725, "comment_id": 63152655, "body": "<code>tee()</code> and <code>splice()</code> have some unusual restrictions that make them unsuitable for use in the <code>tee</code> command. (Specifically, at least one of the FDs must be a pipe.)"}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 2, "last_activity_date": 1465972388, "creation_date": 1465972388, "answer_id": 37827725, "question_id": 37826505, "link": "https://stackoverflow.com/questions/37826505/implement-tee-without-leaving-kernel-space/37827725#37827725", "title": "Implement &quot;tee&quot; without leaving kernel space", "body": "<p>The premise of this question is faulty. The <code>tee</code> command does not depend on the <code>tee()</code> or <code>splice()</code> system calls, and is not zero-copy; it is essentially implemented as:</p>\n\n<pre><code>open file for writing;\nwhile (read some data from stdin) {\n    write the data to stdout;\n    write the data to the file;\n}\n</code></pre>\n\n<p>The only system calls involved are <code>open()</code>, <code>read()</code>, and <code>write()</code>, and the Windows versions of these calls are essentially identical to the UNIX versions.</p>\n"}, {"comments": [{"owner": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "edited": false, "score": 0, "creation_date": 1466036287, "post_id": 37847573, "comment_id": 63155465, "body": "Thanks.  What functions/API should I research to accomplish this?"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "edited": false, "score": 0, "creation_date": 1466052788, "post_id": 37847573, "comment_id": 63159354, "body": "You&#39;d probably want to start with <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff554690(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Getting started with Windows drivers</a>.  I imagine you&#39;d just use ZwWriteFile to forward the data on to the destinations, you should be able to call that from DispatchWrite if the handles are open in the context of the source application.  If you have to get the handles from a different application, ZwDuplicateObject should help; you&#39;d probably want the OBJ_KERNEL_HANDLE option.  (Disclaimer: I&#39;ve done some Windows kernel-mode programming, but I&#39;m not an expert.)"}], "tags": [], "owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "is_accepted": false, "score": 1, "last_activity_date": 1466035140, "last_edit_date": 1466035140, "creation_date": 1466034144, "answer_id": 37847573, "question_id": 37826505, "link": "https://stackoverflow.com/questions/37826505/implement-tee-without-leaving-kernel-space/37847573#37847573", "title": "Implement &quot;tee&quot; without leaving kernel space", "body": "<p>No such functionality is built into Windows, but it should be possible in principle to write a tee-like kernel-mode device driver.  Of course, it would still work <em>basically</em> the same way as the user-mode implementation: receive the data from the source, write it to the destinations.  You would be able to receive the data as output sent to the tee device, rather than issuing read operations, which is a bit more efficient, and you'd avoid a few user/kernel-mode transitions, but even so I'm unsure how much of a performance improvement you'd get.</p>\n\n<p>My guess is that it probably wouldn't be worth the effort involved, but perhaps there are edge cases.</p>\n\n<p>I'm also not sure whether or not a kernel driver could deal with console I/O in older versions of Windows, as that uses psuedo-handles rather than real handles.  But console I/O is slow, so if any of your endpoints is a console you may as well stick to the user-mode implementation anyway - that definitely won't be a bottleneck in this scenario.</p>\n\n<p>A splice-like kernel-mode device driver should also be possible.  This one would probably be implemented in exactly the same way as the user-mode version, albeit with a slightly different API.</p>\n\n<p>In either case, using a kernel-mode driver would likely make it easier to efficiently handle lots of simultaneous tees and/or splices from different processes.  In user-mode you'd likely wind up with a separate thread, or even a separate process, for each one.</p>\n"}], "owner": {"reputation": 6732, "user_id": 1470887, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/be5148b43cdbb2b8eed7a6099aeb411b?s=128&d=identicon&r=PG", "display_name": "twinlakes", "link": "https://stackoverflow.com/users/1470887/twinlakes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1466035140, "creation_date": 1465966868, "last_edit_date": 1466005554, "question_id": 37826505, "link": "https://stackoverflow.com/questions/37826505/implement-tee-without-leaving-kernel-space", "title": "Implement &quot;tee&quot; without leaving kernel space", "body": "<p>In Linux, the <code>tee</code> command copies data from stdin to both stdout and a file; one could implement this function without the data ever leaving kernel space by leveraging the <code>tee</code> and <code>splice</code> system calls.  What functions are necessary to implement the <code>tee</code> command on Windows without the data ever leaving kernel space?</p>\n\n<p>While the <code>tee</code> command has a trivial implementation with <code>read</code>, <code>open</code>, and <code>write</code> that copies data in user space, I'm specifically interested in learning how to split a file stream without data leaving kernel space. </p>\n"}, {"tags": ["c", "memory", "enums"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1465966364, "post_id": 37826183, "comment_id": 63115549, "body": "This question is really &quot;What are enums?&quot;  This is something you should get from a C tutorial, not a SO post."}], "answers": [{"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1465965961, "post_id": 37826236, "comment_id": 63115393, "body": "<code>char suitSymbol</code> is not going to work unless you are using CP437 or something like that."}, {"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465967927, "post_id": 37826236, "comment_id": 63116173, "body": "But I am looking to pass value to enum variable at run time in code , is it possible ?"}, {"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465968334, "post_id": 37826236, "comment_id": 63116315, "body": "what does CP437 mean"}, {"owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "reply_to_user": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465982098, "post_id": 37826236, "comment_id": 63123850, "body": "@harish CP437 is a particular character Code Page (there are lots). CP437 is the one used on the original IBM PC that had the standard ASCII characters, plus special graphics characters outside of the normal range."}, {"owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "reply_to_user": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1465982242, "post_id": 37826236, "comment_id": 63123945, "body": "@harish You can copy an enum variable to another of the same type with no problems. If you want to save it or load it, you&#39;ll need to convert it to/from an int with a cast: <code>int i = (int)suit; Suits suit = (Suits)i;</code>"}], "tags": [], "owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "is_accepted": false, "score": 1, "last_activity_date": 1465967206, "last_edit_date": 1465967206, "creation_date": 1465965314, "answer_id": 37826236, "question_id": 37826183, "link": "https://stackoverflow.com/questions/37826183/enum-not-able-to-understand-in-memory-and-functionality/37826236#37826236", "title": "enum not able to understand in memory and functionality", "body": "<p><code>enum</code>s are exactly that: literal constants. They're not variables that can change at all.</p>\n\n<p>You would use an <code>enum</code> when you want to associate some identifiers with each other. The classic is the suits in a deck of cards:</p>\n\n<pre><code>enum Suits { Clubs, Diamonds, Hearts, Spades };\n</code></pre>\n\n<p>That means that throughout your code you can say <code>suit = Hearts;</code>, or compare them like <code>if (suit1&lt;suit2)</code> or something. But <code>Hearts = Diamonds;</code> doesn't make sense.</p>\n\n<p>As an implementation detail, <code>Clubs</code> would get the value <code>0</code>, and the next ones would get successive values. You can change this if you want:</p>\n\n<pre><code>enum Suits { Clubs=1, Diamonds/*=2*/, // Diamonds gets 2 anyway: it's the next value\n             Hearts=4, Spades=8 }; \n</code></pre>\n\n<p>With C and C++, though, if you were to output the value you'd get its numeric equivalent: not the string. To get that, you have to organise it yourself. Assuming the original definition:</p>\n\n<pre><code>enum Suits { Clubs, Diamonds, Hearts, Spades };\nchar suitSymbolA[] = { '\\5', '\\4', '\\3', '\\6' }; // ASCII version\nwchar_t suitSymbolU[] = { L'\u2663', L'\u2666', L'\u2660', L'\u2660' }; // Unicode version\nchar *suitString[] = { \"Clubs\", \"Diamonds\", \"Hearts\", \"Spades\" };\n</code></pre>\n"}], "owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1465967206, "creation_date": 1465965001, "question_id": 37826183, "link": "https://stackoverflow.com/questions/37826183/enum-not-able-to-understand-in-memory-and-functionality", "title": "enum not able to understand in memory and functionality", "body": "<p>I am not able to understand below code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nenum x_t{a,b,c,d};\nmain()\n{\nenum y{ x=3};\na=x;\nprintf(\"a=%d\\n\",a);\nprintf(\"x=%d\\n\",x);\nprintf(\"c=%d\\n\",c);\n}\n</code></pre>\n\n<p>Points what I am not clear are:\n1-why enum cant be assigned to other enum,are they constants?If they are not constants then can I assign a number to enum?\n2-what is the need to assign a tag to enum when we can access directly a value without x_t,I knew it is for Identifier purpose in designs but is there going to be any memory assigned with this tag ,if so where is this getting allocated in Data segment?</p>\n\n<p>Can I do this below code which is asked in first point.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nenum x_t{a,b,c,d};\nmain()\n{\na=3;\nprintf(\"a=%d\\n\",a);\nprintf(\"x=%d\\n\",x);\nprintf(\"c=%d\\n\",c);\n}\n</code></pre>\n\n<p>Please help me in understanding the memory structure of enum ,why it is behaving as constant .\nError what I get is </p>\n\n<blockquote>\n  <p>lvalue required as left operand of assignment</p>\n</blockquote>\n"}, {"tags": ["c", "matlab", "matrix", "mex"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4677866, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/6dbaa82ce88696b8e955442c41c7e40b?s=128&d=identicon&r=PG&f=1", "display_name": "genap", "link": "https://stackoverflow.com/users/4677866/genap"}, "edited": false, "score": 0, "creation_date": 1465993787, "post_id": 37825970, "comment_id": 63132121, "body": "Yes, the performance I was hoping to get with mxSetN was that it would simply ignore that last column and effectively delete it; that seems to be what the author was indicating. Unfortunately, it didn&#39;t work out on my end. Ultimately, I think that the best way to do this might be to just a <code>java.util.ArrayList</code>."}, {"owner": {"reputation": 751, "user_id": 5650504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181610208c30d867d0bf396ab0b59ad1?s=128&d=identicon&r=PG&f=1", "display_name": "CKT", "link": "https://stackoverflow.com/users/5650504/ckt"}, "reply_to_user": {"reputation": 135, "user_id": 4677866, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/6dbaa82ce88696b8e955442c41c7e40b?s=128&d=identicon&r=PG&f=1", "display_name": "genap", "link": "https://stackoverflow.com/users/4677866/genap"}, "edited": false, "score": 0, "creation_date": 1466135896, "post_id": 37825970, "comment_id": 63201968, "body": "Well, you <i>can</i> take that approach with mxSetN and it will do that.  It won&#39;t delete it until the mxArray actually gets cleaned up, but MATLAB will treat the array as if it has one fewer column.  What wasn&#39;t working out about it?  You said you couldn&#39;t get it running -- what was the problem?"}], "tags": [], "owner": {"reputation": 751, "user_id": 5650504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181610208c30d867d0bf396ab0b59ad1?s=128&d=identicon&r=PG&f=1", "display_name": "CKT", "link": "https://stackoverflow.com/users/5650504/ckt"}, "is_accepted": false, "score": 0, "last_activity_date": 1465963745, "creation_date": 1465963745, "answer_id": 37825970, "question_id": 37824981, "link": "https://stackoverflow.com/questions/37824981/efficiently-deleting-matrix-rows-columns-in-matlab/37825970#37825970", "title": "Efficiently Deleting Matrix Rows/Columns in MATLAB", "body": "<p>Well, for one, the MEX solution you posted isn't actually <em>deleting</em> the column, so it's not really a fair comparison. The solution of using \"mxSetN\" just sets the internal header for the mxArray to think that it has N columns.  From the documentation:</p>\n\n<blockquote>\n  <p>You typically use mxSetN to change the shape of an existing mxArray. The mxSetN function does not allocate or deallocate any space for the pr, pi, ir, or jc arrays. </p>\n</blockquote>\n\n<p>Regarding the timing results you're seeing, what happens if you run this multiple times? The first time I ran this I had similar results to yours, but on the second run the timings were similar for both methods.</p>\n\n<p>Keep in mind that in either case, you have to reallocate a large amount of memory because you're only deleting 4 elements at a time.  This means the earlier loop iterations will cost you more than the later iterations.</p>\n\n<p>The big question here is what you're ultimately trying to do. Maybe you can avoid the deletion and just use the portion of the matrix you need, or maybe there's some way to avoid having to delete a single column on each iteration (and instead do multiple columns).</p>\n"}], "owner": {"reputation": 135, "user_id": 4677866, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/6dbaa82ce88696b8e955442c41c7e40b?s=128&d=identicon&r=PG&f=1", "display_name": "genap", "link": "https://stackoverflow.com/users/4677866/genap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465963745, "creation_date": 1465956686, "question_id": 37824981, "link": "https://stackoverflow.com/questions/37824981/efficiently-deleting-matrix-rows-columns-in-matlab", "title": "Efficiently Deleting Matrix Rows/Columns in MATLAB", "body": "<p>Any tips on efficiently and quickly deleting a given row/column from a Matrix?</p>\n\n<p>I had initially believed that deleting the last column of a given matrix would be more efficient than the first column, and all column operations would be more efficient than row operations (given MATLAB's column based memory), which I was able to confirm through testing. However, the performance I did get was rather unfortunate. </p>\n\n<pre><code>someB = rand(4,50000);\nsomeC = someB.';\n\ntic\nwhile size(someB,2) &gt; 2\n   someB(:,size(someB,2)) = [];\nend\ntoc\n\ntic\nwhile size(someC,1) &gt; 2\n   someC(size(someC,1),:) = [];\nend\ntoc\n\n%Elapsed time is 13.869280 seconds.\n%Elapsed time is 10.198270 seconds.\n</code></pre>\n\n<p>I did a quick search and in <a href=\"https://www.mathworks.com/matlabcentral/newsreader/view_thread/245581%20this%20thread\" rel=\"nofollow\">this MATLAB newsgroup discussion</a>I found hope that through external C MEX functions there may indeed be a way to efficiently delete the last column of a matrix quickly. The code is attached below.</p>\n\n<pre><code>#include \"mex.h\"\n\n// You may need to uncomment the next line\n//#define mwSize int\n\nvoid mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])\n{ \n  mwSize n;\n  if( n = mxGetN(prhs[0]) )\n      mxSetN(prhs[0], n - 1);\n} \n</code></pre>\n\n<p>However, I was not able to get said code running myself. If you take a quick look at the results that the author was finding, you'll find rather remarkable performance. I'm not that good at MEX myself; would anyone know how to fix above code so that it runs, or alternatively, have an equally/near equally good MEX code/MATLAB code performance-wise?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "pointers", "variable-assignment"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1465951497, "post_id": 37824338, "comment_id": 63111989, "body": "Actually, just to clarify. Do you want all three variables to point to the same memory or different memory? The link above shows how to do it for the former."}, {"owner": {"reputation": 13, "user_id": 6467025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af1004f6fbceea50ef733da28da9e86?s=128&d=identicon&r=PG&f=1", "display_name": "kalyani", "link": "https://stackoverflow.com/users/6467025/kalyani"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1465951553, "post_id": 37824338, "comment_id": 63112005, "body": "Different memory locations"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1465951571, "post_id": 37824338, "comment_id": 63112008, "body": "Ok then the answer is no it is not possible in C syntax. Need multiple seperate assignments with corresponding <code>malloc</code> call."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465951627, "post_id": 37824338, "comment_id": 63112020, "body": "An assignment does not create variables in general."}, {"owner": {"reputation": 13, "user_id": 6467025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af1004f6fbceea50ef733da28da9e86?s=128&d=identicon&r=PG&f=1", "display_name": "kalyani", "link": "https://stackoverflow.com/users/6467025/kalyani"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465951798, "post_id": 37824338, "comment_id": 63112053, "body": "Thanks Kaylum! @Olaf Yess vaiables need to be declared first before assigning memory."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465951919, "post_id": 37824338, "comment_id": 63112074, "body": "@kalyani: No, they have to be <i>defined</i>, which allocates storage to them. The <i>declaration</i> is required to make the compiler know them. None is done by an assignment. You might confuse this with an initialiser, which also uses the <code>=</code>, but is not an assignment."}, {"owner": {"reputation": 13, "user_id": 6467025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af1004f6fbceea50ef733da28da9e86?s=128&d=identicon&r=PG&f=1", "display_name": "kalyani", "link": "https://stackoverflow.com/users/6467025/kalyani"}, "edited": false, "score": 0, "creation_date": 1465952360, "post_id": 37824338, "comment_id": 63112162, "body": "Thanks Olaf.Yess true"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "is_accepted": false, "score": 3, "last_activity_date": 1465951725, "creation_date": 1465951725, "answer_id": 37824417, "question_id": 37824338, "link": "https://stackoverflow.com/questions/37824338/can-i-assign-memory-to-different-struct-pointer-at-same-time/37824417#37824417", "title": "Can i assign memory to different struct pointer at same time?", "body": "<p>No you cannot, what you can do is make all the pointers points to the same adress:</p>\n\n<pre><code>head=next=n1=malloc(sizeof(node));\n</code></pre>\n\n<p>Same as:</p>\n\n<pre><code>n1 = malloc(sizeof(node));\nnext = n1;\nhead = next;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1465952880, "creation_date": 1465952880, "answer_id": 37824549, "question_id": 37824338, "link": "https://stackoverflow.com/questions/37824338/can-i-assign-memory-to-different-struct-pointer-at-same-time/37824549#37824549", "title": "Can i assign memory to different struct pointer at same time?", "body": "<p>This expression statement that is valid in C</p>\n\n<pre><code>head,next,n1=malloc(sizeof(node));\n</code></pre>\n\n<p>consists of three subexpressions that are operands of the comma operator.</p>\n\n<p>You can imagine it like</p>\n\n<pre><code>( head ), ( next ), ( n1=malloc(sizeof(node)) );\n</code></pre>\n\n<p>So as you can see only n1 is assigned with the value returned by the call of <code>malloc</code>.</p>\n\n<p>You could write instead</p>\n\n<pre><code>head = next = n1 = malloc(sizeof(node));\n</code></pre>\n\n<p>but again in this case function malloc is called once and its value is assigned to three pointers n1, next and head. That is all three pointers will have the same value - the address of the allocated memory by this one call of malloc.</p>\n\n<p>So if you want that each pointer would point to its own allocated memory then you have to call malloc three times.</p>\n\n<pre><code>head = malloc(sizeof(node));\nnext = malloc(sizeof(node));\nn1 = malloc(sizeof(node));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6411011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4JjK.jpg?s=128&g=1", "display_name": "p4p1", "link": "https://stackoverflow.com/users/6411011/p4p1"}, "is_accepted": false, "score": 0, "last_activity_date": 1465972270, "creation_date": 1465972270, "answer_id": 37827688, "question_id": 37824338, "link": "https://stackoverflow.com/questions/37824338/can-i-assign-memory-to-different-struct-pointer-at-same-time/37827688#37827688", "title": "Can i assign memory to different struct pointer at same time?", "body": "<p>in C the \",\"(comma) operator is used to define multiple variables of the same type. For example:</p>\n\n<pre><code>int n1, next, head;\n</code></pre>\n\n<p>But can not be used to assign a value to a variable. To do that you need to use the assigning operator \"=\"(equal). For example:</p>\n\n<pre><code>head = next = n1 = malloc(sizeof(node));\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6467025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af1004f6fbceea50ef733da28da9e86?s=128&d=identicon&r=PG&f=1", "display_name": "kalyani", "link": "https://stackoverflow.com/users/6467025/kalyani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1465989334, "accepted_answer_id": 37824549, "answer_count": 3, "score": -2, "last_activity_date": 1465989237, "creation_date": 1465951154, "last_edit_date": 1465989237, "question_id": 37824338, "link": "https://stackoverflow.com/questions/37824338/can-i-assign-memory-to-different-struct-pointer-at-same-time", "closed_reason": "Duplicate", "title": "Can i assign memory to different struct pointer at same time?", "body": "<p>I am a new C learner and have a question.  Can I assign memory to different struct pointer at same time?  Like this: </p>\n\n<pre><code>head,next,n1=malloc(sizeof(node));\n</code></pre>\n\n<p>Head next and n1 are pointers of type struct and node is struct name.  Will this create 3 different struct pointers in memory?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1465950501, "post_id": 37824185, "comment_id": 63111725, "body": "In the first loop, you print the number followed by the star. In the second loop, you print the star followed by the number. You should make the first loop exactly the same as the second loop."}, {"owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465951500, "post_id": 37824185, "comment_id": 63111993, "body": "@user3386109 if I do that I get a trailing <code>*</code>, like <code>2*2*3*</code>"}, {"owner": {"reputation": 145, "user_id": 2624808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357740553/picture?type=large", "display_name": "James H", "link": "https://stackoverflow.com/users/2624808/james-h"}, "edited": false, "score": 0, "creation_date": 1465955061, "post_id": 37824185, "comment_id": 63112680, "body": "add a condition that only prints the trailing <code>*</code> if there are remaining factors"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465956686, "post_id": 37824185, "comment_id": 63113060, "body": "@TenTenPeter I said make the <b>first</b> loop exactly like the second. Check <code>if(y)</code> and print the star <i>before</i> the number, <b>in the first loop</b>."}], "answers": [{"tags": [], "owner": {"reputation": 7857, "user_id": 1076786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae65cca65a98d5ed54cc15ad0a2ace3?s=128&d=identicon&r=PG", "display_name": "Eli Algranti", "link": "https://stackoverflow.com/users/1076786/eli-algranti"}, "is_accepted": false, "score": 1, "last_activity_date": 1465952490, "last_edit_date": 1465952490, "creation_date": 1465950530, "answer_id": 37824249, "question_id": 37824185, "link": "https://stackoverflow.com/questions/37824185/display-prime-factors-of-a-positive-number-separated-by-in-c/37824249#37824249", "title": "Display prime factors of a positive number separated by &#39;*&#39; in c", "body": "<p>When you divide by two to find the multiple of twos you first put the number (2) then the asterisk.\nInside the <code>while (i &lt;= ft_sqrt(n))</code> used to find the rest of the primes you first print the asterisk then the number.</p>\n\n<p>Why do you even have the first while?</p>\n\n<p>In case you missed it this is a leading question.\nThe reason for finding the first prime, separate from the others is so you don't print the asterisk the first time.\nAt StackOverflow we don't like doing other people's homework but here's a lead:</p>\n\n<p>Your code should look:</p>\n\n<ul>\n<li>Find the first divider (which may or may not be 2) and print it.</li>\n<li>Find the rest of the dividers to <code>ft_sqrt(n)</code> (if any) and print '*' then the prime.</li>\n<li>Deal with the remainder and either print the asterisk or not depending on whether you've printed anything (hint: what is <code>y</code> in your code for?).</li>\n</ul>\n\n<p>Good design would call for a function to find the next divider.</p>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 4262814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513e68ba08dbe21e84479afe8007cbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Wenfeng", "link": "https://stackoverflow.com/users/4262814/wenfeng"}, "is_accepted": false, "score": 1, "last_activity_date": 1465953848, "creation_date": 1465953848, "answer_id": 37824658, "question_id": 37824185, "link": "https://stackoverflow.com/questions/37824185/display-prime-factors-of-a-positive-number-separated-by-in-c/37824658#37824658", "title": "Display prime factors of a positive number separated by &#39;*&#39; in c", "body": "<p>Since I don't have your other <code>ft_</code> functions, I write an example just use <code>putchar</code>, you can try to modify your own function like this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nvoid ft_prime(int n)\n{\n    int i;\n    bool separated;\n\n    separated = false;\n    while (n % 2 == 0) {\n        if (separated)\n            putchar('*');\n        putchar('2');\n        n /= 2;\n        separated = true;\n    }\n\n    i = 3;\n    while (i &lt;= n) {\n        while (n % i == 0) {\n            if (separated)\n                putchar('*');\n            putchar(i+'0');\n            n /= i;\n            separated = true;\n        }\n        i += 2;\n    }\n}\n\nint main(void)\n{\n    ft_prime(12);\n}\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>2*2*3\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 3606247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b09fe531732514f335d35500ea09dcaa?s=128&d=identicon&r=PG&f=1", "display_name": "Sunson", "link": "https://stackoverflow.com/users/3606247/sunson"}, "is_accepted": false, "score": 1, "last_activity_date": 1465967486, "last_edit_date": 1465967486, "creation_date": 1465961278, "answer_id": 37825589, "question_id": 37824185, "link": "https://stackoverflow.com/questions/37824185/display-prime-factors-of-a-positive-number-separated-by-in-c/37825589#37825589", "title": "Display prime factors of a positive number separated by &#39;*&#39; in c", "body": "<p>In your logic, the first loop: <code>(2*)(2*)</code>, the second loop:<code>(*3)</code>,\nso the output is <code>(2*)(2*)(*3)</code></p>\n\n<p>To modify it, change the <em>first loop</em>, make the logic like (2)(*2)(*2)...</p>\n\n<pre><code>while (n % 2 == 0)\n{\n    if(y==1){\n        ft_putchar('*');\n    }\n    ft_putnbr(2);\n    y = 1;\n    n = n / 2;\n}\n</code></pre>\n"}], "owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1465967486, "creation_date": 1465949960, "question_id": 37824185, "link": "https://stackoverflow.com/questions/37824185/display-prime-factors-of-a-positive-number-separated-by-in-c", "title": "Display prime factors of a positive number separated by &#39;*&#39; in c", "body": "<p>I'm trying to find prime factors of positive number and separate them by '*', my function works, sometimes it prints two stars instead of one. <code>2*2**3</code></p>\n\n<pre><code>void    ft_prime(int    n)\n{\n    int i;\n    int y;\n\n    i = 3;\n    y = 0;\n    while (n % 2 == 0)\n    {\n        ft_putnbr(2);\n        ft_putchar('*');\n        y = 1;\n        n = n / 2;\n    }\n    while (i &lt;= ft_sqrt(n))\n    {\n        while(n % i == 0)\n        {\n            if (y)\n                ft_putchar('*');\n            ft_putnbr(i);\n            y = 1;\n            n = n / i;\n        }\n        i += 2;\n    }\n    if (n &gt; 2)\n    {\n        ft_putchar('*');\n        ft_putnbr(n);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1465949818, "post_id": 37824121, "comment_id": 63111550, "body": "Welcome to Stack Overflow. Please read the <a href=\"https://stackoverflow.com/tour\">About</a> page soon, and about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) even sooner.  You need to set <code>Count</code> and <code>sum</code> (consistency of capitalization?) to zero at the start of each iteration of the outer loop.  You don&#39;t show the declarations of <code>sumTotal</code>, <code>sumRow</code>, or <code>sumCol</code>, which is distracting/disturbing."}, {"owner": {"reputation": 29, "user_id": 6466951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7f804193871bd9cbe7c6399fadcc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Smith", "link": "https://stackoverflow.com/users/6466951/alex-smith"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1465950242, "post_id": 37824121, "comment_id": 63111660, "body": "sorry for capitalization, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 0, "last_activity_date": 1465950807, "last_edit_date": 1465950807, "creation_date": 1465949841, "answer_id": 37824176, "question_id": 37824121, "link": "https://stackoverflow.com/questions/37824121/how-can-i-count-the-average-separately-for-all-rows/37824176#37824176", "title": "How can I count the average separately for all rows", "body": "<p>make the counters in outer loop</p>\n\n<pre><code>int main()\n{\n    int r;\n\n    double c,value;\n    for (r=1; r&lt;11; r++)\n    {\n        int Count=0;\n        double sum=0;\n        double Average=0;  \n        for(c=1; c&lt;5; c++)\n        {\n\n            value=(rand()%10000)/100.0;\n\n            if (value&gt;=67.0)\n            {\n                Count++;\n                printf(\"%5.2f  \",value);\n            //    sumTotal=sumRow/sumCol;\n                sum += value;\n            }\n            else\n            {\n                 printf(\"       \");\n            }   \n        }\n\n        Average=sum/Count;\n        if(Average == 0){\n            printf(\"|     \");\n        }\n        else{\n            printf(\"| %6.2f \",Average);\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I commented out broken code.</p>\n"}], "owner": {"reputation": 29, "user_id": 6466951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7f804193871bd9cbe7c6399fadcc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Smith", "link": "https://stackoverflow.com/users/6466951/alex-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 37824176, "answer_count": 1, "score": -1, "last_activity_date": 1465950807, "creation_date": 1465949332, "last_edit_date": 1465950083, "question_id": 37824121, "link": "https://stackoverflow.com/questions/37824121/how-can-i-count-the-average-separately-for-all-rows", "title": "How can I count the average separately for all rows", "body": "<p>It's a basic program, but I need to find out how to calculate the average for each row separately. Should I use more counts or should I use another loop?</p>\n\n<pre><code>int main()\n{\n    int r;\n    int Count=0;\n    double sum=0;\n    double Average=0;\n    double c,value;\n    for (r=1; r&lt;11; r++)\n    {\n        for(c=1; c&lt;5; c++)\n        {\n            value=(rand()%10000)/100.0;\n\n            if (value&gt;=67.0)\n            {\n                Count++;\n                printf(\"%5.2f  \",value);\n                sumTotal=sumRow/sumCol;\n                sum += value;\n            }\n            else\n            {\n                 printf(\"       \");\n            }   \n        }\n\n        Average=sum/Count;\n        if(Average == 0){\n            printf(\"|     \");\n        }\n        else{\n            printf(\"| %6.2f \",Average);\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465949653, "post_id": 37823982, "comment_id": 63111511, "body": "It is good you want to learn. So now it is time to learn how to use the debugger. Step through the code and check the variables if they have the expected values."}, {"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465949898, "post_id": 37823982, "comment_id": 63111566, "body": "Thanks for the response. I will take a look at the debugger. They haven&#39;t really showed me in school how to use it , but i will start looking at it and figuring it out. I use the build log to determine some of my errors so far."}, {"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465949953, "post_id": 37823982, "comment_id": 63111582, "body": "On the debugger, do I type in a line of the code to scan it?"}, {"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465950184, "post_id": 37823982, "comment_id": 63111638, "body": "I&#39;m not quite sure how to use the debugger. Build log shows zero errors and zero warnings."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465950198, "post_id": 37823982, "comment_id": 63111643, "body": "Typically no. I have no idea which debugger you use. The user interfaces can differ quite a lot. But that is part of learning, isn&#39;t it?"}, {"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465950261, "post_id": 37823982, "comment_id": 63111665, "body": "I&#39;m using CodeBlocks"}, {"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465950527, "post_id": 37823982, "comment_id": 63111733, "body": "Do you see anything wrong with my code that I&#39;m trying to make the calculations with at the bottom?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465950603, "post_id": 37823982, "comment_id": 63111744, "body": "Code::Blocks is an IDE. Please understand this is not tutoring site. I think you wanted to learn? That includes you find out on your own."}, {"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465950749, "post_id": 37823982, "comment_id": 63111784, "body": "Stack Overflow is a privately held website, the flagship site of the Stack Exchange Network, created in 2008 by Jeff Atwood and Joel Spolsky. It was created to be a more open alternative to earlier Q&amp;A sites such as Experts-Exchange."}, {"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465950775, "post_id": 37823982, "comment_id": 63111795, "body": "I have questions, so far your answers are not helpful at all."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465951020, "post_id": 37823982, "comment_id": 63111849, "body": "You seem to have forgot to read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Rules are set by the community. I tried to help you. If you prefer complaining instead of showing some research on your own, fee free. But keep in mind, no one likes whining kids."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465951078, "post_id": 37823982, "comment_id": 63111871, "body": "Oh, and comments are not to answer. Read about that, too."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "edited": false, "score": 0, "creation_date": 1465954570, "post_id": 37824631, "comment_id": 63112582, "body": "Thanks a lot! I kind of see what i did wrong and how your code is working. I was close just had some of my logic backwards and I was missing another for loop. I really appreciate it."}], "tags": [], "owner": {"reputation": 78, "user_id": 5712794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1629531743977603/picture?type=large", "display_name": "Nikola Jokic", "link": "https://stackoverflow.com/users/5712794/nikola-jokic"}, "is_accepted": true, "score": 0, "last_activity_date": 1471447388, "last_edit_date": 1471447388, "creation_date": 1465953641, "answer_id": 37824631, "question_id": 37823982, "link": "https://stackoverflow.com/questions/37823982/using-an-array-to-calculate-and-store-the-percentage-increase-from-one-year-to-t/37824631#37824631", "title": "Using an array to calculate and store the percentage increase from one year to the next", "body": "<p>In the last for loop, you can't say <code>percentage[i]= (value[i+1] -value[i])/(float)value[i+1];</code> because you haven't initialized <code>value[i+1]</code> yet. Only thing you can do is to use backward indexing like <code>((float)value[i] - (float)value[i-1])/(float)value[i];</code>\nIn the case of the first calculation, it won't work but in the first calculation, you have 0% increase because it is the first year and you have nothing to compare with.</p>\n\n<hr>\n\n<p>Actually, try this. I think this will match your goal:</p>\n\n<pre><code>printf(\"\\n\\n\");\nfor (i = 0; i &lt; years; i++) {\n    value[i] = 0;\n    for(j = 0, sum = 0; j &lt; months; j++) value[i] += range[i][j];\n}\nfor(i = 0; i &lt; years-1; i++) {\n    percentage[i]= (value[i+1]-value[i])/(float)value[i+1];\n    printf(\"\\n The increase from %i to %i was: %.2f%% \", time[i], time[i+1], percentage[i]*100);\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5875827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/e75iX.jpg?s=128&g=1", "display_name": "RTriplett", "link": "https://stackoverflow.com/users/5875827/rtriplett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 37824631, "answer_count": 1, "score": 1, "last_activity_date": 1471447388, "creation_date": 1465948305, "question_id": 37823982, "link": "https://stackoverflow.com/questions/37823982/using-an-array-to-calculate-and-store-the-percentage-increase-from-one-year-to-t", "title": "Using an array to calculate and store the percentage increase from one year to the next", "body": "<p>I'm working on a program for my programming class in college. I got most of it to work properly,but the end loop i'm trying to use doesn't work right. I'm not quite sure whats going on. I like to learn more and figure out why it's doing this. My problem is at the end where I show the increase between years in a percentage. I'm trying to take the (year+1)-year/(year+1). Now I have my variables as integers and I want to cast my denominator to a float point. My answers kept coming up with 100.00%, -1.#J%, and 98.24% when I run the program. Below is a copy of what I got so far. An help will be gladly appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define years 4\n#define months 12\nint main(void)\n{\n    float percentage [4];\n    float answer = 0.0;\n    int i = 0, j = 0, n = 0, sum = 0;\n    int time[] = {2012,2013,2014,2015};\n    int value[years];\n    const char* name[]= {\"    JAN \",\" FEB \", \" MAR \", \" APR \", \" MAY \", \" JUN \", \" JUL  \",\"AUG \",\" SEP \",\" OCT \",\" NOV \",\" DEC \"};\n    int range[years][months] = {\n\n        { 5626, 5629, 5626, 5606, 5622, 5633, 5647, 5656, 5673, 5682, 5728, 5728},\n        { 5741, 5793, 5814, 5811, 5831, 5854, 5857, 5874, 5900, 5923, 5954, 5939},\n        { 5999, 6020, 6062, 6103, 6115, 6128, 6169, 6194, 6219, 6233, 6256, 6301},\n        { 6351, 6378, 6371, 6409, 6426, 6426, 6437, 6441, 6451, 6484, 6549, 6597}\n    };\n\n    printf(\"YEAR\");\n    for(n=0; n &lt; months; n++)\n        printf(\"%s\", name[n]);\n\n    for (i = 0; i &lt; years; i++) {\n        printf(\" \\n%i    \", time[i]);\n        for (j = 0; j &lt; months; j++)\n            printf(\"%2i \", range[i][j]);\n            printf(\"\\n\");\n    }\n\n    for (i = 0; i &lt; years; i++) {\n        for(j = 0, sum = 0; j &lt; months; j++)\n            sum += range[i][j];\n            printf(\"\\n This is the sum of months for %i: %i\", time[i], sum);\n\n\n    }\n    printf(\"\\n\\n\");\n    for (i = 0; i &lt; years-1; i++)\n    {\n        value[i] = 0;\n        for(j = 0, sum = 0; j &lt; months; j++)\n            {\n                value[i] += range[i][j];\n                percentage[i]= (value[i+1]-value[i])/(float)value[i+1];\n            }\n\n    printf(\"\\n The increase from %i to %i was: %.2f%% \", time[i], time[i+1], percentage[i]*100);\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1465947726, "post_id": 37823856, "comment_id": 63111070, "body": "<code>while (j &lt; size)</code> then <code>if (tab[j] &gt; tab[j + 1])</code>. Access to <code>tab[j+1]</code> is out of bounds for the last value of <code>j</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465947765, "post_id": 37823856, "comment_id": 63111078, "body": "You ran off the end of your array. And use <code>for</code> loops. <code>for(i=0;i&lt;size;i++)</code>."}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "edited": false, "score": 0, "creation_date": 1465948174, "post_id": 37823856, "comment_id": 63111176, "body": "and you just increases <code>i</code> and never do anything with it? how is that supposed to sort?"}, {"owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1465948179, "post_id": 37823856, "comment_id": 63111178, "body": "@jxh I&#39;m not allowed to use any other functions."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1465947750, "creation_date": 1465947750, "answer_id": 37823905, "question_id": 37823856, "link": "https://stackoverflow.com/questions/37823856/sort-int-array-got-killed-by-sigabot-in-c/37823905#37823905", "title": "sort int array, got killed by SIGABOT in c", "body": "<p>You are accessing the array one past its length by accessing <code>tab[j + 1]</code> when you merely made sure that <code>j &lt; size</code>. It is possible that <code>j == size</code> and thus <code>j</code> out of bounds. To fix this issue, compare <code>j + 1</code> against the limit:</p>\n\n<pre><code>while (j + 1 &lt; size) ...\n</code></pre>\n"}], "owner": {"reputation": 745, "user_id": 2562564, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef1939aba4fb7a820c0e96e4a7c53a70?s=128&d=identicon&r=PG&f=1", "display_name": "TenTen Peter", "link": "https://stackoverflow.com/users/2562564/tenten-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 37823905, "answer_count": 1, "score": 0, "last_activity_date": 1465947750, "creation_date": 1465947415, "question_id": 37823856, "link": "https://stackoverflow.com/questions/37823856/sort-int-array-got-killed-by-sigabot-in-c", "title": "sort int array, got killed by SIGABOT in c", "body": "<pre><code>void sort_int_tab(int *tab, unsigned int size);\n</code></pre>\n\n<p>I'm trying to write a function that must sort (in-place) the 'tab' int array, that contains exactly 'size'\nmembers, in ascending order.Doubles are preserved. When I run the code i get <code>SIGABOT</code>, How can I fix this?</p>\n\n<pre><code>void    sort_int_tab(int *tab, unsigned int size)\n{\n    unsigned int    i;\n    unsigned int    j;\n    int             tmp;\n\n    i = 0;\n    j = 0;\n    while (i &lt; size)\n    {\n        j = 0;\n        while (j &lt; size)\n        {\n            if (tab[j] &gt; tab[j + 1])\n            {\n                tmp = tab[j];\n                tab[j] = tab[j + 1];\n                tab[j + 1] = tmp;\n            }\n            j++;\n        }\n        i++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linear-algebra", "numerical-methods", "lapack", "blas"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1465947280, "post_id": 37823702, "comment_id": 63110980, "body": "Posting the values in this case is completely unnecessary, instead you should post how you <b>tried</b> to use <i>lapack</i> to solve the problem. Also, if you know that the result is wrong it has to be because you can solve this with a different method, why do you want it in <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>?"}, {"owner": {"reputation": 9313, "user_id": 1957265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b616537ad7664d6f0d24c2b6ff098098?s=128&d=identicon&r=PG", "display_name": "kangshiyin", "link": "https://stackoverflow.com/users/1957265/kangshiyin"}, "edited": false, "score": 1, "creation_date": 1465966982, "post_id": 37823702, "comment_id": 63115790, "body": "You are asking a math question not a programming question."}], "answers": [{"tags": [], "owner": {"reputation": 9313, "user_id": 1957265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b616537ad7664d6f0d24c2b6ff098098?s=128&d=identicon&r=PG", "display_name": "kangshiyin", "link": "https://stackoverflow.com/users/1957265/kangshiyin"}, "is_accepted": false, "score": 1, "last_activity_date": 1465968453, "creation_date": 1465968453, "answer_id": 37826819, "question_id": 37823702, "link": "https://stackoverflow.com/questions/37823702/solving-ill-conditioned-system-of-linear-equations-with-lapackco/37826819#37826819", "title": "Solving ill-conditioned system of linear equations with Lapack&amp;co", "body": "<p>Solving ill-coditioned linear equations is generally hard. At least you could not use those one-step LAPACK APIs to get an answer with satisfied numerical error.</p>\n\n<p>As a good start, you could use truncated SVD method to get a more numerically stable result. </p>\n\n<p><a href=\"https://en.m.wikipedia.org/wiki/Linear_least_squares_(mathematics)\" rel=\"nofollow\">https://en.m.wikipedia.org/wiki/Linear_least_squares_(mathematics)</a> </p>\n\n<blockquote>\n  <p>This method is the most computationally intensive, but is particularly useful if the normal equations matrix, XTX, is very ill-conditioned (i.e. if its condition number multiplied by the machine's relative round-off error is appreciably large). In that case, including the smallest singular values in the inversion merely adds numerical noise to the solution. This can be cured with the truncated SVD approach, giving a more stable and exact answer, by explicitly setting to zero all singular values below a certain threshold and so ignoring them, a process closely related to factor analysis.</p>\n</blockquote>\n\n<p>More effective methods may involve making the matrix well-conditioned before solving by finding a pre conditioning matrix. You need to have some understanding on the structure of the original matrix. You could find some more ideas in the following discussion. </p>\n\n<p><a href=\"https://www.researchgate.net/post/How_can_I_solve_an_ill-conditioned_linear_system_of_equations\" rel=\"nofollow\">https://www.researchgate.net/post/How_can_I_solve_an_ill-conditioned_linear_system_of_equations</a></p>\n"}], "owner": {"reputation": 669, "user_id": 1584773, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d918565ab7cefaa8abaec96c60ff4281?s=128&d=identicon&r=PG", "display_name": "user1584773", "link": "https://stackoverflow.com/users/1584773/user1584773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1465992176, "creation_date": 1465946488, "last_edit_date": 1465992176, "question_id": 37823702, "link": "https://stackoverflow.com/questions/37823702/solving-ill-conditioned-system-of-linear-equations-with-lapackco", "title": "Solving ill-conditioned system of linear equations with Lapack&amp;co", "body": "<p>I have the following 11x11 linear system of equations Ax = b with:</p>\n\n<pre><code>A = {\n{1.0000000000000000, 8.0000000000000000, 6.0000000000000000, 12.0000000000000000, 24.0000000000000000, 24.0000000000000000, 8.0000000000000000, 6.0000000000000000, 24.0000000000000000, 24.0000000000000000, 24.0000000000000000},\n{4.5999999999999996, 41.8531411531233601, 33.0479488942856037, 87.8349057232554173, 149.3783917109033439, 195.3689938163366833, 121.0451669808013690, 48.8422484540841708, 223.6406089026404516, 851.8470736603384239, 269.3015780207464900},\n{21.1599999999999966, 218.9606780479085160, 182.0278210198854936, 642.9142219510971472, 929.7459962556697519, 1590.3768227003254196, 1831.4915561762611560, 397.5942056750813549, 2083.9634145976574473, 30235.1432043200838962, 3021.8058301860087340},\n{97.3359999999999701, 1145.5240206653393216, 1002.6076877338904296, 4705.8591727678940515, 5786.8317341801457587, 12946.2633183243797248, 27711.6501551604087581, 3236.5658295810949312, 19419.1186238102454809, 1073154.9275125553831458, 33907.3782725576675148},\n{447.7455999999998539, 5992.9723163999815370, 5522.3546042079124163, 34444.8913989153879811, 36017.8173980603314703, 105387.4349242659372976, 419295.1650431178859435, 26346.8587310664843244, 180954.3130575636751018, 38090161.8577392920851707, 380471.2698060897528194},\n{0.0000000000000000, 34.2801357124991952, 168.4702728821191613, 2101.6181209908259007, 1236.1435394200643714, 6631.0420254749351443, 38374.2674650820554234, 4069.0485156323466072, 28291.8793721561523853, 7044717.1197200166061521, 60211.4334496619121637},\n{2059.6297599999993508, 31353.0895356311411888, 30417.0821226643129194, 252121.9823892920394428, 224178.4848274685500655, 857893.2134182706940919, 6344206.6583608603104949, 214473.3033545676735230, 1686197.1981563565786928, 1351958038.0734937191009521, 4269229.7229307144880295},\n{0.0000000000000000, 179.3414198404317403, 927.9328280691040618, 15382.9524602928686363, 7693.8805767663707229, 53979.1670196200575447, 580627.4516345988959074, 33123.5797620395824197, 263633.8804078772664070, 250042569.2999326586723328, 675626.4184535464737564},\n{0.0000000000000000, 938.2502198978935439, 5111.0461132262771571, 112596.6815912620077142, 47887.4794405465727323, 439410.6478194649680518, 8785268.3545934017747641, 269638.3520710353623144, 2456635.0642409822903574, 8874917956.1941699981689453, 7581135.8600852200761437},\n{0.0000000000000000, 938.2502198978935439, 0.0000000000000000, 56298.3407956310038571, 23943.7397202732863661, 319571.3802323381532915, 8785268.3545934017747641, 0.0000000000000000, 269630.6777825467870571, 3293783983.7421655654907227, 1735440.7390556528698653},\n{0.0000000000000000, 70.9608494071368625, 1546.2151390406352220, 34063.2210755480555235, 13279.8613116998949408, 129911.1650312914862297, 2657756.2850107550621033, 183537.2854802548536099, 1654054.3836708476301283, 5487391301.6329326629638672, 5049794.3807012736797333}\n};\n\n\nb = {1, 6.167551546217714, 39.66265463865314, 267.9960092725794, 1918.2310370808632, 137.49061855461255, 14662.396462231256, 1216.4598834815756, 11424.520672986631, 3808.17355766221, 6082.299417407878};\n</code></pre>\n\n<p>The matrix is clearly ill-conditioned, although the correct solution can be found with mathematica:</p>\n\n<pre><code>x = {0.0775277, 0.00771443, 0.087553, 0.0208838, 8.47931*1e-7, 0.00197285, 0.0000611365, 0.00187375, 0.000283606, 3.82771*1e-9, 0.000788588};\n</code></pre>\n\n<p>I now want to solve the system using this and many other similar matrices inside a C program.\nI have tried almost every lapack function for solving a linear system of equations, in particular:</p>\n\n<ul>\n<li>dgesv</li>\n<li>dsgesv</li>\n<li>dgels</li>\n<li>dgelss</li>\n<li>dgelsy</li>\n</ul>\n\n<p>but they all give severely wrong results.</p>\n\n<p>At this point I don't expect to have any typo / mistake from a programming point of view, since trying with well-conditioned matrices I get correct results.\nI guess it's something conceptually or maybe I have to use other tools.. Is there anything I can do to find get the correct solution with some routine from mathematical libraries?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 2, "creation_date": 1465946412, "post_id": 37823650, "comment_id": 63110748, "body": "<code>[j-1]</code> - but <code>j</code> starts at 0! Not to mention apart from <code>[0][0]</code> <code>forest</code> is uninitialized. What you have looks massively over complicated (and quite buggy) just to get a &quot;checkerboard&quot;."}, {"owner": {"reputation": 125, "user_id": 5451893, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0e27598e211a00aa9b619ee4de9c4616?s=128&d=identicon&r=PG&f=1", "display_name": "Tam Lam", "link": "https://stackoverflow.com/users/5451893/tam-lam"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1465946635, "post_id": 37823650, "comment_id": 63110812, "body": "forest is initialized in main function."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465946654, "post_id": 37823650, "comment_id": 63110820, "body": "To make a checkerboard: <code>forest[i][j] = (i+j)&amp;1 ? &#39;T&#39; : &#39; &#39;;</code>"}, {"owner": {"reputation": 125, "user_id": 5451893, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0e27598e211a00aa9b619ee4de9c4616?s=128&d=identicon&r=PG&f=1", "display_name": "Tam Lam", "link": "https://stackoverflow.com/users/5451893/tam-lam"}, "edited": false, "score": 0, "creation_date": 1465946781, "post_id": 37823650, "comment_id": 63110857, "body": "can you further explain (i+j)&amp;1 in forest[i][j] = (i+j)&amp;1"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465946985, "post_id": 37823650, "comment_id": 63110919, "body": "<code>(i+j)&amp;1</code> checks if <code>i+j</code> is an odd number. To understand why that makes a checkerboard, draw a 4x4 grid on a sheet of paper. Write the i,j values in each square, and compute the sum. Note where the sums are odd."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465947017, "post_id": 37823650, "comment_id": 63110931, "body": "@TamLam: How about looking up the operators yourself? Would be a good exercise and you can better explain to your tutor."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1465959251, "post_id": 37823650, "comment_id": 63113631, "body": "@TamLam it&#39;s a cheesy way of writing <code>(i + j) % 2</code>"}], "answers": [{"tags": [], "owner": {"reputation": 223, "user_id": 3127174, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XB8Nh.jpg?s=128&g=1", "display_name": "James Shewey", "link": "https://stackoverflow.com/users/3127174/james-shewey"}, "is_accepted": false, "score": 1, "last_activity_date": 1465955840, "last_edit_date": 1495541308, "creation_date": 1465947134, "answer_id": 37823808, "question_id": 37823650, "link": "https://stackoverflow.com/questions/37823650/2-dimensional-array-manipulation/37823808#37823808", "title": "2 dimensional array manipulation", "body": "<p>I think this might have to do with how the data in the array is stored. In memory, the data is just stored <a href=\"https://stackoverflow.com/questions/5920944/how-are-3d-arrays-stored-in-c\">sequentially</a>. Since <a href=\"https://stackoverflow.com/questions/3473675/are-negative-array-indexes-allowed-in-c\">negative array indexes are allowed in C</a> the functional outcome in your case is that forest[1][-1] points to the same data located in cell forest[0][9], which you will note is 'T'.</p>\n\n<p>Because forest[0][9] (aka forest[1][-1]) is 'T', you fail this test</p>\n\n<pre><code>if(forest[i][j-1]!='T' &amp;&amp; forest[i-1][j]!= 'T')\n</code></pre>\n\n<p>Which means that a ' ' is registered in cell forest[1][0] instead. Prevent negative index values, and you should be good.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1465952029, "last_edit_date": 1465952029, "creation_date": 1465951551, "answer_id": 37824385, "question_id": 37823650, "link": "https://stackoverflow.com/questions/37823650/2-dimensional-array-manipulation/37824385#37824385", "title": "2 dimensional array manipulation", "body": "<p>You may be over-thinking the logic you are using to fill the <code>forest</code> array in <code>plant_forest</code>. All you need to stagger the <code>'T'</code> and <code>' '</code> elements used to fill <code>forest</code> is a check on whether your outer loop index <code>'i'</code> is <em>odd or even</em> and start filling with either a <code>'T'</code> or <code>' '</code> based on the result. Then just <em>toggle</em> between <code>'T'</code> and <code>' '</code> for each <code>'j'</code> index. For example:</p>\n\n<pre><code>int plant_forest (char (*forest)[SIZE])\n{\n    if (!forest) return 1;              /* validate pointer */\n    int i, j;\n\n    for (i = 0; i &lt; SIZE; i++) {\n        int t = i &amp; 1;\n        for (j = 0; j &lt; SIZE; j++)   /* simple toggle 'T' or ' ' */\n            forest[i][j] = t ? 'T' : ' ', t ^= 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>You can test the results with a simple bit of code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define SIZE 10\n\nint plant_forest (char (*forest)[SIZE])\n{\n    if (!forest) return 1;              /* validate pointer */\n    int i, j;\n\n    for (i = 0; i &lt; SIZE; i++) {\n        int t = i &amp; 1;\n        for (j = 0; j &lt; SIZE; j++)   /* simple toggle 'T' or ' ' */\n            forest[i][j] = t ? 'T' : ' ', t ^= 1;\n    }\n    return 0;\n}\n\nint main (void) {\n\n    char arr[SIZE][SIZE] = {{0}};\n\n    if (!plant_forest (arr)) {\n        int i, j;\n        for (i = 0; i &lt; SIZE; i++) {\n            for (j = 0; j &lt; SIZE; j++)\n                putchar (arr[i][j]);\n            putchar ('\\n');\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/plant\n T T T T T\nT T T T T\n T T T T T\nT T T T T\n T T T T T\nT T T T T\n T T T T T\nT T T T T\n T T T T T\nT T T T T\n</code></pre>\n\n<p>If you have any questions, or if I misunderstood your question, just let me know. (I'll leave it to you to fill in all the additional <code>'|'</code> formatting your may like).</p>\n\n<p>You can even save a line of code as mentioned in the comments by anding the sum of <code>i</code> and <code>j</code>, in <code>plant_forest</code> to choose between assigning <code>'T'</code> or <code>' '</code> e.g.</p>\n\n<pre><code>    for (i = 0; i &lt; SIZE; i++)\n        for (j = 0; j &lt; SIZE; j++)   /* simple toggle 'T' or ' ' */\n            forest[i][j] = (i + j) &amp; 1 ? 'T' : ' ';\n</code></pre>\n\n<p>Either way will insure your <code>forest</code> array is populated correctly.</p>\n"}], "owner": {"reputation": 125, "user_id": 5451893, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0e27598e211a00aa9b619ee4de9c4616?s=128&d=identicon&r=PG&f=1", "display_name": "Tam Lam", "link": "https://stackoverflow.com/users/5451893/tam-lam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465955840, "creation_date": 1465946205, "question_id": 37823650, "link": "https://stackoverflow.com/questions/37823650/2-dimensional-array-manipulation", "title": "2 dimensional array manipulation", "body": "<p>I am trying to create a (10x10) 2 dimensional character array to store either ' ' and 'T' and display it like this</p>\n\n<pre><code>+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| |T| |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| |T| |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| |T| |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| |T| |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| |T| |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n</code></pre>\n\n<p>The function I wrote:</p>\n\n<pre><code>  int plant_forest(char forest[][SIZE])\n{\n    int i,j;\n    forest[0][0] = ' ';\n    for(i = 0;i&lt;SIZE;i++)\n    {\n        for(j=0;j&lt;SIZE;j++)\n        {\n            if(forest[i][j]!= forest[0][0])\n            {\n                if(forest[i][j-1]!='T' &amp;&amp; forest[i-1][j]!= 'T')\n                {\n                    forest[i][j] = 'T';\n                }\n                else\n                {\n                    forest[i][j] = ' ';\n                }\n\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The result I got was slightly different.</p>\n\n<pre><code>+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n| | |T| |T| |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n|T| | |T| |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n| |T| | |T| |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| | |T| |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| | |T| |T| |\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| |T| | |T| |T|\n+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| | |T| |\n+-+-+-+-+-+-+-+-+-+-+\n|T| |T| |T| |T| | |T|\n+-+-+-+-+-+-+-+-+-+-+\n| |T| |T| |T| |T| | |\n+-+-+-+-+-+-+-+-+-+-+\n</code></pre>\n\n<p>I checked the logic and couldn't find anything wrong. Except from i-1 and j-1 could be negative number. But how would this effecting the execution ? </p>\n\n<p>Just for reference, I will include the printing function here. But I have already checked and sure that there was no error in this function</p>\n\n<pre><code>void printBoard(char forest[][SIZE])\n{\n    int i,j;\n\n        printf(\"+-+-+-+-+-+-+-+-+-+-+\\n\");\n        for(i = 0; i&lt;SIZE;i++)\n        {\n            for(j = 0;j&lt;SIZE;j++)\n            {\n                printf(\"|%c\",forest[i][j]);\n            }\n            printf(\"|\\n\");\n            printf(\"+-+-+-+-+-+-+-+-+-+-+\\n\");\n\n        }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc", "large-files", "large-file-support"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1465945428, "post_id": 37823455, "comment_id": 63110461, "body": "What platform are you programming on? Are you programming against the glibc?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1465945483, "post_id": 37823455, "comment_id": 63110479, "body": "<code>_LARGEFILE_SOURCE</code> is obsolete anyways, why do you think you need it? Legacy code?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1465945539, "post_id": 37823455, "comment_id": 63110495, "body": "@BaummitAugen It is not obsolete. If you compile a C program on i386 Linux, you get a 32 bit <code>off_t</code> by default. <code>_LARGEFILE_SOURCE</code> is kinda needed."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1465945626, "post_id": 37823455, "comment_id": 63110516, "body": "@FUZxxl It is obsolete if you just use <code>#define _FILE_OFFSET_BITS 64</code> instead."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1465945667, "post_id": 37823455, "comment_id": 63110533, "body": "@DietrichEpp Which is a non-standard feature-test macro as opposed to the standard <code>_LARGEFILE_SOURCE</code>."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1465945706, "post_id": 37823455, "comment_id": 63110545, "body": "Cannot reproduce with g++6 on Arch btw."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1465945792, "post_id": 37823455, "comment_id": 63110570, "body": "@BaummitAugen: You are probably compiling for 64-bit."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1465945832, "post_id": 37823455, "comment_id": 63110582, "body": "@DietrichEpp Indeed, I was not aware that mattered. Thx."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1465945968, "post_id": 37823455, "comment_id": 63110626, "body": "@FUZxxl <code>_FILE_OFFSET_BITS 64</code> is standard POSIX afaik, just like <code>_LARGEFILE_SOURCE</code>. Though the latter is called historical and <i>&quot;New programs           should not employ this macro; defining _XOPEN_SOURCE as just           described or defining _FILE_OFFSET_BITS with the value 64 is the           preferred mechanism to achieve the same result.&quot;</i> <a href=\"http://man7.org/linux/man-pages/man7/feature_test_macros.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/feature_test_macros.7.html</a>"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1465947292, "post_id": 37823455, "comment_id": 63110984, "body": "Related to: <a href=\"http://stackoverflow.com/q/5378778/315052\">stackoverflow.com/q/5378778/315052</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465947461, "post_id": 37823455, "comment_id": 63111017, "body": "Names starting with underscore are implementation-specific and reserved for internal use. You must not use them unless explicitly allowed by the implementation. I doubt the documentation allows this. Also C and C++ are different languages. You would not expect <code>for c in &quot;12345&quot;:</code> to be legal in C either."}], "answers": [{"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1465945597, "post_id": 37823520, "comment_id": 63110504, "body": "That&#39;s a really weird design decision."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1465945661, "post_id": 37823520, "comment_id": 63110530, "body": "@FUZxxl: I would probably use the word &quot;pathological&quot; but &quot;weird&quot; works."}, {"owner": {"reputation": 11007, "user_id": 22244, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5fecd49826c31a343863e90632b9a7ae?s=128&d=identicon&r=PG", "display_name": "Michael Labb&#233;", "link": "https://stackoverflow.com/users/22244/michael-labb%c3%a9"}, "edited": false, "score": 0, "creation_date": 1465947214, "post_id": 37823520, "comment_id": 63110970, "body": "Brutal choice!  I just verified this is the case and then accepted your answer."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 6, "last_activity_date": 1465947566, "last_edit_date": 1465947566, "creation_date": 1465945476, "answer_id": 37823520, "question_id": 37823455, "link": "https://stackoverflow.com/questions/37823455/why-is-largefile-source-defined-in-stdio-h-when-compiling-with-g-but-not-gcc/37823520#37823520", "title": "Why is _LARGEFILE_SOURCE defined in stdio.h when compiling with g++ but not gcc?", "body": "<p>Because g++ defines <code>_GNU_SOURCE</code>, which basically implies all other feature macros, such as <code>_LARGEFILE_SOURCE</code>.  These additional macros are defined when the <code>&lt;features.h&gt;</code> header is included, and most system header files include <code>&lt;features.h&gt;</code> very early in the file.  The fact that <code>_GNU_SOURCE</code> is predefined is a continual source of frustration for people who want to write portable C++ code.</p>\n\n<p>I believe you can simply:</p>\n\n<pre><code>#undef _GNU_SOURCE\n</code></pre>\n\n<p>However, this will break libstdc++.  Ouch!  What a pain!  This all stems from one of the biggest design flaws in C++, which is the fact that <code>#include</code> is basically textual inclusion.  Since most of libstdc++ is defined (not just declared!) in header files, this means that they contaminate your program with <code>_GNU_SOURCE</code>.</p>\n\n<p>If you need to access an interface hidden by <code>_GNU_SOURCE</code> (such as <code>strerror_r</code>, for example, which is completely broken by <code>_GNU_SOURCE</code>) then you can access those interfaces only from files which don't use any libstdc++ headers.</p>\n\n<p>This is only a problem with libstdc++ as far as I know, so I think you can also avoid the problem by using libc++ or something else like that.</p>\n"}], "owner": {"reputation": 11007, "user_id": 22244, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5fecd49826c31a343863e90632b9a7ae?s=128&d=identicon&r=PG", "display_name": "Michael Labb&#233;", "link": "https://stackoverflow.com/users/22244/michael-labb%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 37823520, "answer_count": 1, "score": 0, "last_activity_date": 1530008562, "creation_date": 1465945101, "last_edit_date": 1530008562, "question_id": 37823455, "link": "https://stackoverflow.com/questions/37823455/why-is-largefile-source-defined-in-stdio-h-when-compiling-with-g-but-not-gcc", "title": "Why is _LARGEFILE_SOURCE defined in stdio.h when compiling with g++ but not gcc?", "body": "<p>If the following code is compiled with gcc lfs.c -o lfs, it prints nothing.  However, if it is compiled with g++ lfs.c -o lfs, it prints \"_LARGEFILE_SOURCE defined by stdio.h!\".</p>\n\n<pre><code>#ifdef _LARGEFILE_SOURCE\nint largefile_defined_at_start = 1;\n#else\nint largefile_defined_at_start = 0;\n#endif\n\n// This defines _LARGEFILE_SOURCE, but only in C++!\n#include &lt;stdio.h&gt;\n\nint main(void) {\n#ifdef _LARGEFILE_SOURCE\n  if (!largefile_defined_at_start)\n    printf(\"_LARGEFILE_SOURCE defined by stdio.h!\");\n#endif\n  return 0;\n}\n</code></pre>\n\n<p>In either case, _LARGEFILE_SOURCE is not defined by the compiler:</p>\n\n<pre><code>gcc -dM -E - &lt; /dev/null |grep _LARGEFILE_SOURCE |wc -l\n0\ng++ -dM -E - &lt; /dev/null |grep _LARGEFILE_SOURCE |wc -l\n0\n</code></pre>\n\n<p>Why is stdio.h defining _LARGEFILE_SOURCE when GCC is invoked via the g++ frontend?</p>\n"}, {"tags": ["c", "linux", "mutex", "semaphore"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1465944827, "post_id": 37823324, "comment_id": 63110293, "body": "What &quot;shell&quot; mutex/semaphore mechanism in particular are you talking about? shells don&#39;t provide that functionality in general. Shells do provide file locking which can be used to achieve some of the functionality of mutexes. But it is not clear what you are referring to exactly."}, {"owner": {"reputation": 19, "user_id": 5601236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-nX3qQsHY-o4/AAAAAAAAAAI/AAAAAAAAAFc/R4-nQstqoY4/photo.jpg?sz=128", "display_name": "Dark Inspiration", "link": "https://stackoverflow.com/users/5601236/dark-inspiration"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1465945618, "post_id": 37823324, "comment_id": 63110510, "body": "My bad.. It&#39;s C not shell"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1465945774, "post_id": 37823324, "comment_id": 63110566, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12251701/semaphores-and-mutex-for-thread-and-process-synchronization\">Semaphores and Mutex for Thread and Process Synchronization</a>"}, {"owner": {"reputation": 19, "user_id": 5601236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-nX3qQsHY-o4/AAAAAAAAAAI/AAAAAAAAAFc/R4-nQstqoY4/photo.jpg?sz=128", "display_name": "Dark Inspiration", "link": "https://stackoverflow.com/users/5601236/dark-inspiration"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1465945982, "post_id": 37823324, "comment_id": 63110634, "body": "Not quite.. I saw that thread before didn&#39;t help.."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1465946890, "post_id": 37823324, "comment_id": 63110891, "body": "It didn&#39;t help because? It answers exactly: &quot;do they synchronize both threads and processes or only threads, and only processes&quot;. If you say more precisely why it didn&#39;t help then someone can address the gap."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 1, "last_activity_date": 1465947098, "last_edit_date": 1465947098, "creation_date": 1465946227, "answer_id": 37823655, "question_id": 37823324, "link": "https://stackoverflow.com/questions/37823324/semaphores-and-mutex-behaviour-doubts/37823655#37823655", "title": "Semaphores and Mutex behaviour doubts", "body": "<p><a href=\"http://linux.die.net/man/2/semget\" rel=\"nofollow\">SysV IPC semaphores</a> synchronize between processes.</p>\n\n<p>With POSIX semaphores, you can choose via the pshared argument to <a href=\"http://linux.die.net/man/3/sem_init\" rel=\"nofollow\">sem_init(3)</a> With pshared=1, you can synchronize among all tasks (possibly both threads and processes) that have access to the region of shared memory that you've placed the semaphore at.</p>\n\n<p><a href=\"http://linux.die.net/man/3/pthread_mutex_lock\" rel=\"nofollow\">Pthread mutexes</a> work on threads.\n(Pthreads also has condition variables which are functionally equivalent to semaphores).</p>\n\n<p>The thread versions can have better performance as it's the process that can manage the shared counter, whereas with semaphores, the kernel has to do it. </p>\n\n<p>Synchronization is about determining whether a task can go on or has to wait in coordination with other tasks, and it involves communication, e.g., via incrementing and decrementing semaphores, which are shared among tasks.</p>\n"}], "owner": {"reputation": 19, "user_id": 5601236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-nX3qQsHY-o4/AAAAAAAAAAI/AAAAAAAAAFc/R4-nQstqoY4/photo.jpg?sz=128", "display_name": "Dark Inspiration", "link": "https://stackoverflow.com/users/5601236/dark-inspiration"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 37823655, "answer_count": 1, "score": 1, "last_activity_date": 1465948343, "creation_date": 1465944282, "last_edit_date": 1465948343, "question_id": 37823324, "link": "https://stackoverflow.com/questions/37823324/semaphores-and-mutex-behaviour-doubts", "title": "Semaphores and Mutex behaviour doubts", "body": "<p>Do semaphores and mutexes synchronize both threads and processes, or only threads, or only processes?</p>\n\n<p>Edit: my mistake it's C, not shell. Since I programmed through the shell I mistook it. And one more thing: are communication and synchronization the same? </p>\n"}, {"tags": ["c", "gcc", "linker", "clang", "static-libraries"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1465944247, "post_id": 37823271, "comment_id": 63110148, "body": "First thing to notice is that that&#39;s a <i>linker</i> error -- it doesn&#39;t mean it failed to compile."}, {"owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1465944331, "post_id": 37823271, "comment_id": 63110175, "body": "@Dmitri Yes, I&#39;ll fix the title."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1465944433, "post_id": 37823271, "comment_id": 63110199, "body": "<code>-lgcc</code> must go at the end. Gcc processes libraries at the point it encounters them, so they are only used to resolve symbols from previously mentioned objects."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1465944492, "post_id": 37823271, "comment_id": 63110216, "body": "Why do you think it is? It might be required for linking, but not for compilation! And even for the latter it is not required."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1465944870, "post_id": 37823271, "comment_id": 63110308, "body": "Does <a href=\"http://stackoverflow.com/a/29694977/417501\">this answer</a> answer your question? If it does, I would close your question as a duplicate. If it doesn&#39;t, it might help to highlight the things that are different in your question."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1465944585, "post_id": 37823334, "comment_id": 63110245, "body": "&quot;Thus, it is required to link against the libc in order to run any C program.&quot; - Sorry, but that is plain wrong! It depends on the environment if it is required. On most embedded systems it is not and there is not even a standard library to link with."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465944638, "post_id": 37823334, "comment_id": 63110258, "body": "@Olaf An embedded system without a C standard library is not in compliance with the standard. Anyway, I reworded the answer slightly. Is this acceptable to you?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1465944698, "post_id": 37823334, "comment_id": 63110266, "body": "I honestly think my embedded code is very well &quot;ordinary C programs&quot;. In fact,  don&#39;t find that term in the standard."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1465944747, "post_id": 37823334, "comment_id": 63110275, "body": "It very well is! Please read the standard <b>carefully</b> (translation and execution environment)."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465944799, "post_id": 37823334, "comment_id": 63110286, "body": "@Olaf The standard specifies that the standard library must be available even in free-standing environments (except for those functions that do not have to be available). An implementation of the C programming language that does not provide this standard library is not in compliance with the standard. Programs written for such an environment are certainly not ordinary."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1465945013, "post_id": 37823334, "comment_id": 63110356, "body": "A freestanding environment is not required to provide the standard library per se, but only specific <b>headers</b> which do not declare any objects/(functions with external linkage. Briefly: there is nothing to link for a freestanding implementation, as these headers only provide types, and macros."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465945123, "post_id": 37823334, "comment_id": 63110381, "body": "Actually gcc <b>is</b> a freestanding implementation. It does not provide the standard library even for Linux. The glibc is a seperate project of the GCC (that name has two meanings). Alternatives exist."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465945214, "post_id": 37823334, "comment_id": 63110405, "body": "@Olaf You convinced me. I hope the updated wording is appropriate."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465945386, "post_id": 37823334, "comment_id": 63110450, "body": "As a proud embedded systems engineer (whatever that means;-), I cannot accept my primary field of work is something abnormal. Less as these outnumber PCs etc. by decades. How about deleting the answer and let time delete the question as dup (hope it does delete, does it?)"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1465945198, "last_edit_date": 1495540370, "creation_date": 1465944341, "answer_id": 37823334, "question_id": 37823271, "link": "https://stackoverflow.com/questions/37823271/why-is-stdlib-required-to-link-programs/37823334#37823334", "title": "Why is stdlib required to link programs?", "body": "<p><code>_start</code> is the entry point of the program, cf. <a href=\"https://stackoverflow.com/a/29694977/417501\">this answer</a>. The libc contains a little stub that reads the command line arguments off the place where the operating system puts them and then calls <code>main</code>. Thus, it is required to link against the libc in order to run a normal C program on a normal platform.</p>\n\n<p>You can try to write a program without the libc, but then you have to provide your own <code>_start</code>. You can't do much though, you can't even return as there is nothing you return to. Your only option is to use assembly to painstakingly recreate the parts of the libc you need, like the <code>_exit</code> function.</p>\n"}], "owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "closed_date": 1465945244, "accepted_answer_id": 37823334, "answer_count": 1, "score": 4, "last_activity_date": 1465945198, "creation_date": 1465943952, "last_edit_date": 1465944587, "question_id": 37823271, "link": "https://stackoverflow.com/questions/37823271/why-is-stdlib-required-to-link-programs", "closed_reason": "Duplicate", "title": "Why is stdlib required to link programs?", "body": "<p>Take the following C program:  </p>\n\n<pre><code>int main(){}\n</code></pre>\n\n<p>It's not using anything from the C standard library.<br>\nI assumed we could disable linkage through <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html\" rel=\"nofollow\">-nostdlib</a>.  </p>\n\n<p>However, this results in the following error:  </p>\n\n<pre><code>$ gcc -nostdlib -o main main.c\n/usr/bin/ld: warning: cannot find entry symbol _start; defaulting to 0000000000400150\n</code></pre>\n\n<p>Can someone clarify what the <code>_start</code> symbol is and who is responsible for providing it?<br>\nHow would one go about using  <code>-nostdlib</code>?  </p>\n\n<hr>\n\n<p>Per the docs, I have also tried: </p>\n\n<pre><code>$ gcc -nostdlib -o main main.c -lgcc\n</code></pre>\n\n<p>Same behaviour is seen with clang.</p>\n"}, {"tags": ["python", "c", "python-c-extension"], "comments": [{"owner": {"reputation": 3966, "user_id": 2132213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31de75b6e3603efbc437ab3475a757d?s=128&d=identicon&r=PG", "display_name": "Nick Matteo", "link": "https://stackoverflow.com/users/2132213/nick-matteo"}, "edited": false, "score": 2, "creation_date": 1465949358, "post_id": 37823232, "comment_id": 63111433, "body": "<code>int</code>s and <code>float</code>s are immutable in Python. So no, they cannot be modified, period."}, {"owner": {"reputation": 1091, "user_id": 5302241, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b58e25a907ac8e47c48204ba7e7a45f?s=128&d=identicon&r=PG&f=1", "display_name": "rxu", "link": "https://stackoverflow.com/users/5302241/rxu"}, "reply_to_user": {"reputation": 3966, "user_id": 2132213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31de75b6e3603efbc437ab3475a757d?s=128&d=identicon&r=PG", "display_name": "Nick Matteo", "link": "https://stackoverflow.com/users/2132213/nick-matteo"}, "edited": false, "score": 0, "creation_date": 1465993707, "post_id": 37823232, "comment_id": 63132058, "body": "I searched online and found that is quite true. is it possible to pass a pointer to the int/flow variable into the function? That way, can the function get and modify the value that the pointer points to? Or this (stackoverflow.com/questions/8056130/immutable-vs-mutable-ty&zwnj;&#8203;pes) can work?"}, {"owner": {"reputation": 3966, "user_id": 2132213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31de75b6e3603efbc437ab3475a757d?s=128&d=identicon&r=PG", "display_name": "Nick Matteo", "link": "https://stackoverflow.com/users/2132213/nick-matteo"}, "edited": false, "score": 0, "creation_date": 1465997957, "post_id": 37823232, "comment_id": 63135263, "body": "No. The value cannot be changed. In Python, there is a single <code>int</code> object with the value 3. If you do any operation resulting in 3, this object is returned. If somehow you did manage to access the memory location and change its contents to, say, 4, then 1+2 would be 4 everywhere. This would be bad."}], "answers": [{"comments": [{"owner": {"reputation": 1091, "user_id": 5302241, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b58e25a907ac8e47c48204ba7e7a45f?s=128&d=identicon&r=PG&f=1", "display_name": "rxu", "link": "https://stackoverflow.com/users/5302241/rxu"}, "edited": false, "score": 0, "creation_date": 1465993499, "post_id": 37823272, "comment_id": 63131916, "body": "Thank you for the pointer. How to write a c extension that mutates the objects passed to the function? Like, taking an int object, and then mutate the object?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 1091, "user_id": 5302241, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b58e25a907ac8e47c48204ba7e7a45f?s=128&d=identicon&r=PG&f=1", "display_name": "rxu", "link": "https://stackoverflow.com/users/5302241/rxu"}, "edited": false, "score": 0, "creation_date": 1466006569, "post_id": 37823272, "comment_id": 63141732, "body": "@rxu: Python ints are not mutable."}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1465943966, "creation_date": 1465943966, "answer_id": 37823272, "question_id": 37823232, "link": "https://stackoverflow.com/questions/37823232/writing-a-python-c-extension-that-modifies-argument/37823272#37823272", "title": "Writing a python c extension that modifies argument", "body": "<blockquote>\n  <p>I want to write a c extension with a function that modifies its argument. Is that possible?</p>\n</blockquote>\n\n<p>Only to the extent that it's possible with an ordinary function. You can mutate the objects passed to you, if they're mutable, but you can't reassign any variables used to pass you those objects. The C API doesn't let you get around this.</p>\n\n<p>The function you want to write won't work.</p>\n"}], "owner": {"reputation": 1091, "user_id": 5302241, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2b58e25a907ac8e47c48204ba7e7a45f?s=128&d=identicon&r=PG&f=1", "display_name": "rxu", "link": "https://stackoverflow.com/users/5302241/rxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 2, "accepted_answer_id": 37823272, "answer_count": 1, "score": 1, "last_activity_date": 1465943966, "creation_date": 1465943711, "question_id": 37823232, "link": "https://stackoverflow.com/questions/37823232/writing-a-python-c-extension-that-modifies-argument", "title": "Writing a python c extension that modifies argument", "body": "<p>I want to write a c extension with a function that modifies its argument. Is that possible?</p>\n\n<p>helloworld.c</p>\n\n<pre><code>#include &lt;Python.h&gt;\n// adapted from http://www.tutorialspoint.com/python/python_further_extensions.htm\n\n\n/***************\\\n* Argument Test *\n\\***************/\n// Documentation string\nstatic char arg_test_docs[] =\n    \"arg_test(integer i, double d, string s): i = i*i; d = i*d;\\n\";\n\n// C Function\nstatic PyObject * arg_test(PyObject *self, PyObject *args){\n    int i;\n    double d;\n    char *s;\n    if (!PyArg_ParseTuple(args, \"ids\", &amp;i, &amp;d, &amp;s)){\n        return NULL;\n    }\n    i = i * i;\n    d = d * d;\n    Py_RETURN_NONE;\n}\n\n// Method Mapping Table\nstatic PyMethodDef arg_test_funcs[] = {\n    {\"func\", (PyCFunction)arg_test,  METH_NOARGS , NULL },\n    {\"func\", (PyCFunction)arg_test,  METH_VARARGS, NULL},\n    {NULL, NULL, 0, NULL}\n};\n\nvoid inithelloworld(void)\n{\n    Py_InitModule3(\"helloworld\", arg_test_funcs,\n                   \"Extension module example3!\");\n}\n</code></pre>\n\n<p>setup.py</p>\n\n<pre><code>from distutils.core import setup, Extension\nsetup(name='helloworld', version='1.0',  \\\n      ext_modules=[Extension('helloworld', ['helloworld.c'])])\n</code></pre>\n\n<p>Installation:</p>\n\n<pre><code>python setup.py install\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>import helloworld\ni = 2; d = 4.0; s='asdf'\nprint(\"before: %s, %s, %s\" % (i,d,s))\nhelloworld.func(i,d,s)\nprint(\"after: %s, %s, %s\" % (i,d,s))\n</code></pre>\n\n<p>Test Result:</p>\n\n<pre><code>before: 2, 4.0, asdf\nafter: 2, 4.0, asdf\n</code></pre>\n\n<p>The integer and double values are not changed.\nThe result should be \"after: 4, 16.0, asdf\"</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1465942000, "post_id": 37822860, "comment_id": 63109439, "body": "The syntax is correct. What do you mean by &quot;does not appear to work&quot;?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1465942057, "post_id": 37822860, "comment_id": 63109461, "body": "It&#39;s the first line of that snippet that won&#39;t compile. The last line is fine. To get a definitive answer, you need to post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465942130, "post_id": 37822860, "comment_id": 63109496, "body": "@user3386109: You should add the rest of the code. The first line is no valid syntax as-is. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 3, "creation_date": 1465942459, "post_id": 37822860, "comment_id": 63109594, "body": "@RSahu <code>*structure struct1_ptr;</code> is a syntax error"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1465942541, "post_id": 37822860, "comment_id": 63109633, "body": "<code>*structure struct1_ptr;</code> --&gt; <code>structure *struct1_ptr;</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1465942956, "post_id": 37822860, "comment_id": 63109772, "body": "@M.M, yes. I was looking at just the line that tries to access the array of the <code>struct</code>."}, {"owner": {"reputation": 3, "user_id": 6466735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ffd887572541e7fca7858868b54002?s=128&d=identicon&r=PG&f=1", "display_name": "alk", "link": "https://stackoverflow.com/users/6466735/alk"}, "edited": false, "score": 1, "creation_date": 1465943013, "post_id": 37822860, "comment_id": 63109789, "body": "I&#39;ve updated the initial entry to include a trimmed version of my code. Apologies for the first line&#39;s syntax error, it was a mistake I made when I was just writing a generic version of the code."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1465943225, "post_id": 37822860, "comment_id": 63109850, "body": "@alk local variables stop existing when their function returns, so you access a dangling pointer"}, {"owner": {"reputation": 303, "user_id": 5062064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6pnV.jpg?s=128&g=1", "display_name": "mw215", "link": "https://stackoverflow.com/users/5062064/mw215"}, "edited": false, "score": 0, "creation_date": 1465944109, "post_id": 37822860, "comment_id": 63110119, "body": "@alk If your function creates a <code>structure</code> using a <code>malloc</code>, you can safely return that pointer to the caller. Just keep in mind you have to <code>free</code> that memory when you no longer need it!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465947934, "post_id": 37822860, "comment_id": 63111114, "body": "An array is not a pointer. You cannot &quot;dereference an array&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 5062064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6pnV.jpg?s=128&g=1", "display_name": "mw215", "link": "https://stackoverflow.com/users/5062064/mw215"}, "edited": false, "score": 0, "creation_date": 1465943733, "post_id": 37823153, "comment_id": 63110009, "body": "That&#39;s not necessarily the case: he could have called <code>malloc</code> inside his function which in turn returned the pointer to the newly allocated <code>structure</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 303, "user_id": 5062064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6pnV.jpg?s=128&g=1", "display_name": "mw215", "link": "https://stackoverflow.com/users/5062064/mw215"}, "edited": false, "score": 0, "creation_date": 1465944200, "post_id": 37823153, "comment_id": 63110135, "body": "@mw215 He could, but he didn&#39;t. Look at the code in the question."}, {"owner": {"reputation": 3, "user_id": 6466735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ffd887572541e7fca7858868b54002?s=128&d=identicon&r=PG&f=1", "display_name": "alk", "link": "https://stackoverflow.com/users/6466735/alk"}, "edited": false, "score": 0, "creation_date": 1465944889, "post_id": 37823153, "comment_id": 63110314, "body": "So essentially I&#39;d have to use malloc and then free it after I&#39;m done using. Am I correct in assuming it&#39;s better to return a pointer than just the simple_vector? I&#39;m doing so because I don&#39;t want the program to have to copy an entirely new struct."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 3, "user_id": 6466735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ffd887572541e7fca7858868b54002?s=128&d=identicon&r=PG&f=1", "display_name": "alk", "link": "https://stackoverflow.com/users/6466735/alk"}, "edited": false, "score": 0, "creation_date": 1465945474, "post_id": 37823153, "comment_id": 63110477, "body": "@alk I&#39;ve added a couple of possible solutions (in order from most to least recommended)."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 0, "last_activity_date": 1465945383, "last_edit_date": 1465945383, "creation_date": 1465943228, "answer_id": 37823153, "question_id": 37822860, "link": "https://stackoverflow.com/questions/37822860/dereferencing-an-array-in-a-struct-in-c/37823153#37823153", "title": "dereferencing an array in a struct (in C)", "body": "<p>You're returning the address of a local variable. When control leaves the block containing the variable definition (in this case, your function), the variable gets destroyed, and you're left with an invalid pointer.</p>\n\n<p>Your code has undefined behavior.</p>\n\n<p>You should also check if your compiler has warning options for this case. E.g. gcc has <code>-Wreturn-local-addr</code> (which I believe is enabled by default), which warns you about this situation.</p>\n\n<hr>\n\n<p>To solve this problem, you could have your function take a pointer to a struct to write the results into. This would make it the caller's responsibility to manage the memory associated with the struct.</p>\n\n<p>You could also return a struct by value, which would copy it to the caller (behind the scenes this probably compiles to something like solution #1; functions returning structs are usually implemented by making them take a hidden pointer argument anyway).</p>\n\n<p>Or you could <code>malloc</code> a struct dynamically. Then you have to check for errors (a <code>NULL</code> return from <code>malloc</code>) and it becomes the caller's responsibility to <code>free</code> the returned pointer.</p>\n\n<p>Finally, you could make the function return nothing (<code>void</code>) and instead use a global variable to communicate values back to the caller. This is usually not recommended because global variables can lead to some hard to understand program logic (and hard to find bugs).</p>\n"}, {"tags": [], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "is_accepted": false, "score": 0, "last_activity_date": 1466101620, "last_edit_date": 1466101620, "creation_date": 1465945227, "answer_id": 37823475, "question_id": 37822860, "link": "https://stackoverflow.com/questions/37822860/dereferencing-an-array-in-a-struct-in-c/37823475#37823475", "title": "dereferencing an array in a struct (in C)", "body": "<blockquote>\n  <p>How do I go about accessing the non-zeroth element of an array using the -> operator?</p>\n</blockquote>\n\n<p>You can do it by making your variables accessible in the first place. Assuming the \"non zeroth\" and \"tenth\" elements in an array of 8 elements are typos, what you might easily do is correctly create and manage a pointer to valid memory which is also <em>accessible from your caller function</em>. One obvious possibility is doing it <em>dynamically</em>. Here is a quick demonstration fix, based on your code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct {\n    uint8_t length;\n    uint8_t data[8];\n} simple_vector;\n\nsimple_vector* SD_cmd(uint8_t cmd, uint32_t arg, uint8_t crc, uint8_t read_cnt)\n{\n    simple_vector *vector = malloc(sizeof(simple_vector)); // pointer to malloc'd memory\n    //stuff happens and the simple_vector is manipulated\n    vector-&gt;data[3] = 42;\n    return vector; //return the pointer\n}\n\nint main()\n{\n    if((simple_vector *response = SD_cmd(8, 0x000001AA, 0x87, 5)) == NULL){\n        printf(\"Memory allocation error\\n\");\n        return(1);\n    }\n    uint8_t value = response-&gt;data[3]; //the \"last\" line in question\n    printf(\"%hhu\\n\", value);\n    free(response);       //free the memory once you don't need it !\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>The last line in the above snippet does not return the correct value</p>\n</blockquote>\n\n<pre><code>&gt; ./test\n  42\n</code></pre>\n\n<p>Please note how elegant and idiomatic to C such procedures are.</p>\n"}], "owner": {"reputation": 3, "user_id": 6466735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ffd887572541e7fca7858868b54002?s=128&d=identicon&r=PG&f=1", "display_name": "alk", "link": "https://stackoverflow.com/users/6466735/alk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 37823153, "answer_count": 2, "score": -1, "last_activity_date": 1466101620, "creation_date": 1465941802, "last_edit_date": 1465944692, "question_id": 37822860, "link": "https://stackoverflow.com/questions/37822860/dereferencing-an-array-in-a-struct-in-c", "title": "dereferencing an array in a struct (in C)", "body": "<p>Let's say I have a struct and the following functions:</p>\n\n<p>struct in header file:</p>\n\n<pre><code>typedef struct {\nuint8_t length;\nuint8_t data[8];\n} simple_vector;\n</code></pre>\n\n<p>function:</p>\n\n<pre><code>simple_vector* SD_cmd(uint8_t cmd, uint32_t arg, uint8_t crc, uint8_t read_cnt){\n\nsimple_vector vector;\n\n//stuff happens and the simple_vector is manipulated\n\nreturn &amp;vector;\n}\n</code></pre>\n\n<p>How do I go about accessing the non-zeroth element of an array using the -> operator?</p>\n\n<p>Let's say a function returns a pointer to this struct:</p>\n\n<pre><code>simple_vector *response;\nresponse = SD_cmd(8, 0x000001AA, 0x87, 5);\nuint8_t value = response-&gt;data[3];\n</code></pre>\n\n<p>The last line in the above snippet does not return the correct value. I've debugged (on an mcu) and verified that the data[3] in the function is not the same as what I get when I dereference it outside of the function. Any thoughts?</p>\n"}, {"tags": ["c", "organization", "code-organization", "paradigms"], "comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 1, "creation_date": 1465941743, "post_id": 37822809, "comment_id": 63109356, "body": "Well-thought-out question, but this might border on &quot;Too broad&quot;... my opinion is not definitive though, so I&#39;ll wait to see what other people say."}, {"owner": {"reputation": 14193, "user_id": 183203, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf9ec57f64280ffe34ddd221d5c5151f?s=128&d=identicon&r=PG", "display_name": "antlersoft", "link": "https://stackoverflow.com/users/183203/antlersoft"}, "edited": false, "score": 0, "creation_date": 1465941851, "post_id": 37822809, "comment_id": 63109386, "body": "I don&#39;t know of any rule against developing C with an OOP style.  After all, the stdio functions are written this way, as is the Linux kernel."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 3, "creation_date": 1465941920, "post_id": 37822809, "comment_id": 63109411, "body": "Another point is that this question may be more well suited for <a href=\"http://programmers.stackexchange.com/\">Programmers StackExchange</a>. See their <a href=\"http://programmers.stackexchange.com/help/on-topic\">list of topics</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1465942016, "post_id": 37822809, "comment_id": 63109445, "body": "Those last 4 questions are a style matter and largely of an opinion (and broad).  Suggest another site."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1465942121, "post_id": 37822809, "comment_id": 63109491, "body": "If this were to be migrated to Programmers, perhaps you could narrow down your question to ask specifically something to the effect of &quot;What are some common core conventions in C for modularization?&quot; Find a wording that will help minimize opinionated answers, and hopefully next time you won&#39;t get shot down at the door."}, {"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1465942642, "post_id": 37822809, "comment_id": 63109666, "body": "I&#39;d gladly see answers to this question, but rules are rules - too broad / opinion based apply too well here."}, {"owner": {"reputation": 1414, "user_id": 1578234, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6f825abb09fd46d88caade666badf547?s=128&d=identicon&r=PG", "display_name": "MrKatSwordfish", "link": "https://stackoverflow.com/users/1578234/mrkatswordfish"}, "edited": false, "score": 0, "creation_date": 1465949414, "post_id": 37822809, "comment_id": 63111448, "body": "Alright, I&#39;ll take my question elsewhere. Sorry about that."}], "owner": {"reputation": 1414, "user_id": 1578234, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6f825abb09fd46d88caade666badf547?s=128&d=identicon&r=PG", "display_name": "MrKatSwordfish", "link": "https://stackoverflow.com/users/1578234/mrkatswordfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 452, "favorite_count": 1, "closed_date": 1465942189, "answer_count": 0, "score": 4, "last_activity_date": 1465950244, "creation_date": 1465941548, "last_edit_date": 1465950244, "question_id": 37822809, "link": "https://stackoverflow.com/questions/37822809/modularity-techniques-in-c", "closed_reason": "Needs more focus", "title": "Modularity Techniques in C", "body": "<p>Most of my programming experience and learning so far has been focused on languages (C++, C#, Python, etc.) that feature tools for Object Oriented Design and other 'high level' organizational concepts. Many of these languages have pretty clear conventions when it comes to breaking up a project into modules (files, packages, libraries, etc.), and often these conventions are pretty closely connected to OO ideas. As such, I find that I get a little bit stuck when I start thinking about writing a program in a language that doesn't rely heavily on these concepts (in this case, C).</p>\n\n<p>For example, in C++ and C# I'm very used to typically organizing my programs such that each class is a module. In <em>C#</em> it's <em>usually</em> one file per class, and in <em>C++</em> it's <em>usually</em> one header file and one source file per class. Of course, there are times when it's helpful to break these conventions and there is some degree of personal preference, but this is close to what I would consider to be conventional.</p>\n\n<p>I'm pretty new to <em>Python</em>, so I won't risk generalizing too much here. However, from what I've seen so far, it seems that it's a little bit more common to throw multiple classes and/or functions into a single module/file. It seems the rule of thumb here is that your program should be as modular as possible within reason, but if some piece of code doesn't make sense as a stand-alone unit for other users to import it probably shouldn't be put into a separate module. Regardless, it seems the convention here is a bit less 'conventional' and a bit more logical.</p>\n\n<p>So, back to learning C, the language seems pretty flexible from a design and organizational standpoint and it doesn't seem to carry too many 'built-in' conventions or rules for how to go about making a well organized and modular program. Compared to C++, where I would usually start programming with a sort of 'top-down' approach which involves declaring various high level classes in separate files, I'm not really sure how to organize a C program.. </p>\n\n<p>Other than writing chaotic spaghetti code, here are two basic approaches to C that I know so far:</p>\n\n<ul>\n<li><p><strong>Libraries:</strong> Break highly related groups of data structures and functionality into a single, coherent library. For example, you might make a \"math\" library that defines various common constants like pi or e, defines useful structs for vectors and matrices, and has a gamut of useful functions like trig functions, matrix math, etc. This is simple and makes a lot of sense, but it also seems like it could quickly become messy from a maintainability standpoint. Any client that uses a simply library like this would have transparent access to various functions and structs, meaning that changes in the library are much more likely to break other pieces of code. This might work well for a math library where significant changes to the data and interfaces are uncommon, but I can imagine that complex and large programs that undergo frequent changes would be hurt by this style of organization.</p></li>\n<li><p><strong>Abstract Data Types:</strong> Break a group of code into two files, one (source/.c) containing function and struct definitions, and another (header/.h) that declares a subset of those functions as well as defining new types as pointers to those structs. This looks very familiar to me, and I'd say that it verges on being a kind of home made OOP. This creates abstraction and encapsulation like OOP are used to working with, and it seems like you could break a project into similar ADT units (dare I say classes) in a similar way to creating a C++ program (one pair of files per ADT). This seems to have most of the benefits associated with OOP, but also many of the drawbacks, including added complexity and tons of 'boilerplate' code. I understand this, and I think it's well within my comfort zone, but I feel as if I've heard equal amounts of advise for and against designing C programs in a somewhat OO fashion.</p></li>\n</ul>\n\n<p>Because C is a very powerful and 'low level' language, it seems like you have all the tools to do basically whatever you want. But what are some of the core conventions and recommendations that C programmers use to design, organize, and write big projects? Are there some other useful approaches that I don't know about? What are the benefits and drawbacks to each of these organizational approaches? Do design approaches shift significantly depending on the context of the project (for example, considerations of embedded vs. kernel vs. user-space application development)?</p>\n\n<p>Edit: Question seems to be against the rules. Moved to reddit. <a href=\"https://www.reddit.com/r/learnprogramming/comments/4o4kea/modularity_techniques_in_c/\" rel=\"nofollow\">https://www.reddit.com/r/learnprogramming/comments/4o4kea/modularity_techniques_in_c/</a></p>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1465941537, "post_id": 37822733, "comment_id": 63109271, "body": "It might not have given an error: but it did give a warning (if you looked). It made assumptions about the function prototype (in the missing header), and linked the library automatically."}], "answers": [{"comments": [{"owner": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "edited": false, "score": 0, "creation_date": 1465941787, "post_id": 37822815, "comment_id": 63109366, "body": "gcc did not give me any warning when I used the following command: <code>gcc -o myprogram myfile.c</code>. Also the program worked fine and printed <code>&quot;Hello&quot;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1465941793, "post_id": 37822815, "comment_id": 63109369, "body": "Doubtful about &quot;this is undefined behaviour as functions that take variable argument lists like printf must be declared explicitly&quot;  Any citation available?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "edited": false, "score": 1, "creation_date": 1465941910, "post_id": 37822815, "comment_id": 63109407, "body": "@Tom compile with <code>-Wall</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1465942300, "post_id": 37822815, "comment_id": 63109547, "body": "@chux C11 6.5.2.2/6   (C89 and C99 had similar text). Standard library functions are considered to be defined with a prototype."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465942437, "post_id": 37822815, "comment_id": 63109586, "body": "Since C99 missing declarations have to generate a warning."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "edited": false, "score": 0, "creation_date": 1465942495, "post_id": 37822815, "comment_id": 63109610, "body": "@Tom: Use C99 mode, gcc that old defaults to C90 at best. And get a more recent version."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1465942545, "post_id": 37822815, "comment_id": 63109634, "body": "Old gcc defaults to <code>-std=gnu89</code> (i.e. C89/C90 with GNU extensions)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1465943337, "post_id": 37822815, "comment_id": 63109893, "body": "@melpomene: IIRC, it defaults to <code>gnu90</code>."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465944100, "post_id": 37822815, "comment_id": 63110113, "body": "@Olaf Which is the same thing. Newer gcc defaults to <code>gnu11</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465944406, "post_id": 37822815, "comment_id": 63110190, "body": "@FUZxxl: To be precise gcc 5 and newer:-)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1465945811, "post_id": 37822815, "comment_id": 63110576, "body": "@M.M Thanks for the cite.  As I read it, it does not support &quot;UB as  functions that take variable argument lists like printf must be declared explicitly&quot;.  It also needs incompatibility.  I read that spec as functions like <code>printf()</code>  (those with a <code>...</code>) and <i>the types of the arguments after promotion are not compatible with the types of the parameters, the behavior is undefined.</i> Yet if the arguments happed to be compatible, it is not UB.  Thus with OP&#39;s lack of <code>stdio.h</code>, the format happened to be compatible and so things worked.  Obviously not portable code."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1465947624, "post_id": 37822815, "comment_id": 63111048, "body": "@chux ISO 9899 &#167;3.3.2.2 &#182;6 is quite clear in this regard: <i>If the expression that denotes the called function has a type that does not include a prototype, the integral promotions are performed on each argument and arguments that have type float are promoted to double. [...] If the function is defined with a type that includes a prototype, and the types of the arguments after promotion are not compatible with the types of the parameters, or if the prototype ends with an ellipsis ( &quot;, ...&quot; ), the behavior is undefined.</i>"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 3, "last_activity_date": 1465941572, "creation_date": 1465941572, "answer_id": 37822815, "question_id": 37822733, "link": "https://stackoverflow.com/questions/37822733/does-gcc-include-some-header-files-automatically/37822815#37822815", "title": "Does gcc include some header files automatically?", "body": "<p>In ANSI C, you can call functions you didn't declare. Such functions are implicitly declared the first time you call them. They are assumed to return <code>int</code> and take arguments according to the <em>default argument promotions.</em> Since you didn't include <code>&lt;stdio.h&gt;</code>, the compiler uses this rule and implicitly declares <code>printf</code>. Note that this is undefined behaviour as functions that take variable argument lists like <code>printf</code> must be declared explicitly. gcc usually warns you if it uses the implicit declaration rule since it's usually not intentionally used.</p>\n"}, {"comments": [{"owner": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "edited": false, "score": 0, "creation_date": 1465942101, "post_id": 37822900, "comment_id": 63109480, "body": "Is there a way to prevent gcc from doing these &quot;guesses&quot;?"}, {"owner": {"reputation": 1947, "user_id": 127259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a03d0d7cef50d64a2035198c2a657a?s=128&d=identicon&r=PG&f=1", "display_name": "fpmurphy", "link": "https://stackoverflow.com/users/127259/fpmurphy"}, "edited": false, "score": 1, "creation_date": 1465942341, "post_id": 37822900, "comment_id": 63109555, "body": "Or try compile with -Werror-implicit-function-declaration"}], "tags": [], "owner": {"reputation": 8848, "user_id": 2116168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjVAe.jpg?s=128&g=1", "display_name": "Elmar Peise", "link": "https://stackoverflow.com/users/2116168/elmar-peise"}, "is_accepted": false, "score": 1, "last_activity_date": 1465941953, "creation_date": 1465941953, "answer_id": 37822900, "question_id": 37822733, "link": "https://stackoverflow.com/questions/37822733/does-gcc-include-some-header-files-automatically/37822900#37822900", "title": "Does gcc include some header files automatically?", "body": "<p>No, gcc did not include any header files you didn't request.  <code>#include</code> statements are C preprocessor macros (like <code>#define</code> or <code>#if</code>) that are actually evaluated before the actual C compilation.  You can see what your code looks like after all macros are resolved by calling <code>gcc -E myfile.c</code>.  As you will see, <code>printf</code> will still not be declared.</p>\n\n<p>If you compile with <code>-Wall</code>, you should get a warning that <code>printf</code> is undeclared.  However gcc \"guesses\" how <code>printf</code> is used (probably from its arguments, but it could also simply know the routine internally).  Since it finds a matching symbol name while linking, you don't get an error and your program runs just fine.</p>\n\n<p>BTW, gcc 5.3.0 shows the following warning:</p>\n\n<pre><code>myfile.c: In function 'main':\nmyfile.c:3:5: warning: implicit declaration of function 'printf' [-Wimplicit-function-declaration]\n     printf(\"Hello\\n\");\n     ^\nmyfile.c:3:5: warning: incompatible implicit declaration of built-in function 'printf'\nmyfile.c:3:5: note: include '&lt;stdio.h&gt;' or provide a declaration of 'printf'\n</code></pre>\n"}], "owner": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1465942536, "creation_date": 1465941212, "last_edit_date": 1465942536, "question_id": 37822733, "link": "https://stackoverflow.com/questions/37822733/does-gcc-include-some-header-files-automatically", "title": "Does gcc include some header files automatically?", "body": "<p>I have the following code:</p>\n\n<pre><code>int main()\n{\n    printf(\"Hello\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>I compiled it using the following command:</p>\n\n<pre><code>gcc -o myprogram myfile.c\n</code></pre>\n\n<p>And it compiled without any error even though I did not <code>#include &lt;stdio.h&gt;</code>. So did gcc include this header file automatically?</p>\n\n<p><strong>My gcc version is 4.3.3</strong></p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 3, "creation_date": 1465940619, "post_id": 37822580, "comment_id": 63108931, "body": "You lucked out. Don&#39;t try it again."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 2, "creation_date": 1465940997, "post_id": 37822580, "comment_id": 63109066, "body": "My guess: both STDIN and STDOUT map to the same two-way pipe (or similar construct) and thus you were able to write to STDIN on this occasion."}], "answers": [{"comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1465942115, "post_id": 37822698, "comment_id": 63109487, "body": "I have tested your answer with expanded OP&#39;s code, redirection and piping, you&#39;re right, @Mike . Yet it makes me wonder, what&#39;s the use of such programmatic writing to <code>stdin</code>? Can the content written in such a way also get retrieved from the <code>stdin</code> buffer somehow?"}, {"owner": {"reputation": 12563, "user_id": 77939, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7cd2dfec42419c9791031b2e86ea9b68?s=128&d=identicon&r=PG", "display_name": "mpontillo", "link": "https://stackoverflow.com/users/77939/mpontillo"}, "reply_to_user": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1465942647, "post_id": 37822698, "comment_id": 63109670, "body": "@user3078414, as far as I understand it, it&#39;s a bug. Don&#39;t do this. ;-)"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1465943123, "post_id": 37822698, "comment_id": 63109824, "body": "I wouldn&#39;t do it in real life, unless recommended practice @Mike. Just for test, this doesn&#39;t work: <code>#include &lt;string.h&gt; #include &lt;unistd.h&gt; int main() {     char str[] = &quot;Hello, World!\\n&quot;;     char text[100];     write(0, str, strlen(str));        read(0, text, strlen(str));     write(1, text, strlen(text));     return 0; }</code>  (-:"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1465949649, "post_id": 37822698, "comment_id": 63111510, "body": "@user3078414: It is because terminals (actually <a href=\"http://man7.org/linux/man-pages/man7/pty.7.html\" rel=\"nofollow noreferrer\">pseudoterminals</a> aka <code>pty</code>s in Linux) are really full duplex devices, and in this case, standard input is connected to one. The <a href=\"http://man7.org/linux/man-pages/man3/isatty.3.html\" rel=\"nofollow noreferrer\"><code>isatty()</code></a> function will tell you if a descriptor is connected to a pseudoterminal. Libraries like <a href=\"https://en.wikipedia.org/wiki/Ncurses\" rel=\"nofollow noreferrer\">ncurses</a> write control messages to the standard input, and read the responses from the terminal master (kernel or program) interspersed among other input."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1465950348, "post_id": 37822698, "comment_id": 63111688, "body": "As an example, you can run <code>printf &#39;Foo\\033[6nBar\\n&#39;</code> (using any POSIXy shell like dash or bash) in a terminal window. You&#39;ll see <code>FooBar</code> printed on its own line, but with garbage you can edit already present on the next command line. The already-present garbage probably ends with <code>;4R</code>, since the command, <a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code\" rel=\"nofollow noreferrer\">DSR</a>, yields a response <code>\\033[</code> <i>row</i> <code>;</code> <i>column</i> <code>R</code>, and at the point of the command the terminal cursor is in the fourth column."}], "tags": [], "owner": {"reputation": 12563, "user_id": 77939, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7cd2dfec42419c9791031b2e86ea9b68?s=128&d=identicon&r=PG", "display_name": "mpontillo", "link": "https://stackoverflow.com/users/77939/mpontillo"}, "is_accepted": false, "score": 6, "last_activity_date": 1465941020, "creation_date": 1465941020, "answer_id": 37822698, "question_id": 37822580, "link": "https://stackoverflow.com/questions/37822580/why-is-it-possible-to-write-to-stdin/37822698#37822698", "title": "Why is it possible to write() to STDIN?", "body": "<p>Because by default your terminal will echo stdin back out to the console. Try redirecting it to a file; it didn't actually write to stdout.</p>\n"}, {"comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1465943260, "post_id": 37823080, "comment_id": 63109866, "body": "FYI, this function <code>write()</code> is declared in <code>&lt;unistd.h&gt;</code> in <i>unix</i>."}], "tags": [], "owner": {"reputation": 1, "user_id": 6461297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c861d6e1036c34a765df7f688605ad?s=128&d=identicon&r=PG&f=1", "display_name": "detourvmx", "link": "https://stackoverflow.com/users/6461297/detourvmx"}, "is_accepted": false, "score": 0, "last_activity_date": 1465942847, "creation_date": 1465942847, "answer_id": 37823080, "question_id": 37822580, "link": "https://stackoverflow.com/questions/37822580/why-is-it-possible-to-write-to-stdin/37823080#37823080", "title": "Why is it possible to write() to STDIN?", "body": "<p>Are you confusing write with fwrite? The first parameter in write is a \"file descripter\", but it's not stdin.  Try doing an fwrite to stdin -- it doesn't happen.</p>\n"}, {"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1465998577, "post_id": 37827295, "comment_id": 63135737, "body": "Perhaps it would be better to not suggest such a hack, since <code>stderr</code> is available for that exact purpose? Many do not seem to know it. (Besides, one can call <code>ctermid()</code> to find the path to the current controlling (pseudo-)terminal, and try and open that, to write to terminal.) As a side note, POSIX.1-2001 and later state that <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/stdin.html\" rel=\"nofollow noreferrer\">stderr is expected to be opened for reading and writing</a>, because in most situations, it should be connected to the controlling terminal (if there is any), even if stdout and/or stdin are redirected."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1466007394, "post_id": 37827295, "comment_id": 63142289, "body": "@NominalAnimal: that&#39;s why I said it is a dirty hack and even give a use case where it could lead to terrible results..."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1466007984, "post_id": 37827295, "comment_id": 63142687, "body": "Yes. It&#39;s just that most people seem surprised by my example code having <code>fprintf(stderr, ...)</code> scattered everywhere, outputting human-readable information intended for the user (as opposed to stdin/stdout used for <i>data</i>). I wish more people would suggest learners to use stderr for human-readable diagnostics, and stdin/stdout primarily for data. Learners often think <i>&quot;hacks are cool&quot;</i>, and often do not latch on better practices. You&#39;re cool, so you could set a better example. ;)"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1466008374, "post_id": 37827295, "comment_id": 63142897, "body": "@NominalAnimal: Does it look better now?"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 11, "last_activity_date": 1466008355, "last_edit_date": 1466008355, "creation_date": 1465970734, "answer_id": 37827295, "question_id": 37822580, "link": "https://stackoverflow.com/questions/37822580/why-is-it-possible-to-write-to-stdin/37827295#37827295", "title": "Why is it possible to write() to STDIN?", "body": "<p>Well, old Unix systems were originaly used with serial terminals, and a special program <code>getty</code> was in charge to manage the serial devices, open and configure them, display a message on an incoming connexion (break signal), and pass the opened file descriptors to login and then the shell.</p>\n\n<p>It used to open the tty device as input/output to configure it, and that was then duplicated in file descriptors 0, 1 and 2. And by default the (still good old) <code>stty</code> command operates by default on standard input. To ensure compatibility, on modern Linuxes, when you are connected to a terminal, file descriptor 0 is still opened for input/output.</p>\n\n<p>It can be used as a quick and dirty hack to only display prompts when standard input is connected to a terminal, because if standard input is redirected to a read only file or pipe, all writes will fail (without any harm for the process) and nothing will be printed. But it is anyway a dirty hack: just imagine what happens if a caller passes a file opened for input/output as standard input... That's why good practices recommend to use stderr for prompts or messages to avoid having them lost in redirected stream while keeping output and input in separate streams, which is neither harder nor longer.</p>\n\n<p>TL/DR: if you are connected to a terminal, standard input <strong>is</strong> opened for input/output even if the name and standard usage could suggest it is read only.</p>\n"}], "owner": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2867, "favorite_count": 5, "answer_count": 3, "score": 6, "last_activity_date": 1579855844, "creation_date": 1465940404, "last_edit_date": 1579855844, "question_id": 37822580, "link": "https://stackoverflow.com/questions/37822580/why-is-it-possible-to-write-to-stdin", "title": "Why is it possible to write() to STDIN?", "body": "<p>I have the following code:</p>\n\n<pre><code>int main()\n{\n    char str[] = \"Hello\\n\";\n    write(0, str, 6);   // write() to STDIN\n    return 0;\n}\n</code></pre>\n\n<p>When I compiled and executed this program, <code>Hello</code> was printed in the terminal.</p>\n\n<p>Why did it work? Did <code>write()</code> replace my <code>0</code> (STDIN) argument with <code>1</code> (STDOUT)?</p>\n"}, {"tags": ["c", "linux", "sockets", "networking"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1465940545, "post_id": 37823304, "comment_id": 63110134, "body": "I think you&#39;re lost..."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1465944680, "post_id": 37823304, "comment_id": 63110263, "body": "&quot;I am noticing that client does not receive response when server sends response from a different process&quot;. Isn&#39;t the likely reason because of bugs in your code? What you have described is possible if coded correctly. But we can&#39;t help you further since you have not shown any code."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1465955942, "post_id": 37823304, "comment_id": 63112875, "body": "If your socket is <code>TCP</code> oriented, you can spawn a child process and the file descriptor of the accepted connection will be inherited. Then use <code>send()</code> and <code>recv()</code>. But it seems you are using UDP sockets. In <code>UDP</code> sockets, you only create the socket and bind to it. There&#39;s no <code>listen()</code>ing port. You then use <code>sendto()</code> and <code>recvfrom()</code>. In your case, you should spawn a child, which already inherited the creation and binding to socket, to <code>recvfrom()</code> the messages sent from client. If you are truly creating, binding and listening on a connection oriented, <code>sendto()</code> ignores the destaddr"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1465956032, "post_id": 37823304, "comment_id": 63112896, "body": "In summary, you may use <code>sendto()</code> even in connection oriented socket but you need to use <code>recv()</code>. In connectionless oriented socket you can only use <code>sendto()</code> and <code>recvfrom()</code>."}, {"owner": {"reputation": 11, "user_id": 6470017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf87198a14aba23666eabb70d682db0?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6470017/kumar"}, "edited": false, "score": 0, "creation_date": 1465999738, "post_id": 37823304, "comment_id": 63136632, "body": "See this link. <a href=\"http://stackoverflow.com/questions/752492/replying-to-a-client-over-sockets-udp-from-a-different-process?rq=1\" title=\"replying to a client over sockets udp from a different process\">stackoverflow.com/questions/752492/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 6470017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf87198a14aba23666eabb70d682db0?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6470017/kumar"}, "edited": false, "score": 0, "creation_date": 1466027923, "post_id": 37823304, "comment_id": 63153174, "body": "With the help of the iptables (i.e. snat), when server sends response to the client I changed the port to the destination port, which is received when client sends its message. Still client does not receive messages. But if server sends response from the same socket it received, then client receives it"}], "answers": [{"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1465950961, "post_id": 37824242, "comment_id": 63111832, "body": "The socket will be auto-bound by <code>sendto()</code> if it isn&#39;t already bound."}, {"owner": {"reputation": 11, "user_id": 6470017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf87198a14aba23666eabb70d682db0?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6470017/kumar"}, "edited": false, "score": 0, "creation_date": 1466012221, "post_id": 37824242, "comment_id": 63145009, "body": "With the help of the iptables (i.e. snat), when server sends response to the client I changed the port  to the destination port, which is received when client sends its message. Still client does not receive messages. But if server sends response from the same socket it received, then client receives it."}], "tags": [], "owner": {"reputation": 7116, "user_id": 5083516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2aeeefc1a95ddb2f19612150ccd7ba?s=128&d=identicon&r=PG&f=1", "display_name": "plugwash", "link": "https://stackoverflow.com/users/5083516/plugwash"}, "is_accepted": false, "score": 1, "last_activity_date": 1465951962, "last_edit_date": 1465951962, "creation_date": 1465950419, "answer_id": 37824242, "question_id": 37823304, "link": "https://stackoverflow.com/questions/37823304/can-server-send-response-from-a-different-process-and-socket/37824242#37824242", "title": "Can server send response from a different process and socket?", "body": "<p>This can be done but there are some major caveats.</p>\n\n<ol>\n<li><p>The client must bind the socket and use <code>sendto()</code> and <code>recvfrom()</code> rather than <code>connect()</code>'ing the socket and using <code>send()</code> and <code>recv()</code>.  This allows it to receive incoming packets from anywhere as long as they are directed to the IP/Port that <code>recvfrom()</code> is reading on.</p></li>\n<li><p>If there is a firewall or NAT in the path between client and server, it is likely to block the response since the sending IP/Port does not match the IP/Port that the client originally sent its request to.</p></li>\n</ol>\n"}], "migrated_from": {"other_site": {"aliases": ["http://chiphacker.com", "http://www.chiphacker.com"], "markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1300734875, "open_beta_date": 1285786800, "closed_beta_date": 1285786800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/electronics/Img/apple-touch-icon@2.png", "twitter_account": "StackElectronix", "favicon_url": "https://cdn.sstatic.net/Sites/electronics/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/electronics/Img/apple-touch-icon.png", "audience": "electronics and electrical engineering professionals, students, and enthusiasts", "site_url": "https://electronics.stackexchange.com", "api_site_parameter": "electronics", "logo_url": "https://cdn.sstatic.net/Sites/electronics/Img/logo.png", "name": "Electrical Engineering", "site_type": "main_site"}, "on_date": 1465944177, "question_id": 241027}, "owner": {"reputation": 11, "user_id": 6470017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bf87198a14aba23666eabb70d682db0?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6470017/kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1465951962, "creation_date": 1465940383, "question_id": 37823304, "link": "https://stackoverflow.com/questions/37823304/can-server-send-response-from-a-different-process-and-socket", "title": "Can server send response from a different process and socket?", "body": "<p>After server, which is listening on port X, receives a request from the client, can it send response from a different process and a socket with sendto call. Please note that the client also sends request with sendto (server address) call.</p>\n\n<p>Here are the steps:</p>\n\n<ol>\n<li>server opens a socket and binds it to IP address (a.b.c.d) and port (x)</li>\n<li>client opens a socket and binds it to IP address (k.l.m.n) and port (z) and sends request to server with sendto call.</li>\n<li>Server (in different process) opens a socket and binds it to IP address (a.b.c.d) and port (y)</li>\n<li>server sends response from above socket to client with sendto</li>\n</ol>\n\n<p>Both client and server knows each other ip addresses and port numbers.</p>\n\n<p>I am noticing that client does not receive response when server sends response from a different process. Otherwise, it does.</p>\n"}, {"tags": ["c", "clock"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1465940190, "post_id": 37822497, "comment_id": 63108751, "body": "<i>&quot;The clock() function determines the amount of processor time used...&quot;</i> When you sleep, time passes, but no processor time is used."}, {"owner": {"reputation": 188, "user_id": 6025940, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f7881d1a844db75479cad003d88dbe0d?s=128&d=identicon&r=PG&f=1", "display_name": "george_t", "link": "https://stackoverflow.com/users/6025940/george-t"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465940299, "post_id": 37822497, "comment_id": 63108799, "body": "So do i need the delay() function ?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465940546, "post_id": 37822497, "comment_id": 63108898, "body": "No, you need to use a different function to measure wall time. On a MAC,  use <code>mach_absolute_time</code>. On Windows, it&#39;s <code>QueryPerformanceCounter</code>."}, {"owner": {"reputation": 188, "user_id": 6025940, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f7881d1a844db75479cad003d88dbe0d?s=128&d=identicon&r=PG&f=1", "display_name": "george_t", "link": "https://stackoverflow.com/users/6025940/george-t"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1465940648, "post_id": 37822497, "comment_id": 63108936, "body": "On linux ?? Just use a different function to delay or to measure time ?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1465941031, "post_id": 37822497, "comment_id": 63109080, "body": "On linux, I think you&#39;re stuck with <code>gettimeofday</code>."}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1465975687, "post_id": 37822497, "comment_id": 63119802, "body": "there&#39;s also <a href=\"http://linux.die.net/man/2/clock_gettime\" rel=\"nofollow noreferrer\"><code>clock_gettime</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6438618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119d8b7bc0eb718bfe519c54b0522cc2?s=128&d=identicon&r=PG&f=1", "display_name": "Johnson1372", "link": "https://stackoverflow.com/users/6438618/johnson1372"}, "is_accepted": false, "score": 0, "last_activity_date": 1465956918, "creation_date": 1465956918, "answer_id": 37825010, "question_id": 37822497, "link": "https://stackoverflow.com/questions/37822497/clock-function-usleep-not-working-right-in-c-program/37825010#37825010", "title": "Clock function usleep not working right in c program ?", "body": "<p>In fact, clock function records cpu cycle number for this process. When you call the usleep function, the cpu will not provide any time slide for this process.\nSo the real reason is clock() function. Maybe you can find some functions to get the system time. I think it will work.</p>\n"}, {"tags": [], "owner": {"reputation": 188, "user_id": 6025940, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f7881d1a844db75479cad003d88dbe0d?s=128&d=identicon&r=PG&f=1", "display_name": "george_t", "link": "https://stackoverflow.com/users/6025940/george-t"}, "is_accepted": true, "score": 2, "last_activity_date": 1466074660, "creation_date": 1466074660, "answer_id": 37857200, "question_id": 37822497, "link": "https://stackoverflow.com/questions/37822497/clock-function-usleep-not-working-right-in-c-program/37857200#37857200", "title": "Clock function usleep not working right in c program ?", "body": "<p>Found a solution . I wrote a delay function  : </p>\n\n<pre><code>void delay (unsigned int msecs) {\nclock_t goal = msecs*CLOCKS_PER_SEC/1000 + clock();  //convert msecs to clock count  \nwhile ( goal &gt; clock() );               // Loop until it arrives.\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 188, "user_id": 6025940, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f7881d1a844db75479cad003d88dbe0d?s=128&d=identicon&r=PG&f=1", "display_name": "george_t", "link": "https://stackoverflow.com/users/6025940/george-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2213, "favorite_count": 0, "accepted_answer_id": 37857200, "answer_count": 2, "score": 2, "last_activity_date": 1466074660, "creation_date": 1465939960, "question_id": 37822497, "link": "https://stackoverflow.com/questions/37822497/clock-function-usleep-not-working-right-in-c-program", "title": "Clock function usleep not working right in c program ?", "body": "<p>I want to delay my program for 500 msec using clock_t type .For example i have following code  : </p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n   clock_t start_t, end_t, total_t,start_2,end_2,total_2;\n   int i;\n\n   start_t = clock();\n   printf(\"start_t = %ld\\n\", start_t);\n\n   //do a loop\n   for(i=0; i&lt; 10000000; i++)\n   {\n   }\n\n   end_t = clock();\n\n\n   printf(\"end_t = %ld \\n\", end_t);\n\n   total_t = (double)(end_t - start_t)*1000 / CLOCKS_PER_SEC;\n   printf(\"Total1 in msec %ld \\n\",total_t);\n\n\n\n   start_2=clock();\n   printf(\"start_2 %ld\\n \", start_2);\n   usleep(500000);\n\n   end_2=clock();\n   printf(\"end_2 %ld\\n \", end_2);\n   total_2=(double)(start_2-end_2)*1000/CLOCKS_PER_SEC;\n   printf(\"Total2 in msec %ld\\n \", total_2);\n\n\n   return(0);\n}\n</code></pre>\n\n<p>I have found out that usleep takes a value of \u03bcsec as an input. So i put 500000. </p>\n\n<p>But i get : </p>\n\n<pre><code>start_t = 1041\nend_t = 50441 \nTotal1 in msec 49 \n\nstart_2 50446\nend_2 50478\nTotal2 in msec 0\n</code></pre>\n\n<p>What goes wrong ? Why is total2 =0 ? Any help please ? </p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 2127, "user_id": 923194, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d48e182893f9d17460dd2404c4072828?s=128&d=identicon&r=PG", "display_name": "Imran Ali", "link": "https://stackoverflow.com/users/923194/imran-ali"}, "edited": false, "score": 0, "creation_date": 1465939715, "post_id": 37822400, "comment_id": 63108529, "body": "move <code>a[i] = 0 ;</code> inside the <code>if</code> statement, and start comparison from the index 1 i.e. <code>i=1</code> in for loop"}, {"owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "edited": false, "score": 0, "creation_date": 1465940623, "post_id": 37822400, "comment_id": 63108932, "body": "And what if there is more than 1 smallest element?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2127, "user_id": 923194, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d48e182893f9d17460dd2404c4072828?s=128&d=identicon&r=PG", "display_name": "Imran Ali", "link": "https://stackoverflow.com/users/923194/imran-ali"}, "edited": false, "score": 0, "creation_date": 1465941175, "post_id": 37822400, "comment_id": 63109143, "body": "@ImranAli no, then it will set the smallest-so-far to 0 each time it finds a new smallest"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1465941194, "post_id": 37822400, "comment_id": 63109147, "body": "The title says &quot;index&quot;, I guess from the description you actually meant &quot;value&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1465940266, "post_id": 37822504, "comment_id": 63108778, "body": "you can remove second sanity check by doing an <code>else return</code> on the first one"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1465940300, "post_id": 37822504, "comment_id": 63108800, "body": "@pm100 good point, and a more DRY answer. I will update that, thank you. It&#39;s fixed now."}, {"owner": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "edited": false, "score": 0, "creation_date": 1465942763, "post_id": 37822504, "comment_id": 63109706, "body": "Hey Patrick. I implemented your code but it didn&#39;t change anything in the array. I appreciate your help tho. I know to start i at 1 instead of 0 now and also know about size_t"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "reply_to_user": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "edited": false, "score": 0, "creation_date": 1465943731, "post_id": 37822504, "comment_id": 63110007, "body": "@JayJava please provide code demonstrating how you call the function."}, {"owner": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "edited": false, "score": 0, "creation_date": 1465945133, "post_id": 37822504, "comment_id": 63110385, "body": "@PatrickRoberts follow up question, how could I alter this to set the 2, 3, or n lowest elements to zero? Im thinking either surrounding this code around a while loop or creating a new function and calling this one"}], "tags": [], "owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "is_accepted": false, "score": 2, "last_activity_date": 1465940345, "last_edit_date": 1465940345, "creation_date": 1465939975, "answer_id": 37822504, "question_id": 37822400, "link": "https://stackoverflow.com/questions/37822400/find-smallest-element-of-an-array-and-set-its-index-to-0/37822504#37822504", "title": "find smallest element of an array and set its index to 0", "body": "<p>There's a few issues with your code, I'm surprised your compiler didn't explode on you.</p>\n\n<pre><code>void find_minimum(double a[], size_t n) {\n\n  size_t i, index;\n  double smallest;\n\n  // sanity check to make sure we're not accessing outside allocated memory\n  if (n &gt; 0) {\n    smallest = a[0];\n    index = 0;\n  } else {\n    // nothing left to do here\n    return;\n  }\n\n  // start at 1 because 0 is initial default\n  for (i = 1; i &lt; n; i++) {\n    if (a[i] &lt; smallest) {\n      smallest = a[i];\n      index = i;\n    }\n  }\n\n  // assign only the smallest index\n  a[index] = 0.0;\n}\n</code></pre>\n\n<p>Feel free to post comments if you have any questions.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "edited": false, "score": 0, "creation_date": 1465942894, "post_id": 37822692, "comment_id": 63109750, "body": "Thanks but this function didn&#39;t change any values of the array. I think I may have a complier issue because other solution didn&#39;t work"}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 1, "last_activity_date": 1465941191, "last_edit_date": 1465941191, "creation_date": 1465941015, "answer_id": 37822692, "question_id": 37822400, "link": "https://stackoverflow.com/questions/37822400/find-smallest-element-of-an-array-and-set-its-index-to-0/37822692#37822692", "title": "find smallest element of an array and set its index to 0", "body": "<p>If we're assuming only one smallest like the OP and some answers, we can also keep track of just the index of the smallest, instead of the value of the smallest, to keep things simple:</p>\n\n<pre><code>void find_minimum(double a[], size_t n) {\n    if (n &lt;= 0) {\n        return;\n    }\n\n    size_t smallest = 0;\n\n    for (size_t i = 1; i &lt; n; i++) {\n        if (a[i] &lt; a[smallest]) {\n            smallest = i;\n        }\n    }\n\n    a[smallest] = 0.0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "edited": false, "score": 0, "creation_date": 1465945194, "post_id": 37823224, "comment_id": 63110399, "body": "Thanks. This works and appreciate you addresses other cases"}], "tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": true, "score": 0, "last_activity_date": 1465944512, "last_edit_date": 1465944512, "creation_date": 1465943649, "answer_id": 37823224, "question_id": 37822400, "link": "https://stackoverflow.com/questions/37822400/find-smallest-element-of-an-array-and-set-its-index-to-0/37823224#37823224", "title": "find smallest element of an array and set its index to 0", "body": "<p>I'd like to address the case where there are more then one unique smallest value.</p>\n\n<p>In such a case, two loops are needed. One to find out the smallest value over the entire array and the other to set to zero all the elements with that value.</p>\n\n<p>I'll keep track of the minimum and maximum index where this value appears in the array to minimize the range of the second loop:</p>\n\n<pre><code>void set_smallest_to_zero(double a[], size_t n) {\n\n    if ( !a || !n ) {\n        return;\n    }\n\n    double smallest = a[0];\n    size_t min_index = 0,               \n           max_index = 0,\n           i;\n\n    // find the smallest values\n    for ( i = 1; i &lt; n; ++i ) {\n        if ( a[i] &gt; smallest ) {\n            continue;\n        } else if ( a[i] &lt; smallest ) {\n            smallest = a[i];\n            min_index = i;\n            max_index = i;\n        } else {                       //  a[i] == smallest\n            max_index = i;\n        }\n    }\n\n    // set to zero all the the minimum values\n    for ( i = min_index; i &lt;= max_index; ++i ) {\n        if ( a[i] == smallest ) {\n            a[i] = 0.0;\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/nf4Czr\" rel=\"nofollow\">HERE</a> there is a live example.</p>\n"}], "owner": {"reputation": 43, "user_id": 5987204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/651aae1a1c14d5c0e0e3af0fe88ea725?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Java", "link": "https://stackoverflow.com/users/5987204/jay-java"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 37823224, "answer_count": 3, "score": 1, "last_activity_date": 1465954472, "creation_date": 1465939545, "last_edit_date": 1465954472, "question_id": 37822400, "link": "https://stackoverflow.com/questions/37822400/find-smallest-element-of-an-array-and-set-its-index-to-0", "title": "find smallest element of an array and set its index to 0", "body": "<p>I am trying to create a C function that takes an array, finds the smallest element, and sets the value of that element to zero. </p>\n\n<p>This is my function so far. </p>\n\n<pre><code>void find_minimum(double a[], int n) {\n\n    int i, smallest = 0;\n\n    smallest = a[0];\n\n    for (i = 0; i &lt; n; i++) {\n        if (a[i] &lt; smallest) {\n            smallest = a[i];\n        }\n        a[i] = 0;\n    }\n}\n</code></pre>\n\n<p>When I run it, every index except the last one is zero, but I want only the smallest element to be zero.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "edited": false, "score": 2, "creation_date": 1465937440, "post_id": 37821720, "comment_id": 63107493, "body": "You should close files, especially before you reopen them. (This should not fix your problem, just a tip.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1465937741, "post_id": 37821720, "comment_id": 63107643, "body": "<code>scanw (&quot;%s&quot;,osp-&gt;name);</code> needs a limit to avoid reading too many characters.  With <code>name[16]</code>, maybe something like <code>scanw (&quot;%15s&quot;,osp-&gt;name);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1465937884, "post_id": 37821720, "comment_id": 63107712, "body": "BTW: first names and last names somethings have spaces in them making the <code>&quot;%s&quot;</code> inadequate."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1465937995, "post_id": 37821720, "comment_id": 63107758, "body": "I see a number of issue including <code>while (!feof(h))</code> and not using the return values from <code>fread()</code>.  Drop the <code>feof()</code> and use the return values instead."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465966647, "post_id": 37821720, "comment_id": 63115657, "body": "<code>while (!feof(h))</code> <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">is wrong</a>."}, {"owner": {"reputation": 316, "user_id": 7389293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWgS5.png?s=128&g=1", "display_name": "carloswm85", "link": "https://stackoverflow.com/users/7389293/carloswm85"}, "edited": false, "score": 0, "creation_date": 1530013610, "post_id": 37821720, "comment_id": 89075194, "body": "@user241968 What&#39;s the meaning of the word &quot;osp&quot; in the code? Please, comment on the meaning of the abbreviations."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6466458, "user_type": "registered", "profile_image": "https://graph.facebook.com/1353561041/picture?type=large", "display_name": "user241968", "link": "https://stackoverflow.com/users/6466458/user241968"}, "edited": false, "score": 0, "creation_date": 1466031431, "post_id": 37826354, "comment_id": 63154260, "body": "Thank you very much indeed! You were so kind. I didn&#39;t expect so soon an asnwer. Of course I was going to organize better the program using functions, but I was still trying to figure out the reason of my failure: after all, that was my first attempt, but I don&#39;t know if i were going to succeed without your help. Sorry for the Italian words in the code. As far as the getch() concerns, yes, its purpose was only debug."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 73, "user_id": 6466458, "user_type": "registered", "profile_image": "https://graph.facebook.com/1353561041/picture?type=large", "display_name": "user241968", "link": "https://stackoverflow.com/users/6466458/user241968"}, "edited": false, "score": 0, "creation_date": 1466038313, "post_id": 37826354, "comment_id": 63155910, "body": "You&#39;re welcome! One of my best friends is a nurse and she does similar analysis of patient records, so I could empathize. My friend is not a programmer and just uses spreadsheets, etc., so, for you, as a nurse, to write your own program [in C, no less] is to be commended. I had done a cut-and-paste of the [&quot;alien&quot; :-)] language into Google Translate, so I was able to read enough of the Italian to understand what was going on. I&#39;ve added an update to my answer to clarify things a bit more. Keep up the good work!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1466045868, "post_id": 37826354, "comment_id": 63157556, "body": "Second version in <code>read_archive</code>, you have <code>h = fopen(file, &quot;w&quot;);</code>  (<code>&quot;w&quot;</code>??)"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1466049230, "post_id": 37826354, "comment_id": 63158284, "body": "@DavidC.Rankin Thanks, David [fixed]. I fully tested v1 [with hex dumps of the file] but only compiled v2. I created <code>write_archive</code> first and then pasted the top ~6 lines to create <code>read_archive</code> along with the read loop body, but missed the <code>&quot;w&quot;</code> change. Actually, IIRC, I did test v2, but I was more concerned with the <code>add_new_elements</code> loop working and didn&#39;t notice that the old data got blasted"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1466049534, "post_id": 37826354, "comment_id": 63158339, "body": "Yes, I knew it was just a typo, but when I was reading over it, I thought I would go ahead and bring it to your attention <code>:)</code>"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1466051277, "post_id": 37826354, "comment_id": 63158856, "body": "@DavidC.Rankin With that sort of attention to detail, you&#39;d make a good attorney :-)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1466054239, "post_id": 37826354, "comment_id": 63159844, "body": "They hate me on technical cases <code>:)</code>"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1466055774, "post_id": 37826354, "comment_id": 63160385, "body": "@DavidC.Rankin No doubt. Most lawyers don&#39;t have the tech education to understand the issues. One who does can dispel the FUD [&quot;You&#39;re stealing my IP&quot;]. (e.g.) Oracle v. Google [java API]. I read Alsup&#39;s original slip opinion [IMO, he got it right], overturned at 9th circuit, and new jury trial [which Google just won, thankfully]. IMO [IANAL] Oracle was trying to use copyright to get patent protection against from scratch reimplementation of the JVM. But, the ruling that API is copyrightable with fair use exception is [still] less than desirable"}, {"owner": {"reputation": 73, "user_id": 6466458, "user_type": "registered", "profile_image": "https://graph.facebook.com/1353561041/picture?type=large", "display_name": "user241968", "link": "https://stackoverflow.com/users/6466458/user241968"}, "edited": false, "score": 0, "creation_date": 1466361320, "post_id": 37826354, "comment_id": 63272999, "body": "excuse me for the OT, but could you suggest to me a good IDE for C - C++ that works well with Debian/GNU Linux ? I&#39;m at home with Code::Blocks, but unfortunately the so called nightly build is buggy and crashes very often (the code completion utility is very useful but I must not type str..., otherwise it freezes), and that&#39;s very frustrating!."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 2, "last_activity_date": 1466463251, "last_edit_date": 1466463251, "creation_date": 1465966070, "answer_id": 37826354, "question_id": 37821720, "link": "https://stackoverflow.com/questions/37821720/saving-and-loading-a-linked-list-to-a-binary-file-c/37826354#37826354", "title": "saving and loading a linked list to a binary file (C)", "body": "<p>You were so close, I'm not even sure what was the true cause of failure, because, for the first cut, I just applied [most of] the fixes suggested by others and got a working program.</p>\n\n<p>Although it worked, I found that the way you did the \"one ahead\" <code>make_structure</code> call to be less flexible when you extend the program to do other things.</p>\n\n<p>For example, you'd have a hanging \"ghost\" record if, instead of adding a new record, you decided to <em>not</em> add a new record, but do some statistics on or manipulation of the existing ones.</p>\n\n<p>So, I created a second version of the program that has more isolation and generality.</p>\n\n<hr>\n\n<p>Here's the minimally changed version [please pardon the gratuitous style cleanup]:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ncurses.h&gt;\n\nstruct pat {\n    char surn[16];\n    char name[16];\n    struct pat *next;\n};\n\nstatic FILE *h;\nstatic struct pat *osp;\nstatic struct pat *first;\n\nstruct pat *make_structure(void);\n\nint\nmain()\n{\n    int rlen;\n\n    initscr();\n    raw();\n    keypad(stdscr, TRUE);\n    noecho();\n\n    clear();\n\n    osp = make_structure();\n    first = osp;\n\n    h = fopen(\"archivio\", \"r\");\n\n    if (h == NULL)\n        printw(\"Archivio inesistente\\n\");\n    else {\n        while (1) {\n            printw(\"Lungh. nome = %d\\n\", sizeof osp-&gt;name);\n\n            // leave early on EOF or badly formed entry\n            rlen = fread(osp-&gt;surn, sizeof osp-&gt;surn, 1, h);\n            if (rlen != 1)\n                break;\n\n            // leave early on EOF or badly formed entry\n            fread(osp-&gt;name, sizeof osp-&gt;name, 1, h);\n            if (rlen != 1)\n                break;\n\n            printw(\"Cognome: %s\\tNome: %s\\n\", osp-&gt;surn, osp-&gt;name);\n\n            osp-&gt;next = make_structure();\n            osp = osp-&gt;next;\n        }\n        fclose(h);\n    }\n\n    // NOTE: this just chews the first character (debug, I suppose?)\n#if 0\n    getch();\n#endif\n\n    // add new element\n    echo();\n    printw(\"Surname: \");\n    scanw(\"%15s\", osp-&gt;surn);\n    printw(\"Name: \");\n    scanw(\"%15s\", osp-&gt;name);\n\n    noecho();\n\n    h = fopen(\"archivio\", \"w\");\n\n    osp = first;\n    while (osp != NULL) {\n        fwrite(osp-&gt;surn, sizeof osp-&gt;surn, 1, h);\n        fwrite(osp-&gt;name, sizeof osp-&gt;name, 1, h);\n        osp = osp-&gt;next;\n    }\n\n    fclose(h);\n\n    return 0;\n}\n\nstruct pat *\nmake_structure(void)\n{\n    struct pat *a;\n\n    a = malloc(sizeof(struct pat));\n\n    // NOTE: do this for good measure\n    a-&gt;next = NULL;\n\n    return (a);\n}\n</code></pre>\n\n<hr>\n\n<p>Here's the more generalized version that may give you some ideas when you extend the capabilities of the program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ncurses.h&gt;\n\nstruct pat {\n    char surn[16];\n    char name[16];\n    struct pat *next;\n};\n\nstatic FILE *h;\nstatic struct pat *osp;\nstatic struct pat *first;\nstatic struct pat *prev;\n\nvoid read_archive(const char *file);\nvoid add_new_elements(void);\nvoid write_archive(const char *file);\nstruct pat *make_structure(void);\nvoid add_to_list(struct pat *pat);\n\nint\nmain()\n{\n\n    initscr();\n    raw();\n    keypad(stdscr, TRUE);\n    noecho();\n\n    clear();\n\n    read_archive(\"archivio\");\n\n    // NOTE: this just chews the first character (debug, I suppose?)\n#if 0\n    getch();\n#endif\n\n    // NOTE: instead of just automatically adding new elements, this might\n    // be replaced with a menu, such as:\n    //   Enter Operation:\n    //     (1) Add new names\n    //     (2) Calculate statistics\n    //     (3) Backup database\n    add_new_elements();\n\n    write_archive(\"archivio\");\n\n    return 0;\n}\n\n// read_archive -- read in archive\nvoid\nread_archive(const char *file)\n{\n    int rlen;\n\n    h = fopen(file, \"r\");\n\n    if (h == NULL)\n        printw(\"Archivio inesistente\\n\");\n\n    else {\n        while (1) {\n            osp = make_structure();\n\n            // leave early on EOF or badly formed entry\n            rlen = fread(osp-&gt;surn, sizeof osp-&gt;surn, 1, h);\n            if (rlen != 1)\n                break;\n\n            // leave early on EOF or badly formed entry\n            fread(osp-&gt;name, sizeof osp-&gt;name, 1, h);\n            if (rlen != 1)\n                break;\n\n            printw(\"Cognome: %s\\tNome: %s\\n\", osp-&gt;surn, osp-&gt;name);\n\n            add_to_list(osp);\n        }\n\n        // NOTE: this is _always_ for EOF or bad entry, so free it\n        free(osp);\n\n        fclose(h);\n    }\n}\n\n// add_new_elements -- prompt for new elements\nvoid\nadd_new_elements(void)\n{\n\n    echo();\n    while (1) {\n        osp = make_structure();\n\n        printw(\"Surname: \");\n        osp-&gt;surn[0] = 0;\n        scanw(\"%15s\", osp-&gt;surn);\n        if (osp-&gt;surn[0] == 0)\n            break;\n\n        printw(\"Name: \");\n        osp-&gt;name[0] = 0;\n        scanw(\"%15s\", osp-&gt;name);\n        if (osp-&gt;name[0] == 0)\n            break;\n\n        add_to_list(osp);\n    }\n    noecho();\n\n    free(osp);\n}\n\n// write_archive -- write out archive\nvoid\nwrite_archive(const char *file)\n{\n\n    h = fopen(file, \"w\");\n\n    for (osp = first;  osp != NULL;  osp = osp-&gt;next) {\n        fwrite(osp-&gt;surn, sizeof osp-&gt;surn, 1, h);\n        fwrite(osp-&gt;name, sizeof osp-&gt;name, 1, h);\n    }\n\n    fclose(h);\n}\n\nstruct pat *\nmake_structure(void)\n{\n    struct pat *a;\n\n    a = malloc(sizeof(struct pat));\n\n    // NOTE: do this for good measure\n    a-&gt;next = NULL;\n\n    return (a);\n}\n\nvoid\nadd_to_list(struct pat *pat)\n{\n\n    if (first == NULL)\n        first = pat;\n    else\n        prev-&gt;next = pat;\n\n    prev = pat;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>I was still trying to figure out the reason of my failure</p>\n</blockquote>\n\n<p>I didn't debug/single-step your original code because I thought that your linked list logic would need fixing and I wanted to get to that quickly. However, after I reviewed it, the logic was fine. Based on my best guess analysis, the probable failure was the <code>feof</code> which I had already changed to length check on <code>fread</code>.</p>\n\n<blockquote>\n  <p>Of course I was going to organize better the program using functions</p>\n</blockquote>\n\n<p>I assumed that you would. The splitup in the second program was more of a teaching tool to clarify and illustrate a principle and was <em>not</em> a critique of the modularity.</p>\n\n<p>In your original code, you <em>had</em> to add a new record because <code>osp</code> was empty but already linked into the list. Loosely, a \"zombie\" record, if you will.</p>\n\n<p>That is, the list had an entry linked in <em>before</em> it was filled in and validated. In other words, after the read loop, but before the user is prompted for the new entry, the <em>list</em> could be considered malformed (i.e. a [small] violation of \"contract programming\" or \"design-by-contract\" principles).</p>\n\n<p>The function splitup in the second program was just to emphasize this. In particular, by moving the read loop to a separate function, it illustrated/enforced design-by-contract.</p>\n\n<p>That is, upon entry, the list is whole and well formed [albeit, empty]. Upon return, it either is empty [if the input file does <em>not</em> exist] or has only well formed/complete records in it.</p>\n\n<p>In the second program, a partial/malformed entry is <em>never</em> linked in. The <code>add_to_list</code> is always done last [for a whole/complete record only].</p>\n\n<p>So, for both <code>read_archive</code> and <code>add_new_entries</code>, when they are called, they are both given a whole/complete list with only valid, fully formed records. That is the \"contract\" to <em>them</em>.</p>\n\n<p>And to fulfill their part of the \"contract\" these functions must leave things the same way, maintaining the list integrity upon exit. That is the functions' \"contract\" to the outside world</p>\n\n<hr>\n\n<p><strong>UPDATE #2:</strong></p>\n\n<blockquote>\n  <p>excuse me for the OT, but could you suggest to me a good IDE for C - C++ that works well with Debian/GNU Linux ?</p>\n</blockquote>\n\n<p>I may not be the best person to advise you on this as I don't use one. I was writing C long before they existed, so I have developed my own tools suite which is far more powerful than any IDE I've seen. Also, when I've looked at them, I could never find a way to mesh the two.</p>\n\n<blockquote>\n  <p>I'm at home with Code::Blocks, but unfortunately the so called nightly build is buggy and crashes very often</p>\n</blockquote>\n\n<p>If you're at home with codeblocks, but the nightly build is buggy, perhaps the simple solution is to switch your update to the \"stable\" tree, if that's possible. That may be the best \"short answer\".</p>\n\n<blockquote>\n  <p>(the code completion utility is very useful but I must not type str..., otherwise it freezes), and that's very frustrating!</p>\n</blockquote>\n\n<p>Maybe you could check the bug database and see if the problems you are experiencing are have known bug reports. If not, you could/should file one.</p>\n\n<hr>\n\n<p>I installed <code>codeblocks</code>. It looks clean and simple enough. I also installed <code>eclipse</code> and took a look at <code>kdevelop</code>. From several web pages, eclipse gets high marks, with <code>netbeans</code> a close second</p>\n\n<p>I tried to use them on source file I had lying around that was built with a Makefile. codeblocks was intuitive enough that I could get it going quickly. I had more trouble with the others. eclipse was originally designed by IBM for internal use and then released as a public service. It is well supported and mature.</p>\n\n<p>I had been running eclipse <em>without</em> CDT, but once I added that, <code>eclipse</code> gets my vote, because it appears to have enough features to control all of what I'm going to gripe about below ;-)</p>\n\n<p>An IDE is a somewhat personal choice [unless your company mandates one], so you should use what you like. In other words, try some and see what features they have and how they work. Here is a page that lists some: <a href=\"https://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments</a></p>\n\n<p>When selecting an IDE, you have to look at the \"most used\" features. The most frequent thing you do is scroll around in the source file. So, an editor should support the <code>hjkl</code> aliases to the arrow keys, like <code>vi</code> does. Having to move your right hand over to the arrow keys and back slows things down so much that it's a non-starter.</p>\n\n<p>eclipse uses <code>gvim</code> [graphical <code>vim</code>], so that's a plus.</p>\n\n<p>I'm <em>not</em> a fan of editing with some simple WYSIWYG editor pane that has only crude search/replace features. Likewise, <code>vim</code> allows regex search simply by typing <code>/</code>, so again, the most common operations are \"at your fingertips\"</p>\n\n<p>I don't use [nor <em>want</em>] autocompletion features. When I've tried them, they frequently get things wrong and it takes longer to backspace over what they've done. I am a very fast typist.</p>\n\n<p>I also turn off syntax highlighting and colorization of source. When entering source code, the colors change just about with every character entered because of what the editor <em>thinks</em> I'm typing (e.g. I'm typing a comment, but it thinks it's code, etc.) I've found that to be distracting.</p>\n\n<p>Also, when looking at the final result, I find that the colorized result to be \"too busy\" (i.e. more information I have to filter) rather than something that helps me see what I need to see.</p>\n\n<p>I am fairly insistent about indenting, breaking up long code blocks with blank lines to improve readibility. And, of course, good comments. To me, these are far more important than the coloring. I have a custom tool for the indent [As you may recall, when I posted the code above, it was reindented because I ran it through my tool before posting.</p>\n\n<p>Another feature is the graphical debugger. Is it full featured? For example, <code>ddd</code> is a graphical wrapper around [the very powerful] <code>gdb</code>. <code>ddd</code> provides a graphical wrapper and windows for common things, but still allows a direct text window for the <code>gdb</code> prompt, so you can manually type in the more advanced commands (e.g. <code>watch symbol</code>).</p>\n\n<p>Is the IDE extensible? Can you add plugins? Can you easily add/create your own?</p>\n\n<p>What source code control system does the IDE use? I've used <em>many</em> over the years and, now, am completely sold on <code>git</code>. So, if the IDE doesn't support <code>git</code>, it's a non-starter.</p>\n\n<p>It should be noted that <code>git</code> has <em>so</em> many features than they can <em>not</em> be contained in a GUI. So, the really powerful stuff uses a command line tool in a terminal window.</p>\n\n<p>My IDE? Several <code>xterm</code> windows, <code>vi</code>, <code>git</code>, and my tools suite [which is currently 250,000 lines of <code>perl</code> scripts ;-)]\nDoes the IDE force you to do things its way? How easy is it to import/export configuration, etc. to other external tools and IDEs?</p>\n\n<p>I have a very powerful build script of my own design. So, I'd want the IDE to, when I click on the \"build\" button to <em>not</em> do whatever it would normally do, but turn over control to <em>my</em> build script. Likewise for <em>any</em> other operation the IDE has to offer.</p>\n\n<p>Is the IDE portable and available on all major platforms: linux, OSX, and windows? In the past, that was another reason I shied away from IDEs. They would be available on only one platform. Or, since I was doing consulting work, I'd go into an environment that would not allow the IDE to be installed/used because of [sysadmin] policy.</p>\n"}], "owner": {"reputation": 73, "user_id": 6466458, "user_type": "registered", "profile_image": "https://graph.facebook.com/1353561041/picture?type=large", "display_name": "user241968", "link": "https://stackoverflow.com/users/6466458/user241968"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1434, "favorite_count": 1, "accepted_answer_id": 37826354, "answer_count": 1, "score": 7, "last_activity_date": 1466463251, "creation_date": 1465936922, "last_edit_date": 1465937768, "question_id": 37821720, "link": "https://stackoverflow.com/questions/37821720/saving-and-loading-a-linked-list-to-a-binary-file-c", "title": "saving and loading a linked list to a binary file (C)", "body": "<p>I'm trying to write and read a linked list from a binary file in C.\nMy aim is saving and loading resident data for a Nursing Home (actually, I'm a Nurse), in order to classify each resident via the Resource Utilization Groups. I've already done it for a fixed amount of residents (32, that is the capacity of the facility) using an array of structures, but now I need to do so for a variable set of residents, in order to do a statistic study. \nObviously for this first attempt i simplified the structure to the minimum, as the actual structure contains 109 data.</p>\n\n<p>I'm very close to the solution but something doesn't work, that is, each element of the saved list is alternated with a void one.This code should read the list from the binary file, show it on the terminal, add a new element, save the list. Of course each procedure should be put in a function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ncurses.h&gt;\n\nstruct pat\n{\n    char surn [16];\n    char name [16];\n    struct pat *next;\n};\n\nstatic FILE *h;\nstatic struct pat *osp;\nstatic struct pat *first;\n\nstruct pat *make_structure (void);\n\nint main()\n{\n    initscr();\n    raw();\n    keypad (stdscr, TRUE);\n    noecho();\n\n    clear();\n\n    osp=make_structure();\n    first=osp;\n\n    h=fopen (\"archivio\",\"r\");\n\n    if (h==NULL)\n        printw (\"Archivio inesistente\\n\");\n    else\n    {\n        while (!feof(h))\n        {\n            printw (\"Lungh. nome = %d\\n\",sizeof osp-&gt;name);\n            fread (osp-&gt;surn,sizeof osp-&gt;surn,1,h);\n            fread (osp-&gt;name,sizeof osp-&gt;name,1,h);\n            printw (\"Cognome: %s\\tNome: %s\\n\",osp-&gt;surn,osp-&gt;name);\n            osp-&gt;next=make_structure();\n            osp=osp-&gt;next;\n        }\n    }\n\n    getch();\n\n    echo();\n    printw (\"Surname: \");\n    scanw (\"%s\",osp-&gt;surn);\n    printw (\"\\nName: \");\n    scanw (\"%s\",osp-&gt;name);\n\n    noecho();\n\n    osp=first;\n\n    h=fopen (\"archivio\",\"w\");\n\n    while (osp != NULL)\n    {\n        fwrite (osp-&gt;surn,sizeof osp-&gt;surn,1,h);\n        fwrite (osp-&gt;name,sizeof osp-&gt;name,1,h);\n        osp=osp-&gt;next;\n    }\n\n    return 0;\n}\n\nstruct pat *make_structure(void)\n{\n    struct pat *a;\n    a = (struct pat *)malloc(sizeof(struct pat));\n    return (a);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465938526, "post_id": 37821634, "comment_id": 63108000, "body": "Functions are always static. You might confuse it with the <code>static</code> storage class specifier which determines the linkage for functions."}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 1454667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f00a493358701e8e243bfd747f0a66d?s=128&d=identicon&r=PG", "display_name": "JDW", "link": "https://stackoverflow.com/users/1454667/jdw"}, "edited": false, "score": 0, "creation_date": 1465942535, "post_id": 37821729, "comment_id": 63109627, "body": "Thanks for the clarification! I would usually mark such functions as static, but was wondering because I have seen static functions (i.e. functions with internal linkage) described as being inaccessible from other translation units. I guess &quot;inaccessible&quot; just means not visible (i.e. the symbol isn&#39;t exported and can&#39;t be directly referred to in another translation unit), though. It does make sense that the compiler would refrain from doing incompatible optimizations when it sees that a pointer to the function is passed to an outside function."}], "tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": true, "score": 2, "last_activity_date": 1465937278, "last_edit_date": 1465937278, "creation_date": 1465936961, "answer_id": 37821729, "question_id": 37821634, "link": "https://stackoverflow.com/questions/37821634/using-a-file-static-function-as-a-callback-from-a-different-translation-unit/37821729#37821729", "title": "Using a file-static function as a callback from a different translation unit", "body": "<p>Yes, this is perfectly fine code and even good code. There is no need for your <code>test</code> callback to be global.</p>\n\n<p>The compiler is responsible to ensure that the function isn't called outside the translation unit, before doing any optimizations that would affect calling it from outside.</p>\n\n<p>If it sees that a pointer to the function is passed to an external function, it has to refrain from doing incompatible optimizations to the function.</p>\n\n<p>Thus, the only effect is that the object file won't export a <code>test</code> symbol (This is termed <a href=\"http://en.cppreference.com/w/c/language/storage_duration\" rel=\"nofollow\">Internal Linkage</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1465937648, "creation_date": 1465937648, "answer_id": 37821892, "question_id": 37821634, "link": "https://stackoverflow.com/questions/37821634/using-a-file-static-function-as-a-callback-from-a-different-translation-unit/37821892#37821892", "title": "Using a file-static function as a callback from a different translation unit", "body": "<p>You wrote, </p>\n\n<blockquote>\n  <p>Now, this might not be the best practice, since the writer of a.c probably doesn't expect test() to be called from another file and the variable a modified, but is this legal C code? </p>\n</blockquote>\n\n<p>If the writer did not want his <code>test()</code> function to be called from another file, he should not have passed a pointer to it to an outside module!</p>\n\n<p>When the writer called  <code>set_callback(test);</code> he knew he was passing his static method to an outside module, and giving that outside module permission to call it.</p>\n\n<p>The point is that the author is in charge of the <code>test</code> method and where it goes.  He's not prevented from doing anything, but he can control where his data goes; and he <strong><em>chose</em></strong> to pass it to an outsider.</p>\n"}], "owner": {"reputation": 440, "user_id": 1454667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f00a493358701e8e243bfd747f0a66d?s=128&d=identicon&r=PG", "display_name": "JDW", "link": "https://stackoverflow.com/users/1454667/jdw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 37821729, "answer_count": 2, "score": 2, "last_activity_date": 1465937648, "creation_date": 1465936553, "last_edit_date": 1465936865, "question_id": 37821634, "link": "https://stackoverflow.com/questions/37821634/using-a-file-static-function-as-a-callback-from-a-different-translation-unit", "title": "Using a file-static function as a callback from a different translation unit", "body": "<p>Consider the following code:</p>\n\n<p><strong>a.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"b.h\"\n\nstatic int a = 41;\n\nstatic void test(void){\n    a++;\n    printf(\"a: %d\\n\", a);\n}\n\nint main(void){\n    set_callback(test);\n    call();\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>b.c</strong></p>\n\n<pre><code>static void (*callback)(void);\n\nvoid set_callback(void (*func)(void)){\n    callback = func;\n}\n\nvoid call(void){\n    if (callback){\n        callback();\n    }\n}\n</code></pre>\n\n<p><strong>b.h</strong></p>\n\n<pre><code>void set_callback(void (*func)(void));\nvoid call(void);\n</code></pre>\n\n<p>This compiles without warnings with <code>-Wall</code> and prints out <code>a: 42</code> as expected.</p>\n\n<p>Now, this might not be the best practice, since the writer of <code>a.c</code> probably doesn't expect <code>test()</code> to be called from another file and the variable <code>a</code> modified, but is this legal C code? Will it work portably on different platforms and compilers?</p>\n"}, {"tags": ["c", "variables", "initialization"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1465937629, "post_id": 37821601, "comment_id": 63107584, "body": "Undefined Behaviour is Undefined Behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5636504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42888b28a254d8e893d59e8b3cfe3b1a?s=128&d=identicon&r=PG&f=1", "display_name": "112", "link": "https://stackoverflow.com/users/5636504/112"}, "edited": false, "score": 0, "creation_date": 1465936601, "post_id": 37821623, "comment_id": 63107035, "body": "but UB would result in a random character, wouldn&#39;t it? And the variable wasn&#39;t completely uninitialized; it was written to by <code>getword</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 75, "user_id": 5636504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42888b28a254d8e893d59e8b3cfe3b1a?s=128&d=identicon&r=PG&f=1", "display_name": "112", "link": "https://stackoverflow.com/users/5636504/112"}, "edited": false, "score": 2, "creation_date": 1465939678, "post_id": 37821623, "comment_id": 63108505, "body": "@ProHackr112 &quot;undefined&quot; doesn&#39;t mean &quot;random&quot;"}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 0, "last_activity_date": 1465936502, "creation_date": 1465936502, "answer_id": 37821623, "question_id": 37821601, "link": "https://stackoverflow.com/questions/37821601/uninitialized-char-defaulting-to/37821623#37821623", "title": "Uninitialized char defaulting to @", "body": "<p>Reading from an uninitialized local variable invokes <em>Undefined Behavior</em>. The program is free to do anything it wants.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1465937558, "last_edit_date": 1465937558, "creation_date": 1465937238, "answer_id": 37821793, "question_id": 37821601, "link": "https://stackoverflow.com/questions/37821601/uninitialized-char-defaulting-to/37821793#37821793", "title": "Uninitialized char defaulting to @", "body": "<p>Original code lacks clearing <code>buf[]</code> and even <code>char buf[100] = {0};</code> does not insure null character termination when 100 characters are read.   Else the <code>printf(\"buf is %s\\n\",buf);</code> attempts to print a potentially invalid string.</p>\n\n<p>Further, on subsequent calls <code>char buf[100] = {0};</code> does not re-zero the array.</p>\n\n<p>Better to use <code>getword(buf,'&gt;',sizeof buf - 1,f);</code> and have <code>getword()</code> append the <code>'\\0'</code>. </p>\n\n<hr>\n\n<blockquote>\n  <p>Why would it default to @</p>\n</blockquote>\n\n<p>It is undefined behavior.  In your case, likely the <code>buf[]</code> contained the <code>'@'</code>, but anything may have happened.  It did not <em>default</em> to <code>'@'</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 1, "last_activity_date": 1465937849, "last_edit_date": 1465937849, "creation_date": 1465937273, "answer_id": 37821797, "question_id": 37821601, "link": "https://stackoverflow.com/questions/37821601/uninitialized-char-defaulting-to/37821797#37821797", "title": "Uninitialized char defaulting to @", "body": "<p>you need to zero terminate your string</p>\n\n<pre><code>int getword(char *fmt, int delim, int max, FILE *f)\n{\n    int c, x = 0;\n    while (((c = getc(f)) != EOF) &amp;&amp; (c != delim) &amp;&amp; (x &lt; max))\n            fmt[x++] = c;\n    fmt[x] = 0;\n    return x;\n}\n</code></pre>\n\n<p>you are getting an '@' because thats what was left over in memory, almost certainly the shell or loader. And since the shell or loader is the same every time you are getting the same random piece of junk. If you jiggle your program around a bit (add a few extra variables before buff ) you will get a different piece of junk.</p>\n"}], "owner": {"reputation": 75, "user_id": 5636504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42888b28a254d8e893d59e8b3cfe3b1a?s=128&d=identicon&r=PG&f=1", "display_name": "112", "link": "https://stackoverflow.com/users/5636504/112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 37821797, "answer_count": 3, "score": -2, "last_activity_date": 1480870900, "creation_date": 1465936407, "last_edit_date": 1480870900, "question_id": 37821601, "link": "https://stackoverflow.com/questions/37821601/uninitialized-char-defaulting-to", "title": "Uninitialized char defaulting to @", "body": "<p>So I wrote this function:</p>\n\n<pre><code>int getword(char *fmt, int delim, int max, FILE *f)\n{\n    int c, x = 0;\n    while (((c = getc(f)) != EOF) &amp;&amp; (c != delim) &amp;&amp; (x &lt; max))\n            fmt[x++] = c;\n    return x;\n}\n</code></pre>\n\n<p>Whenever I check the function, there is always an <code>@</code> at the end.</p>\n\n<pre><code>buf = color 32@\n/* segmentation fault */\n</code></pre>\n\n<p>and no matter what I did to change it the variable would always end with <code>@</code>. I fixed the problem by initializing the variable:</p>\n\n<pre><code>char buf[100] = {0};\n</code></pre>\n\n<p>but ever since I have been wondering why the character was always a <code>@</code> if an uninitialized <code>char</code> can be anything in its range. Why would it default to <code>@</code>?</p>\n"}, {"tags": ["c", "x86", "atomic", "inline-assembly", "compare-and-swap"], "comments": [{"owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "edited": false, "score": 1, "creation_date": 1465936961, "post_id": 37821072, "comment_id": 63107222, "body": "Does <a href=\"http://stackoverflow.com/questions/6756985/correct-way-to-wrap-cmpxchg8b-in-gcc-inline-assembly-32-bits\" title=\"correct way to wrap cmpxchg8b in gcc inline assembly 32 bits\">stackoverflow.com/questions/6756985/&hellip;</a> help?"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 1, "creation_date": 1465943179, "post_id": 37821072, "comment_id": 63109838, "body": "Have you read the docs for cmpxchg8b: <code>Compare EDX:EAX with m64. If equal, set ZF and load ECX:EBX into m64. Else, clear ZF and load m64 into EDX:EAX.</code> Since you aren&#39;t loading any particular value into EDX (or EBX), I assume the compare always fails, meaning the asm does nothing, and <code>prev</code> (init to 0 in unoptimized builds) is returned unchanged. Additionally, the memory address you are passing to cmpxchg8b is <code>prev</code> (aka %0), not ptr, so ptr is never used. Which is probably just as well since *ptr (vs ptr) is probably not a valid memory address."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1465943281, "post_id": 37821072, "comment_id": 63109878, "body": "Also, how long are <code>unsigned long</code> on your platform (you say x86)? If the answer is not 8 bytes, you need to reconsider using cmpxchg8b. What is wrong?  I&#39;m afraid it&#39;s nearly everything."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6448088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06c07e51de39525cc2ca18728729f9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/6448088/ritesh"}, "edited": false, "score": 0, "creation_date": 1465936953, "post_id": 37821675, "comment_id": 63107218, "body": "These two functions you have mentioned ,they return boolean values. For my implementation I need old value pointed *ptr."}, {"owner": {"reputation": 396, "user_id": 2066345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7183db5112d49c71bdc57fbbfe6d49?s=128&d=identicon&r=PG", "display_name": "Ed Schouten", "link": "https://stackoverflow.com/users/2066345/ed-schouten"}, "reply_to_user": {"reputation": 57, "user_id": 6448088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06c07e51de39525cc2ca18728729f9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/6448088/ritesh"}, "edited": false, "score": 0, "creation_date": 1465937135, "post_id": 37821675, "comment_id": 63107320, "body": "These functions can also be used for that purpose. The variable pointed to by the second argument will be overwritten to contain the old value."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 57, "user_id": 6448088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06c07e51de39525cc2ca18728729f9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/6448088/ritesh"}, "edited": false, "score": 1, "creation_date": 1465939160, "post_id": 37821675, "comment_id": 63108267, "body": "@Ritesh: Please edit your question and add why you cannot use standard features of the language and have to revert to Assembler code. In general it is a bad idea to write your own stubs, as they might interfere with compiler optimisation and result in worse code. Not to mention it is not portable. There are application notes to be found how to emulate CAS with stdatomics. But actually, the standard provides more useful functions which make that CAS-emulation likely superfluous."}], "tags": [], "owner": {"reputation": 396, "user_id": 2066345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7183db5112d49c71bdc57fbbfe6d49?s=128&d=identicon&r=PG", "display_name": "Ed Schouten", "link": "https://stackoverflow.com/users/2066345/ed-schouten"}, "is_accepted": false, "score": 2, "last_activity_date": 1465936737, "creation_date": 1465936737, "answer_id": 37821675, "question_id": 37821072, "link": "https://stackoverflow.com/questions/37821072/not-getting-expected-output-using-cmpxchg8b-for-unsigned-long/37821675#37821675", "title": "Not getting expected output using cmpxchg8b for unsigned long", "body": "<p>Sorry for not answering your question directly, but my question is: why not use <a href=\"http://en.cppreference.com/w/c/atomic\" rel=\"nofollow\">C11's <code>&lt;stdatomic.h&gt;</code> or C++11's <code>&lt;atomic&gt;</code></a>? It's a lot less error-prone than writing your own functions and has the advantage that you're not targeting a specific hardware architecture or compiler.</p>\n\n<p>In your case you should either be using <code>atomic_compare_exchange_weak()</code> or <code>atomic_compare_exchange_strong()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1465958241, "post_id": 37825052, "comment_id": 63113400, "body": "hehe, I think I&#39;ll leave this one alone; looks like you have it covered.  Despite my avatar, I do sometimes need to restrain myself from trying to correct <i>everything</i> that&#39;s wrong on the Internet.  Although, are you sure you need a <code>&quot;memory&quot;</code> clobber?  If you use a <code>&quot;+m&quot;</code> operand for the value in memory that might or might not be modified, the compiler will have to reload it.  Probably using a <code>volatile moo*</code> is a good choice."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1465958600, "post_id": 37825052, "comment_id": 63113480, "body": "Also, you could avoid the <code>union</code> by using a <code>&quot;+A&quot;</code> constraint, meaning the combination of <code>edx:eax</code> as a 64bit value.  But it is clearer, and portable to x86-64 (<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html\" rel=\"nofollow noreferrer\">where a 64bit value will just go into either rax or rdx</a>)."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1465959218, "post_id": 37825052, "comment_id": 63113622, "body": "@MichaelPetch: Hey, I linked to both my wiki and my docs.  Wouldn&#39;t want to blow my horn <i>too</i> much."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1465959327, "post_id": 37825052, "comment_id": 63113656, "body": "@PeterCordes: Consider code where thread 1 is handing work off to a worker thread.  It populates a struct and uses cas to add it to a linked list.  You MUST ensure that the struct is flushed BEFORE adding the node to the list (ie memory clobber), since the &#39;other&#39; thread could start accessing it the instant the cmpxchg8b is complete. The clobber isn&#39;t needed for the moo ptr, it&#39;s needed for everything else."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1465960174, "post_id": 37825052, "comment_id": 63113855, "body": "@PeterCordes: Just couldn&#39;t help yourself, eh?&lt;g&gt;  I&#39;m not a big fan of <code>+A</code>.  For teaching purposes (like the current context), I just can&#39;t see it.  As for <code>volatile</code>, hmm.  Given the &quot;+m&quot;, I don&#39;t know what more it could buy you.  From a self-documenting standpoint, maybe.  Could the compiler need this for some reason?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1465969865, "post_id": 37825052, "comment_id": 63116918, "body": "@DavidWohlferd: oh right, to get release semantics with a compiler memory barrier.  I guess it&#39;s a good idea to keep things simple by making it a CAS with sequential-consistency semantics, rather than relaxed, since that would probably lead someone to include a separate <code>mfence</code> instead of just using a compiler memory barrier.  (There&#39;s no standard way to express the fact that it&#39;s a full memory barrier at the asm level, but relaxed as far as compile-time reordering, so only a compiler barrier is needed to strengthen it)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1465970146, "post_id": 37825052, "comment_id": 63117049, "body": "I was thinking of <code>volatile</code> just as a self-documenting thing, and to prevent any overly-clever compiler from loading/storing to it outside the asm.  Besides, if you need to spin on it to wait for some condition before cmpxchg8b, you should do that <a href=\"http://stackoverflow.com/a/37246263/224132\">with normal loads (and a <code>pause</code> instruction)</a>.  8-byte atomic loads/stores are possible in 32bit mode using SSE <code>movq</code>, or <code>fild</code>/<code>fistp</code>, and gcc will actually use that.  You only need cmpxchg8b for an atomic RMW."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1465971612, "post_id": 37825052, "comment_id": 63117669, "body": "Since all these recent cmpxchg?b questions seem to refer to <code>node_lf</code>, adding the memory clobber seemed prudent.  You&#39;ve got a good point on volatile. Doesn&#39;t seem worth editing for just that, but if something else comes up, I&#39;ll make sure to add it. OP hasn&#39;t accepted the answer yet, so there may be other changes."}], "tags": [], "owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "is_accepted": true, "score": 4, "last_activity_date": 1465957245, "creation_date": 1465957245, "answer_id": 37825052, "question_id": 37821072, "link": "https://stackoverflow.com/questions/37821072/not-getting-expected-output-using-cmpxchg8b-for-unsigned-long/37825052#37825052", "title": "Not getting expected output using cmpxchg8b for unsigned long", "body": "<p>Let me start by saying \"Using inline asm is a bad idea.\"  And let me repeat that \"Using inline asm is a bad idea.\"  You could write an entire <a href=\"https://gcc.gnu.org/wiki/DontUseInlineAsm\" rel=\"nofollow\">wiki entry</a> about why using inline asm is a bad idea.  Please consider using builtins (like gcc's <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.5.4/gcc/Atomic-Builtins.html\" rel=\"nofollow\">__sync_bool_compare_and_swap</a>) or libraries like &lt;atomic&gt; instead.</p>\n\n<p>If you are writing production software, the risks from using inline asm are almost certainly greater than any benefit.  If you are writing for educational purposes, then read on.</p>\n\n<p>(For a further illustration of why you shouldn't use inline asm, wait for Michael or Peter to show up and point out all the things wrong with this code.  It's <em>really</em> hard, even for people who know this stuff, to get it right.)</p>\n\n<p>Here is some code showing how to use <code>cmpxchg8b</code>.  It is simple, but should be sufficient to give a general idea.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// Simple struct to break up the 8 byte value into 32bit chunks.\ntypedef union {\n  struct {\n     unsigned int lower;\n     unsigned int upper;\n  };\n  unsigned long long int f;\n} moo;\n\nunsigned char cas(moo *ptr, moo *oldval, const moo *newval)\n{\n   unsigned char result;\n\n#ifndef __GCC_ASM_FLAG_OUTPUTS__\n\n   asm (\"lock cmpxchg8b %[ptr]\\n\\t\"\n        \"setz %[result]\"\n        : [result] \"=q\" (result), [ptr] \"+m\" (*ptr),\n          \"+d\" (oldval-&gt;upper), \"+a\" (oldval-&gt;lower)\n        : \"c\" (newval-&gt;upper), \"b\" (newval-&gt;lower)\n        : \"cc\", \"memory\");\n\n#else\n\n   asm (\"lock cmpxchg8b %[ptr]\"\n        : [result] \"=@ccz\" (result), [ptr] \"+m\" (*ptr),\n          \"+d\" (oldval-&gt;upper), \"+a\" (oldval-&gt;lower)\n        : \"c\" (newval-&gt;upper), \"b\" (newval-&gt;lower)\n        : \"memory\");\n\n#endif\n\n   return result;\n}\n\nint main()\n{\n   moo oldval, newval, curval;\n   unsigned char ret;\n\n   // Will not change 'curval' since 'oldval' doesn't match.\n   curval.f = -1;\n   oldval.f = 0;\n   newval.f = 1;\n\n   printf(\"If curval(%u:%u) == oldval(%u:%u) \"\n          \"then write newval(%u:%u)\\n\",\n          curval.upper, curval.lower,\n          oldval.upper, oldval.lower,\n          newval.upper, newval.lower);\n\n   ret = cas(&amp;curval, &amp;oldval, &amp;newval);\n\n   if (ret)\n      printf(\"Replace succeeded: curval(%u:%u)\\n\",\n             curval.upper, curval.lower);\n   else\n      printf(\"Replace failed because curval(%u:%u) \"\n             \"needed to be (%u:%u) (which cas has placed in oldval).\\n\",\n             curval.upper, curval.lower,\n             oldval.upper, oldval.lower);\n\n   printf(\"\\n\");\n\n   // Now that 'curval' equals 'oldval', newval will get written.\n   curval.lower = 1234; curval.upper = 4321;\n   oldval.lower = 1234; oldval.upper = 4321;\n   newval.f = 1;\n\n   printf(\"If curval(%u:%u) == oldval(%u:%u) \"\n          \"then write newval(%u:%u)\\n\",\n          curval.upper, curval.lower,\n          oldval.upper, oldval.lower,\n          newval.upper, newval.lower);\n\n   ret = cas(&amp;curval, &amp;oldval, &amp;newval);\n\n   if (ret)\n      printf(\"Replace succeeded: curval(%u:%u)\\n\",\n             curval.upper, curval.lower);\n   else\n      printf(\"Replace failed because curval(%u:%u) \"\n             \"needed to be (%u:%u) (which cas has placed in oldval).\\n\",\n             curval.upper, curval.lower,\n             oldval.upper, oldval.lower);\n\n}\n</code></pre>\n\n<p>A few points:</p>\n\n<ul>\n<li>If the cas fails (because the values don't match), the return value from the function is 0, and the value you <em>need</em> to use is returned in oldval.  This makes trying again simple.  Note that if you are running multi-threaded (which you must be or you wouldn't be using <code>lock cmpxchg8b</code>), a second attempt could conceivable fail as well, since the 'other' thread could have beaten you to the write again.</li>\n<li>The <code>__GCC_ASM_FLAG_OUTPUTS__</code> define is available on newer builds of gcc (6.x+).  It allows you to skip doing the <code>setz</code> and use the flags directly.  See the gcc <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#FlagOutputOperands\" rel=\"nofollow\">docs</a> for details.</li>\n</ul>\n\n<p>As for how it works:</p>\n\n<p>When we call <code>cmpxchg8b</code>, we pass it a pointer to memory.  It is going to compare the (8 byte) value that is in that memory location to the 8 bytes in edx:eax.  If they match, then it will write the 8 bytes in ecx:ebx to the memory location and the <code>zero</code> flag will be set.  If they don't match, then the current value will be returned in edx:eax and the <code>zero</code> flag will be cleared.</p>\n\n<p>So, compare that with the code:</p>\n\n<pre><code>   asm (\"lock cmpxchg8b %[ptr]\"\n</code></pre>\n\n<p>Here we are passing the pointer to the 8 bytes to <code>cmpxchg8b</code>.</p>\n\n<pre><code>        \"setz %[result]\"\n</code></pre>\n\n<p>Here we are storing the contents of the <code>zero</code> flag set by <code>cmpxchg8b</code> into (result).</p>\n\n<pre><code>        : [result] \"=q\" (result), [ptr] \"+m\" (*ptr),\n</code></pre>\n\n<p>Specify that (result) is an output (=), and that it must be a byte register (q).  Also, the memory pointer is an in+out (+) since we will be both reading it and writing to it.</p>\n\n<pre><code>          \"+d\" (oldval-&gt;upper), \"+a\"(oldval-&gt;lower)\n</code></pre>\n\n<p>The + signs again indicate that these values are in+out.  This is necessary since if the comparison fails, edx:eax will be overwritten with the current value from ptr.</p>\n\n<pre><code>        : \"c\" (newval-&gt;upper), \"b\"(newval-&gt;lower)\n</code></pre>\n\n<p>These values are input-only.  The <code>cmpxchg8b</code> isn't going to change their values so we put them after the second colon.</p>\n\n<pre><code>        : \"cc\", \"memory\");\n</code></pre>\n\n<p>Since we are changing the flags, we need to inform the compiler via \"cc\".  The \"memory\" constraint may not be necessary, depending on exactly what cas is being used for.  It's possible that thread 1 is notifying thread 2 that something is ready for processing.  In that case, you want to make absolutely sure gcc doesn't have any values in registers that it is planning to write to memory later.  It absolutely must flush them all to memory <em>before</em> executing the <code>cmpxchg8b</code>.</p>\n\n<p>The <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow\">gcc docs</a> describe in detail the workings of the extended asm statement.  If parts of this explanation are still unclear, some reading might help.</p>\n\n<p>BTW in case I forgot to mention, writing inline asm is a bad idea...</p>\n"}], "owner": {"reputation": 57, "user_id": 6448088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06c07e51de39525cc2ca18728729f9b2?s=128&d=identicon&r=PG&f=1", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/6448088/ritesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 37825052, "answer_count": 2, "score": -1, "last_activity_date": 1465957245, "creation_date": 1465934478, "question_id": 37821072, "link": "https://stackoverflow.com/questions/37821072/not-getting-expected-output-using-cmpxchg8b-for-unsigned-long", "title": "Not getting expected output using cmpxchg8b for unsigned long", "body": "<p>I am trying to write a simple compare and swap inline assembly code. Here is my code </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\nstatic inline unsigned long\ncas(volatile unsigned long* ptr, unsigned long old, unsigned long _new)\n{\n    unsigned long prev=0;\n    asm volatile(\"lock cmpxchg8b %0;\"\n                 : \"=m\"(prev)\n                 : \"m\"(*ptr),\"a\"(old),\"c\"(_new)\n                 );\n    return prev;\n}\n\nint main()\n{\n\n    unsigned long *a;\n    unsigned long b=5,c;\n    a=&amp;b;\n        c=cas(a,b,6);\n    printf(\"%lu\\n\",c);\n    return 0;\n}\n</code></pre>\n\n<p>This code should ideally print 5 but it is printing 0. What is wrong in my code ?Please help.</p>\n"}, {"tags": ["c", "pointers", "structure", "fread"], "comments": [{"owner": {"reputation": 12856, "user_id": 3708596, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Okb7e.jpg?s=128&g=1", "display_name": "Everettss", "link": "https://stackoverflow.com/users/3708596/everettss"}, "edited": false, "score": 2, "creation_date": 1465934530, "post_id": 37820889, "comment_id": 63105991, "body": "It will be easier to help you if you don&#39;t use Polish in code."}, {"owner": {"reputation": 303, "user_id": 5062064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6pnV.jpg?s=128&g=1", "display_name": "mw215", "link": "https://stackoverflow.com/users/5062064/mw215"}, "edited": false, "score": 0, "creation_date": 1465939946, "post_id": 37820889, "comment_id": 63108625, "body": "<code>fread</code> reads data from the given stream into an array. In your code, however, the first argument to <code>fread</code> is a struct. This is problematic due to padding issue; a better approach is to read the file header into an array of <code>unsigned char</code>."}, {"owner": {"reputation": 303, "user_id": 5062064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D6pnV.jpg?s=128&g=1", "display_name": "mw215", "link": "https://stackoverflow.com/users/5062064/mw215"}, "edited": false, "score": 0, "creation_date": 1465939998, "post_id": 37820889, "comment_id": 63108656, "body": "A look at <a href=\"http://stackoverflow.com/questions/37779302/fread-into-struct-reads-data-incorrectly/37780151\">this</a> might be of help."}, {"owner": {"reputation": 13, "user_id": 6466217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45c69724e40a266901542cfa2866064?s=128&d=identicon&r=PG&f=1", "display_name": "Aghero", "link": "https://stackoverflow.com/users/6466217/aghero"}, "edited": false, "score": 0, "creation_date": 1466023304, "post_id": 37820889, "comment_id": 63151030, "body": "Thank you all for your help. Yeah my bad. Next time I&#39;ll translate all names into english. Sorry for that"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6466217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45c69724e40a266901542cfa2866064?s=128&d=identicon&r=PG&f=1", "display_name": "Aghero", "link": "https://stackoverflow.com/users/6466217/aghero"}, "edited": false, "score": 0, "creation_date": 1466023245, "post_id": 37820954, "comment_id": 63151010, "body": "Thank you Sir. Everything works as intended right now."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1465934095, "creation_date": 1465934095, "answer_id": 37820954, "question_id": 37820889, "link": "https://stackoverflow.com/questions/37820889/fread-and-pointer-to-structures-in-functions/37820954#37820954", "title": "Fread and pointer to structures in functions", "body": "<p><code>fread</code> needs the address of a buffer.  So in your second attempt, pass the address of <code>fheader-&gt;sygnatura</code>:</p>\n\n<pre><code>fread(&amp;fheader-&gt;sygnatura,2,1,fp1);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6466217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45c69724e40a266901542cfa2866064?s=128&d=identicon&r=PG&f=1", "display_name": "Aghero", "link": "https://stackoverflow.com/users/6466217/aghero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 37820954, "answer_count": 1, "score": 0, "last_activity_date": 1465934196, "creation_date": 1465933796, "last_edit_date": 1465934196, "question_id": 37820889, "link": "https://stackoverflow.com/questions/37820889/fread-and-pointer-to-structures-in-functions", "title": "Fread and pointer to structures in functions", "body": "<p>I am working at program reading bitmap. The thing is I wrote everything in main and need to spread out code to functions. I am reading information using fread using standard structure adressing but I somehow cannot acces information after leaving function. So I tried adressing structure via pointers, but fread doesn't let me to do so. I've read that fread isn't designed to do it via pointers. But i cannot confirm it. And that's my question. How do I do it via pointers? And why my first try doesn't work outside function?</p>\n\n<pre><code>void odczyt_pliku_bmp(struct FileHeader fheader, struct MapHeader mheader, char *nazwa) {\n    FILE *fp1;\n    fp1 =fopen(nazwa,\"rb\");\n\n    if(fp1)\n    {\n        fread(&amp;fheader.sygnatura,2,1,fp1);\n        //...\n\n\n        printf(\"%d\\n\",fheader.sygnatura);//Checking. Everything seems right there\n\n    }\n    else\n    {\n        printf(\"Error\");\n    }\n    fclose(fp1);\n}\n</code></pre>\n\n<p>And main:</p>\n\n<pre><code>int main() {\n    struct FileHeader fheader;\n    struct MapHeader mheader;\n\n    char nazwapliku, *wczyt_nazwa =&amp;nazwapliku;\n    printf(\"Podaj nazwe pliku bitmapy: \");\n    scanf(\"%s\",wczyt_nazwa);\n\n    odczyt_pliku_bmp(fheader, mheader, wczyt_nazwa);\n    printf(\"%d\\n\",fheader.sygnatura);// And there is random trash\n\n    return 0;\n}\n</code></pre>\n\n<p>Another try using pointers:</p>\n\n<pre><code>void odczyt_pliku_bmp(struct FileHeader *fheader, struct MapHeader *mheader, char *nazwa) {\n    FILE *fp1;\n    fp1 =fopen(nazwa,\"rb\");\n\n    if(fp1)\n    {\n        fread(fheader-&gt;sygnatura,2,1,fp1);\n        //...\n\n\n        printf(\"%d\\n\",fheader-&gt;sygnatura);\n\n    }\n    else\n    {\n        printf(\"Error\");\n    }\n    fclose(fp1);\n}\n</code></pre>\n\n<p>Again main for second method:</p>\n\n<pre><code>int main() {\n    struct FileHeader fheader;\n    struct MapHeader mheader;\n\n    char nazwapliku, *wczyt_nazwa =&amp;nazwapliku;\n    printf(\"Podaj nazwe pliku bitmapy: \");\n    scanf(\"%s\",wczyt_nazwa);\n\n    odczyt_pliku_bmp(&amp;fheader, &amp;mheader, wczyt_nazwa);\n    printf(\"%d\\n\",fheader.sygnatura);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "casting", "int", "unsigned-char"], "comments": [{"owner": {"reputation": 3255, "user_id": 2134021, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/6vRxL.png?s=128&g=1", "display_name": "Marshall Tigerus", "link": "https://stackoverflow.com/users/2134021/marshall-tigerus"}, "edited": false, "score": 1, "creation_date": 1465931308, "post_id": 37820183, "comment_id": 63104476, "body": "<a href=\"http://stackoverflow.com/questions/8317295/convert-unsigned-int-to-signed-int-c\" title=\"convert unsigned int to signed int c\">stackoverflow.com/questions/8317295/&hellip;</a>"}, {"owner": {"reputation": 430, "user_id": 2082445, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/57frH.jpg?s=128&g=1", "display_name": "The Prenx", "link": "https://stackoverflow.com/users/2082445/the-prenx"}, "reply_to_user": {"reputation": 3255, "user_id": 2134021, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/6vRxL.png?s=128&g=1", "display_name": "Marshall Tigerus", "link": "https://stackoverflow.com/users/2134021/marshall-tigerus"}, "edited": false, "score": 0, "creation_date": 1465931621, "post_id": 37820183, "comment_id": 63104627, "body": "thanks for the response @MarshallTigerus but it does not help in my case as the difference is 3 bytes here between char and int. So even if I use a short int I get first 8 bits 0 i.e. a positive number."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1465931746, "post_id": 37820183, "comment_id": 63104683, "body": "The signed value isn&#39;t <code>-81</code> it is <code>-47</code>. Try <code>printf(&quot;%d\\n&quot;, (signed char)c);</code>"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1465931779, "post_id": 37820183, "comment_id": 63104700, "body": "Convert it to signed char first: <code>int n = (int)(signed char)uc;</code>. Then you will get sign extension."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1465931944, "post_id": 37820183, "comment_id": 63104788, "body": "@Dmitri And what about values &lt; 128?"}, {"owner": {"reputation": 430, "user_id": 2082445, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/57frH.jpg?s=128&g=1", "display_name": "The Prenx", "link": "https://stackoverflow.com/users/2082445/the-prenx"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1465932010, "post_id": 37820183, "comment_id": 63104814, "body": "Thanks for all your suggestions. I got it working by using int n = (int)(signed char)uc; Thanks @Aconcagua"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1465932037, "post_id": 37820183, "comment_id": 63104824, "body": "According to 6.3.1.3.3 converting unsigned char to signed char is implementation defined."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1465932241, "post_id": 37820183, "comment_id": 63104900, "body": "But at least not undefined behaviour... So it&#39;s valid, but possibly not portable to everywhere."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1465932658, "post_id": 37820183, "comment_id": 63105101, "body": "@user3528438 that was a good (last-but-one) comment except it should be <code>y = x&lt;=127 ? x : (x-256);</code>"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1465932837, "post_id": 37820183, "comment_id": 63105183, "body": "This question is actually not a duplicate of the int case, because it&#39;s easier. In the int case you can not easily do <code>x-4294967296</code> because <code>4294967296</code> is not representable by a normal 32bit <code>int</code> and getting 64bit int involved is a waste of CPU resources for such a simple task. That&#39;s the only reason to use bit-hacking. For this one, doing (x-256) for x&gt;127 is feasible because 256 is representable by int."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1465932935, "post_id": 37820183, "comment_id": 63105230, "body": "@WeatherVane You are right. I&#39;ve removed my incorrect comment."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1465932996, "post_id": 37820183, "comment_id": 63105256, "body": "@Aconcagua <code>int n = (signed char)uc;</code> would be sufficient.  No need for <code>(int)</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1465943348, "post_id": 37820183, "comment_id": 63109899, "body": "Not an exact duplicate of that question IMO... similar but there are differences (paticularly, the type)"}], "owner": {"reputation": 430, "user_id": 2082445, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/57frH.jpg?s=128&g=1", "display_name": "The Prenx", "link": "https://stackoverflow.com/users/2082445/the-prenx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "closed_date": 1465931645, "answer_count": 0, "score": 0, "last_activity_date": 1465931129, "creation_date": 1465931129, "question_id": 37820183, "link": "https://stackoverflow.com/questions/37820183/c-convert-unsigned-char-to-signed-integer-negative-values", "closed_reason": "Duplicate", "title": "C - convert unsigned char to signed integer (negative values)", "body": "<p>I have an unsigned char with binary value 11010001.\nIf I were to convert it to unsigned integer its value would be 209. Its signed value however should be -81.<br>\nIf I normally convert it to integer by type casting it gives me a value of 209, but I want the signed value of -81.\nI understand that when I convert it to integer the first 1 or 3 bytes (depending 16 bit or 32 bit integer value) will be 0 and so the whole integer value will be considered positive.<br>\nHow do I get the signed value from this unsigned char?</p>\n"}, {"tags": ["c", "bitwise-operators", "atmel", "comparison-operators"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1465933364, "post_id": 37820169, "comment_id": 63105454, "body": "Could it be a timing issue? Try adding a small delay between the write to port C and the read from port A."}, {"owner": {"reputation": 1997, "user_id": 2058281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jppqe.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2058281/aaron"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1465934579, "post_id": 37820169, "comment_id": 63106016, "body": "@MargaretBloom Just came back to add that as the answer. I added 1 microsecond delay and that was sufficient. I&#39;m going to dive back into the datasheet right now and see where it gives the pin charge times. If you wanted to add that as a formal answer, I&#39;ll gladly upvote + accept it."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1465936192, "post_id": 37820169, "comment_id": 63106834, "body": "Without an official reference on the timings I feel like I can only give an incomplete answer. I believe the rise time depend on the output load but I&#39;m no expert on electronics. If you can find anything in the datasheet post the answer, It&#39;ll be useful for future readers!"}], "answers": [{"tags": [], "owner": {"reputation": 1997, "user_id": 2058281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jppqe.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2058281/aaron"}, "is_accepted": true, "score": 0, "last_activity_date": 1466103533, "creation_date": 1466103533, "answer_id": 37867362, "question_id": 37820169, "link": "https://stackoverflow.com/questions/37820169/why-would-comparisons-on-my-xmega-work-when-a-breakpoint-is-set-on-that-line-bu/37867362#37867362", "title": "Why would comparisons on my Xmega work when a breakpoint is set on that line, but not when running normally?", "body": "<p>It was a timing issue of not allowing long enough for the value on the pin to reflect what I set it as in the code. The issue was resolved by adding a 1 micro second delay using the delay function <code>_delay_us(1)</code> from the <code>delay.h</code> library.</p>\n"}, {"tags": [], "owner": {"reputation": 305, "user_id": 6685260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e11aa21913ac452f6c0f5b11714b9c?s=128&d=identicon&r=PG", "display_name": "Gabriel Cs&#233;falvay", "link": "https://stackoverflow.com/users/6685260/gabriel-cs%c3%a9falvay"}, "is_accepted": false, "score": 0, "last_activity_date": 1470479759, "creation_date": 1470479759, "answer_id": 38803321, "question_id": 37820169, "link": "https://stackoverflow.com/questions/37820169/why-would-comparisons-on-my-xmega-work-when-a-breakpoint-is-set-on-that-line-bu/38803321#38803321", "title": "Why would comparisons on my Xmega work when a breakpoint is set on that line, but not when running normally?", "body": "<p>See Any XMEGA Manual > I/O Ports > Overview > General I/O Pin Functionality</p>\n\n<p>Before the IN register there is a synchronizer so the input signal does not instantly appear in the input register. A couple of clock cycles would be enough to wait.</p>\n"}], "owner": {"reputation": 1997, "user_id": 2058281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jppqe.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2058281/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 37867362, "answer_count": 2, "score": 1, "last_activity_date": 1470479759, "creation_date": 1465931083, "last_edit_date": 1465931746, "question_id": 37820169, "link": "https://stackoverflow.com/questions/37820169/why-would-comparisons-on-my-xmega-work-when-a-breakpoint-is-set-on-that-line-bu", "title": "Why would comparisons on my Xmega work when a breakpoint is set on that line, but not when running normally?", "body": "<p>I am using an Xmega384C3, and all I am trying to do is send a signal down an output port and read it on an input port. I have <code>PORTC</code> set as an output port, and <code>PORTA</code> set as an input port. The corresponding pins on each port are shorted together (PortA pin 0 to PortC pin 0, etc).</p>\n\n<p>My issue appears in the following code:</p>\n\n<pre><code>uint8_t i;\nint count = 0;\n\nfor(i=2; i&lt;8; i++) {\n    PORTC.OUT = (1 &lt;&lt; i);\n    if (PORTA.IN == PORTC.OUT) {\n        count++;\n    }\n}\n\nif (count == 6) {\n    //success\n}\n</code></pre>\n\n<p>I basically just want to read that when I send a logic high down a pin on <code>PORTC</code>, that I can read it on the corresponding pin on <code>PORTA</code>. When I let the code run normally, it does not find any matches and therefore never increments count. However if I add a break point on the line where the if comparison occurs, it then evaluates to true and increments count as expected. Additionally, I can see the ports have the correct values in Atmel Studio's I/O view feature. Any ideas?</p>\n"}, {"tags": ["c", "function", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1465929896, "post_id": 37819773, "comment_id": 63103761, "body": "You should change the title. Programming is all about custom structs and custom functions."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1465930258, "post_id": 37819773, "comment_id": 63103926, "body": "<code>&amp;month,&amp;day,&amp;year</code>...wait they are not <i>normal</i> variables, they are member variable of <i>some</i> structure variable."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1465930540, "post_id": 37819773, "comment_id": 63104085, "body": "<code>printf(&quot;%d&#47;%d&#47;%d&quot;, origDate);</code> has two missing arguments."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1465931234, "post_id": 37819773, "comment_id": 63104425, "body": "Might be helpful: <a href=\"http://www.tutorialspoint.com/cprogramming/c_structures.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_structures.htm</a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1465932112, "post_id": 37819773, "comment_id": 63104860, "body": "<i>mm/dd/yyyy format</i> - <a href=\"https://xkcd.com/1179/\" rel=\"nofollow noreferrer\">:-(</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2896, "user_id": 2277872, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4f8d2102f71125210b3a56480b758421?s=128&d=identicon&r=PG", "display_name": "user2277872", "link": "https://stackoverflow.com/users/2277872/user2277872"}, "edited": false, "score": 0, "creation_date": 1465940852, "post_id": 37821045, "comment_id": 63109020, "body": "Quite an exemplary description. I don&#39;t work with structs much, but you&#39;ve made it much clearer."}, {"owner": {"reputation": 45, "user_id": 5785966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mxNw2.jpg?s=128&g=1", "display_name": "Philip Hudson", "link": "https://stackoverflow.com/users/5785966/philip-hudson"}, "edited": false, "score": 0, "creation_date": 1466008358, "post_id": 37821045, "comment_id": 63142887, "body": "First off, thank you for your help mghazian, that is incredibly helpful. I have it working for the most part, however when I put in  new date of 5/27/1985 it prints:       &#39;5/27/1985      1/19/3`    I have been trying to trouble shoot it but I do not know what I am missing."}, {"owner": {"reputation": 38, "user_id": 6030162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9de086f7432466a2bba4c688d744b?s=128&d=identicon&r=PG&f=1", "display_name": "mghazian", "link": "https://stackoverflow.com/users/6030162/mghazian"}, "reply_to_user": {"reputation": 45, "user_id": 5785966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mxNw2.jpg?s=128&g=1", "display_name": "Philip Hudson", "link": "https://stackoverflow.com/users/5785966/philip-hudson"}, "edited": false, "score": 0, "creation_date": 1466056315, "post_id": 37821045, "comment_id": 63160616, "body": "@PhilipHudson I don&#39;t know why the first <code>printf</code> line works, but by your explanation, your second <code>printf</code> line is problematic. <code>%d</code> needs to be assigned <i>something</i>, and many of the <code>%d</code> hasn&#39;t been so. Since your format is mm/dd/yyyy, you would want to assign the first <code>%d</code> with the <code>date</code>&#39;s <code>month</code>. The second with <code>date</code>&#39;s <code>day</code>, and the third with <code>date</code>&#39;s <code>year</code>. Take a look again when the program receive user input. That&#39;s how it should be done too when printing since the value you need is a member of a struct (i.e. <code>newDate.day</code> etc.)"}, {"owner": {"reputation": 38, "user_id": 6030162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9de086f7432466a2bba4c688d744b?s=128&d=identicon&r=PG&f=1", "display_name": "mghazian", "link": "https://stackoverflow.com/users/6030162/mghazian"}, "edited": false, "score": 0, "creation_date": 1466077315, "post_id": 37821045, "comment_id": 63173714, "body": "In your edited code, there&#39;s <code>printf(&quot;\\n%d&#47;%d&#47;%d\\n&quot;, newDate);</code>. Each of <code>%d</code> technically didn&#39;t get any value to be assigned with. What you would do is assign each %d with each member of <code>newDate</code> i.e. <code>newDate.month, newDate.day, newDate.year</code>"}, {"owner": {"reputation": 45, "user_id": 5785966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mxNw2.jpg?s=128&g=1", "display_name": "Philip Hudson", "link": "https://stackoverflow.com/users/5785966/philip-hudson"}, "edited": false, "score": 0, "creation_date": 1466079039, "post_id": 37821045, "comment_id": 63174885, "body": "I made the change however it now always returns <code>2686868&#47;4201214&#47;4201120</code>"}, {"owner": {"reputation": 38, "user_id": 6030162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9de086f7432466a2bba4c688d744b?s=128&d=identicon&r=PG&f=1", "display_name": "mghazian", "link": "https://stackoverflow.com/users/6030162/mghazian"}, "reply_to_user": {"reputation": 45, "user_id": 5785966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mxNw2.jpg?s=128&g=1", "display_name": "Philip Hudson", "link": "https://stackoverflow.com/users/5785966/philip-hudson"}, "edited": false, "score": 0, "creation_date": 1466081497, "post_id": 37821045, "comment_id": 63176675, "body": "@PhilipHudson <code>newDate = addSeven (origDate);</code> is why it returns gibberish number. You assigned <code>newDate</code> when <code>origDate</code> contains nothing. You should assign <code>newDate</code> after user inputs <code>origDate</code>. To clarify, after <code>scanf</code> assign <code>newDate</code> with <code>addSeven</code>"}, {"owner": {"reputation": 45, "user_id": 5785966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mxNw2.jpg?s=128&g=1", "display_name": "Philip Hudson", "link": "https://stackoverflow.com/users/5785966/philip-hudson"}, "edited": false, "score": 0, "creation_date": 1466083429, "post_id": 37821045, "comment_id": 63178236, "body": "That did it, You have been amazingly helpful, thank you very much."}], "tags": [], "owner": {"reputation": 38, "user_id": 6030162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9de086f7432466a2bba4c688d744b?s=128&d=identicon&r=PG&f=1", "display_name": "mghazian", "link": "https://stackoverflow.com/users/6030162/mghazian"}, "is_accepted": true, "score": 1, "last_activity_date": 1465934397, "creation_date": 1465934397, "answer_id": 37821045, "question_id": 37819773, "link": "https://stackoverflow.com/questions/37819773/custom-struct-and-custom-functions-adding-7-days-to-user-input-date/37821045#37821045", "title": "Custom struct and custom functions (adding 7 days to user input date)", "body": "<p>The idea is to return the date 7 days afterwards from the inputted one. In sequence, what you need to do is</p>\n\n<ol>\n<li>Add the <code>day</code> from the struct by 7</li>\n<li>Check whether the <code>day</code>'s value goes over the <code>month</code>'s day amount. If it is, decrement the <code>day</code> by how many days the corresponding <code>month</code> has. Then increment the <code>month</code> by 1</li>\n<li>Check whether the <code>month</code> goes over 12 (There's only 12 months in a year). Suppose it is, get the <code>month</code>'s value to 1, then increment the <code>year</code> by 1</li>\n</ol>\n\n<p>These steps cover what your function need to do.</p>\n\n<p>Since the date will be stored in <code>struct date</code>, the process will also use <code>struct date</code>. That said, this line is unnecessary in a way.</p>\n\n<pre><code>int origDate, newDate;\n</code></pre>\n\n<p>You are going to use <code>struct date</code>, so <code>int</code> is incompatible for what you're going to do. There are ways to fix this but for now I suggest to change the <code>int</code> to <code>struct date</code>. Then you can erase this line of code.</p>\n\n<pre><code>struct date datecalc;\n</code></pre>\n\n<p>The idea is two variable with datatype <code>struct date</code> is needed: one for input, and one for post-processing. Don't be surprised if someone else suggests only one variable. Like I said, there are many ways to do this. For now, let's stick with the method I'm going to tell you.</p>\n\n<p>Now, you need to receive user's input. <code>struct</code>'s member can be accessed using period. Using our variable before, let's say if you're going to fill in value <code>1999</code> into <code>origDate</code>'s <code>year</code>, this is what you would do</p>\n\n<pre><code>origDate.year = 1999;\n</code></pre>\n\n<p>See that I accessed <code>year</code> from <code>origDate</code> by giving a period between them. The same way goes to the other member of <code>struct date</code>. This line is problematic.</p>\n\n<pre><code>scanf(\"%d/%d/%d\",&amp;month,&amp;day,&amp;year);\n</code></pre>\n\n<p>The compiler would flip a table on you because in your program, variable <code>month</code>, <code>day</code> and <code>year</code> can't be found. Of course, they're in <code>struct date</code>. But these variables need an instance sheltering them to be usable (think it this way: before using a <code>TV</code>, you need <code>electricity</code>. Once you have <code>electricity</code>, you have all the <code>TV</code>'s functionality). To resolve this, you need a variable with datatype <code>struct date</code>. After then, the <code>month</code>, <code>day</code>, and <code>year</code> is exist via <code>struct date</code> variable.</p>\n\n<p>To fix the code, access each member via the variable (e.g. <code>origDate</code>) so the line would look like this.</p>\n\n<pre><code>scanf(\"%d/%d/%d\", &amp;origDate.month, &amp;origDate.day, &amp;origDate.year);\n</code></pre>\n\n<p>So far we have covered the input. Now let's deal with the processing part. Recall the steps I have stated before. These steps shows that <code>day</code>, <code>month</code>, and <code>year</code> is needed and they can be found in <code>struct date</code>. So in the <code>addSeven</code> function, the parameter you need must have <code>struct date</code> datatype.</p>\n\n<pre><code>int addSeven(struct date addSev)\n</code></pre>\n\n<p>The outcome of the processing part is the date with 7 days ahead of the input. Since we expect the output to be a date, let's change the return datatype <code>int</code> to <code>struct date</code>.</p>\n\n<pre><code>struct date addSeven(struct date addSev)\n</code></pre>\n\n<p>Bingo. Your function prototype.</p>\n\n<p>Let's setup the function.</p>\n\n<ol>\n<li><p>Add the <code>day</code> from the struct by 7</p>\n\n<pre><code>addSev.day += 7; // Equivalent to addSev.day = addSev.day + 7;\n</code></pre></li>\n<li><p>Check whether the <code>day</code>'s value goes over the <code>month</code>'s day amount</p>\n\n<pre><code>// Months with 31 days\nif ((addSev.month == 1 || // January\n     addSev.month == 3 || // March\n     addSev.month == 5 || // May\n     addSev.month == 7 || // July\n     addSev.month == 8 || // August\n     addSev.month == 10 || // October\n     addSev.month == 12) // December\n     &amp;&amp; addSev.day &gt; 31)\n{\n    addSev.day -= 31; // Equivalent to addSev.day = addSev.day - 31;\n    addSev.month += 1;\n}\n// Months with 30 days\nelse if ((addSev.month == 4 || // April\n          addSev.month == 6 || // June\n          addSev.month == 9 || // September\n          addSev.month == 11) // November\n          &amp;&amp; addSev.day &gt; 30)\n{\n    addSev.day -= 30;\n    addSev.month += 1;\n}\n// February\nelse\n{\n    if (addSev.year % 4 == 0 &amp;&amp; addSev.day &gt; 29) // Leap year\n    {\n        addSev.day -= 29;\n        addSev.month += 1;\n    }\n    else if (addSev.day &gt; 28)\n    {\n        addSev.day -= 28;\n        addSev.month += 1;\n    }\n}\n</code></pre>\n\n<p>Yes this is lengthy. I suggest to make another function to do the 'day overflow check'.</p></li>\n<li><p>Check whether the <code>month</code> goes over 12</p>\n\n<p>if (addSev.month > 12)\n{\n    addSev.month = 1;\n    addSev.year += 1;\n}</p></li>\n</ol>\n\n<p>After all this steps, return <code>addSev</code>.</p>\n\n<p>To use this function, just assign <code>origDate</code> as parameter, and store the return value into <code>newDate</code>.</p>\n\n<pre><code>newDate = addSeven (origDate);\n</code></pre>\n\n<p>Finally, to print the value has the same idea with receiving user input. Only without ampersand (<code>&amp;</code>) but I'm sure you already know that.</p>\n"}], "owner": {"reputation": 45, "user_id": 5785966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mxNw2.jpg?s=128&g=1", "display_name": "Philip Hudson", "link": "https://stackoverflow.com/users/5785966/philip-hudson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 37821045, "answer_count": 1, "score": 0, "last_activity_date": 1504800123, "creation_date": 1465929738, "last_edit_date": 1466063152, "question_id": 37819773, "link": "https://stackoverflow.com/questions/37819773/custom-struct-and-custom-functions-adding-7-days-to-user-input-date", "title": "Custom struct and custom functions (adding 7 days to user input date)", "body": "<p>New date always returns as 1/19/3, format needs to be mm/dd/yyyy. Also needs to be the correct date. I cannot find where in which par of the new date calculation the problems is occurring. </p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct date {\n    int month;\n    int day;\n    int year;\n    };\n\nstruct date addSeven(struct date addSev) {\n    addSev.day += 7;\n // Months with 31 days\n    if ((addSev.month == 1 || // January\n        addSev.month == 3 || // March\n        addSev.month == 5 || // May\n        addSev.month == 7 || // July\n        addSev.month == 8 || // August\n        addSev.month == 10 || // October\n        addSev.month == 12) // December\n        &amp;&amp; addSev.day &gt; 31) {\n            addSev.day -= 31; // Equivalent to addSev.day = addSev.day - 31;\n            addSev.month += 1;\n            }\n    // Months with 30 days\n        else if ((addSev.month == 4 || // April\n        addSev.month == 6 || // June\n        addSev.month == 9 || // September\n        addSev.month == 11) // November\n        &amp;&amp; addSev.day &gt; 30) {\n            addSev.day -= 30;\n            addSev.month += 1;\n            }\n    // February\n        else {\n            if (addSev.year % 4 == 0 &amp;&amp; addSev.day &gt; 29) { // Leap year\n                addSev.day -= 29;\n                addSev.month += 1;\n                }  \n            else if (addSev.day &gt; 28) {\n                addSev.day -= 28;\n                addSev.month += 1;\n                }\n            }\n    if ((addSev.day == 25)\n            &amp;&amp; addSev.day &gt; 31) {\n            addSev.day -= 31; // Equivalent to addSev.day = addSev.day - 31;\n            addSev.month += 1;\n            }\n        else if ((addSev.day == 24)\n                &amp;&amp; addSev.day &gt; 30) {\n                    addSev.day -= 30;\n                    addSev.month += 1;\n                    }\n        else {\n            if (addSev.year % 4 == 0 &amp;&amp; addSev.day &gt; 29) { // Leap year\n                addSev.day -= 29;\n                addSev.month += 1;\n                }\n            else if (addSev.day &gt; 28) {\n                addSev.day -= 28;\n                addSev.month += 1;\n                }\n         if (addSev.month &gt; 12) {\n            addSev.month = 1; addSev.year += 1;\n            }\n        return addSev;\n        }\n    }\n\n\nint main () {\n    struct date origDate, newDate;\n    newDate = addSeven (origDate);\n    printf(\"Enter a date in mm/dd/yyyy format:\");\n    scanf(\"%d/%d/%d\",&amp;origDate.month,&amp;origDate.day,&amp;origDate.year);\n\n    printf(\"\\n%d/%d/%d\\n\", origDate);\n    printf(\"\\n%d/%d/%d\\n\", newDate);\n\nreturn 0;\n}\n</code></pre>\n"}]