[{"tags": ["c"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1512604079, "post_id": 47685348, "comment_id": 82330495, "body": "Because they&#39;re not the same."}, {"owner": {"reputation": 1285, "user_id": 8955448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cDG4Z.jpg?s=128&g=1", "display_name": "Galen", "link": "https://stackoverflow.com/users/8955448/galen"}, "edited": false, "score": 1, "creation_date": 1512604118, "post_id": 47685348, "comment_id": 82330516, "body": "<code>printf</code> expects a null terminated string as the format. Is <code>pos</code> null terminated? Additionally, the first and last items in <code>pos</code> are a quotation mark. Keep in mind that <code>\\0</code> is the escape sequence for null. You probably want \\\\0 in your string literal."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9064550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f5e54bcaeb5b0895b39060f043ad70?s=128&d=identicon&r=PG&f=1", "display_name": "yummyduck", "link": "https://stackoverflow.com/users/9064550/yummyduck"}, "edited": false, "score": 0, "creation_date": 1512605259, "post_id": 47685448, "comment_id": 82330866, "body": "Tx, dbush. No 34 needed. Also seems to work without tracing 0."}, {"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 1, "creation_date": 1512613174, "post_id": 47685448, "comment_id": 82332704, "body": "Leave the trailing \\0 in there-it might work without it, but it\u2019s not guaranteed."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 1, "user_id": 9064550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f5e54bcaeb5b0895b39060f043ad70?s=128&d=identicon&r=PG&f=1", "display_name": "yummyduck", "link": "https://stackoverflow.com/users/9064550/yummyduck"}, "edited": false, "score": 1, "creation_date": 1512648391, "post_id": 47685448, "comment_id": 82348770, "body": "@yummyduck &quot;seems to work&quot; is the first step on the road to undefined behaviour"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1512611181, "last_edit_date": 1512611181, "creation_date": 1512604614, "answer_id": 47685448, "question_id": 47685348, "link": "https://stackoverflow.com/questions/47685348/printf-variable-placeholder-is-it-even-a-thing/47685448#47685448", "title": "printf variable placeholder? Is it even a thing?", "body": "<p>There are two problems with <code>pos</code>.</p>\n\n<p>First what you have is a character array, not a null terminated string.  You need to add a 0 to the end of that array.</p>\n\n<p>Second, you don't have the same characters.  In the string literal <code>\"\\033[9;9H%s\"</code> there are a total of 8 characters while <code>pos</code> has 13.  </p>\n\n<p>The sequence <code>\\033</code> represent a single character whose value is 33 octal or 27 decimal.  You instead have the literal characters <code>'\\'</code>, <code>'0'</code>, <code>'3'</code>, and <code>'3'</code>.  So replace 92,48,51,51 with 27.  Also, you have 34 for the first and last characters in <code>pos</code>, which is the double quote character <code>\"</code>.  These characters are not part of the string literal but are used to denote it in code.  So get rid of those.</p>\n\n<p><code>pos</code> should now look like this:</p>\n\n<pre><code>char pos[] = {27,91,57,59,57,72,37,115,0};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "is_accepted": false, "score": 0, "last_activity_date": 1512604649, "creation_date": 1512604649, "answer_id": 47685451, "question_id": 47685348, "link": "https://stackoverflow.com/questions/47685348/printf-variable-placeholder-is-it-even-a-thing/47685451#47685451", "title": "printf variable placeholder? Is it even a thing?", "body": "<p>You've got three differences:</p>\n\n<ol>\n<li><p>You don't need the initial and final <code>34</code> character (<code>\"</code>), since string (2) doesn't print them out.</p></li>\n<li><p>You need a null terminator to ensure that you print only your string and nothing more.</p></li>\n<li><p>If <code>\\033</code> is meant to be an escape character, then its value is just <code>27</code>, not <code>92,48,51,51</code>.</p></li>\n</ol>\n\n<p>After addressing those differences, your <code>pos</code> array:</p>\n\n<pre><code>{34,92,48,51,51,91,57,59,57,72,37,115,34}\n</code></pre>\n\n<p>Should instead look like this (aligned to match the original array):</p>\n\n<pre><code>            {27,91,57,59,57,72,37,115,0}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9064550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f5e54bcaeb5b0895b39060f043ad70?s=128&d=identicon&r=PG&f=1", "display_name": "yummyduck", "link": "https://stackoverflow.com/users/9064550/yummyduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 47685448, "answer_count": 2, "score": -3, "last_activity_date": 1512611181, "creation_date": 1512603767, "question_id": 47685348, "link": "https://stackoverflow.com/questions/47685348/printf-variable-placeholder-is-it-even-a-thing", "title": "printf variable placeholder? Is it even a thing?", "body": "<pre><code>#include &lt;stdio.h&gt;\nchar pos[] = {34,92,48,51,51,91,57,59,57,72,37,115,34}; // \"\\033[9;9H%s\"\n\nmain() {\n    printf(pos,\"Aaaaaaa\");              // (1) This doesnt work as intended\n    printf(\"\\033[9;9H%s\",\"Aaaaaaa\");    // (2) Works as intended\n}\n</code></pre>\n\n<p>So why (2) works and (1) doesn't?</p>\n"}, {"tags": ["c", "string", "strtok"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1512603516, "post_id": 47685239, "comment_id": 82330283, "body": "What is the problem? Just read the description of the function."}, {"owner": {"reputation": 1754, "user_id": 6087092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjhgT.jpg?s=128&g=1", "display_name": "Isac", "link": "https://stackoverflow.com/users/6087092/isac"}, "edited": false, "score": 2, "creation_date": 1512603696, "post_id": 47685239, "comment_id": 82330352, "body": "<code>strtok</code> with <code>NULL</code> is to continue from where it left of last time you called it"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1512604649, "post_id": 47685239, "comment_id": 82330703, "body": "To be fair, <code>strtok()</code> is an abomination and incredibly stupid."}], "answers": [{"tags": [], "owner": {"reputation": 1285, "user_id": 8955448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cDG4Z.jpg?s=128&g=1", "display_name": "Galen", "link": "https://stackoverflow.com/users/8955448/galen"}, "is_accepted": true, "score": 0, "last_activity_date": 1512604706, "creation_date": 1512604706, "answer_id": 47685463, "question_id": 47685239, "link": "https://stackoverflow.com/questions/47685239/strtok-and-its-usage/47685463#47685463", "title": "strtok and it&#39;s usage", "body": "<p>From the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strtok_r.html\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>Each subsequent call, with a null pointer as the value of the first argument, starts searching from the saved pointer and behaves as described above.</p>\n</blockquote>\n"}], "owner": {"reputation": 25, "user_id": 8857646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23c4fe1cdbea6b4827ec727a236b08f7?s=128&d=identicon&r=PG&f=1", "display_name": "Briehn", "link": "https://stackoverflow.com/users/8857646/briehn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47685463, "answer_count": 1, "score": -1, "last_activity_date": 1512607274, "creation_date": 1512603129, "last_edit_date": 1512607274, "question_id": 47685239, "link": "https://stackoverflow.com/questions/47685239/strtok-and-its-usage", "title": "strtok and it&#39;s usage", "body": "<p>I'm working on an assignment that requires string and file manipulation. I'm currently working on the string manipulation part and I'm trying to use strtok to separate lines in a file, split by a comma. However, I'm not sure how strtok works. I'm looking at the code below and don't quite understand why there is a NULL in the second strtok call, when NULL isn't even a string.</p>\n\n<p>The code I'm running:</p>\n\n<p>/*****************************************************************\n *\n * Purpose: Program to demonstrate the 'strtok' function.\n * Author:  M J Leslie\n * Date:    23-Apr-94\n *\n ****************************************************************/</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nmain()\n{\n            /* Copy the constant into the memory\n             * pinted to by 'test_string'       */\n    char test_string[50]=\"string to split up\";\n\n    /* if 'test_string' is declared as below and the program will give a \n    * 'Segmentation fault' This is because test_string' is pointing\n    * to a constant i.e. somethin that cant be changed.     \n\n    char *test_string=\"string to split up\";         */\n\n    char *sub_string;\n\n                /* Extract first string */\n    printf(\"%s\\n\", strtok(test_string, \" \"));\n\n                /* Extract remaining \n                 * strings      */\n    while ( (sub_string=strtok(NULL, \" \")) != NULL)\n    {\n         printf(\"%s\\n\", sub_string);\n    }\n }\n /*****************************************************************\n *\n * Program O/P will look like this...\n *\n *   string\n *   to\n *   split\n *   up\n *\n *****************************************************************/\n</code></pre>\n"}, {"tags": ["c", "gcc", "assembly", "x86", "gnu-assembler"], "comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 4, "creation_date": 1512603074, "post_id": 47685181, "comment_id": 82330118, "body": "The <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#cdecl\" rel=\"nofollow noreferrer\">32-bit CDECL calling convention</a> makes <i>EBX</i> a callee saved register (If you change it, you must save and restore it). Just use one of the other volatile (caller saved) registers like <i>ECX</i> or <i>EDX</i> instead of <i>EBX</i>"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 3, "creation_date": 1512608720, "post_id": 47685181, "comment_id": 82331699, "body": "You could also write it as  <code>xor edx, edx</code> <code>mov eax, [esp+4]</code> <code>div dword ptr [esp+8]</code> <code>ret</code>"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 3, "creation_date": 1512609287, "post_id": 47685181, "comment_id": 82331813, "body": "I should point out though that your assembly routine is doing unsigned division. If you make one of the parameters negative the results won&#39;t be as you expect. Your function is actually <code>unsigned int extern divExtern(unsigned int n, unsigned int m);</code> . If you want to do signed division you&#39;d could do something like <code>mov eax, [esp+4]</code>         <code>cdq</code>         <code>idiv dword ptr [esp+8]</code>         <code>ret</code> . The CDQ takes the value in <i>EAX</i> and sign extends it into <i>EDX</i>. We use <code>idiv</code> to do signed division rather than <code>div</code> for the unsigned division."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1512621056, "post_id": 47685181, "comment_id": 82334600, "body": "Your compiler is actually using <code>ebx</code> because it was configured with <code>--enable-default-pie</code> to make Position-Independent Executables (which applies even in 32-bit mode).  See <a href=\"https://stackoverflow.com/questions/43367427/32-bit-absolute-addresses-no-longer-allowed-in-x86-64-linux\" title=\"32 bit absolute addresses no longer allowed in x86 64 linux\">stackoverflow.com/questions/43367427/&hellip;</a>.  (Your code is still wrong with <code>-no-pie -fno-pie</code>; the calling convention doesn&#39;t change but your code might have happened to work.)  Mostly I mention this because <code>-fpie</code> costs more performance in 32-bit mode than in 64-bit mode."}], "owner": {"reputation": 101, "user_id": 6890735, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/13982685ca77eeb79ad00024cafaf423?s=128&d=identicon&r=PG&f=1", "display_name": "Sam K9", "link": "https://stackoverflow.com/users/6890735/sam-k9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1512606942, "creation_date": 1512602740, "last_edit_date": 1512606942, "question_id": 47685181, "link": "https://stackoverflow.com/questions/47685181/segmentation-fault-when-attempting-to-print-int-value-from-x86-external-function", "title": "Segmentation fault when attempting to print int value from x86 external function", "body": "<p>I'm trying to learn how to use the x86 <em>DIV</em> instruction. Here is my external function located in a .S file:</p>\n\n<pre><code>.intel_syntax noprefix\n.text\n.global divExtern\n\ndivExtern:\n        mov edx, 0\n        mov eax, [esp+4]\n        mov ebx, [esp+8]\n        div ebx\n        ret\n</code></pre>\n\n<p>Here is my C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint extern divExtern(int n, int m);\n\nint main() {\n        printf(\"%d\", divExtern(10, 5));\n        return 0;\n}\n</code></pre>\n\n<p>As you can see I am testing to see if 10/5 = 2. Using GDB I verified that 2 is indeed in <em>EAX</em> right before executing <em>RET</em>.</p>\n\n<pre><code>0x565555eb &lt;divExtern&gt;          mov    $0x0,%edx                                                                   3\n   30x565555f0 &lt;divExtern+5&gt;        mov    0x4(%esp),%eax                                                              3\n   30x565555f4 &lt;divExtern+9&gt;        mov    0x8(%esp),%ebx                                                              3\n   30x565555f8 &lt;divExtern+13&gt;       div    %ebx                                                                        3\n  &gt;30x565555fa &lt;divExtern+15&gt;       ret\n\n(gdb) p $eax\n$2 = 2\n</code></pre>\n\n<p>However I am still getting a seg fault.</p>\n\n<p>GDB has shown me that <em>EAX</em> changed in between executing the function and <code>printf</code>. Why is this the case and what can I do to prevent this?</p>\n\n<pre><code>0x565555af &lt;main+15&gt;    call   0x56555470 &lt;__x86.get_pc_thunk.bx&gt;                                                  3\n   30x565555b4 &lt;main+20&gt;    add    $0x1a4c,%ebx                                                                        3\n   30x565555ba &lt;main+26&gt;    sub    $0x8,%esp                                                                           3\n   30x565555bd &lt;main+29&gt;    push   $0x5                                                                                3\n   30x565555bf &lt;main+31&gt;    push   $0xa                                                                                3\n   30x565555c1 &lt;main+33&gt;    call   0x565555eb &lt;divExtern&gt;                                                              3\n   30x565555c6 &lt;main+38&gt;    add    $0x10,%esp                                                                          3\n   30x565555c9 &lt;main+41&gt;    sub    $0x8,%esp                                                                           3\n   30x565555cc &lt;main+44&gt;    push   %eax                                                                                3\n   30x565555cd &lt;main+45&gt;    lea    -0x1980(%ebx),%eax                                                                  3\n   30x565555d3 &lt;main+51&gt;    push   %eax                                                                                3\n  &gt;30x565555d4 &lt;main+52&gt;    call   0x56555400 &lt;printf@plt&gt;\n\n\n(gdb) p $eax\n$3 = -6523\n</code></pre>\n\n<p>In case you need to know I compiled this by running <code>gcc test.c divExtern.S -m32 -o test</code></p>\n"}, {"tags": ["c", "string", "file"], "comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 3, "creation_date": 1512602869, "post_id": 47685150, "comment_id": 82330026, "body": "What does fscanf return? What does that mean?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 4, "creation_date": 1512603419, "post_id": 47685150, "comment_id": 82330245, "body": "<code>while(!feof(fp))</code> is wrong. <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512641320, "post_id": 47685150, "comment_id": 82343976, "body": "given the sizing of the input fields, the struct definition char fields are too short by 1 char.  This is because when calling any for the <code>scanf()</code> family of functions, the input format specifiers <code>%s</code> and <code>%[...]</code> always append a NUL byte to the end of the input."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512641788, "post_id": 47685150, "comment_id": 82344320, "body": "the call to <code>fscanf()</code> has an spurious &#39;s&#39; after the input format specifier <code>%51[^\\n]</code>  The &#39;s&#39; doesn&#39;t exist in the input data, so the input activity will stop there.  If you had been checking the returned value from <code>fscanf()</code> (which in the current scenario should be: 5) it would have returned 2.  You seem to have a misunderstanding about the &#39;%[]&#39; input specifier.  This is a &#39;standalone&#39; specifier, so does NOT need a trailing &#39;s&#39;."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512697554, "post_id": 47685150, "comment_id": 82373178, "body": "in general, NEVER use <code>feof()</code> in a while loop.  For the current scenario, use this for the <code>while</code> statement: <code>while( 5 == fscanf(fp,&quot;%d %51[^\\n] %11c %11c %d\\n&quot;, &amp;bilhete.BI, bilhete.nome, bilhete.partida, bilhete.chegada, &amp;bilhete.data) )</code>"}, {"owner": {"reputation": 888, "user_id": 4162084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7xGHkctBZDo/AAAAAAAAAAI/AAAAAAAAAEg/vzBUlmaZceo/photo.jpg?sz=128", "display_name": "Jakub Piskorz", "link": "https://stackoverflow.com/users/4162084/jakub-piskorz"}, "edited": false, "score": 0, "creation_date": 1512770880, "post_id": 47685150, "comment_id": 82406317, "body": "Additionally, your last parameter is passed incorrectly. format specifier is <code>%d</code>, which expects <code>int *</code> argument to write number value. You&#39;re passing <code>&amp;bilhete.data</code>, where data is an array of ints, so basically <code>int **</code>. Either change data to be single int, or pass it without <code>&amp;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 1683793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/384cc6ed9450635fc4189e1a5a840dd5?s=128&d=identicon&r=PG", "display_name": "user1683793", "link": "https://stackoverflow.com/users/1683793/user1683793"}, "is_accepted": false, "score": 0, "last_activity_date": 1512770428, "creation_date": 1512770428, "answer_id": 47722791, "question_id": 47685150, "link": "https://stackoverflow.com/questions/47685150/read-strings-in-c-from-txt-file/47722791#47722791", "title": "Read strings in C from txt file", "body": "<p>Since you have fixed columns, I would consider just reading in the data and doing my own scanning with something like:</p>\n\n<pre><code>char linein[200];\nchar *p;\n\nwhile (fgets(linein, sizeof(linein), fp))\n{\n    char biBuf[10]={0};\n    char dataBuf[10]={0};\n\n    p=linein;\n    memcpy(biBuf,linein,5);\n    bilhete.BI=atoi(biBuf);\n    p+=5;\n    memcpy(bilhete.nome,p,51);\n    p+=51;\n    memcpy(bilhete.partida,p,11);\n    p+=11;\n    memcpy(bilhete.chegada,p, 11);\n    p+=11;\n    memcpy(dataBuf,p,2);\n    bilhete.data[0]=atoi(dataBuf);\n    printf(\"%.51s %d\\n\",bilhete.nome, bilhete.data[0]);\n}\n</code></pre>\n\n<p>I am not sure what you wanted to do with the data variable but this will give you an integer. Observe, the biBuf and dataBuf variables are allocated in the loop so they get set to zeros each time.</p>\n"}], "owner": {"reputation": 11, "user_id": 9064495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc98025051ce398134131b33f6afc4c3?s=128&d=identicon&r=PG&f=1", "display_name": "losvatos", "link": "https://stackoverflow.com/users/9064495/losvatos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512770428, "creation_date": 1512602518, "question_id": 47685150, "link": "https://stackoverflow.com/questions/47685150/read-strings-in-c-from-txt-file", "title": "Read strings in C from txt file", "body": "<p>I'm trying to read some strings from a txt file.\nEach line has a 5 digit number, a full name that occupies 51 characters (including spaces), 2 city names, each one occupyng 11 characters including spaces, and one number. Example:</p>\n\n<pre><code>12345Ant\u00f3nio Manuel Silva Mendes                        Frankfurt  Varsovia    1\n</code></pre>\n\n<p>I can now scan the first 2 strings, but I can't scan the city names, nor the last number.</p>\n\n<p>Here's the struct:</p>\n\n<pre><code>typedef struct bilhete{\n\n    int BI;\n    char nome[51];\n    char partida[11];\n    char chegada[11];\n    int data[2];\n\n}BILHETE;\n</code></pre>\n\n<p>here's the way I'm reading the file</p>\n\n<pre><code>while(!feof(fp)){\n\n        fscanf(fp,\"%d%51[^\\n]s%11c%11c%d\\n\", &amp;bilhete.BI, bilhete.nome, bilhete.partida, bilhete.chegada, &amp;bilhete.data);\n</code></pre>\n\n<p>What am I doing wrong? when I print the city names, nothing appears!</p>\n"}, {"tags": ["c", "arrays", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512622124, "post_id": 47685076, "comment_id": 82334874, "body": "<code>(*arr)[i].points[i] = point;</code> writes out of bounds. you only allocated space for one Point"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3670471, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000440682707/picture?type=large", "display_name": "user3670471", "link": "https://stackoverflow.com/users/3670471/user3670471"}, "edited": false, "score": 0, "creation_date": 1512602202, "post_id": 47685094, "comment_id": 82329773, "body": "It doesn&#39;t, but it works. I have tried to <code>printf()</code> for debuging at every line. crash point ts really at <code>main</code>."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 23, "user_id": 3670471, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000440682707/picture?type=large", "display_name": "user3670471", "link": "https://stackoverflow.com/users/3670471/user3670471"}, "edited": false, "score": 0, "creation_date": 1512602303, "post_id": 47685094, "comment_id": 82329817, "body": "@user3670471 If it doesn&#39;t crash on this exact line, it doesn&#39;t mean that the line itself is ok. Replace the second <code>i</code> with <code>0</code> and it will work."}, {"owner": {"reputation": 23, "user_id": 3670471, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000440682707/picture?type=large", "display_name": "user3670471", "link": "https://stackoverflow.com/users/3670471/user3670471"}, "edited": false, "score": 0, "creation_date": 1512602609, "post_id": 47685094, "comment_id": 82329942, "body": "Yes, now I see the problem. Thanks a lot."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": false, "score": 1, "last_activity_date": 1512602326, "last_edit_date": 1512602326, "creation_date": 1512602130, "answer_id": 47685094, "question_id": 47685076, "link": "https://stackoverflow.com/questions/47685076/c-segmentation-fault-after-freeing-dynamically-allocated-array/47685094#47685094", "title": "C - Segmentation fault after freeing dynamically allocated array", "body": "<pre><code>(*arr)[i].points[i] = point;\n</code></pre>\n\n<p>This doesn't look right. It should be</p>\n\n<pre><code>(*arr)[i].points[0] = point;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "is_accepted": false, "score": 0, "last_activity_date": 1512602244, "creation_date": 1512602244, "answer_id": 47685111, "question_id": 47685076, "link": "https://stackoverflow.com/questions/47685076/c-segmentation-fault-after-freeing-dynamically-allocated-array/47685111#47685111", "title": "C - Segmentation fault after freeing dynamically allocated array", "body": "<p>The following bit:</p>\n\n<pre><code>    (*arr)[i].points = (Point *)malloc(sizeof(Point));\n    (*arr)[i].points[i] = point;\n</code></pre>\n\n<p>does not allocate the correct amount of memory. <code>i</code> will be some number greater than zero, but you've only allocated space for <em>one</em> <code>Point</code>. You're smashing your heap and a crash will follow.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1512622270, "last_edit_date": 1512622270, "creation_date": 1512621810, "answer_id": 47687737, "question_id": 47685076, "link": "https://stackoverflow.com/questions/47685076/c-segmentation-fault-after-freeing-dynamically-allocated-array/47687737#47687737", "title": "C - Segmentation fault after freeing dynamically allocated array", "body": "<p>There is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><strong>Do I cast the result of malloc?</strong></a>. <code>malloc</code> returns <code>void *</code> compatible with any pointer. A cast can only serve to muddy the waters. Simply allocate your pointer <code>points</code> and then call <code>sizeof</code> on the dereferenced pointer, e.g.:</p>\n\n<pre><code>(*arr)[i].points = malloc (sizeof *(*arr)[i].points);\n</code></pre>\n\n<p>While a correct statement for the allocation, it wholly fails to <em>validate</em> the allocation succeeds, instead, check the return from <code>malloc</code> is not <code>NULL</code>, e.g.</p>\n\n<pre><code>         if (!((*arr)[i].points = malloc (sizeof *(*arr)[i].points))) {\n            perror (\"malloc failed - points\");\n            exit (EXIT_FAILURE);\n        }\n</code></pre>\n\n<p>The same for the allocation of <code>*arr</code>, e.g.</p>\n\n<pre><code>    if (!(*arr = malloc (sizeof **arr * nclusters))) {\n        perror (\"malloc failed - nclusters\");\n        exit (EXIT_FAILURE);\n    }\n</code></pre>\n\n<p>(note: <code>how_many_clusters</code> was shortened to <code>nclusters</code>, we are not writing a novel)</p>\n\n<p>Your primary problem is:</p>\n\n<pre><code>        (*arr)[i].points[i] = point;\n</code></pre>\n\n<p>You only allocate memory for <strong>one <code>Point</code> struct</strong>, therefore <code>points[i]</code> makes no sense at all. You allocated <code>sizeof(Point)</code> -- how many of them do you think there are?</p>\n\n<p>Since your goal is to copy <code>point</code> to the newly allocated block of memory at the address held by the pointer <code>(*arr)[i].points</code>, <em>\"How Do You Access (or Set) the value Referenced (e.g. Pointed-to) by a Pointer?\"</em> (<strong><em>Answer:</em></strong>, you <em>dereference</em> the pointer to obtain the value). </p>\n\n<p>That's all you need do here. No additional <code>[..]</code> tacked on the end to dereference <code>(*arr)[i].points</code>, just dereference it with the unary <code>'*'</code>, e.g.</p>\n\n<pre><code>        *(*arr)[i].points = point;  /* copy struct to allocated memory */\n</code></pre>\n\n<p>Putting the pieces altogether, you can do something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    int ID; //each point has some ID and XY coordinates\n    int X;\n    int Y;\n} Point;\n\ntypedef struct {\n    int size;      //how many points can cluster hold\n    int count;     //how many points cluster actually holds\n    Point *points; //dynamically allocated array of points\n} Cluster;\n\nvoid fill_array (Cluster **arr, int nclusters)\n{\n    if (!(*arr = malloc (sizeof **arr * nclusters))) {\n        perror (\"malloc failed - nclusters\");\n        exit (EXIT_FAILURE);\n    }\n    for (int i = 0; i &lt; nclusters; i++)\n    {\n        Point point;\n        point.ID = i;\n        point.X = i * 2;\n        point.Y = i * 3;\n        (*arr)[i].size = 1;\n        (*arr)[i].count = 1;\n        if (!((*arr)[i].points = malloc (sizeof *(*arr)[i].points))) {\n            perror (\"malloc failed - points\");\n            exit (EXIT_FAILURE);\n        }\n        *(*arr)[i].points = point;  /* copy struct to allocated memory */\n    }\n}\n\nint main (void) {\n\n    Cluster *clusters;\n    int clusters_count = 20;\n\n    fill_array (&amp;clusters, clusters_count);\n\n    for(int i = 0; i &lt; clusters_count; i++)\n    {\n        free(clusters[i].points); //crash point\n        clusters[i].points = NULL;\n    }\n    free (clusters);\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> you do <strong>not</strong> have to <code>free</code> each <code>clusters[i].points</code> <strong>in reverse order</strong>. (it's not wrong, there is just no need to go out of your way to do it). Just free them as you work your way through the loop.)</p>\n\n<p><strong>Example Use/Validation</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/fillclusters_alloc\n==26217== Memcheck, a memory error detector\n==26217== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==26217== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==26217== Command: ./bin/fillclusters_alloc\n==26217==\n==26217==\n==26217== HEAP SUMMARY:\n==26217==     in use at exit: 0 bytes in 0 blocks\n==26217==   total heap usage: 21 allocs, 21 frees, 560 bytes allocated\n==26217==\n==26217== All heap blocks were freed -- no leaks are possible\n==26217==\n==26217== For counts of detected and suppressed errors, rerun with: -v\n==26217== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 23, "user_id": 3670471, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000440682707/picture?type=large", "display_name": "user3670471", "link": "https://stackoverflow.com/users/3670471/user3670471"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1512648745, "accepted_answer_id": 47687737, "answer_count": 3, "score": -2, "last_activity_date": 1512622270, "creation_date": 1512602051, "question_id": 47685076, "link": "https://stackoverflow.com/questions/47685076/c-segmentation-fault-after-freeing-dynamically-allocated-array", "closed_reason": "Not suitable for this site", "title": "C - Segmentation fault after freeing dynamically allocated array", "body": "<p>I'm trying to create dynamically allocated array of clusters, where every cluster has its own dynamically allocated array of points.</p>\n\n<pre><code>typedef struct Point\n{\n    int ID; //each point has some ID and XY coordinates\n    int X;\n    int Y;\n}Point;\n\ntypedef struct Cluster\n{\n    int size;      //how many points can cluster hold\n    int count;     //how many points cluster actually holds\n    Point *points; //dynamically allocated array of points\n}Cluster;\n</code></pre>\n\n<p>I am able to initialize clusters array and populate it with this function:</p>\n\n<pre><code>void fill_array(Cluster **arr, int how_many_clusters)\n{\n    *arr = (Cluster *)malloc(sizeof(Cluster) * how_many_clusters);\n\n    for(int i = 0; i &lt; how_many_clusters; i++)\n    {\n        Point point;\n        point.ID = i;\n        point.X = i * 2;\n        point.Y = i * 3;\n        (*arr)[i].size = 1;\n        (*arr)[i].count = 1;\n        (*arr)[i].points = (Point *)malloc(sizeof(Point));\n        (*arr)[i].points[i] = point;\n    }\n}\n</code></pre>\n\n<p>In main I want to create the array, fill it with function mentioned before and then free it.</p>\n\n<pre><code>int main ()\n{\n    Cluster *clusters;\n    int clusters_count = 20;\n    fill_array(&amp;cluters, clusters_count);\n\n    for(int i = clusters_count - 1; i &gt;= 0; i--)\n    {\n        free(clusters[i].points); //crash point\n        clusters[i].points = NULL;\n    }\n    free(clusters);\n\n    return 0;\n}\n</code></pre>\n\n<p>When I compile and run this program, it crashes at second iteration of <code>free</code>ing with segmentation fault. I have spent last 2 days digging through the internet, but didn't find anything about what I'm doing wrong.\nCan anyone point out where is the mistake I can't see?</p>\n"}, {"tags": ["c", "pointers", "integer"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 2, "creation_date": 1512603914, "post_id": 47684980, "comment_id": 82330426, "body": "You are comparing to <code>number</code>, which is NOT an integer"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512701189, "post_id": 47684980, "comment_id": 82373968, "body": "When calling any of the <code>scanf()</code> family of functions: always check the returned value, not the parameter values, to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512701331, "post_id": 47684980, "comment_id": 82373993, "body": "for ease of readability and understanding: 1) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 5219, "user_id": 4724167, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/2CiEe.jpg?s=128&g=1", "display_name": "Nandu Kalidindi", "link": "https://stackoverflow.com/users/4724167/nandu-kalidindi"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1512604143, "post_id": 47685372, "comment_id": 82330531, "body": "Sorry about that, typed it in a hurry, corrected it now."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1512605581, "post_id": 47685372, "comment_id": 82330974, "body": "Have you considered applying your &quot;fix&quot; and and compiling the code that results from your answer?"}, {"owner": {"reputation": 13, "user_id": 9064410, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wTjbrzZ3e_Y/AAAAAAAAAAI/AAAAAAAAGEE/qL5g0sI4zgg/photo.jpg?sz=128", "display_name": "Monty", "link": "https://stackoverflow.com/users/9064410/monty"}, "edited": false, "score": 0, "creation_date": 1512644795, "post_id": 47685372, "comment_id": 82346363, "body": "OF COURSE!  i am soo stupid lol, thank you soo much!! appreciate it! it worked! :D"}], "tags": [], "owner": {"reputation": 5219, "user_id": 4724167, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/2CiEe.jpg?s=128&g=1", "display_name": "Nandu Kalidindi", "link": "https://stackoverflow.com/users/4724167/nandu-kalidindi"}, "is_accepted": true, "score": 0, "last_activity_date": 1512605771, "last_edit_date": 1512605771, "creation_date": 1512603974, "answer_id": 47685372, "question_id": 47684980, "link": "https://stackoverflow.com/questions/47684980/for-loop-to-arrange-numbers-in-ascending-order-error-pointer-and-integer-co/47685372#47685372", "title": "&#39;For loop&#39; to arrange Numbers in ascending order. [ERROR] pointer and integer comparision", "body": "<p>You are using <code>i &lt; number</code> where <code>i</code> is <code>int</code> and <code>number</code> is an <code>array</code></p>\n\n<p>Just change those lines to below</p>\n\n<pre><code>for(i=0; i &lt; (total-1); i++){ \n\n        for(j=(i+1); j  &lt; total; j++){  \n\n\nfor(i=0; i &lt; total; i++){ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1512703235, "creation_date": 1512703235, "answer_id": 47707212, "question_id": 47684980, "link": "https://stackoverflow.com/questions/47684980/for-loop-to-arrange-numbers-in-ascending-order-error-pointer-and-integer-co/47707212#47707212", "title": "&#39;For loop&#39; to arrange Numbers in ascending order. [ERROR] pointer and integer comparision", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>properly checks for errors</li>\n<li>properly outputs error messages to <code>stderr</code></li>\n<li>properly minimizes the scope of variables</li>\n<li>cleanly compiles</li>\n<li>incorporates appropriate horizontal spacing after commas, after semicolons, inside parens, around C operators</li>\n<li>performs the desired functionality</li>\n<li>makes use of a VLA (variable length array) so the number of numbers could be most any positive number</li>\n<li>separates code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line</li>\n<li>does not contain random blank lines</li>\n<li>documents why each header file is included</li>\n<li>does not allow the user to enter a negative count for the number of numbers</li>\n<li>follows the axiom: <em>only one statement per line and (at most) one variable declaration per statement.</em></li>\n</ol>\n\n<p>And now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // scanf(), perror(), printf()\n#include &lt;stdlib.h&gt;  // exit(), EXIT_FAILURE\n\nint main( void )\n{\n    int total;\n\n    printf(\"Enter the quantity of the numbers you want \\n\");\n    if( 1 != scanf( \"%d\", &amp;total ) )\n    {\n        perror( \"scanf for count of numbers failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, scanf successful\n\n    if( !total )\n    {  // then 0 entered\n        printf( \"Exiting, no numbers to enter\\n\" );\n        return 0;\n    }\n\n    // implied else, some numbers to enter\n\n    int number[ total ];   // &lt;&lt; uses the VLA feature of C\n\n    for( unsigned i = 0; i &lt; total; i++ )\n    {\n        printf( \"Enter number %u: \", i+1 );\n\n        if( 1 != scanf( \"%d\", &amp;number[i] ) )\n        {\n            perror( \"scanf for a number failed\" );\n            exit( EXIT_FAILURE );\n        }\n\n        // implied else, scanf successful\n    }\n\n    for( int i = 0; i &lt; (total - 1); i++ )\n    {\n        for( int j = (i+1); j &lt; total; j++ )\n        {\n            if( number[i] &gt; number[j] )\n            {\n                int temp  = number[i];\n                number[i] = number[j];\n                number[j] = temp;\n            }\n        }\n    }\n\n    for( unsigned i = 0; i &lt; total; i++ )\n    {\n        printf(\"%d \\n\", number[i]);\n    }\n\n    return 0;\n} // end function: main\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9064410, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wTjbrzZ3e_Y/AAAAAAAAAAI/AAAAAAAAGEE/qL5g0sI4zgg/photo.jpg?sz=128", "display_name": "Monty", "link": "https://stackoverflow.com/users/9064410/monty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "accepted_answer_id": 47685372, "answer_count": 2, "score": 1, "last_activity_date": 1512703235, "creation_date": 1512601469, "last_edit_date": 1512607238, "question_id": 47684980, "link": "https://stackoverflow.com/questions/47684980/for-loop-to-arrange-numbers-in-ascending-order-error-pointer-and-integer-co", "title": "&#39;For loop&#39; to arrange Numbers in ascending order. [ERROR] pointer and integer comparision", "body": "<p>This is a very simple program, to arrange numbers in ascending order. Now here I don't know how it says there is the comparison between integer and pointer, in all the for loops. I am a noob by the way. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    int number[100],total,i,j,temp;;\n\n    printf(\"Enter the quantity of the numbers you want \\n\");\n    scanf(\"%d\",&amp;total);\n\n    printf(\"Enter the numbers \\n\");\n    for(i=0; i&lt;total; i++){\n\n        scanf(\"%d\",&amp;number[i]);\n    }\n\n    for(i=0; i &lt; (number-1); i++){ \n\n        for(j=(i+1); j  &lt; number; j++){  \n\n            if(number[i]&gt;number[j]){\n                temp = number[i];\n                number[i] = number[j];\n                number[j] = temp;\n           }\n\n        }\n\n    }\n    for(i=0; i &lt; number; i++){  \n\n        printf(\"%d \\n\", number[i]);\n    }\n\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "concatenation", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1512601268, "post_id": 47684901, "comment_id": 82329433, "body": "Fyi, <code>&#39;*&#39;</code> is the integer literal for the asterisk character. Note the single quotes."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1512601301, "post_id": 47684901, "comment_id": 82329444, "body": "<code>char *asterix; *asterix = *;</code> has two problems. The pointer is uninitialised, and <code>*</code> is not a type of value that can be assigned to where it might point. Perhaps <code>*asterix = &#39;*&#39;;</code>"}, {"owner": {"reputation": 29, "user_id": 9053335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba984559948e99e4e070f0271069b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Tcranmer", "link": "https://stackoverflow.com/users/9053335/tcranmer"}, "edited": false, "score": 0, "creation_date": 1512601422, "post_id": 47684901, "comment_id": 82329477, "body": "Ya what I was missing was the single quotes, it fixed my issue (I fixed the initialization problem too, thank you)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1512601540, "post_id": 47684901, "comment_id": 82329531, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1512601619, "post_id": 47684901, "comment_id": 82329568, "body": "There&#39;s no need for <code>asterisk</code> to be a pointer. Just <code>char asterisk = &#39;*&#39;;</code>"}, {"owner": {"reputation": 29, "user_id": 9053335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba984559948e99e4e070f0271069b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Tcranmer", "link": "https://stackoverflow.com/users/9053335/tcranmer"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1512601745, "post_id": 47684901, "comment_id": 82329609, "body": "Hmmm, when you get an unfortunate segmentation fault XD @Barmar I see, so get rid of (*char), I unfortunately need malloc for my 3rd string (as far as I know)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1512602109, "post_id": 47684901, "comment_id": 82329734, "body": "I never said not to use <code>malloc</code>, I said not to <i>cast</i> the result. <code>char *str4 = malloc(strlen(str1) + strlen(str2)+ 29);</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1512602182, "post_id": 47684901, "comment_id": 82329763, "body": "When you change <code>asterisk</code> to an ordinary variable, you should use <code>asterisk</code> instead of <code>*asterisk</code> in the rest of the code."}, {"owner": {"reputation": 29, "user_id": 9053335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba984559948e99e4e070f0271069b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Tcranmer", "link": "https://stackoverflow.com/users/9053335/tcranmer"}, "edited": false, "score": 0, "creation_date": 1512602253, "post_id": 47684901, "comment_id": 82329791, "body": "Ya, Im to get rid of (char *) in my malloc because it&#39;s repetitive. Using <code>asterisk</code> instead of <code>*asterisk</code> gives me a warning of comparing without a cast. 29 is the max characters I would need for the asterisks that may be needed, and the NULL character"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1512602303, "post_id": 47684901, "comment_id": 82329816, "body": "Why are you adding 29 to the sum of the string lengths?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1512602619, "post_id": 47684901, "comment_id": 82329945, "body": "Hint: rewrite using <code>for()</code> loops."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9053335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba984559948e99e4e070f0271069b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Tcranmer", "link": "https://stackoverflow.com/users/9053335/tcranmer"}, "edited": false, "score": 0, "creation_date": 1512713972, "post_id": 47685175, "comment_id": 82377365, "body": "Thank you for the answer; with some tweaking it worked (I just had to add a p3++ because it would put the next string character over the asterisk)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 29, "user_id": 9053335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba984559948e99e4e070f0271069b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Tcranmer", "link": "https://stackoverflow.com/users/9053335/tcranmer"}, "edited": false, "score": 0, "creation_date": 1512720100, "post_id": 47685175, "comment_id": 82379810, "body": "Yeah, didn&#39;t notice the extra increment was missing. I changed it to do the increments along with the assignments."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1512720059, "last_edit_date": 1512720059, "creation_date": 1512602714, "answer_id": 47685175, "question_id": 47684901, "link": "https://stackoverflow.com/questions/47684901/passing-an-asterisk-into-a-string-in-c/47685175#47685175", "title": "Passing an Asterisk into a string in c", "body": "<p><code>asterix</code> doesn't need to be a pointer, it's just a single character.</p>\n\n<p>You're not using the correct size when allocating the result string. It needs to have 2 characters for each character in the two original strings -- 1 for each of the characters you're copying, and 1 for the asterisks in between.</p>\n\n<p>You need to add a null terminator to the final result. This can replace the final asterisk, since you're only supposed to have asterisks <em>between</em> the characters, not after each character.</p>\n\n<pre><code>char* widen_stars(char * str1, char *str2)\n{       \n    int ls1 = strlen(str1);\n    int ls2 = strlen(str2);\n\n    char *str4 = (char *) malloc(2 * ls1 + 2 * ls2);\n    char *p1 = str1;\n    char *p2 = str2;\n    char *p3 = str4;\n    const char asterix = '*';\n    while(*p1 != '\\0'){\n        *p3++ = *p1++;\n        *p3++ = asterix; // Needs to add an *, after printing the first element.//\n    }\n    while(*p2 != '\\0'){\n        *p3++ = *p2++;\n        *p3++ = asterix;\n    }\n    // Replace last asterisk with null byte\n    if (p3 &gt; str4) {\n        p3--;\n    }\n    *p3 = '\\0';\n    return str4;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9053335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba984559948e99e4e070f0271069b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Tcranmer", "link": "https://stackoverflow.com/users/9053335/tcranmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 47685175, "answer_count": 1, "score": 1, "last_activity_date": 1512720059, "creation_date": 1512601112, "last_edit_date": 1512602458, "question_id": 47684901, "link": "https://stackoverflow.com/questions/47684901/passing-an-asterisk-into-a-string-in-c", "title": "Passing an Asterisk into a string in c", "body": "<p>I have a question about putting a * into a concatenated string and having it print out the asterisk. My code takes 2 parameter strings, and needs to return a pointer that is the First string and Second string concatenated <em>BUT</em> I need it to have * inbetween each character. (Ex: String 1: 09876;  String 2; 12345  result; 0*9*8*7*6*1*2*3*4*5); My issue isn't with trying to print this result, it's adding the asterisk, especially since C won't let me just declare a * or have a pointer point to *. So I'm a bit stuck. Here's my code</p>\n\n<pre><code>   char* widen_stars(char * str1, char *str2)\n{       \n    int ls1 = strlen(str1);\n    int ls2 = strlen(str2);\n\n    char *str4 = (char *) malloc(strlen(str1) + strlen(str2)+ 29);\n    char *p1 = str1;\n    char *p2 = str2;\n    char *p3 = str4;\n    char *asterix;\n    *asterix = '*'; //Pointer pointing to *, won't let me though//\n        while(*p1 != '\\0'){\n        *p3 = *p1;\n        p1++;\n        p3++;\n        *p3 = *asterix; // Needs to add an *, after printing the first element.//\n        }\n        while(*p2 != '\\0'){\n        *p3 = *p2;\n        p2++;\n        p3++;\n        *p3 = *asterix;\n        }\n    return str4;\n}\n</code></pre>\n\n<p>I supplied just my function, because this is the only part of my code I get problems. EDIT: The 29 in my Malloc is to keep account of asterisks and the NULL character (The parameter strings have a maximum of 30 characters) I fixed my problem of adding the asterisk thanks to the community, now I get a segmentation fault, this should be fun.</p>\n"}, {"tags": ["c", "struct", "linked-list", "insert", "singly-linked-list"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1512600168, "post_id": 47684674, "comment_id": 82328991, "body": "You defined the function add_number  inside main. It is not a standard C feature."}, {"owner": {"reputation": 79, "user_id": 9046372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a622a29146aed372877f5c50502b92c9?s=128&d=identicon&r=PG&f=1", "display_name": "CodeOnce", "link": "https://stackoverflow.com/users/9046372/codeonce"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1512600364, "post_id": 47684674, "comment_id": 82329075, "body": "already fixed that minor error, but that not my main issue"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1512601478, "creation_date": 1512601478, "answer_id": 47684982, "question_id": 47684674, "link": "https://stackoverflow.com/questions/47684674/linked-lists-structures/47684982#47684982", "title": "Linked Lists Structures", "body": "<p>For starters according to the C Standard the function main without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>Also it seems you defined the function <code>add_number</code> inside the main (if you did not omit the closing brace for main). The C Standard does not allow to declare a function inside another function.</p>\n\n<p>Usually if a singly-linked one-sided list is declared then nodes to the list are added to its beginning.</p>\n\n<p>Here is a demonstrative program that shows how new nodes can be added to the beginning and the end of a singly linked list.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct numbers\n{\n    int number_inserted;\n    struct numbers *next;\n} NUMBERS;\n\n\nint add_number_front( NUMBERS **numbers, int x  )\n{\n    NUMBERS *tmp = malloc( sizeof( NUMBERS ) );\n    int success = tmp != NULL;\n\n    if ( success )\n    {\n        tmp-&gt;number_inserted = x;\n        tmp-&gt;next = *numbers;\n\n        *numbers = tmp;\n    }\n\n    return success;\n}\n\nint add_number_back( NUMBERS **numbers, int x  )\n{\n    NUMBERS *tmp = malloc( sizeof( NUMBERS ) );\n    int success = tmp != NULL;\n\n    if ( success )\n    {\n        tmp-&gt;number_inserted = x;\n        tmp-&gt;next = NULL;\n\n        while ( *numbers != NULL ) numbers = &amp;( *numbers )-&gt;next;\n\n        *numbers = tmp;\n    }\n\n    return success;\n}\n\n\nvoid display_numbers( NUMBERS **numbers )\n{\n    for ( NUMBERS *current = *numbers; current != NULL; current = current-&gt;next )\n    {\n        printf( \"%d \", current-&gt;number_inserted );\n    }\n}\n\nint main(void) \n{\n    NUMBERS *numbers = NULL;\n\n    for ( int i = 0; i &lt; 5; i++ ) add_number_back( &amp;numbers, i );\n\n    display_numbers( &amp;numbers );\n    putchar( '\\n' );\n\n    for ( int i = 0; i &lt; 5; i++ ) add_number_front( &amp;numbers, i );\n\n    display_numbers( &amp;numbers );\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>0 1 2 3 4 \n4 3 2 1 0 0 1 2 3 4 \n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 9046372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a622a29146aed372877f5c50502b92c9?s=128&d=identicon&r=PG&f=1", "display_name": "CodeOnce", "link": "https://stackoverflow.com/users/9046372/codeonce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512601697, "creation_date": 1512599971, "last_edit_date": 1512601697, "question_id": 47684674, "link": "https://stackoverflow.com/questions/47684674/linked-lists-structures", "title": "Linked Lists Structures", "body": "<pre><code>typedef struct numbers{\nint number_inserted;\nstruct numbers *next;\n}NUMBERS;\n\n\nint main(){\nNUMBERS * num=NULL\nint i=0;\n\nwhile(i&lt;5){\n   num=add_number(num);\n   i++;\n}\n}\n\nNUMBERS * add_number(NUMBERS *num){\n\n\nif (num== NULL) {\n    num = (NUMBERS *) malloc(sizeof(NUMBERS));\n    num-&gt;number_inserted=0;\n    num-&gt;next = NULL;\n}\n\nint gets;\nprintf(\"Insira o numero\");\nscanf(\"%d\",&amp;gets);\nnum-&gt;number_inserted=gets;\nnum-&gt;next = ????????\n\nreturn num;\n}\n</code></pre>\n\n<p>How can I link my variable num->next for my structure NUMBERS so when it is called again I dont lose the numbers I have inserted previously. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512600088, "post_id": 47684668, "comment_id": 82328966, "body": "What does <code>excve</code> have to do with it?  And if the program does not end then it certainly does not crash with a segmentation fault."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9062823"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512600155, "post_id": 47684668, "comment_id": 82328985, "body": "My fault sorry. Edited."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512600352, "post_id": 47684668, "comment_id": 82329070, "body": "After your SIGALARM is handled and the handler returns, control will resume in the function that was executing when the signal was received.  That function might continue as if nothing had happened, or it might fail, depending on a variety of factors, but it won&#39;t automatically exit the program.  If you want the program to end when it receives the <code>SIGALARM</code>, then why not have the handler call <code>exit()</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9062823"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512601055, "post_id": 47684668, "comment_id": 82329350, "body": "I was thinking to use kill(getpid(), SIGTERM). Could I use it? Or I must use   exit()?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1512605371, "post_id": 47684668, "comment_id": 82330904, "body": "Undefined behavior for calling a non async-safe function in a signal handler context."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512654615, "post_id": 47684668, "comment_id": 82352739, "body": "It would be silly to use <code>kill()</code> when you could use <code>raise()</code>, instead, to send a <code>SIGTERM</code> to yourself.  And you could do so, but that seems very roundabout.  In my mind, <code>_exit()</code> (as opposed to <code>exit()</code>, which I first recommended but which is not async-signal safe) is the stylistically right thing to do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9062823"}, "edited": false, "score": 1, "creation_date": 1513094823, "post_id": 47684668, "comment_id": 82514792, "body": "Thank you! Solved my problem!"}], "owner": {"user_type": "does_not_exist", "display_name": "user9062823"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1512609828, "creation_date": 1512599946, "last_edit_date": 1512609828, "question_id": 47684668, "link": "https://stackoverflow.com/questions/47684668/catching-signals", "title": "Catching signals", "body": "<p>I'm trying to write this little game. What I want is that when the time is over the program prints \"off time\" and then it ends. Why does it prints and not end?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\nvoid gestore(int segnale);\nint main(int argc, char * argv[]){\n    int random, answer;\n    srand(getpid());\n    random = rand () % atoi(argv[1])+1;\n    printf(\"Write a number: \");\n    alarm(3);\n    if(signal(SIGALRM, gestore))\n        return 0;\n    scanf(\"%d\", &amp;answer);\n    while(answer != random){\n        if(answer &gt; random)\n            printf(\"higher\\n\");\n        else if(answer &lt; random)\n            printf(\"lower\\n\");\n        printf(\"Write a number: \");\n        scanf(\"%d\", &amp;answer);\n    }\n    printf(\"guessed\\n\");\n}\nvoid gestore(int segnale){\n    signal(segnale, SIG_IGN);\n    printf(\"off time!\");\n    signal(segnale, gestore);\n}\n</code></pre>\n"}, {"tags": ["c", "command-line-arguments"], "comments": [{"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 2, "creation_date": 1512599705, "post_id": 47684586, "comment_id": 82328821, "body": "<b><i>Show Code</i></b>"}, {"owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "edited": false, "score": 0, "creation_date": 1512599765, "post_id": 47684586, "comment_id": 82328846, "body": "You seem to already know <i>how</i> to do this - use <code>argc</code> to check for the number of arguments. We don&#39;t know what kind of &quot;restrictions&quot; you have on actually writing code, is this for a school assignment or something?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1512599780, "post_id": 47684586, "comment_id": 82328853, "body": "writing a function just to check <code>argc</code> seems a bit overkill to me .. just check <code>argc</code> in <code>main</code> ... <code>if (argc==1){ create_board(10, 10); } else if (argc==3) { create_board(atoi(argv[1]), atoi(argv[2]); }else{ printError} ... return 0;</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512599790, "post_id": 47684586, "comment_id": 82328861, "body": "Although perhaps it evades the spirit of the problem, it seems that all you need to do is have <code>main()</code> call a <code>main_real()</code> function that is not subject to the same limitations, passing <code>argc</code> and <code>argv</code> to it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512599911, "post_id": 47684586, "comment_id": 82328902, "body": "But perhaps what you&#39;re looking for is more like <code>int num_rows = (argc &lt; 3) ? 10 : atoi(argv[1])</code>."}, {"owner": {"reputation": 187, "user_id": 8391046, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5396a3d60d7467ac89caad0fba8efd38?s=128&d=identicon&r=PG&f=1", "display_name": "Ismael", "link": "https://stackoverflow.com/users/8391046/ismael"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1512600100, "post_id": 47684586, "comment_id": 82328969, "body": "@yano Yes, that is the obvious solution. However a restriction on this assignment is that we are only allowed to call functions and declare/assign variables in main"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1512600387, "post_id": 47684586, "comment_id": 82329086, "body": "ok? My very limited pseudo code follows those restrictions. Declare the board in <code>main</code>, pass it to the <code>create_board</code> function which will dynamically allocate it... then after that call the next function in <code>main</code> that uses the board."}, {"owner": {"reputation": 187, "user_id": 8391046, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5396a3d60d7467ac89caad0fba8efd38?s=128&d=identicon&r=PG&f=1", "display_name": "Ismael", "link": "https://stackoverflow.com/users/8391046/ismael"}, "reply_to_user": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "edited": false, "score": 0, "creation_date": 1512600478, "post_id": 47684586, "comment_id": 82329117, "body": "@GregHewgill yes, this is for an assignment. I understand that I can check argc for the number of arguments; where I&#39;m stuck is how to assign argv[1] to be numRows and argv[2] to be numCols in a separate function that is called in main"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1512601139, "post_id": 47684586, "comment_id": 82329381, "body": "I think you need to go get some clarification from your teacher (or maybe just add some clarification for me if I&#39;m the only one). Passing <code>argv</code> to a function doesn&#39;t violate your &quot;<i>in main we are only allowed to call functions and/or declare/assign variables</i>&quot; restriction. That&#39;s not even a restriction. Every <code>main</code> in the history of <code>c</code> has done that except for HelloWorld and similar. I declare/assign variables and call functions from <code>main</code> all the time."}, {"owner": {"reputation": 187, "user_id": 8391046, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5396a3d60d7467ac89caad0fba8efd38?s=128&d=identicon&r=PG&f=1", "display_name": "Ismael", "link": "https://stackoverflow.com/users/8391046/ismael"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1512601598, "post_id": 47684586, "comment_id": 82329556, "body": "@yano I&#39;m sorry for not wording it better. My problem was that I was trying to split argv before passing it as parameters, when I should&#39;ve just passed the whole thing and accessed different elements within the function, as seen in the answers below. thank you"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 8391046, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5396a3d60d7467ac89caad0fba8efd38?s=128&d=identicon&r=PG&f=1", "display_name": "Ismael", "link": "https://stackoverflow.com/users/8391046/ismael"}, "edited": false, "score": 0, "creation_date": 1512600166, "post_id": 47684702, "comment_id": 82328989, "body": "Yes but in main we are only allowed to call functions or declare/assign variables. Thus I would need to pass argv[1] and argv[2] as parameters in a function which wouldn&#39;t work."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 1, "creation_date": 1512600407, "post_id": 47684702, "comment_id": 82329094, "body": "So pass <code>argc</code> and <code>argv</code> and in the function, determine the rows / cols based on <code>argc</code>."}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1512600078, "creation_date": 1512600078, "answer_id": 47684702, "question_id": 47684586, "link": "https://stackoverflow.com/questions/47684586/how-to-code-for-optional-command-line-parameters-in-c/47684702#47684702", "title": "How to code for optional command line parameters in C", "body": "<p>It doesn't matter if the arguments don't exist for a code path you don't take.</p>\n\n<p>What I mean:</p>\n\n<pre><code>if(3==argc)\nmake_board(argv[1], argv[2]);\nelse if(1==argc)\nmake_board(\"10\", \"10\");\nelse\n{\n/*error*/\n}\n</code></pre>\n\n<p>If numArgs is not 3 then that path is not taken so the non-existent arguments aren't used and are never evaluated.</p>\n"}, {"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": true, "score": 1, "last_activity_date": 1512600570, "creation_date": 1512600570, "answer_id": 47684822, "question_id": 47684586, "link": "https://stackoverflow.com/questions/47684586/how-to-code-for-optional-command-line-parameters-in-c/47684822#47684822", "title": "How to code for optional command line parameters in C", "body": "<p>You can pass both <code>argc</code> and <code>argv</code> to a function and have it return rows and cols.</p>\n\n<pre><code>int main(int argc, char **argv) {\n    int rows = 10, cols = 10;\n    check_args(argc, argv, &amp;rows, &amp;cols);\n    return 0;\n}\n\nvoid check_args(int argc, char **argv, int *rows, int *cols) {\n    if (argc == 3) {\n        *rows = atoi(argv[1]);\n        *cols = atoi(argv[2]);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1512601703, "last_edit_date": 1512601703, "creation_date": 1512601302, "answer_id": 47684948, "question_id": 47684586, "link": "https://stackoverflow.com/questions/47684586/how-to-code-for-optional-command-line-parameters-in-c/47684948#47684948", "title": "How to code for optional command line parameters in C", "body": "<p>You can do it quite easily with variable assignment using a <em>ternary</em> operator to check if <code>argc &gt; 2</code> and if it is, convert the supplied arguments to <code>rows</code> and <code>cols</code>, otherwise, use the default <code>10</code> for each, e.g.</p>\n\n<pre><code>errno = 0;\n\nint rows = argc &gt; 2 ? (int)strtol (argv[1], NULL, 10) : 10,\n    cols = argc &gt; 2 ? (int)strtol (argv[2], NULL, 10) : 10;\n\nif (errno) { /* handle error in strtol conversion    */\n             /* (you should also check for overflow) */ }\n</code></pre>\n\n<p>(<strong>note:</strong> always check for error in the conversion before continuing -- you can move this to a function and fully validate the <code>strtol</code> conversion by checking <code>nptr</code> against <code>endptr</code> to insure characters were converted, and then saving the value to a temporary <code>long</code> value, you can insure the values are between <code>INT_MIN</code> and <code>INT_MAX</code> (and reasonable) before assigning to <code>rows</code>, <code>cols</code>)</p>\n\n<p>If you must use a function, just pass a pointer to <code>rows</code> and <code>cols</code> as parameters and then set the values stored at each respective address within the function. That way you have a simple function call that can return <code>0/1</code> for success/failure and update the values for <code>rows, cols</code> through the pointers passed as parameters.</p>\n"}], "owner": {"reputation": 187, "user_id": 8391046, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5396a3d60d7467ac89caad0fba8efd38?s=128&d=identicon&r=PG&f=1", "display_name": "Ismael", "link": "https://stackoverflow.com/users/8391046/ismael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 47684822, "answer_count": 3, "score": 1, "last_activity_date": 1512601703, "creation_date": 1512599491, "question_id": 47684586, "link": "https://stackoverflow.com/questions/47684586/how-to-code-for-optional-command-line-parameters-in-c", "title": "How to code for optional command line parameters in C", "body": "<p>My program has to accept optional command line parameters where there will be either 1 or 3 parameters (executable, number of rows, number of columns). If argc is anything other than 3, we have to create a board that is 10x10 (I've already made a function to create the board). </p>\n\n<p>I'm not sure how to account for this. One restriction on main.c is that we're only allowed to declare/assign variables and call functions, so I'm stuck on how I'm supposed to make this work. My initial idea was to write a function correctNumOfArgs to check if argc is 3, and then return true or false. I would then use that result in a different function to determine how to create the board, but that would still require me to pass argv[1] and argv[2] as parameters in the function and they might not even exist. How do I get around this? Note: I looked at other questions regarding optional command line parameters and they suggested solutions more advanced than what we have learned. Is there a more basic solution to this?</p>\n"}, {"tags": ["c", "visual-c++", "ffmpeg", "static-libraries"], "owner": {"reputation": 151, "user_id": 6911480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1daab39250cf2bfa7ccb9c7b68d53e?s=128&d=identicon&r=PG&f=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/6911480/saeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1512599416, "creation_date": 1512599416, "question_id": 47684565, "link": "https://stackoverflow.com/questions/47684565/compile-ffmpeg-library-statically-using-visual-c", "title": "Compile ffmpeg library statically using visual c++", "body": "<p>When I try to compile ffmpeg library statically using visual studio 2015, with following configure options </p>\n\n<pre><code> ./configure --toolchain=msvc --arch=x86 --enable-yasm --enable-asm  --disable-shared --enable-static\n</code></pre>\n\n<p>surprisingly, I get <code>.a</code> libraries instead of <code>.lib</code>. How can I compile ffmpeg to generate .libs ?</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1512598960, "post_id": 47684421, "comment_id": 82328485, "body": "Read manual pages, you need some more includes."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1512598964, "post_id": 47684421, "comment_id": 82328489, "body": "<i>Some systems require the inclusion of &lt;netinet/in.h&gt; instead of &lt;arpa/inet.h&gt;.</i> <code>rand</code> is in <code>stdlib</code>."}, {"owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "edited": false, "score": 1, "creation_date": 1512599235, "post_id": 47684421, "comment_id": 82328614, "body": "ive just added #include &lt;arpa/inet.h&gt; to connection.c and that has fixed those errors so I just have the &#39;rand&#39; function warning left to fix"}, {"owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "edited": false, "score": 1, "creation_date": 1512599340, "post_id": 47684421, "comment_id": 82328667, "body": "bingo thanks Eugene thats fixed it !"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1512599408, "post_id": 47684421, "comment_id": 82328704, "body": "@Bat This information is easily located in the man pages right after the &quot;Synopsis&quot;. Next time read it more carefully."}, {"owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512599594, "post_id": 47684421, "comment_id": 82328774, "body": "@EugeneSh. As per my post i did check the man page but it doesnt state to use stdlib which is why as a complete novice I asked for help from experts"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512599643, "post_id": 47684421, "comment_id": 82328796, "body": "@Bat Which system are you using to get the <code>man</code> pages?"}, {"owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512599733, "post_id": 47684421, "comment_id": 82328831, "body": "@EugeneSh. Debian"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512599780, "post_id": 47684421, "comment_id": 82328852, "body": "And it is very different from this: <a href=\"https://linux.die.net/man/3/rand\" rel=\"nofollow noreferrer\">linux.die.net/man/3/rand</a> ?"}, {"owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512599985, "post_id": 47684421, "comment_id": 82328934, "body": "@EugeneSh. yes ive uploaded an image in the description"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512600131, "post_id": 47684421, "comment_id": 82328977, "body": "this is not the correct man page. Try <code>man 3 rand</code>"}, {"owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "edited": false, "score": 0, "creation_date": 1512600259, "post_id": 47684421, "comment_id": 82329033, "body": "ah that is more helpful and why I couldn&#39;t find the answer when I looked before. Why do you need to specify the 3 ? ive not come across that before"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1512600298, "post_id": 47684421, "comment_id": 82329050, "body": "Take a look here: <a href=\"https://unix.stackexchange.com/questions/3586/what-do-the-numbers-in-a-man-page-mean\" title=\"what do the numbers in a man page mean\">unix.stackexchange.com/questions/3586/&hellip;</a>"}, {"owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "edited": false, "score": 0, "creation_date": 1512600728, "post_id": 47684421, "comment_id": 82329209, "body": "ok thanks I&#39;ll take a look and thanks for your help"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1512614694, "post_id": 47684421, "comment_id": 82333098, "body": "don&#39;t put images of text here"}], "owner": {"reputation": 135, "user_id": 8993306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d91d04c5dba039d3072b603ef1b2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bat", "link": "https://stackoverflow.com/users/8993306/bat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3771, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1512614675, "creation_date": 1512598855, "last_edit_date": 1512614675, "question_id": 47684421, "link": "https://stackoverflow.com/questions/47684421/c-warning-implicit-declaration-of-function-htons-ntohs-rand-are-the", "title": "C warning: implicit declaration of function &#39;htons&#39; &amp; &#39;ntohs&#39; &amp; &#39;rand&#39; - are they missing headers?", "body": "<p>I'm very new to C programming so wondered if anyone could help with these warnings. (I am trying to compile someone else's code, I couldn't code these lol)</p>\n\n<pre><code>src/connection.c:79:9: warning: implicit declaration of function 'close' [-Wimplicit-function-declaration\n         close(conn-&gt;fd);\n\nsrc/main.c: In function 'main':\nsrc/main.c:37:16: warning: implicit declaration of function 'inet_addr' [-Wimplicit-function-declaration]\n     addrs[0] = inet_addr(\"192.168.252.20\"); // Address to bind to\n\n\nsrc/server.c: In function 'server_queue_telnet':\nsrc/server.c:93:9: warning: implicit declaration of function 'sleep' [-Wimplicit-function-declaration]\n         sleep(1);\n\nsrc/telnet_info.c: In function 'telnet_info_parse':\nsrc/telnet_info.c:59:12: warning: implicit declaration of function 'inet_addr' [-Wimplicit-function-decla\n     addr = inet_addr(addr_str);\n\n\nsrc/telnet_info.c:60:12: warning: implicit declaration of function 'htons' [-Wimplicit-function-declarati\n     port = htons(atoi(port_str));\n\nsrc/server.c: In function 'server_queue_telnet':\nsrc/server.c:93:9: warning: implicit declaration of function 'sleep' [-Wimplicit-function-declaration]\n         sleep(1);\n\nsrc/util.c:94:9: warning: implicit declaration of function 'close' [-Wimplicit-function-declaration]\n         close(fd);\n\n\nsrc/util.c: In function 'util_trim':\nsrc/util.c:161:11: warning: implicit declaration of function 'isspace' [-Wimplicit-function-declaration]\n     while(isspace(*str))\n</code></pre>\n\n<p>I managed to fix the above warnings by including the below missing include statements in the appropriate files.</p>\n\n<pre><code>include &lt;unistd.h&gt;\ninclude &lt;arpa/inet.h&gt; \ninclude &lt;ctype.h&gt;\n</code></pre>\n\n<p>However the below warnings still persist and I cannot work out which include statements are missing. When I do <strong>man ntohs</strong> , <strong>man htons</strong> and <strong>man rand</strong> I cannot see any specified libraries that should be included in connection.c and util.c files</p>\n\n<pre><code>src/connection.c: In function 'connection_close':\nsrc/connection.c:62:17: warning: implicit declaration of function 'ntohs' [-Wimplicit-function-declaratio\n                 ntohs(conn-&gt;info.port),\n\nsrc/connection.c: In function 'connection_consume_arch':\nsrc/connection.c:485:35: warning: implicit declaration of function 'htons' [-Wimplicit-function-declarati\n                 ehdr-&gt;e_machine = htons(ehdr-&gt;e_machine);\n\nsrc/util.c: In function 'util_socket_and_bind':\nsrc/util.c:77:18: warning: implicit declaration of function 'rand' [-Wimplicit-function-declaration]\n     start_addr = rand() % srv-&gt;bind_addrs_len;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/H47Id.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H47Id.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "io", "ascii", "unsigned-char"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1512598932, "post_id": 47684335, "comment_id": 82328471, "body": "&quot;od&quot; stands for &quot;OCTAL dump&quot;. Octal 226 is 150."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1512599142, "post_id": 47684335, "comment_id": 82328576, "body": "And 257 can&#39;t be a decimal byte value, it is octal for decimal 175."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7856499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e942a8023d6309dd524b19816ac3843a?s=128&d=identicon&r=PG&f=1", "display_name": "DrakesDR", "link": "https://stackoverflow.com/users/7856499/drakesdr"}, "edited": false, "score": 0, "creation_date": 1512599520, "post_id": 47684457, "comment_id": 82328741, "body": "The ASCII table that I was using didn&#39;t have octal numbers for Extended ASCII. I found another table that gives more info. Thanks for clarifying"}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": true, "score": 1, "last_activity_date": 1512599003, "creation_date": 1512599003, "answer_id": 47684457, "question_id": 47684335, "link": "https://stackoverflow.com/questions/47684335/shifting-extended-ascii-codes/47684457#47684457", "title": "Shifting Extended ASCII codes", "body": "<p>You are printing in octal (that's what od does by default), 226 octal is 150 decimal.</p>\n"}], "owner": {"reputation": 33, "user_id": 7856499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e942a8023d6309dd524b19816ac3843a?s=128&d=identicon&r=PG&f=1", "display_name": "DrakesDR", "link": "https://stackoverflow.com/users/7856499/drakesdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 47684457, "answer_count": 1, "score": 1, "last_activity_date": 1512599003, "creation_date": 1512598486, "question_id": 47684335, "link": "https://stackoverflow.com/questions/47684335/shifting-extended-ascii-codes", "title": "Shifting Extended ASCII codes", "body": "<p>When assigning Extended ASCII codes to an unsigned char, I noticed that the values are shifted upwards when they are written to a file.</p>\n\n<p>I condensed my code into this simple program to briefly present my question:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    unsigned char testascii[3];\n\n    testascii[0] = 122;\n    testascii[1] = 150;\n    testascii[2] = 175;\n\n    printf(\"%d\\n\", testascii[0]);\n    printf(\"%d\\n\", testascii[1]);\n    printf(\"%d\\n\", testascii[2]);\n\n    return 0;\n}\n</code></pre>\n\n<p>If I run this simple program, I get this terminal output:</p>\n\n<pre><code>122\n150\n175\n</code></pre>\n\n<p>This is correct.</p>\n\n<p>If I now add the following to the above program:</p>\n\n<pre><code>FILE *f;\nf = fopen(\"/mystuff/testascii\", \"wb\");\nif (f == NULL)\n{\n  printf(\"Error opening file\\n\");\n  exit(1);\n}\nfwrite(testascii, 1, 3, f);\nfclose(f);\n</code></pre>\n\n<p>It runs correctly but if I now go to the O/S and run:</p>\n\n<pre><code>od -c testascii\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>0000000   z 226 257\n0000003\n</code></pre>\n\n<p>As you can see the Standard ASCII code (below 128) is correctly shown; however the Extended ASCII codes (above 127) are changed. I expect them to be 150 and 175 but they are 226 and 257.</p>\n\n<p>If I remove the binary flag from the file open command, the result is still the same.</p>\n\n<p>As a final check, instead of the binary print (fwrite), I changed the code again and looped through the array and did a fprintf of each item like this:</p>\n\n<pre><code>fprintf (fp, \"%d\", appendtxt[i]);\n</code></pre>\n\n<p>Here's the OD display for that:</p>\n\n<pre><code>0000000   1   2   2   1   5   0   1   7   5\n0000011\n</code></pre>\n\n<p>This all tells me that the binary print (fwrite) isn't doing what I expected. It's my understanding the fwrite command writes the binary data to the file. In that case why does it successful write a value less than 128 but it fails with values equal to or greater than 128?</p>\n\n<p>Environment:\n  Code::Blocks 16.01\n  Centos 7.1</p>\n\n<p>Note: I did find this similar question: <a href=\"https://stackoverflow.com/questions/30961728/fwrite-with-non-ascii-characters\">fwrite with non ASCII characters</a> but it didn't seem to help with my situation. I could be wrong. Please let me know if I missed something in that post?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1512597419, "post_id": 47684067, "comment_id": 82327812, "body": "This code inevitably invokes undefined behavior. You need to understand strings in c first. Read about them, what they are and how they are represented. <code>char x[1]</code> is too small because you need to account for the <code>&#39;\\0&#39;</code> terminator."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1512597429, "post_id": 47684067, "comment_id": 82327816, "body": "Please read up about strings and integer. Please read the manual page for fgets."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512640577, "post_id": 47684067, "comment_id": 82343462, "body": "the supposed answer has undefined behavior.  the smallest buffer for <code>fgets()</code> is 3 bytes.  That will hold the char, the newline, the NUL byte.  Suggest read the MAN page for <code>fgets()</code> for further details.   If you only want to read a single character and have it be an &#39;int&#39;, then use: <code>int ch = fgetc();</code>"}], "answers": [{"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1512598596, "post_id": 47684165, "comment_id": 82328314, "body": "Preferrably <code>strtol</code>, not <code>atoi</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1512640743, "post_id": 47684165, "comment_id": 82343585, "body": "the values from <code>stdin</code> would be:  {&#39;6&#39;, &#39;7&#39;, &#39;\\n&#39;}  and the the values in the buffer set by <code>fgets()</code> would be: <code>{&#39;6&#39;, &#39;7&#39;, &#39;\\n&#39;, &#39;\\0&#39;}</code>  AND the OP indicated conversion of a single character to integer, not a string of characters."}], "tags": [], "owner": {"reputation": 714, "user_id": 9036814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250742688f24344257034879f1fc76ea?s=128&d=identicon&r=PG&f=1", "display_name": "mckuok", "link": "https://stackoverflow.com/users/9036814/mckuok"}, "is_accepted": true, "score": 1, "last_activity_date": 1512678674, "last_edit_date": 1512678674, "creation_date": 1512597660, "answer_id": 47684165, "question_id": 47684067, "link": "https://stackoverflow.com/questions/47684067/what-is-the-required-allocation-of-a-char-that-is-to-be-converted-to-an-int-from/47684165#47684165", "title": "What is the required allocation of a char that is to be converted to an int from stdin", "body": "<p>Your input does not get automatically converted into an int. For example if your user typed in \"67 (enter)\", what you should expect in <code>stdin</code> is <code>char</code> array of <code>{'6', '7', '\\n', '\\0'}</code>. </p>\n\n<p>What you want to do is to allocate a big enough array, save the user input from <code>stdin</code>, then use <code>atoi</code> to do the conversion. </p>\n"}], "owner": {"reputation": 336, "user_id": 6411264, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b6da9faea5a6ec9f25c4cca74a18ccf6?s=128&d=identicon&r=PG&f=1", "display_name": "UberStuper", "link": "https://stackoverflow.com/users/6411264/uberstuper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47684165, "answer_count": 1, "score": 0, "last_activity_date": 1512678674, "creation_date": 1512597236, "last_edit_date": 1512598662, "question_id": 47684067, "link": "https://stackoverflow.com/questions/47684067/what-is-the-required-allocation-of-a-char-that-is-to-be-converted-to-an-int-from", "title": "What is the required allocation of a char that is to be converted to an int from stdin", "body": "<p>Hear me C gods, I am but a newbie: </p>\n\n<p>Trying to get an input char that will be a small int, convert it to an int and then print it out again. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(void) {\n    char x[1]; /* I assumed this is OK because my input is between -127 and 127 */;\n    printf(\"Input your integer\\n\");\n    fgets(x, 1, stdin);\n    printf(\"you entered %s\\n\", x); \n    if (isdigit(x)) {\n        int i = x - '0';\n        printf(\"success it's:%d \\n\", i);\n        printf(\"two times %d is %d\\n\", i, i*2);\n    } else {\n        printf(\"YOU DID NOT INPUT AN INTEGER\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>What is the correct allocation of <code>char x[1]</code> for this to work? In the end my program just screams at me. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>thanks to an answer below, this works: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(void) {\n    char x[2]; \n    printf(\"Input your integer\\n\");\n    fgets(x, 2, stdin);\n    printf(\"you entered %s\\n\", x);\n    if (isdigit(x[0])) {\n        int i = x[0] - '0';\n        printf(\"success it's:%d \\n\", i);\n        printf(\"two times %d is %d\\n\", i, i*2);\n    } else {\n        printf(\"YOU DID NOT INPUT AN INTEGER\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>It seems I needed to account for an additional char <code>\\0</code>, once that was done in the allocation, then I could use isdigit by indexing the char array and do the same for the conversion. Whether this is recommended use though I'm unsure(I suspect not). </p>\n"}, {"tags": ["c", "freertos", "nucleo"], "answers": [{"tags": [], "owner": {"reputation": 2658, "user_id": 3887835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c6f11a2a2ff629a3684515f6769637?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/3887835/richard"}, "is_accepted": false, "score": 0, "last_activity_date": 1512602865, "creation_date": 1512602865, "answer_id": 47685196, "question_id": 47683865, "link": "https://stackoverflow.com/questions/47683865/read-data-from-serial-port-in-freertos/47685196#47685196", "title": "Read data from serial port in FreeRTOS", "body": "<p>I find your question confusing as you don't clearly state what the issue you are having is and you make assumptions that others will know how the functions you are calling are implemented.  In any case is sounds unrelated to FreeRTOS.</p>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1512602865, "creation_date": 1512596294, "question_id": 47683865, "link": "https://stackoverflow.com/questions/47683865/read-data-from-serial-port-in-freertos", "title": "Read data from serial port in FreeRTOS", "body": "<p>We have a issue during reading data from serial port. The C function which is used to read data have a argument for the data size in bytes. In order to read data  we need to know in advance the size of the incoming data. We use RFID reader via serial port connection. Data is send to Nucleo board in different size each time.\nThe other problem that we face is the Nucleo interruption during reading data. When we receive the data in height speed we need to initiate it again. This leads to data loss in height data transfer speeds.\nOne possible solution will be to use DMA(direct memory access) but we are not familiar wit this approach.\nCan you propose some solution?</p>\n"}, {"tags": ["c", "scanf", "strtok"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1512596217, "post_id": 47683776, "comment_id": 82327228, "body": "Note: follow on from <a href=\"https://stackoverflow.com/questions/47679916/trying-to-extract-complex-numbers-from-strings\">previous question</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1512596335, "post_id": 47683776, "comment_id": 82327294, "body": "Note: you mis-copied <code>sscanf(tok, &quot;%1f%1fi&quot;, &amp;real, &amp;imag);</code> where the <code>1</code> (one) should be <code>l</code> (ell)."}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1512596345, "post_id": 47683776, "comment_id": 82327300, "body": "<code>%1f%1fi&quot;</code> ? should be <code>%lf%lfi</code>"}, {"owner": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "edited": false, "score": 0, "creation_date": 1512596790, "post_id": 47683776, "comment_id": 82327523, "body": "I knew it was something stupid ahaha. Thanks Weather!"}], "owner": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512595918, "creation_date": 1512595918, "question_id": 47683776, "link": "https://stackoverflow.com/questions/47683776/unexpected-output-for-sscanf", "title": "Unexpected output for sscanf", "body": "<p>I am inputting a file and parsing the text into tokens. I am attempting to take each token which consists of a real and imaginary number and trying to print them out into separate columns. Ex input file format: [[[0+0i 1+1i 9-345i -7654-1234i][0+0i......][...]][[......]]]\nThe resulting output is suposed to be:</p>\n\n<pre><code>0       0\n1       1\n9       -345\n-7654   -1234 etc......\n</code></pre>\n\n<p>I am able to successfully pull in the file and the tok was tested and it was correct. The only prblem is once the tok is put through the sscanf statement all the output is:\n0      0\nfor all the items in the array. The simplistic form was tested and it also gave the correct output:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main ()\n{\n    double r, i;\n    char array[]= \"[[[1+1i -4+100i 45-234i -56-78i]]]\";\n    char *tok;\n    tok = strtok(array, \" []\");\n    while(tok) {\n        sscanf(tok, \"%lf%lfi\", &amp;r, &amp;i);\n        printf(\"%.0f%.0fi\\n\", r, i);\n        tok = strtok(NULL, \" []\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This worked like a charm However when I apply this to my code, i am only getting zeros. My code is the following:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\n\nchar data[999999];\nint line = 0;\nchar *tok;\ndouble real, imag;\n\nvoid main()\n{\nFILE * filei = fopen(\"signal_subband_16.ascii\",\"r\");\nFILE * fileo = fopen(\"Output_file_simple.txt\",\"a\");\nif(filei==NULL){\n    printf(\"There was an error opening the input file\");\n    exit(1);\n}\nelse if(fileo==NULL){\n    printf(\"There was an error opening the output file\");\n    exit(1);\n}\nelse{\n    while(fgets(data,999999,filei)){\n        tok = strtok(data,\" []\");\n        while(tok){\n        //  printf(\"%s\\n\",tok);\n            sscanf(tok, \"%1f%1fi\", &amp;real, &amp;imag);\n            printf(\"%8.0f%8.0fi\\n\", real, imag);\n            tok = strtok(NULL,\" []\");\n        }\n    }\n\n\n    memset(data,0,999999);\n    line ++;\n\n}\n\n\n\n\n\n\n\n\nfclose(filei);\nfclose(fileo);\n\n}\n</code></pre>\n\n<p>Feel like this is a very simple solution I'm just missing something. Thank you in advance for the help.</p>\n"}, {"tags": ["c", "opencv", "memory", "memory-leaks"], "comments": [{"owner": {"reputation": 1103, "user_id": 4200424, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1bb83ff2ad5dcb60ee8e408792526e49?s=128&d=identicon&r=PG&f=1", "display_name": "bennji_of_the_overflow", "link": "https://stackoverflow.com/users/4200424/bennji-of-the-overflow"}, "edited": false, "score": 1, "creation_date": 1512596967, "post_id": 47683755, "comment_id": 82327618, "body": "Are you using an additional library? I can&#39;t find any mention anywhere of cvFreeImage or cvFreeImageHeader. Do you mean cvReleaseImage()?"}, {"owner": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1512597091, "post_id": 47683755, "comment_id": 82327664, "body": "The code you show is definitely missing a <code>cvReleaseImage</code> call, to go with the <code>cvCreateImage</code> -- you always allocate, never deallocate. Also, you shouldn&#39;t be deallocating <code>frameRaw</code>, the docs of <code>cvQueryFrame</code> explicitly mention that."}, {"owner": {"reputation": 151, "user_id": 3002417, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/4399ee6ae379dd20d67389e0c8c5197f?s=128&d=identicon&r=PG&f=1", "display_name": "Panni", "link": "https://stackoverflow.com/users/3002417/panni"}, "reply_to_user": {"reputation": 1103, "user_id": 4200424, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1bb83ff2ad5dcb60ee8e408792526e49?s=128&d=identicon&r=PG&f=1", "display_name": "bennji_of_the_overflow", "link": "https://stackoverflow.com/users/4200424/bennji-of-the-overflow"}, "edited": false, "score": 0, "creation_date": 1512597323, "post_id": 47683755, "comment_id": 82327773, "body": "@bennji_of_the_overflow you&#39;re right, I meant <code>cvReleaseImage()</code>, seems like it&#39;s getting too late for me..."}, {"owner": {"reputation": 151, "user_id": 3002417, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/4399ee6ae379dd20d67389e0c8c5197f?s=128&d=identicon&r=PG&f=1", "display_name": "Panni", "link": "https://stackoverflow.com/users/3002417/panni"}, "reply_to_user": {"reputation": 14358, "user_id": 3962537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AI0Bc.png?s=128&g=1", "display_name": "Dan Ma\u0161ek", "link": "https://stackoverflow.com/users/3962537/dan-ma%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1512597559, "post_id": 47683755, "comment_id": 82327881, "body": "Thank you very much @DanMa\u0161ek seems like just using <code>cvReleaseImage(&amp;frame)</code> after each iteration solved  the problem"}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 3002417, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/4399ee6ae379dd20d67389e0c8c5197f?s=128&d=identicon&r=PG&f=1", "display_name": "Panni", "link": "https://stackoverflow.com/users/3002417/panni"}, "is_accepted": true, "score": 1, "last_activity_date": 1512598180, "last_edit_date": 1512598180, "creation_date": 1512597913, "answer_id": 47684218, "question_id": 47683755, "link": "https://stackoverflow.com/questions/47683755/opencv-leaks-memory-cvresize-cvcreateimage/47684218#47684218", "title": "OpenCV leaks memory (cvResize, cvCreateImage)", "body": "<p>Thanks to @DanMa\u0161ek I found the solution:</p>\n\n<p>After each <code>while</code>-loop iteration the allocated memory for the frame has to be freed. That can be accomplished using <code>cvReleaseImage(&amp;frame)</code>.</p>\n\n<p>The complete code now looks like this:</p>\n\n<pre><code>IplImage *frame;\nIplImage *frameRaw;\n\nmain() {\n    CvCapture *capture = cvCreateCameraCapture(-1);\n\n    while (1) {\n        frameRaw = cvQueryFrame(capture);\n        frame = cvCreateImage(cvSize(WIDTH, HEIGHT), frameRaw-&gt;depth, frameRaw-&gt;nChannels);\n\n        cvResize(frameRaw, frame, 0); // 0 = CV_INTER_NEAREST\n\n        // Do something with \"frame\"\n\n        cvReleaseImage(&amp;frame);\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3002417, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/4399ee6ae379dd20d67389e0c8c5197f?s=128&d=identicon&r=PG&f=1", "display_name": "Panni", "link": "https://stackoverflow.com/users/3002417/panni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 47684218, "answer_count": 1, "score": 1, "last_activity_date": 1512598202, "creation_date": 1512595789, "last_edit_date": 1512598202, "question_id": 47683755, "link": "https://stackoverflow.com/questions/47683755/opencv-leaks-memory-cvresize-cvcreateimage", "title": "OpenCV leaks memory (cvResize, cvCreateImage)", "body": "<p>I'm running OpenCV on a RaspberryPi and use OpenCVs C interface.</p>\n\n<p>I need to resize the dimensions of an image from a webcam, therefore I used the <code>cvResize()</code> function.</p>\n\n<p>It works fine but after a few seconds I run out of memory, since I'm executing the code inside a <code>while(1)</code>-Loop and read about other people having this problem, I suspect a memory leak.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>IplImage *frame;\nIplImage *frameRaw;\n\nmain() {\n    CvCapture *capture = cvCreateCameraCapture(-1);\n\n    while (1) {\n        frameRaw = cvQueryFrame(capture);\n        frame = cvCreateImage(cvSize(WIDTH, HEIGHT), frameRaw-&gt;depth, frameRaw-&gt;nChannels);\n\n        cvResize(frameRaw, frame, 0); // 0 = CV_INTER_NEAREST\n\n        // Do something with \"frame\"\n    }\n\n}\n</code></pre>\n\n<p>I already tried to free the reserved memory at the end of each iteration using <code>cvReleaseImage(&amp;frameRaw)</code> (or <code>&amp;frame</code>) but that always caused a segmentation fault. Using <code>cvReleaseImageHeader()</code> caused no segmentation fault but also didn't free any memory.</p>\n\n<p>Also I tried to change the capture-resolution of the frames via <code>cvSetCaptureProperty()</code> but that did nothing. </p>\n\n<p>Can someone help me understand what's going wrong here?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "pointers", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 4719, "user_id": 2958070, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FtkjC.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2958070/ben"}, "edited": false, "score": 2, "creation_date": 1512595730, "post_id": 47683704, "comment_id": 82326986, "body": "valgrind can help! <a href=\"https://stackoverflow.com/questions/5134891/how-do-i-use-valgrind-to-find-memory-leaks\" title=\"how do i use valgrind to find memory leaks\">stackoverflow.com/questions/5134891/&hellip;</a>"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1512595994, "post_id": 47683704, "comment_id": 82327111, "body": "Leak happens <code>v=fct(v);</code>, you could have <code>fct</code> take a pointer instead and check  the validity of <code>vector::t</code> (and make sure <code>vector:;t</code> is always initialised), though I can&#39;t say for sure that&#39;s what you should since I really can&#39;t figure out the purpose of this program."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512641042, "post_id": 47683704, "comment_id": 82343792, "body": "regarding: <code>vector fct (vector v){</code>  strongly suggest replacing with: <code>vector* fct (vector *v){</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3676, "user_id": 414279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd8e859d8cf73f2d49eb640964605bb?s=128&d=identicon&r=PG", "display_name": "rurban", "link": "https://stackoverflow.com/users/414279/rurban"}, "is_accepted": false, "score": 1, "last_activity_date": 1512595702, "creation_date": 1512595702, "answer_id": 47683737, "question_id": 47683704, "link": "https://stackoverflow.com/questions/47683704/does-this-c-code-leak-memory/47683737#47683737", "title": "Does this C code leak memory?", "body": "<p>Sure it does. vector t is allocated twice, and freed once. The whole architecture looks problematic.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 8488207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DDMYKJ904Ik/AAAAAAAAAAI/AAAAAAAAACo/1vvBg3JvE9Y/photo.jpg?sz=128", "display_name": "Kendots", "link": "https://stackoverflow.com/users/8488207/kendots"}, "edited": false, "score": 0, "creation_date": 1512596022, "post_id": 47683760, "comment_id": 82327125, "body": "But I need v as a parameter for fct, how can I access v.t if it is freed?"}, {"owner": {"reputation": 61, "user_id": 8488207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DDMYKJ904Ik/AAAAAAAAAAI/AAAAAAAAACo/1vvBg3JvE9Y/photo.jpg?sz=128", "display_name": "Kendots", "link": "https://stackoverflow.com/users/8488207/kendots"}, "edited": false, "score": 0, "creation_date": 1512596522, "post_id": 47683760, "comment_id": 82327389, "body": "I think that doesn&#39;t solve the leak, It might need to free(v) before using fct."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 61, "user_id": 8488207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DDMYKJ904Ik/AAAAAAAAAAI/AAAAAAAAACo/1vvBg3JvE9Y/photo.jpg?sz=128", "display_name": "Kendots", "link": "https://stackoverflow.com/users/8488207/kendots"}, "edited": false, "score": 1, "creation_date": 1512596631, "post_id": 47683760, "comment_id": 82327449, "body": "@Kendots It does solve the leak.  There are two allocations and two frees."}, {"owner": {"reputation": 61, "user_id": 8488207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DDMYKJ904Ik/AAAAAAAAAAI/AAAAAAAAACo/1vvBg3JvE9Y/photo.jpg?sz=128", "display_name": "Kendots", "link": "https://stackoverflow.com/users/8488207/kendots"}, "edited": false, "score": 0, "creation_date": 1512597164, "post_id": 47683760, "comment_id": 82327702, "body": "What I meant was free(v.t) sorry."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 61, "user_id": 8488207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DDMYKJ904Ik/AAAAAAAAAAI/AAAAAAAAACo/1vvBg3JvE9Y/photo.jpg?sz=128", "display_name": "Kendots", "link": "https://stackoverflow.com/users/8488207/kendots"}, "edited": false, "score": 0, "creation_date": 1512597246, "post_id": 47683760, "comment_id": 82327739, "body": "The value of <code>v.t</code> is saved in <code>vt_sav</code> so it doesn&#39;t get lost.  Then that value is passed to <code>free</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1512595837, "creation_date": 1512595837, "answer_id": 47683760, "question_id": 47683704, "link": "https://stackoverflow.com/questions/47683704/does-this-c-code-leak-memory/47683760#47683760", "title": "Does this C code leak memory?", "body": "<pre><code>v.t=malloc(2*sizeof(int));\n</code></pre>\n\n<p>Here you assign allocated memory to <code>v.t</code>.</p>\n\n<pre><code>v=fct(v);\n</code></pre>\n\n<p>Then here you overwrite all fields of <code>v</code> with what was returned from <code>fct</code>.  This discards the old value of <code>v.t</code>, causing a memory leak.</p>\n\n<p>The call to <code>free</code> at the end of <code>main</code> is freeing the memory that was allocated inside of <code>fct</code>.</p>\n\n<p>You can fix this leak by saving <code>v.t</code> and calling <code>free</code> on the saved pointer:</p>\n\n<pre><code>vector v;\nint *vt_sav;\nv.x=2;\nv.t=malloc(2*sizeof(int));\nvt_sav = v.t;\nv.t[0]=1; v.t[1]=5;\nv=fct(v);\nfree(vt_sav);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1512596930, "last_edit_date": 1512596930, "creation_date": 1512596615, "answer_id": 47683938, "question_id": 47683704, "link": "https://stackoverflow.com/questions/47683704/does-this-c-code-leak-memory/47683938#47683938", "title": "Does this C code leak memory?", "body": "<p>Yes, you are leaking memory. w.t is never released.<br>\nAlso pass the structures via pointers not by value. Returning vector is also expensive.</p>\n\n<p>Your new program can look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\ntypedef struct {\n    int x;\n    int *t;\n}vector;\n\nvoid fct (vector *v, vector * w){\n\n    int i;\n\n    w-&gt;x = v-&gt;x;\n\n    for (i=0; i&lt;w-&gt;x; i++)\n        w-&gt;t[i]=2*v-&gt;t[i];\n}\n\n\nint main (){\n    int i;\n    vector v;\n    vector w;\n\n    v.x=2;\n\n    v.t = malloc(2*sizeof(int));\n    w.t = malloc(2*sizeof(int));\n\n    v.t[0]=1;\n    v.t[1]=5;\n\n    fct(&amp;v,&amp;w);\n\n    for (i=0; i&lt;2; i++)\n        printf(\"%d \\t\",w.t[i]);\n\n\n    puts(\"\");\n\n    free(v.t);\n    free(w.t);\n\n    return 0;\n}\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>2       10\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1512597144, "creation_date": 1512597144, "answer_id": 47684045, "question_id": 47683704, "link": "https://stackoverflow.com/questions/47683704/does-this-c-code-leak-memory/47684045#47684045", "title": "Does this C code leak memory?", "body": "<blockquote>\n  <p>I'm quite worried about whether or not it causes a memory leak, and how I can fix that in case it does.</p>\n</blockquote>\n\n<p>It does.  In <code>main()</code>, you allocate memory and point <code>v.t</code> to it; then you overwrite that pointer with one from the return value of <code>fct()</code>.  The original pointer is lost, and you've no other copy of it, so the pointed-to memory is leaked.</p>\n\n<blockquote>\n  <p>Oh, and I know that if I define another vector let's say w, such that w = fct(v) it would clear the problem, but I need a different method, one that would work even if the function is returned to the original vector.</p>\n</blockquote>\n\n<p>With every dynamic memory allocation comes an obligation to free that memory.  You can consider that obligation to be associated with exactly one copy of the pointer to that memory, as a kind of notional tag.  You can freely (notionally) transfer the tag to a different copy of the pointer.  If the copy then bearing the tag ever goes out of scope or is overwritten with a different value, however, then you leak the pointed-to memory.</p>\n\n<p>Consider how that applies to your case:</p>\n\n<ol>\n<li><p>You allocate memory and assign a pointer to <code>v.t</code>.  This is initially the only copy of the pointer to the allocated memory, so the obligation to free that memory is associated with it.</p></li>\n<li><p>You pass a copy of <code>v</code>, including a copy of <code>v.t</code>, to function <code>fct()</code>.  You have two alternatives: the obligation to free can stay with the original copy of <code>v.t</code>, or it can be transferred to the copy received by the function.  That is an inherent characteristic of the definition of <code>fct()</code>, and should be documented with it -- you cannot choose on a call-by-call basis.  Since <code>fct()</code> does not free the pointer, you have implicitly chosen for the obligation to free to remain with the original copy.</p></li>\n<li><p><code>fct()</code> performs its own allocation and returns a copy of the resulting pointer; that's the only copy that survives the execution of the function, so the obligation to free must go with it.</p></li>\n<li><p>By overwriting the original <code>v.t</code> with a different value while it holds an obligation to free, you leak the original memory.  There is still an obligation to free the (new) value of <code>v.t</code>, but there is no longer any way to access the old dynamically-allocated memory.</p></li>\n</ol>\n\n<p>Now you had one option in there: whether to transfer the obligation to free as part of the function call.  Suppose that you did transfer it; in that case, <code>fct()</code> must not fail to perform that <code>free()</code> before it returns.  In that case, however, <code>main()</code> must not use the original value of <code>v.t</code> after calling <code>fct()</code>, whether it overwrites <code>v</code> with that function's result or not.</p>\n\n<p>So you have a choice: either <code>fct()</code> takes responsibility for freeing <code>v.t</code> (which it could pass on to another function if it wished, or which it could return to the caller via its return value), or <code>fct()</code> does not take that responsibility.  Its callers need to behave accordingly.  You cannot have it both ways.</p>\n"}], "owner": {"reputation": 61, "user_id": 8488207, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DDMYKJ904Ik/AAAAAAAAAAI/AAAAAAAAACo/1vvBg3JvE9Y/photo.jpg?sz=128", "display_name": "Kendots", "link": "https://stackoverflow.com/users/8488207/kendots"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 47683760, "answer_count": 4, "score": 0, "last_activity_date": 1555439106, "creation_date": 1512595542, "last_edit_date": 1555439106, "question_id": 47683704, "link": "https://stackoverflow.com/questions/47683704/does-this-c-code-leak-memory", "title": "Does this C code leak memory?", "body": "<p>So here is my code:</p>\n\n<pre><code>typedef struct {\n    int x;\n    int *t;\n}vector;\n\nvector fct (vector v){\n    vector w;\n    int i;\n    w.x=v.x;\n    w.t=malloc(w.x *sizeof(int));\n    for (i=0; i&lt;w.x; i++)\n        w.t[i]=2*v.t[i];\n    return w;\n}\n\n\nint main (){\n    int i;\n    vector v;\n    v.x=2;\n    v.t=malloc(2*sizeof(int));\n    v.t[0]=1; v.t[1]=5;\n    v=fct(v);\n    for (i=0; i&lt;2; i++)\n        printf(\"%d \\t\",v.t[i]);\n    puts(\"\");\n    free(v.t);\n    return 0;\n}\n</code></pre>\n\n<p>I'm quite worried about whether or not it causes a memory leak, and how I can fix that in case it does. \nOh, and I know that if I define another vector let's say w, such that\n<code>w = fct(v)</code>\nit would clear the problem, but I need a different method, one that would work even if the function is returned to the original vector.</p>\n"}, {"tags": ["c", "windows", "winapi", "handle"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1512595487, "post_id": 47683671, "comment_id": 82326880, "body": "<i>If I try to write it in a local file, it will stop at the first \\0 delimiter,</i> - really ?"}, {"owner": {"reputation": 1042, "user_id": 5874239, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zKBbr.jpg?s=128&g=1", "display_name": "Alexandru Antochi", "link": "https://stackoverflow.com/users/5874239/alexandru-antochi"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1512595562, "post_id": 47683671, "comment_id": 82326911, "body": "If not, the rest of the char up to 65536 will be garbage from memory. Doesn&#39;t it work like that?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1512595614, "post_id": 47683671, "comment_id": 82326941, "body": "if you write garbage to file - will be garbage. all depend from you only"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512595682, "post_id": 47683671, "comment_id": 82326965, "body": "How you define <code>buffer</code>? How you write the file?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1512595778, "post_id": 47683671, "comment_id": 82327005, "body": "and why limit to <code>65536</code> ? how about large files ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512595982, "post_id": 47683671, "comment_id": 82327106, "body": "BTW, what is your <code>rgpszAcceptTypes</code>?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1512596280, "post_id": 47683671, "comment_id": 82327262, "body": "<i>&quot;If I try to write it in a local file, it will stop at the first <code>\\0</code> delimiter&quot;</i> - No, it won&#39;t. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365747.aspx\" rel=\"nofollow noreferrer\">WriteFile</a> takes an explicit length parameter, and doesn&#39;t interpret the data at all."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1512596369, "post_id": 47683671, "comment_id": 82327306, "body": "@IInspectable I wonder how the server will handle this request if the accepted type is text only. Maybe it will stop transmitting on the first zero?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512607622, "post_id": 47683671, "comment_id": 82331471, "body": "@EugeneSh. If the client explicitly states the types it accepts, and the server wants to send a type that is not accepted, it is supposed to send a failure HTTP response, such as <code>406 Not Acceptable</code>, and not try to send the requested resource at all"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 1, "creation_date": 1512612470, "post_id": 47683671, "comment_id": 82332523, "body": "<code>INTERNET_FLAG_NO_COOKIES || INTERNET_FLAG_NO_AUTH</code> Don&#39;t use logic OR <code>||</code> for these flags, it will always result in 1, or sometimes zero. Use bitwise OR <code>|</code> to combine the flags, it&#39;s sort of like adding the flags."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1512637663, "post_id": 47683671, "comment_id": 82341524, "body": "You&#39;ve asked the wrong question. Your question is not about how to execute a process. It is about how to download a file to disk. It looks like you tried to do that, failed, and decided it was impossible! A conclusion that can be immediately rejected by the fact that so many programs do exactly that. You need to keep a clear head, think straight, and don&#39;t just give up when you fail at the first attempt to perform a task you know to be possible."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1512611305, "last_edit_date": 1512611305, "creation_date": 1512610569, "answer_id": 47686232, "question_id": 47683671, "link": "https://stackoverflow.com/questions/47683671/how-to-run-an-exe-file-downloaded-with-internetopenfile-in-winapi/47686232#47686232", "title": "How to run an .exe file downloaded with InternetOpenFile() in Winapi", "body": "<p>You must save the EXE file to a local file before you can execute it.  You can't execute an EXE from memory (without writing your own EXE loader, or using a 3rd party one).</p>\n\n<p><code>InternetReadFile()</code> reads arbitrary amounts of data, so you need to call it in a loop until the end of the response is reached. Write each block of data that is received <em>as-is</em> to your local file.  Your claim that your writing \"will stop at the first\u00a0<code>\\0</code>\u00a0delimiter\" means that you are writing the received data as null-terminated strings instead of as raw binary data.  Binary files, especially executable files, contain plenty of 0x00 bytes in them. So this is a logic bug in your code that you need to fix.</p>\n\n<p>Try something more like this instead:</p>\n\n<pre><code>HINTERNET hInternet = InternetOpen(...);\nif (!hInternet)\n{\n    _error(\"InternetOpen error.\");\n}\n\nHINTERNET hHTTP = InternetConnect(hInternet, \"students.info.uaic.ro\", INTERNET_DEFAULT_HTTP_PORT, NULL, NULL, INTERNET_SERVICE_HTTP, 0, 0);\nif (!hHTTP)\n{\n    InternetCloseHandle(hInternet);\n    _error(\"InternetConnect error.\");\n}\n\nconst char* rgpszAcceptTypes[] = {\"application/vnd.microsoft.portable-executable\", \"application/octet-stream\", \"application/x-msdownload\", NULL};\nHINTERNET hRequest = HttpOpenRequest(hHTTP, \"GET\", \"/~alexandru.antochi/exe_1.exe\", NULL, NULL, rgpszAcceptTypes, NULL, INTERNET_FLAG_NO_COOKIES | INTERNET_FLAG_NO_AUTH);\nif (!hRequest)\n{\n    InternetCloseHandle(hHTTP);\n    InternetCloseHandle(hInternet);\n    _error(\"HttpOpenRequest error.\");\n}\n\nif (!HttpSendRequest(hRequest, NULL, NULL, NULL, NULL))\n{\n    InternetCloseHandle(hRequest);\n    InternetCloseHandle(hHTTP);\n    InternetCloseHandle(hInternet);\n    _error(\"Could not send HTTP request.\");\n}\n\nDWORD statusCode;\nDWORD size = sizeof(statusCode), index = 0;\nif (!HttpQueryInfo(hRequest, HTTP_QUERY_STATUS_CODE | HTTP_QUERY_FLAG_NUMBER, &amp;statusCode, &amp;size, &amp;index))\n{\n    InternetCloseHandle(hRequest);\n    InternetCloseHandle(hHTTP);\n    InternetCloseHandle(hInternet);\n    _error(\"HttpQueryInfo error.\");\n}\n\nif (statusCode != 200)\n{\n    InternetCloseHandle(hRequest);\n    InternetCloseHandle(hHTTP);\n    InternetCloseHandle(hInternet);\n    _error(\"HTTP request failed.\");\n}\n\nHANDLE hFile = CreateFile(\"C:\\\\path to\\\\exe_1.exe\" , GENERIC_WRITE, FILE_SHARE_READ, NULL, CREATE_ALWAYS, 0, NULL); \nif (hFile == INVALID_HANDLE_VALUE)\n{\n    InternetCloseHandle(hRequest);\n    InternetCloseHandle(hHTTP);\n    InternetCloseHandle(hInternet);\n    _error(\"Could not create local file.\");\n}\n\nBYTE buffer[1024];\nDWORD bytesRead, bytesWritten;\n\ndo\n{\n    if (!InternetReadFile(hRequest, buffer, sizeof(buffer), &amp;bytesRead))\n    {\n        CloseHandle(hFile);\n        InternetCloseHandle(hRequest);\n        InternetCloseHandle(hHTTP);\n        InternetCloseHandle(hInternet);\n        _error(\"Could not read HTTP response.\");\n    }\n\n    if (bytesRead == 0)\n        break;\n\n    if (!WriteFile(hFile, buffer, bytesRead, &amp;bytesWritten))\n    {\n        CloseHandle(hFile);\n        InternetCloseHandle(hRequest);\n        InternetCloseHandle(hHTTP);\n        InternetCloseHandle(hInternet);\n        _error(\"Could not write to local file.\");\n    }\n}\nwhile (true);\n\nCloseHandle(hFile);\nInternetCloseHandle(hRequest);\nInternetCloseHandle(hHTTP);\nInternetCloseHandle(hInternet);\n\n// use EXE file as needed...\n</code></pre>\n\n<p>Refer to MSDN documentation for more details:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384322.aspx\" rel=\"nofollow noreferrer\">HTTP Sessions</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384322.aspx#Downloading_resource\" rel=\"nofollow noreferrer\">Downloading Resources from the WWW</a> </p>\n"}], "owner": {"reputation": 1042, "user_id": 5874239, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zKBbr.jpg?s=128&g=1", "display_name": "Alexandru Antochi", "link": "https://stackoverflow.com/users/5874239/alexandru-antochi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 47686232, "answer_count": 1, "score": -2, "last_activity_date": 1512611305, "creation_date": 1512595429, "question_id": 47683671, "link": "https://stackoverflow.com/questions/47683671/how-to-run-an-exe-file-downloaded-with-internetopenfile-in-winapi", "title": "How to run an .exe file downloaded with InternetOpenFile() in Winapi", "body": "<p>I have a C app written using Winapi and an <code>.exe</code> file that I need to download and execute. My code so far is:</p>\n\n<pre><code>if (NULL == (hRequest = HttpOpenRequest(hHTTP, \"GET\", \"/~alexandru.antochi/exe_1.exe\", NULL, NULL, rgpszAcceptTypes, NULL, INTERNET_FLAG_NO_COOKIES || INTERNET_FLAG_NO_AUTH)))\n        {\n            _error(\"HttpOpenRequest error.\");\n        }\n\n        if (HttpSendRequest(hRequest, NULL, NULL, NULL, NULL))\n        {\n\n            if (InternetReadFile(hRequest, &amp;buffer, 65536, &amp;bytesRead))\n            {\n                if (bytesRead == 65536)\n                {\n                    printf(\"Warning: .exe file too big. Ignoring\");\n                    continue;\n                }\n            }\n        }\n        else\n        {\n            _error(\"Could not send HTTP request.\");\n        }\n\n        closeHandles(2, hRequest, hHTTP);\n</code></pre>\n\n<p>I read the file, what now? If I try to write it in a local file, it will stop at the first <code>\\0</code> delimiter, which is after 2 letters in my case. The file can be found at <a href=\"http://students.info.uaic.ro/~alexandru.antochi/exe_1.exe\" rel=\"nofollow noreferrer\">http://students.info.uaic.ro/~alexandru.antochi/exe_1.exe</a></p>\n"}, {"tags": ["java", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 6798, "user_id": 279982, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4c5fbe0017b87b221e035284a173ef87?s=128&d=identicon&r=PG", "display_name": "atoMerz", "link": "https://stackoverflow.com/users/279982/atomerz"}, "edited": false, "score": 0, "creation_date": 1512594937, "post_id": 47683406, "comment_id": 82326615, "body": "The way I understand it, you&#39;re looking for a way to receive GUI events from java world in your c++ code. I think it is best to call the c++ code from java rather than startup java from c++. Since the way you describe it actions are always initiated from the java GUI. I&#39;m not sure I understand what you mean by <code>no connection between such a library file and the actual c program I need the data in</code>."}, {"owner": {"reputation": 2915, "user_id": 5155371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tSOxq.png?s=128&g=1", "display_name": "Michael Troger", "link": "https://stackoverflow.com/users/5155371/michael-troger"}, "reply_to_user": {"reputation": 6798, "user_id": 279982, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4c5fbe0017b87b221e035284a173ef87?s=128&d=identicon&r=PG", "display_name": "atoMerz", "link": "https://stackoverflow.com/users/279982/atomerz"}, "edited": false, "score": 0, "creation_date": 1512596095, "post_id": 47683406, "comment_id": 82327166, "body": "thx for your input! Yes, I need GUI events in C code.  In this case I really need to invoke the Java GUI via C. So doing it the other way around is not an option.  Concerning the library file and actual program connection I hope that the editing of the question clarifies it."}, {"owner": {"reputation": 6798, "user_id": 279982, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4c5fbe0017b87b221e035284a173ef87?s=128&d=identicon&r=PG", "display_name": "atoMerz", "link": "https://stackoverflow.com/users/279982/atomerz"}, "edited": false, "score": 0, "creation_date": 1512652950, "post_id": 47683406, "comment_id": 82351661, "body": "One dirty way that comes to my mind is that you can set a flag when a GUI event happens. Then a thread in c++ could check that flag periodically and see if any events occurred. The way I described it is in its simplest form and has limitations. For example successive events may be lost if you don&#39;t check the flag fast enough. It can be solved by using a queue instead of a single variable. I don&#39;t intend to go into it in detail but you should get the idea."}, {"owner": {"reputation": 6798, "user_id": 279982, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4c5fbe0017b87b221e035284a173ef87?s=128&d=identicon&r=PG", "display_name": "atoMerz", "link": "https://stackoverflow.com/users/279982/atomerz"}, "edited": false, "score": 0, "creation_date": 1512653370, "post_id": 47683406, "comment_id": 82351925, "body": "A better way is to register your c++ methods as GUI listeners using <a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#wp5833\" rel=\"nofollow noreferrer\">RegisterNatives</a> during JVM initialization."}], "answers": [{"tags": [], "owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "is_accepted": false, "score": 0, "last_activity_date": 1512737032, "last_edit_date": 1512737032, "creation_date": 1512647966, "answer_id": 47694652, "question_id": 47683406, "link": "https://stackoverflow.com/questions/47683406/how-to-send-data-back-to-c-app-from-java-app-launched-via-invocation-api-using-j/47694652#47694652", "title": "How to send data back to C app from Java app launched via Invocation API using JNI?", "body": "<p>Actually you do have a connection between your executable and a hypothetical JNI library. They're in the same process so you can always pass some handle from C code to Java code and then from Java code to the C code in your JNI library. And the library can use it to call stuff from you main module. </p>\n\n<p>That said, I would skip the JNI part altogether. You could pass a function address to Java, then use JNA (<a href=\"https://github.com/java-native-access/jna\" rel=\"nofollow noreferrer\">https://github.com/java-native-access/jna</a>) to call that function. It uses libffi internally.</p>\n\n<p>(If you don't want to pass function pointers around, JNA can also help you get the module handle for wherever your function is and then get the function via its name)</p>\n"}], "owner": {"reputation": 2915, "user_id": 5155371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tSOxq.png?s=128&g=1", "display_name": "Michael Troger", "link": "https://stackoverflow.com/users/5155371/michael-troger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512737032, "creation_date": 1512594175, "last_edit_date": 1512597155, "question_id": 47683406, "link": "https://stackoverflow.com/questions/47683406/how-to-send-data-back-to-c-app-from-java-app-launched-via-invocation-api-using-j", "title": "How to send data back to C app from Java app launched via Invocation API using JNI?", "body": "<p>I have a Java app acting as GUI launched via the <a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/invocation.html\" rel=\"nofollow noreferrer\">Invocation API</a> for C</p>\n\n<pre><code>MyApp.c -&gt; Main application - compiled to MyApp\nMyGUI.java -&gt; Java GUI launched programmatically from the C main application - compiled to MyGUI.class\nMyGUI_Print.c -&gt; holds JNI method for testing purpose, called from Java GUI - compiled to libMyGUI_Print.so\n</code></pre>\n\n<p>The main C (MyApp) file looks like.:</p>\n\n<pre><code> #include &lt;jni.h&gt;   \n//...\nJNI_CreateJavaVM(&amp;jvm, (void**)&amp;env, &amp;vm_args);\n//...\n(*env)-&gt;CallStaticVoidMethod(env, cls, mid, args);\n</code></pre>\n\n<p>the last line method call makes me able to send data from C to the programmatically launched Java GUI. But how do I send data (boolean or string) back to the actual C app (MyApp) from Java - let's say on a button click in the Java GUI?</p>\n\n<p>It's clear that I can call C methods from within Java via JNI. The Java GUI app (MyGUI) holds for testing purposes:</p>\n\n<pre><code>private native void print();\nstatic {\n   System.loadLibrary(\"MyGUI_Print\");\n}\n</code></pre>\n\n<p>But the corresponding C file has to be compiled as so/dll file, so I have of course no connection between this library file (MyGUI_Print) and the actual c program (MyApp) I need the data in. From the MyGUI_Print I'm however able to print like this:</p>\n\n<pre><code>#include &lt;jni.h&gt;\n#include &lt;stdio.h&gt;\n#include \"MyGUI.h\"\n\nJNIEXPORT void JNICALL Java_MyGUI_print (JNIEnv *env, jobject obj)\n{\n    printf(\"Hello World!\");\n    fflush(stdout);\n}\n</code></pre>\n\n<p>This output is also reaching the actual C app's console output. But the C app itself has so far no knowledge of the \"incoming\" data. Any way I can programmatically access this string on the other side (C app)? Or is there any better solution?</p>\n\n<p>Theoretically I could of course do polling - i.e. asking from the C app every few seconds the current state of some variable in the Java environment. But I don't think that's a nice way of doing it.</p>\n"}, {"tags": ["c", "function", "pointers", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1512594361, "post_id": 47683396, "comment_id": 82326305, "body": "Don&#39;t include <code>*.c</code> files! Ever. Until you are a pro and know <i>exactly</i> what you are doing."}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512594523, "post_id": 47683396, "comment_id": 82326385, "body": "This is an assignment and they wanted us to include all three files"}, {"owner": {"reputation": 1628, "user_id": 1230621, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a752347505880eb6aca2316744e7f474?s=128&d=identicon&r=PG", "display_name": "StarShine", "link": "https://stackoverflow.com/users/1230621/starshine"}, "edited": false, "score": 0, "creation_date": 1512594541, "post_id": 47683396, "comment_id": 82326397, "body": "The error is clear: You cannot use the type Name if it is incomplete. Since you already fully declared Name in the header contacts.h, you can remove the pre-declaration entirely."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1512594578, "post_id": 47683396, "comment_id": 82326415, "body": "No way they are asking such a thing. If they are - I would reconsider studying C in this place."}, {"owner": {"reputation": 1628, "user_id": 1230621, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a752347505880eb6aca2316744e7f474?s=128&d=identicon&r=PG", "display_name": "StarShine", "link": "https://stackoverflow.com/users/1230621/starshine"}, "edited": false, "score": 3, "creation_date": 1512594650, "post_id": 47683396, "comment_id": 82326460, "body": "@SaM Eugene is right, c files should never be included. c files should be compiled and linked (and in that sense, included into your output executable project)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1512594775, "post_id": 47683396, "comment_id": 82326527, "body": "You should have gotten numerous redefinition errors with this code."}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512595044, "post_id": 47683396, "comment_id": 82326671, "body": "Yes I understand that I should not include the <code>*.c</code> files."}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512595061, "post_id": 47683396, "comment_id": 82326682, "body": "But what changes should I make to fix this error?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512595145, "post_id": 47683396, "comment_id": 82326723, "body": "What errors do you get when you actually remove this include? All of them. BTW, looks like the function call is happening outside of <code>main</code>. Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> after fixed the errors mentioned."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1512595217, "post_id": 47683396, "comment_id": 82326750, "body": "Where is <code>contact</code> in a1ms4.c declared?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 1, "creation_date": 1512595329, "post_id": 47683396, "comment_id": 82326805, "body": "Do you think using <code>scanf(&quot;%s&quot;</code> with a <code>char</code> variable address is a good idea? Read how <code>scanf</code> works carefully..."}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512598697, "post_id": 47683396, "comment_id": 82328357, "body": "@EugeneSh. Yes I minimized the code and posted below if you could please take a look thanks"}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1512598755, "post_id": 47683396, "comment_id": 82328378, "body": "@NetMage Yes I know it should be %c its just there were few error due to that but now i changed it"}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1512598840, "post_id": 47683396, "comment_id": 82328420, "body": "@NetMage I just reposted the program below and put it into one main file if you could take a look thanks"}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "reply_to_user": {"reputation": 1628, "user_id": 1230621, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a752347505880eb6aca2316744e7f474?s=128&d=identicon&r=PG", "display_name": "StarShine", "link": "https://stackoverflow.com/users/1230621/starshine"}, "edited": false, "score": 0, "creation_date": 1512598875, "post_id": 47683396, "comment_id": 82328442, "body": "@StarShine I just reposted the program below and put it into one main file if you could take a look thanks"}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512599444, "post_id": 47683396, "comment_id": 82328713, "body": "@EugeneSh. Okay I posted it in the question section now. and typed <code>typedef</code> with the function but still no luck"}, {"owner": {"reputation": 1362, "user_id": 7131301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95feecfe61cbcdf86514a34cdc248623?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas By", "link": "https://stackoverflow.com/users/7131301/tomas-by"}, "edited": false, "score": 0, "creation_date": 1512599685, "post_id": 47683396, "comment_id": 82328813, "body": "It&#39;s difficult to understand what the question is at this point. I assume the errors at the end of the post is what you are asking about. I see two problems: C reads the file from the top, so anything you define and then use has to be defined before it is used, in the file, and when you define a struct you get a struct, not a new type."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512601669, "post_id": 47684791, "comment_id": 82329584, "body": "Yes I put that <code>Struct</code> before the Name and its working now. Thank you for help. There is this new error: request for member <code>firstName</code> in something not a structure or union"}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512611502, "post_id": 47684791, "comment_id": 82332279, "body": "I put every code in place (<code>*.h</code> <code>*.c</code> <code>main</code>) and now I am getting two kinds of errors in the header file one is Conflicting type with the get* second is redefination of struct *"}], "tags": [], "owner": {"reputation": 81, "user_id": 8879320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CBgrrXDuNsU/AAAAAAAAAAI/AAAAAAAAEQE/aZ6Mj7sr5pw/photo.jpg?sz=128", "display_name": "NeRa", "link": "https://stackoverflow.com/users/8879320/nera"}, "is_accepted": false, "score": 0, "last_activity_date": 1512600452, "creation_date": 1512600452, "answer_id": 47684791, "question_id": 47683396, "link": "https://stackoverflow.com/questions/47683396/c-programming-dereferencing-pointers/47684791#47684791", "title": "C programming : dereferencing pointers", "body": "<p>There are quite a few things wrong but I think your main error is that you have declared <code>Name</code> as <code>struct Name</code> so you need to use <code>struct Name</code> instead of just <code>Name</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512601447, "post_id": 47684792, "comment_id": 82329484, "body": "Yes I got it Thank You it fixed the error of unknown type. I put <code>struct</code> before the Name in the function. really appreciate the help"}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512601496, "post_id": 47684792, "comment_id": 82329508, "body": "It is giving the error: request for member <code>firstName</code> in something not a structure or union"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512601715, "post_id": 47684792, "comment_id": 82329598, "body": "@SaM Ah, overlooked that mistake: When <code>firstName</code> is a pointer (declared with <code>struct Name* firsName</code>), you cannot use the <code>.</code> operator to access its members. You must use the dereferencing <code>-&gt;</code> operator instead."}, {"owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "edited": false, "score": 0, "creation_date": 1512604051, "post_id": 47684792, "comment_id": 82330481, "body": "Now I am gonna try and put it separately in <code>*.h</code> <code>*.c</code> and <code>main</code>"}], "tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1512601395, "last_edit_date": 1512601395, "creation_date": 1512600454, "answer_id": 47684792, "question_id": 47683396, "link": "https://stackoverflow.com/questions/47683396/c-programming-dereferencing-pointers/47684792#47684792", "title": "C programming : dereferencing pointers", "body": "<p>When you say <code>struct Foo {...};</code> in C, you are not defining a type with the name <code>Foo</code>. Instead, you are defining a <code>struct</code> by the name <code>Foo</code> **which is referenced as <code>struct Foo</code>.</p>\n\n<p>Thus, when you say <code>void getName(Name*name);</code>, your compiler rightly complains that there is no type called <code>Name</code>. Since it could not parse this function declaration, it subsequently complains about not knowing about that function when you call it. Ignore that second error, it's not your problem. Fix the prototype.</p>\n\n<hr>\n\n<p>There are two methods of fixing your program:</p>\n\n<ol>\n<li><p>Call your structs <code>struct</code>. At each and every instance where you have <code>Name</code> in your code, ensure that you are actually saying <code>struct Name</code> instead.</p></li>\n<li><p>Write a <code>typedef</code> that defines the type <code>Name</code>. Declare your struct like this:</p>\n\n<pre><code>struct Foo { ... };\ntypedef struct Foo Foo;\n</code></pre>\n\n<p>Since C programmers are lazy gits, they will usually merge these two statements into the following declaration:</p>\n\n<pre><code>typedef struct Foo { ... } Foo;\n</code></pre>\n\n<p>This declares both the <code>struct Foo</code> and its alias <code>Foo</code> in a single statement. You'll see this a lot in real code.</p></li>\n</ol>\n\n<hr>\n\n<p>The form of the typedef deserves some explanation. I find it easiest to think of it as a variable declaration with <code>typedef</code> prepended to turn the variable name into a type name. I.e. if you can declare an array of strings with</p>\n\n<pre><code>char* array[10];\n</code></pre>\n\n<p>then you can give a name to its type with</p>\n\n<pre><code>typedef char* ArrayType[10];\n</code></pre>\n\n<p>After that, you can declare the above array with a simple</p>\n\n<pre><code>ArrayType array;\n</code></pre>\n\n<p>So, when you say</p>\n\n<pre><code>typedef struct Foo Foo;\n</code></pre>\n\n<p>the second <code>Foo</code> is the name that is being declared, and the type it aliases is the rest of the declaration without the <code>typedef</code>: <code>struct Foo</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10596476, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AeVHJ3gE3Es/AAAAAAAAAAI/AAAAAAAAABE/_EI8jn6Z1P0/photo.jpg?sz=128", "display_name": "Richard Shaffer", "link": "https://stackoverflow.com/users/10596476/richard-shaffer"}, "is_accepted": false, "score": 0, "last_activity_date": 1541169206, "creation_date": 1541169206, "answer_id": 53120518, "question_id": 47683396, "link": "https://stackoverflow.com/questions/47683396/c-programming-dereferencing-pointers/53120518#53120518", "title": "C programming : dereferencing pointers", "body": "<p>Dereferencing a pointer means using the * operator to access the value stored at a pointer. But keep it in mind that the value stored at the address of the pointer must be a value of the same type as the type of variable the pointer \"points\" to, but there is no guarantee this is the case unless the pointer was set correctly. </p>\n"}], "owner": {"reputation": 57, "user_id": 7566146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mfkXpu0R42w/AAAAAAAAAAI/AAAAAAAAB5c/lgL_yHJ6zfQ/photo.jpg?sz=128", "display_name": "Abby", "link": "https://stackoverflow.com/users/7566146/abby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1541169206, "creation_date": 1512594140, "last_edit_date": 1512599346, "question_id": 47683396, "link": "https://stackoverflow.com/questions/47683396/c-programming-dereferencing-pointers", "title": "C programming : dereferencing pointers", "body": "<p>I have these three files. using structures, functions and pointers.</p>\n\n<p>Trying to do this:</p>\n\n<p><strong><code>void getName(Name *)</code> - Receives a pointer to a Name and performs the actions</strong></p>\n\n<p>contacts.h</p>\n\n<pre><code>struct Name {\nchar firstName[31];\nchar middleInitial[7];\nchar lastName[36];\n};\nstruct Contacts {\nstruct Name name;\nstruct Address address;\nstruct Numbers numbers;\n};\nvoid getName(struct Name*name);\n</code></pre>\n\n<p>contacts.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"contacts.h\"\n\nvoid getName(struct Name*name)\n{\n    char yorn;\n        printf(\"Please enter the contact's first name: \");\nscanf(\"%s\", name-&gt;firstName);\n\nprintf(\"Do you want to enter a middle initial(s)? (y or n): \");\nscanf(\"%s\", &amp;yorn);\n\nif (yorn == 'y'){\n    printf(\"Please enter the contact's middle initial(s): \");\n    scanf(\"%s\", name-&gt;middleInitial);\n}\n\nprintf(\"Please enter the contact's last name: \");\nscanf(\"%s\", name-&gt;lastName);\n}\n</code></pre>\n\n<p>a1ms4.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"contacts.h\"\n#include \"contacts.c\"\n\nstruct Name name;\ngetName(&amp;contact.name);\n</code></pre>\n\n<p>I'm getting the following error in contacts.c:</p>\n\n<p>error: dereferencing pointer to incomplete type struct Name</p>\n\n<p><code>scanf(\"%s\", name-&gt;firstName);</code></p>\n\n<pre><code>                 ^~\n</code></pre>\n\n<p>[EDIT:\nI minimized the code to this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct Name {\nchar firstName[31];\n};\n\nstruct Contacts {\n\nstruct Name name;\n};\n\nvoid getName(Name*name);\n\nint main(void)\n{\n\nstruct Contacts contact;\ngetName(&amp;contact.name);\nreturn 0;\n}\n\nvoid getName(Name*name)\n{\nchar yorn;\nprintf(\"Please enter the contact's first name: \");\nscanf(\"%c\", name-&gt;firstName);\n\nprintf(\"First name: %c\\n\", name.firstName);\n\nreturn;\n}\n</code></pre>\n\n<p>and getting these error:</p>\n\n<p>1). error: unknown type name \u00e2<code>Name</code>\u00e2</p>\n\n<p><code>void getName(Name*name);</code></p>\n\n<p>2). In function \u00e2<code>main</code>\u00e2:</p>\n\n<p>warning: implicit declaration of function \u00e2<code>getName</code>\u00e2; did you mean \u00e2<code>getline</code>\u00e2? [-Wimplicit-function-declaration]</p>\n\n<p><code>getName(&amp;contact.name);</code></p>\n\n<p>3). At top level:</p>\n\n<p>error: unknown type name \u00e2<code>Name</code>\u00e2</p>\n\n<p><code>void getName(Name*name)</code></p>\n"}, {"tags": ["c", "loops", "fgets"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512592896, "post_id": 47683070, "comment_id": 82325546, "body": "Side issue: <code>for(i=0,j=0; i&lt;strlen(inputString); i++,j++)     {         if (isalpha(inputString[i]))             inputString[j] = ...</code> is inefficient code with its many calls to <code>strlen(inputString)</code>.  Simple use <code>i&lt;strlen(inputString)</code> --&gt; <code>inputString[i]</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1512592970, "post_id": 47683070, "comment_id": 82325576, "body": "Start by checking that <code>fgets</code> even <i>suceeded</i>. The return value of that function is there for a reason. Also, <code>fgets</code> consumes the newline, adding it to the end of the string-read, when it succeeds, so a followup <code>getchar</code> is unwarranted if all input is through <code>fgets</code>."}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512593931, "post_id": 47683070, "comment_id": 82326101, "body": "@chux Thank you for the feedback! I am not super familiar with for-loops, what does this do exactly? Because I thought for-loops needed some form of condition, for example while i is less than the length of inputString."}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1512594017, "post_id": 47683070, "comment_id": 82326134, "body": "@WhozCraig Sorry if I sound nooby but how would I check that fgets suceeded and what would it mean it if has not suceeded?"}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1512594183, "post_id": 47683070, "comment_id": 82326219, "body": "@user3121023 What would that change essentially? Because I used the <code>cont = getchar();</code> so the code would loop if the user input &#39;y&#39;. Sorry if my question seems dumb I just really wanna understand what I am doing."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1512594441, "post_id": 47683070, "comment_id": 82326345, "body": "You check by validating the result of the function indicates it succeeded (or not). What it ultimately <i>means</i>, if that result indicates failure, is that the content of <code>inputString</code> is not valid, and you should likely exit your loop, rather than marching on and assuming content in <code>inputString</code> is valid. It is a common mistake, sadly not just by beginners, and I often cite <a href=\"https://www.seebs.net/c/10com.html\" rel=\"nofollow noreferrer\">Henry Spencer&#39;s Sixth Commandment</a> among the reasons to be diligent about error states, and more specifically, checking for them judiciously."}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1512594653, "post_id": 47683070, "comment_id": 82326463, "body": "@WhozCraig Thank you for taking your time to explain that a little further to me!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512594900, "post_id": 47683070, "comment_id": 82326591, "body": "@MemErkanEktiren <code>inputString[i]</code> is the <a href=\"https://stackoverflow.com/questions/47683070/issue-with-fgets-inside-of-a-do-while-loop-in-c?noredirect=1#comment82326101_47683070\">condition</a>.  If the value is non-zero, continue the loop.  Code could use the  <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself#DRY_vs_WET_solutions\" rel=\"nofollow noreferrer\">WET</a> <code>inputString[i] != &#39;\\0&#39;;</code>.  <code>for(i=0; inputString[i]; i++)</code> is nice and clean."}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512595104, "post_id": 47683070, "comment_id": 82326700, "body": "@chux Yeah but what does it really mean that inputString[i] is the condition? Does it run through the whole string until it encounters the &#39;\\0&#39;? In that case, wow. I never even thought of that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512595374, "post_id": 47683070, "comment_id": 82326825, "body": "@MemErkanEktiren Another side tip: Do not use <code>inputString[strlen(inputString)-1] = &#39;\\0&#39;;</code>  it is a hacker exploit (hacker enters the null character as the first character to be read).  A classic one-liner alternative is <code>inputString[strcspn(inputString, &quot;\\n&quot;)] = &#39;\\0&#39;;</code>.  See <a href=\"https://stackoverflow.com/a/28462221/2410359\">ref</a> and others."}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512595576, "post_id": 47683070, "comment_id": 82326920, "body": "@chux I forgot to mention, so it&#39;s my bad. However our teacher only allowed us to use the strlen function, no other string functions such as strcpy etc. Is there another way to do what I did without using any string functions from &lt;string.h&gt;?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512595739, "post_id": 47683070, "comment_id": 82326991, "body": "@MemErkanEktiren Yes, see others such as <a href=\"https://stackoverflow.com/a/27729970/2410359\">this</a> which uses <code>strlen()</code>"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1512595841, "post_id": 47683070, "comment_id": 82327045, "body": "Press &#39;y&#39;, and then press enter. Problem solved."}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512595958, "post_id": 47683070, "comment_id": 82327094, "body": "@chux Thank you for your help, really appriciate it!"}, {"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1512595982, "post_id": 47683070, "comment_id": 82327107, "body": "@Sebivor That was the whole point, it did not work as intended. However it has been solved now, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "edited": false, "score": 0, "creation_date": 1512593548, "post_id": 47683140, "comment_id": 82325903, "body": "Thank you so much! This worked. I was just wondering, does the getchar() in the dowhile loop actually consume the newline automatically and how does this work? Also what does the EOF stand for?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "edited": false, "score": 1, "creation_date": 1512593710, "post_id": 47683140, "comment_id": 82325982, "body": "@MemErkanEktiren It does not consume newlines automatically, it only reads one character at a time.  So if you pressed &quot;ABC[ENTER]&quot;.  The first call to <code>getchar</code> returns <code>&#39;A&#39;</code>, the next call <code>&#39;B&#39;</code>, the next <code>&#39;C&#39;</code>, and the next <code>&#39;\\n&#39;</code>.  <code>EOF</code> is a constant that indicates the end of the stream was reached, and the reason <code>getchar</code> returns an <code>int</code>."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1512596252, "post_id": 47683140, "comment_id": 82327247, "body": "You might find <code>fread</code> to be more expressive for this &quot;read and test a character&quot; kind of scenario. <code>char c; while (fread(&amp;c, 1, 1, file) &amp;&amp; c != &#39;\\n&#39;);</code>; it also seems much more difficult for beginners to get wrong. or you could use <code>scanf</code> as your loop: <code>scanf(&quot;%*[^\\n]&quot;); getchar();</code> ... in fact, the whole line can be <i>scanned</i>, user input obtained in the same call: <code>int answer = 0; fscanf(&quot;%*[Yy]%n%*[^\\n]&quot;, &amp;answer); getchar();</code>..."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1512596435, "post_id": 47683140, "comment_id": 82327335, "body": "Don&#39;t mind me... I&#39;m just offering more expressive alternatives. I don&#39;t disagree with the solution; providing <code>cont</code> is declared as<code>int</code> (i.e. like <code>nextchar</code>), this is a good answer. I just figured it&#39;d be best to have the other alternatives in the same place."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1512593008, "creation_date": 1512593008, "answer_id": 47683140, "question_id": 47683070, "link": "https://stackoverflow.com/questions/47683070/issue-with-fgets-inside-of-a-do-while-loop-in-c/47683140#47683140", "title": "Issue with fgets() inside of a do-while loop in C", "body": "<p>Where the newline is getting left in the buffer is after the <code>getchar</code> call at the bottom of the loop.  It only reads one character, so the newline (and any extra characters you may have entered) are still left.  So when <code>fgets</code> is called on the next iteration, it reads just the newline.</p>\n\n<p>You need to flush out the input buffer at the bottom of the loop by repeatedly calling <code>getchar</code> until you see a newline:</p>\n\n<pre><code>cont = getchar();\n\nint nextchar;\ndo {\n    nextchar = getchar();\n} while (nextchar != '\\n' &amp;&amp; nextchar != EOF);\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 9063947, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46705d505ef6e9abe8cea2e0365666ba?s=128&d=identicon&r=PG&f=1", "display_name": "lemonslayer", "link": "https://stackoverflow.com/users/9063947/lemonslayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 47683140, "answer_count": 1, "score": 2, "last_activity_date": 1528988667, "creation_date": 1512592697, "last_edit_date": 1528988667, "question_id": 47683070, "link": "https://stackoverflow.com/questions/47683070/issue-with-fgets-inside-of-a-do-while-loop-in-c", "title": "Issue with fgets() inside of a do-while loop in C", "body": "<p>\nHello. I have a problem with a code I have created to decide if an input string is a palindrome or not (word is the same if read in wrong direction). The actual code in itself works as intended, however when I tried to put a loop on the whole code it started acting weird.</p>\n\n\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define STRING_MAX 100\n\nint isPalindrome();\nchar* removeNonAlpha();\nchar* strLowerCase();\n\nint main()\n{\n    int x = 0;\n    char inputString[STRING_MAX];\n    char cont='y';\n\n    do\n    {\n        printf(\"Hello. Please enter a word or sentence: \");\n        fgets(inputString, STRING_MAX, stdin);\n\n        printf(\"You entered: %s\\n\", inputString);\n\n        //Remove all non alphabetical symbols from the string\n        removeNonAlpha(inputString);\n        printf(\"First we have to remove everything non-alphabetical: %s\\n\", inputString);\n\n        //Make sure all the alphabetical symbols are lower case\n        strLowerCase(inputString);\n        printf(\"Then we have to make everything lower-case: %s\\n\", inputString);\n\n        //After that, check if the string is a palindrome\n        x = isPalindrome(inputString);\n\n        if(x)\n        {\n            printf(\"The string you entered is a palindrome! :D\\n\");\n        }\n        else\n        {\n            printf(\"The string you entered is not a palindrome... :|\\n\");\n        }\n        printf(\"Would you like to enter another word or sentence? (y/n): \");\n        cont = getchar();\n\n        inputString[strlen(inputString)-1] = '\\0';\n\n    } while (cont == 'y');\n\n    return 0;\n}\n\nint isPalindrome(char inputString[])\n{\n    int l = 0, r = strlen(inputString) - 1;\n\n    if (l == r)\n        return 1;\n\n    while (r &gt; l)\n    {\n        if (inputString[l++] != inputString[r--])\n            return 0;\n    }\n    return 1;\n}\n\nchar* removeNonAlpha(char inputString[])\n{\n    int i, j;\n\n    for(i=0,j=0; i&lt;strlen(inputString); i++,j++)\n    {\n        if (isalpha(inputString[i]))\n            inputString[j] = inputString[i];\n        else\n            j--;\n    }\n    inputString[j] = '\\0';\n\n    return inputString;\n\n}\n\nchar* strLowerCase(char inputString[])\n{\n    int i;\n\n    for(i=0; i&lt;strlen(inputString); i++)\n        inputString[i] = tolower(inputString[i]);\n\n\n    return inputString;\n}\n</code></pre>\n\n<p>\nSo what I expected was the code to run again and ask for another string to be entered, however it doesn't. I read around a bit about this and it looks like what is happening is what a newline (\\n) is still in the input buffer and the fgets is skipped. I tried using a getchar() after the fgets to consume eventual newlines but it did not solve my problem. This is the output I am getting:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TwzaA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TwzaA.png\" alt=\"The output\"></a></p>\n\n\n\n<p>Any ideas on how to solve this? I am new to programming and I would love to hear on how I could improve my code generally, although my main concern right now is fixing this loop issue.</p>\n\n<p><strong>EDIT:</strong> The only function from string.h that I am allowed to use is strlen().</p>\n"}, {"tags": ["c", "unit-testing", "arm", "embedded", "isr"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512592834, "post_id": 47683031, "comment_id": 82325520, "body": "Just wire some output to an input and trigger the interrupt by that input... But surely you have an <code>svc</code> instruction triggering an exception."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 2, "creation_date": 1512594159, "post_id": 47683031, "comment_id": 82326208, "body": "ISPR is writable. Just set the interrupt pending."}, {"owner": {"reputation": 18850, "user_id": 999530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YGip7.png?s=128&g=1", "display_name": "Travis Griggs", "link": "https://stackoverflow.com/users/999530/travis-griggs"}, "edited": false, "score": 0, "creation_date": 1512600287, "post_id": 47683031, "comment_id": 82329044, "body": "What interrupt would I use then? I&#39;m using a small embedded OS, which seems to be doing stuff with SVC and PendSV. Is it legal to use one of the &quot;reserved&quot; slots in the vector table? They&#39;re mapped to DummyHandler at the moment, can I just map one of those to function, and then write the associated IRQn to ISPR?"}, {"owner": {"reputation": 1487, "user_id": 607434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0b458e94231d885c11b9d87773264bd?s=128&d=identicon&r=PG", "display_name": "andy mango", "link": "https://stackoverflow.com/users/607434/andy-mango"}, "edited": false, "score": 1, "creation_date": 1512609244, "post_id": 47683031, "comment_id": 82331796, "body": "You might try to use the interrupt for an unused peripheral. Define your own handler and set the interrupt to pending. Nature should then take its course."}, {"owner": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "edited": false, "score": 0, "creation_date": 1512756327, "post_id": 47683031, "comment_id": 82400190, "body": "You should probably open a new question rather than appending your query about the vector table onto this one."}, {"owner": {"reputation": 18850, "user_id": 999530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YGip7.png?s=128&g=1", "display_name": "Travis Griggs", "link": "https://stackoverflow.com/users/999530/travis-griggs"}, "edited": false, "score": 0, "creation_date": 1512757776, "post_id": 47683031, "comment_id": 82400886, "body": "I was hoping someone would actually put up a legit answer to either the original or derived question. Seems more and more people just answer in comment, but then you can&#39;t approve an answer :("}, {"owner": {"reputation": 18850, "user_id": 999530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YGip7.png?s=128&g=1", "display_name": "Travis Griggs", "link": "https://stackoverflow.com/users/999530/travis-griggs"}, "reply_to_user": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "edited": false, "score": 0, "creation_date": 1512765360, "post_id": 47683031, "comment_id": 82404105, "body": "@DKrueger : <a href=\"https://stackoverflow.com/questions/47721785/is-it-possible-to-set-isr-handler-at-runtime-on-m0\" title=\"is it possible to set isr handler at runtime on m0\">stackoverflow.com/questions/47721785/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18850, "user_id": 999530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YGip7.png?s=128&g=1", "display_name": "Travis Griggs", "link": "https://stackoverflow.com/users/999530/travis-griggs"}, "edited": false, "score": 0, "creation_date": 1513009124, "post_id": 47721810, "comment_id": 82475125, "body": "I love it when there&#39;s a downvote with no clear reason as to why"}], "tags": [], "owner": {"reputation": 18850, "user_id": 999530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YGip7.png?s=128&g=1", "display_name": "Travis Griggs", "link": "https://stackoverflow.com/users/999530/travis-griggs"}, "is_accepted": false, "score": 1, "last_activity_date": 1512765469, "creation_date": 1512765469, "answer_id": 47721810, "question_id": 47683031, "link": "https://stackoverflow.com/questions/47683031/how-to-programmatically-drive-isr-on-m0/47721810#47721810", "title": "How to programmatically drive ISR on M0+", "body": "<p>Based on the hints from @user58697 and @andymango, I came up with the following scheme.</p>\n\n<p>-1 Determined that for my board (SAMD21), there was no peripheral at IRQ 21.</p>\n\n<p>-2 Copying the other alias dummy handlers in my resetVectors.c file, I added:</p>\n\n<pre><code>void PV21Handler             ( void ) __attribute__ ((weak, alias(\"Dummy_Handler\")));\n</code></pre>\n\n<p>-3 Modified the DeviceVectors structure to set .pvReserved21 to that:</p>\n\n<pre><code>__attribute__ ((section(\".vectors\")))\nconst DeviceVectors exception_table = {\n    ...\n    ...\n    .pvReserved21           = (void*) PV21Handler,\n    ...\n    ...\n};\n</code></pre>\n\n<p>-4 Implemented a void PV21Handler(void) { } function that actually does something</p>\n\n<p>-5 Used the following to enable the interrupt:</p>\n\n<pre><code>NVIC_EnableIRQ(21);\n// this comes from the core_cm0plus.h file\n</code></pre>\n\n<p>-6 Finally trigger the interrupt with:</p>\n\n<pre><code>while (NVIC_GetPendingIRQ(21)) {  }\nNVIC_SetPendingIRQ(21);\nwhile (NVIC_GetPendingIRQ(21)) {  }\n</code></pre>\n\n<p>The poll for clear status was necessary since there seems to be a slight delay between setting the interrupt and it actually happening, so to get a true edge, I had to assert it low first.</p>\n"}], "owner": {"reputation": 18850, "user_id": 999530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YGip7.png?s=128&g=1", "display_name": "Travis Griggs", "link": "https://stackoverflow.com/users/999530/travis-griggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512765583, "creation_date": 1512592542, "last_edit_date": 1512765583, "question_id": 47683031, "link": "https://stackoverflow.com/questions/47683031/how-to-programmatically-drive-isr-on-m0", "title": "How to programmatically drive ISR on M0+", "body": "<p>I'm writing some <code>Unity</code> unit tests for an embedded project running on an Arm M0+. Some of my APIs depend on wether they're called from the ISR context or not. So I want to programmatically drive an interrupt. In pseudo code, I want my test to look something like:</p>\n\n<pre><code>// set (global) flag indicating what ISR should do\n// trigger the ISR\n// control transfers to ISR which branches off of (global) flag and computes result, store in some global\n// control now returns to here, where I can assert the nature of the global result\n</code></pre>\n\n<p>The part that I need some direction in is how to trigger the ISR. I saw some references in the M3 docs about a Software Interrupt Trigger, but I'm not finding anything like that for M0+.</p>\n\n<p>A \"workaround\" solution might be to grab an unused timer, use it's ISR, then set it's compare to 0, and start it so it drives the interrupt. Or maybe a similar scheme with an unused pin which I configure? Is there a more direct way to accomplish this?</p>\n"}, {"tags": ["c", "arrays", "string", "mpi", "openmpi"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1512594775, "post_id": 47682939, "comment_id": 82326528, "body": "Strings may be a bit special, but they are just a array of pointers. Check out <a href=\"https://stackoverflow.com/questions/9507987/mpi-sending-array-of-array\">this question</a>. There&#39;s also this <a href=\"https://stackoverflow.com/questions/19744458/sending-string-array-mpi-c\">(not properly answered) duplicate</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "is_accepted": false, "score": 2, "last_activity_date": 1512610635, "creation_date": 1512610635, "answer_id": 47686241, "question_id": 47682939, "link": "https://stackoverflow.com/questions/47682939/mpi-broadcast-array-of-strings/47686241#47686241", "title": "MPI broadcast array of strings", "body": "<p>Assuming the strings that you store in the <code>lines</code> array may have a varying size, you can first broadcast an int array of sizes of each string and then broadcast each string separately,</p>\n\n<pre><code>/* Create an Array with length of each line \n   Broadcast it from process 0 */ \nint lin_siz[linesCount];\nif (p_rank == 0)\n    for (i=0; i &lt; linesCount; i++)\n        lin_siz[i] = strlen(lines[i])+1;\nMPI_Bcast(&amp;lin_siz, linesCount, MPI_INT, 0, MPI_COMM_WORLD);\n\n/* Broadcast each line */\nfor (i=0; i &lt; linesCount; i++)\n    MPI_Bcast(&amp;lines[i], lin_siz[i], MPI_CHAR, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p><code>MPI_Bcast</code> can broadcast only elements that are contiguous in memory - in this case the int array with sizes, <code>lin_siz</code> and each line stored in <code>lines</code>. This may not be a very elegant solution and better is surely possible but it works. </p>\n\n<p>It was tested with the following array</p>\n\n<pre><code>char **lines;\nlines = malloc(linesCount * sizeof(char*));\n\nif (p_rank == 0){\n    for (i=0; i&lt;linesCount-2; i++)\n        lines[i] = \"This is a test.\";\n    lines[i++] = \"More testing.\";\n    lines[i++] = \"Even more..\";\n}\n</code></pre>\n\n<p>with <code>p_rank</code> being a standard processor rank obtained with     <code>MPI_Comm_rank(MPI_COMM_WORLD, &amp;p_rank)</code>. And successfully printed at the end as</p>\n\n<pre><code>/* Print */\nprintf(\"Process rank %d:\\n\", p_rank);\nfor (i=0; i &lt; linesCount; i++)\n     printf(\"%s\\n\", lines[i]);\n</code></pre>\n\n<p>I can post the entire test case if you have issues implementing my answer.</p>\n"}], "owner": {"reputation": 39, "user_id": 8682997, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4c9f8063edbdd74edfe7d3113611d18b?s=128&d=identicon&r=PG&f=1", "display_name": "somik07", "link": "https://stackoverflow.com/users/8682997/somik07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1512610635, "creation_date": 1512592112, "question_id": 47682939, "link": "https://stackoverflow.com/questions/47682939/mpi-broadcast-array-of-strings", "title": "MPI broadcast array of strings", "body": "<p>is it possible to broadcast array of strings defined as </p>\n\n<pre><code>char **lines;\nlines = malloc(512 * sizeof(char*));\n</code></pre>\n\n<p>I have tried </p>\n\n<pre><code>MPI_Bcast(lines, linesCount, MPI_BYTE, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p>and </p>\n\n<pre><code>MPI_Bcast(lines, linesCount, MPI_CHAR, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p>where linesCount is number of strings in array.</p>\n\n<p>How can it be achieved?</p>\n"}, {"tags": ["c", "arrays", "pointers", "opcode"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512592170, "post_id": 47682930, "comment_id": 82325142, "body": "What&#39;s wrong with <code>switch&#47;case</code>? Alternatively you can let the opcode to index the array, but it might result in an oversized array."}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1512592220, "post_id": 47682930, "comment_id": 82325166, "body": "Map the opcodes [0x1A, 0x1D, ...] into array indices [0, 1, ...] in a function. Store pointers to the functions in a corresponding array, and invoke the function pointer using something like (*funcptr[index])()."}, {"owner": {"reputation": 1, "user_id": 9063904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxBbo.png?s=128&g=1", "display_name": "M.Hisoka", "link": "https://stackoverflow.com/users/9063904/m-hisoka"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512592240, "post_id": 47682930, "comment_id": 82325184, "body": "@EugeneSh. As far as I know switch/case evaluation is slower than using a function pointer array. Also another problem is to index the array because then I would have an oversized array as you have mentioned."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1512592350, "post_id": 47682930, "comment_id": 82325249, "body": "If you can&#39;t come up with some straight-forward mapping opcode-&gt;index, then you will have to face the trade-off."}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1512592484, "post_id": 47682930, "comment_id": 82325319, "body": "See <a href=\"https://stackoverflow.com/questions/252748/how-can-i-use-an-array-of-function-pointers\" title=\"how can i use an array of function pointers\">stackoverflow.com/questions/252748/&hellip;</a>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1512592610, "post_id": 47682930, "comment_id": 82325395, "body": "Do all relevant functions have the same signature (i.e. same number/type of parameters and return type)?  If so, you can use a function pointer array.  If not, you&#39;ll have to use a <code>switch</code> statement."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1512592687, "post_id": 47682930, "comment_id": 82325440, "body": "Where is your function pointer array?  The notation I&#39;d use is <code>(*array[index])(arg1, ...);</code> but you could probably get away with <code>array[index](arg1, ...);</code> (where the three dots represent sundry extra arguments, not an actual ellipsis in the code)."}, {"owner": {"reputation": 1, "user_id": 9063904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxBbo.png?s=128&g=1", "display_name": "M.Hisoka", "link": "https://stackoverflow.com/users/9063904/m-hisoka"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1512592710, "post_id": 47682930, "comment_id": 82325454, "body": "@dbush Yes all relevant functions have the same signature."}, {"owner": {"reputation": 1, "user_id": 9063904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxBbo.png?s=128&g=1", "display_name": "M.Hisoka", "link": "https://stackoverflow.com/users/9063904/m-hisoka"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512592895, "post_id": 47682930, "comment_id": 82325545, "body": "@JonathanLeffler my function pointer array: <code>void (*execOp[4])(int opcode) { add, sub, div, mul };</code> the problem is how to filter which function to call for example by passing &#39;0x1A&#39; to call &#39;add()&#39;."}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1512593040, "post_id": 47682930, "comment_id": 82325620, "body": "Unbalanced braces in <code>main()</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1512593329, "post_id": 47682930, "comment_id": 82325782, "body": "What are your possible opcodes?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512593351, "post_id": 47682930, "comment_id": 82325800, "body": "@M.Hisoka, it would be appropriate to add that array definition to your question, but note that it is not consistent with the <code>add()</code> function you actually present.  It would be much more helpful to present a bona fide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1512593361, "post_id": 47682930, "comment_id": 82325807, "body": "What&#39;s the possible range of opcodes?  If it&#39;s not too big, create an array whose size is the largest opcode, put the relevant functions in the correct places, and set the rest to <code>NULL</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1512593572, "post_id": 47682930, "comment_id": 82325914, "body": "Are you using C99?  If so, you can use designated initializers to place the opcodes correctly in the array: <code>void (*execOp[])(int opcode)) = { [OP_ADD] = add, [OP_SUB] = sub, [OP_MUL] = mul, [OP_DIV] = div, ... };</code> which automatically places things in the right place.  You can then use <code>if (execOp[opcode] != 0) (*execOp[opCode])(arg);</code> to call it.  You decide what to do if the pointer is null.  Error?  Terminate?"}, {"owner": {"reputation": 1, "user_id": 9063904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxBbo.png?s=128&g=1", "display_name": "M.Hisoka", "link": "https://stackoverflow.com/users/9063904/m-hisoka"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512593828, "post_id": 47682930, "comment_id": 82326038, "body": "@EugeneSh. is currently unspecified, I am looking for a general solution."}, {"owner": {"reputation": 1, "user_id": 9063904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxBbo.png?s=128&g=1", "display_name": "M.Hisoka", "link": "https://stackoverflow.com/users/9063904/m-hisoka"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1512593844, "post_id": 47682930, "comment_id": 82326049, "body": "@dbush That&#39;s an option but I am searching for an another way because this would be too memory consuming."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512593875, "post_id": 47682930, "comment_id": 82326067, "body": "There is no general solution that fits all."}, {"owner": {"reputation": 1, "user_id": 9063904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxBbo.png?s=128&g=1", "display_name": "M.Hisoka", "link": "https://stackoverflow.com/users/9063904/m-hisoka"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1512593914, "post_id": 47682930, "comment_id": 82326086, "body": "@JonathanLeffler that sounds nice I will try it."}], "owner": {"reputation": 1, "user_id": 9063904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wxBbo.png?s=128&g=1", "display_name": "M.Hisoka", "link": "https://stackoverflow.com/users/9063904/m-hisoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512593626, "creation_date": 1512592065, "last_edit_date": 1512593626, "question_id": 47682930, "link": "https://stackoverflow.com/questions/47682930/c-function-pointer-array-how-to-call-function-from-array-depending-on-opcode", "title": "C - Function Pointer Array - How to call function from array depending on opcode", "body": "<p>Hello StackOverflow Community,</p>\n\n<p>How do I call a function from a function pointer array based on the passed opcode?</p>\n\n<p>For example when I read the opcode '0x1A' and pass it to a function pointer array I want to call some function for example 'add()'.</p>\n\n<p>How can I do that without using switch/case ?</p>\n\n<p>My function pointer array:</p>\n\n<pre><code>void (*execOp[4])(int opcode) = { add, sub, div, mul };\n</code></pre>\n\n<p>My Codebase:</p>\n\n<pre><code>const int memory[2]= {0x1A, 0x1D}; // Memory\nint pc=0; //Program counter\nint opcode; //Current opcode\n\n//Functions\nvoid fetch()\n{\n  opcode=memory[pc];\n}  \n\nvoid add()\n{\n  printf(\"add\");\n}\n\n\nint main()\n{\n  //Decoding Opcodes from Memory\n  for(;;)\n  {\n    fetch();\n  }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1512591629, "post_id": 47682797, "comment_id": 82324838, "body": "Just cast it when passing it to the API. The real question here is whether the API accepts a <code>const</code> string. What API are you using?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1512591786, "post_id": 47682797, "comment_id": 82324929, "body": "No C function receives or returns an array of any kind.  The language has no provision for it.  Wherever you think that&#39;s what&#39;s happening, very likely it&#39;s instead a pointer that&#39;s being passed or returned.  This is important because you can convert a <code>char *</code> to a different pointer type, but you cannot convert a pointer to an array."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512592143, "post_id": 47682797, "comment_id": 82325127, "body": "Well your edit certainly changes things.  No, your API function (still) <i>does not</i> accept an array, but I guess it accepts either a <code>struct WifiConfig</code> or a pointer to one."}, {"owner": {"reputation": 1, "user_id": 2831450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9dfdb35074f8e27c95bf718d3e7eb00?s=128&d=identicon&r=PG&f=1", "display_name": "CasMeiron", "link": "https://stackoverflow.com/users/2831450/casmeiron"}, "edited": false, "score": 0, "creation_date": 1512592309, "post_id": 47682797, "comment_id": 82325227, "body": "I have to populate ssid of that structure but the information is stored into a char *, so indeed I need to copy that information into WifiConfig.ssid which is an array of __uint8_t."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2831450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9dfdb35074f8e27c95bf718d3e7eb00?s=128&d=identicon&r=PG&f=1", "display_name": "CasMeiron", "link": "https://stackoverflow.com/users/2831450/casmeiron"}, "edited": false, "score": 0, "creation_date": 1512591740, "post_id": 47682828, "comment_id": 82324902, "body": "I&#39;ve got an error when I&#39;ve tried to do that: error: assignment to expression with array type      current_config.ssid = (__uint8_t *) ssid;"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1, "user_id": 2831450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9dfdb35074f8e27c95bf718d3e7eb00?s=128&d=identicon&r=PG&f=1", "display_name": "CasMeiron", "link": "https://stackoverflow.com/users/2831450/casmeiron"}, "edited": false, "score": 1, "creation_date": 1512591967, "post_id": 47682828, "comment_id": 82325037, "body": "No, @user2831450, you got an error when you tried to do <i>something different</i> from what Alexander recommended.  See also my comment on your question."}, {"owner": {"reputation": 1, "user_id": 2831450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9dfdb35074f8e27c95bf718d3e7eb00?s=128&d=identicon&r=PG&f=1", "display_name": "CasMeiron", "link": "https://stackoverflow.com/users/2831450/casmeiron"}, "edited": false, "score": 0, "creation_date": 1512592554, "post_id": 47682828, "comment_id": 82325359, "body": "Thanks very much, that worked!! I really appreciate your help."}], "tags": [], "owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "is_accepted": true, "score": 3, "last_activity_date": 1512592235, "last_edit_date": 1592644375, "creation_date": 1512591621, "answer_id": 47682828, "question_id": 47682797, "link": "https://stackoverflow.com/questions/47682797/how-can-i-convert-char-pointer-to-uint8-t-array-in-c/47682828#47682828", "title": "How can I convert char pointer to __uint8_t array in C?", "body": "<p>Just cast:</p>\n<pre><code>const char *name = &quot;My Full Name&quot;;\nyourAPIFunction((__uint8_t *) name);\n</code></pre>\n<p>Note: this violates const-correctness. You have to make sure <code>yourAPIFunction</code> doesn't mutate <code>name</code>. If it does, then you'll need to <code>memcpy</code> (and <code>free</code>!) it to a local variable, and provide it that, so its mutations don't effect the pooled-string used by any other users of <code>&quot;My Full Name&quot;</code>.</p>\n<h1>Response to your (completely different) updated question:</h1>\n<p>Those arrays have their storage in-line, they're not pointers to the heap like a typical <code>char *</code>.. You need to copy the contents of your string into them:</p>\n<pre><code>// ssid must be at most 31 chars (plus NUL terminator)\n// password must be at most 63 chars (plus NUL terminator)\nstruct WifiConfig new_wifi_config(char *ssid, char *password) {\n    struct WifiConfig wifi_config;\n    memcpy(wifi_config.ssid, ssid, strlen(ssid)+1)\n    memcpy(wifi_config.password, ssid, strlen(ssid)+1)\n    return wifi_config;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1512593199, "creation_date": 1512593199, "answer_id": 47683185, "question_id": 47682797, "link": "https://stackoverflow.com/questions/47682797/how-can-i-convert-char-pointer-to-uint8-t-array-in-c/47683185#47683185", "title": "How can I convert char pointer to __uint8_t array in C?", "body": "<blockquote>\n  <p>I need to convert a string (char*) to an array of __uint8_t. I know\n  the latter is an alias of unsigned char but I can't figure it out how\n  to proper convert it.</p>\n</blockquote>\n\n<p>Being pedantic -- because it matters here -- a C string is <em>not</em> a <code>char *</code>.  Rather, it is a null-terminated array of <code>char</code>.  These are accessed and handled primarily via pointers of type <code>char *</code>, largely because that's how one works with arrays in C.</p>\n\n<p>Thus, no, you do not want to convert a <code>char *</code> to an array.  It appears that what you want to do is <em>copy the contents</em> of the array to which it points.  For your particular purpose I would use the <code>strncpy()</code> function:</p>\n\n<pre><code>strncpy((char *) wifi_config.ssid, ssid, sizeof(wifi_config.ssid));\n</code></pre>\n\n<p>Note well that with that code, if <code>ssid</code> is longer than <code>wifi_config.ssid</code> can accommodate then the latter will end up being unterminated, and that otherwise its tail will be filled out with null bytes.  Given the type of that array, such behavior may be <em>precisely</em> what is needed.  If you want to ensure null termination, however, then simply overwrite the last byte of the array with a 0 after the <code>strncpy()</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 2831450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9dfdb35074f8e27c95bf718d3e7eb00?s=128&d=identicon&r=PG&f=1", "display_name": "CasMeiron", "link": "https://stackoverflow.com/users/2831450/casmeiron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1587, "favorite_count": 0, "accepted_answer_id": 47682828, "answer_count": 2, "score": -1, "last_activity_date": 1512593199, "creation_date": 1512591519, "last_edit_date": 1512591937, "question_id": 47682797, "link": "https://stackoverflow.com/questions/47682797/how-can-i-convert-char-pointer-to-uint8-t-array-in-c", "title": "How can I convert char pointer to __uint8_t array in C?", "body": "<p>I need to convert a string (char*) to an array of __uint8_t. I know the latter is an alias of unsigned char but I can't figure it out how to proper convert it.</p>\n\n<p>Example:</p>\n\n<pre><code>char *ssid = \"XXXXX\";\n</code></pre>\n\n<p>This is need cause I have to call an API that accepts only an array of __uint8_t and not char*.</p>\n\n<pre><code>struct WifiConfig {\n    uint8_t ssid[32];\n    uint8_t password[64];\n};\n\nstruct WifiConfig wifi_config;\nwifi_config.ssid = ???\n</code></pre>\n\n<p>If I try to cast:</p>\n\n<pre><code>wifi_config.ssid = (__uint8_t *) ssid;\n</code></pre>\n\n<p>I get the follow error:</p>\n\n<pre><code>error: assignment to expression with array type\n     wifi_config.ssid = (__uint8_t *) ssid;\n</code></pre>\n\n<p>Sorry if that's a silly question, last time I've played with C I was a teen.</p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["c", "arrays", "struct", "initialization", "declaration"], "comments": [{"owner": {"reputation": 3217, "user_id": 995931, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/800518b9616592cb23fb1654925db06f?s=128&d=identicon&r=PG&f=1", "display_name": "user-44651", "link": "https://stackoverflow.com/users/995931/user-44651"}, "edited": false, "score": 0, "creation_date": 1512591599, "post_id": 47682745, "comment_id": 82324819, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4123314/how-i-can-declare-arrays-in-struct\">How I can declare arrays in struct?</a>"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 3217, "user_id": 995931, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/800518b9616592cb23fb1654925db06f?s=128&d=identicon&r=PG&f=1", "display_name": "user-44651", "link": "https://stackoverflow.com/users/995931/user-44651"}, "edited": false, "score": 0, "creation_date": 1512591755, "post_id": 47682745, "comment_id": 82324911, "body": "@user-44651 - the link you refer to is tagged c#, which is a completely different language with different rules.  IMO, This is not a duplicate of that."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1512592240, "post_id": 47682745, "comment_id": 82325185, "body": "Until you create space for: <code>int* section_A;</code>, the elements you refer to in <code>static const struct structname structvariable_b = {...</code> do not exist.  And if you know there will be three elements at compile time, why don&#39;t you just create it as: <code>int section_A[3];</code>?  In general, it is best to use stack memory unless you cannot know the size of something until runtime."}, {"owner": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "edited": false, "score": 0, "creation_date": 1550772280, "post_id": 47682745, "comment_id": 96403626, "body": "I am going to delete this question since nobody upvoted it - and therefore I am not allowed to ask something anymore... I someone is against the deletion, please tell me."}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "edited": false, "score": 0, "creation_date": 1512595414, "post_id": 47683328, "comment_id": 82326849, "body": "very useful :) i will upvote as soon as my reputation is high enough. thank you!"}, {"owner": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "edited": false, "score": 0, "creation_date": 1512595639, "post_id": 47683328, "comment_id": 82326953, "body": "can you maybe add an example for the &quot;sentinel thing&quot;?"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1512601129, "last_edit_date": 1512601129, "creation_date": 1512593803, "answer_id": 47683328, "question_id": 47682745, "link": "https://stackoverflow.com/questions/47682745/c-declare-and-init-array-inside-struct/47683328#47683328", "title": "C - declare and init array inside struct", "body": "<p>Once you take a pointer to the first element of an array, you can no longer find the size of the array through that pointer. So you will also need to make variables to hold the array size. (Or use a sentinel value for the end of the array).</p>\n\n<p>One way to solve your problem would be through ugly macros:</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#define ARRAY_SIZE(a) ( (sizeof(a)) / sizeof((a)[0]) )\n\n\nstruct structname {\n    int* section_A;\n    size_t A_len;\n    int* section_B;\n    size_t B_len;\n};\n\n#define A_INIT (int[]) { 0, 1, 2, 3 }\n#define B_INIT (int[]) { [0x33] = 1, [0x34] = 2 }\n\nstatic const struct structname structvariable_a =\n{\n    .section_A = A_INIT,\n    .A_len = ARRAY_SIZE(A_INIT),\n    .section_B = B_INIT,\n    .B_len = ARRAY_SIZE(B_INIT)\n};\n#undef A_INIT\n#undef B_INIT\n</code></pre>\n\n<p>It would also be possible to define <code>static</code> named <code>int</code> arrays and then use that array's name in the initializers for <code>structvariable_a</code>.</p>\n\n<p>Consider using <code>int const *</code> and <code>int const[]</code> respectively, if you don't intend to change the contents of the arrays at runtime. Note that if this code is in a header, each translation unit will have their own copy of the arrays.</p>\n\n<hr>\n\n<p>Update (as suggested by comment): using a sentinel value would look like:</p>\n\n<pre><code>struct structname {\n    int* section_A;\n    int* section_B;\n};\n\nstatic const struct structname structvariable_a = \n{\n    .section_A = (int[]) { 0, 1, 2, 3, INT_MAX },\n    .section_B = (int[]) { [0x33] = 1, [0x34] = 2, INT_MAX }\n};\n</code></pre>\n\n<p>and the in <code>main</code> or whatever, you look for <code>INT_MAX</code> to know where the end of the array is, e.g.:</p>\n\n<pre><code>size_t a_len;\nfor (a_len = 0; structvariable_a.section_A[a_len] != INT_MAX; ++a_len) { }\n</code></pre>\n\n<p>Obviously this means the range of valid data for the array needs to exclude the sentinel value.</p>\n"}, {"comments": [{"owner": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "edited": false, "score": 0, "creation_date": 1512595559, "post_id": 47683381, "comment_id": 82326910, "body": "thanks! but i would prefer to calculate the size at comilation time since i want to keep the code as easy to extend as possible :)"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1512594060, "creation_date": 1512594060, "answer_id": 47683381, "question_id": 47682745, "link": "https://stackoverflow.com/questions/47682745/c-declare-and-init-array-inside-struct/47683381#47683381", "title": "C - declare and init array inside struct", "body": "<p>The error you're getting is because <code>ARRAY_SIZE</code> expects an array, and <code>structvariablepointer-&gt;section_A</code> is not an array but a pointer.</p>\n\n<p>Since your structs effectively have fixed size arrays, just declare them as arrays instead of pointers:</p>\n\n<pre><code>struct structname {\n    int section_A[4];\n    int section_B[0x35];\n};\n</code></pre>\n\n<p>Then initialize like this:</p>\n\n<pre><code>static const struct structname structvariable_a = {\n\n    .section_A = {\n            [0x01] = 1,\n            [0x02] = 2,\n            [0x03] = 3\n        },\n\n    .section_B = {\n            [0x33] = 4,\n            [0x34] = 5\n        },\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "edited": false, "score": 0, "creation_date": 1512595347, "post_id": 47683546, "comment_id": 82326812, "body": "i would like to upvote your answer as &quot;(very) useful&quot; - but my reputation is too low. i will do that as soon as i am allowed too ;) thanks!"}, {"owner": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "edited": false, "score": 0, "creation_date": 1512595952, "post_id": 47683546, "comment_id": 82327092, "body": "can you think of any similar code that doesn&#39;t reserve 35 elements if only two are filled?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "edited": false, "score": 0, "creation_date": 1512597778, "post_id": 47683546, "comment_id": 82327991, "body": "Sure, @flood, you could use a linked list, or a hash table, or any number of other data structures.  There are tradeoffs involved with each.  Some win on space usage only for much sparser data than you present.  Few, if any, can be initialized as cleanly as the array version.  I wouldn&#39;t sweat the space usage unless it&#39;s a <i>bona fide</i> problem."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1512594840, "creation_date": 1512594840, "answer_id": 47683546, "question_id": 47682745, "link": "https://stackoverflow.com/questions/47682745/c-declare-and-init-array-inside-struct/47683546#47683546", "title": "C - declare and init array inside struct", "body": "<blockquote>\n  <p>i am trying to declare and initialize an array inside a struct and pass it to a pointer, which is itself declared in the struct xD</p>\n</blockquote>\n\n<p>That doesn't make any sense whatever, but your actual code is almost completely correct in C99 and later.  In particular, this:</p>\n\n<blockquote>\n<pre><code>(int[]) {\n            [0x01] = 1,\n            [0x02] = 2,\n            [0x03] = 3\n        }\n</code></pre>\n</blockquote>\n\n<p>Is neither a declaration of nor (quite) an initialization of an array; rather, it is a <em>compound literal</em> of type array of <code>int</code>.  Because arrays decay to pointers in the context given, as in most, such a compound literal can indeed be used to initialize a structure member of type <code>int *</code> (to point to the first element of the array).  Having successfully initialized those two <code>struct structname</code> objects, you can certainly obtain their addresses and record those in variables.</p>\n\n<p>HOWEVER, a pointer to an array element does not carry information about the number of elements in the array.  If that's all you have, as is the case in your <code>main()</code> function, then you cannot determine the number of array elements from it.  You need to be able to determine that from the content (this is why C strings must be null-terminated), or you must have that information from some other source, such as a function argument, a variable, or clairvoyance.</p>\n\n<blockquote>\n  <p>yes, i know my attempt is... let's say \"not correct\" :D but it would be very useful if something similar would exist.</p>\n</blockquote>\n\n<p>If you declare the members of <code>struct structname</code> to be <em>bona fide</em> arrays then you can access and use their declared lengths.  If you prefer, you can store the number of array elements in additional members of that struct.  Both of those approaches are used in the wild, as are approaches based on the contents of the pointed to elements.  But I don't foresee C ever gaining a facility for making your <code>ARRAY_SIZE()</code> macro work with pointers as it seems you would like.</p>\n"}], "owner": {"reputation": 682, "user_id": 2974685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc14da156e7fa877252781a2c283faaf?s=128&d=identicon&r=PG", "display_name": "ataraxis", "link": "https://stackoverflow.com/users/2974685/ataraxis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "accepted_answer_id": 47683328, "answer_count": 3, "score": 1, "last_activity_date": 1512601129, "creation_date": 1512591330, "last_edit_date": 1512593660, "question_id": 47682745, "link": "https://stackoverflow.com/questions/47682745/c-declare-and-init-array-inside-struct", "title": "C - declare and init array inside struct", "body": "<p>language: <strong>C</strong></p>\n\n<p>i am trying to declare and initialize an array inside a struct and pass it to a pointer, which is itself declared in the struct xD</p>\n\n<p>yes, i know my attempt is... let's say \"not correct\" :D\nbut it would be very useful if something similar would exist.</p>\n\n<p>any ideas?</p>\n\n<pre><code>struct structname {\n    int* section_A;\n    int* section_B;\n};\n\nstatic const struct structname structvariable_a = {\n\n    .section_A = (int[]) {\n            [0x01] = 1,\n            [0x02] = 2,\n            [0x03] = 3\n        },\n\n    .section_B = (int[]) {\n            [0x33] = 4,\n            [0x34] = 5\n        },\n\n};\n\nstatic const struct structname structvariable_b = {\n\n    .section_A = (int[]) {\n            [0x01] = 10,\n            [0x02] = 20,\n            [0x03] = 30\n        },\n\n    .section_B = (int[]) {\n            [0x33] = 7,\n            [0x34] = 8\n        },\n\n};\n</code></pre>\n\n<p>later, i want to access the values ...</p>\n\n<pre><code>int main()\n{\n\n    struct structname* structvariablepointer;\n\n    if(foo == 1){\n        structvariablepointer = &amp;structvariable_a;\n    } else {\n        structvariablepointer = &amp;structvariable_b;\n    }\n\n    printf(\"%i\", ARRAY_SIZE(structvariablepointer-&gt;section_A));     // ARRAY_SIZE(arr) equals sizeof(arr) / sizeof(arr[0]));\n\n    int b = 2;\n\n    printf(\"%i\", structvariablepointer-&gt;section_A[b]);\n}\n</code></pre>\n\n<p>the only error is</p>\n\n<pre><code>./include/linux/build_bug.h:29:45: Fehler: Negative Breite in Bitfeld \u00bb&lt;anonym&gt;\u00ab\n #define BUILD_BUG_ON_ZERO(e) (sizeof(struct { int:(-!!(e)); }))\n                                             ^\n./include/linux/compiler-gcc.h:64:28: Anmerkung: bei Substitution des Makros \u00bbBUILD_BUG_ON_ZERO\u00ab\n #define __must_be_array(a) BUILD_BUG_ON_ZERO(__same_type((a), &amp;(a)[0]))\n                            ^~~~~~~~~~~~~~~~~\n./include/linux/kernel.h:60:59: Anmerkung: bei Substitution des Makros \u00bb__must_be_array\u00ab\n #define ARRAY_SIZE(arr) (sizeof(arr) / sizeof((arr)[0]) + __must_be_array(arr))\n                                                           ^~~~~~~~~~~~~~~\n</code></pre>\n"}, {"tags": ["c", "sse", "matrix-multiplication", "intrinsics"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1512590881, "post_id": 47682611, "comment_id": 82324468, "body": "It looks like you might be using GCC under Linux.  Please update your post with the following info: a) OS, b) Compiler and version, c) Run in gdb (if applicable) and copy/paste your stack trace."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1512596640, "post_id": 47682611, "comment_id": 82327454, "body": "Some of your loads (the last 3) are misaligned - use <code>_mm_loadu_ps</code> for these (or for all of them)."}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1512803309, "last_edit_date": 1512803309, "creation_date": 1512614152, "answer_id": 47686673, "question_id": 47682611, "link": "https://stackoverflow.com/questions/47682611/matrix-multiplication-of-size-100100-using-sse-intrinsics/47686673#47686673", "title": "Matrix Multiplication of size 100*100 using SSE Intrinsics", "body": "<blockquote>\n  <p>The segmentation fault was solved by <code>_mm_loadu_ps</code> Also there is something wrong with logic...</p>\n</blockquote>\n\n<p>You're loading 4 overlapping windows on <code>b[k][j+0..7]</code>.  (This is why you needed <code>loadu</code>).</p>\n\n<p>Perhaps you meant to load <code>b[k][j+0]</code>, <code>+4</code>, <code>+8</code>, <code>+12</code>?  If so, you should align <code>b</code> by 64, so all four loads come from the same cache line (for performance).  Strided access is not great, but using all 64 bytes of every cache line you touch is a lot better than getting row-major vs. column-major totally wrong in scalar code with no blocking.</p>\n\n<blockquote>\n  <p>I take 4 elements from row from <code>a</code> multiply it by 4 elements from a column from <code>b</code></p>\n</blockquote>\n\n<p>I'm not sure your text description describes your code.</p>\n\n<p>Unless you've already transposed <code>b</code>, you can't load multiple values from the same column with a SIMD load, because they aren't contiguous in memory.</p>\n\n<p>C multidimensional arrays are \"row major\": the last index is the one that varies most quickly when moving to the next higher memory address.  Did you think that <code>_mm_loadu_ps(&amp;b[k][j+1])</code> was going to give you <code>b[k+0..3][j+1]</code>?  If so, this is a duplicate of <a href=\"https://stackoverflow.com/questions/40313434/sse-matrix-matrix-multiplication\">SSE matrix-matrix multiplication</a> (That question is using 32-bit integer, not 32-bit float, but same layout problem.  See that for a working loop structure.)</p>\n\n<hr>\n\n<p>To debug this, put a simple pattern of values into <code>b[]</code>.  Like</p>\n\n<pre><code>#include &lt;stdalign.&gt;\n\nalignas(64) float b[MAX_DIM][MAX_DIM] = {\n    0000, 0001, 0002, 0003, 0004, ...,\n    0100, 0101, 0102, ...,\n    0200, 0201, 0202, ...,\n };\n\n // i.e. for (...) b[i][j] = 100 * i + j;\n</code></pre>\n\n<p>Then when you step through your code in the debugger, you can see what values end up in your vectors.</p>\n\n<p>For your <code>a[][]</code> values, maybe use <code>90000.0 + 100 * i + j</code> so if you're looking at registers (instead of C variables) you can still tell which values are <code>a</code> and which are <code>b</code>.</p>\n\n<hr>\n\n<p>Related: </p>\n\n<ul>\n<li><p><a href=\"https://www.akkadia.org/drepper/cpumemory.pdf\" rel=\"nofollow noreferrer\">Ulrich Drepper's <strong>What Every Programmer Should Know About Memory</strong></a> shows an optimized matmul with cache-blocking with SSE instrinsics for double-precision.  Should be straightforward to adapt for <code>float</code>.</p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/1303182/how-does-blas-get-such-extreme-performance\">How does BLAS get such extreme performance?</a>  (You might want to just use an optimized matmul library; tuning matmul for optimal cache-blocking is non-trivial but important)</p></li>\n<li><a href=\"https://stackoverflow.com/questions/44375076/matrix-multiplication-with-blocks\">Matrix Multiplication with blocks</a></li>\n<li><a href=\"https://stackoverflow.com/questions/46552143/poor-maths-performance-in-c-vs-python-numpy\">Poor maths performance in C vs Python/numpy</a> has some links to other questions</li>\n<li><a href=\"https://stackoverflow.com/questions/35401524/how-to-optimize-matrix-multiplication-matmul-code-to-run-fast-on-a-single-proc\">how to optimize matrix multiplication (matmul) code to run fast on a single processor core</a></li>\n</ul>\n"}], "owner": {"reputation": 81, "user_id": 6500168, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/601b94035e1a7a2b6cc2c24f82f8c05e?s=128&d=identicon&r=PG&f=1", "display_name": "Amr Khalil", "link": "https://stackoverflow.com/users/6500168/amr-khalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512803309, "creation_date": 1512590732, "last_edit_date": 1512603273, "question_id": 47682611, "link": "https://stackoverflow.com/questions/47682611/matrix-multiplication-of-size-100100-using-sse-intrinsics", "title": "Matrix Multiplication of size 100*100 using SSE Intrinsics", "body": "<pre><code>    int MAX_DIM = 100;\n    float a[MAX_DIM][MAX_DIM]__attribute__   ((aligned(16)));\n    float b[MAX_DIM][MAX_DIM]__attribute__   ((aligned(16)));\n    float d[MAX_DIM][MAX_DIM]__attribute__   ((aligned(16)));\n    /*\n     * I fill these arrays with some values\n     */\n\nfor(int i=0;i&lt;MAX_DIM;i+=1){\n\n      for(int j=0;j&lt;MAX_DIM;j+=4){\n\n        for(int k=0;k&lt;MAX_DIM;k+=4){\n\n          __m128 result = _mm_load_ps(&amp;d[i][j]);\n\n          __m128 a_line  = _mm_load_ps(&amp;a[i][k]);\n\n          __m128 b_line0 = _mm_load_ps(&amp;b[k][j+0]);\n\n          __m128 b_line1 = _mm_loadu_ps(&amp;b[k][j+1]);\n\n          __m128 b_line2 = _mm_loadu_ps(&amp;b[k][j+2]);\n\n          __m128 b_line3 = _mm_loadu_ps(&amp;b[k][j+3]);\n\n         result = _mm_add_ps(result, _mm_mul_ps(_mm_shuffle_ps(a_line, a_line, 0x00), b_line0));\n         result = _mm_add_ps(result, _mm_mul_ps(_mm_shuffle_ps(a_line, a_line, 0x55), b_line1));\n         result = _mm_add_ps(result, _mm_mul_ps(_mm_shuffle_ps(a_line, a_line, 0xaa), b_line2));\n         result = _mm_add_ps(result, _mm_mul_ps(_mm_shuffle_ps(a_line, a_line, 0xff), b_line3));\n         _mm_store_ps(&amp;d[i][j],result);\n        }\n      }\n    }\n</code></pre>\n\n<p>the above code I made to make matrix multiplication using SSE. the code runs as flows I take  4 elements from row from a multiply it by 4 elements from a column from b and move to the next 4 elements in the row of a and next 4 elements in column b </p>\n\n<p>I get an error <code>Segmentation fault (core dumped)</code> I don't really know why </p>\n\n<p>I use gcc  5.4.0 on ubuntu 16.04.5 </p>\n\n<p>Edit : \nThe segmentation fault was solved by _mm_loadu_ps\nAlso there is something wrong with logic i will be greatfull if someone helps me to  find it</p>\n"}, {"tags": ["c", "pointers", "directory"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 5, "creation_date": 1512588659, "post_id": 47682073, "comment_id": 82323265, "body": "Are you sure there&#39;s no superfluous whitespace in <code>dirPath</code>?  Can you try checking with <code>strcmp</code> to be sure?"}, {"owner": {"reputation": 247, "user_id": 8220434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10213308347526791/picture?type=large", "display_name": "Aviv Eyal", "link": "https://stackoverflow.com/users/8220434/aviv-eyal"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1512589131, "post_id": 47682073, "comment_id": 82323512, "body": "srtcmp returned that the strings are not equals , but not because superfluous whitespace.  @user3121023 - if was filled using getline (from a FILE) - and you answer solved the problem! now its working"}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1512589157, "post_id": 47682073, "comment_id": 82323523, "body": "Well, then you have found your issue :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1512589365, "post_id": 47682073, "comment_id": 82323635, "body": "If <code>printf(dirPath);</code> prints a newline, then that&#39;s the problem.  You shouldn&#39;t use that; you should write <code>printf(&quot;dirPath = [%s]\\n&quot;,dirPath);</code> which is both safer (file names containing <code>%</code> would send <code>printf()</code> into a tizzy) and makes it easier to see embedded newlines or carriage returns because of the <code>[</code> and <code>]</code> markers surrounding the string."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1512590268, "post_id": 47682073, "comment_id": 82324102, "body": "FIY in C the newline character <code>\\n</code> is considered a whitespace."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 0, "creation_date": 1512591663, "post_id": 47682073, "comment_id": 82324860, "body": "I&#39;m not having any problems in my own implementation; can you show us how you&#39;re setting the <code>dirPath</code> variable?"}, {"owner": {"reputation": 247, "user_id": 8220434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10213308347526791/picture?type=large", "display_name": "Aviv Eyal", "link": "https://stackoverflow.com/users/8220434/aviv-eyal"}, "reply_to_user": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 0, "creation_date": 1512594800, "post_id": 47682073, "comment_id": 82326542, "body": "@Jose - dirPath filled by getline() from a file - getline(&amp;dirPath,&amp;dirlen,file) and that is why its ending with &quot;\\n&quot;"}], "owner": {"reputation": 247, "user_id": 8220434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10213308347526791/picture?type=large", "display_name": "Aviv Eyal", "link": "https://stackoverflow.com/users/8220434/aviv-eyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1512589617, "answer_count": 0, "score": 1, "last_activity_date": 1512588586, "creation_date": 1512588586, "question_id": 47682073, "link": "https://stackoverflow.com/questions/47682073/c-opendir-return-no-such-file-or-directory", "closed_reason": "Duplicate", "title": "C - opendir() return &quot;No such file or directory&quot;", "body": "<p>I am trying open dir and read files inside it .</p>\n\n<p>but the function opendir() returns always \"No such file or directory\",\nand when I put the the path it's working .</p>\n\n<p><strong>Working:</strong></p>\n\n<pre><code>if (!(dir = opendir(\"/home/user/workspace/OS-Ex2Files/students/\"))){\n    perror(dir);\n    return;\n}\n</code></pre>\n\n<p><strong>Not working:</strong></p>\n\n<pre><code>printf(dirPath); // prints  /home/user/workspace/OS-Ex2Files/students/\nif (!(dir = opendir(dirPath))){\n    perror(dir);\n    return;\n}\n</code></pre>\n\n<p>dirPath is a char* .</p>\n\n<p>Can you please explain me why the second option is not working?</p>\n"}, {"tags": ["c", "pointers", "frequency"], "comments": [{"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 1, "creation_date": 1512587082, "post_id": 47681534, "comment_id": 82322382, "body": "Formatting your code correctly and creating a minimal -but complete- example helps us better help you."}, {"owner": {"reputation": 1096, "user_id": 2436859, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ac93344f8743c4577c1fe1bafdf2c905?s=128&d=identicon&r=PG", "display_name": "Taegost", "link": "https://stackoverflow.com/users/2436859/taegost"}, "edited": false, "score": 1, "creation_date": 1512588721, "post_id": 47681534, "comment_id": 82323305, "body": "This code doesn&#39;t have anything to do with finding out the most frequent character in any string, only whether or not the designated letter exists in the string or not...  Finding the most frequent character would require completely different code, the only part that would stay the same is the initial &quot;for&quot;..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9063382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45b712f05488d2fa41f6b6f40f20118a?s=128&d=identicon&r=PG&f=1", "display_name": "amoutzas retzios", "link": "https://stackoverflow.com/users/9063382/amoutzas-retzios"}, "edited": false, "score": 0, "creation_date": 1512587596, "post_id": 47681696, "comment_id": 82322657, "body": "i didnt know u can use this for( char c = &#39;a&#39;; c &lt;= &#39;z&#39;;c++){  ,so i was in blind,i knew about a &quot;max&quot; counter and a compare at the end, thank you very much,i was about to break my head"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 11, "user_id": 9063382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45b712f05488d2fa41f6b6f40f20118a?s=128&d=identicon&r=PG&f=1", "display_name": "amoutzas retzios", "link": "https://stackoverflow.com/users/9063382/amoutzas-retzios"}, "edited": false, "score": 0, "creation_date": 1512587684, "post_id": 47681696, "comment_id": 82322716, "body": "@amoutzasretzios.: It&#39;s strange you know the way you have used the whole thing...I mean this is basically counting which character appears in maximum number of cities..Hope this helps"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512591667, "post_id": 47681696, "comment_id": 82324861, "body": "A weak compiler will call <code>strlen()</code> many times O(len*len) with <code>for(size_t j = 0; j &lt; strlen(cities[i]); j++)      ...;</code>.  <code>for(size_t j = 0; cities[i][j]; j++)       ...</code> will accomplish the same function with O(len) work."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1512611198, "post_id": 47681696, "comment_id": 82332201, "body": "@chux Yes, that&#39;s the thing. I first edited it to <code>len = strllen()</code> and then loop over <code>len</code> but that also calls <code>strlen</code> couple of times which can be avoided if we do what you have shown. Nice pick."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1512611072, "last_edit_date": 1512611072, "creation_date": 1512587066, "answer_id": 47681696, "question_id": 47681534, "link": "https://stackoverflow.com/questions/47681534/most-frequent-character-in-2d-array-with-pointer/47681696#47681696", "title": "most frequent character in 2d array with pointer", "body": "<p>You have to somehow store the number of occurences for each character somewhere.</p>\n\n<p>With that given a hint would be to keep one variable with storing the max occurence of the character and the character itself. Nothing else. And for looping you need to consider all characters from <code>a</code> to <code>z</code>.</p>\n\n<p>The code will be something like:-(Only look if you feel you have tried enough).</p>\n\n<p>To make you aware of what this code does - it counts the character which occurs in maximum number of cities. In case there is a tie, it selects the smaller alphabet first (lexicographically).</p>\n\n<blockquote class=\"spoiler\">\n  <p><pre><code>for( char c = 'a'; c &lt;= 'z';c++){\n    int ch1 = 0, mxch1 = 0;\n    char mch='?';\n    for(i = 0; i &lt; numOfCities; i++){\n      ch=strchr(cities[i],c); \n        if( ch ){\n           printf(\"Exist in %s\\n\",cities[i]);\n           ch1++;\n        }\n        else\n           printf(\"Doesn't Exist in %s\\n\",cities[i]);\n    }\n    if( ch1 > mch1) { \n      mch1 = ch1; \n      mch = c; \n  }\n    printf(\"The character %c appears in %d cities\\n\",c,ch1);\n}\nprintf(\"Character which occured in max number of cities is %c %d\",mch,mch1);</pre></code></p>\n</blockquote>\n\n<p>The code for most frequent character will be a bit different.</p>\n\n<blockquote class=\"spoiler\">\n  <p><pre><code>int charMap[26]={0};\nfor(size_t i = 0; i &lt; numOfCities; i++){\n  for(size_t j = 0; cities[i][j]; j++)\n      charMap[cities[i][j]-'a']++;\n}\nint mx = 0;\nmxi = 0;\nfor(size_t i = 0; i &lt; sizeof(charMap)/sizeof(charMap[0]); i++){\n  if(charMap[i]>mx){\n      mx  = charMap[i];\n      mxi = i;\n  }\n\nprintf(\"Character which occured max number of times is %c %d\", (char)(mxi+'a'),mx);</pre></code></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 954, "user_id": 1935009, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/LmCmh.png?s=128&g=1", "display_name": "Yashas", "link": "https://stackoverflow.com/users/1935009/yashas"}, "is_accepted": false, "score": 0, "last_activity_date": 1512621274, "creation_date": 1512621274, "answer_id": 47687652, "question_id": 47681534, "link": "https://stackoverflow.com/questions/47681534/most-frequent-character-in-2d-array-with-pointer/47687652#47687652", "title": "most frequent character in 2d array with pointer", "body": "<p>You can use <a href=\"https://en.wikipedia.org/wiki/Counting_sort\" rel=\"nofollow noreferrer\">count sort</a> to achieve this task in O(n) time complexity and O(1) space complexity if your input strictly consists of ASCII characters only.</p>\n\n<p>You keep an array <code>int count[128] = {0};</code> which keeps track of how many time each character occurred. You use the index of the array as the ASCII value of the character.</p>\n\n<pre><code>for(int i = 0; i &lt; 5; i++)\n    for(int j = 0; cities[i][j] != '\\0'; j++)\n         count[cities[i][j]]++;  \n</code></pre>\n\n<p>If you want to ignore non-graphic characters or you just want to count alphanumeric characters or whatever your requirements maybe, you will have to add an <code>if</code> check with the correct combination of functions (<code>isalpha</code>, <code>isalnum</code>, etc) from <a href=\"http://en.cppreference.com/w/c/string/byte\" rel=\"nofollow noreferrer\"><code>ctype.h</code></a></p>\n\n<p>You now have to run through the <code>count</code> array and find the largest number. The index at which the largest number was found is the ASCII value of the most common character.</p>\n"}], "owner": {"reputation": 11, "user_id": 9063382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45b712f05488d2fa41f6b6f40f20118a?s=128&d=identicon&r=PG&f=1", "display_name": "amoutzas retzios", "link": "https://stackoverflow.com/users/9063382/amoutzas-retzios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512621274, "creation_date": 1512586448, "last_edit_date": 1512587076, "question_id": 47681534, "link": "https://stackoverflow.com/questions/47681534/most-frequent-character-in-2d-array-with-pointer", "title": "most frequent character in 2d array with pointer", "body": "<p>i want to find the most frequent character for 5 strings,i thought of this ,i have done it for a specific character,in my ocasion s ,but how can i make it for every character,its only part of my code </p>\n\n<p>Ch is a pointer!!!</p>\n\n<pre><code>for(i = 0; i &lt; five; i++){\n    ch = strchr(cities[i], 's'); \n\n    if (ch != NULL){ //if this is true \n        ch1++;\n        printf(\"exists in %s\\n\", cities[i]); //print\n    }\n    else\n    {\n        printf (\"doesnt exist in %s\\n\", cities[i]); //print\n    }\n}\nprintf(\"The character 's' appears in %d cities\\n\", ch1);\n</code></pre>\n"}, {"tags": ["c", "string", "segmentation-fault", "string-literals"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512584675, "post_id": 47681043, "comment_id": 82321209, "body": "The only duty of the compiler - is to compile the code. If it is doing it, the rest is about the code itself."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5989170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8TrKA.jpg?s=128&g=1", "display_name": "Telegonicaxx", "link": "https://stackoverflow.com/users/5989170/telegonicaxx"}, "edited": false, "score": 0, "creation_date": 1512585308, "post_id": 47681078, "comment_id": 82321519, "body": "So, let me see if i understand, if a make  string using malloc() and strcpy(), it is impossible to edit it because it is a string literal. Or it is is because I passed a string in double quotes, &quot;string literal&quot; that i&#39;m unable to edit it?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 17, "user_id": 5989170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8TrKA.jpg?s=128&g=1", "display_name": "Telegonicaxx", "link": "https://stackoverflow.com/users/5989170/telegonicaxx"}, "edited": false, "score": 0, "creation_date": 1512585425, "post_id": 47681078, "comment_id": 82321571, "body": "@Telegonicaxx You passed to the function a pointer to the first character of a string literal and using this pointer you are trying to change the string literal within the function."}, {"owner": {"reputation": 17, "user_id": 5989170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8TrKA.jpg?s=128&g=1", "display_name": "Telegonicaxx", "link": "https://stackoverflow.com/users/5989170/telegonicaxx"}, "edited": false, "score": 0, "creation_date": 1512585497, "post_id": 47681078, "comment_id": 82321600, "body": "thanks you @Vlad from Moscow! I was really scratching my head with this one."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1512586250, "last_edit_date": 1512586250, "creation_date": 1512584778, "answer_id": 47681078, "question_id": 47681043, "link": "https://stackoverflow.com/questions/47681043/compiler-does-not-allow-me-to-edit-the-passed-string/47681078#47681078", "title": "compiler does not allow me to edit the passed string", "body": "<p>From the C Standard (6.4.5 String literals)</p>\n\n<blockquote>\n  <p>7 It is unspecified whether these arrays are distinct provided their\n  elements have the appropriate values. <strong>If the program attempts to\n  modify such an array, the behavior is undefined.</strong></p>\n</blockquote>\n\n<p>To escape the error you could call the function like</p>\n\n<pre><code>char s[] = \"juanpablo\";   \n\nrm_char( s, 2 );\n</code></pre>\n\n<p>Take into account that it is better to use type <code>size_t</code> instead of the type <code>int</code> for the second parameter and the variable <code>len</code> declared like</p>\n\n<pre><code>int len = strlen(word);\n</code></pre>\n\n<p>is not used in the function.</p>\n\n<p>The function should be declared like</p>\n\n<pre><code>char * rm_char(char* word, size_t pos);\n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar * rm_char(char *word, size_t pos)\n{\n    size_t n = strlen( word );\n\n    if ( pos &lt; n )\n    {\n        //memmove( word + pos, word + pos + 1, n - pos );\n        do \n        {\n            word[pos] = word[pos+1];\n        } while ( word[pos++] );\n    }\n\n    return word;\n}\n\nint main(void) \n{\n    char word[] = \"juanpablo\";\n\n    puts( word );\n    puts( rm_char( word, 2 ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>juanpablo\njunpablo\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5989170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8TrKA.jpg?s=128&g=1", "display_name": "Telegonicaxx", "link": "https://stackoverflow.com/users/5989170/telegonicaxx"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1512584786, "answer_count": 1, "score": -4, "last_activity_date": 1512589647, "creation_date": 1512584607, "last_edit_date": 1512589647, "question_id": 47681043, "link": "https://stackoverflow.com/questions/47681043/compiler-does-not-allow-me-to-edit-the-passed-string", "closed_reason": "Duplicate", "title": "compiler does not allow me to edit the passed string", "body": "<p>I looked around and I could not find a solution of my problems in other question. For some reason, then I get segmentation fault when I run my program and it seems to be because i am changing the give string. I tried passing a pointer to a char pointer and edit that, but to no avail.</p>\n\n<h2>what I get:</h2>\n\n<p>before: juanpablo\nSegmentation fault (core dumped)</p>\n\n<h2>My code:</h2>\n\n<pre><code>void rm_char(char* word, int pos){\n\n   printf(\"before: %s\\n\", word);\n\n   int len = strlen(word);\n\n   int i;\n\n   i = pos;\n\n   while(word[i+1] != '\\0'){\n\n     word[i] = word[i+1];\n\n     i++;\n   } \n\n   word[i] = '\\0';\n\n   printf(\"after: %s\\n\", word);\n} \n\n\nint main(void){\n\n   rm_char(\"juanpablo\", 2);\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1512583782, "post_id": 47680818, "comment_id": 82320768, "body": "Poste the code."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1512583952, "post_id": 47680818, "comment_id": 82320853, "body": "struct declarations define the layout of objects. All the objects need to have the same layout, obviously. How will that work if each one may contain an array of a different size?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1512583964, "post_id": 47680818, "comment_id": 82320862, "body": "To give more details: Post the code as text directly here, i.e. not as picture and not as external link."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7033692, "user_type": "registered", "profile_image": "https://graph.facebook.com/1315106981862642/picture?type=large", "display_name": "Enrique Bozza Dutra", "link": "https://stackoverflow.com/users/7033692/enrique-bozza-dutra"}, "edited": false, "score": 0, "creation_date": 1512584695, "post_id": 47680946, "comment_id": 82321222, "body": "Thanks. I think that i&#39;m going to try it in c++."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512588012, "last_edit_date": 1512588012, "creation_date": 1512584262, "answer_id": 47680946, "question_id": 47680818, "link": "https://stackoverflow.com/questions/47680818/initializing-array-inside-struct/47680946#47680946", "title": "Initializing array inside struct", "body": "<p>Please not that</p>\n\n<ul>\n<li>You cannot preset the values of <code>row</code> <code>col</code> in your code.</li>\n</ul>\n\n<p>To acheive this you need dynamic allocation like this,</p>\n\n<pre><code>struct matrix {\n    int row_count;\n    int col_count;\n    int **values;\n};\n\nvoid free_matrix(struct matrix *const M);\nint initialize_matrix(struct matrix *const M, int row_count, int col_count);\n\nint initialize_matrix(struct matrix *const M, int row_count, int col_count)\n{\n    M-&gt;values = malloc(sizeof *M-&gt;values * row_count);\n    if (M-&gt;values == NULL)\n        return -1;\n    M-&gt;row_count = 0;\n    for (int row = 0; row &lt; row_count; ++row) {\n        M-&gt;values[row] = malloc(sizeof **M-&gt;values * col_count);\n        // In case of failure to allocate\n        // free all rows.\n        if (M-&gt;values[row] == NULL) {\n            free_matrix(M);\n        } else {\n            M-&gt;row_count += 1;\n        }\n    }\n    M-&gt;col_count = col_count;\n}\n\nvoid free_matrix(struct matrix *const M)\n{\n    if (M == NULL)\n        return;\n    for (int row = 0; row &lt; M-&gt;row_count; ++row) {\n        free(M-&gt;values[row]);\n    }\n    free(M-&gt;values);\n}\n\nint main(void)\n{\n    struct matrix M;\n    initialize_matrix(&amp;M);\n    // Use the matrix here\n    free_matrix(&amp;M);\n}\n</code></pre>\n\n<p>You should be extremely careful with the use of <code>malloc()</code> and <code>free()</code>, you must use it correctly or unexpected things will happen to your program.</p>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1512585726, "creation_date": 1512585726, "answer_id": 47681333, "question_id": 47680818, "link": "https://stackoverflow.com/questions/47680818/initializing-array-inside-struct/47681333#47681333", "title": "Initializing array inside struct", "body": "<p>You can't declare a struct in that manner.  One thing people have done is to set their array to the end of the struct and then use malloc to leave extra space for the array in the struct.  Something like this:</p>\n\n<pre><code>typedef struct {\n    int row;\n    int col;\n    char **elem[];\n} table;\n\nvoid some_func() {\n    int row = 5;\n    int col = 5;\n    table *tab = malloc(sizeof(table) + ((row * col) * sizeof(char **)));\n    tab-&gt;row = row;\n    tab-&gt;col = col;\n    // now do whatever you need to with your new struct\n    // that holds an array of 25 char ** elements\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 9008686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqGze.jpg?s=128&g=1", "display_name": "Danlger", "link": "https://stackoverflow.com/users/9008686/danlger"}, "is_accepted": false, "score": 0, "last_activity_date": 1512586438, "creation_date": 1512586438, "answer_id": 47681531, "question_id": 47680818, "link": "https://stackoverflow.com/questions/47680818/initializing-array-inside-struct/47681531#47681531", "title": "Initializing array inside struct", "body": "<p>There are few of errors in the code. You probably want something posted below. Also, don't divide by zero. </p>\n\n<pre><code>struct tbl{\n    int col;\n    int row;\n    // char** elem [col*row]; // can't initialize array size this way\n    char** elem;\n};\n\n\nint main(int argc, char** argv){\n\n    int i, row, col;\n    col = row = 0;\n    bool loop = true;\n    char c;           // Unused?      \n    col = col/row;    // zero divided by zero? You sure you want that?   \n\n    // table tab;        // not defined correctly, Use next line instead \n    struct tbl tab;   \n    tab.row = row;\n    tab.col = col;\n\n    tab.elem = malloc(sizeof(char*)*tab.row);\n    for (i=0 ; i&lt;tab.row ; i++) {\n        tab.elem[i] = malloc(sizeof(char)*tab.col);\n        /* initalize tab.elem[i] */\n    }\n\n    /* ... do stuff */\n\n    // free memory\n    for (i=0 ; i&lt;tab.row ; i++) {\n        free(tab.elem[i]);\n    }\n    free(tab.elem);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7033692, "user_type": "registered", "profile_image": "https://graph.facebook.com/1315106981862642/picture?type=large", "display_name": "Enrique Bozza Dutra", "link": "https://stackoverflow.com/users/7033692/enrique-bozza-dutra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 3, "score": -5, "last_activity_date": 1512588012, "creation_date": 1512583758, "last_edit_date": 1512584244, "question_id": 47680818, "link": "https://stackoverflow.com/questions/47680818/initializing-array-inside-struct", "title": "Initializing array inside struct", "body": "<p>I'm trying to initialize an array inside a struct, <a href=\"https://i.stack.imgur.com/7OMSx.png\" rel=\"nofollow noreferrer\">Like this</a>.</p>\n\n<p>I want the array to have the size of row*col.</p>\n\n<p>Here is part of the code:</p>\n\n<pre><code>struct tbl{\n    int col;\n    int row;\n    char** elem [col*row];\n};\n\n\nint main(int argc, char** argv){\n\n    int i, row, col;\n    col = row = 0;\n    bool loop = true;\n    char c;     \n    col = col/row;  \n\n    table tab;\n    tab.row = row;\n    tab.col = col;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift", "bitmask"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512583858, "post_id": 47680794, "comment_id": 82320813, "body": "The question is unclear. Can you give examples of inputs and outputs expected?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512584090, "post_id": 47680794, "comment_id": 82320919, "body": "The result of <code>output = 1UL &gt;&gt; 2;</code> is like <code>output = 0;</code>.  What was really wanted? <code>&lt;&lt;</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512584244, "post_id": 47680794, "comment_id": 82320991, "body": "To set a bit: <code>output |= (uint32_t)1 &lt;&lt; bit_position;</code>."}, {"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512585242, "post_id": 47680794, "comment_id": 82321486, "body": "@EugeneSh. I updated my question with example usage"}, {"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512585276, "post_id": 47680794, "comment_id": 82321504, "body": "@chux nothing in my code example works correctly :) I just tried but it all fails..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512585592, "post_id": 47680794, "comment_id": 82321641, "body": "Hint: <code>output &amp;= ~FEATURE_MASK; output |= FEATURE_VALUE &lt;&lt; FEATURE_SHIFT;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512586454, "post_id": 47680794, "comment_id": 82322043, "body": "@EugeneSh. <code>output &amp;= ~FEATURE_MASK;</code> is a good idea yet one must be careful when <code>output</code> is wider than <code>unsigned&#47;int</code>, as <code>~FEATURE_MASK</code> may clear bits more-significant bits than <code>unsigned</code>.  An alternative: <code>output |= FEATURE_MASK; output ^= FEATURE_MASK;</code> to avoid wdith issues."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512586696, "post_id": 47680794, "comment_id": 82322181, "body": "@chux XORing with mask won&#39;t work. It will set the corresponding bit if it is unset."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1512586744, "post_id": 47680794, "comment_id": 82322204, "body": "@EugeneSh. XORing after ORing will always clear the bit.  Let the compiler then optimize into the equivalent <code>and</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512586783, "post_id": 47680794, "comment_id": 82322223, "body": "@chux Oh, I see what you are saying."}, {"owner": {"reputation": 1941, "user_id": 988207, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a757b52f46dede44d9323d13fb65cf4?s=128&d=identicon&r=PG", "display_name": "Andrew Falanga", "link": "https://stackoverflow.com/users/988207/andrew-falanga"}, "edited": false, "score": 0, "creation_date": 1512587544, "post_id": 47680794, "comment_id": 82322622, "body": "I think your example shows the incorrect shift. For example, to set bit 1 to 1: <code>output = 1UL &lt;&lt; 1;</code>, likewise, to set bit 0 to 1: <code>output = 1UL &lt;&lt; 0;</code>. However, as <i>chux</i> has pointed out in his response, you want to use the bitwise &#39;or&#39;: <code>output |= (1UL &lt;&lt; 1);</code>. This is made clearer, using your defines, by: <code>output |= MASK_DBG_CTRL_FIFO_ENABLE;</code> But, as written, each time a switch block is entered, and is &quot;true&quot;, the result is simply assigned discarding what was present. Using the right-shift with 1, always assigns 0."}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "edited": false, "score": 0, "creation_date": 1512595519, "post_id": 47681452, "comment_id": 82326892, "body": "Thanks for the help! I added two more of the registers at the end of my question."}, {"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "edited": false, "score": 0, "creation_date": 1512908150, "post_id": 47681452, "comment_id": 82437681, "body": "Chux, thanks for your answer it solved my problem, would you kindly also give a hint as to how to set <code>MASK_DAD_NUM_ADDR</code> and <code>MASK_DAD_NUM_DECI</code> that I updated in my question?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1512586617, "last_edit_date": 1512586617, "creation_date": 1512586141, "answer_id": 47681452, "question_id": 47680794, "link": "https://stackoverflow.com/questions/47680794/how-to-generate-a-value-using-pre-defined-mask/47681452#47681452", "title": "How to generate a value using pre defined mask", "body": "<blockquote>\n  <p>How to generate a value using pre defined mask (?)</p>\n</blockquote>\n\n<p>To address OP's first part:</p>\n\n<p>Consider a re-write of the function signature.  Other suggested changes below as comment code.</p>\n\n<pre><code>// uint32_t generateDebugRegister(uint8_t fifoSplit, uint8_t fifoEnable,\n//     uint8_t adcSplit, uint8_t adcEnable, uint16_t counter) { ...\n\n// use bool for simple T/F values\nuint32_t generateDebugRegister(bool fifoSplit, bool fifoEnable, bool adcSplit, \n    bool adcEnable, uint16_t counter) {\n\n  uint32_t output = 0;\n  if (fifoSplit == WITH_SPLIT) {   // use an `if()`\n    output |= MASK_DBG_CTRL_FIFO_SPLIT; // use an 'or' of the mask\n  } \n  if (fifoEnable == ENABLE) {\n    output |= MASK_DBG_CTRL_FIFO_ENABLE;\n  }\n  .... // like-wise with  adcSplit, adcEnable\n\n  // add an `offset` to simplify shifting needs\n  #define MASK_DBG_CTRL_MAX_BIT_OFFSET 4\n  #define MASK_DBG_CTRL_MAX_MAX (MASK_DBG_CTRL_MAX_COUNTER &gt;&gt; MASK_DBG_CTRL_MAX_BIT_OFFSET)\n\n  // test, since 16 bits do not fit in 12\n  if (counter &gt; MASK_DBG_CTRL_MAX_MAX) {\n    Handle_error_with_TBD_Code();\n  }\n  else { \n    output |= (uint32_t)counter &lt;&lt; MASK_DBG_CTRL_MAX_BIT_OFFSET;\n  }\n\n  return out;\n}\n</code></pre>\n\n<blockquote>\n  <p>I have a dozen of similar registers that have different bit-width and stuff...How can I make this easier?</p>\n</blockquote>\n\n<p>Need to see some of those for a good general answer.</p>\n"}], "owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 47681452, "answer_count": 1, "score": 0, "last_activity_date": 1512595493, "creation_date": 1512583667, "last_edit_date": 1512595493, "question_id": 47680794, "link": "https://stackoverflow.com/questions/47680794/how-to-generate-a-value-using-pre-defined-mask", "title": "How to generate a value using pre defined mask", "body": "<p>I am working on a hardware that is a bit tricky...for example one its 32bit registers looks like this (the upper 16bits are all zero)</p>\n\n<pre><code>#define MASK_DBG_CTRL_FIFO_SPLIT            0b0000000000000001\n#define MASK_DBG_CTRL_FIFO_ENABLE           0b0000000000000010\n#define MASK_DBG_CTRL_ADC_SPLIT             0b0000000000000100\n#define MASK_DBG_CTRL_ADC_ENABLE            0b0000000000001000\n#define MASK_DBG_CTRL_MAX_COUNTER           0b1111111111110000\n\n#define NO_SPLIT                            0  \n#define WITH_SPLIT                          1\n#define DISABLE                             0  \n#define ENABLE                              1\n</code></pre>\n\n<p>My question is, how can I generate a number that I need to write into this register. E.g. I will have a function that gets numbers from user and returns the value ready to be written to register.</p>\n\n<p>This seems to be a very painfull process...I have a dozen of similar registers that have different bit-width and stuff...How can I make this easier?</p>\n\n<p>For one, How do I even write a desired value at the <code>MASK_DBG_CTRL_MAX_COUNTER</code> bits?</p>\n\n<pre><code>uint32_t generateDebugRegister(uint8_t fifoSplit, uint8_t fifoEnable,\n                                uint8_t adcSplit, uint8_t adcEnable,\n                                uint16_t counter) {\n    uint32_t output = 0;\n\n    switch(fifoSplit) {\n    case NO_SPLIT:\n        //do nothing;\n        break;\n    case WITH_SPLIT:\n        output = 1UL &gt;&gt; 1; //set bit 0 to 1\n        break;\n    }\n\n    switch(fifoEnable) {\n    case DISABLE:\n        //do nothing;\n        break;\n    case ENABLE:\n        output = 1UL &gt;&gt; 2; //set bit 2 to 1\n        break;\n    }\n\n    switch(adcSplit) {\n    case NO_SPLIT:\n        //do nothing;\n        break;\n    case WITH_SPLIT:\n        output = 1UL &gt;&gt; 3; //set bit 3 to 1\n        break;\n    }\n\n    switch(adcEnable) {\n    case DISABLE:\n        //do nothing;\n        break;\n    case ENABLE:\n        output = 1UL &gt;&gt; 4; //set bit 4 to 1\n        break;\n    }\n\n    //how to evenset the counter value???\n\n    return output;\n}\n</code></pre>\n\n<p>Example of calling function:</p>\n\n<pre><code>void setDebugRegister(uint32_t value) { /*write to reg*/ };\n\nuint32_t toWrite = generateDebugRegister(NO_SPLIT, DISABLE, WITH_SPLIT, ENABLE, 4256);\n\nsetDebugRegister( toWrite);\n</code></pre>\n\n<p>Here is another set of register masks...here I neeed to set the low 10 bits spliced into two 5 bits:</p>\n\n<pre><code>#define MASK_DAD_NUM_ADDR                   0b0000000000011111\n#define MASK_DAD_NUM_DECI                   0b0000001111100000\n</code></pre>\n\n<p>Here, top 8 bits and low 8 bits:</p>\n\n<pre><code>#define MASK_DBG_REG_ID                     0b1111111100000000;\n#define MASK_DBG_REG_CNTR                   0b0000000011111111;\n</code></pre>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1512581775, "post_id": 47680256, "comment_id": 82319728, "body": "Calling a type <code>Goto</code> is not the best idea."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1512582020, "post_id": 47680256, "comment_id": 82319855, "body": "Your problem is rooted in the fact that everything in <code>c</code> is pass by value. A local copy of <code>gotoList</code> is made in <code>addLabel</code> when you call that function, and its scope exists only in that function. If you want changes to <code>gotoList</code> to persist outside of <code>addLabel</code>, you must return <code>gotoList</code> or pass in a pointer to it (a <code>Goto**</code> type), and dereference that pointer in the function."}], "answers": [{"comments": [{"owner": {"reputation": 1179, "user_id": 6240756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-04YIAx_01kY/AAAAAAAAAAI/AAAAAAAAnhw/V94DoARneK4/photo.jpg?sz=128", "display_name": "iAmoric", "link": "https://stackoverflow.com/users/6240756/iamoric"}, "edited": false, "score": 0, "creation_date": 1512582447, "post_id": 47680282, "comment_id": 82320088, "body": "Thanks a lot ! Due to the fact that gotolist was a pointer, I thought that I could change the value, but I effectively need a pointer to a pointer. And I didn&#39;t know that Goto was a C keyword.. I will change"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 1179, "user_id": 6240756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-04YIAx_01kY/AAAAAAAAAAI/AAAAAAAAnhw/V94DoARneK4/photo.jpg?sz=128", "display_name": "iAmoric", "link": "https://stackoverflow.com/users/6240756/iamoric"}, "edited": false, "score": 0, "creation_date": 1512582502, "post_id": 47680282, "comment_id": 82320117, "body": "@iAmoric.: Pointer doesn&#39;t mean you can change it&#39;s value. It;s just an address, so you can change anything to the content of that address nothing else."}, {"owner": {"reputation": 1179, "user_id": 6240756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-04YIAx_01kY/AAAAAAAAAAI/AAAAAAAAnhw/V94DoARneK4/photo.jpg?sz=128", "display_name": "iAmoric", "link": "https://stackoverflow.com/users/6240756/iamoric"}, "edited": false, "score": 0, "creation_date": 1512582922, "post_id": 47680282, "comment_id": 82320326, "body": "Yes that&#39;s what I meat, use the pointer to change the content at the address. Anyway, thanks for helping me. Question is solved"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1512582581, "last_edit_date": 1512582581, "creation_date": 1512581828, "answer_id": 47680282, "question_id": 47680256, "link": "https://stackoverflow.com/questions/47680256/pointer-is-null-after-a-function/47680282#47680282", "title": "Pointer is null after a function", "body": "<p>Well to make change either you have to pass the address of the variable from the caller function or return from the callee function the address of the allocated memory and assign it to respective variable.</p>\n\n<p>Here you do neither of it so you don't get to retain the change.</p>\n\n<p>By passing the adress of the variable you can do it like this:(The other can be done easily if you understand this one fully).</p>\n\n<pre><code>void addLabel(Goto** gotoList, int value) {\n    if (*gotoList == NULL) {\n        Goto* gotoLabel = malloc(sizeof(*gotoLabel ));\n        gotoLabel-&gt;index = value;\n        gotoLabel-&gt;next = NULL;\n        *gotoList = gotoLabel;\n    }\n    else {\n        Goto* gotoLabel = *gotoList;\n        Goto* newLabel = malloc(sizeof(*newLabel));\n        newLabel-&gt;next = NULL;\n        newLabel-&gt;index = value;\n        while (gotoLabel-&gt;next != NULL) {\n            gotoLabel = gotoLabel-&gt;next;\n        }\n        gotoLabel-&gt;next = newLabel;\n    }\n}\n</code></pre>\n\n<p>Here what we did is simply passed the address of the variable. You will call the function like this</p>\n\n<pre><code>addLabel(&amp;listhead,val);\n</code></pre>\n\n<p>One thing, you have a bad choice in selecting the names of the variables. <code>Goto</code> is the last choice of variable name. In <code>C</code> <code>goto</code> is a keyword, naming a variable on some variation of it is not only misleading but also erroneous in meaning too.</p>\n"}], "owner": {"reputation": 1179, "user_id": 6240756, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-04YIAx_01kY/AAAAAAAAAAI/AAAAAAAAnhw/V94DoARneK4/photo.jpg?sz=128", "display_name": "iAmoric", "link": "https://stackoverflow.com/users/6240756/iamoric"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 1, "closed_date": 1512581836, "accepted_answer_id": 47680282, "answer_count": 1, "score": -1, "last_activity_date": 1512582581, "creation_date": 1512581702, "question_id": 47680256, "link": "https://stackoverflow.com/questions/47680256/pointer-is-null-after-a-function", "closed_reason": "Duplicate", "title": "Pointer is null after a function", "body": "<p>I am working with linked list in C, but I think didn't understant very well the use of pointers.</p>\n\n<p>I have a structure for my linked list. I initialize the first element to NULL. I send this pointer to a function to create (with malloc) a new element of the list. But after the call of the function my element is still NULL. I don't understand. It is surely a stupid error but I need some help..</p>\n\n<pre><code>typedef struct Goto Goto;\nstruct Goto\n{\n    int index;\n    Goto *next;\n};\n\n\n//my code\nGoto* gotoList = NULL;\naddLabel(gotoList, index);\n// Here : gotoList is NULL\n\n\nvoid addLabel(Goto* gotoList, int value) {\n    if (gotoList == NULL) {\n        Goto* gotoLabel = malloc(sizeof(*gotoList));\n        gotoLabel-&gt;index = value;\n        gotoLabel-&gt;next = NULL;\n        gotoList = gotoLabel;\n    }\n    else {\n        Goto* gotoLabel = gotoList;\n        Goto* newLabel = malloc(sizeof(*newLabel));\n        newLabel-&gt;next = NULL;\n        newLabel-&gt;index = value;\n        while (gotoLabel-&gt;next != NULL) {\n            gotoLabel = gotoLabel-&gt;next;\n        }\n        gotoLabel-&gt;next = newLabel;\n    }\n// Here : gotoList is not NULL\n</code></pre>\n\n<p>}</p>\n\n<p>Thanks for helping me</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66, "user_id": 9032857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4399dc80b1e694909b0177bfbd4e9db?s=128&d=identicon&r=PG&f=1", "display_name": "Ora", "link": "https://stackoverflow.com/users/9032857/ora"}, "edited": false, "score": 0, "creation_date": 1512581464, "post_id": 47680114, "comment_id": 82319575, "body": "add &quot;\\t&quot; for tab"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 66, "user_id": 9032857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4399dc80b1e694909b0177bfbd4e9db?s=128&d=identicon&r=PG&f=1", "display_name": "Ora", "link": "https://stackoverflow.com/users/9032857/ora"}, "edited": false, "score": 1, "creation_date": 1512581568, "post_id": 47680114, "comment_id": 82319635, "body": "@Ora That&#39;s not going to work when the length of the shortest printed number is 8 or more chars less than the length of the longest printed number."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1512582785, "post_id": 47680114, "comment_id": 82320260, "body": "Try the format specifier <code>%12g</code>, or to ensure a space afterwards, reduce the &quot;width&quot; part of the specifier by one and add an explicit space, like: <code>%11g %11g %d</code>."}], "owner": {"reputation": 17, "user_id": 9063095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PiWYXCuhykU/AAAAAAAAAAI/AAAAAAAABiA/Ma_n08SZQP4/photo.jpg?sz=128", "display_name": "William P", "link": "https://stackoverflow.com/users/9063095/william-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1512581459, "answer_count": 0, "score": 0, "last_activity_date": 1512581157, "creation_date": 1512581157, "question_id": 47680114, "link": "https://stackoverflow.com/questions/47680114/display-float-with-variable-spaces-in-c", "closed_reason": "Duplicate", "title": "Display float with variable spaces in c", "body": "<p>I'm trying to display float number like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>0.64        0           1    \n0.64        0.0625      1    \n0.64        0.125       1    \n0.64        0.1875      1    \n0.64        0.25        1    \n0.64        0.3125      2    \n0.64        0.375       2    \n0.64        0.4375      2    \n0.64        0.5         2  \n</code></pre>\n\n<p>i know that i need to use %g but how can the spaces change ?\nthanks</p>\n"}, {"tags": ["c", "strtok", "strchr"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 9032857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4399dc80b1e694909b0177bfbd4e9db?s=128&d=identicon&r=PG&f=1", "display_name": "Ora", "link": "https://stackoverflow.com/users/9032857/ora"}, "is_accepted": false, "score": 0, "last_activity_date": 1512581095, "creation_date": 1512581095, "answer_id": 47680096, "question_id": 47679916, "link": "https://stackoverflow.com/questions/47679916/trying-to-extract-complex-numbers-from-strings/47680096#47680096", "title": "trying to extract complex numbers from strings", "body": "<p>parse every number yourself.  start scanning the string from index 1 (since index 0 is either +/- or a number), looking for either a \"=\" or a \"-\".  once you find it, you know how to split the string. </p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "edited": false, "score": 0, "creation_date": 1512582624, "post_id": 47680170, "comment_id": 82320179, "body": "Thank you for the help, fixed the small mistakes I am still getting an odd answer. through debugging i am seeing this:                                                            (gdb) p real                                                                                                           $1 = 5.2635442471208903e-315  Any ideas why I am not seeing 1? i changed the first value to be 1+1i and i reedited the question to remove confusion but i shud be getting 1 instead i get this"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "edited": false, "score": 0, "creation_date": 1512582801, "post_id": 47680170, "comment_id": 82320269, "body": "You have assumed the first <code>strtok</code> does not return <code>NULL</code>."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 2, "last_activity_date": 1512583261, "last_edit_date": 1512583261, "creation_date": 1512581379, "answer_id": 47680170, "question_id": 47679916, "link": "https://stackoverflow.com/questions/47679916/trying-to-extract-complex-numbers-from-strings/47680170#47680170", "title": "trying to extract complex numbers from strings", "body": "<p>So far so good but in</p>\n\n<pre><code>sscanf(arrayp[j],\"%f%fi\", real, imaginary);\n</code></pre>\n\n<p>there are two errors. Firstly the <code>scanf</code> function family needs <code>%lf</code> for a <code>double</code> target.</p>\n\n<p>Secondly, it needs the <em>address</em> of the target, so</p>\n\n<pre><code>sscanf(arrayp[j], \"%lf%lfi\", &amp;real, &amp;imaginary);\n</code></pre>\n\n<p>Also, I don't see why you need to build an array of string pointers first - just examine every non-<code>NULL</code> token pointer that <code>strtok</code> produces.</p>\n\n<p><strong>Edit:</strong> this is a little test program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main ()\n{\n    double r, i;\n    char array[]= \"[[[1+1i -4+100i 45-234i -56-78i]]]\";\n    char *tok;\n    tok = strtok(array, \" []\");\n    while(tok) {\n        sscanf(tok, \"%lf%lfi\", &amp;r, &amp;i);\n        printf(\"%.0f %.0fi\\n\", r, i);\n        tok = strtok(NULL, \" []\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre>\n1 1i\n-4 100i\n45 -234i\n-56 -78i\n</pre>\n\n<p>The program should be more rigorous and check the return value from <code>sscanf</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 6934693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae01dbd66948bafbb6ea6728951bb610?s=128&d=identicon&r=PG&f=1", "display_name": "Ammar Ahmad", "link": "https://stackoverflow.com/users/6934693/ammar-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 47680170, "answer_count": 2, "score": 0, "last_activity_date": 1512583261, "creation_date": 1512580452, "last_edit_date": 1512582839, "question_id": 47679916, "link": "https://stackoverflow.com/questions/47679916/trying-to-extract-complex-numbers-from-strings", "title": "trying to extract complex numbers from strings", "body": "<p>I am attempting to extract two columns of numbers from a text file. first column is the real part of the number and the second in the imaginary part. I managed to extract the list of numbers from the file as strings but I don't know how to separate the strings into two parts. I have attempted to use the sscanf function but just hasnt worked. The difficult part is the numbers can be both positive and negative therefore I cant use + and - in the delimiter of the strtok function since it will remove the negatives. Iv been stuck for a few days so any suggestions would be appreciated. Thanks in advance. Here is the code I worte which errors at the sscanf line. </p>\n\n<pre><code>        #include &lt;stdio.h&gt;\n        #include &lt;stdlib.h&gt;\n        #include &lt;string.h&gt;\n        #include &lt;complex.h&gt;\n\n        char array[35]= \"[[[1+1i -4+100i 45-234i -56-78i]]]\";\n        char *arrayp[35];\n        int count,n,i,j;\n        double complex z1;\n        double real = 0;\n        double imaginary = 0;\n\n        int main()\n        {\n            arrayp[0] = strtok(array,\" []\");\n            n=1;\n            while (arrayp[n-1]!=NULL)\n            {\n               arrayp[n] = strtok(NULL, \" []\");\n               n++;\n            }\n        // up to this point it has been tested to work. the remaining code is very \n        // sloppy since I have tried 8 different things and have quickly written one of \n        // the options tried.    \n\n            for(j=0;j&lt;n;j++)\n            {\n                if (strchr(*arrayp, '+'))\n                {\n                    sscanf(arrayp[j],\"%f+%fi\", real, imaginary);\n                }\n                else if(arrayp string has equal to more than 1 '-')\n                {\n                     sscanf(arrayp[j],\"%f%fi\", real, imaginary);\n                }\n            }\n        }\n</code></pre>\n\n<blockquote>\n  <p>The output should be something like this:<br>\n  0     0<br>\n  -4    100<br>\n  45    -234<br>\n  -56   -78 </p>\n</blockquote>\n\n<p>I noticed there are mistakes such are trying to search *arrayp in strchr but its a pointer I dont know how to convert a pointer into a string so i can put it into this file. Thank you for the help and effort in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 3, "creation_date": 1512578574, "post_id": 47679239, "comment_id": 82317749, "body": "yes the maximum length of a command line may be limited, depends on the OS"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1512578733, "post_id": 47679239, "comment_id": 82317850, "body": "See <a href=\"https://stackoverflow.com/questions/19354870/bash-command-line-and-input-limit\" title=\"bash command line and input limit\">stackoverflow.com/questions/19354870/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/3205027/maximum-length-of-command-line-string\" title=\"maximum length of command line string\">stackoverflow.com/questions/3205027/&hellip;</a> depending on your OS."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 4, "creation_date": 1512578736, "post_id": 47679239, "comment_id": 82317853, "body": "That&#39;s a very strange way of writing data to a file. Not only will you run into the command line length limit, but there will also be issues if the data contains special characters such as <code>&#39;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1512579176, "post_id": 47679239, "comment_id": 82318145, "body": "<code>string_append_with_format(&amp;command...</code> should be <code>string_append_with_format(command...</code> which implies not all warnings are enabled.  Save time - Enable them."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1512579658, "post_id": 47679239, "comment_id": 82318433, "body": "Given your options, I would suggest setting up a system call to &quot;cat &gt; output.txt&quot; and a pipe to feed the data to the above program. You could use the <code>popen</code> function to perform the system call and create the pipe in one go, or emulate the functionality of the <code>popen</code> function in your own code."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1512581612, "post_id": 47679239, "comment_id": 82319657, "body": "@interjay not only characters special to shell, but also format specifiers special to <code>printf</code> such as <code>%%</code>..."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1512583874, "post_id": 47679239, "comment_id": 82320823, "body": "&quot;<i>What do you recommend me to do?</i>&quot; Use <code>fopen()&#47;fwrite()&#47;fclose()</code> or <code>open()&#47;write()&#47;close()</code>!"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1512580070, "creation_date": 1512580070, "answer_id": 47679787, "question_id": 47679239, "link": "https://stackoverflow.com/questions/47679239/call-to-systemprintf-buffer-output-txt-fails-to-write-file-when-buffer-is/47679787#47679787", "title": "Call to system(&quot;printf buffer &gt; output.txt&quot;) fails to write file when buffer is 1MB", "body": "<blockquote>\n  <p>What do you recommend me to do? to change this to execve approach?</p>\n</blockquote>\n\n<p>The alternatives of <code>system()</code> <em>vs</em>. <code>execve()</code> are choices for how to run another process.  The latter would be combined with <code>fork()</code>.  Given that you must use one of these, it is apparent that you are supposed to use an external command to perform the I/O to the eventual destination.  An essential question to answer, then, is <em>which</em> external command to use.</p>\n\n<p>As you have discovered, there are limits to the size of a shell command, and if you pursued a direct conversion to using <code>execve()</code> instead of <code>system()</code> then you would likely discover that there are corresponding limits at that level.  Therefore, your basic approach of passing the data to be printed as an argument to the command is not viable if the possible size of the data is not suitably bounded.  Thus a second, related, essential question is how the data to write are to be conveyed to the external command.</p>\n\n<p>Allow me to suggest using the <code>cat</code> command in place of <code>printf</code>.  With no arguments, <code>cat</code> simply copies its standard input to its standard output.  This solves the problem of providing the data to write to the file: you will arrange for <code>cat</code> to read it from its standard input.  To arrange for the data to go to the destination file, you will need to connect <code>cat</code>'s standard output to that file.</p>\n\n<p>As far as the standard input goes, it looks like you would want to establish a <code>pipe()</code> between the main process and its <code>fork()</code>ed child, and to <code>dup2()</code> the read end of that pipe onto the child's standard input.  The child would close the write end of the pipe (important), and the parent would close the read end.</p>\n\n<p>The clean way to handle the output would be for the child to <code>open()</code> the destination file, and to <code>dup2()</code> its file descriptor on to its standard output.</p>\n\n<p>Having performed those redirections, the child would then <code>execve()</code> <code>/usr/bin/cat</code> with no arguments, and the parent would <code>write()</code> or <code>fwrite()</code> the data to the write end of the pipe, then <code>close()</code> the pipe and <code>wait()</code>s for the child to finish.</p>\n"}], "owner": {"reputation": 450, "user_id": 2007643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b89d550a302aea69ecc604b7ff9488a2?s=128&d=identicon&r=PG", "display_name": "Gaunt", "link": "https://stackoverflow.com/users/2007643/gaunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 47679787, "answer_count": 1, "score": 1, "last_activity_date": 1512580070, "creation_date": 1512578270, "question_id": 47679239, "link": "https://stackoverflow.com/questions/47679239/call-to-systemprintf-buffer-output-txt-fails-to-write-file-when-buffer-is", "title": "Call to system(&quot;printf buffer &gt; output.txt&quot;) fails to write file when buffer is 1MB", "body": "<p>Iam trying to call system to save a buffer to an output, i have to do this with system call, or with execve and pipes(it's a university project).</p>\n\n<p>The buffer is read for a part of a file, and then i have to run a sh on it, and then i can save it to file.\nI was trying to just save it to file with the system(), when i replace the buffer with a shorter string it works perfectly, but not with the large buffer.</p>\n\n<p>I use this function to create the command:</p>\n\n<pre><code>char* command = string_new();\nstring_append_with_format(&amp;command, \"(printf '%s') &gt; %s\", buffer, outputName);\n</code></pre>\n\n<p>Here is the link to the functions iam using if you wanna see them, it's a university library.\n<a href=\"https://github.com/sisoputnfrba/so-commons-library/blob/master/src/commons/string.c\" rel=\"nofollow noreferrer\">https://github.com/sisoputnfrba/so-commons-library/blob/master/src/commons/string.c</a></p>\n\n<p>Is there a limit to the characters you can output with printf command on sh?</p>\n\n<p>What do you recommend me to do? to change this to execve approach?</p>\n\n<p>Thanks, i will add code/information if you need it.</p>\n"}, {"tags": ["c", "http"], "comments": [{"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 1, "creation_date": 1512578071, "post_id": 47679092, "comment_id": 82317435, "body": "Possibly related: <a href=\"https://stackoverflow.com/questions/29230776/c-socket-recv-function-loop\" title=\"c socket recv function loop\">stackoverflow.com/questions/29230776/&hellip;</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512644650, "post_id": 47679092, "comment_id": 82346290, "body": "regarding: <code>byte_count = recv(sockfd,buf,sizeof(buf),0);</code>  a ethernet packet has a limited size, so this needs to be in a loop, where: always check the returned value, if &lt;0 then an error occurred,  if 0 then all input received. if &gt;0 then append the input data to the input buffer (this is usually done by manipulation of the second and third parameters so no separate copy needs to be performed."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512644854, "post_id": 47679092, "comment_id": 82346396, "body": "always check the returned value from <code>socket()</code>, <code>connect()</code>, <code>send()</code>, <code>recv()</code> (etc) to assure the operation was successful."}], "answers": [{"tags": [], "owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "is_accepted": true, "score": 4, "last_activity_date": 1512578388, "creation_date": 1512578388, "answer_id": 47679282, "question_id": 47679092, "link": "https://stackoverflow.com/questions/47679092/i-cant-get-full-webpage/47679282#47679282", "title": "i can&#39;t get full webpage", "body": "<p>As pointed in the comment, you have to <code>recv</code> repeatedly until the returned value is less or equal to zero. Also in such a simple case I'd recommend to send HTML 1.0 request to avoid chunked answers. Try the following code:</p>\n\n<pre><code>#define POSIX_C_SOURCE &gt;= 200112L\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char* argv[])\n{\n    struct addrinfo hints, *res;\n    int sockfd;\n    char buf[65536];\n    int n, byte_count;\n\n    memset(&amp;hints, 0,sizeof hints);\n    hints.ai_family=AF_UNSPEC;\n    hints.ai_socktype = SOCK_STREAM;\n    getaddrinfo(\"man7.org\",\"80\", &amp;hints, &amp;res);\n    sockfd = socket(res-&gt;ai_family,res-&gt;ai_socktype,res-&gt;ai_protocol);\n    printf(\"Connecting...\\n\");\n    connect(sockfd,res-&gt;ai_addr,res-&gt;ai_addrlen);\n    printf(\"Connected!\\n\");\n    char *header = \"GET /linux/man-pages/man2/recv.2.html HTTP/1.0\\r\\nHost:man7.org\\r\\n\\r\\n\";\n    send(sockfd,header,strlen(header),0);\n    printf(\"GET Sent...\\n\");\n//all right ! now that we're connected, we can receive some data!\n\n    byte_count = n = 0;\n    do {\n        byte_count += n;\n        n = recv(sockfd,buf+byte_count,sizeof(buf)-byte_count,0);\n    } while (n &gt; 0);\n    printf(\"recv()'d %d bytes of data in buf\\n\",byte_count);\n    printf(\"%.*s\",byte_count,buf); // &lt;-- give printf() the actual data size\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9062827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e38acc65c2db0d669fcf2cbe0c1db50?s=128&d=identicon&r=PG&f=1", "display_name": "Mykhailo Ogorodniichuk", "link": "https://stackoverflow.com/users/9062827/mykhailo-ogorodniichuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 47679282, "answer_count": 1, "score": 0, "last_activity_date": 1513062774, "creation_date": 1512577809, "last_edit_date": 1513062774, "question_id": 47679092, "link": "https://stackoverflow.com/questions/47679092/i-cant-get-full-webpage", "title": "i can&#39;t get full webpage", "body": "<p>i wanted do http request but it doesnt download full page. only 7300bytes or less from any big webpage\nif i try little webpage it download full\ni tried different flags but still cant find my mistake</p>\n\n<pre><code>#define POSIX_C_SOURCE &gt;= 200112L\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char* argv[])\n{\nstruct addrinfo hints, *res;\nint sockfd;\nchar buf[25056];\nint byte_count;\n\n memset(&amp;hints, 0,sizeof hints);\nhints.ai_family=AF_UNSPEC;\nhints.ai_socktype = SOCK_STREAM;\ngetaddrinfo(\"man7.org\",\"80\", &amp;hints, &amp;res);\nsockfd = socket(res-&gt;ai_family,res-&gt;ai_socktype,res-&gt;ai_protocol);\nprintf(\"Connecting...\\n\");\nconnect(sockfd,res-&gt;ai_addr,res-&gt;ai_addrlen);\nprintf(\"Connected!\\n\");\nchar *header = \"GET /linux/man-pages/man2/recv.2.html HTTP/1.1\\r\\nHost:         \nman7.org\\r\\n\\r\\n\";\nsend(sockfd,header,strlen(header),0);\nprintf(\"GET Sent...\\n\");\n//all right ! now that we're connected, we can receive some data!\n\nbyte_count = recv(sockfd,buf,sizeof(buf),0);\nprintf(\"recv()'d %d bytes of data in buf\\n\",byte_count);\nprintf(\"%.*s\",byte_count,buf); // &lt;-- give printf() the actual data size\n\nreturn 0;\n}\n</code></pre>\n\n<p>exec :</p>\n\n<pre><code>Connecting...\nConnected!\nGET Sent...\nrecv()'d 7300 bytes of data in buf     \nHTTP/1.1 200 OK\nDate: Wed, 06 Dec 2017 16:04:29 GMT\nServer: Apache\nLast-Modified: Tue, 05 Dec 2017 18:41:34 GMT\nETag: \"4d77-64f1-55f9c2f245380\"\nAccept-Ranges: bytes\nContent-Length: 25841\nConnection: close\nContent-Type: text/html; charset=UTF-8\n</code></pre>\n"}, {"tags": ["c++", "c", "ssl", "openssl"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1512582110, "post_id": 47678368, "comment_id": 82319898, "body": "Please study <a href=\"https://www.openssl.org/docs/man1.0.2/apps/ciphers.html\" rel=\"nofollow noreferrer\">man ciphers</a>. It boils down to `...:!DES&#39; for disabling DES but note that 3DES is not the same as DES and you probably want to disable this too. Please see <a href=\"https://wiki.mozilla.org/Security/Server_Side_TLS\" rel=\"nofollow noreferrer\">wiki.mozilla.org/Security/Server_Side_TLS</a> for useful cipher strings."}], "answers": [{"tags": [], "owner": {"reputation": 935, "user_id": 1967221, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5U3DX.png?s=128&g=1", "display_name": "JTejedor", "link": "https://stackoverflow.com/users/1967221/jtejedor"}, "is_accepted": false, "score": 0, "last_activity_date": 1512579291, "last_edit_date": 1512579291, "creation_date": 1512578918, "answer_id": 47679447, "question_id": 47678368, "link": "https://stackoverflow.com/questions/47678368/disable-des-in-my-https-server/47679447#47679447", "title": "Disable DES in my https server", "body": "<p>I found an example of <code>SSL_CTX_set_cipher_list</code> usage in this <a href=\"https://stackoverflow.com/questions/18449332/limit-openssl-server-cipher-options\">question</a>.</p>\n\n<p>Summarizing you should declare an string of algorithms using <code>:</code> as separators between them (you  can consult the algorihtm names in <a href=\"https://wiki.openssl.org/index.php/Manual:Ciphers(1)\" rel=\"nofollow noreferrer\">wiki openssl</a>) and create the context before (as you suggested) setting the cypher list. A little example in code:</p>\n\n<pre><code>// List of allowed ciphers in a colon-separated list.\nconst char *allowedCiphers = \"ECDHE-ECDSA-AES256-SHA384:AES256-GCM-SHA384\";\nint main()\n{\n  const SSL_METHOD *method;\n  SSL_CTX *ctx;\n\n  method = SSLv23_server_method();\n  ctx = SSL_CTX_new(method);    \n  // Set the allowed ciphers\n  if (SSL_CTX_set_cipher_list(ctx, ciphers) != 1)\n  {\n    //define error\n  }\n  SSL_CTX_free(ctx);\n  cleanup_openssl();\n  return 0;\n}\n</code></pre>\n\n<p>Finally I would suggest change your version of openSSL if the library allows DES method, because, as you can see in <a href=\"https://github.com/openssl/openssl/issues/3717\" rel=\"nofollow noreferrer\">this proposal</a>, DES is disabled by default except if you compile explicitly. So, I highly recommend update your openSSL version.</p>\n"}], "owner": {"reputation": 35623, "user_id": 1003575, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cceded39fb12d936211b56afc86dcb04?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAMED", "link": "https://stackoverflow.com/users/1003575/mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1512579291, "creation_date": 1512575553, "question_id": 47678368, "link": "https://stackoverflow.com/questions/47678368/disable-des-in-my-https-server", "title": "Disable DES in my https server", "body": "<p>have a light http server (embedded software solution). This http server is calling openssl functions to handle https connexions.</p>\n\n<p>I want to disable the DES cipher in my https server so I find the function:</p>\n\n<pre><code>SSL_CTX_set_cipher_list(SSL_CTX *ctx, const char *str);\n</code></pre>\n\n<p>I m newbie in openssl and I want to find the right string to pass in the function <code>SSL_CTX_set_cipher_list()</code></p>\n\n<p>What's the string to use in <code>SSL_CTX_set_cipher_list()</code> in order to disable DES in my server?</p>\n\n<p>Is it correct to call the <code>SSL_CTX_set_cipher_list()</code> just after <code>ctx = SSL_CTX_new(meth);</code> ?</p>\n"}, {"tags": ["c", "gdb", "remote-debugging"], "comments": [{"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1512586473, "post_id": 47678054, "comment_id": 82322057, "body": "You are <i>again</i> withholding nearly all relevant info."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1512607519, "post_id": 47678054, "comment_id": 82331450, "body": "By &quot;sharing the same session&quot;, does that mean that multiple users are running their own copy of gdb (same or different versions?) and taking turns connecting to the same remote gdbserver process?"}, {"owner": {"reputation": 193, "user_id": 6151660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b757c042504dfe31020598538b3428d?s=128&d=identicon&r=PG&f=1", "display_name": "YGouddi", "link": "https://stackoverflow.com/users/6151660/ygouddi"}, "edited": false, "score": 0, "creation_date": 1512629329, "post_id": 47678054, "comment_id": 82337405, "body": "When i say the same session, I mean that the two of us are logged in as the same user. As for the gdb version, it 7.2."}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 6151660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b757c042504dfe31020598538b3428d?s=128&d=identicon&r=PG&f=1", "display_name": "YGouddi", "link": "https://stackoverflow.com/users/6151660/ygouddi"}, "edited": false, "score": 0, "creation_date": 1512646519, "post_id": 47681511, "comment_id": 82347558, "body": "When i say the same session, I mean that the two of us are logged in as the same user on the same machine.  As for the gdb version, it&#39;s 7.2."}, {"owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "edited": false, "score": 0, "creation_date": 1611300510, "post_id": 47681511, "comment_id": 116411482, "body": "What if I am not debugging and not setting any break points? This puzzles me."}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "edited": false, "score": 0, "creation_date": 1611329605, "post_id": 47681511, "comment_id": 116424418, "body": "@ed22 If you are not debugging, then you by definition can&#39;t receive the GDB message which is the subject of this question. You should ask a separate one, and provide details of what <i>exactly</i> you are doing."}, {"owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "edited": false, "score": 0, "creation_date": 1611366538, "post_id": 47681511, "comment_id": 116436815, "body": "@EmployedRussian I have compiled the app and am trying to run it. I am getting this error. No debugging."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 3, "last_activity_date": 1615169447, "last_edit_date": 1615169447, "creation_date": 1512586386, "answer_id": 47681511, "question_id": 47678054, "link": "https://stackoverflow.com/questions/47678054/program-received-signal-sigtrap-trace-breakpoint-trap-switching-to-thread-6/47681511#47681511", "title": "Program received signal SIGTRAP, Trace/breakpoint trap. [Switching to Thread 6]", "body": "<p>You are not providing <em>nearly</em> enough info to help you. Details <em>matter</em>, and you are withholding them. Versions of GDB and gdbserver matter, how you invoke GDB and gdbserver matter, what warnings you receive from GDB (if any) matter.</p>\n<p>Now, this error message:</p>\n<pre><code>Program received signal SIGTRAP, Trace/breakpoint trap. [Switching to Thread 6]\n</code></pre>\n<p>usually means that gdbserver has not attached one of the threads of your process, and that thread has tried to execute breakpoint instruction (you do have breakpoints set before this happens, don't you?).</p>\n<p>One of the reasons this may happen is when your GDB loads &quot;wrong&quot; <code>libthread_db.so</code> (one that doesn't match the target <code>libc.so.6</code>).</p>\n<blockquote>\n<p>what makes matter crazier is the fact that a colleague and I, are sharing the same session (the debug is done using cygwin with a remote machine) and it works fine for them but not for me.</p>\n</blockquote>\n<p>I am not sure what you mean by &quot;same session&quot;, but it's probably not &quot;when he types commands, they work; but when I type the same commands into the same GDB, they don't&quot;.</p>\n<p>One difference between you and your colleague could be <code>LD_LIBRATY_PATH</code> environment variable setting. Another could be in <code>~/.gdbinit</code> or in <code>./.gdbinit</code>.</p>\n<p>I suggest running <code>gdb -nx</code> to get rid of the latter, and unsetting <code>LD_LIBRARY_PATH</code> to get rid of the former.</p>\n"}, {"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1531857704, "post_id": 47810227, "comment_id": 89750684, "body": "After a local <code>gdb</code> install you usually find <code>gdb</code> at <code>&#47;usr&#47;local&#47;bin&#47;gdb</code>. Something sounds a bit unusual."}], "tags": [], "owner": {"reputation": 193, "user_id": 6151660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b757c042504dfe31020598538b3428d?s=128&d=identicon&r=PG&f=1", "display_name": "YGouddi", "link": "https://stackoverflow.com/users/6151660/ygouddi"}, "is_accepted": false, "score": 0, "last_activity_date": 1513244695, "creation_date": 1513244695, "answer_id": 47810227, "question_id": 47678054, "link": "https://stackoverflow.com/questions/47678054/program-received-signal-sigtrap-trace-breakpoint-trap-switching-to-thread-6/47810227#47810227", "title": "Program received signal SIGTRAP, Trace/breakpoint trap. [Switching to Thread 6]", "body": "<p>The problem with the whole thing and for some reason no one seemed to notice it is this : \nthis is how I call gdb <code>/usr/local/build/gdbx.y/gdb/gdb</code> what I should be doing is this :  <code>/usr/local/build/gdbx.y/build/gdb/gdb</code>\nIt was a path problem.</p>\n"}], "owner": {"reputation": 193, "user_id": 6151660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b757c042504dfe31020598538b3428d?s=128&d=identicon&r=PG&f=1", "display_name": "YGouddi", "link": "https://stackoverflow.com/users/6151660/ygouddi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5445, "favorite_count": 0, "accepted_answer_id": 47681511, "answer_count": 2, "score": 0, "last_activity_date": 1615169447, "creation_date": 1512574683, "question_id": 47678054, "link": "https://stackoverflow.com/questions/47678054/program-received-signal-sigtrap-trace-breakpoint-trap-switching-to-thread-6", "title": "Program received signal SIGTRAP, Trace/breakpoint trap. [Switching to Thread 6]", "body": "<p>I know this question has been asked before, but I have read all the threads and I didn't find an answer.\nFrom the moment I execure <code>run</code> to start debugging my project, I get this : <code>Program received signal SIGTRAP, Trace/breakpoint trap. [Switching to Thread 6]</code>. When I do <code>ctrl+c</code>, gdb tells me : <code>Program received signal SIGINT, Interrupt.\n0x00000000 in ?? ()</code></p>\n\n<p>Usually it'll tell me which file and which function it got interrupted at not <code>0x00000000 in ?? ()</code>\nGDB no longer hits breakpoints, and what makes matter crazier is the fact that a colleague and I, are sharing the same session (the debug is done using cygwin with a remote machine) and it works fine for them but not for me.\nwhen I try to get info about the threads using <code>info threads</code> here's what I get : </p>\n\n<pre><code>[New Thread 20]\n [New Thread 21]\n [New Thread 22]\n  Id   Target Id         Frame\n  4    Thread 22 (ssp=0xa9004d5c) 0x00000000 in ?? ()\n  3    Thread 21 (ssp=0xa9002e64) 0x00000010 in ?? ()\n  2    Thread 20 (ssp=0xa9000ef4) 0x00000000 in ?? ()\n\nThe current thread &lt;Thread ID 1&gt; has terminated.  See `help thread'\n</code></pre>\n\n<p>there's no thread 6, there's no <code>*</code> to indicate which thread gdb is using. And I don't even know if that's linked to the problem.\nCan anyone please help me?</p>\n"}, {"tags": ["c#", "c++", "c", "wpf", "dllimport"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1512573451, "post_id": 47677569, "comment_id": 82314292, "body": "<code>StringBuilder</code> maps to <code>char*</code>. <code>byte[]</code> maps to <code>unsigned char*</code>. If you use <code>StringBuilder</code> then the caller should null terminate the string. But this doesn&#39;t look like text data at all. Your error is probably just that <code>MyVal</code> has not been initialised correctly. Where is the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? And why don&#39;t you do some debugging?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1512574976, "post_id": 47677569, "comment_id": 82315334, "body": "Having two distinct processes use the same DLL and getting them to share <i>data</i> is a very untrivial programming technique.  It requires #pragma section or a memory-mapped file.  Such a vehicle <i>always</i> requires some kind of synchronization to ensure that the data is valid and not actively being written.  Very important details, nothing like that is visible in the snippet.  So is likely missing, random failure is expected when MyVal was never initialized.  If you don&#39;t yet know how to debug native code that is called by [DllImport] then pursue that instead."}], "owner": {"reputation": 1, "user_id": 6463240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84e2bd92f2d91a2268cac0857fbd714?s=128&d=identicon&r=PG&f=1", "display_name": "Devyesh Tandon", "link": "https://stackoverflow.com/users/6463240/devyesh-tandon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512574491, "creation_date": 1512573184, "last_edit_date": 1512574491, "question_id": 47677569, "link": "https://stackoverflow.com/questions/47677569/system-accessviolationexception-in-wpf-dllimport-and-unsigned-char", "title": "&#39;System.AccessViolationException&#39; in WPF; DLLImport and unsigned char*", "body": "<p>I am trying to import a DLL written in C. The definition of the function is:</p>\n\n<pre><code>__declspec(dllexport) double GetData(unsigned char *Buffer, int l)\n{\n    int i;\n    for (i= 0; i&lt;l; i++)\n    {\n        Buffer[i] = MyVal[i];  //MyVal is a global Variable, updated by differnt process\n    }\n    return 3.14;\n}\n</code></pre>\n\n<p>The counter function used in C# to import this DLL is:</p>\n\n<pre><code>[DllImportAttribute(DLLLocation, CallingConvention = CallingConvention.Cdecl)]\npublic static extern double GetData(StringBuilder buffer, int l);\n</code></pre>\n\n<p>which is called using,</p>\n\n<pre><code>int l = 8;\nStringBuilder buffer = new StringBuilder(8) ;\ndouble t = GetData(buffer, l);\nstring S = buffer.ToString()\n</code></pre>\n\n<p>But when I run thiscode, I get an error, </p>\n\n<pre><code>An unhandled exception of type 'System.AccessViolationException' occurred in\nTestCode.exe\n\nAdditional information: Attempted to read or write protected memory. This is \noften an indication that other memory is corrupt.\n</code></pre>\n\n<p>PS: There are two processes that are using the same DLL. <code>MyVal</code> is getting updated by one process and the other process (<code>WPF</code>) is trying to get that. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5471256"}, "edited": false, "score": 0, "creation_date": 1512575433, "post_id": 47677292, "comment_id": 82315651, "body": "it seems that &#39;(&quot;A.o&quot; has not even the slightest idea about the calling convention for functions in &quot;B.o&quot;, and vice versa).&#39; is putting you in position where your only option is calling a void f(void) function and have a global variable in either one that is declared as extern global in the opposite file. let&#39;s say have a declared int X in A.o and extern int X in B.o, but i don&#39;t know mutch about thread safety. maybe if you put another global int Y (extern int Y) and use it as a flag before you try to read/write the value of X..."}, {"owner": {"reputation": 579, "user_id": 5394746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8bb8432bfdfa5edf2c5c8b4e7f3a2ca6?s=128&d=identicon&r=PG&f=1", "display_name": "cesss", "link": "https://stackoverflow.com/users/5394746/cesss"}, "edited": false, "score": 0, "creation_date": 1512576478, "post_id": 47677292, "comment_id": 82316395, "body": "@b&#39;stard : Yes, the problem of communicating through static global variables is that all threads would share the same data, so the only way is locking the data, as you mention. Another approach I imagined is to define the global variables as arrays (one element per thread), but that&#39;s waaaaay tooooo dirty!! (you have to manage the logic for each thread to know what element in the array belongs to them, not to mention the dynamic resizing of the arrays at thread creation/ending)... too dirty, I&#39;d like to avoid that path if there&#39;s a more elegant solution."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512577013, "post_id": 47677292, "comment_id": 82316761, "body": "Look up ABI \u2014 Application Binary Interface.  You are supposing that the object files do not necessarily have the same ABI (the same calling conventions), or maybe you&#39;re stating that they necessarily do not have the same ABI.  If you have to map between two different ABIs, you are in for a world of pain.  You will need to understand (and know) each object file&#39;s ABI, and how to map between the two.  You won&#39;t be able to call them directly; you&#39;ll need to go via some mapping code. It doesn&#39;t sound sensible to try, even if you know the different conventions.  Recompile with the &#39;right&#39; ABI."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5471256"}, "edited": false, "score": 0, "creation_date": 1512577871, "post_id": 47677292, "comment_id": 82317314, "body": "there must be an easy solution to this problem, but different calling convention even on the same instruction set makes a mess. the same cpu would make the use of stack a bit deterministic, but the calling convention can pass data to registers, the stack, require the caller to clean up the stack, the callee to clean up the stack... you can&#39;t use return values and arguments, but this is a trick question so it has to be an easy one..."}, {"owner": {"reputation": 579, "user_id": 5394746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8bb8432bfdfa5edf2c5c8b4e7f3a2ca6?s=128&d=identicon&r=PG&f=1", "display_name": "cesss", "link": "https://stackoverflow.com/users/5394746/cesss"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512587873, "post_id": 47677292, "comment_id": 82322808, "body": "@JonathanLeffler  Yes, the only difference between the two ABIs would be the calling convention. The rest would be the same. Anyway, I decided to impose a requirement in the calling convention for functions in the interface only (the rest can choose whatever calling convention they prefer, but those in the communication interface will be forced to an specific calling convention)."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 5394746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8bb8432bfdfa5edf2c5c8b4e7f3a2ca6?s=128&d=identicon&r=PG&f=1", "display_name": "cesss", "link": "https://stackoverflow.com/users/5394746/cesss"}, "edited": false, "score": 1, "creation_date": 1512587411, "post_id": 47679484, "comment_id": 82322552, "body": "I think the best option is your second suggestion: Imposing that the functions used as a calling interface <i>must</i> have a well-known calling convention. That way, everything would be solved. In my question I said it wasn&#39;t possible to know the calling convention in advance, but I think it&#39;s reasonable to impose this requirement for the functions in the interface (those functions are always going to be there, in a similar fashion to main() in every executable, so it doesn&#39;t hurt if I impose a requirement on the calling convention at their prototype). Thanks!"}], "tags": [], "owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "is_accepted": true, "score": 1, "last_activity_date": 1512580502, "last_edit_date": 1512580502, "creation_date": 1512579046, "answer_id": 47679484, "question_id": 47677292, "link": "https://stackoverflow.com/questions/47677292/jumping-between-object-code-with-different-and-unknown-calling-convention-in-c/47679484#47679484", "title": "Jumping between object code with different (and unknown) calling convention in C", "body": "<p>Here are two suggestions.</p>\n\n<h1>Data interface</h1>\n\n<p>This elaborates on the struct you defined yourself. From what I've seen in the past, compilers typically use a single register (e.g. <code>eax</code>) for their return value (provided the return type fits in a register). My guess is, the following function prototype is likely to be unaffected by differing calling conventions.</p>\n\n<pre><code>struct data_interface *get_empty_data_interface(void);\n</code></pre>\n\n<p>If so, then you could use that in a way that is similar to the idea you already had about using arrays. Define the following struct and functions in B:</p>\n\n<pre><code>struct data_interface {\n    int ready;\n    int the_real_data;\n};\n\nstruct data_interface *get_empty_data_interface(void)\n{\n    struct data_interface *ptr = malloc(sizeof(struct data_interface));\n    add_to_list_of_data_block_pointers(ptr);\n    ptr-&gt;ready = 0;\n    return ptr;\n}\n\nvoid the_function(void)\n{\n    execute_functionality_for_every_data_block_in_my_list_that_is_flagged_ready_and_remove_from_list();\n}\n</code></pre>\n\n<p>To call the function, do this in A:</p>\n\n<pre><code>struct data_interface *ptr = get_empty_data_interface();\nptr-&gt;the_real_data = 12345;\nptr-&gt;ready = 1;\nthe_function();\n</code></pre>\n\n<p>For thread-safety, make sure the list of data blocks maintained by B is thread-safe.</p>\n\n<ul>\n<li>Simultaneous calls to <code>get_empty_data_interface</code> should not overwrite each other's slot in the list.</li>\n<li>Simultaneous calls to <code>the_function</code> should not both pick up the same list element.</li>\n</ul>\n\n<h1>Wrapper functions</h1>\n\n<p>You could try to expose wrapper functions with a well-known calling convention (e.g. cdecl); if necessary defined in a separate object file that <em>is</em> aware of the calling convention of the functions it wraps.</p>\n\n<p>Unfortunately you will probably need non-portable function attributes for this.</p>\n\n<p>You may be able to cheat your way out of it by declaring <strong>variadic</strong> wrapper functions (with an ellipsis parameter, like <code>printf</code> has); compilers are likely to fall back on cdecl for those. This eliminates non-portable function attributes, but it may be unreliable; you would have to verify my assumption for every compiler you'd like to support. When testing this, keep in mind that compiler options (in particular optimizations) may well play a role. All in all, quite a dirty approach.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5471256"}, "is_accepted": false, "score": 1, "last_activity_date": 1512580914, "creation_date": 1512580914, "answer_id": 47680048, "question_id": 47677292, "link": "https://stackoverflow.com/questions/47677292/jumping-between-object-code-with-different-and-unknown-calling-convention-in-c/47680048#47680048", "title": "Jumping between object code with different (and unknown) calling convention in C", "body": "<p>the question implies that both object files are compiled differently except for the endianness and that they are linked together into one executable.</p>\n\n<p>it says that A.o knows all static symbols from B.o, but the opposite is not true.</p>\n\n<p><strong>Don't make any assumption about the calling conventions involved.</strong></p>\n\n<p>so we'll be using only <code>void f(void)</code> type of functions.</p>\n\n<p>you'll declare <code>int X, Y;</code> in B.o and <code>extern int X, Y;</code> in A.o so before you call the functions in B.o you check the Y flag, if raised wait until it falls. when a B's function is called it raises the Y flag, read the input from X, do some calculations, write the result back in X and return.</p>\n\n<p>then the calling function in A.o copies the value from X into it's own compilation unit and clears the Y flag.</p>\n\n<p>...if calling a <code>void f(void)</code> function just makes a wild jump from one point in the code to another.</p>\n\n<p>another way to do it would be to declare <code>static int Y = 0;</code> in B.o and omit it entirely in A.o</p>\n\n<p>then when a B.o function gets called it checks if <code>Y == 0</code> and if so increase Y, read X, do calculations, write X, decrease Y and return. if not so then wait to become 0 and block the calling function.</p>\n\n<p>or maybe even have a static flag in every B.o function, but i don't see the point in this waste since the communication data is global in B.o</p>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 5394746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8bb8432bfdfa5edf2c5c8b4e7f3a2ca6?s=128&d=identicon&r=PG&f=1", "display_name": "cesss", "link": "https://stackoverflow.com/users/5394746/cesss"}, "edited": false, "score": 0, "creation_date": 1512587690, "post_id": 47680102, "comment_id": 82322718, "body": "Very interesting comments, they helped me realize it&#39;s better if I impose a requirement in the calling convention for the functions in the interface. BTW, regarding shared resources, they wouldn&#39;t be an issue, because only the functions in one of the object files are allowed to allocate resources (memory allocation included)"}], "tags": [], "owner": {"reputation": 426, "user_id": 5029430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfebca461b5469f748ae8fff3fcea68a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Mills", "link": "https://stackoverflow.com/users/5029430/dan-mills"}, "is_accepted": false, "score": 1, "last_activity_date": 1512581115, "creation_date": 1512581115, "answer_id": 47680102, "question_id": 47677292, "link": "https://stackoverflow.com/questions/47677292/jumping-between-object-code-with-different-and-unknown-calling-convention-in-c/47680102#47680102", "title": "Jumping between object code with different (and unknown) calling convention in C", "body": "<p>Remember that there are both caller saves and callee saves conventions out there, together with variations on use of registers to pass values, use or not of a frame pointer, and even (in some architectures, in some optimisation levels) the use of the delay slot in a branch to hold the first instruction of the subroutine. You are not going to be able to do this without some knowledge of the calling conventions in play, but fortunately the linker will need that anyway. Presumably there is some higher level entity that is responsible for loading those DLLs and that knows the calling conventions for both of them? </p>\n\n<p>Anything you do here is going to be at best deep into implementation defined territory, if not technically undefined behaviour, and you will want to make a deep study of the linker and loader (In particular the linker must know how to resolve dynamic linkage in your unknown calling convention or you will not be able to load that shared object in a meaningful way, so you may be able to leaverage it using libbfd or such but that is outside the scope of C). </p>\n\n<p>The place this sort of thing can go very wrong is if shared resources are allocated in A and freed in B (Memory springs to mind) as memory management is a usually a library based wrapper over the operating systems SBRK or similar, and these implementations of memory management are not inherently compatible in memory layout, other places you may be bitten by this include IO (see shennanigans you sometimes get when mixing printf and cout in c++ for a benign example), and locking. </p>\n"}], "owner": {"reputation": 579, "user_id": 5394746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8bb8432bfdfa5edf2c5c8b4e7f3a2ca6?s=128&d=identicon&r=PG&f=1", "display_name": "cesss", "link": "https://stackoverflow.com/users/5394746/cesss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 47679484, "answer_count": 3, "score": 2, "last_activity_date": 1512581115, "creation_date": 1512572352, "question_id": 47677292, "link": "https://stackoverflow.com/questions/47677292/jumping-between-object-code-with-different-and-unknown-calling-convention-in-c", "title": "Jumping between object code with different (and unknown) calling convention in C", "body": "<p>I have (mapped in memory) two object files, <strong>\"A.o\"</strong> and <strong>\"B.o\"</strong>, with the same CPU Instruction Set (not necessarily Intel --it can be x86, x86_64, MIPS(32/64), ARM(32/64), PowerPC(32/64),..., but always the same in both object files).</p>\n\n<p>Also, both object files are compiled with the same endianness (both little endian, or both big endian).</p>\n\n<p>However <em>(you knew there was a however, otherwise there wouldn't be any question)</em>, <strong>\"A.o\"</strong> and <strong>\"B.o\"</strong> can have a different function calling convention and, to make things worse, unknown to each other (<strong>\"A.o\"</strong> has not even the slightest idea about the calling convention for functions in <strong>\"B.o\"</strong>, and vice versa).</p>\n\n<p><strong>\"A.o\"</strong> and <strong>\"B.o\"</strong> are obviously designed to call functions within their same object file, but there must be a (very) limited interface for communicating between them (otherwise, if execution starts at some function in <strong>\"A.o\"</strong>, no function from <strong>\"B.o\"</strong> would ever be executed if there was no such interface).</p>\n\n<p>The file where execution started (let's suppose it's <strong>\"A.o\"</strong>) knows the addresses of all static symbols from <strong>\"B.o\"</strong> (the addresses of all functions and all global variables). But the opposite is not true (well, the limited interface I'm trying to write would overcome that, but <strong>\"B.o\"</strong> doesn't know any address from <strong>\"A.o\"</strong> before such interface is established).</p>\n\n<p><strong>Finally the question:</strong> How can execution jump from a function in <strong>\"A.o\"</strong> to a function in <strong>\"B.o\"</strong>, and back, while also communicating some data?</p>\n\n<p>I need it to:</p>\n\n<ul>\n<li>Be done in standard C (no assembly). </li>\n<li>Be portable C (not compiler-dependent, nor CPU-dependent). </li>\n<li>Be thread safe.</li>\n<li>Don't make any assumption about the calling conventions involved.</li>\n<li>Be able to communicate data between the two object files.</li>\n</ul>\n\n<p>My best idea, for the moment, seems that can meet all these requirements, except thread safety. For example, if I define an <code>struct</code> like this:</p>\n\n<pre><code>struct data_interface {\n   int value_in;\n   int value_out; };\n</code></pre>\n\n<p>I could write a pointer to an <code>struct</code> like this from <strong>\"A.o\"</strong> into a global variable of <strong>\"B.o\"</strong> (knowing in advance that such global variable in <strong>\"B.o\"</strong> has space enough for storing a pointer).</p>\n\n<p>Then, the interface function would be a <code>void interface(void)</code> (I'm assuming that calling <code>void(void)</code> functions is safe across different calling conventions... if this is not true, then my idea wouldn't work). Calling such a function from <strong>\"A.o\"</strong> to <strong>\"B.o\"</strong> would communicate the data to the code in <strong>\"B.o\"</strong>. And, <em>fingers crossed</em>, when the called function in <strong>\"B.o\"</strong> returns, it would travel back nicely (supposing the different calling convention doesn't change the behaviour when returning from <code>void(void)</code> functions).</p>\n\n<p>However, this is not thread safe, of course.</p>\n\n<p>For it to be thread safe, I guess my only option is to access the stack.</p>\n\n<p>But... can the stack be accessed in a portable way in standard C?</p>\n"}, {"tags": ["c", "linux", "concurrency", "mmap", "page-fault"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512573569, "post_id": 47677137, "comment_id": 82314384, "body": "You tag [linux] and mention OSX compatibility and POSIX compatibility.  Inasmuch as POSIX contains optional features, the latter does not necessarily imply the former."}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 5113524, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7dde4d55abf11fb8077dfe825fc8ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Navneeth", "link": "https://stackoverflow.com/users/5113524/navneeth"}, "edited": false, "score": 0, "creation_date": 1512586458, "post_id": 47678808, "comment_id": 82322045, "body": "Thanks for the help. I&#39;m intending to transfer data in blocks over a network using UDP, so there&#39;s a real chance that the writing file worker will be blocked long enough for a child thread to resolve several imminent page faults (perhaps driven by a semaphore, or something). Though my real case for thread-driven prefaulting is that I want to resolve dropped packets in batches (i.e. send all remaining file blocks FCFS), so every iteration after the first will be far from sequential. <code>POSIX_MADV_DONTNEED</code> seems like just what I need for paging away satisfied blocks, though :)"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1512576887, "creation_date": 1512576887, "answer_id": 47678808, "question_id": 47677137, "link": "https://stackoverflow.com/questions/47677137/mmap-manual-concurrent-prefaulting-paging/47678808#47678808", "title": "`mmap()` manual concurrent prefaulting / paging", "body": "<blockquote>\n  <p>It appears, as expected, that the main limitation of mmap()'s performance seems to be the number of minor page faults it generates on large files.</p>\n</blockquote>\n\n<p>That's not particularly surprising, I agree.  But this is a cost that cannot be avoided, at least for the pages corresponding to regions of the mapped file that you actually access.</p>\n\n<blockquote>\n  <p>Furthermore, I suspect the laziness of the Linux kernel's page-to-disk is causing some performance issues. Namely, any test programs that end up performing huge writes to mmaped memory seem to take a long time after performing all writes to terminate/munmap memory.</p>\n</blockquote>\n\n<p>That's plausible.  Again, this is an unavoidable cost, at least for dirty pages, but you can exercise some influence over when those costs are incurred.</p>\n\n<blockquote>\n  <p>I was hoping to offset the cost of these faults by concurrently\n  prefaulting pages while performing the almost-sequential access and\n  paging out pages that I won't need again. But I have three main\n  questions regarding this approach and my understanding of the problem:</p>\n  \n  <ol>\n  <li>Is there a straightforward (preferably POSIX [or at least OSX] compatible) way of performing a partial prefault? I am aware of the\n  <code>MAP_POPULATE</code> flag, but this seems to attempt loading the entire file\n  into memory,</li>\n  </ol>\n</blockquote>\n\n<p>Yes, that's consistent with its documentation.</p>\n\n<blockquote>\n  <p>which is intolerable in many cases. Also, this seems to\n  cause the <code>mmap()</code> call to block until prefaulting is complete,</p>\n</blockquote>\n\n<p>That's also as documented.</p>\n\n<blockquote>\n  <p>which\n  is also intolerable. My idea for a manual alternative was to spawn a\n  thread simply to try reading the next N pages in memory to force a\n  prefetch.</p>\n</blockquote>\n\n<p>Unless there's a delay between when you initially <code>mmap()</code> the file and when you want to start accessing the mapping, it's not clear to me why you would expect that to provide any improvement.</p>\n\n<blockquote>\n  <p>But it might be that madvise with <code>MADV_SEQUENTIAL</code> already\n  does this, in effect.</p>\n</blockquote>\n\n<p>If you want POSIX compatibility, then you're looking for <code>posix_madvise()</code>.  I would indeed recommend using this function instead of trying to roll your own userspace alternative.  In particular, if you use <code>posix_madvise()</code> to assert <code>POSIX_MADV_SEQUENTIAL</code> on some or all of the mapped region, then it is reasonable to hope that the kernel will read ahead to load pages before they are needed.  Additionally, if you advise with <code>POSIX_MADV_DONTNEED</code> then you might, at the kernel's discretion, get earlier sync to disk and overall less memory use.  There is other advice you can pass by this mechanism, too, if it is useful.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li><code>msync()</code> can be used to flush changes to the disk. However, is it actually useful to do this periodically? My idea is that it might\n  be useful if the program is frequently in an \"Idle\" state of disk IO\n  and can afford to squeeze in some disk writebacks. Then again, the\n  kernel might very well be handling this itself better than the ever\n  application could.</li>\n  </ol>\n</blockquote>\n\n<p>This is something to test.  Note that <code>msync()</code> supports <em>asynchronous</em> syncing, however, so you don't need I/O idleness.  Thus, when you're sure you're done with a given page you could consider <code>msync()</code>ing it with flag <code>MS_ASYNC</code> to request that the kernel schedule a sync.  This might reduce the delay incurred when you unmap the file.  You'll have to experiment with combining it with <code>posix_madvise(..., ..., POSIX_MADV_DONTNEED)</code>; they might or might not complement each other.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Is my understanding of disk IO accurate? My assumption is that prefaulting and reading/writing pages can be done concurrently by\n  different threads or processes; if I am wrong about this, then manual\n  prefaulting would not be useful at all.</li>\n  </ol>\n</blockquote>\n\n<p>It should be possible for one thread to prefault pages (by accessing them), while another reads or writes others that have already been faulted in, but it's unclear to me why you expect such a prefaulting thread to be able to run ahead of the one(s) doing the reads and writes.  If it has any effect at all (i.e. if the kernel does not prefault on its own) then I would expect prefaulting a page to be more expensive than reading or writing each byte in it once.</p>\n\n<blockquote>\n  <p>Similarly, if an <code>msync()</code>\n  call blocks all disk IO, both to the filesystem cache and to the raw\n  filesystem, then there also isn't as much of an incentive to use it\n  over flushing the entire disk cache at the program's termination.</p>\n</blockquote>\n\n<p>There is a minimum number of disk reads and writes that will need to be performed on behalf of your program.  For any given mmapped file, they will all be performed on the same I/O device, and therefore they will all be serialized with respect to one another.  If you are I/O bound then to a first approximation, the order in which those I/O operations are performed does not matter for overall runtime.</p>\n\n<p>Thus, if the runtime is what you're concerned with, then probably neither <code>posix_madvise()</code> nor <code>msync()</code> will be of much help unless your program spends a significant fraction of its runtime on tasks that are independent of accessing the mmapped file.  If you do find yourself not wholly I/O bound  then my suggestion would be to see first what <code>posix_madvise()</code> can do for you, and to try asynchronous <code>msync()</code> if you need more.  I'm inclined to doubt that userspace prefaulting or synchronous <code>msync()</code> would provide a win, but in optimization, it's always better to test than to (only) predict.</p>\n"}], "owner": {"reputation": 333, "user_id": 5113524, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7dde4d55abf11fb8077dfe825fc8ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Navneeth", "link": "https://stackoverflow.com/users/5113524/navneeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 1, "accepted_answer_id": 47678808, "answer_count": 1, "score": 2, "last_activity_date": 1512576887, "creation_date": 1512571862, "question_id": 47677137, "link": "https://stackoverflow.com/questions/47677137/mmap-manual-concurrent-prefaulting-paging", "title": "`mmap()` manual concurrent prefaulting / paging", "body": "<p>I'm trying to fine tune <code>mmap()</code> to perform fast writes or reads (generally not both) of a potentially very large file. The writes and reads will be <em>mostly</em> sequential on one pass and then likely very sparse on future passes. No region of memory needs to be accessed more than once.</p>\n\n<p>In other words, think of it as a file transfer with some lossiness that gets fixed asynchronously.</p>\n\n<p>It appears, as expected, that the main limitation of <code>mmap()</code>'s performance seems to be the number of minor page faults it generates on large files. Furthermore, I suspect the laziness of the Linux kernel's page-to-disk is causing some performance issues. Namely, any test programs that end up performing huge writes to <code>mmap</code>ed memory seem to take a long time after performing all writes to terminate/<code>munmap</code> memory.</p>\n\n<p>I was hoping to offset the cost of these faults by concurrently prefaulting pages while performing the almost-sequential access and paging out pages that I won't need again. But I have three main questions regarding this approach and my understanding of the problem:</p>\n\n<ol>\n<li>Is there a straightforward (preferably POSIX [or at least OSX] compatible) way of performing a partial prefault? I am aware of the <code>MAP_POPULATE</code> flag, but this seems to attempt loading the entire file into memory, which is intolerable in many cases. Also, this seems to cause the <code>mmap()</code> call to block until prefaulting is complete, which is also intolerable.  My idea for a manual alternative was to spawn a thread simply to try reading the next  <code>N</code> pages in memory to force a prefetch. But it might be that <code>madvise</code> with <code>MADV_SEQUENTIAL</code> already does this, in effect. </li>\n<li><code>msync()</code> can be used to flush changes to the disk. However, is it actually useful to do this periodically? My idea is that it might be useful if the program is frequently in an \"Idle\" state of disk IO and can afford to squeeze in some disk writebacks. Then again, the kernel might very well be handling this itself better than the ever application could. </li>\n<li>Is my understanding of disk IO accurate? My assumption is that prefaulting and reading/writing pages can be done <em>concurrently</em> by different threads or processes; if I am wrong about this, then manual  prefaulting would not be useful at all. Similarly, if an <code>msync()</code> call blocks all disk IO, both to the filesystem cache and to the raw filesystem, then there also isn't as much of an incentive to use it over flushing the entire disk cache at the program's termination.</li>\n</ol>\n"}, {"tags": ["c", "gcc", "command-line", "command-line-arguments", "object-files"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1512571842, "post_id": 47677104, "comment_id": 82313058, "body": "Why did you put the <code>&lt;</code> there? remove it."}, {"owner": {"reputation": 11, "user_id": 8498862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb1c5e85c6eecfc107dbb85258d6d16?s=128&d=identicon&r=PG&f=1", "display_name": "PhastOfTheFuture", "link": "https://stackoverflow.com/users/8498862/phastofthefuture"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1512572549, "post_id": 47677104, "comment_id": 82313614, "body": "@tkausl Hi, that&#39;s how the script is for reading the project."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1512576041, "post_id": 47677104, "comment_id": 82316093, "body": "<code>myproject&lt;1.txt</code> doesn&#39;t pass any arguments to <code>myproject</code>. <code>myproject 1.txt</code> does."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8498862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb1c5e85c6eecfc107dbb85258d6d16?s=128&d=identicon&r=PG&f=1", "display_name": "PhastOfTheFuture", "link": "https://stackoverflow.com/users/8498862/phastofthefuture"}, "edited": false, "score": 0, "creation_date": 1512572951, "post_id": 47677202, "comment_id": 82313932, "body": "This doesn&#39;t work for me as it just gives the file name but the rest of the program freezes."}, {"owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "reply_to_user": {"reputation": 11, "user_id": 8498862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb1c5e85c6eecfc107dbb85258d6d16?s=128&d=identicon&r=PG&f=1", "display_name": "PhastOfTheFuture", "link": "https://stackoverflow.com/users/8498862/phastofthefuture"}, "edited": false, "score": 2, "creation_date": 1512573549, "post_id": 47677202, "comment_id": 82314365, "body": "May the issue be in the &#39;rest of the program&#39;? (As you said the code above code &#39;prints the filename&#39; which is what it has to do)"}, {"owner": {"reputation": 2737, "user_id": 913182, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/H12RK.jpg?s=128&g=1", "display_name": "Tanner Babcock", "link": "https://stackoverflow.com/users/913182/tanner-babcock"}, "edited": false, "score": 0, "creation_date": 1512616081, "post_id": 47677202, "comment_id": 82333504, "body": "What is the rest of the program? Using that syntax with the short program you wrote in the OP should work"}], "tags": [], "owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "is_accepted": false, "score": 2, "last_activity_date": 1512575058, "last_edit_date": 1512575058, "creation_date": 1512572084, "answer_id": 47677202, "question_id": 47677104, "link": "https://stackoverflow.com/questions/47677104/cant-read-file-name-when-input-through-cmd-in-c-through-args1/47677202#47677202", "title": "Cant read file name when Input through cmd in C ( through args[1] )", "body": "<p>Using redirection (&lt;) gives the data to the program on the standard input (the program sees the data just as if they were typed in by the keyboard), if you want to pass just the parameter simply delete the redirection.</p>\n\n<pre><code>myproject 1.txt\n</code></pre>\n\n<p>... if you just want to 'count lines' give a try to the command <code>wc -l</code>, if it's a homework, just check you're dealing with the file in the correct way: Use fscanf, fgetc,  fputs, fputc, ... instead of the 'standard input' ones scanf, gets, getc, putc, ...</p>\n"}], "owner": {"reputation": 11, "user_id": 8498862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb1c5e85c6eecfc107dbb85258d6d16?s=128&d=identicon&r=PG&f=1", "display_name": "PhastOfTheFuture", "link": "https://stackoverflow.com/users/8498862/phastofthefuture"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512575058, "creation_date": 1512571778, "last_edit_date": 1512573044, "question_id": 47677104, "link": "https://stackoverflow.com/questions/47677104/cant-read-file-name-when-input-through-cmd-in-c-through-args1", "title": "Cant read file name when Input through cmd in C ( through args[1] )", "body": "<p>This is how I am reading my text files in cmd. It is a constraint.</p>\n\n<pre><code>&gt;gcc -std=c99 myproject.c -o myproject\n&gt;myproject&lt;1.txt\n</code></pre>\n\n<p>What I'm trying to achieve is the file name \"1.txt\" as a string so that I can read the number for lines in the file.\nI looked through a bunch of solutions and all of them suggest argv[1] but when I do this:</p>\n\n<pre><code>int main(int args, char*argv[]) {\nprintf(\"File: %s\\n\", argv[1]); }\n</code></pre>\n\n<p>it prints null.</p>\n\n<p>args gives 1 and argv[0] gives myproject.\nI don't know what else I could try. All I want to achieve the number of lines in the given input file. Please help. Thanks!</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1512570754, "post_id": 47676723, "comment_id": 82312307, "body": "Pretty strange to use non-compiling code as an example, there&#39;s no <code>;</code> after the statement (and a statement in <code>()</code> makes little sense to me)."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 2, "creation_date": 1512570761, "post_id": 47676723, "comment_id": 82312312, "body": "This is close/identical to the <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">X macro</a> concept."}, {"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1512570882, "post_id": 47676723, "comment_id": 82312389, "body": "@OliverCharlesworth IMO that comment is answer worthy!"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1512570981, "post_id": 47676723, "comment_id": 82312468, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/264269/what-is-a-good-reference-documenting-patterns-of-use-of-x-macros-in-c-or-possib\">What is a good reference documenting patterns of use of X-Macros in C (or possibly C++)?</a>, and there&#39;s also <a href=\"https://stackoverflow.com/questions/6635851/real-world-use-of-x-macros\">Real-world use of X-Macros</a>"}], "answers": [{"tags": [], "owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "is_accepted": true, "score": 4, "last_activity_date": 1512570970, "creation_date": 1512570970, "answer_id": 47676831, "question_id": 47676723, "link": "https://stackoverflow.com/questions/47676723/parameterized-includes/47676831#47676831", "title": "Parameterized includes", "body": "<p>This is a variant of what are often called <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">X macros</a>.</p>\n\n<h3>Further reading</h3>\n\n<ul>\n<li><a href=\"http://www.drdobbs.com/the-new-c-x-macros/184401387\" rel=\"nofollow noreferrer\"><em>The New C: X Macros</em></a> (Dr Dobbs)</li>\n</ul>\n"}], "owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 47676831, "answer_count": 1, "score": 1, "last_activity_date": 1512570970, "creation_date": 1512570667, "last_edit_date": 1512570795, "question_id": 47676723, "link": "https://stackoverflow.com/questions/47676723/parameterized-includes", "title": "Parameterized includes", "body": "<p>In a few C programs (for example in <a href=\"https://github.com/mozilla/gecko-dev/blob/aac3a947d7cb117cef0ebe5e7291c36b716125e6/gfx/harfbuzz/src/hb-shape-plan.cc#L68\" rel=\"nofollow noreferrer\">gecko</a>) I've noticed an idiom whereby a program will temporarily define a macro, then include a file which uses that macro, then undefine the macro. Here's a trivial example:</p>\n\n<p>speak.c:</p>\n\n<pre><code>#define SPEAK(phrase) (printf(\"When I speak I say %s\\n\", (phrase)))\n#include \"dog.h\"\n#undef SPEAK\n</code></pre>\n\n<p>dog.h:</p>\n\n<pre><code>SPEAK(\"woof\");\n</code></pre>\n\n<p>Which expands to:</p>\n\n<pre><code>(printf(\"When I speak I say %s\\n\", (\"woof\")))\n</code></pre>\n\n<p>I gather this might be a useful technique to generalize included code by being able to specify behavior at the expansion site.</p>\n\n<p><strong>Does this pattern have a name, or has it been written about previously?</strong></p>\n"}, {"tags": ["c", "algorithm", "bit-manipulation"], "comments": [{"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 3, "creation_date": 1512570796, "post_id": 47676609, "comment_id": 82312328, "body": "What does this algorithm do? For example <code>selector_value = current_selector | mask;</code> always non-zero, so next <code>if</code> looks strange"}, {"owner": {"reputation": 40404, "user_id": 282912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bmLJq.png?s=128&g=1", "display_name": "msw", "link": "https://stackoverflow.com/users/282912/msw"}, "edited": false, "score": 0, "creation_date": 1512571068, "post_id": 47676609, "comment_id": 82312523, "body": "It looks like it might be calculating <code>*selector &amp; *source</code> in a really convoluted way. See <a href=\"https://en.wikipedia.org/wiki/Bitwise_operations_in_C#Bitwise_AND_.26\" rel=\"nofollow noreferrer\">bitwise and</a> to check if that&#39;s what you meant."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1512571069, "post_id": 47676609, "comment_id": 82312524, "body": "Where this data is coming from? Probably from some IO channel. Which is much slower than your algorithm. So I wouldn&#39;t worry about it until profiled and proven it is a bottleneck."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1512571350, "post_id": 47676609, "comment_id": 82312721, "body": "<code>mask &lt;&lt; bit;</code> expression has no effect."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1512571670, "post_id": 47676609, "comment_id": 82312949, "body": "Rather than dump a bunch of dense code on us and expect us to understand what problem you&#39;re trying to solve, explain it to us <i>in words</i>. What you&#39;ve done here is akin to showing me a tool that does a job I&#39;m not familiar with, and asked me to help you design a similar tool to do something that you haven&#39;t even defined."}, {"owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1512571726, "post_id": 47676609, "comment_id": 82312992, "body": "Please before optimizing the code, check if your algorithm works at all. This is very unlikely with errors like the one mentioned by @wildplasser [<code>mask &lt;&lt; bit;</code>]"}, {"owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1512572401, "post_id": 47676609, "comment_id": 82313495, "body": "@JimMischel I explained what a bit selector is for those people who do not know what it is. I did not do this originally because anyone who does not already know what a bit selector is would be unlikely to be able to answer the question."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1512572823, "post_id": 47676609, "comment_id": 82313827, "body": "I know what a bit selector is. Your &quot;explanation&quot; of a bit selector is, at best, incomplete. Somebody who doesn&#39;t know what one is wouldn&#39;t be able to figure it out from those two sentences. And the code you provide is way more complicated than it needs to be to illustrate the concept. In any case, my suggestion, as it is for most things, is to first write something that works, <i>then</i> figure out how to make it fast."}, {"owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1512574415, "post_id": 47676609, "comment_id": 82314907, "body": "@JimMischel I am not interested in optimizing my algorithm. The question is whether there is a BETTER algorithm altogether. I included my first attempt, simply to illustrate the general idea of what is being done. I expect that an efficient algorithm will work in a completely different way, so the nuances of my toy algorithm are irrelevant."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1512574851, "post_id": 47676609, "comment_id": 82315235, "body": "Do you mean <a href=\"https://stackoverflow.com/a/25492730/555045\">this</a>?"}, {"owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1512580456, "post_id": 47676609, "comment_id": 82318972, "body": "@harold Yes, thanks harold. harold, once again a lone island of wisdom in an ocean of ignorance."}], "answers": [{"tags": [], "owner": {"reputation": 5636, "user_id": 8207228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bea1f01a8f41b0714de4eddc3c93ce8?s=128&d=identicon&r=PG", "display_name": "Ralf Kleberhoff", "link": "https://stackoverflow.com/users/8207228/ralf-kleberhoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1512591012, "creation_date": 1512591012, "answer_id": 47682671, "question_id": 47676609, "link": "https://stackoverflow.com/questions/47676609/bit-selection-algorithm/47682671#47682671", "title": "Bit selection algorithm", "body": "<p>I'd do it byte by byte and based on a lookup table.</p>\n\n<p>Create a lookup table that gives you the bit patterns to be or'ed (after shifting) onto the current and the next byte of the output. This table is indexed by [sourceByte][selectorByte], so it's a 256*256 table of byte values.</p>\n\n<p>Shift the table result by the number of bits already occupied in your current output byte, and OR that onto the current and next byte (or maybe use bigger chunks for the result).</p>\n\n<p>Advance the output bit position and byte pointer by the number of bits from the selector byte (another table byte[256] might be easier than bit-fiddling).</p>\n\n<p>But in the end, you have to profile the program and try which approach is faster (and if the bit-fiddling really makes for a noticable portion of the run-time).</p>\n"}], "owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1512591012, "creation_date": 1512570353, "last_edit_date": 1512572329, "question_id": 47676609, "link": "https://stackoverflow.com/questions/47676609/bit-selection-algorithm", "title": "Bit selection algorithm", "body": "<p>I want to find an efficient way to select bits from one stream using the bits of another stream in C. The amount of data processed is terabytes, so speed is important.</p>\n\n<p>What a \"bit selector\" does is select only certain bits from out of a sequence of bits. For example, if the source stream is [ 1, 0, 1, 0, 1, 0, 1 ] and the selection criteria is [ 1, 1, 0, 0, 1, 0, 0 ] then the result will be [ 1, 0, 1 ].</p>\n\n<p>An example of doing this the following:</p>\n\n<pre><code>uint64_t source[5];\nsource[0] = 1234567890987654321;\nsource[1] = 3456789098765432198;\nsource[2] = 5678909876543219876;\nsource[3] = 7890987654321987654;\nsource[4] = 9098765432198765432;\nuint64_t selector[5];\nselector[0] = 8214263800482614621;\nselector[1] = 4251759498365531188;\nselector[2] = 1628009771533217836;\nselector[3] = 6890182644227957152;\nselector[4] = 3018964452491735032;\nsize_t count_values = 5;\nuint64_t result[5];\n\nsize_t xCurrentResultBits = 0;\nuint64_t result_value = 0;\nsize_t result_index = 0;\nfor( size_t xSelector = 0; xSelector &lt; count_values; xSelector ){\n   uint64_t current_selector = selector[ xSelector ];\n   uint64_t current_source = source[ xSelector ];\n   for( size_t bit = 0; bit &lt; 64; bit++ ){\n      uint64_t mask = 1;\n      mask = mask &lt;&lt; bit;\n      uint64_t selector_value = current_selector | mask;\n      if( selector_value &gt; 0 ){ // keep the bit in the source\n         uint64_t source_value = current_source | mask;\n         result_value = result_value &lt;&lt; 1;\n         if( source_value &gt; 0 ) result_value = result_value + 1;\n         xCurrentResultBits++\n      } else {\n         // throw away source bit\n      }\n      if( xCurrentResultBits == 63 ){ // filled up a result value\n         result[ result_index ] = result_value;\n         result_index++;\n         result_value = 0;\n         xCurrentResultBits = 0;\n      }\n   }\n}\n</code></pre>\n\n<p>The problem is that this method is probably a lot slower than it could be. Is there a well-known algorithm to do this fast?</p>\n"}, {"tags": ["c", "variadic-functions"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1512569893, "post_id": 47676372, "comment_id": 82311695, "body": "Perhaps you could call <code>printf(&quot;%d&quot;, a)</code> before calling<code>vprintf</code> with the rest of the arguments? (But that would mean that the <code>%d</code> shouldn&#39;t be part of your format, which apparently is the case. Why?)"}, {"owner": {"reputation": 1, "user_id": 9062154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd32ea3f6678b9f8844b6ed62311a0ab?s=128&d=identicon&r=PG&f=1", "display_name": "Zingfrid", "link": "https://stackoverflow.com/users/9062154/zingfrid"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1512570227, "post_id": 47676372, "comment_id": 82311942, "body": "Yes, this is exactly the case, that %d is part of the format."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1512570288, "post_id": 47676372, "comment_id": 82311990, "body": "This seems like a weird design. Why can&#39;t the caller pass <code>a</code> like normal?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512570446, "post_id": 47676372, "comment_id": 82312095, "body": "The fact that the <code>%d</code> is part of the format and the <code>int</code> value is not part of the <code>va_list</code> is going to make life tricky.  You&#39;ll need to parse the format, for example separating it into the part up to (but not including) the second <code>%</code>, and use that format with the standalone argument; the remainder of the format is then passed to <code>vprintf()</code>.  If you&#39;re on a POSIX system and in a multi-threaded program, you might want to use <code>flockfile()</code> and <code>funlockfile()</code> on <code>stdout</code> to ensure that they&#39;re treated as a single unit of output despite the mulit-threading."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1512570548, "post_id": 47676372, "comment_id": 82312166, "body": "However, you would do best to redesign the interface so that the format string only applies to the <code>...</code> (<code>va_list</code>) arguments; the fixed argument gets treated separately.  You could look at the FFI (foreign function interface) library; I&#39;m not at all sure it will help, though.  Also, if you&#39;re on POSIX and someone passes <code>&quot;it is %2$s and %1$d things happened&quot;</code>, you&#39;re in deep trouble."}, {"owner": {"reputation": 1, "user_id": 9062154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd32ea3f6678b9f8844b6ed62311a0ab?s=128&d=identicon&r=PG&f=1", "display_name": "Zingfrid", "link": "https://stackoverflow.com/users/9062154/zingfrid"}, "edited": false, "score": 0, "creation_date": 1512570937, "post_id": 47676372, "comment_id": 82312430, "body": "Yes, I&#39;m on POSIX system. But it is quite old, I even not able to use approaches with <b>VA_ARGS</b> macros as it appears in C99+ standards."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512571524, "post_id": 47676372, "comment_id": 82312853, "body": "Curious that you&#39;re on such an old system.  However, that simply means you probably won&#39;t write code with the <code>n$</code> notations in it, so it is one less thing to worry about.  Standard reasons for wanting extra arguments are logging things like <code>__FILE__</code> and <code>__LINE__</code> (presumably not <code>__func__</code> if you don&#39;t have C99 <code>__VA_ARGS__</code> support).  You would probably do best to remove the option of caller-controlled formatting of those fixed arguments, leaving the <code>fmt</code> to process just the <code>...</code> arguments."}], "answers": [{"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1512571477, "post_id": 47676978, "comment_id": 82312825, "body": "Yes, that&#39;s the clean and simple solution."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1512571431, "creation_date": 1512571431, "answer_id": 47676978, "question_id": 47676372, "link": "https://stackoverflow.com/questions/47676372/print-one-more-parameter-with-va-args/47676978#47676978", "title": "Print one more parameter with va_args", "body": "<p>If <code>a</code> is always printed the same way, it shouldn't be part of the format passed in.  You should instead print it separately.</p>\n\n<p>In the example you gave, change your format string to <code>\"some text %s\"</code>.  Then your function can do this:</p>\n\n<pre><code>void func (int a, char *fmt, ...) {\n    va_list ap;\n\n    // first print the function specific fields\n    printf(\"%d \", a);\n\n    // then the user's format\n    va_start (ap, fmt);\n    vprintf(fmt, ap);\n    va_end(ap);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1512591447, "last_edit_date": 1512591447, "creation_date": 1512572547, "answer_id": 47677355, "question_id": 47676372, "link": "https://stackoverflow.com/questions/47676372/print-one-more-parameter-with-va-args/47677355#47677355", "title": "Print one more parameter with va_args", "body": "<p>As noted in comments:</p>\n\n<h3>Redesign the interface</h3>\n\n<p>You would do best to redesign the interface so that the format string only applies to the <code>...</code> (<code>va_list</code>) arguments; the fixed argument gets treated separately.</p>\n\n<p>Standard reasons for wanting extra arguments are logging things like <code>__FILE__</code> and <code>__LINE__</code> (presumably not <code>__func__</code> if you don't have C99 <code>__VA_ARGS__</code> support \u2014 see below). You would probably do best to remove the option of caller-controlled formatting of those fixed arguments, leaving the <code>fmt</code> to process just the <code>...</code> arguments.</p>\n\n<h3>If you can't redesign the interface</h3>\n\n<p>The fact that the <code>%d</code> is part of the format and the <code>int</code> value is not part of the <code>va_list</code> makes life tricky.</p>\n\n<p>If you cannot, or decline to, change the rules for calling the function, you'll need to parse the format, for example separating it into the part up to (but not including) the second <code>%</code>, and use that format with the standalone argument; the remainder of the format is then passed to <code>vprintf()</code>. If you're on a POSIX system and in a multi-threaded program, you might want to use <code>flockfile()</code> and <code>funlockfile()</code> on stdout to ensure that they're treated as a single unit of output despite the multi-threading.</p>\n\n<pre><code>// Using C99 features\nvoid func(int a, char *fmt, ...)\n{\n    char *p1 = strchr(fmt, '%');\n    if (p1 == 0)\n    {\n        // No conversion specifications. Not puts(); it adds a newline\n        fputs(fmt, stdout);\n        return;\n    }\n    char *p2 = strchr(p1 + 1, '%');\n    if (p2 == 0)\n    {\n        // The user invoked func(1, \"iteration %d:\\n\");?\n        printf(fmt, a);\n        return;\n    }\n    int buflen = p2 - fmt + 1;\n    char buffer[buflen];\n    memmove(buffer, fmt, buflen);\n    buffer[buflen-1] = '\\0';\n    // flockfile(stdout);    // Multi-threading\n    printf(buffer, a);\n    va_list ap;\n    va_start(ap, fmt);\n    vprintf(p2, ap);\n    va_end(ap);\n    // funlockfile(stdout);  // Multi-threading\n}\n</code></pre>\n\n<p>The code cheats; it uses a C99 VLA (variable length array) and also interleaved declarations and statements.  In C90, therefore, you'd probably end up using <code>malloc()</code>, or perhaps a fixed size buffer (running risks of overflows), or a hybrid (use a fixed size buffer if the prefix of the format string is small enough to fit, or allocate (and free) if not).</p>\n\n<p>You need to decide on the appropriate error handling strategies.  Note that this isn't bullet-proof code.  Calling <code>func(a, \"%% yield is %d; data is [%s]\\n\", data);</code> throws another spanner in the works.  Also, if you're on POSIX and someone passes \"it is %2$s and %1$d things happened\", you're in deep trouble.</p>\n\n<blockquote>\n  <p>Yes, I'm on POSIX system. But it is quite old, I am even not able to use approaches with <code>__VA_ARGS__</code> macros as it appears in C99+ standards.</p>\n</blockquote>\n\n<p>It's curious that you're on such an old system. However, that simply means you probably won't write code with the <code>n$</code> notations in it, so it is one less thing to worry about.  The multi-threading issue is less likely to be a problem either.  And you can't use the other C99 features that were shown in my sample code.</p>\n\n<p>You could look at the FFI (foreign function interface) library; I'm not at all sure it will help, though.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512590419, "post_id": 47679416, "comment_id": 82324193, "body": "You need to use <code>strlen()</code> or something similar rather than just 10 in the call to <code>malloc()</code>.  And you need to allow for the size of the number in <code>a</code>; if it is a 9-digit number, you need to add more than 9 to the memory allocation.  Integers could be 10 digits plus a sign, so <code>char *new_format = malloc(strlen(fmt) + 11);</code> would probably be OK (there are 2 extra characters for the %d that was removed.  Note, though, that people are inventive and the <code>%d</code> won&#39;t necessarily be first characters in the string.  Be cautious!"}], "tags": [], "owner": {"reputation": 1, "user_id": 9062154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd32ea3f6678b9f8844b6ed62311a0ab?s=128&d=identicon&r=PG&f=1", "display_name": "Zingfrid", "link": "https://stackoverflow.com/users/9062154/zingfrid"}, "is_accepted": true, "score": 0, "last_activity_date": 1512578828, "creation_date": 1512578828, "answer_id": 47679416, "question_id": 47676372, "link": "https://stackoverflow.com/questions/47676372/print-one-more-parameter-with-va-args/47679416#47679416", "title": "Print one more parameter with va_args", "body": "<p>Based on <a href=\"https://stackoverflow.com/a/47677355/9062154\">previous answer</a> to parse format, I've found a simple solution (if <code>%d</code> is always first):</p>\n\n<pre><code> void func (int a, char *fmt, ...) {\n    char *new_format = malloc(10*sizeof(char));\n    snprintf(new_format, 10, \"%d\", a);\n    strcat(new_format, (fmt+2));\n    va_list ap;\n    va_start (ap, fmt);\n    vprintf(stdout, new_format, ap);\n    va_end(ap);\n}\n</code></pre>\n\n<p>Special Thanks to <a href=\"https://stackoverflow.com/users/15168/jonathan-leffler\">Jonathan Leffler</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9062154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd32ea3f6678b9f8844b6ed62311a0ab?s=128&d=identicon&r=PG&f=1", "display_name": "Zingfrid", "link": "https://stackoverflow.com/users/9062154/zingfrid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 47679416, "answer_count": 3, "score": 0, "last_activity_date": 1512591447, "creation_date": 1512569649, "last_edit_date": 1512571159, "question_id": 47676372, "link": "https://stackoverflow.com/questions/47676372/print-one-more-parameter-with-va-args", "title": "Print one more parameter with va_args", "body": "<p>I have a function which implements a custom variant of <code>printf</code>.\nDoes anyone have a clue how I can print out one more parameter with <code>va_list</code>? My format is like <code>\"%d some text %s\"</code>. I need <code>a</code>, to be printed as first parameter.</p>\n\n<pre><code>void func (int a, char *fmt, ...) {\n    va_list ap;\n    va_start (ap, fmt);\n    // vprintf(stdout, fmt, a, ap) //Can't do like this :( \n    vfprintf(fmt, a, ap);          //Or like this :( \n    va_end(ap);\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "windows-console"], "comments": [{"owner": {"reputation": 9884, "user_id": 2035029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b0a22963bc260b4beff6f99b98df44?s=128&d=identicon&r=PG&f=1", "display_name": "Dirk", "link": "https://stackoverflow.com/users/2035029/dirk"}, "edited": false, "score": 2, "creation_date": 1512569900, "post_id": 47676350, "comment_id": 82311703, "body": "You probably have to use the defines before you include the <code>windows.h</code>."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1512569969, "post_id": 47676350, "comment_id": 82311759, "body": "You do need the defines before including Windows.h, and <code>#define NTDDI_WIN7 as 0x06010000</code> is not correct syntax. <a href=\"https://ideone.com/DP1j6j\" rel=\"nofollow noreferrer\">ideone.com/DP1j6j</a>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1512570014, "post_id": 47676350, "comment_id": 82311791, "body": "The linked documentation implies pretty clearly that the macros affect parsing of the headers, hence must be available before <code>#include</code>ing them."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1512577754, "post_id": 47676350, "comment_id": 82317252, "body": "You meant to define <code>NTDDI_VERSION</code>, not one of the constant values it can be defined as (i.e. <code>#define NTDDI_VERSION NTDDI_WIN7</code> ). Define this macro if you&#39;re targeting a specific service pack. Otherwise let the headers define it based on the value of  <code>_WIN32_WINNT</code>. For the latter, unless you&#39;re actually targeting ancient Windows 2000 (i.e. <code>_WIN32_WINNT_WIN2K</code>, i.e. 0x0500), then you&#39;ll want to use a more recent version, or the default value from the SDK. Windows 2000 is just the minimum version required for <code>GetConsoleWindow</code> in the wincon.h header."}, {"owner": {"reputation": 4917, "user_id": 1850797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4045b3bec181efb7c141a9416a0bed?s=128&d=identicon&r=PG", "display_name": "Edward Clements", "link": "https://stackoverflow.com/users/1850797/edward-clements"}, "edited": false, "score": 0, "creation_date": 1512578876, "post_id": 47676350, "comment_id": 82317938, "body": "also: the &quot;as&quot; needs to be deleted in the <code>#define</code>s"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1512591010, "post_id": 47676350, "comment_id": 82324538, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 2, "last_activity_date": 1512579805, "creation_date": 1512579805, "answer_id": 47679712, "question_id": 47676350, "link": "https://stackoverflow.com/questions/47676350/undefined-reference-to-getconsolewindow/47679712#47679712", "title": "Undefined reference to GetConsoleWindow", "body": "<p>You have to have kernel32.lib in your list of input libraries.</p>\n"}], "owner": {"reputation": 9, "user_id": 6481269, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/11cea488aa8d9dd7f8e9b48eb145b60f?s=128&d=identicon&r=PG&f=1", "display_name": "Linz", "link": "https://stackoverflow.com/users/6481269/linz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1512579805, "creation_date": 1512569584, "last_edit_date": 1512578190, "question_id": 47676350, "link": "https://stackoverflow.com/questions/47676350/undefined-reference-to-getconsolewindow", "title": "Undefined reference to GetConsoleWindow", "body": "<p>I am trying to get a handle for the console window with the following:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define NTDDI_WIN7 as 0x06010000\n#define _WIN32_WINNT as 0x0500\n\nint main(int argc, char *argv[]) {\n    HWND self = GetConsoleWindow();\n    /* some more code */\n    return 0;\n}\n</code></pre>\n\n<p>I followed the instructions from the <a href=\"https://docs.microsoft.com/en-us/windows/console/getconsolewindow\" rel=\"nofollow noreferrer\"><code>GetConsoleWindow</code></a> documentation and <a href=\"https://msdn.microsoft.com/library/windows/desktop/aa383745\" rel=\"nofollow noreferrer\">\"Using the Windows Headers\"</a>, but I still get:</p>\n\n<blockquote>\n  <p>undefined reference to `GetConsoleWindow'</p>\n</blockquote>\n"}, {"tags": ["mysql", "c", "mysqli", "mysql-workbench", "mysql-connector"], "comments": [{"owner": {"reputation": 3003, "user_id": 7644018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yE50W.png?s=128&g=1", "display_name": "Paul T.", "link": "https://stackoverflow.com/users/7644018/paul-t"}, "edited": false, "score": 0, "creation_date": 1512607885, "post_id": 47676260, "comment_id": 82331524, "body": "Could be named <code>my_load_defaults()</code>?  There was apparently a race condition with <code>load_defaults()</code>, based on <a href=\"https://bugs.mysql.com/bug.php?id=40552\" rel=\"nofollow noreferrer\">this info old bug information</a>. Search the page for <code>load_defaults</code> to follow the details."}, {"owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "edited": false, "score": 0, "creation_date": 1578449987, "post_id": 47676260, "comment_id": 105439389, "body": "In mariadb it has been renamed to <code>mariadb_load_defaults</code>, but it&#39;s implementation can not be found. I got <code>undefined reference to &#39;mariadb_load_defaults&#39;</code> when linking."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4948350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LZDq8.jpg?s=128&g=1", "display_name": "Adoni Aamir", "link": "https://stackoverflow.com/users/4948350/adoni-aamir"}, "edited": false, "score": 0, "creation_date": 1512658067, "post_id": 47690346, "comment_id": 82354986, "body": "MySQL Developers didnt mention the substitute for this function in their manual. Where to find it? It is also no more in my_sys.h header file."}, {"owner": {"reputation": 36245, "user_id": 1137174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/361fd9b1b32d13cd1c1dc03e5c6a2127?s=128&d=identicon&r=PG", "display_name": "Mike Lischke", "link": "https://stackoverflow.com/users/1137174/mike-lischke"}, "reply_to_user": {"reputation": 1, "user_id": 4948350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LZDq8.jpg?s=128&g=1", "display_name": "Adoni Aamir", "link": "https://stackoverflow.com/users/4948350/adoni-aamir"}, "edited": false, "score": 0, "creation_date": 1512661527, "post_id": 47690346, "comment_id": 82357295, "body": "Then my assumption seems still be correct. It&#39;s no longer available."}, {"owner": {"reputation": 1, "user_id": 4948350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LZDq8.jpg?s=128&g=1", "display_name": "Adoni Aamir", "link": "https://stackoverflow.com/users/4948350/adoni-aamir"}, "edited": false, "score": 0, "creation_date": 1512800569, "post_id": 47690346, "comment_id": 82412458, "body": "What is the solution instead of using load_defaults() on 09-12-2017?"}, {"owner": {"reputation": 36245, "user_id": 1137174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/361fd9b1b32d13cd1c1dc03e5c6a2127?s=128&d=identicon&r=PG", "display_name": "Mike Lischke", "link": "https://stackoverflow.com/users/1137174/mike-lischke"}, "reply_to_user": {"reputation": 1, "user_id": 4948350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LZDq8.jpg?s=128&g=1", "display_name": "Adoni Aamir", "link": "https://stackoverflow.com/users/4948350/adoni-aamir"}, "edited": false, "score": 0, "creation_date": 1512814944, "post_id": 47690346, "comment_id": 82415588, "body": "There is no solution. I talked with the responsible people. This function is considered to be internal. It&#39;s still exported by the client lib, but meant to be used by MySQL software only (the declaration has been removed from the public C API and is exposed only by an internal header). It shouldn&#39;t be used outside, can change at any time and no promise is made that it will do what you expect. Better get away without it."}], "tags": [], "owner": {"reputation": 36245, "user_id": 1137174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/361fd9b1b32d13cd1c1dc03e5c6a2127?s=128&d=identicon&r=PG", "display_name": "Mike Lischke", "link": "https://stackoverflow.com/users/1137174/mike-lischke"}, "is_accepted": false, "score": 0, "last_activity_date": 1512633991, "creation_date": 1512633991, "answer_id": 47690346, "question_id": 47676260, "link": "https://stackoverflow.com/questions/47676260/what-is-new-name-of-load-defaults-function-in-mysql-c-api/47690346#47690346", "title": "What is new name of load_defaults() function in mysql c api?", "body": "<p><code>load_defaults</code> was never meant to be used outside of the client lib. It had therefore been removed from the library exports. I assumed this would still be the case, but then I found: <a href=\"https://bugs.mysql.com/bug.php?id=25535\" rel=\"nofollow noreferrer\">https://bugs.mysql.com/bug.php?id=25535</a>, which seems to indicate this function has been renamed and re-exported. Didn't check this myself, though .</p>\n"}], "owner": {"reputation": 1, "user_id": 4948350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LZDq8.jpg?s=128&g=1", "display_name": "Adoni Aamir", "link": "https://stackoverflow.com/users/4948350/adoni-aamir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512633991, "creation_date": 1512569279, "question_id": 47676260, "link": "https://stackoverflow.com/questions/47676260/what-is-new-name-of-load-defaults-function-in-mysql-c-api", "title": "What is new name of load_defaults() function in mysql c api?", "body": "<p>What is new name of load_defaults() function in mysql c api?</p>\n\n<p>I tried the following code from this link (<a href=\"http://www.kitebird.com/mysql-book/ch06-2ed.pdf\" rel=\"nofollow noreferrer\">http://www.kitebird.com/mysql-book/ch06-2ed.pdf</a>). I am using MySQL 5.7 and Visual Studio 2013 on Windows 7/64bit. The load_defaults() function no more exists. There is no documentation on it. What is the new name of load_defaults() function?</p>\n\n<pre><code>#include &lt;my_global.h&gt;\n#include &lt;sql.h&gt;\n#include &lt;my_sys.h&gt; //#include &lt;my_getopt.h&gt;\n\nstatic const char *client_groups[] = { \"show_argv\",\"client\", NULL };\n\nint main(int argc, char *argv[]) {  int i;\n\n    printf(\"Original argument vector:\\n\");  for (i = 0; i &lt; argc; i++)      printf(\"arg %d: %s\\n\", i, argv[i]);\n\n    my_init();  my_load_defaults(\"my\", client_groups, &amp;argc, &amp;argv);\n\n    printf(\"Modified argument vector:\\n\");  for (i = 0; i &lt; argc; i++)      printf(\"arg %d: %s\\n\", i, argv[i]);         exit(0); }\n</code></pre>\n"}, {"tags": ["c", "performance", "parsing"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1512569986, "post_id": 47676197, "comment_id": 82311771, "body": "The label and goto statement are undesirable; it is not clear that they&#39;re needed.  You could perfectly well use <code>for (;;)</code> or <code>while (1)</code> around the body of the label/goto loop.  You should not ignore the return value from <code>fread()</code>; it tells you how much, if any, data was read.  You cannot write reliable code if you ignore that return value."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1512570028, "post_id": 47676197, "comment_id": 82311806, "body": "What does <code>ParseHHT2_HH2(buffer-&gt;records[buffer-&gt;head], channel, timetag, oflcorrection);</code> do?  BTW: passing and dereferencing the pointers looks costly."}, {"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512570635, "post_id": 47676197, "comment_id": 82312229, "body": "@JonathanLeffler I liked more how the goto statement looked nothing else. With respect to the return value of fread, the header of the file contains how many records it contains. So the StopRecord avoids the problem of trying to read more records than available."}, {"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1512570846, "post_id": 47676197, "comment_id": 82312361, "body": "@wildplasser ParseHHT2_HH2 takes a 32bit record from the buffer and puts into channel and timetag the channel at which it was detected and the time of arrival. Oflcorrection takes care of the time overflows in the timetags. I will edit the question adding the parsing function."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1512570857, "post_id": 47676197, "comment_id": 82312373, "body": "You are supposing, @GuillemB, that your files are always well formed and that no I/O errors occur.  Neither of those is a safe assumption.  Check the return values of your function calls."}, {"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1512571876, "post_id": 47676197, "comment_id": 82313075, "body": "@JonathanLeffler and JohnBollinger. You are right of course, I was obsessed with trying to make it go fast that I thought another if would kill me. Of course it doesn&#39;t as it is called very infrequently. On that topic, the cost of the if clause on the channel conditions is huge. By eliminating and (of course killing the algorithms that come after) I bump my parsing speed by a factor 2 on a trivial function that only reads the total number of photons in the file.."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512572136, "post_id": 47676197, "comment_id": 82313303, "body": "@GuillemB, yes, indirect accesses (via pointers) are likely to be far more costly than direct ones, especially to local variables."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1512572363, "post_id": 47676197, "comment_id": 82313467, "body": "Also: the amount of conditions inside the main loop (plus the amount of <i>active expressions</i>) will effectively trash the branch prediction. In any case: profile &amp; check the generated assembler source."}, {"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "edited": false, "score": 1, "creation_date": 1512573179, "post_id": 47676197, "comment_id": 82314094, "body": "I was assuming that the branch predictor was completely thrased. For a typical experiment overlfow records, channel 0 and channel 1 photons are in a ratio of 1:1.5:1.5 and going into either channel 0 and channel 1 is a true random process. I tried using the clang __builtin_unpredictable to mark the random ifs but it made little to no difference."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1512581064, "post_id": 47676197, "comment_id": 82319327, "body": "Have you tested your performance without the data processing, i.e. don&#39;t call <code>ParseHHT2_HH2</code> but just add all the 32 bit values together (or some other simple low cost action). This will tell you how much you can expect from the file system."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1512588030, "post_id": 47676197, "comment_id": 82322904, "body": "<code>Now I am reading the file in chunks of 1024 records</code> --&gt;&gt; increment your buffer size to <b>at least</b> a few MB."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512570696, "post_id": 47676679, "comment_id": 82312269, "body": "Except it seems clear that the OP&#39;s code is <i>not</i> I/O bound, for he sees a substantial speedup from parallelizing the analysis, and even then he is not (he thinks) saturating his I/O bandwidth."}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512570887, "post_id": 47676679, "comment_id": 82312391, "body": "How come you can be 100% sure about that? Optimizing SSD access is not that trivial. We don&#39;t know the choice of <code>RECORD_CHUNK</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512571248, "post_id": 47676679, "comment_id": 82312651, "body": "That parallelizing the analysis increases the throughput by a factor of 3 shows that the analysis cost is of the same order of magnitude as the I/O cost.  If the program were strictly I/O bound then speeding the analysis part would not significantly improve overall throughput."}, {"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "edited": false, "score": 0, "creation_date": 1512572659, "post_id": 47676679, "comment_id": 82313710, "body": "For a 1,5 GB file the whole thing is parsed on 3 seconds for the single threaded program. If I just return from the parsing function and skip the actual parsing it takes around 0.9 seconds. The simpler algorithms used to analyze the data do take 3 seconds. The RECORD chunk is 1024 and each record is 4 bytes so I&#39;m reading 4kB chunks. Any multiple of 1024 give me a similar performance."}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512577677, "post_id": 47676679, "comment_id": 82317199, "body": "@JohnBollinger: Well, it could be that the threading speeded up the read performance. But since <code>fread</code> does cached reading (cached by the OS), you are right I guess. With <code>O_DIRECT</code>, situation would be completely different. What I actually wanted to say: just make sure that with just the fread you can reach the max read bandwidth of your disk. But probably he can."}, {"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "edited": false, "score": 1, "creation_date": 1512578434, "post_id": 47676679, "comment_id": 82317668, "body": "@PedramAzad I know there are a lot of branches... I made an almost branchless parser. See edit above. This doesn&#39;t produce to my surprise any speedup. The only thing that seems to make a difference is getting rid of the ifs in the next_photon function. That&#39;s why I would like to have a more abstract answer in terms of how computation could be rearranged to possibly use SIMD plus the chunking."}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512580582, "post_id": 47676679, "comment_id": 82319043, "body": "I guess the statistic of the flags/data in your file is the reason that removing those ifs doesn&#39;t change much (those are nested compared to the ones in <code>next_photon</code>, which are always evaluated). I still have to say, I wouldn&#39;t concentrate on SIMD here that much. Btw, four threads because you only have four cores on your CPU? Decoupling reading from processing as suggested by @JohnBollinger could help in fact."}, {"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1512581352, "post_id": 47676679, "comment_id": 82319518, "body": "I&#39;m coding a 2 core i7 machine. From 1 thread to 2 there is a big speed going from 2 to 4 gets you a bit less than a 20% over the 2 thread case. I have some trouble on seeing how @JohnBollinger &#39;s would be implemented. As I understand it I would reserve one thread for reading from the file and use the others for computation. I don&#39;t understand why this would be better than having the 4 threads work on 4 separate sections of the file. Could you help me understand?"}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "edited": false, "score": 0, "creation_date": 1512587547, "post_id": 47676679, "comment_id": 82322630, "body": "Good point. Now that I think about it, I don&#39;t see that either."}], "tags": [], "owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "is_accepted": false, "score": 0, "last_activity_date": 1512594474, "last_edit_date": 1512594474, "creation_date": 1512570544, "answer_id": 47676679, "question_id": 47676197, "link": "https://stackoverflow.com/questions/47676197/fast-binary-parser-algorithm/47676679#47676679", "title": "Fast binary parser algorithm", "body": "<p>I/O is very likely to dominate the runtime of your function. That said, you should first measure the speed without parsing, i.e. just the <code>fread</code>. Probably it won't differ that much to the speed including parsing.</p>\n\n<p>If so, you can concentrate on optimizing that bottleneck first. Look into the linux tool <code>fio</code>, in particular with different <code>--ioenginge=</code> (also libaio). In case you are using an NVMe disk, look into the Intel SPDK.</p>\n\n<p>Apart from that, you can optimize the parsing further. You can avoid both the <code>(*RecNum)++</code> and more importantly the first if-clause within the loop, since after the <code>fread</code> you know how many records you will read, so you can use that information.</p>\n\n<p>Furthermore, I would not iterate over <code>buffer-&gt;head</code> but use a local variable for that, using a for-loop.</p>\n\n<p>I also would use a local variable for <code>*RecNum</code> and only at the end assign to <code>*RecNum</code>. If you are aiming at parallel writing to <code>*RecNum</code>, your code would be buggy anyways, because neither your increment nor your read uses an atomic operation.</p>\n\n<p>Not until then you should start thinking about SSE or AVX. If you have mostly zeroes in <code>*channel</code>, you could use SSE/AVX to check 16 or more bytes at once for greater or equal zero.</p>\n\n<p>Update:<br>\nNow after you providing the code of your parse function, I can see that situation is different. Many branches there...</p>\n\n<p>Update:<br>\nHere is an implementation of the optimizations for <code>next_photon</code> that I mean. If <code>buffer-&gt;head == 0</code> is guaranteed when entering <code>next_photon</code>, it can be simplified. And I assume you don't check the return value of <code>fread</code> on purpose, because you want to handle that with <code>StopRecord</code> only. So I left it like that even though it's not safe.</p>\n\n<pre><code>static inline bool next_photon(FILE* filehandle, uint64_t *RecNum,\n                            uint64_t StopRecord, record_buf_t *buffer,\n                            uint64_t *oflcorrection, uint64_t *timetag,\n                            int *channel)\n{\n    int recNum = *RecNum;\n    int i = buffer-&gt;head;\n\n    while (true) {\n        int records;\n        bool quit;\n\n        if (StopRecord - recNum &lt;= RECORD_CHUNK - i) {\n            records = i + StopRecord - recNum;\n            quit = true;\n        } else {\n            records = RECORD_CHUNK;\n            quit = false;\n        }\n\n        const int i0 = i;\n\n        for (; i &lt; records; i++) { // still have records on buffer\n            ParseHHT2_HH2(buffer-&gt;records[i], channel, timetag, oflcorrection);\n\n            if (*channel &gt;= 0) { // found a photon\n                *RecNum = recNum + i - i0 + 1;\n                buffer-&gt;head = i + 1;\n                return true;\n            }\n        }\n\n        recNum += records - i0;\n\n        if (quit) {\n            break;\n        }\n\n        // run out of buffer\n        i = 0;\n        fread(buffer-&gt;records, RECORD_CHUNK, sizeof(uint32_t), filehandle);    \n    }\n\n    *RecNum = recNum;\n    buffer-&gt;head = i;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 253, "user_id": 2676533, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Hk6Bc.png?s=128&g=1", "display_name": "recp", "link": "https://stackoverflow.com/users/2676533/recp"}, "is_accepted": false, "score": 0, "last_activity_date": 1512570954, "creation_date": 1512570954, "answer_id": 47676827, "question_id": 47676197, "link": "https://stackoverflow.com/questions/47676197/fast-binary-parser-algorithm/47676827#47676827", "title": "Fast binary parser algorithm", "body": "<p>You are accessing to disk in loop and I don't think SIMD will help too much there, you could use mmap. </p>\n\n<p>Check these answers:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/258091/when-should-i-use-mmap-for-file-access/258097#258097\">When should I use mmap for file access?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/3002122/fastest-file-reading-in-c\">Fastest file reading in C</a></p>\n\n<p>but you could also use SIMD (SSE/AVX/NEON) for other parts e.g in parsing code</p>\n"}, {"comments": [{"owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "edited": false, "score": 1, "creation_date": 1512573496, "post_id": 47677132, "comment_id": 82314330, "body": "As an example of a more complex analysis of the file is for example computing correlations in between the arrival time of photons in both channels. This amounts to computing the delta between times of arrivals and putting it into a histogram. The 4 threaded version of this algorithm takes 1.4 seconds (again for the 1.5 GB file) compared to 1 second for the counting photons function (with 4 threads). I was very surprised by the fact that eliminating the  if(*channel&gt;=0) boosted the speed of the count_photon function to 0.6 seconds."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1512571855, "creation_date": 1512571855, "answer_id": 47677132, "question_id": 47676197, "link": "https://stackoverflow.com/questions/47676197/fast-binary-parser-algorithm/47677132#47677132", "title": "Fast binary parser algorithm", "body": "<p>That speeding the data analysis by parallelizing it has such a dramatic effect on your program's throughput shows that the data analysis cost is of the same order of magnitude as the I/O cost.  Therefore, if you want to improve its throughput to be closer to the limit imposed by your available I/O bandwidth, the best course of action would probably be to perform analysis and I/O in parallel.</p>\n\n<p>You can do that by maintaining two separate I/O buffers, processing one while you read into the other, and then flipping.</p>\n"}], "owner": {"reputation": 271, "user_id": 938530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6920c523fa3a514678522209dc6d50fc?s=128&d=identicon&r=PG", "display_name": "GuillemB", "link": "https://stackoverflow.com/users/938530/guillemb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1512594474, "creation_date": 1512569066, "last_edit_date": 1512578717, "question_id": 47676197, "link": "https://stackoverflow.com/questions/47676197/fast-binary-parser-algorithm", "title": "Fast binary parser algorithm", "body": "<p>\nI'm writing a parser for binary files. The data is stored in consecutive 32 bit records. The files only have to be read once and as this is done it is fed into the analysis algorithm.</p>\n\n<p>Now I am reading the file in chunks of 1024 records to avoid as much of the overhead from calling fread more frequently than necessary as possible. In the example below I use oflcorrection, timetag and channel as outputs for the algorithms and use the bool return value to check if the algorithm should stop. Also note that not all the records contain photons just those with positive values.</p>\n\n<p>With this approach I can process  at up to 0.5GBps or 1.5 GBps  if I use the threaded version of the algorithms which break the file into pieces. I know my SSD can read at least a 40% faster. I was thinking of using SIMD to parse several records in parallel but I don't know how to do it with the conditional return clauses.</p>\n\n<p>Do you know any other approach that would allow me to combine chunked reading and SIMD? Is there in general a better way of doing it?</p>\n\n<p>Thanks</p>\n\n<p>P.S. The records correspond to either photons arriving to detectors after going through a beam splitter or a special record that indicates an overflow condition. The latter is needed because Timetags are stored with picosecond resolution in uint64_t.</p>\n\n\n\n<pre><code> static inline bool next_photon(FILE* filehandle, uint64_t * RecNum,\n                               uint64_t StopRecord, record_buf_t *buffer,\n                               uint64_t *oflcorrection, uint64_t *timetag, int *channel)\n{\n    pop_record:\n    while (__builtin_unpredictable(buffer-&gt;head &lt; RECORD_CHUNK)) { // still have records on buffer\n        ParseHHT2_HH2(buffer-&gt;records[buffer-&gt;head], channel, timetag, oflcorrection);\n        buffer-&gt;head++;\n        (*RecNum)++;\n\n        if (*RecNum &gt;= StopRecord) { // run out of records\n            return false;\n        }\n\n        if (*channel &gt;= 0) { // found a photon\n            return true;\n        }\n    }\n    // run out of buffer\n    buffer-&gt;head = 0;\n    fread(buffer-&gt;records, RECORD_CHUNK, sizeof(uint32_t), filehandle);\n    goto pop_record;\n}\n</code></pre>\n\n<p>Please find below the parsing function. Keep in mind that I can't do anything about the file format. Thanks again, Guillem.</p>\n\n<pre><code>static inline void ParseHHT2_HH2(uint32_t record, int *channel,\n                                 uint64_t *timetag, uint64_t *oflcorrection)\n{\n    const uint64_t T2WRAPAROUND_V2 = 33554432;\n    union{\n        uint32_t   allbits;\n        struct{ unsigned timetag  :25;\n            unsigned channel  :6;\n            unsigned special  :1;\n        } bits;\n    } T2Rec;\n\n    T2Rec.allbits = record;\n\n    if(T2Rec.bits.special) {\n        if(T2Rec.bits.channel==0x3F) {  //an overflow record\n            if(T2Rec.bits.timetag!=0) {\n                *oflcorrection += T2WRAPAROUND_V2 * T2Rec.bits.timetag;\n            }\n            else {  // if it is zero it is an old style single overflow\n                *oflcorrection += T2WRAPAROUND_V2;  //should never happen with new Firmware!\n            }\n            *channel = -1;\n        } else if(T2Rec.bits.channel == 0) {  //sync\n            *channel = 0;\n        } else if(T2Rec.bits.channel&lt;=15) {  //markers\n            *channel = -2;\n        }\n    } else {//regular input channel\n        *channel = T2Rec.bits.channel + 1;\n    }\n    *timetag = *oflcorrection + T2Rec.bits.timetag;\n}\n</code></pre>\n\n<p>I came up with an almost branchless parsing function, but it doesn't produce any speed up.</p>\n\n<pre><code>if(T2Rec.bits.channel==0x3F) {  //an overflow record\n        *oflcorrection += T2WRAPAROUND_V2 * T2Rec.bits.timetag;\n    }\n    *channel = (!T2Rec.bits.special) * (T2Rec.bits.channel + 1) - T2Rec.bits.special * T2Rec.bits.channel;\n    *timetag = *oflcorrection + T2Rec.bits.timetag;\n}\n</code></pre>\n\n\n\n\n"}, {"tags": ["c", "arrays", "malloc", "free"], "comments": [{"owner": {"reputation": 904, "user_id": 2405101, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/24c8b950afd89b7a00efda2c9703774c?s=128&d=identicon&r=PG", "display_name": "Nepho", "link": "https://stackoverflow.com/users/2405101/nepho"}, "edited": false, "score": 2, "creation_date": 1512568413, "post_id": 47675965, "comment_id": 82310731, "body": "Why are you saying that you cannot do this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5471256"}, "edited": false, "score": 0, "creation_date": 1512569753, "post_id": 47675965, "comment_id": 82311600, "body": "if you are trying to create the Fibonacci numbers i think you will get to negative index quite fast with this code values[i] = values[i - values[i - 1]] + values[i - values[i - 2]] say when you get to i = 6 that is you will get values[6] = values[6 - 8] + values[6 - 5] = values[-2] + values[1]. you have to do it like values[i] = values[i - 1] + values[i - 2];"}, {"owner": {"reputation": 5, "user_id": 8554446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d44e589670eb4cba73a65f39e876fcc?s=128&d=identicon&r=PG&f=1", "display_name": "qblacksheep", "link": "https://stackoverflow.com/users/8554446/qblacksheep"}, "edited": false, "score": 0, "creation_date": 1512571163, "post_id": 47675965, "comment_id": 82312589, "body": "It&#39;s not Fibonacci number, it&#39;s similar to Fib: u(n - u(n - 1)) + u(n -u(n - 2)). For i =6 i have values[6] = values[6-values[5]] + values[6-values[4]] where values[5] =3 and values[4] = 3 so i will not have negative index. values[3] = values[n-values[2]] + values[n-values[1]] = values[3-1] + values [3-2] = 1+1 = 2"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8554446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d44e589670eb4cba73a65f39e876fcc?s=128&d=identicon&r=PG&f=1", "display_name": "qblacksheep", "link": "https://stackoverflow.com/users/8554446/qblacksheep"}, "edited": false, "score": 0, "creation_date": 1512570147, "post_id": 47676025, "comment_id": 82311886, "body": "thanks! what a misstake from me, shame:D. Thanks for very helpfull explain."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1512568545, "creation_date": 1512568545, "answer_id": 47676025, "question_id": 47675965, "link": "https://stackoverflow.com/questions/47675965/c-free-int-array-in-function-after-writing-value-to-other-variable/47676025#47676025", "title": "C free int array in function after writing value to other variable", "body": "<p>Remember that <code>sizeof(int)*n + 1</code> is equal to <code>(sizeof(int)*n) + 1</code>. You allocate space for <code>n</code> integer values, plus one <strong><em>byte</em></strong>.</p>\n\n<p>That means your loop in the <code>else</code> case <em>will</em> write out of bounds (unless <code>sizeof(int) == 1</code> which few if any platforms have, even historically). And writing out of bounds of allocated memory leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n\n<p>Often, writing out of bounds messes up the private and internal data used by the memory allocator, leading to problems when calling <code>free</code>.</p>\n\n<p>The solution is to either change the allocation so it allocates <code>n + 1</code> integers (i.e. <code>sizeof(int) * (n + 1)</code>). Or to change the loop condition to <code>i &lt; n</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 8554446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d44e589670eb4cba73a65f39e876fcc?s=128&d=identicon&r=PG&f=1", "display_name": "qblacksheep", "link": "https://stackoverflow.com/users/8554446/qblacksheep"}, "edited": false, "score": 0, "creation_date": 1512570666, "post_id": 47676183, "comment_id": 82312247, "body": "1) Its look better, with your sugesstions. Thanks. I correct my code."}, {"owner": {"reputation": 5, "user_id": 8554446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d44e589670eb4cba73a65f39e876fcc?s=128&d=identicon&r=PG&f=1", "display_name": "qblacksheep", "link": "https://stackoverflow.com/users/8554446/qblacksheep"}, "edited": false, "score": 0, "creation_date": 1512570829, "post_id": 47676183, "comment_id": 82312347, "body": "2) It&#39;s a task from CodeWars, i need to implement function similar to fibonacci series: u(n - u(n - 1)) + u(n -u(n - 2))."}], "tags": [], "owner": {"reputation": 2204, "user_id": 7000960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WguQ0.jpg?s=128&g=1", "display_name": "farbiondriven", "link": "https://stackoverflow.com/users/7000960/farbiondriven"}, "is_accepted": false, "score": 0, "last_activity_date": 1512570271, "last_edit_date": 1512570271, "creation_date": 1512569021, "answer_id": 47676183, "question_id": 47675965, "link": "https://stackoverflow.com/questions/47675965/c-free-int-array-in-function-after-writing-value-to-other-variable/47676183#47676183", "title": "C free int array in function after writing value to other variable", "body": "<p>Have a look to the comments.</p>\n\n<pre><code>int u(int n)\n   {\n    if (n &lt; 3)  // moved it here. If n it's smaller you have a smaller array; move it ahead of malloc/free\u2019s\n       return 1;\n    int* values = (int*)malloc(sizeof(int)*(n + 1));\n    int out = 0;\n    for (int i = 0; i &lt;= n; i++)\n    {\n       if(i&lt;3) \n          values[i] = 1;\n       else\n          values[i] = values[i - values[i - 1]] + values[i - values[i - 2]]; // this is suspicious; what do you want to obtain ?\n    }\n\n    out = values[n];\n    if(values!=NULL)\n       free(values);\n    return out;\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8554446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d44e589670eb4cba73a65f39e876fcc?s=128&d=identicon&r=PG&f=1", "display_name": "qblacksheep", "link": "https://stackoverflow.com/users/8554446/qblacksheep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 1, "accepted_answer_id": 47676025, "answer_count": 2, "score": 0, "last_activity_date": 1512570271, "creation_date": 1512568327, "question_id": 47675965, "link": "https://stackoverflow.com/questions/47675965/c-free-int-array-in-function-after-writing-value-to-other-variable", "title": "C free int array in function after writing value to other variable", "body": "<p>i want to free memory allocated to int array in function after assign value from array element to integer variable.</p>\n\n<p>I have code:</p>\n\n<pre><code> int u(int n)\n   {\n    int* values = (int*)malloc(sizeof(int)*n + 1);\n    int out = 0;\n    for (int i = 0; i &lt; 3; i++) \n      values[i] = 1;\n    if (n &lt; 3) \n      return 1;\n    else \n    {\n        for (int i = 3; i &lt;= n; i++)\n            values[i] = values[i - values[i - 1]] + values[i - values[i - 2]];\n    }\n    out = values[n];\n    free(values);\n    return out;\n}\n</code></pre>\n\n<p>Why cant i free memory allocated to array after write a value to another variable? \nint out have another adress then allocated memory, all what i want to do its just give a value from array to another variable. Can somebody explain me why i cannot do it?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1512568008, "post_id": 47675824, "comment_id": 82310470, "body": "There is no correct answer as different compilers do this differently."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 6, "creation_date": 1512568019, "post_id": 47675824, "comment_id": 82310477, "body": "Yes there is. A compiler is a general term for something that takes a thing in a source language and produces something in a target language. Both source and target can generally be anything."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1512568023, "post_id": 47675824, "comment_id": 82310479, "body": "In general, a compiler converts one language to another."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1512568035, "post_id": 47675824, "comment_id": 82310496, "body": "Refer to authoritative links, whether provided in SO answers or those you find elsewhere. SO is not authoritative by definition."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1512568200, "post_id": 47675824, "comment_id": 82310595, "body": "Some compilers can do both.  That is, they can compile a source language to either assembly code or machine code, or even to both in the same run."}, {"owner": {"reputation": 260, "user_id": 5256754, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204330603619413/picture?type=large", "display_name": "Muhammad Haroon", "link": "https://stackoverflow.com/users/5256754/muhammad-haroon"}, "edited": false, "score": 0, "creation_date": 1512568468, "post_id": 47675824, "comment_id": 82310758, "body": "with exam point of view, compiler generated code is ?. Object code or Assembly code. I guess both."}, {"owner": {"reputation": 260, "user_id": 5256754, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204330603619413/picture?type=large", "display_name": "Muhammad Haroon", "link": "https://stackoverflow.com/users/5256754/muhammad-haroon"}, "edited": false, "score": 0, "creation_date": 1512569009, "post_id": 47675824, "comment_id": 82311128, "body": "nicomp, will you please suggest some links"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1512569258, "post_id": 47675824, "comment_id": 82311269, "body": "@MuhammadHaroon <a href=\"https://en.wikipedia.org/wiki/Cfront\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Cfront</a> Original C++ compiler, compiled C++ to C  Also 2 mins with Google will get you the definition of a Compiler."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1512569422, "post_id": 47675824, "comment_id": 82311374, "body": "Not peer-reviewed but published by a professor who teaches graduate-level compiler theory at a nationally accredited college: <a href=\"https://lambda.uta.edu/cse5317/notes/node3.html\" rel=\"nofollow noreferrer\">lambda.uta.edu/cse5317/notes/node3.html</a> , also here is a book from one of courses I took in grad school co-written by one of the biggest names in compilers:  <a href=\"https://books.google.com/books/about/Compilers.html?id=dIU_AQAAIAAJ\" rel=\"nofollow noreferrer\">books.google.com/books/about/Compilers.html?id=dIU_AQAAIAAJ</a>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1512569622, "post_id": 47675824, "comment_id": 82311516, "body": "And then you&#39;ll reach the rather tautologous but alas not particularly helpful conclusion that &quot;source code -&gt; compiler -&gt; compiled code&quot;. The latter is said to be runnable in a &quot;target&quot; environment."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 5, "creation_date": 1512569639, "post_id": 47675824, "comment_id": 82311528, "body": "@nicomp Just because some professor said something in an introductory course doesn&#39;t make it correct or &quot;authoritative&quot;. The widely used definition for a compiler is something that translates between two programming languages, not just into machine language as claimed by that link."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1512569949, "post_id": 47675824, "comment_id": 82311749, "body": "In general, a &quot;translator&quot; is a program which takes a source program in a &quot;source&quot; language and generates an equivalent program in a different &quot;target&quot; language. A &quot;compiler&quot; is a translator which translates a source program in a higher level language to an equivalent program in a lower level language. The target language can be the machine language of a real processor, but quite often, the target language is assembly language or byte code."}, {"owner": {"reputation": 260, "user_id": 5256754, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204330603619413/picture?type=large", "display_name": "Muhammad Haroon", "link": "https://stackoverflow.com/users/5256754/muhammad-haroon"}, "edited": false, "score": 0, "creation_date": 1512573210, "post_id": 47675824, "comment_id": 82314113, "body": "as for as I understood, it depends on the compiler. Some compiler generate object code, some Assembly code and some can generate both. While generating machine code is the responsibility of Linker."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1512585467, "post_id": 47675824, "comment_id": 82321586, "body": "@interjay what&#39;s your point? Are you simply looking for an argument?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1512587054, "post_id": 47675824, "comment_id": 82322369, "body": "@nicomp Huh? I just said that wasn&#39;t a good link to post because its definition for compiler isn&#39;t the usual one (and contradicts the definition given in the dragon book). No need to be so combative about it."}], "answers": [{"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": true, "score": 3, "last_activity_date": 1512571096, "last_edit_date": 1512571096, "creation_date": 1512570055, "answer_id": 47676506, "question_id": 47675824, "link": "https://stackoverflow.com/questions/47675824/misconception-in-compilers-function/47676506#47676506", "title": "Misconception in Compiler&#39;s function", "body": "<p>Ultimately, the compiler has to somehow produce object files with the code that will end up in the application, and the linker combines the code from object files and libraries (which are just collections of object files) to produce the application. So it's correct to say that the compiler produces object files and the linker combines them.</p>\n\n<p>On the other hand, there are various ways that the compiler can produce the object files. One way is to directly generate object files. Another way is to generate assembler code and run the assembler to produce the object files. That introduces some flexibility, because the compiler doesn't have to know the details of how object files are laid out; the assembler does that. Yet another way is to generate C code and run the C compiler (which could, in turn generate assembler code and run the assembler) on that to produce object files. That's how cfront worked back in the olden days of C++. It's also how some modern compiler front-ends work. For example, Edison Design Group sells a C++ front-end that vendors can hook up to their own back-end for code generation. They also provide a version that generates C code, for use during compiler development when the back-end isn't yet working. Typically in these cases, the compiler will have a switch to keep the C or assembler file around, so you can examine that to see what's going on.</p>\n"}], "owner": {"reputation": 260, "user_id": 5256754, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10204330603619413/picture?type=large", "display_name": "Muhammad Haroon", "link": "https://stackoverflow.com/users/5256754/muhammad-haroon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 47676506, "answer_count": 1, "score": 2, "last_activity_date": 1512571096, "creation_date": 1512567896, "last_edit_date": 1512568264, "question_id": 47675824, "link": "https://stackoverflow.com/questions/47675824/misconception-in-compilers-function", "title": "Misconception in Compiler&#39;s function", "body": "<p>I have studied many articles to understand whether <em>Compiler</em> generates <strong>Object Code</strong> or <strong>Assembly Code</strong> and there is conflict, even in stack overflow. Some says <em>Compiler</em> generates <strong>Object Code</strong> while other says <em>Compiler</em> generates <strong>Assembly Code</strong> which is then converted to <strong>Object Code</strong> by <em>Assembler</em>. Both answers has up-votes. Is there any clarification or justification for this.</p>\n"}, {"tags": ["c", "arrays", "segmentation-fault", "character"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1512567600, "post_id": 47675710, "comment_id": 82310178, "body": "What does the <code>1024</code> do?"}, {"owner": {"reputation": 1586, "user_id": 6225741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f147a4cf533863ff2f12762e3c6192?s=128&d=identicon&r=PG", "display_name": "Nayfe", "link": "https://stackoverflow.com/users/6225741/nayfe"}, "edited": false, "score": 0, "creation_date": 1512567860, "post_id": 47675710, "comment_id": 82310364, "body": "If you want to make dynamic char arrays, you need to use malloc, as in char charArray[number], number is unknown at compile time. char charArray = malloc(number); then free(charArray);"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1512567875, "post_id": 47675710, "comment_id": 82310374, "body": "Take a debugger to see what happens. The code is easy enough and you will learn how to debug your programs."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5471256"}, "edited": false, "score": 0, "creation_date": 1512567917, "post_id": 47675710, "comment_id": 82310402, "body": "you are writing 1024 bytes into a 100 byte buffer, there for destroying the contents of 900+ bytes past the buf object."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 1586, "user_id": 6225741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f147a4cf533863ff2f12762e3c6192?s=128&d=identicon&r=PG", "display_name": "Nayfe", "link": "https://stackoverflow.com/users/6225741/nayfe"}, "edited": false, "score": 1, "creation_date": 1512567961, "post_id": 47675710, "comment_id": 82310431, "body": "@Nayfe, in the latest version of c, dynamic arrays are defined."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5471256"}, "edited": false, "score": 0, "creation_date": 1512568287, "post_id": 47675710, "comment_id": 82310645, "body": "that is to say, you are writing not only to the buf object but also in the memory locations of the objects that immediately follow buf, like tempNum and fPointer, tha last of which is probably causing the segmentation fault."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1512568389, "post_id": 47675710, "comment_id": 82310715, "body": "You don&#39;t have any error checking. What if <code>fopen</code> fails? Or <code>fgets</code>? What if <code>number</code> is 0 or negative?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1512568487, "post_id": 47675710, "comment_id": 82310776, "body": "Not necessarily, @b&#39;stard.  <code>fgets()</code> stores at most one byte more than it reads, so it will overrun the array bounds only if the input line contains more bytes than the buffer can actually hold, less one.  But the mismatch between the array declaration and the <code>fgets()</code> call is, indeed, pointless and risky."}, {"owner": {"reputation": 21, "user_id": 4522165, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ef6e0924c6260a2017294c9b2ce7119e?s=128&d=identicon&r=PG&f=1", "display_name": "Staytrippy", "link": "https://stackoverflow.com/users/4522165/staytrippy"}, "edited": false, "score": 0, "creation_date": 1512568644, "post_id": 47675710, "comment_id": 82310883, "body": "I appreciate for all our helps. However I just found out by using gdb and the error message was &quot;Program received signal SIGBUS, Bus error&quot;. Any ideas?"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1512568746, "post_id": 47675710, "comment_id": 82310949, "body": "gdb does more than give you an error message. Use it to inspect the state of your program. Step through each line of code and see what happens."}, {"owner": {"reputation": 1586, "user_id": 6225741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f147a4cf533863ff2f12762e3c6192?s=128&d=identicon&r=PG", "display_name": "Nayfe", "link": "https://stackoverflow.com/users/6225741/nayfe"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1512568877, "post_id": 47675710, "comment_id": 82311040, "body": "@PaulOgilvie thanks, good to know if i need to switch back to pure C :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5471256"}, "edited": false, "score": 0, "creation_date": 1512570681, "post_id": 47675710, "comment_id": 82312257, "body": "&quot;Bus errors are generally caused by applications trying to access memory that hardware cannot physically address. &quot;, that is Linux Bus Error. you have overwritten the fPointer with some arbitrary data read from you file input.txt and that file pointer fPointer is trying to access God knows what memory address. maybe a negative one..."}], "answers": [{"tags": [], "owner": {"reputation": 1586, "user_id": 6225741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f147a4cf533863ff2f12762e3c6192?s=128&d=identicon&r=PG", "display_name": "Nayfe", "link": "https://stackoverflow.com/users/6225741/nayfe"}, "is_accepted": false, "score": 0, "last_activity_date": 1512574048, "last_edit_date": 1512574048, "creation_date": 1512571297, "answer_id": 47676937, "question_id": 47675710, "link": "https://stackoverflow.com/questions/47675710/declaring-char-array-results-segmentation-fault-in-c-programming-language/47676937#47676937", "title": "Declaring char array results segmentation fault in C programming language", "body": "<p>Something like this?</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define BUF_SIZE 1024\n#define MAX_INPUT 2\n\nint main(int argc, char **argv) {\n    char *token = NULL;\n    char *next_token = NULL;\n    char buf[BUF_SIZE];\n    long tempNum[MAX_INPUT] = { 0 };\n    const char *delim = \" \";\n    char * end = NULL;\n\n    // Init vars\n    memset(buf, 0, BUF_SIZE);\n\n    // Open file\n    FILE * fPointer = fopen(\"input.txt\", \"r\");\n    if (fPointer == NULL) {\n        return 1;\n    }\n\n    // Read first line\n    if (fgets(buf, BUF_SIZE, fPointer) == NULL) {\n        fclose(fPointer);\n        return 2;\n    }\n\n    // Parse line\n    token = strtok_s(buf, delim, &amp;next_token);\n    for (int i = 0;((i &lt; MAX_INPUT) &amp;&amp; (token != NULL)); i++){\n        tempNum[i] = strtol(token, &amp;end, 10);\n        if (*end != NULL){\n            printf(\"error in %s\\n\", token);\n        } else {\n            printf(\"%d\\n\", tempNum[i]);\n        }\n        token = strtok_s(NULL, delim, &amp;next_token);\n    }\n\n    fclose(fPointer);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4522165, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ef6e0924c6260a2017294c9b2ce7119e?s=128&d=identicon&r=PG&f=1", "display_name": "Staytrippy", "link": "https://stackoverflow.com/users/4522165/staytrippy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1512574048, "creation_date": 1512567531, "last_edit_date": 1512567639, "question_id": 47675710, "link": "https://stackoverflow.com/questions/47675710/declaring-char-array-results-segmentation-fault-in-c-programming-language", "title": "Declaring char array results segmentation fault in C programming language", "body": "<p>I was just creating simple implementation where I read input.txt file which has one line of code containing two numbers separated by space (e.g. 4 4).</p>\n\n<p>I was trying to separate them by delimiting with space first.</p>\n\n<p>And I was trying to use the first value as a size of char array.</p>\n\n<p>However it keeps causing segmentation fault but I have no idea.</p>\n\n<pre><code>int main(int argc, char **argv){\n\nint number;\nint i = 0;\nchar *token;\nchar buf[100];\nint tempNum[2];\n\n// Open file\nFILE * fPointer;\nfPointer = fopen(\"input.txt\", \"r\");\n\n// Read first line\nfgets(buf, 1024, fPointer);\ntoken = strtok(buf, \" \");\nnumber = atoi(token);\n\nchar charArray[number];\n\n\nwhile(token != NULL){\n    tempNum[i] = atoi(token);\n    token = strtok(NULL, \"\\n\");\n    printf(\"%d\\n\", tempNum[i]);\n    i++;\n}\n</code></pre>\n\n<p>If I comment out \"char charArray[number]\" it does not cause segmentation fault. If I comment out only the while loop, it does not cause segmentation fault. But I cannot figure out why it is causing the segmentation in the first place. Please help.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "android-ndk", "java-native-interface", "shared-libraries", "header-files"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1512567236, "post_id": 47675590, "comment_id": 82309916, "body": "the function exists and the linker finds it, even if there isn&#39;t a prototype. If there are no arguments, it will work. if there are arguments, there could be issues, though."}, {"owner": {"reputation": 1, "user_id": 9061987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f043eb21786969b5e834acc0e59389?s=128&d=identicon&r=PG&f=1", "display_name": "Ted.SC", "link": "https://stackoverflow.com/users/9061987/ted-sc"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1512567386, "post_id": 47675590, "comment_id": 82310017, "body": "@Jean-Fran&#231;oisFabre  Thanks for replying. So can I say that I can call functions in shared library if I know the function name and the input argments for this function even if those function are not declared in header files?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512697791, "post_id": 47675590, "comment_id": 82373228, "body": "first, mighty flakey implementation if the associated header file does not contain all the needed function prototypes.  second, in the code that is going to call that undocumented function, insert your own function prototype.  third, when a person writes a function in a library, and does not place a prototype for that function in the header file, then they do not want that function being directly called"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1512688373, "last_edit_date": 1512688373, "creation_date": 1512572595, "answer_id": 47677376, "question_id": 47675590, "link": "https://stackoverflow.com/questions/47675590/call-function-in-shared-library-but-not-declaration-in-header-files/47677376#47677376", "title": "Call function in shared library but not declaration in header files", "body": "<p>There are two possibilities here.</p>\n\n<ol>\n<li><p>The file using the function may contain its own declaration of the function. (Declarations are not required to be only in header files.)</p></li>\n<li><p>If you use a function without declaring it, the compiler may provide a default declaration. This is not part of modern C, but compilers may use old standards or be unduly lax in this regard. The default declaration is a function of the type <code>int SomeName()</code>. Such implicit declarations automatically have external linkage, which means the name will be matched to the definition of the function when the library is linked in.</p></li>\n</ol>\n\n<p>If the latter is the case, you would be well advised to enable additional switches to tell the compiler to issue more warning messages and to use a modern language standard (such as C 2011), at least when developing new code.</p>\n\n<p>Using a routine that is in a shared library but is not declared in its header is inadvisable. Such routines are often intended only for internal use of the library, and they may change or vanish in future versions of the library. So code using them would break; it would not be compatible with the new versions of the library.</p>\n"}], "owner": {"reputation": 1, "user_id": 9061987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f043eb21786969b5e834acc0e59389?s=128&d=identicon&r=PG&f=1", "display_name": "Ted.SC", "link": "https://stackoverflow.com/users/9061987/ted-sc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512688373, "creation_date": 1512567130, "question_id": 47675590, "link": "https://stackoverflow.com/questions/47675590/call-function-in-shared-library-but-not-declaration-in-header-files", "title": "Call function in shared library but not declaration in header files", "body": "<p>I am doing some implementation about calling function of shared library via Java to JNI.\nAnd JNI is implemented by C code.\nHere is my question.\nThere is a function named ABC() in shared library.\nThis function is not be declared in header files.\nBUT with NDK build, it can be successful and this function also can work fine.</p>\n\n<p>It's very confusing.\nWhy? why can it be built by NDK and why can it be called without any exception?\nThank you for answering:)</p>\n"}, {"tags": ["c", "console-application", "dev-c++"], "comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1512567667, "post_id": 47675527, "comment_id": 82310234, "body": "Are you aware that in C, &quot;string&quot;s are null-terminated (with <code>0</code> or equivalently <code>&#39;\\0&#39;</code>) char arrays?"}, {"owner": {"reputation": 27, "user_id": 8824232, "user_type": "registered", "profile_image": "https://graph.facebook.com/1845217552173829/picture?type=large", "display_name": "Daniel Go", "link": "https://stackoverflow.com/users/8824232/daniel-go"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1512567782, "post_id": 47675527, "comment_id": 82310314, "body": "Forgive me, I don&#39;t know about what is null-terminated. Can you explain it? Thx @Bob__"}, {"owner": {"reputation": 27, "user_id": 8824232, "user_type": "registered", "profile_image": "https://graph.facebook.com/1845217552173829/picture?type=large", "display_name": "Daniel Go", "link": "https://stackoverflow.com/users/8824232/daniel-go"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1512567970, "post_id": 47675527, "comment_id": 82310443, "body": "Ah, I see @Bob__ Thx for helping me."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1512568013, "post_id": 47675527, "comment_id": 82310473, "body": "C string is a char array with the last array element == to NULL, or &#39;\\0&#39;. for example for the following string: <code>char stringArray[] = {&quot;sample&quot;}; </code>stringArray` contains the following: <code>|s|a|m|p|l|e|0|</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512645009, "post_id": 47675527, "comment_id": 82346507, "body": "suggest using <code>strcat()</code> rather than <code>strcpy()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 0, "last_activity_date": 1512591289, "last_edit_date": 1512591289, "creation_date": 1512572111, "answer_id": 47677214, "question_id": 47675527, "link": "https://stackoverflow.com/questions/47675527/theres-a-space-when-i-strcpy-a-string-into-another-string/47677214#47677214", "title": "There&#39;s a space when I strcpy a string into another string", "body": "<p>The space(s) showing up at the end of your printout are because the list of test conditions you include: </p>\n\n<pre><code>if(temp[i]!=' ' &amp;&amp; temp[i]!='-' &amp;&amp; temp)\n</code></pre>\n\n<p>May be missing some additional conditions that need to be excluded:<br>\n1) added additional test: <code>test[i] != 0</code><br>\n2) changed <code>temp[i] != ' '</code> to <code>!isspace(temp[i])</code>, which will test against all white space.  </p>\n\n<p>Once these are added:</p>\n\n<pre><code>if(!isspace(temp[i]) &amp;&amp; temp[i]!='-' &amp;&amp; temp &amp;&amp; (temp[i] != 0))\n</code></pre>\n\n<p>The text entered is printed only down to the last non-whitespace character. </p>\n\n<p>Code modifications:<br>\nI added some other minor modifications to the following code that allowed the code to be compiled in my environment.  Because my modifications use functions that are part of the C standard libraries, this should compile for you as well.\nChanges also include expanding <code>for(...)</code> loops to accommodate the array sizes you created, enabling input up to <code>N-1</code> characters as opposed to only 10.  Most of what I did includes commented explanations.     </p>\n\n<pre><code>int main(int argc, char *argv[]) \n{\n    int i,j;\n    //int jumlah[10]; \n    int jumlah[N]; // probably meant to use N here?\n\n    string inputan = {0};\n    string temp = {0};\n    int counter = 0;// initialize\n\n    for(i=0;i&lt;N;i++) {\n        jumlah[i]=0;\n    }\n\n    for(i=0;i&lt;N-1;i++) {\n        temp[i]='-';\n    }\n\n    for(i=0;i&lt;N-1;i++) {\n        inputan[i]='-';\n    }\n\n\n    do {\n\n        //system(\"cls\");  This is fine, just does not work in my environment, so commented.\n        //printf(\"\\nMasukan kalimat: \");fflush(stdin);gets(inputan);\n        printf(\"\\nPut Sentence (or \\\"0\\\" to process): \");fflush(stdin);gets(inputan);// clarified instructions.\n\n        if(stricmp(inputan,\"0\")!=0) {  //strcmpi\n            strcpy(temp,inputan);\n        }\n        //getch(); this (or getchar()) is really not necessary here to support\n        //         the flow of your application.\n\n    }while(stricmp(inputan,\"0\")!=0);\n\n\n\n    printf(\"Hasil Analisa:\\n\\n\");\n\n    for(i=0;i&lt;N;i++) { //replace 10 with N\n\n        if(temp[i]!='-') {\n\n            char c = temp[i];\n            for(j=0;j&lt;N;j++) {  //replace 10 with N\n\n                if(temp[j]!='-') {\n\n                    if(c == temp[j])\n                        //counter+=1;\n                        counter++; // var++ equivalent var += 1\n\n                }\n\n            }\n\n            jumlah[i] = counter;\n            counter = 0;\n        }\n\n    }\n\n\n    for(i=0;i&lt;N;i++) {\n\n        //if(temp[i]!=' ' &amp;&amp; temp[i]!='-' &amp;&amp; temp) { // only spaces ?\n        if(!isspace(temp[i]) &amp;&amp; temp[i]!='-' &amp;&amp; temp &amp;&amp; (temp[i] != 0)) { // temp[i] != 0, and exclude all white space\n            printf(\"\\t%c terdapat %d\\n\",temp[i],jumlah[i]); \n        }\n\n    }\n\n    getchar();    //orig getch() not standard\n\n}\n</code></pre>\n\n<p>Addressing your question: <em>how to display only one char if there's a symbol again in another index that have same symbol.</em></p>\n\n<p>Displaying a list of the characters used, and the number of times used might be better handled in a separate function.  The one below can be adapted to be called in your original main function by inserting the following lines:</p>\n\n<pre><code>char *res = letterCounter(\"this is the string\");\nprintf(res);\nfree(res);\n</code></pre>\n\n<p>Just under your existing line: <code>printf(\"Hasil Analisa:\\n\\n\");</code>\n(i.e. replace all your code under that line down to the <code>getch();</code> function;</p>\n\n<pre><code>char * letterCounter(const char *string)\n{\n    int i, j;\n    int len = strlen(string);\n    char *dup = StrDup(string);\n    if(!dup) return NULL;\n    int viewableAscii = '~' - '!'; /// range of ASCII from ! to ~ (33 - 126)\n    char buf[20];\n    char * results = calloc(100*strlen(string), 1);//ensure enough room\n    if(!results) return NULL;\n    /// caps 'A' == 65, 'Z' == 90\n    /// lowr 'a' == 97, 'z' == 122\n    /// all visable printables: 33 - 126\n    unsigned char characterUsageCounter[viewableAscii];\n    memset(characterUsageCounter, 0,viewableAscii); \n\n    for(i=0;i&lt;len;i++)\n    {\n        for(j=0;j&lt;viewableAscii;j++)\n        {\n            if(dup[i]  == 33 + j)\n            {\n                characterUsageCounter[j]++;\n            }\n        }\n    }\n    for(i=0;i&lt;viewableAscii;i++)\n    {\n        if(characterUsageCounter[i] &gt; 0)\n        {\n            if(characterUsageCounter[i] == 1) sprintf(buf, \"%c occurs %d time\\n\", i+33, characterUsageCounter[i]);\n            else sprintf(buf, \"%c occurs %d times\\n\", i+33, characterUsageCounter[i]);\n            strcat(results, buf);\n        }\n    }\n\n    return results;\n}\n</code></pre>\n\n<p>For example, if the string \"this is the string\" were passed as the argument to that function, the following would be output:<br>\n<a href=\"https://i.stack.imgur.com/EpvHs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EpvHs.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 8824232, "user_type": "registered", "profile_image": "https://graph.facebook.com/1845217552173829/picture?type=large", "display_name": "Daniel Go", "link": "https://stackoverflow.com/users/8824232/daniel-go"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1290, "favorite_count": 0, "accepted_answer_id": 47677214, "answer_count": 1, "score": 0, "last_activity_date": 1512591289, "creation_date": 1512566958, "question_id": 47675527, "link": "https://stackoverflow.com/questions/47675527/theres-a-space-when-i-strcpy-a-string-into-another-string", "title": "There&#39;s a space when I strcpy a string into another string", "body": "<p>I have a kind of logical assignment here in my class. So my question is when I try to strcpy() a string into another string, There's a (like space) in my new string. I don't know how to delete that, perhaps my mistake. Please help me, thank you.</p>\n\n<p>This program let's you type whatever letters or symbol on your keyboard and try to capture it and count the symbol. Then, return it.</p>\n\n<p>Here's my code in C</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;string.h&gt;\n#define N 25\ntypedef char string[N];\n\nint main(int argc, char *argv[]) \n{\n    int i,j;\n    int jumlah[10];\n\n    string inputan;\n    string temp;\n    int counter;\n\n    //Init\n    for(i=0;i&lt;10;i++) {\n        jumlah[i]=0;\n    }\n\n    for(i=0;i&lt;10;i++) {\n        temp[i]='-';\n    }\n\n    for(i=0;i&lt;10;i++) {\n        inputan[i]='-';\n    }\n\n\n    do {\n\n        system(\"cls\");\n        printf(\"\\nMasukan kalimat: \");fflush(stdin);gets(inputan);\n\n        if(strcmpi(inputan,\"0\")!=0) {\n            strcpy(temp,inputan);\n        }\n        getch();\n\n    }while(strcmpi(inputan,\"0\")!=0);\n\n\n    printf(\"Hasil Analisa:\\n\\n\");\n\n    for(i=0;i&lt;10;i++) {\n\n        if(temp[i]!='-') {\n\n            char c = temp[i];\n            for(j=0;j&lt;10;j++) {\n\n                if(temp[j]!='-') {\n\n                    if(c == temp[j])\n                        counter+=1;\n\n                }\n\n            }\n\n            jumlah[i] = counter;\n            counter = 0;\n        }\n\n    }\n\n\n    for(i=0;i&lt;10;i++) {\n\n        if(temp[i]!=' ' &amp;&amp; temp[i]!='-' &amp;&amp; temp) {\n            printf(\"\\t%c terdapat %d\\n\",temp[i],jumlah[i]); \n        }\n\n    }\n\n    getch();\n\n}\n</code></pre>\n\n<p>And here's my console result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lCIEt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lCIEt.png\" alt=\"There&#39;s a space\"></a></p>\n\n<p>So that's make the program will show the space symbol and count it.</p>\n\n<p>And if I can ask again, how to display only one char if there's a symbol again in another index that have same symbol. Thx, forgive me if my English is not fluent.</p>\n"}, {"tags": ["c++", "c", "arrays", "pointers", "winapi"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1512567033, "post_id": 47675506, "comment_id": 82309757, "body": "<code>InetPton</code> seems to be a Windows-specific function, so probably worth adding a corresponding tag to this question :)"}, {"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1512567499, "post_id": 47675506, "comment_id": 82310110, "body": "@tkausl Sorry, I did not get why is it a char pointer? I believe that is where my misunderstanding lies."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1512567600, "post_id": 47675506, "comment_id": 82310181, "body": "I was looking at the wrong variable, sorry. Why is it an array of size 1 though? Just use a local <code>u_long</code> and take the pointer to that variable."}, {"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512567831, "post_id": 47675506, "comment_id": 82310348, "body": "InetPton() returns a <code>binary numeric IP address in network byte order.</code> and 4 bytes (32 bits) - which is the size of u_long on windows is enough for an IPV4 address."}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 0, "creation_date": 1512568030, "post_id": 47675506, "comment_id": 82310491, "body": "Wouldn&#39;t it be easier to just declare <code>buff</code> as the correct type (an <code>IN_ADDR</code>)?"}, {"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512568336, "post_id": 47675506, "comment_id": 82310676, "body": "Yes, you guys are right - better set of data types and usage of <code>u_long buff;</code> instead of <code>u_long * buff[1];</code> - however, please treat it as me asking why does it need the casting in my specific case. I definitely agree on all the points raised, but why casting is needed in my code example is I think were my knowledge of c/cpp could be expanded :)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1512571619, "post_id": 47675506, "comment_id": 82312924, "body": "better use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa814459(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>RtlIpv4StringToAddressEx</code></a> for this task. and despite documentation : Minimum supported client - vista - really on xp this api also exist"}], "answers": [{"comments": [{"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512581505, "post_id": 47675864, "comment_id": 82319602, "body": "This was an example I was building upon found on the internet, but  appreciate that it&#39;s somehow C 101. Pointers should not be used I agree, just wanted to understand why I see the behavior I see."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512582537, "post_id": 47675864, "comment_id": 82320130, "body": "buff is not a storage location. You cannot ask how to retrieve a value in buff[0] because it does not exist. Your buff variable points to a undefined location and when passed to InetPton as a location to write to it could in theory overwrite your master boot record."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": false, "score": 2, "last_activity_date": 1512568352, "last_edit_date": 1512568352, "creation_date": 1512568038, "answer_id": 47675864, "question_id": 47675506, "link": "https://stackoverflow.com/questions/47675506/unclear-relationship-between-pointer-dereferencing-and-casting-in-a-specific-sce/47675864#47675864", "title": "Unclear relationship between pointer dereferencing and casting in a specific scenario", "body": "<p>The parameter passed to <code>ntohl</code> should not need casting.</p>\n\n<p>When parsing a IPv4 string address <code>InetPton</code> just needs an address in memory where it can write 4 bytes.</p>\n\n<pre><code>u_long addr; // 4 bytes on Windows\nint ret = InetPton(AF_INET, ipv4, &amp;addr);\nif (ret == -1) return 1;\nif (ret == 0) return 1; // more handling needs to be added\n\nreturn ntohl(addr);\n</code></pre>\n\n<p>Ideally you would use the <code>IN_ADDR</code> type instead but if you only care about Windows you can use the <code>long</code> based types directly.</p>\n\n<p>Declaring a variable on the stack as a pointer (<code>*</code>) to something makes no sense when you need to store data in said variable, this is C 101.</p>\n"}, {"comments": [{"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512580816, "post_id": 47675966, "comment_id": 82319186, "body": "<code>storing the resulting IP address directly in this pointer variable.</code> - let me try formulate how I understand what you sai. I hope you can correct me in case I&#39;m missing something. I&#39;m passing <code>&amp;buff</code> which is equivalent to <code>&amp;buff[0]</code> or simply <code>buff</code> to <code>InetPton()</code>. It pushes the value as the first element of the array. The out parameter for the function is defined as <code>_Out_ PVOID  pAddrBuf</code> therefore I should be able to <code>use u_long * a []</code> w/o problem. The function <code>ntohl()</code> then accepts u_long - which should be obtained from **buff - first <code>*</code> defers array, second <code>*</code> - get the value?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 1, "creation_date": 1512583848, "post_id": 47675966, "comment_id": 82320803, "body": "@MindaugasBernatavi\u010dius The problem is that the IP address is being stored in <code>buff[0]</code> which is of type <code>u_long *</code>.  So for example if you passed &quot;127.0.0.1&quot; to <code>InetPtoN</code>, then <code>buff[0]</code> would (assuming your system is little endian) contain the value 0x0100007f as type <code>u_long *</code>.  So <code>buff[0]</code> contains the value you want but it&#39;s the wrong type.  That&#39;s why <code>(u_long)buff[0]</code> gets you the expected value.  It&#39;s also why <code>*buff[0]</code> segfaults, because it means &quot;get the value at address 0x0100007f&quot; which is not a valid address."}, {"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512595196, "post_id": 47675966, "comment_id": 82326742, "body": "OK, great. Think I understand it now. PVOID is not the <code>InetPtoN()</code>&#39;s return type (not sure why I though that it was, since return value is specified at the beginning of the function signature), it is the type of value that it expects - a pointer which in my case is being retrieved with the address-of operator (&amp;) of <code>buff</code>. And since <code>buff[0]</code> is <code>u_long *</code> IP gets stored there and dereferencing it I would get a segfault. The strange mistake I made was thinking that PVOID is somehow a return type - maybe I made this mistake due to programming in C# recently :D Who knows."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1512572209, "last_edit_date": 1512572209, "creation_date": 1512568335, "answer_id": 47675966, "question_id": 47675506, "link": "https://stackoverflow.com/questions/47675506/unclear-relationship-between-pointer-dereferencing-and-casting-in-a-specific-sce/47675966#47675966", "title": "Unclear relationship between pointer dereferencing and casting in a specific scenario", "body": "<p>You have <code>buff</code> defined as an array (of size 1) of <em>pointer</em> to <code>u_long</code>.  So <code>InetPton</code> is storing the resulting IP address directly in this pointer variable.  You then get a crash because this IP address is interpreted as a memory address and dereferenced.</p>\n\n<p><code>buff</code> should be defined as a simple <code>u_long</code>, with it's address passed to <code>InetPton</code>:</p>\n\n<pre><code>u_long buff;\nint ret = InetPton(AF_INET, ipv4, &amp;buff);\n</code></pre>\n\n<p>Then you can do this:</p>\n\n<pre><code>return ntohl(buff);\n</code></pre>\n\n<p>Improving on this, the MSDN page says the following if the value of the first parameter is <code>AF_INET</code>:</p>\n\n<blockquote>\n<pre><code>INT WSAAPI InetPton(\n  _In_  INT     Family,\n  _In_  PCTSTR pszAddrString,\n  _Out_ PVOID  pAddrBuf\n);\n</code></pre>\n  \n  <p>...</p>\n  \n  <p>When this parameter is specified, the <code>pszAddrString</code> parameter must\n  point to a text representation of an IPv4 address and the <code>pAddrBuf</code>\n  parameter returns a pointer to an <code>IN_ADDR</code> structure that represents\n  the IPv4 address.</p>\n</blockquote>\n\n<p>So you should instead be passing in the address of an <code>IN_ADDR</code> for the third parameter:</p>\n\n<pre><code>IN_ADDR addr;\nint ret = InetPton(AF_INET, ipv4, &amp;addr);\n...\nreturn ntohl(addr.S_addr);\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Expanding on why the cast makes a difference, it turns out it doesn't.  What makes a difference is the level of indirection and how many times you dereference.</p>\n"}, {"comments": [{"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512581296, "post_id": 47675979, "comment_id": 82319479, "body": "I agree with the last point and I will not leave the code as presented in the question. Thanks for helping me out, I appreciate it. So you are saying that <code>buff</code> is not a pointer (array) to a <code>u_long *</code> pointers? The out param is <code>_Out_ PVOID  pAddrBuf</code> for <code>InetPton()</code> PVOID, I take is void * - a general purpose pointer so I should be able to use u_long * ? ... seems like I&#39;m missing something."}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "reply_to_user": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 1, "creation_date": 1512594451, "post_id": 47675979, "comment_id": 82326350, "body": "As you declared it <code>buff</code> is indeed an array of pointers. But the reason the function takes a pointer is to tell it where to write the result; the result is not itself a pointer. You just have to pass the address of a variable of suitable type - see for example @Anders answer. (Note that <code>_Out_</code> is not standard C++; here it&#39;s essentially a comment.)"}, {"owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "edited": false, "score": 0, "creation_date": 1512595382, "post_id": 47675979, "comment_id": 82326830, "body": "Precisely identified, that were I was mistaken - I though the out keyword specified the return type. Glad I clarified this in my head. Thanks a lot for the help, you made it easier for me to understand the problem :)"}], "tags": [], "owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "is_accepted": false, "score": 2, "last_activity_date": 1512568393, "creation_date": 1512568393, "answer_id": 47675979, "question_id": 47675506, "link": "https://stackoverflow.com/questions/47675506/unclear-relationship-between-pointer-dereferencing-and-casting-in-a-specific-sce/47675979#47675979", "title": "Unclear relationship between pointer dereferencing and casting in a specific scenario", "body": "<p>The call to <code>InetPton</code> writes a 32 bit IPv4 address to the first <code>u_long *</code> in <code>buff</code>.</p>\n\n<p>All your variants that double-dereference are treating that value as if it were a pointer. It isn't, which is why they crash.</p>\n\n<p>The ones that work manage to do only a single dereference and have the result treated as a long, which is why they work. (Although I suspect many of them actually have unspecified or undefined behaviour since you are being pretty cavalier about whether the value is a pointer or integer.)</p>\n\n<p>If you declared <code>buff</code> as an <code>IN_ADDR</code> your code could be both simpler and clearly correct.</p>\n"}], "owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 47675966, "answer_count": 3, "score": -1, "last_activity_date": 1512572209, "creation_date": 1512566883, "last_edit_date": 1512567413, "question_id": 47675506, "link": "https://stackoverflow.com/questions/47675506/unclear-relationship-between-pointer-dereferencing-and-casting-in-a-specific-sce", "title": "Unclear relationship between pointer dereferencing and casting in a specific scenario", "body": "<p>I have the following Cpp funtion:</p>\n\n<pre><code>u_long stringIpV4ToBinary(const char * ipv4)\n{\n    u_long * buff[1];\n    int ret = InetPton(AF_INET, ipv4, &amp;buff);\n    if (ret == -1) return 1;\n    if (ret == 0) return 1; // more handling needs to be added\n\n// return ntohl(*buff[0]);           // crash, no warning\n// return ntohl((*buff)[0]);         // same meaning above (??) crash, no warning\n// return ntohl(**buff);             // crash, no warning\n// return ntohl(*(buff[0]));         // crash, no warning\n// return ntohl(*(u_long*)buff[0]);  // crash, no warning\n// return ntohl((u_long)buff[0]);    // works, but produces warnings:: 'type cast': truncation from 'u_long *' to 'u_long'\n// return ntohl(*(u_long*)&amp;buff);    // works\n// return ntohl(*(u_long*)&amp;buff[0]); // works\n// return ntohl(*(u_long*)buff[0]);  // crash, no warning\n// return ntohl(*(u_long*)buff);     // works\n}\n</code></pre>\n\n<p>I have spent some time trying to extract the value of buff that I need to pass to <code>ntohl()</code> (so you can ignore the first couple of lines). I was playing around with <code>*buff[0]</code> <code>*buff</code> and others, w/o realizing that I need to cast the value of the first element of the array (<code>&amp;buff[0]</code>, <code>buff</code> or <code>&amp;buff</code>).</p>\n\n<p><strong>Question</strong>: why do I need to cast the retrieved value to <code>(u_long*)</code> and then deference the pointer? Is it ambiguous or unclear to @ runtime that the value held in the <code>buff[0]</code> will be a of type <code>u_long *</code> ?  My expectation was that <code>ntohl(**buff)</code> - (buff is the array name, that decays into a pointer and since the array is of u_long pointers itself) double dereferencing should suffice.</p>\n"}, {"tags": ["android", "c", "freopen"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1512565187, "post_id": 47674836, "comment_id": 82308551, "body": "removed, the c++ tag, not sure, but may it also isnt really about c..."}, {"owner": {"reputation": 61, "user_id": 8928251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f222a6ea037746585433c332688d8?s=128&d=identicon&r=PG&f=1", "display_name": "Tangent", "link": "https://stackoverflow.com/users/8928251/tangent"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1512566280, "post_id": 47674836, "comment_id": 82309245, "body": "I know, but freopen() is a function of c/c++. That&#39;s why I added c &amp; c++ tag @tobi303"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1512566319, "post_id": 47674836, "comment_id": 82309268, "body": "There is no such thing like C/C++. These are 2 different languages. Please only use the tags for the language you are using."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1512568992, "post_id": 47674836, "comment_id": 82311116, "body": "imho C++ got the worst name ever. Maybe ++C would have been better to make it more obvious that <code>C != ++C</code> ;) (btw <code>c &amp; c++</code> as well as <code>c&#47;c++</code> is undefinded both in c and c++ afaik)"}, {"owner": {"reputation": 61, "user_id": 8928251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f222a6ea037746585433c332688d8?s=128&d=identicon&r=PG&f=1", "display_name": "Tangent", "link": "https://stackoverflow.com/users/8928251/tangent"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1512757655, "post_id": 47674836, "comment_id": 82400828, "body": "I thought all the codes in c runs successfully in c++ @gerhardh"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1512758053, "post_id": 47674836, "comment_id": 82401007, "body": "No, that&#39;s simply not true."}], "owner": {"reputation": 61, "user_id": 8928251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f222a6ea037746585433c332688d8?s=128&d=identicon&r=PG&f=1", "display_name": "Tangent", "link": "https://stackoverflow.com/users/8928251/tangent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512565165, "creation_date": 1512564925, "last_edit_date": 1512565165, "question_id": 47674836, "link": "https://stackoverflow.com/questions/47674836/input-and-output-of-a-c-code-from-file-in-android-without-root", "title": "Input and output of a c code from file in android (without root)", "body": "<p>For <strong>OJ</strong> problem solving I often face importance to have my outputs as a file. But <strong>freopen()</strong> does not work in android. Actually, there is a way that copy the code in a root diretory using <strong>Termux</strong> (or like apps) and then </p>\n\n<pre><code>./a.out &lt;input.txt&gt; output.txt\n</code></pre>\n\n<p>But it is very long process. Is there any way to doing this <strong>input/output</strong> easily any app or method?</p>\n"}, {"tags": ["c", "variables", "macros", "arguments"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1512564491, "post_id": 47674663, "comment_id": 82308075, "body": "Why can&#39;t <code>add</code> be recoded as a function that takes a variable argument list?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1512564568, "post_id": 47674663, "comment_id": 82308129, "body": "... Or to reduce the chance of errors, a function that takes 2 mandatory parameters and another optional one by a variable argument list."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512572445, "post_id": 47674663, "comment_id": 82313530, "body": "The <i>sane</i> solution: a function <code>type add (type a, type b, type c);</code> where <code>c</code> is optional and can be set to NULL or some such. Variadic macros is often the road towards madness."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1512566452, "last_edit_date": 1512566452, "creation_date": 1512565722, "answer_id": 47675086, "question_id": 47674663, "link": "https://stackoverflow.com/questions/47674663/variable-arguments-inside-a-macro/47675086#47675086", "title": "Variable arguments inside a macro", "body": "<p>That <a href=\"https://stackoverflow.com/questions/2124339/c-preprocessor-va-args-number-of-arguments\">usual trick for counting arguments</a> may be adapted for this:</p>\n\n<pre><code>#define ADD_EXPAND(...) \\\n        ADD_EXPAND_(__VA_ARGS__, EXPAND_ADD_FUNCS())\n\n#define ADD_EXPAND_(...) \\\n        EXPAND_ADD_SEL_FUNC(__VA_ARGS__)\n\n#define EXPAND_ADD_SEL_FUNC(first_, second_, third_, func, ...) func\n\n#define EXPAND_ADD_FUNCS() foo2, foo, dummy\n\n#define add(...) ADD_EXPAND(__VA_ARGS__)(__VA_ARGS__)\n</code></pre>\n\n<p>Once you plow through the boiler plate, it basically just involves placing all the arguments in a line, with the function tokens after them, and seeing which function stands out. That's what <code>EXPAND_ADD_SEL_FUNC</code> does.</p>\n\n<p>You can see it <kbd><a href=\"http://coliru.stacked-crooked.com/a/b6a844c545d2b961\" rel=\"nofollow noreferrer\">live on coliru</a></kbd>.</p>\n\n<p>But I'll reiterate what we told you in comments. This is likely to be a sub-par solution to a proper function. I haven't tested it thoroughly, so breakage is easily possible. Use at your own risk. </p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1512566152, "post_id": 47675112, "comment_id": 82309168, "body": "Yours is way more readable than my shot at it, I must say. Definite +1"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512574086, "post_id": 47675112, "comment_id": 82314710, "body": "I don&#39;t believe <code>#define ADD(_1, _2, _3, X, ...) X</code> is standard C, you have to burn the <code>__VA_ARGS__</code> somewhere. Don&#39;t compile with some gcc extensions enabled."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512574840, "post_id": 47675112, "comment_id": 82315229, "body": "Yep, just checked with GCC in standard mode. This code won&#39;t compile. Very smart trick, but not valid C, unfortunately."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512590190, "post_id": 47675112, "comment_id": 82324049, "body": "@Lundin: Oh. I didn&#39;t know that a variadic macro has to use <code>__VA_ARGS__</code> somewhere. I get a warning in standard mode. Strangely, I can make it go away by adding a dummy argument after <code>add2</code> in <code>add</code>, which is fishy, because it doesn&#39;t change the fact that I ignore the variadic arguments in <code>ADD</code>. It makes the variadic args a non-empty list, though."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512633890, "post_id": 47675112, "comment_id": 82339515, "body": "I know that gcc has various non-standard extensions here, hence I compiled with <code>gcc -std=c11 -pedantic-errors</code> which doesn&#39;t let through non-compliant code. I&#39;m not sure if making the <code>...</code> argument non-empty is enough for standard compliance."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1512634744, "post_id": 47675112, "comment_id": 82339924, "body": "@Lundin: Hmmm. I get a different error message with a newer gcc. It seems that is is legal not to use the variadic args, but it isn&#39;t legal to pass zero variadic arguments. If that&#39;s true, adding the dummy argument works. I&#39;ve tried with an admittedly dated version of Visual studio, and it doesn&#39;t compile at all. (That doesn&#39;t say anything about standard compliance, though.)"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1512634858, "post_id": 47675112, "comment_id": 82339985, "body": "And the OP seems to have lost interest in the question. I don&#39;t think the <code>add</code> scenario is what they are after anyways -- the &quot;variadic&quot;  way to add several numbers is to use the <code>+</code> operator several times. If the real intention is shown, a more C-ish solution without macros could be proposed."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 4, "last_activity_date": 1512653512, "last_edit_date": 1512653512, "creation_date": 1512565771, "answer_id": 47675112, "question_id": 47674663, "link": "https://stackoverflow.com/questions/47674663/variable-arguments-inside-a-macro/47675112#47675112", "title": "Variable arguments inside a macro", "body": "<p>If you just want to distinguish between two functions, the following works:</p>\n\n<pre><code>#define ADD(_1, _2, _3, X, ...) X\n#define add(...) ADD(__VA_ARGS__, add3, add2, 0)(__VA_ARGS__)\n</code></pre>\n\n<p>The auxiliary macro <code>ADD</code> always picks the fourth argument:</p>\n\n<pre><code>add(a, b)    --&gt; ADD(a, b, add3, add2, 0)    --&gt; add2\nadd(a, b, c) --&gt; ADD(a, b, c, add3, add2, 0) --&gt; add3\n</code></pre>\n\n<p>The drawback is that you get quite cryptic error messages when you don't supply two or three arguments to the function.</p>\n\n<p>The advantage over variadic functions is that you get type safety. For example if your functions operate on <code>double</code>s, you can still say <code>add(1, 2)</code> and the integer arguments will be converted to <code>double</code>s. And variadic functions require some additional information on the number of actual arguments, so that's not a feasible solution here, unless you specify the number of summands in the function. </p>\n\n<p><em>Addendum</em>: I've changed the <code>add</code> macro so that it doesn't pass an empty variadic list to <code>ADD</code>. Some compilers allow empty lists, but it isn't standard C.</p>\n"}, {"comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1513773796, "post_id": 47678077, "comment_id": 82779478, "body": "This solution has some minor drawbacks, namely that the function arguments must be assignment compatible to <code>int</code>, and even if they are, you might get weird warnings. For the latter, using <code>_Complex long double</code> instead of <code>int</code> would allow to capture all arithmetic types."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1513784097, "post_id": 47678077, "comment_id": 82786418, "body": "@JensGustedt It is intentional, since variadic-macros have non-existent type safety. The code will only compile if compatible/implicitly convertible types are passed. Character types, floating point etc will work, but pointer types on aggregates etc will not be accepted. Getting diagnostics is a good thing, implicit and silent conversions and is a bad thing."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1617864877, "post_id": 47678077, "comment_id": 118428187, "body": "This is 100% standard C11. I don&#39;t think this pass into a C90 nor C99 compiler."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1617868861, "post_id": 47678077, "comment_id": 118429849, "body": "@Cyan There is only one C standard. That&#39;s kind of the whole point of standardization. That standard is currently ISO 9899:2018. When this was written, the C standard was ISO 9899:2011. ISO 9899:1999 was withdrawn over a decade ago."}, {"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1617870112, "post_id": 47678077, "comment_id": 118430338, "body": "Semantic smokescreen. This will do little to help people who must write portable code, and have to pay attention if a given expression will work on C90 or C99 compilers. That your suggestion only works on more recent C11 compilers is a rather useful information that should haver been mentioned to the reader. In contrast, Oehm&#39;s answer just below is compatible with all compilers that support variadic macros, from C99 onwards (and virtually all C90 I&#39;m aware of). A difference worth underlining."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1617876169, "post_id": 47678077, "comment_id": 118433124, "body": "@Cyan According to the SO policies about C questions (and all other programming languages too), the current standard is assumed unless the person writing the question is saying otherwise. You can read about it here <a href=\"https://stackoverflow.com/tags/c/info\">stackoverflow.com/tags/c/info</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1617876177, "post_id": 47678077, "comment_id": 118433126, "body": "@Cyan Summary:  &quot;- If your question is specific to one particular version of the the language, add c90 c99 c11 or c17. - Unless the question explicitly mentions which version of the C standard that is used, it is assumed that the current version is used. That is, whichever version of ISO 9899 that ISO currently lists as active. Please have this in mind when answering or commenting on questions tagged c.&quot;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1617876504, "post_id": 47678077, "comment_id": 118433280, "body": "Now if someone maintaining old C90 stuff stumbles upon this thread and decide to grab the code from here and import it in their old C90 code base, then they are thoroughly incompetent and should not be working with code maintenance. Maintaining such old code is much harder and more qualified work than writing new code - you shouldn&#39;t assign some rookie or quack to such tasks. For example variadic macros won&#39;t work in C90 either and you should know that if you work with C90 maintenance."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1512575076, "last_edit_date": 1512575076, "creation_date": 1512574752, "answer_id": 47678077, "question_id": 47674663, "link": "https://stackoverflow.com/questions/47674663/variable-arguments-inside-a-macro/47678077#47678077", "title": "Variable arguments inside a macro", "body": "<p>If you <em>must</em> use variadic macros, then here is a trick. </p>\n\n<pre><code>#define add(...) _Generic ( &amp;(int[]){__VA_ARGS__}, \\\n                            int(*)[2]: add2,       \\\n                            int(*)[3]: add3) (__VA_ARGS__)\n</code></pre>\n\n<ul>\n<li>Have the macro create a compound literal array. The size of this array will depend on the number of arguments.</li>\n<li>Grab the address of the compound literal, to get an array pointer type.</li>\n<li>Let <code>_Generic</code> check which type you got, then call the proper function based on that.</li>\n</ul>\n\n<p>This is 100% standard C and also type safe.</p>\n\n<hr>\n\n<p>Demo:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\n#define add(...) _Generic ( &amp;(int[]){__VA_ARGS__}, \\\n                            int(*)[2]: add2,       \\\n                            int(*)[3]: add3) (__VA_ARGS__)\n\nint add2 (int a, int b);\nint add3 (int a, int b, int c);\n\nint main (void)\n{\n  printf(\"%d\\n\", add(1, 2));\n  printf(\"%d\\n\", add(1, 2, 3));\n//printf(\"%d\\n\", add(1, 2, 3, 4)); Compiler error for this.\n}\n\n\nint add2 (int a, int b)\n{\n  return a + b;\n}\n\nint add3 (int a, int b, int c)\n{\n  return a + b + c;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6137960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bda956ddaad878eb9f22d3985eed6d0d?s=128&d=identicon&r=PG&f=1", "display_name": "Sruthy", "link": "https://stackoverflow.com/users/6137960/sruthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 47678077, "answer_count": 3, "score": 0, "last_activity_date": 1512653512, "creation_date": 1512564445, "question_id": 47674663, "link": "https://stackoverflow.com/questions/47674663/variable-arguments-inside-a-macro", "title": "Variable arguments inside a macro", "body": "<p>I have two functions foo1(a,b) &amp; foo2(a,b,c) and a macro</p>\n\n<pre><code>#define add(a,b) foo(a,b)\n</code></pre>\n\n<p>I need to re-define macro to accomplish, </p>\n\n<p>1.if add() is called with 2 parameters, then call foo1</p>\n\n<ol start=\"2\">\n<li>if add() is called with 3 parameters then call foo2</li>\n</ol>\n\n<p>Im new to the option VA_ARGS. How can I do that </p>\n"}, {"tags": ["c", "arrays", "quicksort", "qsort"], "comments": [{"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 1, "creation_date": 1512562946, "post_id": 47674203, "comment_id": 82307121, "body": "You have to show your effort."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1512563429, "post_id": 47674203, "comment_id": 82307401, "body": "Use <code>qsort()</code> from stdlib.h?"}, {"owner": {"reputation": 36, "user_id": 9061601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcf95e5e6e0ecd03cf874349b96bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo Resende", "link": "https://stackoverflow.com/users/9061601/hugo-resende"}, "edited": false, "score": 0, "creation_date": 1512563755, "post_id": 47674203, "comment_id": 82307598, "body": "Sorry, i wasn&#39;t explicit enough, I think its understandable now..."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1512564158, "post_id": 47674203, "comment_id": 82307868, "body": "You did provide correct number of elements: <code>3</code>. You <b>did not</b> provide the correct element size: <code>sizeof (int)</code>. As you want to sort arrays you have to provide the size of these arrays: <code>sizeof (int[2])</code>. I didn&#39;t check (nor can remember) whether this is correct syntax but <code>2 * sizeof (int)</code> should do as well. Btw. your <code>f</code> is not capable to sort (sub-)arrays. Any reason why you give <code>arr[0]</code> as first argument (instead of <code>arr</code>)? Though, I guess it shouldn&#39;t make a difference..."}, {"owner": {"reputation": 36, "user_id": 9061601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcf95e5e6e0ecd03cf874349b96bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo Resende", "link": "https://stackoverflow.com/users/9061601/hugo-resende"}, "edited": false, "score": 0, "creation_date": 1512564287, "post_id": 47674203, "comment_id": 82307952, "body": "Well I only want it to compare the first element, thats why I only gave it arr[0], but let me try it now"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1512564336, "post_id": 47674203, "comment_id": 82307983, "body": "@HugoResende It&#39;s not <code>qsort()</code> that&#39;s doing the comparison, it&#39;s you. You pass <code>qsort()</code> essentially a pointer to the first byte of your data, so you need to tell it where each element in that soup of data begins, and how many there are."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1512564518, "post_id": 47674203, "comment_id": 82308097, "body": "What you actually compare you decide in your <code>f</code> (the 4th arg. of <code>qsort()</code>) but the element size is considered in swapping. Therefore, if you want to sort sub-arrays you have to tell in the 3rd. arg. You may compare with a similar Q/A: <a href=\"https://stackoverflow.com/q/47607517/7478597\">SO: Sorting an array of integers in alternate fashion using qsort function.</a>"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1512564154, "creation_date": 1512564154, "answer_id": 47674577, "question_id": 47674203, "link": "https://stackoverflow.com/questions/47674203/c-sorting-2d-arrays-row-by-row-using-qsort/47674577#47674577", "title": "C: sorting 2d arrays row by row using qsort", "body": "<p>You're not sorting integers, you're sorting \"things\" that happen to be a number of integers in size.</p>\n\n<p>So, don't lie to <code>qsort()</code> about your element size:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic int cmprow(const void *a, const void *b)\n{\n    const int * const ia = a, * const ib = b;\n    return ia[0] &lt; ib[0] ? -1 : ia[0] &gt; ib[0];\n}\n\nint main(void) {\n    int arr[3][2]={{65,1},\n                   {45,2},\n                   {66,3}};\n\n    qsort(arr, sizeof arr / sizeof *arr, sizeof *arr, cmprow);\n    for (size_t i = 0; i &lt; sizeof arr / sizeof *arr; ++i)\n    {\n        for (size_t j = 0; j &lt; sizeof *arr / sizeof **arr; ++j)\n            printf(\"%d \", arr[i][j]);\n        putchar('\\n');\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>45 2 \n65 1 \n66 3 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512564823, "last_edit_date": 1512564823, "creation_date": 1512564380, "answer_id": 47674635, "question_id": 47674203, "link": "https://stackoverflow.com/questions/47674203/c-sorting-2d-arrays-row-by-row-using-qsort/47674635#47674635", "title": "C: sorting 2d arrays row by row using qsort", "body": "<p>Here is the problem:</p>\n\n<pre><code>qsort(arr[0],3,sizeof(int),f);\n</code></pre>\n\n<p>This function take <code>size_t</code> as the second argument. You have passed 3. Thats not the size, thats count of elements in the array <code>arr</code>. In a crude way, you need something like <code>3*sizeof(int)</code>. Or better <code>sizeof(arr) / sizeof *arr</code>.\nSo, change it to</p>\n\n<pre><code>qsort(arr, sizeof(arr) / sizeof *arr, sizeof(int), sizeof *arr, comparator);\n</code></pre>\n\n<p>With: </p>\n\n<pre><code>int comparator(const void *p, const void *q)\n{\n    // Get the values at given addresses\n    int l = *(const int *)p;\n    int r = *(const int *)q;\n\n    // both odd, put the greater of two first.\n    if ((l&amp;1) &amp;&amp; (r&amp;1))\n        return (r-l);\n\n    // both even, put the smaller of two first\n    if ( !(l&amp;1) &amp;&amp; !(r&amp;1) )\n        return (l-r);\n\n    // l is even, put r first\n    if (!(l&amp;1))\n        return 1;\n\n    // l is odd, put l first\n    return -1;\n}\n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 9061601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fcf95e5e6e0ecd03cf874349b96bf85?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo Resende", "link": "https://stackoverflow.com/users/9061601/hugo-resende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 47674577, "answer_count": 2, "score": -3, "last_activity_date": 1512564823, "creation_date": 1512562910, "last_edit_date": 1512563553, "question_id": 47674203, "link": "https://stackoverflow.com/questions/47674203/c-sorting-2d-arrays-row-by-row-using-qsort", "title": "C: sorting 2d arrays row by row using qsort", "body": "<p>So, what I'm trying to achieve here, is to use the C implementation of qsort in a 2d array, in witch I want only the rows to be sorted based on the its first element, for example:</p>\n\n<pre><code>        int arr[3][2]={{65,1},\n                       {45,2},\n                       {66,3}}\n</code></pre>\n\n<p>I want the output to be:</p>\n\n<pre><code>        int arr[3][2]={{45,2},\n                       {65,1},\n                       {66,3}}\n</code></pre>\n\n<p>Is there a way of doing this without implementing quicksort myself? If so, how?</p>\n\n<p>EDIT</p>\n\n<p>This is what my code looks like:</p>\n\n<pre><code>int f(int a, int b)\n{\nreturn a-b;\n}\n\nqsort(arr[0],3,sizeof(int),f);\n</code></pre>\n"}, {"tags": ["c", "dictionary", "macros", "embedded", "variadic"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1512563742, "post_id": 47674021, "comment_id": 82307587, "body": "Please don&#39;t use that macro, meta programming with macros is <i>horrible</i> programming practice. Use function pointers in a loop instead. Seriously."}, {"owner": {"reputation": 17, "user_id": 2175239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/632b123838143029fcf7a4225398fab3?s=128&d=identicon&r=PG", "display_name": "Riccardo Ancona", "link": "https://stackoverflow.com/users/2175239/riccardo-ancona"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512567557, "post_id": 47674021, "comment_id": 82310148, "body": "Hi Lundin, thanks for writing. I want to &quot;generate&quot; some code with X-Macros that have a variable argument list. I am not using them just to &quot;loop&quot;  :)"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 2175239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/632b123838143029fcf7a4225398fab3?s=128&d=identicon&r=PG", "display_name": "Riccardo Ancona", "link": "https://stackoverflow.com/users/2175239/riccardo-ancona"}, "edited": false, "score": 0, "creation_date": 1512993959, "post_id": 47683947, "comment_id": 82465495, "body": "Unfortunately I cannot use this solution because a should be another macro argument and is not known in advance."}], "tags": [], "owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "is_accepted": false, "score": 0, "last_activity_date": 1512596668, "creation_date": 1512596668, "answer_id": 47683947, "question_id": 47674021, "link": "https://stackoverflow.com/questions/47674021/embedded-c-how-to-apply-the-map-macro-to-two-arguments-at-a-time-instead-of-one/47683947#47683947", "title": "Embedded C: How to apply the MAP macro to two arguments at a time instead of one?", "body": "<p>Just call <code>MAP()</code> with a macro for the function name, where the macro expansion inserts your argument:</p>\n\n<pre><code>#define F(x) f(a,x)\n</code></pre>\n\n<p>Then in your function:</p>\n\n<pre><code>MAP(F, 1, 2, 3);\n</code></pre>\n\n<p>Result is:</p>\n\n<pre><code>f(a, 1); f(a, 2); f(a, 3);\n</code></pre>\n\n<p>(Not endorsing the approach, just providing an answer to the question.)</p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 2175239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/632b123838143029fcf7a4225398fab3?s=128&d=identicon&r=PG", "display_name": "Riccardo Ancona", "link": "https://stackoverflow.com/users/2175239/riccardo-ancona"}, "is_accepted": true, "score": -2, "last_activity_date": 1513862353, "creation_date": 1513862353, "answer_id": 47925885, "question_id": 47674021, "link": "https://stackoverflow.com/questions/47674021/embedded-c-how-to-apply-the-map-macro-to-two-arguments-at-a-time-instead-of-one/47925885#47925885", "title": "Embedded C: How to apply the MAP macro to two arguments at a time instead of one?", "body": "<p>In the end, it was clear that using C preprocessor is bad and should be avoided as much as possible in the real world.</p>\n\n<p>I decided to use auto-generation of code using python and <strong>COG</strong>, the <strong>CO</strong>de <strong>G</strong>enerator: <a href=\"https://nedbatchelder.com/code/cog/index.html#h_the_cog_module\" rel=\"nofollow noreferrer\">https://nedbatchelder.com/code/cog/index.html#h_the_cog_module</a> </p>\n\n<p>By wrapping python code inside a comment, I was able to selfgenerate all I wanted, no matter how complex it was.</p>\n\n<p>Much easier, flexible and 2017 friendly than relying on preprocessor.</p>\n"}], "owner": {"reputation": 17, "user_id": 2175239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/632b123838143029fcf7a4225398fab3?s=128&d=identicon&r=PG", "display_name": "Riccardo Ancona", "link": "https://stackoverflow.com/users/2175239/riccardo-ancona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 47925885, "answer_count": 2, "score": 2, "last_activity_date": 1513862353, "creation_date": 1512562272, "question_id": 47674021, "link": "https://stackoverflow.com/questions/47674021/embedded-c-how-to-apply-the-map-macro-to-two-arguments-at-a-time-instead-of-one", "title": "Embedded C: How to apply the MAP macro to two arguments at a time instead of one?", "body": "<p>I want to modify or use in a tricky way this <a href=\"https://github.com/swansontec/map-macro\" rel=\"nofollow noreferrer\">https://github.com/swansontec/map-macro</a> macro for using map in my C sources as follows:</p>\n\n<pre><code>MAP(f,1,2,3)\n   f(1)\n   f(2)\n   f(3)\n</code></pre>\n\n<p>into </p>\n\n<pre><code>MAP2(f,a,1,2,3)\n   f(a,1)\n   f(a,2)\n   f(a,3)\n</code></pre>\n\n<p>How should I?</p>\n"}, {"tags": ["c", "arrays", "hex", "offset"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1512561534, "post_id": 47673759, "comment_id": 82306316, "body": "Thats correct.."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1512561639, "post_id": 47673759, "comment_id": 82306381, "body": "I don&#39;t understand how you came up with <code>1..9</code> for the field <code>Timestamp</code>; it&#39;s size is specified as 15 so the relevant elements should be 15 and not 9, i.e. it&#39;s <code>0xF8, 0xFA, 0xFB, 0xCA, 0xAC, 0x24, 0x53, 0x64, 0x4F, 0x1E, 0xA2, 0xF9, 0x78, 0xCA, 0x63</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1512561640, "post_id": 47673759, "comment_id": 82306382, "body": "Almost, but you forget the <i>size</i>. And that the offsets are presented in <i>hexadecimal</i>. So that means the &quot;Info1&quot; field <i>starts</i> at <code>myArray[16]</code> (i.e. <code>myArray[0x10]</code>)."}, {"owner": {"reputation": 2291, "user_id": 3193876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e89e4aba2480e6a7ef021bfaceb9bdc5?s=128&d=identicon&r=PG&f=1", "display_name": "Ronald", "link": "https://stackoverflow.com/users/3193876/ronald"}, "edited": false, "score": 1, "creation_date": 1512561658, "post_id": 47673759, "comment_id": 82306393, "body": "Almost correct. The second field is 15 bytes long and goes from 0x01 .. 0x0F, not 0x09"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1512561696, "post_id": 47673759, "comment_id": 82306412, "body": "Incorrect because for offset 0x01, it&#39;s elements from 0x01 up to 0x10 in hexadecimal basis (size is 15, hexa 0xF), so elements 0xF8, 0xFA..., 0xCA, 0x63."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512563942, "post_id": 47673759, "comment_id": 82307720, "body": "I&#39;d look into mapping that data to a struct. Either by disabling padding or by de-serialization."}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1512564078, "post_id": 47673759, "comment_id": 82307818, "body": "Thanks, that makes sense. I misinterpreted some stuff :)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1512566560, "post_id": 47673759, "comment_id": 82309435, "body": "@Jean-BaptisteYun&#232;s Nearly correct. It is 0x01..0x0F, not 0x10."}], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 8570726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e2f75f037e8bafc2d8f2a7ad483c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Caio Sym", "link": "https://stackoverflow.com/users/8570726/caio-sym"}, "is_accepted": true, "score": 0, "last_activity_date": 1512562385, "last_edit_date": 1512562385, "creation_date": 1512561737, "answer_id": 47673852, "question_id": 47673759, "link": "https://stackoverflow.com/questions/47673759/calculate-hexadecimal-offset-within-array/47673852#47673852", "title": "calculate hexadecimal offset within array", "body": "<p>Your elements have a given size, as described by your size column. So basically what this tells you is:</p>\n\n<p><strong>Version</strong> starts at offset <strong>0x00</strong> (aka, position 0) and has a size of 1, so its the first element: <strong>0xCB</strong></p>\n\n<p><strong>Timestamp</strong> starts at offset <strong>0x01</strong> (aka, position 1) and has a size of 15, so its the combined elements: <strong>[0xF8, 0xFA, 0xFB, 0xCA, 0xAC, 0x24, 0x53, 0x64, 0x4F, 0x1E, 0xA2, 0xF9, 0x78, 0xCA, 0x63]</strong></p>\n\n<p><strong>Info1</strong> starts at offset <strong>0x10</strong> (aka, position 16) and has a size of 8, so its the combined elements: <strong>[0xB8, 0x7F, 0xFC, 0xFB, 0xD8, 0xFA, 0xFB, 0x8F]</strong></p>\n\n<p><strong>Info2</strong> starts at offset 0x18 (aka, position 24) and has a size of 2, so its the combined elements: <strong>[0x67, 0xC1]</strong></p>\n\n<p>And so it goes...</p>\n\n<p>One thing that you seem to be getting wrong in your analysis, as others have pointed out is that the offsets are in base 16 (hexadecimal). So 0x10 is 1 * 16 + 0 = 16.</p>\n\n<p>How to interpret each byte sequence as a proper type is up to you.</p>\n\n<p>Does this make sense?</p>\n"}], "owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 47673852, "answer_count": 1, "score": 0, "last_activity_date": 1512562385, "creation_date": 1512561436, "question_id": 47673759, "link": "https://stackoverflow.com/questions/47673759/calculate-hexadecimal-offset-within-array", "title": "calculate hexadecimal offset within array", "body": "<p>I know in general what  offsets are, but I have a question regarding offsets on the following array. Let's say I have a uint8 array:</p>\n\n<pre><code>   const myArray uint8[]=\n   {\n   0xCB, 0xF8, 0xFA, 0xFB, 0xCA, 0xAC, 0x24, 0x53, 0x64, 0x4F, 0x1E, 0xA2, \n   0xF9, 0x78, 0xCA, 0x63, 0xB8, 0x7F, 0xFC, 0xFB, 0xD8, 0xFA, 0xFB, 0x8F, \n   0x67, 0xC1, 0xFD, 0xF8, 0xC2, 0xF8, 0xFF, 0xF9, 0xFA, 0xE4, 0xFA, 0xF9,\n   0xFB, 0xFE, 0xE4, 0xFA, 0xCA, 0xCF, 0x94, 0xD5, 0xD6, 0xCA, 0xA2, 0xA2,\n   ....\n   ....\n   ....\n   ....\n}\n</code></pre>\n\n<p>Now I have description which says:</p>\n\n<pre><code>--------------------------------------------------\n| Offset in myArray | meaning     |  size (Byte) |\n--------------------------------------------------\n|    0x00           |  Version     |  1          |\n-------------------------------------------------\n|    0x01           |  Timestamp  |  15         |\n ------------------------------------------------\n|    0x10           |  Info1      |   8         |\n ------------------------------------------------\n|    0x18           |  Info2      |   2         |\n ------------------------------------------------\n</code></pre>\n\n<p>Does this in myArray mean:</p>\n\n<p>For offset 0x00: It's the element with index 0 of myArray, so 0xCB</p>\n\n<p>For offset 0x01: It's the element with index 1..9,so 0xF8, 0xFA, 0xFB, 0xCA, 0xAC, 0x24, 0x53, 0x64, 0x4F</p>\n\n<p>etc.</p>\n\n<p>Or do I interpret it wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 4, "creation_date": 1512561538, "post_id": 47673717, "comment_id": 82306318, "body": "<b>even prime numbers between 101 and 203</b>???"}, {"owner": {"reputation": 728, "user_id": 4628444, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S_tKKQ1s_PY/AAAAAAAAAAI/AAAAAAAAHU8/ph4sOcIgi0w/photo.jpg?sz=128", "display_name": "JoshKisb", "link": "https://stackoverflow.com/users/4628444/joshkisb"}, "edited": false, "score": 1, "creation_date": 1512561657, "post_id": 47673717, "comment_id": 82306392, "body": "did you intend to count or get the sum?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1512561763, "post_id": 47673717, "comment_id": 82306448, "body": "<code>sum += i</code> if <code>i</code> is prime..."}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 7241416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbasL.jpg?s=128&g=1", "display_name": "HerTesla", "link": "https://stackoverflow.com/users/7241416/hertesla"}, "edited": false, "score": 0, "creation_date": 1512562984, "post_id": 47673913, "comment_id": 82307146, "body": "So I think the result should be 3167"}], "tags": [], "owner": {"reputation": 66, "user_id": 7241416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbasL.jpg?s=128&g=1", "display_name": "HerTesla", "link": "https://stackoverflow.com/users/7241416/hertesla"}, "is_accepted": false, "score": 0, "last_activity_date": 1512562948, "last_edit_date": 1512562948, "creation_date": 1512561927, "answer_id": 47673913, "question_id": 47673717, "link": "https://stackoverflow.com/questions/47673717/the-sum-of-prime-numbers/47673913#47673913", "title": "The sum of prime numbers", "body": "<p>First of all: you do not need 'i++;' in your prime-method because this is unreachable code.</p>\n\n<p>Second: try this function for checking if a number is prime:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint prime(int n)\n{\n    for (int i = 2; i &lt; n; i++) {\n        if (n % i == 0 &amp;&amp; i != n) return 0;\n    }\n    return 1;\n}\n\nint main()\n{\n    int sum=0;\n    for (int i=101; i&lt;=203; i+=2) {\n        if (prime(i)==1){\n          sum+=i;\n        }\n    }\n    printf(\"%d \\n\",sum);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512566621, "post_id": 47673978, "comment_id": 82309480, "body": "There is such a thing as even prime numbers."}, {"owner": {"reputation": 21, "user_id": 8193349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5867cc5ca3c226c5a0216d607b2b158b?s=128&d=identicon&r=PG&f=1", "display_name": "HasibM", "link": "https://stackoverflow.com/users/8193349/hasibm"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512579417, "post_id": 47673978, "comment_id": 82318292, "body": "The is one possible even number, two. As far as I am aware, two does not fall in the range they are looking for."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512579722, "post_id": 47673978, "comment_id": 82318474, "body": "So say that in the answer."}], "tags": [], "owner": {"reputation": 21, "user_id": 8193349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5867cc5ca3c226c5a0216d607b2b158b?s=128&d=identicon&r=PG&f=1", "display_name": "HasibM", "link": "https://stackoverflow.com/users/8193349/hasibm"}, "is_accepted": false, "score": 0, "last_activity_date": 1512564604, "last_edit_date": 1512564604, "creation_date": 1512562127, "answer_id": 47673978, "question_id": 47673717, "link": "https://stackoverflow.com/questions/47673717/the-sum-of-prime-numbers/47673978#47673978", "title": "The sum of prime numbers", "body": "<p>THERE ARE NO SUCH THING AS EVEN PRIME NUMBERS... YOU WILL ALWAYS GET 0.</p>\n\n<p>But to really answer your question...</p>\n\n<p>You really don't need to put i++ in your first function. Secondly, try this</p>\n\n<pre><code>for (int i=101; i&lt;=203; i++)\n{\n   i++\n   if (prime(i)==1)\n   {\n     sum+=i;\n   }\n}\n</code></pre>\n\n<p>This should work. You don't need to increment sum by 1, you need to add i each time there is a prime number. The reason why you get 52 is because you do sum+=1, which adds 1 to sum 52 times in the for loop.</p>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1512562534, "last_edit_date": 1512562534, "creation_date": 1512562176, "answer_id": 47673993, "question_id": 47673717, "link": "https://stackoverflow.com/questions/47673717/the-sum-of-prime-numbers/47673993#47673993", "title": "The sum of prime numbers", "body": "<p>There are several problems in your code.</p>\n\n<p>In the <code>for</code> loop:</p>\n\n<pre><code>    for (int i=101; i&lt;=203; i+=2) {\n    if (prime(i)==1){\n    }sum+=1;\n</code></pre>\n\n<p>The statement <code>sum+=1</code> should be inside the <code>if</code> block.</p>\n\n<p>Also, you are adding <code>1</code> to <code>sum</code>. Instead, you should add <code>i</code> as you want the sum of prime numbers as result:</p>\n\n<pre><code>sum+=i;\n</code></pre>\n\n<p>The function <code>prime()</code> should return <code>1</code> only when <code>while</code> loop checks condition <code>n%i == 0</code> for all the values of <code>i</code> and for none of the value of <code>i</code> it is <code>true</code>. So, you need to move <code>return 1</code> to out of the <code>while</code> loop.</p>\n\n<p>Also, in the <code>while</code> loop in <code>prime()</code> this is incorrect:</p>\n\n<pre><code>while (1&lt;=n2) {\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>while (i&lt;=n2) {\n</code></pre>\n\n<p>Collectively, it should be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint prime(int n)\n{\n    int i=2;\n    int n2;\n    n2 = n/2;\n    while (i&lt;=n2) {\n        if (n%i == 0) {\n            return 0;\n        }\n        i++;\n   }\n   return 1;\n}\n\nint main()\n{\n    int sum=0;\n    for (int i=101; i&lt;=203; i+=2) {\n        if (prime(i)==1){\n            sum+=i;\n        }\n    }\n\n    printf(\"%d \\n\",sum);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7359946, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a007f195fdf93a9c897c537d61c366b9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Atiyah", "link": "https://stackoverflow.com/users/7359946/a-atiyah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1512564604, "creation_date": 1512561342, "last_edit_date": 1512562616, "question_id": 47673717, "link": "https://stackoverflow.com/questions/47673717/the-sum-of-prime-numbers", "title": "The sum of prime numbers", "body": "<p>I want to calculate the sum of even prime numbers between 101 and 203. But the output for my code is wrong, the output is 52.\nCan anyone help me please to get the correct output, in my code I supposed that the even numbers are sure not prime that's why I escaped them. I want to solve it using this method by the prime function. What should I do? Thank you a lot </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint prime(int n)\n{\n    int i=2;\n    int n2;\n    n2 = n/2;\n    while (1&lt;=n2) {\n        if (n%i == 0) {\n            return 0;\n        } else {\n            return 1;\n        }\n        i++;\n    }\n}\n\nint main()\n{\n    int sum=0;\n    for (int i=101; i&lt;=203; i+=2) {\n        if (prime(i)==1) {\n        }\n        sum+=1;\n    }\n    printf(\"%d \\n\",sum);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "arm", "corruption", "stm32f4"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1512563155, "post_id": 47673522, "comment_id": 82307245, "body": "If you break at the first instruction after a reset (often an assembly label called <code>Reset_Handler</code>), and inspect the flash, is it still corrupted on the next run after this happens? If no (which I <i>strongly</i> suspect), this points at some runtime error which simply makes the flash look broken, i.e. flash reads are failing. What frequency is the PLL at when you switch to it? Is is stable and all that? Also, consider switching to Cube."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512564056, "post_id": 47673522, "comment_id": 82307806, "body": "Also, note that many debuggers fail to adapt when you change the clock source on the fly."}, {"owner": {"reputation": 1, "user_id": 9061366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee07e55e2c0b2cd9959f2244ced4b679?s=128&d=identicon&r=PG&f=1", "display_name": "MBr", "link": "https://stackoverflow.com/users/9061366/mbr"}, "edited": false, "score": 0, "creation_date": 1512568261, "post_id": 47673522, "comment_id": 82310626, "body": "Just did this. Indeed the flash does not look corrupted anymore. What can cause this? Can it be the flash not keeping up with the PLL&#39;s frequency? I&#39;ve tried upping the Flash Wait State to 11 cycles instead of 6, to no avail. How can I test for PLL stability? I&#39;ll look into Cube."}, {"owner": {"reputation": 1, "user_id": 9061366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee07e55e2c0b2cd9959f2244ced4b679?s=128&d=identicon&r=PG&f=1", "display_name": "MBr", "link": "https://stackoverflow.com/users/9061366/mbr"}, "edited": false, "score": 0, "creation_date": 1512568611, "post_id": 47673522, "comment_id": 82310859, "body": "The main issue is not a debugger issue at this point: running the program without debugger, the processor doesn&#39;t go into main() if the PLL is selected as the main clock source. Using HSE, main() runs correctly and the LEDs blink as I&#39;ve programmed them. I&#39;ll keep your remark in mind nonetheless."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512564745, "post_id": 47674446, "comment_id": 82308244, "body": "This particular part apparently specifies max clock 30MHz for zero wait states and supply 3.3V. (The manual chapter 6.3.1 table 17)"}, {"owner": {"reputation": 1, "user_id": 9061366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee07e55e2c0b2cd9959f2244ced4b679?s=128&d=identicon&r=PG&f=1", "display_name": "MBr", "link": "https://stackoverflow.com/users/9061366/mbr"}, "edited": false, "score": 0, "creation_date": 1512569993, "post_id": 47674446, "comment_id": 82311773, "body": "The clock source and flash latency are set in system_stm32f4xx.c, which I haven&#39;t written. Two lines above the faulting line, the source reads: <code>FLASH-&gt;ACR = FLASH_ACR_PRFTEN | FLASH_ACR_ICEN |FLASH_ACR_DCEN |FLASH_ACR_LATENCY_5WS;</code> I tried using <code>FLASH_ACR_LATENCY_15WS</code>, to no avail."}], "tags": [], "owner": {"reputation": 7207, "user_id": 410847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a354e99dd64adf823aa72c4ee22a1fc?s=128&d=identicon&r=PG", "display_name": "Turbo J", "link": "https://stackoverflow.com/users/410847/turbo-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1512563715, "creation_date": 1512563715, "answer_id": 47674446, "question_id": 47673522, "link": "https://stackoverflow.com/questions/47673522/on-the-stm32f4-why-does-setting-the-main-clock-source-as-the-pll-corrupt-the-re/47674446#47674446", "title": "On the STM32F4, why does setting the main clock source as the PLL corrupt the rest of the program?", "body": "<blockquote>\n  <p>I've narrowed down the issue to a str instruction in the SetSysClock function:</p>\n</blockquote>\n\n<p>That usually means you forgot to set the flash wait states before. Flash memory ist rather slow - it tops usually at around 20 MHz without wait states for many MCUs. Trying to run it too fast result in reading garbage.</p>\n\n<p>Reference Manual and datasheet should state how many wait states your target frequency requires for flash access. Note: It is safe (but slower) to run the flash at maximum wait states.</p>\n"}], "owner": {"reputation": 1, "user_id": 9061366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee07e55e2c0b2cd9959f2244ced4b679?s=128&d=identicon&r=PG&f=1", "display_name": "MBr", "link": "https://stackoverflow.com/users/9061366/mbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512563715, "creation_date": 1512560758, "question_id": 47673522, "link": "https://stackoverflow.com/questions/47673522/on-the-stm32f4-why-does-setting-the-main-clock-source-as-the-pll-corrupt-the-re", "title": "On the STM32F4, why does setting the main clock source as the PLL corrupt the rest of the program?", "body": "<p>first question here, thank you for your patience.</p>\n\n<p>I'm facing an issue with an STM32F446VET6-based board (the ST-B96B-F446VE from STMicroelectronics), using the StdPeriph library v1.8.0. I've narrowed down the issue to a <code>str</code> instruction in the SetSysClock function:</p>\n\n<pre><code>;722          RCC-&gt;CFGR |= RCC_CFGR_SW_PLL;\n; RCC-&gt;CFGR = 0x9400\n; RCC_CFGR_SW_PLL = 0x02\nldr r2, [pc, #36]   ; (0x80005a8 &lt;SetSysClock+284&gt;)\nldr r3, [pc, #36]   ; (0x80005a8 &lt;SetSysClock+284&gt;)\nldr r3, [r3, #8]\norr.w   r3, r3, #2\nstr r3, [r2, #8]    ; r2 = 0x40023800, r3 = 0x9402\n</code></pre>\n\n<p>The instruction result should be that the second bit of RCC->CFGR (SW1) be set to 1, in order to set up the PLL as the main clock source.</p>\n\n<p>Instead, the bit stays at 0, and a whole lot of code past 0x08000000 (in the flash) is overwritten. For instance, this line in SystemInit():</p>\n\n<pre><code>; SCB-&gt;VTOR = FLASH_BASE | VECT_TAB_OFFSET; /* Vector Table Relocation in Internal FLASH */\nldr     r3, [pc, #12]   ; (0x8000484 &lt;SystemInit+96&gt;)\nmov.w   r2, #134217728  ; 0x8000000\nstr     r2, [r3, #8]\n</code></pre>\n\n<p>ends up rewritten as:</p>\n\n<pre><code>; SCB-&gt;VTOR = FLASH_BASE | VECT_TAB_OFFSET; /* Vector Table Relocation in Internal FLASH */\nbic.w   r3, r3, #262144 ; 0x40000\nstr     r3, [r2, #0]\nldr     r3, [pc, #24]   ; (0x8000494 &lt;SetSysClock+8&gt;)\n</code></pre>\n\n<p>Letting the program run in this state and pausing it again shows some more overwriting happened, again at the same lines:</p>\n\n<pre><code>; SCB-&gt;VTOR = FLASH_BASE | VECT_TAB_OFFSET; /* Vector Table Relocation in Internal FLASH */\nb.n     0x8000476 &lt;SystemInit+86&gt;\nsubs    r0, #0\nands    r2, r0\n</code></pre>\n\n<p>and it hangs in the subs and ands instructions.</p>\n\n<p>Incidentally, replacing the line <code>RCC-&gt;CFGR |= RCC_CFGR_SW_PLL;</code> by <code>RCC-&gt;CFGR |= RCC_CFGR_SW_HSE;</code> resolves the issue. No corruption happens, and main() executes properly. But now it's using another clock source, with no idea what implications this carries.</p>\n\n<hr>\n\n<p>Is there some way to revert to the default state of using the PLL as the main clock source, and avoid the flash corruption?</p>\n"}, {"tags": ["c", "microcontroller", "stm32"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1512560812, "post_id": 47673509, "comment_id": 82305867, "body": "What microcontroller? Using what language? This is too broad."}, {"owner": {"reputation": 1, "user_id": 5916993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e647685c6f8b913ddc17e6adbca93a?s=128&d=identicon&r=PG&f=1", "display_name": "0412PA", "link": "https://stackoverflow.com/users/5916993/0412pa"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1512560969, "post_id": 47673509, "comment_id": 82305978, "body": "Microcontroller : STM32F series, Language : C."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1512561221, "post_id": 47673509, "comment_id": 82306136, "body": "Please <a href=\"https://stackoverflow.com/posts/47673509/edit\">edit</a> your post to tag such relevant facts, so that it&#39;s clear what you&#39;re asking, and people skilled in those topics can find the question."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1512563672, "post_id": 47673509, "comment_id": 82307548, "body": "Is the JPEG file a constant that you have at build time?  Or is it a variable that is produced at run time?"}, {"owner": {"reputation": 1, "user_id": 5916993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e647685c6f8b913ddc17e6adbca93a?s=128&d=identicon&r=PG&f=1", "display_name": "0412PA", "link": "https://stackoverflow.com/users/5916993/0412pa"}, "edited": false, "score": 0, "creation_date": 1512564395, "post_id": 47673509, "comment_id": 82308029, "body": "JPEG file is a constant, which will be available during build time."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1512584491, "post_id": 47673509, "comment_id": 82321117, "body": "a jpeg file is just bits and bytes, why are you struggling to put bits and bytes on the flash in a way your program can access?  there is no operating system so it is up to you to embed it into the application."}, {"owner": {"reputation": 698, "user_id": 1981374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd547bb1f448490439e0093eba3a70?s=128&d=identicon&r=PG", "display_name": "pan-mroku", "link": "https://stackoverflow.com/users/1981374/pan-mroku"}, "edited": false, "score": 0, "creation_date": 1571669925, "post_id": 47673509, "comment_id": 103308305, "body": "Hi @0412PA If this question has been solved by the answer please consider <a href=\"https://meta.stackexchange.com/q/5234/179419\">accepting it</a> by clicking the check-mark. This indicates to the wider community that you&#39;ve found a solution and gives some reputation to both the answerer and yourself. There is no obligation to do this."}], "answers": [{"tags": [], "owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "is_accepted": false, "score": 1, "last_activity_date": 1512572349, "creation_date": 1512572349, "answer_id": 47677290, "question_id": 47673509, "link": "https://stackoverflow.com/questions/47673509/how-to-store-raw-jpeg-image-into-the-internal-flash-of-stm32f2-series-microcontr/47677290#47677290", "title": "How to store raw jpeg image into the internal flash of STM32F2 series microcontroller using Embedded C?", "body": "<p>Generally, one method is to define a constant array which is initialized with the data from the JPEG (or any binary) file.  Then that array definition gets linked with your code and becomes a part of the firmware programmed to flash.  If desired, you can use linker directives to locate the array (i.e., the file data) at a specific address in flash.</p>\n\n<p>You can accomplish this general idea in many different ways.  Below is just one specific example implementation of this technique.</p>\n\n<p>First, create a desktop program that reads the JPEG file as a stream of bytes and writes those bytes into a new comma separated text file.  Here are the first two lines of an example file, I'll call <code>my_jpeg.h</code>:</p>\n\n<pre><code>0xFF, 0xD8, 0xFF, 0xE0, 0x00, 0x10, 0x4A, 0x46, 0x49, 0x46, 0x00, 0x01, 0x01, 0x01, 0x00, 0x48,\n0x00, 0x48, 0x00, 0x00, 0xFF, 0xE1, 0x03, 0xA0, 0x00, 0x01, 0x69, 0x48, 0x00, 0x4D, 0x4D, 0x46,\n</code></pre>\n\n<p>Then define an array in your C code and initialize it with the data from the file you created.</p>\n\n<pre><code>const uint8_t my_jpeg[] = {\n    #include \"my_jpeg.h\"\n};\n</code></pre>\n\n<p>Now all that JPEG file data will be included in your firmware and be programmed to flash when you program the firmware.</p>\n\n<p>You could use a makefile recipe or your IDE's pre-build batch script feature to run your JPEG conversion program automatically and produce <code>my_jpeg.h</code> during the build.</p>\n"}], "owner": {"reputation": 1, "user_id": 5916993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e647685c6f8b913ddc17e6adbca93a?s=128&d=identicon&r=PG&f=1", "display_name": "0412PA", "link": "https://stackoverflow.com/users/5916993/0412pa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1512572349, "creation_date": 1512560724, "last_edit_date": 1512564712, "question_id": 47673509, "link": "https://stackoverflow.com/questions/47673509/how-to-store-raw-jpeg-image-into-the-internal-flash-of-stm32f2-series-microcontr", "title": "How to store raw jpeg image into the internal flash of STM32F2 series microcontroller using Embedded C?", "body": "<p>I have a .JPEG file which I need to store into internal memory of the STM32F2 series controller. Is this possible to do without any conversion/encoding the JPEG file? If so can anyone please provide some sample code for my understanding.</p>\n"}, {"tags": ["c", "pointers", "dynamic", "char"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 1, "creation_date": 1512560876, "post_id": 47673502, "comment_id": 82305910, "body": "<code>printf(&quot;%s&quot;, &amp;caracter);</code> --&gt;&gt; Addresses are not strings. If you want to print the address of variable or pointer, or address of anything in C, you should use <code>%p</code> in <code>printf()</code>. <code>%s</code> format specifier is specifically for strings."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1512560922, "post_id": 47673502, "comment_id": 82305951, "body": "<code>*ptr = realloc(*ptr,bloques * tamanho);</code> this is generally a bad idea. Always use a temporary, check for <code>NULL</code> and then assign. Else you might have a leak."}, {"owner": {"reputation": 15, "user_id": 8863098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c808768a161f9d869df03204278e915?s=128&d=identicon&r=PG&f=1", "display_name": "user8863098", "link": "https://stackoverflow.com/users/8863098/user8863098"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1512562462, "post_id": 47673502, "comment_id": 82306858, "body": "@AjayBrahmakshatriya Thank you for your advice!"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1512562474, "post_id": 47673502, "comment_id": 82306865, "body": "<code>scanf(&quot;%s&quot;, &amp;scaneado)</code> --&gt; <code>scanf(&quot;%s&quot;, scaneado)</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512562704, "post_id": 47673502, "comment_id": 82306995, "body": "<code>reallocarDimensiones(1,&amp;scaneado[cont],sizeof(char));</code> -- what is going on here? <code>&amp;scaneado[cont]</code> is a pointer to <code>char</code>, yet <code>reallocarDimensiones()</code> takes a <code>void **</code> argument."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8863098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c808768a161f9d869df03204278e915?s=128&d=identicon&r=PG&f=1", "display_name": "user8863098", "link": "https://stackoverflow.com/users/8863098/user8863098"}, "edited": false, "score": 0, "creation_date": 1512561369, "post_id": 47673622, "comment_id": 82306212, "body": "For the first thing you pointed out, I first didn&#39;t use the &quot;&amp;&quot;, but that way it doesn&#39;t even print it for some reason. For the second thing you pointed out, it does need to be a double pointer, since it is a void pointer, otherwise it doesn&#39;t work. You can run my code, it does run. If you modify those parts, you&#39;ll see."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 15, "user_id": 8863098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c808768a161f9d869df03204278e915?s=128&d=identicon&r=PG&f=1", "display_name": "user8863098", "link": "https://stackoverflow.com/users/8863098/user8863098"}, "edited": false, "score": 0, "creation_date": 1512561426, "post_id": 47673622, "comment_id": 82306243, "body": "@user8863098: Yes, I do agree about me getting it wrong with double pointers, thats why I removed that part from the answer."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1512561447, "post_id": 47673622, "comment_id": 82306253, "body": "<i>&quot;it does run&quot;</i> doesn&#39;t mean &#39;it is correct or well-defined&#39;."}, {"owner": {"reputation": 15, "user_id": 8863098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c808768a161f9d869df03204278e915?s=128&d=identicon&r=PG&f=1", "display_name": "user8863098", "link": "https://stackoverflow.com/users/8863098/user8863098"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1512562789, "post_id": 47673622, "comment_id": 82307038, "body": "@underscore_d I didn&#39;t say it worked. I just only said exactly that it &quot;Runs&quot;. If it worked I would not be asking for help LOL"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 15, "user_id": 8863098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c808768a161f9d869df03204278e915?s=128&d=identicon&r=PG&f=1", "display_name": "user8863098", "link": "https://stackoverflow.com/users/8863098/user8863098"}, "edited": false, "score": 0, "creation_date": 1512563030, "post_id": 47673622, "comment_id": 82307172, "body": "@user8863098 -- underscore_d didn&#39;t say that you said that it works. That the posted code runs is meaningless; it is filled with undefined behavior, which is what &quot;doesn&#39;t mean &#39;it is correct or well-defined&#39;&quot; was getting at."}, {"owner": {"reputation": 15, "user_id": 8863098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c808768a161f9d869df03204278e915?s=128&d=identicon&r=PG&f=1", "display_name": "user8863098", "link": "https://stackoverflow.com/users/8863098/user8863098"}, "edited": false, "score": 0, "creation_date": 1512563041, "post_id": 47673622, "comment_id": 82307185, "body": "@WedaPashi the lector I used is just for checking wheter the user pressed &quot;\\n&quot;, and if it is end of whatever the user wrote, that&#39;s it."}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512563864, "last_edit_date": 1512563864, "creation_date": 1512561057, "answer_id": 47673622, "question_id": 47673502, "link": "https://stackoverflow.com/questions/47673502/how-to-make-a-dynamic-char/47673622#47673622", "title": "How to make a dynamic char?", "body": "<p>I see something wrong here:</p>\n\n<pre><code>printf(\"%s\", &amp;caracter);//I want to now why this doesn't print\n</code></pre>\n\n<p><code>caracter</code> is a <code>char</code> pointer. By using <code>&amp;</code> with <code>caracter</code> you are trying to access the address of the <code>char</code> pointer, and not the contents to which the pointer is pointing.</p>\n\n<p>Change it to </p>\n\n<pre><code>printf(\"%s\", caracter);\n</code></pre>\n\n<p>Secondly, what is <code>lector</code> initialized to before it is used? See here:</p>\n\n<pre><code>while((strcpy(lector,getchar())) !='\\n' &amp;&amp; lector!=EOF)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 0, "last_activity_date": 1512563421, "last_edit_date": 1512563421, "creation_date": 1512563168, "answer_id": 47674287, "question_id": 47673502, "link": "https://stackoverflow.com/questions/47673502/how-to-make-a-dynamic-char/47674287#47674287", "title": "How to make a dynamic char?", "body": "<p>This simplifies the code to one function to capture input until a newline. Memory is allocated on each character.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nchar *generarCadena(char *);\n\nint main(void){\n    char *caracter=NULL;//so realloc will operate as malloc on first call\n    caracter = generarCadena ( caracter);\n    printf(\"%zu\\n\", sizeof(caracter));\n    if ( caracter) {//something was input\n        printf(\"%s\\n\", caracter);\n        free ( caracter);\n    }\n    return 0;\n}\n\nchar *generarCadena(char *scaneado){\n    char *temp = NULL;\n    int in = 0;\n    size_t size = 0;\n\n    while ( '\\n' != ( in = getchar ( ))) {//loop until newline\n        if ( NULL == ( temp = realloc ( scaneado, size + 2))) {//realloc for each character input and '\\0'\n            fprintf ( stderr, \"realloc problem\\n\");\n            return scaneado;\n        }\n        scaneado = temp;\n        scaneado[size] = in;//set input\n        scaneado[size + 1] = '\\0';//terminate\n        size++;\n    }\n    return scaneado;\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8863098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c808768a161f9d869df03204278e915?s=128&d=identicon&r=PG&f=1", "display_name": "user8863098", "link": "https://stackoverflow.com/users/8863098/user8863098"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 47674287, "answer_count": 2, "score": 0, "last_activity_date": 1512563864, "creation_date": 1512560693, "question_id": 47673502, "link": "https://stackoverflow.com/questions/47673502/how-to-make-a-dynamic-char", "title": "How to make a dynamic char?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid generarCadena(char *);\nvoid generarDimension(int, void **, int);\nvoid reallocarDimensiones(int , void **, int);\n\nint main(void){\n    char *caracter=NULL;\n    generarCadena(&amp;caracter);\n    printf(\"%d\", sizeof(caracter));\n    printf(\"%s\", &amp;caracter);//I want to now why this doesn't print\n    return 0;\n}\n\nvoid generarCadena(char *scaneado){\n    unsigned int cont;\n    char lector;\n    generarDimension(1,&amp;scaneado,sizeof(char));\n    cont = 0;\n    while(!scanf(\"%s\", &amp;scaneado)){\n        while((strcpy(lector,getchar())) !='\\n' &amp;&amp; lector!=EOF){\n           reallocarDimensiones(1,&amp;scaneado[cont],sizeof(char));\n           cont++;\n        }\n    }\n    printf(\"%s\", &amp;scaneado);/*Inside de function it prints, \n    however, it doesn't print outside it*/\n}//This function is for the dynamic char\n\nvoid generarDimension(int bloques, void **ptr, int tamanho){\n    *ptr = malloc(bloques * tamanho);\n    if(*ptr==NULL){\n        printf(\"No se pudo almacenar memoria\\n\");\n    }\n}//This function mallocs any given pointer\nvoid reallocarDimensiones(int bloques, void **ptr, int tamanho){\n    *ptr = realloc(*ptr,bloques * tamanho);\n    if(*ptr==NULL){\n        printf(\"No se pudo almacenar memoria\\n\");\n    }\n}//This function reallocs any given pointer\n</code></pre>\n\n<p>Hi, I want to now how to dynamically store a char while writting it on the keyboard, so I made a function for it. I want to send a char pointer in it, but it doesn't seem to modify it. Another problem I have is that my function only stores a few data, so if the data is to long, my program crashes.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 0, "creation_date": 1512560277, "post_id": 47673342, "comment_id": 82305578, "body": "Just write &quot;&lt;foo&gt;bar&lt;/foo&gt;&quot; in a loop a couple of million times?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1512560287, "post_id": 47673342, "comment_id": 82305584, "body": "How about a loop printing smaller chunks?"}, {"owner": {"reputation": 29, "user_id": 2406009, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2cc8e2205f85c52e7b384336d88e9f4d?s=128&d=identicon&r=PG", "display_name": "Frazz", "link": "https://stackoverflow.com/users/2406009/frazz"}, "edited": false, "score": 0, "creation_date": 1512567160, "post_id": 47673342, "comment_id": 82309850, "body": "Maybe append until the 1st &lt;data&gt; tag and then insert random chars? and at the end finalise it with the rest of the tags? I&#39;ll have a try."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 2406009, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2cc8e2205f85c52e7b384336d88e9f4d?s=128&d=identicon&r=PG", "display_name": "Frazz", "link": "https://stackoverflow.com/users/2406009/frazz"}, "is_accepted": true, "score": 0, "last_activity_date": 1512639237, "creation_date": 1512639237, "answer_id": 47691810, "question_id": 47673342, "link": "https://stackoverflow.com/questions/47673342/how-to-generate-an-xml-file-in-c-of-1gb/47691810#47691810", "title": "How to generate an xml file in C of 1GB", "body": "<p>I solved it by creating three files. </p>\n\n<p>One with the xml until the opening of the tag in which the data should reside.\nThe second with the generated junk data.\nThe third with the close tag of the bulk data en the rest of the xml.</p>\n\n<p>Like so: </p>\n\n<pre><code>   // Open two files to be merged\n   FILE *fp1 = fopen(\"person1.xml\", \"r\");\n   FILE *fp2 = fopen(\"randomdata.txt\", \"r\");\n   FILE *fp3 = fopen(\"person3.xml\", \"r\");\n\n\n   // Open file to store the result\n   FILE *fp4 = fopen(\"personf.xml\", \"w\");\n   char c;\n\n   if (fp1 == NULL || fp2 == NULL || fp3 == NULL || fp4 == NULL)\n   {\n         puts(\" --- Could not open files\");\n         exit(0);\n   }\n\n   // Copy contents of first file1\n   while ((c = fgetc(fp1)) != EOF)\n      fputc(c, fp4);\n\n   printf(\" --- Done copying file 1\\n\");\n   // Copy contents of first file2\n   while ((c = fgetc(fp2)) != EOF)\n      fputc(c, fp4);\n\n   printf(\" --- Done copying file 2\\n\");\n\n   // Copy contents of first file3\n   while ((c = fgetc(fp3)) != EOF)\n      fputc(c, fp4);\n\n   printf(\" --- Done copying file 3\\n\");\n\n   printf(\"Merged files\\n\");\n\n   fclose(fp1);\n   fclose(fp2);\n   fclose(fp3);\n   fclose(fp4);\n   return 0;\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 2406009, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2cc8e2205f85c52e7b384336d88e9f4d?s=128&d=identicon&r=PG", "display_name": "Frazz", "link": "https://stackoverflow.com/users/2406009/frazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47691810, "answer_count": 1, "score": -5, "last_activity_date": 1512639237, "creation_date": 1512560168, "last_edit_date": 1512639145, "question_id": 47673342, "link": "https://stackoverflow.com/questions/47673342/how-to-generate-an-xml-file-in-c-of-1gb", "title": "How to generate an xml file in C of 1GB", "body": "<p>I don't know who to generate 1GB of data within a tag of XML.\nI want to generate a line of data within the data text of 1GB of size\nHow can I realise this in the most efficient (speed-wise) way.\nThe data should be readable (can be nonsense of course)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    printf(\" --- Creating XML\");\n\n    FILE *fptr;\n\n    /*  open for writing */\n    fptr = fopen(\"/tmp/emp.xml\", \"w\");\n\n    if (fptr == NULL)\n    {\n            printf(\"File does not exists \\n\");\n            return 1;\n    }\n\n\n    fprintf(fptr, \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"yes\\\"?&gt;\\n\");\n    fprintf(fptr, \"&lt;customer id=\\\"100\\\"&gt;\\n\");\n    fprintf(fptr, \"    &lt;age&gt;25&lt;/age&gt;\\n\");\n    fprintf(fptr, \"    &lt;name&gt;New Customer&lt;/name&gt;\\n\");\n    fprintf(fptr, \"    &lt;data&gt;dhgdhgdkrjgndliutghdnkljtghdliuthgdithugdnk...1GB_LONG&lt;data&gt;\\n\");\n    fprintf(fptr, \"&lt;/customer&gt;\");\n\n    fclose(fptr);\n}\n</code></pre>\n"}, {"tags": ["c", "perl", "static-analysis", "scitools"], "comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1512560851, "post_id": 47673327, "comment_id": 82305900, "body": "Did you try <code>grep -n</code>?"}, {"owner": {"reputation": 91, "user_id": 8493544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f4539639584aec545c86113861b4a7b?s=128&d=identicon&r=PG&f=1", "display_name": "EnsieT", "link": "https://stackoverflow.com/users/8493544/ensiet"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1512561125, "post_id": 47673327, "comment_id": 82306078, "body": "Dear @cdarke , Thanks for the quick response. Once I get the lexeme, then I can look for the substring using grep etc.. Thing is , I&#39;m not sure , if there is a lexer that I can loop in the entire .c file and even if it is possible, I believe it would not be efficient. Have you already used  Understand for c/c++?"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1512561305, "post_id": 47673327, "comment_id": 82306175, "body": "I know Perl and I know C and C++, but I don&#39;t know Understand, sorry."}, {"owner": {"reputation": 91, "user_id": 8493544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f4539639584aec545c86113861b4a7b?s=128&d=identicon&r=PG&f=1", "display_name": "EnsieT", "link": "https://stackoverflow.com/users/8493544/ensiet"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1512561511, "post_id": 47673327, "comment_id": 82306299, "body": "no problem. Thanks anyways @cdarke."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1512568646, "post_id": 47673327, "comment_id": 82310885, "body": "<b>cdarke</b> is referring to the <i>command line</i> <code>grep</code> tool. There is no need to involve Understand just to find a string in some files."}, {"owner": {"reputation": 91, "user_id": 8493544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f4539639584aec545c86113861b4a7b?s=128&d=identicon&r=PG&f=1", "display_name": "EnsieT", "link": "https://stackoverflow.com/users/8493544/ensiet"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1512570237, "post_id": 47673327, "comment_id": 82311951, "body": "Thanks @Borodin. Well, I understand what you say but thing is, the perl script is just one small part of another process. So, lot of other things are involved inside and outside of the script including how it is being executed. That&#39;s the reason why I would like to insert a small functionality inside the existing script. Hope you got my point."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1512582615, "post_id": 47673327, "comment_id": 82320173, "body": "Especially with something obscure, you&#39;ll need to do better than that. Add a link to Understand&#39;s docs, code that does something similar, etc"}, {"owner": {"reputation": 91, "user_id": 8493544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f4539639584aec545c86113861b4a7b?s=128&d=identicon&r=PG&f=1", "display_name": "EnsieT", "link": "https://stackoverflow.com/users/8493544/ensiet"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1512600516, "post_id": 47673327, "comment_id": 82329129, "body": "Sorry @ikegami , added link to online manual including sample codes in the description."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1512680694, "post_id": 47673327, "comment_id": 82367612, "body": "What problem are you having? Getting the entity, or searching a string for another string?"}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 0, "last_activity_date": 1512680992, "creation_date": 1512680992, "answer_id": 47703824, "question_id": 47673327, "link": "https://stackoverflow.com/questions/47673327/how-to-find-a-specific-string-in-a-c-file-using-the-perl-api-of-scitools-unde/47703824#47703824", "title": "How to find a specific string in a .c file using the perl api of (Scitools) Understand?", "body": "<p>Sounds like you simply want</p>\n\n<pre><code>  use Understand qw( );\n\n  my $db = Understand::open(\"test.udb\");\n\n  # Find all 'File' entities that match test*.cpp\n  for my $file_ent ($db-&gt;lookup(\"test*.cpp\",\"File\")) {\n       my $file_contents = $file_ent-&gt;contents();\n       printf \"File %s matches\", $file_ent-&gt;name\n          if $file_contents =~ /pattern/;\n  }\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 8493544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f4539639584aec545c86113861b4a7b?s=128&d=identicon&r=PG&f=1", "display_name": "EnsieT", "link": "https://stackoverflow.com/users/8493544/ensiet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1512680992, "creation_date": 1512560132, "last_edit_date": 1512631578, "question_id": 47673327, "link": "https://stackoverflow.com/questions/47673327/how-to-find-a-specific-string-in-a-c-file-using-the-perl-api-of-scitools-unde", "title": "How to find a specific string in a .c file using the perl api of (Scitools) Understand?", "body": "<p>I'm trying to analyse a code base (many .c files) by writing Perl script using (Scitools) Understand's Perl API.</p>\n\n<p>I'm aware that list of variables, functions etc. are easy to obtain for a given .c file. </p>\n\n<p>Probably someone who has worked with <a href=\"https://scitools.com/documents/manuals/perl/\" rel=\"nofollow noreferrer\">Understand</a> Perl API could point me in the right direction to search for a specific string that is present in many lines of a file? and possible return the line number?</p>\n"}, {"tags": ["c", "file", "fseek"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1512559976, "post_id": 47673197, "comment_id": 82305395, "body": "Can you please elaborate on the &quot;weird behavior&quot;? What happens? For some specific input, what is the expected and actual output? How do you call this function? What is the contents of the file? Is the file opened in binary or text mode? When you divide positions by 12, are you counting the newlines correctly? Please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, <b>Complete</b>, and Verifiable Example</a>."}, {"owner": {"reputation": 31, "user_id": 6090669, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206175815774914/picture?type=large", "display_name": "Mike Lund Andersen", "link": "https://stackoverflow.com/users/6090669/mike-lund-andersen"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1512560309, "post_id": 47673197, "comment_id": 82305594, "body": "Well i tried printf(&quot;test\\n&quot;); before the first fseek and it worked, but after it, it doesn&#39;t print anything. I call the function like: &quot;if(BinarySearch(cp, CPR, &amp;position)). The file holds 9 lines of numbers of 10 digits + newline, which is 12 bytes pr. line.   Does this clarify?"}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1512579908, "post_id": 47673598, "comment_id": 82318589, "body": "That is clearly not the actual solution - <code>fseek</code> etc... take a <code>FILE *</code> and your compiler should be complaining a lot if you pass it a <code>FILE **</code>. There is likely some undefined behaviour else where in your code that this solution is fixing by pure chance."}], "tags": [], "owner": {"reputation": 31, "user_id": 6090669, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206175815774914/picture?type=large", "display_name": "Mike Lund Andersen", "link": "https://stackoverflow.com/users/6090669/mike-lund-andersen"}, "is_accepted": false, "score": 1, "last_activity_date": 1512560984, "creation_date": 1512560984, "answer_id": 47673598, "question_id": 47673197, "link": "https://stackoverflow.com/questions/47673197/trouble-debugging-binarysearch-function-in-c/47673598#47673598", "title": "Trouble debugging binarysearch function in C", "body": "<p>I found my answer, it was my FILE pointer that was off, it had to be a pointer to a pointer so FILE **. </p>\n"}], "owner": {"reputation": 31, "user_id": 6090669, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206175815774914/picture?type=large", "display_name": "Mike Lund Andersen", "link": "https://stackoverflow.com/users/6090669/mike-lund-andersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512560984, "creation_date": 1512559620, "question_id": 47673197, "link": "https://stackoverflow.com/questions/47673197/trouble-debugging-binarysearch-function-in-c", "title": "Trouble debugging binarysearch function in C", "body": "<p>i'm trying to make a binary search that searches through an ordered file of numbers. Although, even though it worked in \"main\" before I converted this into a function, it has managed to have some weird behavior after my fseek(). </p>\n\n<p>Any suggestions? </p>\n\n<pre><code>int BinarySearch(FILE *cp, char *CPR, int *position) {\n\n  int i, lines, current_line;\n  double CPR_number, CPR_check;\n  char CPR_check_string[CPR_LEN];\n\n  sscanf(CPR, \"%lf\", &amp;CPR_number);\n\n  fseek(cp, 0L, SEEK_END);\n  lines = ftell(cp)/12;\n\n  current_line = ftell(cp)/2 - ((ftell(cp)/2) % 12);\n\n  for (i = 0; i &lt; log10(lines)/log10(2); i++) {\n\n    fseek(cp, current_line, SEEK_SET);\n\n    /* Read CPR as string */\n    fscanf(cp, \"%[0-9]\", CPR_check_string);\n\n    /* Convert to number */\n    sscanf(CPR_check_string, \"%lf\", &amp;CPR_check);\n\n    if (CPR_number == CPR_check) {\n      printf(\"This happens\\n\");\n      *position = ftell(cp);\n      return TRUE;\n    } else if (CPR_number &lt; CPR_check) {\n      current_line = ftell(cp)/2 - ((ftell(cp)/2) % 12);\n    } else if (CPR_number &gt; CPR_check) {\n      current_line = ftell(cp) + ftell(cp)/2 - ((ftell(cp) + ftell(cp)/2) % 12);\n    }\n  }\n\n  return FALSE;\n}\n</code></pre>\n\n<p>It doesn't seem to run the rest of the code. </p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c", "winapi", "type-conversion"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1512565993, "post_id": 47673109, "comment_id": 82309072, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/998571/c-template-for-safe-integer-casts\">C++ Template for safe integer casts</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 1, "last_activity_date": 1512570657, "last_edit_date": 1512570657, "creation_date": 1512560746, "answer_id": 47673516, "question_id": 47673109, "link": "https://stackoverflow.com/questions/47673109/safely-convert-size-t-to-word/47673516#47673516", "title": "Safely convert SIZE_T to WORD", "body": "<p>exist many ways do this. for example we can use next code:</p>\n\n<pre><code>if ((wConvertedValue = (WORD)nValueToConvert) == nValueToConvert)\n{\n    DbgPrint(\"convert ok\\n\");\n}\nelse\n{\n    DbgPrint(\"too big for WORD\\n\");\n}\n</code></pre>\n\n<hr>\n\n<p>however this is valid only for <strong>unsigned</strong> types - both <code>SIZE_T</code> and <code>WORD</code> is unsigned. if work with <strong>signed</strong> types, say <code>SSIZE_T nValueToConvert</code> and <code>SHORT wConvertedValue</code>, task become more complex, separate signed bit create problems here. i think try truncate and check can be done next way:</p>\n\n<pre><code>BOOL Truncate(SSIZE_T nValueToConvert, SHORT* pwConvertedValue)\n{\n    SHORT wConvertedValue;\n\n    if (0 &gt; nValueToConvert)\n    {\n        wConvertedValue = -(wConvertedValue = ((SHORT)-nValueToConvert));\n    }\n    else\n    {\n        wConvertedValue = (SHORT)nValueToConvert;\n    }\n\n    *pwConvertedValue = wConvertedValue;\n\n    return wConvertedValue == nValueToConvert;\n}\n</code></pre>\n\n<p><code>Truncate</code> return true when <code>SSIZE_T nValueToConvert</code> in range <code>[-0x8000, 0x7FFF]</code>, otherwise false </p>\n"}, {"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512564187, "post_id": 47674466, "comment_id": 82307890, "body": "Why would this conversion <i>never</i> be safe? <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.3p1\" rel=\"nofollow noreferrer\">When a value with integer type is converted to another integer type other than _Bool, if the value can be represented by the new type, it is unchanged.</a>."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512564594, "post_id": 47674466, "comment_id": 82308146, "body": "@DavidBowling You are right.! By save I meant a proper result of conversion. For example <code>unsigned int</code> cannot be properly converted to <code>unsigned char</code> we will loose a precision."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512565272, "post_id": 47674466, "comment_id": 82308627, "body": "Any integer value in the range of an <code>unsigned char</code> can be converted to an <code>unsigned char</code> value with the value unchanged."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512565455, "post_id": 47674466, "comment_id": 82308763, "body": "@DavidBowling You are right!  I mess up. Correcting my answer."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1512566134, "post_id": 47674466, "comment_id": 82309160, "body": "@DavidBowling Thank you!"}], "tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 1, "last_activity_date": 1512565688, "last_edit_date": 1512565688, "creation_date": 1512563814, "answer_id": 47674466, "question_id": 47673109, "link": "https://stackoverflow.com/questions/47673109/safely-convert-size-t-to-word/47674466#47674466", "title": "Safely convert SIZE_T to WORD", "body": "<p>Conversion may not give a proper result. The type sizes are different. Check this:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383751%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Window Data Types</a></p>\n\n<p><code>SIZE_T</code> Unsigned integral type; defined as:</p>\n\n<pre><code>typedef ULONG_PTR SIZE_T;\n</code></pre>\n\n<p><code>WORD</code>   A 16-bit unsigned integer. The range is 0 through 65535 decimal.\nThis type is declared in <em>WinDef.h</em> as follows:</p>\n\n<pre><code>  typedef unsigned short WORD;\n</code></pre>\n\n<p>But if you really want to compare them than </p>\n\n<pre><code>if( nValueToConvert &gt; 65535 ) (\n{\n    DbgPrint(\"Conversion is not safe\\n\");\n}\nelse\n{\n    DbgPrint(\"conversion is OK\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1199, "user_id": 3825101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJgje.png?s=128&g=1", "display_name": "macro_controller", "link": "https://stackoverflow.com/users/3825101/macro-controller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 47673516, "answer_count": 2, "score": 0, "last_activity_date": 1512570657, "creation_date": 1512559314, "question_id": 47673109, "link": "https://stackoverflow.com/questions/47673109/safely-convert-size-t-to-word", "title": "Safely convert SIZE_T to WORD", "body": "<p>In my C code, I want to convert <code>SIZE_T</code> <code>WINAPI</code> type, in either 32/64 bit system to a <code>WORD</code> <code>WINAPI</code> type.</p>\n\n<pre><code>#include &lt;Windows.h&gt;\nSIZE_T nValueToConvert;\nWORD wConvertedValue;\n</code></pre>\n\n<p>In case that <code>nValueToConvert</code> is too big for <code>WORD</code> type I want to know abot it and raise an error. What is the best and safest way to do that? </p>\n"}, {"tags": ["c", "module", "reference", "linux-kernel", "driver"], "comments": [{"owner": {"reputation": 8597, "user_id": 1039481, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a10ec3de7bec751e1633eba0ef28d4cb?s=128&d=identicon&r=PG", "display_name": "Akhil Thayyil", "link": "https://stackoverflow.com/users/1039481/akhil-thayyil"}, "edited": false, "score": 0, "creation_date": 1512555441, "post_id": 47671573, "comment_id": 82302445, "body": "Where is the driver code ?"}, {"owner": {"reputation": 23, "user_id": 4408673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jqC10JUx4qM/AAAAAAAAAAI/AAAAAAAAAB4/KHFHyaXvUyc/photo.jpg?sz=128", "display_name": "Tobias", "link": "https://stackoverflow.com/users/4408673/tobias"}, "reply_to_user": {"reputation": 8597, "user_id": 1039481, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a10ec3de7bec751e1633eba0ef28d4cb?s=128&d=identicon&r=PG", "display_name": "Akhil Thayyil", "link": "https://stackoverflow.com/users/1039481/akhil-thayyil"}, "edited": false, "score": 0, "creation_date": 1512557732, "post_id": 47671573, "comment_id": 82304006, "body": "Isn&#39;t fWrite() enough? The driver is quite long, and there are some know-how/commerical sensitive parts inside. Which parts are needed?"}, {"owner": {"reputation": 8597, "user_id": 1039481, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a10ec3de7bec751e1633eba0ef28d4cb?s=128&d=identicon&r=PG", "display_name": "Akhil Thayyil", "link": "https://stackoverflow.com/users/1039481/akhil-thayyil"}, "edited": false, "score": 0, "creation_date": 1512558722, "post_id": 47671573, "comment_id": 82304676, "body": "Are you sure that inside fwrite the file pointer is valid ? is it getting corrupt due to some race condition anywhere in the code ?"}, {"owner": {"reputation": 8597, "user_id": 1039481, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a10ec3de7bec751e1633eba0ef28d4cb?s=128&d=identicon&r=PG", "display_name": "Akhil Thayyil", "link": "https://stackoverflow.com/users/1039481/akhil-thayyil"}, "edited": false, "score": 0, "creation_date": 1512558758, "post_id": 47671573, "comment_id": 82304699, "body": "We cannot derive a conclusion from whatever you have pasted above"}], "answers": [{"tags": [], "owner": {"reputation": 195, "user_id": 6935752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14135e47b5b3ba0300bbc9b90f17c5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Hercules dd", "link": "https://stackoverflow.com/users/6935752/hercules-dd"}, "is_accepted": false, "score": 0, "last_activity_date": 1512627824, "creation_date": 1512627824, "answer_id": 47688855, "question_id": 47671573, "link": "https://stackoverflow.com/questions/47671573/access-on-kernel-module/47688855#47688855", "title": "Access on kernel module", "body": "<p>In the driver function fWrite() return length instead of 0.</p>\n\n<pre><code>static ssize_t fWrite(struct file *file, const char  *buffer, size_t length, loff_t *offset)\n{\nprintk(KERN_ERR \"INSIDE\\n\");\nreturn length;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4408673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jqC10JUx4qM/AAAAAAAAAAI/AAAAAAAAAB4/KHFHyaXvUyc/photo.jpg?sz=128", "display_name": "Tobias", "link": "https://stackoverflow.com/users/4408673/tobias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512627824, "creation_date": 1512554703, "question_id": 47671573, "link": "https://stackoverflow.com/questions/47671573/access-on-kernel-module", "title": "Access on kernel module", "body": "<p>I wrote a linux kernel module char device (SuSE 13.2 Kernel 3.16.6), and an application for using this device.</p>\n\n<p>In principle, the driver, the application and the communication works. The application can open, read, write and close the char device.</p>\n\n<p>But there is a sporadic issue, that the application somtime 'lost' the reference to the module's write function. After 3 to 4 (sometime much more) write commands from the application to the module, the module's write funtion isn't executed. </p>\n\n<p>I reduced and the write function inside module:</p>\n\n<pre><code>static ssize_t fWrite(struct file *file, const char  *buffer, size_t length, loff_t *offset)\n{\n  printk(KERN_ERR \"INSIDE\\n\");\n  return 0;\n}\n</code></pre>\n\n<p>And I also reduced the applcation:</p>\n\n<pre><code>int main (int argc, char **argv)\n{\n  unsigned short buffer=0xffff;\n  fd = open (\"/dev/MYPCI\" , O_SYNC | O_RDWR );\n  OUTPW (0, buffer ,fd );\n  OUTPW (2, buffer,fd );\n  OUTPW (4, buffer,fd ); \n  OUTPW (196, buffer,fd );\n  OUTPW (70000, buffer,fd );   \n  OUTPW (400, buffer,fd );\n\n  printf(\"DEV-Handle: %d\\n\", fd);  \n  close (fd );\n}\n\nint OUTPW (unsigned short ByteAddr, unsigned short value, int fd)\n{\n  int x;  \n  int size = (ByteAddr/2) &lt;&lt;16; \n  size +=2;            \n\n  printf (\"\\nByteAddr:0x%08hX value:0x%08hX size:0x%08hX WRITE-Handle: 0x%04hX\\n\" , ByteAddr,value,size, &amp;write);\n\n  x= write(fd, &amp;value, size) ;\n\n  return x;\n}\n</code></pre>\n\n<p>The output looks loke this. sometime I can read 3 times, sometime I can read 4 times, sometimes much more. <a href=\"https://i.stack.imgur.com/p6cyu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p6cyu.jpg\" alt=\"screenshoot of outputs\"></a></p>\n\n<p>The write function handle is still valid. If one write command fails, all following will also fail.\nIf I close&amp;open the device again (inside the application) the write is temporary fixed. </p>\n\n<p>The same behaviour exists on read command.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1512554649, "post_id": 47671509, "comment_id": 82301918, "body": "Suggestion: Refactor your logic, then the code. <code>goto</code> is considered <i>evil</i>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1512554655, "post_id": 47671509, "comment_id": 82301920, "body": "Don&#39;t... just don&#39;t"}, {"owner": {"reputation": 1140, "user_id": 4892907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aE5LujU7Dz0/AAAAAAAAAAI/AAAAAAAAAfA/umYfIt-WSuI/photo.jpg?sz=128", "display_name": "xxxvodnikxxx", "link": "https://stackoverflow.com/users/4892907/xxxvodnikxxx"}, "edited": false, "score": 0, "creation_date": 1512555170, "post_id": 47671509, "comment_id": 82302262, "body": "Answer is clear, <code>always avoid to use goto and jumps in code</code>, but if you really want to look how it works and can be used, look eg there <a href=\"https://stackoverflow.com/questions/2891766/how-to-throw-an-exception-in-c\" title=\"how to throw an exception in c\">stackoverflow.com/questions/2891766/&hellip;</a>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1512555214, "post_id": 47671509, "comment_id": 82302285, "body": "Just return to <code>main</code> when you want to exit, and have <code>main</code> return.  If you can&#39;t structure your program to do this, then you could use <code>setjmp&#47;longjmp</code>.  I don&#39;t really see the point of this though."}], "answers": [{"comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 3, "creation_date": 1512554871, "post_id": 47671594, "comment_id": 82302052, "body": "Please do not look at <code>setjmp()</code> and <code>longjmp()</code> until you understand how to properly structure your code."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1512555354, "post_id": 47671594, "comment_id": 82302373, "body": "I am not exactly a follower of carg-cult programming. That&#39;s why I mentioned it <i>can be</i> done. But it&#39;s not really OP you needed."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1512555530, "post_id": 47671594, "comment_id": 82302505, "body": "@VittorioRomeo Please do not look at <code>setjmp()</code> and <code>longjmp()</code> <b>ever</b>. These two functions were implemented and defined in the very beginning of C because they were easy to implement and promised to be powerful. An assessment of their utility and their danger was not done. It is only later that people realized that their danger far outweights their utility. They are much worse than a <code>goto</code>. But people didn&#39;t realize that until after the damage was done and these two functions were de-facto part of the C standard."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1512574025, "post_id": 47671594, "comment_id": 82314684, "body": "@cmaster: The \u201cnever\u201d is terrible advice. There are legitimate uses for <code>setjmp</code> and <code>longjmp</code>, even if there are many associated hazards. Unlike, for example, <code>gets</code> which is far less safe than <code>longjmp</code>."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1512575350, "post_id": 47671594, "comment_id": 82315606, "body": "@DietrichEpp Can you name some such uses? I only know of the use as an exception replacement/implementation, and that use is definitely most deeply flawed when any hand-written C code in involved. (The exception is that the entire C code is only the output of some other compiler frontend that inserts both the <code>setjmp()</code>/<code>longjmp()</code> calls and the necessary cleanup code to implement exceptions in the high-level language. And even in that case, <code>setjmp()</code>/<code>longjmp()</code> is a poor implementation choice.) So, I fail to see a valid use case, but if you have one, I&#39;d be happy to hear about it :-)"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512575858, "post_id": 47671594, "comment_id": 82315937, "body": "@cmaster Yes, exception handling is the most common use case. But why do you think it&#39;s &quot;deeply flawed&quot;? What else do you propose, say when returning from a SIGSEGV handling code, that cuts across multiple stack frames for example?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512576003, "post_id": 47671594, "comment_id": 82316059, "body": "@cmaster In larger programs or in general usage it is certainly dangerous and difficult to use correctly. However, C is often used to implement the runtime for other languages, for example, in Lua where a longjmp greatly simplifies error handling. C is also used for low-level systems programming where you may occasionally want to do something like <code>longjmp</code> out of a signal handler, which is ordinary very dangerous but in certain cases is useful. In particular, it is the ONLY way to recover from SIGBUS or SIGSEGV, so in those cases it is irreplaceable."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512576501, "post_id": 47671594, "comment_id": 82316408, "body": "@cmaster The exception handling case is not always bad either. There are cases where you have a high confidence that <code>longjmp</code> is safe, so branding it a \u201cpoor implementation choice\u201d is a bit too general. It\u2019s like dynamite \u2026 most people shouldn\u2019t have sticks of dynamite in their toolbox, but some of us are glad it exists."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1512591538, "post_id": 47671594, "comment_id": 82324796, "body": "@DietrichEpp Ok, if you must, recover from these signals, then you may be forced to use <code>longjmp()</code>. The danger that I see, is that operations are skipped in an entirely uncontrolled way. When you throw an exception in C++, it&#39;s the compilers duty to make sure that all destructors get called. There is no such thing with <code>longjmp()</code>. As such, I see the SIGBUS and SIGSEGV signals simply as unrecoverable signals, that force a quick uncheatable death - there&#39;s nothing that can safely be recovered. You are allowed to use the handler to print some diagnostics, but that&#39;s it, after that you die."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512591595, "post_id": 47671594, "comment_id": 82324818, "body": "I likel your dynamite analogy, though (IMHO, nitroglycerin would be a better analogy, see <a href=\"https://en.wikipedia.org/wiki/Nitroglycerin\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Nitroglycerin</a>), we may only differ in our assessment of the environment: When I think of any sizable piece of code, I think of tons of dirt, impurities, rough handling, blatant mistakes, and smoking employees to set of the nitroglycerin... The only way that I can think of controlling the danger is to remove the human factor altogether. Or remove the nitroglycerin."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512631108, "post_id": 47671594, "comment_id": 82338175, "body": "@cmaster: You say that \u201cthese operations are skipped in an entirely uncontrolled way\u201d but that\u2019s simply not always true, and it\u2019s just plain false that SIGSEGV is unrecoverable. Don\u2019t think of this from the perspective of an application developer, where the idea of recovering from an arbitrary SIGSEGV \u201csomewhere\u201d in your application just means that your application contains a memory error. Instead, consider this from a systems programmer perspective. Is it possible to write code where SIGSEGV is expected, normal, and safe? The answer is absolutely and unequivocally \u201cyes\u201d."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1512650033, "post_id": 47671594, "comment_id": 82349815, "body": "@DietrichEpp If you are not in user space, you are in kernel space, and kernels don&#39;t get signals, afaik. Kernels get interrupts instead. IMHO, if the interrupt handler for an address space violation identifies a user space process as the source, it should shoot that process. If the source is a kernel thread, it should panic. However, it&#39;s true that I&#39;m more of a user space programmer, so there may indeed be cases where an interrupt handler for an address space violation must be able to resume the violating kernel thread. I guess, there are quite insane hardware interfaces out there..."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1512650791, "post_id": 47671594, "comment_id": 82350290, "body": "With careful programming, SIGSEGV is recoverable from userspace itself without involving &quot;uncontrollable ways&quot;. In short, there are genuine use-cases for setjmp/longjmp even in userspace programs."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512659612, "post_id": 47671594, "comment_id": 82356093, "body": "@cmaster: I wasn&#39;t even thinking about kernels, all of the examples I was thinking of were from ordinary userspace programs. Kernel programming is just one type of systems programming."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1512661411, "post_id": 47671594, "comment_id": 82357233, "body": "@DietrichEpp That puzzles me. Under what circumstances would you <i>want</i> to recover a user-space process from a SIGSEGV? Can you give an example?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512665747, "post_id": 47671594, "comment_id": 82359928, "body": "@cmaster: When writing a garbage collector, you can make a page fault in the allocator trigger collection. In a database, you can make a page fault load from disk. In an interpreter, you can make a page fault generate a null pointer exception. If you are writing a parser, you can use <code>longjmp</code> to return an error from a deeply nested function. The <code>longjmp</code> function is a very powerful and useful tool, it\u2019s just also dangerous and often inappropriate."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1512667172, "post_id": 47671594, "comment_id": 82360811, "body": "@DietrichEpp Garbage Collection: So you want the allocator to routinely invoke UB to save a single comparison per allocation? I&#39;d think, there must be better ways. Database: If you want lazy loading, <code>mmap()</code> the file/disk. Interpreter: This has some justification. Parser: I would throw you off my project if you did this. A parser exists to build an AST, and if you abort its creation in the middle and happily resume work, you are left with a ton of half constructed objects. That classifies as deeply broken code IMNSHO. But, as I said, the interpreter use-case is a valid one. Thanks :-)"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1512668215, "post_id": 47671594, "comment_id": 82361371, "body": "@cmaster: A SIGSEGV is not actually undefined behavior. It sounds like you have very strong opinions on this subject, but I honestly am a bit hurt by some of these responses like \u201cI would throw you off my project if you did this\u201d or \u201cdeeply broken code\u201d. Is that an appropriate comment? It also sounds like there are a large number of assumptions here, like about half-constructed objects. If you are allocating those objects in a pool, which is not unusual, you can simply free the pool after the <code>longjmp</code>. There is a great variety of coding styles, coding styles you don\u2019t like are not \u201cwrong\u201d."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512668389, "post_id": 47671594, "comment_id": 82361446, "body": "@cmaster: \u201cSaving a single comparison\u201d in the allocator can actually be an enormous win because it can bring heap allocation much closer to stack allocation in terms of performance in certain situations and using certain metrics."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1512672939, "post_id": 47671594, "comment_id": 82363717, "body": "@DietrichEpp You cannot get a SIGSEGV without invoking UB first: It means that you have an access outside of a memory object allocated via some system function (<code>mmap</code>, <code>malloc</code>, etc.). I.e. you are dereferencing an invalid pointer by the definition of the C language standard. Anyway, sorry that I hurt your feelings. I tried to be very clear about my point, and I tried to explain my reasoning. Yes, I have strong opinions about coding - it&#39;s what I love to do, after all. I see the pool strategy as a valid damage encapsulation technique, but I&#39;d rather avoid the damage in the first place."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512682534, "post_id": 47671594, "comment_id": 82368472, "body": "@cmaster: I feel like a bit of a broken record here, but it is an outright falsehood to say that only undefined behavior triggers SIGSEGV. Please refer to the <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\"><code>mmap</code> man page</a> and note the <code>prot</code> argument. It&#39;s good to have opinions but I expect people to acknowledge that their opinions are not absolute verdicts on the matter."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512682719, "post_id": 47671594, "comment_id": 82368577, "body": "@cmaster: Also note that <code>mmap</code> is most commonly available on Posix systems or systems which implement similar interfaces, and the Posix standard requires certain behavior beyond what the C standard requires. So SIGSEGV can still be portable, because a Posix-compliant C compiler must make it so."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1512685432, "post_id": 47671594, "comment_id": 82369765, "body": "@DietrichEpp Good point about the <code>prot</code> argument, I totally missed that. So, I take back what I said about SIGSEGV and UB, and claim the opposite :-) Sorry for claiming wrong stuff, and thanks for your patience correcting me."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1512554765, "creation_date": 1512554765, "answer_id": 47671594, "question_id": 47671509, "link": "https://stackoverflow.com/questions/47671509/how-to-use-goto-across-multiple-functions/47671594#47671594", "title": "How to use goto across multiple functions", "body": "<p><code>goto</code> can't be used to jump across different functions; it can only be used within the same function. To jump between functions, you can look at <code>setjmp()</code> and <code>longjmp()</code> functions.</p>\n\n<p>Having said, since you claim to be a beginner, I am not convinced you really need to use either of the above. You can simply modify your function to return an \"error\" value. And in <code>main()</code>, check its value and return from <code>main()</code> with the error value.</p>\n"}, {"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 4, "last_activity_date": 1512554816, "creation_date": 1512554816, "answer_id": 47671608, "question_id": 47671509, "link": "https://stackoverflow.com/questions/47671509/how-to-use-goto-across-multiple-functions/47671608#47671608", "title": "How to use goto across multiple functions", "body": "<p>The only good answer to this question is: <strong>don't do it</strong>. <code>goto</code>s used in this way make your code very hard to reason about. </p>\n\n<p>Refactor your code so that you have a clear structure and hierarchy of calls. Use return values to propagate success/failure throughout the call stack.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1512573421, "creation_date": 1512573421, "answer_id": 47677638, "question_id": 47671509, "link": "https://stackoverflow.com/questions/47671509/how-to-use-goto-across-multiple-functions/47677638#47677638", "title": "How to use goto across multiple functions", "body": "<p>By design, a <code>goto</code> cannot jump from one function to another.  It can only be used to jump within a given function.</p>\n\n<p>There are ways to jump between functions, but doing so is not only very poor design but also dangerous as it is very easy to put your program in an invalid state.</p>\n\n<p>The proper way to handle this is to have your function return a specific value (or set of values) to indicate an error.  Then the calling function would check for one of those error values and act accordingly.</p>\n\n<p>For example:</p>\n\n<pre><code>int readFile(char *filename)\n{\n  FILE *filepointer;\n\n  char * line = NULL;\n  size_t len = 0;\n  size_t read;\n  int linecount = 0;\n  filepointer = fopen(filename, \"r\");\n  if (filepointer == NULL)\n    {\n      // add strerror(error) to the error message to know why fopen failed\n      printf(\"[ERR] Could not read file %s: %s.\\n\",filename, strerror(errno) );\n      // error completion\n      return 0;\n    }\n  ...\n  // successful completion\n  return 1;\n}\n\nint main(){\n   ...\n   if (readFile(\"myfile\") == 0) {\n       return 3;\n   }\n   ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 7275089, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690963681195605/picture?type=large", "display_name": "David Wooley - AST", "link": "https://stackoverflow.com/users/7275089/david-wooley-ast"}, "is_accepted": false, "score": 0, "last_activity_date": 1590249947, "creation_date": 1590249947, "answer_id": 61974875, "question_id": 47671509, "link": "https://stackoverflow.com/questions/47671509/how-to-use-goto-across-multiple-functions/61974875#61974875", "title": "How to use goto across multiple functions", "body": "<p>If you wanted to use a go-to , and insisted on doing that, you could I guess try to expand your 1st function so it includes / encapsulates the 2nd function, and get rid of the 2nd function conpletely, so your able to do go tos and subroutines within this much larger function. </p>\n\n<p>Is that an option you could try ? (If you were dead cert on using Goto's, ) ?</p>\n\n<p>I would give that a go. </p>\n"}], "owner": {"reputation": 29, "user_id": 8831314, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b8b995e9105df6088ff992789c222219?s=128&d=identicon&r=PG&f=1", "display_name": "Gehteuch Nixan", "link": "https://stackoverflow.com/users/8831314/gehteuch-nixan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1590249947, "creation_date": 1512554518, "last_edit_date": 1512555556, "question_id": 47671509, "link": "https://stackoverflow.com/questions/47671509/how-to-use-goto-across-multiple-functions", "title": "How to use goto across multiple functions", "body": "<p>I am trying to exit a program without using <code>exit()</code>. I have come up with a very convoluted and dirty solution (I am a Beginner).\nI would like to use <code>if</code> statements and if it is true, then I would like to use <code>goto</code> to go the main function and then <code>return 3;</code> and end the program.</p>\n\n<p>Here is a bit of code:</p>\n\n<pre><code>    FILE *filepointer;\n\n      char * line = NULL;\n      size_t len = 0;\n      size_t read;\n      int linecount = 0;\n      filepointer = fopen(filename, \"r\");\n      if (filepointer == NULL)\n        {\n          printf(\"[ERR] Could not read file %s.\\n\",filename );\n          goto FILE_ERROR;\n        }\n    ...\n    int main(){\n    ...\n    FILE_ERROR: return 3;\n\n}\n</code></pre>\n\n<p>This however does not work as I cannot get jump between functions because I get <code>undeclared Label</code> as an error. Is there any way I can exclude <code>exit()</code> from my program and still end it returning a certain value. If there is a better solution, please let me know </p>\n"}, {"tags": ["c", "algorithm", "infinite-loop", "geometry"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1512554279, "post_id": 47671374, "comment_id": 82301641, "body": "first thing in that case: put a lot of  printfs to print values of varying indices like x, y, err in all the loops and observe where you&#39;re stuck. Also use a small circle to avoid a lot of output."}, {"owner": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1512554463, "post_id": 47671374, "comment_id": 82301773, "body": "@Jean-Fran&#231;oisFabre thanks for that advice - i will try that and lower the radius to 5. But is my idea, how I can fill up the rest, right?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1512555110, "post_id": 47671374, "comment_id": 82302225, "body": "oh you could also use a flood fill algorithm. I&#39;m describing one (implemented in python) here: <a href=\"https://stackoverflow.com/questions/40963288/fatal-python-error-cannot-recover-from-stack-overflow-during-flood-fill/40963737?s=2|26.2027#40963737\" title=\"fatal python error cannot recover from stack overflow during flood fill\">stackoverflow.com/questions/40963288/&hellip;</a>"}, {"owner": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1512555206, "post_id": 47671374, "comment_id": 82302280, "body": "this would work? where can I find your algorithm? this would be awesome.  edit: just saw you edited it - thanks :) edit2: @Jean-Fran&#231;oisFabre could you maybe give me an exaple, how I implement your fill-up-algorithm in my c-programm?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1512555441, "post_id": 47671374, "comment_id": 82302446, "body": "if you can convert my python code to C, you&#39;ll get a generic flood fill code, that can fill any closed form, not only a circle."}, {"owner": {"reputation": 9168, "user_id": 1921273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LREX2.png?s=128&g=1", "display_name": "MrSmith42", "link": "https://stackoverflow.com/users/1921273/mrsmith42"}, "edited": false, "score": 0, "creation_date": 1512556634, "post_id": 47671374, "comment_id": 82303229, "body": "You should try debugging!"}, {"owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "edited": false, "score": 0, "creation_date": 1512564387, "post_id": 47671374, "comment_id": 82308021, "body": "This question is a duplicate of <a href=\"https://stackoverflow.com/q/1201200/563940\">fast algorithm for drawing filled circles?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "edited": false, "score": 0, "creation_date": 1512555005, "post_id": 47671548, "comment_id": 82302138, "body": "+1 for that idea:  I already thought that - so you mean i should fill the circle up line by line? This means I should get first the starting coordinate and then the ending coordinate from a line am I right?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "edited": false, "score": 1, "creation_date": 1512556124, "post_id": 47671548, "comment_id": 82302910, "body": "Yes, I mean you should draw the circle as a bunch of horizontal lines. No need to draw the actual circle (outline, un-filled) first, just draw the lines and that will be enough. You only need to compute <i>one</i> horizontal coordinate per vertical coordinate, since the circle is symmetrical as I said."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 6, "last_activity_date": 1512554630, "creation_date": 1512554630, "answer_id": 47671548, "question_id": 47671374, "link": "https://stackoverflow.com/questions/47671374/fill-a-drawed-circle-with-the-midpoint-algorithm-in-c-infinite-loop/47671548#47671548", "title": "Fill a drawed circle with the midpoint algorithm in c-&gt; infinite-loop?", "body": "<p>I'm pretty sure doing it your way won't generate a very nice circle; rounding errors and such might very well end up giving you \"holes\" in the circle, i.e. un-filled pixels.</p>\n\n<p>A much better approach is to realize that the circle can be viewed as a bunch of horizontal lines of varying lengths. Thus, all you need to do is to iterate the <code>y</code> component from <code>-r</code> to <code>r</code>, and for each such <code>y</code> compute the corresponding <code>x</code> using your existing code. Then draw a horizontal line from <code>(-x, y)</code> to <code>(x, y)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 705, "user_id": 563940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f032f602bdd0ffd7ba6f3306156fe57?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/563940/pedro"}, "is_accepted": false, "score": 0, "last_activity_date": 1512564300, "last_edit_date": 1512564300, "creation_date": 1512558420, "answer_id": 47672854, "question_id": 47671374, "link": "https://stackoverflow.com/questions/47671374/fill-a-drawed-circle-with-the-midpoint-algorithm-in-c-infinite-loop/47672854#47672854", "title": "Fill a drawed circle with the midpoint algorithm in c-&gt; infinite-loop?", "body": "<p>This question is a duplicate of <a href=\"https://stackoverflow.com/q/1201200/563940\">fast algorithm for drawing filled circles?</a>.</p>\n"}], "owner": {"reputation": 121, "user_id": 8848846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f87743e71ce1d3164a4f0bc68eda795f?s=128&d=identicon&r=PG&f=1", "display_name": "s.r.", "link": "https://stackoverflow.com/users/8848846/s-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 0, "accepted_answer_id": 47671548, "answer_count": 2, "score": 2, "last_activity_date": 1515785086, "creation_date": 1512554115, "last_edit_date": 1515785086, "question_id": 47671374, "link": "https://stackoverflow.com/questions/47671374/fill-a-drawed-circle-with-the-midpoint-algorithm-in-c-infinite-loop", "title": "Fill a drawed circle with the midpoint algorithm in c-&gt; infinite-loop?", "body": "<p>\nI am trying to draw a filled circle with the midpoint algorithm. I already managed to draw an unfilled circle with y0 = 320; x0 = 240; radius = 180 -with the following code (reference: <a href=\"https://en.wikipedia.org/wiki/Midpoint_circle_algorithm\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Midpoint_circle_algorithm</a>):</p>\n\n<pre><code>int x0, int y0, int radius;\n\nx0 = 320;     //assign values\ny0 = 240;\nradius = 180;\n\nint x = radius-1;\nint y = 0;\nint dx = 1;\nint dy = 1;\nint err = dx - (radius &lt;&lt; 1);\n\nwhile (x &gt;= y)\n{\n    putpixel(x0 + x, y0 + y);\n    putpixel(x0 + y, y0 + x);\n    putpixel(x0 - y, y0 + x);\n    putpixel(x0 - x, y0 + y);\n    putpixel(x0 - x, y0 - y);\n    putpixel(x0 - y, y0 - x);\n    putpixel(x0 + y, y0 - x);\n    putpixel(x0 + x, y0 - y);\n\n    if (err &lt;= 0)\n    {\n        y++;\n        err += dy;\n        dy += 2;\n    }\n    if (err &gt; 0)\n    {\n        x--;\n        dx += 2;\n        err += dx - (radius &lt;&lt; 1);\n    }\n}\n</code></pre>\n\n<p>This delivers the following output (saved in a bitmap):\n<a href=\"https://i.stack.imgur.com/BEOdx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BEOdx.png\" alt=\"enter image description here\"></a></p>\n\n\n\n<p>Now I want, that this unfilled yellow circle will be filled, so it looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/GiiA6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GiiA6.png\" alt=\"enter image description here\"></a></p>\n\n<p>I thought I can accommplish this with setting the radius everytime to radius-- so it draws the same circle with a -1 radius - and that until radius=0. So basically it draws everytime a new circle filled up with the old circle until there is now circle to draw anymore (radius=0). My code for this is:</p>\n\n<p>int x0, int y0, int radius;</p>\n\n<pre><code>x0 = 320;     //assign values\ny0 = 240;\nradius = 180;\n\nint x = radius-1;\nint y = 0;\nint dx = 1;\nint dy = 1;\nint err = dx - (radius &lt;&lt; 1);\n\nwhile(radius!=0) {\n    while (x &gt;= y)\n    {\n        putpixel(x0 + x, y0 + y);\n        putpixel(x0 + y, y0 + x);\n        putpixel(x0 - y, y0 + x);\n        putpixel(x0 - x, y0 + y);\n        putpixel(x0 - x, y0 - y);\n        putpixel(x0 - y, y0 - x);\n        putpixel(x0 + y, y0 - x);\n        putpixel(x0 + x, y0 - y);\n\n        if (err &lt;= 0)\n        {\n            y++;\n            err += dy;\n            dy += 2;\n        }\n        if (err &gt; 0)\n        {\n            x--;\n            dx += 2;\n            err += dx - (radius &lt;&lt; 1);\n        }\n    }\n\n    x0 = x0 - 1;     //getting the next circle until radius = 0\n    y0 = y0 -1;\n    radius = radius - 1;\n\n    x = radius-1;\n    y = 0;\n    dx = 1;\n    dy = 1;\n    err = dx - (radius &lt;&lt; 1);\n\n}\n</code></pre>\n\n<p>This should be the code to my idea how I could fill up, but all i get is an infinite-loop.. Has anyone an idea why? Or has anyone another way to fill up the circle using the midpoint algorithm?</p>\n\n<p>Greetings</p>\n"}, {"tags": ["c", "pthreads", "mutex"], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 8906514, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aKv9stVvOdA/AAAAAAAAAAI/AAAAAAAAJU8/mvV-vwgh0XI/photo.jpg?sz=128", "display_name": "Antonio", "link": "https://stackoverflow.com/users/8906514/antonio"}, "is_accepted": true, "score": 2, "last_activity_date": 1512579669, "last_edit_date": 1512579669, "creation_date": 1512561487, "answer_id": 47673777, "question_id": 47671262, "link": "https://stackoverflow.com/questions/47671262/pthread-mutex-with-a-global-variable-correct-usage/47673777#47673777", "title": "pthread mutex with a global variable: correct usage?", "body": "<p>In general:</p>\n\n<blockquote>\n  <p>Global Variable are Evil:</p>\n  \n  <ul>\n  <li><a href=\"http://wiki.c2.com/?GlobalVariablesAreBad\" rel=\"nofollow noreferrer\">Global Variables Are Bad</a> on C2 Wiki</li>\n  <li><a href=\"http://koopman.us/bess/chap19_globals.pdf\" rel=\"nofollow noreferrer\">Chapter 19: Global Variables Are Evil</a> from <a href=\"http://koopman.us/\" rel=\"nofollow noreferrer\"><em>Better</em> Embedded System Software</a></li>\n  </ul>\n</blockquote>\n\n<p>Yes, you have to create a variable in the main thread and pass the reference to other threads that have to use it, which is true even if you have only one shared variable.</p>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1512561743, "creation_date": 1512561743, "answer_id": 47673858, "question_id": 47671262, "link": "https://stackoverflow.com/questions/47671262/pthread-mutex-with-a-global-variable-correct-usage/47673858#47673858", "title": "pthread mutex with a global variable: correct usage?", "body": "<ol>\n<li><p>Is it really that bad to put the shared resource as a global variable?</p>\n\n<p><strong>It depends , It is up to the developer to decide . But in general we need to be cautious about using the shared variable as a global one . For example if the program is so simple , then it is easy to manage global variables , if the program is complex and large enough with its own other complexities , it is somewhat not easy to maintain .</strong></p></li>\n<li><p>If you have only 1 shared variable, like in the example, would it be considered ok to use a global variable, or still no?</p>\n\n<p><strong>Above answer answers this question as well.</strong></p></li>\n<li><p>What is the better way to share the variables between the processes?</p>\n\n<p><strong>You can go ahead with some kind of serialization method which suits for you</strong> .</p></li>\n</ol>\n"}], "owner": {"reputation": 904, "user_id": 8037521, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/95033503f12d3840c30d0dd0ea594df6?s=128&d=identicon&r=PG&f=1", "display_name": "Valeria", "link": "https://stackoverflow.com/users/8037521/valeria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1994, "favorite_count": 0, "accepted_answer_id": 47673777, "answer_count": 2, "score": 1, "last_activity_date": 1512579669, "creation_date": 1512553740, "question_id": 47671262, "link": "https://stackoverflow.com/questions/47671262/pthread-mutex-with-a-global-variable-correct-usage", "title": "pthread mutex with a global variable: correct usage?", "body": "<p>I understand the purpose of mutex in pthreads, but I often here that it is considered a bad practice to use mutex with a global variable as a shared resource (for example, like in the answer to this question: <a href=\"https://stackoverflow.com/questions/14888027/mutex-lock-threads\">Mutex lock threads</a>).</p>\n\n<p>So, the questions:</p>\n\n<ol>\n<li>Is it really that bad to put the shared resource as a global variable?</li>\n<li>If you have only 1 shared variable, like in the example, would it be considered ok to use a global variable, or still no?</li>\n<li>What is the better way to share the variables between the processes?</li>\n</ol>\n"}, {"tags": ["c", "multithreading", "winapi", "threadpool"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1512576300, "post_id": 47671101, "comment_id": 82316282, "body": "system can not know about your tasks and when it finished. you need do this yourself"}, {"owner": {"reputation": 1199, "user_id": 3825101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJgje.png?s=128&g=1", "display_name": "macro_controller", "link": "https://stackoverflow.com/users/3825101/macro-controller"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1512656631, "post_id": 47671101, "comment_id": 82353978, "body": "Do you have any idea how can I do it myself? I&#39;m running a series of tasks, and want to close my program when all the tasks are done."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1512657577, "post_id": 47671101, "comment_id": 82354640, "body": "you need yourself count tasks. say have <code>LONG dwTaskCount = 1</code>, every time when you add new task - call <code>InterlockedIncrement(&amp;dwTaskCount)</code>, every time when you finish task - <code>void OnTaskDone() { if (!InterlockedDecrement(&amp;dwTaskCount)) SomeSignal();</code> also once call <code>OnTaskDone()</code> after you finish add new tasks. in <code>OnSignal</code> you can set some event, or do another job.. however without more knowledge about your requirements - hard select the best implementation"}], "owner": {"reputation": 1199, "user_id": 3825101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJgje.png?s=128&g=1", "display_name": "macro_controller", "link": "https://stackoverflow.com/users/3825101/macro-controller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512553284, "creation_date": 1512553284, "question_id": 47671101, "link": "https://stackoverflow.com/questions/47671101/windows-threadpool-api-wait-until-all-tasks-finished", "title": "Windows ThreadPool API - wait until all tasks finished", "body": "<p>I'm trying to use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686766%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Windows Thread Pool API</a> as pat of my C program. In my scenario, I want to send many tasks to the thread pool, and wait until all tasks are finished, and there are no more pending tasks. After all tasks finished I want to close the thread pool and continue execution of my program.</p>\n\n<p>I believe the way to achieve it is using the wait objects described in the link above, but I can't really figure out what is the right way to do that. Does anyone understand if it's possible and what is the right way to do that?</p>\n"}, {"tags": ["c", "process", "system"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1512552087, "post_id": 47670671, "comment_id": 82300158, "body": "What\u2019s <code>number</code>? Where\u2019s the rest of the program? (If the rest of the program is too big, make it smaller and see if the problem still happens. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1512552206, "post_id": 47670671, "comment_id": 82300247, "body": "execvp sets <code>errno</code> if it fails."}, {"owner": {"reputation": 300, "user_id": 4416073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8973deeb0a5d81aef4ca801a42391cb?s=128&d=identicon&r=PG&f=1", "display_name": "Steven ", "link": "https://stackoverflow.com/users/4416073/steven"}, "edited": false, "score": 0, "creation_date": 1512553593, "post_id": 47670671, "comment_id": 82301180, "body": "I wrote a quick program just to test if I can get execvp working but gdb is giving me a seg fault."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1512555858, "last_edit_date": 1512555858, "creation_date": 1512554322, "answer_id": 47671435, "question_id": 47670671, "link": "https://stackoverflow.com/questions/47670671/c-programming-using-execvp/47671435#47671435", "title": "c programming using execvp", "body": "<p>The main problem is with this line:</p>\n\n<pre><code>char *args[] = {\"./isEven\", 12345, NULL};\n</code></pre>\n\n<p>The <code>args</code> passed to <code>execvp</code> must be an array of <code>char*</code>. Having <code>12345</code> as an argument makes it interpret it as address and it's unlikely to be a valid address. In any case, that's not what you wanted to pass. So do:</p>\n\n<pre><code>char *args[] = {\"./isEven\", \"12345\", NULL};\n</code></pre>\n\n<p>You need to convert <code>number</code> into a string. For example:</p>\n\n<pre><code>int number = 12345;\nchar num_str[256];\nsnprintf(num_str, sizeof num_str, \"%d\", number);\nchar *args[] = {\"./isEven\", num_str, NULL};\nexecvp(\"./isEven\", args);\nperror(\"exec\");\n</code></pre>\n\n<hr>\n\n<p>In your modified example, you are printing <code>errno</code> as:</p>\n\n<pre><code>printf(errno);\n</code></pre>\n\n<p>This will fail because <code>printf</code> expects a string as its first argument. You can use <a href=\"http://man7.org/linux/man-pages/man3/perror.3.html\" rel=\"nofollow noreferrer\"><code>perror()</code></a> to print the error as shown above.</p>\n"}], "owner": {"reputation": 300, "user_id": 4416073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8973deeb0a5d81aef4ca801a42391cb?s=128&d=identicon&r=PG&f=1", "display_name": "Steven ", "link": "https://stackoverflow.com/users/4416073/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1768, "favorite_count": 0, "accepted_answer_id": 47671435, "answer_count": 1, "score": 0, "last_activity_date": 1512558541, "creation_date": 1512551971, "last_edit_date": 1512558541, "question_id": 47670671, "link": "https://stackoverflow.com/questions/47670671/c-programming-using-execvp", "title": "c programming using execvp", "body": "<p>I'm working on a side project where I want to spawn 5 children processes then execvp into a second program called isEven which will tell if the number passed to it is even or not. However, the execvp call keeps failing as I ran it in gdb and it doesn't execute.\nArgs and load(args) are both called in another function.</p>\n\n<p>Thanks in advance!!! </p>\n\n<pre><code>//Code to load binary\nvoid load(char* args[])\n{\n    execvp(\"./isEven\", args);\n    printf(\"ERROR\\n\");\n} \n\n//args being passed in\nchar *args[] = {\"./isEven\", number, NULL};\nload(args);\n</code></pre>\n\n<p>Here is a smaller program I wrote which does the same thing I'm trying to do right now. Gdb says I am getting a segmentation fault.</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int returnCode = fork();\n\n    if(returnCode == 0)\n    {\n        char *args[] = {\"./isEven\", 12345, NULL};\n        execvp(\"./isEven\", args);\n        printf(errno);\n        printf(\"ERROR: execvp failed\\n\");\n        exit(-1);\n    }\n    else if(returnCode &lt; 0)\n    {\n        fprintf(stderr, \"fork failed\\n\");\n    }\n    else\n    {\n        //i am the parent\n        printf(\"I am the parent\");\n    }\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "swift"], "answers": [{"tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 4, "last_activity_date": 1512550907, "last_edit_date": 1512550907, "creation_date": 1512549435, "answer_id": 47669995, "question_id": 47669905, "link": "https://stackoverflow.com/questions/47669905/how-to-pass-a-string-from-c-to-swift/47669995#47669995", "title": "How to pass a string from C to swift?", "body": "<p>You might want to change </p>\n\n<pre><code>char c[]={\"H\",\"E\",\"L\",\"L\",\"O\"};\n</code></pre>\n\n<p>to </p>\n\n<pre><code>char c[]={'H','E','L','L','O','\\0'};\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>char c[]=\"HELLO\"; \n</code></pre>\n\n<p>By <code>char c[]={\"H\",\"E\",\"L\",\"L\",\"O\"};</code> an array of strings is getting declared, rather than an array of characters.\nThere is a difference between a string and a char.</p>\n\n<p>A string literal enclosed within a double quotes represents a set of characters. So, \"H\" seems to represent a single character to you, but internally it contains an additional character with <code>'H'</code> and the very necessary <code>'\\0'</code> which is terminating character in C. That was possibly the reason that you were getting a <code>H</code> printed on your console as output.</p>\n\n<p>This is because as per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.4.5\" rel=\"nofollow noreferrer\">C11 standard - Section: 6.4.5 String literals</a> which states,</p>\n\n<blockquote>\n  <p>A character string literal is a sequence of zero or more multibyte characters enclosed in double-quotes, as in \"xyz\". A UTF-8 string literal is the same, except prefixed by u8. A wide string literal is the same, except prefixed by the letter L, u, or U.</p>\n</blockquote>\n\n<p>Additionally, section: 6.4.4.4 Character constants states that,</p>\n\n<blockquote>\n  <p>An integer character constant is a sequence of one or more multibyte characters enclosed in single-quotes, as in 'x'. A wide character constant is the same, except prefixed by the letter L, u, or U. With a few exceptions detailed later, the elements of the sequence are any members of the source character set; they are mapped in an implementation-defined manner to members of the execution character set.</p>\n</blockquote>\n\n<p>Also,</p>\n\n<pre><code>char teststring()\n</code></pre>\n\n<p>means that <code>teststring</code> is supposed to return a <code>char</code>, and you are returning <code>c</code> which is now a string. So either change it to return a pointer to <code>char</code> i.e </p>\n\n<pre><code>char* teststring()\n</code></pre>\n\n<p>Or, return a <code>char</code> like <code>return c[0];</code></p>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 3602488, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17f02894dcd241394fde153d4c9951a8?s=128&d=identicon&r=PG&f=1", "display_name": "Raptisoft", "link": "https://stackoverflow.com/users/3602488/raptisoft"}, "is_accepted": false, "score": 1, "last_activity_date": 1512549838, "creation_date": 1512549838, "answer_id": 47670085, "question_id": 47669905, "link": "https://stackoverflow.com/questions/47669905/how-to-pass-a-string-from-c-to-swift/47670085#47670085", "title": "How to pass a string from C to swift?", "body": "<p>there's a couple things...</p>\n\n<p>First, it'd be a lot easier to format your string this way:</p>\n\n<pre><code>char* c=\"HELLO\";\n</code></pre>\n\n<p>But, if you want to do it your way still, you need to null-terminate your string, otherwise the computer will not know where the string ends and new memory begins:</p>\n\n<pre><code>char c[]={\"H\",\"E\",\"L\",\"L\",\"O\"};\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>char c[]={'H','E','L','L','O',0};\n</code></pre>\n\n<p>See the single quotes vs the double quotes?  The double quotes indicate a whole string (null terminated with zero)... the single quotes indicate a single char.</p>\n\n<p>So when you did it with double quotes, in characters in memory for the whole thing looked something like this:</p>\n\n<p>H0E0L0L0O0</p>\n\n<p>With single quotes, the characters in memory looks like this:</p>\n\n<p>HELLO0</p>\n\n<p>The printf function will print until it hits a zero and then quit.  That's why you were getting just the 'H' printing out.</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1512550218, "last_edit_date": 1592644375, "creation_date": 1512549891, "answer_id": 47670096, "question_id": 47669905, "link": "https://stackoverflow.com/questions/47669905/how-to-pass-a-string-from-c-to-swift/47670096#47670096", "title": "How to pass a string from C to swift?", "body": "<p>Yes you have to declare array of <code>char</code>s.</p>\n<p>So the it will be</p>\n<h3>Case-1</h3>\n<pre><code>char c[]={'H','E','L','L','O','\\0');\n</code></pre>\n<p>Here you have created something like array of array of chars. Coorect way of doing it would be.</p>\n<h3>Case-2</h3>\n<pre><code>char c[][2]={&quot;H&quot;,&quot;E&quot;,&quot;L&quot;,&quot;L&quot;,&quot;O&quot;};\n</code></pre>\n<p><em>But in this case you have to pass <code>c[0]</code> or <code>c[1]</code> in <code>printf</code>.</em></p>\n<p>Also note that the first thing can alternatively done using</p>\n<h3>Case-3</h3>\n<pre><code>   char c[]=&quot;HELLO&quot;;\n</code></pre>\n<p>This is an array of 6 characters, <code>\\0</code> included.</p>\n<p>And once again you could have also done</p>\n<h3>Case-4</h3>\n<pre><code>   char *c[]={&quot;H&quot;,&quot;E&quot;,&quot;L&quot;,&quot;L&quot;,&quot;O&quot;};\n</code></pre>\n<p>Here you have to pass the <code>c[0]</code> or <code>c[1]</code> which will print the string <code>&quot;H&quot;</code> or <code>&quot;E&quot;</code>.</p>\n<p>Also note that</p>\n<pre><code>char c[]={'H','E','L','L','O'};\n</code></pre>\n<p>is a valid initialization but this is not null terminated. So you can't pass it where a null terminated char array is expected. (like <code>strlen()</code> etc).</p>\n<p>Now the case-2, here the strings are modifiable. So you can change the character in them where as the strings in case-4 are not. Those are string literals which are non-modifiable.</p>\n<blockquote>\n<p>Simply put if you wanted to have a string which contains those as\ncharacters then Case-1 and case-3 are the way for you.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "is_accepted": false, "score": 0, "last_activity_date": 1512549999, "creation_date": 1512549999, "answer_id": 47670124, "question_id": 47669905, "link": "https://stackoverflow.com/questions/47669905/how-to-pass-a-string-from-c-to-swift/47670124#47670124", "title": "How to pass a string from C to swift?", "body": "<p><code>c</code> is an array and when you return <code>c</code> you return first element. You need to return entire array. Check</p>\n\n<pre><code>printf(\"%s\", c);\nreturn *c;\n</code></pre>\n\n<p>And remember to change signature of your function</p>\n"}], "owner": {"reputation": 31, "user_id": 8777837, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iUJgcmeGbTI/AAAAAAAAAAI/AAAAAAAAAEA/5Om8kq0R3Eg/photo.jpg?sz=128", "display_name": "pencilnoo", "link": "https://stackoverflow.com/users/8777837/pencilnoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1512553735, "creation_date": 1512549093, "last_edit_date": 1512553735, "question_id": 47669905, "link": "https://stackoverflow.com/questions/47669905/how-to-pass-a-string-from-c-to-swift", "title": "How to pass a string from C to swift?", "body": "<p>I am using OpenSSL as a library in swift. Since it's in C, I need to pass some data from C language back to swift. The data was an array, but after some research I have learned that I cannot pass an array from C to swift. One way I can think of it is to change the array into a string, an then pass the string back to swift. \nIn C I wrote:</p>\n\n<pre><code>char teststring()\n{\n    char c[]={\"H\",\"E\",\"L\",\"L\",\"O\"};\n    printf(c);\n    return c;\n}\n</code></pre>\n\n<p>In Swift I wrote:</p>\n\n<pre><code>teststring()\n</code></pre>\n\n<p>The result is that it only prints <code>H</code>.\nWhat did I do wrong with it? It there a easier way to pass an array from C back to Swift?</p>\n"}, {"tags": ["c", "linux-kernel"], "answers": [{"tags": [], "owner": {"reputation": 6731, "user_id": 725163, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Kgxeq.jpg?s=128&g=1", "display_name": "e.dan", "link": "https://stackoverflow.com/users/725163/e-dan"}, "is_accepted": true, "score": 3, "last_activity_date": 1602579805, "last_edit_date": 1602579805, "creation_date": 1512547618, "answer_id": 47669553, "question_id": 47669293, "link": "https://stackoverflow.com/questions/47669293/does-kfree-fill-the-memory-with-0x6b/47669553#47669553", "title": "Does kfree fill the memory with 0x6b?", "body": "<blockquote>\n<p>Is it a debugging mechanism of Linux kernel ...?</p>\n</blockquote>\n<p>Yes, it's called &quot;slab poisoning&quot;.</p>\n<p>Here is the <code>0x6b</code> declared in the source for memory freeing:</p>\n<p><a href=\"https://elixir.free-electrons.com/linux/v4.9/source/include/linux/poison.h#L56\" rel=\"nofollow noreferrer\">https://elixir.free-electrons.com/linux/v4.9/source/include/linux/poison.h#L56</a></p>\n<p>And here's a short blurb about it:</p>\n<p><a href=\"https://whatilearned2day.wordpress.com/2006/12/13/slab-poisoning/\" rel=\"nofollow noreferrer\">https://whatilearned2day.wordpress.com/2006/12/13/slab-poisoning/</a></p>\n"}], "owner": {"reputation": 300, "user_id": 1358465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832bc2977d8e3d9c358b24c62918f08f?s=128&d=identicon&r=PG", "display_name": "Garlic Tseng", "link": "https://stackoverflow.com/users/1358465/garlic-tseng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 47669553, "answer_count": 1, "score": 2, "last_activity_date": 1602579805, "creation_date": 1512546471, "last_edit_date": 1512547247, "question_id": 47669293, "link": "https://stackoverflow.com/questions/47669293/does-kfree-fill-the-memory-with-0x6b", "title": "Does kfree fill the memory with 0x6b?", "body": "<p>I ran into a bug that I found somehow the memory will be filled with '0x6b' for each char by someone else. (I check the memory via printk, not ICE.) After a lot of debugging I found out that it was because I accidentally did kfree to the memory (it was allocated by kmalloc).</p>\n\n<p>I'm curious about who fills the '0x6b' and trace the kfree code but can't find the code doing this. Is it a debugging mechanism of Linux kernel or there is some other reason?</p>\n\n<p>(the env is kernel 4.9)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1512545912, "post_id": 47669155, "comment_id": 82297014, "body": "<a href=\"https://stackoverflow.com/q/5431941/2173917\">Please see Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1512546351, "post_id": 47669155, "comment_id": 82297188, "body": "Have you tried stepping through with a debugger? Hint: After the end of <code>numFile1</code>, your second while loop is <code>while (14 &lt; 12 &amp;&amp; !feof()){}</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 2232, "user_id": 5947203, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/mFZwc.jpg?s=128&g=1", "display_name": "Ani", "link": "https://stackoverflow.com/users/5947203/ani"}, "edited": false, "score": 0, "creation_date": 1512547924, "post_id": 47669155, "comment_id": 82297915, "body": "@Ani The fix isn&#39;t that simple.  That will prevent premature exit, but it will attempt to read past EOF on the shorter file."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8767762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pCZLSKnA4V8/AAAAAAAAAAI/AAAAAAAAAZQ/PsAxzW-9Xqk/photo.jpg?sz=128", "display_name": "Beej", "link": "https://stackoverflow.com/users/8767762/beej"}, "edited": false, "score": 0, "creation_date": 1512556009, "post_id": 47669751, "comment_id": 82302843, "body": "When I tried to use <code>fscanf</code>&#39;s return values the program didn&#39;t put anything into the output file. It only started working once I put in the <code>feof()</code>"}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "reply_to_user": {"reputation": 1, "user_id": 8767762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pCZLSKnA4V8/AAAAAAAAAAI/AAAAAAAAAZQ/PsAxzW-9Xqk/photo.jpg?sz=128", "display_name": "Beej", "link": "https://stackoverflow.com/users/8767762/beej"}, "edited": false, "score": 0, "creation_date": 1512564227, "post_id": 47669751, "comment_id": 82307914, "body": "This is because the excerpt above was to show the output in the console. The answer has been edited to write results into <code>outputFile</code>."}], "tags": [], "owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "is_accepted": false, "score": 1, "last_activity_date": 1512564186, "last_edit_date": 1512564186, "creation_date": 1512548440, "answer_id": 47669751, "question_id": 47669155, "link": "https://stackoverflow.com/questions/47669155/arranging-numbers-in-a-file-using-c/47669751#47669751", "title": "Arranging numbers in a file using C", "body": "<p>There are a few problems with the current code</p>\n\n<ol>\n<li>Initialization of the 2 numbers should be performed before the main loop</li>\n<li>Use of <code>feof()</code> here</li>\n<li>Test of strict <code>&lt;</code> insteaf of <code>&lt;=</code> (could lock your algo)</li>\n<li>Keep reading a file if the other one becomes empty </li>\n</ol>\n\n<p>Regarding 2., <code>fscanf</code> returns a number <code>&gt;0</code> if it could read the number, so you can test this instead of checking <code>feof</code> (that says that EOF (a stop condition) happened before, and this might trigger one more unwanted iteration).</p>\n\n<p>Suggested fixed code:</p>\n\n<pre><code>int read1 = fscanf(numFile1, \"%d\", &amp;num1);\nint read2 = fscanf(numFile2, \"%d\", &amp;num2);\n\nwhile (read1 &gt; 0 || read2 &gt; 0) {\n    while (read1 &gt; 0 &amp;&amp; (read2&lt;=0 || num1 &lt;= num2))\n    {\n        fprintf(outputFile, \"%d\\n\", num1);\n        read1 = fscanf(numFile1, \"%d\", &amp;num1);\n    }\n    while (read2 &gt; 0 &amp;&amp; (read1&lt;=0 || num2 &lt;= num1))\n    {\n        fprintf(outputFile, \"%d\\n\", num2);\n        read2 = fscanf(numFile2, \"%d\", &amp;num2);\n    }\n} \n</code></pre>\n\n<p>Further explanations</p>\n\n<ul>\n<li><code>readX&lt;=0 || numY &lt;= numX</code> addresses <code>4.</code></li>\n<li><code>readX = fscanf(...)</code> addresses<code>2.</code></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8767762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pCZLSKnA4V8/AAAAAAAAAAI/AAAAAAAAAZQ/PsAxzW-9Xqk/photo.jpg?sz=128", "display_name": "Beej", "link": "https://stackoverflow.com/users/8767762/beej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512564186, "creation_date": 1512545822, "last_edit_date": 1512546383, "question_id": 47669155, "link": "https://stackoverflow.com/questions/47669155/arranging-numbers-in-a-file-using-c", "title": "Arranging numbers in a file using C", "body": "<p>I need to take the numbers listed in the two files \"numbers1.txt\" and \"numbers2.txt\" (where the numbers are listed in ascending order) and move them to a file named \"output.txt\" where they are arranged in ascending order.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>void appendToOutput(FILE *numFile1, FILE *numFile2, FILE *outputFile)\n{\nint num1 = 0;\nint num2 = 0;\n\ndo {\n    fscanf(numFile1, \"%d\", &amp;num1);\n    fscanf(numFile2, \"%d\", &amp;num2);\n    while ((num1 &lt; num2) &amp;&amp; !feof(numFile1))\n    {\n        fprintf(outputFile, \"%d\\n\", num1);\n        fscanf(numFile1, \"%d\", &amp;num1);\n    }\n    while ((num2 &lt; num1) &amp;&amp; !feof(numFile2))\n    {\n        fprintf(outputFile, \"%d\\n\", num2);\n        fscanf(numFile2, \"%d\", &amp;num2);\n    }\n    if (num1 == num2)\n    {\n        fprintf(outputFile, \"%d\\n%d\\n\", num1, num2);\n    }\n} while (!feof(numFile1) || !feof(numFile2));\n\nreturn;\n}\n</code></pre>\n\n<p>my files look like the following:</p>\n\n<p>numbers1.txt</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n</code></pre>\n\n<p>numbers2.txt:</p>\n\n<pre><code>2\n4\n6\n8\n10\n12\n14\n16\n18\n20\n22\n24\n</code></pre>\n\n<p>The issue I am having is that the output file ends up looking like this:\noutput.txt</p>\n\n<pre><code>1\n2\n2\n3\n4\n4\n5\n6\n6\n7\n8\n8\n9\n10\n10\n11\n12\n12\n</code></pre>\n\n<p>So my issue is that the program is not continuing to read/write numbers from numbers2.txt even though it has not yet hit the end of it's file. I've looked through it and I can't seem to find out why it's stopping, so help would be appreciated!</p>\n"}, {"tags": ["c", "performance", "arithmetic-expressions"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 8, "creation_date": 1512545764, "post_id": 47669101, "comment_id": 82296937, "body": "It is pretty pointless to answer this in a general way, it depends on the specific CPU. Generally, it is best to write the code as clear as possible and then let the compiler worry about optimization."}, {"owner": {"reputation": 6824, "user_id": 3202093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004496564514/picture?type=large", "display_name": "sp2danny", "link": "https://stackoverflow.com/users/3202093/sp2danny"}, "edited": false, "score": 4, "creation_date": 1512546652, "post_id": 47669101, "comment_id": 82297348, "body": "Unless you are using an incompetent compiler, these kinds of micro-optimizations are already being done for you."}, {"owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "edited": false, "score": 0, "creation_date": 1512547667, "post_id": 47669101, "comment_id": 82297802, "body": "gcc is quite smart when using division by a integer constant: <a href=\"https://stackoverflow.com/questions/41183935/why-does-gcc-use-multiplication-by-a-strange-number-in-implementing-integer-divi\">Why does GCC use multiplication by a strange number in implementing integer division?</a>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1512548288, "post_id": 47669101, "comment_id": 82298061, "body": "Far too broad currently. For example, what are the types of X, Y, and Z?"}, {"owner": {"reputation": 131, "user_id": 2204038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e68490326f74f5435cff128b269a813?s=128&d=identicon&r=PG", "display_name": "Dipankar", "link": "https://stackoverflow.com/users/2204038/dipankar"}, "edited": false, "score": 0, "creation_date": 1512550344, "post_id": 47669101, "comment_id": 82299164, "body": "X Y Z all are integer, using gcc.  I jusy thought it in this way, Y = X*3;  // Y = (X&lt;&lt;1) +X;  But I am not sure, what I am achieving after this much changes."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1512551385, "post_id": 47669101, "comment_id": 82299716, "body": "In any case you need to look at the generated assembler code to verify whether you gained anything."}, {"owner": {"reputation": 66, "user_id": 9032857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4399dc80b1e694909b0177bfbd4e9db?s=128&d=identicon&r=PG&f=1", "display_name": "Ora", "link": "https://stackoverflow.com/users/9032857/ora"}, "edited": false, "score": 0, "creation_date": 1512571584, "post_id": 47669101, "comment_id": 82312890, "body": "you could also look at the generated assembly code for the original commands to see how you could possibly improve"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2204038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e68490326f74f5435cff128b269a813?s=128&d=identicon&r=PG", "display_name": "Dipankar", "link": "https://stackoverflow.com/users/2204038/dipankar"}, "edited": false, "score": 0, "creation_date": 1513013949, "post_id": 47677931, "comment_id": 82477936, "body": "Thanks for your suggestion Andriy. I am already using -O3 also it is confirmed that CPU is getting exhausted."}, {"owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "reply_to_user": {"reputation": 131, "user_id": 2204038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e68490326f74f5435cff128b269a813?s=128&d=identicon&r=PG", "display_name": "Dipankar", "link": "https://stackoverflow.com/users/2204038/dipankar"}, "edited": false, "score": 0, "creation_date": 1513070192, "post_id": 47677931, "comment_id": 82498910, "body": "@dipankar sorry, the only way to optimize x*3 is x+x+x, which is not always faster. You should show us more code to get more practical suggestions."}], "tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": false, "score": 1, "last_activity_date": 1512574301, "last_edit_date": 1592644375, "creation_date": 1512574301, "answer_id": 47677931, "question_id": 47669101, "link": "https://stackoverflow.com/questions/47669101/how-to-use-divided-by-1000-as-cpu-optimization/47677931#47677931", "title": "How to use divided by 1000 as CPU optimization?", "body": "<h3>1. Confirm your bottlenecks</h3>\n<p>There are CPU-bound, memory-bound, IO-bound applications etc. Your low-end processor in fact may spend most of the time waiting for the data from DRAM, doing some IO, or waiting for a spinlock. So the first thing you do is to confirm your real bottleneck.</p>\n<p>There are tools for this, like free <code>perf</code> for Linux or paid Intel VTune.</p>\n<h3>2. Show us the context</h3>\n<p>If you found that most of the time your CPU spends on foo(), show us this function so we could help.</p>\n<h3>3. Generic suggestions</h3>\n<p>For your generic question, you will get just generic suggestions, like:</p>\n<ol>\n<li>Use more aggressive compiler optimization, like <code>-O3</code></li>\n<li>Change your algorithms.</li>\n<li>Avoid locks.</li>\n<li>Align your data.</li>\n<li>Avoid false sharing.</li>\n<li>Make your data structures more compact.</li>\n<li>Use prefetch.</li>\n</ol>\n<p>etc etc</p>\n<p>Sorry, there is no context to suggest you a more specific technique.</p>\n"}], "owner": {"reputation": 131, "user_id": 2204038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e68490326f74f5435cff128b269a813?s=128&d=identicon&r=PG", "display_name": "Dipankar", "link": "https://stackoverflow.com/users/2204038/dipankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1512574301, "creation_date": 1512545588, "question_id": 47669101, "link": "https://stackoverflow.com/questions/47669101/how-to-use-divided-by-1000-as-cpu-optimization", "title": "How to use divided by 1000 as CPU optimization?", "body": "<p>I am using small embedded PCIe based hardware, which is having a very low-end processor, based on the operation and firmware size, I am consuming all of its resources. To do CPU optimization what are the steps I can do?</p>\n\n<p>I have tried to move multiplication(*) and divisions(/) using bitwise.\nBut I have codes like this</p>\n\n<pre><code>Y = X * 3;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Z = X / 1000;\n</code></pre>\n\n<p>getting confused how to do these in CPU friendly ways.</p>\n"}, {"tags": ["c", "sockets", "networking"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1512544204, "post_id": 47668695, "comment_id": 82296134, "body": "Did you do this at both ends? What did <code>setsockopt</code> return? Did you time the <i>code</i> itself, comparing the timestamps with Wireshark?"}, {"owner": {"reputation": 196, "user_id": 7439381, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nZkDJmzC57c/AAAAAAAAAAI/AAAAAAAAAcM/s_glMjx5_X0/photo.jpg?sz=128", "display_name": "Shihab Pullissery", "link": "https://stackoverflow.com/users/7439381/shihab-pullissery"}, "edited": false, "score": 0, "creation_date": 1512544427, "post_id": 47668695, "comment_id": 82296264, "body": "Have you tried to clear TCP_CORK along with setting TCP_NODELAY ? I remember when i had the same problem I done both.that is i set tcp_nodelay and cleared tcp_cork"}, {"owner": {"reputation": 31, "user_id": 8269765, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B50OwskEWV0/AAAAAAAAAAI/AAAAAAAAAAA/7nmVfFKOIP4/photo.jpg?sz=128", "display_name": "Cloud Lee", "link": "https://stackoverflow.com/users/8269765/cloud-lee"}, "edited": false, "score": 0, "creation_date": 1512545683, "post_id": 47668695, "comment_id": 82296901, "body": "To Antti : I only add setsockopt on server side."}, {"owner": {"reputation": 31, "user_id": 8269765, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B50OwskEWV0/AAAAAAAAAAI/AAAAAAAAAAA/7nmVfFKOIP4/photo.jpg?sz=128", "display_name": "Cloud Lee", "link": "https://stackoverflow.com/users/8269765/cloud-lee"}, "edited": false, "score": 0, "creation_date": 1512545780, "post_id": 47668695, "comment_id": 82296944, "body": "To Shihab : I will  try to clear TCP_CORK, thank for your comment"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1512549163, "post_id": 47668695, "comment_id": 82298542, "body": "@CloudLee you can reply to people like this."}, {"owner": {"reputation": 31, "user_id": 8269765, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B50OwskEWV0/AAAAAAAAAAI/AAAAAAAAAAA/7nmVfFKOIP4/photo.jpg?sz=128", "display_name": "Cloud Lee", "link": "https://stackoverflow.com/users/8269765/cloud-lee"}, "edited": false, "score": 0, "creation_date": 1512552047, "post_id": 47668695, "comment_id": 82300136, "body": "@ Ajay Thanks a lot"}, {"owner": {"reputation": 196, "user_id": 7439381, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nZkDJmzC57c/AAAAAAAAAAI/AAAAAAAAAcM/s_glMjx5_X0/photo.jpg?sz=128", "display_name": "Shihab Pullissery", "link": "https://stackoverflow.com/users/7439381/shihab-pullissery"}, "edited": false, "score": 1, "creation_date": 1512552731, "post_id": 47668695, "comment_id": 82300608, "body": "@CloudLee Please comment if your problem is solved, So that it will help others."}, {"owner": {"reputation": 31, "user_id": 8269765, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B50OwskEWV0/AAAAAAAAAAI/AAAAAAAAAAA/7nmVfFKOIP4/photo.jpg?sz=128", "display_name": "Cloud Lee", "link": "https://stackoverflow.com/users/8269765/cloud-lee"}, "edited": false, "score": 0, "creation_date": 1512614347, "post_id": 47668695, "comment_id": 82333031, "body": "This problem is solved, it is not TCP problem. It&#39;s related to printf function. Since I will output log to terminal. I guess print function will queue message. After turn off this function is work well."}], "owner": {"reputation": 31, "user_id": 8269765, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-B50OwskEWV0/AAAAAAAAAAI/AAAAAAAAAAA/7nmVfFKOIP4/photo.jpg?sz=128", "display_name": "Cloud Lee", "link": "https://stackoverflow.com/users/8269765/cloud-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "closed_date": 1513281443, "answer_count": 0, "score": 2, "last_activity_date": 1512543961, "creation_date": 1512543961, "question_id": 47668695, "link": "https://stackoverflow.com/questions/47668695/how-to-send-a-packet-immediately", "closed_reason": "Not suitable for this site", "title": "How to send a packet immediately", "body": "<p>I use Linux C to write a simple socket program. (Both client &amp; server side)\nWhen server got a packet from client. Server will send a response packet to client.</p>\n\n<p>When client send continuous packets, I expect server send back resp. packets within 100ms. However, the time of resp. packet send back sometimes over 300ms.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6q58F.png\" rel=\"nofollow noreferrer\">send packet not immediately</a></p>\n\n<p>I try to used disable NAGLE algorithm.</p>\n\n<pre><code>setsockopt(serverTcpSockId, IPPROTO_TCP, TCP_NODELAY, &amp;reuse_flag, sizeof(int));\n</code></pre>\n\n<p>or disable send buffer</p>\n\n<pre><code>setsockopt(serverTcpSockId, SOL_SOCKET, SO_SNDBUF, &amp;nZero, sizeof(nZero));\n</code></pre>\n\n<p>Both these two methods not work.</p>\n"}, {"tags": ["c++", "c", "ssl", "encryption", "openssl"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1512542596, "post_id": 47668236, "comment_id": 82295292, "body": "Where&#39;s the code..."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1512542984, "post_id": 47668236, "comment_id": 82295505, "body": "Dubious source material. SSL uses symmetric encryption, not PKI. If you don&#39;t use RSA for key exchange, you aren&#39;t using it at all."}], "answers": [{"comments": [{"owner": {"reputation": 35623, "user_id": 1003575, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cceded39fb12d936211b56afc86dcb04?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAMED", "link": "https://stackoverflow.com/users/1003575/mohamed"}, "edited": false, "score": 0, "creation_date": 1512543180, "post_id": 47668447, "comment_id": 82295617, "body": "is it possible to use the <code>SSL_CTX_set_cipher_list()</code> instead of <code>SSL_set_cipher_list()</code> after ssl CTX init?"}], "tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": false, "score": 2, "last_activity_date": 1512542933, "creation_date": 1512542933, "answer_id": 47668447, "question_id": 47668236, "link": "https://stackoverflow.com/questions/47668236/openssl-function-to-define-cipher-order/47668447#47668447", "title": "openssl function to define cipher order", "body": "<p>From the OpenSSL documentation, the relevant function call here is <a href=\"https://www.openssl.org/docs/man1.0.2/ssl/SSL_set_cipher_list.html\" rel=\"nofollow noreferrer\"><code>SSL_set_cipher_list</code></a></p>\n\n<p>The OpenSSL recommended string to use here is <code>HIGH:!aNULL:!kRSA:!PSK:!SRP:!MD5:!RC4</code>, since the <code>!kRSA</code> disables using RSA as the key exchange and forces the use of ephemeral DH, which provides the Perfect Forward Secrecy that you describe in your question.</p>\n\n<p>As a disclaimer, the cipher string above may not be what is recommended today, it is just what is recommended in the OpenSSL documentation.</p>\n"}], "owner": {"reputation": 35623, "user_id": 1003575, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cceded39fb12d936211b56afc86dcb04?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAMED", "link": "https://stackoverflow.com/users/1003575/mohamed"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "closed_date": 1512589123, "answer_count": 1, "score": 2, "last_activity_date": 1512542933, "creation_date": 1512542132, "last_edit_date": 1512542749, "question_id": 47668236, "link": "https://stackoverflow.com/questions/47668236/openssl-function-to-define-cipher-order", "closed_reason": "Not suitable for this site", "title": "openssl function to define cipher order", "body": "<p>I have a light http server (embedded software solution). This http server is calling openssl functions to handle https connexions.</p>\n\n<p>I want to make the https server prioritize some ciphers. because according to the following <a href=\"https://www.digicert.com/ssl-support/ssl-enabling-perfect-forward-secrecy.htm\" rel=\"nofollow noreferrer\">link</a>, the https connection is more secure when the DH cipher are prioritized:</p>\n\n<blockquote>\n  <p>Instead of using the RSA method for exchanging session keys, you\n  should use the Elliptic Curve Diffie-Hellman (ECDHE) key exchange.\n  Note that you can still use the RSA public-key cryptosystem as the\n  encryption algorithm, just not as the key exchange algorithm. ECDHE is\n  much faster than ordinary DH (Diffie-Hellman), but both create session\n  keys that only the entities involved in the SSL connection can access.\n  Because the session keys are not linked to the server\u2019s key pair, the\n  server\u2019s private key alone cannot be used to decrypt any SSL session.</p>\n  \n  <p>To enable Perfect Forward Secrecy, you must do the following:</p>\n  \n  <p>1- Reorder your cipher suites to place the ECDHE (Elliptic Curve\n  Diffie-Hellman) suites at the top of list, followed by the DHE\n  (Diffie-Hellman) suites.</p>\n  \n  <p>2- Configure servers to enable other non-DH-key-exchange cipher\n  suites from the list of cipher suites offered by the SSL Client.</p>\n</blockquote>\n\n<p>How I can change the cipher order on my openssl server to make the DH ciphers first? </p>\n"}, {"tags": ["c", "macos-sierra", "pid", "ports"], "comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1512541716, "post_id": 47668036, "comment_id": 82294910, "body": "have you tried using strace with sudo lsof -i tcp:6697?"}, {"owner": {"reputation": 962, "user_id": 3784644, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/GnY64.jpg?s=128&g=1", "display_name": "DTSCode", "link": "https://stackoverflow.com/users/3784644/dtscode"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1512541777, "post_id": 47668036, "comment_id": 82294939, "body": "If you can find me an strace that will work with Mac I would be glad to use it. Otherwise, <code>sudo dtruss lsof ...</code> doesn&#39;t show anything relevant due to SIP"}], "owner": {"reputation": 962, "user_id": 3784644, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/GnY64.jpg?s=128&g=1", "display_name": "DTSCode", "link": "https://stackoverflow.com/users/3784644/dtscode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1512542028, "creation_date": 1512541347, "question_id": 47668036, "link": "https://stackoverflow.com/questions/47668036/get-pid-of-process-using-port-in-macos-sierra", "title": "Get PID of process using port in macos Sierra", "body": "<p>I am writing an ident server for IRC on macos Sierra, and I am having trouble with finding the owner of the port. In linux, this seems to be done with /proc/net/tcp if I remember correctly. I know it is theoretically possible, because <code>sudo lsof -i tcp:6697</code> lists the exact information I want (username and local port). I have tried going through the lsof source code on opensource.apple.com, but I was unable to locate where and how lsof does this. Google also yielded me no results beyond \"Here is how to do it with lsof\" or \"Here is how to do it on linux\". I also couldn't see anything relevant in sysctl(3). If anyone has a solution to this, or some insight, it would be much appreciated. Thank you!</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512533817, "post_id": 47666648, "comment_id": 82292503, "body": "If <code>A</code> is a 2-D array then <code>A[n]</code> is the n-th row of the array (starting from 0)"}, {"owner": {"reputation": 13, "user_id": 9059626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac538f83887cfa3ecdd3c4c4439d4cc2?s=128&d=identicon&r=PG&f=1", "display_name": "Anna ", "link": "https://stackoverflow.com/users/9059626/anna"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512533947, "post_id": 47666648, "comment_id": 82292531, "body": "@M.M that make sense, thanks!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1512543754, "post_id": 47666648, "comment_id": 82295906, "body": "That is some <b>very</b> garbage code. First of all the table should be typed <b>signed char</b>!! The author of <i>that</i> code should go writing Visual Basic."}], "answers": [{"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 3, "last_activity_date": 1512548747, "last_edit_date": 1512548747, "creation_date": 1512533890, "answer_id": 47666712, "question_id": 47666648, "link": "https://stackoverflow.com/questions/47666648/access-c-multidemensional-array-with-only-one-argument/47666712#47666712", "title": "access c multidemensional array with only one argument?", "body": "<p>The type of <code>gradient</code> is <code>static const char[32][4]</code> i.e. a two dimensional array of chars. When you dereference it twice using <code>[]</code> operator you get a <code>char</code>.</p>\n\n<p>But in this case when you deference only once you get <code>const char[4]</code> which can be decayed into <code>const char*</code> and assigned to <code>g0000</code>.</p>\n\n<p>Precisely, <code>g0000</code> will hold the address of the 2nd sub-array if <code>Indice(x1, y1, z1, t1)</code> returned 1.</p>\n"}, {"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512534886, "post_id": 47666761, "comment_id": 82292748, "body": "&quot;multidimensional array is stored in memory in C is as a 1D array&quot;, and then &quot;multidimensional array is stored in memory in C is as a 1D array&quot;-- this seems a little misleading, because with <code>ray[2][2]</code>, <code>int *rayP = &amp;ray[0];</code>, <code>rayP[3]</code> is undefined behavior."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1512535147, "post_id": 47666761, "comment_id": 82292806, "body": "Misleading because: 1) 2d arrays of <code>int</code> are arrays of arrays, not arrays of <code>int</code>, and 2) you can&#39;t legally access a 2d array as if it were a 1d array."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1512535168, "post_id": 47666761, "comment_id": 82292811, "body": "A snippet proves nothing. Quotes from the standard on the other hand do."}, {"owner": {"reputation": 3812, "user_id": 7697209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0zmCe.png?s=128&g=1", "display_name": "Kostas", "link": "https://stackoverflow.com/users/7697209/kostas"}, "edited": false, "score": 0, "creation_date": 1512535483, "post_id": 47666761, "comment_id": 82292894, "body": "You are absolutely right David. The abstraction that is created by C is that a 2D array for example is an array of arrays, so it&#39;s kind of tricky to access the memory as it actually is written. When running <code>*rayP = &amp;ray[0];</code> in your example, you get a compiler error, as <code>&amp;ray[0]</code> is treated as an array of arrays of 3 elements <code>int(*)[3]</code>, while <code>rayP</code> is treated as <code>int *</code>. You need to cast it to an <code>int *</code> first for you to access the memory successfully."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1512535700, "post_id": 47666761, "comment_id": 82292950, "body": "Note that there is debate over whether this access is legal (although everyone agrees that after <code>int *rayP = (int *)&amp;ray;</code> , then <code>rayP[3]</code> is OK)"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1512535875, "post_id": 47666761, "comment_id": 82293001, "body": "@M.M -- &quot;although everyone agrees&quot; -- that looks like a strict aliasing violation, since <code>int *</code> and <code>int (*)[]</code> are not compatible types."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1512536240, "post_id": 47666761, "comment_id": 82293126, "body": "@DavidBowling Neither of those types are relevant to strict aliasing. The rule is that an object of type <code>T</code> may only be accessed by an lvalue of type <code>T</code> (plus some exceptions). In this code there is access of <code>int</code> objects by lvalue of type <code>int</code> and nothing else. There are no <code>int *</code> objects being aliased, and there is no access of array objects (which is not even possible in C, only the array elements may be accessed)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1512537921, "post_id": 47666761, "comment_id": 82293645, "body": "@Stargateur the question you link to is about accessing out of bounds of an array, which is nothing to do with strict aliasing. Using bold typeface does not change wrong statements into correct ones ."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512539421, "post_id": 47666761, "comment_id": 82294160, "body": "@M.M -- I concede that I was wrong about strict aliasing here. My original point was not about this, but about the dangers of thinking of a 2d array of <code>int</code> as a big 1d array of <code>int</code> instead of as a 1d array of 1d arrays of <code>int</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512548590, "post_id": 47666761, "comment_id": 82298222, "body": "@DavidBowling maybe the discussion here can help. We have tried to look over as many factors as possible"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1512551047, "post_id": 47666761, "comment_id": 82299541, "body": "@Stargateur: The relevant part of the standard is C 2011 [N1570] 6.3.2.3 7: \u201cA pointer to an object type may be converted to a pointer to a different object type. If the resulting pointer is not correctly aligned for the referenced type, the behavior is undefined.\u2026\u201d So converting the pointer is legal if the alignment is satisfied, which of course it would be when going from an array of <code>int</code> to <code>int</code>. Using the pointer is not defined."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512561089, "post_id": 47666761, "comment_id": 82306050, "body": "@EricPostpischil -- &quot;Using the pointer is not defined&quot; are you saying that <code>rayP[3]</code> is an illegal access attempt (and UB), <a href=\"https://stackoverflow.com/users/1505939/m-m\">in disagreement with M.M&#39;s comment</a>?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512565652, "post_id": 47666761, "comment_id": 82308879, "body": "@DavidBowling: (a) <code>rayP[3]</code> is undefined because the C standard does not define what the resulting value of converting <code>int (*)[3]</code> to <code>int *</code> is other than that, when converted back, it must compare equivalent to the original pointer. (b) I do not see any comment by M.M. that says <code>rayP[3]</code> is legal. There is one that says there is debate, which is literally true, one that says the aliasing rules are not applicable here, which is true, one that says <code>ray</code> may be converted to <code>int *</code>, which is true, and one that says Stargateur\u2019s link speaks to out-of-bounds access, which is true."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512565790, "post_id": 47666761, "comment_id": 82308952, "body": "@EricPostpischil -- in the comment I linked: &quot;although everyone agrees that after <code>int *rayP = (int *)&amp;ray;</code> , then <code>rayP[3]</code> is OK)&quot;."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512566310, "post_id": 47666761, "comment_id": 82309264, "body": "@DavidBowling: Your link was to M.M.\u2019s user profile, not to a comment. But now I see it. Note that that is a different statement. It says not that <code>rayP[3]</code> after the original <code>int *rayP = (int *) ray;</code> is fine but that <code>rayP[3]</code> after <code>int *rayP = (int *)&amp;ray;</code> is fine. However, both are not defined, for the same reason, that C does not define the value that results from converting either <code>int (*)[3]</code> or <code>int (*)[2][3]</code> to <code>int *</code> other than that it must convert back to something equivalent to the original. On the other hand, <code>int *rayP = (int *)*ray;</code> would produce a usable value."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512567911, "post_id": 47666761, "comment_id": 82310399, "body": "@EricPostpischil -- sorry about the mislink; need coffee. My original comment used <code>int *rayP = &amp;ray[0][0];</code> (forgot the second <code>[0]</code> in the original) to avoid what looked like UB due to dereferencing <code>rayP</code> in <code>int *rayP = (int *) ray;</code> followed by <code>printf(&quot;%d\\n&quot;, rayP[3]);</code> from this answer. I should never have mentioned strict aliasing."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512592829, "post_id": 47666761, "comment_id": 82325518, "body": "@EricPostpischil By your logic , <code>int *x = malloc(sizeof(int)); x[0] = 0;</code> is UB because the result of converting <code>void *</code> to <code>int *</code> is undefined other than that it must give the same value when converted back to <code>void *</code>.  I feel this is an impractical interpretation of the standard that you take; I follow <a href=\"https://stackoverflow.com/a/25570179/1505939\">this answer</a> (and not the answer by Anton Savin on the same thread)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512594585, "post_id": 47666761, "comment_id": 82326421, "body": "@M.M: <code>malloc</code> is defined to return space for an object of the requested size (if it succeeds), so we know it returns a pointer that may be converted to a pointer to the object. Then rule for storing a value into an object having no declared type (6.5 6) allows us to assign a value to <code>x[0]</code>, after which the rule is clear that there is an <code>int</code> there and not an object of some other type. Effectively, the specification of <code>malloc</code> requires that it be possible to convert the <code>void *</code> returned by <code>malloc</code> to a pointer to an type that could have been created by that <code>malloc</code> (is the right size)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512594785, "post_id": 47666761, "comment_id": 82326530, "body": "@M.M: But that does not mean that <b>any</b> <code>void *</code> can be so converted. The standard makes provision for pointers that compare equal having different representations, for example. Pointers may have different information in them depending on their history. A pointer converted from a <code>int (*)[2]</code> might have different data than a pointer converted from <code>int *</code>, even if they theoretically pointed to the same byte. So converting a pointer to an array to a pointer to an <code>int</code> might not include the data that C implementation needs to work properly."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512594871, "post_id": 47666761, "comment_id": 82326575, "body": "@M.M: Additionally, the optimizer might transform the code in ways that preserve valid pointer uses but that break invalid pointer uses."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1512595053, "post_id": 47666761, "comment_id": 82326676, "body": "@EricPostpischil if you agree that they theoretically point to the same byte, then they can be used to access memory at that location, so long as there is not a strict aliasing violation"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1512595360, "post_id": 47666761, "comment_id": 82326819, "body": "@M.M: I wrote \u201c<b>pointed</b> to\u201d, not \u201cpoint to\u201d. An <code>int *</code> converted to <code>float *</code> is not guaranteed to point to anything at all. If <code>A</code> is an <code>int (*)[2]</code> and <code>B</code> is an <code>int *</code>, and <code>B</code> was created by <code>B = &amp;(*A)[0]</code>, so <code>B</code> points to the first element of the array that <code>A</code> points to, so they point to objects (an array and an <code>int</code>) that start at the same byte, and then we do <code>float *fA = (float *) A</code> and <code>float *fB = (float *) B</code>, there is no guarantee that <code>fA</code> and <code>fB</code> have the same values (or compare equal) or point to the original byte. All we know is that converting back works."}], "tags": [], "owner": {"reputation": 3812, "user_id": 7697209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0zmCe.png?s=128&g=1", "display_name": "Kostas", "link": "https://stackoverflow.com/users/7697209/kostas"}, "is_accepted": false, "score": 2, "last_activity_date": 1512535703, "last_edit_date": 1512535703, "creation_date": 1512534314, "answer_id": 47666761, "question_id": 47666648, "link": "https://stackoverflow.com/questions/47666648/access-c-multidemensional-array-with-only-one-argument/47666761#47666761", "title": "access c multidemensional array with only one argument?", "body": "<p>The way a static multidimensional array is stored in memory as a 1D array (in C).</p>\n\n<p>For example if you have the following array:</p>\n\n<pre><code>int ray[2][3] = {{1, 2, 3}, {4, 5, 6}};\n</code></pre>\n\n<p>the memory allocation is exactly the same as in:</p>\n\n<pre><code>int ray[6] = {1, 2, 3, 4, 5, 6};\n</code></pre>\n\n<p>This can be shown by the following snippet:</p>\n\n<pre><code>int ray[2][2] = {1, 2, 3, 4};\nint *rayP = (int *) ray;\nprintf(\"%d\\n\", rayP[3]);     //PRINTS 4\n</code></pre>\n\n<p>The reason that you can use multiple indices is just C making your life easier in using it as a 2D array abstraction.</p>\n\n<p>So if you access the element <code>ray[x][y]</code> of an array <code>ray[a][b]</code>, the element you actually access is <code>ray[x * b + y]</code>, even though C won't let you do that to keep the abstraction clear.</p>\n\n<p>Instead, if you try to access element <code>ray[x]</code> directly, it will return you <code>&amp;ray[x * b]</code>, which is exactly what you want here:</p>\n\n<p>A pointer to the beginning of the desired sub-array, which you can treat as an array.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1512535753, "post_id": 47666887, "comment_id": 82292967, "body": "<code>gradient[i]</code> is an array, not a pointer.  Also your address expression is wrong, <code>x[y]</code> is equivalent to <code>*(x + y)</code>, there are no additional sizeof steps"}], "tags": [], "owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "is_accepted": false, "score": 0, "last_activity_date": 1512539501, "last_edit_date": 1512539501, "creation_date": 1512535199, "answer_id": 47666887, "question_id": 47666648, "link": "https://stackoverflow.com/questions/47666648/access-c-multidemensional-array-with-only-one-argument/47666887#47666887", "title": "access c multidemensional array with only one argument?", "body": "<p>That wouldn't be unreasonable to assume <code>Indice()</code> returns the index of the row in <code>gradient</code> that holds the 4 values <code>x1, y1, z1 and t1</code>.</p>\n\n<p><code>gradient</code> being <code>const char[32][4]</code>, say <code>Indice</code> returns an index <code>i</code> used in <code>gradient</code></p>\n\n<pre><code>gradient[i] \n</code></pre>\n\n<p>is an address that points to a <code>char</code> ; the calculated address of <code>gradient[i]</code></p>\n\n<pre><code>g0000 = gradient[i]\n</code></pre>\n\n<p>is </p>\n\n<pre><code>gradient + ( i*4*sizeof(gradient[0][0]) )\n</code></pre>\n\n<p>that is, it points to the first element of gradient at address <code>&amp;gradient[i][0]</code></p>\n\n<p>In C there is no automatic control of array out of bounds indexes, and in that array, accessing <code>[R][C]</code> is like accessing <code>[R*4+C]</code>, meaning while <code>g0000</code> points to a <code>[4]</code> char area, you might try to access beyond that 4-limit, (e.g. <code>[i][5]</code>) and would access the next row (since it's <code>[i*4+5]</code> or <code>[i+1][1]</code>).</p>\n\n<p>However accessing the array out of bounds leads to undefined behavior (if <code>i+1 &gt; 31</code> in that case, since an array <code>[X]</code> goes from <code>[0]</code> to <code>[X-1]</code>).</p>\n"}], "owner": {"reputation": 13, "user_id": 9059626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac538f83887cfa3ecdd3c4c4439d4cc2?s=128&d=identicon&r=PG&f=1", "display_name": "Anna ", "link": "https://stackoverflow.com/users/9059626/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "accepted_answer_id": 47666712, "answer_count": 3, "score": 1, "last_activity_date": 1512548747, "creation_date": 1512533433, "last_edit_date": 1512539752, "question_id": 47666648, "link": "https://stackoverflow.com/questions/47666648/access-c-multidemensional-array-with-only-one-argument", "title": "access c multidemensional array with only one argument?", "body": "<p>I am reading this <strong>C</strong> code, and I find it difficult to understand what's going on.</p>\n\n<p>Here is the array:</p>\n\n<pre><code>static const char   gradient[32][4] =\n{\n{ 1,  1,  1,  0}, { 1,  1,  0,  1}, { 1,  0,  1,  1}, { 0,  1,  1,  1},\n{ 1,  1, -1,  0}, { 1,  1,  0, -1}, { 1,  0,  1, -1}, { 0,  1,  1, -1},\n{ 1, -1,  1,  0}, { 1, -1,  0,  1}, { 1,  0, -1,  1}, { 0,  1, -1,  1},\n{ 1, -1, -1,  0}, { 1, -1,  0, -1}, { 1,  0, -1, -1}, { 0,  1, -1, -1},\n{-1,  1,  1,  0}, {-1,  1,  0,  1}, {-1,  0,  1,  1}, { 0, -1,  1,  1},\n{-1,  1, -1,  0}, {-1,  1,  0, -1}, {-1,  0,  1, -1}, { 0, -1,  1, -1},\n{-1, -1,  1,  0}, {-1, -1,  0,  1}, {-1,  0, -1,  1}, { 0, -1, -1,  1},\n{-1, -1, -1,  0}, {-1, -1,  0, -1}, {-1,  0, -1, -1}, { 0, -1, -1, -1},\n};\n</code></pre>\n\n<p>and it's 32*4, this is another part of the code that trying to access this array:</p>\n\n<pre><code>const char * g0000 = gradient[Indice (x1, y1, z1, t1)];\n</code></pre>\n\n<p><code>Indice</code> is a function that returns an <code>int</code>. So what is this <code>g0000</code> (I know it's a pointer), say <code>Indice</code> returns 1, what is the value <code>g0000</code> holds? I mostly code in <strong>C#</strong> to my understanding if you want to access multidimensional array you would need several arguments, but here is only one, I am really confused...</p>\n"}, {"tags": ["c", "multithreading", "sockets", "tcp", "memory-leaks"], "comments": [{"owner": {"reputation": 866, "user_id": 7607594, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OyzH_J0Nigs/AAAAAAAAAAI/AAAAAAAAAFg/tWm2BVaSBwY/photo.jpg?sz=128", "display_name": "Jorge Omar Medra", "link": "https://stackoverflow.com/users/7607594/jorge-omar-medra"}, "edited": false, "score": 0, "creation_date": 1512590757, "post_id": 47666459, "comment_id": 82324385, "body": "Could you share us the code of  <code>client_handler</code> function?"}, {"owner": {"reputation": 51, "user_id": 5963839, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1383569024991609/picture?type=large", "display_name": "Daryl VaDazzle McAllister", "link": "https://stackoverflow.com/users/5963839/daryl-vadazzle-mcallister"}, "reply_to_user": {"reputation": 866, "user_id": 7607594, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OyzH_J0Nigs/AAAAAAAAAAI/AAAAAAAAAFg/tWm2BVaSBwY/photo.jpg?sz=128", "display_name": "Jorge Omar Medra", "link": "https://stackoverflow.com/users/7607594/jorge-omar-medra"}, "edited": false, "score": 0, "creation_date": 1512609791, "post_id": 47666459, "comment_id": 82331906, "body": "@JorgeOmarMedra Edited it to include the client_handler for you now."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512642578, "post_id": 47666459, "comment_id": 82344875, "body": "there are LOTS of problems with the code, beyond the one you specifically ask about.  I.E. the returned value from <code>socket()</code> is not checked, calling <code>exit()</code> without cleaning up, after <code>pthread_detach()</code> the main thread cannot use <code>pthread_join()</code>  &#39;choice&#39; is 8 characters, but &#39;switch&#39; can only handle a single &#39;int&#39; value, not a string.  etc etc etc"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512642678, "post_id": 47666459, "comment_id": 82344942, "body": "regarding: <code>goto jump;</code>  This is a very bad idea, instead, just set &#39;choice&#39;, to 6.   NOTE: &#39;choice&#39; is an array, not a pointer to an array, so this: <code>switch (*choice) {</code> should be: <code>switch( choice )</code>  and &#39;choice&#39; should be a &#39;int&#39; or a single char."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512643164, "post_id": 47666459, "comment_id": 82345286, "body": "for ease of readability and understanding: 1) consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces. 2) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512643282, "post_id": 47666459, "comment_id": 82345359, "body": "there are MANY functions that should not be called in a signal handler.  The posted code is calling several of those functions inside the signal handler.  Suggest the signal handler just set a flag and the main loop of the program be checking that flag."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512643807, "post_id": 47666459, "comment_id": 82345706, "body": "the posted code can only handle a single client at a time.  (even though the call to <code>listen()</code> allows for up to 10 clients at a time)  Suggest using a &#39;thread pool&#39; as calls to <code>pthread_create()</code> and <code>pthread_exit()</code> are very expensive"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512644090, "post_id": 47666459, "comment_id": 82345917, "body": "Suggest the code to call <code>accept()</code> be, itself, a thread, then the main thread can be checking for some flag being set by the signal handler.  The main thread needs to be able to tell all the &#39;sub&#39; threads to exit.  Then it needs to call <code>pthread_join()</code> for every &#39;sub&#39; thread.  This is usually done be keeping an array of thread IDs and calling <code>pthread_join()</code> for each of those IDs, in a loop"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5963839, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1383569024991609/picture?type=large", "display_name": "Daryl VaDazzle McAllister", "link": "https://stackoverflow.com/users/5963839/daryl-vadazzle-mcallister"}, "edited": false, "score": 0, "creation_date": 1512578963, "post_id": 47666616, "comment_id": 82318005, "body": "I went and implemented the suggests and unfortunetly the 272 bytes are still being lost! I went ahead and gave the suggested tutorial a full implement and even that has the same 272 bytes lost on sigint exit"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 51, "user_id": 5963839, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1383569024991609/picture?type=large", "display_name": "Daryl VaDazzle McAllister", "link": "https://stackoverflow.com/users/5963839/daryl-vadazzle-mcallister"}, "edited": false, "score": 0, "creation_date": 1512644261, "post_id": 47666616, "comment_id": 82346026, "body": "@DarylVaDazzleMcAllister,  when running valgrind, always set it to ignore problems found in system/library functions"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512699989, "post_id": 47666616, "comment_id": 82373704, "body": "the linked tutorial has a few problem.  1) outputs most error messages to <code>stdout</code> rather than <code>stderr</code>  2) fails to pass the socket to <code>close()</code> in the client handler code, before passing the socket to <code>free()</code>.  3) has a comment about calling <code>pthread_join()</code>, but never actually calls that function.  4) the threads should call <code>pthread_exit()</code> as a better choice than <code>return</code> 5) fails to check the returned value from <code>listen()</code>  6) the loop extracting the IP address comments that it will use the first one but actually uses the last one"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512700689, "post_id": 47666616, "comment_id": 82373857, "body": "cont: 7) the &#39;connection_handler()` function should loop until a return from <code>read()</code> is 0, (meaning the client has disconnected) then exit the loop 8) this statement: <code>new_sock = malloc(1);</code> doesn&#39;t allocate enough room.  it should be: <code>new_sock = malloc( sizeof( int ) );</code>  and then check that the allocation was successful:  <code>if( !new_sock ) { perror( &quot;malloc failed&quot;; pthread_exit( NULL ); } 8) the call to </code>listen()` states that three connections can be active at once, so the <code>sniffer_thread</code> should be an array of 3, with related changes, so main thread can call <code>pthread_join()</code> (cont)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1512700955, "post_id": 47666616, "comment_id": 82373919, "body": "(cont) in a loop, so it does not exit until all threads have exited."}], "tags": [], "owner": {"reputation": 56, "user_id": 5333692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQFHM.jpg?s=128&g=1", "display_name": "JoshuaJames", "link": "https://stackoverflow.com/users/5333692/joshuajames"}, "is_accepted": false, "score": 1, "last_activity_date": 1512533245, "creation_date": 1512533245, "answer_id": 47666616, "question_id": 47666459, "link": "https://stackoverflow.com/questions/47666459/pthread-create-memory-leaks/47666616#47666616", "title": "pthread_create Memory Leaks", "body": "<p>You need to put a join before the end of your while loop, rather than in your signal catching function</p>\n\n<p>I would recommend looking through the last few sections of this guide, a few problems with your code that they handle are:</p>\n\n<ul>\n<li>joining the threads so that threads dont stay open because you are using\nthreading, </li>\n<li>your connfd can be overwritten (as it exists in same\nmemory space across different threads) </li>\n<li>adjusting your while loop to\nrun only while the connection is open (changing it to be on the\nreturn of accept) </li>\n</ul>\n\n<p><a href=\"http://www.binarytides.com/socket-programming-c-linux-tutorial/\" rel=\"nofollow noreferrer\">http://www.binarytides.com/socket-programming-c-linux-tutorial/</a></p>\n"}], "owner": {"reputation": 51, "user_id": 5963839, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1383569024991609/picture?type=large", "display_name": "Daryl VaDazzle McAllister", "link": "https://stackoverflow.com/users/5963839/daryl-vadazzle-mcallister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512609758, "creation_date": 1512531942, "last_edit_date": 1512609758, "question_id": 47666459, "link": "https://stackoverflow.com/questions/47666459/pthread-create-memory-leaks", "title": "pthread_create Memory Leaks", "body": "<p>I am trying to code a very basic multi-threaded TCP client server system and have managed to get the main functionality working as well as sorted any memory problems except for one. </p>\n\n<p>When its time for the server to shutdown, I have it set up to receive and handle a SIGINT signal which will close the listen and connfd as well as do some arbitrary output.</p>\n\n<p>The problem being that valgrind reports a memory leak on exit which it says is from pthread_create and threads being left active on exit. The leak is the size of 272 bytes for each connected user at the time. </p>\n\n<p><a href=\"https://i.stack.imgur.com/lIDvz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lIDvz.png\" alt=\"Valgrind output\"></a></p>\n\n<p>The code for the sig handler and main are as follows:</p>\n\n<pre><code>struct timeval t1, t2;\nint connfd = 0;\nint listenfd = 0;\npthread_t sniffer_thread;\n\nstatic void SIGhandler(int sig, siginfo_t *siginfo, void *context)\n{\n\n    pthread_join(sniffer_thread, NULL);\n\n    shutdown(connfd, SHUT_RDWR);\n    shutdown(listenfd, SHUT_RDWR);\n\ngettimeofday(&amp;t2, NULL);\n\n    double totalSeconds = (double) (t2.tv_usec - t1.tv_usec) / 1000000 + (double) (t2.tv_sec - t1.tv_sec) ;\n\n    int seconds = ((int)totalSeconds % 60);\n    int minutes = ((int)totalSeconds % 3600) / 60;\n    int hours = ((int)totalSeconds % 86400) / 3600;\n    int days = ((int)totalSeconds % (86400 * 30)) / 86400;\n\n    printf(\"\\n\\nServer shutdown request received\");\n    printf (\"\\nTotal server up time = %d days %d hours %d minutes and %d seconds\\n\\n\",days, hours ,minutes , seconds);\n\n    close(connfd);\n    close(listenfd);\n\n\nexit(EXIT_SUCCESS);\n}\n\n\nint main(void)\n{\n\n    gettimeofday(&amp;t1, NULL);\n\nstruct sigaction act;\n\nmemset(&amp;act, '\\0', sizeof(act));\n\n// this is a pointer to a function\nact.sa_sigaction = &amp;SIGhandler;\n\n// the SA_SIGINFO flag tells sigaction() to use the sa_sigaction field, not sa_handler\nact.sa_flags = SA_SIGINFO;\n\nif (sigaction(SIGINT, &amp;act, NULL) == -1) {\nperror(\"sigaction\");\nexit(EXIT_FAILURE);\n}\n\nstruct sockaddr_in serv_addr;\nstruct sockaddr_in client_addr;\nsocklen_t socksize = sizeof(struct sockaddr_in);\nlistenfd = socket(AF_INET, SOCK_STREAM, 0);\nmemset(&amp;serv_addr, '0', sizeof(serv_addr));\n\nserv_addr.sin_family = AF_INET;\nserv_addr.sin_addr.s_addr = htonl(INADDR_ANY);\nserv_addr.sin_port = htons(50001);\n\nbind(listenfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr));\n\nif (listen(listenfd, 10) == -1) {\nperror(\"Failed to listen\");\nexit(EXIT_FAILURE);\n}\n// end socket setup\n\n//Accept and incoming connection\nputs(\"Waiting for incoming connections...\");\nwhile (1) {\nprintf(\"Waiting for a client to connect...\\n\\n\");\nconnfd =\n    accept(listenfd, (struct sockaddr *) &amp;client_addr, &amp;socksize);\n\nprintf(\"\\n\\nConnection established with: %s\\n\", inet_ntoa(client_addr.sin_addr));\nprintf(\"%s is connected on socket:  %d\\n\",inet_ntoa(client_addr.sin_addr),connfd);\n\n\n    // third parameter is a pointer to the thread function, fourth is its actual parameter\nif (pthread_create\n    (&amp;sniffer_thread, NULL, client_handler,\n     (void *) &amp;connfd) &lt; 0) {\n    perror(\"could not create thread\");\n    exit(EXIT_FAILURE);\n}\n\n\nprintf(\"Handler assigned\\n\\n\");\n}\n\n// never reached...\nexit(EXIT_SUCCESS);\n} // end main()\n</code></pre>\n\n<p>The client handler code is:</p>\n\n<pre><code>// thread function - one instance of each for each connected client\nvoid *client_handler(void *socket_desc)\n{\n    pthread_detach(pthread_self());\n//Get the socket descriptor\nint connfd = *(int *) socket_desc;\n\nsend_conConfirm(connfd);\n\n\nchar choice[8];\n\ndo {\n            get_menu_choice(connfd,choice);\n            switch (*choice) {\n            case '1':\n                printf(\"Executing IP/ID return for socket: %d\\n\",connfd);\n            send_studentID(connfd);\n        break;\n            case '2':\n                printf(\"Executing server time return for socket: %d\\n\",connfd);\n            send_serverTime(connfd);\n        break;\n            case '3':\n                printf(\"Executing sys info return for socket: %d\\n\",connfd);\n            send_uname(connfd);\n        break;\n            case '4':\n                printf(\"Executing file list return for socket: %d\\n\",connfd);\n            send_filenames(connfd,choice);\n        break;\n            case '5':\n            send_filenames(connfd,choice);\n        break;\n            case '6':\n                printf(\"Disconection choice on socket: %d\\n\",connfd);\n        break;\n            default:\n            printf(\"Client on socket %d has been disconnected\\n\", connfd);\n                goto jump;\n        break;\n        }\n} while (*choice != '6' );\n\n\n\n    jump: //jump for goto statement\n\n\nshutdown(connfd, SHUT_RDWR);\nclose(connfd);\n\nprintf(\"Thread %lu exiting\\n\", (unsigned long) pthread_self());\n\nreturn 0;\n}  // end client_handler()\n</code></pre>\n\n<p>I have tried many different ways including detaching the threads upon completion but always end up with this memory leak. Occasional the memory leak will occur even if the client has only connected and the server ends and other times it will only occur if the client connects and interacts with the server.</p>\n"}, {"tags": ["c", "ubuntu", "memory-leaks", "valgrind"], "comments": [{"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 1, "creation_date": 1512641596, "post_id": 47666335, "comment_id": 82344179, "body": "Start by trying to fix the first error in the output. Later messages may be related to the same errors."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "is_accepted": false, "score": 1, "last_activity_date": 1512552360, "creation_date": 1512552360, "answer_id": 47670783, "question_id": 47666335, "link": "https://stackoverflow.com/questions/47666335/trying-to-read-leak-summary-from-valgrind-program-causes-a-segmentation-fault/47670783#47670783", "title": "Trying to read leak summary from valgrind - Program causes a segmentation fault on my PC, not on another", "body": "<p>Segmentation fault has nothing to do with memory leaks. To fix segmentation fault you should read and fix <em>errors</em> reported by Valgrind, not <em>memory leaks</em>. According to output there are 8 errors found by Valgrind:</p>\n\n<pre><code>==21294== ERROR SUMMARY: 8 errors from 3 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>See the difference between Valgrind errors and memory leaks here:<br>\n<a href=\"https://stackoverflow.com/q/17398796/72178\">Error summary in Valgrind output?</a></p>\n"}], "owner": {"reputation": 19, "user_id": 9059022, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x6mXn-ykxkM/AAAAAAAAAAI/AAAAAAAAAUg/mV48BEX1RAM/photo.jpg?sz=128", "display_name": "The_Fiz", "link": "https://stackoverflow.com/users/9059022/the-fiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512552360, "creation_date": 1512530896, "last_edit_date": 1512551476, "question_id": 47666335, "link": "https://stackoverflow.com/questions/47666335/trying-to-read-leak-summary-from-valgrind-program-causes-a-segmentation-fault", "title": "Trying to read leak summary from valgrind - Program causes a segmentation fault on my PC, not on another", "body": "<p>I have a C code OpenGL program that compiles and runs fine on my ubuntu machine. But when I compile and run it on another linux it causes a segmentation fault. I've used valgrind to see where the problem could be and here is a small portion of the output:</p>\n\n<pre><code>==21294== LEAK SUMMARY:\n==21294==    definitely lost: 72 bytes in 1 blocks\n==21294==    indirectly lost: 0 bytes in 0 blocks\n==21294==      possibly lost: 0 bytes in 0 blocks\n==21294==    still reachable: 191,932 bytes in 1,397 blocks\n==21294==         suppressed: 0 bytes in 0 blocks\n==21294== \n==21294== ERROR SUMMARY: 8 errors from 3 contexts (suppressed: 0 from 0)\n==21294== \n==21294== 1 errors in context 1 of 3:\n==21294== Syscall param ioctl(generic) points to uninitialised byte(s)\n==21294==    at 0x5936F07: ioctl (syscall-template.S:84)\n==21294==    by 0x7C0E0E7: drmIoctl (in /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0)\n==21294==    by 0x7C10DDE: drmCommandWriteRead (in /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0)\n==21294==    by 0xABF2DA0: nouveau_object_mthd (in /usr/lib/x86_64-linux-gnu/libdrm_nouveau.so.2.0.0)\n==21294==    by 0xABF3535: nouveau_device_new (in /usr/lib/x86_64-linux-gnu/libdrm_nouveau.so.2.0.0)\n==21294==    by 0xA0B9690: nouveau_drm_screen_create (in /usr/lib/x86_64-linux-gnu/dri/nouveau_dri.so)\n==21294==    by 0x9C7FD15: ??? (in /usr/lib/x86_64-linux-gnu/dri/nouveau_dri.so)\n==21294==    by 0x9F6C59B: ??? (in /usr/lib/x86_64-linux-gnu/dri/nouveau_dri.so)\n==21294==    by 0x9F67BD2: ??? (in /usr/lib/x86_64-linux-gnu/dri/nouveau_dri.so)\n==21294==    by 0x4E80AA2: ??? (in /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2.0)\n==21294==    by 0x4E589C3: ??? (in /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2.0)\n==21294==    by 0x4E53F00: glXQueryVersion (in /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2.0)\n</code></pre>\n\n<p>The full output file from valgrind is 15614 lines long.\nI'm still learning it but I could use assistance on reading what I'm looking at and how I can correct my code. Also this is my first post on this site, so any info for this question and posting in general would be appreciated.</p>\n"}, {"tags": ["c", "free", "calloc"], "comments": [{"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 4, "creation_date": 1512530761, "post_id": 47666283, "comment_id": 82291733, "body": "Show the memory allocation statements."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1512530890, "post_id": 47666283, "comment_id": 82291762, "body": "Rule is simple - if you allocate it (1) preserve a pointer to the beginning of the block of memory; so (2) it can be freed when it is no longer needed. No caveats."}, {"owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1512530923, "post_id": 47666283, "comment_id": 82291771, "body": "<code>array = calloc(size, sizeof(int) * 3);</code>"}, {"owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1512530959, "post_id": 47666283, "comment_id": 82291779, "body": "Where <code>size</code> is an arbitrary amount."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512531431, "post_id": 47666283, "comment_id": 82291915, "body": "Yes, you very much do need to <code>free(array)</code>, if <code>array</code> was allocated using <code>malloc</code> or similar."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 1, "creation_date": 1512531572, "post_id": 47666283, "comment_id": 82291948, "body": "Looks fine, but be careful of dangling pointers. If you delete an element from the array, the pointer in the Array must be set to NULL or you might end up freeing the same block of memory more than once..."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512532139, "post_id": 47666283, "comment_id": 82292084, "body": "Or you could <a href=\"http://www.hboehm.info/gc/\" rel=\"nofollow noreferrer\">use a garbage collector</a>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1512532158, "post_id": 47666283, "comment_id": 82292090, "body": "You do not need to test a pointer before passing it to <code>free</code>. <code>free</code> is specified to do nothing when passed a null pointer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1512547135, "post_id": 47666283, "comment_id": 82297561, "body": "Each call to malloc needs to be matched with a call to free, simple as that."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1512552360, "post_id": 47666283, "comment_id": 82300359, "body": "<code>array = calloc(size, sizeof(int) * 3);</code> What are these parameters supposed to mean? How do you want to use <code>array</code>? If you call <code>free(array[i])</code> shouldn&#39;t there be some pointer type involved?"}], "answers": [{"tags": [], "owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "is_accepted": false, "score": 1, "last_activity_date": 1512530959, "creation_date": 1512530959, "answer_id": 47666342, "question_id": 47666283, "link": "https://stackoverflow.com/questions/47666283/how-should-i-free-an-array-in-c/47666342#47666342", "title": "How should I free an array in C?", "body": "<p>You must write <code>free(array)</code> at the end, otherwise there will be memory leak.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1512531117, "post_id": 47666351, "comment_id": 82291831, "body": "Does that go for <code>calloc()</code> as well?"}, {"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "reply_to_user": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 1, "creation_date": 1512531219, "post_id": 47666351, "comment_id": 82291853, "body": "@ssharma: yes it foes for calloc() as well"}, {"owner": {"reputation": 56, "user_id": 5333692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQFHM.jpg?s=128&g=1", "display_name": "JoshuaJames", "link": "https://stackoverflow.com/users/5333692/joshuajames"}, "edited": false, "score": 0, "creation_date": 1512531246, "post_id": 47666351, "comment_id": 82291862, "body": "yes, calloc allocates memory the same as malloc. calloc then initialises the memory to zero, whereas malloc does not. For every malloc OR calloc, you must have a free"}, {"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 0, "creation_date": 1512531317, "post_id": 47666351, "comment_id": 82291889, "body": "@JoshuaJames: <code>calloc()</code> initialises memory to zero while <code>malloc()</code> doesn&#39;t initialise."}, {"owner": {"reputation": 56, "user_id": 5333692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQFHM.jpg?s=128&g=1", "display_name": "JoshuaJames", "link": "https://stackoverflow.com/users/5333692/joshuajames"}, "edited": false, "score": 0, "creation_date": 1512531347, "post_id": 47666351, "comment_id": 82291895, "body": "yes, if the original double pointer was malloc&#39;d. because we cant see your allocation code we cant say. Please mark answer as correct and useful"}, {"owner": {"reputation": 56, "user_id": 5333692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQFHM.jpg?s=128&g=1", "display_name": "JoshuaJames", "link": "https://stackoverflow.com/users/5333692/joshuajames"}, "reply_to_user": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 0, "creation_date": 1512531398, "post_id": 47666351, "comment_id": 82291907, "body": "@Destructor thats what i said: &quot;calloc initialises the memory&quot; edited for clarification"}, {"owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1512531595, "post_id": 47666351, "comment_id": 82291951, "body": "The original double pointer looked like this: <code>int **array = calloc(size, sizeof(int));</code>"}, {"owner": {"reputation": 56, "user_id": 5333692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQFHM.jpg?s=128&g=1", "display_name": "JoshuaJames", "link": "https://stackoverflow.com/users/5333692/joshuajames"}, "edited": false, "score": 0, "creation_date": 1512531653, "post_id": 47666351, "comment_id": 82291957, "body": "so you did allocate the memory, so you must free it. which means your code is correct. Please mark answer as correct"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1512532245, "post_id": 47666351, "comment_id": 82292112, "body": "Note that the <code>(int **)malloc...</code> cast is not only unnecessary but not recommended"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "edited": false, "score": 0, "creation_date": 1512555656, "post_id": 47666351, "comment_id": 82302619, "body": "@ssharma as comment to the question you provided totally different allocation code. Please add it to the question and show the <b>real</b> code, not some random stuff."}], "tags": [], "owner": {"reputation": 56, "user_id": 5333692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQFHM.jpg?s=128&g=1", "display_name": "JoshuaJames", "link": "https://stackoverflow.com/users/5333692/joshuajames"}, "is_accepted": true, "score": 3, "last_activity_date": 1512533668, "last_edit_date": 1512533668, "creation_date": 1512531041, "answer_id": 47666351, "question_id": 47666283, "link": "https://stackoverflow.com/questions/47666283/how-should-i-free-an-array-in-c/47666351#47666351", "title": "How should I free an array in C?", "body": "<p>If you malloc the pointer as well as each element of the array you will need to free that pointer after your for loop.</p>\n\n<p>For example:</p>\n\n<pre><code>int **array;\narray = malloc(SIZE*sizeof(int*));\nfor(int ii = 0; ii &lt; SIZE; ii++)\n{\n     array[ii] = (int*)malloc(sizeof(int));\n}\n</code></pre>\n\n<p>you will have to free each element and free array.\nEssentially for every malloc/calloc you have, you must have a free</p>\n"}], "owner": {"reputation": 53, "user_id": 8400194, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TkQLw.png?s=128&g=1", "display_name": "ssharma", "link": "https://stackoverflow.com/users/8400194/ssharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2859, "favorite_count": 0, "accepted_answer_id": 47666351, "answer_count": 2, "score": 0, "last_activity_date": 1512533668, "creation_date": 1512530499, "question_id": 47666283, "link": "https://stackoverflow.com/questions/47666283/how-should-i-free-an-array-in-c", "title": "How should I free an array in C?", "body": "<p>I created a function to free an array in C, but I don't know\nwhether it is correct or not:</p>\n\n<pre><code>void dealloc_array(void *array[], int size) {\n\n         int i = 0;\n\n         for (i = 0; i &lt; size; i++) {\n\n                if (array[i]) free(array[i]);\n         }\n\n         if (array) free(array);\n\n\n}\n</code></pre>\n\n<p>I'm not sure whether I should execute <code>free(array)</code> at the end. Technically, we've already freed all the array elements, so we don't need to do <code>free(array)</code>.</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["c", "process", "signals", "fork"], "comments": [{"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 1, "creation_date": 1512549946, "post_id": 47666105, "comment_id": 82298957, "body": "which path exactly gets called? The &quot;%s wins by default&quot; or &quot;%s is the winner&quot;?"}, {"owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1512585543, "post_id": 47666105, "comment_id": 82321620, "body": "The %s is the winner"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 2, "creation_date": 1512765364, "post_id": 47666105, "comment_id": 82404107, "body": "Do those <code>execv</code> calls actually succeed? It looks like the 2nd arg is incorrect - it&#39;s the address of the first character of a character string but should be the address of the first of a sequence of pointers."}], "owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512529253, "creation_date": 1512529253, "question_id": 47666105, "link": "https://stackoverflow.com/questions/47666105/forks-and-processes-in-c", "title": "Forks and Processes in C", "body": "<p>I am supposed to write a program that runs two scripts in two separate processes and returns which one finished first. Unfortunately, my program returns the slower process, which confuses me. I made sure that the pids were not 0, so that they weren't child processes. I then compared the pids of each process to the pid of the process that finished first, but for some reason, the slower program gets printed.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(int argc, char **argv) {\n\n  if (argc != 3) {\n    printf(\"Invalid number of arguments!\");\n    exit(1);\n  }\n  pid_t one;\n  pid_t two;\n  int status = 0;\n  pid_t winner;\n\n  char const *args[] = {\"/bin/sh\", argv[1], argv[2], NULL};\n\n  if ((one = fork()) == 0) {\n    printf(\"%s is starting.\\n\",argv[1]);\n    execv(args[0], args[1]);\n  }\n  if ((two = fork()) == 0 &amp;&amp; (one != 0)) {\n    printf(\"%s is starting\\n\",argv[2]);\n    execv(args[0], args[2]);\n  }\n  if (one != 0 &amp;&amp; two != 0) {\n    winner = wait(&amp;status);\n    if (winner == -1) {\n      if (one == winner) {\n    kill(one, SIGKILL);\n    printf(\"%s wins by default!\\n\", argv[2]);\n      }\n      else if (two == winner) {\n    kill(two, SIGKILL);\n    printf(\"%s wins by default!\\n\", argv[1]);\n      }\n    }\n    else {\n      if (one == winner) {\n    kill(two, SIGKILL);\n    printf(\"%s is finished!\\n\", argv[1]);\n    printf(\"%s is the winner\\n\", argv[1]);\n      }\n      if (two == winner) {\n    kill(one, SIGKILL);\n    printf(\"%s is finished!\\n\", argv[2]);\n    printf(\"%s is the winner\\n\", argv[2]);\n      }\n    }\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "mysql", "c", "macos"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1512527661, "post_id": 47665882, "comment_id": 82290967, "body": "Are you linking with the library? The header files tell the compiler about those functions, but the linker also needs to find the actual implementation of them. You are getting an error from the linker here (ld)."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1512539694, "post_id": 47665882, "comment_id": 82294242, "body": "Are you using precompiled headers?"}, {"owner": {"reputation": 60, "user_id": 9059365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BFJJ.jpg?s=128&g=1", "display_name": "Bill Baits", "link": "https://stackoverflow.com/users/9059365/bill-baits"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1512875222, "post_id": 47665882, "comment_id": 82431452, "body": "@Yunnosch Yes I am using precompiled headers"}, {"owner": {"reputation": 60, "user_id": 9059365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BFJJ.jpg?s=128&g=1", "display_name": "Bill Baits", "link": "https://stackoverflow.com/users/9059365/bill-baits"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1512875262, "post_id": 47665882, "comment_id": 82431460, "body": "@Cris Luengo I&#39;m sure from where I can link the library to the headers. Can you please elaborate?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1512878610, "post_id": 47665882, "comment_id": 82431933, "body": "On the command line you add <code>-l&lt;library_name&gt;</code>. In Xcode I&#39;m sure there is a place where you specify what libraries to link to. See the documentation to figure out where that is. And see the documentation for MySQL to figure out what library you need to link to. I haven&#39;t used MySQL so don&#39;t know. But the error I do recognize: &quot;ld: symbol(s) not found&quot; means that you&#39;re not linking against a needed library."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1512886883, "post_id": 47665882, "comment_id": 82433259, "body": "If you are using precompiled headers, you should have included &quot;stdafx.h&quot;. Please show where you do that. (I assume you left out that line to make your code example more minimal.) Inlcuding it should be the very first."}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 9059365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BFJJ.jpg?s=128&g=1", "display_name": "Bill Baits", "link": "https://stackoverflow.com/users/9059365/bill-baits"}, "edited": false, "score": 0, "creation_date": 1512966643, "post_id": 47735795, "comment_id": 82452957, "body": "This fixed my problem. +1 for concise and simple answer"}, {"owner": {"reputation": 60, "user_id": 9059365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BFJJ.jpg?s=128&g=1", "display_name": "Bill Baits", "link": "https://stackoverflow.com/users/9059365/bill-baits"}, "edited": false, "score": 1, "creation_date": 1512967303, "post_id": 47735795, "comment_id": 82453096, "body": "Since, in my case, the flags were already included with the sql header, gcc -o program progame.c  <code>mysql_config --libs</code> did the job for me. Just an alternative"}], "tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": true, "score": 1, "last_activity_date": 1512879230, "creation_date": 1512879230, "answer_id": 47735795, "question_id": 47665882, "link": "https://stackoverflow.com/questions/47665882/sql-functions-not-found-after-include/47735795#47735795", "title": "sql functions not found after include", "body": "<p>The MySQL documentation, and specifically <a href=\"https://dev.mysql.com/doc/refman/5.6/en/c-api-building-clients.html\" rel=\"nofollow noreferrer\">this page</a>, explains how to link your program with the MySQL. This is copy-pasted from the link above:</p>\n\n<hr>\n\n<p>mysql_config displays the options needed for compiling or linking:</p>\n\n<pre><code>shell&gt; mysql_config --cflags\nshell&gt; mysql_config --libs\n</code></pre>\n\n<p>You can run those commands to get the proper options and add them manually to compilation or link commands. Alternatively, include the output from mysql_config directly within command lines using backticks:</p>\n\n<pre><code>shell&gt; gcc -c `mysql_config --cflags` progname.c\nshell&gt; gcc -o progname progname.o `mysql_config --libs`\n</code></pre>\n\n<hr>\n\n<p>If you use C++ (you have both C and C++ as tags in your question) you'll want to replace <code>gcc</code> with <code>g++</code> of course, but also replace <code>--cflags</code> with <code>--cxxflags</code>.</p>\n"}], "owner": {"reputation": 60, "user_id": 9059365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9BFJJ.jpg?s=128&g=1", "display_name": "Bill Baits", "link": "https://stackoverflow.com/users/9059365/bill-baits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 47735795, "answer_count": 1, "score": 0, "last_activity_date": 1512879230, "creation_date": 1512527314, "question_id": 47665882, "link": "https://stackoverflow.com/questions/47665882/sql-functions-not-found-after-include", "title": "sql functions not found after include", "body": "<p>I've been working on a basic server/client program in c on a MacOSX, and when having tried to link the server to a mysql database, I'm having serious issues. I checked the sql header file and it had all the function declarations that the compiler cannot find. I downloaded a connector, specifically for the x86_64 architecture, and using it gave the same error. </p>\n\n<p>Consider the following code:</p>\n\n<pre><code>#include &lt;mysql/mysql.h&gt;\n#include &lt;mysql/my_global.h&gt;\n\nint main(int argc, char const *argv[]) {\n\n   //Create the connector object\n   MYSQL *con = mysql_init(NULL);\n   if (con == NULL) {\n     fprintf(stderr, \"%s\\n\", mysql_error(con));\n     exit(1);\n   }\n\n   //Connect to database\n   if (mysql_real_connect(con, \"localhost\", \"username\",\"password\", NULL, 0, NULL, 0) == NULL) {\n     fprintf(stderr, \"%s\\n\", mysql_error(con));\n     mysql_close(con);\n     exit(1);\n   }\n}  \n</code></pre>\n\n<p>I get the following error upon compiling it:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n   \"_finish_with_error\", referenced from:\n   _main in ServerSocket-dbb1df.o\n   \"_mysql_close\", referenced from:\n   _main in ServerSocket-dbb1df.o\n   \"_mysql_error\", referenced from:\n   _main in ServerSocket-dbb1df.o\n   \"_mysql_init\", referenced from:\n   _main in ServerSocket-dbb1df.o\n   \"_mysql_query\", referenced from:\n   _main in ServerSocket-dbb1df.o\n   \"_mysql_real_connect\", referenced from:\n   _main in ServerSocket-dbb1df.o\n   \"_mysql_store_result\", referenced from:\n   _main in ServerSocket-dbb1df.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Any help as to what's going wrong here would be appreciated!</p>\n"}, {"tags": ["c", "error-handling", "getopt"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1512528259, "post_id": 47665881, "comment_id": 82291121, "body": "The extra argument has to be detected after the loop; it will appear as an &#39;unconsumed&#39; argument and <code>optind &lt; argc</code> will hold when the loop exits.  The repeated argument will need something like <code>int sflag = 0;</code> before the loop and <code>if (sflag++ &gt; 0) { \u2026chastise user and exit\u2026 }</code> in the <code>case &#39;s&#39;:</code> code."}], "answers": [{"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1525167707, "last_edit_date": 1525167707, "creation_date": 1525166111, "answer_id": 50113988, "question_id": 47665881, "link": "https://stackoverflow.com/questions/47665881/getopt-error-checking/50113988#50113988", "title": "Getopt() Error Checking", "body": "<p>For each option, you may maintain a flag to see if the option has already been encountered or not. Duplicate options are detected with the help of these flags.</p>\n\n<pre><code>int c, sflag=0, fflag=0;\nwhile( (c=getopt(argc, argv, \"s:f:\"))!=-1 )\n{\n    switch(c)\n    {\n    case 's':\n        if(sflag!=0)\n        {\n            //fprintf(stderr, \"\\n dup s option\");\n            return 1; //duplicate s option\n        }   \n        sflag++;\n        //printf(\"\\ns flag: %s\", optarg);\n        break;\n    case 'f':\n        if(fflag!=0)\n        {\n            //fprintf(stderr, \"\\n dup f option\");\n            return 1; //duplicate f option\n        }   \n        fflag++;\n        //printf(\"\\nf flag: %s\", optarg);\n        break;\n    case '?':\n        if(isprint(optopt))\n        {\n            fprintf(stderr, \"Unknown option %c\", optopt);\n        }\n        else\n        {\n            fprintf(stderr, \"\\nUnknown option character x%x\", optopt);\n        }\n        return 1;\n    }\n}   \n</code></pre>\n\n<p><code>optind</code> will have the index of the next <code>argv[]</code> which is still to be examined. After all the options have been taken care of, in your program there should be exactly one non-option argument.</p>\n\n<p>So, <code>optind</code> must be equal to <code>argc-1</code> for a correct usage of the command.</p>\n\n<pre><code>if(optind != argc-1) //exactly one non-option argument is expected\n{\n    fprintf(stderr, \"\\nInvalid number of arguments.\");\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 2918160, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c91c441384a9fede4212a0fbdf797fa5?s=128&d=identicon&r=PG&f=1", "display_name": "user2918160", "link": "https://stackoverflow.com/users/2918160/user2918160"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1140, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1525167707, "creation_date": 1512527291, "last_edit_date": 1525166259, "question_id": 47665881, "link": "https://stackoverflow.com/questions/47665881/getopt-error-checking", "title": "Getopt() Error Checking", "body": "<p>\nI am trying to make it so that getopt can handle certain flags, but I am having trouble implementing the error handling using getopt. I want to prevent duplicate flags such as '-s 1 -s 1', and having too many arguments for a flag '-s 1 2' both of these should exit the program. \n</p>\n\n<pre><code> int opt; //command flags\n while((opt = getopt(argc, argv, \"s:f:\")) != -1){\n switch(opt){\n  case 's':\n    printf(\"%s\\n\", optarg);\n    printf(\"%i\\n\", optind);\n    break;\n  case 'f':\n    printf(\"%s\\n\", optarg);\n    printf(\"%i\\n\", optind);\n    break;\n  default:\n    //unknown command flags\n    fprintf(stderr, \"Usage:  fred [ -s symbol-table-file ] [ -f fred-program-file ]\\n\");\n    return EXIT_FAILURE;\n  }\n}\n</code></pre>\n\n<p>\nToo many arguments (e.g., program -s f1 -f f2 hello). Duplicate flags (e.g., program -s f1 -s f2). Both should exit the program\n</p>\n"}, {"tags": ["c", "input", "enums"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1512527867, "post_id": 47665863, "comment_id": 82291023, "body": "see <a href=\"https://stackoverflow.com/q/8642970/2410359\">Map string to ENUM</a>"}, {"owner": {"reputation": 783, "user_id": 8890692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d73b1bb439acfca597990e5eea101a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Kerian", "link": "https://stackoverflow.com/users/8890692/matthew-kerian"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1512527990, "post_id": 47665863, "comment_id": 82291061, "body": "@chux Thanks a lot!"}], "owner": {"reputation": 783, "user_id": 8890692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d73b1bb439acfca597990e5eea101a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Kerian", "link": "https://stackoverflow.com/users/8890692/matthew-kerian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 0, "closed_date": 1567192422, "answer_count": 0, "score": 0, "last_activity_date": 1512527156, "creation_date": 1512527156, "question_id": 47665863, "link": "https://stackoverflow.com/questions/47665863/how-to-take-an-input-through-scanf-for-an-enum", "closed_reason": "Duplicate", "title": "How to take an input through Scanf for an enum", "body": "<p>I'm trying to assign an enum so that the user enters in a small string (e.g. B6) and I want to assign a number value to that.</p>\n\n<p>My code:</p>\n\n<pre><code>typedef enum{\n    A8 = 11, B8, C8, D8...\n    A7 = 21, B7, C7, D7...\n    ...\n} rankFile;\n</code></pre>\n\n<p>Then I'm trying to scan for user input like</p>\n\n<pre><code>rankFile userInput;\nscanf(\"%u\", &amp;userInput);\nprintf(\"%d\", userInput);\n</code></pre>\n\n<p>I'm getting garbage values, e.g. 2 billion or sometimes a negative number. Does anyone know what I can do to fix this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 2, "creation_date": 1512527003, "post_id": 47665804, "comment_id": 82290804, "body": "a. <code>fptr= malloc(cnt*sizeof(float));</code> and <code>fread(fptr, sizeof(float), cnt, ifile);</code> ... the value of <code>cnt</code> is ? b. No check that the file opened successfully."}, {"owner": {"reputation": 13, "user_id": 8793087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3c9a724ddaf435312e280c2add9e11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Medina", "link": "https://stackoverflow.com/users/8793087/miguel-medina"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1512527345, "post_id": 47665804, "comment_id": 82290885, "body": "Im trying to dynamically create an array of floats using the first number of the file with the malloc function. I am not sure if i did it correctly."}, {"owner": {"reputation": 54765, "user_id": 309412, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9739ec5574d9977b522d1c80fb8de84?s=128&d=identicon&r=PG", "display_name": "Lie Ryan", "link": "https://stackoverflow.com/users/309412/lie-ryan"}, "edited": false, "score": 2, "creation_date": 1512527384, "post_id": 47665804, "comment_id": 82290898, "body": "<code>cnt</code> is never assigned anywhere but is used in malloc() and fread(), thus running the program in your question leads to undefined behavior."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1512527793, "post_id": 47665804, "comment_id": 82291000, "body": "how do you know the content of the file? did you print it? You are reading it as binary, is it really binary or an ascii file?"}, {"owner": {"reputation": 13, "user_id": 8793087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3c9a724ddaf435312e280c2add9e11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Medina", "link": "https://stackoverflow.com/users/8793087/miguel-medina"}, "edited": false, "score": 0, "creation_date": 1512528010, "post_id": 47665804, "comment_id": 82291065, "body": "This is for an assignment, the values where given to us but i can&#39;t really see the file. I am now adding another fread statement for  &quot;cnt&quot; to see if this fixes the problem."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512528506, "post_id": 47665804, "comment_id": 82291186, "body": "Note that your code only prints a single value, effectively <code>fptr[0]</code>, and it&#39;s possible that value could be zero.  You should be printing <code>cnt</code> different values, once you&#39;ve read a value into <code>cnt</code>."}, {"owner": {"reputation": 13, "user_id": 8793087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3c9a724ddaf435312e280c2add9e11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Medina", "link": "https://stackoverflow.com/users/8793087/miguel-medina"}, "edited": false, "score": 0, "creation_date": 1512528831, "post_id": 47665804, "comment_id": 82291276, "body": "Alright thank you. Im trying to print the floats and use the int of the file as a way to know how many floats there are. Then create an array of type float with the size being equal to the integer. Not really the int but the value 4. so an array of 4 floats."}, {"owner": {"reputation": 13, "user_id": 8793087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3c9a724ddaf435312e280c2add9e11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Medina", "link": "https://stackoverflow.com/users/8793087/miguel-medina"}, "edited": false, "score": 0, "creation_date": 1512529881, "post_id": 47665804, "comment_id": 82291507, "body": "Thank you. cnt was the problem."}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1512528802, "creation_date": 1512528802, "answer_id": 47666057, "question_id": 47665804, "link": "https://stackoverflow.com/questions/47665804/program-in-c-that-reads-binary-file-and-outputs-only-zeros-in-float-notation-ins/47666057#47666057", "title": "Program in C that reads binary file and outputs only zeros in float notation instead of file contents", "body": "<p>You don't set <code>cnt</code> anywhere so you read an unspecified number of floats which may or may not be correct.  If I hard code it to <code>4</code> and use a binary data file with 4 floats in it, it works fine:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\nint main (int argc, char *argv[]){\n    FILE *ifile;\n    int cnt = 4, i;\n    float *fptr;\n    fptr= malloc(cnt*sizeof(float));\n    ifile=fopen(argv[1], \"rb\");\n    fread(fptr, sizeof(float), cnt, ifile);\n    printf(\"%f\\n\", *fptr);\n    printf(\"%f\\n\", fptr[1]);\n    printf(\"%f\\n\", fptr[2]);\n    printf(\"%f\\n\", fptr[3]);\n}\n</code></pre>\n\n<p>running the program:</p>\n\n<pre><code>$ ./test-prog data\n1.100000\n2.200000\n3.300000\n4.400000\n$ hd data\n00000000  cd cc 8c 3f cd cc 0c 40  33 33 53 40 cd cc 8c 40  |...?...@33S@...@|\n00000010\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8793087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3c9a724ddaf435312e280c2add9e11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Medina", "link": "https://stackoverflow.com/users/8793087/miguel-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512530711, "creation_date": 1512526731, "last_edit_date": 1512530711, "question_id": 47665804, "link": "https://stackoverflow.com/questions/47665804/program-in-c-that-reads-binary-file-and-outputs-only-zeros-in-float-notation-ins", "title": "Program in C that reads binary file and outputs only zeros in float notation instead of file contents", "body": "<p>I am not that comfortable with the C language or really writing code. I am trying to read a file in binary and output it to the screen. I am using fread and fopen since these work well with binary. I have this code that compiles but when i run my code as ./a.out data1 i only get 0.0000. The file contents are 4, 1.1, 2.2, 3.3, 4.4. This is what is supposed to be outputted. 1.1000 2.2000 3.3000 4.40000 only the floats. I supspect the problem is that im not passing the values in the file to the array correctly. I would appreciate any help or comments. My code is below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\nint main (int argc, char *argv[])\n{\n    FILE *ifile;\n    int cnt, i;\n    float *fptr;\n    fptr = malloc (cnt * sizeof (float));\n    ifile = fopen (argv[1], \"rb\");\n    fread (fptr, sizeof (float), cnt, ifile);\n    printf (\"%f\\n\", *fptr);\n}\n\n// new code that works\n#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\nint main (int argc, char *argv[])\n{\n    FILE *ifile;\n    int cnt, i;\n    float *fptr;\n    ifile = fopen (argv[1], \"rb\");\n    if (fread (&amp;cnt, sizeof (int), 1, ifile) != 1) {\n        printf (\"%d\\n\", cnt);\n    }\n    fptr = malloc (cnt * sizeof (float));\n    fread (fptr, sizeof (float), cnt, ifile);\n    for (i = 0; i &lt; cnt; i++) {\n        printf (\"%f\\n\", *fptr[i]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "arrays"], "comments": [{"owner": {"reputation": 3804, "user_id": 5014099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Ju1iz.jpg?s=128&g=1", "display_name": "Souvik Ghosh", "link": "https://stackoverflow.com/users/5014099/souvik-ghosh"}, "edited": false, "score": 0, "creation_date": 1512526536, "post_id": 47665769, "comment_id": 82290696, "body": "This is a multi dimension array in C. Read about them here- <a href=\"http://www.geeksforgeeks.org/multidimensional-arrays-c-cpp/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/multidimensional-arrays-c-cpp</a> and <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/arrays/multidimensional-arrays\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/csharp/programming-guide/arr&zwnj;&#8203;ays/&hellip;</a>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512526680, "post_id": 47665769, "comment_id": 82290735, "body": "<code>char</code> is an integer type, but plain <code>char</code> may be <code>signed</code> or <code>unsigned</code> and may not be able to hold a value of <code>-1</code>."}, {"owner": {"reputation": 363, "user_id": 5884011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a18cd70b148266417876e7da2f4ea805?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5884011/anna"}, "reply_to_user": {"reputation": 3804, "user_id": 5014099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Ju1iz.jpg?s=128&g=1", "display_name": "Souvik Ghosh", "link": "https://stackoverflow.com/users/5014099/souvik-ghosh"}, "edited": false, "score": 0, "creation_date": 1512526744, "post_id": 47665769, "comment_id": 82290747, "body": "@SouvikGhosh I know it&#39;s a multidimensional array... I guess my problem is it&#39;s declared as a char array in C, but what&#39;s inside the array are intergers, C seems to handle it alright, but C# doesn&#39;t convert int to char directly..."}, {"owner": {"reputation": 363, "user_id": 5884011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a18cd70b148266417876e7da2f4ea805?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5884011/anna"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512526822, "post_id": 47665769, "comment_id": 82290770, "body": "@DavidBowling so does that mean char array cannot hold values like {-1,-1,-1,0}? What does {-1,-1,-1,0} as a char type?"}, {"owner": {"reputation": 25339, "user_id": 3181933, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/eQpds.jpg?s=128&g=1", "display_name": "Llama", "link": "https://stackoverflow.com/users/3181933/llama"}, "edited": false, "score": 0, "creation_date": 1512526827, "post_id": 47665769, "comment_id": 82290771, "body": "Do you need it as char or as integers? If you need it as integers just declare it as a multi-dimensional int array."}, {"owner": {"reputation": 363, "user_id": 5884011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a18cd70b148266417876e7da2f4ea805?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5884011/anna"}, "reply_to_user": {"reputation": 25339, "user_id": 3181933, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/eQpds.jpg?s=128&g=1", "display_name": "Llama", "link": "https://stackoverflow.com/users/3181933/llama"}, "edited": false, "score": 0, "creation_date": 1512526941, "post_id": 47665769, "comment_id": 82290792, "body": "@john I honestly don&#39;t kown. I don&#39;t know if chaning it to an int array in C# is the same as the char array in C"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512526990, "post_id": 47665769, "comment_id": 82290801, "body": "Again, <code>char</code> <i>is an integer type</i>; it is meant to hold integer values (not necessarily the full range of <code>int</code>). <code>char</code> may be <code>signed</code> or may be <code>unsigned</code>; this is implementation dependent. <code>char</code> can always hold a value of <code>0</code> or <code>1</code>, but may not be able to hold <code>-1</code>. The posted code is not portable. I don&#39;t know what this means for C#, though."}, {"owner": {"reputation": 363, "user_id": 5884011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a18cd70b148266417876e7da2f4ea805?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5884011/anna"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512527125, "post_id": 47665769, "comment_id": 82290828, "body": "@DavidBowling sorry I am still confused...if char cannot hold -1, but the code I posted works just fine with -1s?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512527279, "post_id": 47665769, "comment_id": 82290859, "body": "I did not say &quot;cannot&quot;, I said &quot;may not be able to.&quot; Whether <code>char</code> can hold negative values depends on the implementation, hence, not portable. It may work on your system, and fail on others. This was really just a comment about the posted code, but does not address your problem of converting to C#."}, {"owner": {"reputation": 363, "user_id": 5884011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a18cd70b148266417876e7da2f4ea805?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5884011/anna"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512527321, "post_id": 47665769, "comment_id": 82290874, "body": "@DavidBowling okay, thank you! that make sense..."}, {"owner": {"reputation": 1142, "user_id": 5961242, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-vSKsOpeZ4no/AAAAAAAAAAI/AAAAAAAAAE4/x4855SE9j2o/photo.jpg?sz=128", "display_name": "Dylan Nicholson", "link": "https://stackoverflow.com/users/5961242/dylan-nicholson"}, "edited": false, "score": 0, "creation_date": 1512527347, "post_id": 47665769, "comment_id": 82290886, "body": "For C# I&#39;d suggest just using an <code>int</code>, given the small size of the array."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512527739, "post_id": 47665769, "comment_id": 82290988, "body": "<a href=\"https://www.tutorialspoint.com/csharp/csharp_data_types.htm\" rel=\"nofollow noreferrer\">According to this</a> the C# <code>sbyte</code> type is an 8-bit signed integer type with a range of [-128,127]; this corresponds with <code>signed char</code> in C."}, {"owner": {"reputation": 363, "user_id": 5884011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a18cd70b148266417876e7da2f4ea805?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5884011/anna"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1512528031, "post_id": 47665769, "comment_id": 82291073, "body": "@DavidBowling Thanks, i think it&#39;ll work. I&#39;ll go head and try"}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1512527906, "post_id": 47665911, "comment_id": 82291035, "body": "C# <code>byte</code> would correspond to C <code>uint8_t</code>, which is an 8-bit <code>unsigned</code> integer type. Note that in C <code>char</code> is an integer type which may be <code>signed</code> or <code>unsigned</code>, and which must be <i>at least</i> 8 bits wide, but may be wider."}], "tags": [], "owner": {"reputation": 501, "user_id": 659045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56822968ae885c4ba9923a17ca8b9b61?s=128&d=identicon&r=PG", "display_name": "Ken Forsythe", "link": "https://stackoverflow.com/users/659045/ken-forsythe"}, "is_accepted": true, "score": 2, "last_activity_date": 1512527576, "creation_date": 1512527576, "answer_id": 47665911, "question_id": 47665769, "link": "https://stackoverflow.com/questions/47665769/char-stored-as-int-array-in-c-how-to-i-convert-it-to-c/47665911#47665911", "title": "char stored as int array in C? How to I convert it to C#", "body": "<p>C# equivalent of char is byte. But in your case you need possibility of negative numbers, so you\u2019ll need a multidimensional array of sbyte. </p>\n"}], "owner": {"reputation": 363, "user_id": 5884011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a18cd70b148266417876e7da2f4ea805?s=128&d=identicon&r=PG&f=1", "display_name": "Anna", "link": "https://stackoverflow.com/users/5884011/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 47665911, "answer_count": 1, "score": -4, "last_activity_date": 1512533607, "creation_date": 1512526418, "last_edit_date": 1512533607, "question_id": 47665769, "link": "https://stackoverflow.com/questions/47665769/char-stored-as-int-array-in-c-how-to-i-convert-it-to-c", "title": "char stored as int array in C? How to I convert it to C#", "body": "<p>I am trying to understand part of the C code and convert it to C# code. I have a hard time understanding this part, it seems like a char array, expressed with intergers. How do I convert it to C# code?</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>static const char   gradient[32][4] =\n{\n    { 1,  1,  1,  0}, { 1,  1,  0,  1}, { 1,  0,  1,  1}, { 0,  1,  1,  1},\n    { 1,  1, -1,  0}, { 1,  1,  0, -1}, { 1,  0,  1, -1}, { 0,  1,  1, -1},\n    { 1, -1,  1,  0}, { 1, -1,  0,  1}, { 1,  0, -1,  1}, { 0,  1, -1,  1},\n    { 1, -1, -1,  0}, { 1, -1,  0, -1}, { 1,  0, -1, -1}, { 0,  1, -1, -1},\n    {-1,  1,  1,  0}, {-1,  1,  0,  1}, {-1,  0,  1,  1}, { 0, -1,  1,  1},\n    {-1,  1, -1,  0}, {-1,  1,  0, -1}, {-1,  0,  1, -1}, { 0, -1,  1, -1},\n    {-1, -1,  1,  0}, {-1, -1,  0,  1}, {-1,  0, -1,  1}, { 0, -1, -1,  1},\n    {-1, -1, -1,  0}, {-1, -1,  0, -1}, {-1,  0, -1, -1}, { 0, -1, -1, -1},\n};\n</code></pre>\n"}, {"tags": ["c", "dll", "static-libraries", "external"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1512528752, "post_id": 47665670, "comment_id": 82291246, "body": "You&#39;ll need to consult your lecture notes to understand what the teacher wants you to regurgitate. (3a) Does zero count? You don&#39;t add libraries to the code; you add them to the build process, or load them at runtime. (3b) There are no places, so you shouldn&#39;t get more points for listing zero places. (3c) And since there are no places, there are no disadvantages or advantages to those zero places. Clearly, my interpretation of what &quot;libraries in code&quot; means doesn&#39;t mean what they think it does. Work out what you&#39;ve been taught, but I have reservations about the usefulness of that information."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512534576, "post_id": 47665670, "comment_id": 82292672, "body": "@JonathanLeffler would you consider headers with static inline functions or function like macros as libraries? I believe some parts of the standard C <i>library</i> are also implemented that way."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1512535316, "post_id": 47665670, "comment_id": 82292842, "body": "@AjayBrahmakshatriya: &#39;Header-only libraries&#39; are real, especially in the C++ world.  They&#39;re rare but not impossible in C.  I still regard them first and foremost as headers rather than libraries \u2014 they provide their services without using a library.  Whether this was discussed in the lecture notes is something I can&#39;t tell."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1512535432, "post_id": 47665670, "comment_id": 82292878, "body": "@AjayBrahmakshatriya: This also raises the question &quot;what is a library&quot;.  Does &#39;parts of the standard C library&#39; being implemented like that mean &quot;the standard C library is (all) implemented like that&quot;?  No; there&#39;s still a separate standard C library.  There are complex constraints on C libraries.  You don&#39;t have to include a header to get access to most of the services of the library.  You are permitted to include an appropriate declaration (that matches what the standard says) and call the function even without the header being included. That means the library must provide the functions."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512535762, "post_id": 47665670, "comment_id": 82292969, "body": "@JonathanLeffler I think the common idea of a library (a <code>.so</code> file or <code>.a</code> file) is a part of the implementation. This interpretation of the word &quot;library&quot; is correct in the OS context. For C, this is not necessary. In fact, one could have an implementation where libraries are not linked in such a way. The implementation might not even be compiled. In that case I am not sure if just including the prototype of the function and not including the header would work. I am not sure on this part, but does the standard allow this?(I am sure the standard allows some functions to be declared as macros)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512535866, "post_id": 47665670, "comment_id": 82292997, "body": "@JonathanLeffler but then again, OP has added the <code>dll</code> and <code>static-libraries</code> to the question. So I think your interpretation (and hence the comment) is correct. There is one possibility though - <code>#pragma comment(lib, &quot;library.0.lib&quot;)</code>. I am again not sure if this is standard."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1512536502, "post_id": 47665670, "comment_id": 82293210, "body": "@AjayBrahmakshatriya: the standard allows functions to be declared as macros, but it requires every function to be implemented as a function.  There are a few exceptions \u2014 <code>va_arg()</code> is one such; <code>offsetof()</code> is another.  In both cases, it&#39;s because the macro takes arguments which are not simple values; <code>va_arg()</code> takes a type name; <code>offsetof()</code> takes a type and a &#39;member designator&#39; as arguments."}], "owner": {"reputation": 113, "user_id": 2465172, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3e83577127f0d90944e03011551402fe?s=128&d=identicon&r=PG", "display_name": "Kevin doesmath", "link": "https://stackoverflow.com/users/2465172/kevin-doesmath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512525773, "creation_date": 1512525773, "question_id": 47665670, "link": "https://stackoverflow.com/questions/47665670/where-can-external-libraries-be-added-to-c-code", "title": "Where can external libraries be added to C code?", "body": "<p>I am answering this homework problem I need some help with.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9dqPU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9dqPU.png\" alt=\"enter image description here\"></a></p>\n\n<p>As I understand, external libraries can be added in two places in a C file: the top, with an #include statement, and in a function body, with dlopen().</p>\n\n<p>I'm not sure if this is the correct interpretation of the problem, and if it is, if there are other places I may have missed.</p>\n\n<p>Thank you for any insights :) </p>\n"}, {"tags": ["c", "function", "winapi", "colors"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1512520674, "post_id": 47664868, "comment_id": 82289188, "body": "You are passing a <code>HANDLE*</code> pointer to <code>GetConsoleScreenBufferInfoEx()</code> and <code>SetConsoleTextAttribute()</code>, but they expect a <code>HANDLE</code> value instead. <code>HANDLE</code> is already a pointer type, so there is no need to pass it around by address. The only way your code could compile is if you are compiling without <code>STRICT</code> defined, so <code>HANDLE</code> maps to <code>void*</code> (<code>STRICT</code> would have caught this error and failed to compile). You need to change your <code>HANDLE*</code> parameters to <code>HANDLE</code> and pass them around by value instead of by pointer"}, {"owner": {"reputation": 314, "user_id": 6890481, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2c2ded74bde447d938af986755ad5e87?s=128&d=identicon&r=PG&f=1", "display_name": "Ahm23", "link": "https://stackoverflow.com/users/6890481/ahm23"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1512520852, "post_id": 47664868, "comment_id": 82289232, "body": "@RemyLebeau Ok so i fixed that and the function gets called properly but the color still isn&#39;t changing"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1512521431, "post_id": 47664868, "comment_id": 82289383, "body": "Well, you are retrieving <i>a copy</i> of the console&#39;s color table and then altering that copy, but you are not assigning the alterations back to the console with <code>SetConsoleScreenBufferInfoEx()</code>. And <code>SetConsoleTextAttribute()</code> only affects higher-level output functions, like <code>WriteFile()</code>, not lower-level output functions, like <code>WriteConsoleOutput()</code>, <code>WriteConsoleOutputCharacter()</code>, etc. Check your RTL&#39;s implementation of <code>printf()</code> to see what API function is actually used for console output. And, you are not checking either API function for failures."}], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 6890481, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2c2ded74bde447d938af986755ad5e87?s=128&d=identicon&r=PG&f=1", "display_name": "Ahm23", "link": "https://stackoverflow.com/users/6890481/ahm23"}, "is_accepted": false, "score": 0, "last_activity_date": 1512572953, "creation_date": 1512572953, "answer_id": 47677486, "question_id": 47664868, "link": "https://stackoverflow.com/questions/47664868/returning-setconsoletextattribute-colour-value-from-function-in-c/47677486#47677486", "title": "Returning SetConsoleTextAttribute colour value from function in c", "body": "<p>Ok so I got it fixed. I first decided to declare the HANDLE value in the mainMenu() function and remove the HANDLE pointer.</p>\n\n<p>Secondly, the setColour() function's GetConsoleScreenBufferInfoEx() did get called before changing the color values but wasn't called after modifying the color values thus i needed to call GetConsoleScreenBufferInfoEx() a second time to get the new color values to use.</p>\n\n<p>Fixed Code:</p>\n\n<pre><code>void setColour(HANDLE* hConsole, int ChangeColour, int Red, int Green, int Blue, int Colour) {\n    CONSOLE_SCREEN_BUFFER_INFOEX info;\n    info.cbSize = sizeof(info);\n    GetConsoleScreenBufferInfoEx(hConsole, &amp;info);\n    info.ColorTable[ChangeColour] = RGB(Red, Green, Blue);\n    GetConsoleScreenBufferInfoEx(hConsole, &amp;info);\n    SetConsoleTextAttribute(hConsole, Colour);\n}\n\nvoid mainMenu(WindowProp* Dimensions) {\n    getWindowSize(Dimensions);\n    clearScreen();\n    HANDLE hConsole = GetStdHandle(STD_OUTPUT_HANDLE);\n    setColour(hConsole, 3, 120, 120, 236, 48);\n    int DisplayRowCount, DisplayColumnCount;\n    for (DisplayRowCount = 0; DisplayRowCount &lt;= Dimensions-&gt;Y-1; DisplayRowCount++) {\n        for (DisplayColumnCount = 0; DisplayColumnCount &lt;= Dimensions-&gt;X-1; DisplayColumnCount++) {\n            printf(\" \");\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 314, "user_id": 6890481, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2c2ded74bde447d938af986755ad5e87?s=128&d=identicon&r=PG&f=1", "display_name": "Ahm23", "link": "https://stackoverflow.com/users/6890481/ahm23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512572953, "creation_date": 1512519894, "question_id": 47664868, "link": "https://stackoverflow.com/questions/47664868/returning-setconsoletextattribute-colour-value-from-function-in-c", "title": "Returning SetConsoleTextAttribute colour value from function in c", "body": "<p>Currently im trying to call a function to change the color the text background using the windows.h functions to do so. I have done it before but not from another function. Is the problem that the function needs to return the color value somehow or there is just something wrong.\nThe function was called from another function if that changes anything.</p>\n\n<p>Code Together: </p>\n\n<pre><code>void setColour(HANDLE* hConsole, int ChangeColour, int Red, int Green, int Blue, int Colour) {\n    CONSOLE_SCREEN_BUFFER_INFOEX info;\n    info.cbSize = sizeof(info);\n    GetConsoleScreenBufferInfoEx(hConsole, &amp;info);\n    info.ColorTable[ChangeColour] = RGB(Red, Green, Blue);\n    SetConsoleTextAttribute(hConsole, Colour);\n}\n\nvoid mainMenu(WindowProp* Dimensions, HANDLE* hConsole) {\n    getWindowSize(Dimensions);\n    clearScreen();\n    setColour(hConsole, 3, 120, 120, 236, 48);\n    printf(\"Set\");\n    int DisplayRowCount, DisplayColumnCount;\n    for (DisplayRowCount = 0; DisplayRowCount &lt;= Dimensions-&gt;Y-1; DisplayRowCount++) {\n        for (DisplayColumnCount = 0; DisplayColumnCount &lt;= Dimensions-&gt;X-1; DisplayColumnCount++) {\n            printf(\" \");\n        }\n    }\n}\n</code></pre>\n\n<p>mainMenu called from main: </p>\n\n<pre><code>mainMenu(&amp;WindowP, hConsole);\n</code></pre>\n"}, {"tags": ["c", "sockets", "data-structures", "tcp", "structure"], "comments": [{"owner": {"reputation": 1626, "user_id": 5478462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/760557cc7099bc054a445ff659d02950?s=128&d=identicon&r=PG&f=1", "display_name": "pastaleg", "link": "https://stackoverflow.com/users/5478462/pastaleg"}, "edited": false, "score": 0, "creation_date": 1512519093, "post_id": 47664715, "comment_id": 82288809, "body": "Have you read through this previous answer to a very similar question. At what point does that not work for you? <a href=\"https://stackoverflow.com/questions/8000851/passing-a-struct-over-tcp-sock-stream-socket-in-c\" title=\"passing a struct over tcp sock stream socket in c\">stackoverflow.com/questions/8000851/&hellip;</a>"}, {"owner": {"reputation": 586, "user_id": 4216567, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/83dd4424baa962b340b97eb1899ed75d?s=128&d=identicon&r=PG&f=1", "display_name": "noone392", "link": "https://stackoverflow.com/users/4216567/noone392"}, "edited": false, "score": 0, "creation_date": 1512519147, "post_id": 47664715, "comment_id": 82288823, "body": "just cast it to a char array to serialize it and if you need to restrict it to actual charrs then just base64 encode it"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1512519724, "post_id": 47664715, "comment_id": 82288959, "body": "The only part that might cause problems is the <code>sockid</code>.  There&#39;s a question of how often your <code>buff</code> will actually contain 1000+ characters vs just a few; it might be better to send only the active characters for such a long field, but the others could probably be sent entire.  Look up &quot;serialization&quot; -- that&#39;s the process you need to send the data, and &quot;deserialization&quot; to receive it."}, {"owner": {"reputation": 3885, "user_id": 652528, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a580420b66f89e76e1fb9a368f785b3f?s=128&d=identicon&r=PG", "display_name": "geckos", "link": "https://stackoverflow.com/users/652528/geckos"}, "edited": false, "score": 0, "creation_date": 1512520044, "post_id": 47664715, "comment_id": 82289034, "body": "If you want to use binary protocol I suggest protobuf from Google :)"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 4761747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d73ee9d75be18ab94c7ab44904d6970?s=128&d=identicon&r=PG&f=1", "display_name": "rama", "link": "https://stackoverflow.com/users/4761747/rama"}, "is_accepted": false, "score": 0, "last_activity_date": 1512519686, "creation_date": 1512519686, "answer_id": 47664830, "question_id": 47664715, "link": "https://stackoverflow.com/questions/47664715/sending-a-structure-through-a-socket-in-c/47664830#47664830", "title": "Sending a structure through a socket in c", "body": "<p>Before, writing a structure, you need to be aware of padding issues. It seems that your structure is well aligned. However, the receiver needs to be on similar architecture and similar compiler structure packaging settings to consume the structure in the same exact way. Alternatively, you can define a message protocol that explicitly packs this data and writes as a byte stream. </p>\n\n<p>That said, a structure could still be written simply by doing\nwrite(sock, &amp;myMessage, sizeof (message)). It will write out all the bytes of the sizeof(message). </p>\n"}, {"tags": [], "owner": {"reputation": 601, "user_id": 9058096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49044ab07fe9808b72ce58dcc999adcd?s=128&d=identicon&r=PG&f=1", "display_name": "Cupcake Protocol", "link": "https://stackoverflow.com/users/9058096/cupcake-protocol"}, "is_accepted": false, "score": 1, "last_activity_date": 1512519812, "creation_date": 1512519812, "answer_id": 47664851, "question_id": 47664715, "link": "https://stackoverflow.com/questions/47664715/sending-a-structure-through-a-socket-in-c/47664851#47664851", "title": "Sending a structure through a socket in c", "body": "<p>You can just write the message out on the socket:</p>\n\n<pre><code>struct message mymess;\n...\nwrite(socketfd, &amp;mymess, sizeof(struct message));\n</code></pre>\n\n<p>and then read it back in on the client side. That works if it's always the same hardware / compiler, since the struct will be compiled the same way. If you haven't memset() the whole of mymess, then you are likely to have uninitialized stuff in the write(). It should be safe, but can set off sanity checks.</p>\n\n<p>For more reliable messaging you need to design or adopt a serialization protocol. JSON is an extremely popular one (albeit perhaps not among C programmers), but there are many others.</p>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 2, "last_activity_date": 1512530101, "last_edit_date": 1512530101, "creation_date": 1512528338, "answer_id": 47665999, "question_id": 47664715, "link": "https://stackoverflow.com/questions/47664715/sending-a-structure-through-a-socket-in-c/47665999#47665999", "title": "Sending a structure through a socket in c", "body": "<p>For the same machines and compilers you can do as follows:  </p>\n\n<pre><code>// define your structure:\n#define BUFFSIZE 1024\n#define USERLEN 32\n#define OPTLEN 16\n\ntypedef struct message{\n  char option[OPTLEN];\n  char user[USERLEN];\n  char buff[BUFFSIZE]; \n  char target[USERLEN];\n  int sockid;\n}my_message;\n\n\n// now you can use it in your program\n\nmy_message m;\n\n// initialize m\n...\nstrcpy(m.user,\"1234\");\n...\nm.sockid = sockfd;\n\n// send it over \n\nif ((nbytes = write(sockfd, &amp;m, sizeof(my_message)) != sizeof(my_message))\n{\n  printf(\"error writing my message\");\n}\n\n\n\n// read the message on the other side:\n...\nmy_message received_message;\nint size;\n\nif( (size = recv ( sockfd, (void*)&amp;received_message, sizeof(my_message), 0)) &gt;= 0)\n{\n     // check the size\n}\n\n// It would work for same machines 32/64 bits and same compilers.\n</code></pre>\n\n<p>If you need better portability try <a href=\"https://github.com/protobuf-c/protobuf-c\" rel=\"nofollow noreferrer\">protobuf-c</a> , <a href=\"http://jpa.kapsi.fi/nanopb/\" rel=\"nofollow noreferrer\">nanopb</a>, binary serialization <a href=\"https://github.com/liteserver/binn\" rel=\"nofollow noreferrer\">binn</a> or <a href=\"http://troydhanson.github.io/tpl/\" rel=\"nofollow noreferrer\">tpl</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9048314, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/91265c911e16ef1007e9b20ff8140c12?s=128&d=identicon&r=PG&f=1", "display_name": "jonelearn", "link": "https://stackoverflow.com/users/9048314/jonelearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3330, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1512530101, "creation_date": 1512518720, "question_id": 47664715, "link": "https://stackoverflow.com/questions/47664715/sending-a-structure-through-a-socket-in-c", "title": "Sending a structure through a socket in c", "body": "<p>I want to send a data structure through a socket in a tcp server/client program written in C. However when i try to print the sent data it doesn't print anything. I've realized by now that sending structures this way is a bad idea, the posts i've seen aren't being very helpful in finding a way to actually make this work. Here's the data structure in question: </p>\n\n<pre><code>#define BUFFSIZE 1024\n#define USERLEN 32\n#define OPTLEN 16\n\nstruct  message{\n  char option[OPTLEN];\n  char user[USERLEN];\n  char buff[BUFFSIZE]; \n  char target[USERLEN];\n  int sockid;\n};\n</code></pre>\n\n<p>thanks in advance.</p>\n"}, {"tags": ["c", "sockets", "ubuntu", "pthreads"], "comments": [{"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1512518829, "post_id": 47664680, "comment_id": 82288732, "body": "Threading is so complicated.  Instead of spawning a thread to handle each request, you might get better performance and easier programming both, by using <code>select</code> or <code>epoll</code> instead.  Just a thought - I&#39;ve done it the way you are doing it here, but I wouldn&#39;t again.  I&#39;ll have to look closer at your code to see if I can spot your issue."}, {"owner": {"reputation": 11, "user_id": 5646850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a23ee85fa985f1c10c0290359feee1c?s=128&d=identicon&r=PG&f=1", "display_name": "serhan48", "link": "https://stackoverflow.com/users/5646850/serhan48"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1512519309, "post_id": 47664680, "comment_id": 82288875, "body": "thank you so much for your advice but unfortunately i got no knowledge about select and epoll you&#39;re talking about. i got some knowledge about pthread library (including mutexes, condition variables, threads) and some knowledge about socket api in c."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1512520643, "post_id": 47664680, "comment_id": 82289178, "body": "Why &#39;pthread_join(handler_thread, NULL);&#39; ?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1512520721, "post_id": 47664680, "comment_id": 82289200, "body": "Don&#39;t use gets(). It&#39;s dangerous and deprecated."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1512520794, "post_id": 47664680, "comment_id": 82289217, "body": "&#39;send(sock_descriptor, buffer, sizeof(buffer), 0);&#39; why send 256 bytes every time?"}, {"owner": {"reputation": 11, "user_id": 5646850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a23ee85fa985f1c10c0290359feee1c?s=128&d=identicon&r=PG&f=1", "display_name": "serhan48", "link": "https://stackoverflow.com/users/5646850/serhan48"}, "edited": false, "score": 0, "creation_date": 1512522337, "post_id": 47664680, "comment_id": 82289650, "body": "Martin i know gets is dangerous i used it for simplicity and debugging. i was thinking it to change later. i don&#39;t know what number of bytes should i allow user to send i chose it maximum 255 characters for now. i was practicing now i will change it to multi-user chat program later when i understand basics."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1512524900, "post_id": 47664680, "comment_id": 82290299, "body": "first get the socket io working with a single client and single server. THEN add any multithreading ... it&#39;ll make your life easier."}, {"owner": {"reputation": 11, "user_id": 5646850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a23ee85fa985f1c10c0290359feee1c?s=128&d=identicon&r=PG&f=1", "display_name": "serhan48", "link": "https://stackoverflow.com/users/5646850/serhan48"}, "edited": false, "score": 1, "creation_date": 1512527472, "post_id": 47664680, "comment_id": 82290921, "body": "Martin thank you so much i realized i wrote sizeof(buffer) instead of strlen(buffer) in send(sock_descriptor, buffer, sizeof(buffer), 0) statement. I changed it to normal and it worked thank you so much."}], "answers": [{"comments": [{"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "reply_to_user": {"reputation": 11, "user_id": 5646850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a23ee85fa985f1c10c0290359feee1c?s=128&d=identicon&r=PG&f=1", "display_name": "serhan48", "link": "https://stackoverflow.com/users/5646850/serhan48"}, "edited": false, "score": 1, "creation_date": 1512528091, "post_id": 47665688, "comment_id": 82291085, "body": "Ok . Still it is complex to analyze threaded code. Start with non threaded code then move to threads"}, {"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1512591401, "post_id": 47665688, "comment_id": 82324725, "body": "It seems kind of pointless to start up a thread to handle your connection, and then immediately join that thread before returning to the accept loop.  At that point, the thread has to be done before the next request can be made - you may as well not bother running the thread at all.  I don&#39;t see how it makes any difference.  If you opportunistically joined the thread you could accept other requests in the mean time ( a select or epoll would also allow you to handle multiple sockets from a single thread )"}, {"owner": {"reputation": 11, "user_id": 5646850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a23ee85fa985f1c10c0290359feee1c?s=128&d=identicon&r=PG&f=1", "display_name": "serhan48", "link": "https://stackoverflow.com/users/5646850/serhan48"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 1, "creation_date": 1512598355, "post_id": 47665688, "comment_id": 82328222, "body": "@DanFarrell I understand that using threads this way hasn&#39;t any significance. I was changed it to handle one client to try to solve the problem i mentioned above. I solved the problem thanks of Martin James. I will turn it to multi-user multithreaded chat application. Is&#39;nt there a way to do that with pthread library and socket api ? Now i&#39;ve created a global thread pool to assign threads to each client communicating with server. Do you have any suggestions ?"}], "tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1512550190, "last_edit_date": 1512550190, "creation_date": 1512525882, "answer_id": 47665688, "question_id": 47664680, "link": "https://stackoverflow.com/questions/47664680/synchronization-in-simple-socket-programming-in-c/47665688#47665688", "title": "synchronization in simple socket programming in C", "body": "<p>Join the threads right after it has been created , accept is a blocking call (I assume you have not modified the default behavior) . Threads are complex to analyze however , the call to join wont even come since blocking accept call in while loop.</p>\n\n<pre><code>while(1)\n {\n    //do something here \n    ...\n    if( pthread_create(&amp;handler_thread, (void *)NULL, connection_handler, (void *)new_sock) &lt; 0)\n    {\n        printf(\"ERROR: creating thread\\n\");\n        exit(1);\n    }\n\n    pthread_join(handler_thread, NULL); //Use it right after creating thread\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5646850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a23ee85fa985f1c10c0290359feee1c?s=128&d=identicon&r=PG&f=1", "display_name": "serhan48", "link": "https://stackoverflow.com/users/5646850/serhan48"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 918, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512550190, "creation_date": 1512518499, "question_id": 47664680, "link": "https://stackoverflow.com/questions/47664680/synchronization-in-simple-socket-programming-in-c", "title": "synchronization in simple socket programming in C", "body": "<p>I want to create a simple multithreaded chat application in C using api. For the beginning, i wrote a simple  server communicating with client but there is a problem in the order messages sent.</p>\n\n<p>example output:</p>\n\n<p>in server</p>\n\n<p>*new_sock socket number: 4</p>\n\n<p>Server:hello client</p>\n\n<p>Client:hello server</p>\n\n<p>Server:how are you?</p>\n\n<p>Client:</p>\n\n<p>Server:</p>\n\n<p>in client</p>\n\n<p>Server:hello client</p>\n\n<p>Client:hello server</p>\n\n<p>Server:how are you?</p>\n\n<p>Client:</p>\n\n<pre><code>    //server code\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;sys/socket.h&gt;\n    #include &lt;sys/types.h&gt;\n    #include &lt;netinet/in.h&gt;\n    #include &lt;pthread.h&gt;\n\nvoid* connection_handler(void* socket_descriptor)\n{\n\n    int socket = *(int *)socket_descriptor;\n\n    int n;\n\n    char server_buffer[256];\n    memset(server_buffer, 0, sizeof(server_buffer));\n\n    printf(\"Server:\");\n    gets(server_buffer);\n\n    send(socket, server_buffer, strlen(server_buffer), 0);\n    memset(server_buffer, 0, sizeof(server_buffer));\n\n    while ((n = recv(socket, server_buffer, 255, 0)) &gt; 0)\n    {\n        server_buffer[n] = '\\0';\n        printf(\"Client:%s\\n\", server_buffer);\n        memset(server_buffer, 0, sizeof(server_buffer));\n        printf(\"Server:\");\n        gets(server_buffer);\n        send(socket, server_buffer, strlen(server_buffer), 0);\n        memset(server_buffer, 0, sizeof(server_buffer));\n\n        n = 0;\n    }\n\n    close(socket);\n\n    free(socket_descriptor);\n\n    return 0;\n}\n\n\nint main(int argc, char *argv[])\n{\n    int server_sock, client_sock, portno, client_len, n;\n    int *new_sock;\n\n    struct sockaddr_in server_addr, client_addr;\n\n    if(argc &lt; 2)\n    {\n        printf(\"ERROR: no port provided.\\n\");\n        exit(1);\n    }\n\n    server_sock = socket(AF_INET, SOCK_STREAM, 0);\n\n    if(server_sock &lt; 0)\n    {\n        printf(\"ERROR: opening socket.\");\n        exit(1);\n    }\n\n    portno = atoi(argv[1]);\n\n\n    memset((char *)&amp;server_addr, 0, sizeof(server_addr));\n\n\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_port = htons(portno);\n    server_addr.sin_addr.s_addr = INADDR_ANY;\n\n    if( bind(server_sock, (struct sockaddr *)&amp;server_addr, sizeof(server_addr)) &lt; 0 )\n    {\n        printf(\"ERROR: binding socket.\");\n        exit(1);\n    }\n\n\n    listen(server_sock, 5);\n\n    pthread_t handler_thread;\n\n\n    while( client_sock = accept(server_sock, (struct sockaddr *)&amp;client_addr, &amp;client_len) )\n    {\n\n\n        new_sock = malloc(sizeof(int));\n        *new_sock = client_sock;\n\n        printf(\"*new_sock socket number: %d\\n\", *new_sock);\n\n        if( pthread_create(&amp;handler_thread, (void *)NULL, connection_handler, (void *)new_sock) &lt; 0)\n        {\n            printf(\"ERROR: creating thread\\n\");\n            exit(1);\n        }\n\n\n    }\n\n    pthread_join(handler_thread, NULL);\n\n    printf(\"server shut down.\\n\");\n\n\n    return 0;\n}\n\n//client code\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n\n\nint main(int argc, char* argv[])\n{\n    int sock_descriptor, portno, n;\n\n    struct sockaddr_in server_addr;\n\n    char buffer[256];\n\n    if (argc != 2)\n    {\n        printf(\"usage: %s port\\n\", argv[0]);\n        exit(1);\n    }\n\n\n    portno = atoi(argv[1]);\n\n    sock_descriptor = socket(AF_INET, SOCK_STREAM, 0);\n\n    if (sock_descriptor &lt; 0)\n    {\n        printf(\"ERROR: creating socket!\\n\");\n        exit(1);\n    }\n\n\n    memset((char *)&amp;server_addr, 0, sizeof(server_addr));\n\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_addr.s_addr = INADDR_ANY;\n    server_addr.sin_port = htons(portno);\n\n    if (connect(sock_descriptor, (struct sockaddr *)&amp;server_addr, sizeof(server_addr)) &lt; 0)\n    {\n        printf(\"ERROR: connecting server!\\n\");\n        exit(1);\n    }\n\n    memset(buffer, 0, sizeof(buffer));\n\n\n\n    while((n = recv(sock_descriptor, buffer, 255, 0)) &gt; 0)\n    {\n        buffer[n] = '\\0';\n        printf(\"Server:%s\\n\", buffer);\n        memset(buffer, 0, sizeof(buffer));\n        printf(\"Client:\");\n        gets(buffer);\n        send(sock_descriptor, buffer, sizeof(buffer), 0);\n        memset(buffer, 0, sizeof(buffer));\n\n    }\n\n\n\n    if (n &lt;= 0)\n    {\n        printf(\"ERROR: reading from socket\");\n        exit(1);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "vector"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1512518507, "post_id": 47664657, "comment_id": 82288636, "body": "If you double the size of your vector every time you add one element, you&#39;re going to run out of memory really fast."}, {"owner": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 0, "creation_date": 1512518802, "post_id": 47664657, "comment_id": 82288725, "body": "Can you post the <code>getline</code> function? I believe that&#39;s where the problem is."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 1, "creation_date": 1512518969, "post_id": 47664657, "comment_id": 82288774, "body": "@xiaofeng.li <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline</code> is a POSIX-standard function.</a>"}, {"owner": {"reputation": 11, "user_id": 9059003, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e77Y4x05sDg/AAAAAAAAAAI/AAAAAAAABOk/QcPgjhOxcNs/photo.jpg?sz=128", "display_name": "Saintz", "link": "https://stackoverflow.com/users/9059003/saintz"}, "edited": false, "score": 0, "creation_date": 1512519204, "post_id": 47664657, "comment_id": 82288838, "body": "added my get_element function"}], "answers": [{"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1512521011, "post_id": 47664733, "comment_id": 82289262, "body": "The standard way vectors are implemented is similar, but (1) your &quot;double_capacity()&quot; function should simply return if the vector isn&#39;t full, otherwise it reallocates it bigger, copies the values, and de-allocates the old one; and (2) increasing the capacity by 150% is a better speed/memory waste tradeoff."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1512530129, "post_id": 47664733, "comment_id": 82291564, "body": "@LeeDanielCrocker I understand that.  I deliberately tried to keep this answer as close to the code in the original question as possible."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 0, "last_activity_date": 1512518921, "creation_date": 1512518921, "answer_id": 47664733, "question_id": 47664657, "link": "https://stackoverflow.com/questions/47664657/c-read-a-file-line-by-line-to-vector/47664733#47664733", "title": "C read a file, line by line to vector", "body": "<p>You need to make a copy of the data you add to your vector.</p>\n\n<pre><code>void vector_push(Vector *vector, void *value, size_t bytes){\n    vector_double_capacity(vector);\n    void *copy = malloc(bytes);\n    memcpy(copy, value, bytes);\n    vector -&gt; data[vector -&gt; size ++] = copy;\n}\n</code></pre>\n\n<p>You'd have to call that with something like</p>\n\n<pre><code>vector_push(&amp;someVector, line, 1 + strlen( line ) );\n</code></pre>\n\n<p>to preserve your vector's apparent purpose of holding a pointer to any type of data and not just <code>NUL</code>-terminated strings.  You may also want to add a <code>size</code> field to your structure so you know how much data is pointed to.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9059003, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e77Y4x05sDg/AAAAAAAAAAI/AAAAAAAABOk/QcPgjhOxcNs/photo.jpg?sz=128", "display_name": "Saintz", "link": "https://stackoverflow.com/users/9059003/saintz"}, "is_accepted": false, "score": 0, "last_activity_date": 1513442577, "creation_date": 1513442577, "answer_id": 47847862, "question_id": 47664657, "link": "https://stackoverflow.com/questions/47664657/c-read-a-file-line-by-line-to-vector/47847862#47847862", "title": "C read a file, line by line to vector", "body": "<p>I found another simple way around this.</p>\n\n<pre><code>while (getline(&amp;line, &amp;len, fp) != -1){\n   vector_push(&amp;someVector, line);\n}\n\nline = NULL;\n</code></pre>\n\n<p>by setting line to NULL</p>\n"}], "owner": {"reputation": 11, "user_id": 9059003, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-e77Y4x05sDg/AAAAAAAAAAI/AAAAAAAABOk/QcPgjhOxcNs/photo.jpg?sz=128", "display_name": "Saintz", "link": "https://stackoverflow.com/users/9059003/saintz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 47664733, "answer_count": 2, "score": 0, "last_activity_date": 1513442577, "creation_date": 1512518330, "last_edit_date": 1512518980, "question_id": 47664657, "link": "https://stackoverflow.com/questions/47664657/c-read-a-file-line-by-line-to-vector", "title": "C read a file, line by line to vector", "body": "<p>I just started coding in C.\nI have implemented a vector that seems to be working when i append strings to it,\nbut as soon as i read from the file i seem to get the last string again and again.\nFrom what i can see it seems like it uses the same address and therfore i get the same line again and again.</p>\n\n<p>But i can't seem to find a solution to the problem, hope you can help.</p>\n\n<p>this is my vector structure:</p>\n\n<pre><code>void vector_init(Vector *vector){\n    vector -&gt; size = 0;\n    vector -&gt; capacity = 20;\n    vector -&gt; data = malloc(sizeof(void *) * vector -&gt; capacity);\n</code></pre>\n\n<p>}</p>\n\n<p>and appending to vector:</p>\n\n<pre><code>void vector_push(Vector *vector, void *value){\n    vector_double_capacity(vector);\n    vector -&gt; data[vector -&gt; size ++] = value;\n}\n</code></pre>\n\n<p>and here is what i do in my main function:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n\n    Vector someVector;\n    vector_init(&amp;someVector);\n\n    FILE *fp;\n    void *line = NULL;\n    size_t len = 0;\n    fp = fopen(argv[1], \"r\");\n\n    if (fp == NULL)\n        exit(EXIT_FAILURE);\n\n    while (getline(&amp;line, &amp;len, fp) != -1){\n        vector_push(&amp;someVector, line);\n    }\n\n    fclose(fp);\n    printf(\"\\n\");\n\n    vector_push(&amp;someVector, \"blah\");\n    vector_push(&amp;someVector, \"test\");\n    vector_push(&amp;someVector, \"some random txt\");\n    vector_push(&amp;someVector, \"yollo\");\n    vector_push(&amp;someVector, \"something\");\n\n    for (int i = 0; i &lt; someVector.size; i++)\n        printf(\"\\nvalue is : %s\", (char *) vector_get_element(&amp;someVector, i));\n\n    return 0;\n}\n</code></pre>\n\n<p>My get_element function:</p>\n\n<pre><code>void *vector_get_element(const Vector *vector, size_t index){\n    if (index &gt;= vector -&gt; size || index &lt; 0){\n        printf (\"Index %d out of bounds\", (int) index);\n    }\n    return vector -&gt; data[index];\n}\n</code></pre>\n\n<p>here is my output:</p>\n\n<pre><code>value is : terminal\nvalue is : terminal\nvalue is : terminal\nvalue is : terminal\nvalue is : blah\nvalue is : test\nvalue is : some random txt\nvalue is : yollo\nvalue is : something\nProcess finished with exit code 0\n</code></pre>\n"}, {"tags": ["c", "process", "fork"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1512518450, "post_id": 47664647, "comment_id": 82288621, "body": "Calling <code>perror</code> with an indeterminate value in <code>errno</code> is a mistake.  You&#39;re likely to get error message like <code>Invalid number of arguments!: Success</code>, or possibly <code>Invalid number of arguments: Not a type-writer</code>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1512518739, "post_id": 47664647, "comment_id": 82288712, "body": "Why are you looping on <code>wait</code>?  The first time <code>wait</code> returns, it tells you the pid of the child that just finished.  It is most sensible to say that child is the one that finished first.  Indeed, you could define &quot;finishing&quot; as having the parent reap the child&#39;s data from the process table, so by definition the pid first returned by <code>wait</code> is the pid of the child that finished first."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1512522146, "post_id": 47664647, "comment_id": 82289587, "body": "Your question was &quot;How I can terminate another child, and return the winning process?&quot;.... 1) following the fork(), the &quot;parent&quot; saves the pid of the new child. 2) wait will tell you the pid of the winning process.  3) use &quot;kill()&quot; to terminate the &#39;losing&#39; process."}, {"owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "edited": false, "score": 0, "creation_date": 1512524635, "post_id": 47664647, "comment_id": 82290229, "body": "But how can I immediately get the pid of the losing process so that I can kill it?"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 1, "last_activity_date": 1567000485, "creation_date": 1567000485, "answer_id": 57694115, "question_id": 47664647, "link": "https://stackoverflow.com/questions/47664647/c-program-that-tells-the-user-which-child-process-finished-first/57694115#57694115", "title": "C program that tells the user which child process finished first", "body": "<blockquote>\n  <p>But how can I immediately get the pid of the losing process so that I can kill it?</p>\n</blockquote>\n\n<p>Just as TonyB told: <em>the \"parent\" saves the pid of the new child. 2) wait will tell you the pid of the winning process.</em> More verbose: Save the PID of both children, wait for any one, compare the return value to (one of) the saved PIDs; the matching one is the winner, the non-matching one is the loser. E. g.:</p>\n\n<pre><code>#define _POSIX_SOURCE\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;signal.h&gt;\n\nint main(int argc, char **argv)\n{\n  if (argc != 3)    // with two program arguments, argc is 3\n    fputs(\"Invalid number of arguments!\\n\", stderr), exit(EXIT_FAILURE);\n  pid_t pid[2];     // to store both child pids\n  pid_t wpid;\n  for (int i = 0; i &lt; 2; i++)\n    if ((pid[i] = fork()) == 0)\n      execl(\"/bin/sh\", \"sh\", \"-c\", argv[i+1], NULL),\n      perror(argv[i+1]), exit(EXIT_FAILURE);\n  wpid = wait(NULL);                    // wait for first\n  int wi = wpid==pid[0] ? 0 : 1;        // get index of winner\n  kill(pid[!wi], SIGKILL), wait(NULL);  // kill and reap loser\n  printf(\"%s finished first!\\n\", argv[wi+1]);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567000485, "creation_date": 1512518241, "last_edit_date": 1512519811, "question_id": 47664647, "link": "https://stackoverflow.com/questions/47664647/c-program-that-tells-the-user-which-child-process-finished-first", "title": "C program that tells the user which child process finished first", "body": "<p>I am working on an assignment that involves using <code>fork</code>. The program runs two separate programs simultaneously and tells the user which one finished first. If a child finishes, the other child still running should be killed immediately.\nMy code so far is this...</p>\n\n<pre><code>int main(int argc, char **argv) {\n\n  if (argc != 2) {\n    perror(\"Invalid number of arguments!\");\n    exit(1);\n  }\n  pid_t pid;\n  pid_t wpid;\n  int status = 0;\n\n  for (int i = 0; i &lt; 2; i++) {\n    if ((pid = fork()) == 0) {\n      execv(\"/bin/sh\", argv[i+1]);\n    } \n  }\n  while ((wpid = wait(&amp;status)) &gt; 0);\n  printf(\"%s finished first!\", &lt;Insert winning program here&gt;);\n  return 0;\n}\n</code></pre>\n\n<p>From my understanding, this runs the programs and will not let the parent process continue until the child processes have finished. Now I'm wondering how I can terminate another child and return the winning process.</p>\n"}, {"tags": ["c", "process", "semaphore", "producer-consumer"], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "is_accepted": true, "score": 0, "last_activity_date": 1512541245, "creation_date": 1512541245, "answer_id": 47668006, "question_id": 47664635, "link": "https://stackoverflow.com/questions/47664635/producer-consumer-semaphore-value-is-not-correct/47668006#47668006", "title": "Producer consumer semaphore value is not correct", "body": "<p>You initialize the \"full\" semaphore to zero.  Your \"child\" producer, prior to exiting calls your <code>sem_post()</code> function, which calls <code>semop()</code> with a <code>SEM_UNDO</code> argument.  </p>\n\n<pre><code>int sem_post(int semid) {\n    printf(\"Someone is posting %d\\n\", semid);\n    struct sembuf sem = { 0, 1, SEM_UNDO };\n    return semop(semid, &amp;sem, 1);\n}\n</code></pre>\n\n<p>The Ubuntu Linux man page for semop says the following about SEM_UNDO:</p>\n\n<blockquote>\n  <p>... If  an  operation  specifies SEM_UNDO, it will be automatically\n  undone when the process terminates.</p>\n</blockquote>\n\n<p>This means, \"producer\" increments \"full\" prior to exiting, then after it exits the system \"undoes\" the increment (i.e. it decrements \"full\") setting it back to zero.  </p>\n\n<p>So,for the purposes of the \"full\" semaphore, you should NOT specify SEM_UNDO.</p>\n"}], "owner": {"reputation": 13, "user_id": 8927414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66ba960675ad6dd029889529762d49c?s=128&d=identicon&r=PG&f=1", "display_name": "beti", "link": "https://stackoverflow.com/users/8927414/beti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 47668006, "answer_count": 1, "score": 0, "last_activity_date": 1512541245, "creation_date": 1512518145, "question_id": 47664635, "link": "https://stackoverflow.com/questions/47664635/producer-consumer-semaphore-value-is-not-correct", "title": "Producer consumer semaphore value is not correct", "body": "<p>I'm trying to implement producer-consumer problem in C using processes and System V IPC and I'm stuck on one thing. This is early version of my code (without implementing queue operations or even producer and consumer executing in loop) that I was using to learn and test how semaphores work: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n#include \"sem.h\"\n#include \"shm.h\"\n\n#define BUFFER_SIZE 9\n\nint full;\nint empty;\nint mutex;\n\nstruct buff {\n    int queue[BUFFER_SIZE];\n} *buffer;\n\nvoid producer();\nvoid consumer();\n\nint main() {\n\n    int parent_pid, pid, i; \n\n    parent_pid = getpid();\n\n    int shmid = allocate_shared_memory(sizeof(*buffer));         \n    buffer = (struct buff *) attach_shared_memory(shmid);\n\n    for (i = 0; i &lt; BUFFER_SIZE; i++) {\n        buffer-&gt;queue[i] = 0;\n    }\n\n    full = sem_allocate();\n    empty = sem_allocate();\n    mutex = sem_allocate();\n\n\n    printf(\"Full %d\\n\", full);\n    printf(\"Empty %d\\n\", empty);\n    printf(\"Mutex %d\\n\", mutex);\n\n\n    sem_init(full, 0);\n    sem_init(empty, BUFFER_SIZE);\n    sem_init(mutex, 1);\n\n\n    printf(\"Full value %d\\n\", sem_get_val(full));\n    printf(\"Empty value %d\\n\", sem_get_val(empty));\n    printf(\"Mutex value %d\\n\", sem_get_val(mutex));\n\n\n    srand(time(0));\n\n    pid = fork();\n    if (!pid) {\n        printf(\"Producer here: %d\\n\", getpid());\n        producer();\n        printf(\"Full value after prod() %d\\n\", sem_get_val(full));\n        return 0;\n    } else printf(\"Created new producent: %d\\n\", pid);\n\n    sleep(1);\n\n    pid = fork();\n    if (!pid) {\n        printf(\"Consumer here: %d\\n\", getpid());\n        printf(\"Full value before cons() %d\\n\", sem_get_val(full)); //here I always get 0\n        consumer();\n        return 0;\n    } else printf(\"Created new consumer: %d\\n\", pid);\n\n       while (1)\n    {\n        int status;\n        pid_t done = wait(&amp;status);\n        if (done == -1)\n        {\n            if (errno == ECHILD) break; // no more child processes\n        }\n        else\n        {\n            if (!WIFEXITED(status) || WEXITSTATUS(status) != 0) {\n                exit(1);\n            }\n        }\n    }\n\n    if (getpid() == parent_pid) {\n        sem_deallocate(full);\n        sem_deallocate(empty);\n        sem_deallocate(mutex);\n    }\n}\n\nvoid producer() {\n\n    sem_wait(empty);\n    sem_wait(mutex);\n    printf(\"Producer is producing!\\n\");\n    buffer-&gt;queue[0]=0;\n    sem_post(mutex);\n    sem_post(full);\n}\n\n\nvoid consumer() {\n\n    sem_wait(full);\n    sem_wait(mutex);\n    printf(\"Consumer is consuming!\\n\");\n    sem_post(mutex);\n    sem_post(empty);\n\n}\n\nint sem_allocate() {\n    return semget(IPC_PRIVATE, 1, IPC_CREAT | 0666);\n}\n\nvoid sem_deallocate(int semid) {\n\n        if (semctl(semid, 0, IPC_RMID, NULL) == -1)\n    {\n        perror(\"Error releasing semaphore!\\n\");\n        exit(EXIT_FAILURE);\n    }\n}\n\nint sem_init(int semid, int value) {\n    union semun arg;\n    arg.val = value;\n    if (semctl(semid, 0, SETVAL, arg) == -1) {\n        perror(\"semctl\");\n        return -1;\n    }else return 1;\n}\n\nint sem_wait(int semid) {\n    printf(\"Someone is waiting %d\\n\", semid);\n    struct sembuf sem = { 0, -1, SEM_UNDO };\n    return semop(semid, &amp;sem, 1);\n}\n\nint sem_post(int semid) {\n    printf(\"Someone is posting %d\\n\", semid);\n    struct sembuf sem = { 0, 1, SEM_UNDO };\n    return semop(semid, &amp;sem, 1);\n}\n\nint sem_get_val(int semid) {\n    return semctl(semid, 0, GETVAL, 0);\n}\n\n\nint allocate_shared_memory(int size) {\n    return shmget(IPC_PRIVATE, size, IPC_CREAT | SHM_W | SHM_R);\n}\n\nvoid deallocate_shared_memory(const void* addr, int shmid) {\n    shmctl(shmid, IPC_RMID, 0);\n}\n\nvoid* attach_shared_memory(int shmid) {\n    return shmat(shmid, NULL, 0);\n}\n</code></pre>\n\n<p>sem.h:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;errno.h&gt;\n\nunion semun {\n    int val;\n    struct semid_ds *buf;\n    ushort* array;\n};\n\n\nint sem_post(int);\n\nint sem_wait(int);\n\nint sem_allocate();\n\nvoid sem_deallocate(int);\n\nint sem_init(int, int);\n\nint sem_get_val(int);\n</code></pre>\n\n<p>shm.h:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt; \n\nint allocate_shared_memory(int size);\n\nvoid deallocate_shared_memory(const void* addr, int shmid);\n\nvoid* attach_shared_memory(int shmid);\n</code></pre>\n\n<p>Why before executing consumer function value of full semaphore is 0? Even if right after producer finishes his job the value is 1...</p>\n\n<p>I'm new to this kind of topics so maybe there is an obvious explenation of the situation, but I have no idea what can I do and hope you can help me.</p>\n"}, {"tags": ["c", "serialization", "struct", "netbios"], "owner": {"reputation": 23, "user_id": 4745192, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9f3ca0f9a56ee955840c59eb9c55dd46?s=128&d=identicon&r=PG&f=1", "display_name": "Chen Hubert", "link": "https://stackoverflow.com/users/4745192/chen-hubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1512520489, "creation_date": 1512516952, "question_id": 47664457, "link": "https://stackoverflow.com/questions/47664457/serialize-netbios-struct-to-send-over-tcp-ip-in-c-possible", "title": "Serialize Netbios struct to send over TCP/IP in C, possible?", "body": "<p>I have 2 machines talking to each other using NetBIOS via NetBEUI. I am in the process of replacing NETBEUI with TCP. I am looking for the easiest and fastest way to do it. There is NetBios over TCP/IP protocol available but for some reason it's not working... I could not figure out why. So now, I am thinking to serialize the NetBIOS struct and send it over to another machine using TCP and de-serialize there. The struct look like below. Will serialize approach work?</p>\n\n<pre><code>typedef struct _NCB {\n    UCHAR   ncb_command;            /* command code                   */\n    UCHAR   ncb_retcode;            /* return code                    */\n    UCHAR   ncb_lsn;                /* local session number           */\n    UCHAR   ncb_num;                /* number of our network name     */\n    PUCHAR  ncb_buffer;             /* address of message buffer      */\n    WORD    ncb_length;             /* size of message buffer         */\n    UCHAR   ncb_callname[NCBNAMSZ]; /* blank-padded name of remote    */\n    UCHAR   ncb_name[NCBNAMSZ];     /* our blank-padded netname       */\n    UCHAR   ncb_rto;                /* rcv timeout/retry count        */\n    UCHAR   ncb_sto;                /* send timeout/sys timeout       */\n    void (CALLBACK *ncb_post)( struct _NCB * );\n    UCHAR   ncb_lana_num;           /* lana (adapter) number          */\n    UCHAR   ncb_cmd_cplt;           /* 0xff =&gt; commmand pending       */\n#ifdef _WIN64\n    UCHAR   ncb_reserve[18];        /* reserved, used by BIOS         */\n#else\n    UCHAR   ncb_reserve[10];        /* reserved, used by BIOS         */\n#endif\n    HANDLE  ncb_event;              /* HANDLE to Win32 event which    */\n                                /* will be set to the signalled   */\n                                /* state when an ASYNCH command   */\n                                /* completes                      */\n} NCB, *PNCB;\n</code></pre>\n"}]