[{"tags": ["c", "mqtt", "mosquitto", "subscriber"], "comments": [{"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1464855654, "post_id": 37579480, "comment_id": 62658197, "body": "I&#39;ve built the code you&#39;ve posted and tested it with <code>mosquitto_pub</code> and it&#39;s all working fine. The sample code prints the received message as soon as it&#39;s published"}, {"owner": {"reputation": 41, "user_id": 2892909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5adac1b98d4a47a1a2131345a663b6?s=128&d=identicon&r=PG&f=1", "display_name": "user2892909", "link": "https://stackoverflow.com/users/2892909/user2892909"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1464973121, "post_id": 37579480, "comment_id": 62722119, "body": "mosquitto_pub sure works fine. But I have a problem when I publish it via the C/C++ code. I would like the publisher and subcriber to be a part of the bigger C++ project I have. Using the C/C++ publisher code would be great. Any ideas?"}, {"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1464977669, "post_id": 37579480, "comment_id": 62724503, "body": "The publish example code works fine as well, it runs, publishes and exits straight away. What platform are you on?"}, {"owner": {"reputation": 41, "user_id": 2892909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5adac1b98d4a47a1a2131345a663b6?s=128&d=identicon&r=PG&f=1", "display_name": "user2892909", "link": "https://stackoverflow.com/users/2892909/user2892909"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1464980064, "post_id": 37579480, "comment_id": 62725655, "body": "Ubuntu 14.04, mosquitto version 1.4.8. (-h localhost, -p 7777). I tried the C/C++ codes with gcc (Pub &amp; Sub), Qt (Pub &amp; Sub), Java (Only Sub)."}, {"owner": {"reputation": 41, "user_id": 2892909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5adac1b98d4a47a1a2131345a663b6?s=128&d=identicon&r=PG&f=1", "display_name": "user2892909", "link": "https://stackoverflow.com/users/2892909/user2892909"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 1, "creation_date": 1465241289, "post_id": 37579480, "comment_id": 62809120, "body": "I got it working. Accidentally I had commented MQTTClientWaitForCompletion() line. Thanks for your help."}], "owner": {"reputation": 41, "user_id": 2892909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5adac1b98d4a47a1a2131345a663b6?s=128&d=identicon&r=PG&f=1", "display_name": "user2892909", "link": "https://stackoverflow.com/users/2892909/user2892909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1042, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1464868643, "creation_date": 1464818281, "last_edit_date": 1464868643, "question_id": 37579480, "link": "https://stackoverflow.com/questions/37579480/mqtt-synchronous-message-reception-at-the-subscriber", "title": "MQTT synchronous message reception at the subscriber", "body": "<p>I have a simple publisher and a subscriber written in C. I am using Paho MQTT libraries and mosquitto broker. I followed the instructions from this site - <a href=\"https://www.eclipse.org/paho/clients/c/\" rel=\"nofollow\">https://www.eclipse.org/paho/clients/c/</a> (The Publisher code is same as in this link)</p>\n\n<p>The Subscriber code in the second file is this -</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"stdlib.h\"\n#include \"string.h\"\n#include \"MQTTClient.h\"\n\n#define ADDRESS     \"tcp://localhost:7777\"\n#define CLIENTID    \"CppClientSub\"\n#define TOPIC       \"MQTT Examples\"\n#define PAYLOAD     \"Hello World!\"\n#define QOS         2\n#define TIMEOUT     10000L\nvolatile int count;\nvolatile MQTTClient_deliveryToken deliveredtoken;\n\nvoid delivered(void *context, MQTTClient_deliveryToken dt) {\n      printf(\"Message with token value %d delivery confirmed\\n\", dt);\n          deliveredtoken = dt;\n}\n\nint msgarrvd(void *context, char *topicName, int topicLen, MQTTClient_message *message) {   \n      int i;\n      char* payloadptr;\n      count = count + 1;\n      printf(\"Message arrived\\n\");\n      printf(\"     topic: %s\\n\", topicName);\n      //printf(\" %d \\n\",count);\n\n      payloadptr = (char*)message-&gt;payload;\n      for(i=0; i&lt;message-&gt;payloadlen; i++) {\n          putchar(*payloadptr++);\n      }\n      putchar('\\n');\n\n      MQTTClient_freeMessage(&amp;message);\n      MQTTClient_free(topicName);\n      return 1;\n}\n\nvoid connlost(void *context, char *cause) {\n      printf(\"\\nConnection lost\\n\");\n      printf(\"     cause: %s\\n\", cause);\n}\n\nint main(int argc, char* argv[]) {\n      count = 0;\n      MQTTClient client;\n      MQTTClient_connectOptions conn_opts = MQTTClient_connectOptions_initializer;\n      int rc;\n      int ch;\n\n      MQTTClient_create(&amp;client, ADDRESS, CLIENTID,\n             MQTTCLIENT_PERSISTENCE_NONE, NULL);\n      conn_opts.keepAliveInterval = 60;\n      conn_opts.cleansession = 0;\n\n      MQTTClient_setCallbacks(client, NULL, connlost, msgarrvd, delivered);\n\n      if ((rc = MQTTClient_connect(client, &amp;conn_opts)) != MQTTCLIENT_SUCCESS)\n      {\n          printf(\"Failed to connect, return code %d\\n\", rc);\n          exit(-1);       \n      }\n      printf(\"Subscribing to topic %s\\nfor client %s using QoS%d\\n\\n\"\n                         \"Press Q&lt;Enter&gt; to quit\\n\\n\", TOPIC, CLIENTID, QOS);\n      MQTTClient_subscribe(client, TOPIC, QOS);\n\n      do {\n          ch = getchar();\n      } while(ch!='Q' &amp;&amp; ch != 'q');\n\n      MQTTClient_disconnect(client, 10000);\n      MQTTClient_destroy(&amp;client);\n      return rc;\n}\n</code></pre>\n\n<p>mosquitto.conf file -</p>\n\n<pre><code>pid_file /var/run/mosquitto.pid\nautosave_interval 100\npersistence true\npersistence_location /var/lib/mosquitto/\npersistence_file mosquitto.db\nconnection_messages true\nlog_timestamp true\nlog_dest stderr\nlog_type error\nlog_type warning\nlog_type_debug\nallow_anonymous false\nprotocol mqtt\nlog_dest file /var/log/mosquitto/mosquitto.log\ninclude_dir /etc/mosquitto/conf.d\n</code></pre>\n\n<p>Problem:- I am able to run the publisher and subscriber code through mosquitto broker. However, subscriber receives the first message when the second message is published, second messaged received when third message is published. When the publisher program is stopped (by like closing the terminal it was running in), the last published message is received at the subscriber. I want the subscriber to receive the message as soon as the broker gets it. I have QoS = 2 in both publisher and subscriber. </p>\n\n<p>Where am I going wrong? Is it got to do with the broker settings? or the way I have setup publisher and subscriber? </p>\n"}, {"tags": ["c", "simgrid"], "answers": [{"tags": [], "owner": {"reputation": 7695, "user_id": 637866, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a566553d97f6cdd46b6de6b26f47374?s=128&d=identicon&r=PG", "display_name": "ysdx", "link": "https://stackoverflow.com/users/637866/ysdx"}, "is_accepted": true, "score": 3, "last_activity_date": 1464818877, "creation_date": 1464818877, "answer_id": 37579586, "question_id": 37579193, "link": "https://stackoverflow.com/questions/37579193/simgrid-create-subprocess-with-argument/37579586#37579586", "title": "SimGrid. Create subprocess with argument", "body": "<p>You have 2 ways to pass arguments to MSG processes:</p>\n\n<ul>\n<li><p>either via the argv;</p></li>\n<li><p>or via the <code>data</code> argument.</p></li>\n</ul>\n\n<h2>Pass the data via <code>argv</code></h2>\n\n<p>In the first solution, you have to create a new <code>argv</code>:</p>\n\n<pre><code>// Create argv for child process\nchar** newargv = xbt_new(char*, 3);\nnewargv[1] = xbt_strdup(\"TS\");\nnewargv[2] = xbt_strdup(argv[0]);\nnewargv[3] = xbt_strdup(argv[0]);\n// Create process with new argv:\nMSG_process_create_with_arguments(\"TS\", subprocess, NULL,     MSG_host_self(), 3, newargv);\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>int subprocess(int argc, char* argv)\n{\n    int num = xbt_str_parse_int(argv[1], \"Invalid argument %s\");\n    int id = xbt_str_parse_int(argv[2], \"Invalid argument %s\");\n    return 0;\n}\n</code></pre>\n\n<h2>Pass the data via <code>data</code></h2>\n\n<p>Another solution is to pass the data using the <code>data</code> parameter:</p>\n\n<pre><code>struct ts_data {\n  int num;\n  int id;\n};\n\nstruct ts_data* data = xbt_new(ts_data, 1);\ndata-&gt;num = xbt_str_parse_int(argv[1], \"Invalid argument %s\");\ndata-&gt;id = xbt_str_parse_int(argv[2], \"Invalid argument %s\");\nMSG_process_create_with_arguments(\"TS\", subprocess, data,     MSG_host_self(), 0, NULL\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>int subprocess(int argc, char* argv)\n{\n    struct ts_data* data = MSG_process_get_data(MSG_process_self());\n    int num = data-&gt;num;\n    int id = data-&gt;id;\n    free(data);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 37579586, "answer_count": 1, "score": 1, "last_activity_date": 1464818877, "creation_date": 1464816945, "question_id": 37579193, "link": "https://stackoverflow.com/questions/37579193/simgrid-create-subprocess-with-argument", "title": "SimGrid. Create subprocess with argument", "body": "<p>I have process declared in <code>main.c</code>:</p>\n\n<pre><code>MSG_function_register(\"dispatcher\", dispatcher);\n</code></pre>\n\n<p>The <code>dispatcher</code> function gets arguments from <code>deployment.xml</code> file:</p>\n\n<pre><code>int num = xbt_str_parse_int(argv[1], \"Invalid argument %s\");\nint id = xbt_str_parse_int(argv[2], \"Invalid argument %s\");\n</code></pre>\n\n<p>Then <code>dispatcher</code> creates a subprocess:</p>\n\n<pre><code>MSG_process_create_with_arguments(\"TS\", subprocess, NULL, MSG_host_self(), agrc, argv);\n</code></pre>\n\n<p>How can I pass <code>num</code> and <code>id</code> to subprocess function?</p>\n\n<pre><code>int subprocess(int argc, char* argv){\n    return 0;\n}\n</code></pre>\n\n<p>How can I call this argv inside from subprocess function?</p>\n"}, {"tags": ["c", "sockets", "google-nativeclient"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1464817007, "post_id": 37579158, "comment_id": 62645323, "body": "You clearly haven&#39;t done your homework. First of all, you need to know why it returned <code>-1</code> by inspecting the value of <code>errno</code> after the call to <code>socket()</code>."}, {"owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1464817171, "post_id": 37579158, "comment_id": 62645388, "body": "<code>socket</code> is a UNIX system call, not really anything to do with google-nativeclient"}, {"owner": {"reputation": 71, "user_id": 6411782, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kbFtmXxc4Hc/AAAAAAAAAAI/AAAAAAAAAcQ/aKpobcQtSBg/photo.jpg?sz=128", "display_name": "Roman Sushinskiy", "link": "https://stackoverflow.com/users/6411782/roman-sushinskiy"}, "edited": false, "score": 0, "creation_date": 1464817414, "post_id": 37579158, "comment_id": 62645485, "body": "errno returns 38(Function not implemented). Can I use socket&#39;s POSIX API of native client?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464817469, "post_id": 37579158, "comment_id": 62645509, "body": "@RomanSushinskiy now you have your answer."}, {"owner": {"reputation": 71, "user_id": 6411782, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kbFtmXxc4Hc/AAAAAAAAAAI/AAAAAAAAAcQ/aKpobcQtSBg/photo.jpg?sz=128", "display_name": "Roman Sushinskiy", "link": "https://stackoverflow.com/users/6411782/roman-sushinskiy"}, "edited": false, "score": 0, "creation_date": 1464817534, "post_id": 37579158, "comment_id": 62645536, "body": "self, does nacl sdk have analog functions for working with sockets?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464817605, "post_id": 37579158, "comment_id": 62645560, "body": "@RomanSushinskiy You really MUST read the documentation."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1464817960, "post_id": 37579158, "comment_id": 62645697, "body": "<a href=\"https://developer.chrome.com/apps/app_network\" rel=\"nofollow noreferrer\">developer.chrome.com/apps/app_network</a>"}, {"owner": {"reputation": 71, "user_id": 6411782, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kbFtmXxc4Hc/AAAAAAAAAAI/AAAAAAAAAcQ/aKpobcQtSBg/photo.jpg?sz=128", "display_name": "Roman Sushinskiy", "link": "https://stackoverflow.com/users/6411782/roman-sushinskiy"}, "edited": false, "score": 0, "creation_date": 1464818246, "post_id": 37579158, "comment_id": 62645796, "body": "jxh, yes, permission section had been added, but it does not help   &quot;permissions&quot;: [     {&quot;fileSystem&quot;: [&quot;write&quot;, &quot;read&quot;]},     &quot;alarms&quot;,     &quot;storage&quot;,     &quot;unlimitedStorage&quot;,     {&quot;sockets&quot;: {                 &quot;tcp&quot;: { &quot;connect&quot; : &quot;<i>:</i>&quot; },                 &quot;udp&quot;: { &quot;connect&quot; : &quot;<i>:</i>&quot; },                 &quot;tcpServer&quot;: { &quot;listen&quot; : &quot;:*&quot; }             }}   ],"}, {"owner": {"reputation": 71, "user_id": 6411782, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kbFtmXxc4Hc/AAAAAAAAAAI/AAAAAAAAAcQ/aKpobcQtSBg/photo.jpg?sz=128", "display_name": "Roman Sushinskiy", "link": "https://stackoverflow.com/users/6411782/roman-sushinskiy"}, "edited": false, "score": 0, "creation_date": 1464818321, "post_id": 37579158, "comment_id": 62645820, "body": "ihabor, I have red the documentation. It says that nacl_io supports POSIX sockets  <a href=\"https://developer.chrome.com/native-client/devguide/coding/nacl_io\" rel=\"nofollow noreferrer\">developer.chrome.com/native-client/devguide/coding/nacl_io</a>"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1464818391, "post_id": 37579158, "comment_id": 62645853, "body": "Please add all the information of what you have tried to get it to work."}, {"owner": {"reputation": 1850, "user_id": 2453058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Y0kT.png?s=128&g=1", "display_name": "binji", "link": "https://stackoverflow.com/users/2453058/binji"}, "edited": false, "score": 0, "creation_date": 1464819341, "post_id": 37579158, "comment_id": 62646213, "body": "What version of the NaCl SDK are you using? Have you tried running the nacl_io_demo example? You can try using sockets there (the connect button)."}, {"owner": {"reputation": 71, "user_id": 6411782, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kbFtmXxc4Hc/AAAAAAAAAAI/AAAAAAAAAcQ/aKpobcQtSBg/photo.jpg?sz=128", "display_name": "Roman Sushinskiy", "link": "https://stackoverflow.com/users/6411782/roman-sushinskiy"}, "edited": false, "score": 0, "creation_date": 1464902851, "post_id": 37579158, "comment_id": 62689560, "body": "Thanks to all, I&#39;ve fixed this problem. I&#39;d forgotten to call nacl_io_init_ppapi function."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 6411782, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kbFtmXxc4Hc/AAAAAAAAAAI/AAAAAAAAAcQ/aKpobcQtSBg/photo.jpg?sz=128", "display_name": "Roman Sushinskiy", "link": "https://stackoverflow.com/users/6411782/roman-sushinskiy"}, "is_accepted": true, "score": 1, "last_activity_date": 1464903124, "creation_date": 1464903124, "answer_id": 37602482, "question_id": 37579158, "link": "https://stackoverflow.com/questions/37579158/socket-function-from-nacl-sdk-returns-1/37602482#37602482", "title": "socket() function from nacl sdk returns -1", "body": "<p>Don't forget to call nacl_io_init_ppapi function</p>\n"}], "owner": {"reputation": 71, "user_id": 6411782, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kbFtmXxc4Hc/AAAAAAAAAAI/AAAAAAAAAcQ/aKpobcQtSBg/photo.jpg?sz=128", "display_name": "Roman Sushinskiy", "link": "https://stackoverflow.com/users/6411782/roman-sushinskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 37602482, "answer_count": 1, "score": 1, "last_activity_date": 1464903124, "creation_date": 1464816812, "last_edit_date": 1464817031, "question_id": 37579158, "link": "https://stackoverflow.com/questions/37579158/socket-function-from-nacl-sdk-returns-1", "title": "socket() function from nacl sdk returns -1", "body": "<p>I have build chrome app with nacl module which calls <code>socket()</code> function, but the function returns -1. I have compiled the module with -lnacl_io linker option. Also I have tried to run Goolgle Chrome with <code>--allow-nacl-socket-api=localhost</code>. I call this function with the next arguments:</p>\n\n<pre><code>socket(AF_INET, SOCK_STREAM, IPPROTO_TCP)\n</code></pre>\n\n<p>Why is this function failed?</p>\n"}, {"tags": ["c++", "c", "arduino", "trigonometry"], "comments": [{"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 1, "creation_date": 1464818277, "post_id": 37578938, "comment_id": 62645809, "body": "It is not clear how microphones are oriented, where they are, why do you expect the voltages to be in this relation to the direction, e.t.c. elaborate please."}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1464870394, "creation_date": 1464870394, "answer_id": 37591851, "question_id": 37578938, "link": "https://stackoverflow.com/questions/37578938/arduino-calculating-the-resultant-direction-of-the-magnitude-of-three-microphon/37591851#37591851", "title": "Arduino, Calculating the resultant direction of the magnitude of three microphones", "body": "<p>Well... I'm not sure but... if you write</p>\n\n<pre><code>//Mic2\nfloat x1 =volts[1]*cos(120.0/360 * 2*Pi);\nfloat y1 =volts[1]*sin(120.0/360 * 2*Pi);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>//Mic3\nfloat x2 =volts[2]*cos(240.0/360 * 2*Pi);\nfloat y2 = volts[2]*sin(240.0/360 * 2*Pi);\n</code></pre>\n\n<p>I suppose that your intention for Mic1 (<code>x0</code> and <code>y0</code>) was</p>\n\n<pre><code>//Mic1\nfloat x0 =volts[0]*cos(0.0/360 * 2*Pi);\nfloat y0 =volts[0]*sin(0.0/360 * 2*Pi);\n</code></pre>\n\n<p>that is</p>\n\n<pre><code>//Mic1\nfloat x0 =volts[0]*cos(0.0);\nfloat y0 =volts[0]*sin(0.0);\n</code></pre>\n\n<p>and, remembering that <code>cos(0.0)</code> is 1 ans <code>sin(0.0)</code> is 0,</p>\n\n<pre><code>//Mic1\nfloat x0 =volts[0];\nfloat y0 =0.0;\n</code></pre>\n\n<p>But in your code I see</p>\n\n<pre><code>//Mic1\nfloat x0 =0;\nfloat y0 =volts[0];\n</code></pre>\n\n<p>Briefly, I suspect you've switched <code>x0</code> with <code>y0</code>.</p>\n\n<p>p.s.: sorry for my bad English.</p>\n"}], "owner": {"reputation": 11, "user_id": 6264231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb8fa9c308f7197c4d3c747d194452d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6264231/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "closed_date": 1465974957, "answer_count": 1, "score": 0, "last_activity_date": 1464870394, "creation_date": 1464815861, "question_id": 37578938, "link": "https://stackoverflow.com/questions/37578938/arduino-calculating-the-resultant-direction-of-the-magnitude-of-three-microphon", "closed_reason": "Needs details or clarity", "title": "Arduino, Calculating the resultant direction of the magnitude of three microphones", "body": "<p>I am trying to calculate the direction where theta is a range from 0 - 2 pi to indicate the direction of the resultant vector of three microphones placed at the 0 degree, 120, and 240 degree marks. All of the microphones are working but somehow I can't seem to get the correct degree values. Can someone look at my code?</p>\n\n<pre><code>void detDirection(){\n\n//Mic1\nfloat x0 =0;\nfloat y0 =volts[0];\n//Serial.println(x0);\n// Serial.println(y0);\n//Mic2\nfloat x1 =volts[1]*cos(120.0/360 * 2*Pi);\nfloat y1 =volts[1]*sin(120.0/360 * 2*Pi);\n// Serial.println(x1);\n//Serial.println(y1);\n//Mic3\nfloat x2 =volts[2]*cos(240.0/360 * 2*Pi);\nfloat y2 = volts[2]*sin(240.0/360 * 2*Pi);\n//Serial.println(x2);\n//Serial.println(y2);\n//Calculate resultant\nfloat sumX = x0 + x1 + x2;\nfloat sumY = y0 + y1 + y2;\n//Serial.println(sumX);\n//Serial.println(sumY);\nfloat resultant = pow(pow(sumX,2)+pow(sumY,2),0.5);\nfloat degree = atan2(sumY,sumX);\nfloat fixDegree= 0 ;\n//Fix degree\nif(!isNeg(sumX) &amp;&amp; !isNeg(sumY)){\n  fixDegree = degree;\n}\nelse if(isNeg(sumX) &amp;&amp; !isNeg(sumY)){\n  fixDegree = Pi - degree;\n}\nelse if(isNeg(sumX) &amp;&amp; isNeg(sumY)){\n  fixDegree = Pi+ degree;\n}\nelse if (!isNeg(sumX) &amp;&amp; isNeg(sumY)){\n  fixDegree = 2*Pi - degree;\n}\n\nString text = \"\";\ntext.concat(resultant);\ntext.concat(\" \");\ntext.concat(fixDegree);\ntext.concat(\" \");\n//Serial.println(text);  \n}\n</code></pre>\n"}, {"tags": ["c", "performance", "cpu", "cpu-cache", "cpu-speed"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464815569, "post_id": 37578851, "comment_id": 62644624, "body": "It doesn&#39;t matter how you split it up, you can&#39;t fit 256 bytes into 64 bytes."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1464815648, "post_id": 37578851, "comment_id": 62644667, "body": "All that matters is that you access the array sequentially, that will minimize cache misses."}, {"owner": {"reputation": 63, "user_id": 6411681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6becd74614e4f918fa11a1054da3974a?s=128&d=identicon&r=PG&f=1", "display_name": "Tunga", "link": "https://stackoverflow.com/users/6411681/tunga"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464816513, "post_id": 37578851, "comment_id": 62645103, "body": "maybe I should have 4 arrays arr1[8], arr2[8], arr3[8], arr4[8] where all fit perfectly into cache line? I want to avoid any access to memory but access the arrays may not be sequentially."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464816606, "post_id": 37578851, "comment_id": 62645143, "body": "You will have to access memory if you go from <code>arr1</code> to <code>arr2</code>, because they can&#39;t both be in the cache line at the same time."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1464816652, "post_id": 37578851, "comment_id": 62645161, "body": "The array already has 4 blocks that fit into cache lines (assuming it is 64-aligned), giving the blocks different names makes no difference."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464816657, "post_id": 37578851, "comment_id": 62645166, "body": "Also, there&#39;s no guarantee that any variable will be aligned at a cache line boundary."}, {"owner": {"reputation": 63, "user_id": 6411681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6becd74614e4f918fa11a1054da3974a?s=128&d=identicon&r=PG&f=1", "display_name": "Tunga", "link": "https://stackoverflow.com/users/6411681/tunga"}, "edited": false, "score": 0, "creation_date": 1464816785, "post_id": 37578851, "comment_id": 62645230, "body": "but my cache L2 has 256kb and L3 has 6Mb so there should be a space to store those arrays."}, {"owner": {"reputation": 573, "user_id": 5286954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1b23933a5228890aeb5964ec54d6be?s=128&d=identicon&r=PG&f=1", "display_name": "Harvey Pham", "link": "https://stackoverflow.com/users/5286954/harvey-pham"}, "edited": false, "score": 0, "creation_date": 1464820275, "post_id": 37578851, "comment_id": 62646545, "body": "In a normal program, you have no control of how memory are cached, so attempt to fit data into cache is useless. 2-D array has the same performance as 1-D array as they are both contiguous memory blocks. Splitting a large array to multiple swap-size arrays at best gives the same performance as the 1 large array, at worst gives worse performance since you might not have contiguous data."}], "answers": [{"comments": [{"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1464831336, "post_id": 37580503, "comment_id": 62649378, "body": "Would add &quot;4. The only thing you can do that&#39;s actually useful is to ensure the start of the array is aligned on a cache line boundary; so that it takes 4 full cache lines, and doesn&#39;t take (e.g.) half a cache line then 3 full cache lines then another half a cache line.&quot;"}, {"owner": {"reputation": 63, "user_id": 6411681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6becd74614e4f918fa11a1054da3974a?s=128&d=identicon&r=PG&f=1", "display_name": "Tunga", "link": "https://stackoverflow.com/users/6411681/tunga"}, "edited": false, "score": 0, "creation_date": 1464855923, "post_id": 37580503, "comment_id": 62658362, "body": "Brendan - how can i do that (to ensure)?"}], "tags": [], "owner": {"reputation": 49428, "user_id": 6210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14994f4fef70636139dfeaf97dca2ef8?s=128&d=identicon&r=PG", "display_name": "MSN", "link": "https://stackoverflow.com/users/6210/msn"}, "is_accepted": false, "score": 1, "last_activity_date": 1464824564, "creation_date": 1464824564, "answer_id": 37580503, "question_id": 37578851, "link": "https://stackoverflow.com/questions/37578851/how-to-store-array-to-fit-cache-line-size/37580503#37580503", "title": "How to store array to fit cache line size", "body": "<ol>\n<li>Your array is 256 bytes, so it will not fit in one 64 byte cache line.</li>\n<li>Splitting your array won't decrease its size, so #1 still applies.</li>\n<li>Your CPU has multiple cache lines, so it's very likely that 256 bytes will fit in whatever cache you are worried about.</li>\n</ol>\n"}], "owner": {"reputation": 63, "user_id": 6411681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6becd74614e4f918fa11a1054da3974a?s=128&d=identicon&r=PG&f=1", "display_name": "Tunga", "link": "https://stackoverflow.com/users/6411681/tunga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464824564, "creation_date": 1464815481, "question_id": 37578851, "link": "https://stackoverflow.com/questions/37578851/how-to-store-array-to-fit-cache-line-size", "title": "How to store array to fit cache line size", "body": "<p>I want to have an array with 32 elements of 64bit numbers like this :\nlong int arr[32];</p>\n\n<p>however my cache line size is 64 bytes. Does it mean my array will not go at all into the cache system or rather some of elements will do?</p>\n\n<p>Would it help to fit cache if I split my array into two-dimensional like this :\nlong int arr[4][8]; ?</p>\n"}, {"tags": ["c", "linux", "ipc", "semaphore", "sysv-ipc"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1464811752, "post_id": 37577824, "comment_id": 62642634, "body": "<code>man semctl</code>: <i>[...]When there are four, the fourth has the type union semun.  The  calling  program  must define this union as follows:             union semun {                int              val;    /</i> Value for SETVAL <i>/                struct semid_ds *buf;    /</i> Buffer for IPC_STAT, IPC_SET <i>/                unsigned short  *array;  /</i> Array for GETALL, SETALL <i>/                struct seminfo  *__buf;  /</i> Buffer for IPC_INFO                                            (Linux-specific) <i>/            };</i>"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464812026, "post_id": 37577824, "comment_id": 62642766, "body": "@EOF - that&#39;s an answer, not a comment (and now AndrewHenle has it as an answer)"}], "answers": [{"comments": [{"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1464815196, "post_id": 37577959, "comment_id": 62644455, "body": "Do you know what the rationale is for making the program declare <code>union semun</code>, rather than simply having it declared in a standard header like <code>&lt;sys&#47;sem.h&gt;</code>?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1464863606, "post_id": 37577959, "comment_id": 62663741, "body": "@NateEldredge The only reason I can think of is that by the time the call was standardized, too much legacy code would have been broken."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 4, "last_activity_date": 1464812071, "creation_date": 1464812071, "answer_id": 37577959, "question_id": 37577824, "link": "https://stackoverflow.com/questions/37577824/linux-system-v-ipc-unable-to-initialize-semaphore-value/37577959#37577959", "title": "Linux System V IPC: Unable to initialize semaphore value", "body": "<p>You have to explicitly declare <code>union semun</code> yourself.</p>\n\n<p>Per the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/semctl.html\" rel=\"nofollow\">POSIX standard for <code>semctl()</code></a>:</p>\n\n<blockquote>\n  <p>The semctl() function provides a variety of semaphore control\n  operations as specified by cmd. The fourth argument is optional and\n  depends upon the operation requested. If required, it is of type\n  <code>union semun</code>, <strong>which the application shall explicitly declare</strong>:</p>\n\n<pre><code>union semun {\n    int val;\n    struct semid_ds *buf;\n    unsigned short  *array;\n} arg;\n</code></pre>\n</blockquote>\n\n<p>Per the <a href=\"http://man7.org/linux/man-pages/man2/semctl.2.html\" rel=\"nofollow\">Linux man page</a>:</p>\n\n<blockquote>\n  <p>This function has three or four arguments, depending on <code>cmd</code>.  When\n         there are four, the fourth has the type <code>union semun</code>.  The calling\n         <em>program</em> must define this union as follows:</p>\n\n<pre><code>   union semun {\n       int              val;    /* Value for SETVAL */\n       struct semid_ds *buf;    /* Buffer for IPC_STAT, IPC_SET */\n       unsigned short  *array;  /* Array for GETALL, SETALL */\n       struct seminfo  *__buf;  /* Buffer for IPC_INFO\n                                   (Linux-specific) */\n   };\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 6795, "user_id": 1460665, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/o8b6s.jpg?s=128&g=1", "display_name": "Insane Coder", "link": "https://stackoverflow.com/users/1460665/insane-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1282, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1464815078, "creation_date": 1464811587, "last_edit_date": 1464815078, "question_id": 37577824, "link": "https://stackoverflow.com/questions/37577824/linux-system-v-ipc-unable-to-initialize-semaphore-value", "title": "Linux System V IPC: Unable to initialize semaphore value", "body": "<p>I have created a simple semaphore initialization example for demo purpose: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint init_semaphore(int semid, int semnum, int initval)\n{\n    union semun pack;\n    pack.val = initval;\n    return semctl(semid,semnum,SETVAL,pack);\n}\n</code></pre>\n\n<p>But I am getting the error: </p>\n\n<pre><code>error: aggregate \u2018init_semaphore(int, int, int)::semun pack\u2019 has incomplete type and cannot be defined\n</code></pre>\n\n<p>I am not able to understand why the compiler is throwing the error. The headers are also included properly.</p>\n"}, {"tags": ["c", "recursion", "stack-overflow"], "comments": [{"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 0, "creation_date": 1464811215, "post_id": 37577522, "comment_id": 62642330, "body": "I had similar situations solved by changing my base condition. If you have a stackoverflow in your recursion, it could be because of your base condition. If I were you, I&#39;d check my base condition and debug which conditions the code reaches."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464815161, "post_id": 37577522, "comment_id": 62644437, "body": "In the <code>if(n == NULL)</code> case you never initiailize <code>n-&gt;center_x</code> or <code>n-&gt;center_y</code> or <code>n-&gt;m</code> in the new node, but your <code>quadtree_calculate_forcey</code> function seems to read and compare those values"}, {"owner": {"reputation": 13, "user_id": 6411412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077059457c1a529a0c2a54eaaeb6f190?s=128&d=identicon&r=PG&f=1", "display_name": "radnaskela", "link": "https://stackoverflow.com/users/6411412/radnaskela"}, "edited": false, "score": 0, "creation_date": 1464817957, "post_id": 37577522, "comment_id": 62645695, "body": "Its done in other functions before the call to forcey, since center is supposed to be mass-center we need the particles to be in the correct places. An example is above."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1464821806, "post_id": 37577522, "comment_id": 62647071, "body": "Hmmm...did you forget to specify that the positions of the particles are inside the unit square (bottom-left corner at the origin, top-right at (1,1))?  That&#39;s the trouble with magic numbers; there&#39;s nothing to explain what they mean."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1464816198, "post_id": 37578600, "comment_id": 62644940, "body": "Do note that the &quot;repeated&quot; code is the same in <i>form</i>, but not in detail. That is, fragment 1B uses <code>n-&gt;p</code> where fragment 1A uses <code>p</code>.  I think this is purposeful: the idea seems to be to force all data (the <code>Particle</code>s) out to leaf nodes."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1464816497, "post_id": 37578600, "comment_id": 62645093, "body": "@JohnBollinger: you might be right, but then the bug is in that code.  I&#39;m not sufficiently sure what the quadtree should look like \u2014 there&#39;s no information in the question.  The two lots of recursion for the same particle looks kinda odd.  I&#39;ve not established enough diagnostic tracing to tell what&#39;s going on in the crash case versus the non-crash case.  The problem isn&#39;t &quot;out of heap space&quot;, there&#39;s only 6 MiB allocated when the crash occurs."}, {"owner": {"reputation": 13, "user_id": 6411412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077059457c1a529a0c2a54eaaeb6f190?s=128&d=identicon&r=PG&f=1", "display_name": "radnaskela", "link": "https://stackoverflow.com/users/6411412/radnaskela"}, "edited": false, "score": 0, "creation_date": 1464817845, "post_id": 37578600, "comment_id": 62645651, "body": "That piece of advice about the code was brilliant, next time ill make sure to follow through!  Its exactly like John says, every particle should occupy one end-node. My suspicions say its to do with the movement, and planets aligning so that a ridiculous number of iterations have to be done to open two free squares. I&#39;m unable to see a solution to my problem though, any thoughts?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1464820279, "post_id": 37578600, "comment_id": 62646549, "body": "@JonathanLeffler, I&#39;m learning quadtree on the fly, but I think I&#39;ve identified the problem.  It is, of course, related to the near-duplicate code, just as you say."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 13, "user_id": 6411412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077059457c1a529a0c2a54eaaeb6f190?s=128&d=identicon&r=PG&f=1", "display_name": "radnaskela", "link": "https://stackoverflow.com/users/6411412/radnaskela"}, "edited": false, "score": 0, "creation_date": 1464820305, "post_id": 37578600, "comment_id": 62646559, "body": "@radnaskela: See the updated material.  Use my data set; it goes wrong quickly (you said yours takes several hundred entries to go wrong)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1464820436, "post_id": 37578600, "comment_id": 62646601, "body": "@JohnBollinger: I&#39;ve not yet gone to study quadtree theory, so you&#39;re a step ahead of me.  To a large extent, I think I&#39;ve identified where the problem is \u2014 how it should be resolved is mostly radnaskela&#39;s problem. <i>[\u2026time passes\u2026]</i> Wikipedia on <a href=\"https://en.wikipedia.org/wiki/Quadtree\" rel=\"nofollow noreferrer\">quadtree</a> \u2014 I think this is a point quadtree, isn&#39;t it?"}, {"owner": {"reputation": 13, "user_id": 6411412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077059457c1a529a0c2a54eaaeb6f190?s=128&d=identicon&r=PG&f=1", "display_name": "radnaskela", "link": "https://stackoverflow.com/users/6411412/radnaskela"}, "edited": false, "score": 0, "creation_date": 1464823444, "post_id": 37578600, "comment_id": 62647549, "body": "Thank you for the help, Jonathan! Im ridiculously impressed by your ability to break down the problem, hope all your future endeavours succeed. I can also add that you two have taught me more than the past month of random reading about C!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 13, "user_id": 6411412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077059457c1a529a0c2a54eaaeb6f190?s=128&d=identicon&r=PG&f=1", "display_name": "radnaskela", "link": "https://stackoverflow.com/users/6411412/radnaskela"}, "edited": false, "score": 0, "creation_date": 1464823679, "post_id": 37578600, "comment_id": 62647615, "body": "@radnaskela: You&#39;re welcome. More than anything else, I hope you learned a bit about how to go about debugging such problems. Granted, <code>printf()</code> statements aren&#39;t the only way to debug code \u2014 another is to use a debugger \u2014 but they do have merits. Tracking what is going on by judiciously placed print operations can really help. (See also <a href=\"https://stackoverflow.com/questions/1644868\">C <code>#define</code> macro for debug printing</a>.)  But since John Bollinger did the grunt-work of getting the code to work \u2014 rather than just diagnosing where the problem is \u2014 you&#39;re absolutely correct to accept his answer."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 3, "last_activity_date": 1464819775, "last_edit_date": 1495542693, "creation_date": 1464814499, "answer_id": 37578600, "question_id": 37577522, "link": "https://stackoverflow.com/questions/37577522/stack-overflow-using-recursion-in-c/37578600#37578600", "title": "Stack-overflow using recursion in C", "body": "<h3>Partial analysis</h3>\n\n<p>I'm tolerably certain the trouble is primarily due to the bulk repeated code (near to repeated code) in the primary <code>else</code> clause of <code>quadtree_insert()</code>.  I've marked the starts with comments saying <code>Fragment 1A</code> and <code>Fragment 1B</code> \u2014 and Fragment 1B is now also framed with <code>#ifdef DO_REPEAT</code> and <code>#endif</code>.</p>\n\n<pre><code>    else\n    {\n        /* Fragment 1A */\n        // n = (node*)malloc(sizeof(node));\n        double x;\n        double y;\n        if (width &lt; 1e-300)\n        {\n            width = 1e-300;\n        }\n        if (n-&gt;is_leaf == 1) // ! that is, if the node is not a branch\n        {\n            x = (double)n-&gt;p-&gt;x_pos;\n            y = (double)n-&gt;p-&gt;y_pos;\n\n            if (x &lt;= center_x &amp;&amp; y &lt;= center_y) // ! first quadrant\n            {\n                n-&gt;sw = quadtree_insert(n-&gt;sw, n-&gt;p, center_x * 0.5, center_y * 0.5, width * 0.5);\n            }\n            else if (x &lt;= center_x &amp;&amp; y &gt; center_y) // ! second quadrant\n            {\n                n-&gt;nw = quadtree_insert(n-&gt;nw, n-&gt;p, center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n            }\n            else if (x &gt; center_x &amp;&amp; y &lt;= center_y) // ! third quadrant\n            {\n                n-&gt;se = quadtree_insert(n-&gt;se, n-&gt;p, center_x + center_x * 0.5, center_y * 0.5, width * 0.5);\n            }\n            else // ! fourth quadrant\n            {\n                n-&gt;ne = quadtree_insert(n-&gt;ne, n-&gt;p, center_x + center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n            }\n\n            n-&gt;p = NULL; // ! sets branch pointer to nothing...\n            n-&gt;is_leaf = 0;\n        }\n\n#ifdef DO_REPEAT\n        /* Fragment 1B */\n        x = (double)p-&gt;x_pos;\n        y = (double)p-&gt;y_pos;\n\n        if (x &lt;= center_x &amp;&amp; y &lt;= center_y) // ! first quadrant\n        {\n            n-&gt;sw = quadtree_insert(n-&gt;sw, p, center_x * 0.5, center_y * 0.5, width * 0.5);\n        }\n        else if (x &lt;= center_x &amp;&amp; y &gt; center_y) // ! second quadrant\n        {\n            n-&gt;nw = quadtree_insert(n-&gt;nw, p, center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n        }\n        else if (x &gt; center_x &amp;&amp; y &lt;= center_y) // ! third quadrant\n        {\n            n-&gt;se = quadtree_insert(n-&gt;se, p, center_x + center_x * 0.5, center_y * 0.5, width * 0.5);\n        }\n        else // ! fourth quadrant\n        {\n            n-&gt;ne = quadtree_insert(n-&gt;ne, p, center_x + center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n        }\n#endif /* DO_REPEAT */\n        return n;\n    }\n</code></pre>\n\n<p>I took your code and reordered some of the fragments, and used this <code>main()</code>.  Note that I should not have needed to do this; you should have produced an MCVE (<a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable Example?</a>) or SSCCE (<a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">Short, Self-Contained, Correct Example</a>) \u2014 two names and links for the same basic idea.</p>\n\n<pre><code>static struct Particle particles[] =\n{\n    {  19.99,  96.07,  62.79, -99.46,  19.70 },\n    {  12.94,   1.43, -33.45,  31.80, -66.08 },\n    {   6.49,  16.99, -20.83,  92.51,  35.98 },\n    {  17.01, -28.85, -94.10,  42.82,  -1.30 },\n    {  14.27,  85.07,  88.21,  11.22,  16.85 },\n    {  15.73, -56.37,  46.85,  27.40, -15.15 },\n    {   1.53, -49.44, -64.27, -29.45, -38.25 },\n    {   8.03,  92.11, -47.50,  63.77, -29.99 },\n    {   8.67, -99.81,  73.19,  18.75,  88.66 },\n    {  16.36,  66.33,  14.23,  87.65,  40.01 },\n};\n\nenum { nParticles = sizeof(particles) / sizeof(particles[0]) };\n\nint main(void)\n{\n    node *root = NULL;\n    printf(\"Particle 0:\\n\");\n    root = quadtree_insert(root, &amp;particles[0], 0.500, 0.5, 1);\n\n    for (int i = 1; i &lt; nParticles; i++)\n    {\n        printf(\"Particle %d:\\n\", i);\n        quadtree_insert(root, &amp;particles[i], 0.5000, 0.5, 1);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I used a random number generator for the table of values:</p>\n\n<pre><code>random -n 10 -T '    { %6:2[1:20]f, %6:2[-100:100]f, %6:2[-100:100]f, %6:2[-100:100]f, %6:2[-100:100]f },'\n</code></pre>\n\n<p>It crashed for me on Particle 6.  In outline, <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\"><code>valgrind</code></a> said:</p>\n\n<pre><code>\u2026startup blurb omitted\u2026\nParticle 0:\nParticle 1:\nParticle 2:\nParticle 3:\nParticle 4:\nParticle 5:\nParticle 6:\n==79528== \n==79528== Process terminating with default action of signal 11 (SIGSEGV)\n==79528==  Access not within mapped region at address 0x104003FD0\n==79528==    at 0x100008E39: malloc (vg_replace_malloc.c:302)\n==79528==  If you believe this happened as a result of a stack\n==79528==  overflow in your program's main thread (unlikely but\n==79528==  possible), you can try to increase the size of the\n==79528==  main thread stack using the --main-stacksize= flag.\n==79528==  The main thread stack size used in this run was 8388608.\n==79528== \n==79528== HEAP SUMMARY:\n==79528==     in use at exit: 6,017,700 bytes in 75,080 blocks\n==79528==   total heap usage: 75,162 allocs, 82 frees, 6,023,876 bytes allocated\n==79528== \n==79528== LEAK SUMMARY:\n==79528==    definitely lost: 4,120 bytes in 2 blocks\n==79528==    indirectly lost: 2,288 bytes in 6 blocks\n==79528==      possibly lost: 4,880 bytes in 45 blocks\n==79528==    still reachable: 5,997,720 bytes in 74,904 blocks\n==79528==         suppressed: 8,692 bytes in 123 blocks\n==79528== Rerun with --leak-check=full to see details of leaked memory\n</code></pre>\n\n<p>Even on a Mac where I ran it, that indicates problems; the suppressed stuff is OK, but the rest is mostly not.</p>\n\n<p>When compiled without <code>-DDO_REPEAT</code> (a normal compilation), the sample program runs to completion.  It leaks, of course, because there's no code to free the memory.</p>\n\n<pre><code>Particle 0:\nParticle 1:\nParticle 2:\nParticle 3:\nParticle 4:\nParticle 5:\nParticle 6:\nParticle 7:\nParticle 8:\nParticle 9:\n==79683== \n==79683== HEAP SUMMARY:\n==79683==     in use at exit: 26,580 bytes in 191 blocks\n==79683==   total heap usage: 273 allocs, 82 frees, 32,756 bytes allocated\n==79683== \n==79683== LEAK SUMMARY:\n==79683==    definitely lost: 4,200 bytes in 3 blocks\n==79683==    indirectly lost: 2,368 bytes in 7 blocks\n==79683==      possibly lost: 4,880 bytes in 45 blocks\n==79683==    still reachable: 6,440 bytes in 13 blocks\n==79683==         suppressed: 8,692 bytes in 123 blocks\n==79683== Rerun with --leak-check=full to see details of leaked memory\n</code></pre>\n\n<p>Note that there's dramatically less memory in use than before.</p>\n\n<p>If the code eliminated by the absence of <code>DO_REPEAT</code> is in fact crucial, then the bug either lies in that code, or lies in the setup work done in Fragment 1A.  However, inserting the same particle twice with the recursive calls seems likely to me to be the source of the trouble.</p>\n\n<p>I also note that the <code>quadtree_calculate_forcey()</code> function isn't used in the code; it is definitely not a part of the MCVE.</p>\n\n<hr>\n\n<h3>Fragment 1B is needed</h3>\n\n<p><a href=\"https://stackoverflow.com/users/2402272/john-bollinger\">John Bollinger</a> suggested:</p>\n\n<blockquote>\n  <p>Do note that the \"repeated\" code is the same in form, but not in detail. That is, fragment 1B uses <code>n-&gt;p</code> where fragment 1A uses <code>p</code>. I think this is purposeful: the idea seems to be to force all data (the Particles) out to leaf nodes.</p>\n</blockquote>\n\n<p>and <a href=\"https://stackoverflow.com/users/6411412/radnaskela\">radnaskela</a> affirmed:</p>\n\n<blockquote>\n  <p>It's exactly like John says, every particle should occupy one end-node. My suspicions say its to do with the movement, and planets aligning so that a ridiculous number of iterations have to be done to open two free squares. I'm unable to see a solution to my problem though, any thoughts?</p>\n</blockquote>\n\n<p>There is a problem with the logic, though I'm not entirely sure what that problem is.  The first step I'd do is to add some instrumentation to the code in <code>quadtree_insert()</code>, like this:</p>\n\n<pre><code>static node *quadtree_insert(node *n, struct Particle *p, double center_x, double center_y, double width)\n{\n    printf(\"Centre (X,Y) = (%6.2f,%6.2f)\\n\", center_x, center_y);\n    if (n == NULL)\n    {\n        n = (node *)malloc(sizeof(node));\n        n-&gt;is_leaf = 1;\n\n        n-&gt;p = p;\n        // n-&gt;m = 0.1;\n\n        n-&gt;sw = NULL;\n        n-&gt;se = NULL;\n        n-&gt;nw = NULL;\n        n-&gt;ne = NULL;\n        if (width &lt; 1e-300)\n        {\n            n-&gt;width = 1e-300;\n        }\n        else\n            n-&gt;width    = width;\n        return n;\n    }\n    else\n    {\n        // n = (node*)malloc(sizeof(node));\n        double x;\n        double y;\n        if (width &lt; 1e-300)\n        {\n            width = 1e-300;\n        }\n        if (n-&gt;is_leaf == 1) // ! that is, if the node is not a branch\n        {\n            x = (double)n-&gt;p-&gt;x_pos;\n            y = (double)n-&gt;p-&gt;y_pos;\n\n            if (x &lt;= center_x &amp;&amp; y &lt;= center_y) // ! first quadrant\n            {\n                printf(\"Recurse SW 1: \");\n                n-&gt;sw = quadtree_insert(n-&gt;sw, n-&gt;p, center_x * 0.5, center_y * 0.5, width * 0.5);\n            }\n            else if (x &lt;= center_x &amp;&amp; y &gt; center_y) // ! second quadrant\n            {\n                printf(\"Recurse NW 1: \");\n                n-&gt;nw = quadtree_insert(n-&gt;nw, n-&gt;p, center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n            }\n            else if (x &gt; center_x &amp;&amp; y &lt;= center_y) // ! third quadrant\n            {\n                printf(\"Recurse SE 1: \");\n                n-&gt;se = quadtree_insert(n-&gt;se, n-&gt;p, center_x + center_x * 0.5, center_y * 0.5, width * 0.5);\n            }\n            else // ! fourth quadrant\n            {\n                printf(\"Recurse NE 1: \");\n                n-&gt;ne = quadtree_insert(n-&gt;ne, n-&gt;p, center_x + center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n            }\n\n            n-&gt;p = NULL; // ! sets branch pointer to nothing...\n            n-&gt;is_leaf = 0;\n        }\n\n        x = (double)p-&gt;x_pos;\n        y = (double)p-&gt;y_pos;\n\n        if (x &lt;= center_x &amp;&amp; y &lt;= center_y) // ! first quadrant\n        {\n            printf(\"Recurse SW 2: \");\n            n-&gt;sw = quadtree_insert(n-&gt;sw, p, center_x * 0.5, center_y * 0.5, width * 0.5);\n        }\n        else if (x &lt;= center_x &amp;&amp; y &gt; center_y) // ! second quadrant\n        {\n            printf(\"Recurse NW 2: \");\n            n-&gt;nw = quadtree_insert(n-&gt;nw, p, center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n        }\n        else if (x &gt; center_x &amp;&amp; y &lt;= center_y) // ! third quadrant\n        {\n            printf(\"Recurse SE 2: \");\n            n-&gt;se = quadtree_insert(n-&gt;se, p, center_x + center_x * 0.5, center_y * 0.5, width * 0.5);\n        }\n        else // ! fourth quadrant\n        {\n            printf(\"Recurse NE 2: \");\n            n-&gt;ne = quadtree_insert(n-&gt;ne, p, center_x + center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n        }\n        return n;\n    }\n}\n</code></pre>\n\n<p>When run with the 10-point data set, the output up to Particle 5 is:</p>\n\n<pre><code>Particle 0: Centre (X,Y) = (  0.50,  0.50)\nParticle 1: Centre (X,Y) = (  0.50,  0.50)\nRecurse NE 1: Centre (X,Y) = (  0.75,  0.75)\nRecurse SE 2: Centre (X,Y) = (  0.75,  0.25)\nParticle 2: Centre (X,Y) = (  0.50,  0.50)\nRecurse SE 2: Centre (X,Y) = (  0.75,  0.25)\nRecurse SE 1: Centre (X,Y) = (  1.12,  0.12)\nRecurse SE 2: Centre (X,Y) = (  1.12,  0.12)\nRecurse SE 1: Centre (X,Y) = (  1.69,  0.06)\nRecurse SE 2: Centre (X,Y) = (  1.69,  0.06)\nRecurse SW 1: Centre (X,Y) = (  0.84,  0.03)\nRecurse SE 2: Centre (X,Y) = (  2.53,  0.03)\nParticle 3: Centre (X,Y) = (  0.50,  0.50)\nRecurse SW 2: Centre (X,Y) = (  0.25,  0.25)\nParticle 4: Centre (X,Y) = (  0.50,  0.50)\nRecurse NE 2: Centre (X,Y) = (  0.75,  0.75)\nRecurse NE 1: Centre (X,Y) = (  1.12,  1.12)\nRecurse NE 2: Centre (X,Y) = (  1.12,  1.12)\nRecurse NE 1: Centre (X,Y) = (  1.69,  1.69)\nRecurse NE 2: Centre (X,Y) = (  1.69,  1.69)\nRecurse NE 1: Centre (X,Y) = (  2.53,  2.53)\nRecurse NE 2: Centre (X,Y) = (  2.53,  2.53)\nRecurse NE 1: Centre (X,Y) = (  3.80,  3.80)\nRecurse NE 2: Centre (X,Y) = (  3.80,  3.80)\nRecurse NE 1: Centre (X,Y) = (  5.70,  5.70)\nRecurse NE 2: Centre (X,Y) = (  5.70,  5.70)\nRecurse NE 1: Centre (X,Y) = (  8.54,  8.54)\nRecurse NE 2: Centre (X,Y) = (  8.54,  8.54)\nRecurse NE 1: Centre (X,Y) = ( 12.81, 12.81)\nRecurse NE 2: Centre (X,Y) = ( 12.81, 12.81)\nRecurse NE 1: Centre (X,Y) = ( 19.22, 19.22)\nRecurse NE 2: Centre (X,Y) = ( 19.22, 19.22)\nRecurse NE 1: Centre (X,Y) = ( 28.83, 28.83)\nRecurse NE 2: Centre (X,Y) = ( 28.83, 28.83)\nRecurse NE 1: Centre (X,Y) = ( 43.25, 43.25)\nRecurse NE 2: Centre (X,Y) = ( 43.25, 43.25)\nRecurse NE 1: Centre (X,Y) = ( 64.87, 64.87)\nRecurse NE 2: Centre (X,Y) = ( 64.87, 64.87)\nRecurse SE 1: Centre (X,Y) = ( 97.31, 32.44)\nRecurse NE 2: Centre (X,Y) = ( 97.31, 97.31)\nParticle 5: Centre (X,Y) = (  0.50,  0.50)\nRecurse NW 2: Centre (X,Y) = (  0.25,  0.75)\n</code></pre>\n\n<p>I'm a bit surprised by some of the processing there, and the number of entries for Particle 4.  That may be indicative of the problem.</p>\n\n<p>And then it processes Particle 6:</p>\n\n<pre><code>Particle 6: Centre (X,Y) = (  0.50,  0.50)\nRecurse SW 2: Centre (X,Y) = (  0.25,  0.25)\nRecurse SW 1: Centre (X,Y) = (  0.12,  0.12)\nRecurse SW 2: Centre (X,Y) = (  0.12,  0.12)\nRecurse SW 1: Centre (X,Y) = (  0.06,  0.06)\nRecurse SW 2: Centre (X,Y) = (  0.06,  0.06)\nRecurse SW 1: Centre (X,Y) = (  0.03,  0.03)\nRecurse SW 2: Centre (X,Y) = (  0.03,  0.03)\nRecurse SW 1: Centre (X,Y) = (  0.02,  0.02)\nRecurse SW 2: Centre (X,Y) = (  0.02,  0.02)\nRecurse SW 1: Centre (X,Y) = (  0.01,  0.01)\nRecurse SW 2: Centre (X,Y) = (  0.01,  0.01)\nRecurse SW 1: Centre (X,Y) = (  0.00,  0.00)\nRecurse SW 2: Centre (X,Y) = (  0.00,  0.00)\nRecurse SW 1: Centre (X,Y) = (  0.00,  0.00)\nRecurse SW 2: Centre (X,Y) = (  0.00,  0.00)\nRecurse SW 1: Centre (X,Y) = (  0.00,  0.00)\nRecurse SW 2: Centre (X,Y) = (  0.00,  0.00)\n</code></pre>\n\n<p>It gets very tedious from there onwards.  The question that you need to ask is \"what should be happening with that point\"?  It would probably be a good idea to have a function to dump the quadtree structure, too.</p>\n\n<p>This basically suggests that you have not yet analyzed the conditions under which the points are to be added sufficiently.  I'm not clear why you multiply the center coordinates by 1.5 when the insertion is in the SE or NE quadrants and by 0.5 when in the SW or NW quadrants (nor why you use the add plus multiply rather than simply multiply).</p>\n\n<p>The test on <code>width</code> less than <code>1e-300</code> is mildly worrying.  Given that you call the function with the value <code>1.0</code>, it takes a while to get that small when you halve the width each time you recurse.</p>\n\n<p>Better tracing might well report on the values of <code>x</code> and <code>y</code> as well as the centre coordinate.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6411412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077059457c1a529a0c2a54eaaeb6f190?s=128&d=identicon&r=PG&f=1", "display_name": "radnaskela", "link": "https://stackoverflow.com/users/6411412/radnaskela"}, "edited": false, "score": 0, "creation_date": 1464823336, "post_id": 37579786, "comment_id": 62647514, "body": "You, my dear sir, will be knighted if I ever get the pleasure to be king of something. The moral of this story is that years of preparation cannot prepare me for the simplest things. I changed the conditions for centers and voil&#225;, like the sweetest rain of tasty barley from clear blue sky, shit just worked! If I ever get the pleasure of meeting you I&#39;ll probably kiss you, guess perhaps we&#39;ll both rue the day but still.  All your points have been taken, and had been considered. Gut feeling told me it was something sillier, just didn&#39;t realize how silly."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1464819979, "creation_date": 1464819979, "answer_id": 37579786, "question_id": 37577522, "link": "https://stackoverflow.com/questions/37577522/stack-overflow-using-recursion-in-c/37579786#37579786", "title": "Stack-overflow using recursion in C", "body": "<p>I see several problems with your code.</p>\n\n<hr>\n\n<p>In the first place, you have a near-duplication of a sizable block of non-trivial code.  The two blocks seem to differ only in which <code>Particle</code> they reference; this begs to be factored out into a helper function.</p>\n\n<hr>\n\n<p>In the second place, consider this fragment:</p>\n\n<blockquote>\n<pre><code>else if (x &lt;= center_x &amp;&amp; y &gt; center_y) // ! second quadrant\n{\n    n-&gt;nw = quadtree_insert(n-&gt;nw, n-&gt;p, center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n}\n</code></pre>\n</blockquote>\n\n<p>I take the input <code>center_x</code> and <code>center_y</code> to be the center of a square patch of the overall area, and <code>width</code> to be the edge length for that patch.  In that case, the center of the northwest quadrant of the patch is (<code>center_x - width * 0.25</code>, <code>center_y + width * 0.25</code>).  Only in certain special cases will that coincide with the computation in your recursive call.  You actually can determine the width of the patch from the coordinates of its center, but not so directly as you're trying to do.</p>\n\n<p>Similar applies to all seven of the other recursive calls.</p>\n\n<hr>\n\n<p>In the third place, consider what happens if you end up with two particles that have very similar -- or worse, identical -- coordinates.  They can be the only two in the simulation.</p>\n\n<p>The first particle initially gets positioned in a node representing the whole simulation area.  When the second is inserted, the quadtree is traversed to the same node.  The original particle is therefore moved to a newly created quadrant of the original node's area, and the insertion process for second node resumes.  But the insertion then <em>again</em> reaches the same node that the original particle occupies, and the process repeats.  And maybe it repeats again.  And again.</p>\n\n<p>There is therefore no definite bound to your recursion.  If you happen to end up with two particles with identical coordinates -- for example, maybe they are pinned to the corner of the simulation area -- then the you will definitely recurse endlessly, eventually producing a stack overflow.  Even if no two particles have identical coordinates, however, it is conceivable that two will be close enough together for the recursion to go deep enough for a stack overflow.</p>\n\n<p>I suspect that this problem is aggravated by the previous issue, but it does not depend on that issue.</p>\n\n<p>One way to approach this problem would be to merge particles that come close enough together.  That would allow you to place a firm bound on the recursion depth, based on the patch width.  Alternatively, you may abort if recursion goes too deep.  Or, you could just let it crash in that case, as it already does.</p>\n\n<hr>\n\n<p>For what it's worth, here's how I think your <code>quadtree_insert()</code> ought to look:</p>\n\n<pre><code>// adjust as needed:\n#define MIN_PARTICLE_SEPARATION 1e-300\n\nvoid quadtree_insert_helper(node *n, Particle *p, double center_x,\n        double center_y, double width) {\n    width *= 0.5;\n\n    double new_center_x = center_x\n            + width * ((p-&gt;x_pos &lt;= center_x) ? -0.5 : 0.5);\n    double new_center_y = center_y\n            + width * ((p-&gt;y_pos &lt;= center_y) ? -0.5 : 0.5);\n    node **quad;\n\n    if (new_center_x &lt;= center_x &amp;&amp; new_center_y &lt;= center_y) {\n        //! first quadrant\n        quad = &amp;n-&gt;sw;\n    } else if (new_center_x &lt;= center_x &amp;&amp; new_center_y &gt; center_y) {\n        //! second quadrant\n        quad = &amp;n-&gt;nw;\n    } else if (new_center_x &gt; center_x &amp;&amp; new_center_y &lt;= center_y) {\n        //! third quadrant\n        quad = &amp;n-&gt;se;\n    } else {\n        //! fourth quadrant\n        quad = &amp;n-&gt;ne;\n    }\n    *quad = quadtree_insert(*quad, p, new_center_x, new_center_y, width);\n}\n\nnode* quadtree_insert(node *n, struct Particle *p, double center_x,\n        double center_y, double width) {\n    if (n == NULL) {\n        n = malloc(sizeof(*n));\n        n-&gt;is_leaf = 1;\n        n-&gt;p = p;\n        //n-&gt;m = 0.1;\n        n-&gt;sw = NULL;\n        n-&gt;se = NULL;\n        n-&gt;nw = NULL;\n        n-&gt;ne = NULL;\n        n-&gt;center_x = center_x;\n        n-&gt;center_y = center_y;\n        n-&gt;width = width;\n    } else if (n-&gt;is_leaf &amp;&amp; (with &lt;= MIN_PARTICLE_SEPARATION)) {\n        // ... merge particles ...\n    } else {\n        if (n-&gt;is_leaf) { //! that is, if the node is not a branch\n            quadtree_insert_helper(n, n-&gt;p, center_x, center_y, width);\n            //! the node is now a branch\n            n-&gt;p = NULL;\n            n-&gt;is_leaf = 0;\n        }\n\n        quadtree_insert_helper(n, p, center_x, center_y, width);\n    }\n\n    return n;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6411412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077059457c1a529a0c2a54eaaeb6f190?s=128&d=identicon&r=PG&f=1", "display_name": "radnaskela", "link": "https://stackoverflow.com/users/6411412/radnaskela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1465137073, "accepted_answer_id": 37579786, "answer_count": 2, "score": 1, "last_activity_date": 1464819979, "creation_date": 1464810448, "last_edit_date": 1464818035, "question_id": 37577522, "link": "https://stackoverflow.com/questions/37577522/stack-overflow-using-recursion-in-c", "closed_reason": "Not suitable for this site", "title": "Stack-overflow using recursion in C", "body": "<p>I've been looking frantically for an answer to no avail; I've created a quadtree which is supposed to sort an array of more than 1000 objects declared by the struct:</p>\n\n<pre><code>typedef struct node\n{\n    char     is_leaf;\n    struct Particle *p;\n    double    m;\n\n    double center_x;\n    double center_y;\n    double width;\n\n    struct node *sw;\n    struct node *nw;\n    struct node *se;\n    struct node *ne;\n\n} node;\n</code></pre>\n\n<p>into a quadtree with the function:</p>\n\n<pre><code>node* quadtree_insert(node *n, struct Particle *p, double center_x, double center_y, double width)\n{\n    if(n == NULL)\n    {\n        n = (node*)malloc(sizeof(node));\n        n-&gt;is_leaf = 1;\n\n        n-&gt;p = p;\n        //n-&gt;m = 0.1;\n\n        n-&gt;sw = NULL;\n        n-&gt;se = NULL;\n        n-&gt;nw = NULL;\n        n-&gt;ne = NULL;\n        if(width &lt; 1e-300){\n            n-&gt;width = 1e-300;\n            }\n        else\n            n-&gt;width    = width;\n        return n;\n    }\n    else{\n        //n = (node*)malloc(sizeof(node));\n        double x;\n        double y;\n        if(width &lt; 1e-300){\n            width = 1e-300;\n            }\n        if(n-&gt;is_leaf == 1) //! that is, if the node is not a branch\n        {\n                        x = (double)n-&gt;p-&gt;x_pos;\n            y = (double)n-&gt;p-&gt;y_pos;\n\n            if(x &lt;= center_x &amp;&amp; y &lt;= center_y) //! first quadrant\n            {\n                n-&gt;sw = quadtree_insert(n-&gt;sw, n-&gt;p, center_x * 0.5, center_y * 0.5, width * 0.5);\n            }\n            else if(x &lt;= center_x &amp;&amp; y &gt; center_y) //! second quadrant\n            {\n                n-&gt;nw = quadtree_insert(n-&gt;nw, n-&gt;p, center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n            }\n            else if(x &gt; center_x &amp;&amp; y &lt;= center_y) //! third quadrant\n            {\n                n-&gt;se = quadtree_insert(n-&gt;se, n-&gt;p, center_x + center_x * 0.5, center_y * 0.5, width * 0.5);\n            }\n            else //! fourth quadrant\n            {\n                n-&gt;ne = quadtree_insert(n-&gt;ne, n-&gt;p, center_x + center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n            }\n\n            n-&gt;p = NULL; //! sets branch pointer to nothing...\n            n-&gt;is_leaf = 0;\n                    }\n        //}\n\n        x = (double)p-&gt;x_pos;\n        y = (double)p-&gt;y_pos;\n\n        if(x &lt;= center_x &amp;&amp; y &lt;= center_y) //! first quadrant\n        {\n            n-&gt;sw = quadtree_insert(n-&gt;sw, p, center_x * 0.5, center_y * 0.5, width * 0.5);\n\n        }\n        else if(x &lt;= center_x &amp;&amp; y &gt; center_y) //! second quadrant\n        {\n            n-&gt;nw = quadtree_insert(n-&gt;nw, p, center_x * 0.5, center_y + center_y * 0.5, width * 0.5);\n\n        }\n        else if(x &gt; center_x &amp;&amp; y &lt;= center_y) //! third quadrant\n        {\n            n-&gt;se = quadtree_insert(n-&gt;se, p, center_x + center_x * 0.5, center_y * 0.5, width * 0.5);\n\n        }\n        else //! fourth quadrant\n        {\n            n-&gt;ne = quadtree_insert(n-&gt;ne, p, center_x + center_x * 0.5, center_y + center_y * 0.5, width * 0.5);            \n        }\n        return n;\n    }\n}\n</code></pre>\n\n<p>This is all done by: </p>\n\n<pre><code> node *root = NULL;\n  root = quadtree_insert(root, &amp;particles[0],0.500,0.5,1);\n\n  for(i = 1; i &lt; nParticles; i++)\n  {\n    quadtree_insert(root, &amp;particles[i],0.5000,0.5,1);\n  }\n</code></pre>\n\n<p>where \"particles\" is passed on on the form struct Particle* particles. And a particle is defined such that:</p>\n\n<pre><code>struct Particle {\n    double mass;\n    double x_pos;\n    double y_pos;\n    double x_vel;\n    double y_vel;\n};\n\ntypedef struct Particle * Particle_structure;\n</code></pre>\n\n<p>The root is free'd after every iteration, after the for-loop, and the code works for samples smaller than ~200 and valgrind gives no errors for these. Added to this is a middle function, which performs some arithmetic on the particles:</p>\n\n<pre><code>double quadtree_calculate_forcey(struct Particle *p, node *n, double theta_max, double delta_t, int numP, double epsilon, double G)\n{\n    if(n != NULL)\n    {\n            double d_x      = (n-&gt;center_x - p-&gt;x_pos);\n                double d_y      = (n-&gt;center_y - p-&gt;y_pos);\n        double r_2     = d_x * d_x + d_y * d_y;\n        r_2 = sqrt(r_2) + epsilon;\n        if(theta_max &lt;= (n-&gt;width / r_2) &amp;&amp; !n-&gt;is_leaf){\n                double a = 0;\n            if(n-&gt;sw != NULL)\n                        a += quadtree_calculate_forcey(p, n-&gt;sw, theta_max, delta_t, numP, epsilon, G);\n                    if(n-&gt;nw != NULL)\n                        a += quadtree_calculate_forcey(p, n-&gt;nw, theta_max, delta_t, numP, epsilon, G);\n                    if(n-&gt;se != NULL)\n                        a += quadtree_calculate_forcey(p, n-&gt;se, theta_max, delta_t, numP, epsilon, G);\n                    if(n-&gt;ne != NULL)\n                        a += quadtree_calculate_forcey(p, n-&gt;ne, theta_max, delta_t, numP, epsilon, G);\n                    return a;\n        }\n        else    \n                {\n                double fy;\n            double mass;\n           if(d_x == 0 &amp;&amp; d_y == 0){ // could be comparing the same star\n                 //printf(\"R\u00d6\u00d6\u00d6VHATT\\n\");  \n                  return 0;\n            }\n            else{\n            //printf(\"MASS : %f\\n\", n-&gt;m);\n                  mass = n-&gt;m;\n                  //printf(\"MASS : %f\\n\", mass);\n                  fy = G * (mass * p-&gt;mass/ pow(r_2,3)) * d_y;   \n                            //printf(\"DY:%f   DX:%f   R_2:%f   MASSA:%f\\n\",d_y, d_x, r_2 - epsilon, mass);          \n                     // printf(\"HIT SKA JAG: %f\\n\",d_y);\n                  return fy;              \n                 }\n        }\n    }\n    return 0.0;\n}\n</code></pre>\n\n<p>The ringer is that its rolls for a bit (clearing the root, and redoing it for new positions), so the number of variables in the recursion surely cannot be the problem(?). I'm pretty sure I'm out swimming with the fishes when it comes to some allocation of pointer declaration. Any thoughts/help would put you on the good side of Odin!</p>\n\n<p>Edit: An example from how we find mass-center etc. The node-mass is done the same way.</p>\n\n<pre><code>double set_centerx(node *n)\n{\n    if(n != NULL)\n    {\n        if(!(n-&gt;is_leaf))\n        {\n                    double a = set_centerx(n-&gt;ne);\n                    double b = set_centerx(n-&gt;nw);\n                    double c = set_centerx(n-&gt;se);\n                    double d = set_centerx(n-&gt;sw);\n                    double m1 = get_mass2(n-&gt;ne);\n                    double m2 = get_mass2(n-&gt;nw);\n                    double m3 = get_mass2(n-&gt;se);\n                    double m4 = get_mass2(n-&gt;sw);\n          n-&gt;center_x = (double)(m1*a + m2*b + m3*c + m4*d)/(m1+m2+m3+m4);\n          return n-&gt;center_x;\n        }\n                n-&gt;center_x =n-&gt;p-&gt;x_pos;\n        return n-&gt;p-&gt;x_pos;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "strtok"], "comments": [{"owner": {"reputation": 23, "user_id": 6333950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oKEtN.jpg?s=128&g=1", "display_name": "Kauder Hexenban", "link": "https://stackoverflow.com/users/6333950/kauder-hexenban"}, "edited": false, "score": 0, "creation_date": 1464810393, "post_id": 37577500, "comment_id": 62641897, "body": "Thank you all in advance for the help!"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 6, "creation_date": 1464810455, "post_id": 37577500, "comment_id": 62641923, "body": "Did you do your indentation with a shotgun? Also, I like <code>while ((token1 != NULL)) {     if (token1 != NULL)</code>, for the tricky cases where you need to be <b>absolutely sure</b> <code>token1</code> in non-NULL."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1464810484, "post_id": 37577500, "comment_id": 62641941, "body": "Have you invented &quot;inverse formatting style&quot;?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1464810522, "post_id": 37577500, "comment_id": 62641964, "body": "did u try stepping through the code with a debugger?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1464810607, "post_id": 37577500, "comment_id": 62642002, "body": "<code>sizeof(ptrArray1)</code> is the size of the pointer, not of an array"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464810863, "post_id": 37577500, "comment_id": 62642147, "body": "The pointer arrays <code>char *ptrArray1, *ptrArray2;</code> that you pass are unintialised pointers to random memory. Might work, probably not.You must allocate memory for an array of token pointers. But as stated above, you don&#39;t know how many elements the function used."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464811305, "post_id": 37577500, "comment_id": 62642380, "body": "<code>void returnArrayOfWords()</code> --&gt; <code>int returnArrayOfWords() { ... return i; }</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464811850, "post_id": 37577500, "comment_id": 62642681, "body": "Where do you allocate memory for the arrays? There is a lot to learn first about pointers and dynamic memory and arrays. A pointer is not an array!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464813014, "post_id": 37577500, "comment_id": 62643270, "body": "<code>strcoll</code> does not find the longest string. It compares them lexographically with respect to locale (whatever that means)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464813022, "post_id": 37577500, "comment_id": 62643275, "body": "It looks like the intent is that <code>returnArrayOfWords()</code> should allocate the array and assign that to <code>*arrayParsed</code>. It should be declared <code>char **arrayParsed</code> to make this clearer."}, {"owner": {"reputation": 23, "user_id": 6333950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oKEtN.jpg?s=128&g=1", "display_name": "Kauder Hexenban", "link": "https://stackoverflow.com/users/6333950/kauder-hexenban"}, "edited": false, "score": 0, "creation_date": 1465133373, "post_id": 37577500, "comment_id": 62764785, "body": "Thank you all for the help, especially to those who left some positive comments ;)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6333950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oKEtN.jpg?s=128&g=1", "display_name": "Kauder Hexenban", "link": "https://stackoverflow.com/users/6333950/kauder-hexenban"}, "edited": false, "score": 0, "creation_date": 1465121020, "post_id": 37578460, "comment_id": 62761252, "body": "Thank you for answering. Your code works well, but I was originally searching for the longest common word in the two strings. Example: string 1 = pear banana apple; string 2 = banana grapes cucumber; The longest common word = banana. Could you help me out with this one?"}, {"owner": {"reputation": 23, "user_id": 6333950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oKEtN.jpg?s=128&g=1", "display_name": "Kauder Hexenban", "link": "https://stackoverflow.com/users/6333950/kauder-hexenban"}, "edited": false, "score": 0, "creation_date": 1498806845, "post_id": 37578460, "comment_id": 76661633, "body": "I apologize I never gave you a &quot;I accept this answer&quot;, I was new to the site and didn&#39;t know much about it. I made sure I fixed it now. Thank you again for the answer and have a great day! :)"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 0, "last_activity_date": 1464813887, "creation_date": 1464813887, "answer_id": 37578460, "question_id": 37577500, "link": "https://stackoverflow.com/questions/37577500/incorrect-behavior-of-a-pointer-in-function-in-c/37578460#37578460", "title": "Incorrect behavior of a pointer in function in C", "body": "<p>There are numerous errors in the program although it compiled without any warnings. Chiefly the pointer types for your array, and the memory allocated. Secondly the function does not know how many words is allowed, and does not return how many were read - your method did not work at all (as in comments). Thirdly the string comparisons: you did not state the goals clearly, but in comment you want the \"biggest string\". <code>strcoll</code> does not do that - it's a lexical comparison, so I changed that section to find the longest string for the two sentences you enter. See comments, I made a large number of changes.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint returnArrayOfWords (char *str4Parsing, char *arrayParsed[], int maxtokens)  // added max\n{\n    char seps[] = \" ,\\t\\n\"; // separators\n    char *token1 = NULL;\n    char *next_token1 = NULL;\n    int i = 0;\n\n    // Establish string and get the first token:\n    token1 = strtok_s( str4Parsing, seps, &amp;next_token1);\n\n    // While there are tokens in \"str4Parsing\" \n    while (token1 != NULL)\n    {\n        if(i &gt;= maxtokens)\n            return i;                                   // ignore the rest\n        arrayParsed[i] = token1;\n        printf( \" %s\\n\", token1 );\n        token1 = strtok_s( NULL, seps, &amp;next_token1);\n        i++;\n    }\n    return i;\n}\n\nint main (void)                                         // correct signature\n{\n    int i, j, n = 80; /*max number of words in string*/\n    char arrS1[80], arrS2[80];\n    //const char *w1, *w2; /*pointers*/                 // deleted\n    char **ptrArray1, **ptrArray2;                      // changed type\n    int currLength1 = 0, currLength2 = 0 ;\n    int sizeArr1 = 0, sizeArr2 = 0;\n    int maxLength = 0;\n    char *wordMaxLength;                                // changed to pointer\n\n    ptrArray1 = malloc(n * sizeof (char*));             // allocate mem for pointer array\n    if (ptrArray1 == NULL)\n        return 1;\n    ptrArray2 = malloc(n * sizeof (char*));             // allocate mem for pointer array\n    if (ptrArray2 == NULL)\n        return 1;\n\n    printf(\"Type your first string: \"); \n    fgets(arrS1, 80, stdin);\n    sizeArr1 = returnArrayOfWords(arrS1, ptrArray1, n); // indirection error, added max words, get actual num\n\n    printf(\"Type your second string: \");\n    fgets(arrS2, 80, stdin);\n    sizeArr2 = returnArrayOfWords(arrS2, ptrArray2, n); // indirection error, added max words, get actual num\n\n    for (i = 0; i &lt; sizeArr1; i++)                      // this section rewritten\n    {\n        // to find the largest word in the array\n        currLength1 = strlen(ptrArray1[i]);\n        if(currLength1 &gt; maxLength) \n        {\n            maxLength = currLength1;\n            wordMaxLength = ptrArray1[i];               // changed definition to pointer\n        }\n    }\n\n    for (j = 0; j &lt; sizeArr2; j++)\n    {\n        // to find the largest word in the array\n        currLength2 = strlen(ptrArray2[j]);\n        if(currLength2 &gt; maxLength) \n        {\n            maxLength = currLength2;\n            wordMaxLength = ptrArray2[j];               // changed definition to pointer\n        }\n    }\n\n    printf(\"The largest word is: %s\", wordMaxLength);\n\n    free(ptrArray1);                                    // added\n    free(ptrArray2);\n    return 0;\n}\n</code></pre>\n\n<p>Program session:</p>\n\n<pre><code>Type your first string: one two three four\n one\n two\n three\n four\nType your second string: apple banana pear\n apple\n banana\n pear\nThe largest word is: banana\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6333950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oKEtN.jpg?s=128&g=1", "display_name": "Kauder Hexenban", "link": "https://stackoverflow.com/users/6333950/kauder-hexenban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 37578460, "answer_count": 1, "score": -5, "last_activity_date": 1465133308, "creation_date": 1464810367, "last_edit_date": 1465133308, "question_id": 37577500, "link": "https://stackoverflow.com/questions/37577500/incorrect-behavior-of-a-pointer-in-function-in-c", "title": "Incorrect behavior of a pointer in function in C", "body": "<p>I have a problem with the following program.</p>\n\n<p>The main function calls the function <code>returnArrayOfWords(arrS1, &amp;ptrArray1)</code> twice. On the first call, the array is parsed perfectly, and afterward the pointer always points to the first word.  On the other hand, after the second call, the pointer of the first array points to the second word, the third word, or sometimes the first word, but it should always point to the first word -- nowhere else.</p>\n\n<p>Why does the function misbehave when called for the second time?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid returnArrayOfWords (char *str4Parsing, char *arrayParsed[])\n{\n    char seps[] = \" ,\\t\\n\"; // separators\n    char *token1 = NULL;\n    char *next_token1 = NULL;\n    int i = 0;\n\n    // Establish string and get the first token:\n    token1 = strtok_s( str4Parsing, seps, &amp;next_token1);\n\n    // While there are tokens in \"str4Parsing\" \n    while (token1 != NULL)\n    {\n        // Get next token:\n        if (token1 != NULL)\n        {\n            arrayParsed[i] = token1;\n            printf( \" %s\\n\", token1 );\n            token1 = strtok_s( NULL, seps, &amp;next_token1);\n            i++;\n        }\n    }\n}\n\n\n//int main1 ()\nint main ()\n{\n    int i, j, n = 80; /*max number of words in string*/\n    char arrS1[80], arrS2[80];\n    const char *w1, *w2; /*pointers*/\n    char *ptrArray1, *ptrArray2;\n    int currLength1 = 0, currLength2 = 0 ;\n    int sizeArr1 = 0, sizeArr2 = 0;\n    int maxLength = 0;\n    char wordMaxLength ;\n\n    printf(\"Type your first string: \"); \n    fgets(arrS1, 80, stdin);\n    returnArrayOfWords(arrS1, &amp;ptrArray1);\n    sizeArr1 = sizeof(ptrArray1) / sizeof(ptrArray1[0]);\n\n    printf(\"Type your second string: \");\n    fgets(arrS2, 80, stdin);\n    returnArrayOfWords(arrS2, &amp;ptrArray2);\n    sizeArr2 = sizeof(ptrArray2) / sizeof(ptrArray2[0]);\n\n    for (i = 0; i &lt; sizeArr1; i++)\n    {\n        // to find the largest word in the array\n        w1 = &amp;ptrArray1[i];\n        currLength1 = strlen(w1);\n        for (j = 0; j &lt; sizeArr2; j++)\n        {\n            w2 = &amp;ptrArray2[j];\n            currLength2 = strlen(w2);\n\n            if (strcoll(w1, w2) == 0)\n            // compares the strings\n            {\n                if (currLength2 &gt;= maxLength)\n                // in the 0th element -&gt; the length of the longest word \n                {\n                    maxLength = currLength2;\n                    wordMaxLength = ptrArray2[j];\n                }\n            }\n        }\n    }\n\n    printf(\"The largest word is: %s\", wordMaxLength);\n    return 0;\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Here's the latest version of the code, everything here works fine, managed to fix it myself. I'm just posting it in case somebody needs it as a solution: </p>\n\n<pre><code>         #include &lt;stdio.h&gt;\n         #include &lt;string.h&gt;\n         #include &lt;stdlib.h&gt;\n         #include &lt;stddef.h&gt;\n         #include &lt;ctype.h&gt;\n\n      #define n 80 /*max number of words in string*/\n\n      /* Arrays and pointers */\n\n      int returnArrayOfWords (char *str4Parsing, char *arrayParsed[])  \n  {\n// returns the length of array\nint elArr = 0, na = 0;\nchar *delim = \" .,;-\\t\\n\";      /* word delimiters   */\nchar *next_token1 = NULL;\nchar *ap = str4Parsing;          /* pointer to str4Parsing */\nfor (ap = strtok_s (str4Parsing, delim, &amp;next_token1); ap; ap = strtok_s( NULL, delim, &amp;next_token1))\n{\n    arrayParsed[na++] = ap;\n    elArr++;\n}\n\nreturn elArr;\n}\n\n\nvoid printArr(char *arr[])\n{\nint i;\nfor ( i = 0; i &lt; n; i++)\n{\n    printf(\"Element %d is %s \\n\", i, arr[i]);\n}\n}\n\n\nvoid findLargestWord(char *ptrArray1[], int sizeArr1, char *ptrArray2[], int       sizeArr2)\n{\nsize_t maxLength = 0;\nchar *wordMaxLength = NULL ;\nint i = 0, j = 0;\nchar *w1 = NULL, *w2 = NULL; /*pointers*/\nsize_t currLength1 = 0, currLength2 = 0 ;\n\nfor (i = 0; i &lt; sizeArr1; i++)\n    {\n    // to find the largest word in the array\n    w1 = (ptrArray1[i]); // value of address (ptrArray1 + i)\n    currLength1 = strlen(w1);\n    //printf(\"The word from the first string is: %s and its length is : %d     \\n\", w1, currLength1); // check point\n\n    for (j = 0; j &lt; sizeArr2; j++)\n        {\n        w2 = (ptrArray2[j]); // value of address (ptrArray2 + j)\n        currLength2 = strlen(w2);\n        //printf(\"The word from the second string is : %s and its length is  : %d \\n\", w2, currLength2); // check point\n\n        if (strcoll(w1, w2) == 0 &amp;&amp; currLength1 == currLength2)\n            // compares the strings\n            {\n            if (currLength2 &gt;= maxLength)\n                // in the variable maxLength -&gt; the length of the longest word \n                {\n                    maxLength = currLength2;\n                    wordMaxLength = w2;\n                    //printf(\"The largest word for now is : %s and its   length is : %d \\n\", wordMaxLength, maxLength); // check point\n                }\n            }\n        }\n    }\nprintf(\"The largest word is: %s \\n\", wordMaxLength);\nprintf(\"Its length is: %d \\n\", maxLength);\n }\n\n\n   void typeArray (char *arrS1)\n {  \n  int err = 0;\nif (!fgets (arrS1, n, stdin)) {  /* validate 'arrS1' */\n    fprintf (stderr, \"Error: invalid input for string.\\n\");\n    err = 1;\n}\n\nwhile (err == 1) \n{\n    if (!fgets (arrS1, n, stdin)) {  /* validate 'arrS1' */\n        fprintf (stderr, \"Error: invalid input for string.\\n\");\n        err = 1;\n    }\n}\n}\n\n\n   int main(void)\n {\n   char arrS1[n], arrS2[n];\nchar *ptrArray1[n] = {NULL}, *ptrArray2[n] = {NULL};\nint sizeArr1 = 0, sizeArr2 = 0;\n\nprintf(\"Type your first string: \"); \ntypeArray (arrS1);\nsizeArr1 = returnArrayOfWords (arrS1, ptrArray1); // sizeArr1 = number of    elements in array 1\n\nprintf(\"Type your second string: \");\ntypeArray (arrS2);\nsizeArr2 = returnArrayOfWords (arrS2, ptrArray2); // sizeArr2 = number of elements in array 2\n\nfindLargestWord(ptrArray1, sizeArr1, ptrArray2, sizeArr2);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "scanf", "gets"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 4, "creation_date": 1464809088, "post_id": 37577156, "comment_id": 62641214, "body": "First of all and before reading the question, <code>gets()</code> should not be used and it has been deprecated in recent versions of the <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> standard. Your code has also multiple other issues like using <code>&amp;</code> operator to pass an array for a <code>&quot;%s&quot;</code> specifier to <code>scanf()</code>. If the compiler, (<i>or runtime?, since I would never use <code>gets()</code> I didn&#39;t know there was a warning</i>) is issuing a warning why do you keep using it?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 4, "creation_date": 1464809438, "post_id": 37577156, "comment_id": 62641386, "body": "<b>Never ever</b> use <code>gets</code>! It has even been removed from the C standard, which is really a rare event."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1464809482, "post_id": 37577156, "comment_id": 62641405, "body": "<code>scanf(&quot;%s&quot;,b)</code> == <code>gets(b)</code> == a hole through which your user may crash or take control of your program"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1464809562, "post_id": 37577156, "comment_id": 62641453, "body": "Your question is really &quot;how do I used scanf when I actually don&#39;t want to do what scanf does&quot;. And the best answer is &quot;don&#39;t use scanf&quot;. Use some function that reads a line if you really want to read a line, and then use something like <code>sscanf</code> to parse the line you read."}, {"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464811019, "post_id": 37577156, "comment_id": 62642222, "body": "@iharob: Is using <code>&amp;</code> operator to pass an array for a <code>&quot;%s&quot;</code> specifier to <code>scanf()</code> invokes undefined behaviour ? I think so !!!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1464813569, "post_id": 37577156, "comment_id": 62643561, "body": "&quot;<i>... scanf() continues to read the input string until it encounters a whitespace ...</i>&quot; -- This is specific to the <code>%s</code> format specifier."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1464823611, "post_id": 37577156, "comment_id": 62647594, "body": "You&#39;ll soon find, if you haven&#39;t already, that <code>scanf</code> really isn&#39;t very useful.  You&#39;ve already heard that <code>gets</code> is unsafe and should not be used at all.  So the best thing you can do is take all the time you were going to spend struggling with <code>scanf</code>, and spend that time learning how to read entire lines with <code>fgets</code>, and then process those lines however you want.  This may seem like a nuisance at first; you may find yourself thinking &quot;but <code>scanf</code> is so much easier!&quot;  Trust me, <code>scanf</code> is <i>not</i> easier, at least, not if you want your input to actually work."}], "answers": [{"comments": [{"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 0, "creation_date": 1464811059, "post_id": 37577260, "comment_id": 62642240, "body": "It is better to use <code>fscanf()</code> instead of problematic <code>scanf()</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 1, "creation_date": 1464813686, "post_id": 37577260, "comment_id": 62643630, "body": "@Destructor: The only difference between <code>fscanf()</code> and <code>scanf()</code> is that <code>scanf()</code> reads from <code>stdin</code>, while <code>fscanf()</code> takes a parameter specifying where it reads from. Did you mean to suggest reading a line using <code>fgets()</code> and then scanning it using <code>sscanf</code>?"}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 3, "last_activity_date": 1464809720, "last_edit_date": 1464809720, "creation_date": 1464809405, "answer_id": 37577260, "question_id": 37577156, "link": "https://stackoverflow.com/questions/37577156/c-programming-scanf-and-gets/37577260#37577260", "title": "c programming: (scanf and gets)", "body": "<p>You can flush it by manually reading and discarding characters until you find a <code>'\\n'</code> or someone hits the appropriate key combination to cause an <code>EOF</code>. Or you can ask <code>scanf()</code> to discard everything until a <code>'\\n'</code> is found, the second one can be achieved like this</p>\n\n<pre><code>char string[20];\nscanf(\"%19s%*[^\\n]\\n\", string);\n</code></pre>\n\n<p>There are other things about your code, that are wrong</p>\n\n<ol>\n<li><p>You declare <code>a</code> as an array of 20 <code>char</code> and then you pass it's address to <code>scanf()</code> where it expects a pointer of <code>char</code>, the array name (<em>the variable if you prefer</em>) is automatically converted to a pointer to <code>char</code> when it's necessary.</p></li>\n<li><p>You used <code>gets()</code>, it's an old dangerous and deprecated function that is no longer a standard function. You should use <code>fgets()</code> instead which takes a parameter to perevent overflowing the destination array.</p></li>\n</ol>\n\n<p>This is an example testing the suggested fixes</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint\nmain(void)\n{    \n    char string[20];\n\n    string[0] = '\\0'; /* Avoid Undefined behaviour \n                         when passing it to `fprintf()' */\n\n    scanf(\"%19s%*[^\\n]\\n\", string);\n    fprintf(stdout, \"%s\\n\", string);\n\n    fgets(string, sizeof(string), stdin);\n    fprintf(stdout, \"%s\\n\", string);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6247202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d942a6ebbdfa10af1e7a27db4fca8a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/6247202/arun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 0, "accepted_answer_id": 37577260, "answer_count": 1, "score": 0, "last_activity_date": 1464812983, "creation_date": 1464808988, "last_edit_date": 1464812983, "question_id": 37577156, "link": "https://stackoverflow.com/questions/37577156/c-programming-scanf-and-gets", "title": "c programming: (scanf and gets)", "body": "<p>Am aware that the difference between scanf() and gets() function is that scanf() continues to read the input string until it encounters a whitespace, whereas gets() continues to read the input string until it encounters a \\n or EOF(end of file).</p>\n\n<p>To see this difference in action, I tried writing a example on my own which is as follows: </p>\n\n<pre><code>                 #include &lt;stdio.h&gt;\n                  int main()\n                {    \n                   char a[20];\n                   printf(\"enter the string\\n\");\n                   scanf(\"%s\",&amp;a);\n                   printf(\"the string is %s\\n\",a);\n                   char b[20];\n                   printf(\"enter the string\\n\");\n                   gets(b);\n                   printf(\"the string is %s\\n\",b);\n                   return 0;\n                }\n</code></pre>\n\n<p>When the variable a was given the string \"manchester united\" as input, the output was:</p>\n\n<pre><code>                   enter the string\n                   manchester united\n                   the string is manchester\n                   enter the string\n                   warning: this program uses gets(), which is unsafe.\n                   the string is  united\n</code></pre>\n\n<p>What I was expecting as output was just the first part of the string given to the variable a which is manchester and then, the program prompting me to enter the new input string for the variable b.\nInstead, I ended up with the above given output.</p>\n\n<p>Based on the output, what I understand is:</p>\n\n<p>It can be seen that as soon as scanf() encounters the whitespace, it stops reading the string thereafter, and thus, the remaining part of the \nstring:united, has been assigned to the variable b,even without the program prompting me to enter the string for variable b. </p>\n\n<p>How do I flush out the remaining part(the portion after the whitespace) of the string given to variable a? </p>\n\n<p>so that, I can enter a whole new input string for the variable b.</p>\n\n<p>Any further explanation on what is also happening here in the execution of the code will be greatly appreciated. </p>\n\n<p>Apologies for the very basic mistakes(as it is evident by the responses)!!\nJust a novice to C programming:)</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1464807039, "post_id": 37576486, "comment_id": 62640225, "body": "What exactly are you referring to by in32 and out32? As near I can tell Linux doesn&#39;t have anything by those names."}, {"owner": {"reputation": 3596, "user_id": 1279782, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0c13bbd4bff7520c5d54c592865ecb21?s=128&d=identicon&r=PG", "display_name": "Iceman", "link": "https://stackoverflow.com/users/1279782/iceman"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1464807152, "post_id": 37576486, "comment_id": 62640288, "body": "@RossRidge: My bad - they are writel and readl."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1464808044, "post_id": 37576486, "comment_id": 62640690, "body": "You should give more context about what you&#39;re actually trying to do."}], "answers": [{"tags": [], "owner": {"reputation": 2219, "user_id": 1521807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ca95c59b3b803d42939dcc34412e5c6?s=128&d=identicon&r=PG", "display_name": "bodangly", "link": "https://stackoverflow.com/users/1521807/bodangly"}, "is_accepted": false, "score": 0, "last_activity_date": 1464809848, "last_edit_date": 1464809848, "creation_date": 1464808090, "answer_id": 37576890, "question_id": 37576486, "link": "https://stackoverflow.com/questions/37576486/can-io-utilities-writel-and-readl-be-used-on-physical-addresses/37576890#37576890", "title": "Can IO utilities writel and readl be used on physical addresses", "body": "<p>The answer is going to be platform dependent. If you search through the code you will see writel and readl typically are implemented in the architecture specific files (in arch/ in the kernel tree), as assembly language calls. On some platforms it is possible it might work. However, it makes more sense to always call ioremap to get a pointer. This will help with portability and if not needed on a particular platform it would be optimized out anyhow.</p>\n\n<p>See:</p>\n\n<p><a href=\"http://lxr.free-electrons.com/ident?i=writel\" rel=\"nofollow\">Free-Electrons writel</a></p>\n\n<p><a href=\"http://lxr.free-electrons.com/ident?i=readl\" rel=\"nofollow\">Free-Electrons writel</a></p>\n"}], "owner": {"reputation": 3596, "user_id": 1279782, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0c13bbd4bff7520c5d54c592865ecb21?s=128&d=identicon&r=PG", "display_name": "Iceman", "link": "https://stackoverflow.com/users/1279782/iceman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464809848, "creation_date": 1464806678, "last_edit_date": 1464807107, "question_id": 37576486, "link": "https://stackoverflow.com/questions/37576486/can-io-utilities-writel-and-readl-be-used-on-physical-addresses", "title": "Can IO utilities writel and readl be used on physical addresses", "body": "<p>Can IO utils such as writel and readl be used on physical addresses, or do I always need to first map the physical memory into my virtual space, and then use the pointer as the argument to writel/readl?</p>\n"}, {"tags": ["c", "interrupt"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464807185, "post_id": 37576438, "comment_id": 62640308, "body": "Have you looked up <code>EXE2BIN</code> utility? I also guess you need to compile with the <code>SMALL</code> or possibly <code>TINY</code> memory model."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1464807554, "post_id": 37576438, "comment_id": 62640470, "body": "Woah.. I think you have invented a time machine or something..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464807780, "post_id": 37576438, "comment_id": 62640575, "body": "My guess is that 1Mb memory will be enough to run a <code>TINY</code> model which is limited to 64Kb. I remember installing my first upgrade to a massive 2Mb - I was sailing!"}], "owner": {"reputation": 11, "user_id": 6292708, "user_type": "registered", "profile_image": "https://graph.facebook.com/1166708516695716/picture?type=large", "display_name": "Mariya Tanveer", "link": "https://stackoverflow.com/users/6292708/mariya-tanveer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562857061, "creation_date": 1464806486, "last_edit_date": 1562857061, "question_id": 37576438, "link": "https://stackoverflow.com/questions/37576438/can-you-guide-me-how-to-set-settings-so-that-compiler-generate-com-file-as-its", "title": "Can you guide me how to set settings so that compiler generate .com file as its TSR program?", "body": "<p><a href=\"https://i.stack.imgur.com/Oa6Ce.png\" rel=\"nofollow noreferrer\">c program</a></p>\n\n<p>I tried to run this program in Turbo c++ but it's not working. It's a TSR(Terminate but Stay Resident) program. To run such programs, these have to be converted into .com file but I do not know how to set Turbo c++ settings for this. Kindly guide.</p>\n"}, {"tags": ["c", "string", "file", "input", "char"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464805611, "post_id": 37576148, "comment_id": 62639439, "body": "Which third byte is <code>&#39;s&#39;</code>? But you can do <code>getchar(); getchar(); int c = getch();</code> it&#39;s not worth having a loop."}, {"owner": {"reputation": 319, "user_id": 3427042, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5e195d64c70f837e6b01c643c09be5cc?s=128&d=identicon&r=PG&f=1", "display_name": "Jakkie Chan", "link": "https://stackoverflow.com/users/3427042/jakkie-chan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464805685, "post_id": 37576148, "comment_id": 62639481, "body": "the s in push(&quot;blah&quot;)"}, {"owner": {"reputation": 319, "user_id": 3427042, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5e195d64c70f837e6b01c643c09be5cc?s=128&d=identicon&r=PG&f=1", "display_name": "Jakkie Chan", "link": "https://stackoverflow.com/users/3427042/jakkie-chan"}, "edited": false, "score": 0, "creation_date": 1464805777, "post_id": 37576148, "comment_id": 62639538, "body": "well im reading from stdin, so i want to read the push part as well"}, {"owner": {"reputation": 7673, "user_id": 3004881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lFgVw.jpg?s=128&g=1", "display_name": "Dan Getz", "link": "https://stackoverflow.com/users/3004881/dan-getz"}, "edited": false, "score": 0, "creation_date": 1464812447, "post_id": 37576148, "comment_id": 62642975, "body": "Are you going to want to check earlier bytes later? Or are you just looking to throw away an arbitrary number of bytes of input?"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1464805771, "creation_date": 1464805771, "answer_id": 37576237, "question_id": 37576148, "link": "https://stackoverflow.com/questions/37576148/retrieving-a-char-from-stdin/37576237#37576237", "title": "Retrieving a char from stdin", "body": "<p>When reading from <code>stdin</code>, you typically want to read a line at a time, then work with that.</p>\n\n<p>So start by using <code>fgets</code> to read a line, then check the contents of what is read.</p>\n\n<pre><code>char line[100];\nfgets(line, sizeof(line), stdin);\nif ((strlen(line) &gt; 2) &amp;&amp; line[2] == 's') {\n    printf(\"got s\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1464806097, "creation_date": 1464806097, "answer_id": 37576325, "question_id": 37576148, "link": "https://stackoverflow.com/questions/37576148/retrieving-a-char-from-stdin/37576325#37576325", "title": "Retrieving a char from stdin", "body": "<p>The standard input is not normally seekable, so the only reliable way to read it is sequentially, from the beginning.  There are any number of ways you could extract specifically the third <code>char</code> without looping:</p>\n\n<pre><code>int c1;\nchar c2;\nchar c3;\nchar buf[4];\n\n// approach 1:\ngetchar(); getchar(); c1 = getchar();\n\n// approach 2:\nscanf(\"%*c%*c%c\", &amp;c2);\n\n// approach 3:\nfgets(buf, sizeof(buf), stdin);\nc3 = buf[3];\n</code></pre>\n\n<p>Note that those are intended for individual use, not sequential use; they are presented together for ease of presentation.  Note also, importantly, that no error / EOF checks are performed in those examples.  In real code it is essential to test your function call results for error codes.  Thirdly, note that the first two examples discard the two initial characters.  There is no possibility of getting them back later.  If you want them, you'll need to keep track of them, as, for example, the third alternative allows.</p>\n"}], "owner": {"reputation": 319, "user_id": 3427042, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5e195d64c70f837e6b01c643c09be5cc?s=128&d=identicon&r=PG&f=1", "display_name": "Jakkie Chan", "link": "https://stackoverflow.com/users/3427042/jakkie-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1464813424, "answer_count": 2, "score": -3, "last_activity_date": 1464806097, "creation_date": 1464805434, "last_edit_date": 1464805749, "question_id": 37576148, "link": "https://stackoverflow.com/questions/37576148/retrieving-a-char-from-stdin", "closed_reason": "Needs details or clarity", "title": "Retrieving a char from stdin", "body": "<p>How would I get a char from stdin. For example if stdin was <code>push(\"blah\")</code>, and I wanted to retrieve the 3rd char/byte which is 's', how would I go about doing that? I'm not sure if <code>fgetc()</code> or <code>getchar()</code> is involved, I want to try avoiding a loop, but is a loop the only way to iterate through it, can I not just retrieve it directly like a <code>getchar(3)</code> type of thing?</p>\n"}, {"tags": ["c", "infinite-loop", "qsort"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464805255, "post_id": 37575970, "comment_id": 62639259, "body": "Aside: the <code>cmp</code> function could be simpler as two of the tests are quite unnecessary (the 2 equality tests). The function only needs 4 tests, with a final <code>return 0</code> which currently is never executed. None of the <code>else</code>s are necessary either."}, {"owner": {"reputation": 11, "user_id": 6404734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d683d7627539638bcd37ba78eb5fb4f5?s=128&d=identicon&r=PG&f=1", "display_name": "oliver hovorka", "link": "https://stackoverflow.com/users/6404734/oliver-hovorka"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464809960, "post_id": 37575970, "comment_id": 62641669, "body": "@WeatherVane yeah your right thank you!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464810102, "post_id": 37575970, "comment_id": 62641744, "body": "And while I am nit-picking, the <code>cmp</code> function could be slightly quicker by removing the <code>- &#39;0&#39;</code> from each initialisation - you will still be making valid comparisons."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6404734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d683d7627539638bcd37ba78eb5fb4f5?s=128&d=identicon&r=PG&f=1", "display_name": "oliver hovorka", "link": "https://stackoverflow.com/users/6404734/oliver-hovorka"}, "edited": false, "score": 0, "creation_date": 1464805154, "post_id": 37576029, "comment_id": 62639204, "body": "Thanks for telling me that."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 3, "last_activity_date": 1464805406, "last_edit_date": 1464805406, "creation_date": 1464805042, "answer_id": 37576029, "question_id": 37575970, "link": "https://stackoverflow.com/questions/37575970/qsort-endless-loop-causes-error-c/37576029#37576029", "title": "qsort endless loop causes error C", "body": "<p>The declaration of your <code>ausgabesortiert</code> function </p>\n\n<pre><code>void ausgabesortiert(struct raeume *arr[],int used,int size)\n</code></pre>\n\n<p>clearly suggests that array <code>arr</code> contains <em>pointers</em> to <code>struct raeume</code> objects, not the objects themselves. </p>\n\n<p>But the call to <code>qsort</code></p>\n\n<pre><code>qsort(*arr,size,sizeof(raeume),cmp);\n</code></pre>\n\n<p>and the comparison function are written as if you are trying to sort an array of <code>struct raeume</code> objects themselves that begins at <code>arr[0]</code> location.</p>\n\n<p>While there's nothing formally invalid in this, it still looks rather strange. Is this really your intent? What exactly are you trying to sort, again? The <code>arr</code> array or some other array pointed by <code>arr[0]</code>? I suspect that it is the former, in which case you need to fix the <code>qsort</code> call and comparison function.</p>\n"}], "owner": {"reputation": 11, "user_id": 6404734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d683d7627539638bcd37ba78eb5fb4f5?s=128&d=identicon&r=PG&f=1", "display_name": "oliver hovorka", "link": "https://stackoverflow.com/users/6404734/oliver-hovorka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464805406, "creation_date": 1464804781, "question_id": 37575970, "link": "https://stackoverflow.com/questions/37575970/qsort-endless-loop-causes-error-c", "title": "qsort endless loop causes error C", "body": "<p>So I\u00b4m stuck with this sort function because everything seems to work fine when I debug it and there are no errors or warnings what so ever but it somehow gets stuck in an infinite loop.</p>\n\n<p>My struct(if it helps):</p>\n\n<pre><code>typedef struct raeume{\nchar number[5];\nchar klasse[6];\nint tische;\n}raeume;\n</code></pre>\n\n<p>my start of the qsort function:</p>\n\n<pre><code>void ausgabesortiert(struct raeume *arr[],int used,int size)\n{\n    qsort(*arr,size,sizeof(raeume),cmp);\n    ausgabesortiert(arr,size,used);\n}\n</code></pre>\n\n<p>my compare function:</p>\n\n<pre><code>int cmp(const void * a, const void * b)\n{\n    raeume *raumA = (raeume *) a;\n    raeume *raumB = (raeume *) b;\n    int tempA = raumA-&gt;klasse[0] - '0';\n    int tempB = raumB-&gt;klasse[0] - '0';\n    if(tempA &lt; tempB)\n    {\n        return -1;\n    }\n    else if(tempA &gt; tempB)\n    {\n        return 1;\n    }\n    else if(tempA == tempB)\n    {\n        if(raumA-&gt;tische &gt; raumB-&gt;tische)\n        {\n            return -1;\n        }\n        else if(raumA-&gt;tische &lt; raumB-&gt;tische)\n        {\n            return 1;\n        }\n        else if(raumA-&gt;tische == raumB-&gt;tische)\n        {\n           return 0;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "arm", "interrupt", "armv6"], "comments": [{"owner": {"reputation": 1270, "user_id": 755977, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a36e5d14141aaafdd6dab9e2fb33cff0?s=128&d=identicon&r=PG", "display_name": "PhilDulac", "link": "https://stackoverflow.com/users/755977/phildulac"}, "edited": false, "score": 1, "creation_date": 1464805148, "post_id": 37575878, "comment_id": 62639198, "body": "Can you share what you have done/tried so far? It would help to answer your question."}, {"owner": {"reputation": 2977, "user_id": 3780976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd03a6382250ef22f350f1614714c703?s=128&d=identicon&r=PG&f=1", "display_name": "Dric512", "link": "https://stackoverflow.com/users/3780976/dric512"}, "edited": false, "score": 0, "creation_date": 1464809155, "post_id": 37575878, "comment_id": 62641248, "body": "Why would you need to switch to SVC handler to do the context switch ? It does not have more priviledge."}, {"owner": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "reply_to_user": {"reputation": 2977, "user_id": 3780976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd03a6382250ef22f350f1614714c703?s=128&d=identicon&r=PG&f=1", "display_name": "Dric512", "link": "https://stackoverflow.com/users/3780976/dric512"}, "edited": false, "score": 0, "creation_date": 1464823032, "post_id": 37575878, "comment_id": 62647431, "body": "@Dric512 I want to do it in SVC mode in order to change the SVC mode stack pointer, not the IRQ one. I can&#39;t just switch into SVC mode and branch to the link register, because, when an interrupt happens, I want to save r15 from the running thread and switch to the stored program counter."}, {"owner": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "reply_to_user": {"reputation": 1270, "user_id": 755977, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a36e5d14141aaafdd6dab9e2fb33cff0?s=128&d=identicon&r=PG", "display_name": "PhilDulac", "link": "https://stackoverflow.com/users/755977/phildulac"}, "edited": false, "score": 0, "creation_date": 1464823044, "post_id": 37575878, "comment_id": 62647438, "body": "@PhilDulac Let me know if that helps."}, {"owner": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "edited": false, "score": 0, "creation_date": 1464849728, "post_id": 37575878, "comment_id": 62654803, "body": "I am almost entirely sure that lr_irq is the task PC... when the interrupt completes, the LR contains the place to go back to to keep executing what was running before the interrupt (ignoring tasks at all). I&#39;m wondering how to set the service SP and PC from interrupt mode - for example, does pop {sp}^ pop a value in the svc r13?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "edited": false, "score": 0, "creation_date": 1464898950, "post_id": 37593746, "comment_id": 62687669, "body": "Thanks, this helps a lot. How can I actually change lr_irq and sp_irq? I believe I need to do these things to actually be able to go back to a new thread."}, {"owner": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "edited": false, "score": 0, "creation_date": 1464922968, "post_id": 37593746, "comment_id": 62694845, "body": "I see this: /var/folders/qb/njcg85_123s4jqr_n0kkt71w0000gn/T//ccStXA95.s&zwnj;&#8203;:39: Error: selected processor does not support ARM mode `cpsid aif,#18&#39;"}, {"owner": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "edited": false, "score": 0, "creation_date": 1464922978, "post_id": 37593746, "comment_id": 62694848, "body": "Is there anyway to get around it? @artless-noise"}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "reply_to_user": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "edited": false, "score": 0, "creation_date": 1464975137, "post_id": 37593746, "comment_id": 62723210, "body": "Use the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/ARM-Options.html\" rel=\"nofollow noreferrer\">gcc option</a> <code>-march=armv6</code> (which is good for other reasons too).  If you want to set <code>lr_irq</code>, etc then it is the opposite.  Just do <code>mov lr, %1</code> and modify the output to input arguments."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "reply_to_user": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "edited": false, "score": 0, "creation_date": 1464976889, "post_id": 37593746, "comment_id": 62724120, "body": "Ok, if <code>-march=armv6</code> doesn&#39;t work (you have ARMv6T1, not T2) then you can remove the CPS and clear the mode bits and set the IRQ mode manually with multiple instructions of &#39;and/or&#39; masking or use the <code>msr cpsr_c, mode</code>."}], "tags": [], "owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "is_accepted": false, "score": 1, "last_activity_date": 1464977188, "last_edit_date": 1495542693, "creation_date": 1464875196, "answer_id": 37593746, "question_id": 37575878, "link": "https://stackoverflow.com/questions/37575878/arm-v6-irq-context-switch/37593746#37593746", "title": "ARM v6 IRQ context switch", "body": "<p>For the ARMv6 you need to change modes to get the banked registers.  Your sample code already has many of the necessary details.</p>\n\n<pre><code>    #define MODE_IRQ 0x12\n    #define MODE_SVC 0x13\n    unsigned int mode;   /* original mode */\n\n    /* target data... */\n    unsigned int lr_irq;\n    unsigned int sp_irq;\n    unsigned int spsr;\n\n    asm (\" mrs %0, cpsr\\n\"    /* Save mode. */\n         \" msr cpsr_c,%4 \\n\"  /* to irq mode */\n         \" mov %1, lr\\n\"      /* Get lr_irq */\n         \" mov %2, sp\\n\"      /* Get sp_irq */\n         \" mrs %3, spsr\\n\"    /* Get spsr_irq */\n         \" msr cpsr, %0\\n\"    /* back to old mode */\n         : \"=&amp;r\" (mode), \"=r\"(lr_irq),\n           \"=r\"(sp_irq), \"=r\"(spsr)\n         : \"I\" (MODE_IRQ));\n</code></pre>\n\n<p>gcc will allocate the <code>lr_irq</code> etc to general registers (non-banked) and you can transfer the data across modes.  The ARMv7 with virtualization extensions has an instruction to avoid this switch.</p>\n\n<p>You should be aware that the timer interrupt could occur in many contexts.  It is probably prudent to at least check the <em>spsr</em> from the IRQ mode and have some debug (assert like) that verifies it is user mode.  If this never triggers and you think an IRQ can only happen in user mode then the 'debug' can be removed.</p>\n\n<p>Another method is to do this in the assembler of the IRQ handler and pass them to the <code>interrupt_yield()</code> routine in r0-r2 for instance.  The ARM EABI puts parameters in r0-r2 so interrupt yield needs parameters.  Once you have this data there should be no need to return to the IRQ mode.  I highly recommend this method for production code.  The above is good for prototyping.</p>\n\n<hr>\n\n<p>Related: <a href=\"https://stackoverflow.com/questions/2784978/explicitly-accessing-banked-registers-on-arm\">Explicitly accessing banked registers on ARM</a> </p>\n"}], "owner": {"reputation": 39, "user_id": 5100102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xYlCkg3FERU/AAAAAAAAAAI/AAAAAAAAAwM/JCotiG9gCHw/photo.jpg?sz=128", "display_name": "Andrew Milich", "link": "https://stackoverflow.com/users/5100102/andrew-milich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464977188, "creation_date": 1464804471, "last_edit_date": 1464875711, "question_id": 37575878, "link": "https://stackoverflow.com/questions/37575878/arm-v6-irq-context-switch", "title": "ARM v6 IRQ context switch", "body": "<p>I'm trying to write a context switch in a timer interrupt handler. Currently, the context switch is able to switch between contexts on command (cooperative). In the interrupt handler, I was trying to: </p>\n\n<ol>\n<li>Save the current program counter as the place the old thread needs to keep executing</li>\n<li>Switch into SVC mode to actually perform the context switch </li>\n<li>Switch back into IRQ mode and change the link register to be the saved PC from the <em>new thread</em> </li>\n<li>Return from the IRQ handler to the IRQ link register</li>\n</ol>\n\n<p>I believe I can do the first two properly, but I was wondering: how can I switch back into interrupt mode, or at least modify the SVC R13 and R15 from the interrupt handler? </p>\n\n<p>I'm using an ARM v6 processor; thanks so much for the help!</p>\n\n<p>Edit: here's basically what my switch is: </p>\n\n<pre><code>void interrupt_yield() {\n    unsigned int old_mode; \n    __asm__(\"mrs %0, cpsr\" : \"=r\" (old_mode));\n    __asm__(\"msr cpsr_c, %0\" : : \"r\" (MODE_SVC));\n\n    PUSH_ALL; // Macro for push {r0-r12, lr} \n    __asm__(\"mov %0, sp\" : \"=r\"(sp));\n    manager-&gt;threads[manager-&gt;current_thread].sp = sp;\n\n    unsigned nt = (manager-&gt;current_thread + 1) % manager-&gt;thread_counter;\n    if (CURRENT_THREAD.status == ACTIVE) {\n        CURRENT_THREAD.status = INACTIVE;\n    }\n    manager-&gt;current_thread = nt;\n\n    CURRENT_THREAD.status = ACTIVE;\n    SET_SP(CURRENT_THREAD.sp);\n    POP_ALL;\n\n    __asm__(\"msr cpsr, %0\" : : \"r\" (old_mode));\n}\n\n\nvoid timer_vector() { // This is called by assembly in interrupt mode\n    armtimer_clear_interrupt(); // clear timer interrupt\n    interrupt_yield(); // Calls above function \n}\n</code></pre>\n\n<p>The goal is to change the IRQ link register to return to the new function. I can't seem to switch back into interrupt mode, however, to do this. </p>\n\n<p>1 more edit: I never actually switch the IRQ link register; I realize this but am not even switching back into IRQ mode so this is a later problem to fix. </p>\n"}, {"tags": ["java", "android", "c", "android-ndk"], "answers": [{"tags": [], "owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "is_accepted": false, "score": 0, "last_activity_date": 1465814082, "creation_date": 1465814082, "answer_id": 37787496, "question_id": 37575440, "link": "https://stackoverflow.com/questions/37575440/unable-to-enable-jni-debugger/37787496#37787496", "title": "Unable to Enable JNI Debugger", "body": "<p>To enable native debugging, compile your C++ code under Android Studio.</p>\n\n<p>With version 2.2, you can use <a href=\"https://sites.google.com/a/android.com/tools/tech-docs/external-c-builds\" rel=\"nofollow\"><strong>externalNativeBuild</strong></a>. For 2.1, you only have the <a href=\"https://sites.google.com/a/android.com/tools/tech-docs/new-build-system/gradle-experimental\" rel=\"nofollow\"><em>experimental</em></a> Gradle plugin. Unfortunately, it is not completely integrated into AS, e.g. <strong>File/Project Structure</strong> (a.k.a. <strong>Ctrl-;</strong>) does not understand these <code>build.gradle</code> files.</p>\n"}], "owner": {"reputation": 1, "user_id": 6410047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f993496eee3d6582caf618964636a68c?s=128&d=identicon&r=PG&f=1", "display_name": "Nir H.", "link": "https://stackoverflow.com/users/6410047/nir-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1465814082, "creation_date": 1464802850, "last_edit_date": 1464852628, "question_id": 37575440, "link": "https://stackoverflow.com/questions/37575440/unable-to-enable-jni-debugger", "title": "Unable to Enable JNI Debugger", "body": "<p>I have started using Java Native Interface (JNI) recently and encountered some problems that I hope you could help me to solve.</p>\n\n<p>I am using Android Studio 2.1.1, SDK Tools 25.1.7, NDK 12, API 21.</p>\n\n<p>1.My main problem is that i cannot debug the C code, only the java.\ni will try to explain my attempts at debugging on a much simpler code which i    will include.</p>\n\n<p>1.1 I compiled the C code to .so with the command ndk-build NDK_DEBUG=1.</p>\n\n<p>1.2 I have added the SDK\\NDK path to the Android Studio Project Structure.</p>\n\n<p>1.3 I have added to the build.gradle \"jnidebuggable=true\".</p>\n\n<p>1.4 I have created in Run->Edit Config a new debug session with \"Hybrid\" \n    settings and loaded the .so libs to it.</p>\n\n<p>1.5 Attaching my Android.mk, Application.mk, build.gradle, C code and files.</p>\n\n<p>1.6 The code is running and working, it doesn't hit the breakpoints inside the C code.</p>\n\n<p>2.how can i monitor the heap and stack usage of my code and especially the of \nthe JNI? also is it changeable?</p>\n\n<p>3.on the same matter as 2. how can i decrease the dependency in the heap? will defining my variables as static do the trick?</p>\n\n<p>Android.mk</p>\n\n<pre><code>LOCAL_PATH := $(call my-dir)\ninclude $(CLEAR_VARS)\nLOCAL_MODULE := sub\nLOCAL_SRC_FILES := subst.c\ninclude $(BUILD_SHARED_LIBRARY)\n</code></pre>\n\n<p>Application.mk</p>\n\n<pre><code>APP_ABI := all\nAPP_BUILD_SCRIPT := C:\\Users\\Nir\\AndroidStudioProjects\\FirstApp\\jni\\Android.mk\n</code></pre>\n\n<p>C code</p>\n\n<pre><code>jdouble Java_nir_firstapp_MainActivity_subst(JNIEnv* env, jobject obj, jdouble A, jdouble B)\n{\nint x;\nx=A-B;\nreturn(x);\n}\n</code></pre>\n\n<p>build.gradle</p>\n\n<pre><code>apply plugin: 'com.android.application'\n\nandroid {\ncompileSdkVersion 23\nbuildToolsVersion \"23.0.2\"\n\ndefaultConfig {\n    applicationId \"nir.firstapp\"\n    minSdkVersion 19\n    targetSdkVersion 23\n    versionCode 1\n    versionName \"1.0\"\n}\nbuildTypes {\n    release {\n        minifyEnabled false\n        proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n    }\n    debug {\n        jniDebuggable true\n        debuggable true\n    }\n    }\n}\n</code></pre>\n\n<p>MainActivity relevant code</p>\n\n<pre><code>public native double subst(double A, double B);\nstatic{\n    System.loadLibrary(\"sub\");\n}\ndouble calc = subst(Double.valueOf(num1str),Double.valueOf(num2str));\n</code></pre>\n\n<p>My sincere thank you,\nNir</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "edited": false, "score": 2, "creation_date": 1464801836, "post_id": 37575129, "comment_id": 62637415, "body": "But the file is not comma separated?"}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1464802370, "post_id": 37575129, "comment_id": 62637724, "body": "Read things as string, <a href=\"http://www.cplusplus.com/faq/sequences/strings/split/\" rel=\"nofollow noreferrer\">split them</a> and them use functions to convert numbers to int or to doubles"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464802487, "post_id": 37575129, "comment_id": 62637794, "body": "Aside: please improve your error-catch: <code>printf(&quot;File opening problem!&quot;);</code> may well not appear on the console before you get a segfault. Add a <code>\\n</code> at the end of the message, and <code>return 1</code> from <code>main</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464804098, "post_id": 37575129, "comment_id": 62638684, "body": "Am I being picky when I ask why the distance from Kecskemet to Miskolc is 231, but the distance from Miskolc to Kecskemet is 123? There are many other such anomolies in the data. Also as commented, it is not a CSV file. If it were, it could handle city names with more than one word, but now it cannot. Perhaps it is a TSV (Tab-separated values) file."}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": false, "score": 0, "last_activity_date": 1464802838, "last_edit_date": 1495539850, "creation_date": 1464802838, "answer_id": 37575430, "question_id": 37575129, "link": "https://stackoverflow.com/questions/37575129/how-do-i-read-into-an-array-from-a-csv-file/37575430#37575430", "title": "How do I read into an array from a CSV file?", "body": "<p>(side-note: CSV means <a href=\"https://en.wikipedia.org/wiki/Comma-separated_values\" rel=\"nofollow noreferrer\">comma-separated values</a>; your file is not in CSV format)</p>\n\n<p>If you know the dimensions of your array, and don't need error checking, you can use <code>fscanf</code>.</p>\n\n<p>The following will skip a word (delimited by spaces). Use it to skip the redundant names that go before the numbers, which you actually need.</p>\n\n<pre><code>fscanf(file, \"%*s\");\n</code></pre>\n\n<p>The following will read a number:</p>\n\n<pre><code>int distance;\nfscanf(file, \"%d\", &amp;distance);\n</code></pre>\n\n<p>Combine these in a loop, with proper counting, and you will get your data.</p>\n\n<hr>\n\n<p>Note: the above is a quick-and-dirty solution. You <strong>will</strong> have errors in your file or in the code that reads it, and <a href=\"https://stackoverflow.com/q/2430303/509868\"><code>fscanf</code> makes it hard to handle errors</a>. You should learn how to use <code>fgets</code> and <a href=\"https://stackoverflow.com/q/9210528/509868\">split a string</a> in C.</p>\n"}], "owner": {"reputation": 21, "user_id": 6410901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac6f50bbaf281ce41c8e45701f08bbb?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/6410901/g%c3%a1bor-micsk%c3%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1053, "favorite_count": 0, "closed_date": 1464803841, "answer_count": 1, "score": 0, "last_activity_date": 1464802838, "creation_date": 1464801763, "last_edit_date": 1464802323, "question_id": 37575129, "link": "https://stackoverflow.com/questions/37575129/how-do-i-read-into-an-array-from-a-csv-file", "closed_reason": "Duplicate", "title": "How do I read into an array from a CSV file?", "body": "<p>My csv file contains the following:</p>\n\n<pre><code>            BP  BCS DEB EG  GY  KAP KEC MI\nBP          0   216 511 311 22  23  242 550\nBekescsaba  216 0   23  34  11  345 23  42\nDebrecen    511 642 0   124 31  124 123 315\nEger        311 1351 31 0   342 532 211 134\nGyor        22  135 341 431 0   134 23  312\nKaposvar    23  14  24  341 14  0   15  32\nKecskemet   242 241 241 135 14  15  0   231\nMiskolc     550 24  4   12  352 124 123 0\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/5N3vY.png\" rel=\"nofollow\">IMG</a></p>\n\n<p>I want to read the numbers into an array. Question is, how can I do that, while skipping the first string as well?</p>\n\n<p>This is the code that reads everything:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#define MAX 1024\n\nvoid main() {\n\n    FILE *f;\n    float r;\n    int i, j;\n    char line[1024];\n    char city[MAX];\n    int mtx[20][20];\n    int szam[50];\n    char *cities[9] = {\"Budapest\", \"Bekescsaba\", \"Debrecen\", \"Eger\", \"Gyor\", \"Kaposvar\", \"Kecskemet\", \"Miskolc\"};\n    f = fopen(\"/home/dumika/Desktop/asd.csv\", \"r\");\n    if(!f) printf(\"File opening problem!\");\n\n\n    //fgets(line, 1024, f);\n\n    while(fscanf(f, \"%s\", city) != EOF)\n    {\n        printf(\"%s \\n\", city);\n    }\n\n}\n</code></pre>\n\n<p>Very little info on how to actually manage csv i/o on C. The actual task is to ask a user to input two cities, and calculate the distance.\nWhat I would do is read the numbers in a matrix, and have cities in a pointer array. A user writes, for example Budapest (index 0) and Eger (index 3) the distance will be 311. (mtx[0][3]) \nBut I have trouble reading the numbers into a 2D array. What is the best method to do so?</p>\n"}, {"tags": ["c", "unix", "recursion", "pipe", "dup2"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1464801505, "post_id": 37574901, "comment_id": 62637214, "body": "<code>execve</code> will never return. (Well, ok, it will return if it didn&#39;t work.)"}, {"owner": {"reputation": 31, "user_id": 6410807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7609ccd59b2e062212fa3cf8312af39?s=128&d=identicon&r=PG&f=1", "display_name": "Roozaay", "link": "https://stackoverflow.com/users/6410807/roozaay"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464806795, "post_id": 37574901, "comment_id": 62640106, "body": "It returns -1 when it doesn&#39;t work yeah..."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1464809512, "last_edit_date": 1464809512, "creation_date": 1464807606, "answer_id": 37576761, "question_id": 37574901, "link": "https://stackoverflow.com/questions/37574901/fork-pipe-close-in-a-recursive-function/37576761#37576761", "title": "fork / pipe / close in a recursive function", "body": "<p>It's a bit unclear how you are trying to use the function you present, but here are some notable points about it:</p>\n\n<ul>\n<li><p>It's poor form to rely on a static variable to limit recursion depth because it's not thread-safe and because you need to do extra work to manage it (for example, to ensure that any changes are backed out when the function returns).  Use a function parameter instead.</p></li>\n<li><p>As has been observed in comments, the exec-family functions return only on failure.  Although you acknowledge that, I'm not sure you appreciate the consequences, for both branches of your fork contain code that will never be executed as a result.  The recursive call in particular is dead and will never be executed.</p></li>\n<li><p>Moreover, the process in which the function is called performs an <code>execve()</code> call itself.  The reason that function does not return is that it <em>replaces</em> the process image with that of the new process.  That means that function <code>test_recurs()</code> <em>also</em> does not return.</p></li>\n</ul>\n\n<p>Just as shell ordinarily must fork / exec to launch a single external command, it ordinarily must fork / exec for <em>each</em> command in a pipeline.  If it fails to do so then afterward it is no longer running -- whatever it exec'ed without forking runs instead.</p>\n\n<blockquote>\n  <p>The problem is it only execute \"ls | wc\" one time and then wait on the standard input. </p>\n</blockquote>\n\n<p>Certainly it does not recurse, because the recursive call is in a section of dead code.  I suspect you are mistaken in your claim that it afterward waits on standard input, because the process that calls that function execs <code>/bin/ls</code>, which does not read from standard input.  When the <code>ls</code> exits, however, leaving you with neither shell nor <code>ls</code>, what you then see might seem to be a wait on stdin.</p>\n"}], "owner": {"reputation": 31, "user_id": 6410807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7609ccd59b2e062212fa3cf8312af39?s=128&d=identicon&r=PG&f=1", "display_name": "Roozaay", "link": "https://stackoverflow.com/users/6410807/roozaay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464809512, "creation_date": 1464800886, "last_edit_date": 1464801245, "question_id": 37574901, "link": "https://stackoverflow.com/questions/37574901/fork-pipe-close-in-a-recursive-function", "title": "fork / pipe / close in a recursive function", "body": "<p>In order to realize a shell command interpretor, I try to execute pipes.\nTo do it, I use a recursive function in wich I use the pipe function and some redirections with dup2.\nHere is my code :</p>\n\n<pre><code>void            test_recurs(pid_t pid, char **ae)\n{\n  char  *const  arg[2] = {\"/bin/ls\", NULL};\n  char  *const  arg2[3] = {\"/bin/wc\", NULL};\n  static int    limit = 0;\n  int           check;\n  int           fd[2];\n\n  if (limit &gt; 5)\n    return ;\n  if (pipe(fd) == -1)\n    {\n      printf(\"pipe failed\\n\");\n      return ;\n    }\n  pid = fork();\n  if(pid != 0)\n    {\n      printf(\"p\u00e8re %d\\n\",getpid());\n      close(fd[0]);\n      dup2(fd[1], 1);\n      close(fd[1]);\n      if ((execve(\"/bin/ls\", arg, ae)) == -1)\n        exit(125);\n      dprintf(2, \"execution ls\\n\");\n      wait(&amp;check);\n    }\n  else\n    {\n      printf(\"fils %d\\n\", getpid());\n      close(fd[1]);\n      dup2(fd[0], 0);\n      close(fd[0]);\n      if ((execve(\"/bin/wc\", arg2, ae)) == -1)\n        printf(\"echec execve\\n\");;\n      dprintf(2, \"limit[%d]\\n\", limit);\n      limit++;\n      test_recurs(pid, ae);\n    }\n}\n</code></pre>\n\n<p>The problem is it only execute \"ls | wc\" one time and then wait on the standard input. I know that the problem may come from the pipes (and the redirections).</p>\n"}, {"tags": ["c", "performance", "x86"], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 4066038, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90268512e8c68063cb7b0ccecc05081d?s=128&d=identicon&r=PG&f=1", "display_name": "deadbeef", "link": "https://stackoverflow.com/users/4066038/deadbeef"}, "edited": false, "score": 0, "creation_date": 1464801937, "post_id": 37574846, "comment_id": 62637472, "body": "Your statement - &quot;turbo boosting will only work on single cores at a time&quot; is not clear to me. Can you bit more explain this point. My understanding is if turbo boost is enabled, all cores will run on highest possible frequency provided thermal conditions are met."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1464801968, "post_id": 37574846, "comment_id": 62637491, "body": "Actually, Turbo can boost multiple cores at once.  The max single-core turbo is a bit higher than the max dual or quad-core turbo, but for some CPUs with a low TDP, there is power / thermal headroom to turbo multiple cores for short periods.  e.g. for <a href=\"https://en.wikipedia.org/wiki/Skylake_(microarchitecture)#Desktop_processors\" rel=\"nofollow noreferrer\">Skylake Desktop</a>, 6600k 3.5GHz sustained can single-core turbo to 3.9GHz, but only to 3.6GHz for quad-core."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1464802734, "post_id": 37574846, "comment_id": 62637929, "body": "@PeterCordes exactly; it makes no sense to use turbo boost in a &quot;I need the performance boost continually&quot; scenario, as that will just lead to thermal throttling later on, and that &quot;higher than usual \u2013 lower than usual \u2013 higher than usual \u2026&quot; clocking scheme definitely doesn&#39;t help system behaviour."}], "tags": [], "owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "is_accepted": false, "score": 0, "last_activity_date": 1464800779, "creation_date": 1464800779, "answer_id": 37574846, "question_id": 37574742, "link": "https://stackoverflow.com/questions/37574742/intel-turbo-boost-and-multi-core-performance-relation/37574846#37574846", "title": "Intel turbo boost and multi core performance relation", "body": "<p>you're misinterpreting. Read closely. Performance \"scales\" means you take twice the number of cores, you get twice the performance.</p>\n\n<p>However, turbo boosting will only work on single cores at a time \u2013 so when you take N non-turbo-boosting cores, you get N times the performane of a single non-boosting one, but if you take M turbo-boosting cores, you will only get M times the performance of a non-boosting core; since that is less than M times the performance of a boosting core, Scaling breaks, but not the absolute performance increase, though that will diminish relatively with the number of cores.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 1, "last_activity_date": 1464803001, "creation_date": 1464803001, "answer_id": 37575483, "question_id": 37574742, "link": "https://stackoverflow.com/questions/37574742/intel-turbo-boost-and-multi-core-performance-relation/37575483#37575483", "title": "Intel turbo boost and multi core performance relation", "body": "<p>The suggestions on that page look reasonable for getting consistent benchmark results, but terrible for ongoing use.</p>\n\n<ul>\n<li><em>Disable all power saving options such as: Power performance tuning, CPU P-State, CPU C3 Report and CPU C6 Report.</em>  This will make your CPU waste huge amounts of power when it's idle.</li>\n<li><em>Select Performance as the CPU Power and Performance policy.</em> This will probably also hurt idle power consumption, and maybe also light-load performance</li>\n<li><em>Disable Turbo Boost to ensure the performance scaling increases with the number of cores.</em></li>\n</ul>\n\n<p><strong>Disabling turbo will indeed make the performance ratio between single-core and many-core more predictable (scaling), but it does so by slowing down single-core, not by speeding up multi-core.</strong></p>\n\n<p>Desktop/mobile CPUs also <a href=\"https://en.wikipedia.org/wiki/Skylake_(microarchitecture)#Desktop_processors\" rel=\"nofollow\">turbo with multiple cores active</a> (to a lower frequency), but IDK if Xeons do that.</p>\n\n<hr>\n\n<p>Only follow those suggestions if you want to verify that performance behaves the way you expect when you take CPU power saving out of the equation.  <strong>Put them all back to normal after!!</strong></p>\n\n<p>A 1% increase in performance isn't worth a 20% increase in power consumption.  Running hot all the time means less thermal headroom for Turbo, so disabling P-states and so on could lead to a decrease in actual performance, esp. for a slightly bursty workload.</p>\n\n<p>The <a href=\"http://myeventagenda.com/sessions/0B9F4191-1C29-408A-8B61-65D7520025A8/7/5#sessionID=155\" rel=\"nofollow\">IDF talk about Skylake Power Management</a> pointed out some gains in a few benchmarks (e.g. JavaScript) from saving more power between bursts, so it could turbo more of the time when there was work to do.  (Skylake can reclock itself much faster than Broadwell, because it can do all its own power management internally instead of having the OS choose the clock speed for levels below max/turbo.)</p>\n"}], "owner": {"reputation": 531, "user_id": 4066038, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90268512e8c68063cb7b0ccecc05081d?s=128&d=identicon&r=PG&f=1", "display_name": "deadbeef", "link": "https://stackoverflow.com/users/4066038/deadbeef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1000, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1464803001, "creation_date": 1464800442, "question_id": 37574742, "link": "https://stackoverflow.com/questions/37574742/intel-turbo-boost-and-multi-core-performance-relation", "title": "Intel turbo boost and multi core performance relation", "body": "<p>I have seen a recommendation to disable turbo boost for multi core performance improvement.<a href=\"http://dpdk.org/doc/guides/linux_gsg/nic_perf_intel_platform.html\" rel=\"nofollow\">here, section 7.1.2</a>.This is the exact wording from link:<strong>Disable Turbo Boost to ensure the performance scaling increases with the number of cores.</strong>\n  I always thought more clock speed means more ups and more performance. So turbo boost should always help or at least shouldn't harm performance of system. But this recommendation is very surprising. Any thoughts on this point?</p>\n"}, {"tags": ["c", "linux", "compilation", "linux-kernel"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464800440, "post_id": 37574684, "comment_id": 62636598, "body": "<i>&quot;refuses to compile&quot;</i> ?? What does that mean? Do you have a Makefile? Update: OK, I see you do..."}, {"owner": {"reputation": 141, "user_id": 5828698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-EaO5Tmkk7OQ/AAAAAAAAAAI/AAAAAAAAAC8/CSPIkBmMEp4/photo.jpg?sz=128", "display_name": "sir mordred", "link": "https://stackoverflow.com/users/5828698/sir-mordred"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464800610, "post_id": 37574684, "comment_id": 62636694, "body": "i mean i cant see any <b>core.o</b> (compiled object) in <code>kernel&#47;examplepatch</code> after compilation. and yes i have makefile here <a href=\"https://github.com/sirmordred/ref-3.10/blob/3674fd24cfc87fb9cc5dba51780e6a4dc04c0e4b/kernel/examplepatch/Makefile\" rel=\"nofollow noreferrer\">github.com/sirmordred/ref-3.10/blob/&hellip;</a>"}, {"owner": {"reputation": 141, "user_id": 5828698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-EaO5Tmkk7OQ/AAAAAAAAAAI/AAAAAAAAAC8/CSPIkBmMEp4/photo.jpg?sz=128", "display_name": "sir mordred", "link": "https://stackoverflow.com/users/5828698/sir-mordred"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464800715, "post_id": 37574684, "comment_id": 62636740, "body": "and also sorry for bad english :/"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1464800983, "post_id": 37574684, "comment_id": 62636907, "body": "I think you need to add the <code>core.o</code> to your <code>obj-$(CONFIG_EXAMPLEPATCH)</code>"}, {"owner": {"reputation": 141, "user_id": 5828698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-EaO5Tmkk7OQ/AAAAAAAAAAI/AAAAAAAAAC8/CSPIkBmMEp4/photo.jpg?sz=128", "display_name": "sir mordred", "link": "https://stackoverflow.com/users/5828698/sir-mordred"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464801482, "post_id": 37574684, "comment_id": 62637198, "body": "firstly i choosed the following implementation <a href=\"https://github.com/torvalds/linux/blob/master/kernel/livepatch/Makefile\" rel=\"nofollow noreferrer\">github.com/torvalds/linux/blob/master/kernel/livepatch/Makef&zwnj;&#8203;ile</a> as a base thats why i added <b>examplepatch-objs</b> to core.o but i will try and inform you thank you so much"}], "owner": {"reputation": 141, "user_id": 5828698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-EaO5Tmkk7OQ/AAAAAAAAAAI/AAAAAAAAAC8/CSPIkBmMEp4/photo.jpg?sz=128", "display_name": "sir mordred", "link": "https://stackoverflow.com/users/5828698/sir-mordred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464801346, "creation_date": 1464800272, "last_edit_date": 1464801346, "question_id": 37574684, "link": "https://stackoverflow.com/questions/37574684/linux-kernel-error-patch-refuses-to-compile", "title": "Linux kernel error: patch refuses to compile", "body": "<p>here is the code that i wrote: <a href=\"https://github.com/sirmordred/ref-3.10/commit/3674fd24cfc87fb9cc5dba51780e6a4dc04c0e4b\" rel=\"nofollow\">link</a></p>\n\n<p>and im selecting the following defconfig(exynos8890-herolte_kor_defconfig) for compiling <a href=\"https://github.com/sirmordred/ref-3.10/blob/universal8890/arch/arm64/configs/exynos8890-herolte_kor_defconfig\" rel=\"nofollow\">defconfig file</a></p>\n\n<p>and my core function (<code>kernel/examplepatch/core.c</code>) is depend on the following options as described in <code>kernel/example/Kconfig</code></p>\n\n<pre><code>config HAVE_EXAMPLEPATCH\n    bool\n    help\n      Arch supports kernel example patch\n\nconfig EXAMPLEPATCH\n    bool \"Kernel example patch\"\n    depends on DYNAMIC_FTRACE2\n    depends on MODULES\n    depends on SYSFS\n    depends on KALLSYMS_ALL\n    depends on HAVE_EXAMPLEPATCH\n    help\n      Say Y here if you want to support kernel example patch.\n</code></pre>\n\n<p>and the following options <code>depends on MODULES</code> , <code>depends on SYSFS</code> and <code>depends on KALLSYMS_ALL</code> are selected through defconfig which i selected at compile time(exynos8890-herolte_kor_defconfig) and the rest dependencies <code>depends on HAVE_EXAMPLEPATCH</code> and <code>depends on DYNAMIC_FTRACE2</code> are selected through arch/arm64/Kconfig <a href=\"https://github.com/sirmordred/ref-3.10/commit/3674fd24cfc87fb9cc5dba51780e6a4dc04c0e4b#diff-74b704a6995edb0529fc619230b82b94R79\" rel=\"nofollow\">link</a> within CONFIG_ARM64(and exynos8890-herolte_kor_defconfig has CONFIG_ARM64 option too)</p>\n\n<p>but unfortunatly the <code>kernel/examplepatch/core.c</code> refuses to compile i cant see the <strong>core.o</strong> (compiled object) in <code>kernel/examplepatch</code></p>\n\n<p>so what part or things are wrong?</p>\n\n<p>thanx\nregards</p>\n"}, {"tags": ["c", "recursion", "data-structures", "struct", "linked-list"], "answers": [{"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 2, "last_activity_date": 1464799647, "creation_date": 1464799647, "answer_id": 37574486, "question_id": 37574396, "link": "https://stackoverflow.com/questions/37574396/delete-recursively-number-from-linked-list/37574486#37574486", "title": "delete recursively number from linked list", "body": "<p>You freed what should be returned and dereferended the pointer pointing at what is freed. This is what is wrong.</p>\n\n<p>You should introduce a buffer to store what should be returned.</p>\n\n<pre><code>struct node* delete_item(struct node* head, int num)\n{\n    if (head == NULL) { // Found the tail\n        printf(\"not found\\n\");\n        return NULL;\n    }\n    else if (head-&gt;data == num) \n    { // Found one to delete\n        struct node* next = head-&gt;next;\n        free(head);\n        printf(\"num founded\");\n        return next;\n    }\n    else \n    { // Just keep going\n        head-&gt;next = delete_item(head-&gt;next, num);\n        return head;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6072321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-gtuoyr_EgwA/AAAAAAAAAAI/AAAAAAAAADU/x_8pYhqXpCs/photo.jpg?sz=128", "display_name": "Daniel Zingerman", "link": "https://stackoverflow.com/users/6072321/daniel-zingerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464799647, "creation_date": 1464799411, "question_id": 37574396, "link": "https://stackoverflow.com/questions/37574396/delete-recursively-number-from-linked-list", "title": "delete recursively number from linked list", "body": "<p>hello guys i made a func which deleting from a linked list recursively according to the number you want to delete from the linked list. but after the removing if im trying to print the list its stack and there is a run-time error because after the removing there is just nothing in the place of the number. how can i complete the code ?</p>\n\n<pre><code> struct node* delete_item(struct node* head, int num)\n{\n    if (head == NULL) { // Found the tail\n        printf(\"not found\\n\");\n        return NULL;\n    }\n    else if (head-&gt;data == num) \n    { // Found one to delete\n        head = head-&gt;next;\n        free(head);\n        printf(\"num founded\");\n        return head-&gt;next;\n    }\n    else \n    { // Just keep going\n        head-&gt;next = delete_item(head-&gt;next, num);\n        return head;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "codeblocks", "free"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 4, "creation_date": 1464798915, "post_id": 37574243, "comment_id": 62635709, "body": "Do not post your code as image. Please post your code as text directly in your question. Also please don&#39;t forget to post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 3, "creation_date": 1464798961, "post_id": 37574243, "comment_id": 62635738, "body": "They say <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">you shouldn&#39;t cast the result of <code>malloc()</code> in C</a>."}, {"owner": {"reputation": 405, "user_id": 6336615, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-54JWXHU1LhI/AAAAAAAAAAI/AAAAAAAABKc/N9fUA8Ue7e4/photo.jpg?sz=128", "display_name": "Wayne Booth", "link": "https://stackoverflow.com/users/6336615/wayne-booth"}, "edited": false, "score": 0, "creation_date": 1464798991, "post_id": 37574243, "comment_id": 62635756, "body": "What&#39;s the question?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1464799025, "post_id": 37574243, "comment_id": 62635778, "body": "Checking if <code>M == NULL</code> after assigning some value to <code>*M</code> isn&#39;t good. See <a href=\"https://www.securecoding.cert.org/confluence/display/c/EXP34-C.+Do+not+dereference+null+pointers\" rel=\"nofollow noreferrer\">EXP34-C. Do not dereference null pointers - CERT C Coding Standard - CERT Secure Coding Standards</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464799231, "post_id": 37574243, "comment_id": 62635914, "body": "I am feeling like opened Instagram..."}], "answers": [{"comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1464800429, "post_id": 37574413, "comment_id": 62636588, "body": "Lines 2-4 of ReservarMemoriaMatriz are still wrong, Presumably the caller is passing <code>&amp;M</code> as the first parameter, and that can never be NULL. so the second line is meaningless. Line 4 should check *M for NULL, not M. And assuming the caller also passes &amp;M into LiberarMemoriaMatriz, the same applies there, too."}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": true, "score": 0, "last_activity_date": 1464800820, "last_edit_date": 1464800820, "creation_date": 1464799443, "answer_id": 37574413, "question_id": 37574243, "link": "https://stackoverflow.com/questions/37574243/c-program-crashes-when-using-free-function/37574413#37574413", "title": "C - program crashes when using free function", "body": "<p>The errors in the code is:</p>\n\n<ul>\n<li><code>M == NULL</code> is not a valid way to check if <code>malloc</code> is succeeded. You should use <code>(*M) == NULL</code> because the value is assigned to <code>(*M)</code>, not <code>M</code>.</li>\n<li>The loop condition in <code>ReservarMemoriaMatriz</code> <code>i&lt;=m</code> seems wrong. It should be <code>i&lt;=n</code>.</li>\n<li>You forgot to free <code>(*M)[n]</code> in <code>LiberarMemoriaMatriz</code>.</li>\n</ul>\n\n<p>Corrected code:</p>\n\n<pre><code>void LiberarMemoriaMatriz(double*** M,int n){\n    int i = 0;\n    if(M == NULL) return;\n    for(i=0; i&lt;=n; i++){\n        free((*M)[i]);\n    }\n    free(*M);\n}\n\nint ReservarMemoriaMatriz(double*** M, int n, int ,){\n    int i = 0;\n    if(M == NULL) return 0;\n    (*M) = malloc((n+1)*sizeof(double*));\n    if((*M) == NULL){\n        return 0;\n    }\n    for(i = 0; i&lt;=n; i++){\n        (*M)[i] = malloc(m*sizeof(double));\n        if((*M)[i] == NULL){\n            /* free what is allocated before failing */\n            for(i--; i&gt;=0; i--) free((*M)[i]);\n            free(*M);\n            return 0;\n        }\n    }\n    return 1;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12794, "user_id": 865643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mG7s3.jpg?s=128&g=1", "display_name": "noelicus", "link": "https://stackoverflow.com/users/865643/noelicus"}, "is_accepted": false, "score": 1, "last_activity_date": 1464799477, "creation_date": 1464799477, "answer_id": 37574425, "question_id": 37574243, "link": "https://stackoverflow.com/questions/37574243/c-program-crashes-when-using-free-function/37574425#37574425", "title": "C - program crashes when using free function", "body": "<p>Your for loop should be using <code>n</code> not <code>m</code> on your second round of allocation.</p>\n\n<pre><code>for (i=0; i &lt; n; i++) // You're using m here: use n\n{\n    ...\n    malloc(m...) // Here m is correct\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6409925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cPDCd4AOgdk/AAAAAAAAAAI/AAAAAAAAAZo/2yNlGT1M99Y/photo.jpg?sz=128", "display_name": "Carlos Obregon", "link": "https://stackoverflow.com/users/6409925/carlos-obregon"}, "is_accepted": false, "score": 0, "last_activity_date": 1464927591, "last_edit_date": 1464927591, "creation_date": 1464924967, "answer_id": 37605518, "question_id": 37574243, "link": "https://stackoverflow.com/questions/37574243/c-program-crashes-when-using-free-function/37605518#37605518", "title": "C - program crashes when using free function", "body": "<p>I was looking line-by-line and finally found the mistake:</p>\n\n<p>I like what you do that says:</p>\n\n<blockquote>\n  <p>free what is allocated before failing</p>\n</blockquote>\n\n<p>Another thing that I changed is when allocating memory I use:</p>\n\n<pre><code>(*M) = (double**)malloc(n * sizeof(double*));\n</code></pre>\n\n<p>and the loop condition, <code>i &lt; n</code>, and everything is working fine.</p>\n"}], "owner": {"reputation": 1, "user_id": 6409925, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cPDCd4AOgdk/AAAAAAAAAAI/AAAAAAAAAZo/2yNlGT1M99Y/photo.jpg?sz=128", "display_name": "Carlos Obregon", "link": "https://stackoverflow.com/users/6409925/carlos-obregon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "accepted_answer_id": 37574413, "answer_count": 3, "score": -6, "last_activity_date": 1464927591, "creation_date": 1464798851, "last_edit_date": 1592644375, "question_id": 37574243, "link": "https://stackoverflow.com/questions/37574243/c-program-crashes-when-using-free-function", "title": "C - program crashes when using free function", "body": "<p>first, sorry for my bad english jeje. I don't speak it.</p>\n<p>I'm having a problem when using free() function to free memory, this is what I have :</p>\n<p><img src=\"https://i.stack.imgur.com/ZLs7J.jpg\" alt=\"Using free() function in C \" /></p>\n<p>I'm using codeblocks on Windows 7. I have around 3 years using dinamic memory allocation and this is the first time I get this problem.\nThere are people that say that the problem is gcc compiler</p>\n<p><img src=\"https://i.stack.imgur.com/OQGov.jpg\" alt=\"equal Directions \" /></p>\n<p>Directions are equal in and out the function, so I don't think I'm trying to free an invalid pointer</p>\n"}, {"tags": ["c++", "c", "windows", "header", "linker"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1464798544, "post_id": 37574117, "comment_id": 62635461, "body": "Would you mind posting a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 117, "user_id": 6410671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfd340b94d18b6258c31ef997dcb3da?s=128&d=identicon&r=PG&f=1", "display_name": "Cecil", "link": "https://stackoverflow.com/users/6410671/cecil"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1464798574, "post_id": 37574117, "comment_id": 62635485, "body": "@MikeCAT Okay sure! Give me a few minutes please."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1464798782, "post_id": 37574117, "comment_id": 62635620, "body": "@RandyGaul Keep the <b>minimal</b> in mind."}], "answers": [{"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1464799504, "post_id": 37574191, "comment_id": 62636062, "body": "I&#39;d be careful to specify the proper calling convention modifier in the prototypes too, and put them in an <code>extern C</code> section."}, {"owner": {"reputation": 117, "user_id": 6410671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfd340b94d18b6258c31ef997dcb3da?s=128&d=identicon&r=PG&f=1", "display_name": "Cecil", "link": "https://stackoverflow.com/users/6410671/cecil"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1464800230, "post_id": 37574191, "comment_id": 62636477, "body": "Alright, I&#39;ve added an example! @MarkRansom Actually I haven&#39;t tried to add the <code>extern C</code> section yet. I definitely need that..."}, {"owner": {"reputation": 117, "user_id": 6410671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfd340b94d18b6258c31ef997dcb3da?s=128&d=identicon&r=PG&f=1", "display_name": "Cecil", "link": "https://stackoverflow.com/users/6410671/cecil"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1464800288, "post_id": 37574191, "comment_id": 62636507, "body": "@MarkRansom Yep, that was exactly the problem. I forgot the <code>extern C</code>, if added my example code compiles perfectly fine."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 4, "last_activity_date": 1464798682, "creation_date": 1464798682, "answer_id": 37574191, "question_id": 37574117, "link": "https://stackoverflow.com/questions/37574117/compile-on-win32-without-windows-h/37574191#37574191", "title": "Compile on WIN32 without Windows.h", "body": "<p>No, the tools don't do anything especially for windows.h.</p>\n\n<p>I'd guess you've gotten your header wrong. It's hard to guess what the problem might be without seeing the header, but one possibility sticks out.</p>\n\n<p>For most functions, Windows has both \"ANSI\" and \"Wide\" versions, so what you see as <code>CreateWindow</code> is really two functions <code>CreateWindowA</code> and <code>CreateWindowW</code>. <code>CreateWindow</code> exists only as a macro that maps to either the <code>*A</code> or <code>*W</code> name, depending upon whether <code>UNICODE</code> is defined.</p>\n\n<p>So, if you've provided a prototype/declaration for a function named <code>CreateWindow</code>, it's not going to link--what exists in the library are <code>CreateWindowA</code> and <code>CreateWindowW</code>, not <code>CreateWindow</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 6410671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfd340b94d18b6258c31ef997dcb3da?s=128&d=identicon&r=PG&f=1", "display_name": "Cecil", "link": "https://stackoverflow.com/users/6410671/cecil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "accepted_answer_id": 37574191, "answer_count": 1, "score": 2, "last_activity_date": 1464800182, "creation_date": 1464798425, "last_edit_date": 1464800182, "question_id": 37574117, "link": "https://stackoverflow.com/questions/37574117/compile-on-win32-without-windows-h", "title": "Compile on WIN32 without Windows.h", "body": "<p>As a learning exercise I've written a standard Windows program that registers and creates a window without explicitly including <code>Windows.h</code>. All header symbols from <code>Windows.h</code> have been extracted and placed into a custom header which I include into the source. The custom header has type definitions like <code>CreateWindow</code> and <code>WNDCLASSEX</code>.</p>\n\n<p>The program is compiled with <code>cl.exe</code> with a command line like so:</p>\n\n<p><code>cl main.cpp /link opengl32.lib gdi32.lib kernel32.lib user32.lib</code></p>\n\n<p>It is my understanding that these .lib files are import libs which do setup work for loading in function addresses from the associated DLLs upon process startup. The above command line will work perfectly fine if <code>main.cpp</code> includes <code>Windows.h</code> directly. However, when including the custom header <code>cl.exe</code> fails to link all function calls made into the Windows API, despite having specified the associated import libs on the command line (unresolved external symbol errors).</p>\n\n<p>Is there some kind of special-case magic <code>cl.exe</code> performs specifically for <code>Windows.h</code>? What steps are necessary to ensure proper linking in this scenario?</p>\n\n<p>Here is the smallest example I could construct:</p>\n\n<pre><code>typedef unsigned __int64 UINT_PTR, *PUINT_PTR;\ntypedef __int64 LONG_PTR, *PLONG_PTR;\ntypedef UINT_PTR            WPARAM;\ntypedef LONG_PTR            LPARAM;\ntypedef LONG_PTR            LRESULT;\ntypedef int                 INT;\ntypedef unsigned int        UINT;\ntypedef char CHAR;\ntypedef unsigned short      WORD;\n#define CONST const\n#define DECLARE_HANDLE(name) struct name##__{int unused;}; typedef struct name##__ *name\nDECLARE_HANDLE(HWND);\nDECLARE_HANDLE(HINSTANCE);\nDECLARE_HANDLE(HICON);\nDECLARE_HANDLE(HCURSOR);\nDECLARE_HANDLE(HBRUSH);\nDECLARE_HANDLE(HMODULE);\ntypedef unsigned __int64 ULONG_PTR, *PULONG_PTR;\ntypedef CHAR *NPSTR, *LPSTR, *PSTR;\ntypedef CONST CHAR *LPCSTR, *PCSTR;\n#define CALLBACK    __stdcall\n#define WINAPI      __stdcall\ntypedef LRESULT (CALLBACK* WNDPROC)(HWND, UINT, WPARAM, LPARAM);\n#define DECLSPEC_IMPORT __declspec(dllimport)\n#define WINUSERAPI DECLSPEC_IMPORT\n#define WINBASEAPI DECLSPEC_IMPORT\n#define CS_VREDRAW          0x0001\n#define CS_HREDRAW          0x0002\n#define CS_OWNDC            0x0020\n#define MAKEINTRESOURCEA(i) ((LPSTR)((ULONG_PTR)((WORD)(i))))\n#define MAKEINTRESOURCE  MAKEINTRESOURCEA\n#define IDC_ARROW           MAKEINTRESOURCE(32512)\n#define NULL 0\ntypedef WORD                ATOM;   //BUGBUG - might want to remove this from minwin\n\ntypedef struct tagWNDCLASSEXA {\n    UINT        cbSize;\n    /* Win 3.x */\n    UINT        style;\n    WNDPROC     lpfnWndProc;\n    int         cbClsExtra;\n    int         cbWndExtra;\n    HINSTANCE   hInstance;\n    HICON       hIcon;\n    HCURSOR     hCursor;\n    HBRUSH      hbrBackground;\n    LPCSTR      lpszMenuName;\n    LPCSTR      lpszClassName;\n    /* Win 4.0 */\n    HICON       hIconSm;\n} WNDCLASSEXA, *PWNDCLASSEXA, *NPWNDCLASSEXA, *LPWNDCLASSEXA;\n\nWINUSERAPI LRESULT CALLBACK DefWindowProcA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);\nWINBASEAPI HMODULE WINAPI GetModuleHandleA(LPCSTR lpModuleName);\nWINUSERAPI HCURSOR WINAPI LoadCursorA(HINSTANCE hInstance, LPCSTR lpCursorName);\nWINUSERAPI ATOM WINAPI RegisterClassExA(CONST WNDCLASSEXA *);\n\nLRESULT CALLBACK WndProc( HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam )\n{\n    return DefWindowProcA( hWnd, message, wParam, lParam );\n}\n\nINT WINAPI WinMain( HINSTANCE hInst, HINSTANCE hPrev, LPSTR szCmdLine, INT sw )\n{\n    // register window class\n    WNDCLASSEXA wcex = { 0 };\n    wcex.cbSize            = sizeof( WNDCLASSEXA );\n    wcex.style            = CS_HREDRAW | CS_VREDRAW | CS_OWNDC;\n    wcex.lpfnWndProc    = WndProc;\n    wcex.hInstance        = (HINSTANCE)GetModuleHandleA( NULL );\n    wcex.hIcon            = NULL;\n    wcex.hCursor        = LoadCursorA( NULL, IDC_ARROW );\n    wcex.lpszClassName    = \"Title\";\n    RegisterClassExA( &amp;wcex );\n\n    return 0;\n}\n</code></pre>\n\n<p>Compiled with:</p>\n\n<pre><code>@echo off\ncall \"C:\\Program Files (x86)\\Microsoft Visual Studio 12.0\\VC\\vcvarsall.bat\" x64\n\nset CONSOLE= -subsystem:windows\nset CFLAGS= -Zi -nologo\nset CFLAGS= -D__WINDOWS__ -D_CRT_SECURE_NO_WARNINGS %CFLAGS%\nset LFLAGS= -incremental:no -opt:ref\nset LFLAGS= user32.lib kernel32.lib %LFLAGS%\n\ncl %CFLAGS% main.cpp -Fegame.exe /link %LFLAGS% %CONSOLE%\n</code></pre>\n"}, {"tags": ["c", "arrays", "list", "struct", "memcpy"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 3, "creation_date": 1464794065, "post_id": 37572456, "comment_id": 62632526, "body": "A <code>int**</code> does not refer to a 2D array of <code>int</code>, but to a pointer to pointer of <code>int</code>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464794625, "post_id": 37572456, "comment_id": 62632958, "body": "Are you using an array of pointers, each pointing to arrays of <code>int</code>?  Or is it all allocated in one chunk with extra math to find the right element from a row and column?"}, {"owner": {"reputation": 41, "user_id": 4997339, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153524020714560/picture?type=large", "display_name": "Nano Aguayo", "link": "https://stackoverflow.com/users/4997339/nano-aguayo"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464795135, "post_id": 37572456, "comment_id": 62633309, "body": "@Dmitri it&#39;s all allocated in one chunk, except for the first one that is created number by number (I&#39;ve to get it from a .txt file)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464795146, "post_id": 37572456, "comment_id": 62633318, "body": "I am not using <code>memcpy()</code> correctly, because if it were&#39;nt working correctly we would be in serious problems."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464795335, "post_id": 37572456, "comment_id": 62633462, "body": "Can you show how you create the array, and how you access the elements?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1464796014, "post_id": 37572456, "comment_id": 62633900, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}, {"owner": {"reputation": 41, "user_id": 4997339, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153524020714560/picture?type=large", "display_name": "Nano Aguayo", "link": "https://stackoverflow.com/users/4997339/nano-aguayo"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1464796431, "post_id": 37572456, "comment_id": 62634168, "body": "@L\u01b0uV\u0129nhPh&#250;c keep getting the same with or whithout the cast"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1464796546, "post_id": 37572456, "comment_id": 62634237, "body": "I didn&#39;t say that&#39;s related to your problem. That&#39;s a suggestion"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1464796592, "post_id": 37572456, "comment_id": 62634262, "body": "@NanoAguayo For the umpteen time, <code>int**</code> is not a contiguous 2D array."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464798120, "post_id": 37572456, "comment_id": 62635188, "body": "Posting code showing the <code>Add()</code> call and the origin of the variables passed to <code>Add()</code> would help."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1464794616, "post_id": 37572615, "comment_id": 62632943, "body": "And this is one of the reasons why it is important to know the difference between a pointer-to-array and a pointer-to-pointer."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1464794674, "post_id": 37572615, "comment_id": 62632985, "body": "This cannot be correct because <code>estado</code> points to an array of int pointers, yet this code is using <code>sizeof(int)</code>."}, {"owner": {"reputation": 41, "user_id": 4997339, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153524020714560/picture?type=large", "display_name": "Nano Aguayo", "link": "https://stackoverflow.com/users/4997339/nano-aguayo"}, "edited": false, "score": 0, "creation_date": 1464796504, "post_id": 37572615, "comment_id": 62634217, "body": "Did it and worked better, but still get the same values in every &quot;estado&quot;"}], "tags": [], "owner": {"reputation": 12794, "user_id": 865643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mG7s3.jpg?s=128&g=1", "display_name": "noelicus", "link": "https://stackoverflow.com/users/865643/noelicus"}, "is_accepted": true, "score": 3, "last_activity_date": 1464797771, "last_edit_date": 1495542693, "creation_date": 1464794046, "answer_id": 37572615, "question_id": 37572456, "link": "https://stackoverflow.com/questions/37572456/memcpy-not-working-correctly/37572615#37572615", "title": "memcpy() not working correctly", "body": "<p>Your <code>memcpy</code>-ing onto the address of a pointer rather than the memory it's point<em>ing</em> to. Try this instead:</p>\n\n<pre><code>memcpy(list-&gt;last-&gt;estado,estado,size*sizeof(int));\n</code></pre>\n\n<p>Look in to pointers of pointers if you want to read around the subject.</p>\n\n<p>Also, as pointed out by some comments, a double pointer is not the same as a 2D array. Check out <a href=\"https://stackoverflow.com/a/14809055/865643\">this answer on creating a pointer to a 2D array</a>. You want to be doing something like that in your code. <code>estado</code> should be a pointer to a double array instead.</p>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1464797738, "post_id": 37573764, "comment_id": 62634959, "body": "I think OP will be even more confused. The code is technically correct, but I doubt copying just the pointers is the intended behavior."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1464798011, "post_id": 37573764, "comment_id": 62635114, "body": "@2501 Suspect you are correct.  With what OP posted, this at least takes care of allocating the right size.  Should code be copying what <code>estado</code> points to (as an array) or replicating <code>estado</code> is TBD."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1464797573, "last_edit_date": 1464797573, "creation_date": 1464797265, "answer_id": 37573764, "question_id": 37572456, "link": "https://stackoverflow.com/questions/37572456/memcpy-not-working-correctly/37573764#37573764", "title": "memcpy() not working correctly", "body": "<p><code>memcpy(list-&gt;last-&gt;estado,estado,size*sizeof(int));</code> is not type/size consistent.</p>\n\n<p><code>estado</code> is type <code>int**</code><br>\n<code>list-&gt;last-&gt;estado</code> is type <code>int**</code>, the same as <code>estado</code> (good)<br>\n<code>size*sizeof(int)</code> is <code>size</code> being multiplied by the wrong size element.  </p>\n\n<p>Rather than an <code>int</code>, it should be the type the 2 pointers point to.  (<code>int*</code>)</p>\n\n<p>Recommend the following to avoid the wrong size element.</p>\n\n<pre><code>memcpy(list-&gt;last-&gt;estado,estado,size*sizeof *(list-&gt;last-&gt;estado));\n</code></pre>\n\n<hr>\n\n<p>Same problem for <code>calloc()</code>: wrong size.  Also no need for cast.</p>\n\n<pre><code>// list-&gt;last-&gt;estado = (int**)calloc(size,sizeof(int));\nlist-&gt;last-&gt;estado = calloc(size, sizeof *(list-&gt;last-&gt;estado));\n\n// For consistency\n// list-&gt;last-&gt; next = calloc(1,sizeof(element));\nlist-&gt;last-&gt; next = calloc(1,sizeof *(list-&gt;last-&gt; next));\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4997339, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153524020714560/picture?type=large", "display_name": "Nano Aguayo", "link": "https://stackoverflow.com/users/4997339/nano-aguayo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2309, "favorite_count": 1, "accepted_answer_id": 37572615, "answer_count": 2, "score": 1, "last_activity_date": 1464798732, "creation_date": 1464793624, "last_edit_date": 1464798732, "question_id": 37572456, "link": "https://stackoverflow.com/questions/37572456/memcpy-not-working-correctly", "title": "memcpy() not working correctly", "body": "<p>I am having trouble copying a 2D array in a function in c. Here is the code:</p>\n\n<pre><code>void Add(Lista* list,int** estado, char* sec, int size)\n{\n\n   if(list-&gt;last==NULL)\n   {\n    list-&gt;last = calloc(1,sizeof(element));\n    list-&gt;last-&gt; secuencia = sec;\n    list-&gt;last-&gt;next = NULL;\n    list-&gt;last-&gt;prev = NULL;\n    list-&gt;last-&gt; estado = (int**)calloc(size,sizeof(int));\n    memcpy(&amp;list-&gt;last-&gt;estado,&amp;estado,size*sizeof(int));\n\n    list-&gt;cantidad++;\n   }\n   else\n   {    \n    list-&gt;last-&gt; next = calloc(1,sizeof(element));\n    list-&gt;last-&gt; next -&gt; secuencia = sec;\n    list-&gt;last-&gt;next-&gt;next = NULL;\n    list-&gt;last-&gt;next-&gt;prev = list-&gt;last;\n    list-&gt;last =list-&gt;last-&gt;next;\n    list-&gt;last-&gt;estado = (int**)calloc(size,sizeof(int));\n    memcpy(&amp;list-&gt;last-&gt;estado,&amp;estado,size*sizeof(int));\n    list-&gt;cantidad++;\n   }\n\n}\n</code></pre>\n\n<p>Here are the structs Lista and element</p>\n\n<pre><code>typedef struct element\n{\n   char* secuencia;\n   struct element* next;\n   struct element* prev;\n   int** estado;\n}element;\n\ntypedef struct Lista\n{\n\n   int cantidad;    \n   element* last;\n\n}Lista;\n</code></pre>\n\n<p>The idea is to add \"elements\" in Lista, it is a basic list that returns the last added element. The problem is that every element stored in list returns the same \"estado\" (2D int array), if I modify one of the elements estado then every element estado gets the same modification. So, I dont know where is the problem, because memcpy() should copy the values and then make both arrays independent of each other, right?.</p>\n\n<p>PS: Sorry if it was not well explained, I speak Spanish</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>So, I change my code based on the answers to this:</p>\n\n<pre><code>void Add(Lista* list,int** estado, char* sec, int size)\n{\n\n   if(list-&gt;last==NULL)\n   {\n    list-&gt;last = calloc(1,sizeof(element));\n    list-&gt;last-&gt; secuencia = sec;\n    list-&gt;last-&gt;next = NULL;\n    list-&gt;last-&gt;prev = NULL;\n    list-&gt;last-&gt; estado = (int**)calloc(size,sizeof(int));\n    memcpy(list-&gt;last-&gt;estado,estado,size*sizeof(int));\n\n    list-&gt;cantidad++;\n   }\n   else\n   {    \n    list-&gt;last-&gt; next = calloc(1,sizeof(element));\n    list-&gt;last-&gt; next -&gt; secuencia = sec;\n    list-&gt;last-&gt;next-&gt;next = NULL;\n    list-&gt;last-&gt;next-&gt;prev = list-&gt;last;\n    list-&gt;last =list-&gt;last-&gt;next;\n    list-&gt;last-&gt;estado = (int**)calloc(size,sizeof(int));\n    memcpy(list-&gt;last-&gt;estado,estado,size*sizeof(int));\n    list-&gt;cantidad++;\n   }\n\n}\n</code></pre>\n\n<p>Now I haven't valgrind errors, but I keep getting the problem (when I modify one array the others get the modification)</p>\n\n<p><strong>EDIT2</strong></p>\n\n<p>So, I started checking the code and before the call to Add() there was an incorrect assignation of the array (always passed the same array to the function), that and the modification of EDIT1 solved my problem. </p>\n\n<p>PS2: I will look deeply into pointer, thanks </p>\n"}, {"tags": ["c", "arm", "reverse-engineering", "compiler-optimization", "jump-table"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1464793392, "post_id": 37572271, "comment_id": 62632037, "body": "IIRC, there are some differences in the ranges of some addressing modes between ARM and x86 that could explain this."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464793502, "post_id": 37572271, "comment_id": 62632121, "body": "I bet the x86 and ARM parts of GCC are written by different people..."}, {"owner": {"reputation": 1642, "user_id": 26730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa9ce9fcf3552c2c824308b0d371d8b?s=128&d=identicon&r=PG", "display_name": "cojocar", "link": "https://stackoverflow.com/users/26730/cojocar"}, "edited": false, "score": 0, "creation_date": 1464793687, "post_id": 37572271, "comment_id": 62632267, "body": "Yes, there are some differences. On ARM, you can use an immediate offset of max 4KB to address memory."}, {"owner": {"reputation": 5065, "user_id": 563188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z1wGD.png?s=128&g=1", "display_name": "unixsmurf", "link": "https://stackoverflow.com/users/563188/unixsmurf"}, "edited": false, "score": 2, "creation_date": 1464797444, "post_id": 37572271, "comment_id": 62634774, "body": "There are ARMs and there are ARMs. The answer you link to was explicitly talking about extreme-low-power-tiny-microcontrollers executing directly from flash. It would probably be useful to state in the question which instruction set and architecture profile you are building for. The compiler output for bare-metal T32 on a microcontroller has little bearing on codegen for A32 under Linux on an applications processor."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464801267, "post_id": 37572271, "comment_id": 62637076, "body": "x86[-64] has variable-length instructions. In particular, it is possible to load a full-sized register <i>in a single instruction</i>. ARM, in contrast, only has 16- and 32-bit instructions, which simply cannot hold a full register immediate. Therefore, ARM tends to use small PC-relative offsets to load constants from literal-pools embedded in the text-section, while x86 embeds the constant in the immediate of an instruction (which naturally ends up in the text-section as well)."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464806454, "post_id": 37572271, "comment_id": 62639933, "body": "@EOF That is true in some contexts.  However, here both need to use a table to get some information about the case code size/offset.  There is no way the x86 can embed this information in a single instruction.  I guess here the <code>PC</code> comes loaded for free.  If you had to load a base table address on the ARM then your comment would apply."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1464809290, "post_id": 37572271, "comment_id": 62641316, "body": "@artlessnoise: The point I was trying to make is that on ARM, putting literal pools into the text-section to be accessed via an offset from PC is common and &quot;idiomatic&quot;. On x86, there is no need to put such a table into the text-section, because you can encode an arbitrary address (with arbitrary relocations at load-time) in a single instruction."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1464930381, "post_id": 37572271, "comment_id": 62696668, "body": "I think the 4KB maximum reach is the reason. Functions can easily be longer than 4KB, so ARM is forced to put the jump table inside the function. x64 has a 2GB reach, which lets you put the jump table outside the function."}], "answers": [{"comments": [{"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1464807372, "post_id": 37576229, "comment_id": 62640399, "body": "I would agree with <a href=\"http://stackoverflow.com/users/563188/unixsmurf\">unixsmurf</a>, that caching issues depend on the ARM CPU (unified or separate code/data for instance)."}, {"owner": {"reputation": 1642, "user_id": 26730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa9ce9fcf3552c2c824308b0d371d8b?s=128&d=identicon&r=PG", "display_name": "cojocar", "link": "https://stackoverflow.com/users/26730/cojocar"}, "edited": false, "score": 0, "creation_date": 1464861162, "post_id": 37576229, "comment_id": 62662029, "body": "I agree with @artless, the fact that <code>PC</code> is almost a general purpose register seems to have a big role. I also tested on MIPS, and the jump table is placed in <code>.rodata</code> section. On MIPS, one does not have <i>easy</i> access to <code>PC</code>."}], "tags": [], "owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "is_accepted": true, "score": 3, "last_activity_date": 1464807054, "last_edit_date": 1464807054, "creation_date": 1464805732, "answer_id": 37576229, "question_id": 37572271, "link": "https://stackoverflow.com/questions/37572271/switch-cases-jump-table-position-within-code-on-arm/37576229#37576229", "title": "Switch case&#39;s jump table position within code on ARM", "body": "<p>Mainly this has to do with RISC vs CISC philosophy.  On the ARM the PC is almost a general purpose register.  You can see that with <code>add r2, pc, #4</code>; this puts the address of the table in <code>r2</code>.  Since the table is loaded via the PC, it needs to go with the code.  A simpler switch is possible,</p>\n\n<pre><code>     ldr     r1, [r1, pc]  ; get table data via 'pc'\n     add     pc, r1        ; do switch\ntable: \n     .word offset_first_case ; ... etc.\n</code></pre>\n\n<p>The above is completely <code>PC</code> relative.  It looks like your code might need a relocation.  If the case code is highly symmetric, a table might not even be needed just <code>pc += case * case_code_size</code>.</p>\n\n<p>Some ARM CPUs support instructions like <code>xlat</code> and a switch/case implementation may depend on the compiler, target ARM/x86 CPU, the data type and the density of the cases.  For instance, the table might contain 'case,case_offset' and be sorted so a binary search is performed in the 'sparse case' case.</p>\n\n<hr>\n\n<p>Note: The ARM <code>pc</code> is two instructions (eight bytes) ahead due to the original ARM pipeline size.  ARM maintains this offset when using the <code>PC</code> in order to stay compatible.</p>\n"}], "owner": {"reputation": 1642, "user_id": 26730, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fa9ce9fcf3552c2c824308b0d371d8b?s=128&d=identicon&r=PG", "display_name": "cojocar", "link": "https://stackoverflow.com/users/26730/cojocar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1847, "favorite_count": 3, "accepted_answer_id": 37576229, "answer_count": 1, "score": 2, "last_activity_date": 1469079838, "creation_date": 1464793056, "last_edit_date": 1495539857, "question_id": 37572271, "link": "https://stackoverflow.com/questions/37572271/switch-cases-jump-table-position-within-code-on-arm", "title": "Switch case&#39;s jump table position within code on ARM", "body": "<p>In C/C++ a switch statement can be lowered by the compiler to <a href=\"https://stackoverflow.com/questions/1837656/jump-table-switch-case-question\">a jump table</a>. I noticed a difference of placement of the jump table between ARM and x86.</p>\n\n<h2>x86</h2>\n\n<p>For x86 (And x86_64) the jump table is often placed <strong>outside</strong> of the function (e.g. .rodata)</p>\n\n<pre><code>  4005e0:       48 8b 45 d8             mov    -0x28(%rbp),%rax\n  4005e4:       48 8b 0c c5 b0 0c 40    mov    0x400cb0(,%rax,8),%rcx\n  4005eb:       00 \n  4005ec:       ff e1                   jmpq   *%rcx\n  4005ee:       8b 45 e8                mov    -0x18(%rbp),%eax\n  4005f1:       83 e8 66                sub    $0x66,%eax\n</code></pre>\n\n<h2>ARM</h2>\n\n<p>For ARM the jump table is <strong>interleaved</strong> with function's code.</p>\n\n<pre><code> 15c:   e28f2004        add     r2, pc, #4\n 160:   e7911002        ldr     r1, [r1, r2]\n 164:   e1a0f001        mov     pc, r1\n 168:   000001a4        .word   0x000001a4\n 16c:   000001b4        .word   0x000001b4\n 170:   000001e4        .word   0x000001e4\n 174:   00000214        .word   0x00000214\n 178:   00000214        .word   0x00000214\n 17c:   00000214        .word   0x00000214\n 180:   00000214        .word   0x00000214\n 184:   00000214        .word   0x00000214\n 188:   000001c4        .word   0x000001c4\n 18c:   000001f4        .word   0x000001f4\n</code></pre>\n\n<p>The above code was generated with <code>clang 3.5 -target arm-none-eabi -march=armv7</code>, but similar code is generated with <code>gcc</code>.</p>\n\n<h2>MIPS</h2>\n\n<p>For completeness, here's the code for a switch statement on MIPS. The jump table is placed in the <code>.rodata</code> section.</p>\n\n<pre><code> 4002b8:    2c85000b    sltiu   a1,a0,11       \n 4002bc:    afc40018    sw  a0,24(s8)       //local var that we switch on \n 4002c0:    10a00021    beqz    a1,400348 &lt;main0+0xb4&gt; // default case\n 4002c4:    00000000    nop\n 4002c8:    8fc10018    lw  at,24(s8)      //the var that we switch on is in at\n 4002cc:    00011080    sll v0,at,0x2      // v0 = at&lt;&lt;2\n 4002d0:    3c030040    lui v1,0x40        // v1 = 0x40&lt;&lt;16\n 4002d4:    00431021    addu    v0,v0,v1   // v0 = (at&lt;&lt;2) + v1 \n 4002d8:    8c421848    lw  v0,6216(v0)    // v0 = *((at&lt;&lt;2)+0x401848)\n 4002dc:    00400008    jr  v0             // jump\n 4002e0:    00000000    nop\n</code></pre>\n\n<p>The address of the jumptable (<code>0x00401848</code>) is in <code>.rodata</code>.</p>\n\n<pre><code> $ readelf -e /tmp/muti-sw.mips.o  | grep .rodata\n [ 7] .rodata           PROGBITS        00401848 001848 00069a 00   A  0   0  4\n</code></pre>\n\n<p>The above code was generated with clang 3.9.</p>\n\n<h2>Question</h2>\n\n<p>Why on ARM architecture the jump table is often interleaved with function's code and on x86 not?</p>\n\n<p><a href=\"https://stackoverflow.com/a/35846099/26730\">This answer implies</a> that the way the cache is working on ARM has to do with it. Are there any other reasons?</p>\n"}, {"tags": ["c", "syntax", "bitwise-operators", "conditional-operator"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 6, "creation_date": 1464793069, "post_id": 37572130, "comment_id": 62631794, "body": "Bitwise operators don&#39;t short-circuit."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1464793088, "post_id": 37572130, "comment_id": 62631809, "body": "Bitwise operators and Logical operators are different. What do you mean with &quot;instead of&quot;?  Show some examples"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464793106, "post_id": 37572130, "comment_id": 62631821, "body": "Short circuit is a big difference."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1464793112, "post_id": 37572130, "comment_id": 62631825, "body": "|| and &amp;&amp; are logical operators, they return true or false, &amp; and | are bitwise, they don&#39;t just return 0 or 1"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 6, "creation_date": 1464793175, "post_id": 37572130, "comment_id": 62631871, "body": "<code>1 &amp;&amp; 2</code> is true, <code>1 &amp; 2</code> is 0 (false)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1464793185, "post_id": 37572130, "comment_id": 62631880, "body": "There&#39;s a huge difference between <code>&amp;</code> and <code>&amp;&amp;</code> operators.  For example:  <code>0x01 &amp; 0x10</code> is <code>0</code>, <code>0x01 &amp;&amp; 0x10</code> is <code>1</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1464793257, "post_id": 37572130, "comment_id": 62631929, "body": "@IngoLeonhardt I was about to write something similar as an answer :) But I guess you should do it with an addition of short-circuiting.."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1464799819, "post_id": 37572130, "comment_id": 62636245, "body": "You can turn all the values into boolean 0 and 1 using <code>!!</code>, then <code>&amp;</code> and <code>|</code> will behave like non-short-circuiting versions of <code>&amp;&amp;</code> and <code>||</code>. For example, <code>1 &amp; 2</code> is <code>0</code>, but <code>!!1 &amp; !!2</code> is <code>1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464793621, "post_id": 37572397, "comment_id": 62632204, "body": "Neither <code>true</code> nor <code>false</code> are C keywords."}, {"owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1464793678, "post_id": 37572397, "comment_id": 62632255, "body": "@AndrewHenle: That is why they do not appear with a fixed font in my answer."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464793716, "post_id": 37572397, "comment_id": 62632283, "body": "WT... first time I see an &quot;wiki&quot; answer. How can it be done?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1464793757, "post_id": 37572397, "comment_id": 62632314, "body": "@LPs: There&#39;s a checkmark to the bottom right of the answer text box. You won&#39;t get rep from the answer but open it up for everyone to edit."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464793784, "post_id": 37572397, "comment_id": 62632334, "body": "@mouviciel <i>That is why they do not appear with a fixed font in my answer.</i>  Someone unfamiliar with C isn&#39;t going to notice that."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1464793941, "post_id": 37572397, "comment_id": 62632438, "body": "@AndrewHenle Why would it matter?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464794073, "post_id": 37572397, "comment_id": 62632534, "body": "@EugeneSh <i>Why would it matter?</i>  Because the logical operators <code>&amp;&amp;</code> and <code>||</code> produce either <code>0</code> or <code>1</code>, not some amorphous &quot;true&quot; or &quot;false&quot;, and the bitwise operators produce the full bitwise-or or -and of the two operands.  Additionally, the logical &#39;||&#39; can short circuit evaluation of the second operand, while the bitwise <code>|</code> does not.  They are significantly different."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1464794311, "post_id": 37572397, "comment_id": 62632706, "body": "@AndrewHenle: We have been using &quot;true&quot; as colloquial synonym for &quot;something not equal to <code>0</code>&quot; in C for ages, <i>because</i> there is no <code>true</code> keyword with a more well-defined meaning... (Of course, now there is <code>&lt;stdbool.h&gt;</code> defining the <i>macro</i> <code>true</code> to <code>1</code>...)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1464794751, "post_id": 37572397, "comment_id": 62633043, "body": "@DevSolar Colloquialisms are fine in casual conversation.  But precision matters in code."}], "tags": [], "owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "is_accepted": true, "score": 4, "last_activity_date": 1464794059, "last_edit_date": 1464794059, "creation_date": 1464793439, "answer_id": 37572397, "question_id": 37572130, "link": "https://stackoverflow.com/questions/37572130/can-i-use-bitwise-operators-instead-of-conditional-operators-in-c/37572397#37572397", "title": "Can I use bitwise operators instead of conditional operators in C?", "body": "<p>As pointed out in comments:</p>\n\n<blockquote>\n  <p><code>1 &amp;&amp; 2</code> is true, <code>1 &amp; 2</code> is false.</p>\n</blockquote>\n\n<p>Also,</p>\n\n<blockquote>\n  <p>Bitwise operators don't short-circuit.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1464793521, "creation_date": 1464793521, "answer_id": 37572422, "question_id": 37572130, "link": "https://stackoverflow.com/questions/37572130/can-i-use-bitwise-operators-instead-of-conditional-operators-in-c/37572422#37572422", "title": "Can I use bitwise operators instead of conditional operators in C?", "body": "<pre><code>if (3 &amp; 5) // also true\n</code></pre>\n\n<p>Yes because the result of bitwise <code>&amp;</code> is <code>1</code></p>\n\n<p>Using 8 bit:</p>\n\n<pre><code>0b00000101 &amp;\n0b00000011\n------------\n0b00000001\n</code></pre>\n\n<p>But what <code>if ( 2 &amp; 5 )</code></p>\n\n<pre><code>0b00000010 &amp;\n0b00000101\n------------\n0b00000000\n</code></pre>\n\n<p>So it is <code>false</code> while <code>if ( 2 &amp;&amp; 5)</code> still <code>true</code>;</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 3293462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8b7d5f07031c7deefbbc9e08f7b762f?s=128&d=identicon&r=PG&f=1", "display_name": "user3293462", "link": "https://stackoverflow.com/users/3293462/user3293462"}, "is_accepted": false, "score": 0, "last_activity_date": 1464793549, "creation_date": 1464793549, "answer_id": 37572433, "question_id": 37572130, "link": "https://stackoverflow.com/questions/37572130/can-i-use-bitwise-operators-instead-of-conditional-operators-in-c/37572433#37572433", "title": "Can I use bitwise operators instead of conditional operators in C?", "body": "<p>Logical operators and bitwise operators are quite different. Logical operators return a boolean value (either 0 or 1) while bitwise operators return an integer based on applying that bitwise operator bit by bit. Example: 15 &amp; 8 = 8, while 15 &amp;&amp; 8 = 1. Syntactically you can use bitwise operators inplace of logical operators but semantically it will be wrong. </p>\n"}], "owner": {"reputation": 1039, "user_id": 3402827, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/8o0Qb.jpg?s=128&g=1", "display_name": "Amr Ayman", "link": "https://stackoverflow.com/users/3402827/amr-ayman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "closed_date": 1464793704, "accepted_answer_id": 37572397, "answer_count": 3, "score": 1, "last_activity_date": 1464794059, "creation_date": 1464792736, "last_edit_date": 1464793192, "question_id": 37572130, "link": "https://stackoverflow.com/questions/37572130/can-i-use-bitwise-operators-instead-of-conditional-operators-in-c", "closed_reason": "Duplicate", "title": "Can I use bitwise operators instead of conditional operators in C?", "body": "<p>Can I use &amp; and | instead of &amp;&amp; and || in the C language family ? This won't work with objects ofcourse. Is there any difference ? If there isn't, then why do the conditional operators exist ?</p>\n\n<p>For example:</p>\n\n<pre><code>if (3 &amp;&amp; 5) // true\nif (3 &amp; 5) // also true\n</code></pre>\n"}, {"tags": ["c", "sockets", "server"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 1, "creation_date": 1464792478, "post_id": 37571946, "comment_id": 62631365, "body": "first of all you should print the errno in all error cases."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1464792507, "post_id": 37571946, "comment_id": 62631393, "body": "[sigh] what happens, what gets printed out, what is perror/errno?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1464792527, "post_id": 37571946, "comment_id": 62631408, "body": ".. for example instead of <code>printf(&quot;\\n Error : Connect Failed \\n&quot;);</code> use <code>perror(&quot;connect() failed&quot;);</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1464792565, "post_id": 37571946, "comment_id": 62631434, "body": ".. and do that for all system calls."}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1464792759, "post_id": 37572111, "comment_id": 62631573, "body": "LOL - OP must have slipped up when copy/pasting from wherever.. ;)"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 2, "last_activity_date": 1464793241, "last_edit_date": 1495535338, "creation_date": 1464792699, "answer_id": 37572111, "question_id": 37571946, "link": "https://stackoverflow.com/questions/37571946/how-to-connect-to-socket-c/37572111#37572111", "title": "How to connect to socket (c)?", "body": "<p>[Please also take into account the important advise given in <em><a href=\"https://stackoverflow.com/users/6304107/j-carl-zeigler\">J Carl Zeigler</a></em>'s <a href=\"https://stackoverflow.com/a/37572243/694576\">answer here</a>!]</p>\n\n<p>You want to delete this line</p>\n\n<pre><code>memset(&amp;serv_addr, '0', sizeof(serv_addr));\n</code></pre>\n\n<p>as it just overwrites what you initialised <code>serv_addr</code> to before by doing this:</p>\n\n<pre><code>serv_addr.sin_family = AF_INET;\nserv_addr.sin_addr.s_addr = INADDR_ANY;\nserv_addr.sin_port = htons( 8888 );\n</code></pre>\n\n<hr>\n\n<p>Just guessing that you probably wanted to zero-out the target address member you are trying to set here:</p>\n\n<pre><code>if(inet_pton(AF_INET,\"192.168.0.1\", &amp;serv_addr.sin_addr)&lt;=0)\n</code></pre>\n\n<p>This would then have looked like this:</p>\n\n<pre><code>memset(&amp;serv_addr.sin_addr, 0, sizeof(serv_addr.sin_addr));\n</code></pre>\n\n<p>(note the usage of the value <code>0</code> instead of the character <code>'0'</code>, which most likely evaluates to the value <code>48</code> if using ASCII on your system)</p>\n\n<p>Any ways zeroing it out before is not needed, as <code>inet_pton()</code> takes care of fully properly setting the <code>sin_addr</code> member.</p>\n\n<hr>\n\n<p>And the next thing you might like to do is learn how to use a debugger to fix such stxxid issues yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 6304107, "user_type": "registered", "profile_image": "https://graph.facebook.com/1148710255171496/picture?type=large", "display_name": "J Carl Zeigler", "link": "https://stackoverflow.com/users/6304107/j-carl-zeigler"}, "is_accepted": true, "score": 2, "last_activity_date": 1464792999, "creation_date": 1464792999, "answer_id": 37572243, "question_id": 37571946, "link": "https://stackoverflow.com/questions/37571946/how-to-connect-to-socket-c/37572243#37572243", "title": "How to connect to socket (c)?", "body": "<p>Try:</p>\n\n<pre><code>if( connect(sockfd, (struct sockaddr *)&amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n{\n   printf(\"\\n Error : Connect Failed \\n\");\n   return 1;\n}\n</code></pre>\n\n<p><a href=\"http://www.cs.rpi.edu/~moorthy/Courses/os98/Pgms/socket.html\" rel=\"nofollow\">Here is a good tutorial</a></p>\n"}], "owner": {"reputation": 71, "user_id": 5809736, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208395003049131/picture?type=large", "display_name": "com", "link": "https://stackoverflow.com/users/5809736/com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1464812261, "accepted_answer_id": 37572243, "answer_count": 2, "score": -1, "last_activity_date": 1464793241, "creation_date": 1464792316, "question_id": 37571946, "link": "https://stackoverflow.com/questions/37571946/how-to-connect-to-socket-c", "closed_reason": "Not suitable for this site", "title": "How to connect to socket (c)?", "body": "<p>I cannot connect to my server program via sockets.</p>\n\n<p>My server program works fine with telnet connections.</p>\n\n<p>I cant spot the problem, any ideas?</p>\n\n<pre><code>int main(void){\nint sockfd =0;\nchar recvBuff[1024];\nstruct sockaddr_in serv_addr; \n\nserv_addr.sin_family = AF_INET;\nserv_addr.sin_addr.s_addr = INADDR_ANY;\nserv_addr.sin_port = htons( 8888 );\n\nmemset(recvBuff, '0',sizeof(recvBuff));\nif((sockfd = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)\n{\n    printf(\"\\n Error : Could not create socket \\n\");\n    return 1;\n} \n\nmemset(&amp;serv_addr, '0', sizeof(serv_addr));\n\nif(inet_pton(AF_INET,\"192.168.0.1\", &amp;serv_addr.sin_addr)&lt;=0)\n{\n    printf(\"\\n inet_pton error occured\\n\");\n    return 1;\n} \n\nif( connect(sockfd, (struct sockaddr *)&amp;serv_addr.sin_addr, sizeof(serv_addr.sin_addr)) &lt; 0)\n{\n   printf(\"\\n Error : Connect Failed \\n\");\n   return 1;\n} \n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "eclipse", "arduino", "avr"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1464816243, "post_id": 37571841, "comment_id": 62644963, "body": "Making an educated guess, I&#39;d would say that you&#39;re not initializing the memory location where your string literals are stored. (This should be done before <code>main</code>, but normally shouldn&#39;t be your job, so this might be a bug - though unlikely - in avr-libc). The array (probably on the stack) might get initialized with direct compiler generated constant values, and not the literal."}, {"owner": {"reputation": 576, "user_id": 2770573, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Gd9LV.png?s=128&g=1", "display_name": "Max R.", "link": "https://stackoverflow.com/users/2770573/max-r"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1464864654, "post_id": 37571841, "comment_id": 62664404, "body": "Hey Daniel, thanks for responding. Well, I actually don&#39;t know where the error was, but I fixed it by creating a new C Project and copied all my source to the new project. So it was any of the compiler setting.."}], "owner": {"reputation": 576, "user_id": 2770573, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Gd9LV.png?s=128&g=1", "display_name": "Max R.", "link": "https://stackoverflow.com/users/2770573/max-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464792751, "creation_date": 1464792024, "last_edit_date": 1464792751, "question_id": 37571841, "link": "https://stackoverflow.com/questions/37571841/since-avr-libc-2-0-i-have-problems-process-direct-char-arrays", "title": "since avr-libc 2.0 I have problems process direct char arrays", "body": "<p>I use WinAVR with eclipse to program an Arduino (AVR ATmega 328p). Since I updated the AVR-LibC to 2.0 I am not able to process direct char-arrays (Strings).\nWhen I try <br>\n<code>char test[10] = \"hallo\";\nRS232_SendString(test);</code><br>\nit works and sends (68 61 6C 6C ...), but when i try\n<br><code>RS232_SendString(\"hallo\");</code><br>\nit just sends nothing (00 00 00 00 ...).</p>\n\n<p>Does anyone knows whats the problem and how to solve it? </p>\n\n<p>Thanks in advance,\nSpider</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1464792463, "post_id": 37571798, "comment_id": 62631356, "body": "Take a look <a href=\"http://stackoverflow.com/questions/31437095/conditional-execution-based-on-short-circuit-logical-operation\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 5, "last_activity_date": 1464792112, "creation_date": 1464792112, "answer_id": 37571874, "question_id": 37571798, "link": "https://stackoverflow.com/questions/37571798/is-the-order-of-the-boolean-expressions-in-if-statement-fixed/37571874#37571874", "title": "Is the order of the boolean expressions in if statement fixed?", "body": "<p>Yes. It's guaranteed. It's called <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"noreferrer\">\"short circuit\"</a> evaluation.</p>\n\n<p>From C11 draft, <em>6.5.14 Logical OR operator</em>:</p>\n\n<blockquote>\n  <p>Unlike the bitwise | operator, <strong>the || operator guarantees\n  left-to-right evaluation</strong>; if the second operand is evaluated, there is\n  a sequence point between the evaluations of the first and second\n  operands. If the first operand compares unequal to 0, the second\n  operand is not evaluated.</p>\n</blockquote>\n\n<p>(emphasis mine).</p>\n"}], "owner": {"reputation": 441, "user_id": 1642908, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21f21756513cb24f3d66e7ea2f21b722?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/1642908/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 37571874, "answer_count": 1, "score": 3, "last_activity_date": 1464792313, "creation_date": 1464791916, "last_edit_date": 1464792313, "question_id": 37571798, "link": "https://stackoverflow.com/questions/37571798/is-the-order-of-the-boolean-expressions-in-if-statement-fixed", "title": "Is the order of the boolean expressions in if statement fixed?", "body": "<p>Is the order of <code>boolean</code> expressions in this <code>if</code> statement fixed?</p>\n\n<pre><code>if(boolean_expression_1 || boolean_expression_2) {\n\n}\n</code></pre>\n\n<p>Is <code>boolean_expression_1</code> always evaluated before <code>boolean_expression_2</code>?  Is the order of evaluation a standard in <code>C</code>?</p>\n"}, {"tags": ["c", "linux", "segmentation-fault", "ubuntu-14.04"], "comments": [{"owner": {"reputation": 34174, "user_id": 65464, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1fc3a85db4ff7618a7639742f356b3b?s=128&d=identicon&r=PG", "display_name": "Erich Kitzmueller", "link": "https://stackoverflow.com/users/65464/erich-kitzmueller"}, "edited": false, "score": 3, "creation_date": 1464789589, "post_id": 37570863, "comment_id": 62629056, "body": "<code>strcat(pathInputFile, &quot;.binary&quot;);</code> overwrites memory that hasn&#39;t been allocated by your program."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3646905"}, "reply_to_user": {"reputation": 34174, "user_id": 65464, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1fc3a85db4ff7618a7639742f356b3b?s=128&d=identicon&r=PG", "display_name": "Erich Kitzmueller", "link": "https://stackoverflow.com/users/65464/erich-kitzmueller"}, "edited": false, "score": 0, "creation_date": 1464789956, "post_id": 37570863, "comment_id": 62629360, "body": "So How can i fix it?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1464790271, "post_id": 37570863, "comment_id": 62629612, "body": "@user3646905 read a good C textbook or follow a tutorial. Learn about pointers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1464790306, "post_id": 37570863, "comment_id": 62629646, "body": "Allocate enough memory for the arguemnt, the extension, and a terminator, and, check the results of <code>fopen</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1464790404, "post_id": 37570863, "comment_id": 62629735, "body": "And your typedef <code>typedef char* __string</code>is a bad idea. It makes believe that there is a &quot;string&quot; type, but actually <code>__string</code>is a mere pointer to char."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1464791603, "post_id": 37570863, "comment_id": 62630689, "body": "Do not start your own identifiers with two underscore! Identifiers starting with two underscores (like <code>__string</code>) are reserved for internal use by the standard library."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1464792409, "last_edit_date": 1464792409, "creation_date": 1464790338, "answer_id": 37571196, "question_id": 37570863, "link": "https://stackoverflow.com/questions/37570863/reading-2-byte-at-a-time-from-a-binary-file/37571196#37571196", "title": "Reading 2 byte at a time from a binary file", "body": "<p>You have no room to concatenate extention to path so you have to create space for that.</p>\n\n<p>One solution could be:</p>\n\n<pre><code>char ext[] = \".binary\";\npathOutputFile = strdup(arg_path);\nif (pathOutputFile != NULL)\n{\n   pathOutputFile = realloc(pathOutputFile, strlen(arg_path) + sizeof(ext));\n   if (pathOutputFile != NULL)\n   {\n       pathOutputFile = strcat(pathInputFile, ext);\n\n\n      // YOUR STUFF\n   }\n\n   free(pathOutputFile);\n}\n</code></pre>\n\n<p>Side note: <code>typedef</code> a pointer is not a good idea...</p>\n"}, {"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464795268, "post_id": 37572483, "comment_id": 62633409, "body": "Your code is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behavior</a> you failed to copy mine.... ;)"}], "tags": [], "owner": {"reputation": 170, "user_id": 3970215, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/52f435adcbf4b73dbf24bca03ceb2dec?s=128&d=identicon&r=PG&f=1", "display_name": "Adonaim", "link": "https://stackoverflow.com/users/3970215/adonaim"}, "is_accepted": true, "score": -1, "last_activity_date": 1464793699, "creation_date": 1464793699, "answer_id": 37572483, "question_id": 37570863, "link": "https://stackoverflow.com/questions/37570863/reading-2-byte-at-a-time-from-a-binary-file/37572483#37572483", "title": "Reading 2 byte at a time from a binary file", "body": "<p>change your typedef to typedef char* __charptr </p>\n\n<pre><code>void rw_binaryfile(__charptr arg_path){\n\n    FILE *inputFile;\n    FILE *outputFile;\n\n    __charptr extension = \".binary\";\n    __charptr pathOutputFile = strdup(arg_path);\n\n    if (pathOutputFile != NULL){\n        pathOutputFile = realloc(pathOutputFile, strlen(arg_path) + sizeof(extension));\n\n        if (pathOutputFile != NULL){\n\n            pathOutputFile = strcat(pathOutputFile, \".binary\");\n\n            inputFile = fopen(arg_path, \"rb\");\n            outputFile = fopen(pathOutputFile, \"wb\");\n\n            write_file(inputFile, outputFile);\n\n            }\n    }\n}\n\nvoid write_file(FILE *read, FILE *write){\n    int ch;\n    ch = getc(read);\n    while (ch != EOF){\n        fprintf(write, \"%x\" , ch);\n        ch = getc(read);\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3646905"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 37572483, "answer_count": 2, "score": 2, "last_activity_date": 1464793699, "creation_date": 1464789482, "question_id": 37570863, "link": "https://stackoverflow.com/questions/37570863/reading-2-byte-at-a-time-from-a-binary-file", "title": "Reading 2 byte at a time from a binary file", "body": "<p>I have an elf file that called example. I wrote following code which it's read the content of the example file in the binary mode and then I wanted to save their content in another file called example.binary. But when I run the following program it shows me a segmentation fault. What's wrong with this program? I can't find out my mistake. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// typedef macro\ntypedef char* __string;\n\n//Function prototypes\nvoid readFileToMachine(__string arg_path);\n\n\nint main(int argc, char *argv[]) {\n\n    __string pathBinaryFile;\n\n    if(argc != 2){\n        printf(\"Usage : ./program file.\\n\");\n        exit(1);\n    }\n\n    pathBinaryFile = argv[1];\n\n    readFileToMachine(pathBinaryFile);\n\n    return EXIT_SUCCESS;\n}\n\nvoid readFileToMachine(__string arg_path){\n\n    int ch;\n    __string pathInputFile = arg_path;\n    __string pathOutputFile = strcat(pathInputFile, \".binary\");\n\n    FILE *inputFile = fopen(pathInputFile, \"rb\");\n    FILE *outputFile = fopen(pathOutputFile, \"wb\");\n\n    ch = getc(inputFile);\n\n    while (ch != EOF){\n        fprintf(outputFile, \"%x\" , ch);\n        ch = getc(inputFile);\n    }\n\n    fclose(inputFile);\n    fclose(outputFile);\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel", "heap", "linux-device-driver"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464791668, "post_id": 37570127, "comment_id": 62630749, "body": "Accessing a freed memory is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behavior</a>"}, {"owner": {"reputation": 109, "user_id": 5493002, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/729a4108dccc275b562cc5820dc90a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Sangpil Kim", "link": "https://stackoverflow.com/users/5493002/sangpil-kim"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464796831, "post_id": 37570127, "comment_id": 62634419, "body": "@LPs didn&#39;t undefined behavior means result is unexpected?(if I&#39;m understand correctly.) but this result always the same."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1464796882, "post_id": 37570127, "comment_id": 62634452, "body": "There are 3 types of memory allocators in the kernel: <code>slab</code>, <code>slub</code> and <code>slob</code>. With which one your kernel is configured? (CONFIG_SLAB, CONFIG_SLOB or CONFIG_SLUB)."}, {"owner": {"reputation": 109, "user_id": 5493002, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/729a4108dccc275b562cc5820dc90a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Sangpil Kim", "link": "https://stackoverflow.com/users/5493002/sangpil-kim"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1464797478, "post_id": 37570127, "comment_id": 62634802, "body": "@Tsyvarev Check out the kernel config I got CONFIG_SLUB=y"}, {"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "edited": false, "score": 0, "creation_date": 1464799264, "post_id": 37570127, "comment_id": 62635936, "body": "Do you always get related values in free memory and address of b?"}, {"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "edited": false, "score": 0, "creation_date": 1464799590, "post_id": 37570127, "comment_id": 62636129, "body": "Do you always get related values in free memory and address of b? If it is so, then make a third pointer two. and then check the result. I have got an idea who validity would depened on the experiement you perform."}, {"owner": {"reputation": 109, "user_id": 5493002, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/729a4108dccc275b562cc5820dc90a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Sangpil Kim", "link": "https://stackoverflow.com/users/5493002/sangpil-kim"}, "reply_to_user": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "edited": false, "score": 0, "creation_date": 1464799975, "post_id": 37570127, "comment_id": 62636332, "body": "@Mazhar address of b and value 0x001e7f430088ffff  varies in every execution. 8-bytes of unknown variable is always inserted."}, {"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "edited": false, "score": 0, "creation_date": 1464801171, "post_id": 37570127, "comment_id": 62637022, "body": "In this case these 8 bytes seems relevant. I just want you to tell me about values on other run."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1464801646, "post_id": 37570127, "comment_id": 62637301, "body": "It looks like an 8-byte amd64 pointer value. I assume it is a &quot;next&quot; pointer in a linked list of free blocks."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464806622, "post_id": 37570127, "comment_id": 62640016, "body": "Undefined means that what you find there is not predictible. On the same system in a different time, with other loaded modules or whatever you can find whatever randomly. What if another module/task take that memory and write something there in the time between free and b dereference."}, {"owner": {"reputation": 293, "user_id": 5393143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aebc438736c62df02f11e4235458a70e?s=128&d=identicon&r=PG&f=1", "display_name": "AnshuMan Gupta", "link": "https://stackoverflow.com/users/5393143/anshuman-gupta"}, "edited": false, "score": 0, "creation_date": 1465202885, "post_id": 37570127, "comment_id": 62785698, "body": "can you please try once to run the following  code  after disabling  SMP and use a spinlock i.e disable the preemption. that will confirm the undefined behavior whether it is effect of kfree or  kernel had allocated the memory chunk to any other thread."}], "answers": [{"comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1464798133, "post_id": 37573681, "comment_id": 62635200, "body": "The asker <b>intentionally</b> dereferences <code>free</code>-ed pointer, and asks about its content. I see no reason to remind him that such dereference shouldn&#39;t be used in real programs."}, {"owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1464799355, "post_id": 37573681, "comment_id": 62635987, "body": "@Tsyvarev you are right. I thought he could be new to this kind of situation. So if if it won&#39;t help, I will remove it."}], "tags": [], "owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1464801327, "last_edit_date": 1464801327, "creation_date": 1464797033, "answer_id": 37573681, "question_id": 37570127, "link": "https://stackoverflow.com/questions/37570127/what-happened-when-kfree-function-called/37573681#37573681", "title": "What happened when kfree function called", "body": "<pre><code>   b =a;\n</code></pre>\n\n<p>Which means both a and b points to same memory. Free any pointer will result in losing the memory from both pointers. and then this memory can contain any garbage value. </p>\n\n<pre><code>  free(a);\n  a=NULL;\n</code></pre>\n\n<p>Once freed no need to assign <code>NULL</code>. When you free a pointer, it means it is no more pointing to any memory.</p>\n\n<p>So if you need to avoid such behavior </p>\n\n<ol>\n<li><p>Either don't free pointer <code>a</code>. Just assign it <code>NULL</code> or another memory</p></li>\n<li><p>Or use <code>memcpy(b, a, sizeof(a));</code> function to copy values in <code>a</code>. But before that you have to allocate memory to <code>b</code></p></li>\n</ol>\n"}], "owner": {"reputation": 109, "user_id": 5493002, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/729a4108dccc275b562cc5820dc90a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Sangpil Kim", "link": "https://stackoverflow.com/users/5493002/sangpil-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1672, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464801327, "creation_date": 1464787653, "last_edit_date": 1464796991, "question_id": 37570127, "link": "https://stackoverflow.com/questions/37570127/what-happened-when-kfree-function-called", "title": "What happened when kfree function called", "body": "<p>I am testing kernel module that allocates memory using <code>kmalloc</code> to some variable and <code>memset</code> it's value and <code>free</code>.<br>\nHere is the code with zeroisation memory routine.</p>\n\n<pre><code>    unsigned char *a = (unsigned char *)kmalloc(256, GFP_KERNEL);\n    unsigned char *b;\n    int i;\n\n    for(i=0;i&lt;256;i++)\n    {\n       a[i]=(unsigned char)i;\n    }\n    // print variable a\n    printk(\"before zeroisation\\n\");\n    for(i=0;i&lt;255;i++)\n    {\n      printk(\"%02x\", a[i]);\n    }\n\n    // copy allocated address to variable b\n    b =a;\n\n    memset(a, 0x00, 256);\n    // print memset to zero\n    printk(\"memset variable a\\n\");\n    for(i=0;i&lt;255;i++)\n    {\n      printk(\"%02x\", b[i]);\n    }\n\n    free(a);\n    a=NULL;\n\n    // print free variable's address\n    printk(\"after zeroisation\\n\");\n    for(i=0;i&lt;255;i++)\n    {\n      printk(\"%02x\", b[i]);\n    }\n</code></pre>\n\n<p>and result is  </p>\n\n<pre><code>before zeroization  \n000102030405060708090a0b0c0d0e0f ...  \nmemset variable a\n00000000000000000000000000000000 ...  \nafter zeroization  \n001e7f430088ffff0000000000000000 ...  \n</code></pre>\n\n<p>It seems free of variable makes insert value of something's address in allocated area. 001e7f430088ffff -> ffff8800437f1e00 (in little endian)<br>\n Additionaly address of pointer of b is ffff8800437f0800<br>\n I know that dynamic memory allocation in heap memory has free-list made of double-linked list.<br>\n I think this is related to memory allocation process too.  </p>\n\n<p>I want to know the meaning of value 001e7f430088ffff and process of within <code>kfree</code> function.<br>\n thanks.  </p>\n"}, {"tags": ["c", "synchronization", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1464786565, "post_id": 37569571, "comment_id": 62626466, "body": "It&#39;s like asking if you only need to lock the front door of your house, the back door is only used for occasional visitors and isn&#39;t so important."}, {"owner": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 0, "creation_date": 1464786612, "post_id": 37569571, "comment_id": 62626506, "body": "see e.g. <a href=\"http://stackoverflow.com/questions/30150903/necessity-of-pthread-mutex\" title=\"necessity of pthread mutex\">stackoverflow.com/questions/30150903/necessity-of-pthread-mu&zwnj;&#8203;tex</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1464787071, "post_id": 37569571, "comment_id": 62626909, "body": "You could use <code>stdatomic.h</code>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1464789837, "post_id": 37569571, "comment_id": 62629256, "body": "Useful exercise: <a href=\"https://deadlockempire.github.io\" rel=\"nofollow noreferrer\">deadlockempire.github.io</a>"}], "answers": [{"comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1464786984, "post_id": 37569730, "comment_id": 62626845, "body": "The technical concepts that define &quot;ordering&quot; are &quot;happens-before&quot; and &quot;synchronizes-with&quot;."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1464800587, "post_id": 37569730, "comment_id": 62636682, "body": "The accesses do <i>not</i> have to ordered. If the accesses are atomic with <code>memory_order_relaxed</code>, they are not ordered."}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 9, "last_activity_date": 1464802876, "last_edit_date": 1464802876, "creation_date": 1464786717, "answer_id": 37569730, "question_id": 37569571, "link": "https://stackoverflow.com/questions/37569571/is-a-mutex-necessary-when-only-inc-decrementing-a-variable/37569730#37569730", "title": "Is a mutex necessary when only inc/decrementing a variable?", "body": "<p>The universal rule of concurrency is this: If a memory location is accessed concurrently in a non-atomic way, and not all accesses are reads, then the accesses must be ordered. Ordering can be imposed either by serializing access through locking a mutex, or by some lower-level operation like an ordered atomic access or an ordered fence.</p>\n\n<p>The only time you're allowed to have <em>unordered</em> accesses if <em>all</em> of the accesses are reads. E.g. multiple threads can read a (non-atomic) constant without ordering.</p>\n"}, {"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 4, "last_activity_date": 1499288506, "last_edit_date": 1499288506, "creation_date": 1464786785, "answer_id": 37569768, "question_id": 37569571, "link": "https://stackoverflow.com/questions/37569571/is-a-mutex-necessary-when-only-inc-decrementing-a-variable/37569768#37569768", "title": "Is a mutex necessary when only inc/decrementing a variable?", "body": "<p>You need to synchronize the access to the variables if the operations you are performing are not atomic.\nConsider a scenario of a single variable <code>a</code> having initial value of, say, 5.\nNow we have two threads T1 and T2, both want to increment it. How increment operation is broken down, in case it is not atomic (just an example, it could be some other way)?</p>\n\n<p>1) Read <code>a</code> value into a temp location.<br>\n2) Increment and write the temp location back into <code>a</code>.  </p>\n\n<p>Now consider a scenario T1 is performing this operation first, and then pre-empted by T2 after completing step 1 only:</p>\n\n<p>T1: 1) Read <code>a</code> into <code>temp1</code> => <code>temp1=5</code><br>\nT2: 1) Read <code>a</code> into <code>temp2</code> => <code>temp2=5</code><br>\nT2:  2) Write <code>temp2+1</code> into <code>a</code> => <code>a=6</code><br>\nT1:  2) Write <code>temp1+1</code> into <code>a</code> => <code>a=6</code>    </p>\n\n<p>So the final value of <code>a</code> will be <code>6</code> and not <code>7</code> as you would expect.</p>\n"}], "owner": {"reputation": 197, "user_id": 4054572, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/dmtbd.jpg?s=128&g=1", "display_name": "Davide R.", "link": "https://stackoverflow.com/users/4054572/davide-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 37569768, "answer_count": 2, "score": 3, "last_activity_date": 1499288506, "creation_date": 1464786312, "question_id": 37569571, "link": "https://stackoverflow.com/questions/37569571/is-a-mutex-necessary-when-only-inc-decrementing-a-variable", "title": "Is a mutex necessary when only inc/decrementing a variable?", "body": "<p>I have a struct with some integers field, like </p>\n\n<pre><code>struct s {\n    int a;\n    int b;\n    int c;\n    int max;\n};\nstruct s mystruct = {0, 0, 0, 0}; // Global var\n</code></pre>\n\n<p>And then I have N threads that sometimes have to do things like <code>++</code> or <code>--</code> on the first three fields, and sometimes have to read them and then update the <code>max</code> field. Do I have to use a mutex here? And if yes, is it needed only when reading/updating <code>max</code> or always? Why? If I just increment or decrement the first three fields, does it matter if a thread runs before another?</p>\n"}, {"tags": ["c++", "c", "io", "xlsx"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1464786153, "post_id": 37569349, "comment_id": 62626117, "body": "OK, you put the headers (which are required for compilation) and DLLs (which are required for running) in the proper places. But did you put the <code>lib</code> files (which are required for linking) somewhere accessible, and did you set up your program&#39;s linker properties to link these in?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1464786213, "post_id": 37569349, "comment_id": 62626163, "body": "IOW, did you look at the <a href=\"http://stackoverflow.com/q/12573816/1782465\">FAQ on &quot;Unresolved symbol&quot;</a>?"}, {"owner": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "reply_to_user": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1464789335, "post_id": 37569349, "comment_id": 62628855, "body": "I didn&#39;t see any .lib files.... Unless that&#39;s what those .a files were for but I&#39;ve never seen a .lib file with such an extension. Edit: I&#39;m a turd. <a href=\"http://stackoverflow.com/questions/5965171/what-is-a-file-with-extension-a\" title=\"what is a file with extension a\">stackoverflow.com/questions/5965171/&hellip;</a> Yep. .a files are libraries XD"}, {"owner": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "reply_to_user": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1464790253, "post_id": 37569349, "comment_id": 62629598, "body": "Edit: But now how to link .a with visual studio... XD"}, {"owner": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "reply_to_user": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1464790417, "post_id": 37569349, "comment_id": 62629749, "body": "Nevermind, it was pretty easy."}], "owner": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 401, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464785777, "creation_date": 1464785777, "question_id": 37569349, "link": "https://stackoverflow.com/questions/37569349/xlsx-io-library-from-sourceforge-issue", "title": "Xlsx IO library (from sourceforge) issue", "body": "<p><a href=\"https://sourceforge.net/projects/xlsxio/\" rel=\"nofollow\">xlsx io from sourceforge</a></p>\n\n<p>Anyone know how to actually use this library?</p>\n\n<p>I took the time to download it and include it with a project.</p>\n\n<p>The problem is, when I try to compile, if I attempt to call any of the library's functions, I get the dreaded linking error: \"unresolved symbols\".</p>\n\n<p>I'm using Visual Studio Express 2013.</p>\n\n<p>To make this more clear, here's some sample code I've tried (that creates the linker error).</p>\n\n<pre><code>#include \"xlsxio_read.h\"\n\n\nint main(void){\n    xlsxioreader x = xlsxioread_open(\"input.xlsx\");\n}\n</code></pre>\n\n<p>And before anyone asks the standard inane questions, Yes I put the header files and their dll's into the appropriate directories before trying to include or use anything.</p>\n"}, {"tags": ["c", "swig", "ffi", "steamworks-api", "openvr"], "comments": [{"owner": {"reputation": 25, "user_id": 6236425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cbcd298c87e02c67b428630781ee656c?s=128&d=identicon&r=PG&f=1", "display_name": "Tribes", "link": "https://stackoverflow.com/users/6236425/tribes"}, "edited": false, "score": 0, "creation_date": 1464785880, "post_id": 37568362, "comment_id": 62625883, "body": "I saw that LibOVR also has a C API"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1464869875, "post_id": 37568362, "comment_id": 62667990, "body": "It depends heavily on the &quot;another language&quot;, which is?"}], "owner": {"reputation": 25, "user_id": 6236425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cbcd298c87e02c67b428630781ee656c?s=128&d=identicon&r=PG&f=1", "display_name": "Tribes", "link": "https://stackoverflow.com/users/6236425/tribes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469708069, "creation_date": 1464783278, "last_edit_date": 1469708069, "question_id": 37568362, "link": "https://stackoverflow.com/questions/37568362/using-the-openvr-library-from-c-ffi", "title": "Using the OpenVR library from C FFI", "body": "<p>I'm trying to use the openVR library from another language which only has ffi support for C.</p>\n\n<p>I saw that there is a C header with the following comment: \"Purpose: Header for flatted SteamAPI. Use this for binding to other languages.\"</p>\n\n<p>Any idea how to use it ?</p>\n\n<p>Thanks for the explanations</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464783571, "post_id": 37568161, "comment_id": 62623973, "body": "A macro identifier may not start with a number."}], "answers": [{"tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": true, "score": 2, "last_activity_date": 1465241696, "last_edit_date": 1465241696, "creation_date": 1464783470, "answer_id": 37568426, "question_id": 37568161, "link": "https://stackoverflow.com/questions/37568161/invalid-characters-in-c-preprocessors-macros/37568426#37568426", "title": "Invalid characters in C preprocessors/macros?", "body": "<p>It's your compiler that allows usage of <code>$</code> as an identifier. It's not standard and you shouldn't expect other compilers to provide it or your compiler to allow it, if you compile with <code>-pedantic</code> or similar. </p>\n\n<p>In the C11 draft's common extension appendix:</p>\n\n<blockquote>\n  <p><strong>J.5.2 Specialized identifiers</strong></p>\n  \n  <p><strong>1</strong>   Characters other than the underscore _, letters, and digits, that\n  are not part of the basic source character set (<em>such as the dollar sign $</em>, or characters in national character sets) may appear in an identifier (6.4.2).</p>\n</blockquote>\n\n<p><strong>Section 6.4.2</strong> shows what characters <em>every</em> conforming compiler has to\nsupport:</p>\n\n<pre><code>6.4.2 Identifiers\n6.4.2.1 General\nSyntax 1         identifier:\n                 identifier-nondigit\n                 identifier identifier-nondigit\n                 identifier digit\n         identifier-nondigit:\n                 nondigit\n                 universal-character-name\n                 other implementation-defined characters\n         nondigit: one of\n                _ a b            c    d    e    f     g    h    i    j     k    l    m\n                    n o          p    q    r    s     t    u    v    w     x    y    z\n                    A B          C    D    E    F     G    H    I    J     K    L    M\n                    N O          P    Q    R    S     T    U    V    W     X    Y    Z\n         digit: one of\n                0 1        2     3    4    5    6     7    8    9\n</code></pre>\n\n<p>You should restrict yourself to those.</p>\n"}, {"tags": [], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1464783474, "last_edit_date": 1495542159, "creation_date": 1464783474, "answer_id": 37568431, "question_id": 37568161, "link": "https://stackoverflow.com/questions/37568161/invalid-characters-in-c-preprocessors-macros/37568431#37568431", "title": "Invalid characters in C preprocessors/macros?", "body": "<p>Macro names should only consist of alphanumeric characters and underscores, i.e. 'a-z', 'A-Z', '0-9', and '_', and the first character should not be a digit. Some preprocessors also permit the dollar sign character '$', but you shouldn't use it. </p>\n\n<p>Also have look on this... <a href=\"https://stackoverflow.com/questions/369495/what-are-the-valid-characters-for-macro-names\">What are the valid characters for macro names?</a></p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464789553, "post_id": 37568445, "comment_id": 62629021, "body": "Wrong! It is not required by the standard, but the standard very well allows such additional characters, so for a specific implementation (e.g. gcc) they are very well valid characters."}], "tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1464783521, "creation_date": 1464783521, "answer_id": 37568445, "question_id": 37568161, "link": "https://stackoverflow.com/questions/37568161/invalid-characters-in-c-preprocessors-macros/37568445#37568445", "title": "Invalid characters in C preprocessors/macros?", "body": "<blockquote>\n  <p>It seems that <code>#define TE$T 8</code> is working, so <code>$</code> is valid.</p>\n</blockquote>\n\n<p>That's not true.  <code>$</code> is NOT a valid character for identifiers in standard C. Some compilers, e.g, GCC , allows <code>$</code> in identifiers as an extension. (See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Dollar-Signs.html#Dollar-Signs\" rel=\"nofollow\">Dollar Signs</a>)</p>\n\n<p>So you are asking the wrong question, there's nothing special for names in macros, all the preprocessor does is text replacement.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464789611, "post_id": 37568720, "comment_id": 62629069, "body": "Wrong! It is not required by the standard, but the standard very well allows such additional characters, so for a specific implementation (e.g. gcc) they are very well valid characters (not specific for macro names, btw.)."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464795161, "post_id": 37568720, "comment_id": 62633332, "body": "@Olaf : I did mention &quot;strict ISO C&quot; which doesn&#39;t allow anything other than standard features IMHO."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464803502, "post_id": 37568720, "comment_id": 62638381, "body": "Please read the cited paragraph carefully. The standard explicitly allows additional characters. Despite extensions which often violate the standard."}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1464785197, "last_edit_date": 1464785197, "creation_date": 1464784249, "answer_id": 37568720, "question_id": 37568161, "link": "https://stackoverflow.com/questions/37568161/invalid-characters-in-c-preprocessors-macros/37568720#37568720", "title": "Invalid characters in C preprocessors/macros?", "body": "<p>Consider somefille.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define NAM$ \"SomeName\"\nint main(void)\n{\nprintf(\"Name - %s\\n\",NAM$);\n\nreturn 0;\n}\n</code></pre>\n\n<p>Compiling the above with </p>\n\n<pre><code>gcc -pedantic somefille.c -o somefille\n</code></pre>\n\n<p>gives you</p>\n\n<pre><code>somefille.c:2:9: warning: '$' in identifier or number [enabled by default]\n #define NAM$ \"SomeName\"\n</code></pre>\n\n<p>This <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html\" rel=\"nofollow\">[ page ]</a> says.</p>\n\n<blockquote>\n  <p>-pedantic<br>\n      Issue all the warnings demanded by strict ISO C and ISO C++; reject all programs that use forbidden extensions, and some other\n  programs that do not follow ISO C and ISO C++. For ISO C, follows the\n  version of the ISO C standard specified by any -std option used.</p>\n</blockquote>\n\n<p>As per the strict standard the macro name must have no spaces in it, and it must conform to the same naming rules that C variables follow: Only letters, digits, and the underscore ( _ ) character can be used, and the first character cannot be a digit. <br></p>\n\n<p>The problem is that various compilers do not comply with this. An example is gcc which I mentioned above.</p>\n\n<p>Having said that, below rules are still obeyed:</p>\n\n<ol>\n<li><p>A macro name must not begin with a number, if you violate this you may get an error like : </p>\n\n<pre><code>error: macro names must be identifiers\n</code></pre></li>\n<li><p>A macro name must not contain spaces. For instance <code>#define FULL NAME \"Your name\"</code> gives you :</p>\n\n<pre><code>error: \u2018NAME\u2019 undeclared (first use in this function)\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 6345467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b22d59fb792e696bdbd416b3281b856?s=128&d=identicon&r=PG&f=1", "display_name": "A.Bigot", "link": "https://stackoverflow.com/users/6345467/a-bigot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1978, "favorite_count": 1, "closed_date": 1464790140, "accepted_answer_id": 37568426, "answer_count": 4, "score": 1, "last_activity_date": 1465241696, "creation_date": 1464782745, "last_edit_date": 1464794872, "question_id": 37568161, "link": "https://stackoverflow.com/questions/37568161/invalid-characters-in-c-preprocessors-macros", "closed_reason": "Duplicate", "title": "Invalid characters in C preprocessors/macros?", "body": "<p>What are the different <strong>invalid characters</strong> that I am not allowed use in a <strong>macro</strong> ?<br>\nIt seems that <code>#define TE$T 8</code> is working, so <code>$</code> is valid.<br>\nDoes somebody have a list of the invalid characters ? (or on the contrary the list of the valid ones).  </p>\n"}, {"tags": ["c", "linux", "process", "signals", "sigaction"], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 3, "last_activity_date": 1464783637, "last_edit_date": 1464783637, "creation_date": 1464782714, "answer_id": 37568150, "question_id": 37568033, "link": "https://stackoverflow.com/questions/37568033/how-to-set-more-than-one-flag-in-sigaction-sa-flags/37568150#37568150", "title": "How to set more than one flag in sigaction.sa_flags", "body": "<p><a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow\">The manual page</a> has the answer:</p>\n\n<blockquote>\n  <p>It is formed by the bitwise OR of zero or more of the following: [...]</p>\n</blockquote>\n\n<p>So you'd do something like</p>\n\n<pre><code>sa1.sa_flags = SA_NODEFER | SA_SIGINFO;\n</code></pre>\n\n<p>This way of representing multiple independent flags as single bits in an integer is very very common in all of programming, and certainly in C. It's easily available since bitwise manipulation is simple in C, and often desirable since it's a very light implementation.</p>\n\n<p>A more \"modern\" (verbose, and/or Bloaty McBloatface) approach might be to use bitfields in a structure:</p>\n\n<pre><code>struct sigaction {\n  /* ... */\n  struct {\n    unsigned int sa_nocldstop : 1;\n    unsigned int sa_nocldwait : 1;\n    unsigned int sa_nodefer : 1;\n    unsigned int sa_nostack : 1;\n    unsigned int sa_siginfo : 1;\n    /* ... */\n  } sa_flags;\n  /* ... */\n};\n</code></pre>\n\n<p>This makes the <code>sa_flags</code> member in <code>struct sigaction</code> itself be a <code>struct</code>, which consists of a bunch of 1-bit wide <code>unsigned int</code> members. This will typically compile down to the exact same bitwise code, but it's more clear.</p>\n\n<p>You'd set multiple flags by doing explicit sets:</p>\n\n<pre><code>sa1.sa_flags.sa_nodefer = 1;\nsa1.sa_flags.sa_siginfo = 1;\n</code></pre>\n\n<p>and you'd need some other way to make sure the rest got set to 0.</p>\n"}], "owner": {"reputation": 232, "user_id": 5546660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YK3mp.jpg?s=128&g=1", "display_name": "A. Harkous", "link": "https://stackoverflow.com/users/5546660/a-harkous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 1, "accepted_answer_id": 37568150, "answer_count": 1, "score": 1, "last_activity_date": 1464783637, "creation_date": 1464782381, "question_id": 37568033, "link": "https://stackoverflow.com/questions/37568033/how-to-set-more-than-one-flag-in-sigaction-sa-flags", "title": "How to set more than one flag in sigaction.sa_flags", "body": "<p>I have the following structure:</p>\n\n<pre><code>struct sigaction sa1;\nsa1.sa_flags=SA_SIGINFO;\nsa1.sa_flags=SA_NODEFER;\nsa1.sa_sigaction = handler;\nsigaction(SIGUSR1,&amp;sa1,NULL);\n</code></pre>\n\n<p>How can I use SA_SIGINFO along with SA_NODEFER without making the second flag overrides the first?</p>\n"}, {"tags": ["c", "openssl", "tls1.2"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1464804765, "post_id": 37567855, "comment_id": 62639007, "body": "Also see <a href=\"http://stackoverflow.com/a/24415607/608639\">Setting up TLS1.2 connection which supports SNI</a>. Though its tagged with iOS, it applies to nearly all OpenSSL. However, it only answers your &quot;TLS 1.0 and above&quot; question. Its doe snot answer your &quot;purpose of SSL_set_ssl_method&quot; question."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1464826120, "post_id": 37567855, "comment_id": 62648293, "body": "Also, the TLSv1.1 client connection is easy enough to test: <code>openssl s_client -connect &lt;hostname&gt;:&lt;port&gt; -tls1_1 -servername &lt;hostname&gt;</code>. The <code>-servername</code> ensures you are using SNI. See <a href=\"http://www.openssl.org/docs/manmaster/apps/s_client.html\" rel=\"nofollow noreferrer\"><code>s_client</code> man page</a> for details on the options."}], "owner": {"reputation": 429, "user_id": 1237212, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/729f75d3d17fea7f72e252fe536ff150?s=128&d=identicon&r=PG", "display_name": "singh", "link": "https://stackoverflow.com/users/1237212/singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1464781905, "creation_date": 1464781905, "question_id": 37567855, "link": "https://stackoverflow.com/questions/37567855/what-is-the-use-of-ssl-set-ssl-method-after-we-have-already-created-context-usin", "title": "what is the use of SSL_set_ssl_method after we have already created context using SSL_CTX_new", "body": "<p>I am working on a SSL client server application. I want to enable all protocols above TLSv1 so what i am doing is </p>\n\n<pre><code>1)sslctx = SSL_CTX_new(SSLv23_method());\n2)SSL_CTX_set_options(sslctx,SSL_OP_NO_SSLv2|SSL_OP_NO_SSLv3|SSL_OP_NO_TLSv1);\n3)SSL_set_ssl_method(ssl,TLSv1_2_method());\n</code></pre>\n\n<p>The doubt that i have is will i also be able to connect using TLSv1_1 if i use TLSv1_2_method in SSL_set_ssl_method or will it only support TLSv1_2?</p>\n\n<p>I want to support everything above TLSv1?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "while-loop", "scanf"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6409258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6glBJBWxRII/AAAAAAAAAAI/AAAAAAAAArQ/JyIbmSyQJ-0/photo.jpg?sz=128", "display_name": "Code Monkey", "link": "https://stackoverflow.com/users/6409258/code-monkey"}, "edited": false, "score": 0, "creation_date": 1464788072, "post_id": 37567167, "comment_id": 62627765, "body": "The wiki link really helped , and your explanation was spot on !! thanks :)"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1464779926, "creation_date": 1464779926, "answer_id": 37567167, "question_id": 37567045, "link": "https://stackoverflow.com/questions/37567045/scanf-input-output-confusion/37567167#37567167", "title": "scanf Input output confusion", "body": "<p>This is correct, the first loop will go on until all three values turn zero, while the second loop will stop as soon as one of three items becomes zero.</p>\n\n<p>This is because <a href=\"https://en.wikipedia.org/wiki/Comma_operator\" rel=\"nofollow\"><em>comma operator</em></a> discards the result of the first expression - essentially, the expression <code>a || b || c</code> or <code>a &amp;&amp; b &amp;&amp; c</code> become your loop condition.</p>\n\n<p>Note that your loops may not terminated when the input ends prior to reading a stopping combination (all zeros / one zero). When this happens, your loop becomes infinite. To prevent this from happening, change your loops to</p>\n\n<pre><code> while(scanf(\"%d%d%d\",&amp;a,&amp;b,&amp;c) == 3 &amp;&amp; (a||b||c) ) { //some code }\n</code></pre>\n\n<p>or</p>\n\n<pre><code> while(scanf(\"%d%d%d\",&amp;a,&amp;b,&amp;c) == 3 &amp;&amp; a &amp;&amp; b &amp;&amp; c) ) { //some code }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1464784994, "post_id": 37567269, "comment_id": 62625089, "body": "This does not answer the question, since <code>while(true)</code> will never become <code>false</code> and vice versa. <code>True</code> and <code>false</code> are constants, while <code>a</code>, <code>b</code> and <code>c</code> are variables."}], "tags": [], "owner": {"reputation": 147, "user_id": 5746194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ag5pW.jpg?s=128&g=1", "display_name": "mssirvi", "link": "https://stackoverflow.com/users/5746194/mssirvi"}, "is_accepted": false, "score": 0, "last_activity_date": 1464780210, "creation_date": 1464780210, "answer_id": 37567269, "question_id": 37567045, "link": "https://stackoverflow.com/questions/37567045/scanf-input-output-confusion/37567269#37567269", "title": "scanf Input output confusion", "body": "<pre><code>while(true) {//some code}  // loop will run\nwhile(false) {//some code} // loop will not run\n</code></pre>\n\n<p>since any value other than <code>0</code> is considered as true so your first <code>while</code> loop will execute until all of them become <code>0</code>.\nand in second <code>while</code> loop if any of them become <code>0</code> the loop will not execute.\njust basic operators.</p>\n"}], "owner": {"reputation": 9, "user_id": 6409258, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6glBJBWxRII/AAAAAAAAAAI/AAAAAAAAArQ/JyIbmSyQJ-0/photo.jpg?sz=128", "display_name": "Code Monkey", "link": "https://stackoverflow.com/users/6409258/code-monkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 37567167, "answer_count": 2, "score": 1, "last_activity_date": 1464784847, "creation_date": 1464779637, "last_edit_date": 1464784847, "question_id": 37567045, "link": "https://stackoverflow.com/questions/37567045/scanf-input-output-confusion", "title": "scanf Input output confusion", "body": "<p><em>I was confused about my assumption as to how the while loop might work ..\nI've tried it on my computer, and seen that all cases have been as expected,\nam i right, or am i missing out on something ?</em>   </p>\n\n<pre><code> while(scanf(\"%d%d%d\",&amp;a,&amp;b,&amp;c) ,a||b||c ) { /* some code */ }\n</code></pre>\n\n<p><strong>This means that even if one value (either a,b or c )  is non zero , it will loop on</strong></p>\n\n<hr>\n\n<pre><code>while(scanf(\"%d%d%d\",&amp;a,&amp;b,&amp;c) ,a&amp;&amp;b&amp;&amp;c ) {  /* some code */ }\n</code></pre>\n\n<p><strong>This means whenever any of a, b or c  becomes zero, the loop terminates</strong> </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1464779630, "post_id": 37566913, "comment_id": 62621189, "body": "Is bit pattern always a single byte?"}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 2, "creation_date": 1464779688, "post_id": 37566913, "comment_id": 62621229, "body": "What have you yet tried ? You should read about bitwise operators: &lt;&lt;, &gt;&gt;, &amp;, |, ^, ~, ...."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1464779761, "post_id": 37566913, "comment_id": 62621275, "body": "Do leading zeros count? For example, If my pattern is <code>0x05</code> and my stream is <code>00, 00, A5, 00, 00</code>, is the answer 1 or 2?"}, {"owner": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1464779804, "post_id": 37566913, "comment_id": 62621306, "body": "the pattern is always 1 byte"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464779806, "post_id": 37566913, "comment_id": 62621309, "body": "Read byte A. (x) Check byte A for the pattern. If byte B is &quot;empty&quot; read in a byte to byte B. Shift a bit out of byte B into byte A. Repeat from (x)."}, {"owner": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1464779922, "post_id": 37566913, "comment_id": 62621390, "body": "The answer would be 0, there is a no match"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464780143, "post_id": 37566913, "comment_id": 62621567, "body": "@Invictus my algorithm tests every run of 8 bits, in overlapping bytes, at bit 0, bit 1, bit 2, ..."}, {"owner": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1464780527, "post_id": 37566913, "comment_id": 62621813, "body": "Can you give a small snippet of what are you doing?"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1464782824, "post_id": 37567739, "comment_id": 62623436, "body": "It will work on any length data up to the limit of <code>size_t</code> type. I am getting 8 bits from file at a time, and storing them in <code>int</code> because that&#39;s the return type of <code>fgetc</code>. I then shift 1 bit (of 8) at a time into the test variable. There is no reason why you can&#39;t read each value from a character array instead of from a file. I am not going to write the exact code you need, as stated in the answer, this is to give you an idea how to go about it. PS sorry I forgot to close the file."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1464783954, "post_id": 37567739, "comment_id": 62624255, "body": "Notice that I am only using the least significant 8 bits of <code>byteA</code> with the mask <code>0xFF</code>, and notice how I always extract bit 7 of <code>byteB</code> with the mask <code>0x80</code>, to move into bit 0 of <code>byteA</code>. That woould be the same if I was using <code>unsigned char</code> - it makes no difference to the algorithm."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1464785456, "post_id": 37567739, "comment_id": 62625519, "body": "By copying it to an <code>int</code> then manipulate it like I did. An <code>unsigned char</code> can be promoted safely to <code>int</code> because <code>int</code> can hold all the possible values of <code>unsigned char</code>. Instead of reading a byte from file, read it from your string."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "edited": false, "score": 0, "creation_date": 1464806449, "post_id": 37567739, "comment_id": 62639929, "body": "In that case over to you: ask a new question with the code you have tried, the input you gave, the output you expected and the output you got. This is not a code writing service. I just gave you some ideas."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1464781577, "creation_date": 1464781577, "answer_id": 37567739, "question_id": 37566913, "link": "https://stackoverflow.com/questions/37566913/use-of-unsigned-char-pointer/37567739#37567739", "title": "use of unsigned char pointer", "body": "<p>This works by reading the file one byte at a time and rotating bits into a test variable. You could modify it to read from a string (unwilling to give you \"pat\" code).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nsize_t count_patt(char *filename, unsigned char pattern)\n{\n    size_t count = 0;\n    int byteA, byteB, bits = 0;\n    FILE *fp;\n    if((fp = fopen(filename, \"rb\")) == NULL) {\n        return count;\n    }\n    if((byteA = fgetc(fp)) == EOF) {\n        return count;\n    }\n    while(1) {\n        if(byteA == pattern) {\n            count++;\n        }\n        if(bits &lt;= 0) {\n            if((byteB = fgetc(fp)) == EOF)          // refresh byte B\n                break;\n            bits = 8;                               // which has 8 bits\n        }\n        byteA = (byteA &lt;&lt; 1) &amp; 0xFF;                // rotate byte A left\n        if((byteB &amp; 0x80) != 0) {\n            byteA++;                                // shift in ms bit of byte B\n        }\n        byteB &lt;&lt;= 1;                                // rotate byte B left\n        bits--;                                     // bit tally\n    }\n    return count;\n}\n\nint main()\n{\n    printf(\"%zu bytes\\n\", count_patt(\"test.txt\", 0x31));\n}\n</code></pre>\n\n<p>Contents of test.txt (2 bytes 01000010 01100011)</p>\n\n<pre><code>Bc\n</code></pre>\n\n<p>Program output</p>\n\n<pre><code>1 bytes\n</code></pre>\n"}], "owner": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "closed_date": 1464819276, "answer_count": 1, "score": -3, "last_activity_date": 1464854983, "creation_date": 1464779230, "last_edit_date": 1464854983, "question_id": 37566913, "link": "https://stackoverflow.com/questions/37566913/use-of-unsigned-char-pointer", "closed_reason": "Needs more focus", "title": "use of unsigned char pointer", "body": "<p>I have a pattern </p>\n\n<p>and I have byte stream and I need to find how many occurrences of this byte is present in my byte stream. The pattern can be found at any bit position.</p>\n"}, {"tags": ["c", "error-handling", "assert"], "comments": [{"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1464779316, "post_id": 37566840, "comment_id": 62620964, "body": "Wait, are you asking about checking for errors from things you <i>use</i>, or are you asking about implementing such error emission and checking for things you <i>develop yourself</i>?"}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1464780628, "post_id": 37566840, "comment_id": 62621894, "body": "@MarcusM&#252;ller I&#39;m wondering why I had to comment out my assertions and I&#39;m wondering where I should use assertions in code that I write. In some places I already use <code>perror</code> but I don&#39;t know the details."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1464781571, "post_id": 37566840, "comment_id": 62622498, "body": "<code>perror()</code> does not check for errors. It just logs the long-text error message for the current value of <code>errno</code> to <code>stderr</code>."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1464794412, "post_id": 37566840, "comment_id": 62632776, "body": "You use assertions when &quot;something very wrong has happened, no point continuing&quot;"}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1464806797, "post_id": 37566840, "comment_id": 62640109, "body": "@user3528438 That&#39;s actually what I&#39;m wondering. &quot;Where should I use assertions?&quot; I had assertions, refactored and then I had to comment out the assertions but the code worked."}], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 4728763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe49a7ad583db027c721303445acda3?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Mu&#241;oz", "link": "https://stackoverflow.com/users/4728763/miguel-mu%c3%b1oz"}, "is_accepted": true, "score": 4, "last_activity_date": 1464783707, "creation_date": 1464783707, "answer_id": 37568518, "question_id": 37566840, "link": "https://stackoverflow.com/questions/37566840/assert-and-error-checking-in-c/37568518#37568518", "title": "Assert and error-checking in C", "body": "<p>As far as I know, assertions should be used during development and testing only. assert is actually a macro. When you build in debug configuration, it performs the check and exit if false. When you are in release configuration, it does nothing. assert should therefore be used to check for programming errors.</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/cassert/assert/\" rel=\"nofollow\">http://www.cplusplus.com/reference/cassert/assert/</a></p>\n\n<p>What you cannot do with assert is to check for runtime errors, meaning errors that happen during program execution due to the environment or to user input, e.g. the program cannot open or write a file, the user enters a string when a number is expected, a network connection cannot be established, etc. You want these checks to happen both in debug and release modes.</p>\n\n<p>I think that the two other error checking methods that you mention, perror and checking return values, always go together. One normally checks the return value of a function, then prints a message (with perror or other function), and then do error recovery or exit. perror itself just prints a message and the program continues unless you do something else.</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/cstdio/perror/\" rel=\"nofollow\">http://www.cplusplus.com/reference/cstdio/perror/</a></p>\n\n<p>Normally one should check the return value of external function calls, and also check all inputs to the program for correctness. Most library functions can fail, including malloc or printf, but depending on your level of paranoia it's enough to check only the ones most likely to cause trouble (files, network, library or device initialization, etc), depending on your application.</p>\n"}], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1170, "favorite_count": 0, "closed_date": 1465974979, "accepted_answer_id": 37568518, "answer_count": 1, "score": -2, "last_activity_date": 1465428448, "creation_date": 1464779037, "last_edit_date": 1492087236, "question_id": 37566840, "link": "https://stackoverflow.com/questions/37566840/assert-and-error-checking-in-c", "closed_reason": "Needs more focus", "title": "Assert and error-checking in C", "body": "<p>I posted my code on <a href=\"https://codereview.stackexchange.com/questions/130093/more-error-checking\">code review</a> and got the answer that I didn't have error-checking. AFAIK I can do error-checking in several ways:</p>\n\n<ul>\n<li>Assertions for preconditions and postconditions</li>\n<li><code>perror</code> usage or similar, which I sometimes do, but I didn't learn it yet</li>\n<li>Manual handcoded error-checking using boolean return values from functions or similar, indicating that a call succeeded or failed</li>\n</ul>\n\n<p>Are there more ways to do it or some specific way that is recommended? Is it better or worse to use both <code>perror</code> and assertions? The code is in <a href=\"https://github.com/montao/openshell\" rel=\"nofollow noreferrer\">my github</a> and the <code>main</code> loop looks like this:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    bool donotrun = false;\n    struct sigaction new_action, old_action;\n    hashtable_t *hashtable = ht_create(65536);\n    /* Set up the structure to specify the new action. */\n    new_action.sa_handler = termination_handler;\n    sigemptyset(&amp;new_action.sa_mask);\n    new_action.sa_flags = 0;\n\n    sigaction(SIGINT, NULL, &amp;old_action);\n    if (old_action.sa_handler != SIG_IGN)\n        sigaction(SIGINT, &amp;new_action, NULL);\n    sigaction(SIGHUP, NULL, &amp;old_action);\n    if (old_action.sa_handler != SIG_IGN)\n        sigaction(SIGHUP, &amp;new_action, NULL);\n    sigaction(SIGTERM, NULL, &amp;old_action);\n    if (old_action.sa_handler != SIG_IGN)\n        sigaction(SIGTERM, &amp;new_action, NULL);\n\n\n    void *pParser;\n    char *c;\n\n\n    int index = 0;\n    int i;\n    char *cvalue = NULL;\n    const char *commandFile = \"\";\n    bool quietFlag;\n\n    while (1) {\n        index = 0;\n        i = getopt_long(argc, argv, \"pc:vh\",\n                        options, &amp;index);\n        if (i == -1)\n            break;\n        switch (i) {\n            case 'p': {\n                exit(EXIT_SUCCESS);\n            }\n            case 'v': {\n                printf(\"sh OpenShell version 0.1(a)\\n\");\n                printf(\"Version: %s\\n\", VERSION);\n                exit(EXIT_SUCCESS);\n\n            }\n            case 'h': {\n                usage();\n                exit(EXIT_SUCCESS);\n\n            }\n            case 'c': {\n                cvalue = optarg;\n                command(cvalue, hashtable);\n                exit(EXIT_SUCCESS);\n            }\n\n            case 'f':\n                /*\n                 * Execute commands from file.\n                 * This is used for osh script files.\n                 * The quiet flag is also set.\n                 */\n                if ((argc != 1) || commandFile)\n                    usage();\n\n                quietFlag = true;\n                argc--;\n\n                break;\n\n\n            case '?':\n                if (optopt == 'c')\n                    fprintf(stderr, \"Option -%c requires an argument.\\n\", optopt);\n                else if (isprint (optopt))\n                    fprintf(stderr, \"Unknown option `-%c'.\\n\", optopt);\n                else\n                    fprintf(stderr,\n                            \"Unknown option character `\\\\x%x'.\\n\",\n                            optopt);\n            default: {\n                return 1;\n            }\n        }\n    }\n    getPath();\n    pParser = (void *) ParseAlloc(malloc);\n    char *copy = \"\";\n\n    for (; ;) {\n        bool scanning = true;\n        bool calc = true;\n        while (scanning) {\n            char *line = NULL;\n            line = readline(\"$ \");\n            if (line == NULL) {\n                /* No more lines, so exit the loop. */\n                break;\n            }\n            if (line)\n                copy = strdup(line);\n\n            if (line &amp;&amp; !strstr(line, \"for\") &amp;&amp; !strstr(line, \"==\") &amp;&amp; !strstr(line, \"if\") &amp;&amp; strstr(line, \"=\")) {\n                donotrun = true;\n                char str[128];\n                char *ptr;\n                strcpy(str, line);\n                strtok_r (str, \"=\", &amp;ptr);\n                ht_set(hashtable, str, ptr);\n            }\n\n            if (!scanning)\n                break;\n\n            if (!isatty(fileno(stdin))) {\n                *argv++;\n                readFile(*argv++, hashtable);\n                free(line);\n                exit(0);\n            }\n            else {\n\n                if (!donotrun) {\n                    line = str_replace(line, \" | \", \"|\");\n                    line = str_replace(line, \" |\", \"|\");\n\n                    command(line, hashtable);\n                }\n                donotrun = false;\n                add_history(copy);\n\n            }\n            free(copy);\n        }\n    }\n    //  ParseFree(pParser, free);FIXME: where should this go?\n    return 0;\n}\n</code></pre>\n\n<p>Then I had assertions that I had to comment out during development and now I'm not sure what the assertions should be. </p>\n\n<pre><code>/* Returns a struct that has the number of \"chunks\" the list of chunks.\n * Splits the command by char | and then by whitespace and return a list of struct pointers\n */\nstruct str_list *list_split(const char *a_str, char *a_delim) {\n\n    char **result = 0;\n    size_t count = 0;\n    char *tmp = (char *) a_str;\n    char *ctmp;\n    char *token = \"\";\n    char *last_comma = 0;\n    char *tmp2 = (char *) a_str; /* TODO: This variable can reuse tmp */\n    //char *delim[2];\n    //delim[0] = a_delim;\n    struct str_list *chunks = NULL;\n    /* Count how many elements will be extracted. */\n    while (*tmp) {\n        if (*a_delim == *tmp) {\n            count++;\n            last_comma = tmp;\n        }\n        tmp++;\n    }\n    /* Add space for trailing token. */\n    count += last_comma &lt; (a_str + strlen(a_str) - 1);\n    count++;\n    result = alloc_argv(count);\n    char **tmpresult = alloc_argv(count);\n    chunks = malloc(count * sizeof *chunks);\n    if (result == NULL) {\n        printf(\"Error allocating memory!\\n\");\n        return chunks;;\n    }\n    if (result) {\n        size_t idx = 0;\n        token = strtok((char *) strdup(a_str), \"|\");\n        int a = 0;\n        while (token) {\n//            assert(idx &lt; count); Why must I turn off assertions?\n            tmpresult[a] = strdup(token);\n            a++;\n            ctmp = strdup(token);\n            *(result + idx++) = ctmp; /* memory leak! how to free() */;\n            token = strtok(0, a_delim);\n        }\n//        assert(idx == count - 1);\n        *(result + idx) = 0;\n    }\n    chunks-&gt;argv = alloc_argv(BUFFER_SIZE);//malloc(chunks-&gt;size * sizeof(char *) * 1);\n    int i = 0;\n    chunks = tokenize(&amp;i, chunks, result, count, tmp2);\n    chunks-&gt;pipes = i; /* important! to get this right */\n    free(ctmp);\n    return expand_shell(tmpresult, chunks);\n}\n</code></pre>\n"}, {"tags": ["c", "string", "algorithm", "sign"], "comments": [{"owner": {"reputation": 1102, "user_id": 2974922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fcd187a430dfd497db690eedc5af14?s=128&d=identicon&r=PG&f=1", "display_name": "nucleon", "link": "https://stackoverflow.com/users/2974922/nucleon"}, "edited": false, "score": 4, "creation_date": 1464779186, "post_id": 37566799, "comment_id": 62620862, "body": "What you are looking for is usually called a hash function. See for example <a href=\"http://stackoverflow.com/questions/7666509/hash-function-for-string\" title=\"hash function for string\">stackoverflow.com/questions/7666509/hash-function-for-string</a>&zwnj;&#8203;."}, {"owner": {"reputation": 68467, "user_id": 1081110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fp4Pm.jpg?s=128&g=1", "display_name": "Dawood ibn Kareem", "link": "https://stackoverflow.com/users/1081110/dawood-ibn-kareem"}, "edited": false, "score": 3, "creation_date": 1464779313, "post_id": 37566799, "comment_id": 62620962, "body": "Different strings should ALWAYS generate different uint64 values?  This isn&#39;t really possible.  Think about how many different strings there are, and how many different uint64s there are."}], "owner": {"reputation": 141, "user_id": 3033296, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/jOTk1.jpg?s=128&g=1", "display_name": "formath", "link": "https://stackoverflow.com/users/3033296/formath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1464781329, "answer_count": 0, "score": 0, "last_activity_date": 1464780326, "creation_date": 1464778914, "last_edit_date": 1464780326, "question_id": 37566799, "link": "https://stackoverflow.com/questions/37566799/how-to-signature-a-string-to-generate-a-uint64-value", "closed_reason": "Duplicate", "title": "how to signature a string to generate a uint64 value?", "body": "<p>I want a function like this:</p>\n\n<pre><code>uint64 sign(String s) {\n    // how to signature a string\n}\n</code></pre>\n\n<p>For use, this function can accept any string and return a signature. For example,</p>\n\n<pre><code>uint64 a = sign(\"hello world\")\n</code></pre>\n\n<p>This function should signature a string just depending on its plain text but not memory location. And, different string text should generate different uint64 values.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "copy-on-write"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1464776432, "post_id": 37565750, "comment_id": 62618838, "body": "<i>please provide the source code of kernel if the kernel is in charge for this.</i> <a href=\"https://github.com/torvalds/linux\" rel=\"nofollow noreferrer\">github.com/torvalds/linux</a>"}, {"owner": {"reputation": 251699, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1464776841, "post_id": 37565750, "comment_id": 62619116, "body": "@AndrewHenle nice one :-)"}, {"owner": {"reputation": 565, "user_id": 2593451, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/YbvhP.jpg?s=128&g=1", "display_name": "Jason Young", "link": "https://stackoverflow.com/users/2593451/jason-young"}, "edited": false, "score": 0, "creation_date": 1464777083, "post_id": 37565750, "comment_id": 62619289, "body": "I think this one is better then github <a href=\"https://code.woboq.org/linux/linux/\" rel=\"nofollow noreferrer\">code.woboq.org/linux/linux</a>"}, {"owner": {"reputation": 251699, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1464777344, "post_id": 37565750, "comment_id": 62619502, "body": "I think wikipedia has the answer: <a href=\"https://en.wikipedia.org/wiki/Copy-on-write#Copy-on-write_in_virtual_memory_management\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a> &quot;Copy-on-write can be implemented by notifying the MMU that certain pages in the process&#39;s address space are read-only. When data is written to these pages, the MMU raises an exception which is handled by the kernel, which allocates new space in physical memory and makes the page being written correspond to that new location in physical memory.&quot; Brillant stuff."}, {"owner": {"reputation": 251699, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1464777676, "post_id": 37565750, "comment_id": 62619744, "body": "Also I&#39;d link to <a href=\"https://people.redhat.com/anderson/crash_whitepaper/\" rel=\"nofollow noreferrer\">people.redhat.com/anderson/crash_whitepaper</a> on the question, many people like me might not know it :-)"}, {"owner": {"reputation": 565, "user_id": 2593451, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/YbvhP.jpg?s=128&g=1", "display_name": "Jason Young", "link": "https://stackoverflow.com/users/2593451/jason-young"}, "edited": false, "score": 1, "creation_date": 1464779412, "post_id": 37565750, "comment_id": 62621022, "body": "There we go: <a href=\"https://books.google.com.hk/books?id=k_ocKY0iegsC&amp;pg=PA135&amp;lpg=PA135&amp;dq=linux+kernel+fork+copy+on+write&amp;source=bl&amp;ots=VhHLKaqxLA&amp;sig=t1-9uzfjo8qHQxvdA9Y6grDebWU&amp;hl=zh-CN&amp;sa=X&amp;ved=0ahUKEwjYp_Gf14bNAhWCGaYKHc6PBHMQ6AEIaDAJ#v=onepage&amp;q=linux%20kernel%20fork%20copy%20on%20write&amp;f=false\" rel=\"nofollow noreferrer\">books.google.com.hk/&hellip;</a>"}, {"owner": {"reputation": 251699, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1464779536, "post_id": 37565750, "comment_id": 62621107, "body": "Related <a href=\"http://stackoverflow.com/questions/13392931/copy-on-write-in-linux\" title=\"copy on write in linux\">stackoverflow.com/questions/13392931/copy-on-write-in-linux</a>"}, {"owner": {"reputation": 565, "user_id": 2593451, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/YbvhP.jpg?s=128&g=1", "display_name": "Jason Young", "link": "https://stackoverflow.com/users/2593451/jason-young"}, "edited": false, "score": 1, "creation_date": 1464780785, "post_id": 37565750, "comment_id": 62621996, "body": "How about this one: <a href=\"https://code.woboq.org/linux/linux/mm/memory.c.html#3196\" rel=\"nofollow noreferrer\">code.woboq.org/linux/linux/mm/memory.c.html#3196</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1064, "user_id": 516268, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c4278691daf3681d598189d8dd0a80ed?s=128&d=identicon&r=PG", "display_name": "larmbr", "link": "https://stackoverflow.com/users/516268/larmbr"}, "is_accepted": true, "score": 5, "last_activity_date": 1465274755, "last_edit_date": 1465274755, "creation_date": 1465274329, "answer_id": 37670596, "question_id": 37565750, "link": "https://stackoverflow.com/questions/37565750/how-does-the-linux-kernel-detect-if-a-memory-address-was-modified-to-implement-c/37670596#37670596", "title": "How does the Linux kernel detect if a memory address was modified to implement COW?", "body": "<blockquote>\n  <p>My question is what happend when cpu execute</p>\n  \n  <p>movl   $0x2c,-0x20(%rbp)</p>\n  \n  <p>How did the kernel know that it is changing a shared memory, so a coping is needed to perform before writing? I am guessing it is using something like page fault interrupt. But I did not found any interrupt related about this.</p>\n</blockquote>\n\n<p>This is achieved with the cooperative effort of the processor and the OS. </p>\n\n<p><strong>The processor side:</strong></p>\n\n<p>When the CPU executes such an instruction:</p>\n\n<blockquote>\n  <p>movl $0x2c,-0x20(%rbp)</p>\n</blockquote>\n\n<p>i.e. fetching the address stored in %rbp register and adding an offset -x20 to it, then issuing a memory access to it(movl).</p>\n\n<p>Upon committing the memory access, the processor will walks the hardware page table(well, in most case, it is short cut by visiting the TLB, but I just talk in fundamental principle here). The page tables, of course, should be setup beforehand by the OS.  </p>\n\n<p>Suppose the processor makes its way to the final level page table, and just finds that the corresponding page table entry(will call it <strong>pte</strong> for short for the rest of this answer) for that very address\nsuggests the page containing that address content is NOT in memory!(It just consults a specific page flag of that pte), then, depending on processor architecture, a hardware exception is raised ! According to Intel terminology, it categorizes such type of exception in to <strong>fault</strong>, and you must frequently hear the term <strong>'page fault'</strong>(a kind of exception that could be fixed and the execution could be resumed as if there was no such exception had happened at all !)</p>\n\n<p><strong>The OS side:</strong></p>\n\n<p>Then we move up the stack into the OS domain.  During booting process, the OS will setup an exception and interrupt handler table(in x86 jargon we call it <strong>IDT</strong>), and will register it to the processor.</p>\n\n<p>Then upon this page fault happening, the pre-setup handler is executed by the processor(technically, the processor shall save the CPU context first, like pushing the cs and rip registers, the rflags register, etc).</p>\n\n<p>The handler could be divided into the arch-specific part (where the OS will further do some hardware related jobs, like saving more registers, call arch-specific hook, determine whether the page fault is allowed? etc) and the arch-independent part(the page faulting logic), so no surprise the handler entry point is arch dependent.</p>\n\n<p>For Linux on x86, the arch-specific part is located in  <strong>arch/x86/entry/entry_64.S</strong> (for 64 bit) and the do_page_fault() C function in <strong>arch/x86/mm/fault.c</strong>. Then in do_page_fault(), it will call arch-independent C function handle_mm_fault(), which locates in the core MM code at <strong>mm/memory.c</strong>. </p>\n\n<p>And for this question, in handle_mm_fault(), do_wp_page() handles the COW logic. Basically, handle_mm_fault() just walks the page table of the faulting address and finds out that it is a write protect page(present, but write flag is not set), so it calls do_wp_page() to allocate a new page.</p>\n"}], "owner": {"reputation": 565, "user_id": 2593451, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/YbvhP.jpg?s=128&g=1", "display_name": "Jason Young", "link": "https://stackoverflow.com/users/2593451/jason-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1000, "favorite_count": 2, "accepted_answer_id": 37670596, "answer_count": 1, "score": 2, "last_activity_date": 1465274755, "creation_date": 1464776002, "last_edit_date": 1464777611, "question_id": 37565750, "link": "https://stackoverflow.com/questions/37565750/how-does-the-linux-kernel-detect-if-a-memory-address-was-modified-to-implement-c", "title": "How does the Linux kernel detect if a memory address was modified to implement COW?", "body": "<p>Source code Here:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n void main() {\n     int *a = malloc(sizeof(int));\n     *a = 11;\n     int b = 22;//on the stack\n\n     int pid = fork();\n\n     if (pid == 0) {\n         printf(\"pid=%d, a = %d, &amp;a=%p\\n\", getpid(), *a, a);\n         printf(\"pid=%d, b = %d, &amp;b=%p\\n\", getpid(), b, &amp;b);\n         getchar();\n         *a = 33;// ===========cow=========happend here=====\n         b = 44;\n         printf(\"pid=%d, a = %d, &amp;a=%p\\n\", getpid(), *a, a);\n         printf(\"pid=%d, b = %d, &amp;b=%p\\n\", getpid(), b, &amp;b);\n     } else {\n         printf(\"pid=%d, a = %d, &amp;a=%p\\n\", getpid(), *a, a);\n         printf(\"pid=%d, b = %d, &amp;b=%p\\n\", getpid(), b, &amp;b);\n     }\n     pause();\n }\n</code></pre>\n\n<p>Here is the gdb disassemble of that line which writing <strong>33</strong> to <strong>a</strong>,\nI set a breakpoint here. and start this program. Then using <em>crash</em> to see the physical address of <strong>a</strong></p>\n\n<pre><code>  &gt;\u25020x40073a &lt;main+154&gt;     movl   $0x2c,-0x20(%rbp)  //copy on write happend here                                                                                                                              \u2502\n   \u25020x400741 &lt;main+161&gt;     mov    -0x18(%rbp),%rax                                                                                                                                 \u2502\n   \u25020x400745 &lt;main+165&gt;     mov    (%rax),%ebx\n</code></pre>\n\n<p>The linear address of <strong>a</strong> is <strong>0x602010</strong>, so using <em>vtop</em>, I got this:</p>\n\n<p>We can see that they are point to the same physical address of <strong>2a683010</strong></p>\n\n<pre><code>    PID: 6468\nCOMMAND: \"a.out\"\n   TASK: ffff88007c317300  [THREAD_INFO: ffff880016728000]\n    CPU: 0\n  STATE: TASK_TRACED|TASK_WAKEKILL\ncrash&gt; vtop 0x602010\nVIRTUAL     PHYSICAL\n602010      2a683010\n\n   PML: 24e6f000 =&gt; 2409c067\n   PUD: 2409c000 =&gt; 7144067\n   PMD: 7144018 =&gt; 19847067\n   PTE: 19847010 =&gt; 800000002a683065\n  PAGE: 2a683000\n\n\n\n    PID: 6464\nCOMMAND: \"a.out\"\n   TASK: ffff880036992280  [THREAD_INFO: ffff880014e38000]\n    CPU: 0\n  STATE: TASK_TRACED|TASK_WAKEKILL\ncrash&gt; vtop 0x602010\nVIRTUAL     PHYSICAL\n602010      2a683010\n\n   PML: 36df9000 =&gt; 3a654067\n   PUD: 3a654000 =&gt; 1a71a067\n   PMD: 1a71a018 =&gt; 18f2a067\n   PTE: 18f2a010 =&gt; 800000002a683065\n  PAGE: 2a683000\n</code></pre>\n\n<p>After type <strong>ni</strong> in gdb(which changed the value of a to 33), using <em>vtop</em> again. I can see one of the process's physical address has changed.    </p>\n\n<pre><code>crash&gt; vtop 0x602010\nVIRTUAL     PHYSICAL\n602010      5d755010\n\n   PML: 24e6f000 =&gt; 2409c067\n   PUD: 2409c000 =&gt; 7144067\n   PMD: 7144018 =&gt; 19847067\n   PTE: 19847010 =&gt; 800000005d755067\n  PAGE: 5d755000\n\n\n\ncrash&gt; vtop 0x602010\nVIRTUAL     PHYSICAL\n602010      2a683010\n\n   PML: 36df9000 =&gt; 3a654067\n   PUD: 3a654000 =&gt; 1a71a067\n   PMD: 1a71a018 =&gt; 18f2a067\n   PTE: 18f2a010 =&gt; 800000002a683065\n  PAGE: 2a683000\n</code></pre>\n\n<p>My question is what happend when cpu execute </p>\n\n<pre><code>movl   $0x2c,-0x20(%rbp)\n</code></pre>\n\n<p>How did the kernel know that it is changing a shared memory, so a coping is needed to perform before writing? I am guessing it is using something like page fault interrupt. But I did not found any interrupt related about this.</p>\n\n<p>Please provide the source code of kernel if the kernel is in charge for this.</p>\n"}, {"tags": ["c++", "c", "portable-executable"], "comments": [{"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 1, "creation_date": 1464777131, "post_id": 37565735, "comment_id": 62619337, "body": "You are calling functions of the runtime and the linker bind them to you stub, but, unnfortunately, that are in the encrypted section... ;-)"}, {"owner": {"reputation": 49, "user_id": 5180260, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y98MKRTm_Fw/AAAAAAAAAAI/AAAAAAAAACM/htta8HiJXGI/photo.jpg?sz=128", "display_name": "plowsec", "link": "https://stackoverflow.com/users/5180260/plowsec"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1464784784, "post_id": 37565735, "comment_id": 62624910, "body": "@frankie If I do not encrypt the section, the problem still occurs though."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1464878131, "post_id": 37565735, "comment_id": 62674655, "body": "I think this is because your added section has been manipulated and will be located at a wrong address. Anyway consider that the common runtime, and its libraries, will always be binded in the standard text section that you will crypt. To work your stub have to be a complete standalone program with no calls to the main one. You may consider a static link to OS functions not related at any runtime library for the stub, but you need anyway some wrapper code. The point is <b>avoid any call to functions binded in the crypted section</b>. Means also that you cannot use streams or standard I/O."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 1, "creation_date": 1464878636, "post_id": 37565735, "comment_id": 62675085, "body": "I forget to tell that even if using direct OS calls statically linked you will use the jump table located in the PE. Be sure to have not crypted the <b>IAT</b> (Import Address Table) or you&#39;ll get the same problem."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 5180260, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y98MKRTm_Fw/AAAAAAAAAAI/AAAAAAAAACM/htta8HiJXGI/photo.jpg?sz=128", "display_name": "plowsec", "link": "https://stackoverflow.com/users/5180260/plowsec"}, "is_accepted": true, "score": 0, "last_activity_date": 1549732814, "creation_date": 1549732814, "answer_id": 54608638, "question_id": 37565735, "link": "https://stackoverflow.com/questions/37565735/adding-a-section-to-a-pe-file-change-entry-point-to-the-new-section-and-execute/54608638#54608638", "title": "Adding a section to a PE file, change Entry Point to the new section and execute any code", "body": "<p>I forgot this question but actually found the solution months after having asked it. The problem here is that one must manually link to external functions, because their addresses are not known at run-time once the code is unpacked into memory.</p>\n\n<p>To do this, one should do the following:</p>\n\n<ul>\n<li>Walk the Process Environment Block to iterate on the linked list of loaded libraries.</li>\n<li>Locate the library kernel32.dll and walk its export table, for instance to get the addresses of GetProcAddress and LoadLibrary.</li>\n<li>Use the API resolved before to load and resolve any other API.</li>\n</ul>\n\n<p>For more information, the Chapter 10 of \"The Rootkit Arsenal\" is a must-read.</p>\n"}], "owner": {"reputation": 49, "user_id": 5180260, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y98MKRTm_Fw/AAAAAAAAAAI/AAAAAAAAACM/htta8HiJXGI/photo.jpg?sz=128", "display_name": "plowsec", "link": "https://stackoverflow.com/users/5180260/plowsec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1534, "favorite_count": 1, "accepted_answer_id": 54608638, "answer_count": 1, "score": 2, "last_activity_date": 1549732814, "creation_date": 1464775973, "question_id": 37565735, "link": "https://stackoverflow.com/questions/37565735/adding-a-section-to-a-pe-file-change-entry-point-to-the-new-section-and-execute", "title": "Adding a section to a PE file, change Entry Point to the new section and execute any code", "body": "<p>I am working on a PE file packer and I can succesfully encrypt the .text section of an executable, change its entry point and add a new section. The newly added section will take care of decrypting the .text section and then jump to the original entry point.</p>\n\n<p>Now, I would like to go a little bit further and execute more code in the new section. I can do pretty much everything I want, but if I call an external function (<strong>cout</strong> from <strong>iostream</strong> for example), the modified executable will crash while attempting to execute an illegal instruction. The disassembly of the stub in the new section looks like this :</p>\n\n<pre><code>.newsec:0042C020                 push    ebp\n.newsec:0042C021                 mov     ebp, esp\n.newsec:0042C023                 push    offset loc_40EB50\n.newsec:0042C028                 mov     eax, ds:dword_40E0B0\n.newsec:0042C02D                 push    eax\n.newsec:0042C02E                 call    loc_41A350\n.newsec:0042C033                 add     esp, 8\n.newsec:0042C036                 pop     ebp\n.newsec:0042C037                 retn\n</code></pre>\n\n<p>The line at address <strong>0x42c033</strong> will jump in the .text section but the code there is unrelated to what std::cout should do.</p>\n\n<p>To help you help me, the code added in the new section is in a file stub.h/cpp :</p>\n\n<pre><code>#pragma comment(linker, \"/OPT:NOREF\")\n#pragma optimize( \"\", off )\n#pragma section(\".stub\",read,write,execute)\n\n__declspec(code_seg(\".stub\"))\nvoid hello_test()\n{\n    std::cout &lt;&lt; \"hello world\";\n}\n\n__declspec(code_seg(\".stub\"))\nvoid default_stub_start(void) {\n    __asm {\n        call hello_test\n\n        mov eax, 0x400000 //oep\n        jmp eax\n    }\n}\n</code></pre>\n\n<p>Then, the entire .stub section will be copied as is in the new section that I added to the executable. The compilation runs smoothly but the modified executable will crash, as I explained above. If I remove the line </p>\n\n<pre><code>std::cout &lt;&lt; \"hello world\";\n</code></pre>\n\n<p>and replace it with some basic maths, it works fine.</p>\n\n<p>My question is : how can I use external functions without breaking the executable ?</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 1, "user_id": 6408900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bae11c9fa14062aa44cbe6043d51be8?s=128&d=identicon&r=PG", "display_name": "Raman Kumar Kharche", "link": "https://stackoverflow.com/users/6408900/raman-kumar-kharche"}, "edited": false, "score": 0, "creation_date": 1464775509, "post_id": 37565548, "comment_id": 62618214, "body": "How to solve this error. I have referred this link <a href=\"http://opensourceforu.com/2012/02/device-drivers-disk-on-ram-block-drivers/\" rel=\"nofollow noreferrer\">opensourceforu.com/2012/02/&hellip;</a>"}, {"owner": {"reputation": 239259, "user_id": 464709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab3363d257d780bd4c1f0c844b020a2?s=128&d=identicon&r=PG", "display_name": "Fr&#233;d&#233;ric Hamidi", "link": "https://stackoverflow.com/users/464709/fr%c3%a9d%c3%a9ric-hamidi"}, "edited": false, "score": 0, "creation_date": 1465742417, "post_id": 37565548, "comment_id": 63018428, "body": "Have you double-checked that the contents of your <code>PartEntry</code> structure are not padded in some way?"}, {"owner": {"reputation": 1, "user_id": 6408900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bae11c9fa14062aa44cbe6043d51be8?s=128&d=identicon&r=PG", "display_name": "Raman Kumar Kharche", "link": "https://stackoverflow.com/users/6408900/raman-kumar-kharche"}, "reply_to_user": {"reputation": 239259, "user_id": 464709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab3363d257d780bd4c1f0c844b020a2?s=128&d=identicon&r=PG", "display_name": "Fr&#233;d&#233;ric Hamidi", "link": "https://stackoverflow.com/users/464709/fr%c3%a9d%c3%a9ric-hamidi"}, "edited": false, "score": 0, "creation_date": 1466490729, "post_id": 37565548, "comment_id": 63323678, "body": "Disk /dev/part: 32MB, 1 head, 32 sectors/track, 2014 cylinder,   Units=cylinder of 32*512=16384 bytes. Disk identifier: 0x36e5756d       Device Boot    Start    End     Block     Id     System    /dev/part1           1      2017    32256    83    Linux Partition 1 does not end on cylinder boundary Disk /dev/part: 32MB, 1 head,, 32 sectors/track, 2014 cylinder, Units=cylinder of 32*512=16384 bytes. Disk identifier: 0xc1e55c48 Disk /dev/CDAC1 doesn&#39;t contain a valid partition table  This is shown in shown in fdisk command. i am accessing BAR 4 of PCI card. it starts from FC00"}], "owner": {"reputation": 1, "user_id": 6408900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bae11c9fa14062aa44cbe6043d51be8?s=128&d=identicon&r=PG", "display_name": "Raman Kumar Kharche", "link": "https://stackoverflow.com/users/6408900/raman-kumar-kharche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 883, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465742213, "creation_date": 1464775463, "last_edit_date": 1465742213, "question_id": 37565548, "link": "https://stackoverflow.com/questions/37565548/disk-doesnt-contain-a-valid-partition-table", "title": "Disk doesn&#39;t contain a valid partition table", "body": "<p>I have written a PCI driver for the PCI card. I want to mount the filesystem before that trying to do partition. But when I perform <code>fdisk -l</code> it shows my device with: </p>\n\n<blockquote>\n  <p>Disk <code>/dev/dor</code> doesn't contain valid partition table</p>\n</blockquote>\n\n<p>My Partition code is:</p>\n\n<pre><code>#include &lt;asm/io.h&gt;\n#include &lt;linux/string.h&gt;\n/*\n* This is critical part of our code, here we are doing set-up so that user can implement any type of file system.\n* Here we ary logically treating our device as a Disk having some Heads,Cylinders,and Secotrs\n* By default each sector size is 512 here we have taken 512 as default if you wish you can modify as per your \n* requirement you just need to use some system API.\n* For any Storage device first sector i.e sector0 called as boot sector ,this boot sector consist of boot information\n* and partion table.We are not interested in boot information ,we are intereste in partion table.\n*/\n#include \"partition.h\"\n\n#define SECTOR_SIZE 512\n#define MBR_SIZE SECTOR_SIZE\n#define MBR_DISK_SIGNATURE_OFFSET 440\n#define MBR_DISK_SIGNATURE_SIZE 4\n#define PARTITION_TABLE_OFFSET 446\n#define PARTITION_ENTRY_SIZE 8 // sizeof(PartEntry)\n#define PARTITION_TABLE_SIZE 32 // sizeof(PartTable)\n#define MBR_SIGNATURE_OFFSET 510\n#define MBR_SIGNATURE_SIZE 2\n#define MBR_SIGNATURE 0xAA55\n#define BR_SIZE SECTOR_SIZE\n#define BR_SIGNATURE_OFFSET 510\n#define BR_SIGNATURE_SIZE 2\n#define BR_SIGNATURE 0xAA55\n/*\n* Total Partion table start from 446 bytes location system support 64 bytes for partion table in that we can have four \n* actual partion table haing 16 bytes each size.\n* we will explain this 16 bytes as follows\n*1st byte-Boot_type....0x00 for inactive and 0x80 for active \n*in our case it is 0x00 because we already tlod you we are not  interested in booting OS from our device.\n*2nd byte-Start of head  you can have maximum 256 head on your disk\n*3rd byte-out of this 8 bit only 6 bits are for sector so you can have 64 maximum sector\n*4th byte-this 8 bit + 2 most significant bits from 3rd byte==10 bits are for cylinder so you can have 1024 maximum cylinder\n*5th byte-this byte is for patition type as we are interested in single partion of 32MB we are noot extending our partion\n*if you wish you can there will we different vale for this particular type\n*6th bytes-end of head\n*7th bytes-out of 8 bit 6 bit= end of sectors\n*8th btes 8+2 bits end of cylinder\n*4 bytes for start of sector no of this partion table\n*4 bytes for total no of sector which are in this partition \n*According to above we have made one structure pf PartEntry type which has all these above mention member of appropriate size\n*/\ntypedef struct {\n    unsigned char boot_type; // 0x00 - Inactive; 0x80 - Active (Bootable)\n    unsigned char start_head;\n    unsigned char start_sec:6;\n    unsigned char start_cyl_hi:2;\n    unsigned char start_cyl;\n    unsigned char part_type;\n    unsigned char end_head;\n    unsigned char end_sec:6;\n    unsigned char end_cyl_hi:2;\n    unsigned char end_cyl;\n    unsigned int abs_start_sec;\n    unsigned int sec_in_part;\n} PartEntry;\n\ntypedef PartEntry PartTable[4];\n\nstatic PartTable def_part_table = {\n    {\n        boot_type: 0x00,\n        start_head: 0x00,\n        start_sec: 0x2,             //first starting sector\n        start_cyl: 0x00,            //first starting cylinder\n        start_cyl_hi:0x00,\n        part_type: 0x83,            //type of partition\n        end_head: 0x00,     \n        end_sec: 0x3F,              //end of sector\n        end_cyl: 0xFE,              //end of cylinder\n        end_cyl_hi:0x03,\n        abs_start_sec: 0x00000001,\n        sec_in_part: 0x0000FB90\n    },\n    {}\n};\n/* In this copy_mbr method we are actually storing our partion table information on boot sector i.e sector0 */\n//Bellow one is set up for partition information\nstatic void copy_mbr(void __iomem *disk) {\n    printk(\"inside partition table setup\\n\");\n    memset_io(disk, 0x0, MBR_SIZE);\n\n    //*(unsigned long *)(disk + MBR_DISK_SIGNATURE_OFFSET) = 0x36E5756D;\n    unsigned char sign[]={0x6D,0x75,0xE5,0x36};\n    memcpy_toio(disk+MBR_DISK_SIGNATURE_OFFSET,sign,4);\n\n    memcpy_toio(disk + PARTITION_TABLE_OFFSET, &amp;def_part_table, PARTITION_TABLE_SIZE);\n\n    //*(unsigned short *)(disk + MBR_SIGNATURE_OFFSET) = MBR_SIGNATURE;\n    iowrite16(MBR_SIGNATURE,disk+MBR_SIGNATURE_OFFSET);\n}\nvoid partition_setup(void __iomem *disk) {\n    copy_mbr(disk);\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2012"], "comments": [{"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1464776034, "post_id": 37565546, "comment_id": 62618561, "body": "Please read how to ask a question: <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 838, "user_id": 2794980, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4131303bc2548368cfbb2ed10577a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Pratik", "link": "https://stackoverflow.com/users/2794980/pratik"}, "edited": false, "score": 0, "creation_date": 1464776585, "post_id": 37565546, "comment_id": 62618936, "body": "You have to be more specific , you need screen shots , code etc .  This question would have been ok to ask to a collegue who was looking at your screen. but when you ask on SO , you need to help people see your problem to get any meaningfull reply."}], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1464787248, "last_edit_date": 1464787248, "creation_date": 1464777839, "answer_id": 37566407, "question_id": 37565546, "link": "https://stackoverflow.com/questions/37565546/visual-studio-no-source-file-in-disassembly/37566407#37566407", "title": "Visual Studio: &quot;No source file&quot; in Disassembly", "body": "<p>To <a href=\"https://social.msdn.microsoft.com/Forums/en-US/503d3ded-976e-460e-b5f9-7e03454ed387/debugging-information-cannot-be-found-or-does-not-match?forum=Vsexpressvc\" rel=\"nofollow\">enable debugging</a>: (Also make sure building the programme in debug mode)</p>\n\n<blockquote>\n  <p>1) Goto Project->HelloWorld Properties</p>\n  \n  <p>2) On the left expand \"Configuration Properties\"</p>\n  \n  <p>3) Expand \"C/C++\"</p>\n  \n  <p>4) On the left, Select \"General\"</p>\n  \n  <p>5) On the right, change \"Debug Information Format\" to \"Program\n  Database For  Edit And Continue (/ZI)\"</p>\n  \n  <p>5) On the left, Select \"Optimization\"</p>\n  \n  <p>6) On the right, change \"Optimization\" to \"Disabled (/Od)\"</p>\n  \n  <p>7) On the left, expand \"Linker\"</p>\n  \n  <p>8) On the left, select \"Debugging\"</p>\n  \n  <p>9) On the right, change \"Generate Debug Info\" to \"Yes\"</p>\n  \n  <p>10) Click ok</p>\n  \n  <p>11) Set your breakpoints</p>\n  \n  <p>12) Rebuild your application</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6316186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d9fafef7463da04f3bba40da28330bd?s=128&d=identicon&r=PG&f=1", "display_name": "vanya", "link": "https://stackoverflow.com/users/6316186/vanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 672, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1464787248, "creation_date": 1464775456, "last_edit_date": 1495540354, "question_id": 37565546, "link": "https://stackoverflow.com/questions/37565546/visual-studio-no-source-file-in-disassembly", "title": "Visual Studio: &quot;No source file&quot; in Disassembly", "body": "<p>I am quite new to C programming, so I apologize if my question is not very clear, but I came across the following problem in Visual Studio:</p>\n\n<p>I'm trying to debug a function in my project, however when I put a breakpoint in it I get the following message - </p>\n\n<blockquote>\n  <p>\"The breakpoint will not currently be hit. No symbols have been loaded\n  for this document\".</p>\n</blockquote>\n\n<p>I already checked the proposed solutions in <a href=\"https://stackoverflow.com/questions/2155930/fixing-the-breakpoint-will-not-currently-be-hit-no-symbols-have-been-loaded-fo\">Fixing &quot;The breakpoint will not currently be hit. No symbols have been loaded for this document.&quot;</a> , but none of those worked.</p>\n\n<p>I've cleaned, rebuilt, deleted whatever similar files could be causing a problem, but no improvement. All the symbols are also loading properly. </p>\n\n<p>When I call the function in my code I am getting an output although I can't step in, so I opened the Disassembly and instead of my function, let's call it <code>func1()</code>, there's another function with similar name, <code>_func1()</code>, and I can step in its assembly, but there's No source file available.</p>\n\n<p>Any ideas how to find out where is <code>_func1()</code> located or why on the first place my initial function is not accessed?</p>\n"}, {"tags": ["c", "operating-system", "system", "sleep", "system-calls"], "answers": [{"comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1464782572, "post_id": 37565563, "comment_id": 62623234, "body": "what is the correct terminology? If I think about locks I would say busy waiting vs sleep."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1464775518, "creation_date": 1464775518, "answer_id": 37565563, "question_id": 37565439, "link": "https://stackoverflow.com/questions/37565439/is-function-sleep-active-on-passive/37565563#37565563", "title": "Is function sleep() active on passive?", "body": "<p><code>sleep</code> is <strong>not</strong> a standard C library function.</p>\n\n<p>If your platform has it, it almost certainly will make a call to the operating system to suspend the thread (that is, in your notation, <em>passive</em>).</p>\n\n<p>It will not adopt a <code>while(1){}</code>-type idiom as that will unnecessarily burn the CPU.</p>\n"}, {"tags": [], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1464779225, "last_edit_date": 1464779225, "creation_date": 1464775861, "answer_id": 37565685, "question_id": 37565439, "link": "https://stackoverflow.com/questions/37565439/is-function-sleep-active-on-passive/37565685#37565685", "title": "Is function sleep() active on passive?", "body": "<p>There are two general approaches to the implementation of the <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/sleep.html\" rel=\"nofollow\">sleep()</a> function.</p>\n\n<p>One is to use the <code>alarm()</code> function to schedule a <strong>SIGALRM</strong> signal and then suspend the calling thread waiting for that signal. The other is to implement an independent facility. </p>\n\n<p>Function <code>sleep()</code> is in  passive wait in unix.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1464779711, "creation_date": 1464779711, "answer_id": 37567080, "question_id": 37565439, "link": "https://stackoverflow.com/questions/37565439/is-function-sleep-active-on-passive/37567080#37567080", "title": "Is function sleep() active on passive?", "body": "<p><code>sleep()</code> is a <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sleep.html\" rel=\"nofollow\">standard POSIX function</a>:</p>\n\n<blockquote>\n  <p><strong>The <code>sleep()</code> function shall cause the calling thread to be suspended\n  from execution</strong> until either the number of realtime seconds specified\n  by the argument seconds has elapsed or a signal is delivered to the\n  calling thread and its action is to invoke a signal-catching function\n  or to terminate the process. The suspension time may be longer than\n  requested due to the scheduling of other activity by the system.</p>\n  \n  <p>...</p>\n</blockquote>\n"}], "owner": {"reputation": 97, "user_id": 2929215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qH2jP.png?s=128&g=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/2929215/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 1, "accepted_answer_id": 37565563, "answer_count": 3, "score": 3, "last_activity_date": 1464779711, "creation_date": 1464775193, "last_edit_date": 1464775690, "question_id": 37565439, "link": "https://stackoverflow.com/questions/37565439/is-function-sleep-active-on-passive", "title": "Is function sleep() active on passive?", "body": "<p>Is function sleep() in C an active wait or passive wait?</p>\n\n<p>Since it stops the thread running, is it always checking if the time has passed like:</p>\n\n<pre><code>while(1){\n//need to wake?\n}\n</code></pre>\n\n<p>Or a passive like:</p>\n\n<pre><code>alarm(sec);\n\npause(); // wait for the alarm and sleeping?\n</code></pre>\n\n<p>The system is unix.</p>\n"}, {"tags": ["c", "expression", "operator-precedence"], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 6309247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-ivdVBvfPrZg/AAAAAAAAAAI/AAAAAAAAAsQ/rmYiwvBzbh4/photo.jpg?sz=128", "display_name": "SWIIWII", "link": "https://stackoverflow.com/users/6309247/swiiwii"}, "edited": false, "score": 0, "creation_date": 1464775506, "post_id": 37565478, "comment_id": 62618213, "body": "This is the article <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">link</a>, so that it means all the operators of the <b>precedence 1</b> have the exactly precedence ?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 315, "user_id": 6309247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-ivdVBvfPrZg/AAAAAAAAAAI/AAAAAAAAAsQ/rmYiwvBzbh4/photo.jpg?sz=128", "display_name": "SWIIWII", "link": "https://stackoverflow.com/users/6309247/swiiwii"}, "edited": false, "score": 0, "creation_date": 1464775577, "post_id": 37565478, "comment_id": 62618261, "body": "@SWIIWII Yes, and the associativity is left-to-right."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 5, "last_activity_date": 1464775292, "creation_date": 1464775292, "answer_id": 37565478, "question_id": 37565386, "link": "https://stackoverflow.com/questions/37565386/brackets-and-points-order-in-language-c/37565478#37565478", "title": "brackets and points order in language c", "body": "<p>Operators <code>.</code> and <code>[]</code> have the same precedence, and are evaluated from left-to-right. The expression <code>a.b[i]</code> is the same as <code>(a.b)[i]</code></p>\n\n<p>The expression <code>a.b.c[i].d[j]</code> is evaluated as: <code>((((a.b).c)[i]).d)[j]</code></p>\n"}], "owner": {"reputation": 315, "user_id": 6309247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-ivdVBvfPrZg/AAAAAAAAAAI/AAAAAAAAAsQ/rmYiwvBzbh4/photo.jpg?sz=128", "display_name": "SWIIWII", "link": "https://stackoverflow.com/users/6309247/swiiwii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 37565478, "answer_count": 1, "score": 1, "last_activity_date": 1464775529, "creation_date": 1464775065, "last_edit_date": 1464775529, "question_id": 37565386, "link": "https://stackoverflow.com/questions/37565386/brackets-and-points-order-in-language-c", "title": "brackets and points order in language c", "body": "<h2>I wonder in language c, is <code>a.b[i]</code> is the same thing as <code>(a.b)[i]</code> ?</h2>\n\n<p>Here <strong>a</strong> is a structure and <strong>b</strong> is his member (<strong>b is an array or a pointer</strong>). \n<br>\nI read an article about precedence of c operators just now and it told me that the <strong>[ ] (brackets)</strong> operator is prior to the <strong>.(point)</strong>, and the <strong>associativity of these two c operators is left-to-right</strong> :\n<br></p>\n\n<h2>So what is the order of the following expression (in c)?</h2>\n\n<pre><code>a.b.c[i].d[j]\n</code></pre>\n"}, {"tags": ["c", "server", "queue"], "comments": [{"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 1, "creation_date": 1464774765, "post_id": 37564990, "comment_id": 62617674, "body": "Try to print the value of <code>front</code> or use debugger. The problem is that <code>front</code> seems to be NULL. And thus the function is never being run."}, {"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "reply_to_user": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1464775145, "post_id": 37564990, "comment_id": 62617946, "body": "@Mirakurun I was printing a message if the queue was empty after I added an element, and it seems the queue isn&#39;t empty at that point, but it still doesn&#39;t pass that conditional. I removed the print statements in the op because I thought it would make it more readable"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464775432, "post_id": 37564990, "comment_id": 62618154, "body": "I thing you have a typo: all  <code>strcmp</code> should be <code>strcpy</code> in <code>interpet</code> function body."}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1464775609, "post_id": 37564990, "comment_id": 62618285, "body": "Try to change <code>if(Front() != NULL)</code> into <code>if(Front() ==NULL)</code> just to see if the function would be called in that case. If yes, then <code>front</code> is definitely null."}, {"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464776354, "post_id": 37564990, "comment_id": 62618779, "body": "@LPs that was a typo, thanks. I tested it again and the interpret function isn&#39;t being run at all"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464776605, "post_id": 37564990, "comment_id": 62618954, "body": "Excuse me if I&#39;m going to say something too basic, but: do you have a client side code?"}, {"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464778494, "post_id": 37564990, "comment_id": 62620342, "body": "Yes, I have the client code, but it doesn&#39;t seem to be a client side problem. The message is getting to the server just fine, the server just isn&#39;t delivering the message"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464787421, "post_id": 37565273, "comment_id": 62627224, "body": "Thank you for your explanation. I will try using threads so that each instance changes the same variable"}, {"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464788411, "post_id": 37565273, "comment_id": 62628056, "body": "Hm concurrency ..? :/ Im not sure I know what that means... is it the program running the threads out of order? Is there an alternative way to achieve what I&#39;m trying to do? I had never used forks before, and I thought the memory was the same, only the instructions changed from process to process...."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464788698, "post_id": 37565273, "comment_id": 62628316, "body": "I think you should study something before start typing... Using multithreading solution you have code that is executed &quot;at the same time&quot; so accessing a global variable must be well managed. [This is a starting guide]. But, i repeat,  you need to study something about before to start with a so difficult stuff."}, {"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464790369, "post_id": 37565273, "comment_id": 62629708, "body": "Thank you for being so patient, Im going to read more on threads before trying to fix the code. Just one more question, is this way of writing a message server acceptable? I couldn&#39;t find any examples online and just tried something on my own, should I look into other solutions or is this ok?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464790738, "post_id": 37565273, "comment_id": 62630028, "body": "It is a very broad matter. You can do that using fork, threads or with 2 compiled different application. It depends on what are you looking for. <a href=\"http://www.tutorialspoint.com/unix_sockets/socket_server_example.htm\" rel=\"nofollow noreferrer\">This is a very plain and linear solution</a> that does not involve fork or threads."}, {"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464791387, "post_id": 37565273, "comment_id": 62630534, "body": "I read that one when I started this assignment, the problem is that I need to have client - client conversations, and that example only provides client server conversations. If there is a way to do that without using forks or threads that would be wonderful, since I never learned about that stuff in classes and I&#39;m trying to keep it simple... this was the only way I thought I could treat multiple connections"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464792381, "post_id": 37565273, "comment_id": 62631291, "body": "Well. it totally depends on many things. While using fork is &quot;complicated&quot; but force you to code taking care of &quot;context&quot;,  Multi-threading is simpler but concurrency is an hard matter. So choose one option and try to do your best. SO will help you with your problems. ;)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464792596, "post_id": 37565273, "comment_id": 62631452, "body": "<a href=\"http://stackoverflow.com/questions/37569571/is-a-mutex-necessary-when-only-inc-decrementing-a-variable\">Someone posted a good question on concurrency just now</a>. Take a look."}, {"owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 1, "creation_date": 1464797906, "post_id": 37565273, "comment_id": 62635057, "body": "Thanks for the link, I read that and a bunch of other stuff, so I think it comes down to either learning to lock memory with mutex, so I don&#39;t get 2 threads trying to interact with the queue or I learn mmap() to make different forked processes share the queue... either way, gotta read and study some more :p"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "edited": false, "score": 0, "creation_date": 1464800284, "post_id": 37565273, "comment_id": 62636504, "body": "That&#39;s the way. Good luck ;)"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 0, "last_activity_date": 1464784290, "last_edit_date": 1464784290, "creation_date": 1464774826, "answer_id": 37565273, "question_id": 37564990, "link": "https://stackoverflow.com/questions/37564990/trying-to-use-a-queue-to-handle-client-messages-on-a-server-c/37565273#37565273", "title": "Trying to use a queue to handle client messages on a server [C]", "body": "<p>You are misunderstanding how globals are managed after <code>fork()</code>.</p>\n\n<p>They are not shared; the processes can modify their own copies of the variables. Those modifications will not be notified to other childs/parents.</p>\n\n<p>So what you are trying to do with <code>Enqueue</code> makes change to the local copy of <code>front</code> pointer but other childs copies of front pointer are not updated.</p>\n\n<p>Reducing your code to minimum:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n\n/******Struct msg*********/\ntypedef struct msg\n{\n    char dest  [64];\n    char origin[64];\n    char text  [256];\n}msg;\n/*********Queue*********/\n/*Queue - Linked List implementation*/\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nstruct Node {\n    msg *data;\n    struct Node* next;\n};\nstruct Node* front = NULL;\nstruct Node* rear = NULL;\n\nvoid Enqueue(msg *x)\n{\n    struct Node* temp = malloc(sizeof(struct Node));\n\n    temp-&gt;data =x;\n    temp-&gt;next = NULL;\n\n    if(front == NULL &amp;&amp; rear == NULL)\n    {\n        front = rear = temp;\n        printf(\"front: %p\\n\", (void *)(front));\n        printf(\"rear: %p\\n\" , (void *)(rear));\n        printf(\"temp: %p\\n\" , (void *)(temp));\n        return;\n    }\n\n    rear-&gt;next = temp;\n    rear = temp;\n}\n\nvoid Dequeue(void) {\n    struct Node* temp = front;\n    if(front == NULL) {\n        printf(\"Queue is Empty\\n\");\n        return;\n    }\n    if(front == rear) {\n        front = rear = NULL;\n    }\n    else {\n        front = front-&gt;next;\n    }\n    free(temp);\n}\nmsg *Front(void) {\n    if(front == NULL) {\n        return 0;\n    }\n    return front-&gt;data;\n}\nvoid error(const char *msg)\n{\n    perror(msg);\n    exit(1);\n}\n\nint interpret(void)\n{\n\n    //this is temporary because there is an error with the code above which made the message not be correct\n    msg *message;\n    message = (msg*)malloc(sizeof(msg));\n\n    strcpy(message-&gt;dest, \"dest\");\n    strcpy(message-&gt;origin, \"origin\");\n    strcpy(message-&gt;text, \"blahblahblah\");\n    Enqueue(message);\n\n    return 1;\n}\n\nvoid dostuff (void)\n{\n    pid_t pid;\n\n    pid = fork();\n\n    if(pid &gt; 0)\n    {\n        interpret();\n    }\n    else\n    {\n        sleep(1);\n        printf(\"\\nfront: %p\\n\", (void *)(front));\n    }\n}\nint main(int argc, char *argv[])\n{\n    pid_t f, pid;\n\n    f = fork();\n\n    if(f &gt; 0)\n    {\n        pid = fork();\n\n        if (pid &lt; 0) \n           error(\"ERROR on fork\");\n\n        if (pid == 0)\n        {\n            dostuff();\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Output will be</p>\n\n<pre><code>front: 0x18371a0\nrear: 0x18371a0\ntemp: 0x18371a0\nroot@mypc:~$\nfront: (nil)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 6386218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0d3cb9b60dbbbf6ebfaad936fbcdb0?s=128&d=identicon&r=PG&f=1", "display_name": "Beka", "link": "https://stackoverflow.com/users/6386218/beka"}, "is_accepted": false, "score": 0, "last_activity_date": 1464785915, "creation_date": 1464785915, "answer_id": 37569413, "question_id": 37564990, "link": "https://stackoverflow.com/questions/37564990/trying-to-use-a-queue-to-handle-client-messages-on-a-server-c/37569413#37569413", "title": "Trying to use a queue to handle client messages on a server [C]", "body": "<p>Use threads instead of fork.\nStart two threads. One for listening and one for answering.</p>\n\n<p>Fork creates new OS process that shares the same code but data segments are different. So what you change in one process will not be seen in another.</p>\n"}], "owner": {"reputation": 23, "user_id": 6408713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7d88fed14d550594ecee01beaf2bbcf?s=128&d=identicon&r=PG&f=1", "display_name": "Lewis", "link": "https://stackoverflow.com/users/6408713/lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 37565273, "answer_count": 2, "score": 1, "last_activity_date": 1464785915, "creation_date": 1464774105, "question_id": 37564990, "link": "https://stackoverflow.com/questions/37564990/trying-to-use-a-queue-to-handle-client-messages-on-a-server-c", "title": "Trying to use a queue to handle client messages on a server [C]", "body": "<p>Im trying to write a server in c that allows clients connected to send messages to each other. I tried doing this by receiving the message, placing it on a queue and have the process that handles the server-client communication (function dostuff) deliver that message if the username matches with the message.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n\n/******Struct msg*********/\ntypedef struct msg\n{\n    char dest  [64]; \n    char origin[64];  \n    char text  [256]; \n}msg;\n/*********Queue*********/\n/*Queue - Linked List implementation*/\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nstruct Node {\n    msg *data;\n    struct Node* next;\n};\nstruct Node* front = NULL;\nstruct Node* rear = NULL;\nvoid Enqueue(msg *x) {\n    struct Node* temp = \n        (struct Node*)malloc(sizeof(struct Node));\n    temp-&gt;data =x; \n    temp-&gt;next = NULL;\n    if(front == NULL &amp;&amp; rear == NULL){\n        front = rear = temp;\n        return;\n    }\n    rear-&gt;next = temp;\n    rear = temp;\n}\nvoid Dequeue() {\n    struct Node* temp = front;\n    if(front == NULL) {\n        printf(\"Queue is Empty\\n\");\n        return;\n    }\n    if(front == rear) {\n        front = rear = NULL;\n    }\n    else {\n        front = front-&gt;next;\n    }\n    free(temp);\n}\nmsg *Front() {\n    if(front == NULL) {\n        return 0;\n    }\n    return front-&gt;data;\n}\nvoid error(const char *msg)\n{\n    perror(msg);\n    exit(1);\n}\n\nint interpret(char *line, char username[])\n{\n    //printf(\"Ready to interpret: %s\\n\",line);\n\n    /*  \n    char *command, *arg1 , *arg2,l[64];\n    msg *message;\n    strcpy(l,line);\n    command = strtok(l,\" \");\n\n    if(strcmp(command, \"/tell\") == 0)\n    {\n        printf(\"The command was vaid!\\n\");//chegou aqui\n        printf(\"Ready to interpret: %s\\n\",l);\n        arg1 = strtok(NULL,\" \");\n        printf(\"I got this far!\");\n        arg2 = l + strlen(command) + strlen(arg1) + 2; //somamos dois por causa dos espa\u00e7os\n\n        message = (msg*)malloc(sizeof(msg));\n\n        //printf(\"I got this far!\"); nao est\u00e1 a chegar aqui\n\n        strcmp(message-&gt;dest, arg1);\n        strcmp(message-&gt;origin, username);\n        strcmp(message-&gt;text, arg2);\n        Enqueue(message);\n        printf(\"(%s -&gt; %s) -%s- was placed on the queue\",message-&gt;origin,message-&gt;dest,message-&gt;text);\n    }\n    else\n    {\n        printf(\"comando inv\u00e1lido\");\n    }\n\n    */\n        //this is temporary because there is an error with the code above which made the message not be correct\n        msg *message;\n        message = (msg*)malloc(sizeof(msg));\n\n        strcmp(message-&gt;dest, \"dest\");\n        strcmp(message-&gt;origin, \"origin\");\n        strcmp(message-&gt;text, \"blahblahblah\");\n        Enqueue(message);\n\n    return 1;\n}\nvoid dostuff (int sock, char username[])\n{\n    int n, pid;\n    char buffer[256], dest[64]; \n    pid = fork();\n    while(1)\n    {\n        if(pid &gt; 0)\n        {\n            bzero(buffer,256);\n            n = read(sock,buffer,255);\n\n            if (n &lt; 0) error(\"ERROR reading from socket\");\n\n            printf(\"Here is the full message: %s\\n\",buffer);\n\n            //n = write(sock,\"I got your message!\\n\",18);\n            //if (n &lt; 0) error(\"ERROR writing to socket\");\n\n            interpret(buffer, username);\n        }\n        else\n        {\n            sleep(1); \n            if(Front() != NULL)\n            {\n                strcpy(dest, Front()-&gt;dest);\n                if(strcmp(dest, username) == 0)\n                {\n                    strcpy(buffer, Front()-&gt;text);\n                    Dequeue();\n                    n = write(sock,buffer,strlen(buffer));\n                    if (n &lt; 0) error(\"ERROR writing to socket\");\n                }\n            }\n        }   \n    }\n}\nint main(int argc, char *argv[])\n{\n     int sockfd, newsockfd, portno, pid , f;\n     int userCount;                                                       \n     socklen_t clilen;\n\n     struct sockaddr_in serv_addr, cli_addr;                                \n\n     if (argc &lt; 2)\n     {\n         fprintf(stderr,\"ERROR, no port provided\\n\");\n         exit(1);\n     }\n\n     sockfd = socket(AF_INET, SOCK_STREAM, 0);                            \n     if (sockfd &lt; 0) \n        error(\"ERROR opening socket\");\n\n     bzero((char *) &amp;serv_addr, sizeof(serv_addr));                            \n\n     portno = atoi(argv[1]); \n\n     serv_addr.sin_family = AF_INET;                                           \n     serv_addr.sin_addr.s_addr = INADDR_ANY;                                   \n     serv_addr.sin_port = htons(portno);                                      \n\n     if (bind(sockfd, (struct sockaddr *) &amp;serv_addr,\n              sizeof(serv_addr)) &lt; 0) \n              error(\"ERROR on binding\");\n\n     listen(sockfd,5);                                                        \n     clilen = sizeof(cli_addr);\n\n     userCount = 0;\n     char dname[64];                                                          \n     f = fork();\n\n     while (1) \n     {\n        if(f &gt; 0)\n        {\n            newsockfd = accept(sockfd,(struct sockaddr *) &amp;cli_addr, &amp;clilen);  \n            if (newsockfd &lt; 0) error(\"ERROR on accept\");\n\n            userCount++;                                                        \n            sprintf(dname, \"%d\", userCount);                                    \n\n            pid = fork();\n            if (pid &lt; 0) error(\"ERROR on fork\");  \n            if (pid == 0)\n            {\n                close(sockfd);\n                dostuff(newsockfd, dname);\n                exit(0);\n            }\n            else close(newsockfd);\n\n        }\n    }\n\n    close(sockfd);\n    return 0;\n}\n</code></pre>\n\n<p>The problem seems to be that this piece of code that is supposed to remove items from the queue :</p>\n\n<pre><code>if(Front() != NULL)\n            {\n                strcpy(dest, Front()-&gt;dest);\n                if(strcmp(dest, username) == 0)\n                {\n                    strcpy(buffer, Front()-&gt;text);\n                    Dequeue();\n                    n = write(sock,buffer,strlen(buffer));\n                    if (n &lt; 0) error(\"ERROR writing to socket\");\n                }\n            }\n</code></pre>\n\n<p>Is never being run. \nI never made anything like this before, so this approach might be totally wrong. If someone could explain me what I'm doing wrong, or suggest a different solution, that would be great.</p>\n"}, {"tags": ["c", "function", "static"], "answers": [{"comments": [{"owner": {"reputation": 867, "user_id": 2063868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f1e7a47eb60a9b8d768134f1a400e96?s=128&d=identicon&r=PG", "display_name": "seereddi sekhar", "link": "https://stackoverflow.com/users/2063868/seereddi-sekhar"}, "edited": false, "score": 0, "creation_date": 1464773425, "post_id": 37564653, "comment_id": 62616705, "body": "data section will not be cleared after the completion of function call??"}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 867, "user_id": 2063868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f1e7a47eb60a9b8d768134f1a400e96?s=128&d=identicon&r=PG", "display_name": "seereddi sekhar", "link": "https://stackoverflow.com/users/2063868/seereddi-sekhar"}, "edited": false, "score": 0, "creation_date": 1464773526, "post_id": 37564653, "comment_id": 62616778, "body": "No, when functions finish execution data section is not impacted."}], "tags": [], "owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "is_accepted": false, "score": 3, "last_activity_date": 1464773577, "last_edit_date": 1464773577, "creation_date": 1464773350, "answer_id": 37564653, "question_id": 37564582, "link": "https://stackoverflow.com/questions/37564582/how-the-static-variable-gets-retrieved-for-every-function-call/37564653#37564653", "title": "How the static variable gets retrieved for every function call", "body": "<p>Yes, static variables persist between function calls. They reside in data section of the program, like global variables.</p>\n\n<p>You can (and probably should) read more about general memory layout of C applications <a href=\"http://www.geeksforgeeks.org/memory-layout-of-c-program/\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1464773412, "creation_date": 1464773412, "answer_id": 37564682, "question_id": 37564582, "link": "https://stackoverflow.com/questions/37564582/how-the-static-variable-gets-retrieved-for-every-function-call/37564682#37564682", "title": "How the static variable gets retrieved for every function call", "body": "<p>You made an incorrect assumption that <code>static</code> variables are placed on the stack<sup>*</sup> when the function that uses them is running, so they need to be saved and retrieved.</p>\n\n<p>This is not how C does it: static variables are allocated in an entirely different memory segment outside of stack, so they do not get freed when the function ends the scope of its automatic variables.</p>\n\n<p>Typically, static data segment is created and initialized once upon entering the program. After that the segment stays allocated for as long as your program is running. All your global variables, along with the static variables from all functions, are placed in this segment by the compiler. That is why entering or leaving functions has no effect on these variables.</p>\n\n<p><sup>*</sup> The official name for \"stack\" is \"automatic storage area\".</p>\n"}, {"comments": [{"owner": {"reputation": 867, "user_id": 2063868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f1e7a47eb60a9b8d768134f1a400e96?s=128&d=identicon&r=PG", "display_name": "seereddi sekhar", "link": "https://stackoverflow.com/users/2063868/seereddi-sekhar"}, "edited": false, "score": 0, "creation_date": 1464773680, "post_id": 37564718, "comment_id": 62616888, "body": "Thank u Rahul. So static variables gets their memory allocated at compilation time, right??"}, {"owner": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "edited": false, "score": 2, "creation_date": 1464773704, "post_id": 37564718, "comment_id": 62616907, "body": "Appreciate for highlighting that the implementation is not specified by the language."}, {"owner": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "reply_to_user": {"reputation": 867, "user_id": 2063868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f1e7a47eb60a9b8d768134f1a400e96?s=128&d=identicon&r=PG", "display_name": "seereddi sekhar", "link": "https://stackoverflow.com/users/2063868/seereddi-sekhar"}, "edited": false, "score": 2, "creation_date": 1464773794, "post_id": 37564718, "comment_id": 62616972, "body": "@seereddisekhar They don&#39;t actually get allocated at compile time, when you run the executable, the loader will pace the executable in the memory as per specified in the executable. Therefore the actual allocation will happen when loading, but when compiling a specification, relative addresses and offsets will be defined."}, {"owner": {"reputation": 867, "user_id": 2063868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f1e7a47eb60a9b8d768134f1a400e96?s=128&d=identicon&r=PG", "display_name": "seereddi sekhar", "link": "https://stackoverflow.com/users/2063868/seereddi-sekhar"}, "reply_to_user": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "edited": false, "score": 0, "creation_date": 1464774025, "post_id": 37564718, "comment_id": 62617144, "body": "Thank you @phoxis for the calrification"}], "tags": [], "owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "is_accepted": true, "score": 3, "last_activity_date": 1464773504, "creation_date": 1464773504, "answer_id": 37564718, "question_id": 37564582, "link": "https://stackoverflow.com/questions/37564582/how-the-static-variable-gets-retrieved-for-every-function-call/37564718#37564718", "title": "How the static variable gets retrieved for every function call", "body": "<p>The <a href=\"https://en.wikipedia.org/wiki/Static_variable\" rel=\"nofollow\">wiki</a> says:</p>\n\n<blockquote>\n  <p>In the C programming language, static is used with global variables\n  and functions to set their scope to the containing file. In local\n  variables, static is used to store the variable in the statically\n  allocated memory instead of the automatically allocated memory. <strong>While\n  the language does not dictate the implementation of either type of\n  memory, statically allocated memory is typically reserved in data\n  segment of the program at compile time</strong>, while the automatically\n  allocated memory is normally implemented as a transient call stack.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>Static local variables: variables declared as static inside a function\n  are statically allocated while having the same scope as automatic\n  local variables. Hence whatever values the function puts into its\n  static local variables during one call will still be present when the\n  function is called again.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 735, "user_id": 2568434, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/2aDtk.jpg?s=128&g=1", "display_name": "dear_tzvi", "link": "https://stackoverflow.com/users/2568434/dear-tzvi"}, "is_accepted": false, "score": 3, "last_activity_date": 1464778058, "last_edit_date": 1464778058, "creation_date": 1464774674, "answer_id": 37565227, "question_id": 37564582, "link": "https://stackoverflow.com/questions/37564582/how-the-static-variable-gets-retrieved-for-every-function-call/37565227#37565227", "title": "How the static variable gets retrieved for every function call", "body": "<p>Adding some more information on top of previously given answers - </p>\n\n<p>The memory for static objects is allocated at compile/link time. Their address is fixed by the linker based on the linker control file.</p>\n\n<p>The linker file defines the physical memory layout (Flash/SRAM) and placement of the different program regions.</p>\n\n<p>The static region is actually subdivided into two further sections, one for initial value, and the other for changes done in run time.</p>\n\n<p>And finally, remember that if you will not specify otherwise, the value will be set to 0 during compilation.</p>\n"}, {"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1464776228, "creation_date": 1464776228, "answer_id": 37565822, "question_id": 37564582, "link": "https://stackoverflow.com/questions/37564582/how-the-static-variable-gets-retrieved-for-every-function-call/37565822#37565822", "title": "How the static variable gets retrieved for every function call", "body": "<p>Consider this example:</p>\n\n<pre><code>static int foo;\n\nvoid f(void)\n{\n    static int bar;\n}\n</code></pre>\n\n<p>The only difference between <em>foo</em> and <em>bar</em> is that <em>foo</em> has file scope whereas <em>bar</em> has function scope. Both variables exist during the whole lifetime of the program.</p>\n"}], "owner": {"reputation": 867, "user_id": 2063868, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f1e7a47eb60a9b8d768134f1a400e96?s=128&d=identicon&r=PG", "display_name": "seereddi sekhar", "link": "https://stackoverflow.com/users/2063868/seereddi-sekhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 37564718, "answer_count": 5, "score": 3, "last_activity_date": 1464778058, "creation_date": 1464773184, "question_id": 37564582, "link": "https://stackoverflow.com/questions/37564582/how-the-static-variable-gets-retrieved-for-every-function-call", "title": "How the static variable gets retrieved for every function call", "body": "<p>We know that when the control exits from function the stack space will be freed. So what happens for static variables. Will they be saved in any memory and retrieved when the function gets called ??</p>\n"}, {"tags": ["c", "linux", "named-pipes", "file-descriptor"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1464774019, "post_id": 37564481, "comment_id": 62617140, "body": "You can transfer file descriptors over sockets, but I don&#39;t think it&#39;s possible to do so using a named pipe. Consider using a socket to communicate with your d&#230;mon."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1464775043, "creation_date": 1464775043, "answer_id": 37565383, "question_id": 37564481, "link": "https://stackoverflow.com/questions/37564481/how-can-i-transfer-a-filedescriptor-over-a-named-pipe/37565383#37565383", "title": "How can I transfer a filedescriptor over a named pipe", "body": "<p>A named pipe won't work for what you want to do - the pipe retains no information regarding where the data in it came from.  It's a <em>pipe</em> for raw data bits, not a <em>connection</em> like a socket that retains a lot more information about where the data came from and where it's going.</p>\n\n<p>Unix-domain sockets and named pipes are not the same - they have different capabilities.  Unix-domain sockets can be used to send file descriptors between processes, named pipes can't.  <em>Why</em> they have been implemented that way is another question.</p>\n\n<p>Since you're trying to create a socket connection between your daemon and client processes, just use Unix-domain sockets to get such a connection directly.  File system permissions work with Unix-domain sockets just as they do for named pipes.</p>\n"}], "owner": {"reputation": 616, "user_id": 3306678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dd72a88a67d63fce90ba5755adc61cf9?s=128&d=identicon&r=PG", "display_name": "TabascoEye", "link": "https://stackoverflow.com/users/3306678/tabascoeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 0, "accepted_answer_id": 37565383, "answer_count": 1, "score": 0, "last_activity_date": 1464775043, "creation_date": 1464772946, "question_id": 37564481, "link": "https://stackoverflow.com/questions/37564481/how-can-i-transfer-a-filedescriptor-over-a-named-pipe", "title": "How can I transfer a filedescriptor over a named pipe", "body": "<p>My goal is to create a concept for daemons which interact locally (i.e. not via network) with other processes, all with different user ids/rights.</p>\n\n<p>To restrict access to the daemons to processes with the right access levels, I throught of the following concept:</p>\n\n<ul>\n<li>Each daemon opens a named pipe for reading in <code>/foo/{daemon-name}</code></li>\n<li>The access to that named pipe can be easily managed via normal file access rights, so other processes not in the correct user group will have no write access to the pipe</li>\n<li>changing access rights to the daemon later is easily done without the need to recompile</li>\n<li>a process that wants to communicate with the daemon sends one end of a <code>socketpair()</code> via the named pipe and communication continues over that link</li>\n</ul>\n\n<p>That way, each dameon could implement their own API or packet format to communicate via the socketpair. But there would be no need for authentication and such because the access rights to the named pipe already took care of only a specific group being able to send the socketpair to communicate over.</p>\n\n<p>Now the only problem I have is that I can't get the transfer of the <code>socketpair()</code> file descritor to work over the named pipe.\n<code>sendmsg()</code> apparently does not work on named pipes.</p>\n\n<p>How can I send one of the <code>socketpair()</code> fds via the named pipe so that the daemon can access the connection and start communicating?</p>\n"}, {"tags": ["c", "linux", "ubuntu", "compilation"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1464774464, "post_id": 37564444, "comment_id": 62617479, "body": "Are you sure the error message is not: <code>open: No such file or directory</code> ? If it is then that error message is coming from the line: <code>perror(&quot;open&quot;);</code> - probably because you have no file <code>lockdemo.c</code>."}, {"owner": {"reputation": 15, "user_id": 4799449, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb622b32fcd04dc6080cb84ad2794ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Vu Ha", "link": "https://stackoverflow.com/users/4799449/vu-ha"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1464774980, "post_id": 37564444, "comment_id": 62617830, "body": "may be i have not create lockdemo.c. I have never created it before so i must check again. thank u so much and please take my kiss too."}], "owner": {"reputation": 15, "user_id": 4799449, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb622b32fcd04dc6080cb84ad2794ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Vu Ha", "link": "https://stackoverflow.com/users/4799449/vu-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464792732, "creation_date": 1464772850, "last_edit_date": 1464777924, "question_id": 37564444, "link": "https://stackoverflow.com/questions/37564444/compile-completed-but-can-not-excute-with-error-no-such-file-or-directory-in-u", "title": "compile completed but can not excute with error &quot;no such file or directory&quot; in ubuntu", "body": "<p>I compile a short file named <code>myfile.c</code> with <code>gcc</code> compiler like:</p>\n\n<pre><code>$ gcc myfile.c -o myapp\n</code></pre>\n\n<p>everything is ok and I run it by:</p>\n\n<pre><code>$ ./myapp\n</code></pre>\n\n<p>and what I've got:</p>\n\n<pre><code>No such file or directory.\n</code></pre>\n\n<p>When I  <code>ls</code>, myapp is still there on the screen, just I can not run it. But some other files I've compiled still working normally. I've even removed some execute files and compiled them again and it's smooth working, so I guess the problem is in myfile.c.</p>\n\n<p>The question is: why the file exist after compiling, but the kernel can not realize it with the alert \"no such file or directory\".</p>\n\n<p>The myfile.c I've copy from beej.us for learning:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[])\n{\n                    /* l_type   l_whence  l_start  l_len  l_pid   */\n    struct flock fl = {F_WRLCK, SEEK_SET,   0,      0,     0 };\n    int fd;\n\n    fl.l_pid = getpid();\n\n    if (argc &gt; 1) \n        fl.l_type = F_RDLCK;\n\n    if ((fd = open(\"lockdemo.c\", O_RDWR)) == -1) {\n        perror(\"open\");\n        exit(1);\n    }\n\n    printf(\"Press &lt;RETURN&gt; to try to get lock: \");\n    getchar();\n    printf(\"Trying to get lock...\");\n\n    if (fcntl(fd, F_SETLKW, &amp;fl) == -1) {\n        perror(\"fcntl\");\n        exit(1);\n    }\n\n    printf(\"got lock\\n\");\n    printf(\"Press &lt;RETURN&gt; to release lock: \");\n    getchar();\n\n    fl.l_type = F_UNLCK;  /* set to unlock same region */\n\n    if (fcntl(fd, F_SETLK, &amp;fl) == -1) {\n        perror(\"fcntl\");\n        exit(1);\n    }\n\n    printf(\"Unlocked.\\n\");\n\n    close(fd);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 0, "creation_date": 1464772819, "post_id": 37564351, "comment_id": 62616258, "body": "From the manpage, 1 will be converted to byte-size. So sending in int(1) should set every byte to 0x01.To set e.g. 01010101, send in 0x55 (unsigned)."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1464773006, "post_id": 37564351, "comment_id": 62616424, "body": "What is definition of <code>buffer</code>? If it&#39;s <code>char buffer[SIZE];</code> or similar,  then <code>sizeof(&amp;buffer)</code> is definitely wrong, because it returns size of a pointer."}, {"owner": {"reputation": 48, "user_id": 6408598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0edeb0fbfe47e69a8baa0757e49d15bc?s=128&d=identicon&r=PG", "display_name": "vvombat", "link": "https://stackoverflow.com/users/6408598/vvombat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1464773477, "post_id": 37564351, "comment_id": 62616741, "body": "@user694733 Sorry I left that part out. It&#39;s <code>void* buffer</code>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1464773557, "post_id": 37564351, "comment_id": 62616801, "body": "If it&#39;s <code>void</code> pointer, then <code>sizeof</code> will definitely not give you the correct size."}, {"owner": {"reputation": 1102, "user_id": 2974922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fcd187a430dfd497db690eedc5af14?s=128&d=identicon&r=PG&f=1", "display_name": "nucleon", "link": "https://stackoverflow.com/users/2974922/nucleon"}, "edited": false, "score": 0, "creation_date": 1464774157, "post_id": 37564351, "comment_id": 62617234, "body": "The value -1 (without quotes)  is 11111111b in 2&#39;s complement representation."}, {"owner": {"reputation": 48, "user_id": 6408598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0edeb0fbfe47e69a8baa0757e49d15bc?s=128&d=identicon&r=PG", "display_name": "vvombat", "link": "https://stackoverflow.com/users/6408598/vvombat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1474889316, "post_id": 37564351, "comment_id": 66701312, "body": "@user694733 Since I know the correct size of the buffer I edited the question to represent this through <code>BUF_LENGTH</code> . (OT: Just to complete this, thought I already commented on your comment. Thank you all!)"}], "answers": [{"comments": [{"owner": {"reputation": 3575, "user_id": 6081445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005fd098b0fa87b368915187a4e588fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Wallis", "link": "https://stackoverflow.com/users/6081445/kevin-wallis"}, "edited": false, "score": 0, "creation_date": 1464772988, "post_id": 37564455, "comment_id": 62616407, "body": "For <code>1010 1010</code> use memset(buffer, 0xAA, BUF_LENGTH); and for <code>01010101</code> use memset(buffer, 0x55, BUF_LENGTH);"}, {"owner": {"reputation": 3575, "user_id": 6081445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005fd098b0fa87b368915187a4e588fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Wallis", "link": "https://stackoverflow.com/users/6081445/kevin-wallis"}, "edited": false, "score": 0, "creation_date": 1464773009, "post_id": 37564455, "comment_id": 62616430, "body": "Can you add this to the answer"}], "tags": [], "owner": {"reputation": 1102, "user_id": 2974922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fcd187a430dfd497db690eedc5af14?s=128&d=identicon&r=PG&f=1", "display_name": "nucleon", "link": "https://stackoverflow.com/users/2974922/nucleon"}, "is_accepted": true, "score": 6, "last_activity_date": 1464773511, "last_edit_date": 1464773511, "creation_date": 1464772880, "answer_id": 37564455, "question_id": 37564351, "link": "https://stackoverflow.com/questions/37564351/how-does-the-conversion-of-int-value-to-unsigned-char-in-memset-work/37564455#37564455", "title": "How does the conversion of int value to unsigned char in memset() work?", "body": "<p>memset operates on a byte-by-byte basis.</p>\n\n<p>To zero the memory use:</p>\n\n<pre><code>memset(buffer, 0, BUF_LENGTH);\n</code></pre>\n\n<p>To set each byte to the value 1 use:</p>\n\n<pre><code>memset(buffer, 0x01, BUF_LENGTH);\n</code></pre>\n\n<p>For the binary pattern 10101010 use:</p>\n\n<pre><code>memset(buffer, 0xAA, BUF_LENGTH);\n</code></pre>\n\n<p>For the binary pattern 01010101 use:</p>\n\n<pre><code>memset(buffer, 0x55, BUF_LENGTH);\n</code></pre>\n\n<p>To set all bits in the buffer to 1 use:</p>\n\n<pre><code>memset(buffer, 0xFF, BUF_LENGTH);\n</code></pre>\n\n<p>BUF_LENGTH would be the length used in the array definition, e.g.</p>\n\n<pre><code>#define BUF_LENGTH 256\nchar buffer[BUF_LENGTH];\n</code></pre>\n\n<p>or what you used as length in dynamic memory allocation:</p>\n\n<pre><code>#define BUF_LENGTH 256\nchar *buffer = malloc(BUF_LENGTH);\n</code></pre>\n\n<p>Do not quote the 0 as in your code example, as this represents the ascii character '0', which has the value 0x30 (see <a href=\"http://www.asciitable.com/\" rel=\"nofollow\">http://www.asciitable.com/</a>).</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1464773278, "post_id": 37564605, "comment_id": 62616610, "body": "Binary literals are not a part of C standard."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1464773598, "post_id": 37564605, "comment_id": 62616824, "body": "@user694733 Was browsing [c++] and missed the C tag. Clarified."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 1, "last_activity_date": 1464773539, "last_edit_date": 1464773539, "creation_date": 1464773235, "answer_id": 37564605, "question_id": 37564351, "link": "https://stackoverflow.com/questions/37564351/how-does-the-conversion-of-int-value-to-unsigned-char-in-memset-work/37564605#37564605", "title": "How does the conversion of int value to unsigned char in memset() work?", "body": "<p>If this is C++, use binary literals, for instance <code>0b10101010</code> and <code>0b01010101</code>.</p>\n\n<p>If it is C, translate to hexadecimal, <code>0xAA</code> and <code>0x55</code>.</p>\n\n<p>(Using <code>'0'</code> and <code>'1'</code> will most likely result in 00110000 and 00110001, respectively.)</p>\n"}], "owner": {"reputation": 48, "user_id": 6408598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0edeb0fbfe47e69a8baa0757e49d15bc?s=128&d=identicon&r=PG", "display_name": "vvombat", "link": "https://stackoverflow.com/users/6408598/vvombat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1212, "favorite_count": 0, "accepted_answer_id": 37564455, "answer_count": 2, "score": 1, "last_activity_date": 1464773905, "creation_date": 1464772567, "last_edit_date": 1464773905, "question_id": 37564351, "link": "https://stackoverflow.com/questions/37564351/how-does-the-conversion-of-int-value-to-unsigned-char-in-memset-work", "title": "How does the conversion of int value to unsigned char in memset() work?", "body": "<pre><code>void * memset ( void * ptr, int value, size_t num );\n</code></pre>\n\n<p><code>memset()</code> sets the first num bytes of ptr to value. I want to use <code>memset()</code> to set all bytes of a void buffer to:</p>\n\n<pre><code>00000000\n11111111\n10101010\n01010101\n</code></pre>\n\n<p>For \"00000000\" I can use</p>\n\n<pre><code>memset(buffer, '0', BUF_LENGTH);\n</code></pre>\n\n<p>But am I right to assume</p>\n\n<pre><code>memset(buffer, '1', BUF_LENGTH);\n</code></pre>\n\n<p>won't end in \"11111111\", but in \"00000001\"? I've read that '-1' would do the trick, but why? And what value would i need to set bitwise 10101010 or 01010101? </p>\n"}, {"tags": ["c++", "c", "int", "compiler-options"], "comments": [{"owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "edited": false, "score": 1, "creation_date": 1464772875, "post_id": 37564338, "comment_id": 62616307, "body": "It is standard in the C++ language now. C++11 and forth see the types: <a href=\"http://en.cppreference.com/w/cpp/types/integer\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/types/integer</a> <code>int32_t</code>, <code>int64_t</code>, etc."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 1, "creation_date": 1464776283, "post_id": 37564338, "comment_id": 62618730, "body": "<code>typedef</code> and tell your students to use the typedef&#39;ed datatype?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1464777053, "post_id": 37564338, "comment_id": 62619265, "body": "If you do the <code>typedef</code> thing, just be aware that it&#39;s not strictly the same as using native 16-bit <code>int</code>. Using types <code>int16_t a, b;</code>, <code>a + b</code> might overflow on 16-bit system, but will never overflow on 32-bit system due to <i>usual arithmetric conversions</i>."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1464788380, "post_id": 37564338, "comment_id": 62628030, "body": "user 694733 has a good point, but the &quot;<code>int16_t</code> is not a real <code>int</code>&quot; problem pops up in more places. The constant <code>32768</code> won&#39;t be an <code>int16_t</code>, nor will the expression <code>1&lt;&lt;15</code>."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1464788861, "post_id": 37564338, "comment_id": 62628463, "body": "There&#39;s a meta-level question here: If you can&#39;t find a compiler where this matters, should you bother teaching it? It might be easier to use <code>long</code> for your course, because that does vary on real compilers (64 on GCC/x64, 32 on MSVC)"}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 4204635, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/86cfc65c669ad598c21dc1cc9c236acb?s=128&d=identicon&r=PG&f=1", "display_name": "BenevolentDeity", "link": "https://stackoverflow.com/users/4204635/benevolentdeity"}, "edited": false, "score": 0, "creation_date": 1464826118, "post_id": 37564510, "comment_id": 62648291, "body": "I chose this as the best answer simply because some of suggestions in the previous postings would not work in my situation due to arithmetic type conversions.  I also have no control over the values that will be used in these variables."}], "tags": [], "owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "is_accepted": true, "score": 1, "last_activity_date": 1464774663, "last_edit_date": 1464774663, "creation_date": 1464773010, "answer_id": 37564510, "question_id": 37564338, "link": "https://stackoverflow.com/questions/37564338/c-c-compiler-that-allows-int-width-selection/37564510#37564510", "title": "C/C++ Compiler that allows int width selection", "body": "<p>See the integer types defined in C++11 and forth: <a href=\"http://en.cppreference.com/w/cpp/types/integer\" rel=\"nofollow\">http://en.cppreference.com/w/cpp/types/integer</a> : <code>int8_t</code>, <code>int16_t</code>, <code>int32_t</code>, <code>int64_t</code></p>\n\n<p>These should be supported by almost any modern C++ compiler: <a href=\"http://www.mingw.org/\" rel=\"nofollow\">GCC you can use MinGW on Windows</a>, <a href=\"https://www.visualstudio.com/\" rel=\"nofollow\">MSVC</a>, <a href=\"https://software.intel.com/en-us/c-compilers\" rel=\"nofollow\">Intel</a>, <a href=\"http://clang.llvm.org/\" rel=\"nofollow\">Clang</a>, even <a href=\"https://www.embarcadero.com/products/cbuilder\" rel=\"nofollow\">Borland/Codegear/Embarcardero</a> as they are now part of the standard.</p>\n\n<p>The fixed width integral types has been part of the C language since C99, but was finally added to C++ in C++11 see: <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1988.pdf\" rel=\"nofollow\">N1988</a></p>\n"}, {"comments": [{"owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "edited": false, "score": 0, "creation_date": 1464773490, "post_id": 37564542, "comment_id": 62616745, "body": "If this is for embedded programming, it is often very useful to know the exact width of the integer type used, and more importantly you want this to be portable across compilers and platforms. <code>__int16</code> is a vendor specific extension to the language, and not a native part of the language."}, {"owner": {"reputation": 1775, "user_id": 1618844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/Pz2m0.jpg?s=128&g=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/1618844/amit"}, "reply_to_user": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "edited": false, "score": 0, "creation_date": 1464773666, "post_id": 37564542, "comment_id": 62616879, "body": "Absolutely. That is why most portable programs that I saw used things such as #defines of the form of INT16, and during porting used to change the #defines to whatever the equivalent was on the underlying system."}, {"owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "edited": false, "score": 0, "creation_date": 1464773981, "post_id": 37564542, "comment_id": 62617110, "body": "would it then not make sense to alter the part of your answer stating &quot;Finally if you have problem with short, C++ does offer __int16&quot; since C++ does in fact not offer <code>__int16</code> (although it does offer <code>int16_t</code>) but the compiler might offer it."}, {"owner": {"reputation": 1775, "user_id": 1618844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/Pz2m0.jpg?s=128&g=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/1618844/amit"}, "reply_to_user": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "edited": false, "score": 0, "creation_date": 1464774253, "post_id": 37564542, "comment_id": 62617300, "body": "Makes sense. What would also make sense is altering your question where you stated your motive was to teach students about overflow and you sort of imply that ints have some inherent problems in teaching overflow."}, {"owner": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "edited": false, "score": 0, "creation_date": 1464774312, "post_id": 37564542, "comment_id": 62617339, "body": "Hi Amit, I am not the one asking the question. But I am the one presenting the answer. :)"}, {"owner": {"reputation": 1775, "user_id": 1618844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/Pz2m0.jpg?s=128&g=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/1618844/amit"}, "reply_to_user": {"reputation": 6654, "user_id": 111143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yhf9U.jpg?s=128&g=1", "display_name": "Tommy Andersen", "link": "https://stackoverflow.com/users/111143/tommy-andersen"}, "edited": false, "score": 0, "creation_date": 1464774658, "post_id": 37564542, "comment_id": 62617603, "body": "ahh! my bad. If the problem is with portability, to the extent that someone if contemplating going to 16 bit, then best to stay with &#39;common&#39; data types likely to be available with most compilers. Better that, then to hunt a compiler that supports all (later day) standard mandated data type"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1464788129, "post_id": 37564542, "comment_id": 62627818, "body": "&quot;Older versions of Visual Studio&quot; is an understatement. VS2008 is old. VS6.0 is ancient. VS1.52 is 16 bits."}], "tags": [], "owner": {"reputation": 1775, "user_id": 1618844, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/Pz2m0.jpg?s=128&g=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/1618844/amit"}, "is_accepted": false, "score": 1, "last_activity_date": 1464775297, "last_edit_date": 1464775297, "creation_date": 1464773096, "answer_id": 37564542, "question_id": 37564338, "link": "https://stackoverflow.com/questions/37564338/c-c-compiler-that-allows-int-width-selection/37564542#37564542", "title": "C/C++ Compiler that allows int width selection", "body": "<p>C++ compilers do support shorts. If this is for teaching, can't you just tell you students to use shorts rather than ints?</p>\n\n<p>And if the purpose is just to tell them about overflows, why can't inputs be provided to the programs using ints that would cause overflows? inputs like 2 billion + 2 billion OR 2 billion x 6?</p>\n\n<p>Back when this was a problem, people also used to define there own constants like INT16 and map them to underlying data type; like INT16 == short on C++. </p>\n\n<p>Finally if you have problem with short, C++ does offer a 16 bit integer type as a standard data type since C++11. </p>\n\n<p>If you do absolutely need an int to be 16 bit, you may find it in compilers such as Digital Mars that allow you to target Win 16 APIs, OR older versions of Visual Studio. </p>\n"}], "owner": {"reputation": 537, "user_id": 4204635, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/86cfc65c669ad598c21dc1cc9c236acb?s=128&d=identicon&r=PG&f=1", "display_name": "BenevolentDeity", "link": "https://stackoverflow.com/users/4204635/benevolentdeity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 37564510, "answer_count": 2, "score": 3, "last_activity_date": 1464775297, "creation_date": 1464772540, "question_id": 37564338, "link": "https://stackoverflow.com/questions/37564338/c-c-compiler-that-allows-int-width-selection", "title": "C/C++ Compiler that allows int width selection", "body": "<p>Does anyone know of a modern native Windows C or C++ compiler that allows you to select between 16-bit and 32-bit type int?  I encountered a cross-compiler back in the 80s that had this feature but I need a native compiler.  As part of teaching my students about portability and standards compliance I would like to be able to automatically check their code for overflow if they are multiplying, adding, etc. two type int quantities and the result would be greater than a 16-bit int could represent.  Thanks.</p>\n"}, {"tags": ["c", "uuid", "openmax"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464773772, "post_id": 37563867, "comment_id": 62616950, "body": "It seems to be a C-string so <code>&#39;0&#39;</code>, <code>&#39;1&#39;</code>, or better <code>snprintf(OMX_UUIDTYPE, sizeof(OMX_UUIDTYPE), &quot;%d&quot;, your_number);</code> in case of UUID is a number only and no alphanumerical code."}, {"owner": {"reputation": 648, "user_id": 3081675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/729e2dcea76b214b1bd2217b62ef9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "Wiki Wang", "link": "https://stackoverflow.com/users/3081675/wiki-wang"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464838193, "post_id": 37563867, "comment_id": 62650825, "body": "my number is 128bit number like 0x4ac23030f4e06cb43ad9384123acc89f, so i cant use %d. guess i have to turn it into bits."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464854286, "post_id": 37563867, "comment_id": 62657336, "body": "Surely you cannot input 128 digit into a 128 char array as string. You should have 129 array items to have room for a null terminator. BTW looking around on the web in some code libraries use strlen function on the type of varibles, so it is defenetly a string. <a href=\"https://www.khronos.org/registry/omxil/specs/OpenMAX_IL_1_2_0_Specification.pdf\" rel=\"nofollow noreferrer\">Manual</a> at page 64 says: <i>A very long unique identifier to uniquely identify at runtime. This identifier should be generated by a component in a way that guarantees that every instance of the identifier running on the system is unique.</i>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464854321, "post_id": 37563867, "comment_id": 62657360, "body": "So I suggest to use %d to put your number into that variable. Mandatory is that the number must be unique on the target system."}, {"owner": {"reputation": 648, "user_id": 3081675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/729e2dcea76b214b1bd2217b62ef9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "Wiki Wang", "link": "https://stackoverflow.com/users/3081675/wiki-wang"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464916893, "post_id": 37563867, "comment_id": 62693573, "body": "I make the uuid according to <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Universally_unique_identifier</a>"}], "owner": {"reputation": 648, "user_id": 3081675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/729e2dcea76b214b1bd2217b62ef9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "Wiki Wang", "link": "https://stackoverflow.com/users/3081675/wiki-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464772712, "creation_date": 1464771249, "last_edit_date": 1464772712, "question_id": 37563867, "link": "https://stackoverflow.com/questions/37563867/why-uuid-in-openmax-is-128-bytes", "title": "Why uuid in OpenMax is 128 bytes?", "body": "<p>in OMX_Types.h there is</p>\n\n<pre><code>typedef unsigned char OMX_UUIDTYPE[128];\n</code></pre>\n\n<p>should I store every bit in a char?\nif so, use actual number 0,1 or use ascii character '0','1'?</p>\n"}, {"tags": ["c", "unix", "stat", "opendir"], "comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 6, "creation_date": 1464769709, "post_id": 37563217, "comment_id": 62614171, "body": "Use <code>stat</code> to find which directory entries are regular files. See <a href=\"http://stackoverflow.com/questions/1633797/list-regular-files-only-without-directory-problem\">List regular files only (without directory) problem</a>"}, {"owner": {"reputation": 2565, "user_id": 4593127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d661b3425b0e9cd38ee220844e1b8659?s=128&d=identicon&r=PG&f=1", "display_name": "gaganso", "link": "https://stackoverflow.com/users/4593127/gaganso"}, "edited": false, "score": 1, "creation_date": 1464769814, "post_id": 37563217, "comment_id": 62614243, "body": "I think your current directory has only files. That&#39;s the reason you are getting only files. I mean no issue with opendir() as you seem to be claiming"}, {"owner": {"reputation": 83, "user_id": 4968522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74dc1e080e9cb836f71ea3f411cc37aa?s=128&d=identicon&r=PG&f=1", "display_name": "wooden", "link": "https://stackoverflow.com/users/4968522/wooden"}, "edited": false, "score": 0, "creation_date": 1464769847, "post_id": 37563217, "comment_id": 62614270, "body": "Yes. Just noticed, anyway how could I achieve what I want?"}, {"owner": {"reputation": 2565, "user_id": 4593127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d661b3425b0e9cd38ee220844e1b8659?s=128&d=identicon&r=PG&f=1", "display_name": "gaganso", "link": "https://stackoverflow.com/users/4593127/gaganso"}, "edited": false, "score": 0, "creation_date": 1464770030, "post_id": 37563217, "comment_id": 62614388, "body": "@wooden, as Klas suggested try out stat."}], "owner": {"reputation": 83, "user_id": 4968522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74dc1e080e9cb836f71ea3f411cc37aa?s=128&d=identicon&r=PG&f=1", "display_name": "wooden", "link": "https://stackoverflow.com/users/4968522/wooden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "closed_date": 1465413828, "answer_count": 0, "score": 0, "last_activity_date": 1464775504, "creation_date": 1464769449, "last_edit_date": 1464775504, "question_id": 37563217, "link": "https://stackoverflow.com/questions/37563217/how-to-print-only-files-from-a-directory-passed-by-command-line-argument", "closed_reason": "Duplicate", "title": "How to print only files from a directory passed by command line argument", "body": "<p>I have this code which outputs names of files and directories in current directory, how can I make it print <strong>only files</strong> from a specified directory</p>\n\n<pre><code> #include &lt;stdlib.h&gt;\n #include &lt;stdio.h&gt;\n #include &lt;sys/types.h&gt;\n #include &lt;dirent.h&gt;\n #include &lt;string.h&gt;\n #include &lt;errno.h&gt;\n\n int main (int c, char *v[]) {\n     DIR * d;\n     char * dir_name = \".\";\n\n     /* Open the current directory. */     \n     d = opendir (dir_name);\n\n     if (! d) {\n         fprintf (stderr, \"Cannot open directory '%s': %s\\n\",\n                  dir_name, strerror (errno));\n         exit (EXIT_FAILURE);\n     }\n     while (1) {\n         struct dirent * entry;             \n         entry = readdir (d);\n         if (! entry) {\n             break;\n         }\n         printf (\"%s\\n\", entry-&gt;d_name);\n     }\n     /* Close the directory. */\n     if (closedir (d)) {\n         fprintf (stderr, \"Could not close '%s': %s\\n\",\n                  dir_name, strerror (errno));\n         exit (EXIT_FAILURE);\n     }\n\n     return 0; \n}\n</code></pre>\n\n<p>I have changed </p>\n\n<pre><code> d = opendir (dir_name)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>  d = opendir (v[1])\n</code></pre>\n\n<p>It opens a directory I need but it does not print only files, it prints everything what is in that directory.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 414, "user_id": 1582263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03999b3478e0ac4b8b25eb2eeba79904?s=128&d=identicon&r=PG", "display_name": "tigris", "link": "https://stackoverflow.com/users/1582263/tigris"}, "edited": false, "score": 0, "creation_date": 1464769417, "post_id": 37563092, "comment_id": 62614002, "body": "did you check unit of the time_to_complete? e.g. (second, millisecond, microsecond )"}, {"owner": {"reputation": 20231, "user_id": 1342730, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/36543a7316596ec6e930bc8c996bf14b?s=128&d=identicon&r=PG", "display_name": "mathematician1975", "link": "https://stackoverflow.com/users/1342730/mathematician1975"}, "edited": false, "score": 0, "creation_date": 1464769426, "post_id": 37563092, "comment_id": 62614008, "body": "Why not store the value returned by <code>clock()</code> in a new variable after the answer is entered and then use a debugger to track the value?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464770141, "post_id": 37563092, "comment_id": 62614472, "body": "Side note: as <a href=\"http://man7.org/linux/man-pages/man3/clock.3.html\" rel=\"nofollow noreferrer\">Man</a> says clock function return <code>clock_t</code> type. I proposed the duplicate because <code>scanf</code> is blocking teh code until user input data."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464769907, "post_id": 37563342, "comment_id": 62614311, "body": "Start program, run until <code>scanf</code>, go make coffee. You can&#39;t tell if it took too long before the user actually inputs something."}, {"owner": {"reputation": 63, "user_id": 5641914, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R32fpev4RI0/AAAAAAAAAAI/AAAAAAAAAGI/WMJtLrTROfs/photo.jpg?sz=128", "display_name": "Anton Oshchepko", "link": "https://stackoverflow.com/users/5641914/anton-oshchepko"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464840549, "post_id": 37563342, "comment_id": 62651317, "body": "I can&#39;t see requirements for sscanf interrupt from question text. If it needed in simple case we can use alarm() call and SIGTERM handler for this on POSIX-capatible OS."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464852654, "post_id": 37563342, "comment_id": 62656329, "body": "&quot;skip to the next question automatically without her inputting anything&quot;"}], "tags": [], "owner": {"reputation": 63, "user_id": 5641914, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R32fpev4RI0/AAAAAAAAAAI/AAAAAAAAAGI/WMJtLrTROfs/photo.jpg?sz=128", "display_name": "Anton Oshchepko", "link": "https://stackoverflow.com/users/5641914/anton-oshchepko"}, "is_accepted": false, "score": -1, "last_activity_date": 1464769782, "creation_date": 1464769782, "answer_id": 37563342, "question_id": 37563092, "link": "https://stackoverflow.com/questions/37563092/continue-to-next-statement-automatically-after-a-set-amount-of-time/37563342#37563342", "title": "Continue to next statement automatically after a set amount of time", "body": "<p>Do you specify time_to_complete variable as time into seconds?</p>\n\n<p>Try to change calls of clock() for calls of following function:</p>\n\n<pre><code>clock_t clock_wrapper()\n{\n   return clock()/CLOCKS_PER_SEC;\n}\n\nif(table_to_test == 2)\n   {\n       finish = clock_wrapper() + time_to_complete;\n       ++tries;\n       printf(\"2 x 8 = \");\n       scanf(\"%d\", &amp;answer);\n       if(answer == 16 &amp;&amp; (clock_wrapper() &lt; finish))\n       {\n           printf(\"Correct!\\n\");\n           ++amount_correct;\n       }\n       else if(answer != 16 &amp;&amp; (clock_wrapper() &lt; finish))\n       {\n           printf(\"\\aWrong!\\n\");\n       }\n       else if(clock_wrapper() &gt; finish)\n       {\n           printf(\"\\aTime's up!\\n\");\n           ++ran_out_of_time;\n       }\n   }\n</code></pre>\n\n<p>CLOCKS_PER_SEC is divider for convert clocks to seconds.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 3794830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BHrdg.jpg?s=128&g=1", "display_name": "ThE411", "link": "https://stackoverflow.com/users/3794830/the411"}, "edited": false, "score": 0, "creation_date": 1464774487, "post_id": 37563457, "comment_id": 62617494, "body": "I&#39;m using Windows, and my compiler is CodeBlocks. I don&#39;t necessarily need to use this code exactly as it is. Is there another way for me to implement some sort of timer like this?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 35, "user_id": 3794830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BHrdg.jpg?s=128&g=1", "display_name": "ThE411", "link": "https://stackoverflow.com/users/3794830/the411"}, "edited": false, "score": 0, "creation_date": 1464774744, "post_id": 37563457, "comment_id": 62617658, "body": "@ThE411 Codeblocks is an IDE, not a compiler. I&#39;m guessing you are using gcc/mingw. You&#39;ll want to look at Windows API <code>PeekConsoleInput</code>, <a href=\"http://stackoverflow.com/questions/9782287/undefined-reference-to-gotoxy-in-c/9783195#9783195\">example here</a>. As for the timer, there are lots of different options, like <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644901%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">this</a>."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1464770108, "creation_date": 1464770108, "answer_id": 37563457, "question_id": 37563092, "link": "https://stackoverflow.com/questions/37563092/continue-to-next-statement-automatically-after-a-set-amount-of-time/37563457#37563457", "title": "Continue to next statement automatically after a set amount of time", "body": "<p>You can't do this with scanf, it's too blunt - it will lock up the program forever if the user doesn't type anything. </p>\n\n<p>You will have to use some OS-specific, non-standard console function which allows you to peek at the console input without waiting for the user. Use this in combination with a timer that flags you when the time is up.</p>\n\n<p>You don't mention which system you are using. There's Linux ncurses or Windows \"console API\" etc, none of them are standard C.</p>\n\n<p>Professional solutions involve using multiple threads for this, but that might be a bit overkill here.</p>\n"}], "owner": {"reputation": 35, "user_id": 3794830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BHrdg.jpg?s=128&g=1", "display_name": "ThE411", "link": "https://stackoverflow.com/users/3794830/the411"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1464786396, "answer_count": 2, "score": 1, "last_activity_date": 1464770108, "creation_date": 1464768985, "last_edit_date": 1464769615, "question_id": 37563092, "link": "https://stackoverflow.com/questions/37563092/continue-to-next-statement-automatically-after-a-set-amount-of-time", "closed_reason": "Duplicate", "title": "Continue to next statement automatically after a set amount of time", "body": "<p>I am writing a simple program to help my niece learn her multiplication tables. To prevent her from taking too long, I want to use a timer which, after a set amount of time passed, will cause the program to skip to the next question automatically without her inputting anything. If the program then does this, it will increment a counter which shows how many times she ran out of time, something like this:</p>\n\n<pre><code>if(table_to_test == 2)\n       {\n           finish = clock() + time_to_complete;\n           ++tries;\n           printf(\"2 x 8 = \");\n           scanf(\"%d\", &amp;answer);\n           if(answer == 16 &amp;&amp; (clock() &lt; finish))\n           {\n               printf(\"Correct!\\n\");\n               ++amount_correct;\n           }\n           else if(answer != 16 &amp;&amp; (clock() &lt; finish))\n           {\n               printf(\"\\aWrong!\\n\");\n           }\n           else if(clock() &gt; finish)\n           {\n               printf(\"\\aTime's up!\\n\");\n               ++ran_out_of_time;\n           }\n       }\n</code></pre>\n\n<p>finish is how long she has before the timer skips to the next question, and time_to_complete is what the user input's for how long the program gives you before automatically skipping to the next question.</p>\n\n<p>Whenever I run this, no matter how quickly I enter the answer, the program outputs the \"Time's up!\" line.</p>\n\n<p>time_to_complete and finish are of type int </p>\n"}, {"tags": ["c", "gcc", "assembly", "arm"], "comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1464768684, "post_id": 37562932, "comment_id": 62613534, "body": "Why did you tag the question &quot;C&quot; without having shown how your function looks in C?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1464769939, "post_id": 37562932, "comment_id": 62614343, "body": "It might be a good idea to replace the call done in inline assembly with a call done in C."}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1464771104, "post_id": 37562932, "comment_id": 62615073, "body": "If you need assembly to get SP, then use it to get SP ; the call is unrelated, so do it in C. That shouldn&#39;t be hard, but you don&#39;t show your code so we can&#39;t know."}, {"owner": {"reputation": 45, "user_id": 6340494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/380d686f89695d7a9d0b373923e4931d?s=128&d=identicon&r=PG&f=1", "display_name": "YouYou", "link": "https://stackoverflow.com/users/6340494/youyou"}, "edited": false, "score": 0, "creation_date": 1464771347, "post_id": 37562932, "comment_id": 62615223, "body": "The equivalent in C would be writing &quot;int func() {}&quot; since I talk about function prelog. But since that gives no information I see no point in that."}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "is_accepted": false, "score": 0, "last_activity_date": 1464771161, "last_edit_date": 1464771161, "creation_date": 1464770785, "answer_id": 37563706, "question_id": 37562932, "link": "https://stackoverflow.com/questions/37562932/controlling-the-functions-prelog-and-epilog-in-arm-gcc/37563706#37563706", "title": "Controlling the function&#39;s prelog and epilog in arm gcc", "body": "<p>There are several solutions to save LR.</p>\n\n<p>1) You can save it manually, since you write inline assembly, you can save LR before calling your function and restore it after the call.</p>\n\n<p>2) You can declare a dummy variable which will be put in LR with the following C code :</p>\n\n<pre><code>register int foo asm (\"lr\");\n</code></pre>\n\n<p>3) Use <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow\">clobbers in your inline assembly</a></p>\n\n<p>Note that the best solution is probably the third.</p>\n"}, {"comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 45, "user_id": 6340494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/380d686f89695d7a9d0b373923e4931d?s=128&d=identicon&r=PG&f=1", "display_name": "YouYou", "link": "https://stackoverflow.com/users/6340494/youyou"}, "edited": false, "score": 0, "creation_date": 1464772123, "post_id": 37563732, "comment_id": 62615763, "body": "@YouYou It&#39;s a pleasure to me."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1464770856, "creation_date": 1464770856, "answer_id": 37563732, "question_id": 37562932, "link": "https://stackoverflow.com/questions/37562932/controlling-the-functions-prelog-and-epilog-in-arm-gcc/37563732#37563732", "title": "Controlling the function&#39;s prelog and epilog in arm gcc", "body": "<p>Mark <code>lr</code> as clobbered to make the compiler save it:</p>\n\n<pre><code>extern void foo(void);\nextern void bar(void)\n{\n    asm ( \"bl foo\" : : : \"lr\" );\n}\n</code></pre>\n\n<p>generates the following code:</p>\n\n<pre><code>bar:\n    str lr, [sp, #-4]!\n    bl foo\n    ldr lr, [sp], #4\n    bx  lr\n</code></pre>\n\n<p>See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#index-g_t_0040code_007basm_007d-clobbers-3634\" rel=\"nofollow\">the documentation</a> for more details. Remember to mark all other registers you use as clobbered, too. Otherwise the compiler might put a variable in one of them. You may also need to mark all caller-saved registers as clobbered.</p>\n"}, {"tags": [], "owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "is_accepted": false, "score": 1, "last_activity_date": 1464786977, "last_edit_date": 1495542708, "creation_date": 1464786648, "answer_id": 37569697, "question_id": 37562932, "link": "https://stackoverflow.com/questions/37562932/controlling-the-functions-prelog-and-epilog-in-arm-gcc/37569697#37569697", "title": "Controlling the function&#39;s prelog and epilog in arm gcc", "body": "<p>The easiest/direct answer is to add <code>lr</code> to the clobber, but you may need to add more!</p>\n\n<hr>\n\n<p><strong>WHY??</strong></p>\n\n<p>Compilers generate different prologue/epilogue depending on the type of function.  They can be a generic function, a leaf function (calls no others) or a <em>tail call</em>.  You haven't shown any code so it is difficult to know your particular circumstance.  However, if you don't document that your inline assembler is calling another function, then gcc thinks it is a <em>leaf</em> function when it is not.</p>\n\n<p>From the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow noreferrer\">gcc assembler documentation</a>,</p>\n\n<blockquote>\n  <p>Accessing data from C programs without using input/output operands (such as by using global symbols directly from the assembler template) may not work as expected. Similarly, calling functions directly from an assembler template requires a detailed understanding of the target assembler and ABI. </p>\n</blockquote>\n\n<p>For this reason, I think that it is safest to add <code>r0</code>-<code>r3</code> and <code>lr</code> to the clobbers as well.  Neon/Floating point register may be required as well.  The compiler should be made aware that these can change over the 'inline <code>asm</code>' statement.</p>\n\n<p>You can use a tail call if there is no code after the assembler statement and you assume there is not a 'frame pointer' or other registers used.  Ie, replace <code>bl inline_asm_target</code> with just <code>b inline_asm_target</code>, where the inline_asm_target function still does a <code>bx lr</code> (or whatever is appropriate for the compiler options/ABI in use).</p>\n\n<p>Related: <br/>\n - <a href=\"https://stackoverflow.com/questions/15752188/arm-link-register-and-frame-pointer\">ARM link register and frame pointer</a><br/>\n - <a href=\"https://stackoverflow.com/questions/261419/arm-to-c-calling-convention-registers-to-save\">ARM to C calling convention registers to save</a></p>\n"}], "owner": {"reputation": 45, "user_id": 6340494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/380d686f89695d7a9d0b373923e4931d?s=128&d=identicon&r=PG&f=1", "display_name": "YouYou", "link": "https://stackoverflow.com/users/6340494/youyou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 37563732, "answer_count": 3, "score": 2, "last_activity_date": 1464786977, "creation_date": 1464768470, "last_edit_date": 1464769904, "question_id": 37562932, "link": "https://stackoverflow.com/questions/37562932/controlling-the-functions-prelog-and-epilog-in-arm-gcc", "title": "Controlling the function&#39;s prelog and epilog in arm gcc", "body": "<p>I have noticed that sometimes when I compile C code the assembly code is sometimes generated in method 1:</p>\n\n<pre><code>STR R11, [SP, #-4]!\nADD R11, SP, #0\nSUB SP, SP, #4\n</code></pre>\n\n<p>and sometimes in method 2:</p>\n\n<pre><code>STMFD SP!, {R11, LR}\nADD R11, SP, #4\nSUB SP, SP, #4\n</code></pre>\n\n<p>the difference between the first and the second methods is that the second method saves LR into the stack.</p>\n\n<p>Right now I am facing a problem where my function, that starts like the first method, calls another function using the link register (BL), and since my function does not save the LR in the first place it causes a serious problem.\nIf I could tell the compiler to use the second method It could solve my problem.</p>\n\n<p>It may be connected to the fact that the function calls the inner function using inline assembly, and thus \"not recognizes\" that there is a call to another function and sees no point in saving the LR. Calling the inline assembly is obligated because the called function gets the value of SP as a parameter.</p>\n\n<p>This is quite a catch-22 situation, hopefully someone could help me solve that.\nThanks!</p>\n"}, {"tags": ["c", "linux", "memory-management", "mmap"], "comments": [{"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1464766700, "post_id": 37562260, "comment_id": 62612372, "body": "Like a debugger would? <a href=\"http://man7.org/linux/man-pages/man2/ptrace.2.html\" rel=\"nofollow noreferrer\"><code>ptrace</code></a> is your starting point."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1464766933, "post_id": 37562260, "comment_id": 62612493, "body": "ok, do <code>int b =a; printf (&quot;a is %d\\n&quot;, b);</code> done..."}, {"owner": {"reputation": 17, "user_id": 6408199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205015332943445/picture?type=large", "display_name": "Florina Barbu", "link": "https://stackoverflow.com/users/6408199/florina-barbu"}, "reply_to_user": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1464767279, "post_id": 37562260, "comment_id": 62612677, "body": "@BoBTFish More like a hacker :)) I have to &quot;unlock&quot; some passwords; thanks, I&#39;ll check your hint"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1464769376, "post_id": 37562260, "comment_id": 62613970, "body": "@FlorinaBarbu please don&#39;t ask SO contributors for help with immoral/illegal activities."}, {"owner": {"reputation": 17, "user_id": 6408199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205015332943445/picture?type=large", "display_name": "Florina Barbu", "link": "https://stackoverflow.com/users/6408199/florina-barbu"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1464771672, "post_id": 37562260, "comment_id": 62615462, "body": "@MartinJames it&#39;s a game we play at University, it&#39;s all legal"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1464777775, "post_id": 37562260, "comment_id": 62619816, "body": "@FlorinaBarbu sure, and I always believe everything I read on the internet, after all, criminals never lie..."}, {"owner": {"reputation": 17, "user_id": 6408199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205015332943445/picture?type=large", "display_name": "Florina Barbu", "link": "https://stackoverflow.com/users/6408199/florina-barbu"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1464957721, "post_id": 37562260, "comment_id": 62711931, "body": "@MartinJames <a href=\"https://security.cs.pub.ro/summer-school/wiki/\" rel=\"nofollow noreferrer\">security.cs.pub.ro/summer-school/wiki</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16607, "user_id": 267482, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fd69625825bed998b63fef68a23592aa?s=128&d=identicon&r=PG", "display_name": "bobah", "link": "https://stackoverflow.com/users/267482/bobah"}, "is_accepted": false, "score": 3, "last_activity_date": 1464767166, "last_edit_date": 1492086988, "creation_date": 1464767166, "answer_id": 37562465, "question_id": 37562260, "link": "https://stackoverflow.com/questions/37562260/how-could-i-access-the-memory-of-a-running-program/37562465#37562465", "title": "How could I access the memory of a running program?", "body": "<p>Memory is accessible via <code>/proc/pid/mem</code>, index is <code>/proc/pid/maps</code>, Python prototype is <a href=\"https://unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux\">how-do-i-read-from-proc-pid-mem-under-linux</a>.</p>\n"}], "owner": {"reputation": 17, "user_id": 6408199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205015332943445/picture?type=large", "display_name": "Florina Barbu", "link": "https://stackoverflow.com/users/6408199/florina-barbu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "closed_date": 1465974990, "answer_count": 1, "score": 0, "last_activity_date": 1464767166, "creation_date": 1464766540, "last_edit_date": 1464766583, "question_id": 37562260, "link": "https://stackoverflow.com/questions/37562260/how-could-i-access-the-memory-of-a-running-program", "closed_reason": "Needs details or clarity", "title": "How could I access the memory of a running program?", "body": "<p>Presuming I have a program in C:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;time.h&gt;\n\nint main()\n{\n    int a = rand() % 1000;\n    return 0;\n}\n</code></pre>\n\n<p>How can I find the value of \"a\" without printing it on the console, but by accessing, with a linux terminal command, its address to read the value from it?</p>\n\n<p>Or generally, how can I map all the written values of a binary without seeing its implementation (like a \"blackbox\")? </p>\n"}, {"tags": ["c", "performance", "avr-gcc"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 2, "creation_date": 1464766013, "post_id": 37562025, "comment_id": 62611974, "body": "Have you disassembled the binaries yet?"}], "answers": [{"comments": [{"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1464771387, "post_id": 37563803, "comment_id": 62615250, "body": "And the compiler should give you a warning, exactly because i &gt;= 0 is always true, so this is likely not what you wanted."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4346741"}, "edited": false, "score": 0, "creation_date": 1464772912, "post_id": 37563803, "comment_id": 62616345, "body": "Oh God! This is blindingly obvious in hindsight. Unsigned integer, of course. I am stupid! Thank you!"}], "tags": [], "owner": {"reputation": 1369, "user_id": 5771399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c801f6ed43d6b594cfe250a6bf05333?s=128&d=identicon&r=PG&f=1", "display_name": "v7d8dpo4", "link": "https://stackoverflow.com/users/5771399/v7d8dpo4"}, "is_accepted": true, "score": 3, "last_activity_date": 1464771038, "creation_date": 1464771038, "answer_id": 37563803, "question_id": 37562025, "link": "https://stackoverflow.com/questions/37562025/avr-gcc-loop-with-faster-than-check/37563803#37563803", "title": "avr-gcc: loop with &gt;= faster than &gt; check", "body": "<pre><code>UInt8 ret, i;\n</code></pre>\n\n<p>means <code>i &gt;= 0</code> is always true. But <code>i &gt; 0</code> has to be evaluated.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4346741"}, "edited": false, "score": 0, "creation_date": 1464773005, "post_id": 37564039, "comment_id": 62616422, "body": "It is code from a virtual machine on embedded nodes. Accordingly, that loop will be executed constantly and I believe optimizations could help.  That said, readability is, naturally, most important. But --i and i-- are as readable normally."}], "tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 0, "last_activity_date": 1464771691, "creation_date": 1464771691, "answer_id": 37564039, "question_id": 37562025, "link": "https://stackoverflow.com/questions/37562025/avr-gcc-loop-with-faster-than-check/37564039#37564039", "title": "avr-gcc: loop with &gt;= faster than &gt; check", "body": "<p>Forget everything that you read about loops, post increment, counting down to zero, and so on. This isn't even micro-optimisation, it is nano-optimisation. The only way it has <em>any</em> effect on the speed of your code is if you make a code that actually <em>changes</em> what the loop does. That is if by playing around with your loop you introduced bugs. </p>\n\n<p>Especially in a case like this one, where you are playing around with threads - all quite expensive operations. What makes you think that it matters even one bit how you change your variables? Changing i is a matter of a nanosecond or less. How on earth will this have any effect on code that runs for 43 seconds unless you do it tens of billions of times? </p>\n\n<p>For your loops, use code that is <em>correct</em>, and that is readable. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4346741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 37563803, "answer_count": 2, "score": 1, "last_activity_date": 1502371052, "creation_date": 1464765823, "last_edit_date": 1502371052, "question_id": 37562025, "link": "https://stackoverflow.com/questions/37562025/avr-gcc-loop-with-faster-than-check", "title": "avr-gcc: loop with &gt;= faster than &gt; check", "body": "<p>There is something I don't understand with my code.\nI'm working with avr-gcc and optimizing my code for speed. I've read about loops, counting down and post/pre (de)crements, comparison with 0 and discovered something odd.</p>\n\n<p>This code runs in 47s:</p>\n\n<pre><code>UInt8 ret, i;\ni = UJ_THREAD_QUANTUM;\ndo {\n    ret = ujThreadPrvInstr(h, t);\n    if (ret == UJ_ERR_RETRY_LATER) {\n        // do not bother with the rest of time quantum if we're already stuck\n        ret = UJ_ERR_NONE;      \n        break;\n    }\n    died = (t-&gt;pc == UJ_PC_DONE);\n    if (died) {\n        break;\n    }\n    if (ret != UJ_ERR_NONE) {\n        break;\n    }\n} while(--i);\n</code></pre>\n\n<p>This code in 43s:</p>\n\n<pre><code>for (i = UJ_THREAD_QUANTUM; i &gt;= 0; --i) {\n    ret = ujThreadPrvInstr(h, t);\n    if (ret == UJ_ERR_RETRY_LATER) {\n        // do not bother with the rest of time quantum if we're already stuck\n        ret = UJ_ERR_NONE;\n        break;\n    }\n    died = (t-&gt;pc == UJ_PC_DONE);\n    if (died) {\n        break;\n    }\n    if (ret != UJ_ERR_NONE) {\n        break;\n    }\n}\n</code></pre>\n\n<p>This code in 47s again:</p>\n\n<pre><code>for (i = UJ_THREAD_QUANTUM+1; i &gt; 0; --i) {\n    ret = ujThreadPrvInstr(h, t);\n    if (ret == UJ_ERR_RETRY_LATER) {\n        // do not bother with the rest of time quantum if we're already stuck\n        ret = UJ_ERR_NONE;      \n        break;\n    }\n    died = (t-&gt;pc == UJ_PC_DONE);\n    if (died) {\n        break;\n    }\n    if (ret != UJ_ERR_NONE) {\n        break;\n    }\n}\n</code></pre>\n\n<p>Thinking that I perhaps misunderstood some internal workings, I varied the value of <code>UJ_THREAD_QUANTUM</code> (which is 10 by default) and post/predecrement counters but eventually discovered that it appears that whether I use <code>&gt;= 0</code> or <code>&gt; 0</code> is the deciding factor.</p>\n\n<p>Can anybody explain why this is?</p>\n"}, {"tags": ["c", "yuv"], "comments": [{"owner": {"reputation": 3067, "user_id": 3876138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef65cd9182b4e7e297c6eef30b1dae1b?s=128&d=identicon&r=PG", "display_name": "nayana", "link": "https://stackoverflow.com/users/3876138/nayana"}, "edited": false, "score": 0, "creation_date": 1464774363, "post_id": 37561461, "comment_id": 62617377, "body": "hm.. maybe you can check videoconvert source code from gstreamer.."}], "owner": {"reputation": 21, "user_id": 6407990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0330dd21012cf2e1470628ccfbeb18?s=128&d=identicon&r=PG&f=1", "display_name": "rak", "link": "https://stackoverflow.com/users/6407990/rak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1561, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1464769979, "creation_date": 1464764105, "last_edit_date": 1464769979, "question_id": 37561461, "link": "https://stackoverflow.com/questions/37561461/how-to-convert-yuyv-to-rgb-code-to-yuv420-to-rgb", "title": "how to convert yuyv to rgb code to yuv420 to rgb", "body": "<p>I have been trying to find code for yuv420 to rgb but nothing is working for me. I have already a code for yuyv to rgb which is working. So i want to make changes in this code so that it can work as yuv to rgb.</p>\n\n<p>Here is yuyv to rgb code:</p>\n\n<pre><code>static void YUV2RGB(const unsigned char y, const unsigned char u,const unsigned char v, unsigned char* r,\n                unsigned char* g, unsigned char* b)\n{\n   const int y2 = (int)y;\n   const int u2 = (int)u - 128;\n   const int v2 = (int)v - 128;\n   //std::cerr &lt;&lt; \"YUV=(\"&lt;&lt;y2&lt;&lt;\",\"&lt;&lt;u2&lt;&lt;\",\"&lt;&lt;v2&lt;&lt;\")\"&lt;&lt;std::endl;\n\n   // This is the normal YUV conversion, but\n   // appears to be incorrect for the firewire cameras\n   //   int r2 = y2 + ( (v2*91947) &gt;&gt; 16);\n   //   int g2 = y2 - ( ((u2*22544) + (v2*46793)) &gt;&gt; 16 );\n   //   int b2 = y2 + ( (u2*115999) &gt;&gt; 16);\n   // This is an adjusted version (UV spread out a bit)\n\n   int r2 = y2 + ((v2 * 37221) &gt;&gt; 15);\n   int g2 = y2 - (((u2 * 12975) + (v2 * 18949)) &gt;&gt; 15);\n   int b2 = y2 + ((u2 * 66883) &gt;&gt; 15);\n   //std::cerr &lt;&lt; \"   RGB=(\"&lt;&lt;r2&lt;&lt;\",\"&lt;&lt;g2&lt;&lt;\",\"&lt;&lt;b2&lt;&lt;\")\"&lt;&lt;std::endl;\n\n   // Cap the values.\n   *r = CLIPVALUE(r2);\n   *g = CLIPVALUE(g2);\n   *b = CLIPVALUE(b2);\n}\n\n\nstatic void yuyv2rgb(char *YUV, char *RGB, int NumPixels)\n{\n   int i, j;\n   unsigned char y0, y1, u, v;\n   unsigned char r, g, b;\n\n   for (i = 0, j = 0; i &lt; (NumPixels &lt;&lt; 1); i += 4, j += 6)\n   {\n      y0 = (unsigned char)YUV[i + 0];\n      u = (unsigned char)YUV[i + 1];\n      y1 = (unsigned char)YUV[i + 2];\n      v = (unsigned char)YUV[i + 3];\n      YUV2RGB(y0, u, v, &amp;r, &amp;g, &amp;b);\n      RGB[j + 0] = r;\n      RGB[j + 1] = g;\n      RGB[j + 2] = b;\n      YUV2RGB(y1, u, v, &amp;r, &amp;g, &amp;b);\n      RGB[j + 3] = r;\n      RGB[j + 4] = g;\n      RGB[j + 5] = b;\n   }\n}\n</code></pre>\n\n<p>I want to convert this code to yuv420 to rgb thats why i want to know the changes i should make to make it work.\nthank you</p>\n"}, {"tags": ["c", "memory-leaks", "gtk3"], "comments": [{"owner": {"reputation": 2323, "user_id": 4642859, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cbbd31a436ff596d2ea6eebbb5ca477c?s=128&d=identicon&r=PG&f=1", "display_name": "3kt", "link": "https://stackoverflow.com/users/4642859/3kt"}, "edited": false, "score": 1, "creation_date": 1464764016, "post_id": 37561399, "comment_id": 62610855, "body": "You can use <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a> to detect any memory leak."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 4, "creation_date": 1464764237, "post_id": 37561399, "comment_id": 62610977, "body": "String literals are not stored in dynamic/heap memory. So it can&#39;t be freed (except when the whole application exits) and hence there is no memory leak."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464764970, "post_id": 37561399, "comment_id": 62611367, "body": "You have a memory leak if you code: <code>foo = g_strconcat (line, &quot;there&quot;, NULL)</code> <code>foo = g_strconcat (line, &quot;is&quot;, NULL)</code> You are creating/allocating <code>&quot;is&quot;</code> without call <code>g_free</code> to free the previous allocated <code>&quot;there&quot; </code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1464765444, "post_id": 37561399, "comment_id": 62611599, "body": "Leaks etc. are avoided by not writing bad code."}, {"owner": {"reputation": 1, "user_id": 5704807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/618dc1c6965a4ac5d5668b2fea63c8b1?s=128&d=identicon&r=PG&f=1", "display_name": "rsa", "link": "https://stackoverflow.com/users/5704807/rsa"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464765682, "post_id": 37561399, "comment_id": 62611761, "body": "@LPs How would u avoid a leak in the example that you&#39;ve given?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1464765862, "post_id": 37561399, "comment_id": 62611890, "body": "In the same way @MartinJames wrote ;) There are no standard mechanisms to avoid those kind of problems. Only write a good code. So each time you use a <code>malloc</code> like function you have to think twice to the pointer you are using and if needs a <code>free</code> before to be overwriteen."}], "answers": [{"tags": [], "owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "is_accepted": false, "score": 0, "last_activity_date": 1467089626, "creation_date": 1467089626, "answer_id": 38067308, "question_id": 37561399, "link": "https://stackoverflow.com/questions/37561399/how-to-avoid-memory-leak-in-this-example-and-in-general/38067308#38067308", "title": "How to avoid memory leak? (In this example and in general)", "body": "<p>Strictly speaking, your string literal should be a <code>const char *</code> since it's undefined behaviour to modify a pointer to a string literal. Making it constant isn't required in C, but this would be more correct:</p>\n\n<pre><code>g_autofree char *foo = NULL;\nconst char *bar = \"Hello\";\nfoo = g_strconcat(bar, \"there\", NULL);\n</code></pre>\n\n<p>If you internalize the rule to always give pointers to string literals a <code>const char *</code> type, and never free <code>const char *</code> variables, then the above code will eventually instinctively look less wrong.</p>\n\n<p>As for the general case, there is no better answer than \"don't overwrite a heap-allocated pointer unless you've freed it.\" Again, given enough experience writing C, doing so will instinctively look wrong.</p>\n"}], "owner": {"reputation": 1, "user_id": 5704807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/618dc1c6965a4ac5d5668b2fea63c8b1?s=128&d=identicon&r=PG&f=1", "display_name": "rsa", "link": "https://stackoverflow.com/users/5704807/rsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467089626, "creation_date": 1464763885, "question_id": 37561399, "link": "https://stackoverflow.com/questions/37561399/how-to-avoid-memory-leak-in-this-example-and-in-general", "title": "How to avoid memory leak? (In this example and in general)", "body": "<p>Following is the code snippet: </p>\n\n<pre><code>g_autofree gchar *foo = NULL;\nfoo = \"Hello\";\nfoo = g_strconcat (line, \"there\", NULL);\n</code></pre>\n\n<p>Is there a memory leak of the previous ref of foo? Why?\nHow to avoid such memory leaks?</p>\n\n<p>Any other tips also welcome!</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 2461, "user_id": 2106328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rfFc5.jpg?s=128&g=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/2106328/nishant"}, "edited": false, "score": 0, "creation_date": 1464762276, "post_id": 37560841, "comment_id": 62609975, "body": "What is <code>PRId8</code>. Should the call to <code>snprintf</code> not be <code>bytes_written = snprintf(buf, 8, &quot;%PRId8&quot;, 2);</code> ?"}, {"owner": {"reputation": 1462, "user_id": 5469991, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-EhCmF1jHGMk/AAAAAAAAAAI/AAAAAAAACgs/arVjyog6MGo/photo.jpg?sz=128", "display_name": "piyushj", "link": "https://stackoverflow.com/users/5469991/piyushj"}, "edited": false, "score": 0, "creation_date": 1464762283, "post_id": 37560841, "comment_id": 62609977, "body": "have a look at this <a href=\"http://stackoverflow.com/questions/17744226/int8-t-vs-char-which-is-the-best-one\" title=\"int8 t vs char which is the best one\">stackoverflow.com/questions/17744226/&hellip;</a>"}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "reply_to_user": {"reputation": 2461, "user_id": 2106328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rfFc5.jpg?s=128&g=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/2106328/nishant"}, "edited": false, "score": 3, "creation_date": 1464762573, "post_id": 37560841, "comment_id": 62610122, "body": "@Nishant No, <code>PRId8</code> is a CPP macro."}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464762643, "post_id": 37560841, "comment_id": 62610155, "body": "@Lundin I use CPP to mean C Preprocessor."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 1, "creation_date": 1464762705, "post_id": 37560841, "comment_id": 62610179, "body": "@a3f Aah :)  No, CPP is an abbreviation for C++."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 2461, "user_id": 2106328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rfFc5.jpg?s=128&g=1", "display_name": "Nishant", "link": "https://stackoverflow.com/users/2106328/nishant"}, "edited": false, "score": 1, "creation_date": 1464762862, "post_id": 37560841, "comment_id": 62610266, "body": "@Nishant No that part it is correct. Take a look at <a href=\"http://stackoverflow.com/a/6299346/3436922\">this SO post</a>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464763360, "post_id": 37560841, "comment_id": 62610540, "body": "@Lundin &quot;cpp&quot; <i>is</i> the name of the C pre-processor, at least as it comes with GCC."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1464763510, "post_id": 37560841, "comment_id": 62610605, "body": "@alk So the G++ pre-processor is called CPPPP?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464763579, "post_id": 37560841, "comment_id": 62610628, "body": "I&#39;d say G++ and GCC use the same CPP. ;-) @Lundin"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1464763690, "post_id": 37560841, "comment_id": 62610684, "body": "Nice one, Lundin. By way of interest there are only three occurrences of &quot;cpp&quot; is the ISO C11 standard and none of them refer to the preprocessor. In a <i>stunningly apt</i> use of the English language, ISO insists on calling this the ... wait for it ... preprocessor :-)"}], "answers": [{"comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1464762846, "post_id": 37560993, "comment_id": 62610261, "body": "<code>char</code> is a distinct type from <code>signed char</code> and <code>unsigned char</code> regardless."}, {"owner": {"reputation": 2036, "user_id": 3291873, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/vpjpp.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/3291873/patrick"}, "edited": false, "score": 0, "creation_date": 1464763787, "post_id": 37560993, "comment_id": 62610748, "body": "@paxdiablo It gave same warning with <i>buf</i> as uint8_t also. I am compiling code with gcc and that consider char as signed char by default"}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 4, "last_activity_date": 1464763885, "last_edit_date": 1464763885, "creation_date": 1464762514, "answer_id": 37560993, "question_id": 37560841, "link": "https://stackoverflow.com/questions/37560841/note-expected-char-restrict-but-argument-is-of-type-int8-t/37560993#37560993", "title": "note: expected \u2018char * __restrict__\u2019 but argument is of type \u2018int8_t *\u2019", "body": "<p>The <code>sprintf</code> family of calls require a <code>char *</code> buffer in which to write their data.</p>\n\n<p>You currently have it as <code>int8_t *</code> (a <em>signed</em> 8-bit value) and the fact that it's complaining about the signedness of the type almost certainly means the naked <code>char</code> is unsigned on your system (the standard leaves it open as to whether or not <code>char</code> is a signed or unsigned type) or that <code>gcc</code> is clever enough to realise this may be a portability issue on other compilers.</p>\n\n<p>Be aware that's a <em>warning</em> so it will probably still work. However, I like to clean up code like that so as to make my life easier down the track.</p>\n\n<p>The fix is, of course, to use the correct type (either by changing the type to <code>char buf[8]</code> or by explicitly casting it in the <code>snprintf</code> call, thereby telling the compiler you know what you're doing).</p>\n"}], "owner": {"reputation": 2036, "user_id": 3291873, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/vpjpp.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/3291873/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5904, "favorite_count": 0, "accepted_answer_id": 37560993, "answer_count": 1, "score": 2, "last_activity_date": 1464764044, "creation_date": 1464761964, "last_edit_date": 1464764044, "question_id": 37560841, "link": "https://stackoverflow.com/questions/37560841/note-expected-char-restrict-but-argument-is-of-type-int8-t", "title": "note: expected \u2018char * __restrict__\u2019 but argument is of type \u2018int8_t *\u2019", "body": "<p>code:</p>\n\n<pre><code>int8_t ret;\nint8_t buf[8];\nbytes_written = snprintf(buf, 8, \"%\" PRId8, 2);\n</code></pre>\n\n<p>warning:</p>\n\n<pre><code>warning: pointer targets in passing argument 1 of \u2018snprintf\u2019 differ in signedness [-Wpointer-sign]\n     bytes_written = snprintf(buf, 8, \"%\" PRId8, 2);\n     ^\n/usr/include/stdio.h:386:12: note: expected \u2018char * __restrict__\u2019 but argument is of type \u2018int8_t *\u2019\n extern int snprintf (char *__restrict __s, size_t __maxlen,\n</code></pre>\n\n<p>I know this can be fixed by taking buf as *char, but</p>\n\n<blockquote>\n  <p>int8_t is typedef as unsigned char</p>\n</blockquote>\n\n<p>checked with pre-processor output i.e. <code>gcc main.c | grep int8_t</code></p>\n\n<p>So why compiler is not able to understand that?</p>\n\n<p>With buf as uint8_t also I get the same warning.</p>\n\n<p>Edit:</p>\n\n<blockquote>\n  <p>int8_t is typedef as signed char (By mistake I have written as unsigned in original post) </p>\n</blockquote>\n"}, {"tags": ["c", "linux-kernel", "c-preprocessor", "code-completion", "clion"], "comments": [{"owner": {"reputation": 386, "user_id": 1936927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e5a471d58908ac83b5f6f7806dc3c1c?s=128&d=identicon&r=PG", "display_name": "Elias Kouskoumvekakis", "link": "https://stackoverflow.com/users/1936927/elias-kouskoumvekakis"}, "edited": false, "score": 0, "creation_date": 1498225030, "post_id": 37560017, "comment_id": 76427822, "body": "I&#39;m having the exact same issue but like you I haven&#39;t found a full solution yet. Your workaround seems to be the best way to somewhat mitigate this until we have a proper solution by JB, thank you."}, {"owner": {"reputation": 9929, "user_id": 2125392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4fd030c5c39984fab1a4fb57d72a144?s=128&d=identicon&r=PG", "display_name": "CivFan", "link": "https://stackoverflow.com/users/2125392/civfan"}, "edited": false, "score": 0, "creation_date": 1539379698, "post_id": 37560017, "comment_id": 92495866, "body": "CPP-6875 is closed and marked Fixed. Did that fix it for you? I&#39;m having a similar issue with CLION 2018.2 but using the new compiler database function instead of CMake."}], "owner": {"reputation": 3634, "user_id": 783000, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4f8aa4cb9e75d158cb423b4134c46087?s=128&d=identicon&r=PG", "display_name": "Alexander Thei&#223;en", "link": "https://stackoverflow.com/users/783000/alexander-thei%c3%9fen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 509, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1464804393, "creation_date": 1464758418, "last_edit_date": 1464804393, "question_id": 37560017, "link": "https://stackoverflow.com/questions/37560017/clion-fails-to-index-c-preprocessor-macros-when-std-gnuxx-is-set-linux-kernel", "title": "CLion fails to index C preprocessor macros when -std=gnuXX is set (Linux Kernel Headers)", "body": "<p>I am trying to write a Linux kernel module with CLion. This is the cmake file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.5)\nproject(labs)\n\nset(KERNEL_HEADERS\n        /home/alex/Developer/linux/include\n        /home/alex/Developer/linux/arch/x86/include\n        /home/alex/Developer/linux/arch/x86/include/generated\n        /home/alex/Developer/linux/include/uapi\n        /home/alex/Developer/linux/include/generated/uapi\n        /home/alex/Developer/linux/arch/x86/include/uapi\n        /home/alex/Developer/linux/arch/x86/include/generated/uapi\n)\n\nset(MY_MODULE_SOURCES\n    chapter_03/lab_01/hello.c\n)\n\nadd_definitions(-imacros /home/alex/Developer/linux/include/linux/kconfig.h)\nadd_definitions(-D__KERNEL__)\nadd_definitions(-DMODULE)\nadd_definitions(-std=gnu89)\ninclude_directories(${KERNEL_HEADERS})\n\n\nadd_custom_target(labs COMMAND $(MAKE) -C ${labs_SOURCE_DIR}\n                         PWD=${labs_SOURCE_DIR})\n\nadd_library(dummylib ${MY_MODULE_SOURCES})\n</code></pre>\n\n<p>The actual building of the kernel module is done with the externally called makefile using \"add_custom_target\". The \"dummylib\" is only there so that CLion actually starts to parse the header files and gives me auto completion. With my supplied definitions it does even compile the \"dummylib\" successfully (look at the screenshot). It is no kernel module though, but that does not matter ;)</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ne2by.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ne2by.png\" alt=\"CLion failing to index macros\"></a></p>\n\n<p>My problem is the error you see in the screenshot. Somehow it says that it can't resolve all the macros defined in the kernel headers. Functions, structs and plain defines ( \"MODULE_SIG_STRING \") do work (as you see). I do not understand why the editor says it cannot resolve the macro but can still build it. What is more strange is that I can even jump to the declaration using STRG+B of the marked macros. Clearly something is going wrong. The macros are really defined within <a href=\"http://lxr.free-electrons.com/source/include/linux/module.h\" rel=\"nofollow noreferrer\">linux/module.h</a>. </p>\n\n<h2>Update</h2>\n\n<p>When I set -std=c89 instead of -std=gnu89 the editor recognizes the macros but the \"dummylib\" of course fails to build since the kernel needs the gnu extensions. I guess this is a bug in CLion. I posted it at the Jetbrains Bugtracker: <a href=\"https://youtrack.jetbrains.com/issue/CPP-6875\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/CPP-6875</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1464756547, "post_id": 37559630, "comment_id": 62607592, "body": "In C you don&#39;t really distinguish between <code>z</code> and the ascii value of <code>z</code>. They are both valid literals for exactly the same object in memory."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1464756551, "post_id": 37559630, "comment_id": 62607594, "body": "It&#39;s the same thing.  <code>&#39;z&#39;</code> is just syntax for the character value of <code>z</code>.  If you want to know what that value is, simply print it as an integer."}, {"owner": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464756841, "post_id": 37559630, "comment_id": 62607708, "body": "so it stores ascii value in the memory location"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1464757692, "post_id": 37559630, "comment_id": 62608022, "body": "It&#39;s an integer constant.  You can do anything with the value that you can with any other integer constant.  You can print it, you can assign it, you can pass it as a function argument.  Take your pick.  It&#39;s an integer constant."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464756611, "post_id": 37559657, "comment_id": 62607615, "body": "does it change for <b>java</b> are it is same as c"}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "reply_to_user": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 1, "creation_date": 1464756718, "post_id": 37559657, "comment_id": 62607662, "body": "It&#39;s <a href=\"http://stackoverflow.com/questions/13849986/character-literal-in-java\">similar in Java</a>, yes."}, {"owner": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464756734, "post_id": 37559657, "comment_id": 62607664, "body": "so you are saying answer is both ascii and &#39;z&#39; or what"}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "reply_to_user": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464756764, "post_id": 37559657, "comment_id": 62607674, "body": "I&#39;m saying there&#39;s no difference. It is both. <code>&#39;z&#39;</code> and <code>122</code> are identical as far as the compiler is concerned."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464756956, "post_id": 37559657, "comment_id": 62607750, "body": "@rajatsharma In Java <code>char</code> is 16-bit rather than 8-bit, so that alone shows that they are not quite the same, though Java accepts things like <code>&#39;a&#39;</code> + 1 and seems to treat <code>char</code> as basically a number type. I&#39;m sure that there must be some differences between Java chars and C chars beyond their size, though I don&#39;t know enough Java to say just what those differences are."}, {"owner": {"reputation": 205376, "user_id": 13, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1XtZi.jpg?s=128&g=1", "display_name": "Chris Jester-Young", "link": "https://stackoverflow.com/users/13/chris-jester-young"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1464757314, "post_id": 37559657, "comment_id": 62607884, "body": "@JohnColeman In Java, when you say <code>&#39;a&#39; + 1</code>, the <code>&#39;a&#39;</code> (a <code>char</code>) is promoted to an <code>int</code> first, before being added to the 1 (which is also an <code>int</code>). In C, <code>&#39;a&#39;</code> is an <code>int</code>."}], "tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 10, "last_activity_date": 1464756797, "last_edit_date": 1464756797, "creation_date": 1464756527, "answer_id": 37559657, "question_id": 37559630, "link": "https://stackoverflow.com/questions/37559630/what-char-ch-z-would-store-in-ch/37559657#37559657", "title": "what char ch = \u2018Z\u2019 would store in ch?", "body": "<p>In C, <code>'z'</code> is a constant of type <code>int</code> with value <code>122</code> (assuming you're on an ASCII machine, which you probably are). Both of your sources are in agreement - they're the same thing.</p>\n\n<p>As an example, just print it all the different ways you care about. Example program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char ch = 'z';\n    char i  = 122;\n    printf(\"%c %d\\n\", ch, ch);\n    printf(\"%c %d\\n\", i, i);\n    return 0;\n}\n</code></pre>\n\n<p>Run it:</p>\n\n<pre><code>$ make example &amp;&amp; ./example\nz 122\nz 122\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 205376, "user_id": 13, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1XtZi.jpg?s=128&g=1", "display_name": "Chris Jester-Young", "link": "https://stackoverflow.com/users/13/chris-jester-young"}, "edited": false, "score": 1, "creation_date": 1464756907, "post_id": 37559696, "comment_id": 62607731, "body": "The cast to <code>int</code> is superfluous: <code>printf</code> is a variadic function which means that the <code>char</code> is auto-promoted to <code>int</code> when passed in."}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 0, "creation_date": 1464756957, "post_id": 37559696, "comment_id": 62607749, "body": "This answer is correct, but a bit misleading. The <code>(int)</code> cast isn&#39;t necessary because of the default argument promotions, and there&#39;s no actual &#39;conversion&#39; taking place anywhere."}, {"owner": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464757014, "post_id": 37559696, "comment_id": 62607779, "body": "but in memory it change only store either &#39;z&#39; or its ascii value..explicity we change change"}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "reply_to_user": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464757404, "post_id": 37559696, "comment_id": 62607920, "body": "@rajatsharma - I don&#39;t think I understand that comment. You can take <i>any</i> program, and replace all instances of <code>122</code> with <code>&#39;z&#39;</code> and vice versa, and get exactly the same binary out of the compiler."}, {"owner": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "edited": false, "score": 0, "creation_date": 1464758035, "post_id": 37559696, "comment_id": 62608180, "body": "What will it store in the memory location carl Norum"}], "tags": [], "owner": {"reputation": 2323, "user_id": 4642859, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cbbd31a436ff596d2ea6eebbb5ca477c?s=128&d=identicon&r=PG&f=1", "display_name": "3kt", "link": "https://stackoverflow.com/users/4642859/3kt"}, "is_accepted": false, "score": 0, "last_activity_date": 1464756765, "creation_date": 1464756765, "answer_id": 37559696, "question_id": 37559630, "link": "https://stackoverflow.com/questions/37559630/what-char-ch-z-would-store-in-ch/37559696#37559696", "title": "what char ch = \u2018Z\u2019 would store in ch?", "body": "<p>The answer is... both ! Here is a snippet that may help you understand better :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char ch = 'z';\n    printf(\"%c\\n\", ch);\n    printf(\"%d\\n\", (int)ch);\n}\n</code></pre>\n\n<p>When you consider ch as a char, it is indeed 'z', that is stored. But if you cast it to an int, you are going to get the ASCII value for 'z', which is 122.</p>\n\n<p>Hope it'll be helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 1, "creation_date": 1464757016, "post_id": 37559721, "comment_id": 62607780, "body": "To be extremely pedantic, it stores the value of that character in the execution instruction set, which is usually ASCII, but doesn&#39;t <i>have</i> to be. Your program will print some nonsense on an EBCDIC machine, for example."}], "tags": [], "owner": {"reputation": 826, "user_id": 5698202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfozP.jpg?s=128&g=1", "display_name": "Abhirath Mahipal", "link": "https://stackoverflow.com/users/5698202/abhirath-mahipal"}, "is_accepted": false, "score": 0, "last_activity_date": 1464757605, "last_edit_date": 1464757605, "creation_date": 1464756906, "answer_id": 37559721, "question_id": 37559630, "link": "https://stackoverflow.com/questions/37559630/what-char-ch-z-would-store-in-ch/37559721#37559721", "title": "what char ch = \u2018Z\u2019 would store in ch?", "body": "<p>It \"usually\" stores the ASCII value.</p>\n\n<p>It therefore is possible to perform integer operations on an char. The ASCII value is used to map it to the right ASCII character. You can even increment it or reduce it. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n\nchar ch = 90;\nprintf(\"%c\\n\\n\", ch);\nch = 64;\nfor (int i = 0; i &lt; 26; i++)\n{\n    ch++;\n    printf(\"%c\\n\", ch);\n}\n\n}\n</code></pre>\n\n<p>The for loop prints out A - Z. Notice how I've just incremented the value of ch by 1 in every iteration.</p>\n\n<p>If you notice I have assigned ch a number. I could have even assigned it 'z'. </p>\n\n<p>From a complete beginner perspective the thing that you must understand is that everything is stored as '0' or '1' in memory. This unreadable sequence of 0's and 1's in converted into the text you see on the screen (decoding).</p>\n"}, {"comments": [{"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 1, "creation_date": 1464759132, "post_id": 37559857, "comment_id": 62608614, "body": "2 and 3 are <i>not</i> guaranteed. Just look at the EBCDIC chart you linked to."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 1, "creation_date": 1464759268, "post_id": 37559857, "comment_id": 62608677, "body": "@CarlNorum, indeed. Thanks for letting me know."}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 1, "creation_date": 1464759320, "post_id": 37559857, "comment_id": 62608696, "body": "Is your new #2 guaranteed? I thought the only guarantee was that the digits were consecutive."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 0, "creation_date": 1464759858, "post_id": 37559857, "comment_id": 62608937, "body": "They are true for ASCII and EBCDIC encoding. I don&#39;t know whether there are other encodings for which that is not true."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 0, "creation_date": 1464761446, "post_id": 37559857, "comment_id": 62609585, "body": "@CarlNorum I think  you&#39;re right, I don&#39;t find anything in the standard except the mention for consecutive digits."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1464764154, "post_id": 37559857, "comment_id": 62610933, "body": "@Holt, I don&#39;t see anything in the standard that says anything about the character constants for digits being consecutive either. It just happens to be true for both ASCII and EBCDIC encoding. If you know where to find what you are saying, please let me know. It will be instructive for me."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1464764356, "post_id": 37559857, "comment_id": 62611042, "body": "@RSahu In <i>5.2.1/3</i> (<i>Character sets</i>): &quot;In both the source and execution basic character sets, the value of each character after 0 in the above list of decimal digits shall be one greater than the value of the previous.&quot; (Committee Draft <b>n1570</b>)."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1464764365, "last_edit_date": 1464764365, "creation_date": 1464757616, "answer_id": 37559857, "question_id": 37559630, "link": "https://stackoverflow.com/questions/37559630/what-char-ch-z-would-store-in-ch/37559857#37559857", "title": "what char ch = \u2018Z\u2019 would store in ch?", "body": "<p><code>'Z'</code> us a character constant. Its type is <code>int</code>. When you use</p>\n\n<pre><code>char c = 'Z';\n</code></pre>\n\n<p>the integer value stored in <code>c</code> could be different based on the character encoding used by your compiler. If it uses ASCII encoding, then it will store the ASCII representation of <code>'Z'</code> in <code>c</code>, which is <code>90</code> decimal. If it uses EBCDIC encoding, then it will store the EBCDIC representation of <code>'Z'</code> in <code>c</code>, which is <code>233</code> decimal.</p>\n\n<p>In order to write portable programs, you'll have to ignore the integer value stored in <code>c</code>. Certain things you can count on for both those encodings are:</p>\n\n<ol>\n<li><p><code>'9' - '0'</code> is equal to <code>9</code></p></li>\n<li><p><code>'Z' - 'A'</code> is equal to  <code>'z' - 'a'</code></p></li>\n</ol>\n\n<p>I am not aware of other encodings in use where the above are not true.</p>\n\n<p>References:<br>\n<a href=\"https://en.wikipedia.org/wiki/ASCII#ASCII_printable_code_chart\" rel=\"nofollow\">ASCII encoding chart</a><br>\n<a href=\"https://en.wikipedia.org/wiki/EBCDIC#Codepage_layout\" rel=\"nofollow\">EBCDIC encoding chart</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6407636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IiOBFTn2aGU/AAAAAAAAAAI/AAAAAAAAD1Q/TFux7hvz2nw/photo.jpg?sz=128", "display_name": "rajat sharma", "link": "https://stackoverflow.com/users/6407636/rajat-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5155, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1464764365, "creation_date": 1464756359, "question_id": 37559630, "link": "https://stackoverflow.com/questions/37559630/what-char-ch-z-would-store-in-ch", "title": "what char ch = \u2018Z\u2019 would store in ch?", "body": "<p>As i am confuse what will ch stored in it. is it <strong>ascii value or 'z'</strong> as some sites are saying it stores ascii and some says its stores 'z'.\nlink saying the answer is 'z' : <a href=\"http://cprogrammingworld4u.blogspot.in/2011/07/chapter-1-getting-started.html\" rel=\"nofollow\">http://cprogrammingworld4u.blogspot.in/2011/07/chapter-1-getting-started.html</a></p>\n\n<p>link saying answer is ascii : <a href=\"https://www.careercup.com/question?id=12511679\" rel=\"nofollow\">https://www.careercup.com/question?id=12511679</a></p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1464753476, "post_id": 37559098, "comment_id": 62606721, "body": "Best advice: use a debugger."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1464755472, "post_id": 37559098, "comment_id": 62607261, "body": "The global variable <code>weight</code> refered from <code>is_promising</code> won&#39;t be updated throughout the execution and will remain zero as initialized. Try checking implementations around it. You may want to add some parameters to <code>is_promising</code> to be passed from <code>sum_of_subsets</code>."}, {"owner": {"reputation": 31, "user_id": 383039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9562294184c01bd00c695e0f1594b0?s=128&d=identicon&r=PG", "display_name": "vagrantlike", "link": "https://stackoverflow.com/users/383039/vagrantlike"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464757445, "post_id": 37559098, "comment_id": 62607935, "body": "@kaylum I was using GCC Compiler(Code::Blocks IDE)and its debugger with hours of exhaustive debugging..."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464757700, "post_id": 37559098, "comment_id": 62608025, "body": "Well, then please give us the debugging information. Like the exact stack trace when it crashes. Also, tell us the input that causes the crash."}, {"owner": {"reputation": 31, "user_id": 383039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9562294184c01bd00c695e0f1594b0?s=128&d=identicon&r=PG", "display_name": "vagrantlike", "link": "https://stackoverflow.com/users/383039/vagrantlike"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1464757727, "post_id": 37559098, "comment_id": 62608034, "body": "@MikeCAT You are right,I also found that weight variable stay unchanged,I&#39;ll hava a check over it."}, {"owner": {"reputation": 31, "user_id": 383039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9562294184c01bd00c695e0f1594b0?s=128&d=identicon&r=PG", "display_name": "vagrantlike", "link": "https://stackoverflow.com/users/383039/vagrantlike"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464757843, "post_id": 37559098, "comment_id": 62608084, "body": "@kaylum my input is:&lt;br/&gt;10 100&lt;br/&gt; 10 20 40 30 50 80 60 70 5 15&lt;br/&gt;and the application seems frozen,like running in an infinite loop..."}], "owner": {"reputation": 31, "user_id": 383039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9562294184c01bd00c695e0f1594b0?s=128&d=identicon&r=PG", "display_name": "vagrantlike", "link": "https://stackoverflow.com/users/383039/vagrantlike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464753461, "creation_date": 1464753010, "last_edit_date": 1464753461, "question_id": 37559098, "link": "https://stackoverflow.com/questions/37559098/recursion-sum-of-subsets-keeping-getting-error-message", "title": "recursion sum of subsets keeping getting error message", "body": "<p>I am working on this problem on this online judge site(<a href=\"http://zerojudge.tw/ShowProblem?problemid=a981#\" rel=\"nofollow\">http://zerojudge.tw/ShowProblem?problemid=a981#</a>). Sorry for that it's only in Mandarin :(.Basically it's a sum-of-subsets-problem.\nKeep getting same error message on my submit: </p>\n\n<blockquote>\n  <p>RE (SIGSEGV)<br/>\n  Segmentation fault</p>\n</blockquote>\n\n<p>My C code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\nint w[35]= {0};\nbool is_included[35]= {false};\nbool is_promising(int);\nvoid sum_of_subsets(int,int,int);\nint n = 0,W = 0,weight = 0,total = 0,i = 0,j = 0,k = 0,flag = 0,temp = 0;\n\nint main(int argc,char* argv[]) {\n\n    while(scanf(\"%d %d\",&amp;n,&amp;W)==2) {\n        memset(w,0,sizeof(w));\n        memset(is_included,false,sizeof(is_included));\n\n        total = 0;\n        i = 1;\n        temp = n;\n        while(temp--) {\n            scanf(\"%d\",&amp;w[i++]);\n        }\n\n        //ascending bubble sort\n        for(j = n; j &gt;= 1; --j) {\n            flag=0;\n            for(k = 1; k &lt; j; ++k) {\n                if(w[k]&gt;w[k+1]) {\n                    temp = w[k];\n                    w[k] = w[k+1];\n                    w[k+1] = temp;\n                    flag=1;\n                }\n            }\n\n            if(!flag) {\n                break;\n            }\n        }\n\n\n        for(i=1; i&lt;=n; ++i) {\n            total+=w[i];\n        }\n\n        sum_of_subsets(0,0,total);\n    }\n\n    return 0;\n}\n\nbool is_promising(int index) {\n    return (weight+total&gt;=W)&amp;&amp;(weight==W||weight+w[index+1]&lt;=W);\n}\n\nvoid sum_of_subsets(int index,int weight,int total) {\n    int j=1;\n    if(is_promising(index)) {\n        if(weight==W) {\n            for(j=1; j&lt;=index; ++j) {\n                if(is_included[j]) {\n                    printf(\"w[%d] = %d\\n\",j,w[j]);\n                }\n            }\n\n        } else {\n            //include w[index+1]\n            is_included[index+1]=true;\n            sum_of_subsets(index+1,weight+w[index+1],total-w[index+1]);\n\n            //exclude w[index+1]\n            is_included[index+1]=false;\n            sum_of_subsets(index+1,weight,total-w[index+1]);\n        }\n    }\n}\n</code></pre>\n\n<p>Thanks for any advice.</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "edited": false, "score": 0, "creation_date": 1464753089, "post_id": 37559082, "comment_id": 62606610, "body": "it seems the perfect task for a semaphore: <a href=\"http://greenteapress.com/thinkos/html/thinkos012.html\" rel=\"nofollow noreferrer\">greenteapress.com/thinkos/html/thinkos012.html</a>"}, {"owner": {"reputation": 5930, "user_id": 815787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d63bc7f3fac2cef3d9761e8afbaca6?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/815787/serge"}, "edited": false, "score": 0, "creation_date": 1464753332, "post_id": 37559082, "comment_id": 62606675, "body": "rw locks have performance advantage over semaphores: <a href=\"https://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Readers%E2%80%93writer_lock</a>"}, {"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 2, "creation_date": 1464753379, "post_id": 37559082, "comment_id": 62606686, "body": "I think there are two questions/problems you need to solve: 1) how do you tell when all the threads have used the current value once?  And 2) how does any particular thread tell if it has already used the current value?  For #1, if you know the number of threads, you can have each thread count down when it uses the value.  (Semaphore works for this.)  For #2, a thread can either remember the last value it used, and not run again until the value is different, or you can have a &quot;serial number&quot; for a value, and increment <i>that</i> when the value is changed."}, {"owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "edited": false, "score": 0, "creation_date": 1464753414, "post_id": 37559082, "comment_id": 62606697, "body": "It depends at least on three things. First, you have to know the number of threads beforehand. Second, can the threads wait until they are allowed to change the value? What thread will actually change the variable?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1464756703, "post_id": 37559082, "comment_id": 62607653, "body": "&quot;all of the threads have used its current value&quot;. Looks like an XY problem. What are you trying to achieve with this?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1464762073, "post_id": 37559082, "comment_id": 62609881, "body": "You can code a service/daemon that manages access to the variable. Each task register itself to the service/daemon and so it can know how many tasks it has to waits for and gives access to variable value trough a IPC communication: e.g. a socket. BTW your question is OT because it is opinion based."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 3, "creation_date": 1464762090, "post_id": 37559082, "comment_id": 62609889, "body": "Without a definition of &quot;best&quot;, your question only invites opinions, is thus off-topic. Anyhow, what possible ways has the research you have made turned up?"}], "owner": {"reputation": 79, "user_id": 3007620, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/02ad2fb475283ac1bf4c116d22997eb4?s=128&d=identicon&r=PG&f=1", "display_name": "Paulithan", "link": "https://stackoverflow.com/users/3007620/paulithan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "closed_date": 1464792334, "answer_count": 0, "score": 2, "last_activity_date": 1464759540, "creation_date": 1464752894, "question_id": 37559082, "link": "https://stackoverflow.com/questions/37559082/what-is-the-best-way-to-share-a-variable-across-multiple-threads", "closed_reason": "Opinion-based", "title": "What is the best way to share a variable across multiple threads?", "body": "<p>I have a variable that I would like to be shared across multiple threads, and have it be incremented only once when all of the threads have used its current value. What is the best way to accomplish this in C?</p>\n"}, {"tags": ["c", "arrays", "printf"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1464755852, "post_id": 37558663, "comment_id": 62607373, "body": "@abelenky: the result <code>1</code> is from <code>printf(&quot;%d\\n&quot;, *A)</code>, which is what you&#39;d expect, I believe.  The original code would produce <code>5</code>, though.  The question is misleading."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 1, "creation_date": 1464755907, "post_id": 37558663, "comment_id": 62607397, "body": "@abelenky: Steve0101 is right, printf(&quot;%d\\n&quot;, *A) will always print 1 for the given array."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1464782728, "post_id": 37558663, "comment_id": 62623363, "body": "Yeah, I misread it, and thought he was getting 1 for the output of the bigger expression.  Sorry.  Still, link to IDEOne, as a great way to share <a href=\"http://ideone.com/4fu3Sj\" rel=\"nofollow noreferrer\">MVCE code</a>"}], "answers": [{"comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1464750422, "post_id": 37558702, "comment_id": 62605921, "body": "Arrays are automatically converted into pointers for dereferencing, but <i>arrays are NOT pointers!</i>"}], "tags": [], "owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "is_accepted": false, "score": 0, "last_activity_date": 1464750084, "creation_date": 1464750084, "answer_id": 37558702, "question_id": 37558663, "link": "https://stackoverflow.com/questions/37558663/printf-and-array/37558702#37558702", "title": "Printf and Array", "body": "<p>An array variable in C is only the pointer to the initial memory location for the array. So if you derreference the array, you will always get the value for the first position.</p>\n\n<p>If you sum up 1 to the original array value, like <code>*(A+1)</code> you will get the second position.</p>\n\n<p>You can get any position from the array using the same method:</p>\n\n<p><code>*(A)</code> is the first position</p>\n\n<p><code>*(A+1)</code> is the second position</p>\n\n<p><code>*(A+2)</code> is the third position</p>\n\n<p>and so on...</p>\n\n<p>If you declare the int array as <code>int* A</code> and allocate the memory and attribute the values, it is usually easier to visualize how this works.</p>\n"}, {"comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1464750482, "post_id": 37558725, "comment_id": 62605937, "body": "Though it is automatically converted to a pointer in this expression, <code>A</code> is an <i>array</i>, not a pointer."}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1464752003, "post_id": 37558725, "comment_id": 62606332, "body": "@MikeCAT yeah, as usual it is very tempting to lie and say that arrays are pointers.  They almost are (for the purposes of this situation)."}, {"owner": {"reputation": 42860, "user_id": 54937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d968f2f1240bf3e2c4080e773cc95129?s=128&d=identicon&r=PG", "display_name": "Sedat Kapanoglu", "link": "https://stackoverflow.com/users/54937/sedat-kapanoglu"}, "edited": false, "score": 0, "creation_date": 1464755560, "post_id": 37558725, "comment_id": 62607288, "body": "&quot;value of first element&quot;.. no, second."}, {"owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "reply_to_user": {"reputation": 42860, "user_id": 54937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d968f2f1240bf3e2c4080e773cc95129?s=128&d=identicon&r=PG", "display_name": "Sedat Kapanoglu", "link": "https://stackoverflow.com/users/54937/sedat-kapanoglu"}, "edited": false, "score": 0, "creation_date": 1464755897, "post_id": 37558725, "comment_id": 62607394, "body": "@SedatKapanoglu I chose to call them zeroth, first, second and third."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1464757479, "post_id": 37558725, "comment_id": 62607945, "body": "<code>+</code> and <code>-</code> are left-right associative;  it is <code>(A + A[1]) - *A</code>, not <code>A + (A[1] - *A)</code>.   In this case it happens those are equivalent but in general that may not be so."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1464757769, "post_id": 37558725, "comment_id": 62608055, "body": "Pointers and arrays are different, for all purposes ... this answer is better off without that last paragraph."}, {"owner": {"reputation": 39, "user_id": 6407367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d669b891cd6fbb3ff6349fd9fad1cf5?s=128&d=identicon&r=PG&f=1", "display_name": "cla1n", "link": "https://stackoverflow.com/users/6407367/cla1n"}, "edited": false, "score": 0, "creation_date": 1464761048, "post_id": 37558725, "comment_id": 62609409, "body": "@MK. Thanks for the explanation, I understand it now."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464780928, "post_id": 37558725, "comment_id": 62622094, "body": "&quot;A is treated like a pointer to the first element of array of integers&quot; --&gt; It depends on code.  For addition like <code>A+A[1]</code>, the first <code>A</code>, an array, is converted to the address of the beginning element.  Had code been <code>sizeof A</code>, the conversion to an address would not occur - the result being <code>9*sizeof(int)</code> or maybe 36."}], "tags": [], "owner": {"reputation": 31310, "user_id": 68105, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1bC0L.png?s=128&g=1", "display_name": "MK.", "link": "https://stackoverflow.com/users/68105/mk"}, "is_accepted": false, "score": 7, "last_activity_date": 1464755910, "last_edit_date": 1464755910, "creation_date": 1464750245, "answer_id": 37558725, "question_id": 37558663, "link": "https://stackoverflow.com/questions/37558663/printf-and-array/37558725#37558725", "title": "Printf and Array", "body": "<p>A is <em>treated like</em> a pointer to the first element of array of integers.\nA[1] is the value of the first element of that array, which is 3 (indexes are 0-based)\n*A is the value to which A points, which if the zeroth element of array, so 1.\nSo </p>\n\n<pre><code>A[1] - *A == 3 - 1 == 2\n</code></pre>\n\n<p>Now we have</p>\n\n<pre><code>*(A + 2)\n</code></pre>\n\n<p>That's where pointer arithmetic kicks in.  Since A is a pointer to integer, A+2 points to the second (0-based) item in that array and *(A+2) gets its value.\nSo answer is 5.</p>\n\n<p>Also please note for future reference that pointer to an integer and array of integers are somewhat different things in C, but for the purposes of this discussion they are the same thing.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 4, "last_activity_date": 1464750905, "last_edit_date": 1464750905, "creation_date": 1464750583, "answer_id": 37558773, "question_id": 37558663, "link": "https://stackoverflow.com/questions/37558663/printf-and-array/37558773#37558773", "title": "Printf and Array", "body": "<p>Break it down into its constituent parts:</p>\n\n<p><code>A</code> by itself is the memory address of the array, which is also equivalent to <code>&amp;A[0]</code>, the memory address of the first element of the array.</p>\n\n<p><code>A[1]</code> is the value stored in the second element of the array, which is 3.</p>\n\n<p><code>*A</code> dereferences the memory address of the array, which is equivilent to <code>A[0]</code>, the value stored in the first element of the array, which is 1.</p>\n\n<p>So, do some substitutions:</p>\n\n<pre><code>  *(A+A[1]-*A)\n= *(A+(A[1])-(A[0]))\n= *(A+3-1)\n= *(A+2)\n</code></pre>\n\n<p>The notation <code>*(Array+index)</code> is the same as the notation <code>Array[index]</code>.  Under the hood, they both take the starting address of the array, increment it by the number of bytes of the array element type (in this case, <code>int</code>) multiplied by the index, and then dereference the resulting address. So <code>*(A+2)</code> is the same as <code>A[2]</code>, which is 5.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1464756167, "post_id": 37558835, "comment_id": 62607470, "body": "I know what your are thinking, but I guess what is confusing is the <i>&quot;Move the pointer..&quot;</i> phrase. Due to <i>operator precedence</i> the values inside the <code>(...)</code> are evaluated where <code>A[1]</code> (<code>+3</code>) and <code>-*A</code> (<code>-1</code>) are added to pointer <code>A</code> before being dereferenced. So the pointer doesn&#39;t move, you effectively add <code>2</code> to it before dereference. Or, is there another pointer being moved?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1464757613, "post_id": 37558835, "comment_id": 62607991, "body": "@DavidC.Rankin &quot;the pointer&quot; here is a rvalue,  &quot;move the pointer&quot; means &quot;make the pointer point to a different location&quot;"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1464856330, "post_id": 37558835, "comment_id": 62658609, "body": "Yes, that&#39;s what I understood it to be, but the verbiage still caused a double.. then tripple take, and a bit of head scratching to try a suss out the meaning. As it the earlier comment, it was clear Mike had no problem with understanding, but the wording seemed at odds with the good solution he posted."}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 2, "last_activity_date": 1464754910, "last_edit_date": 1464754910, "creation_date": 1464751194, "answer_id": 37558835, "question_id": 37558663, "link": "https://stackoverflow.com/questions/37558663/printf-and-array/37558835#37558835", "title": "Printf and Array", "body": "<ul>\n<li>Arrays used in expressions are automatically converted into pointers pointing at the first elements of the arrays except for some exceptions such as operands of <code>sizeof</code> or unary <code>&amp;</code> operators.</li>\n<li><code>E1[E2]</code> is defined to be equivalent to <code>*((E1) + (E2))</code></li>\n<li><code>+</code> and <code>-</code> operator used to pointers will move the pointer forward and backward.</li>\n</ul>\n\n<p>In this case, <code>*A</code> is equivalent to <code>*(A + 0)</code>, which is equivalent to <code>A[0]</code> and it will give you the first element of the array.</p>\n\n<p>The expression <code>*(A+A[1]-*A)</code> will</p>\n\n<ol>\n<li>Get the pointer to the first element, which points at <code>1</code>, via <code>A</code></li>\n<li>Move the pointer to <code>A[1]</code> (3) elements ahead via <code>+A[1]</code>, so the pointer now points at <code>7</code></li>\n<li>Move the pointer to <code>*A</code> (1) element before what is pointed via <code>-*A</code>, so the pointer now points at <code>5</code></li>\n<li>Dereference the pointer via the unary <code>*</code> operator, so the expression is evaluated to 5</li>\n</ol>\n"}], "owner": {"reputation": 39, "user_id": 6407367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d669b891cd6fbb3ff6349fd9fad1cf5?s=128&d=identicon&r=PG&f=1", "display_name": "cla1n", "link": "https://stackoverflow.com/users/6407367/cla1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1464755910, "creation_date": 1464749850, "last_edit_date": 1464755406, "question_id": 37558663, "link": "https://stackoverflow.com/questions/37558663/printf-and-array", "title": "Printf and Array", "body": "<p>I was asked this question as a class exercise:</p>\n\n<pre><code>int A[] = {1,3,5,7,9,0,2,4,6};\n\nprintf(\"%d\\n\", *(A+A[1]-*A));\n</code></pre>\n\n<p>I couldn't figure it out on paper, so went ahead to compiling a simple program and tested it and found that <code>printf(\"%d\",*A)</code> always gives me <code>1</code> for the output.</p>\n\n<p>But I still do not understand why this is the case, hence it would be great if someone can explain this.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1464750591, "post_id": 37558524, "comment_id": 62605960, "body": "<code>scanf(&quot;%s&quot;,&amp;opr[4]);</code> out of bound --&gt; <code>scanf(&quot;%s&quot;, opr);</code>, <code>switch(*opr){</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464750715, "post_id": 37558524, "comment_id": 62605991, "body": "at <code>push</code> : <code>x = stack[first];         first++;</code> --&gt; <code>stack[first++] = x;</code>"}, {"owner": {"reputation": 69, "user_id": 6398110, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/171fea2fb485feb28e19b13934390590?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/6398110/harry"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464750826, "post_id": 37558524, "comment_id": 62606023, "body": "I have already tried that BLUEPIXY but it is giving me the same wrong result"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1464750879, "post_id": 37558524, "comment_id": 62606033, "body": "<code>printf(&quot;%d&quot;,stack[50]);</code> out of bound."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464751031, "post_id": 37558524, "comment_id": 62606072, "body": "<code>c=pop(); d=pop();</code> --&gt; <code>d=pop(); c=pop();</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464751344, "post_id": 37558524, "comment_id": 62606150, "body": "I do not think it&#39;s the same. <a href=\"http://ideone.com/BmmoZv\" rel=\"nofollow noreferrer\">DEMO</a>  Is output to expect and  your input?"}, {"owner": {"reputation": 69, "user_id": 6398110, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/171fea2fb485feb28e19b13934390590?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/6398110/harry"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464752028, "post_id": 37558524, "comment_id": 62606337, "body": "I am getting the value of e but I think that it is not being pushed to the stack as stack value is not changing."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1464752354, "post_id": 37558524, "comment_id": 62606425, "body": "try print stack top like this <code>printf(&quot;\\ndebug:%d\\n&quot;, stack[first-1]);</code>//e"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1464755090, "post_id": 37558524, "comment_id": 62607169, "body": "Note that these two lines: <code>void push(int x);   &#47;&#47; Calling the push function</code> and <code>int pop();          &#47;&#47; Calling the pop function</code> are not calling any functions; they are declaring the <code>push()</code> and <code>pop()</code> functions."}], "owner": {"reputation": 69, "user_id": 6398110, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/171fea2fb485feb28e19b13934390590?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/6398110/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464748735, "creation_date": 1464748735, "question_id": 37558524, "link": "https://stackoverflow.com/questions/37558524/rpn-calculator-using-push-and-pop", "title": "RPN calculator using push and pop.", "body": "<p>I want to design a RPN calculator using push and pop. But I am not getting the right result for e after running the program. It seems that c and d are storing 0 after I use pop() to get the value of a and b from the stack. Any suggestions?     </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n int stack[50];\n int first = 0;\n int main(void){\n int a,b,c,d,e;\n char opr[4];\n\n printf(\"Enter 2 numbers \\n\");\n scanf(\"%d\",&amp;a);\n scanf(\"%d\",&amp;b);\n void push(int x);   // Calling the push function\n int pop();          // Calling the pop function\n push(a);\n push(b);\n printf(\"Enter the operator \\n\");\n scanf(\"%s\",&amp;opr[4]);\n\n switch(opr[4]){\n    case '+': c=pop(); d=pop(); e=c+d; break;\n    case '-': c=pop(); d=pop(); e=c-d; break;\n    case '*': c=pop(); d=pop(); e=c*d; break;\n    case '/': c=pop(); d=pop(); e=c/d; break;\n    default:  printf(\"not a valid option\");\n}\npush(e);\nprintf(\"%d\",e);\nprintf(\"%d\",stack[50]);\nreturn 0;\n}\nvoid push(int x){\n    if(first==50){\n        printf(\"The stack is full\");\n    }else{\n        x = stack[first];\n        first++;\n    }\n}\nint pop(){\n    int y;\n    if(first == 0){\n        printf(\"Stack is empty \");\n    }else{\n        first--;\n        y = stack[first];\n        return y;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1464748113, "post_id": 37558443, "comment_id": 62605378, "body": "<code>cents &#47; 100</code> is always 0 as it is integer division. Why do you need to add it anyway?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1464748436, "post_id": 37558443, "comment_id": 62605453, "body": "Reverse order <code>cents = cents % 100;</code> and <code>new_dollars = dollars + cents &#47; 100;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1464748485, "post_id": 37558443, "comment_id": 62605463, "body": "Minor: Likely want <code>&quot;$%i.%02i&quot;</code> vs. <code>&quot;$%i.%2i&quot;</code>  (add <code>0</code>)"}, {"owner": {"reputation": 7, "user_id": 6407291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75b605d55c67f4094f60e137d2d4a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Nikki", "link": "https://stackoverflow.com/users/6407291/nikki"}, "edited": false, "score": 0, "creation_date": 1464749504, "post_id": 37558443, "comment_id": 62605724, "body": "When cents are more than 100,  I use &quot;cents / 100&quot; to extract the integer part, and add it to dollars."}, {"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 0, "creation_date": 1464752563, "post_id": 37558443, "comment_id": 62606472, "body": "@Nikki <code>cents</code> can&#39;t be more than 99 after the <code>%</code> operation applied to itself. You need to swap it with the line below."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6407291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75b605d55c67f4094f60e137d2d4a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Nikki", "link": "https://stackoverflow.com/users/6407291/nikki"}, "edited": false, "score": 0, "creation_date": 1464749117, "post_id": 37558503, "comment_id": 62605616, "body": "Hi Alastair Brown, I tried the code following your instruction.                   Enter dollars: 4 Enter cents: 300 7 $7. 0  The output of new_dollars is equal to dollars. No change. It looks like &quot; cents / 100 = 0&quot;."}, {"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "reply_to_user": {"reputation": 7, "user_id": 6407291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75b605d55c67f4094f60e137d2d4a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Nikki", "link": "https://stackoverflow.com/users/6407291/nikki"}, "edited": false, "score": 0, "creation_date": 1464754129, "post_id": 37558503, "comment_id": 62606911, "body": "@Nikki Did you enter <code>300 7</code> as the value for cents?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1464754972, "post_id": 37558503, "comment_id": 62607141, "body": "Note that you should use <code>%.2i</code> or <code>%02i</code> (or <code>%.2d</code>, etc) for the cents to ensure that 1 dollar 2 cents is printed as <code>1.02</code> instead of <code>1. 2</code>."}], "tags": [], "owner": {"reputation": 1588, "user_id": 6353415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HI3UX.png?s=128&g=1", "display_name": "Alastair Brown", "link": "https://stackoverflow.com/users/6353415/alastair-brown"}, "is_accepted": false, "score": 4, "last_activity_date": 1464748519, "creation_date": 1464748519, "answer_id": 37558503, "question_id": 37558443, "link": "https://stackoverflow.com/questions/37558443/new-dollars-dollars-cents-100-no-change/37558503#37558503", "title": "&quot;new_dollars = dollars + cents / 100&quot; NO CHANGE", "body": "<p>The commenters are right about integer division. Try this, it has the order two lines that do the calculation swapped, so <code>cents</code> will still have a useful value when you need it to:</p>\n\n<pre><code>int main(void)\n{\n    int dollars, cents, count, new_dollars;\n\n    for ( count = 1; count &lt;= 10; ++count){\n        printf (\"Enter dollars: \");\n        scanf (\"%i\", &amp;dollars);\n\n        printf (\"Enter cents: \");\n        scanf (\"%i\", &amp;cents);\n\n        if ( cents &gt;= 100 ){\n            new_dollars = dollars + cents / 100;\n            cents = cents % 100;\n            printf (\"%i\\n\", new_dollars);\n            printf (\"$%i.%2i\\n\\n\", new_dollars, cents);\n        }\n        else {        \n            printf (\"$%i.%2i\\n\\n\", dollars, cents);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 1, "creation_date": 1464753415, "post_id": 37559066, "comment_id": 62606698, "body": "Using <code>float</code> may work for this tiny program but it&#39;s the wrong way to deal with decimal fractions in general. You were already close if you&#39;ll notice my comment above."}], "tags": [], "owner": {"reputation": 7, "user_id": 6407291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75b605d55c67f4094f60e137d2d4a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Nikki", "link": "https://stackoverflow.com/users/6407291/nikki"}, "is_accepted": false, "score": 0, "last_activity_date": 1464752770, "creation_date": 1464752770, "answer_id": 37559066, "question_id": 37558443, "link": "https://stackoverflow.com/questions/37558443/new-dollars-dollars-cents-100-no-change/37559066#37559066", "title": "&quot;new_dollars = dollars + cents / 100&quot; NO CHANGE", "body": "<ol>\n<li><p>convert \"int new_dollars\" into \"float new_dollars\";</p></li>\n<li><p>new_dollars = (float) dollars + (float) cents / 100;</p></li>\n<li><p>printf (\"$%.2f\\n\", new_dollars);</p></li>\n</ol>\n"}], "owner": {"reputation": 7, "user_id": 6407291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75b605d55c67f4094f60e137d2d4a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Nikki", "link": "https://stackoverflow.com/users/6407291/nikki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1464752770, "creation_date": 1464748003, "last_edit_date": 1464748322, "question_id": 37558443, "link": "https://stackoverflow.com/questions/37558443/new-dollars-dollars-cents-100-no-change", "title": "&quot;new_dollars = dollars + cents / 100&quot; NO CHANGE", "body": "<p>In output, <code>new_dollars</code> always displays the number of dollars, so I don't know how to solve the problem. Please help me figure out what the problem is.</p>\n\n<pre><code>int main(void)\n{\n    int dollars, cents, count, new_dollars;\n\n    for ( count = 1; count &lt;= 10; ++count){\n        printf (\"Enter dollars: \");\n        scanf (\"%i\", &amp;dollars);\n\n        printf (\"Enter cents: \");\n        scanf (\"%i\", &amp;cents);\n\n        if ( cents &gt;= 100 ){\n            cents = cents % 100;\n            new_dollars = dollars + cents / 100;\n            printf (\"%i\\n\", new_dollars);\n            printf (\"$%i.%2i\\n\\n\", new_dollars, cents);\n        }\n        else {        \n            printf (\"$%i.%2i\\n\\n\", dollars, cents);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pebble-watch", "cloudpebble", "pebble-appmessage"], "answers": [{"tags": [], "owner": {"reputation": 875, "user_id": 5883707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQ0xM.png?s=128&g=1", "display_name": "Edwin Finch", "link": "https://stackoverflow.com/users/5883707/edwin-finch"}, "is_accepted": true, "score": 1, "last_activity_date": 1477785157, "creation_date": 1477785157, "answer_id": 40324810, "question_id": 37558095, "link": "https://stackoverflow.com/questions/37558095/pebblekit-js-send-array-to-pebble-c-by-appmessage/40324810#40324810", "title": "pebblekit js send array to pebble C by appmessage", "body": "<p>Unfortunately there is no way to send an array natively. This is the general framework of how I go about it in my apps. I won't post code because it varies depending on the project.</p>\n\n<ol>\n<li><p>Add the <a href=\"https://github.com/smallstoneapps/js-message-queue\" rel=\"nofollow\">MessageQueue</a> library to your project. This library is great for sending lots of data at a time or many different pieces quickly.</p></li>\n<li><p>Create a <code>sendArray</code> function which simply loops through each of the objects in the array and sends them to Pebble with <code>MessageQueue.sendAppMessage()</code></p></li>\n<li><p>On the C side, in your inbox handler, check for a certain key which you expect to be sent with the array object. For example, if each array object has a <code>temperature</code> key in it, check for that key and then you'll know the rest of the data should be there too.</p>\n\n<p>3.1. Insert all of this data you just got on the C side from the <code>DictionaryIterator</code> into some sort of <code>struct</code> which you have created to represent the array item.</p>\n\n<p>3.2. After processing all of that data, insert that updated <code>struct</code> into an array.</p></li>\n</ol>\n\n<p>Keeping a stack count for that array is usually a good idea too. </p>\n\n<p>Let me know if you need any more help or if I can explain anything better.</p>\n"}], "owner": {"reputation": 70, "user_id": 6267724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a26eb8073fcd5bdf1ea2564ecb742dc?s=128&d=identicon&r=PG&f=1", "display_name": "bergymen", "link": "https://stackoverflow.com/users/6267724/bergymen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 40324810, "answer_count": 1, "score": 1, "last_activity_date": 1496275421, "creation_date": 1464744824, "last_edit_date": 1496275421, "question_id": 37558095, "link": "https://stackoverflow.com/questions/37558095/pebblekit-js-send-array-to-pebble-c-by-appmessage", "title": "pebblekit js send array to pebble C by appmessage", "body": "<p>I am trying to code my first Pebble C app which is based on a pebble.js app I made. I am basically showing the bus schedules.</p>\n\n<p>My question, How can I pass the information from pebblekit js to the pebble C by appmessage so that I can construct a menu? how can I pass an multiple dimension array by appmessage to the watch?</p>\n\n<p>here is an example of the json my pebblekit js has to send to the watch:</p>\n\n<pre><code>{  \n    \"buses\":[\n        {  \n         \"bus_number\":\"55\",\n         \"stops\":[  \n            {  \n                 \"stop_id\":\"109698\",\n                 \"stop_times\":[  \n                    {  \n                       \"arrival_time\":\"21:22:25\",\n                       \"departure_time\":\"21:22:25\"\n                    },\n                    {  \n                       \"arrival_time\":\"21:52:25\",\n                       \"departure_time\":\"21:52:25\"\n                    },\n                    ...\n                 ]\n            },\n            ...\n       }\n   }\n</code></pre>\n"}, {"tags": ["c", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 1929, "user_id": 139942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0105eafa12bc2e15510026309370fab6?s=128&d=identicon&r=PG", "display_name": "namar0x0309", "link": "https://stackoverflow.com/users/139942/namar0x0309"}, "edited": false, "score": 1, "creation_date": 1464744906, "post_id": 37558069, "comment_id": 62604656, "body": "Please add environment you&#39;re using for your build. This looks like compilation or a define is not set correctly."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464747556, "post_id": 37558069, "comment_id": 62605258, "body": "Any reason you spammed the Java-tag?"}], "answers": [{"tags": [], "owner": {"reputation": 281, "user_id": 4407265, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2u0YgMKEFlo/AAAAAAAAAAI/AAAAAAAAByE/m5OaCFNMiLA/photo.jpg?sz=128", "display_name": "David B&#246;hme", "link": "https://stackoverflow.com/users/4407265/david-b%c3%b6hme"}, "is_accepted": true, "score": 5, "last_activity_date": 1464755930, "creation_date": 1464755930, "answer_id": 37559548, "question_id": 37558069, "link": "https://stackoverflow.com/questions/37558069/how-to-make-parallel-this-for-loop-in-openmp/37559548#37559548", "title": "How to make parallel this for loop in OpenMP?", "body": "<p>For OpenMP to parallelize the loop, the number of loop iterations must be determinable in advance. In this particular case, you'd have to determine the string length first:</p>\n\n<pre><code>size_t len = strlen(split);\n#pragma omp for\nfor ( size_t p = 0 ; p &lt; len; ++p ) if (split[p] == ' ') split[p] = '0';\n</code></pre>\n\n<p>It's very doubtful that you'll gain any performance benefit from parallelization for this example though.</p>\n"}], "owner": {"reputation": 263, "user_id": 6396507, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17ba0dafbb232f9a45e554d00695d1b6?s=128&d=identicon&r=PG&f=1", "display_name": "elias rizik", "link": "https://stackoverflow.com/users/6396507/elias-rizik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 37559548, "answer_count": 1, "score": -2, "last_activity_date": 1464755930, "creation_date": 1464744592, "last_edit_date": 1464747529, "question_id": 37558069, "link": "https://stackoverflow.com/questions/37558069/how-to-make-parallel-this-for-loop-in-openmp", "title": "How to make parallel this for loop in OpenMP?", "body": "<p>I am trying to run the loop in parallel by adding \"#pragma omp parallel for\",but this did not work any suggestions to how i can parallel this loop?</p>\n\n<pre><code>#pragma omp parallel for\n   for (p = split; *p != 0; p++) if (*p == ' ') *p = '0';\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1464739406, "post_id": 37557445, "comment_id": 62603473, "body": "C does no bounds checking for you."}, {"owner": {"reputation": 47, "user_id": 6365181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40572eb53fdcbacedb2b26ffd7800cf8?s=128&d=identicon&r=PG&f=1", "display_name": "GMs", "link": "https://stackoverflow.com/users/6365181/gms"}, "edited": false, "score": 0, "creation_date": 1464740025, "post_id": 37557445, "comment_id": 62603627, "body": "Thank you all, now I understand, I will validations manually to be safer."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1464751824, "post_id": 37557445, "comment_id": 62606285, "body": "@Ben There are a bunch of dupes for this question. I just added one I know of specifically."}], "answers": [{"comments": [{"owner": {"reputation": 3364, "user_id": 693294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5935d56f077497b60c12cf86b9d2e1?s=128&d=identicon&r=PG", "display_name": "Gilbert", "link": "https://stackoverflow.com/users/693294/gilbert"}, "edited": false, "score": 0, "creation_date": 1464740199, "post_id": 37557526, "comment_id": 62603663, "body": "Attempts to modify out of bound memory is more likely to fail. The hardware is more likely to catch the write access, and if it doesn&#39;t, but corrupts a critical pointer or count, the program may do something between crash and appear to run just fine. An unstable condition that results in sudden crashes &quot;when it worked just fine yesterday&quot;."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 3364, "user_id": 693294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5935d56f077497b60c12cf86b9d2e1?s=128&d=identicon&r=PG", "display_name": "Gilbert", "link": "https://stackoverflow.com/users/693294/gilbert"}, "edited": false, "score": 0, "creation_date": 1464742141, "post_id": 37557526, "comment_id": 62604046, "body": "@Gilbert: Most hardware will not detect any such accesses reliably or behave in a specific way. C is used much more on non-PC hardware than on PCs."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464742270, "post_id": 37557526, "comment_id": 62604079, "body": "On most systems which are programmed in C heavy-weight libraries or even the standard library are not available."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 5, "last_activity_date": 1464740328, "last_edit_date": 1464740328, "creation_date": 1464739730, "answer_id": 37557526, "question_id": 37557445, "link": "https://stackoverflow.com/questions/37557445/why-my-code-does-not-error-out-of-range/37557526#37557526", "title": "Why my code does not error out of range?", "body": "<p>C is one step up from <a href=\"https://en.wikipedia.org/wiki/Assembly_language\" rel=\"nofollow\">assembly</a> and machine code. It does no bounds checking for you. Arrays and strings (which are also arrays) do not know how long they are or how much memory was allocated to them. They just point at a starting spot in memory.</p>\n\n<p>Instead walking outside of memory bounds is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a> which is C's way of saying \"that's an error, but I don't have to tell you\". Checking <code>array[40][40]</code> will give you whatever garbage was in that memory location. It's known as a <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\" rel=\"nofollow\">buffer overflow</a>. <code>array[0][0]</code> will also give you garbage since the array was never initialized and C does not do that for you.</p>\n\n<p>...but the operating system might. This is known as <a href=\"https://en.wikipedia.org/wiki/Memory_protection\" rel=\"nofollow\">memory protection</a>. Operating systems generally will not allow programs to access memory they were not allocated and their protections are getting better and better. However, memory allocation is not fine grained. The operating system does not know you allocated a 20 by 20 integer array, it just gives your program a hunk of memory to work with, probably larger than it asked for, and leaves the program to slice it up as appropriate.</p>\n\n<p>There are various tools to help you with C's laxidasical attitude. The most important is <a href=\"http://valgrind.org/\" rel=\"nofollow\">Valgrind</a>, a memory checker which will do bounds checks and a whole lot more. <a href=\"http://c.learncodethehardway.org/book/ex4.html\" rel=\"nofollow\">Here's a tutorial on it</a>. I cannot recommend it enough. It can be a bit obscure, but it will tell you why your program is quietly not working and trace the problem back to its source.</p>\n\n<p>Many C compilers also do not have warnings on by default. Most command line compilers respond to <code>-Wall</code>, but those are not all the warnings (this is not the first time C will lie to you). Some use <code>-Weverything</code> or <code>--pendantic</code>. Some compilers <em>will</em> do bounds checks for you for statically initialized things like <code>int array[20][20]</code>. For example, running <code>clang -Wall</code> (<a href=\"https://en.wikipedia.org/wiki/Clang\" rel=\"nofollow\">clang</a> is the default C compiler on OS X)...</p>\n\n<pre><code>test.c:11:14: warning: array index 40 is past the end of the array (which contains 20 elements)\n      [-Warray-bounds]\n    int cc = array[40][40];\n             ^         ~~\ntest.c:9:5: note: array 'array' declared here\n    int array[row][cols];       \n    ^\n</code></pre>\n\n<p>While it's useful to learn standard C, its not a very good way to get things done. Once you have a taste for the problems of standard C, I'd suggest looking at a 3rd party library to improve C. <a href=\"https://developer.gnome.org/glib/stable/\" rel=\"nofollow\">Gnome Lib</a> is a good one.</p>\n"}], "owner": {"reputation": 47, "user_id": 6365181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40572eb53fdcbacedb2b26ffd7800cf8?s=128&d=identicon&r=PG&f=1", "display_name": "GMs", "link": "https://stackoverflow.com/users/6365181/gms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1465413783, "accepted_answer_id": 37557526, "answer_count": 1, "score": -1, "last_activity_date": 1464740328, "creation_date": 1464739211, "question_id": 37557445, "link": "https://stackoverflow.com/questions/37557445/why-my-code-does-not-error-out-of-range", "closed_reason": "Duplicate", "title": "Why my code does not error out of range?", "body": "<p>I've been trying this simple code and two-dimensional arrays in C there do not understand why my program does not fail.</p>\n\n<p>It is assumed that the indices are out of range?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define row 20\n#define cols 20\n\nint main(int argc, char *argv[]) \n{\n    int x,y;\n    int array[row][cols];       \n\n    int cc = array[40][40];\n\n   return 0;\n}\n</code></pre>\n\n<p>regards</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 0, "creation_date": 1464739225, "post_id": 37557428, "comment_id": 62603418, "body": "Please be more specific about what is not working. Is it segfaulting? Failing to compile? Giving incorrect result?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464739245, "post_id": 37557428, "comment_id": 62603424, "body": "And please write code that has consistent style and is readable. And also, the success value from <code>main()</code> is <code>0</code>. Or more precisely, <code>EXIT_SUCCESS</code>. And finally, if you reverse the string, you should think!!! How many characters do you have to swap? And then you will see why it doesn&#39;t work."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1464742512, "post_id": 37557428, "comment_id": 62604124, "body": "You&#39;re returning the address of a local array, but the array is allocated on the stack and is no longer available when the function returns.  You need to do one of three things:  (1) Have <code>inverse</code> allocate the array on the heap by calling <code>malloc</code>,  (2) Have the caller pass a pointer to the desired result array, or  (3) Have <code>inverse</code> reverse the argument string in-place."}], "answers": [{"tags": [], "owner": {"reputation": 1588, "user_id": 6353415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HI3UX.png?s=128&g=1", "display_name": "Alastair Brown", "link": "https://stackoverflow.com/users/6353415/alastair-brown"}, "is_accepted": false, "score": 4, "last_activity_date": 1464739484, "creation_date": 1464739484, "answer_id": 37557487, "question_id": 37557428, "link": "https://stackoverflow.com/questions/37557428/inverse-string-in-c/37557487#37557487", "title": "inverse String in c", "body": "<p>It's slightly hard to tell from you question, because you haven't given any outputs, but my best guess is that it's because your returning a pointer to an item on the stack, which will get over-written by the next call, in your case <code>printf</code>.  You need to pass <code>inverse</code> a place to put its answer. Try this instead:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid inverse(char *s, char *r)\n{\n    int i,taille=strlen(s);\n\n\n    for(i=0;i&lt;taille;i++)\n    {\n        r[i]=s[taille-i-1];\n    }\n    r[i]='\\0';\n}\n\n\n\nint main()\n{\n\nchar s[] = \"kira\";\nchar r[sizeof(s)];\n\ninverse(s, r);    \n\nprintf(\"%s\",r);\n\nreturn 1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 4756446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1621392024761284/picture?type=large", "display_name": "Amar Bessalah", "link": "https://stackoverflow.com/users/4756446/amar-bessalah"}, "edited": false, "score": 0, "creation_date": 1464739602, "post_id": 37557494, "comment_id": 62603522, "body": "how can i fix it ?"}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 121, "user_id": 4756446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1621392024761284/picture?type=large", "display_name": "Amar Bessalah", "link": "https://stackoverflow.com/users/4756446/amar-bessalah"}, "edited": false, "score": 3, "creation_date": 1464739701, "post_id": 37557494, "comment_id": 62603546, "body": "@AmarBessalah, either allocate memory on heap by <code>char *r = malloc(taille + 1)</code>, or make <code>r</code> an output variable, or just copy r content back into <code>s</code>"}, {"owner": {"reputation": 121, "user_id": 4756446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1621392024761284/picture?type=large", "display_name": "Amar Bessalah", "link": "https://stackoverflow.com/users/4756446/amar-bessalah"}, "reply_to_user": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "edited": false, "score": 0, "creation_date": 1464739997, "post_id": 37557494, "comment_id": 62603617, "body": "@gg.kaspersky can you please explain to me why when i don&#39;t allocate, it&#39;s not working ? thanks"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "edited": false, "score": 0, "creation_date": 1464740257, "post_id": 37557494, "comment_id": 62603673, "body": "@gg.kaspersky Do not forget to inform the OP about the need for <code>if (r == NULL) return NULL;</code>. And a later <code>free()</code> somewhere."}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 121, "user_id": 4756446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1621392024761284/picture?type=large", "display_name": "Amar Bessalah", "link": "https://stackoverflow.com/users/4756446/amar-bessalah"}, "edited": false, "score": 0, "creation_date": 1464756986, "post_id": 37557494, "comment_id": 62607763, "body": "@AmarBessalah, <code>char r[taille]</code> declaration makes a buffer with taille characters on the stack (local variables have stack storage). The data allocated on the stack goes away when the function exits. To fix this you need to allocated data on the heap, by using malloc. Heap data persists through function calls, but you need to manually free it, by calling <code>free(r)</code> after you don&#39;t need <code>r</code> anymore."}, {"owner": {"reputation": 121, "user_id": 4756446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1621392024761284/picture?type=large", "display_name": "Amar Bessalah", "link": "https://stackoverflow.com/users/4756446/amar-bessalah"}, "reply_to_user": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "edited": false, "score": 0, "creation_date": 1464813610, "post_id": 37557494, "comment_id": 62643590, "body": "@gg.kaspersky Thank you very much"}], "tags": [], "owner": {"reputation": 86, "user_id": 6402171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a01448d764bb5f009b27d0f4dc9b875?s=128&d=identicon&r=PG&f=1", "display_name": "Gabor Sipkoi", "link": "https://stackoverflow.com/users/6402171/gabor-sipkoi"}, "is_accepted": true, "score": 7, "last_activity_date": 1464739513, "creation_date": 1464739513, "answer_id": 37557494, "question_id": 37557428, "link": "https://stackoverflow.com/questions/37557428/inverse-string-in-c/37557494#37557494", "title": "inverse String in c", "body": "<p>You are returning a pointer to a local variable. That variable gets destroied when the function inverse returns, so accessing the pointer after the function exits will return invalid data. </p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1464746999, "creation_date": 1464746999, "answer_id": 37558340, "question_id": 37557428, "link": "https://stackoverflow.com/questions/37557428/inverse-string-in-c/37558340#37558340", "title": "inverse String in c", "body": "<p>Another standard approach to reversing a string uses pointers to work from both the beginning and end of the string swapping two characters with each iteration. It swaps the original string in place (make a copy if you need to preserve the original, or pass a second string and place the reversed string in there)</p>\n\n<pre><code>/** strrevstr - reverse string, swaps 2 chars per-iteration.\n *  Takes valid string and reverses, original is not preserved.\n *  If 's' is valid and non-empty, returns pointer to 's',\n *  returns NULL otherwise.\n */\nchar *strrevstr (char *s)\n{\n    if (!s || !*s) {     /* validate string is not NULL and non-empty */\n        printf (\"strrevstr() error: invalid string\\n\");\n        return NULL;\n    }\n\n    char *begin = s;    /* pointers to beginning and end, and tmp char */\n    char *end = begin + strlen (s) - 1;\n    char tmp;\n\n    while (end &gt; begin)  /* swap both beginning and end each iteration */\n    {\n        tmp = *end;\n        *end-- = *begin;\n        *begin++ = tmp;\n    }\n\n    return s;\n}\n</code></pre>\n\n<p>As you can tell, there are a number of ways to approach the problem, with this and the other answers provided, you should be able to tailor a solution to meet your needs.</p>\n\n<p>There are advantages and disadvantages to every approach. There is nothing wrong with dynamically allocating a new block of memory to hold the reversed string, it just adds an additional responsibility to (1) preserve a pointer to the starting address for the new block so (2) it can be freed when no longer needed. If you need to preserve the original string, passing a pointer to an character array of sufficient size to hold the reversed string is another option preserve the original. </p>\n\n<p>Look over all the answers and let me know if you have any questions.</p>\n"}], "owner": {"reputation": 121, "user_id": 4756446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1621392024761284/picture?type=large", "display_name": "Amar Bessalah", "link": "https://stackoverflow.com/users/4756446/amar-bessalah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 37557494, "answer_count": 3, "score": 2, "last_activity_date": 1464746999, "creation_date": 1464739105, "last_edit_date": 1464739463, "question_id": 37557428, "link": "https://stackoverflow.com/questions/37557428/inverse-string-in-c", "title": "inverse String in c", "body": "<p>i've done a function that inverse a String(array of character) given in parameter , but it's not working , any idea why ?</p>\n\n<p>I'm getting something like this : \u00e6IGt(Kt$0@</p>\n\n<p>thanks you </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *\ninverse(char *s)\n{\n    int i, taille = strlen(s);\n    char r[taille];\n    for (i = 0 ; i &lt; taille ; i++)\n    {\n        r[i] = s[taille - i - 1];\n    }\n    r[i] = '\\0';    \n    return r;\n}\n\nint\nmain()\n{    \n    char s[] = \"kira\";\n    char *r = inverse(s);\n\n    printf(\"%s\",r);\n\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multithreading", "thread-safety", "pthreads"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3284214, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/063da8f77ec3b57784f7d0fcb96aa4c2?s=128&d=identicon&r=PG&f=1", "display_name": "user3284214", "link": "https://stackoverflow.com/users/3284214/user3284214"}, "edited": false, "score": 0, "creation_date": 1464909808, "post_id": 37557441, "comment_id": 62691946, "body": "Thanks for the reply: I wrote the result of the look-function (both normal and try) into a variable int relax and check !relax before increasing the fields and extracted some pointers (like the array) to temp pointers to boost speed, and seemed to worked a little bit, but the malfunctions still occur."}], "tags": [], "owner": {"reputation": 2400, "user_id": 1123685, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fbe89bfc6b7f4a6f83d222baa20f51ee?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/1123685/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1464739201, "creation_date": 1464739201, "answer_id": 37557441, "question_id": 37557292, "link": "https://stackoverflow.com/questions/37557292/changing-parts-of-arrays-structs-in-threads-without-blocking-the-whole-thing/37557441#37557441", "title": "Changing parts of arrays/structs/.. in threads without blocking the whole thing, in pure c", "body": "<p>There isn't anything special about part of an array or structure. What matters is that the mutex or other synchronization you apply to a given value is used correctly.  </p>\n\n<p>In this case, it seems like you're not checking your locking function results.</p>\n\n<p>The design of the countup function only allows a single thread to ever access the object, running the value all the way up to target before releasing the lock, but you don't check the trylock result.  </p>\n\n<p>So what's probably happening is the first thread gets the lock, and subsequent threads on the same mutex call trylock and fail to get the lock, but the code doesn't check the result.  Then you get multiple threads incrementing the same value without synchronization.  Given all the pointer dereferences the index and increment operations are not guaranteed to be atomic, leading to problems where the values grow well beyond target.</p>\n\n<p>The moral of the story is to check function results and handle errors.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 3284214, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/063da8f77ec3b57784f7d0fcb96aa4c2?s=128&d=identicon&r=PG&f=1", "display_name": "user3284214", "link": "https://stackoverflow.com/users/3284214/user3284214"}, "edited": false, "score": 0, "creation_date": 1464909499, "post_id": 37562801, "comment_id": 62691862, "body": "Why this? &quot;ARRAYLENGTH != THREADS  *    INCREMENTS != TARGET  *    NUM_AREAS != THREADS&quot; I runner you code and non of the fileds reached 100, 5 stayed as 0."}, {"owner": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "reply_to_user": {"reputation": 15, "user_id": 3284214, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/063da8f77ec3b57784f7d0fcb96aa4c2?s=128&d=identicon&r=PG&f=1", "display_name": "user3284214", "link": "https://stackoverflow.com/users/3284214/user3284214"}, "edited": false, "score": 0, "creation_date": 1465210293, "post_id": 37562801, "comment_id": 62790049, "body": "As the C-comment says: this is to make it more interesting: Potentially, the array could be large ; much larger than the thread-count (in contrast to Your code, where an index was changed by one thread, each). The number of areas, this array is split in may be different than the number of threads, too. Also, to make it more interesting, the increments should not be of size TARGET, just to show, that multiple threads need to increment an index to reach TARGET.  Your question was: &quot;Changing parts of arrays/structs/.. in threads without blocking the whole thing&quot;. That&#39;s what my code does."}], "tags": [], "owner": {"reputation": 39, "user_id": 5116723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b091c44c20d78cca945651da04cf724?s=128&d=identicon&r=PG&f=1", "display_name": "Rainer Keller", "link": "https://stackoverflow.com/users/5116723/rainer-keller"}, "is_accepted": false, "score": 0, "last_activity_date": 1464775707, "last_edit_date": 1464775707, "creation_date": 1464768083, "answer_id": 37562801, "question_id": 37557292, "link": "https://stackoverflow.com/questions/37557292/changing-parts-of-arrays-structs-in-threads-without-blocking-the-whole-thing/37562801#37562801", "title": "Changing parts of arrays/structs/.. in threads without blocking the whole thing, in pure c", "body": "<p>Sorry, don't have enough reputation to comment, yet.</p>\n\n<p>Adding to Brad's comment of not checking the result of <code>pthread_mutex_trylock</code>, there's a misconception that shows many times with Pthreads:\nYou assume, that <code>pthread_create</code> will start immediately, and receive the values passed (here pointer <code>t</code> to your struct) and it's content read atomically. That is not true. The thread might start any time later and will find the contents, like <code>t-&gt;run</code> and <code>t-&gt;place</code> already changed by the next iteration of the j-loop in <code>main</code>.</p>\n\n<p>Moreover, you might want to read David Butenhof's book \"Programming with Posix Threads\" (old, but still a good reference) and check on synchronization and condition variables.</p>\n\n<p>It's not that good style to start that many threads in the first place ;)</p>\n\n<p>As this has come up a few times and might come up again, I have restructured that a bit to issue work_items to the started threads. The code below might be amended by a function, that maps the index into <code>array</code> to always the same <code>area_lock</code>, or by adding a queue to feed the running threads with further work-item...</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;pthread.h&gt;\n\n/*\n * Macros for default values. To make it more interesting, set:\n *    ARRAYLENGTH != THREADS\n *    INCREMENTS != TARGET\n *    NUM_AREAS != THREADS\n * Please note, that NUM_AREAS must be &lt;= ARRAY_LENGTH.\n */\n#define ARRAYLENGTH 10\n#define TARGET 100\n#define INCREMENTS 10\n#define NUM_AREAS 2\n#define THREADS 5\n\n\n/* These variables are initialized once in main, then only read... */\nint array_len;\nint target;\nint num_areas;\nint threads;\nint increments;\n\n/**\n * A long array that is going to be equally split into number of areas.\n * Each area is covered by a lock. The number of areas do not have to\n * equal the length of the array, but must be smaller...\n */\ntypedef struct shared_array {\n    int * array;\n    int num_areas;\n    pthread_mutex_t * area_locks;\n} shared_array;\n\n/**\n * A work-item a thread is assigned to upon startup (or later on).\n * Then a value of { 0, any } might signal the ending of this thread.\n * The thread is working on index within zstr-&gt;array, counting up increments\n * (or up until the target is reached).\n */\ntypedef struct work_item {\n    shared_array * zstr;\n    int work_on_index;\n    int increments;\n} work_item;\n\n\n/* Local function declarations */\nvoid * countup(void *);\n\nint main(int argc, char * argv[]) {\n    int i;\n    shared_array * zstr;\n\n    if (argc == 1) {\n        array_len = ARRAYLENGTH;\n        target = TARGET;\n        num_areas = NUM_AREAS;\n        threads = THREADS;\n        increments = INCREMENTS;\n    } else if (argc == 6) {\n        array_len = atoi(argv[1]);\n        target = atoi(argv[2]);\n        num_areas = atoi(argv[3]);\n        threads = atoi(argv[4]);\n        increments = atoi(argv[5]);\n    } else {\n        fprintf(stderr, \"USAGE: %s len target areas threads increments\", argv[0]);\n        exit(-1);\n    }\n    assert(array_len &gt;= num_areas);\n\n    zstr = malloc(sizeof (shared_array));\n    zstr-&gt;array = calloc(array_len, sizeof (int));\n    zstr-&gt;num_areas = num_areas;\n    zstr-&gt;area_locks = calloc(num_areas, sizeof (pthread_mutex_t));\n\n    for (i = 0; i &lt; num_areas; i++)\n        pthread_mutex_init(&amp;(zstr-&gt;area_locks[i]), NULL);\n\n    pthread_t * id = calloc(threads, sizeof (pthread_t));\n    work_item * work_items = calloc(threads, sizeof (work_item));\n\n    for (i = 0; i &lt; threads; i++) {\n        work_items[i].zstr = zstr;\n        work_items[i].work_on_index = i % array_len;\n        work_items[i].increments = increments;\n        pthread_create(&amp;(id[i]), NULL, &amp;countup, &amp;(work_items[i]));\n    }\n    // Let's just do this one work-item.\n    for (i = 0; i &lt; threads; i++) {\n        pthread_join(id[i], NULL);\n    }\n\n    printf(\"Array: \");\n    for (i = 0; i &lt; array_len; i++)\n        printf(\"%d \", zstr-&gt;array[i]);\n    printf(\"\\n\");\n\n    free(id);\n    free(work_items);\n    free(zstr-&gt;area_locks);\n    free(zstr-&gt;array);\n    return 0;\n}\n\nvoid *countup(void* first_work_item) {\n    work_item * wi = first_work_item;\n    int inc;\n\n    // Extract the information from this work-item.\n    int idx = wi-&gt;work_on_index;\n    int area = idx % wi-&gt;zstr-&gt;num_areas;\n    pthread_mutex_t * lock = &amp;(wi-&gt;zstr-&gt;area_locks[area]);\n\n    pthread_mutex_lock(lock);\n    for (inc = wi-&gt;increments; inc &gt; 0 &amp;&amp; wi-&gt;zstr-&gt;array[idx] &lt; target; inc--)\n        wi-&gt;zstr-&gt;array[idx]++;\n    pthread_mutex_unlock(lock);\n\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3284214, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/063da8f77ec3b57784f7d0fcb96aa4c2?s=128&d=identicon&r=PG&f=1", "display_name": "user3284214", "link": "https://stackoverflow.com/users/3284214/user3284214"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464775707, "creation_date": 1464738026, "question_id": 37557292, "link": "https://stackoverflow.com/questions/37557292/changing-parts-of-arrays-structs-in-threads-without-blocking-the-whole-thing", "title": "Changing parts of arrays/structs/.. in threads without blocking the whole thing, in pure c", "body": "<p>I want to modify some (not all) fields of an array (or structs) in multiple threads, with out blocking the rest of the array as the rest of it is being modified in other threads. How is this achieved? I found some answers, but they are for C++ and I want to do it in C.\nHere is the code I got so far:</p>\n\n\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n#define ARRAYLENGTH 5\n#define TARGET 10000\n\nint target;\n\ntypedef struct zstr{\n    int* array;\n    int place;\n    int run;\n    pthread_mutex_t* locks;\n}zstr;\n\nvoid *countup(void *);\n\nint main(int argc, char** args){\n    int al;\n    if(argc&gt;2){\n        al=atoi(args[1]);\n        target=atoi(args[2]);\n    }else{\n        al=ARRAYLENGTH;\n        target=TARGET;\n    }\n    printf(\"%d %d\\n\", al, target);\n    zstr* t=malloc(sizeof(zstr));\n    t-&gt;array=calloc(al, sizeof(int));\n    t-&gt;locks=calloc(al, sizeof(pthread_mutex_t));\n    int* rua=calloc(al, sizeof(int));\n    pthread_t id[4*al];\n    for(int i=0; i&lt;al; i++)\n            pthread_mutex_init(&amp;(t-&gt;locks[i]), NULL);\n    for(int j=0; j&lt;4*al; j++){\n        int st=j%al;\n        t-&gt;run=rua[st]++;\n        t-&gt;place=st;\n        pthread_create(&amp;id[j], NULL, &amp;countup, t);\n    }\n    for(int k=0; k&lt;4*al; k++){\n        pthread_join(id[k], NULL);\n    }\n    for(int u=0; u&lt;al; u++)\n           printf(\"%d\\n\", t-&gt;array[u]);\n    free(rua);\n    free(t-&gt;locks);\n    free(t-&gt;array);\n    return 0;\n}\n\nvoid *countup(void* table){\n    zstr* nu=table;\n    if(!nu-&gt;run){\n        pthread_mutex_lock(nu-&gt;locks + nu-&gt;place);\n    }else{\n        pthread_mutex_trylock(nu-&gt;locks + nu-&gt;place);\n    }\n    while(nu-&gt;array[nu-&gt;place]&lt;target)\n        nu-&gt;array[nu-&gt;place]++;\n    pthread_mutex_unlock(nu-&gt;locks + nu-&gt;place); \n    return NULL;\n}\n</code></pre>\n\n<p>Sometimes this works just fine, but then calculates wrong values and for quiet sort problems (like the default values), it takes super long (strangely it worked once when I handed them in as parameters).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 4, "creation_date": 1464737900, "post_id": 37557228, "comment_id": 62603087, "body": "Looks like you have a memory corruption somewhere. It&#39;s hard for us to help unless a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is provided. But for starters <code>for(int i = 0; i &lt;= s; i++)</code> causes out of bound access. It needs to be <code>for(int i = 0; i &lt; s; i++)</code>. If that doesn&#39;t help then suggest running <a href=\"http://valgrind.org\" rel=\"nofollow noreferrer\">valgrind</a> to help find the memory corruption."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1464738056, "post_id": 37557228, "comment_id": 62603133, "body": "Look into using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\">getline</a> instead of fgets. No arbitrary memory allocation necessary."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1464738143, "post_id": 37557228, "comment_id": 62603156, "body": "@Schwern That function may not be available on non-POSIX systems"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1464738193, "post_id": 37557228, "comment_id": 62603167, "body": "Using a floating point value for <code>range</code> in the size calculation for <code>malloc()</code> is very unusual.  Not necessarily wrong, but unusual enough to be a cause for concern.  What is that meant to do?  How is it used?  Why isn&#39;t it an appropriate size of integer rather than a <code>float</code>?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1464738229, "post_id": 37557228, "comment_id": 62603178, "body": "You allocated memory for <code>s</code> characters, and then copied <code>s+1</code> characters into that memory. And didn&#39;t NUL terminate the string either. You&#39;re also assuming that the <code>strlen(line)</code> is more than 3. Basically, you need to take a step back, and come up with a sensible plan to parse the input."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1464738281, "post_id": 37557228, "comment_id": 62603193, "body": "Could you show us the <code>TrainSet</code> definition please?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464738334, "post_id": 37557228, "comment_id": 62603200, "body": "@M.M Worth it. If it&#39;s not available, make your own."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1464738600, "post_id": 37557228, "comment_id": 62603268, "body": "Does <code>t =  malloc(range * sizeof *t);</code> make sense when <code>t</code> is not used as an array?"}, {"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464738927, "post_id": 37557228, "comment_id": 62603343, "body": "Thanks everybody!! I&#39;ll try to answer your very thoughtful points. For starters, @kaylum was absolutely correct, and that has already been extremely helpful."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464739026, "post_id": 37557228, "comment_id": 62603366, "body": "Wouldn&#39;t <code>range * sizeof *t</code> be calculated as <code>float</code>?  Even if <code>range</code> always holds an integer value, there might not be enough precision if <code>sizeof(TrainSet)</code> is fairly large.."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1464739052, "post_id": 37557228, "comment_id": 62603370, "body": "@Schwern: Probably not. (To be pedantic, when <code>t</code> is not used as a pointer to the initial element of an array.) <code>get_train_set</code> only initializes the <code>TrainSet</code> object that <code>t</code> points to, not any of its successors. (And the floating-point <code>range</code> is very suspicious.)"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1464739055, "post_id": 37557228, "comment_id": 62603371, "body": "what does your input data look like - its hard to picture it"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464739152, "post_id": 37557228, "comment_id": 62603393, "body": "@Dmitri: Yes, <code>range * sizeof *t</code> yields a <code>float</code> result -- which is implicitly converted to <code>size_t</code> before being passed to <code>malloc</code>."}, {"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1464739190, "post_id": 37557228, "comment_id": 62603407, "body": "@JonathanLeffler, I use the range for division later, where the type has to be a float."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1464739253, "post_id": 37557228, "comment_id": 62603428, "body": "can we please see the definition of TrainSet"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464741437, "post_id": 37557228, "comment_id": 62603902, "body": "With <code>TrainSet</code> containing the two 7892-element arrays, <code>range * sizeof *t</code> probably won&#39;t be exact if <code>range</code> is more than a few hundred, even if <code>range</code> is always an exact integer value.  <code>float</code> normally only has 24-bits of precision.."}], "answers": [{"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464738982, "post_id": 37557300, "comment_id": 62603357, "body": "@user3386109 Maybe, but then it&#39;s hard to explain why he allocated <code>s</code> spaces, copied (roughly) <code>s</code> characters and passed <code>atoi</code> a pointer to <code>line[s]</code>. You&#39;d think there&#39;d be a -3 in there somewhere. But with no comments (other than one unhelpful one) and many errors, it&#39;s awfully hard to be sure."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464739156, "post_id": 37557300, "comment_id": 62603395, "body": "Ahh, you are right. It makes much more sense now. Good catch. (Updating answer.)"}, {"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "edited": false, "score": 0, "creation_date": 1464739728, "post_id": 37557300, "comment_id": 62603554, "body": "Sorry for the confusion, the s logic is used to grab an integer that&#39;s at the end of every single quote, and add it to a separate list of labels. The quotes need to be added to a list of quotes. Thanks for the advice! Female writer, btw."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 3, "last_activity_date": 1464739176, "last_edit_date": 1464739176, "creation_date": 1464738093, "answer_id": 37557300, "question_id": 37557228, "link": "https://stackoverflow.com/questions/37557228/malloc-misallocation/37557300#37557300", "title": "Malloc misallocation?", "body": "<pre><code>  char* quote = (char*)malloc(sizeof(char) * s);\n  for(int i = 0; i &lt;= s; i++){\n     quote[i] = line[i];\n  }\n</code></pre>\n\n<p>Suppose <code>s</code> is 2. Your <code>for</code> loop will loop over 0, 1, and 2. That's three spaces in <code>quote</code>. But since <code>s</code> is 2, you've only allocated space in <code>quote</code> for two.</p>\n"}, {"comments": [{"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "edited": false, "score": 0, "creation_date": 1464739829, "post_id": 37557312, "comment_id": 62603584, "body": "Thanks for the advice @MSN! The strange thing is that this worked perfectly at a smaller size, which now that I&#39;m looking at it I can&#39;t see why it would have. You were absolutely correct."}, {"owner": {"reputation": 2659, "user_id": 2026276, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/8wAi8.jpg?s=128&g=1", "display_name": "Bauss", "link": "https://stackoverflow.com/users/2026276/bauss"}, "edited": false, "score": 0, "creation_date": 1464741884, "post_id": 37557312, "comment_id": 62603991, "body": "I believe the reason why you probably didn&#39;t notice is because accessing out of bounds of arrays in C is considered undefined behavior, so God knows what actually is written to."}], "tags": [], "owner": {"reputation": 49428, "user_id": 6210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14994f4fef70636139dfeaf97dca2ef8?s=128&d=identicon&r=PG", "display_name": "MSN", "link": "https://stackoverflow.com/users/6210/msn"}, "is_accepted": true, "score": 0, "last_activity_date": 1464738183, "creation_date": 1464738183, "answer_id": 37557312, "question_id": 37557228, "link": "https://stackoverflow.com/questions/37557228/malloc-misallocation/37557312#37557312", "title": "Malloc misallocation?", "body": "<p>You are writing past the end of <code>quote</code> and potentially writing past the end of <code>t</code>.</p>\n\n<p>This loop:</p>\n\n<pre><code>  for(int i = 0; i &lt;= s; i++){\n     quote[i] = line[i];\n  }\n</code></pre>\n\n<p>writes one <code>char</code> past  the end of <code>quote</code>.</p>\n\n<p>And this part:</p>\n\n<pre><code>  t-&gt;sentences[count] = quote;\n  t-&gt;labels[count] = label;\n</code></pre>\n\n<p>does not check if <code>count &lt; range</code>.</p>\n"}], "owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "closed_date": 1465884547, "accepted_answer_id": 37557312, "answer_count": 2, "score": 0, "last_activity_date": 1464739896, "creation_date": 1464737618, "last_edit_date": 1464739896, "question_id": 37557228, "link": "https://stackoverflow.com/questions/37557228/malloc-misallocation", "closed_reason": "Not suitable for this site", "title": "Malloc misallocation?", "body": "<p>new to C programmer here. This code runs beautifully when the training set it small, but it starts to crash when the range increases. Right now it breaks at 1289, but I'd like to use it up to 7892.  The error is below; I'm fairly certain it's related to something in the malloc call, but I'm not sure how to fix it. Thanks.</p>\n\n<pre><code>TrainSet* get_train_set(float range){\n   TrainSet* t; \n   printf(\"%f\\n\", range);\n   t =  malloc(range * sizeof *t);\n   FILE *fp;\n   char line[300]; /* 300 is an arbitrary length to read in lines from the text file*/\n   int count = 0;\n   fp = fopen(\"Data/main_training_set.txt\", \"r\");\n   if(fp == NULL){\n      perror(\"Error opening file\");\n      return NULL;\n   }\n   while (fgets(line, 300, fp)){\n      // printf(\"%d\\n\", count);\n      int s = strlen((line)) - 3;\n      char* quote = (char*)malloc(sizeof(char) * s);\n      for(int i = 0; i &lt;= s; i++){\n         quote[i] = line[i];\n      }\n      int label =  atoi(&amp;line[s]);\n      t-&gt;sentences[count] = quote;\n      t-&gt;labels[count] = label;\n      count ++;\n   }\n   //fclose(fp);\n   return t;\n}\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>buddhism: malloc.c:2372: sysmalloc: Assertion `(old_top == (((mbinptr) (((char *) &amp;((av)-&gt;bins[((1) - 1) * 2])) - __builtin_offsetof (struct malloc_chunk, fd)))) &amp;&amp; old_size == 0) || ((unsigned long) (old_size) &gt;= (unsigned long)((((__builtin_offsetof (struct malloc_chunk, fd_nextsize))+((2 *(sizeof(size_t))) - 1)) &amp; ~((2 *(sizeof(size_t))) - 1))) &amp;&amp; ((old_top)-&gt;size &amp; 0x1) &amp;&amp; ((unsigned long) old_end &amp; pagemask) == 0)' failed.\nAborted\n</code></pre>\n\n<p>And here's the h file for TrainSet</p>\n\n<pre><code>typedef struct TrainSet {\n    char* sentences[7892];\n    int labels[7892];\n} TrainSet;\n\nTrainSet* get_train_set(float range);\n\n#endif /* READ_H*/*\n</code></pre>\n\n<p>Input data is essentially this, a garbled sort of sentence with an integer at the end of every line. </p>\n\n<pre><code>first four lectures taking place weekendand subject weekends talk five aggregates 1\nrelationship us thats simply want tobe happy dont want suffer 1\nheard words songrecently said \"i dont mind dying living scaresme 1\nus know difficulties life trying somehowto minimize 1\n</code></pre>\n"}, {"tags": ["c", "file", "fwrite"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 3, "creation_date": 1464733020, "post_id": 37556516, "comment_id": 62601748, "body": "Read: <a href=\"http://en.cppreference.com/w/c/io/fwrite\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/io/fwrite</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "is_accepted": false, "score": 2, "last_activity_date": 1464734116, "last_edit_date": 1464734116, "creation_date": 1464733244, "answer_id": 37556583, "question_id": 37556516, "link": "https://stackoverflow.com/questions/37556516/write-byte-0-in-a-binary-file-in-c/37556583#37556583", "title": "Write byte 0 in a binary file in C", "body": "<p>You should specify the buffer which contains the data to write. In your case you can store '\\0' in a char variable and pass its address.</p>\n\n<pre><code>char c = 0;\nint i;\nfor (i = 0; i &lt; 200; i++)\n    fwrite(&amp;c, sizeof c, 1, file);\n</code></pre>\n\n<p>Another (more efficient) solution is create a buffer of 200 elements directly:</p>\n\n<pre><code>char buff[200] = {0}; // declare array with 200 '\\0' bytes\nfwrite(buff, 1, 200, file);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": true, "score": 4, "last_activity_date": 1464740947, "creation_date": 1464740947, "answer_id": 37557659, "question_id": 37556516, "link": "https://stackoverflow.com/questions/37556516/write-byte-0-in-a-binary-file-in-c/37557659#37557659", "title": "Write byte 0 in a binary file in C", "body": "<p>The first argument of <code>fwrite</code> must be a valid pointer.</p>\n\n<p>You can use <code>fputc</code> to write an immediate character (byte) into a file like this:</p>\n\n<pre><code>int i;\nfor(i=0; i &lt; 200; i++){\n    fputc(0, file);\n}\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 5447261, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/eFE3c.jpg?s=128&g=1", "display_name": "Matheus Weber", "link": "https://stackoverflow.com/users/5447261/matheus-weber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4453, "favorite_count": 0, "closed_date": 1465137011, "accepted_answer_id": 37557659, "answer_count": 2, "score": -4, "last_activity_date": 1464740947, "creation_date": 1464732922, "question_id": 37556516, "link": "https://stackoverflow.com/questions/37556516/write-byte-0-in-a-binary-file-in-c", "closed_reason": "Needs details or clarity", "title": "Write byte 0 in a binary file in C", "body": "<p>I have to write a n numbers of bytes in a binary file in C, how can I write it? All the bytes has to be 0.</p>\n\n<p>I am writting a char, but I dont know if this is the correct way.</p>\n\n<pre><code>int i;\nfor(i=0; i &lt; 200; i++){\n    fwrite(0, sizeof(char), 1, file);\n}\n</code></pre>\n"}, {"tags": ["c", "binary", "overflow", "largenumber"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464743223, "post_id": 37556482, "comment_id": 62604276, "body": "Corner case:  <code>binpow(positive_a, 0, 1)</code>  generates the wrong answer <code>1</code>.  Could start with <code>unsigned long long res = 1LLU % m</code> to catch such cases."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6406772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b2ee22af247bfee03ee86c718f35c7?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Rusinov", "link": "https://stackoverflow.com/users/6406772/simon-rusinov"}, "edited": false, "score": 0, "creation_date": 1464746220, "post_id": 37556645, "comment_id": 62604955, "body": "Thank you my friend, your answer is very helpful. Actually I am using this function as a part of algorithm which defines whether number is prime or not. So the speed of calculations here is vital. May I ask you will that library slow calculations down much?"}], "tags": [], "owner": {"reputation": 2371, "user_id": 270006, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/874bcba40024d48919097b29a25e852d?s=128&d=identicon&r=PG", "display_name": "\u0179V -", "link": "https://stackoverflow.com/users/270006/%c5%b9v"}, "is_accepted": true, "score": 0, "last_activity_date": 1464733553, "creation_date": 1464733553, "answer_id": 37556645, "question_id": 37556482, "link": "https://stackoverflow.com/questions/37556482/binary-powering-giving-me-a-wrong-result/37556645#37556645", "title": "Binary powering giving me a wrong result", "body": "<p>Both your residue and modulus are exceeding the width of an <code>unsigned long long</code> (shifted by <code>m</code>).</p>\n\n<p>You can put off the problem by using a compiler extension type like <code>unsigned __int128</code>, which produces the correct result for 4,312,952,827.</p>\n\n<pre><code>unsigned __int128 binpow(unsigned __int128 a, unsigned __int128 n, unsigned __int128 m)\n{\n    unsigned __int128 res;\n    res = 1;\n    while (n)\n        {\n            if (n &amp; 1)\n                {\n                    res = (res*a)%m;\n                    n--;\n                }\n            a = (a*a) % m;\n            n &gt;&gt;= 1;\n        }\n    return res;\n}\n</code></pre>\n\n<p>Alternatively, if you want to work with large numbers in a safe fashion, there are general-purpose bignum libraries like <a href=\"https://gmplib.org/\" rel=\"nofollow\">gmplib</a></p>\n"}, {"tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": false, "score": 1, "last_activity_date": 1464734329, "last_edit_date": 1464734329, "creation_date": 1464733925, "answer_id": 37556709, "question_id": 37556482, "link": "https://stackoverflow.com/questions/37556482/binary-powering-giving-me-a-wrong-result/37556709#37556709", "title": "Binary powering giving me a wrong result", "body": "<p>The expression <code>a*a</code> requires room that is twice as much as the source's size. In your scenario <code>4,312,952,827 &gt; 2^32-1</code>, hence you are out the <code>unsigned long long</code>'s range.</p>\n\n<p>The rule of thumb for implementing modular exponentation's binary ladders is to able to perform arithmetic on range that is at least twice of the datatype of arguments, thus in your case it is 128-bit.</p>\n"}], "owner": {"reputation": 19, "user_id": 6406772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b2ee22af247bfee03ee86c718f35c7?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Rusinov", "link": "https://stackoverflow.com/users/6406772/simon-rusinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 37556645, "answer_count": 2, "score": -1, "last_activity_date": 1464734329, "creation_date": 1464732750, "question_id": 37556482, "link": "https://stackoverflow.com/questions/37556482/binary-powering-giving-me-a-wrong-result", "title": "Binary powering giving me a wrong result", "body": "<p>I have a problem with my binary powering function. Variable which contains the result overflows while performing multiplication and gives me a wrong result. It happens when the source value is greater than 4,312,952,827. So how do I solve this problem? Here's the code of my function.</p>\n\n<pre><code>unsigned long long binpow(unsigned long long a, unsigned long long n, unsigned long long m)\n{\n    unsigned long long res;\n    res=1;\n    while (n)\n    {\n        if (n &amp; 1)\n        {\n            res=(res*a)%m;\n            n--;\n        }\n        a=(a*a)%m;\n        n &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel", "huge-pages"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1464734574, "post_id": 37556216, "comment_id": 62602257, "body": "Did you read the <a href=\"https://www.kernel.org/doc/Documentation/vm/pagemap.txt\" rel=\"nofollow noreferrer\">documentation for pagemap</a>? It&#39;s even referenced from the link you have provided. Specifically the section describing <code>COMPOUND_HEAD</code> and <code>COMPOUND_TAIL</code>."}, {"owner": {"reputation": 424, "user_id": 3276836, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/523363036/picture?type=large", "display_name": "alex10791", "link": "https://stackoverflow.com/users/3276836/alex10791"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464737804, "post_id": 37556216, "comment_id": 62603074, "body": "I have been looking in the pagemap documentation but under the HUGE section which didn&#39;t say much. So according to COMPOUND_HEAD and COMPOUND_TAIL the beginning of my 2 MB buffer should be the head hence any place in the first 4 KB of my buffer should map to the PFN of the entire huge-page? How should I then interpret the value? Should I expect 9 zeros at the end of the PFN? And consider bit 10 and above as the physical memory bits extending my offset?"}], "answers": [{"comments": [{"owner": {"reputation": 1588, "user_id": 3143086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be427f04d51318a211a8946c9101dba?s=128&d=identicon&r=PG&f=1", "display_name": "ruthafjord", "link": "https://stackoverflow.com/users/3143086/ruthafjord"}, "edited": false, "score": 0, "creation_date": 1464755292, "post_id": 37559417, "comment_id": 62607219, "body": "But it might also not be the same. Let me know which error you are getting and I&#39;ll see if I can understand why."}, {"owner": {"reputation": 424, "user_id": 3276836, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/523363036/picture?type=large", "display_name": "alex10791", "link": "https://stackoverflow.com/users/3276836/alex10791"}, "edited": false, "score": 0, "creation_date": 1464891973, "post_id": 37559417, "comment_id": 62683747, "body": "Thanks a lot, it seems to work at the moment. I noticed that I got addresses with a lot of trailing zeros which made sense but I didn&#39;t know for sure, it was just an observation I didn&#39;t want to blindly rely on. Thanks again"}], "tags": [], "owner": {"reputation": 1588, "user_id": 3143086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be427f04d51318a211a8946c9101dba?s=128&d=identicon&r=PG&f=1", "display_name": "ruthafjord", "link": "https://stackoverflow.com/users/3143086/ruthafjord"}, "is_accepted": false, "score": 1, "last_activity_date": 1464755226, "creation_date": 1464755226, "answer_id": 37559417, "question_id": 37556216, "link": "https://stackoverflow.com/questions/37556216/how-to-get-the-physical-address-of-a-huge-page/37559417#37559417", "title": "How to get the physical address of a huge-page", "body": "<p>It should be the same. The primary difference between normal pages and huge pages are a few layers of the page tables. The page table walk ends early for huge pages (at least on x86).</p>\n\n<p>Huge-pages generally end in more zeros than typical pages, as they need to be aligned to their size (in the 2MB case, the low 21 bits should all be zero).</p>\n\n<p>If you are getting -EINVAL from your reads, check out this quote from the <a href=\"https://www.kernel.org/doc/Documentation/vm/pagemap.txt\" rel=\"nofollow\">pagemap documentation</a>(the example reads the wrong number of bytes):</p>\n\n<blockquote>\n  <p>Reading from any of the files will return -EINVAL if you are not\n  starting the read on an 8-byte boundary (e.g., if you sought an odd\n  number of bytes into the file), or if the size of the read is not a\n  multiple of 8 bytes.</p>\n</blockquote>\n"}], "owner": {"reputation": 424, "user_id": 3276836, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/523363036/picture?type=large", "display_name": "alex10791", "link": "https://stackoverflow.com/users/3276836/alex10791"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1768, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1464755226, "creation_date": 1464731506, "last_edit_date": 1464731871, "question_id": 37556216, "link": "https://stackoverflow.com/questions/37556216/how-to-get-the-physical-address-of-a-huge-page", "title": "How to get the physical address of a huge-page", "body": "<p>I need to get the physical address of a huge-page (2 MB) from user-space. I managed to get the physical address of a normal 4 KB page from pagemap as shown in <a href=\"https://shanetully.com/2014/12/translating-virtual-addresses-to-physcial-addresses-in-user-space/#codeprocpidpagemapcode\" rel=\"nofollow\">https://shanetully.com/2014/12/translating-virtual-addresses-to-physcial-addresses-in-user-space/#codeprocpidpagemapcode</a> however I don't understand how I should use pagemap to get the physical address of a huge-page. How is a huge-page page frame number represented in pagemap? Any references and especially any piece of code would be highly appreciated.</p>\n"}, {"tags": ["c", "linux", "filenames", "file-permissions"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1464730121, "post_id": 37555851, "comment_id": 62600668, "body": "If that&#39;s not what you want, why are you calling <code>creat</code>?!"}, {"owner": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1464730255, "post_id": 37555851, "comment_id": 62600721, "body": "I want to create but I want it to check first if this file exists."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1464730504, "post_id": 37555851, "comment_id": 62600826, "body": "Can you be very, very specific about exactly what you want to do? What do you want to happen if the file already exists? What do you want to happen if the file does not exist? What do you want to happen if the file exists but is a symbolic link?"}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "edited": false, "score": 0, "creation_date": 1464730154, "post_id": 37555911, "comment_id": 62600681, "body": "so every time I want to create a file I need to try to open it first? there is no way to check while creating if the file exists to avoid overwrite it?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "edited": false, "score": 2, "creation_date": 1464730688, "post_id": 37555911, "comment_id": 62600892, "body": "@DvirNaim You want to open a file right, creating it if it doesn&#39;t not exist and failing if it does exist? Is that correct? If so, you don&#39;t need to try to open it &quot;first&quot;, all you need to do is try to open it in such a way that the open fails if the file already exists."}, {"owner": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "edited": false, "score": 0, "creation_date": 1464730868, "post_id": 37555911, "comment_id": 62600971, "body": "found it..I tought that creat will do the job for me..I was worng...<a href=\"http://stackoverflow.com/questions/230062/whats-the-best-way-to-check-if-a-file-exists-in-c-cross-platform\" title=\"whats the best way to check if a file exists in c cross platform\">stackoverflow.com/questions/230062/&hellip;</a>"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1464733006, "post_id": 37555911, "comment_id": 62601740, "body": "But <code>creat()</code> opens the file too!"}], "tags": [], "owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "is_accepted": false, "score": 3, "last_activity_date": 1464730005, "creation_date": 1464730005, "answer_id": 37555911, "question_id": 37555851, "link": "https://stackoverflow.com/questions/37555851/creat-overwrite-my-file/37555911#37555911", "title": "creat() overwrite my file", "body": "<p><code>EEXIST</code> is only returned if <code>O_CREAT | O_EXCL</code> is used in the flags to <code>open</code>. While <a href=\"http://linux.die.net/man/2/creat\" rel=\"nofollow\"><code>creat(2)</code></a> does imply <code>O_CREAT</code>, it does not imply <code>O_EXCL</code>, only <code>O_CREAT | O_WRONLY | O_TRUNC</code>.</p>\n\n<p>You should instead use <code>open</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "edited": false, "score": 0, "creation_date": 1464730157, "post_id": 37555924, "comment_id": 62600684, "body": "so every time I want to create a file I need to try to open it first? there is no way to check while creating if the file exists to avoid overwrite it?"}, {"owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "reply_to_user": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "edited": false, "score": 0, "creation_date": 1464730256, "post_id": 37555924, "comment_id": 62600722, "body": "Exactly, but you can create your own function to make the task easily the <code>open()</code> function give you a <code>file descriptor</code>, it&#39;s needed for reading or writing into a file"}, {"owner": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "edited": false, "score": 0, "creation_date": 1464730338, "post_id": 37555924, "comment_id": 62600753, "body": "How..? which tools do I need..?"}, {"owner": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "edited": false, "score": 0, "creation_date": 1464730806, "post_id": 37555924, "comment_id": 62600937, "body": "found it...<a href=\"http://stackoverflow.com/questions/230062/whats-the-best-way-to-check-if-a-file-exists-in-c-cross-platform\" title=\"whats the best way to check if a file exists in c cross platform\">stackoverflow.com/questions/230062/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "is_accepted": false, "score": 3, "last_activity_date": 1464733070, "last_edit_date": 1464733070, "creation_date": 1464730072, "answer_id": 37555924, "question_id": 37555851, "link": "https://stackoverflow.com/questions/37555851/creat-overwrite-my-file/37555924#37555924", "title": "creat() overwrite my file", "body": "<blockquote>\n  <p>The creat() function is the same as:</p>\n\n<pre><code>open(path, O_CREAT | O_TRUNC | O_WRONLY, mode);\n</code></pre>\n</blockquote>\n\n<p>You need the flags <code>O_APPEND</code> to write at the end of the file</p>\n\n<p>So you should use <code>open()</code> <code>read()</code> <code>write()</code></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>exemple :</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint is_file_exist (char *filename)\n{\n  struct stat   buffer;   \n  return (stat (filename, &amp;buffer) == 0);\n}\n\nvoid open_read_write() {\n  int fd;\n\n  if (!is_file_exist(\"./file\"))\n    return ;\n  // open a file descriptor, if not, create\n  fd = open(\"./file\", O_RDWR | O_APPEND);\n  // thanks to O_APPEND, write() writes at the end of the file\n  write(fd, \"hello world\\n\", 12);\n  // close the file descriptor\n  close(fd); // important !\n}\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 4338701, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f50077b71616677b2b5d7d4559defdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Naim", "link": "https://stackoverflow.com/users/4338701/dvir-naim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464733070, "creation_date": 1464729692, "question_id": 37555851, "link": "https://stackoverflow.com/questions/37555851/creat-overwrite-my-file", "title": "creat() overwrite my file", "body": "<p>I wrote down a small C code on linux with a <code>creat</code> function. I used it couple of times with the same file name and the same <code>mode</code> and every time it's overwrites my file with a new time and permission with no <code>EEXIST</code> error.</p>\n\n<pre><code> if (creat(name, mode) &lt; 0)\n{\n    printf(\"something went wrong with create! %s\\n\", strerror(errno));\n    exit(1);\n}\n</code></pre>\n\n<p>What is the problem?</p>\n"}, {"tags": ["c", "arrays", "dynamic"], "comments": [{"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "reply_to_user": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "edited": false, "score": 0, "creation_date": 1464729127, "post_id": 37555614, "comment_id": 62600202, "body": "I just found <a href=\"https://mackiemathew.wordpress.com/2015/06/30/dont-use-memset-for-initializing-floats-or-doubles/\" rel=\"nofollow noreferrer\">this</a> , provides some insight into my question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464729162, "post_id": 37555614, "comment_id": 62600217, "body": "<code>memset(large_float_array, 0, sizeof(large_float_array);</code> does not compile.  Always kind to post true code."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1464729163, "post_id": 37555614, "comment_id": 62600218, "body": "C does not mandate that floating-point be ieee754 specifically. As such I believe there is no guarantee in the standard that <code>0.0f</code> be bitwise-zero."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1464729248, "post_id": 37555614, "comment_id": 62600256, "body": "<code>large_float_array = (float*)calloc(NUM, sizeof(float));</code> --&gt; <code>large_float_array = calloc(NUM, sizeof *large_float_array);</code>"}, {"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464729319, "post_id": 37555614, "comment_id": 62600284, "body": "So is the consensus that memset on floating point arrays is ok, as long as I specify the right size? EDIT: @chux why should that be changed?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464729395, "post_id": 37555614, "comment_id": 62600328, "body": "@Syntactic Fructose Using <code>memset(ptr, 0, ...</code> after <code>ptr = calloc(...)</code> is redundant."}, {"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464729458, "post_id": 37555614, "comment_id": 62600354, "body": "@chux see my comment, I said <code>do stuff with large array</code>, so pretend I filled it with stuff and now need to memset it"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464729516, "post_id": 37555614, "comment_id": 62600383, "body": "As <a href=\"http://stackoverflow.com/questions/37555614/memset-on-float-array-does-not-fully-zero-out-array#comment62600079_37555614\">@AlexD</a> comment, your code is using the size of a pointer and not the size of a <code>float</code>.  Using <code>arge_float_array = calloc(NUM, sizeof *large_float_array);</code> avoids that problem regardless what type <code>large_float_array</code> points to."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464729669, "post_id": 37555614, "comment_id": 62600460, "body": "There are 3 issues here: valid code, correct allocation and the question if <code>memset(some_float_ptr, 0,,...)</code> is as good as setting all <code>float</code> array elements to <code>0.0f</code>.  Until problem #1,#2 is fixed.  the 3rd issue is moot."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464729894, "post_id": 37555614, "comment_id": 62600556, "body": "If code wants to quickly zero fill a <code>float</code> array, use a loop.  If that is not fast enough, code could use a helper function that repeatedly calls <code>memcpy()</code> to fill the large array with any <code>float</code> constant."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464730173, "post_id": 37555614, "comment_id": 62600691, "body": "<code>memset(large_float_array, 0, sizeof(large_float_array);</code> (compiler error and wrong size) --&gt; <code>memset(large_float_array, 0, NUM * sizeof *large_float_array);</code>  Still better to use a loop."}], "answers": [{"tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": false, "score": 3, "last_activity_date": 1464730440, "last_edit_date": 1464730440, "creation_date": 1464729694, "answer_id": 37555852, "question_id": 37555614, "link": "https://stackoverflow.com/questions/37555614/memset-on-float-array-does-not-fully-zero-out-array/37555852#37555852", "title": "memset on float array does not fully zero out array", "body": "<p>The effect of intializing memory area by <code>calloc</code> and using <code>memset</code> function with <code>0</code> value is actually the same. In other words, <code>calloc</code> is no more \"type-wise\" than <code>memset</code>. They both just set memory with all bits zero*.</p>\n\n<p>C11 (N1570) 7.22.3.2/2 <em>The calloc function</em>:</p>\n\n<blockquote>\n  <p>The <code>calloc</code> function allocates space for an array of nmemb objects,\n  each of whose size is size. The space is initialized to all bits zero.<sup>296)</sup></p>\n</blockquote>\n\n<p>Footnote 296 (informative only):</p>\n\n<blockquote>\n  <p>Note that this need not be the same as the representation of\n  floating-point zero or a null pointer constant.</p>\n</blockquote>\n\n<hr>\n\n<p>*) It's conceivable that <code>calloc</code> could return address of memory location that is already pre-initialized with zeros,  thus it may be faster than <code>malloc + memset</code> combo.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1464730391, "post_id": 37555977, "comment_id": 62600782, "body": "You should use <code>size_t</code> instead of <code>int</code> for <code>i</code>, as <code>NUM</code> could be larger that <code>int</code>."}, {"owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1464730456, "post_id": 37555977, "comment_id": 62600802, "body": "@chqrlie does C have the <code>size_t</code> type?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1464730614, "post_id": 37555977, "comment_id": 62600865, "body": "Yes it does. It is defined in <code>&lt;stdlib.h&gt;</code> (among other places)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464732097, "post_id": 37555977, "comment_id": 62601444, "body": "Much better answer."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1552928137, "post_id": 37555977, "comment_id": 97187368, "body": "And to avoid some bugs caused by unsigned types, you may want to change to the non-C-Standard but POSIX-Standard <code>ssize_t</code> which is a signed <code>size_t</code> and is defined in <code>&lt;sys&#47;types.h&gt;</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1587558749, "post_id": 37555977, "comment_id": 108557212, "body": "@LibertyPaul: <i>You can&#39;t use <code>memset</code> because it accepts <code>int</code> as value type</i>. <code>memset</code> does take an <code>int</code> argument, but it only uses the value converted as an <code>unsigned char</code>. Using <code>memset</code> to set an array of <code>int</code> would pose a similar problem as for an array of <code>float</code>: it would be fine to set the elements to <code>0</code>, and some other very specific values, but inappropriate for the general case."}], "tags": [], "owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "is_accepted": false, "score": 7, "last_activity_date": 1572467471, "last_edit_date": 1572467471, "creation_date": 1464730308, "answer_id": 37555977, "question_id": 37555614, "link": "https://stackoverflow.com/questions/37555614/memset-on-float-array-does-not-fully-zero-out-array/37555977#37555977", "title": "memset on float array does not fully zero out array", "body": "<p>You can't use memset because it accepts <code>int</code> as value type, but float may be stored in different way, so you should use a regular cycle</p>\n\n<pre><code>for (size_t i = 0; i &lt; NUM; ++i) {\n    large_float_array[i] = 0.;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1616928985, "post_id": 37555983, "comment_id": 118151164, "body": "For those interested in the legality aspect of memset&#39;ing a float, <a href=\"https://stackoverflow.com/questions/4629853/is-it-legal-to-use-memset-0-on-an-array-of-doubles\">here&#39;s</a> the link for that."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 9, "last_activity_date": 1588466675, "last_edit_date": 1588466675, "creation_date": 1464730352, "answer_id": 37555983, "question_id": 37555614, "link": "https://stackoverflow.com/questions/37555614/memset-on-float-array-does-not-fully-zero-out-array/37555983#37555983", "title": "memset on float array does not fully zero out array", "body": "<p>Since <code>large_float_array</code> is a pointer, you cannot use <code>sizeof(large_float_array)</code> to specify the number of bytes to clear: <code>sizeof(large_float_array)</code> is just the size of the pointer, typically 4 or 8 bytes. To clear the whole array, you must write:</p>\n\n<pre><code>memset(large_float_array, 0, NUM * sizeof(float));\n</code></pre>\n\n<p>or </p>\n\n<pre><code>memset(large_float_array, 0, NUM * sizeof(*large_float_array));\n</code></pre>\n\n<p>Note that <code>memset</code> sets the memory to all bits zero. The C standard does not guarantee that all bits zero be a representation of <code>0.0</code>, But in all current architectures it is the case, so it will work as expected.</p>\n\n<p>The strictly conforming way to clear your array is this:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\n...\nfor (size_t i = 0; i &lt; NUM; i++) {\n    large_float_array[i] = 0;\n}\n</code></pre>\n\n<p>If the target systems represents <code>0.0</code> as all bits zero, modern compilers will optimize the above loop as a call to <code>memset</code> as can be verified with <a href=\"https://godbolt.org/z/iRyGB8\" rel=\"nofollow noreferrer\">Goldbolt's Compiler Explorer</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1464733495, "last_edit_date": 1464733495, "creation_date": 1464730705, "answer_id": 37556059, "question_id": 37555614, "link": "https://stackoverflow.com/questions/37555614/memset-on-float-array-does-not-fully-zero-out-array/37556059#37556059", "title": "memset on float array does not fully zero out array", "body": "<p>Post has multiple issues.</p>\n\n<p>Following does not have balanced <code>()</code>.  Unclear what OP's true code may be.</p>\n\n<pre><code>memset(large_float_array, 0, sizeof(large_float_array);\n</code></pre>\n\n<p>Assuming the above simple used another <code>)</code>, then code was only zero filling a few bytes with zero as <code>sizeof(large_float_array)</code> is the size of a pointer.</p>\n\n<pre><code>memset(large_float_array, 0, sizeof(large_float_array));\n</code></pre>\n\n<p>OP likely wanted something like which would zero fill the allocated space with zero bits.  This will bring the allocated memory into the same state as <code>calloc()</code>.</p>\n\n<pre><code>memset(large_float_array, 0, NUM *sizeof *large_float_array);\n</code></pre>\n\n<p>Code <em>should</em> use the following.  A good compiler will optimize this trivial loop into fast code.</p>\n\n<pre><code>for (size_t i=0; i&lt;NUM; i++) {\n  large_float_array[i] = 0.0f;\n}\n</code></pre>\n\n<hr>\n\n<p>A way to use the fast <code>memcpy()</code> is to copy the <code>float</code> into the first element of the array, then the first element to the 2nd element, then the first 2 elements to elements 3 &amp; 4, then the first 4 elements to elements 4,5,6,7 ...</p>\n\n<pre><code>void *memset_size(void *dest, size_t n, const char *src, size_t element) {\n  if (n &gt; 0 &amp;&amp; element &gt; 0) {\n    memcpy(dest, src, element);  // Copy first element\n    n *= element;\n    while (n &gt; element) {\n      size_t remaining = n - element;\n      size_t n_this_time = remaining &gt; element ? element : remaining;\n      memcpy((char*)dest + element, dest, n_this_time);\n      element += n_this_time;\n    }\n  }\n  return dest;\n}\n\nfloat pi = M_PI;\nfloat a[10000];\nmemset_size(a, 10000, &amp;pi, sizeof pi);\n</code></pre>\n\n<p>As with all optimizations, consider clearly written code first and then employ candidates such as the above in the select cases that warrant it.</p>\n"}], "owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12415, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1588466675, "creation_date": 1464728791, "question_id": 37555614, "link": "https://stackoverflow.com/questions/37555614/memset-on-float-array-does-not-fully-zero-out-array", "title": "memset on float array does not fully zero out array", "body": "<p>I have some array,</p>\n\n<pre><code>float *large_float_array;\n</code></pre>\n\n<p>that I calloc and attempt to memset after a loop</p>\n\n<pre><code>large_float_array = (float*)calloc(NUM, sizeof(float));\n\n// .. do stuff with float array\n\nmemset(large_float_array, 0, sizeof(large_float_array);\n\n// .. do other stuff\n</code></pre>\n\n<p>but it seems <code>large_float_array</code> is not actually zero'd out. Why is this? Is this due to the special properties of floating point numbers? If so, I'm wondering how I could fix this.</p>\n\n<p>P.S. does <code>calloc</code> actually work here too?</p>\n"}, {"tags": ["c", "io", "binary"], "comments": [{"owner": {"reputation": 777, "user_id": 6351637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cadf8318dd2fa53fc88c9adaa5b3e07b?s=128&d=identicon&r=PG&f=1", "display_name": "s7amuser", "link": "https://stackoverflow.com/users/6351637/s7amuser"}, "edited": false, "score": 1, "creation_date": 1464729356, "post_id": 37555594, "comment_id": 62600304, "body": "What is showing on the console after you run your program? Are you sure <code>fopen</code> does not fail and return <code>NULL</code>?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1464729473, "post_id": 37555594, "comment_id": 62600363, "body": "Is your program trying to read itself?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3646905"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1464729512, "post_id": 37555594, "comment_id": 62600380, "body": "@purplepsycho No, It&#39;s going to read re.exe."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3646905"}, "reply_to_user": {"reputation": 777, "user_id": 6351637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cadf8318dd2fa53fc88c9adaa5b3e07b?s=128&d=identicon&r=PG&f=1", "display_name": "s7amuser", "link": "https://stackoverflow.com/users/6351637/s7amuser"}, "edited": false, "score": 0, "creation_date": 1464729563, "post_id": 37555594, "comment_id": 62600408, "body": "@s7amuser After running the program, It shows 4d5affffff90000300000004000000 in the console."}, {"owner": {"reputation": 777, "user_id": 6351637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cadf8318dd2fa53fc88c9adaa5b3e07b?s=128&d=identicon&r=PG&f=1", "display_name": "s7amuser", "link": "https://stackoverflow.com/users/6351637/s7amuser"}, "edited": false, "score": 1, "creation_date": 1464729753, "post_id": 37555594, "comment_id": 62600499, "body": "Why do you think it is not OK? Maybe these are the contents of the <code>re.exe</code> file. Use <code>printf(&quot;%02x &quot;, ch);</code> to see the individual bytes. Also, you can use <a href=\"http://linux.about.com/library/cmd/blcmdl1_hexdump.htm\" rel=\"nofollow noreferrer\">hexdump</a> or <a href=\"http://linux.die.net/man/1/xxd\" rel=\"nofollow noreferrer\">xxd</a> to dump the contents of the file and compare to what your program is printing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3646905"}, "edited": false, "score": 0, "creation_date": 1464730051, "post_id": 37555594, "comment_id": 62600636, "body": "re.exe is a 20kb file. I think it&#39;s content must be more than what my program shows."}, {"owner": {"reputation": 777, "user_id": 6351637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cadf8318dd2fa53fc88c9adaa5b3e07b?s=128&d=identicon&r=PG&f=1", "display_name": "s7amuser", "link": "https://stackoverflow.com/users/6351637/s7amuser"}, "edited": false, "score": 0, "creation_date": 1464730859, "post_id": 37555594, "comment_id": 62600964, "body": "So the problem might be that you implicitly cast the return value of <code>fgetc</code> to a <code>char</code>. Try defining <code>ch</code> as an <code>int</code> instead."}, {"owner": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "reply_to_user": {"reputation": 777, "user_id": 6351637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cadf8318dd2fa53fc88c9adaa5b3e07b?s=128&d=identicon&r=PG&f=1", "display_name": "s7amuser", "link": "https://stackoverflow.com/users/6351637/s7amuser"}, "edited": false, "score": 0, "creation_date": 1464732358, "post_id": 37555594, "comment_id": 62601526, "body": "@s7amuser post that as answer"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1464733173, "post_id": 37555594, "comment_id": 62601798, "body": "Read: <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/io/fgetc</a> Look at the return value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3646905"}, "edited": false, "score": 0, "creation_date": 1464733463, "post_id": 37555594, "comment_id": 62601907, "body": "Okay thank you. It works now."}], "answers": [{"tags": [], "owner": {"reputation": 777, "user_id": 6351637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cadf8318dd2fa53fc88c9adaa5b3e07b?s=128&d=identicon&r=PG&f=1", "display_name": "s7amuser", "link": "https://stackoverflow.com/users/6351637/s7amuser"}, "is_accepted": true, "score": 3, "last_activity_date": 1464780112, "last_edit_date": 1464780112, "creation_date": 1464779498, "answer_id": 37567006, "question_id": 37555594, "link": "https://stackoverflow.com/questions/37555594/read-a-file-in-binary-mode-with-c/37567006#37567006", "title": "Read a file in binary mode with c", "body": "<p>The problem is the implicit casting of the return value of <a href=\"http://www.cplusplus.com/reference/cstdio/fgetc/\" rel=\"nofollow\"><code>fgetc</code></a> from <code>int</code> to <code>char</code>.</p>\n\n<p>Since <code>EOF</code> is defined as <code>(-1)</code> (at least in <a href=\"https://sourceware.org/git/?p=glibc.git;f=libio/stdio.h;hb=HEAD#l136\" rel=\"nofollow\">glibc</a>), the returned <code>char</code> (which is by default signed in GCC) is converted to an <code>int</code> (with sign extension) as specified in section 6.3.1.8 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow\">C99 standard</a>:</p>\n\n<blockquote>\n  <p>If both operands have the same type, then no further conversion is needed.</p>\n  \n  <p>Otherwise, if both operands have signed integer types or both have unsigned\n    integer types, the operand with the type of lesser integer conversion rank   is converted to the type of the operand with greater rank.</p>\n</blockquote>\n\n<p>As a result, the character <code>0xff</code> is converted to <code>0xffffffff</code> and is actually equal to the value of <code>EOF</code> which causes the loop to end prematurely before reading all the file.</p>\n\n<p>In addition, when printing the character with <code>printf(\"%x\", ch)</code> or <code>printf(\"%02x\", ch)</code>, the character is again converted to an <code>int</code> (see <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow\">here</a>) and thus you can see for example the output <code>0xffffff90</code> for the character <code>0x90</code>.</p>\n\n<p>In summary, the solution is defining <code>ch</code> to be an <code>int</code> instead of a <code>char</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3646905"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 37567006, "answer_count": 1, "score": 2, "last_activity_date": 1464780112, "creation_date": 1464728718, "last_edit_date": 1464733220, "question_id": 37555594, "link": "https://stackoverflow.com/questions/37555594/read-a-file-in-binary-mode-with-c", "title": "Read a file in binary mode with c", "body": "<p>I have an executable file called re.exe, I want to read its content in the binary form and then show that content in the console. I write the following code but it doesn't show the content of the binary file in the console. What's the problem?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nvoid readFile(const char *fileName) {\n    FILE *file;\n    file = fopen(fileName, \"rb\");\n    if (file != NULL) {\n        char ch;\n        while ((ch = fgetc(file)) != EOF) {\n            if (isprint(ch)) {\n                printf(\"%x\", ch);\n            }\n            else {\n                printf(\"%02x\", ch);\n                if (ch == '\\n') {\n                    fputs(\"\\n\", stdout);\n                }\n            }\n        }\n     fclose(file);\n    }\n}\n\nint main() {\n\n    readFile(\"re.exe\");\n\n    return 0x0;\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "compiler-optimization", "instruction-set"], "comments": [{"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1464728729, "post_id": 37555550, "comment_id": 62600021, "body": "Readability is high? Readability is so high that pre/post increment/decrement have been removed from Swift3. I&#39;d try memcpy or memmove."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1464729393, "post_id": 37555550, "comment_id": 62600326, "body": "I personally have no problem with pre/post increment. memcpy/memmove is not an option: He is not copying, he is adding values (<code>+=</code> instead of <code>=</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1464729210, "creation_date": 1464729210, "answer_id": 37555723, "question_id": 37555550, "link": "https://stackoverflow.com/questions/37555550/how-to-write-loop-in-c-so-compiler-may-use-branch-on-zero-after-decrement/37555723#37555723", "title": "How to write loop in C so compiler may use branch on zero after decrement", "body": "<p>What about this:</p>\n\n<pre><code>do\n{\n    a[ctr] += b[ctr];\n}\nwhile(--ctr);\n</code></pre>\n\n<p>You'd need an additional check, however:</p>\n\n<pre><code>if(n != 0)\n{\n    /*...*/\n}\n</code></pre>\n\n<p>if you cannot guarantee this by other means...</p>\n\n<p>Oh, and be aware that ctr has different final values depending on which loop variant you select (0 in mine and your second one, ~0 in your first)...</p>\n"}, {"comments": [{"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1464797356, "post_id": 37556135, "comment_id": 62634717, "body": "How do those manage n=0? Your answer gave more ideas. I had the idea before the conditional branch was always at the beginning of the loop. Now I&#39;m not so sure... Having a conditional looking for zero before the loop and the have condition branch checking if it should be run again might be more useful depending on if there is a branch predictor common loop size and how many instructions are fetched at a time. Ugh, I start regretting asking the question in the first place. So much to consider."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 1, "creation_date": 1464988885, "post_id": 37556135, "comment_id": 62729714, "body": "Back in the day, when dec/bnz was new and cool, and data buses were 16 bits wide, max, there were a lot of compilers that generated loops that basically started with a &quot;jump to bottom&quot;, then the bottom of the loop had a <code>decrement-branch-not-zero to top</code> opcode. (This was before cache misses became the dominant factor in code generation.) Essentially, a do-while loop was the &quot;natural&quot; form, and while and for loops were &quot;do while&quot; loops with a jump-to-bottom at the top. :-)"}], "tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 2, "last_activity_date": 1464731088, "creation_date": 1464731088, "answer_id": 37556135, "question_id": 37555550, "link": "https://stackoverflow.com/questions/37555550/how-to-write-loop-in-c-so-compiler-may-use-branch-on-zero-after-decrement/37556135#37556135", "title": "How to write loop in C so compiler may use branch on zero after decrement", "body": "<p>This is going to depend on the efforts of the optimization writers of your compiler.</p>\n\n<p>For instance, a <code>bdz</code> opcode could be used at the bottom of a loop to \"jump over\" a different jump that returned to the top. (This would be a bad idea, but it could happen.)</p>\n\n<pre><code>loop:\n     blah\n     blah\n\n     bdz  ... out\n     b loop\nout: \n</code></pre>\n\n<p>Far more likely would be to decrement and branch if NOT zero, which the PPC also supports.</p>\n\n<pre><code>loop:\n    blah\n    blah\n\n    bdnz ... loop\n\nfallthru:\n</code></pre>\n\n<p>Unless you have a compelling reason to try to game the opcodes, I'd suggest that you try to write clean, readable code that minimizes side effects. Your own change from post-decrement to pre-decrement is a good example of that-- one less (un-used) side effect for the compiler to worry about.</p>\n\n<p>That way, you'll get the most bang for your optimizing buck. If there's a platform that needs a special version of your code, you can <code>#ifdef</code> the whole thing, and either include inline assembly, or rewrite the code in conjunction with reading the assembly output and running the profiler.</p>\n"}, {"comments": [{"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1464796959, "post_id": 37556860, "comment_id": 62634496, "body": "Does all examples generate the same assembly? Because that would be really cool. Btw while(--len) have to watch out for starting with zero."}, {"owner": {"reputation": 458, "user_id": 2598455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10292c97171ec40cfe485635be47a22?s=128&d=identicon&r=PG", "display_name": "Artur Kink", "link": "https://stackoverflow.com/users/2598455/artur-kink"}, "reply_to_user": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1464987257, "post_id": 37556860, "comment_id": 62729083, "body": "No the code is slightly different, but overall pretty similar. Completely identical code would be impressive lol."}], "tags": [], "owner": {"reputation": 458, "user_id": 2598455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10292c97171ec40cfe485635be47a22?s=128&d=identicon&r=PG", "display_name": "Artur Kink", "link": "https://stackoverflow.com/users/2598455/artur-kink"}, "is_accepted": false, "score": 2, "last_activity_date": 1464734705, "creation_date": 1464734705, "answer_id": 37556860, "question_id": 37555550, "link": "https://stackoverflow.com/questions/37555550/how-to-write-loop-in-c-so-compiler-may-use-branch-on-zero-after-decrement/37556860#37556860", "title": "How to write loop in C so compiler may use branch on zero after decrement", "body": "<p>Definitely depends on the compiler, but it's an instruction that is great for performance, so I'd expect compilers to try and maximize its usage.</p>\n\n<p>Since you're linking an AIX reference, I'm assuming you're running xlc. I don't have access to an AIX machine but I do have access to xlc on a Z machine.\nThe equivalent Z counterpart is the Branch On Count (BCTR) instruction.</p>\n\n<p>I tried 5 examples and checked the listings</p>\n\n<pre><code>int len = strlen(argv[1]);\n//Loop header\nargv[1][counter] += argv[2][counter];\n</code></pre>\n\n<p>With the following loop headers:</p>\n\n<pre><code>for (int i = 0; i &lt; len; i++)\nfor (int i = len-1; i &gt;= 0; i--)\nwhile(--len)\nwhile(len--)\nwhile(len){\n   len--;\n</code></pre>\n\n<p>All 5 examples use branch on count at -O1 and higher, and none of them use it at opt 0.</p>\n\n<p>I'd trust a modern compiler to be able to find branch on zero opportunities with any standard loop structure.</p>\n"}], "owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1464799908, "creation_date": 1464728551, "last_edit_date": 1464799908, "question_id": 37555550, "link": "https://stackoverflow.com/questions/37555550/how-to-write-loop-in-c-so-compiler-may-use-branch-on-zero-after-decrement", "title": "How to write loop in C so compiler may use branch on zero after decrement", "body": "<p>Processors are known to have special instructions for decrementing a counter and branch if the counter is zero with very low latency as the branch instruction does not need to wait for the counter decrement passing through an integer unit.</p>\n\n<p>Here is a link to the ppc instruction: </p>\n\n<p><a href=\"https://www.ibm.com/support/knowledgecenter/ssw_aix_53/com.ibm.aix.aixassem/doc/alangref/bc.htm\" rel=\"nofollow\">https://www.ibm.com/support/knowledgecenter/ssw_aix_53/com.ibm.aix.aixassem/doc/alangref/bc.htm</a></p>\n\n<p>My usual way of doing what I believe triggers a compiler to generate the appropriate instructions is as follows:</p>\n\n<pre><code>unsigned int ctr = n;\nwhile(ctr--)\n  a[ctr] += b[ctr];\n</code></pre>\n\n<p>Readability is high and it is a decrementing loop branching on zero. As you see the branch technically occurs if counter is zero before decrement. I was hoping the compiler could do some magic and make it work anyway. Q: Would a compiler have to break any fundamental rules of C in order to mangle it to special decrement and branch conditional instructions (if any)?</p>\n\n<p>Another approach:</p>\n\n<pre><code>unsigned int ctr = n+1;\nwhile(--ctr) {\n  a[ctr-1] += b[ctr-1];\n}\n</code></pre>\n\n<p>The branch now happen after decrement but there are constants roaming making ugly code. An \"index\" variable being one less than counter would make it look a little prettier I guess. Looking at available ppc instructions the extra calculation in finding the a and b adress can still fit single instruction as load may also perform adress arithmetic (add). Not so sure about other instruction sets. My main problem though is if n+1 is larger than an max. Q: Will the decrement pull it back to max and loop as usual?</p>\n\n<p>Q: Is there a more commonly used pattern in C for allowing the common instruction?</p>\n\n<hr>\n\n<p>Edit: ARM has a decrement and branch operation but branches only if value is NOT zero. There appears to be an extra condition just like the ppc bc. As I see it it is from C point of view it is very much the same thing so I expect a code snippet to be compilable to that form too without any C standard violation. <a href=\"http://www.heyrick.co.uk/armwiki/Conditional_execution\" rel=\"nofollow\">http://www.heyrick.co.uk/armwiki/Conditional_execution</a></p>\n\n<hr>\n\n<p>Edit: Intel has virtually the same branching instruction as ARM: <a href=\"http://cse.unl.edu/~goddard/Courses/CSCE351/IntelArchitecture/InstructionSetSummary.pdf\" rel=\"nofollow\">http://cse.unl.edu/~goddard/Courses/CSCE351/IntelArchitecture/InstructionSetSummary.pdf</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 4, "creation_date": 1464728950, "post_id": 37555544, "comment_id": 62600131, "body": "sizeof does not do what you think it does (it does not tell you the size in memory of a string).  You probably want strlen."}, {"owner": {"reputation": 25, "user_id": 6405870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bf9a75977f9965bfc401bad8dc9ebf?s=128&d=identicon&r=PG&f=1", "display_name": "saar", "link": "https://stackoverflow.com/users/6405870/saar"}, "reply_to_user": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1464734418, "post_id": 37555544, "comment_id": 62602198, "body": "Oh I&#39;m so stupid, Thank you! you very helped me and now the program is better and doing almost all but there is a little bug already (triggered a breakpoint) and now its on the realloc line:                                                                    if (!(results = (char**)realloc(results, sizeof(results) + sizeof(char*))))"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464743239, "post_id": 37555544, "comment_id": 62604281, "body": "you really need to improve your error handling instead of having all that code duplication - makes the code hard to follow"}, {"owner": {"reputation": 25, "user_id": 6405870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bf9a75977f9965bfc401bad8dc9ebf?s=128&d=identicon&r=PG&f=1", "display_name": "saar", "link": "https://stackoverflow.com/users/6405870/saar"}, "edited": false, "score": 0, "creation_date": 1464788605, "post_id": 37555544, "comment_id": 62628242, "body": "Just ignore it when you see return -1"}, {"owner": {"reputation": 25, "user_id": 6405870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bf9a75977f9965bfc401bad8dc9ebf?s=128&d=identicon&r=PG&f=1", "display_name": "saar", "link": "https://stackoverflow.com/users/6405870/saar"}, "edited": false, "score": 0, "creation_date": 1464788643, "post_id": 37555544, "comment_id": 62628271, "body": "But do you know what&#39;s my problem now?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1464790784, "post_id": 37555544, "comment_id": 62630067, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}, {"owner": {"reputation": 25, "user_id": 6405870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bf9a75977f9965bfc401bad8dc9ebf?s=128&d=identicon&r=PG&f=1", "display_name": "saar", "link": "https://stackoverflow.com/users/6405870/saar"}, "edited": false, "score": 0, "creation_date": 1464801691, "post_id": 37555544, "comment_id": 62637330, "body": "Why not? And I don&#39;t think that that&#39;s my problem (because it works in other codes)"}], "answers": [{"tags": [], "owner": {"reputation": 49428, "user_id": 6210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14994f4fef70636139dfeaf97dca2ef8?s=128&d=identicon&r=PG", "display_name": "MSN", "link": "https://stackoverflow.com/users/6210/msn"}, "is_accepted": true, "score": 1, "last_activity_date": 1464829885, "creation_date": 1464829885, "answer_id": 37581141, "question_id": 37555544, "link": "https://stackoverflow.com/questions/37555544/anti-virus-exe-has-triggered-a-breakpoint-c-language/37581141#37581141", "title": "Anti_Virus.exe has triggered a breakpoint. C language", "body": "<p>This line:</p>\n\n<pre><code>        if (!(results = (char**)realloc(results, sizeof(results) + sizeof(char*))))\n</code></pre>\n\n<p>Is not increasing the size of <code>results</code> (and therefore you are stomping over the end of it as <code>result_len</code> increases). You probably want to use <code>(result_len + 1)*sizeof(char*)</code>, since you are already storing the number of strings in <code>results</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 6405870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bf9a75977f9965bfc401bad8dc9ebf?s=128&d=identicon&r=PG&f=1", "display_name": "saar", "link": "https://stackoverflow.com/users/6405870/saar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "accepted_answer_id": 37581141, "answer_count": 1, "score": 0, "last_activity_date": 1464829885, "creation_date": 1464728538, "last_edit_date": 1464801786, "question_id": 37555544, "link": "https://stackoverflow.com/questions/37555544/anti-virus-exe-has-triggered-a-breakpoint-c-language", "title": "Anti_Virus.exe has triggered a breakpoint. C language", "body": "<p>I wrote an \"Anti Virus\" (not a real one - just to learn) which uses the heap and sometimes when it needs to use the heap it's break with the message on the topic then it gives me the message:\n\"Debug Assertion Failed\"\nand:\n\"expression: _crtisvalidheappointer(puserdata)\"\nand i realy don't know why...\nIn the code it's happen in the function run when the while loop is on his 5th iteration in this line:</p>\n\n<pre><code>if (!(results = (char**)realloc(results, sizeof(results) + sizeof(char*))))\n</code></pre>\n\n<p>The function:</p>\n\n<pre><code>void run(char* dir_path, char* virus_path, char mode)\n{\n    DIR* dir = NULL;\n    FILE* virus = NULL;\n    struct dirent* cur_file;  // cur_file is a pointer for struct dirent which represnts the file we are checking now (current file)\n    char** results = NULL;  // resullts will be an array of strings to write in the log\n    int results_len = 0, i = 0;\n    char* file_path = NULL;\n\n    //checks the arguments:\n    if (!(dir = opendir(dir_path)))  // argv[1] should be the directory\n    {\n        printf(\"The path that given as the first argument doesn't point to a directory / \");\n        printf(\"an error has occurred while opening the directory\\n\");\n        return -1;\n    }\n    if (!(virus = fopen(virus_path, \"rb\")))\n    {\n        printf(\"The path that given as the second argument doesn't point to a file / \");\n        printf(\"an error has occurred while opening the file\\n\");\n        closedir(dir);\n        return -1;\n    }\n\n    //running on the file in the directory:\n    while (cur_file = readdir(dir))  // at the end of the directory readdir() will return NULL\n    {\n        if (!(strcmp(cur_file-&gt;d_name, \".\")))  // at the first time wer'e reading from a directory the value of d_name will be \".\"\n        {\n            continue;\n        }\n        if (!(strcmp(cur_file-&gt;d_name, \"..\"))) //at the second time wer'e reading from a directory the value of d_name will be \"..\"\n        {\n            continue;\n        }\n\n        if (!(file_path = (char*)malloc(strlen(dir_path) + cur_file-&gt;d_namlen + 2))) //1 for \\ between dir_path and d_name and 1 for the NULL\n        {\n            closedir(dir);\n            fclose(virus);\n            return -1;\n        }\n        strcpy(file_path, dir_path);\n        strcat(file_path, \"\\\\\");\n        strcat(file_path, cur_file-&gt;d_name);\n        if (!(results)) // if results == NULL -&gt; if didn't allocated memory for results already\n        {\n            if (!(results = (char**)malloc(sizeof(char*))))\n            {\n                printf(\"Problem with malloc\\n\");\n                free(file_path);\n                closedir(dir);\n                fclose(virus);\n                return -1;\n            }\n        }\n        else\n        {\n            if (!(results = (char**)realloc(results, sizeof(results) + sizeof(char*))))\n            {\n                printf(\"Problem with realloc\\n\");\n                for (i = 0; i &lt; results_len; i++)\n                {\n                    free(results[i]);\n                }\n                free(file_path);\n                free(results);\n                closedir(dir);\n                fclose(virus);\n                return -1;\n            }\n        }    \n        results[results_len] = check_file(file_path, virus, mode);\n        if(results[results_len] == -1) // results_len will be updated later (just malloced)\n        {\n            for (i = 0; i &lt; results_len; i++)\n            {\n                free(results[i]);\n            }\n            free(file_path);\n            free(results);\n            closedir(dir);\n            fclose(virus);\n            return -1;\n        }\n        results_len++;\n        free(file_path);\n    }\n    fclose(virus);\n    closedir(dir);\n    write_to_log(dir_path, virus_path, mode, results, results_len);\n}\n</code></pre>\n\n<p>and the function check_file returns a char* (string) which malloced in check_file and will be free in other function.</p>\n\n<p>Does someone knows the reason? Thank You</p>\n"}, {"tags": ["c", "arrays", "pointers", "malloc", "dynamic-allocation"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1464729862, "post_id": 37555536, "comment_id": 62600545, "body": "Variation 2 makes no sense. You are not using the value of parameter passed to the function, you are just assigning a new value to it right away. There are no &quot;in-out parameters&quot; in C by the way. You can pass a pointer to emulate pass-by-reference, but that&#39;s not what&#39;s going on in Version 2, and you don&#39;t need it anyway. Just use version 1."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1464731223, "post_id": 37555536, "comment_id": 62601128, "body": "There is no 2D array in the code shown and nothing which can point to one. A pointer is not an array!"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1464736103, "post_id": 37555536, "comment_id": 62602682, "body": "<code>int **a</code> is not a 2D its a pointer lookup table."}, {"owner": {"reputation": 1, "user_id": 6405596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06379529644c871664da707220a14249?s=128&d=identicon&r=PG&f=1", "display_name": "d0rz", "link": "https://stackoverflow.com/users/6405596/d0rz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1464738251, "post_id": 37555536, "comment_id": 62603185, "body": "Sorry, poor wording. I referred to them as 2D arrays because they&#39;re allocated to be indexed as such.  And thanks, @n.m."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464748105, "post_id": 37555536, "comment_id": 62605373, "body": "I&#39;m so sick of pedants who don&#39;t understand what &quot;array&quot; means in programming, or wilfully pretend not to"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1464731313, "post_id": 37555777, "comment_id": 62601167, "body": "This is so very wrong! I don&#39;t even mean the practical problem with allocating a large array on the stack, or the unnecessary, thus potentially dangerous cast. Or assigning a pointer to an array."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1464735931, "post_id": 37555777, "comment_id": 62602635, "body": "Yeh. When you wrote &quot;Why bother with pointers?&quot; did you intend to imply that your example below <i>doesn&#39;t</i> use pointers? I suppose <code>calloc</code> returns <i>burgers</i> instead? Did you mean <code>p2a</code> to be a pneumonic for &quot;pointer to array&quot;? Because it isn&#39;t; what you have declared is an <i>array of pointers</i>... Please learn C before you attempt to teach it. Perhaps you meant <code>int (*p2a)[15]</code>..."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1464736576, "post_id": 37555777, "comment_id": 62602790, "body": "@Seb I think what you meant to say was &quot;Hey, you forgot a pair of parens.&quot; Thanks for that. Fixed. As for the why bother with pointers, better to let the compiler do simple math than have add a layer of extra pointers to indirect through. :-)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1464748167, "post_id": 37555777, "comment_id": 62605389, "body": "This code is incorrect if used with OP&#39;s <code>create_array_2</code>.  If you actually meant to use a different allocation function then you should show that in your answer"}], "tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": -2, "last_activity_date": 1464736422, "last_edit_date": 1592644375, "creation_date": 1464729437, "answer_id": 37555777, "question_id": 37555536, "link": "https://stackoverflow.com/questions/37555536/functions-for-dynamically-allocating-an-array-in-c-any-difference-between-the/37555777#37555777", "title": "Functions for dynamically allocating an array in C -- Any difference between the two?", "body": "<p>IMO, of the two you are better off simply returning the value. This way there's a pure and solid wall between you and the caller.</p>\n<blockquote>\n<p>&quot;Give me some stuff!&quot;</p>\n<p>&quot;Okay, here's some stuff.&quot;</p>\n</blockquote>\n<p>On the other hand, for actually allocating an array of fixed size, why bother with pointers? Why not declare your return type so as to be castable to a sized array?</p>\n<pre><code>int (*p2a)[15] = (int(*)[15])create_array_2(15, 15);\n</code></pre>\n<p>Then you would <code>calloc(15*15,sizeof(int))</code> and be done.</p>\n"}, {"comments": [{"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1464735379, "post_id": 37556327, "comment_id": 62602486, "body": "Which part of any C standard requires a &quot;kernel&quot; for implementations, or that the kernel be &quot;disturbed&quot; by malloc?"}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 0, "last_activity_date": 1464735937, "last_edit_date": 1464735937, "creation_date": 1464731975, "answer_id": 37556327, "question_id": 37555536, "link": "https://stackoverflow.com/questions/37555536/functions-for-dynamically-allocating-an-array-in-c-any-difference-between-the/37556327#37556327", "title": "Functions for dynamically allocating an array in C -- Any difference between the two?", "body": "<p>I'll probably try to avoid calling <code>malloc</code> and <code>free</code> to many times so this kind of approach is what I'll do:</p>\n\n<p>Example 1:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint *foo(size_t row, size_t col);\n\nint main(void){\n    int *arr;\n    unsigned int row, col, k;\n\n    printf(\"Give the ROW: \");\n    if ( scanf(\"%u\",&amp;row) != 1){\n        printf(\"Error, scanf ROW\\n\");\n        exit(1);\n    }\n\n    printf(\"Give the COL: \");\n    if ( scanf(\"%u\",&amp;col) != 1){\n        printf(\"Error, scanf COL\\n\");\n        exit(2);\n    }\n\n    arr = foo(row, col);\n    for (k = 0 ; k &lt; (row * col) ; k++){\n        printf(\"%d \",arr[k]);\n    }\n\n    free(arr);\n}\n\nint *foo(size_t row, size_t col){\n    unsigned int i, j;\n    int *arr = malloc(sizeof *arr * row * col);\n    int l = 0;\n\n    if(arr == NULL){\n        printf(\"Error, malloc\\n\");\n        exit(3);\n    }\n\n    for ( i = 0; i &lt; row ; i++){\n        for ( j = 0 ; j &lt; col ; j++){\n            arr[i * col + j] = l;\n            l++;\n        }\n    }\n\n    return arr;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Give the ROW: 6\nGive the COL: 3\n0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17\n</code></pre>\n\n<p>Example 2 (if you are working with the standard C):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint (*foo(size_t row, size_t col))[];\n\nint main(void){\n    size_t row, col;\n\n\n    printf(\"Give the ROW: \");\n    if ( scanf(\"%zu\",&amp;row) != 1){\n        printf(\"Error, scanf ROW\\n\");\n        exit(1);\n    }\n\n    printf(\"Give the COL: \");\n    if ( scanf(\"%zu\",&amp;col) != 1){\n        printf(\"Error, scanf COL\\n\");\n        exit(2);\n    }\n\n    int (*arr)[col] = foo(row, col);\n\n    for ( size_t i = 0; i &lt; row; i++){\n        for( size_t j = 0; j &lt; col; j++){\n            printf(\"%d \",*(*(arr+i)+j));\n        }\n    }\n\n    free(arr);\n}\n\nint (*foo(size_t row, size_t col))[]{\n    int (*arr)[col] = malloc(row * col * sizeof(int));\n    int l=0;\n\n    if (arr == NULL){\n        printf(\"Error, malloc\\n\");\n        exit(3);\n    }\n\n    for ( size_t i = 0; i &lt; row; i++){\n        for( size_t j = 0; j &lt; col; j++){\n            *(*(arr+i)+j) = l;\n            l++;\n        }\n    }\n\n    return arr;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Give the ROW: 6\nGive the COL: 3\n0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17\n</code></pre>\n\n<p>The whole point here is that the call of <code>malloc</code> and <code>free</code> in both examples takes place only one time</p>\n"}], "owner": {"reputation": 1, "user_id": 6405596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06379529644c871664da707220a14249?s=128&d=identicon&r=PG&f=1", "display_name": "d0rz", "link": "https://stackoverflow.com/users/6405596/d0rz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1464736422, "creation_date": 1464728499, "last_edit_date": 1464735987, "question_id": 37555536, "link": "https://stackoverflow.com/questions/37555536/functions-for-dynamically-allocating-an-array-in-c-any-difference-between-the", "title": "Functions for dynamically allocating an array in C -- Any difference between the two?", "body": "<p>Suppose you have a function in C that accepts the dimensions for a 2d array (for simplicity's sake, say for a square nxn array), dynamically allocates the array, then returns it. </p>\n\n<p>I'm aware allocating memory here might be considered somewhat bad practice to begin with, since it will need to be freed elsewhere, but suppose that's not a huge issue. I'm wondering if there's any advantages/disadvantages associated with these two variations of said function:</p>\n\n<p>Variation 1 - Locally define int** variable in function, allocate/return array:</p>\n\n<pre><code>int **create_array(int n) {\n    // define array pointer, allocate array...\n    int **a_ = (int**)calloc(n,sizeof(int*));\n    for (int i = 0; i &lt; n; i++) \n        a_[i] = (int*)calloc(n,sizeof(int));\n    return a_;\n}\n\nint main() {\n    int n = 3;\n    int **array2d = create_array(n)\n    printf(\"First element: %d%c\",array2d[0][0],'\\n');\n    // do stuff... etc...\n}\n</code></pre>\n\n<p>Variation 2 - Add in-out int** parameter to function, allocate/return array:</p>\n\n<pre><code>int **create_array_2(int **a_, int n) {\n    // allocate array...\n    a_ = (int**)calloc(n,sizeof(int*));\n    for (int i = 0; i &lt; n; i++) \n        a_[i] = (int*)calloc(n,sizeof(int));\n    return a_;\n}\n\nint main() {\n    int n = 3;\n    int **array2d;\n    array2d = create_array_2(array2d,n);\n    printf(\"First element: %d%c\",array2d[0][0],'\\n');\n    // do other stuff... etc...\n}\n</code></pre>\n\n<p>Obviously they return the same result and achieve the same task, but is one considered to be safer/more efficient/better practice than the other? In my opinion the 2nd variation just makes things look a bit redundant, but I'm curious if there's any real differences between the two and what happens on the stack/heap when they're called. Hopefully this isn't a dumb question; it's just something I've been curious about. If anyone has insight to share, I'd appreciate it.</p>\n"}, {"tags": ["c", "sockets", "struct", "tcp"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1464727814, "post_id": 37555304, "comment_id": 62599548, "body": "&quot;i can not put it in de .h file&quot;. Well that is the exact problem. <code>connmgr.c</code> needs to know the full definition of <code>struct tcpsock</code>. If it is not in a header file that it includes then it needs to be in the C file itself (the latter is a bad idea as it would have the struct defn in two places). Does <code>connmgr</code> need to access the internals of the struct? If it does then you can&#39;t arrange the code as you have it now. If it doesn&#39;t then the array should store pointers to the struct rather than the structs themselves (it is ok to declare pointers to incomplete types)."}, {"owner": {"reputation": 43, "user_id": 5798772, "user_type": "registered", "profile_image": "https://graph.facebook.com/1270657406294116/picture?type=large", "display_name": "Gus Vanherf", "link": "https://stackoverflow.com/users/5798772/gus-vanherf"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464728048, "post_id": 37555304, "comment_id": 62599674, "body": "No, the connmgr can not have access to the internals, that&#39;s why it is in the tcpsock.c . Okay I see what you mean, and how do i exactly store these pointers in code?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464728407, "post_id": 37555304, "comment_id": 62599866, "body": "<code>tcpsock_t **client; client = malloc(MAX_CLIENTS * sizeof(tcpsock_t *)); client[conn_counter] = requestclient;</code>"}, {"owner": {"reputation": 43, "user_id": 5798772, "user_type": "registered", "profile_image": "https://graph.facebook.com/1270657406294116/picture?type=large", "display_name": "Gus Vanherf", "link": "https://stackoverflow.com/users/5798772/gus-vanherf"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1464728760, "post_id": 37555304, "comment_id": 62600032, "body": "Thank you so much, this fixed it!"}], "owner": {"reputation": 43, "user_id": 5798772, "user_type": "registered", "profile_image": "https://graph.facebook.com/1270657406294116/picture?type=large", "display_name": "Gus Vanherf", "link": "https://stackoverflow.com/users/5798772/gus-vanherf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464727521, "creation_date": 1464727521, "question_id": 37555304, "link": "https://stackoverflow.com/questions/37555304/an-array-of-structs-defined-in-other-source-file", "title": "An array of structs defined in other source file", "body": "<p>For a school project i made this program where clients (a tcpsock_t) can make a TCP connection with a server and pass data through it. I poll the different connections to see if there is data to read. </p>\n\n<p>I got a tcpsock.c with functions for the TCP sockets which is used as library, a connmgr.c as server and a client code (which is not relevant). </p>\n\n<p>In the tcpsock.h i typedef the struct of the tcpsock_t\n(other functions below)</p>\n\n<pre><code>typedef struct tcpsock tcpsock_t;\n</code></pre>\n\n<p>and in the tcpsock.c i declare the struct (and it should stay here, i can not put it in de .h file)</p>\n\n<pre><code>struct tcpsock{\n long cookie;\n int sd;\n char * ip_addr;\n int port;\n };\n</code></pre>\n\n<p>In the connmgr.c i want to make an array of this tcpsock_t to store all my connected clients, but when i compile it gives always the same sort of errors:</p>\n\n<blockquote>\n  <p>error: invalid use of undefined type \u2018struct tcpsock\u2019\n       client[conn_counter] = *requestclient;</p>\n</blockquote>\n\n<p>Can someone tell me what i'm doing wrong?</p>\n\n<p>Thanks a lot!</p>\n\n<p>Here is my server code :</p>\n\n<pre><code>#include \"tcpsock.h\" \n#include \"connmgr.h\"       \nint conn_counter = 0;\n\n    void add_client(tcpsock_t *newclient, tcpsock_t * array){\n        conn_counter++;\n        array= realloc(test,sizeof(get_size_tcpsock())*conn_counter);\n        array[conn_counter-1]=*newclient; //here i have the error\n\n    }\n\n    void add_poll(struct pollfd * polllist, tcpsock_t *client, tcpsock_t *server){\n        polllist = realloc(polllist,sizeof(struct pollfd)*conn_counter+1);\n        int clientsd;\n        tcp_get_sd(server, &amp;clientsd);\n        polllist[conn_counter].fd= clientsd;\n        polllist[conn_counter].events = POLLIN;\n\n    }\n\n\n    int main(void){\n\n        tcpsock_t *server;\n        tcpsock_t *client;\n        client = malloc(sizeof(get_size_tcpsock()));\n        struct pollfd *poll_list;\n        poll_list = malloc(sizeof(struct pollfd));\n        sensor_data_t data;\n\n        int bytes,result;\n\n        if(tcp_passive_open(&amp;server,PORT)!=TCP_NO_ERROR)exit(EXIT_FAILURE);\n        int serversd;\n        tcp_get_sd(server, &amp;serversd);\n        poll_list[0].fd = serversd;\n        poll_list[0].events = POLLIN;\n\n        printf(\"start polling \\n\");\n\n        while(1){\n\n            int retval,i;\n            retval = poll(poll_list,conn_counter+1,5000);\n            if (retval&gt;0){\n                if(poll_list[0].revents &amp;&amp; POLLIN&gt;0){\n                    tcpsock_t *requestclient;\n                    tcp_wait_for_connection(server,&amp;requestclient);\n                client[conn_counter] = *requestclient; //here i have the error\n                    add_client(requestclient,client);\n                    add_poll(poll_list, requestclient, server);\n\n                }\n                for (i=0; i&lt;conn_counter+1;i++){\n                    if(poll_list[i+1].revents &amp; POLLIN){\n\n                        bytes = sizeof(data.id);\n                        result = tcp_receive(client[i],(void *)&amp;data.id,&amp;bytes); //here i have the error\n\n                        bytes = sizeof(data.value);\n                        result = tcp_receive(client[i],(void *)&amp;data.value,&amp;bytes); //here i have the error\n\n                        bytes = sizeof(data.ts);\n                        result =tcp_receive(client[i],(void *)&amp;data.ts,&amp;bytes); //here i have the error\n                        if ((result==TCP_NO_ERROR) &amp;&amp; bytes){\n\n                            printf(\"sensor id = %\" PRIu16 \" - temperature = %g - timestamp = %ld\\n\", data.id, data.value, (long int)data.ts);\n\n                                }\n\n                        fflush(stdout);\n                    }\n                    if (poll_list[i+1].revents &amp; POLLHUP){\n                        printf(\"client disconnected \\n\");\n                        poll_list[conn_counter+1].fd=-1;\n                        poll_list[conn_counter+1].events=0;\n                        fflush(stdout);\n                    }\n                }       \n            }\n\n        }\n\n\n\n        tcp_close(&amp;server);\n        return 1;\n    }\n</code></pre>\n\n<p>Here is the tcpsock.h, but the functions work fine. </p>\n\n<pre><code>typedef struct tcpsock tcpsock_t;\n\nint get_size_tcpsock();\n\nint tcp_passive_open(tcpsock_t ** socket, int port);\n/* Creates a new socket and opens this socket in 'passive listening mode' (waiting for an active connection setup request) \n * The socket is bound to port number 'port' and to any active IP interface of the system\n */\n\nint tcp_active_open(tcpsock_t ** socket, int remote_port, char * remote_ip);\n/* Creates a new TCP socket and opens a TCP connection to the system with IP address 'remote_ip' on port 'remote_port'\n * The newly created socket is return as '*socket'\n */\n\nint tcp_close(tcpsock_t ** socket); \n\nint tcp_wait_for_connection(tcpsock_t * socket, tcpsock_t ** new_socket); \n/* Puts the socket 'socket' in a blocking wait mode\n * Returns when an incoming TCP connection setup request is received\n * A newly created socket identifying the remote system that initiated the connection request is returned as '*new_socket'\n */\n\nint tcp_send(tcpsock_t * socket, void * buffer, int * buf_size );\n/* Initiates a send command on the socket 'socket' and tries to send the total '*buf_size' bytes of data in 'buffer' (recall that the function might block for a while)\n * The function sets '*buf_size' to the number of bytes that were really sent, which might be less than the initial '*buf_size'\n */\n\nint tcp_get_ip_addr( tcpsock_t * socket, char ** ip_addr);\n/* Set '*ip_addr' to the IP address of 'socket' (could be NULL if the IP address is not set)\n */\n\nint tcp_get_port(tcpsock_t * socket, int * port); \n\nint tcp_get_sd(tcpsock_t * socket, int * sd); \n</code></pre>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1464728517, "post_id": 37555074, "comment_id": 62599920, "body": "Is there any reason why you would want to use sockets for communication? After all you are talking about the <b>Message Passing Interface</b>. It&#39;s like <i>&quot;Use a car to go to the city, but you have to push it with your hands.&quot;</i>"}, {"owner": {"reputation": 487, "user_id": 3484582, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4dbd0a4856c8735010eb1654a46301bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3484582", "link": "https://stackoverflow.com/users/3484582/user3484582"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1464728645, "post_id": 37555074, "comment_id": 62599978, "body": "Well, that&#39;s what I was wondering, bur for some reason that&#39;s how the assignment is. Use MPI to create the processes and sockets for communication. It is supposed to simulate a client-server communication and we are supposedly searching for the file in different computers."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1464729535, "post_id": 37555074, "comment_id": 62600391, "body": "I would advise you to question the assignment. In any case - if you aren&#39;t allowed to use MPI for the communication - and that&#39;s what you are struggling with, then this question is not about MPI. Anyway, please post your <code>server()</code> and <code>client()</code> code."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1464729633, "post_id": 37555074, "comment_id": 62600444, "body": "BTW: <a href=\"http://stackoverflow.com/q/3662899/620382\">Do not use <code>sprintf</code> like that</a>."}, {"owner": {"reputation": 487, "user_id": 3484582, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4dbd0a4856c8735010eb1654a46301bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3484582", "link": "https://stackoverflow.com/users/3484582/user3484582"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1464729976, "post_id": 37555074, "comment_id": 62600590, "body": "Thank you! I will definitely bring that up to the professor. Check out my edit. Will also check <code>sprintf</code>"}], "owner": {"reputation": 487, "user_id": 3484582, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4dbd0a4856c8735010eb1654a46301bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3484582", "link": "https://stackoverflow.com/users/3484582/user3484582"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464729920, "creation_date": 1464726522, "last_edit_date": 1464729920, "question_id": 37555074, "link": "https://stackoverflow.com/questions/37555074/mpi-and-socket-programming-notify-if-no-process-found-the-file-searching", "title": "MPI and Socket programming - Notify if no process found the file searching", "body": "<p>I have an assignment to combine MPI and Socket programming for searching a file. MPI will be used to create processes which search into folders whereas sockets will be used for sending and receiving messages. My only problem right now is how I notify my master process if no file was found. Everything else is working fine.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>int main(int argc, char** argv) \n{   \n    int rank, size;\n    DIR *d;\n    FILE *fp;\n    struct dirent *dir;\n\n    if (argc &lt; 2) {\n        error(\"Ju lutem jepni emrin e file.\");\n    }\n\n    printf(\"Fillon kerkimi...\\n\\n\");\n\n    // Initialize the MPI environment.\n    MPI_Init(&amp;argc, &amp;argv);\n\n    // Get the number of processes\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n\n    // Get the rank of the process\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n    if (rank == 0) {\n        server();\n    } else {\n        char str[100];\n        sprintf(str, \"./%d/%s\", rank, argv[1]);\n\n        //if file is found\n        if ((fp = fopen(str, \"r\")) != NULL) {\n            char buffer[4096];\n            int i=0;\n            char c;\n            while((c = getc(fp)) != EOF)\n            {\n                 buffer[i++] = c;\n            }\n            buffer[i]='\\0';\n\n            client(buffer);\n        }\n    }\n\n    MPI_Finalize();\n\n    return 0;\n}\n</code></pre>\n\n<p>The <code>server()</code> and <code>client()</code> functions are used for sending and receiving using sockets. Didn't post the code because it is working fine.</p>\n\n<p>Any ideas?</p>\n\n<p>EDIT:</p>\n\n<p>Server code:</p>\n\n<pre><code>void server() {\n\n    int sockfd, newsockfd, clilen;\n    char buffer[MAX_LEN];\n    struct sockaddr_in serv_addr, cli_addr;\n    int n;\n\n    struct timeval timeout;      \n    timeout.tv_sec = 3;\n    timeout.tv_usec = 0;\n\n\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if (sockfd &lt; 0) \n    {\n        error(\"ERROR opening socket\");\n    }\n\n\n\n    //clear\n    bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n    serv_addr.sin_port = htons(PORTNO);\n\n    if (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n    {\n        error(\"ERROR on binding\");\n    }\n\n    if (setsockopt (sockfd, SOL_SOCKET, SO_RCVTIMEO, (char *)&amp;timeout,\n            sizeof(timeout)) &lt; 0) {;\n        printf(\"File nuk u gjend!\");\n        return;\n    }\n\n    listen(sockfd,5);;\n    clilen = sizeof(cli_addr);\n\n    newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n\n    if (newsockfd &lt; 0)\n    {\n        error(\"ERROR on accept\");\n    }\n\n    bzero(buffer, 256);\n\n    if (read(newsockfd, buffer, 255) &lt; 0)\n    {\n        error(\"ERROR reading from socket\");\n    }\n\n    close(newsockfd);\n    close(sockfd);\n\n    printf(\"File output: \\n%s\\n\", buffer);\n\n    return;\n}\n</code></pre>\n\n<p>Client code:</p>\n\n<pre><code>void client(char* msg[]) {\n\n    int sockfd, n;\n    struct sockaddr_in serv_addr;\n    struct hostent *server;\n\n    char buffer[256];\n    strcpy(buffer, msg);\n\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n\n    if (sockfd &lt; 0)\n    {\n        error(\"ERROR opening socket\");\n    }\n\n    server = gethostbyname(\"localhost\");\n\n    if (server == NULL) \n    {\n        fprintf(stderr, \"ERROR no such host\\n\");\n        exit(0);\n    }\n\n    bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n\n    serv_addr.sin_family = AF_INET;\n    bcopy(  (char *) server-&gt;h_addr, \n            (char *) &amp;serv_addr.sin_addr.s_addr, \n            server-&gt;h_length\n            );\n    serv_addr.sin_port = htons(PORTNO);\n\n\n    while(1)\n    {\n        if (connect(sockfd, &amp;serv_addr, sizeof(serv_addr)) &gt;= 0)\n            break;\n    }   \n\n    if (write(sockfd, buffer, strlen(buffer)) &lt; 0)\n    {   \n        error(\"ERROR writing to socket\");\n    }\n\n\n    close(sockfd);\n    return;\n\n}\n</code></pre>\n\n<p><strong><em>Note</em></strong>: I'm using <code>setsockopt()</code> on the server function which seems to work well for a timeout and do the job, though it doesn't let me print my own message to the console.</p>\n"}, {"tags": ["c", "linux", "execv"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464725284, "post_id": 37554643, "comment_id": 62598215, "body": "It works fine for me. Were you redirecting output when you tested it?"}, {"owner": {"reputation": 41, "user_id": 6406401, "user_type": "registered", "profile_image": "https://graph.facebook.com/506952782833620/picture?type=large", "display_name": "ILya Shapira", "link": "https://stackoverflow.com/users/6406401/ilya-shapira"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464725474, "post_id": 37554643, "comment_id": 62598326, "body": "I execute it in terminal. ls works good, but there is no &quot;hello&quot; printed"}], "answers": [{"comments": [{"owner": {"reputation": 6017, "user_id": 4694621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lIYBa.png?s=128&g=1", "display_name": "Mateusz Piotrowski", "link": "https://stackoverflow.com/users/4694621/mateusz-piotrowski"}, "reply_to_user": {"reputation": 41, "user_id": 6406401, "user_type": "registered", "profile_image": "https://graph.facebook.com/506952782833620/picture?type=large", "display_name": "ILya Shapira", "link": "https://stackoverflow.com/users/6406401/ilya-shapira"}, "edited": false, "score": 0, "creation_date": 1464865834, "post_id": 37554801, "comment_id": 62665129, "body": "@ILyaShapira You can accept the answer if it solved your problem."}, {"owner": {"reputation": 41, "user_id": 6406401, "user_type": "registered", "profile_image": "https://graph.facebook.com/506952782833620/picture?type=large", "display_name": "ILya Shapira", "link": "https://stackoverflow.com/users/6406401/ilya-shapira"}, "edited": false, "score": 0, "creation_date": 1464869970, "post_id": 37554801, "comment_id": 62668063, "body": "I can&#39;t because i don&#39;t have 15 reputation"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464880484, "post_id": 37554801, "comment_id": 62676552, "body": "You don&#39;t need any reputation to accept an answer to your own question, you only need rep to vote. Click the check mark next to the answer."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1547106486, "last_edit_date": 1547106486, "creation_date": 1464725456, "answer_id": 37554801, "question_id": 37554643, "link": "https://stackoverflow.com/questions/37554643/execv-linux-printf-doesnt-work/37554801#37554801", "title": "Execv Linux printf doesn&#39;t work", "body": "<p>Your program should work when output is to a terminal, but it will not work correctly if output is redirected to a file or a pipe. When <code>stdout</code> is not connected to a terminal, its output is fully buffered. Calling an <code>exec</code> function does not flush the buffer before replacing the current process with the new program, so any buffered output will be lost.</p>\n\n<p>Call <code>fflush(stdout);</code> before calling <code>execlp()</code> and the problem should be resolved. You don't need to sleep, it has no effect on output.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[])\n  {\n     printf(\"hello.\\n\");\n     fflush(stdout);\n     if (execlp(\"ls\",\"ls\",\"-l\",NULL) == -1)\n          printf(\"Error occured during execute ls.\\n\");\n     return 0;\n }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6406401, "user_type": "registered", "profile_image": "https://graph.facebook.com/506952782833620/picture?type=large", "display_name": "ILya Shapira", "link": "https://stackoverflow.com/users/6406401/ilya-shapira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1227, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547106486, "creation_date": 1464724811, "last_edit_date": 1464725175, "question_id": 37554643, "link": "https://stackoverflow.com/questions/37554643/execv-linux-printf-doesnt-work", "title": "Execv Linux printf doesn&#39;t work", "body": "<p>I'm trying to run executable using this c code:   </p>\n\n<pre><code>  int main(int argc, char *argv[])\n  {\n     printf(\"hello.\\n\");\n     sleep(2);\n     if (execlp(\"ls\",\"ls\",\"-l\",NULL) == -1)\n          printf(\"Error occured during execute ls.\\n\");\n     return 0;\n }\n</code></pre>\n\n<p>why printf(\"hello\\n\") \ndoesn't work? even if i put sleep?</p>\n"}, {"tags": ["c", "valgrind"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1464724552, "post_id": 37554429, "comment_id": 62597805, "body": "It&#39;s impossible to tell where the problem is since you have posted only part of your program. Please post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 1, "creation_date": 1464724617, "post_id": 37554429, "comment_id": 62597840, "body": "Does Valgrind tell you that something is definitely unreachable? Or just still reachable?  Did you run valgrind with <code>--leak-check=full</code>?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1464724856, "post_id": 37554429, "comment_id": 62597983, "body": "My understanding is that <code>valgrind</code> will tell you where the memory was allocated and not where the any pointer to that memory was lost. That bit you need to figure out with the debugger"}, {"owner": {"reputation": 461, "user_id": 3648541, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8f0e0db61df8c87618a917a7d9ec99b5?s=128&d=identicon&r=PG&f=1", "display_name": "Olba12", "link": "https://stackoverflow.com/users/3648541/olba12"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1464724983, "post_id": 37554429, "comment_id": 62598061, "body": "@Kaz yes I ran it with --leak-check=full and --show-leak-kinds=all"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1464725154, "post_id": 37554429, "comment_id": 62598147, "body": "Alright, so you haven&#39;t <code>free()</code>ed all your list nodes... do you have code that removes items from the list, or that frees the list when you&#39;re done with it?"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1464725164, "post_id": 37554429, "comment_id": 62598152, "body": "@Olba12 You code doesn&#39;t show any of the parts of the program which create a list, and call <code>insert_first</code> to add to the list, and then clean up the list. The one and only <code>free</code> operation shown is actually a red herring that doesn&#39;t do anything."}, {"owner": {"reputation": 461, "user_id": 3648541, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8f0e0db61df8c87618a917a7d9ec99b5?s=128&d=identicon&r=PG&f=1", "display_name": "Olba12", "link": "https://stackoverflow.com/users/3648541/olba12"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1464726161, "post_id": 37554429, "comment_id": 62598688, "body": "I have made an edit @Kaz. I believe the problem is in the free_list function"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1464726682, "post_id": 37554429, "comment_id": 62598983, "body": "If you want absolutely no leaks reported, you have to do <code>fclose(stdin); fclose(stdout); fclose(stderr);</code> These objects are still allocated at termination.  Usually we don&#39;t care about &quot;still reachable&quot; bytes, only &quot;definitely lost&quot;.   If your program doesn&#39;t show runaway memory growth and doesn&#39;t show &quot;definitely lost&quot; bytes when run to termination under valgrind, don&#39;t worry about it."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1464726725, "post_id": 37554429, "comment_id": 62599006, "body": "The <code>free_list</code> function is oddly coded, but the logic is correct. Basically <code>head-&gt;succ</code> is a stack and you pop that stack in a loop, freeing the top node; then you free the stack itself.  This could be done more simply, but it doesn&#39;t seem to be leaking. (It can be done more simply because <code>head</code> is no different from the rest of the nodes in the stack; there is no need to give it special treatment)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464727514, "post_id": 37554429, "comment_id": 62599425, "body": "Side issue: why use <code>sizeof(list_t)</code> in <code>stack =  xmalloc(sizeof(list_t));</code>?  How about <code>stack =  xmalloc(sizeof *stack);</code>?  No need to update the code should the type of <code>stack</code> change."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1464724642, "post_id": 37554533, "comment_id": 62597857, "body": "Since it does nothing, why is it reported as a memory leak?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 2, "creation_date": 1464724772, "post_id": 37554533, "comment_id": 62597935, "body": "Although this is correct, I don&#39;t see how it addresses the question at all..."}, {"owner": {"reputation": 461, "user_id": 3648541, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8f0e0db61df8c87618a917a7d9ec99b5?s=128&d=identicon&r=PG&f=1", "display_name": "Olba12", "link": "https://stackoverflow.com/users/3648541/olba12"}, "edited": false, "score": 0, "creation_date": 1464725286, "post_id": 37554533, "comment_id": 62598216, "body": "Then it should be  t = new_list(); that does a leakage and hence should be free:ed?"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 461, "user_id": 3648541, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8f0e0db61df8c87618a917a7d9ec99b5?s=128&d=identicon&r=PG&f=1", "display_name": "Olba12", "link": "https://stackoverflow.com/users/3648541/olba12"}, "edited": false, "score": 0, "creation_date": 1464725538, "post_id": 37554533, "comment_id": 62598357, "body": "@Olba12 The allocated node referenced by <code>t</code> is spliced into <code>list</code>.  After this function executes, <code>list-&gt;succ</code> points to <code>t</code> and <code>t-&gt;succ</code> points to the original successor of <code>list</code> which was <code>list-&gt;succ</code>.  If <code>list</code> isn&#39;t leaked, then <code>t</code> isn&#39;t leaked."}, {"owner": {"reputation": 461, "user_id": 3648541, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8f0e0db61df8c87618a917a7d9ec99b5?s=128&d=identicon&r=PG&f=1", "display_name": "Olba12", "link": "https://stackoverflow.com/users/3648541/olba12"}, "edited": false, "score": 0, "creation_date": 1464726253, "post_id": 37554533, "comment_id": 62598748, "body": "Oh this was really good, and It solved all my problems! Sorry for being so confusing. Now I understand it. @Kaz"}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1464724990, "last_edit_date": 1464724990, "creation_date": 1464724473, "answer_id": 37554533, "question_id": 37554429, "link": "https://stackoverflow.com/questions/37554429/double-free-corruption-what-is-wrong-in-my-function-free-list/37554533#37554533", "title": "Double free corruption, what is wrong in my function free_list?", "body": "<p>You have a useless <code>temp</code> variable in this function. That is suspicious. However, this function doesn't leak, by itself.</p>\n\n<pre><code>void insert_first(list_t* list, int* a){\n  list_t* t;\n  t = new_list();\n</code></pre>\n\n<p>After this <code>new_list</code>, <code>t-&gt;succ</code> is null</p>\n\n<pre><code>  t-&gt;value = a;\n</code></pre>\n\n<p><code>t-&gt;succ</code> is still null.</p>\n\n<pre><code>  list_t* temp;\n  temp = t-&gt;succ;\n</code></pre>\n\n<p>Since <code>t-&gt;succ</code> is null, so is <code>temp</code>.</p>\n\n<pre><code>  t-&gt;succ = list-&gt;succ;\n  list-&gt;succ = t;\n  free(temp); \n</code></pre>\n\n<p>So <code>free(temp)</code> is just <code>free(NULL)</code>; it does nothing.</p>\n\n<pre><code>}\n</code></pre>\n"}], "owner": {"reputation": 461, "user_id": 3648541, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8f0e0db61df8c87618a917a7d9ec99b5?s=128&d=identicon&r=PG&f=1", "display_name": "Olba12", "link": "https://stackoverflow.com/users/3648541/olba12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "closed_date": 1465452598, "answer_count": 1, "score": -2, "last_activity_date": 1464726101, "creation_date": 1464724098, "last_edit_date": 1464726101, "question_id": 37554429, "link": "https://stackoverflow.com/questions/37554429/double-free-corruption-what-is-wrong-in-my-function-free-list", "closed_reason": "Not suitable for this site", "title": "Double free corruption, what is wrong in my function free_list?", "body": "<p>I am implementing a linked list in C. After reading the comments I have updated and provided more code, which calls free(). If I run the code below I get the following error \"double free or corruption (fasttop):\" I strongly believe that this comes free_list, which probably is wrong. If I run </p>\n\n<p>valgrind --leak-check=full --show-leak-kinds=all</p>\n\n<p>I'll get the following error \"total heap usage: 4 allocs, 7 frees, 64 bytes allocated\"</p>\n\n<pre><code>list_t* xmalloc(size_t size){\n  list_t * t = malloc(size);\n\n  if(t == NULL){\n    fprintf(stderr, \"out of memory\\n\");\n  }\n  return t;\n}\n\n\n/* a function new_list to create a new and empty list.*/\nlist_t* new_list(void){\n  list_t* stack;\n  stack =  xmalloc(sizeof(list_t));\n  stack-&gt;value = NULL;\n  stack-&gt;succ = NULL;\n  return stack;\n}\n\n/* a function free_list to deallocate the list.*/\nvoid free_list(list_t* head){\n  list_t* temp;\n  temp = head;\n  while(head-&gt;succ != NULL){\n    temp = head-&gt;succ;\n    head-&gt;succ = head-&gt;succ-&gt;succ;\n    free(temp);\n  }\n  free(head);\n}\n\nvoid insert_first(list_t* list, int* a){\n\n  list_t* t;\n  t = new_list();\n  t-&gt;value = a;\n  t-&gt;succ = list-&gt;succ;\n  list-&gt;succ = t;\n  free(t);\n}\n\nint top(list_t* stack){\n  if(stack-&gt;succ == NULL){\n    fprintf(stderr, \"Empty\\n\");\n\n  }\n  return *stack-&gt;succ-&gt;value;\n}\n\nint main(void){\n  int a[3] = {1,2,3};\n  int i;\n  list_t* head1;\n  head1 = new_list();\n  for(i = 0; i &lt; 3; i++){\n    insert_first(head1, &amp;a[i]);\n  }\n  printf(\"Top1: %d\\n\", top(head1));\n}\n free_list(head1);\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "ffmpeg", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1464931703, "post_id": 37553680, "comment_id": 62697124, "body": "As for &#39;in the middle of execution&#39; part, you can lock it with e.g. mutex. Not sure why having queued but inactive timer matters here."}], "answers": [{"tags": [], "owner": {"reputation": 2380, "user_id": 5927496, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a888e2216c350c2f12ee4b3b05e90759?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Clarembeau", "link": "https://stackoverflow.com/users/5927496/alexis-clarembeau"}, "is_accepted": false, "score": 3, "last_activity_date": 1465534927, "last_edit_date": 1465534927, "creation_date": 1464954514, "answer_id": 37613629, "question_id": 37553680, "link": "https://stackoverflow.com/questions/37553680/sdl-addtimer-and-threading-clearing-timer-queue/37613629#37613629", "title": "SDL_AddTimer and threading, clearing timer queue", "body": "<p>There's <strong>a lot of different ways</strong> to solve your problem based on your specific implementation. Few basic ideas can be: </p>\n\n<ol>\n<li><p>Define a boolean that specifies if the player is running (true = running, false = not)</p></li>\n<li><p>Before each call related to the player, check that variable and if its false (the player is stopped), close the function (immediately return)</p></li>\n<li><p>Then, you call <code>removeTimer</code> and you set the variable to false to close the player. </p></li>\n</ol>\n\n<p>However, because <code>addTimer</code> is a function that creates threads, <strong>there can be sometimes race conditions</strong>(what you called \"the middle of execution\"). It's one of the main problem when you use threads. </p>\n\n<p>You need to find and fix those by using tools such as mutexes, semaphores, ... The choice of those tools greatly depends on the strategy you want to implement to avoid those race conditions. </p>\n\n<p>So, there is <strong>no generic solution</strong>. If performance is not a concern, you can use that simple \"one-lock\" solution. It's a basic implementation of the \"critical section\" strategy. It prevents some pieces of code (closing player and running critical sound-related calls) to run simultaneously. </p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdbool.h&gt;\n\npthread_mutex_t mutex; \nbool isRunning; \nint timerID; \n\nvoid timerCallback(){\n    // do some computations \n\n    pthread_mutex_lock(&amp;mutex); \n    // that critical section, defined here will never \n    // (thank to the mutex) occur at the same time at \n    // the critical section in the close method \n\n    if(isRunning){\n         // do critical calls\n    }\n    else{\n         // do nothing\n    }\n    pthread_mutex_unlock(&amp;mutex); \n\n    // do some other computations\n}\n\nvoid init(){\n    pthread_mutex_init(&amp;mutex, NULL); \n    isRunning = true; \n    startTimers(); \n}\n\nvoid close(){\n    pthread_mutex_lock(&amp;mutex); \n\n    // that critical section, defined here will never \n    // (thank to the mutex) occur at the same time at \n    // the critical section in the timerCallback method \n    SDL_RemoveTimer(timerID); \n    isRunning = false; \n    pthread_mutex_unlock(&amp;mutex); \n\n    pthread_mutex_destroy(&amp;mutex); \n}\n</code></pre>\n\n<p>Of course, I cannot explain all the race-condition avoidance strategies in a simple stackoverflow post. <strong>If you need to improve performance, you should define precisely what's your concurrency issue</strong> for your code and choose a right strategy. </p>\n"}], "owner": {"reputation": 3099, "user_id": 798160, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UnviR.jpg?s=128&g=1", "display_name": "William Seemann", "link": "https://stackoverflow.com/users/798160/william-seemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1465534927, "creation_date": 1464721409, "last_edit_date": 1464810592, "question_id": 37553680, "link": "https://stackoverflow.com/questions/37553680/sdl-addtimer-and-threading-clearing-timer-queue", "title": "SDL_AddTimer and threading, clearing timer queue", "body": "<p>I'm writing a media player based on <a href=\"https://ffmpeg.org/download.html\" rel=\"noreferrer\">FFmpeg</a> and I have a design issue. My code calls a function to render video frames at irregular intervals using SDL's <a href=\"https://wiki.libsdl.org/SDL_AddTimer\" rel=\"noreferrer\">SDL_AddTimer</a> function. My problem is this, if I want to perform garbage collection when one video ends (or playback is stopped) and another starts, how can I ensure that I have no more timers in the queue or in the middle of execution as to avoid accessing an object that suddenly has been freed.</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464720410, "post_id": 37553321, "comment_id": 62595458, "body": "What is the <code>__func__</code> macro? where did you see it?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1464721111, "post_id": 37553321, "comment_id": 62595857, "body": "@iharob: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.2.2p1\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.4.2.2p1</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464721136, "post_id": 37553321, "comment_id": 62595867, "body": "What does &quot;strize&quot; mean? Is that even a word?"}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464721404, "post_id": 37553321, "comment_id": 62596025, "body": "@Olaf I know it under the name <code>stringize</code>. It&#39;s a common macro pair to evaluate a macro and turn the value into a string."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1464721652, "post_id": 37553321, "comment_id": 62596165, "body": "@a3f: less <code>z</code>, more <code>s</code>, but yes, that one is known, of course. I just wonder: typo or twitteritis? At least the title line should really have no obvious typos."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6406020, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a352af20b30c372d8bfc88690359e4a6?s=128&d=identicon&r=PG&f=1", "display_name": "Luka", "link": "https://stackoverflow.com/users/6406020/luka"}, "edited": false, "score": 0, "creation_date": 1464780221, "post_id": 37553429, "comment_id": 62621611, "body": "Thanks, that&#39;s ok to stringize this, but how can tokenize it? I want to do things like <code>__func__##_foo</code>, to call another function prefixed by the current function&#39;s name."}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "reply_to_user": {"reputation": 67, "user_id": 6406020, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a352af20b30c372d8bfc88690359e4a6?s=128&d=identicon&r=PG&f=1", "display_name": "Luka", "link": "https://stackoverflow.com/users/6406020/luka"}, "edited": false, "score": 0, "creation_date": 1464782654, "post_id": 37553429, "comment_id": 62623297, "body": "@Tsigorf You can&#39;t. I extended my answer."}], "tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": true, "score": 6, "last_activity_date": 1464782631, "last_edit_date": 1464782631, "creation_date": 1464720512, "answer_id": 37553429, "question_id": 37553321, "link": "https://stackoverflow.com/questions/37553321/how-can-i-tokenize-and-strize-the-func-macro-in-c/37553429#37553429", "title": "How can I tokenize and strize the __func__ macro in C?", "body": "<p>Here is what the C11 draft says about <code>__func__</code>:</p>\n\n<blockquote>\n  <p><strong>1</strong>   The identifier __func__ shall be implicitly declared by the\n  translator as if, immediately following the opening brace of each\n  function definition, the declaration</p>\n  \n  <p><code>static const char __func__[] = \"function-name\";</code></p>\n</blockquote>\n\n<p>As you see <code>__func__</code>, unlike <code>__FILE__</code> and <code>__LINE__</code>, is no preprocessor macro, so you can't evaluate it during the preprocessing stage.</p>\n\n<p><strong>But</strong> in your code, you don't even need to do that. Just change</p>\n\n<pre><code>#define OVERLOAD2(f) printf(\"Trying to overload function %s...\", #f)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>#define OVERLOAD printf(\"Trying to overload function %s...\", __func__)\n</code></pre>\n\n<p>as you can see in the standard's description of <code>__func__</code>, it's already a string. No need to stringize it.</p>\n\n<hr>\n\n<p>If you need the function name as a \"bare word\" at compile time, e.g. an implicit <code>#define __FUNC__ myfunc</code>, you're out of luck.</p>\n\n<p>It's not possible in standard C. GCC additionally provides __FUNCTION__, but despite its all-caps name, the GCC manual says:</p>\n\n<blockquote>\n  <p>Neither of them is a macro; the preprocessor does not know the name of\n  the current function.</p>\n</blockquote>\n\n<p>MSVC provides <code>__FUNCTION__</code> as a macro but it's defined to a string and you can't strip away the double quotes.</p>\n\n<p>Only way around that is writing your own preprocessor or rethink your approach</p>\n"}], "owner": {"reputation": 67, "user_id": 6406020, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a352af20b30c372d8bfc88690359e4a6?s=128&d=identicon&r=PG&f=1", "display_name": "Luka", "link": "https://stackoverflow.com/users/6406020/luka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 37553429, "answer_count": 1, "score": -1, "last_activity_date": 1464782631, "creation_date": 1464720122, "last_edit_date": 1464721648, "question_id": 37553321, "link": "https://stackoverflow.com/questions/37553321/how-can-i-tokenize-and-strize-the-func-macro-in-c", "title": "How can I tokenize and strize the __func__ macro in C?", "body": "<p>I want to <em>tokenize</em> and <em>strize</em>, with macros, the name of the function we are in, to overload the function (with dlopen()), in C.</p>\n\n<p>I found similar things with <code>__LINE__</code> and <code>__FILE__</code>, but it seems to be a bit different in the case with <code>__func__</code>...</p>\n\n<p>I tried that:</p>\n\n<pre><code>#define OVERLOAD2(f) printf(\"Trying to overload function %s...\", #f)\n#define OVERLOAD1(f) OVERLOAD2(f)\n#define OVERLOAD OVERLOAD1(__func__)\n\nint main() {\n    OVERLOAD;\n}\n</code></pre>\n\n<p>Compiling with different standards of compilation (c99, gnu11) doesn't change the result; instead of printing:</p>\n\n<pre><code>Trying to overload function main...\n</code></pre>\n\n<p>It prints:</p>\n\n<pre><code>Trying to overload function __func__...\n</code></pre>\n\n<p>How can I correct those macros?</p>\n"}, {"tags": ["c", "linux", "makefile", "linux-kernel"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1464722855, "post_id": 37553169, "comment_id": 62596848, "body": "I doubt you can easily create a module with CMake. Kernel uses it&#39;s own build system called KBuild. <a href=\"https://cmake.org/pipermail/cmake/2007-November/017320.html\" rel=\"nofollow noreferrer\">cmake.org/pipermail/cmake/2007-November/017320.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1910, "user_id": 2142228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac67bc0f4a64f7102fffe2f3bd45211d?s=128&d=identicon&r=PG", "display_name": "msmith81886", "link": "https://stackoverflow.com/users/2142228/msmith81886"}, "edited": false, "score": 0, "creation_date": 1464728706, "post_id": 37554465, "comment_id": 62600016, "body": "That solved it.  Thank you for your help.  Worked like a charm."}], "tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 3, "last_activity_date": 1464724215, "creation_date": 1464724215, "answer_id": 37554465, "question_id": 37553169, "link": "https://stackoverflow.com/questions/37553169/build-linux-kernel-module-using-makefile-with-different-pathname/37554465#37554465", "title": "Build Linux Kernel Module using Makefile with different pathname", "body": "<p>Move all Kbuild-related logic into the file <code>Kbuild</code>. Kernel's build system checks file with this name first, so it won't look into <code>Makefile</code>, created by CMake. This feature is documented in <a href=\"http://www.mjmwired.net/kernel/Documentation/kbuild/makefiles.txt\" rel=\"nofollow\">Documentation/kbuild/makefiles.txt</a>.</p>\n\n<p>I use exactly this approach in my CMake projects, related with Linux kernel.</p>\n"}, {"tags": [], "owner": {"reputation": 666, "user_id": 1407571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e3283a5023a271474a0a7168ace897?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/1407571/dmitry"}, "is_accepted": false, "score": 0, "last_activity_date": 1464724270, "creation_date": 1464724270, "answer_id": 37554477, "question_id": 37553169, "link": "https://stackoverflow.com/questions/37553169/build-linux-kernel-module-using-makefile-with-different-pathname/37554477#37554477", "title": "Build Linux Kernel Module using Makefile with different pathname", "body": "<p>Open script/Makefile.build into kernel tree:</p>\n\n<pre><code> 41 # The filename Kbuild has precedence over Makefile  \n 42 kbuild-dir := $(if $(filter /%,$(src)),$(src),$(srctree)/$(src))  \n 43 kbuild-file := $(if $(wildcard $(kbuild-dir)/Kbuild),$(kbuild-dir)/Kbuild,$(kbuild-dir)/Makefile)  \n 44 include $(kbuild-file)\n</code></pre>\n\n<p>This part of code (43-44) include Makefile with name 'Makefile'.</p>\n"}, {"tags": [], "owner": {"reputation": 4790, "user_id": 4491743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aXCqO.jpg?s=128&g=1", "display_name": "Knud Larsen", "link": "https://stackoverflow.com/users/4491743/knud-larsen"}, "is_accepted": false, "score": -1, "last_activity_date": 1464724400, "creation_date": 1464724400, "answer_id": 37554511, "question_id": 37553169, "link": "https://stackoverflow.com/questions/37553169/build-linux-kernel-module-using-makefile-with-different-pathname/37554511#37554511", "title": "Build Linux Kernel Module using Makefile with different pathname", "body": "<hr>\n\n<p>The default Makefile. Name = Makefile ... and Makefile-hello, or Makefile.hello.</p>\n\n<pre><code>obj-m    := hello.o\n\nKDIR    := /lib/modules/$(shell uname -r)/build\nPWD    := $(shell pwd)\n\ndefault:\n    $(MAKE) -C $(KDIR) SUBDIRS=$(PWD) modules\n\nclean:\n    $(MAKE) -C $(KDIR) M=$(PWD) clean\n</code></pre>\n\n<p>$ <code>make</code> : OK</p>\n\n<p>$ <code>make -f Makefile-hello</code> OK</p>\n\n<p>$ <code>make -f Makefile.hello</code> Also OK.</p>\n\n<p>Your Makefile : $ <code>make -f Makefile.msmith</code> OK, no errors.</p>\n\n<hr>\n"}], "owner": {"reputation": 1910, "user_id": 2142228, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ac67bc0f4a64f7102fffe2f3bd45211d?s=128&d=identicon&r=PG", "display_name": "msmith81886", "link": "https://stackoverflow.com/users/2142228/msmith81886"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2317, "favorite_count": 0, "accepted_answer_id": 37554465, "answer_count": 3, "score": 1, "last_activity_date": 1464724400, "creation_date": 1464719598, "last_edit_date": 1464720183, "question_id": 37553169, "link": "https://stackoverflow.com/questions/37553169/build-linux-kernel-module-using-makefile-with-different-pathname", "title": "Build Linux Kernel Module using Makefile with different pathname", "body": "<p>I am trying to compile a Linux kernel module using the standard example Makefile specified in the <a href=\"http://www.tldp.org/LDP/lkmpg/2.6/lkmpg.pdf\" rel=\"nofollow\" title=\"here\">Linux Kernel Module Programming Guide</a>.  If the Makefile is called <code>Makefile</code>, then everything works.  If I rename the Makefile to <code>Makefile.hello</code> or something else, then it fails as it cannot find the path <code>Makefile</code>.  I was wondering if there is a command or set of flags I can add to my Makefile to make this function properly.  I need to rename the Makefile as I am calling it from CMake.  Cmake creates its own Makefiles and will commonly overwrite what I already have.  </p>\n\n<p>I replaced my kernel module code with the hello world example and replicated the problem.  I know its the makefile.</p>\n\n<p>hello world example <code>hello.c</code></p>\n\n<pre><code>/*\n * hello\u22121.c \u2212 The simplest kernel module.\n */\n#include &lt;linux/module.h&gt; /* Needed by all modules */\n#include &lt;linux/kernel.h&gt; /* Needed for KERN_INFO */\nint init_module(void)\n{\n    printk(KERN_INFO \"Hello world 1.\\n\");\n    /*\n     * A non 0 return means init_module failed; module can't be loaded.\n     */\n    return 0;\n}\nvoid cleanup_module(void)\n{\n    printk(KERN_INFO \"Goodbye world 1.\\n\");\n}\n</code></pre>\n\n<p>Makefile</p>\n\n<pre><code>obj-m += hello.o\n\nifeq (,$(KDIR))\n    KDIR := /lib/modules/$(shell uname -r)/build\nendif\n\nPWD := $(shell pwd)\n\nall:\n    $(MAKE) -C $(KDIR) M=$(PWD) $(KCONFIG) modules\n\nclean:\n    $(MAKE) -C $(KDIR) M=$(PWD) clean\n</code></pre>\n\n<p>If makefile is called <code>Makefile</code>. (Successfully builds)</p>\n\n<pre><code>$&gt; make -f Makefile\nmake -C /lib/modules/4.4.0-21-generic/build M=/home/msmith/Desktop/kernel-test  modules\nmake[1]: Entering directory '/usr/src/linux-headers-4.4.0-21-generic'\n  CC [M]  /home/msmith/Desktop/kernel-test/hello.o\n  Building modules, stage 2.\n  MODPOST 1 modules\n  CC      /home/msmith/Desktop/kernel-test/hello.mod.o\n  LD [M]  /home/msmith/Desktop/kernel-test/hello.ko\nmake[1]: Leaving directory '/usr/src/linux-headers-4.4.0-21-generic'\n</code></pre>\n\n<p>Make output if makefile is called <code>Makefile.hello</code>  (Fails to build)</p>\n\n<pre><code>$&gt; make -f Makefile.hello\nmake -C /lib/modules/4.4.0-21-generic/build M=/home/msmith/Desktop/kernel-test  modules\nmake[1]: Entering directory '/usr/src/linux-headers-4.4.0-21-generic'\nscripts/Makefile.build:44: /home/msmith/Desktop/kernel-test/Makefile: No such file or directory\nmake[2]: *** No rule to make target '/home/msmith/Desktop/kernel-test/Makefile'.  Stop.\nMakefile:1396: recipe for target '_module_/home/msmith/Desktop/kernel-test' failed\nmake[1]: *** [_module_/home/msmith/Desktop/kernel-test] Error 2\nmake[1]: Leaving directory '/usr/src/linux-headers-4.4.0-21-generic'\nMakefile.hello:10: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>I tried adding the -f to the internal MAKE parameters, however that just caused more issues.  </p>\n"}, {"tags": ["c", "gcc", "compilation", "makefile", "configure"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1464720279, "post_id": 37553086, "comment_id": 62595374, "body": "are you sure you want the <code>--cross-prefix</code> ?"}, {"owner": {"reputation": 11, "user_id": 6406068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7A1nAuFKoq8/AAAAAAAAAAI/AAAAAAAAAC0/vrwy1HXp49A/photo.jpg?sz=128", "display_name": "Charis Kopsacheilis", "link": "https://stackoverflow.com/users/6406068/charis-kopsacheilis"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1464720665, "post_id": 37553086, "comment_id": 62595596, "body": "if a omit it the outcome is the same. At first i tried without it but no luck :("}], "owner": {"reputation": 11, "user_id": 6406068, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7A1nAuFKoq8/AAAAAAAAAAI/AAAAAAAAAC0/vrwy1HXp49A/photo.jpg?sz=128", "display_name": "Charis Kopsacheilis", "link": "https://stackoverflow.com/users/6406068/charis-kopsacheilis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464719250, "creation_date": 1464719250, "question_id": 37553086, "link": "https://stackoverflow.com/questions/37553086/cross-compiling-prex", "title": "Cross - compiling Prex", "body": "<p>i am trying to compile prex using this guide : <a href=\"http://prex.sourceforge.net/doc/build.html\" rel=\"nofollow\">Prex build guide</a></p>\n\n<p>I want to make a bootable USB out of it and run it pretty much in any computer.</p>\n\n<p>Now, i am using a x86_64 linux system</p>\n\n<pre><code>uname -a\nLinux xbaremenos 3.19.0-32-generic #37~14.04.1-Ubuntu SMP Thu Oct 22 09:41:40 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n\n<p>i run </p>\n\n<pre><code>./configure --target=x86-pc --cross-prefix=x86_64-linux-gnu-\n</code></pre>\n\n<p>which specifies i want it to build for a x86 platform but when i try to run make i get this message </p>\n\n<pre><code> ~/Downloads/prex-0.9.0 $ make\nx86_64-linux-gnu-cpp -D__ASSEMBLY__  -D__x86__ -D__pc__ -DKERNEL -I. -I/home/xbaremenos/Downloads/prex-0.9.0 -I/home/xbaremenos/Downloads/prex-0.9.0/include -I/home/xbaremenos/Downloads/prex-0.9.0/bsp/boot/include -I/home/xbaremenos/Downloads/prex-0.9.0/bsp/boot/x86 x86/pc/head.S x86/pc/head.tmp\nx86_64-linux-gnu-as  -o x86/pc/head.o x86/pc/head.tmp\nrm -f x86/pc/head.tmp\nx86_64-linux-gnu-gcc  -c -Os -ansi -pedantic -Wall -Wundef -Wstrict-prototypes -Wpointer-arith -nostdinc -fno-strict-aliasing -fno-stack-protector -march=i386 -mpreferred-stack-boundary=2 -fomit-frame-pointer -fno-builtin  -D__x86__ -D__pc__ -DKERNEL -I. -I/home/xbaremenos/Downloads/prex-0.9.0 -I/home/xbaremenos/Downloads/prex-0.9.0/include -I/home/xbaremenos/Downloads/prex-0.9.0/bsp/boot/include -I/home/xbaremenos/Downloads/prex-0.9.0/bsp/boot/x86 -o x86/pc/startup.o x86/pc/startup.c\nx86/pc/startup.c:1:0: error: CPU you selected does not support x86-64 instruction set\n /*-\n ^\nx86/pc/startup.c:1:0: error: CPU you selected does not support x86-64 instruction set\nx86/pc/startup.c:1:0: error: -mpreferred-stack-boundary=2 is not between 3 and 12\nmake[2]: *** [x86/pc/startup.o] Error 1\nmake[1]: *** [boot] Error 2\nmake: *** [bsp] Error 2\n</code></pre>\n\n<p>What am i doing wrong here ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 0, "creation_date": 1464719483, "post_id": 37553055, "comment_id": 62594865, "body": "The code 1) will store the number at the memory address <code>pn</code> points to, 2) initializes the result with 0, 3) reads input from the console as long as digits are entered, 4) converts the entered characters into digits and 5) updates the target number by multiplying the current value with 10 and adding the last digit entered."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5592662"}, "edited": false, "score": 0, "creation_date": 1464720542, "post_id": 37553055, "comment_id": 62595526, "body": "@itharob i was only concerned with one of code. How could i properly format this question"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5592662"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464720617, "post_id": 37553055, "comment_id": 62595570, "body": "@Olaf getch() is a function to get chars through a buffer. Its in Section 4.3"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464720995, "post_id": 37553055, "comment_id": 62595791, "body": "@MilesGaitan: I very well know the book (that&#39;s why I discuorage from using it: it only covers a 27 year old outdated version of C which is not standard and includes some nowadays questionable coding styles). (Sidenote: Iff you need to post code in a comment, please use markdown). Still there is no reason to use it instead of <code>getchar</code> or <code>fgetc</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464721091, "post_id": 37553055, "comment_id": 62595844, "body": "The function does not return a value: that would generate a compiler warning. Was it supposed to be the input value, or a status?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5592662"}, "edited": false, "score": 0, "creation_date": 1464719709, "post_id": 37553140, "comment_id": 62595009, "body": "Thank you so much. I didn&#39;t realize why it was multiplying by 10 but now it makes sense."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1464719907, "post_id": 37553140, "comment_id": 62595138, "body": "@MilesGaitan You are welcome! When there is no overflow, multiplying by the base of the number system is equivalent to shifting left by one. It works in decimal in the same way as it works in binary (<code>&lt;&lt;</code> operator multiplies the number by <code>2</code>), and for any number system (hex, octal, base-36 or any other base)."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1464719920, "post_id": 37553140, "comment_id": 62595149, "body": "Why were you confused because of the two <code>*</code> operators? One of them is used as a multiplication operator, the other one simply dereferences the pointer, I like it <code>10 * (*pn)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5592662"}, "edited": false, "score": 0, "creation_date": 1464720165, "post_id": 37553140, "comment_id": 62595301, "body": "@itharob i was unclear why there was multiplication by 10. I  didn&#39;t know what it was doing."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1464721068, "post_id": 37553140, "comment_id": 62595830, "body": "@MilesGaitan If this solves your problem, consider accepting the answer by clicking the grey check mark next to it. This would tell other site visitors that you are no longer actively looking for help with this question, and earn you a brand-new badge on Stack Overflow."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1464723178, "post_id": 37553140, "comment_id": 62597028, "body": "&quot;Any change that you make inside this method &quot; method, pe you mean Function?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1464723805, "post_id": 37553140, "comment_id": 62597364, "body": "@Michi Ah, of course! That&#39;s what happens when you try answering questions about a mix of C, Swift, Java, C#, and a bunch of other languages: keeping mental track of &quot;methods&quot;, &quot;functions&quot;, &quot;member variables&quot;, &quot;properties&quot;, &quot;attributes&quot;, and so on becomes a little challenge."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 4, "last_activity_date": 1464723707, "last_edit_date": 1464723707, "creation_date": 1464719476, "answer_id": 37553140, "question_id": 37553055, "link": "https://stackoverflow.com/questions/37553055/kr-code-for-getting-an-int/37553140#37553140", "title": "K&amp;R Code for getting an int", "body": "<p>Here is what's going on here:</p>\n\n<ul>\n<li>Since <code>pn</code> is a pointer to the result passed by pointer, assigning or reading <code>*pn</code> means accessing the result that we have so far. Any change that you make inside this function will be accessible in the context of the caller, who passed you a pointer to <code>int</code>.</li>\n<li>Since codes of decimal digits are next to each other, <code>c-'0'</code> means a numeric value of the character code representing a digit. For example, if <code>c</code> is <code>'5'</code> (in single quotes), then <code>c-'0'</code> is equal to <code>5</code> (no quotes).</li>\n</ul>\n\n<p>Now the rest of the algorithm becomes clear: attaching a digit to the right of a number means taking the prior value of the number, multiplying it by ten, and adding the value of the digit to the result.</p>\n\n<p>For example, if you are reading <code>\"12345\"</code> and you have read <code>\"123\"</code>, then <code>*pn</code> is <code>123</code>, and the next digit is <code>4</code>. You multiply <code>123</code> by <code>10</code> to get <code>1230</code>, and add <code>4</code> to it. Now you have <code>1234</code>, and the next digit is <code>5</code>. You multiply by ten again to get <code>12340</code>, and add <code>5</code> to get your final result of <code>12345</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5592662"}, "edited": false, "score": 0, "creation_date": 1464720398, "post_id": 37553194, "comment_id": 62595451, "body": "yes the function is getint(int *pn). There is also code in the function for error handling and skipping over white spaces."}], "tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": false, "score": -1, "last_activity_date": 1464719665, "creation_date": 1464719665, "answer_id": 37553194, "question_id": 37553055, "link": "https://stackoverflow.com/questions/37553055/kr-code-for-getting-an-int/37553194#37553194", "title": "K&amp;R Code for getting an int", "body": "<p>I am pretty sure this is code for inputting an integer faster by reading digits char by char.So this would be something like</p>\n\n<pre><code> void input_int(int *pn)\n {\n    for ( *pn = 0; isdigit(c); c =getch())\n    *pn = 10 * *pn + ( c - '0') ;\n }\n</code></pre>\n\n<p>and used as</p>\n\n<pre><code> int a;\n input_int(&amp;a);\n</code></pre>\n\n<p>What is happening is that we read the digits char by char and simultaneously create an integer.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5592662"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1464723707, "creation_date": 1464719139, "last_edit_date": 1464721577, "question_id": 37553055, "link": "https://stackoverflow.com/questions/37553055/kr-code-for-getting-an-int", "title": "K&amp;R Code for getting an int", "body": "<p>I'm having trouble understanding the code for getting an int in K&amp;R.\nSpecifically the last line of this function:</p>\n\n<pre><code>void getint( int *pn )\n{\n    int c;\n    while (isspace(c = getch()))\n        ;\n\n    for (*pn = 0; isdigit(c); c = getch())\n        *pn = 10 * *pn + (c - '0') ;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 5, "creation_date": 1464716582, "post_id": 37552323, "comment_id": 62593112, "body": "Your code doesn&#39;t compile."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 2, "creation_date": 1464716594, "post_id": 37552323, "comment_id": 62593121, "body": "&quot;hello&quot; is a const readonly data you can&#39;t increment it since it&#39;s not a variable.  Try using character array instead."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 4, "creation_date": 1464716626, "post_id": 37552323, "comment_id": 62593139, "body": "Turn on <i>all</i> your compiler warnings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "edited": false, "score": 0, "creation_date": 1464716725, "post_id": 37552323, "comment_id": 62593190, "body": "I believe this is a runtime error, since it only comes up when I try and run the program. So when I say &quot;gcc -o test test.c&quot; everything&#39;s good. But when I say ./test then I get that error."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 1, "creation_date": 1464716766, "post_id": 37552323, "comment_id": 62593200, "body": "Dont pass <code>&quot;hello&quot;</code> as it is a string literal and a  constant . Use <code>char s[]=&quot;hello&quot;;</code> as suggested by @cleblanc ."}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 1, "creation_date": 1464716788, "post_id": 37552323, "comment_id": 62593211, "body": "There&#39;s a code smell in there, what&#39;s <code>size</code>, not used. What&#39;s <code>i</code>, not used either. Back to drawing board there I guess."}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 1, "creation_date": 1464716895, "post_id": 37552323, "comment_id": 62593262, "body": "Enclose a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to demonstrate the issue."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1464716930, "post_id": 37552323, "comment_id": 62593292, "body": "@cleblanc Then why can I say &quot;printf(&quot;%c&quot;, buffer[i] + 1) and have it print &quot;ifmmp&quot;?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464717402, "post_id": 37552323, "comment_id": 62593586, "body": "Because your above commented code is not <i>altering a string literal</i>. It is showing each character + 1."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1464717468, "post_id": 37552323, "comment_id": 62593633, "body": "@Mr.Pickles That <code>printf</code> statement is correct no problem in that , but this is what creates probe - <code>buffer[i] = buffer[i] + 1;</code> because you modify <code>buffer[i]</code> here . There is difference between <code>buffer[i]+1</code> and <code>buffer[i]=buffer[i]+1</code> (<i>latter one tries to modify literal</i>)."}, {"owner": {"reputation": 217, "user_id": 6375267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VeNph.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/6375267/mark"}, "edited": false, "score": 1, "creation_date": 1464717481, "post_id": 37552323, "comment_id": 62593642, "body": "&quot;buffer[i] = buffer[i] + 1&quot; is not incrementing a pointer. It is trying to set a character in &quot;buffer&quot; equal to the following character in &quot;buffer&quot;. which character it is trying to change depends on the value of &quot;i&quot;."}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1464717551, "post_id": 37552323, "comment_id": 62593697, "body": "There is <b>undefined behaviour</b> being induced with side effect of seg faulting, <code>i</code> is uninitialized, and could be referencing an out of bounds outside of the buffer by incrementing it to something else, and printing garbage."}, {"owner": {"reputation": 217, "user_id": 6375267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VeNph.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/6375267/mark"}, "edited": false, "score": 0, "creation_date": 1464717847, "post_id": 37552323, "comment_id": 62593879, "body": "The &quot;segmentation fault&quot; is because you are trying to change the character at &quot;buffer[i]&quot;, but it is a unwritable constant."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1464717970, "post_id": 37552323, "comment_id": 62593957, "body": "Where does <code>i</code> come from?"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 0, "creation_date": 1464718129, "post_id": 37552323, "comment_id": 62594074, "body": "Yes, <code>i</code> is uninitialized in above code. And BTW you must use a loop to achieve desired result. And what&#39;s the point of sending <code>size</code> as an argument to <code>encrypt()</code>?"}, {"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1464723968, "post_id": 37552323, "comment_id": 62597468, "body": "is this code related to OP&#39;s previous <a href=\"http://stackoverflow.com/questions/37422662/how-can-i-use-ctypes-to-pass-a-bytearray-into-a-c-function-that-takes-a-char-as\">question</a> and <a href=\"http://stackoverflow.com/questions/37423867/how-can-i-use-java-native-interface-to-pass-a-byte-array-into-a-c-function-which\">question</a> and <a href=\"http://stackoverflow.com/questions/37489128/i-have-2-very-similar-c-functions-being-called-from-python-and-java-how-can-i-c\">this question</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1464719316, "post_id": 37553058, "comment_id": 62594771, "body": "Well, two out of four isn&#39;t terrible, I suppose. And did you <i>compile</i> this, or are you leaving the task of discovering a <code>char[5]</code> can&#39;t possibly hold &quot;hello&quot; (hint: nulchar terminator?) as an exercise to the OP?"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1464719514, "post_id": 37553058, "comment_id": 62594883, "body": "Yes I compiled @WhozCraig do you mean I mentioned only 2 problems?"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1464721224, "post_id": 37553058, "comment_id": 62595915, "body": "@WhozCraig i updated my answer, i think it has no issues now.. And BTW thanks for mentioning th null character issue"}, {"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1464728257, "post_id": 37553058, "comment_id": 62599792, "body": "@Mr.Pickles if you have any doubts regarding my code, you can ask me"}], "tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": false, "score": 1, "last_activity_date": 1464720565, "last_edit_date": 1464720565, "creation_date": 1464719145, "answer_id": 37553058, "question_id": 37552323, "link": "https://stackoverflow.com/questions/37552323/how-to-increment-a-character-pointer-in-c-without-segmentation-fault-error/37553058#37553058", "title": "How to increment a character pointer in C without segmentation fault error?", "body": "<p>There are many problems in your code :</p>\n\n<ul>\n<li><code>i</code> is uninitialized </li>\n<li><code>\"hello\"</code> is converted to <code>int</code>, so avoid sending that way. instead see the code bellow</li>\n<li><p>you've sent argument <code>size</code> but haven't used it.</p></li>\n<li><p>finally, use a loop to increment every value in the array <code>char *buffer</code></p></li>\n<li><p>return a value at the end of <code>main()</code> as you mentioned return type as <code>int</code></p></li>\n</ul>\n\n<p>So, here's the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid encrypt(int size, char *buffer){\n    int i;\n    for(i=0;i&lt;size;i++)\n        buffer[i] =(buffer[i]+1);\n    printf(\"%s\",buffer);\n}\n\nint main(){\n    char s[]=\"hello\";// total 5 charcters + '\\0' character\n    encrypt(5,s);\n    return 0;\n}\n</code></pre>\n\n<p>the output generated is as desired.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6373390"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "closed_date": 1464761394, "answer_count": 1, "score": 0, "last_activity_date": 1464720565, "creation_date": 1464716458, "last_edit_date": 1464716942, "question_id": 37552323, "link": "https://stackoverflow.com/questions/37552323/how-to-increment-a-character-pointer-in-c-without-segmentation-fault-error", "closed_reason": "Needs details or clarity", "title": "How to increment a character pointer in C without segmentation fault error?", "body": "<p>So I have the following function defined in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid encrypt(int size, unsigned char *buffer){\n    buffer[i] = buffer[i] + 1;\n    printf(\"%c\",buffer[i]);\n}\n\nint main(){\n    encrypt(5,\"hello\");\n}\n</code></pre>\n\n<p>I'm expecting this to return <code>ifmmp</code>, but instead I get the error</p>\n\n<blockquote>\n  <p>\"Segmentation fault (core dumped)\".</p>\n</blockquote>\n\n<p>If I get rid of the line<br>\n<code>buffer[i] = buffer[i] + 1</code><br>\nand<br>\n<code>printf(\"%c\",buffer[i]+1)</code><br>\nthen I get the desired result. But I would like to actually change the value stored in that address. How can I do this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1464716521, "post_id": 37552016, "comment_id": 62593076, "body": "For anyone coming from a <i>lower</i> level language C is &quot;easy and safe&quot; which is why is was developed in the first place: to encapsulate assembler working practices. But uninitialised variables,  uninitialised memory allocations, and exceeding array bounds are dangerous. The compiler can warn against the first, but the others are your responsibility."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464722014, "post_id": 37552016, "comment_id": 62596384, "body": "... and if a function returns a value which is not of immediate concern, such as <code>scanf</code>, or one that returns a pointer, such as <code>fopen</code> you must test that value. It is very easy to write code that ignores them, and falls over at the first puff of wind."}], "answers": [{"tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": true, "score": 2, "last_activity_date": 1464716341, "last_edit_date": 1464716341, "creation_date": 1464716031, "answer_id": 37552196, "question_id": 37552016, "link": "https://stackoverflow.com/questions/37552016/what-are-some-modern-c-idioms-guidelines-to-prevent-memory-related-bugs/37552196#37552196", "title": "What are some modern C idioms/guidelines to prevent memory related bugs?", "body": "<p>There are many techniques reffered to as <em>defensive programming</em>, too many to list here. For instance, you may adopt to always set pointer to <code>NULL</code>, when you free the allocated memory:</p>\n\n<pre><code>free(p);\np = NULL;\n</code></pre>\n\n<p>This avoids leaving <code>p</code> as a <em>dangling pointer.</em> The one obvious benefit is that if one calls <code>free</code> again on <code>p</code>, it would not do anything, so you potentially avoid the <em>double free</em> issue.</p>\n\n<p>The second method is to use numerous tools that may help you track the ubiqutous mistakes such as buffer overflow, just to mention Valgrind and AddressSanitizer.</p>\n"}], "owner": {"reputation": 1005, "user_id": 3711299, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/726d2e92665d2124bda3d90757897b60?s=128&d=identicon&r=PG&f=1", "display_name": "user3335", "link": "https://stackoverflow.com/users/3711299/user3335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "closed_date": 1464716392, "accepted_answer_id": 37552196, "answer_count": 1, "score": -1, "last_activity_date": 1464716341, "creation_date": 1464715415, "question_id": 37552016, "link": "https://stackoverflow.com/questions/37552016/what-are-some-modern-c-idioms-guidelines-to-prevent-memory-related-bugs", "closed_reason": "Needs more focus", "title": "What are some modern C idioms/guidelines to prevent memory related bugs?", "body": "<p>In the past few years, I can see a lot of C++ best practices recommended everywhere. The C++ guidelines aren't applicable to C even to a smaller degree. Particularly for people coming from a relatively high level language like C++ or Java (like myself), programming in C seems very dangerous.</p>\n\n<p>I know that C is too low level a language to make any guarantees, but is there anything I must be careful of while writing C code so that I can minimize the chances of memory related bugs? </p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "edited": false, "score": 0, "creation_date": 1464715706, "post_id": 37552015, "comment_id": 62592660, "body": "Is it necessarily to have an array with those zeros? You can simply insert them while outputting array."}, {"owner": {"reputation": 69, "user_id": 6124417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c38ce20efeb6c8ac71f39e13c7f3e69?s=128&d=identicon&r=PG&f=1", "display_name": "user6124417", "link": "https://stackoverflow.com/users/6124417/user6124417"}, "reply_to_user": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "edited": false, "score": 0, "creation_date": 1464715750, "post_id": 37552015, "comment_id": 62592689, "body": "No it is not necessary but would help me to learn either way"}], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": -1, "last_activity_date": 1464716197, "creation_date": 1464716197, "answer_id": 37552243, "question_id": 37552015, "link": "https://stackoverflow.com/questions/37552015/insert-a-number-between-every-element-in-my-array-in-c/37552243#37552243", "title": "Insert a number between every element in my array in C", "body": "<p>You have to multiply the indices by 2:</p>\n\n<pre><code>for(i = 0; i &lt; n; ++i) { //copies and sets the arrays the same\n    a2[2 * i] = a1[i];\n}\n</code></pre>\n\n<p>Not only that, odd-indexed elements of <code>a2</code> should be set to zero. You can do it explicitly in loop:</p>\n\n<pre><code>for(i = 0; i &lt; n; ++i) a2[2 * i + 1] = 0;\n</code></pre>\n\n<p>But simpler is to first initialize the array with zeroes:</p>\n\n<pre><code>int a2[2 * n] = {0};\n</code></pre>\n\n<p>Even-numbered elements will later be overwritten with elements of <code>a1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5754, "user_id": 2867061, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd59dfa471d99e7c625b5dcb191ec8ae?s=128&d=identicon&r=PG&f=1", "display_name": "user31264", "link": "https://stackoverflow.com/users/2867061/user31264"}, "is_accepted": false, "score": 0, "last_activity_date": 1464716328, "creation_date": 1464716328, "answer_id": 37552281, "question_id": 37552015, "link": "https://stackoverflow.com/questions/37552015/insert-a-number-between-every-element-in-my-array-in-c/37552281#37552281", "title": "Insert a number between every element in my array in C", "body": "<pre><code>int n = 0; \nint number = 0; \nint a1[n]; \nint a2[2 * n];\n</code></pre>\n\n<p>Congratulations, now <code>a1</code> and <code>a2</code> are arrays of zero length.  Even if you change <code>n</code> later, this doesn't affect the lengths of arrays.  In C, you cannot make an array longer or shorter.</p>\n\n<p>Try <code>int*</code> and <code>calloc</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464716526, "post_id": 37552295, "comment_id": 62593080, "body": "<a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">Variable length arrays</a> do allow you to create stack-allocated arrays with runtime-defined size."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464716556, "post_id": 37552295, "comment_id": 62593096, "body": "&quot;you can&#39;t create stack-allocated ... with runtime-defined size&quot; --&gt; Are you saying code can not use <code>scanf(&quot;%d&quot;, &amp;n); int a1[n];</code>?  (VLA in C99)"}, {"owner": {"reputation": 2323, "user_id": 4642859, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cbbd31a436ff596d2ea6eebbb5ca477c?s=128&d=identicon&r=PG&f=1", "display_name": "3kt", "link": "https://stackoverflow.com/users/4642859/3kt"}, "edited": false, "score": 0, "creation_date": 1464716558, "post_id": 37552295, "comment_id": 62593101, "body": "Those <code>malloc</code> should be freed."}, {"owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464716632, "post_id": 37552295, "comment_id": 62593143, "body": "@chux exactly I am"}, {"owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "reply_to_user": {"reputation": 2323, "user_id": 4642859, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cbbd31a436ff596d2ea6eebbb5ca477c?s=128&d=identicon&r=PG&f=1", "display_name": "3kt", "link": "https://stackoverflow.com/users/4642859/3kt"}, "edited": false, "score": 0, "creation_date": 1464716650, "post_id": 37552295, "comment_id": 62593155, "body": "@3kt does it matter?"}, {"owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464716716, "post_id": 37552295, "comment_id": 62593185, "body": "@user3386109 I dont quite understand you, but I want to say that only way to create array with <code>input-defined</code> size is to use <code>malloc</code> (or calloc, or other functions)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1464716807, "post_id": 37552295, "comment_id": 62593218, "body": "C99 allows <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">Variable length arrays</a> as commented by @user3386109 which contradicts the first sentence."}, {"owner": {"reputation": 2323, "user_id": 4642859, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cbbd31a436ff596d2ea6eebbb5ca477c?s=128&d=identicon&r=PG&f=1", "display_name": "3kt", "link": "https://stackoverflow.com/users/4642859/3kt"}, "edited": false, "score": 0, "creation_date": 1464716835, "post_id": 37552295, "comment_id": 62593228, "body": "@LibertyPaul it&#39;s a good habit to have in my opinion. It&#39;s not <i>required</i> in this case though, but the matter has already been discussed <a href=\"http://stackoverflow.com/questions/4339134/does-every-malloc-call-have-to-be-freed\">here</a>"}, {"owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464716904, "post_id": 37552295, "comment_id": 62593267, "body": "@chux I didn&#39;t knew anything about it, but VLA is now deprecated so you shouldn&#39;t use it anyway"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464717012, "post_id": 37552295, "comment_id": 62593351, "body": "@LibertyPaul variable length arrays are optional in C11.  Please provide citation for &quot; VLA is now deprecated&quot;."}, {"owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464717215, "post_id": 37552295, "comment_id": 62593477, "body": "@chux <code>although subsequently relegated in C11 to a conditional feature which implementations are not required to support</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1464717821, "post_id": 37552295, "comment_id": 62593868, "body": "Your citation, (not part of the C spec) does not imply depreciation.  The C11 has dozens of attributes that are <i>not required to support</i>.  This is not the same as <i>depreciated</i>.  Further the issue is what is possible, not necessary prudent, hence my initial comment concerning &quot;can&#39;t create stack-allocated or static array&quot; when C99 and select C11 code can do."}], "tags": [], "owner": {"reputation": 1047, "user_id": 2101084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/huVYh.jpg?s=128&g=1", "display_name": "LibertyPaul", "link": "https://stackoverflow.com/users/2101084/libertypaul"}, "is_accepted": false, "score": 0, "last_activity_date": 1464716366, "creation_date": 1464716366, "answer_id": 37552295, "question_id": 37552015, "link": "https://stackoverflow.com/questions/37552015/insert-a-number-between-every-element-in-my-array-in-c/37552295#37552295", "title": "Insert a number between every element in my array in C", "body": "<p>First of all, you can't create <code>stack-allocated</code> or <code>static</code> array with runtime-defined size.</p>\n\n<pre><code>int a[N]; // N should be determined during compilation\n</code></pre>\n\n<p>You should use <code>heap-alloceted</code> or <code>dynamic</code> array:</p>\n\n<pre><code>int *a;\na = (int *)malloc(2 * n, sizeof(int)); // n may be defined by user input\n</code></pre>\n\n<p>There is no way to resize array without moving it to another place, and you can just create a new one (larger then first) and fill it with source numbers and zeroes:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int n = 0; \n    printf(\"Enter the length of the array: \");  \n    scanf(\"%d\", &amp;n);\n\n    int *a1 = (int *)malloc(n, sizeof(int));\n    int *a2 = (int *)malloc(n * 2, sizeof(int));\n\n    printf(\"Enter the elements of the array: \");\n\n    int i, number;\n    for(i = 0; i &lt; n; i++){ //adds values to first array\n        scanf(\"%d\",&amp;number);\n        a1[i] = number;\n    }\n\n    for(i = 0; i &lt; n; i++){ //copies and sets the arrays the same\n        a2[i * 2] = a1[i];\n        a2[i * 2 + 1] = 0;\n    }\n\n    for(i = 0; i &lt; n * 2; ++i){\n        printf(\"%d \", a2[i]);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 6124417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c38ce20efeb6c8ac71f39e13c7f3e69?s=128&d=identicon&r=PG&f=1", "display_name": "user6124417", "link": "https://stackoverflow.com/users/6124417/user6124417"}, "edited": false, "score": 0, "creation_date": 1464717076, "post_id": 37552325, "comment_id": 62593392, "body": "thank you so much this was the for loop I needed! A little more complex then I would of thought of myself."}], "tags": [], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "is_accepted": true, "score": 2, "last_activity_date": 1464856496, "last_edit_date": 1464856496, "creation_date": 1464716475, "answer_id": 37552325, "question_id": 37552015, "link": "https://stackoverflow.com/questions/37552015/insert-a-number-between-every-element-in-my-array-in-c/37552325#37552325", "title": "Insert a number between every element in my array in C", "body": "<p>Assuming your arrays are correctly defined and initialized (statically or dynamically), it is just a matter of properly counting during copying:</p>\n\n<pre><code>for(int i = 0; i &lt; n; i++){ \n        a2[i+i] = a1[i]; \n        if(i &lt; n-1) a2[i+i+1] = 0;\n        } \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 529, "user_id": 6386246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vT5In.jpg?s=128&g=1", "display_name": "SCC", "link": "https://stackoverflow.com/users/6386246/scc"}, "is_accepted": false, "score": 0, "last_activity_date": 1464716603, "creation_date": 1464716603, "answer_id": 37552367, "question_id": 37552015, "link": "https://stackoverflow.com/questions/37552015/insert-a-number-between-every-element-in-my-array-in-c/37552367#37552367", "title": "Insert a number between every element in my array in C", "body": "<p>Add below code in last loop.</p>\n\n<p>for ( j=0, i=0; i &lt;= n; i++ ) {</p>\n\n<pre><code>a2[j++] = a1[i];\na2[j++] = 0;\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 69, "user_id": 6124417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c38ce20efeb6c8ac71f39e13c7f3e69?s=128&d=identicon&r=PG&f=1", "display_name": "user6124417", "link": "https://stackoverflow.com/users/6124417/user6124417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 37552325, "answer_count": 5, "score": -3, "last_activity_date": 1464856496, "creation_date": 1464715414, "question_id": 37552015, "link": "https://stackoverflow.com/questions/37552015/insert-a-number-between-every-element-in-my-array-in-c", "title": "Insert a number between every element in my array in C", "body": "<p>I am completely stuck when it comes to the C language and inserting into arrays. I have my code below and to explain it say the user wants an array of 3. So the user inputs 4 3 2 into array <code>a1[n]</code>. I need array <code>a2[]</code> to output the same numbers but a zero between each. The end result would be 4 0 3 0 2 0 when <code>a2[]</code> is output. How would I get a zero between every other element?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n    int main() {\n\n    int n = 0; \n    int number = 0; \n    int a1[n]; \n    int a2[2 * n];\n\n    printf(\"Enter the length of the array: \");  \n    scanf(\"%d\", &amp;n);\n\n    printf(\"Enter the elements of the array: \");\n\n    for(i = 0; i &lt; n; i++){ //adds values to first array\n            scanf(\"%d\",&amp;number);\n            a1[i] = number; } \n\n   for(i = 0; i &lt; n; i++){ //copies and sets the arrays the same\n            a2[i] = a1[i]; }\n</code></pre>\n"}, {"tags": ["c", "winapi", "atl"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 6405783, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-0_ctQVASWoo/AAAAAAAAAAI/AAAAAAAAACk/GeG9Ev2E5HY/photo.jpg?sz=128", "display_name": "Fanny ZMN", "link": "https://stackoverflow.com/users/6405783/fanny-zmn"}, "is_accepted": false, "score": 0, "last_activity_date": 1464837924, "creation_date": 1464837924, "answer_id": 37582104, "question_id": 37551685, "link": "https://stackoverflow.com/questions/37551685/how-to-change-the-atl-control-default-width-and-height/37582104#37582104", "title": "How to change the ATL control default width and height?", "body": "<p>Finally,I solved my problem by myself.code blew.</p>\n\n<pre><code>&lt;OBJECT ID=\"PolyCtrl\"  width=\"700\" height=\"500\" CLASSID=\"CLSID:F05493DC-007F-4C6A-A2F9-824B2BEA5BAB\"&gt;&lt;/OBJECT&gt;\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6405783, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-0_ctQVASWoo/AAAAAAAAAAI/AAAAAAAAACk/GeG9Ev2E5HY/photo.jpg?sz=128", "display_name": "Fanny ZMN", "link": "https://stackoverflow.com/users/6405783/fanny-zmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464837924, "creation_date": 1464714174, "last_edit_date": 1464714814, "question_id": 37551685, "link": "https://stackoverflow.com/questions/37551685/how-to-change-the-atl-control-default-width-and-height", "title": "How to change the ATL control default width and height?", "body": "<p>I am using <code>ATL control</code> to make my <code>ActiveX</code>, but the problem is when I start the app. The width and height always are fixed and small.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8Saja.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Saja.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But I want to change the width. I changed the code below, but it did not work. So how to solve this problem?</p>\n\n<pre><code>HRESULT OnDraw(ATL_DRAWINFO&amp; di)\n{\n    RECT&amp; rc = *(RECT*)di.prcBounds;\n    rc.left = 0;\n    rc.top = 0;\n    rc.right = 700;\n    rc.bottom = 500;\n\n    HDC hdc = di.hdcDraw;\n    TCHAR wcScore[20];\n    PAINTSTRUCT ps;\n    initialize(hdc,rc);\n    paint(hdc,rc);\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list", "hashtable"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1464712696, "post_id": 37551167, "comment_id": 62590952, "body": "Well. This line is probably wrong: <code>new-&gt;string = str;</code>. This is not how you copy strings. Unless youa re always allocating a new string before passing to the function."}, {"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1464713138, "post_id": 37551167, "comment_id": 62591207, "body": "Thanks @EugeneSh., I just changed it to <code>new-&gt;string = strdup(str)</code>, and changed it in my makefile to -std=gnu99, because apparently c99 doesn&#39;t support that function. Unfortunately it still doesn&#39;t solve the problem, or at least not this one."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1464713620, "post_id": 37551167, "comment_id": 62591504, "body": "Where do you check that the string is not already in the hash table? (Check <code>man strdup</code> for the Feature Test Macro requirements to enable <code>strdup</code>. tl;dr: put <code>#define _XOPEN_SOURCE 700</code>  at the very top of your source file, before any <code>#include</code> directive.)"}, {"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1464713912, "post_id": 37551167, "comment_id": 62591683, "body": "Thanks @rici, I just added the other function."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1464717502, "post_id": 37551167, "comment_id": 62593655, "body": "Don&#39;t you find it odd that the lookup function never follows the linked list? What&#39;s the point of linking nodes if you don&#39;t use the links?"}, {"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "edited": false, "score": 0, "creation_date": 1464719938, "post_id": 37551167, "comment_id": 62595158, "body": "Oh dear, it seems I was adding to the wrong hash table in the function call."}, {"owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1464720017, "post_id": 37551167, "comment_id": 62595199, "body": "@rici: I&#39;m still new to C, and I see that this format doesn&#39;t really use the functionality of linked lists. I am mostly just using them to store other values. I see that this is a problem, and maybe at some point I&#39;ll be able to come back and address it. Thanks!"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1464720337, "post_id": 37551167, "comment_id": 62595410, "body": "Good luck! I think you are confusing two completely different types of hash tables: open-addressing and separate-chaining. The <a href=\"https://en.wikipedia.org/wiki/Hash_table#Collision_resolution\" rel=\"nofollow noreferrer\">Wikipedia article on Hash Tables</a> has a pretty good discussion with sample pseudo-code."}], "owner": {"reputation": 207, "user_id": 4348604, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Xi2ZP.jpg?s=128&g=1", "display_name": "chicago.coder", "link": "https://stackoverflow.com/users/4348604/chicago-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464713857, "creation_date": 1464712470, "last_edit_date": 1464713857, "question_id": 37551167, "link": "https://stackoverflow.com/questions/37551167/adding-twice-in-hash-table-in-c", "title": "Adding twice in hash table in C", "body": "<p>Based on print statements in the rehashing section, I can see that the same string is getting added to the table multiple times. I believe the problem is in this function, although I can't see where. The print statement below return is never executed, so I know that the function actually executes. </p>\n\n<p>Any ideas on where the problem is, or how I should go about finding it? Thanks. The full code on our repository is here:  </p>\n\n<p><a href=\"https://github.com/csking1/buddhism/blob/master/Finding/hash_tables.c\" rel=\"nofollow\">https://github.com/csking1/buddhism/blob/master/Finding/hash_tables.c</a></p>\n\n<pre><code>void add_to_table(HashTable *h, char* str, LinkedList* new){\n  unsigned int hashval = hash(h, str);\n  LinkedList *list;\n\n  // walk through the table and check for the first free spot, start at hash val and go to the top\n  for (int i = hashval; i&lt;h-&gt;size; i++){\n    list = h-&gt;table[i];\n    if (list == NULL){\n        new-&gt;next = h-&gt;table[i];\n        h-&gt;table[i] = new;\n        new-&gt;string = str;\n        return;\n        printf(\"%s\\n\", \"didn't return\");\n    }\n  }\n  // start at the bottom of the table, check for the first free spot up to hash val, then return\n  for (int i = 0; i &lt; hashval; i++){\n    list = h-&gt;table[i];\n    if (list == NULL){\n        new-&gt;next = h-&gt;table[i];\n        h-&gt;table[i] = new;\n        new-&gt;string = str;\n        return;\n    }\n  }\n}\n</code></pre>\n\n<p>For a full view, here's the string lookup function. This gets called one or two lines above the add_to_table() function, and returns if the string is already there.</p>\n\n<pre><code>LinkedList *lookup_string(HashTable *h, char *str){\n  LinkedList *list;\n  unsigned int hashval = hash(h, str);\n\n  for (int i = hashval; i &lt; h-&gt;size; i++){\n    list = h-&gt;table[i];\n    if (list == NULL){\n      return NULL;\n    }\n    if (list != NULL){\n      if (strcmp(str, list-&gt;string) == 0){\n        return list;\n      }\n    }\n  }\n  for (int i = 0; i &lt; hashval; i++){\n    list = h-&gt;table[i];\n    if (list == NULL){\n      return NULL;\n    }\n    if (list != NULL){\n      if (strcmp(str, list-&gt;string) == 0){\n        return list;\n      }\n    }\n  }\n  return NULL;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464712564, "post_id": 37551122, "comment_id": 62590876, "body": "Your image is a small amount of text: please post it as text as part of the question. The idea of the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> is so that readers can copy and try the code, and its input data."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1464712947, "post_id": 37551122, "comment_id": 62591092, "body": "Not checking the result of <code>fscanf()</code> is the <a href=\"http://www.dictionary.com/browse/perdition\" rel=\"nofollow noreferrer\"><i>Road to Perdition</i></a>,"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1464713037, "post_id": 37551122, "comment_id": 62591149, "body": "What is the purpose of <code>fgets</code> before the loop? And what is the loop control <code>(!feof(gstPtr));</code> [sic] supposed to be? Apart from being cautious about the <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">use of <code>feof</code></a> the way to control the loop is with the return value from <code>fscanf</code>, such as <code>while(fscanf(...) == 4) {...}</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1464713689, "post_id": 37551122, "comment_id": 62591541, "body": "... or by reading a whole line with <code>while fgets(line, sizeof line, gstPtr) != NULL) { &#47;* now process with sscanf *&#47; }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1464713263, "post_id": 37551364, "comment_id": 62591280, "body": "Unlimited width specifiers like <code>&quot;%[^;]&quot;</code> are about as good as <code>gets()</code>."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1464713428, "last_edit_date": 1464713428, "creation_date": 1464713116, "answer_id": 37551364, "question_id": 37551122, "link": "https://stackoverflow.com/questions/37551122/how-to-ignore-in-a-file-when-fscanf/37551364#37551364", "title": "How to ignore &#39;;&#39; in a file when fscanf?", "body": "<p>Problems with the format string:</p>\n\n<ol>\n<li><p>When you use the <code>%[^;]</code> format specifier, you should not add <code>s</code> to it. It is implied that the expected data is string.</p></li>\n<li><p>Using <code>%[^;]</code> without specifying a width can lead to reading more data than your variable can hold. Always specify the maximum number of characters you expect to read.</p></li>\n<li><p>Use of <code>%[^;]d</code> and <code>%[^;]f</code> does not allow you to read an <code>int</code> and a <code>float</code>.</p></li>\n<li><p>Avoid using <code>\\n</code> in the format string. That will lead <code>fscanf</code> to read and discard all characters until the next non-whitespace character. It does not read just the newline character. It is better to add another line to skip everything until and including the newline.</p></li>\n</ol>\n\n<p>Use:</p>\n\n<pre><code>fscanf(gstPtr,\"%5[^;];%29[^;];%f;%d\",gstitem, gstname, &amp;gstprice, &amp;gstquant);\nint c;\nwhile ( (c = fgetc(gstPtr)) != EOF &amp;&amp; c != '\\n');\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6405599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1234542973246389/picture?type=large", "display_name": "Victor Lee", "link": "https://stackoverflow.com/users/6405599/victor-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "accepted_answer_id": 37551364, "answer_count": 1, "score": 0, "last_activity_date": 1464713428, "creation_date": 1464712338, "last_edit_date": 1464712390, "question_id": 37551122, "link": "https://stackoverflow.com/questions/37551122/how-to-ignore-in-a-file-when-fscanf", "title": "How to ignore &#39;;&#39; in a file when fscanf?", "body": "<p>How to avoid reading semicolon ; in FILE and save them in variable?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void)\n{\nchar gstitem[6], gstname[30],;\nint gstquant, itemquant;\nfloat gstprice;\n\nchar string[10];\nprintf(\"Purchase items fuction\\n\\n\");\nFILE *gstPtr;   //pointer to the gst.txt\ngstPtr = fopen ( \"gst.txt\", \"r+\" );\nprintf(\"Enter an item code: \");\nfgets(string,10,stdin);\n(!feof(gstPtr));\n{   \n\n    fscanf(gstPtr,\"%[^;]s %[^;]s %[^;]f %[^;]d\\n\",gstitem,gstname,&amp;gstprice,&amp;gstquant);\n    printf(\"%s  %s  %f  %s\\n\",gstitem,gstname,gstprice,gstquant);\n    }\nfclose(gstPtr);\n}\n</code></pre>\n\n<p>This is the file that i want to fscanf vv</p>\n\n<p><a href=\"http://i.stack.imgur.com/1fcFW.png\" rel=\"nofollow\">gst.txt</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1464712113, "post_id": 37551010, "comment_id": 62590598, "body": "What operating system? What C compiler? What C standard library? Did you <i>carefully</i> read the documentation of <code>fgets</code> &amp; of <code>fscanf</code> ? Which one did you read? Did you debug your code using a debugger? Why don&#39;t you test against failure (e.g. of <code>fscanf</code>)?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1464712284, "post_id": 37551010, "comment_id": 62590699, "body": "Don&#39;t <code>fflush(stdin)</code>. It&#39;s behavior is undefined."}, {"owner": {"reputation": 9, "user_id": 4959493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BYWNX.jpg?s=128&g=1", "display_name": "ggaliero", "link": "https://stackoverflow.com/users/4959493/ggaliero"}, "edited": false, "score": 0, "creation_date": 1464712460, "post_id": 37551010, "comment_id": 62590799, "body": "The operating system is ubuntu 14.04 lts. I am using eclipse Luna as IDE. I checked the documentation of both fgets and fscanf but could not finde any relevant description. I used www.tutorialspoint.com. Eventually I did not try a debugger. Thanks for the tips I will try what you said!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1464712594, "post_id": 37551010, "comment_id": 62590902, "body": "&quot; I checked the documentation of both fgets and fscanf but could not finde any relevant description&quot; - Sorry, but this is unbelievable. Ubunut provides comprehensive man-pages for both and any simple online-search will show the required information."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1464712901, "post_id": 37551010, "comment_id": 62591059, "body": "@user3121023 I think thins could be worth an answer"}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "edited": false, "score": 0, "creation_date": 1464713050, "post_id": 37551010, "comment_id": 62591157, "body": "I tested your code (both linux and windows platform) and it works fine. However I would avoid the <code>fflush(stdin)</code> statements."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1464716716, "post_id": 37551010, "comment_id": 62593186, "body": "what does delete_char do?"}, {"owner": {"reputation": 9, "user_id": 4959493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BYWNX.jpg?s=128&g=1", "display_name": "ggaliero", "link": "https://stackoverflow.com/users/4959493/ggaliero"}, "edited": false, "score": 0, "creation_date": 1465566055, "post_id": 37551010, "comment_id": 62969099, "body": "delete_char looks for the char &#39;\\n&#39; and replaces it by &#39;\\0&#39;. If &#39;\\n&#39; is not within the char array, it does nothing."}], "owner": {"reputation": 9, "user_id": 4959493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BYWNX.jpg?s=128&g=1", "display_name": "ggaliero", "link": "https://stackoverflow.com/users/4959493/ggaliero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1464761387, "answer_count": 0, "score": 0, "last_activity_date": 1464712175, "creation_date": 1464711920, "last_edit_date": 1464712175, "question_id": 37551010, "link": "https://stackoverflow.com/questions/37551010/when-using-fgets-in-c", "closed_reason": "Duplicate", "title": "When using fgets in C", "body": "<p>Hi I was trying to implement a library system using C. I defined an abstract type of data called Book with the following fields:</p>\n\n<pre><code>typedef char StringBook     [MAX_LEN];\ntypedef char ISBN           [ISBN_LEN];\n\ntypedef struct {\n    StringBook  title;          /// Title of the book\n    StringBook  author;         /// Author\n    StringBook  editorial;      /// Editorial\n    ISBN        isbn;           /// ISBN\n    int         date;           /// Publication year\n    int         num;            /// Number of copies\n}Book;\n</code></pre>\n\n<p>I defined several functions to set and get the fields of the structure. </p>\n\n<p>In addition in the main function I defined a function, that creates a new book with the data introduced by the keyboard.</p>\n\n<p>void</p>\n\n<pre><code> introduce_book_details(Book* book){\n    StringBook string;\n    ISBN isbn;\n    int date;\n    fprintf(stdout, \"\\nIntroduce the book details: \");\n    fprintf(stdout, \"\\n\\nTitle: \");\n    fgets(string, MAX_LEN, stdin);\n    delete_char(string);\n    fflush(stdin);\n    set_title(book, string);\n    fprintf(stdout, \"Author: \");\n    fgets(string, MAX_LEN, stdin);\n    delete_char(string);\n    fflush(stdin);\n    set_author(book, string);\n    fprintf(stdout, \"Editorial: \");\n    fgets(string, MAX_LEN, stdin);\n    delete_char(string);\n    fflush(stdin);\n    set_editorial(book, string);\n    fprintf(stdout, \"ISBN: \");\n    fgets(isbn, MAX_LEN, stdin);\n    delete_char(isbn);\n    set_isbn(book, isbn);\n    fprintf(stdout, \"Date: \");\n    fscanf(stdin, \"%d\", &amp;date);\n    fflush(stdin);\n    set_date(book, date);\n    set_num(book, 1);\n}\n</code></pre>\n\n<p>So far so good. In the main function I create a book and call introduce_book_details and works. The problem comes if I use the function fscanf before. For instance, I want to create a menu with several options from 1 to 8. The option is introduced by the keyboard, and if it is 1, then the function introduce_book_details is called. However if I introduce this in the main function as:</p>\n\n<pre><code>int main() {\n    Book book;\n    int option;\n\n    fprintf(stdout, \"Introduce the option: \");\n    fscanf(stdin, \"%d\", &amp;option);\n    fflush(stdin);\n\n    if(option == 1) {\n       introduce_book_details(&amp;book);\n       print_book(book);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Then the console shows this:</p>\n\n<pre><code>Introduce the option: 1\nIntroduce the book details: \nTitle: Author: \n</code></pre>\n\n<p>Meaning that the I am not able to introduce the title and the first field I can introduce is the author (being title, NULL). If in the main function I remove the lines to introduce an option by keyboard the program works good. So I believe this has something to do with the fscanf or fflush functions. Any tip or help is welcome. Thanks beforehand.</p>\n"}, {"tags": ["c", "matlab", "simulink", "mex"], "answers": [{"comments": [{"owner": {"reputation": 4299, "user_id": 156525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b540a59cb2b0902d0410fa84f437379b?s=128&d=identicon&r=PG", "display_name": "Navan", "link": "https://stackoverflow.com/users/156525/navan"}, "edited": false, "score": 1, "creation_date": 1464716124, "post_id": 37551476, "comment_id": 62592874, "body": "That option guarantees that your s-function is not throwing exceptions that cause long jumps in code. It is possible this option is masking some other problem that is causing the crash. Make sure you are not overwriting any memory in mdlOutputs."}, {"owner": {"reputation": 576, "user_id": 2245872, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0a0a05a01e95badfdaea6bc1d3b7fa81?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Pereira", "link": "https://stackoverflow.com/users/2245872/jo%c3%a3o-pereira"}, "reply_to_user": {"reputation": 4299, "user_id": 156525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b540a59cb2b0902d0410fa84f437379b?s=128&d=identicon&r=PG", "display_name": "Navan", "link": "https://stackoverflow.com/users/156525/navan"}, "edited": false, "score": 0, "creation_date": 1464776470, "post_id": 37551476, "comment_id": 62618860, "body": "Yeah you are correct. the thing is, how do I make sure no overwrites of memory are happening? Within Matlab + Visual Studio it is pretty difficult"}], "tags": [], "owner": {"reputation": 576, "user_id": 2245872, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0a0a05a01e95badfdaea6bc1d3b7fa81?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Pereira", "link": "https://stackoverflow.com/users/2245872/jo%c3%a3o-pereira"}, "is_accepted": false, "score": 0, "last_activity_date": 1464713464, "creation_date": 1464713464, "answer_id": 37551476, "question_id": 37550409, "link": "https://stackoverflow.com/questions/37550409/matlab-crashes-with-s-function-after-mdloutputs/37551476#37551476", "title": "Matlab crashes with S-function after mdlOutputs", "body": "<p>I think that I finally found out the solution (even though I quite don't understand it yet).</p>\n\n<p>In the <code>mdlInitializeSizes(SimStruct *S)</code> I substituted <code>ssSetOptions(S, 0);</code> by <code>ssSetOptions(S, SS_OPTION_EXCEPTION_FREE_CODE);</code> like it is suggested <a href=\"http://www.mathworks.com/help/simulink/sfg/error-handling.html\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 576, "user_id": 2245872, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0a0a05a01e95badfdaea6bc1d3b7fa81?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Pereira", "link": "https://stackoverflow.com/users/2245872/jo%c3%a3o-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464713464, "creation_date": 1464710134, "last_edit_date": 1464710583, "question_id": 37550409, "link": "https://stackoverflow.com/questions/37550409/matlab-crashes-with-s-function-after-mdloutputs", "title": "Matlab crashes with S-function after mdlOutputs", "body": "<p>I'm doing my \"main\" S-function based on the Matlab template with <code>mdlStart</code> <code>mdlOutputs</code>, etc, which communicates with some Ansi C files that I had, and this S-Function is used in Simulink. I compiled the files correctly with <strong>mex</strong> and in order to debug I'm using Visual Studio 2015. I can set and use breakpoints so everything is working fine.</p>\n\n<p>The problem is, after finishing 'mdlOutputs' function, where all the contents are correctly printed into Matlab the debugging goes into a breakpoint and it goes into 'simulink.c'. After that, the Debug is broken saying that \"libmex.pdb\" cannot be found.</p>\n\n<p>If I run the Simulink model without Visual Studio in the loop, Matlab just crashes and stops working.</p>\n\n<p>So, any idea on how to check properly where it is giving me an error? Also, do you have any clue on why the process crashes after leaving <code>mdlOutputs</code> and before entering <code>mdlTerminate</code>? What happens in-between these two functions?</p>\n\n<p>I'm using Windows 7, 64-bit and Matlab 2012b (I'm going to try and run it in the 2015b).</p>\n"}]