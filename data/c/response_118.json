[{"tags": ["c", "language-lawyer", "typedef", "sizeof"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 9, "creation_date": 1492038520, "post_id": 43380999, "comment_id": 73824126, "body": "I believe it wouldn&#39;t actually compile, did you not just try it?"}, {"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "edited": false, "score": 2, "creation_date": 1492038660, "post_id": 43380999, "comment_id": 73824154, "body": "I think it would take sizeof(char*)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1492038776, "post_id": 43380999, "comment_id": 73824183, "body": "<a href=\"http://ideone.com/LU3HBw\" rel=\"nofollow noreferrer\">DEMO</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1492038982, "post_id": 43380999, "comment_id": 73824247, "body": "My compiler (gcc 6.3.0)  error-ed with  &quot;jimmypage&#39; redeclared as different kind of symbol&quot; for <code>jimmypage *jimmypage;</code>  What compiler/version are you using?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1492092651, "post_id": 43380999, "comment_id": 73850081, "body": "It&#39;s also easy to avoid the confusion by omitting the parentheses. After all, <code>sizeof</code> is an operator, not a function. If the <code>typedef char jimmypage;</code> was in a surrounding block, and <code>jimmypage *jimmypage;</code> in an inner block, the code compiles. Then <code>sizeof jimmypage</code> always refers to the size of the pointer type (<code>char *</code>); and <code>sizeof *jimmypage</code> always refers to the size of the pointed to type (<code>char</code>). This last one has the benefit that it&#39;ll always yield the correct size. If you change the variable declaration to <code>long *jimmypage;</code>, then <code>sizeof *jimmypage == sizeof long</code>."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1492038735, "post_id": 43381041, "comment_id": 73824173, "body": "The question is about using a variable whose name is the same as a <code>typedef</code>. Your example has nothing like that."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1492038853, "post_id": 43381041, "comment_id": 73824212, "body": "@Barmar Ah - I didn&#39;t realise that. I&#39;ve amended my answer."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1492038918, "post_id": 43381041, "comment_id": 73824230, "body": "You can&#39;t have two variables with the same name in the same scope."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1492038965, "post_id": 43381041, "comment_id": 73824244, "body": "@Barmar Fixed again, sorry!"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1492038984, "post_id": 43381041, "comment_id": 73824250, "body": "Please use <code>&quot;%zu&quot;</code> and not <code>&quot;%d&quot;</code> to print <code>sizeof</code> expressions."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1492039206, "post_id": 43381041, "comment_id": 73824316, "body": "@aschepler From what I can tell <code>%zu</code> is a C++11 feature, is it in C99 or C11?"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 3, "creation_date": 1492039341, "post_id": 43381041, "comment_id": 73824347, "body": "@Dai I think it&#39;s actually originally a C99 feature :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1492039955, "post_id": 43381041, "comment_id": 73824533, "body": "The old school portable method of printing <code>sizeof(...)</code> is <code>printf(&quot;synonym: %lu\\n&quot;, (unsigned long) sizeof(synonym));</code>  Works also for most modern implementations too."}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": -1, "last_activity_date": 1492038955, "last_edit_date": 1492038955, "creation_date": 1492038599, "answer_id": 43381041, "question_id": 43380999, "link": "https://stackoverflow.com/questions/43380999/sizeofabcde-in-c-when-abcde-is-both-a-type-and-a-pointer/43381041#43381041", "title": "sizeof(abcde) in C when abcde is both a type and a pointer", "body": "<p>If you're asking about the size of a pointer compared to a value:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef char synonym;\n\nint main()\n{\n    synonym* ptr;\n    synonym  val;\n\n    printf(\"ptr: %d\\n\", sizeof(ptr));\n    printf(\"val: %d\\n\", sizeof(val));\n\n    return 0;\n}\n</code></pre>\n\n<p>Gives me:</p>\n\n<pre><code>ptr: 8\nval: 1\n</code></pre>\n\n<p>If you're asking about which thing (the type or the variable) the compiler will use:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef char synonym;\n\nint main()\n{\n    synonym* synonym;\n\n    printf(\"synonym: %d\\n\", sizeof(synonym));\n\n    return 0;\n}\n</code></pre>\n\n<p>Gives me:</p>\n\n<pre><code>synonym: 8\n</code></pre>\n\n<p>So the local identifier <code>main -&gt; synonym</code> takes precedence over the global <code>typedef char synonym</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": true, "score": 4, "last_activity_date": 1492039764, "last_edit_date": 1492039764, "creation_date": 1492039453, "answer_id": 43381173, "question_id": 43380999, "link": "https://stackoverflow.com/questions/43380999/sizeofabcde-in-c-when-abcde-is-both-a-type-and-a-pointer/43381173#43381173", "title": "sizeof(abcde) in C when abcde is both a type and a pointer", "body": "<p>Let's <a href=\"http://ideone.com/E3srLY\" rel=\"nofollow noreferrer\">make it work</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef char synonym;\n\nint main(void) {\n\n  synonym *synonym;\n  printf(\"sizeof (synonym) = %ld\\n\", (long) sizeof (synonym));\n  return 0;\n}\n</code></pre>\n\n<p>The declaration</p>\n\n<pre><code>synonym *synonym;\n</code></pre>\n\n<p>declares a variable with the name <code>synonym</code> of type pointer to type <code>synonym</code> (equivalent to <code>char</code>) declared in the surrounding block. This declaration <em>shadows</em> the identifier <code>synonym</code> declared in the surrounding block, with the effect that from this point forward to the end of the current block, the identifier <code>synonym</code> will refer to the variable and not the type; that is, in the rest of the block the type name <code>synonym</code> can no longer be used, because <code>synonym</code> is a variable.</p>\n\n<p>Supplementary note:</p>\n\n<p>The declaration is legal because the type was declared in a surrounding block. Trying to declare the variable at the same level as the type</p>\n\n<pre><code>typedef char synonym;\nsynonym *synonym;          // Syntax error: identifier redeclared\n</code></pre>\n\n<p>is a syntax error because the identifier <code>synonym</code> would be redeclared with a different meaning.</p>\n\n<p>Extra supplementary note:</p>\n\n<p>Two words are <em>synonyms</em> if they have the same meaning. Two words with the same form but different meanings are <a href=\"https://en.wikipedia.org/wiki/Homonym\" rel=\"nofollow noreferrer\"><em>homonyms</em></a>.</p>\n"}], "owner": {"reputation": 166, "user_id": 7859119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d8ec59852f6cb329265971c0b39aceb?s=128&d=identicon&r=PG&f=1", "display_name": "Kurt Weber", "link": "https://stackoverflow.com/users/7859119/kurt-weber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 43381173, "answer_count": 2, "score": -4, "last_activity_date": 1492039764, "creation_date": 1492038313, "last_edit_date": 1492038521, "question_id": 43380999, "link": "https://stackoverflow.com/questions/43380999/sizeofabcde-in-c-when-abcde-is-both-a-type-and-a-pointer", "title": "sizeof(abcde) in C when abcde is both a type and a pointer", "body": "<p>Let me preface this by acknowledging that it's easy enough to avoid this situation by naming types and variables in a way that they don't overlap.</p>\n\n<p>Nevertheless, I'm curious what would happen in the following case:</p>\n\n<pre><code>typedef char jimmypage;\n\njimmypage *jimmypage;\n</code></pre>\n\n<p>Would <code>sizeof(jimmypage)</code> be equivalent to <code>sizeof(char)</code> or <code>sizeof(char *)</code>?</p>\n"}, {"tags": ["c", "string"], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 1, "last_activity_date": 1492037552, "creation_date": 1492037552, "answer_id": 43380880, "question_id": 43380818, "link": "https://stackoverflow.com/questions/43380818/return-a-certain-value-based-on-the-contents-of-a-string/43380880#43380880", "title": "Return a certain value based on the contents of a string", "body": "<p><strong>No</strong> </p>\n\n<p>You can implement it yourself though, by fishing the first word from the string (e.g. with <code>strtok()</code>), and then based on that substring, return the corresponding number.</p>\n"}, {"comments": [{"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1492041645, "post_id": 43380892, "comment_id": 73824994, "body": "@chux: On the contrary, if <code>values[i]</code> is <code>&quot;Six&quot;</code> and <code>card</code> is <code>&quot;Six of Spades&quot;</code>, then <code>strncmp()</code> here has the useful property of giving a correct answer to the question, when <code>strcmp()</code> has not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1492046915, "post_id": 43380892, "comment_id": 73826210, "body": "@PaulGriffiths \t I stand corrected. (although I would used <code>size_t len</code> to avoid unneeded type changes.) Of course if the deck had a <a href=\"http://www.djmcadam.com/six-handed-five-hundred.html\" rel=\"nofollow noreferrer\">&quot;Fourteen of hearts&quot;</a> that might conflict with `&quot;Four&quot; with 7 handed 500 ... ;-)"}], "tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 5, "last_activity_date": 1492046742, "last_edit_date": 1492046742, "creation_date": 1492037642, "answer_id": 43380892, "question_id": 43380818, "link": "https://stackoverflow.com/questions/43380818/return-a-certain-value-based-on-the-contents-of-a-string/43380892#43380892", "title": "Return a certain value based on the contents of a string", "body": "<pre><code>int cardValue(char* card)\n{    \n    char* values[] = {\"One\", \"Two\", \"Three\" ... };\n    for(int i = 0; i &lt; sizeof(values) / sizeof(values[0]); i++)\n    {\n        size_t len = strlen(values[i]);\n        if (strncmp(values[i], card, len) == 0)\n        {\n           return i + 1;\n        }\n    } \n    return -1; // error\n}\n</code></pre>\n\n<p>You may need some special case handling when you get to Ace, King, Queen etc.</p>\n"}], "owner": {"reputation": 145, "user_id": 7549053, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000153453277/picture?type=large", "display_name": "user43783", "link": "https://stackoverflow.com/users/7549053/user43783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1492057228, "answer_count": 2, "score": 0, "last_activity_date": 1492046742, "creation_date": 1492037111, "last_edit_date": 1492037656, "question_id": 43380818, "link": "https://stackoverflow.com/questions/43380818/return-a-certain-value-based-on-the-contents-of-a-string", "closed_reason": "Not suitable for this site", "title": "Return a certain value based on the contents of a string", "body": "<p>For example if <code>c[20] = \"Six of Spades\"</code>, then 6 is returned, if <code>c[20] = \"Nine of Hearts\"</code>, then 9 is returned, and so on. So the value returned is based only on the first word in the string. Is there a simple method to do such thing?</p>\n"}, {"tags": ["c", "visual-studio-2015", "linked-list", "playing-cards"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1492037203, "post_id": 43380813, "comment_id": 73823761, "body": "When you write code, start with something simple that works perfectly, then add complexity a little at a time. Try writing a linked list of <i>numbers</i>, before you introduce all the complication of playing cards."}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 1, "creation_date": 1492037334, "post_id": 43380813, "comment_id": 73823800, "body": "What, exactly, were your trying to do with <code>temp-&gt;suit[10] = &amp;suit2;</code>?"}, {"owner": {"reputation": 1, "user_id": 7848291, "user_type": "registered", "profile_image": "https://graph.facebook.com/1091700700934124/picture?type=large", "display_name": "Jett Maher", "link": "https://stackoverflow.com/users/7848291/jett-maher"}, "edited": false, "score": 0, "creation_date": 1492037628, "post_id": 43380813, "comment_id": 73823878, "body": "Just using the suit input in that function wasn&#39;t working so I thought I would have to initialize the string to something so I created suit2 and I figured I could just switch it to what I want it to be using strcpy. So basically, I added that in to try anything to get it work"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1492037773, "post_id": 43380813, "comment_id": 73823917, "body": "<code>, char suit)</code> --&gt; <code>, const char *suit)</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1492038142, "post_id": 43380813, "comment_id": 73824009, "body": "<code>temp-&gt;next = NULL; if (*headp == NULL) {         *tailp = *headp = temp;     } else {         *tailp = (*tailp)-&gt;next = temp;     }</code>"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1492038190, "post_id": 43380813, "comment_id": 73824029, "body": "To add one card you allocate memory for three cards. That&#39;s a red flag right there, think about that. It also seems like you&#39;re trying to optimize by passing around the head and tail, but you&#39;re struggling with a basic linked list. I&#39;d suggest keeping it as simple as possible."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1492038326, "post_id": 43380813, "comment_id": 73824078, "body": "<code>struct card_s * next;</code> --&gt; <code>struct node * next;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1492097385, "post_id": 43380813, "comment_id": 73853555, "body": "when calling any of the heap allocation functions: (malloc, calloc, realloc) 1) the returned value has type <code>void*</code> so can be assigned to any other pointer.  Casting just clutters the code, making understanding, debugging, etc much more difficult.  2)  always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1492097612, "post_id": 43380813, "comment_id": 73853685, "body": "the <code>SPADE</code>, <code>CLUB</code>, <code>DIAMOND</code>, and <code>HEART</code> are strings, but are passed to a function expecting a single char.  Suggest re-defining them similar to: #define SPADE 0x06, etc"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1492097793, "post_id": 43380813, "comment_id": 73853761, "body": "nothing from the <code>math.h</code> header file is being used in the posted code.  including header files those contents are not used is a poor programming practice and can create problems later on."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1492098220, "post_id": 43380813, "comment_id": 73854039, "body": "this line: <code>temp-&gt;suit[10] = &amp;suit2;</code> is assigning the address of a parameter (that is on the local stack) to one past the end of the array <code>suit[]</code>   Perhaps you meant: <code>temp-&gt;suit[0] = suit;</code>   This line: <code>strcpy(temp-&gt;suit, suit2);</code> is pure nonsense.  Suggest elimination of that statement."}], "answers": [{"tags": [], "owner": {"reputation": 3940, "user_id": 2830116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SnjA4.jpg?s=128&g=1", "display_name": "Rohan Kumar", "link": "https://stackoverflow.com/users/2830116/rohan-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1492041650, "last_edit_date": 1492041650, "creation_date": 1492040356, "answer_id": 43381302, "question_id": 43380813, "link": "https://stackoverflow.com/questions/43380813/creating-a-deck-of-cards-using-linked-list/43381302#43381302", "title": "Creating a Deck of Cards using linked list", "body": "<p>As others pointed out in comments you were doing lots of mistakes like allocating card three times instead of one, passing a string literal into a char parameter and overwriting the <code>tailp</code> right away without checking it's previous value, After all this is what which your add_card element would manipulate for most of the time. I tested your code and i corrected some of the mistakes. I was able to see cards :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#define SPADE \"SPADE\"\n#define CLUB \"CLUB\"\n#define DIAMONDS \"DIAMOND\"\n#define HEART \"HEART\"\n\ntypedef struct node {\n    int face_val;\n    char suit[10];\n    struct node * next;\n} card;\n\n\nvoid add_card(card **headp, card **tailp, int face, const char* suit) {\n    card *temp = (card*)malloc(sizeof(card)); // allocate new card\n    temp-&gt;face_val = face; // assign face val\n    strcpy(temp-&gt;suit, suit); // assign suit\n\n    if (*headp == NULL) {\n        *headp = temp;\n        *tailp = temp;\n    }\n    else {\n        (*tailp)-&gt;next = temp;\n        *tailp = temp;\n    }\n}\n\n\nvoid create_deck(card **headp, card **tailp) {\n    int i = 1;\n    while (i &lt;= 13) {\n        int j = 1;\n        while (j &lt;= 4) {\n            if (j == 1) \n                add_card(headp,tailp,i,SPADE);\n            if (j == 2) \n                add_card(headp,tailp,i,HEART);\n            if (j == 3) \n                add_card(headp,tailp,i,DIAMONDS);\n            if (j == 4) \n                add_card(headp,tailp,i,CLUB);\n            j++; \n        }\n        i++;\n    }\n}\n\nvoid printDeck(card *curNode) {\n    while(curNode != NULL) {\n      printf(\"face val : %d, SUIT : %s\\n\", curNode-&gt;face_val, curNode-&gt;suit);\n      curNode = curNode-&gt;next;\n    }\n}\n\n\nint main(void) {\n    card *headp=NULL;\n    card *tailp=NULL;\n    create_deck(&amp;headp,&amp;tailp);\n    printDeck(headp);\n}\n</code></pre>\n\n<p>Besides that, you can learn more about linked lists from a <a href=\"http://quiz.geeksforgeeks.org/linked-list-set-1-introduction/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1492100934, "creation_date": 1492100934, "answer_id": 43397387, "question_id": 43380813, "link": "https://stackoverflow.com/questions/43380813/creating-a-deck-of-cards-using-linked-list/43397387#43397387", "title": "Creating a Deck of Cards using linked list", "body": "<p>here is a proposed version of the code</p>\n\n<ol>\n<li>it cleanly compiles</li>\n<li>it performs appropriate error checking</li>\n<li>it does NOT <code>cleanup</code> when an error occurs, however, it should</li>\n<li>it properly defines the suit values as individual characters</li>\n<li>it corrects the parameter list for <code>add_card()</code></li>\n<li>it documents what is used from each header file</li>\n<li>it does NOT <code>#include</code> header files those contents are not used</li>\n<li>it separates the struct definition from the associated <code>typedef</code></li>\n<li>it corrects the struct definition</li>\n<li>it removes unneeded code</li>\n<li>it properly generates the linked list</li>\n<li>it properly generates a circular linked list</li>\n<li>it properly sets the tail pointer to point to the last entry in  the linked list</li>\n<li>it uses <code>for()</code> statements rather than the 'clunky' <code>while()</code> statements</li>\n<li>it uses meaningful names rather than hardcoded 'magic' numbers</li>\n<li>if follows the axiom: <em>only one statement per line and (at most) one variable declaration per statement.</em></li>\n<li>it consistently indents the code, indenting after every opening brace '{'. unindenting before every closing brace '}'.</li>\n<li>it separates code blocks (for, if, else, while, do..while, switch, case, default) via a single blank line.</li>\n<li>it separate functions, etc by 2 blank lines.</li>\n</ol>\n\n<p>And now the code:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;    // perror()\n#include &lt;stdlib.h&gt;   // malloc(), exit(), EXIT_FAILURE\n//#include &lt;math.h&gt;\n\n#define MAX_SUITS 4\n#define MAX_CARDS_IN_SUIT 13\n\n#define SPADE 0x06\n#define CLUB 0x05\n#define DIAMONDS 0x04\n#define HEART 0x03\n\nstruct node\n{\n    int face_val;\n    char suit;\n    struct node * next;\n};\ntypedef struct node card;\n\n\n// prototypes\nvoid add_card(card **headp, card **tailp, int face, char suit);\nvoid create_deck(card **headp, card **tailp);\n\n\nvoid add_card(card **headp, card **tailp, int face, char suit)\n{\n    card *temp = malloc(sizeof(card));\n    if( !temp )\n    {\n        perror( \"malloc failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, malloc successful\n\n    temp-&gt;face_val = face;\n    temp-&gt;suit = suit;\n    temp-&gt;next = *headp;\n\n    if (*headp == NULL)\n    {\n        *headp = temp;\n        *tailp = temp;\n    }\n\n    else\n    {\n        (*tailp)-&gt;next = temp;\n        *tailp = temp;\n    }\n} // end function: add_card\n\n\nvoid create_deck(card **headp, card **tailp)\n{\n    for ( int i=1; i &lt;= MAX_CARDS_IN_SUIT; i++ )\n    {\n        for( int j=1; j &lt;= MAX_SUITS; j++ )\n        {\n            switch( j )\n            {\n                case 1:\n                    add_card(headp,tailp,i,SPADE);\n                    break;\n\n                case 2:\n                    add_card(headp,tailp,i,HEART);\n                    break;\n\n                case 3:\n                    add_card(headp,tailp,i,DIAMONDS);\n                    break;\n\n                case 4:\n                    add_card(headp,tailp,i,CLUB);\n                    break;\n            } // end switch\n        } // end for each suit\n    } // end for each card in suit\n} // end function: create_deck\n\n\nint main(void)\n{\n\n    card *headp=NULL;\n    card *tailp=NULL;\n\n    create_deck(&amp;headp,&amp;tailp);\n} // end function: main\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7848291, "user_type": "registered", "profile_image": "https://graph.facebook.com/1091700700934124/picture?type=large", "display_name": "Jett Maher", "link": "https://stackoverflow.com/users/7848291/jett-maher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2362, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492100934, "creation_date": 1492037085, "last_edit_date": 1492037400, "question_id": 43380813, "link": "https://stackoverflow.com/questions/43380813/creating-a-deck-of-cards-using-linked-list", "title": "Creating a Deck of Cards using linked list", "body": "<p>I can't seem to figure this out. For some reason my linked list is not creating a deck of cards or even creating one node. If anybody could help I would really appreciate it. All of my code is below. If you could tell me what I am doing wrong and point me in the right direction that would be very helpful.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#define SPADE \"\\x06\"\n#define CLUB \"\\x05\"\n#define DIAMONDS \"\\x04\"\n#define HEART \"\\x03\"\n\ntypedef struct node {\n    int face_val;\n    char suit[10];\n    struct card_s * next;\n} card;\n\n\nvoid add_card(card **headp, card **tailp, int face, char suit) {\n\n    char suit2[10] = \"Test\";\n\n    *tailp = (card*)malloc(sizeof(card));\n    card *temp = (card*)malloc(sizeof(card));\n    temp-&gt;face_val = face;\n    temp-&gt;suit[10] = &amp;suit2;\n    strcpy(temp-&gt;suit, suit2);\n\n    if (*headp == NULL) {\n        *headp = temp;\n        (*headp)-&gt;next = *tailp;\n    }\n\n    else {\n        (*tailp)-&gt;face_val = temp-&gt;face_val;\n        (*tailp)-&gt;suit[10] = temp-&gt;suit;\n        (*tailp)-&gt;next = malloc(sizeof(card));\n        *tailp = (*tailp)-&gt;next;\n    }\n    return;\n}\n\n\nvoid create_deck(card **headp, card **tailp) {\n\n    int i = 1;\n\n\n    while (i &lt;= 13) {\n        int j = 1;\n        while (j &lt;= 4) {\n\n\n            if (j == 1) {\n                add_card(headp,tailp,i,SPADE);\n            }\n            if (j == 2) {\n                add_card(headp,tailp,i,HEART);\n            }\n            if (j == 3) {\n                add_card(headp,tailp,i,DIAMONDS);\n            }\n            if (j == 4) {\n                add_card(headp,tailp,i,CLUB);\n            }\n\n            j++; \n        }\n        i++;\n    }\n    return;\n}\n\n\nint main(void) {\n\n    card *headp=NULL;\n    card *tailp=NULL;\n\n    create_deck(&amp;headp,&amp;tailp);\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "fork", "exec", "execl"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1492036383, "post_id": 43380460, "comment_id": 73823481, "body": "When I try your program I get hundreds of <code>error with wait: No child processes</code> messages."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1492036534, "post_id": 43380460, "comment_id": 73823527, "body": "Never mind, I gave the client program the wrong name. When I fixed that, it worked as expected, I got two lines of output."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1492036688, "post_id": 43380460, "comment_id": 73823574, "body": "After the exec(), the progam doesnt exist.The exec is executed is executed in both the parent and the child. The loop will never loop (if exec succeeds)"}, {"owner": {"reputation": 1700, "user_id": 3517823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ead39c453c59e5666b801a3a17919d?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/3517823/arash"}, "edited": false, "score": 1, "creation_date": 1492036700, "post_id": 43380460, "comment_id": 73823580, "body": "@posixking. please unaccept my answer. It&#39;s not correct and I cannot delete it.."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1492036449, "post_id": 43380687, "comment_id": 73823502, "body": "If stdout is connected to a terminal, it should be line-buffered, so there&#39;s no need to flush. And all streams are flushed automatically when they&#39;re closed, which happens when the program finishes."}, {"owner": {"reputation": 1700, "user_id": 3517823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ead39c453c59e5666b801a3a17919d?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/3517823/arash"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1492036556, "post_id": 43380687, "comment_id": 73823533, "body": "good point. I just tried to re-create his case and cannot do it. You&#39;re right. deleting..."}, {"owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 1, "creation_date": 1492036712, "post_id": 43380687, "comment_id": 73823589, "body": "Thanks &amp; my bad, you are right. I typed the newline character here in stackoverflow, but forgot to type it in my program. Newline also flushes the stream, so it works now."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "edited": false, "score": 1, "creation_date": 1492036763, "post_id": 43380687, "comment_id": 73823605, "body": "@posixKing That shouldn&#39;t matter, since returning will flush. Maybe you just didn&#39;t see the two messages because they were on the same line?"}], "tags": [], "owner": {"reputation": 1700, "user_id": 3517823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ead39c453c59e5666b801a3a17919d?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/3517823/arash"}, "is_accepted": true, "score": 0, "last_activity_date": 1492037512, "last_edit_date": 1492037512, "creation_date": 1492036391, "answer_id": 43380687, "question_id": 43380460, "link": "https://stackoverflow.com/questions/43380460/what-will-happen-if-i-fork-and-exec-in-parent-and-child/43380687#43380687", "title": "What will happen if I fork and exec in parent and child?", "body": "<blockquote>\n  <p>If stdout is connected to a terminal, it should be line-buffered, so there's no need to flush. And all streams are flushed automatically when they're closed, which happens when the program finishes.</p>\n</blockquote>\n\n<p>Maybe you see both print in the same line?\nTry this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char **argv) {\n  printf(\"This is the child with pid = %d from parent %d\\n\", getpid(), getppid());\n  return 0;\n}\n</code></pre>\n\n<p>By the way, you are missing a <code>%d</code> in <code>printf</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 0, "last_activity_date": 1492036639, "creation_date": 1492036639, "answer_id": 43380729, "question_id": 43380460, "link": "https://stackoverflow.com/questions/43380460/what-will-happen-if-i-fork-and-exec-in-parent-and-child/43380729#43380729", "title": "What will happen if I fork and exec in parent and child?", "body": "<p>You should definitely be getting two lines.</p>\n\n<p>If you're not, it's probably due to how you run the program. The parent may print and exit, and if you stop looking or listening at that point you will lose the message from the child.</p>\n\n<p>Due to this, make sure you run the script directly from a shell terminal, and not part of a script, from an IDE, editor, or in any other tool.</p>\n\n<p>For example, here's output of <code>./server; echo \"Done\"</code>:</p>\n\n<pre><code>user ~ $ ./server; echo \"Done.\"\nThis is the child with pid = 27904 from parent\nDone.\n</code></pre>\n\n<p>This makes it look like there's only one line of output. However, in the line after this, the prompt has returned and the child process has written some information after it:</p>\n\n<pre><code>user ~ $ This is the child with pid = 27905 from parent\n</code></pre>\n\n<p>If you run the script in such a way that the shell waits, for example by adding <code>| cat</code> which will wait until the pipe is completely closed, you can see both more clearly:</p>\n\n<pre><code>user ~ $ ./server | cat; echo \"Done.\"\nThis is the child with pid = 27953 from parent\nThis is the child with pid = 27955 from parent\nDone.\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 6762142, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70f0ddb770d4f893fed76e34dae7bfdb?s=128&d=identicon&r=PG&f=1", "display_name": "posixKing", "link": "https://stackoverflow.com/users/6762142/posixking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 43380687, "answer_count": 2, "score": 0, "last_activity_date": 1492037512, "creation_date": 1492035046, "last_edit_date": 1492036733, "question_id": 43380460, "link": "https://stackoverflow.com/questions/43380460/what-will-happen-if-i-fork-and-exec-in-parent-and-child", "title": "What will happen if I fork and exec in parent and child?", "body": "<p>Here is my sample code called server.c (have removed include's to keep it simple).</p>\n\n<pre><code>int main()\n{\n    for(int i = 0; i &lt; 10; i++) {\n        fork();\n        execl(\"./client\", \"./client\", NULL);\n    }\n    if (wait(NULL) == -1)\n        perror(\"error with wait\");\n    return 0;\n}\n</code></pre>\n\n<p>And this is the client code that gets exec'd from the above program.</p>\n\n<pre><code>int main()\n{\n    printf(\"This is the child with pid = %d from parent %d\", getpid(), getppid());\n    return 0;\n}\n</code></pre>\n\n<p>Now let me explain what I think will happen and what I am actually getting as an output.</p>\n\n<p>In server, we enter the for loop. In the first iteration, we hit fork(). At this point there are two processes namely the parent and the first child. Now we exec a program named \"client\" from both of these processes. This client code just prints some information. So when I run this server program, I should end up getting two lines right? One line from parent and the other from the child? But I only get one line printed and after using strace I found that only parent is printing out stuff, not the child. So why is this?</p>\n\n<p>Is it because the child can no longer be collected since parent is dead(is this the right term?) since it was exec'd? If so, what would happen to the child? It becomes a zombie right? and will it be collected by init? Even so, why won't it print out that line before ending up like a zombie?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 179, "user_id": 5524147, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50a6d6e745da37098243f20ca4cdcc25?s=128&d=identicon&r=PG&f=1", "display_name": "san A", "link": "https://stackoverflow.com/users/5524147/san-a"}, "edited": false, "score": 0, "creation_date": 1492035120, "post_id": 43380454, "comment_id": 73823017, "body": "instead of downvoting, shed some light!"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1492035294, "post_id": 43380454, "comment_id": 73823091, "body": "It is nonsense.It <i>could</i> mean:does C has named arguments (for functions), but without it, itis just plain nonsense."}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1492035299, "post_id": 43380454, "comment_id": 73823093, "body": "A search for <i>named notation</i> told me what it was and a quick look at the standard told me if it&#39;s supported. Have you tried doing this yet?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1492035321, "post_id": 43380454, "comment_id": 73823104, "body": "Read your course notes where it describes what they mean by &quot;named notation&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1492035412, "post_id": 43380454, "comment_id": 73823140, "body": "I googled &quot;does c supports named notation?&quot; and the second offering is <a href=\"http://softwareengineering.stackexchange.com/questions/219593/why-do-many-languages-not-support-named-parameters\">Why do many languages not support named parameters?</a>"}, {"owner": {"reputation": 179, "user_id": 5524147, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50a6d6e745da37098243f20ca4cdcc25?s=128&d=identicon&r=PG&f=1", "display_name": "san A", "link": "https://stackoverflow.com/users/5524147/san-a"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1492035485, "post_id": 43380454, "comment_id": 73823174, "body": "@WeatherVane second offering is Wikipedia here &amp; the title is C(programming language)!"}], "answers": [{"tags": [], "owner": {"reputation": 5010, "user_id": 773879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zqTIy.jpg?s=128&g=1", "display_name": "Mark Segal", "link": "https://stackoverflow.com/users/773879/mark-segal"}, "is_accepted": false, "score": 1, "last_activity_date": 1492035304, "creation_date": 1492035304, "answer_id": 43380505, "question_id": 43380454, "link": "https://stackoverflow.com/questions/43380454/what-is-named-notation-in-c/43380505#43380505", "title": "What is Named Notation in C?", "body": "<p>What you're referring to is sometimes called 'named parameters'.</p>\n\n<p>C doesn't support named parameters.</p>\n\n<p>Some other languages do. For example <a href=\"https://www.dotnetperls.com/named-parameters\" rel=\"nofollow noreferrer\">C# does</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1492054577, "post_id": 43380519, "comment_id": 73828066, "body": "I often implement named arguments in C using variadic macros and structs... so, if I could be petty for a moment, &quot;named notation&quot; can be emulated in C, even though it isn&#39;t native to the language."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 3, "last_activity_date": 1492035367, "creation_date": 1492035367, "answer_id": 43380519, "question_id": 43380454, "link": "https://stackoverflow.com/questions/43380454/what-is-named-notation-in-c/43380519#43380519", "title": "What is Named Notation in C?", "body": "<p>\"Named notation\" usually refers to a function call syntax where parameters have names and can be passed, using those names, in any order. For instance, Python supports this language feature; it looks like:</p>\n\n<pre><code>foo(arg1=123, arg2=456)\n</code></pre>\n\n<p>C does not support this language feature. Arguments are purely positional.</p>\n"}], "owner": {"reputation": 179, "user_id": 5524147, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/50a6d6e745da37098243f20ca4cdcc25?s=128&d=identicon&r=PG&f=1", "display_name": "san A", "link": "https://stackoverflow.com/users/5524147/san-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1492045998, "answer_count": 2, "score": -1, "last_activity_date": 1492035367, "creation_date": 1492035018, "last_edit_date": 1492035037, "question_id": 43380454, "link": "https://stackoverflow.com/questions/43380454/what-is-named-notation-in-c", "closed_reason": "Needs details or clarity", "title": "What is Named Notation in C?", "body": "<p>I am currently learning C, and fairly new to the programming in C. I've got a question in the exercise as \"does c supports named notation?\" I am not able to understand what does this mean. I've tried google for answers but couldn't find any.</p>\n"}, {"tags": ["c", "syntax-error", "avr", "codevisionavr"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7838846, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q361L7guPtE/AAAAAAAAAAI/AAAAAAAAAEQ/seisKOYDl6g/photo.jpg?sz=128", "display_name": "Arash Marashian", "link": "https://stackoverflow.com/users/7838846/arash-marashian"}, "edited": false, "score": 0, "creation_date": 1492033393, "post_id": 43380091, "comment_id": 73822334, "body": "yes, for example you have this char : &#39;563&#39; . I divide this to 3 number : 500 + 60 + 3 ."}, {"owner": {"reputation": 3, "user_id": 7838846, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q361L7guPtE/AAAAAAAAAAI/AAAAAAAAAEQ/seisKOYDl6g/photo.jpg?sz=128", "display_name": "Arash Marashian", "link": "https://stackoverflow.com/users/7838846/arash-marashian"}, "edited": false, "score": 0, "creation_date": 1492033625, "post_id": 43380091, "comment_id": 73822437, "body": "i write what u said but it says &quot;undefined symbol atoi&quot; as this err: Error: C:\\cvavr\\BIN\\Thrust Calculator\\TC.c(116): undefined symbol &#39;atoi&#39;"}, {"owner": {"reputation": 318, "user_id": 1203371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a85501fd76c1f04754349f6b0ce651?s=128&d=identicon&r=PG", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/1203371/jeff-d"}, "reply_to_user": {"reputation": 3, "user_id": 7838846, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q361L7guPtE/AAAAAAAAAAI/AAAAAAAAAEQ/seisKOYDl6g/photo.jpg?sz=128", "display_name": "Arash Marashian", "link": "https://stackoverflow.com/users/7838846/arash-marashian"}, "edited": false, "score": 0, "creation_date": 1492033756, "post_id": 43380091, "comment_id": 73822485, "body": "&#39;atoi&#39; is a math library function - you must include the proper header file so the linker can find the function and add it to your executable code.  #include &lt;stdlib.h&gt;  In general any undefined function is either missing the header , or if it is in your own code, you can declare it as &#39;extern&#39;"}, {"owner": {"reputation": 3, "user_id": 7838846, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q361L7guPtE/AAAAAAAAAAI/AAAAAAAAAEQ/seisKOYDl6g/photo.jpg?sz=128", "display_name": "Arash Marashian", "link": "https://stackoverflow.com/users/7838846/arash-marashian"}, "edited": false, "score": 0, "creation_date": 1492034483, "post_id": 43380091, "comment_id": 73822758, "body": "problem solved, i should write this :  intnum1 = atoi(num1);  . it doesn&#39;t need to calculate by each element, it was my fault, tnx for ur help :)"}, {"owner": {"reputation": 318, "user_id": 1203371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a85501fd76c1f04754349f6b0ce651?s=128&d=identicon&r=PG", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/1203371/jeff-d"}, "reply_to_user": {"reputation": 3, "user_id": 7838846, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q361L7guPtE/AAAAAAAAAAI/AAAAAAAAAEQ/seisKOYDl6g/photo.jpg?sz=128", "display_name": "Arash Marashian", "link": "https://stackoverflow.com/users/7838846/arash-marashian"}, "edited": false, "score": 0, "creation_date": 1492035361, "post_id": 43380091, "comment_id": 73823119, "body": "My pleasure ..."}], "tags": [], "owner": {"reputation": 318, "user_id": 1203371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a85501fd76c1f04754349f6b0ce651?s=128&d=identicon&r=PG", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/1203371/jeff-d"}, "is_accepted": true, "score": 0, "last_activity_date": 1492055502, "last_edit_date": 1492055502, "creation_date": 1492033182, "answer_id": 43380091, "question_id": 43379858, "link": "https://stackoverflow.com/questions/43379858/an-err-in-codevision-avr/43380091#43380091", "title": "An Err in Codevision AVR", "body": "<p><code>intnum1 = (int atoi(num1[q])) * 10^(i-q-1) + intnum1;</code> is indeed the problem.</p>\n\n<p>What exactly are you trying to do here?  If you want to cast the entire result to an <code>int</code> as it appears then what you want is this: </p>\n\n<pre><code>intnum1 = (int) (atoi(num1[q])) * (10^(i-q-1))) + intnum1; \n</code></pre>\n\n<p>I am not sure what order of operations are required here, but you want to cast the entire result to int to store it in <code>intnum1</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7838846, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q361L7guPtE/AAAAAAAAAAI/AAAAAAAAAEQ/seisKOYDl6g/photo.jpg?sz=128", "display_name": "Arash Marashian", "link": "https://stackoverflow.com/users/7838846/arash-marashian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "closed_date": 1492057193, "accepted_answer_id": 43380091, "answer_count": 1, "score": -2, "last_activity_date": 1492055502, "creation_date": 1492032092, "last_edit_date": 1492032867, "question_id": 43379858, "link": "https://stackoverflow.com/questions/43379858/an-err-in-codevision-avr", "closed_reason": "Not suitable for this site", "title": "An Err in Codevision AVR", "body": "<p>im coding the calculator in codevision and i get this Err :</p>\n\n<blockquote>\n  <p>Error: C:\\cvavr\\BIN\\Thrust Calculator\\TC.c(112): ')' expected</p>\n</blockquote>\n\n<p>this err related to this part of my code (4th line from bot):</p>\n\n<pre><code>intnum1 = (int atoi(num1[q])) * 10^(i-q-1) + intnum1; \n</code></pre>\n\n<p><strong>What is the problem ?</strong></p>\n\n<p>this is my code :</p>\n\n<pre><code>#include &lt;mega32.h&gt;\n#include &lt;alcd.h&gt;\n#include &lt;delay.h&gt;\n#include &lt;string.h&gt;\n\n\n\n//defining PTND.i\n#define C0 PIND.4\n#define C1 PIND.5\n#define C2 PIND.6\n#define C3 PIND.7\n\n\n\nflash char shift[4] = {0b11111110,0b11111101,0b11111011,0b11110111};\nflash char layout[16] = {'7','8','9','/',\n                         '4','5','6','*',\n                         '1','2','3','-',\n                         'C','0','=','+'};   \n\n\n    char keypad(void);\n    int  fnum1(void);\n    char num1[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};\n    char num2[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};\n    int i,q, intnum1 = 0;\n    int t;  \n\n\nvoid main(void)    \n{\n\n    DDRD = 0X0F;\n    PORTD = 0XF0;\n    lcd_init(16);\n    keypad();\n\nwhile (1)\n      {\n\n\n      }\n}\n\n\n/*   keypad function   */\n\nchar keypad(void) \n{       \nint row = 0, position = 0;\n\n    while (1)\n    {\n    for(row=0; row&lt;4; row++)\n        {\n         int COLUMN = -1;\n\n         PORTD = shift[row];  \n\n        //finding column \n         if(C0 == 0) {COLUMN = 0;}\n         if(C1 == 0) {COLUMN = 1;}\n         if(C2 == 0) {COLUMN = 2;}\n         if(C3 == 0) {COLUMN = 3;} \n\n         //know if sm clik the btn \n         if(COLUMN != -1) \n         {               \n\n           //calculating the position\n           position = row*4 + COLUMN;  \n\n           //do nothing during the pushing\n           while(C0 == 0) {}\n           while(C1 == 0) {}\n           while(C2 == 0) {}\n           while(C3 == 0) {} \n\n           //C as lcd clear          \n           if(layout[position] == 'C') lcd_clear();\n         else \n\n           //return the keypad value   \n           return layout[position];\n         }        \n        delay_ms(50); \n        } \n    }            \n}\n\n\nint fnum1(void)\n{\n\n        if( keypad() != '') \n           {  \n           num1[i] = keypad();\n           i = i + 1;\n           }      \n\n        if ( keypad() == '=')\n          {   \n           for( t = 0 ; t &lt;= i ; t++) \n           {\n             lcd_putchar(num1[t]); \n           }\n          }\n\n        for( q = 0 ; q &lt;= i ; q++) \n          {\n            intnum1 = (int atoi(num1[q])) * 10^(i-q-1) + intnum1; \n          } \n           lcd_putchar(keypad());\n           return intnum1;       \n\n}\n</code></pre>\n\n<p>I'll appreciate if sm can answer me :)</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1492031198, "post_id": 43379611, "comment_id": 73821426, "body": "How long is <code>str</code>?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1492031234, "post_id": 43379611, "comment_id": 73821449, "body": "How much does <code>scanf(&quot;%s&quot;..</code> read?"}, {"owner": {"reputation": 145, "user_id": 7549053, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000153453277/picture?type=large", "display_name": "user43783", "link": "https://stackoverflow.com/users/7549053/user43783"}, "edited": false, "score": 0, "creation_date": 1492031470, "post_id": 43379611, "comment_id": 73821544, "body": "20 characters at most"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1492031550, "post_id": 43379611, "comment_id": 73821587, "body": "Is <code>str</code> long enough? Does <code>scanf</code> prevent more than 20 characters to be read"}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 4, "creation_date": 1492031924, "post_id": 43379785, "comment_id": 73821734, "body": "Change <code>scanf(&quot;%s&quot;, str);</code> to <code>scanf(&quot;%249s&quot;, str);</code>"}, {"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1492032097, "post_id": 43379785, "comment_id": 73821810, "body": "Yes, thank you, guys. I just did it to present a code that works for the purpose of printing into a file something read from the keyboard. I just rushed in and forgot. Thanks again"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 3, "creation_date": 1492032179, "post_id": 43379785, "comment_id": 73821842, "body": "Perhaps also check <code>stream</code> is not null as well"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1492034841, "post_id": 43379785, "comment_id": 73822909, "body": "Robust code always checks the return value of input functions.  <code>if (scanf(&quot;%249s&quot;, str) == 1) fprintf(stream, &quot;%s.\\n&quot;, str);</code>"}, {"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "edited": false, "score": 0, "creation_date": 1492071442, "post_id": 43379785, "comment_id": 73835254, "body": "In most cases scanf(&quot;%s&quot;,...) is not what most users want to use since scanf(&quot;%s&quot;) just reads words terminated by whitespace, which is quite confusing in many situations, e.g. pressing ENTER does not make it return since ENTER is whitespace. In many cases you are better off with using fgets()."}], "tags": [], "owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "is_accepted": true, "score": 3, "last_activity_date": 1492032344, "last_edit_date": 1492032344, "creation_date": 1492031801, "answer_id": 43379785, "question_id": 43379611, "link": "https://stackoverflow.com/questions/43379611/how-to-scan-a-string-and-write-it-in-a-file/43379785#43379785", "title": "How to scan a string and write it in a file?", "body": "<p>try this, should work just fine.\nIt did for me so it should for you too. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\nFILE *stream;\n\nstream = fopen(\"ceva.txt\", \"w\");\nif (stream == NULL) {\n   perror(\"Failed: \");\n   return 1;\n}\nchar str[250];\nscanf(\"%249s\", str);\nfprintf(stream, \"%s.\\n\", str);\n\n\nfclose(stream);\n\nreturn 0;}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60, "user_id": 7717280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQX8T.jpg?s=128&g=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/7717280/stefano"}, "is_accepted": false, "score": 0, "last_activity_date": 1492086086, "creation_date": 1492086086, "answer_id": 43392216, "question_id": 43379611, "link": "https://stackoverflow.com/questions/43379611/how-to-scan-a-string-and-write-it-in-a-file/43392216#43392216", "title": "How to scan a string and write it in a file?", "body": "<p>You must change <code>scanf</code> with <code>fscanf</code></p>\n"}], "owner": {"reputation": 145, "user_id": 7549053, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000153453277/picture?type=large", "display_name": "user43783", "link": "https://stackoverflow.com/users/7549053/user43783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 43379785, "answer_count": 2, "score": 1, "last_activity_date": 1492086086, "creation_date": 1492030983, "last_edit_date": 1492031344, "question_id": 43379611, "link": "https://stackoverflow.com/questions/43379611/how-to-scan-a-string-and-write-it-in-a-file", "title": "How to scan a string and write it in a file?", "body": "<p>I want to scan a string that a user inputs, then write it into the file (file.txt), but this doesn't seem to work for some reason</p>\n\n<pre><code>int main()\n{\n    FILE *stream;\n\n    stream = fopen(\"file.txt\", \"w\");\n\n    char str[] = { '\\0 ' };\n    scanf(\"%s\", &amp;str);\n    fprintf(stream, \"%s.\\n\", str);\n\n\n    fclose(stream);\n\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "process", "signals"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1492029984, "post_id": 43379322, "comment_id": 73820831, "body": "Create the signal handler in the parent process after you fork all the children. Or revert the signal handler in the children to default."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1492030006, "post_id": 43379322, "comment_id": 73820836, "body": "<code>printf()</code> is not async-signal-safe.  You are not permitted to call it from a signal handler.  You can call <code>read()</code> and <code>write()</code>, but be careful of the possibility of interfering with stream operations on the same open file description."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1492030014, "post_id": 43379322, "comment_id": 73820845, "body": "Or the signal handler could check a global variable to determine if it&#39;s the original parent or a child."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1492030368, "post_id": 43379322, "comment_id": 73821011, "body": "This isn&#39;t the problem you&#39;re asking about, but <code>kill(0, SIGTSTP)</code> is wrong - it will prevent you from reacting to input."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 1, "creation_date": 1492030387, "post_id": 43379322, "comment_id": 73821019, "body": "Assuming you are using Unix/Linux, I suggest you read &quot;man 7 signal&quot; for a list of &quot;async-safe functions&quot; that may be called in a signal handler (you will notice &#39;printf()&#39; is not among them&#39;."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1492031055, "post_id": 43379322, "comment_id": 73821356, "body": "Here&#39;s a nice discussion of signal handling when you have child processes, and are using CNTL-C:  <a href=\"http://unix.stackexchange.com/questions/176235/fork-and-how-signals-are-delivered-to-processes\" title=\"fork and how signals are delivered to processes\">unix.stackexchange.com/questions/176235/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1492038272, "post_id": 43379322, "comment_id": 73824060, "body": "Given that all the processes in the process group will receive the signal from the controlling terminal of the process group, you have limited options.  One option is to have just one process go interactive on interrupt; all the others either ignore interrupts or die on interrupts.  Another is to isolate some of the processes from the process group and controlling terminal.  If they must all go interactive, you face a nightmare.  They&#39;ll all prompt, but you won&#39;t be able to tell beforehand which process gets which input.  Thus if you wanted to stop some and let others continue, you&#39;re stuck."}], "owner": {"reputation": 1, "user_id": 6190752, "user_type": "registered", "profile_image": "https://graph.facebook.com/800682130064744/picture?type=large", "display_name": "Ruben Torres", "link": "https://stackoverflow.com/users/6190752/ruben-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492029921, "creation_date": 1492029844, "last_edit_date": 1492029921, "question_id": 43379322, "link": "https://stackoverflow.com/questions/43379322/c-signal-handler-getting-activated-by-all-child-processes", "title": "C signal handler getting activated by all child processes", "body": "<p>I need some kind of signal_handler that when pressed CTRL+C, the program pauses all it's operations and asks the user: \u00abAre you sure you want to terminate(Y/N)?\u00bb If the answer is y, the program terminates, if it's n the program continues/prooceeds with it's functions, this is what i have till this moment:</p>\n\n<pre><code>void sig_handler(int sig){\n    if(sig == SIGINT){\n\n        char res;\n        printf(\"\\nAre you sure you want to terminate (Y/N)?\\n\");\n        kill(0, SIGTSTP); //envia sinal Stop ao processo pai\n\n        do{\n            read(STDIN_FILENO, &amp;res, 1);\n            if (res == 'Y' || res == 'y')\n            {\n                kill(0,SIGTERM); //envia sinal de Terminacao ao proceso pai\n            }else\n                if (res == 'N' || res == 'n')\n                {\n                    kill(0,SIGCONT); //envia sinal ao processo pai para continuar\n                    break;\n                }\n        }while(res != 'Y' &amp;&amp; res != 'y' &amp;&amp; res != 'N' &amp;&amp; res != 'n');\n    }\n\n}\n\nstruct sigaction oldsigaction; //declarar antes de subscribe_SIGINT\n\nvoid subscribe_SIGINT(){\n    sigaction(SIGTSTP, 0,&amp;oldsigaction);\n    struct sigaction newsigaction;\n    newsigaction = oldsigaction;\n    newsigaction.sa_handler = &amp;sig_handler;\n    sigaction(SIGTSTP, &amp;newsigaction,0);\n    signal(SIGINT, sig_handler);\n}\n</code></pre>\n\n<p>The problem with this code is that the message \u00abAre you sure you want to terminate(Y/N)?\u00bb appears more then once, i suppose that happens because all the child processes of the program activate this signal_handler when CTRL+C is pressed.\nAny solutions?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 728, "user_id": 610312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c65934f33958e0a4e8a41d46298102d?s=128&d=identicon&r=PG", "display_name": "ewindes", "link": "https://stackoverflow.com/users/610312/ewindes"}, "edited": false, "score": 2, "creation_date": 1492029732, "post_id": 43379140, "comment_id": 73820695, "body": "For a start, you&#39;re not defining NROWS or NCOLS - so you don&#39;t know the dimensions of your array.  You&#39;ll need to learn how to use GDB, so that you can debug problems on your own."}], "answers": [{"tags": [], "owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "is_accepted": false, "score": 0, "last_activity_date": 1492057886, "creation_date": 1492057886, "answer_id": 43383548, "question_id": 43379140, "link": "https://stackoverflow.com/questions/43379140/segmentation-fault-why/43383548#43383548", "title": "Segmentation Fault. Why?", "body": "<p>There are 2 main problems here:</p>\n\n<ol>\n<li><p>You are declaring NROWS and NCOLS but not initializing them.</p>\n\n<pre><code>int NROWS, NCOLS;\n</code></pre></li>\n</ol>\n\n<p>simply allocates memory for 2 integers. What about their initial values? You need to assign suitable values else they might contain garbage data.\nSomething like:</p>\n\n<pre><code>    int NROWS = 10, NCOLS = 10;\n</code></pre>\n\n<p>is desirable.</p>\n\n<ol start=\"2\">\n<li><p>You're trying to open a file \"rocket1.txt\". There's a problem with this code:</p>\n\n<pre><code>rocket1 = fopen(FILENAME,\"r\");\nif(rocket1 == NULL)\n {printf(\"Error opening file.\\n\");}\n</code></pre></li>\n</ol>\n\n<p>if rocket1 is NULL, then you do print an error but then you should typically terminate the program.</p>\n\n<pre><code>    rocket1 = fopen(FILENAME,\"r\");\n    if(rocket1 == NULL) {\n       printf(\"Error opening file.\\n\");\n       exit(1);\n    }\n</code></pre>\n\n<p>Exiting the program is important since if rocket1 = NULL, then any subsequent reference to rocket1 might result in a NULL pointer deference which is going to segfault.</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 6497318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa77f317c9ab7eccb840dd907015175?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin shihab", "link": "https://stackoverflow.com/users/6497318/yasin-shihab"}, "is_accepted": false, "score": 1, "last_activity_date": 1492060461, "creation_date": 1492060461, "answer_id": 43384007, "question_id": 43379140, "link": "https://stackoverflow.com/questions/43379140/segmentation-fault-why/43384007#43384007", "title": "Segmentation Fault. Why?", "body": "<p>To fix your Program try like this :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#define FILENAME \"rocket1.txt\"\n#define NROWS 10\n#define NCOLS 10\nint main(void)\n{\n    FILE *rocket1 = NULL;\n    int i, k, num_data_pts;\n    double x[NROWS][NCOLS];\n    rocket1 = fopen(FILENAME, \"r\");\n    if (rocket1 == NULL)\n    {\n        printf(\"Error opening file.\\n\");\n    }\n    else\n    {\n        fscanf(rocket1, \"%d\", &amp;num_data_pts);\n        if ( NROWS &lt;= num_data_pts || NCOLS &lt; 4 )\n        {\n            printf(\"Post Fence Error. Increase Array Size.\\n\");\n        }\n        else\n        {\n            for (i = 1; i &lt;= num_data_pts; i++)\n                for (k = 0; k &lt; 4; k++)\n                    fscanf(rocket1, \"%lf\", &amp;x[i][k]);\n            fclose(rocket1);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Here for demonstration purpose NROWS and NCOLS are taken as 10.\nIn your code you accessed x[i][k] from index 1(not 0) for i and\nextended upto num_data_pts(inclusive). So, extra checking is included\nto prevent access outside the array size.</p>\n"}], "owner": {"reputation": 1, "user_id": 7858700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c45a5bcb2c5ff84c2575e99711f9a2f?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/7858700/mason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492060461, "creation_date": 1492029162, "last_edit_date": 1492052723, "question_id": 43379140, "link": "https://stackoverflow.com/questions/43379140/segmentation-fault-why", "title": "Segmentation Fault. Why?", "body": "<p>I am attempting to access a file and fscanf the data into a 2d array, but whenever I run the code I get Segmentation fault (core dumped). I have tried looking for an explanation as to why, but can't seem to find one. I know the file I am attempting to open is in the correct location and is not spelled wrong. Any help?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#define FILENAME \"rocket1.txt\"\n\n\nint main(void)\n{\nFILE *rocket1;\nint i, NROWS, NCOLS, k, num_data_pts;\ndouble x[NROWS][NCOLS];\n\nrocket1 = fopen(FILENAME,\"r\");\n        if(rocket1 == NULL)\n         {printf(\"Error opening file.\\n\");}\n\nfscanf(rocket1,\"%d\",&amp;num_data_pts);\n\nfor(i=1;i&lt;=num_data_pts;i++)\n    for(k=0;k&lt;4;k++)\n        fscanf(rocket1,\"%lf\",&amp;x[i][k]);\n\n\n\n    fclose(rocket1);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arm", "microcontroller", "elf", "relocation"], "comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1492028979, "post_id": 43379029, "comment_id": 73820282, "body": "where are you doing the relocation, do you have an operating system with an elf parser on the cortex-m3?"}, {"owner": {"reputation": 1000, "user_id": 2945630, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/bc7b93821d03d8f5892a0e4cf75bee21?s=128&d=identicon&r=PG&f=1", "display_name": "boortmans", "link": "https://stackoverflow.com/users/2945630/boortmans"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1492029145, "post_id": 43379029, "comment_id": 73820382, "body": "I&#39;m using Contiki OS 2.7, so I only need to write some processor dependent functions, like <code>elfloader_arch_relocate()</code>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1492030720, "post_id": 43379029, "comment_id": 73821197, "body": "It is not clear to me whether you are implementing a <i>linker</i> or a <i>loader</i>. A linker runs as the last stage of compilation, to transform &quot;object files&quot; into &quot;executables&quot; and &quot;shared libraries&quot;.  A loader runs as the first stage of execution, to &quot;fix up&quot; executables and shared libraries as they are brought into memory.  A linker has to handle many more relocation types than a loader. Please say which you mean."}, {"owner": {"reputation": 1000, "user_id": 2945630, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/bc7b93821d03d8f5892a0e4cf75bee21?s=128&d=identicon&r=PG&f=1", "display_name": "boortmans", "link": "https://stackoverflow.com/users/2945630/boortmans"}, "edited": false, "score": 0, "creation_date": 1492030912, "post_id": 43379029, "comment_id": 73821291, "body": "I&#39;m implementing a dynamic loader, to load the object files at runtime"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492032511, "post_id": 43379029, "comment_id": 73821982, "body": "What use would that have. Most CM3 MCUs have use only internal Flash. And dynacially loading code to an embedded system welcomes malware and other trouble."}, {"owner": {"reputation": 1000, "user_id": 2945630, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/bc7b93821d03d8f5892a0e4cf75bee21?s=128&d=identicon&r=PG&f=1", "display_name": "boortmans", "link": "https://stackoverflow.com/users/2945630/boortmans"}, "edited": false, "score": 0, "creation_date": 1492033780, "post_id": 43379029, "comment_id": 73822498, "body": "It is used in wireless sensor networks. Program code typically consists of around 100 kilobytes, so updates of a few kilobytes can be loaded directly in flash memory."}], "answers": [{"comments": [{"owner": {"reputation": 1000, "user_id": 2945630, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/bc7b93821d03d8f5892a0e4cf75bee21?s=128&d=identicon&r=PG&f=1", "display_name": "boortmans", "link": "https://stackoverflow.com/users/2945630/boortmans"}, "edited": false, "score": 0, "creation_date": 1492030523, "post_id": 43379300, "comment_id": 73821106, "body": "When I&#39;m testing the current implementation, I get an error about an unsupported relocation type (#70). Is it possible to overcome this error by using simpler relocations then?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1000, "user_id": 2945630, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/bc7b93821d03d8f5892a0e4cf75bee21?s=128&d=identicon&r=PG&f=1", "display_name": "boortmans", "link": "https://stackoverflow.com/users/2945630/boortmans"}, "edited": false, "score": 0, "creation_date": 1492030600, "post_id": 43379300, "comment_id": 73821147, "body": "Not in the long run, but while you&#39;re still bringing this implementation up, you can test on shared objects of progressively increasing complexity."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1000, "user_id": 2945630, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/bc7b93821d03d8f5892a0e4cf75bee21?s=128&d=identicon&r=PG&f=1", "display_name": "boortmans", "link": "https://stackoverflow.com/users/2945630/boortmans"}, "edited": false, "score": 0, "creation_date": 1492030807, "post_id": 43379300, "comment_id": 73821238, "body": "(It&#39;s possible that you are trying to feed an unlinked object file to a loader, which is not something that is supposed to work in the first place. Please see comments on the question.)"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 0, "last_activity_date": 1492118701, "last_edit_date": 1492118701, "creation_date": 1492029753, "answer_id": 43379300, "question_id": 43379029, "link": "https://stackoverflow.com/questions/43379029/elf-relocation-on-arm-cortex-m3/43379300#43379300", "title": "ELF relocation on ARM Cortex-M3", "body": "<p>If I'm reading this right, and I'm not sure I am, it goes like this:</p>\n\n<ul>\n<li><code>S</code> is <code>addr</code>.</li>\n<li><code>B(S)</code> is <code>sectionaddr</code>.</li>\n<li><code>A</code> is <code>rela-&gt;r_addend</code>.</li>\n<li><code>T</code> <em>may</em> be derivable from information in <code>rela-&gt;r_info</code>; if not, I don't know where you need to look.</li>\n</ul>\n\n<p>This is a really complicated-looking relocation.  Consider starting with the simple ones (like <code>R_ARM_ABS16</code>).  In a dynamic loader, you should <em>not</em> have to implement all of the relocation typess in the spec you linked to, only a small subset.  If it seems like you need a lot of relocation types, this is probably because you are trying to feed <em>unlinked object files</em> to the dynamic loader; you should turn them into shared objects, using your existing ARM linker.  (With the GNU toolchain, a first approximation to how you do that is <code>gcc -shared foo.o -o foo.so</code>.)</p>\n\n<p>Cribbing off an existing dynamic loader for the architecture is often a good plan; there tends to be a lot of undocumented wisdom buried in the code for such things.  For instance, here is <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/arm/dl-machine.h;h=2c72972bd22723c82ae4ae897604fd7f8da9c207;hb=4fee33f8c11447d345b2b1118a98958b54d5fda3\" rel=\"nofollow noreferrer\">GNU libc's ld.so's ARM relocator</a>.  (LGPL)</p>\n"}], "owner": {"reputation": 1000, "user_id": 2945630, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/bc7b93821d03d8f5892a0e4cf75bee21?s=128&d=identicon&r=PG&f=1", "display_name": "boortmans", "link": "https://stackoverflow.com/users/2945630/boortmans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 721, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492118701, "creation_date": 1492028742, "question_id": 43379029, "link": "https://stackoverflow.com/questions/43379029/elf-relocation-on-arm-cortex-m3", "title": "ELF relocation on ARM Cortex-M3", "body": "<p>I'm trying to figure out how relocation works, but I can't seem to get my head around it.\n<a href=\"http://infocenter.arm.com/help/topic/com.arm.doc.ihi0044f/IHI0044F_aaelf.pdf#page=28\" rel=\"nofollow noreferrer\">This document</a> describes the different types one can encounter when relocating an ELF file.</p>\n\n<p>Let's take <code>R_ARM_ALU_SB_G0_NC</code> (#70) for example.</p>\n\n<ul>\n<li>Type: static</li>\n<li>Class: ARM, describes the type of place being relocated (which I do not understand)</li>\n<li>Operation: ((S + A) | T) \u2013 B(S))</li>\n</ul>\n\n<p>I'm guessing that the mathematical expression is the operation I'm looking for. However, I do not completely understand how this fits in my function.\nThe method where the relocation takes place looks as follows:</p>\n\n<pre><code>int elfloader_arch_relocate(int input_fd, struct elfloader_output *output,\n    unsigned int sectionoffset, char *sectionaddr, struct elf32_rela *rela, char *addr)\n</code></pre>\n\n<p><code>input_fd</code> is a file descriptor for the ELF file, <code>*output</code> is used when writing the output segment, <code>sectionoffset</code> is the file offset at which the relocation can be found, <code>*sectionaddr</code> is the section start address (absolute runtime) and <code>*addr</code> is the relocated address.\nThe 32-bit relocation structure looks like this</p>\n\n<pre><code> struct elf32_rela {\n   elf32_addr   r_offset;\n   elf32_word   r_info;\n   elf32_sword  r_addend;\n };\n</code></pre>\n\n<p>On page 26 of the above mentioned <a href=\"http://infocenter.arm.com/help/topic/com.arm.doc.ihi0044f/IHI0044F_aaelf.pdf#page=28\" rel=\"nofollow noreferrer\">document</a> the nomenclature is explained:</p>\n\n<ul>\n<li>S (when used on its own) is the address of the symbol.</li>\n<li>A is the addend for the relocation.</li>\n<li>T is 1 if the target symbol S has type STT_FUNC and the symbol addresses a Thumb instruction; it is 0 otherwise.</li>\n<li>B(S) is the addressing origin of the output segment defining the symbol</li>\n</ul>\n\n<p>So my question is, which of the parameters in the relocate function correspond to the ones used in the formula?</p>\n"}, {"tags": ["c", "gcc", "ipv6"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1492027089, "post_id": 43378526, "comment_id": 73819179, "body": "I would write another program that you use to pre-process the source code."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1492027573, "post_id": 43378526, "comment_id": 73819458, "body": "Along the same lines, I&#39;d suggest you put those IPv6 constants in a JSON config file and write a template header file. Use a program to process the constants and fill in the blanks in the template. Use any programming language and template system you like."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1492027597, "post_id": 43378526, "comment_id": 73819477, "body": "You could do it at <i>coding</i> time.  That might be via a code generator, or by the kind of hand-computation you seem to have performed."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1492027695, "post_id": 43378526, "comment_id": 73819534, "body": "If you&#39;re using a build configuration system such as CMake or the Autotools, you could conceivably put the computation there, and feed it into your build via a macro definition."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1492028083, "post_id": 43378526, "comment_id": 73819764, "body": "Your example mixes well-known decimal values with ipv6 which is hex."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1492028206, "post_id": 43378526, "comment_id": 73819846, "body": "@stark check <a href=\"https://en.wikipedia.org/wiki/IPv6\" rel=\"nofollow noreferrer\">IPv4-mapped IPv6 addresses</a> <code>::ffff:192.0.2.128 represents the IPv4 address 192.0.2.128.</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1492028637, "post_id": 43378526, "comment_id": 73820097, "body": "@Schwern <i>I&#39;d suggest you put those IPv6 constants in a JSON config file and write a template header file.</i> C doesn&#39;t have templates, and why introduce an extraneous dependency on JSON processing?"}, {"owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1492028702, "post_id": 43378526, "comment_id": 73820133, "body": "@Schwern: I&#39;m not sure I understand the advantage of using a config file vs just a script that just replaces the string in place."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1492028876, "post_id": 43378526, "comment_id": 73820222, "body": "@John Using a template means less parsing is involved, and you can use a pre-existing template library, or make up something really simple. Using a config file makes it easier to adjust the values. For example, y2038 has to probe the system to learn its limits. It then uses <a href=\"https://github.com/evalEmpire/y2038/blob/master/perl/Time-y2038/munge_config\" rel=\"nofollow noreferrer\">a tiny Perl program</a> to fill in <a href=\"https://github.com/evalEmpire/y2038/blob/master/perl/Time-y2038/y2038/time64_limits.h.in\" rel=\"nofollow noreferrer\">a template header file</a> to produce <a href=\"https://github.com/evalEmpire/y2038/blob/master/time64_limits.h\" rel=\"nofollow noreferrer\">time64_limits.h</a>."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1492029019, "post_id": 43378526, "comment_id": 73820310, "body": "@AndrewHenle Not C++ templates, fill in the blank templates. JSON is ubiquitous and no great dependency."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1492030027, "post_id": 43378526, "comment_id": 73820853, "body": "Given that it is a compile-time constant, what is wrong with doing it by hand as you have and assigning it as you have in the second fragment?  The number of times you are going to have to do this is probably hardly worth the effort of making it work.  If you want the reader to understand the code, include the string format in a comment."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1492031737, "post_id": 43378526, "comment_id": 73821667, "body": "Have a look at &quot;man inet_pton&quot; on Linux."}, {"owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "edited": false, "score": 0, "creation_date": 1492090729, "post_id": 43378526, "comment_id": 73848723, "body": "Thanks everyone.  I wrote a simple script that expands the macro in place, which can be run prior to compiling."}], "answers": [{"comments": [{"owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "edited": false, "score": 0, "creation_date": 1492091525, "post_id": 43379518, "comment_id": 73849262, "body": "thanks for the response, but while this is interesting, for my purposes it&#39;s faster and more convenient to update the addresses in place (one of my main goals was readability)."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "edited": false, "score": 0, "creation_date": 1492101534, "post_id": 43379518, "comment_id": 73855950, "body": "@John You could add the original value as a comment."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1492030631, "creation_date": 1492030631, "answer_id": 43379518, "question_id": 43378526, "link": "https://stackoverflow.com/questions/43378526/c-convert-ipv6-address-to-string-at-compile-time/43379518#43379518", "title": "c: Convert ipv6 address to string at compile time", "body": "<p>For this sort of thing I'd recommend writing a template header file (not C++ templates, but fill-in-the-blank templates), putting the human-readable values in a config file, and using a small program to fill in the blanks.</p>\n\n<p>For example, the config file might be in JSON. (This is obviously overkill for a single value, I'm just showing the technique.)</p>\n\n<pre><code>{\n    \"addr\": \"::ffff:192.168.1.1\"\n}\n</code></pre>\n\n<p>You could use an existing template language, or make up your own. For something as simple as a C header file, you can get away with something very simple.</p>\n\n<pre><code>const uint64_t addr[2] = { %%addr%% };\n</code></pre>\n\n<p>And the code to read the config and process the template simple in a ubiquitous scripting language like Ruby.</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'json'\n\ntemplate, config_file = ARGV[0..1]\n\n# Load the config file\nconfig = JSON.load( File.new(config_file) )\n\n# Ensure missing config variables throw an error\nconfig.default_proc = proc do |hash, key|\n    throw \"Config key '#{key}' is missing from #{config_file}\"\nend\n\n# ...do whatever processing on the config variables you want...\n\n# Fill in the template.\nIO.foreach(template) { |line|\n    puts line.gsub(/%%(.*?)%%/) { config[$1] }\n}\n</code></pre>\n\n<p>I employ this technique in the y2038 library. It has to probe the system to determine the limits of time.h, then encode those limits into a custom header file. <a href=\"https://github.com/evalEmpire/y2038/blob/master/perl/Time-y2038/munge_config\" rel=\"nofollow noreferrer\">munge_config</a> reads the configuration values (from the build system, not from a JSON config, but the result is the same: a hash), and fills in the template. This is the <a href=\"https://github.com/evalEmpire/y2038/blob/master/perl/Time-y2038/y2038/time64_limits.h.in\" rel=\"nofollow noreferrer\">time64_limits.h.in template</a> and an example of <a href=\"https://github.com/evalEmpire/y2038/blob/master/time64_limits.h\" rel=\"nofollow noreferrer\">a resulting time64_limits.h header file</a>.</p>\n"}], "owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492030631, "creation_date": 1492026903, "question_id": 43378526, "link": "https://stackoverflow.com/questions/43378526/c-convert-ipv6-address-to-string-at-compile-time", "title": "c: Convert ipv6 address to string at compile time", "body": "<p>This is a longshot, but I'm wondering if there are any tricks to convert a constant ipv6 address string into two 64 bit integers at <em>compile time</em>.  (this is on an embedded system, and thus runtime and memory are both valuable commodities).  Ideally the code would look something like:</p>\n\n<pre><code>const uint64_t addr[2] = { IPV6_TO_UINT64S(\"::ffff:192.168.1.1\") };\n</code></pre>\n\n<p>which would produce:</p>\n\n<pre><code>const uint64_t addr[2] = { 0x0000000000000000ULL, 0x0000ffffc0a80101ULL };\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1492027270, "post_id": 43378426, "comment_id": 73819284, "body": "Take a look at <a href=\"http://stackoverflow.com/q/5431941/3684343\">stackoverflow.com/q/5431941/3684343</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1492027839, "post_id": 43378426, "comment_id": 73819620, "body": "inArray is a function-local variable. It is on the stack during the function execution. After &quot;return&quot; is stops existing. Returning a pointer to it is a path to hell. That is different if you use dynmically allocated memory (<code>malloc()</code>), even if it gets allocated inside the function."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1492028006, "post_id": 43378426, "comment_id": 73819723, "body": "By the way your way of asking a question is already quite good. I neveertheless recommend to take the tour and get the badge for it. Some answerers here have something of a preconception against askers who do not have that badge. <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1492028233, "post_id": 43378426, "comment_id": 73819860, "body": "Also, it looks like your format string is incomplete: <code>,%,],</code>"}], "owner": {"reputation": 11, "user_id": 7858497, "user_type": "registered", "profile_image": "https://graph.facebook.com/1359533720798772/picture?type=large", "display_name": "C&#233;sar Penha", "link": "https://stackoverflow.com/users/7858497/c%c3%a9sar-penha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1492027885, "answer_count": 0, "score": 0, "last_activity_date": 1492027403, "creation_date": 1492026620, "last_edit_date": 1492027403, "question_id": 43378426, "link": "https://stackoverflow.com/questions/43378426/access-an-array-of-structs-out-of-a-function", "closed_reason": "Duplicate", "title": "Access an array of structs out of a function", "body": "<p>i'm trying to solve a issue in my code... Im a litle bit new in C program, sorry if i cant explain my issue very well, but its my first time that i put a question on stackoverflow.</p>\n\n<p>So i have this code in my program:</p>\n\n<pre><code>typedef struct contact {\n    int iD;\n    int age;\n    char phone1[15];\n    char phone2[15];\n    char contactFirstName[20];\n    char contactLastName[20];\n    char contactCompany[30];\n    char contactAddress[40];\n    char contactCity[20];\n    char contactState[20];\n    char contactCountry[20];\n    char contactPostalCode[20];\n    char contactEmail[30];\n    char contactWeb[50];\n}contact;\n\nint lines=0;\nvoid printArray(contact *array, int n);\nchar* sortFieldMenu();\nchar* sortTypeMenu();\nvoid mainMenu();\nchar* searchFieldMenu();\ncontact* readFile(char*path);\n\nint main(void){\n    system(\"play -n synth 0.1 sin 1880 | echo -e \"\"\\a\"\" \");\n    char* filePath = \"contact.csv\";\n\n    contact* inArray = (readFile(filePath));\n    printf(\"\\n Debug First Name: %p \\n\",inArray[1].age); \n\n    printf(\"Debug.......\");\n    return 0;\n}\n\ncontact* readFile(char *path){\n    int i, count;\n    char ch;\n    FILE* fp = fopen(path, \"r\");\n    if (fp == NULL) {\n        fprintf(stderr, \"\\n Erro ao abrir o ficheiro de !\\n\");\n        exit(1);\n    }\n    while(!feof(fp)){\n        ch = fgetc(fp);\n        if(ch == '\\n'){\n            lines++;\n        }\n    }\n    printf(\"Number of Lines: %d \\n\", lines);\n    contact inArray[lines];\n    rewind(fp);\n\n    for(i=0;i&lt;=lines-1;i++){\n\n        count++;\n        fscanf(fp, \"%d,%[^,],%[^,],%d,%[^,],%[^,],%[^,],%[^,],%[^,],%,],%\n               [^,],%[^,],%[^,],%s\\n\", &amp;inArray[i].iD, \n               inArray[i].contactFirstName,                             \n               inArray[i].contactLastName, &amp;inArray[i].age, \n               inArray[i].contactCompany, inArray[i].contactAddress, \n               inArray[i].contactCity, inArray[i].contactState,                 \n               inArray[i].contactCountry,\n               inArray[i].contactPostalCode,\n               inArray[i].phone1, \n               inArray[i].phone2,inArray[i].contactEmail,\n               inArray[i].contactWeb);\n    }\n\n    printArray(inArray, lines);\n    fclose(fp);\n    return inArray;\n}\n</code></pre>\n\n<p>Im trying to access(print) an inArray element on the main function. I know that i cant return an array from a function, just the pointer to that array. \nThe main goal is to read an .csv file and put the data in an array of structs (inArray) initialize on that function, and return a pointer to that array.</p>\n\n<p>Im trying to access tho that array in the main function, and print an element( inArray[1].age), but something is wrong.</p>\n\n<p>Any help will be apeciated.</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1492025277, "post_id": 43377929, "comment_id": 73818132, "body": "Aside: in <code>a = floor(a &#47; 10);</code> do your realise that <code>a &#47; 10</code> is an <i>integer</i> division? So there is never any fractional part to discard."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1492027437, "post_id": 43377929, "comment_id": 73819366, "body": "It is perverse to use <i>two</i> magic numbers on the same array. Firstly <code>int doubledDigs[16];</code> followed by <code>i &lt;= 15;</code> where it would be clearer as <code>i &lt; 16</code>. But it is better to <code>#define</code> a length, or declare a <code>const</code> and derive everything from that."}, {"owner": {"reputation": 31, "user_id": 4981715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dAkX1GD2VnY/AAAAAAAAAAI/AAAAAAAACWw/3CQVcQDZJ2U/photo.jpg?sz=128", "display_name": "tome robe", "link": "https://stackoverflow.com/users/4981715/tome-robe"}, "edited": false, "score": 0, "creation_date": 1492205802, "post_id": 43377929, "comment_id": 73898171, "body": "Thanks for the pointers."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 7858301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a00b105e1f039e0e1463eadc9de1c2f9?s=128&d=identicon&r=PG", "display_name": "DrewBot", "link": "https://stackoverflow.com/users/7858301/drewbot"}, "is_accepted": true, "score": 1, "last_activity_date": 1492030418, "last_edit_date": 1492030418, "creation_date": 1492026861, "answer_id": 43378511, "question_id": 43377929, "link": "https://stackoverflow.com/questions/43377929/why-am-i-getting-this-output-from-printing-the-contents-of-an-array-with-only-17/43378511#43378511", "title": "Why am I getting this output from printing the contents of an array with only 17 bytes?", "body": "<p>You're getting this output because of one of two things: either you're accessing your <code>collector</code> array out of its bounds, or you're failing to initialize the last few members of that array, resulting in garbage data being accessed.</p>\n\n<p>Your algorithm assumes that <code>collector</code> and <code>doubledDigs</code> have the same number of members, but since your code doesn't include the part where you declare that array, it's unclear if that is true or not.</p>\n\n<p>Assuming they are the same size, if you're filling <code>collector</code> with the input \"1234567890123\", then you're leaving 3 uninitialized members. In C, if you do not explicitly set the value of a variable or array member, its initial value is equal to whatever happens to be in memory at that particular location. For a signed <code>int</code>, that can be anywhere between 2,147,483,647 and -2,147,483,648.</p>\n\n<p>To guard against this, the first thing you may want to do is zero-initialize your array using <code>int collector[16] = {0};</code>.</p>\n\n<p>That only fixes things in the case that <code>collector</code> and <code>doubledDigs</code> are supposed to be the same size. If it's intended that <code>collector</code> has 14 members and <code>doubledDigs</code> has 16, for instance, you will have to revisit your loop logic. In that example, in the last 2 iterations of the loop, you will attempt access the 15th and 16th members of <code>collector</code>, which don't exist. C will not stop you from doing this, but the result is undefined behavior at best.</p>\n"}], "owner": {"reputation": 31, "user_id": 4981715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dAkX1GD2VnY/AAAAAAAAAAI/AAAAAAAACWw/3CQVcQDZJ2U/photo.jpg?sz=128", "display_name": "tome robe", "link": "https://stackoverflow.com/users/4981715/tome-robe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 43378511, "answer_count": 1, "score": 0, "last_activity_date": 1492030418, "creation_date": 1492024785, "question_id": 43377929, "link": "https://stackoverflow.com/questions/43377929/why-am-i-getting-this-output-from-printing-the-contents-of-an-array-with-only-17", "title": "Why am I getting this output from printing the contents of an array with only 17 bytes?", "body": "<p>I am working through CS50 on edX and have reached the problem where you have to do a checksum for credit card numbers.I am new to programming and even newer to C.</p>\n\n<p>I am collecting the digits in arrays so I can manipulate them.\nI have collected every other digit from the original number and multiplied this by two.</p>\n\n<p>When I try to print this collection I get the digits I want initially but then a dash and whole load of other numbers - I have no idea where these are coming from?</p>\n\n<pre><code>// establishing another array to collect the doubled digits of every other digit from the first array\nint doubledDigs[16];\nint k = 0;\n// building that array, ensuring to split any multi digit products and add them idnividually\nfor (int i = 0; i&lt;= 15; i += 2, k++)\n{\n   int a = collector[i] * 2;\n   if (a &gt; 9)\n   {\n       for (int c=0; c &lt; 2; c++, k++)\n       {\n           int b = a % 10;\n           doubledDigs[k] = b;\n           a = floor(a / 10);\n       }\n   }\n   doubledDigs[k] = a;\n}\n// print doubledDigs to check it is working\nfor (int i = 0; i &lt;= 15; i++)\n{\n    int b = doubledDigs[i];\n    printf (\"%i\", b);\n}\nprintf (\"\\n\");\n\n//add all the doubled digits together\nint doubledProduct = 0;\nfor (int i=0; i &lt;= 15; i++)\n{\n    doubledProduct += doubledDigs[i];\n}\n//print product to check\nprintf(\"%i\\n\", doubledProduct);\n</code></pre>\n\n<p>So if input 1234567890123 as my card number I get 62810410010620-74895702432659\n-748924334\nas an output.The first 14 digits are correct and the ones that I want - but where are all these other numbers coming from?</p>\n"}, {"tags": ["c", "linux", "glibc", "glib", "libc"], "comments": [{"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "edited": false, "score": 1, "creation_date": 1492067596, "post_id": 43377924, "comment_id": 73832982, "body": "Can you use functions from GIO as well as GLib?"}], "answers": [{"comments": [{"owner": {"reputation": 609, "user_id": 1874373, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2b5e19800ac8954500ecdcc5a46971f9?s=128&d=identicon&r=PG&f=1", "display_name": "GTK 1.2.6 fanboy", "link": "https://stackoverflow.com/users/1874373/gtk-1-2-6-fanboy"}, "edited": false, "score": 0, "creation_date": 1523562958, "post_id": 43636454, "comment_id": 86624471, "body": "+1; maybe I would have mentioned that <code>g_autoptr</code> and <code>g_file_enumerator_iterate</code> are rather new &quot;phenomenons&quot;, but I found this a surprisingly elegant solution."}, {"owner": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "reply_to_user": {"reputation": 609, "user_id": 1874373, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2b5e19800ac8954500ecdcc5a46971f9?s=128&d=identicon&r=PG&f=1", "display_name": "GTK 1.2.6 fanboy", "link": "https://stackoverflow.com/users/1874373/gtk-1-2-6-fanboy"}, "edited": false, "score": 0, "creation_date": 1523610972, "post_id": 43636454, "comment_id": 86641167, "body": "I\u2019ve edited it to clarify this. They only require GLib 2.44, which is now quite old (we\u2019ve just released GLib 2.56), but it\u2019s worth pointing out that g_autoptr() only works on GCC or Clang."}], "tags": [], "owner": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "is_accepted": false, "score": 2, "last_activity_date": 1523610936, "last_edit_date": 1523610936, "creation_date": 1493215343, "answer_id": 43636454, "question_id": 43377924, "link": "https://stackoverflow.com/questions/43377924/is-there-a-similar-function-to-boostfilesystemremove-allpath-in-glib-or-li/43636454#43636454", "title": "Is there a similar function to boost::filesystem::remove_all(path) in glib or libc?", "body": "<p>There is nothing currently in GIO which implements the equivalent of <code>rm -rf</code>, but you can build something which does that fairly easily:</p>\n\n<pre><code>/* Recursively delete @file and its children. @file may be a file or a directory. */\nstatic gboolean\nrm_rf (GFile         *file,\n       GCancellable  *cancellable,\n       GError       **error)\n{\n  g_autoptr(GFileEnumerator) enumerator = NULL;\n\n  enumerator = g_file_enumerate_children (file, G_FILE_ATTRIBUTE_STANDARD_NAME,\n                                          G_FILE_QUERY_INFO_NOFOLLOW_SYMLINKS,\n                                          cancellable, NULL);\n\n  while (enumerator != NULL)\n    {\n      GFile *child;\n\n      if (!g_file_enumerator_iterate (enumerator, NULL, &amp;child, cancellable, error))\n        return FALSE;\n      if (child == NULL)\n        break;\n      if (!rm_rf (child, cancellable, error))\n        return FALSE;\n    }\n\n  return g_file_delete (file, cancellable, error);\n}\n</code></pre>\n\n<p>Note that the use of <a href=\"https://developer.gnome.org/glib/stable/glib-Miscellaneous-Macros.html#g-autoptr\" rel=\"nofollow noreferrer\"><code>g_autoptr()</code></a> requires GLib 2.44 and a compiler which supports automatic cleanup (currently, only GCC or Clang). <a href=\"https://developer.gnome.org/gio/stable/GFileEnumerator.html#g-file-enumerator-iterate\" rel=\"nofollow noreferrer\"><code>g_file_enumerator_iterate()</code></a> also requires GLib 2.44.</p>\n"}], "owner": {"reputation": 43, "user_id": 2143819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0611ec8f54767150aa13f66df47687fd?s=128&d=identicon&r=PG", "display_name": "user2143819", "link": "https://stackoverflow.com/users/2143819/user2143819"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1523610936, "creation_date": 1492024773, "question_id": 43377924, "link": "https://stackoverflow.com/questions/43377924/is-there-a-similar-function-to-boostfilesystemremove-allpath-in-glib-or-li", "title": "Is there a similar function to boost::filesystem::remove_all(path) in glib or libc?", "body": "<p>I cannot use boost, but only glib and libc functions.</p>\n\n<p>If you check glib you will find g_remove, g_rmdir, and g_unlink and none of them delete non-empty directories.</p>\n\n<p>I have seen posts that implement a function to recursively delete all files and subdirectories inside a directory like the Linux command \"rm -rf path\".</p>\n\n<p>I prefer to uses a well tested implementation in C.</p>\n\n<p>Which implementation/api do you recommend ?</p>\n\n<p>thanks.</p>\n"}, {"tags": ["c", "rotation", "sdl"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 4, "creation_date": 1492025210, "post_id": 43377916, "comment_id": 73818100, "body": "Always use the original (unmodified) image as the input argument for the rotate function."}, {"owner": {"reputation": 49, "user_id": 5147648, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/10207419023303234/picture?type=large", "display_name": "Callum Luke Perks", "link": "https://stackoverflow.com/users/5147648/callum-luke-perks"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1492026779, "post_id": 43377916, "comment_id": 73819001, "body": "Why does using the rotated coordinates cause it to shrink?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5147648, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/10207419023303234/picture?type=large", "display_name": "Callum Luke Perks", "link": "https://stackoverflow.com/users/5147648/callum-luke-perks"}, "edited": false, "score": 0, "creation_date": 1492026626, "post_id": 43378054, "comment_id": 73818904, "body": "why would this top the image shrinking?"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "reply_to_user": {"reputation": 49, "user_id": 5147648, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/10207419023303234/picture?type=large", "display_name": "Callum Luke Perks", "link": "https://stackoverflow.com/users/5147648/callum-luke-perks"}, "edited": false, "score": 3, "creation_date": 1492027890, "post_id": 43378054, "comment_id": 73819654, "body": "@CallumLukePerks: Because you aren&#39;t accumulating floating-point error by re-using the rotated positions."}], "tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": false, "score": 3, "last_activity_date": 1492025272, "creation_date": 1492025272, "answer_id": 43378054, "question_id": 43377916, "link": "https://stackoverflow.com/questions/43377916/rotation-is-slowly-shrinking-image/43378054#43378054", "title": "Rotation is slowly shrinking image", "body": "<p>Don't update the coordinates in-place, store the rotated coordinates in a separate array.</p>\n"}], "owner": {"reputation": 49, "user_id": 5147648, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/10207419023303234/picture?type=large", "display_name": "Callum Luke Perks", "link": "https://stackoverflow.com/users/5147648/callum-luke-perks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492025272, "creation_date": 1492024739, "question_id": 43377916, "link": "https://stackoverflow.com/questions/43377916/rotation-is-slowly-shrinking-image", "title": "Rotation is slowly shrinking image", "body": "<p>I am drawing a triangle using SDL. The following function is meant to take the coordinates of the triangle which are stored in the 'triCoords' array and rotate them by the specified angle around the center of the triangle which is stored in the 'triPos' array. However, while it seems to rotate correctly it is also shrinking the triangle over time</p>\n\n<pre><code>triCoords[0]=((triCoords[0] - triPos[0])*cos(angle) - (triCoords[1] - triPos[1])*sin(angle)) + triPos[0];\ntriCoords[1]=((triCoords[1] - triPos[1])*cos(angle) + (triCoords[0] - triPos[0])*sin(angle)) + triPos[1];\ntriCoords[2]=((triCoords[2] - triPos[0])*cos(angle) - (triCoords[3] - triPos[1])*sin(angle)) + triPos[0];\ntriCoords[3]=((triCoords[3] - triPos[1])*cos(angle) + (triCoords[2] - triPos[0])*sin(angle)) + triPos[1];\ntriCoords[4]=((triCoords[4] - triPos[0])*cos(angle) - (triCoords[5] - triPos[1])*sin(angle)) + triPos[0];\ntriCoords[5]=((triCoords[5] - triPos[1])*cos(angle) + (triCoords[4] - triPos[0])*sin(angle)) + triPos[1];\n</code></pre>\n"}, {"tags": ["c++", "c", "rsa", "tpm", "trusted-computing"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1492024920, "post_id": 43377862, "comment_id": 73817955, "body": "I use that a lot but every time I succeed they arrest me."}, {"owner": {"reputation": 51, "user_id": 6788777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061b6931563c6a1647d1e80c1b09a4c5?s=128&d=identicon&r=PG&f=1", "display_name": "Adam S", "link": "https://stackoverflow.com/users/6788777/adam-s"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1492027430, "post_id": 43377862, "comment_id": 73819362, "body": "What do you mean?"}], "owner": {"reputation": 51, "user_id": 6788777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061b6931563c6a1647d1e80c1b09a4c5?s=128&d=identicon&r=PG&f=1", "display_name": "Adam S", "link": "https://stackoverflow.com/users/6788777/adam-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492024518, "creation_date": 1492024518, "question_id": 43377862, "link": "https://stackoverflow.com/questions/43377862/binding-unbinding-with-trousers-library", "title": "Binding &amp; Unbinding with TrouSerS library", "body": "<p>I'm using TrouSerS library. I want to write one app which will bind AES key and put this bounded key into file and second app which will decrypt this key from file.</p>\n\n<p>Here is my codes:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n\n#include &lt;tss/tss_error.h&gt;\n#include &lt;tss/platform.h&gt;\n#include &lt;tss/tss_defines.h&gt;\n#include &lt;tss/tss_typedef.h&gt;\n#include &lt;tss/tss_structs.h&gt;\n#include &lt;tss/tspi.h&gt;\n#include &lt;trousers/trousers.h&gt;\n\n#define DBG(message, tResult) printf(\"Line%d, %s) %s returned 0x%08x. %s.\\n\", __LINE__, __func__, message, tResult,(char *)Trspi_Error_String(tResult));\n\n\n\nint main(int argc, char **argv){\n    TSS_HCONTEXT    hContext=0;\n    TSS_HTPM        hTPM=0;\n    TSS_RESULT      result;\n    TSS_HKEY            hSRK=0;\n    TSS_HPOLICY     hSRKPolicy=0;\n    TSS_HPOLICY     hTPMPolicy=0;\n    TSS_UUID        SRK_UUID=TSS_UUID_SRK;\n    BYTE            wks[20]; \n    memset(wks,0,20);  \n\n\nresult=Tspi_Context_Create(&amp;hContext);\nresult=Tspi_Context_Connect(hContext, NULL);\nresult=Tspi_Context_GetTpmObject(hContext, &amp;hTPM);\nresult=Tspi_Context_LoadKeyByUUID(hContext,TSS_PS_TYPE_SYSTEM, SRK_UUID, &amp;hSRK);\nresult=Tspi_GetPolicyObject(hSRK, TSS_POLICY_USAGE, &amp;hSRKPolicy);\nresult=Tspi_Policy_SetSecret(hSRKPolicy, TSS_SECRET_MODE_SHA1,20,wks);\n\nUINT32  ulDataLength;\nBYTE    *rgbBoundData;\nFILE    *fin;\nTSS_HKEY    hBindingKey;\nBYTE        newPubKey[284];\nfin=fopen(\"Bind.pub\",\"r\");\n  read(fileno(fin),newPubKey,284);\nfclose(fin);\n\nTSS_FLAG    initFlags;\ninitFlags=TSS_KEY_TYPE_BIND|TSS_KEY_SIZE_2048|TSS_KEY_AUTHORIZATION|TSS_KEY_NOT_MIGRATABLE;\n\nresult=Tspi_Context_CreateObject(hContext, TSS_OBJECT_TYPE_RSAKEY, initFlags, &amp;hBindingKey);\nDBG(\"\",result);\nresult=Tspi_SetAttribData(hBindingKey, TSS_TSPATTRIB_KEY_BLOB, TSS_TSPATTRIB_KEYBLOB_PUBLIC_KEY, 284, newPubKey);\nDBG(\"\",result);\n\nBYTE    encData[7];\nTSS_HENCDATA hEncData;\nfin=fopen(\"AES.key\",\"rb\");\n  read(fileno(fin),encData,7);\nfclose(fin);\nresult=Tspi_Context_CreateObject(hContext, TSS_OBJECT_TYPE_ENCDATA, TSS_ENCDATA_BIND, &amp;hEncData);\nDBG(\"\",result);\nresult=Tspi_Data_Bind(hEncData, hBindingKey, 7, encData);\nDBG(\"\",result);\nresult=Tspi_GetAttribData(hEncData, TSS_TSPATTRIB_ENCDATA_BLOB, TSS_TSPATTRIB_ENCDATABLOB_BLOB, &amp;ulDataLength, &amp;rgbBoundData);\nDBG(\"\",result);\nFILE *fout;\nfout=fopen(\"Bound.data\",\"wb\");\n  write(fileno(fout),rgbBoundData,ulDataLength);\nfclose(fout);\nTspi_Context_Close(hSRKPolicy);\nDBG(\"\", result);\nTspi_Context_FreeMemory(hContext, NULL);\nDBG(\"\", result);\nTspi_Context_Close(hContext);\nDBG(\"\", result);\nreturn 0;\n}\n</code></pre>\n\n<p>It's executing without any errors.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n\n#include &lt;tss/tss_error.h&gt;\n#include &lt;tss/platform.h&gt;\n#include &lt;tss/tss_defines.h&gt;\n#include &lt;tss/tss_typedef.h&gt;\n#include &lt;tss/tss_structs.h&gt;\n#include &lt;tss/tspi.h&gt;\n#include &lt;trousers/trousers.h&gt;\n\n#define DBG(message, tResult) printf(\"Line%d, %s) %s returned 0x%08x. %s.\\n\", __LINE__, __func__, message, tResult,(char *)Trspi_Error_String(tResult));\n\n\n\nint main(int argc, char **argv){\n    TSS_HCONTEXT    hContext=0;\n    TSS_HTPM        hTPM=0;\n    TSS_RESULT      result;\n    TSS_HKEY            hSRK=0;\n    TSS_HPOLICY     hSRKPolicy=0;\n    TSS_HPOLICY     hTPMPolicy=0;\n    TSS_UUID        SRK_UUID=TSS_UUID_SRK;\n    BYTE            wks[20]; \n    memset(wks,0,20);  \n\nresult=Tspi_Context_Create(&amp;hContext);\nresult=Tspi_Context_Connect(hContext, NULL);\nresult=Tspi_Context_GetTpmObject(hContext, &amp;hTPM);\nresult=Tspi_Context_LoadKeyByUUID(hContext,TSS_PS_TYPE_SYSTEM, SRK_UUID, &amp;hSRK);\nresult=Tspi_GetPolicyObject(hSRK, TSS_POLICY_USAGE, &amp;hSRKPolicy);\nresult=Tspi_Policy_SetSecret(hSRKPolicy, TSS_SECRET_MODE_SHA1,20,wks);\n\nUINT32  encLen=256;\nBYTE    encryptedData[256], *pointer;\nBYTE    *rgbDataunBound;\nUINT32  ulDataLength;\nTSS_UUID MY_UUID={0,0,0,0,0,{0,0,0,2,11}};\nFILE *fin;\nFILE *fout;\nTSS_HKEY    hUnbindKey=0;\nfin=fopen(\"Bound.data\",\"rb\");\nread(fileno(fin),encryptedData,&amp;ulDataLength);\nfclose(fin);\nTSS_HENCDATA hEncData;\nresult=Tspi_Context_CreateObject(hContext, TSS_OBJECT_TYPE_ENCDATA, TSS_ENCDATA_BIND, &amp;hEncData);\nDBG(\"\",result);\nresult=Tspi_SetAttribData(hEncData, TSS_TSPATTRIB_ENCDATA_BLOB,TSS_TSPATTRIB_ENCDATABLOB_BLOB,256,encryptedData);\nDBG(\"\",result);\n\nresult=Tspi_Context_GetKeyByUUID(hContext, TSS_PS_TYPE_SYSTEM, MY_UUID, &amp;hUnbindKey);\nDBG(\"\",result);\nresult=Tspi_Key_LoadKey(hUnbindKey,hSRK);\nDBG(\"\",result);\n\nTSS_HPOLICY hUnbindPolicy;\nresult=Tspi_GetPolicyObject(hUnbindKey, TSS_POLICY_USAGE, &amp;hUnbindPolicy);\nDBG(\"\",result);\nresult=Tspi_Policy_SetSecret(hUnbindPolicy,TSS_SECRET_MODE_PLAIN,3,\"123\");\nDBG(\"\",result);\n\nresult=Tspi_Data_Unbind(hEncData, hUnbindKey, &amp;ulDataLength, &amp;rgbDataunBound);\nDBG(\"\",result);\n\nTspi_Context_Close(hSRKPolicy);\nDBG(\"\", result);\nTspi_Context_FreeMemory(hContext, NULL);\nDBG(\"\", result);\nTspi_Context_Close(hContext);\nDBG(\"\", result);\nreturn 0;\n}\n</code></pre>\n\n<p>And here I'm getting \"0x00000021. Decryption error.\" after Tspi_Data_Unbind function.</p>\n\n<p>Could you help me, please? </p>\n"}, {"tags": ["c", "long-integer", "bit-shift", "unsigned", "8051"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1492021757, "post_id": 43376973, "comment_id": 73816175, "body": "How wide is <code>int</code> on your system? It is likely to be 16 bits. And the arithmetic is done with operands promoted to <code>int</code>, so shifting by <code>16</code> will give you a nice zero..."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1492021839, "post_id": 43376973, "comment_id": 73816224, "body": "@EugeneSh.: Shifting by 16 will give you <i>undefined behavior</i>"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1492021966, "post_id": 43376973, "comment_id": 73816290, "body": "8051 appears to be the &quot;Intel_MCS-51&quot;, which has 8-bit registers? <a href=\"https://en.wikipedia.org/wiki/Intel_MCS-51\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Intel_MCS-51</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1492022039, "post_id": 43376973, "comment_id": 73816326, "body": "@MooingDuck It depends on the value of <code>address_byte3</code> <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.7p4\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.7p4</a> But yeah. UB in the absolute majority of cases (except <code>address_byte3=0</code>.)"}, {"owner": {"reputation": 77, "user_id": 6906043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1MD9D.jpg?s=128&g=1", "display_name": "Jaime Perez", "link": "https://stackoverflow.com/users/6906043/jaime-perez"}, "edited": false, "score": 0, "creation_date": 1492022247, "post_id": 43376973, "comment_id": 73816434, "body": "Hi, yes <code>int</code> value is 2 bytes wide. I was not aware that my char variables would be promoted to an <code>int</code> upon operations."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1492022817, "post_id": 43376973, "comment_id": 73816806, "body": "@EugeneSh.: Shifting an 16 bit <code>int</code> by 16 invokes undefined behaviour, that&#39;s not a matter of &quot;majority&quot; or the original value. Even for a smaller shiftcount, it will invoke UB if the sign is shifted. There is no guarantee it will be <code>0</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492022992, "post_id": 43376973, "comment_id": 73816908, "body": "@JaimePerez: That&#39;s basic C knowledge. You really should read about integer promotions and inform about other pitfalls of the language!"}, {"owner": {"reputation": 77, "user_id": 6906043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1MD9D.jpg?s=128&g=1", "display_name": "Jaime Perez", "link": "https://stackoverflow.com/users/6906043/jaime-perez"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492024079, "post_id": 43376973, "comment_id": 73817459, "body": "@Olaf i will make sure to buff up on that!"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1492022346, "post_id": 43377042, "comment_id": 73816498, "body": "Care should be take in case the bytes are actually <code>signed char</code>"}, {"owner": {"reputation": 77, "user_id": 6906043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1MD9D.jpg?s=128&g=1", "display_name": "Jaime Perez", "link": "https://stackoverflow.com/users/6906043/jaime-perez"}, "edited": false, "score": 0, "creation_date": 1492022413, "post_id": 43377042, "comment_id": 73816548, "body": "This worked and just about solved every other bug I was seeing in my code. Thank you. I was not aware that my <code>char</code> variables would be promoted to an <code>int</code>. So casting it would prevent me from losing any of my bits when doing bitwise op on them? Also, I am casting this inside a routine so does that mean that this will only happen in the routine and the variable will not be affected in the <code>main()</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1492022533, "post_id": 43377042, "comment_id": 73816630, "body": "Casting does not affect the casted variable."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1492026458, "post_id": 43377042, "comment_id": 73818787, "body": "I would put extra parens to visually enforce that the cast is applied to the variable before shifting not after, even if there is an order of operations rule..."}], "tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 1, "last_activity_date": 1492021715, "creation_date": 1492021715, "answer_id": 43377042, "question_id": 43376973, "link": "https://stackoverflow.com/questions/43376973/bit-shifting-not-shifting-correctly/43377042#43377042", "title": "Bit shifting not shifting correctly?", "body": "<p>Variables shorter than <code>int</code> are promoted to <code>int</code> when doing calculations on them. It seems that your <code>int</code> type is 16-bit, so shifting it by 16 bits doesn't work right.</p>\n\n<p>You should explicitly cast the variables to the result type (<code>unsigned long</code>):</p>\n\n<pre><code>address_sum = ((unsigned long)address_byte3&lt;&lt;16) +\n              ((unsigned long)address_byte2&lt;&lt;8) +\n              (unsigned long)address_byte1;\n</code></pre>\n\n<p>The last casting is superfluous but doesn't hurt.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1492025125, "last_edit_date": 1495540952, "creation_date": 1492023095, "answer_id": 43377446, "question_id": 43376973, "link": "https://stackoverflow.com/questions/43376973/bit-shifting-not-shifting-correctly/43377446#43377446", "title": "Bit shifting not shifting correctly?", "body": "<p>A shift of a 16-bit <code>int/unsigned</code>, as well explained by <a href=\"https://stackoverflow.com/a/43377042/2410359\">@anatolyg</a> will only result in a 16-bit answer.</p>\n\n<p>I avoid casting, as a general promotion scheme, as sometimes it may <em>narrow</em> the result as code evolves over time and the maintainer uses wider operands.</p>\n\n<p>Alternatives:</p>\n\n<p><code>((type_of_target) 1) *</code>: This will insure each operation is <em>at least</em> the width of the target.</p>\n\n<pre><code>unsigned long address_sum;\n...\naddress_sum = (1UL*address_byte3&lt;&lt;16) + (1UL*address_byte2&lt;&lt;8) + address_byte1;\n</code></pre>\n\n<p>Assign to the destination and then operate:</p>\n\n<pre><code>address_sum = address_byte3;\naddress_sum = address_sum &lt;&lt; 8 + address_byte2;\naddress_sum = address_sum &lt;&lt; 8 + address_byte1;\n</code></pre>\n\n<p>A sneaky, thought not pleasant looking 1-line alternative.  Recall <code>* +</code> higher order precedence than shift</p>\n\n<pre><code>address_sum = (0*address_sum + address_byte3 &lt;&lt; 16) + \n              (0*address_sum + address_byte2 &lt;&lt;  8) + address_byte1;\n</code></pre>\n\n<hr>\n\n<p>Consider <a href=\"https://stackoverflow.com/questions/43376973/bit-shifting-not-shifting-correctly/43377446#comment73816498_43377042\">@Eugene Sh.</a> concern and use 8-bit unsigned \"bytes\".</p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 6906043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1MD9D.jpg?s=128&g=1", "display_name": "Jaime Perez", "link": "https://stackoverflow.com/users/6906043/jaime-perez"}, "edited": false, "score": 0, "creation_date": 1492036034, "post_id": 43378453, "comment_id": 73823363, "body": "Yes you can shift more than one bit per instruction. I am sure that that is what you are doing in your example above My problem was that I was unaware that my variables were being promoted to and int and when I shifted by 16 bits the uppermost were lost thus giving me undefined behavior."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 77, "user_id": 6906043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1MD9D.jpg?s=128&g=1", "display_name": "Jaime Perez", "link": "https://stackoverflow.com/users/6906043/jaime-perez"}, "edited": false, "score": 0, "creation_date": 1492049540, "post_id": 43378453, "comment_id": 73826808, "body": "I am talking about the instruction set some instruction sets the shift instruction is one bit at a time and you have to call the instruction many times.  I have experienced so many instruction sets I dont remember the nuances of every single one that I havent used in a few years...the 8051 comes from the era of one bit per shift, but the 8086 is a similar era and has a multibit shift option."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 77, "user_id": 6906043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1MD9D.jpg?s=128&g=1", "display_name": "Jaime Perez", "link": "https://stackoverflow.com/users/6906043/jaime-perez"}, "edited": false, "score": 0, "creation_date": 1492049952, "post_id": 43378453, "comment_id": 73826931, "body": "yeah it uses a one bit shift per instruction (rlc or rrc basically), but since the registers are 8 bits, shifting wouldnt actually happen here, registers would likely not be used either but three memory locations, and I dont know what you would be using a 24 bit address with, but that is another story..."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 0, "last_activity_date": 1492026690, "creation_date": 1492026690, "answer_id": 43378453, "question_id": 43376973, "link": "https://stackoverflow.com/questions/43376973/bit-shifting-not-shifting-correctly/43378453#43378453", "title": "Bit shifting not shifting correctly?", "body": "<p>My preference is a variation on chux</p>\n\n<p>bigger declaration address;\nbyte declaration a,b,c;</p>\n\n<pre><code>address =a; address&lt;&lt;=8;\naddress|=b; address&lt;&lt;=8;\naddress|=c;\n</code></pre>\n\n<p>Despite being the most verbose all of the answers thus far should optimize into basically the same code.  But would have to test the specific compiler to see.  Can the 8051 shift more than one bit at a time per instruction anyway?  Dont remember.</p>\n"}], "owner": {"reputation": 77, "user_id": 6906043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1MD9D.jpg?s=128&g=1", "display_name": "Jaime Perez", "link": "https://stackoverflow.com/users/6906043/jaime-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 43377042, "answer_count": 3, "score": 0, "last_activity_date": 1492026690, "creation_date": 1492021500, "question_id": 43376973, "link": "https://stackoverflow.com/questions/43376973/bit-shifting-not-shifting-correctly", "title": "Bit shifting not shifting correctly?", "body": "<p>I am programming the 8051 in C using the Si Labs IDE. I currently have three bytes: <code>address_byte3, address_byte2, and address_byte1</code>. I then initialized a variable <code>address_sum</code> to be an <code>unsigned long int</code> then did the following operation on it...</p>\n\n<pre><code>address_sum=(address_byte3&lt;&lt;16)+(address_byte2&lt;&lt;8)+(address_byte1);\n</code></pre>\n\n<p>This operation would lead me to believe that the value loaded into <code>address_sum</code> if <code>address_byte3, address_byte2, &amp; address_byte1</code> were <code>0x92, 0x56, &amp; 0x78</code>, respectively, would be <code>0xXX925678</code>. Instead I am getting a value of <code>0xXX005678</code>. My logic seems sound but then again I am the one writing the code so I'm biased and could be blinded by my own ignorance. Does anyone have a solution or an explanation as to why the value for <code>address_byte</code> is \"lost\"? </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "algorithm", "data-structures", "tree", "stack"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1492023033, "post_id": 43376887, "comment_id": 73816926, "body": "Try running your program from inside a debugger. Make sure you compile your program with debugging information enabled if you are using a command shell to invoke your compiler."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1492033854, "post_id": 43376887, "comment_id": 73822527, "body": "It would be much easier to do this recursively. Have a single function that returns a tree node. If it pops a value off the stack, then return that value as a leaf node. If it pops an operator that operates on two values, have it create a tree node, and call itself for both child nodes. That&#39;s it. (For useful error messages, use a structure with a pointer to the &quot;bad&quot; stack element, initialized to &quot;no error&quot;. Pass a pointer to that structure to the recursive function, and have it bail out if the error structure indicates an error already occurred.)"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1492051393, "post_id": 43376887, "comment_id": 73827261, "body": "&quot;Keeps crashing my program&quot; isn&#39;t much to go on. Is there an error message displayed when the program crashes? Does it tell you on what line it crashes? Have you run the program in a debugger? We can&#39;t help if you don&#39;t give us more information."}, {"owner": {"reputation": 53, "user_id": 7231645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c5d5188913f8719033e98088941d0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero_Cool", "link": "https://stackoverflow.com/users/7231645/zero-cool"}, "edited": false, "score": 0, "creation_date": 1492164319, "post_id": 43376887, "comment_id": 73877822, "body": "It works now.I just needed to make my tree empty before exiting the while loop in else case. It changed the structure of tree and therefore traversal gave that crash error"}], "owner": {"reputation": 53, "user_id": 7231645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2c5d5188913f8719033e98088941d0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero_Cool", "link": "https://stackoverflow.com/users/7231645/zero-cool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492162634, "creation_date": 1492021238, "last_edit_date": 1492162634, "question_id": 43376887, "link": "https://stackoverflow.com/questions/43376887/how-to-make-a-binary-expression-tree-from-a-postfix-expression", "title": "How to make a binary expression tree from a postfix expression?", "body": "<p>I have been trying to write this code for a while now and even though I know what to do, I am still unable to figure out my error.</p>\n\n<p>The goal was to take a postfix expression and convert it to binary expression tree and then traverse it.</p>\n\n<p>My logic was:</p>\n\n<ol>\n<li><p>If it wasn't an operator, I made a leaf node 'temp' ( i.e <code>temp-&gt;Left=temp-&gt;Right=NULL</code>) and pushed it onto an array based stack of type tree.</p></li>\n<li><p>If it was an operator, I inserted it onto a tree 'T' and then popped my stack twice to add <code>T-&gt;Left</code> and <code>T-&gt;Right</code>.</p></li>\n<li><p>I then pushed the resultant 'T' onto stack and loop iterated till the expression was read.</p></li>\n</ol>\n\n<p>My loop iterated fine and even my stack has one entry remaining at the end but I can't call InOrder, PostOrder or PreOrder traversal onto the resultant as it keeps crashing my program.</p>\n\n<p>My main code is:</p>\n\n<pre><code>while(expression[i]!='\\0'){\n    if(expression[i]==' '){\n        i++;\n        continue;\n    }\n    if(expression[i]!='*' &amp;&amp;\n       expression[i]!='/' &amp;&amp;\n       expression[i]!='-' &amp;&amp;\n       expression[i]!='+'){\n\n        temp = MakeEmpty(NULL);\n        temp=Insert(expression[i],temp);\n        Push(temp,S);\n    }else{\n        T=Insert(expression[i],T);\n        Operand2=TopAndPop(S);\n        Operand1=TopAndPop(S);\n        T=FullTree(Operand1,Operand2,T);\n        Push(T,S);\n        T=MakeEmpty(NULL);   //It just needed to be reset\n    }\n    i++;\n}\n</code></pre>\n\n<p>Additional codes can be provided.</p>\n\n<p>FullTree function just sets Operand1 as <code>T-&gt;Left</code> and <code>Operand2</code> as <code>T-&gt;Right</code>.\nInOrder traversal traverses left, prints the <code>T-&gt;Element</code> and then traverses right. </p>\n\n<p>I really appreciate any help that I can get.Also, if I made any mistakes in posting, kindly guide me so I won't do it again.</p>\n"}, {"tags": ["c", "arrays", "multithreading"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1492021263, "post_id": 43376743, "comment_id": 73815919, "body": "Does pthread put threads on different cores? Is there any reason to think it would?"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1492021330, "post_id": 43376743, "comment_id": 73815962, "body": "@LeeDanielCrocker  pthread knows nothing about cores.  It delegates that level of thread management to the OS."}, {"owner": {"reputation": 135, "user_id": 5786544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4fafe56ad0c8b913995c3e8c0b6ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Denolth", "link": "https://stackoverflow.com/users/5786544/denolth"}, "edited": false, "score": 0, "creation_date": 1492021589, "post_id": 43376743, "comment_id": 73816095, "body": "I measured the time it took for a thread to start and finish computation, before using the lock. It&#39;s really fast for the first thread and gets increasingly bigger for the other threads. You can try it yourself, if possible! I don&#39;t believe the lock is the problem."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492021723, "post_id": 43376743, "comment_id": 73816159, "body": "@Denolth you&#39;re right, which is why I deleted my comment;)"}, {"owner": {"reputation": 135, "user_id": 5786544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4fafe56ad0c8b913995c3e8c0b6ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Denolth", "link": "https://stackoverflow.com/users/5786544/denolth"}, "edited": false, "score": 0, "creation_date": 1492021756, "post_id": 43376743, "comment_id": 73816174, "body": "All good! I had an error in my code when I copy and pasted. I corrected it now (just syntax)"}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492021842, "post_id": 43376743, "comment_id": 73816226, "body": "Get rid of that thread affinity gunge - it&#39;s just muddying the waters."}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 0, "creation_date": 1492022024, "post_id": 43376743, "comment_id": 73816323, "body": "Your locking isn&#39;t thread-safe at all. I suggest you use the synchronization primitives in C++11 (<code>std::mutex</code> or for lower level stuff <code>std::atomic</code>)."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 0, "creation_date": 1492022097, "post_id": 43376743, "comment_id": 73816360, "body": "@Cameron Ewww!  I hadn&#39;t noticed the expicit lock code:("}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492022561, "post_id": 43376743, "comment_id": 73816647, "body": "Nevertheless, I&#39;m somewhat baffled by the overall lack of speedup.  I can&#39;t see any of the usual cockups..."}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 0, "creation_date": 1492022716, "post_id": 43376743, "comment_id": 73816735, "body": "Another thing: Don&#39;t compare performance of debug builds (the default optimization level is <code>-O0</code>)."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492022729, "post_id": 43376743, "comment_id": 73816741, "body": "How many cores you got anyway?   I&#39;m still baffled - if you have 2 or more, I would expect a very noticeable improvement."}, {"owner": {"reputation": 135, "user_id": 5786544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4fafe56ad0c8b913995c3e8c0b6ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Denolth", "link": "https://stackoverflow.com/users/5786544/denolth"}, "edited": false, "score": 0, "creation_date": 1492023090, "post_id": 43376743, "comment_id": 73816964, "body": "I tried running on a i3 and i5, no speedups. The use of test and set is part of an assignment, which is why I wrote it. Cool part: if you uncomment the line that sends each thread to a fixed core, it runs around 8% faster. I assume its the use of the cache."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492023994, "post_id": 43376743, "comment_id": 73817418, "body": "@Denolth  I havn&#39;t seen any numbers anywhere that demostrate any significant advantage by using that affinity stuff."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492024108, "post_id": 43376743, "comment_id": 73817481, "body": "What happens if you make N  100000000 ?"}, {"owner": {"reputation": 135, "user_id": 5786544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4fafe56ad0c8b913995c3e8c0b6ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Denolth", "link": "https://stackoverflow.com/users/5786544/denolth"}, "edited": false, "score": 0, "creation_date": 1492025287, "post_id": 43376743, "comment_id": 73818140, "body": "I tried multiple configurations of N, from 10 to 10^9. The single-threaded program is still faster."}, {"owner": {"reputation": 135, "user_id": 5786544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4fafe56ad0c8b913995c3e8c0b6ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Denolth", "link": "https://stackoverflow.com/users/5786544/denolth"}, "edited": false, "score": 0, "creation_date": 1492027762, "post_id": 43376743, "comment_id": 73819566, "body": "My question was marked as duplicated and indeed I was measuring time in a wrong manner! The program is now around 3x faster when using 4 or more threads (since 2 cores are actually logical cores). Thanks!"}], "owner": {"reputation": 135, "user_id": 5786544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf4fafe56ad0c8b913995c3e8c0b6ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Denolth", "link": "https://stackoverflow.com/users/5786544/denolth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 1, "closed_date": 1492025954, "answer_count": 0, "score": 2, "last_activity_date": 1492021730, "creation_date": 1492020657, "last_edit_date": 1492021730, "question_id": 43376743, "link": "https://stackoverflow.com/questions/43376743/array-sum-with-4-threads-is-slower-than-1-thread", "closed_reason": "Duplicate", "title": "Array sum with 4 threads is slower than 1 thread", "body": "<p>I'm writing a program to sum N numbers in an array. To do this, the program may split its execution in a number of threads, each of them summing N/numThreads positions of the array. </p>\n\n<p>However, the fastest execution time I've got so far was using 1 thread. Using 4 threads may take as much as twice the time! I've thought a lot about this problem (including the possibility of false sharing), but I just can't think of a solution. I really can't see where the false sharing is occurring, if at all.</p>\n\n<p>I'm running Linux Mint and compiling using GCC by typing gcc spinlock.c -o spinlock -lpthread -lm\nMy code is below. Please feel free to compile it and play around with it. You may change the value of N (number of elements in array) by changing the Define in the program and you may pass any number of threads as arguments for the program:</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;pthread.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;sched.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\n#define N 10000000\n\nlong sumTotal = 0; /* Global sum variable */\nint lock = 0;    /* Lock for sum variable access */\n\nstruct threadInfo {            /* Argument passed to the function the thread will execute */\n    pthread_t     threadId;    /* Returned ID by pthread_create() */\n    int           threadNum;   /* Thread number (from 1 to threadNum) */\n    unsigned long sectionSize; /* Section size to operate */\n    int8_t*       section;     /* Pointer to start of the array to be summed */\n};\n\nvoid acquire(int* _lock) {\n    while (__sync_lock_test_and_set(_lock, 1));\n}\n\nvoid release(int* _lock) {\n    *_lock = 0;\n}\n\nvoid sumNum(void* arg){\n    struct threadInfo *tinfo = arg;\n    long i, sum = 0;\n\n    for (i=0; i &lt; tinfo-&gt;sectionSize; i++) {\n        sum += tinfo-&gt;section[i];\n    }\n\n\n    acquire(&amp;lock);\n    sumTotal += sum;\n    release(&amp;lock);\n}\n\nint main(int argc, char** argv)\n{\n    int8_t* numbers;\n    unsigned long sectionSize, currNum;\n    unsigned int currThr, numThreads;\n    int err, num_cores, i, core_interval, t1, t2;\n    double arithmetics;\n    pthread_attr_t attr;\n    struct threadInfo *tinfo;\n\n    /* Invalid number of arguments: */\n    if (argc != 2){\n        fprintf(stderr, \"Usage: %s [threads]\\n\", argv[0]);\n        exit(-1);\n    }\n\n    /* Converts argv to int: (K) */\n    numThreads = (int) strtol(argv[1], (char**) NULL, 10);\n    sectionSize = N/numThreads;\n\n    /* Randoms the seed: */\n    srand(time(NULL));\n\n    /* Fills array with numbers: */\n    numbers = (int8_t*) malloc(N);\n    for (currNum=0; currNum&lt;N; currNum++){\n        numbers[currNum] = (int8_t) (((rand())%199)-99);\n    }\n\n    /* Initializes struct containing default attributes of threads: */\n    err = pthread_attr_init(&amp;attr);\n    if (err != 0){\n        fprintf(stderr, \"Failed.\\n\");\n        exit(-2);\n    }\n\n    /* Allocates memory for pthread_create arguments: */\n    tinfo = calloc(numThreads, sizeof(struct threadInfo));\n    if (tinfo == NULL){\n        fprintf(stderr, \"Failed.\\n\");\n        exit(-3);\n    }\n\n    /* Thread affinity operations: */\n    num_cores = sysconf(_SC_NPROCESSORS_ONLN);\n    cpu_set_t cpuset[num_cores];\n    for (i=0; i&lt;num_cores; i++){\n        CPU_ZERO(&amp;(cpuset[i]));\n        CPU_SET(i+1, &amp;(cpuset[i]));\n    }\n    core_interval = N/num_cores;\n\n    t1 = clock();\n\n    /* Initialize threads: */\n    for (currThr=0; currThr&lt;numThreads; currThr++){\n        tinfo[currThr].threadNum = currThr + 1;\n        tinfo[currThr].section = &amp;(*(numbers+currThr*sectionSize));\n        /* If this is the last thread, takes the remainder of the array:     */\n        if (currThr+1 == numThreads) {\n            tinfo[currThr].sectionSize = N - (currThr*sectionSize);\n        /* Other threads: */\n        } else {\n            tinfo[currThr].sectionSize = sectionSize;\n        }\n\n        /* Calculates to which core a thread should go: */\n        arithmetics = (double) (currThr+1)*num_cores/numThreads;\n        i = ceil(arithmetics);\n        tinfo[currThr].threadId = pthread_self();\n        /* This line, if uncommented, sets a group of threads to a specific cpu (core): */\n        //pthread_setaffinity_np(tinfo[currThr].threadId, sizeof(cpu_set_t), &amp;cpuset[i-1]);\n\n        /* Creates the thread: */\n        err = pthread_create(&amp;tinfo[currThr].threadId,\n                             &amp;attr,\n                             (void*) &amp;sumNum,\n                             &amp;tinfo[currThr]);\n        if (err != 0){\n            fprintf(stderr, \"Failed to create thread.\\n\");\n            exit(-4);\n        }\n    }\n\n    void* ret = NULL;\n\n    /* Joins threads: */\n    for (currThr=0; currThr&lt;numThreads; currThr++) {\n        pthread_join(tinfo[currThr].threadId, &amp;ret);\n    }\n\n    t2 = clock();\n\n    printf(\"Total sum: %ld. Total time: %f\\n\", sumTotal, (t2-t1*1.0)/CLOCKS_PER_SEC);\n    return 0;\n}\n</code></pre>\n\n<p>Thank you for your time, any help is appreciated!</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 5, "creation_date": 1492020302, "post_id": 43376638, "comment_id": 73815391, "body": "Just do <code>printf(&quot;%05d&quot;, 42);</code>."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1492020361, "post_id": 43376638, "comment_id": 73815426, "body": "You can look up stuff like this for yourself in any <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">reference page</a> for <code>printf</code>."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1492020432, "post_id": 43376638, "comment_id": 73815473, "body": "Not sure if that&#39;s a dupe because of <i>or any number or character</i>."}, {"owner": {"reputation": 162, "user_id": 4516230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bmzQd.png?s=128&g=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/4516230/shivam"}, "reply_to_user": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1492022114, "post_id": 43376638, "comment_id": 73816369, "body": "@DanielKamilKozar - Thank you. That is exactly what I was looking for."}], "owner": {"reputation": 162, "user_id": 4516230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bmzQd.png?s=128&g=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/4516230/shivam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "closed_date": 1492020337, "answer_count": 0, "score": 0, "last_activity_date": 1492020244, "creation_date": 1492020244, "question_id": 43376638, "link": "https://stackoverflow.com/questions/43376638/printing-0-in-the-place-of-blank-space-while-using-5d-in-c", "closed_reason": "Duplicate", "title": "Printing 0 in the place of blank space while using %5d in C", "body": "<p>In <code>C</code>,</p>\n\n<pre><code>printf(\"%5d\", 42);\n</code></pre>\n\n<p>Will print 42 using 5 spaces. I want to replace those blank spaces with <code>0</code> or any number or character. What should I do ?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "kernel-module"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1492020195, "post_id": 43376468, "comment_id": 73815338, "body": "You can&#39;t just translate user space code into the kernel and have it work.  You will need to find out what the kernel-internal equivalent of each and every one of the missing functions is.  Be prepared to do <i>significantly</i> more work."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1492020267, "post_id": 43376468, "comment_id": 73815371, "body": "(I don&#39;t know what the equivalents are, but I do know that it doesn&#39;t actually make sense to call the &quot;standar[d] linux <code>open</code> system call&quot; from inside a device driver, and that the various termios functions you are trying to call are userspace C library wrappers around <code>ioctl</code> operations which, again, probably don&#39;t even make sense inside a device driver.)"}, {"owner": {"reputation": 339, "user_id": 5539291, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3Q14f.jpg?s=128&g=1", "display_name": "kivi", "link": "https://stackoverflow.com/users/5539291/kivi"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1492020749, "post_id": 43376468, "comment_id": 73815655, "body": "@zwol yes, i&#39;m starting to realize that now, thank you. I found kernel equivalents for file operations. But don&#39;t kwon what to do with termios functions yet"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 2, "creation_date": 1492023146, "post_id": 43376468, "comment_id": 73816996, "body": "Functions <code>tcgetattr</code> and <code>tcsetattr</code> are actually wrappers around <code>ioctl</code> requests. In kernel you may use <code>file-&gt;f_ops-&gt;unlocked_ioctl()</code> as analogue for ioctl syscall. For determine exact ioctl codes used by <i>termios</i>, write some code in user space, and run it under <code>trace</code> tool."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1492041643, "post_id": 43376468, "comment_id": 73824993, "body": "why return -1 on both success and failure"}], "answers": [{"tags": [], "owner": {"reputation": 734, "user_id": 4344886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oVM9a.png?s=128&g=1", "display_name": "Sr\u0111an Popi\u0107", "link": "https://stackoverflow.com/users/4344886/sr%c4%91an-popi%c4%87"}, "is_accepted": false, "score": 1, "last_activity_date": 1543910060, "creation_date": 1543910060, "answer_id": 53608124, "question_id": 43376468, "link": "https://stackoverflow.com/questions/43376468/linux-kernel-module-compile-error-implicit-declaration-of-function-open/53608124#53608124", "title": "Linux kernel module compile error: implicit declaration of function \u2018open\u2019", "body": "<p>I had the similar problem, what I found out is that adding </p>\n\n<pre><code>#include &lt;linux/uaccess.h&gt; \n</code></pre>\n\n<p>to the list of includes solved my problem on Ubuntu 18.04(Linux Kernel Version : 4.15.0).</p>\n\n<p><strong>NOTE</strong>: leave <code>#include &lt;asm/uaccess.h&gt;</code> as well</p>\n\n<p>There is a case where reordering of the include statements can help. See the answers in this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8440816/warning-implicit-declaration-of-function\">warning: implicit declaration of function</a></p>\n"}], "owner": {"reputation": 339, "user_id": 5539291, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3Q14f.jpg?s=128&g=1", "display_name": "kivi", "link": "https://stackoverflow.com/users/5539291/kivi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6650, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1616893260, "creation_date": 1492019755, "question_id": 43376468, "link": "https://stackoverflow.com/questions/43376468/linux-kernel-module-compile-error-implicit-declaration-of-function-open", "title": "Linux kernel module compile error: implicit declaration of function \u2018open\u2019", "body": "<p>I'm trying to write a simple sniffer-driver for linux, which will redirect all the requests to the real serial port (and also will print all the messages into system log). I found some examples on the Internet and implemented few functions. For example, function that invokes when ouw fake device is opened:</p>\n\n<pre><code>static int dev_open(struct inode *inodep, struct file *filep) {\n   numberOpens++;\n   printk(KERN_INFO \"sniffer: Device has been opened %d time(s)\\n\", numberOpens);\n\n   /// Connecting to real device   \n   fd = open (real_device, O_RDWR | O_NOCTTY | O_SYNC);\n   if (fd &lt; 0) {\n      printk(KERN_INFO \"sniffer: cannot open device %s\\n\", real_device);\n     return 1;\n   }\n\n   set_interface_attribs (fd, B115200, 0);  // set speed to 115,200 bps, 8n1 (no parity)\n   set_blocking (fd, 0);                     // set no blocking\n   return 0;\n}\n</code></pre>\n\n<p>As you can see, this function just opens the real device using standart linux <code>open</code> system call. Or function that sets real device settings (speed and parity):</p>\n\n<pre><code>int set_interface_attribs (int fd, int speed, int parity) {\n    struct termios tty;\n    memset (&amp;tty, 0, sizeof tty);\n    if (tcgetattr (fd, &amp;tty) != 0) {\n        // error_message (\"error %d from tcgetattr\", errno);\n        printk(KERN_INFO \"sniffer: cannot get device attributes\\n\");\n        return -1;\n    }\n\n    cfsetospeed (&amp;tty, speed);\n    cfsetispeed (&amp;tty, speed);\n\n    tty.c_cflag = (tty.c_cflag &amp; ~CSIZE) | CS8;     // 8-bit chars\n    // disable IGNBRK for mismatched speed tests; otherwise receive break\n    // as \\000 chars\n    tty.c_iflag &amp;= ~IGNBRK;         // disable break processing\n    tty.c_lflag = 0;                // no signaling chars, no echo,\n                                // no canonical processing\n    tty.c_oflag = 0;                // no remapping, no delays\n    tty.c_cc[VMIN]  = 0;            // read doesn't block\n    tty.c_cc[VTIME] = 5;            // 0.5 seconds read timeout\n\n    tty.c_iflag &amp;= ~(IXON | IXOFF | IXANY); // shut off xon/xoff ctrl\n\n    tty.c_cflag |= (CLOCAL | CREAD);// ignore modem controls,\n                                    // enable reading\n    tty.c_cflag &amp;= ~(PARENB | PARODD);      // shut off parity\n    tty.c_cflag |= parity;\n    tty.c_cflag &amp;= ~CSTOPB;\n    tty.c_cflag &amp;= ~CRTSCTS;\n\n    if (tcsetattr (fd, TCSANOW, &amp;tty) != 0) {\n        printk(KERN_INFO \"sniffer: cannot set device attributes\\n\");\n        return -1;\n    }\n    return -1;\n}\n</code></pre>\n\n<p>It uses <code>tcgetattr</code> and <code>tcsetattr</code> system calls. </p>\n\n<p>I included all required header files:</p>\n\n<pre><code>#include &lt;linux/init.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/device.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/fcntl.h&gt; \n#include &lt;linux/unistd.h&gt;\n#include &lt;linux/string.h&gt;\n#include &lt;linux/termios.h&gt;\n#include &lt;linux/fs.h&gt;\n#include &lt;asm/uaccess.h&gt;\n</code></pre>\n\n<p>But when I try to compile this module i get \"implicit declaration of function\" errors for this system calls.</p>\n\n<p>My Makefile:</p>\n\n<pre><code>obj-m += sniffer.o\n\nall:\n    $(MAKE) -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules\n\nclean:\n    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean\n</code></pre>\n\n<p>Compile errors:</p>\n\n<pre><code>sniffer.c: In function \u2018set_interface_attribs\u2019:\nsniffer.c:51:9: error: implicit declaration of function \u2018tcgetattr\u2019 [-Werror=implicit-function-declaration]\n     if (tcgetattr (fd, &amp;tty) != 0) {\n         ^\nsniffer.c:57:5: error: implicit declaration of function \u2018cfsetospeed\u2019 [-Werror=implicit-function-declaration]\n     cfsetospeed (&amp;tty, speed);\n     ^\nsniffer.c:58:5: error: implicit declaration of function \u2018cfsetispeed\u2019 [-Werror=implicit-function-declaration]\n     cfsetispeed (&amp;tty, speed);\n     ^\nsniffer.c:79:9: error: implicit declaration of function \u2018tcsetattr\u2019 [-Werror=implicit-function-declaration]\n     if (tcsetattr (fd, TCSANOW, &amp;tty) != 0) {\n         ^\nsniffer.c: In function \u2018dev_open\u2019:\nsniffer.c:151:9: error: implicit declaration of function \u2018open\u2019 [-Werror=implicit-function-declaration]\n    fd = open (real_device, O_RDWR | O_NOCTTY | O_SYNC);\n         ^\nsniffer.c: In function \u2018dev_read\u2019:\nsniffer.c:164:18: error: implicit declaration of function \u2018read\u2019 [-Werror=implicit-function-declaration]\n    error_count = read(fd, buffer, len);\n                  ^\nsniffer.c: In function \u2018dev_write\u2019:\nsniffer.c:177:4: error: implicit declaration of function \u2018write\u2019 [-Werror=implicit-function-declaration]\n    write (fd, buffer, len);\n    ^\nsniffer.c: In function \u2018dev_release\u2019:\nsniffer.c:184:4: error: implicit declaration of function \u2018close\u2019 [-Werror=implicit-function-declaration]\n    close(fd);\n    ^\n</code></pre>\n\n<p>What can it be? All the examples that i found just say that I should include <code>&lt;linux/unistd.h&gt;</code> and <code>&lt;linux/termios.h&gt;</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1492019817, "post_id": 43375754, "comment_id": 73815137, "body": "I&#39;m surprised this didn&#39;t give a bus error instead"}], "answers": [{"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 1, "last_activity_date": 1492017380, "creation_date": 1492017380, "answer_id": 43375803, "question_id": 43375754, "link": "https://stackoverflow.com/questions/43375754/segmentation-fault-in-check-sum-function-c/43375803#43375803", "title": "Segmentation Fault in Check Sum function C", "body": "<p><code>int cksum(int *buf, int count)</code> is taking a pointer to <code>int</code> as a parameter. The call </p>\n\n<pre><code>int my_check_value = cksum(poo, 6); \n</code></pre>\n\n<p>is passing the <code>char</code> array instead.</p>\n"}, {"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 1, "last_activity_date": 1492017432, "creation_date": 1492017432, "answer_id": 43375816, "question_id": 43375754, "link": "https://stackoverflow.com/questions/43375754/segmentation-fault-in-check-sum-function-c/43375816#43375816", "title": "Segmentation Fault in Check Sum function C", "body": "<p>You're passing <code>char poo[6]</code> as an <code>int *buf</code> this is screwing all of your pointer arithmetic.  Either change poo to an int, or specify buf as a char *</p>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 2, "last_activity_date": 1492017554, "creation_date": 1492017554, "answer_id": 43375849, "question_id": 43375754, "link": "https://stackoverflow.com/questions/43375754/segmentation-fault-in-check-sum-function-c/43375849#43375849", "title": "Segmentation Fault in Check Sum function C", "body": "<p>The problem is the difference in size between an <code>int</code> and a <code>char</code>.</p>\n\n<p>You're passing into the function a chunk of memory that is 6 bytes in size as each char is just 1 byte. But the function is expecting memory to be grouped into <code>int</code> which are 4 bytes and you're telling the function that there are 6 of them which means a total of 24 bytes.</p>\n\n<p>How you want to proceed is up to you, but it seems logical that your function in it's current usage should take a <code>char *</code> instead of an <code>int *</code>?</p>\n"}], "owner": {"reputation": 43, "user_id": 4970866, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6034c75527159d9ef5eb0220ce64cc70?s=128&d=identicon&r=PG&f=1", "display_name": "chrisyyy", "link": "https://stackoverflow.com/users/4970866/chrisyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 43375849, "answer_count": 3, "score": 0, "last_activity_date": 1492017554, "creation_date": 1492017207, "question_id": 43375754, "link": "https://stackoverflow.com/questions/43375754/segmentation-fault-in-check-sum-function-c", "title": "Segmentation Fault in Check Sum function C", "body": "<p>when I try to do a test of my checksum function, I keep getting a segmentation fault.</p>\n\n<pre><code>int cksum(int *buf, int count) {\n    long sum = 0;\n    //if(count%2 == 1) { //if we are passing an odd number of bytes\n    //  buf = strncat (*buf, '\\0', 1);\n    //} \n    while (count) {\n        sum += *buf++;\n        if (sum &amp; 0xFFFF0000) { /* carry occurred, so wrap around */\n            sum &amp;= 0xFFFF;\n            sum++;\n        }\n        count--;\n    }\n    return  ~(sum &amp; 0xFFFF);\n}\n</code></pre>\n\n<p>Testing the function:</p>\n\n<pre><code>char poo[6] = {'c', 'b', '1', '3' , '4', 'a'}; \nint my_check_value = cksum(poo, 6);\n</code></pre>\n\n<p>I get the error: Segmentation fault (core dumped)</p>\n\n<p>I really am not sure where in the function I'm going wrong as I implemented it very simply. Thanks!</p>\n"}, {"tags": ["c", "reflection", "macros", "preprocessor", "x-macros"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1492017117, "post_id": 43375421, "comment_id": 73813738, "body": "Well, &quot;recursively&quot; and &quot;macros&quot; are never working together."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1492017493, "post_id": 43375421, "comment_id": 73813935, "body": "@EugeneSh.: well, I know there are ways to get something like <a href=\"https://github.com/swansontec/map-macro\" rel=\"nofollow noreferrer\">list &quot;iteration&quot;</a>, so perhaps the title is misleading."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1492018002, "post_id": 43375421, "comment_id": 73814192, "body": "The parentheses are wrong. It should be &quot;<b>ab</b>use&quot;. That&#39;s an XY problem, use code-generation to accomplish this. Such code will eventually leave you in macro hell for debugging."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492024047, "post_id": 43375421, "comment_id": 73817447, "body": "@Olaf: do you know of a tool which can generate a set of structs with textual de/serializers for C? Most things I&#39;ve found are related to C++ templates."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492024141, "post_id": 43375421, "comment_id": 73817498, "body": "Yes I do. Tool recommendations are off-topic. Just that: you seem not have searched well. (and it is not that complicated to write a small Python program to generate such code)."}, {"owner": {"reputation": 6033, "user_id": 5128464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25BuB.png?s=128&g=1", "display_name": "vlp", "link": "https://stackoverflow.com/users/5128464/vlp"}, "edited": false, "score": 0, "creation_date": 1496602627, "post_id": 43375421, "comment_id": 75717438, "body": "Can&#39;t you just call the nested struct serializer from the parent struct serializer (note: I did not read the linked article)?"}, {"owner": {"reputation": 1235, "user_id": 1904755, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/68879b1c8cb87f19c86a3b48ad573d1c?s=128&d=identicon&r=PG", "display_name": "&#233;tale-cohomology", "link": "https://stackoverflow.com/users/1904755/%c3%a9tale-cohomology"}, "edited": false, "score": 0, "creation_date": 1527652710, "post_id": 43375421, "comment_id": 88201450, "body": "I don&#39;t understand the question but it sounds like something really cool. Did you manage to do it?"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 1235, "user_id": 1904755, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/68879b1c8cb87f19c86a3b48ad573d1c?s=128&d=identicon&r=PG", "display_name": "&#233;tale-cohomology", "link": "https://stackoverflow.com/users/1904755/%c3%a9tale-cohomology"}, "edited": false, "score": 1, "creation_date": 1529016270, "post_id": 43375421, "comment_id": 88736061, "body": "@&#233;tale-cohomology: we ended up using protocol buffers, their tool generates both structs and serialization code from .proto files. We also used some code generation for other things instead of xmacros, because it makes everyone&#39;s life much easier when there is an actual .c/.h file you can open, view, and step-through while debugging. Debugging through macros is a real pain in the ass, and code generation allows you to do much more than you would be able with macros only"}, {"owner": {"reputation": 1235, "user_id": 1904755, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/68879b1c8cb87f19c86a3b48ad573d1c?s=128&d=identicon&r=PG", "display_name": "&#233;tale-cohomology", "link": "https://stackoverflow.com/users/1904755/%c3%a9tale-cohomology"}, "edited": false, "score": 0, "creation_date": 1529037334, "post_id": 43375421, "comment_id": 88740013, "body": "Thanks a lot for sharing! I&#39;ve considered using protobufs before, but somehow I always decide to roll my own serialization..."}], "owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1492017565, "creation_date": 1492016002, "last_edit_date": 1492017565, "question_id": 43375421, "link": "https://stackoverflow.com/questions/43375421/is-it-possible-to-recursively-introspect-nested-c-structs-using-x-macros", "title": "Is it possible to (recursively) &quot;introspect&quot; nested C structs using x-macros?", "body": "<p>I was reading this article (<a href=\"https://natecraun.net/articles/struct-iteration-through-abuse-of-the-c-preprocessor.html\" rel=\"nofollow noreferrer\">Struct iteration through (ab)use of the preprocessor</a>), where the author uses x-macros and <code>offsetof</code> to add metadata to structs which would allow their members to be easily serialized, accessed by name, etc. But it's only implemented for primitive struct elements. </p>\n\n<p>Is it possible to expand this to structs containing nested struct, also? I.e. something which would allow simple de/serialialization of something like:</p>\n\n<pre><code>struct some_struct {\n   int x, y, z;\n}; \n\nstruct data {\n   int number;\n   struct some_struct something;\n}; \n</code></pre>\n\n<p>I've noticed the author states this at the beginning:</p>\n\n<blockquote>\n  <p>At this stage, the structs only consist of primitive elements (int, float, char, etc). <em>Handling nested structs, unions, bitfields and pointers would require additional work</em> (that may be the subject of a future post).</p>\n</blockquote>\n\n<p>Is something like this possible using the C preprocessor?</p>\n\n<p><strong>(Clarification)</strong></p>\n\n<p>To make it clearer, I'd like to see if there is a way which would allow me to:</p>\n\n<p>a) define the <code>struct</code>, and<br>\n  b) create meta data for textual serialization/deserialization</p>\n\n<p>if possible in one step.</p>\n"}, {"tags": ["c", "compiler-construction", "grammar", "abstract-syntax-tree", "interpreter"], "comments": [{"owner": {"reputation": 541, "user_id": 2163150, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nqiHS.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2163150/leo"}, "edited": false, "score": 0, "creation_date": 1492014609, "post_id": 43374737, "comment_id": 73812282, "body": "You should buy the Compilers &quot;dragon&quot;  book from Aho Seti and Ullman...and a tool called bison will help you to achieve what you intend in a fraction of the time you spend to do it &quot;by hand&quot;"}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "reply_to_user": {"reputation": 541, "user_id": 2163150, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nqiHS.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2163150/leo"}, "edited": false, "score": 0, "creation_date": 1492014726, "post_id": 43374737, "comment_id": 73812357, "body": "unfortunately I cannot use bison as the aim of this project is to do all of it &quot;by hand&quot;. thanks anyway"}], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 6, "creation_date": 1492014340, "post_id": 43374841, "comment_id": 73812106, "body": "This is not a way to store an AST, only a way to &quot;solve&quot; one"}], "tags": [], "owner": {"reputation": 8853, "user_id": 1022260, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/27a141cb4a1a2f49d43bc09a5fa742b2?s=128&d=identicon&r=PG&f=1", "display_name": "mikeb", "link": "https://stackoverflow.com/users/1022260/mikeb"}, "is_accepted": false, "score": 1, "last_activity_date": 1492022910, "last_edit_date": 1492022910, "creation_date": 1492014096, "answer_id": 43374841, "question_id": 43374737, "link": "https://stackoverflow.com/questions/43374737/building-an-interpreter-designing-an-ast/43374841#43374841", "title": "Building an interpreter: designing an AST", "body": "<p>I'd use the \"Shunting Yard\" algorithm -> <a href=\"https://en.wikipedia.org/wiki/Shunting-yard_algorithm\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Shunting-yard_algorithm</a></p>\n\n<p>There is psudocode there too.</p>\n\n<p>FTA:</p>\n\n<p>In computer science, the shunting-yard algorithm is a method for parsing mathematical expressions specified in infix notation. It can be used to produce either a postfix notation string, also known as Reverse Polish notation (RPN), or an abstract syntax tree (AST). The algorithm was invented by Edsger Dijkstra and named the \"shunting yard\" algorithm because its operation resembles that of a railroad shunting yard. Dijkstra first described the Shunting Yard Algorithm in the Mathematisch Centrum report MR 34/61.</p>\n\n<p>Like the evaluation of RPN, the shunting yard algorithm is stack-based. Infix expressions are the form of mathematical notation most people are used to, for instance \"3+4\" or \"3+4*(2\u22121)\". For the conversion there are two text variables (strings), the input and the output. There is also a stack that holds operators not yet added to the output queue. To convert, the program reads each symbol in order and does something based on that symbol. The result for the above examples would be \"3 4 +\" or \"3 4 2 1 - * +\".</p>\n\n<p>The shunting-yard algorithm has been later generalized into operator-precedence parsing.</p>\n\n<p>The code, since it was pointed out that this is not how to store it (and if you don't like C - take your pick from  <a href=\"http://rosettacode.org/wiki/Parsing/Shunting-yard_algorithm\" rel=\"nofollow noreferrer\">http://rosettacode.org/wiki/Parsing/Shunting-yard_algorithm</a>):</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;regex.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct {\n    const char *s;\n    int len, prec, assoc;\n} str_tok_t;\n\ntypedef struct {\n    const char * str;\n    int assoc, prec;\n    regex_t re;\n} pat_t;\n\nenum assoc { A_NONE, A_L, A_R };\npat_t pat_eos = {\"\", A_NONE, 0};\n\npat_t pat_ops[] = {\n    {\"^\\\\)\",    A_NONE, -1},\n    {\"^\\\\*\\\\*\", A_R, 3},\n    {\"^\\\\^\",    A_R, 3},\n    {\"^\\\\*\",    A_L, 2},\n    {\"^/\",      A_L, 2},\n    {\"^\\\\+\",    A_L, 1},\n    {\"^-\",      A_L, 1},\n    {0}\n};\n\npat_t pat_arg[] = {\n    {\"^[-+]?[0-9]*\\\\.?[0-9]+([eE][-+]?[0-9]+)?\"},\n    {\"^[a-zA-Z_][a-zA-Z_0-9]*\"},\n    {\"^\\\\(\", A_L, -1},\n    {0}\n};\n\nstr_tok_t stack[256]; /* assume these are big enough */\nstr_tok_t queue[256];\nint l_queue, l_stack;\n#define qpush(x) queue[l_queue++] = x\n#define spush(x) stack[l_stack++] = x\n#define spop()   stack[--l_stack]\n\nvoid display(const char *s)\n{\n    int i;\n    printf(\"\\033[1;1H\\033[JText | %s\", s);\n    printf(\"\\nStack| \");\n    for (i = 0; i &lt; l_stack; i++)\n        printf(\"%.*s \", stack[i].len, stack[i].s); // uses C99 format strings\n    printf(\"\\nQueue| \");\n    for (i = 0; i &lt; l_queue; i++)\n        printf(\"%.*s \", queue[i].len, queue[i].s);\n    puts(\"\\n\\n&lt;press enter&gt;\");\n    getchar();\n}\n\nint prec_booster;\n\n#define fail(s1, s2) {fprintf(stderr, \"[Error %s] %s\\n\", s1, s2); return 0;}\n\nint init(void)\n{\n    int i;\n    pat_t *p;\n\n    for (i = 0, p = pat_ops; p[i].str; i++)\n        if (regcomp(&amp;(p[i].re), p[i].str, REG_NEWLINE|REG_EXTENDED))\n            fail(\"comp\", p[i].str);\n\n    for (i = 0, p = pat_arg; p[i].str; i++)\n        if (regcomp(&amp;(p[i].re), p[i].str, REG_NEWLINE|REG_EXTENDED))\n            fail(\"comp\", p[i].str);\n\n    return 1;\n}\n\npat_t* match(const char *s, pat_t *p, str_tok_t * t, const char **e)\n{\n    int i;\n    regmatch_t m;\n\n    while (*s == ' ') s++;\n    *e = s;\n\n    if (!*s) return &amp;pat_eos;\n\n    for (i = 0; p[i].str; i++) {\n        if (regexec(&amp;(p[i].re), s, 1, &amp;m, REG_NOTEOL))\n            continue;\n        t-&gt;s = s;\n        *e = s + (t-&gt;len = m.rm_eo - m.rm_so);\n        return p + i;\n    }\n    return 0;\n}\n\nint parse(const char *s) {\n    pat_t *p;\n    str_tok_t *t, tok;\n\n    prec_booster = l_queue = 0;\n    display(s);\n    while (*s) {\n        p = match(s, pat_arg, &amp;tok, &amp;s);\n        if (!p || p == &amp;pat_eos) fail(\"parse arg\", s);\n\n        /* Odd logic here. Don't actually stack the parens: don't need to. */\n        if (p-&gt;prec == -1) {\n            prec_booster += 100;\n            continue;\n        }\n        qpush(tok);\n        display(s);\n\nre_op:      p = match(s, pat_ops, &amp;tok, &amp;s);\n        if (!p) fail(\"parse op\", s);\n\n        tok.assoc = p-&gt;assoc;\n        tok.prec = p-&gt;prec;\n\n        if (p-&gt;prec &gt; 0)\n            tok.prec = p-&gt;prec + prec_booster;\n        else if (p-&gt;prec == -1) {\n            if (prec_booster &lt; 100)\n                fail(\"unmatched )\", s);\n            tok.prec = prec_booster;\n        }\n\n        while (l_stack) {\n            t = stack + l_stack - 1;\n            if (!(t-&gt;prec == tok.prec &amp;&amp; t-&gt;assoc == A_L)\n                    &amp;&amp; t-&gt;prec &lt;= tok.prec)\n                break;\n            qpush(spop());\n            display(s);\n        }\n\n        if (p-&gt;prec == -1) {\n            prec_booster -= 100;\n            goto re_op;\n        }\n\n        if (!p-&gt;prec) {\n            display(s);\n            if (prec_booster)\n                fail(\"unmatched (\", s);\n            return 1;\n        }\n\n        spush(tok);\n        display(s);\n    }\n\n    return 1;\n}\n\nint main()\n{\n    int i;\n    const char *tests[] = { \n        \"3 + 4 * 2 / ( 1 - 5 ) ^ 2 ^ 3\",    /* RC mandated: OK */\n        \"123\",                  /* OK */\n        \"3+4 * 2 / ( 1 - 5 ) ^ 2 ^ 3.14\",   /* OK */\n        \"(((((((1+2+3**(4 + 5))))))\",       /* bad parens */\n        \"a^(b + c/d * .1e5)!\",          /* unknown op */\n        \"(1**2)**3\",                /* OK */\n        0\n    };\n\n    if (!init()) return 1;\n    for (i = 0; tests[i]; i++) {\n        printf(\"Testing string `%s'   &lt;enter&gt;\\n\", tests[i]);\n        getchar();\n\n        printf(\"string `%s': %s\\n\\n\", tests[i],\n            parse(tests[i]) ? \"Ok\" : \"Error\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6563, "user_id": 100214, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/db8155dcba940d81cd7a298b4ae99c7c?s=128&d=identicon&r=PG", "display_name": "Frank C.", "link": "https://stackoverflow.com/users/100214/frank-c"}, "is_accepted": true, "score": 4, "last_activity_date": 1492020426, "last_edit_date": 1492020426, "creation_date": 1492019471, "answer_id": 43376382, "question_id": 43374737, "link": "https://stackoverflow.com/questions/43374737/building-an-interpreter-designing-an-ast/43376382#43376382", "title": "Building an interpreter: designing an AST", "body": "<p>Disclaimer: This representation is subjective and just meant to illuminate.</p>\n\n<p>Fundamentally, your AST will be constructed like a binary tree where each AST node is a \"C\" structure that holds both a \"left\" and \"right\" pointer. The other elements of the AST are typically context sensitive. For example, a variable declaration versus a function definition or an expression in a function. For the example you cited, the rough tree would mirror this:</p>\n\n<pre><code>   +\n /   \\\n1     *\n      /\\\n     2  3 \n</code></pre>\n\n<p>So by substituting the above nodes 1 + (2 * 3) with your AST construct would be similar to:</p>\n\n<pre><code>                 -----------------\n                | type: ADDOP   |\n                | left: struct* |\n                | right: struct*|\n                -----------------\n              /                   \\\n             /                     \\\n (ADDOP left points to)         (ADDOP right points to)\n------------------------       --------------------------  \n| type: NUMLITERAL     |       | type: MULTOP           |\n| value: 1             |       | left: struct*          |\n| left: struct* (null) |       | right: struct*         |\n| right: struct*(null) |       --------------------------\n------------------------              /               \\\n                                     /                 \\\n\n                    (MULTOP left points to)         (MULTOP right points to)\n                    ------------------------       --------------------------  \n                    | type: NUMLITERAL     |       | type: NUMLITERAL       |\n                    | value: 2             |       | value: 3               |\n                    | left: struct* (null) |       | left: struct* (null)   |\n                    | right: struct*(null) |       | right: struct* (null)  |\n                    ------------------------       --------------------------\n</code></pre>\n\n<p>I assume that you know enough about \"C\" and how to <code>malloc</code> nodes and assign the left/right pointers. </p>\n\n<p>Now the remaining activity would be to do a post order traversal of the tree to either evaluate the expression and produce a result or to emit the appropriate intermediate code/machine code that aligns to a compiled result. Either choice bringing with it a massive amount of thinking and planning on your part.</p>\n\n<p>BTW: As noted, the AST nodes are going to typically have attributes based on the level of abstraction you want to represent. Also note that a typical compiler may leverage multiple AST for different reasons. Yep, more reading/studying on your part.</p>\n\n<p><strong>Note:</strong> This illustrates the data structure for an AST but @mikeb answer is rock solid for how to get the string \"1 + 2 * 3\" into the nodes of such a structure.</p>\n"}], "owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "accepted_answer_id": 43376382, "answer_count": 2, "score": 1, "last_activity_date": 1492022910, "creation_date": 1492013815, "question_id": 43374737, "link": "https://stackoverflow.com/questions/43374737/building-an-interpreter-designing-an-ast", "title": "Building an interpreter: designing an AST", "body": "<p>So I am making an interpreter for a language which I am making which is similar to Python. Now I understand that this is no small task and I don't expect it to work very well or do much but I would like it to have some basic functionality (variables, functions, loops, if statements, etc...).</p>\n\n<p>So currently I am at the stage where the interpreter takes a file, and splits it up into a list of tokens, and now I am ready to turn these tokens into an AST. I intend to do this with a recursive descent parser, which I believe I understand, but here is the problem. Let's say I have the following input</p>\n\n<pre><code>1 + 2 * 3\n</code></pre>\n\n<p>this would output 7, because using BIDMAS the multiplication is done first so</p>\n\n<pre><code>2 * 3 = 6\n</code></pre>\n\n<p>then the addition is done after</p>\n\n<pre><code>1 + 6 = 7\n</code></pre>\n\n<p>I know how to get this order as I have a simple grammar, but I do not know how to store this as an AST. To simplify things for the answers, lets assume this is the only input you will recieve and the grammar can be</p>\n\n<pre><code>program = add\nadd = mul {\"+\" mul}\nmul = NUM {\"*\" NUM}\n</code></pre>\n\n<p>So basically, how do you make a data structure(s) to store an AST?</p>\n\n<p>P.S. I am doing this in C.</p>\n"}, {"tags": ["c", "gcc", "c-standard-library"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 2, "creation_date": 1492012955, "post_id": 43374452, "comment_id": 73811245, "body": "Is the file <code>quit.h</code> located in the same directory as your C source file?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1492013208, "post_id": 43374452, "comment_id": 73811428, "body": "or to rephrase the question - where is the file quit.h"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1492013368, "post_id": 43374452, "comment_id": 73811522, "body": "Which text book?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1492013574, "post_id": 43374452, "comment_id": 73811634, "body": "&quot;This code is exactly copied from the textbook&quot; - was the content and relative location of <code>quit.h</code> given a similar affordance?"}, {"owner": {"reputation": 842, "user_id": 6572460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3c0888e8617ae4a4c18fc6b3cba6d517?s=128&d=identicon&r=PG&f=1", "display_name": "Nguai al", "link": "https://stackoverflow.com/users/6572460/nguai-al"}, "edited": false, "score": 0, "creation_date": 1492013577, "post_id": 43374452, "comment_id": 73811635, "body": "If quit.h file resides in different directory from your source directory, you can compile it using -I compile option."}], "answers": [{"tags": [], "owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1492014782, "last_edit_date": 1592644375, "creation_date": 1492014782, "answer_id": 43375053, "question_id": 43374452, "link": "https://stackoverflow.com/questions/43374452/gcc-fatal-error-quit-h-no-such-file-or-directory/43375053#43375053", "title": "GCC fatal error: quit.h no such file or directory", "body": "<blockquote>\n<h1>include &quot;quit.h&quot;</h1>\n</blockquote>\n<p>The word <code>#include</code> (with its hash <code>#</code> prefix) means that a file has to be read in; the content of that file (quit.h in this case) is processed exactly as if it was typed inside the program. Suppose you have a file name &quot;test.h&quot; which contains the single line</p>\n<pre><code>// this is a test\n</code></pre>\n<p>if you a have a program like this:</p>\n<pre><code>#include &quot;test.h&quot;\nint main(int argc, char **argv)\n...\n</code></pre>\n<p>the compiler processes (<em>sees</em>) exactly these lines:</p>\n<pre><code>// this is a test\nint main(int argc, char **argv)\n...\n</code></pre>\n<p>The file name specified after <code>#include</code> can be enclosed with angles or quotes. Conventionally, if angles are used, like</p>\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n<p>this means that the file (<em>stdio.h</em> in this case) is some <em>system</em> or <em>standard</em> file or so - in other simple words, someone else has written that file for you. If quotes are used, instead, the file specified is considered somehow part of the program you are compiling. <strong>Your quit.h</strong> seems like this. So you must have a file named <code>quit.h</code>. If you change that &quot;quit.h&quot; to &quot;quit&quot;, a file named <code>quit</code> must be present in the same directory of the file you are compiling. (<em>Actually things are more complicated, but don't mind it for now</em>). Read your book, somewhere it should explain what is that file &quot;quit.h&quot;.</p>\n"}], "owner": {"reputation": 1, "user_id": 7857625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39193b6df51af0619d97aabe1febe864?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Damasceno", "link": "https://stackoverflow.com/users/7857625/matthew-damasceno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492014782, "creation_date": 1492012899, "question_id": 43374452, "link": "https://stackoverflow.com/questions/43374452/gcc-fatal-error-quit-h-no-such-file-or-directory", "title": "GCC fatal error: quit.h no such file or directory", "body": "<p>I am learning C for an operating systems course and have just finished writing this program as per the textbook instructions:</p>\n\n<pre><code>#include &lt;dirent.h&gt;\n#include &lt;stdio.h&gt;\n#include \"quit.h\"\n\nint main(int argc, char **argv) {\n\n        DIR *dir;\n        struct dirent *direntry;\n\n        arg_check(2, argc, \"Specify a directory\\n\", 1);\n\n        if ( (dir = opendir(argv[1])) == NULL)\n                quit(\"opendir\", 1);\n\n        while ((direntry = readdir(dir)) != NULL)\n           printf(\"%10d %s\\n\", direntry-&gt;d_ino, direntry-&gt;d_name);\n\n        closedir(dir);\n        exit(0);\n}\n</code></pre>\n\n<p>This code is exactly copied from the textbook, but quit.h appears to be causing the compile to file. I have tried switching \"quit.h\" to ,  and \"quit\", but none of these have worked, and I cannot find other questions about this specific issue.</p>\n"}, {"tags": ["c", "linux", "directory", "size"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1492012360, "post_id": 43373724, "comment_id": 73810838, "body": "The runtime of your program is bound by the speed of the file system. There should be little to no difference between invoking <code>du</code> and implementing this functionality yourself."}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 2, "creation_date": 1492012744, "post_id": 43373724, "comment_id": 73811108, "body": "Almost exactly the same question here: <a href=\"http://stackoverflow.com/questions/472697/how-do-i-get-the-size-of-a-directory-in-c\" title=\"how do i get the size of a directory in c\">stackoverflow.com/questions/472697/&hellip;</a>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1492017552, "post_id": 43373724, "comment_id": 73813966, "body": "Please explain exactly what you mean by &quot;directory size&quot;.  Your mention of recursive <code>stat</code> and of <code>du</code> suggests one of the several possibilities, but it&#39;s not quite precise enough to give a clear answer."}], "owner": {"reputation": 286, "user_id": 2030732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a1b301053390effc50b24262e9f0b3?s=128&d=identicon&r=PG", "display_name": "trox", "link": "https://stackoverflow.com/users/2030732/trox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492011204, "creation_date": 1492010682, "last_edit_date": 1492011204, "question_id": 43373724, "link": "https://stackoverflow.com/questions/43373724/linux-c-programming-directory-size", "title": "Linux C programming directory size", "body": "<p>I'm looking for C good practice. I need to obtain a directory size in a C code on Linux. Please be aware that I'm really new to C.</p>\n\n<p>I guess there are several ways to do this. Simpler might be to use \"du\" with a system() function and get the output. Correct?</p>\n\n<p>More complicated would be to use stat() function recursively on all files and sub-directories, which is I guess what \"du\" already does.</p>\n\n<p>I'm asking because I like to have the best performances possible. The size will require to be recalculated several times in my program process and as quickly as possible.</p>\n\n<p>I also thought on \"importing\" the source code of \"du\" into my project if that is even an option.</p>\n\n<p>Any input on this matter please?</p>\n"}, {"tags": ["c", "macros", "initialization", "c-preprocessor"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 2, "creation_date": 1492010194, "post_id": 43373393, "comment_id": 73809203, "body": "You have <code>X(name)</code> defined to <code>-1,</code> around the <code>#define</code> for <code>foo_DEFAULT_VALUE</code>, but not where you actually <i>use</i> it.  You need the <code>X</code> macro defined where the substitution occurs, around the <code>static struct foo test = foo_DEFAULT_VALUE;</code> line."}], "answers": [{"comments": [{"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1492010522, "post_id": 43373572, "comment_id": 73809484, "body": "What could be a workaround? I have thought about the following, but I wonder if it is optimal: <code>#define X(name) -1, #define foo_DEFAULT_VALUE_GENERATOR  { LIST_OF_STRUCT_MEMBERS_foo } static const struct foo_DEFAULT_VALUE = foo_DEFAULT_VALUE_GENERATOR; #undef X</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1492010666, "post_id": 43373572, "comment_id": 73809591, "body": "Well, the straight forward way would be apparently that. Move the <code>#undef</code> after the line with the declaration. Otherwise a redesign would be needed."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "reply_to_user": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 1, "creation_date": 1492010884, "post_id": 43373572, "comment_id": 73809764, "body": "@Antonio <code>X</code> doesn&#39;t even need to be defined where <code>foo_DEFAULT_VALUE_GENERATOR</code> is defined, as long as it&#39;s defined where it&#39;s used."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1492010905, "post_id": 43373572, "comment_id": 73809785, "body": "Instead of defining <code>foo_DEFAULT_VALUE</code> as a macro expanding to an initializer, you could declare it as a <code>const struct foo</code> <i>with</i> initializer."}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1492011061, "post_id": 43373572, "comment_id": 73809908, "body": "@JohnBollinger Yep, does my edit match with what you said?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 1, "creation_date": 1492011264, "post_id": 43373572, "comment_id": 73810050, "body": "Yes, @Antonio, though personally, I wouldn&#39;t bother with the <code>foo_DEFAULT_VALUE_GENERATOR</code> macro, either, since you won&#39;t be able to use it later.  I&#39;d just put its replacement text directly into the declaration of <code>foo_DEFAULT_VALUE</code>."}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1492012677, "post_id": 43373572, "comment_id": 73811071, "body": "@EugeneSh. Excuse me, I have removed the code in the second part of the answer because it does not work for the same reason the code in the question doesn&#39;t work"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1492012711, "post_id": 43373572, "comment_id": 73811091, "body": "@Antonio Ow.. right. I&#39;ve confused myself, sorry :) Should always test it."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 10, "last_activity_date": 1492013041, "last_edit_date": 1492013041, "creation_date": 1492010268, "answer_id": 43373572, "question_id": 43373393, "link": "https://stackoverflow.com/questions/43373393/why-is-this-nested-macro-replacement-failing/43373572#43373572", "title": "Why is this nested macro replacement failing?", "body": "<p>Let's pretend that we are the preprocessor and encountering the line:</p>\n\n<pre><code>static struct foo test = foo_DEFAULT_VALUE;\n</code></pre>\n\n<p>Pass 1:</p>\n\n<pre><code>static struct foo test = { LIST_OF_STRUCT_MEMBERS_foo };\n</code></pre>\n\n<p>Pass 2:</p>\n\n<pre><code>static struct foo test = { X(a) X(b) X(c) };\n</code></pre>\n\n<p>Pass 3:  Nothing to expand as <code>X</code> is undefined on this line.</p>\n\n<hr/>\n\n<p>One workaround could be defining a const variable (possibly but not necessarily <code>static</code>) to be used as default value:</p>\n\n<pre><code>#define X(name) -1,\nstatic const struct foo foo_DEFAULT_VALUE = { LIST_OF_STRUCT_MEMBERS_foo };\n#undef X\n</code></pre>\n\n<p>Which generates:</p>\n\n<pre><code>static const struct foo foo_DEFAULT_VALUE = { -1, -1, -1, };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 1, "creation_date": 1492088334, "post_id": 43377322, "comment_id": 73846860, "body": "Would you believe me, if I say I invented it? I do not mean I invented it <i>first</i> (there could be others, earlier), but I did come up with it by myself."}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1492088498, "post_id": 43377322, "comment_id": 73846956, "body": "I do believe you, I searched the subject a lot yesterday, and never came across to such an implementation! I will award you a bounty as soon as it is possible!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1492632986, "post_id": 43377322, "comment_id": 74065182, "body": "Hello everybody, if you know other sources for this method, please let me know. If nobody finds anything I could claim to actually have invented it <b>first</b>. ;-)"}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 3, "last_activity_date": 1492022662, "creation_date": 1492022662, "answer_id": 43377322, "question_id": 43373393, "link": "https://stackoverflow.com/questions/43373393/why-is-this-nested-macro-replacement-failing/43377322#43377322", "title": "Why is this nested macro replacement failing?", "body": "<p>You might like the undef-free version of X_Macros,<br>\nit reduces the necessary care taken with defining and undefining around each use<br>\nand is better suited for definition in a header und useage in multiple code files:  </p>\n\n<pre><code>#define LIST_OF_STRUCT_MEMBERS_foo(mode) \\  \n    X_##mode(a) \\  \n    X_##mode(b) \\  \n    X_##mode(c)  \n\n#define X_struct(name) int name;  \n#define X_list(name) -1,  \n#define foo_DEFAULT_VALUE  { LIST_OF_STRUCT_MEMBERS_foo(list) }  \n\nstruct foo {  \n     LIST_OF_STRUCT_MEMBERS_foo(struct)  \n};  \n\nstatic inline void foo_invalidate(struct foo* in) {  \n     *in = (struct foo){  \n     LIST_OF_STRUCT_MEMBERS_foo(list)  \n     };  \n}  \n\nstatic struct foo test = foo_DEFAULT_VALUE;  \n</code></pre>\n\n<p>Output (gcc -E):  </p>\n\n<pre><code>struct foo {\n     int a; int b; int c;\n};\n\nstatic inline void foo_invalidate(struct foo* in) {\n     *in = (struct foo){\n     -1, -1, -1,\n     };\n}\n\nstatic struct foo test = { -1, -1, -1, };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1493032198, "post_id": 43585898, "comment_id": 74221833, "body": "That&#39;s exactly what I did to fill the <code>Preprocessor output:</code> section of my question"}], "tags": [], "owner": {"reputation": 35, "user_id": 5141643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef2ed63074f1fd1760e9d148824f6ab?s=128&d=identicon&r=PG&f=1", "display_name": "vivekn", "link": "https://stackoverflow.com/users/5141643/vivekn"}, "is_accepted": false, "score": -1, "last_activity_date": 1493030346, "last_edit_date": 1495542899, "creation_date": 1493030346, "answer_id": 43585898, "question_id": 43373393, "link": "https://stackoverflow.com/questions/43373393/why-is-this-nested-macro-replacement-failing/43585898#43585898", "title": "Why is this nested macro replacement failing?", "body": "<p>You might also try to check the output of expanded macros. If you are using gcc as a compiler, <code>gcc -E &lt;filename&gt; &gt;&gt; full_src.txt'</code> shall help. More details are here: <a href=\"https://stackoverflow.com/questions/985403/seeing-expanded-c-macros\">Seeing expanded C macros</a></p>\n"}], "owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 2, "accepted_answer_id": 43373572, "answer_count": 3, "score": 10, "last_activity_date": 1493030346, "creation_date": 1492009834, "last_edit_date": 1495539195, "question_id": 43373393, "link": "https://stackoverflow.com/questions/43373393/why-is-this-nested-macro-replacement-failing", "title": "Why is this nested macro replacement failing?", "body": "<p>I am trying to apply the <a href=\"https://stackoverflow.com/questions/6635851/real-world-use-of-x-macros\">X Macro</a> concept, in order to have the possibility to initialize all struct members to a custom default (invalid) value. I write the following code:</p>\n\n<pre><code>#define LIST_OF_STRUCT_MEMBERS_foo \\\n    X(a) \\\n    X(b) \\\n    X(c)\n\n#define X(name) int name;\nstruct foo {\n     LIST_OF_STRUCT_MEMBERS_foo\n};\n#undef X\n\n\n#define X(name) -1,\nstatic inline void foo_invalidate(struct foo* in) {\n     *in = (struct foo){\n     LIST_OF_STRUCT_MEMBERS_foo\n     };\n}\n#undef X\n\n#define X(name) -1,\n#define foo_DEFAULT_VALUE  { LIST_OF_STRUCT_MEMBERS_foo }\n#undef X\n\nstatic struct foo test = foo_DEFAULT_VALUE;\n</code></pre>\n\n<p>However, when I run the preprocessor, the definition of <code>foo_DEFAULT_VALUE</code> fails to substitute the <code>X(name)</code> calls with <code>-1,</code></p>\n\n<p>Preprocessor output:</p>\n\n<pre><code>struct foo {\n     int a; int b; int c;\n};\n\nstatic inline void foo_invalidate(struct foo* in) {\n     *in = (struct foo){\n     -1, -1, -1, /*Here the substitution worked nicely*/\n     };\n}\n\nstatic struct foo test = { X(a) X(b) X(c) }; /*Why this substitution failed?*/\n</code></pre>\n\n<p>I thought <a href=\"https://stackoverflow.com/questions/7972785/can-a-c-macro-definition-refer-to-other-macros\">C-macros could refer to other macros</a>. Do you know why that substitution fails? Is there any workaround?</p>\n\n<p>I could live with <code>foo_invalidate</code>, but I am reluctant to give up one step from having a value to be used directly at initialization.</p>\n"}, {"tags": ["c", "assembly", "x86", "sse", "simd"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1492008342, "post_id": 43372750, "comment_id": 73807631, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a <a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">debugger</a> to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1492008669, "post_id": 43372750, "comment_id": 73807922, "body": "Where does the crash occur ? I&#39;m guessing at <code>movaps (%eax), %xmm1</code> ? If so then it&#39;s probably an alignment problem."}, {"owner": {"reputation": 604, "user_id": 4911524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/604f28c275d13ec7fb763d6449a1f944?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele", "link": "https://stackoverflow.com/users/4911524/daniele"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1492009428, "post_id": 43372750, "comment_id": 73808564, "body": "yes, the problem is causeb by movaps (%eax), %xmm1, how can i solve it? @PaulR"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1492009768, "post_id": 43372750, "comment_id": 73808857, "body": "Can you show the <i>C</i> code you use to call this?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1492010400, "post_id": 43372750, "comment_id": 73809374, "body": "As I said above, it&#39;s probably an alignment problem - you can check the address in your debugger to see whether it&#39;s 16-byte aligned, or you can just change <code>movaps</code> to <code>movups</code> and see if that fixes the problem."}, {"owner": {"reputation": 604, "user_id": 4911524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/604f28c275d13ec7fb763d6449a1f944?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele", "link": "https://stackoverflow.com/users/4911524/daniele"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1492012853, "post_id": 43372750, "comment_id": 73811178, "body": "I add C code @MichaelPetch."}, {"owner": {"reputation": 604, "user_id": 4911524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/604f28c275d13ec7fb763d6449a1f944?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele", "link": "https://stackoverflow.com/users/4911524/daniele"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1492012913, "post_id": 43372750, "comment_id": 73811215, "body": "movups don&#39;t work, - nan error @PaulR"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1492012916, "post_id": 43372750, "comment_id": 73811217, "body": "You sure you assembled your code after making the change  for <code>movups</code>?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1492012977, "post_id": 43372750, "comment_id": 73811260, "body": "If it&#39;s not an alignment problem then it may just be an invalid address - you really are going to have to <a href=\"http://stackoverflow.com/q/43306288/253056\">learn how to use your debugger</a>... (and providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might be a good idea too)."}], "answers": [{"tags": [], "owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "is_accepted": true, "score": 7, "last_activity_date": 1492018843, "last_edit_date": 1492018843, "creation_date": 1492014051, "answer_id": 43374825, "question_id": 43372750, "link": "https://stackoverflow.com/questions/43372750/sum-array-of-float-in-assembly/43374825#43374825", "title": "Sum array of float in assembly", "body": "<p>As Paul mentioned this is likely an alignment issue. It is clear from your <em>C</em> code that your float array is not guaranteed to be aligned on a 16-byte boundary. The failure is this line:</p>\n\n<pre><code>movaps (%eax), %xmm1\n</code></pre>\n\n<p>The reason is that <a href=\"http://www.felixcloutier.com/x86/MOVAPS.html\" rel=\"noreferrer\"><em>MOVAPS</em></a> has this requirement:</p>\n\n<blockquote>\n  <p>When the source or destination operand is a memory operand, the operand must be aligned on a <strong>16-byte (128-bit version)</strong> or 32-byte (VEX.256 encoded version) boundary or a general-protection exception (#GP) will be generated.</p>\n</blockquote>\n\n<p>Since you are working with 128-bit vector registers you need 16-byte alignment. You have two choices:</p>\n\n<ul>\n<li>Change <em>MOVAPS</em> to <a href=\"http://www.felixcloutier.com/x86/MOVUPS.html\" rel=\"noreferrer\"><em>MOVUPS</em></a> so that unaligned memory access can be done</li>\n<li>Modify your <em>C</em> code to create an array of floats aligned on a 16-byte boundary</li>\n</ul>\n\n<hr>\n\n<p>First solution would require:</p>\n\n<pre><code>movaps (%eax), %xmm1\n</code></pre>\n\n<p>to be changed to;</p>\n\n<pre><code>movups (%eax), %xmm1\n</code></pre>\n\n<p>The second solution is to avoid using <a href=\"http://en.cppreference.com/w/c/memory/calloc\" rel=\"noreferrer\"><em>calloc</em></a> and utilize a function that allows you to create objects with 16-byte alignment. If using <em>C11</em> then you can use the function <a href=\"http://en.cppreference.com/w/c/memory/aligned_alloc\" rel=\"noreferrer\"><em>aligned_alloc</em></a> and <a href=\"http://en.cppreference.com/w/c/string/byte/memset\" rel=\"noreferrer\"><em>memset</em></a> to zero the array. Your <code>create_array</code> could look like:</p>\n\n<pre><code>float *\ncreate_array(size_t number_of_items)\n{\n    float *array = NULL;\n    size_t i;\n\n    array=(float *)aligned_alloc(16, number_of_items * sizeof(*array));\n    if(array){\n        memset (array, 0x00, number_of_items * sizeof(*array));\n        for(i=0; i&lt;number_of_items; i++){\n            array[i]=1.0+(float)i;\n        }\n    }\n    return array;\n}\n</code></pre>\n\n<p>If you are not using C11 you can utilize the POSIX function <a href=\"https://linux.die.net/man/3/posix_memalign\" rel=\"noreferrer\"><em>posix_memalign</em></a> and <em>memset</em> on Linux. The code could look something like:</p>\n\n<pre><code>float *\ncreate_array(size_t number_of_items)\n{\n    float *array = NULL;\n    size_t i;\n\n    if (!posix_memalign((void **)&amp;array, 16, number_of_items * sizeof(*array))){\n        memset (array, 0x00, number_of_items * sizeof(*array));\n        for(i=0; i&lt;number_of_items; i++){\n            array[i]=1.0+(float)i;\n        }\n    }\n    return array;\n}\n</code></pre>\n\n<p>You will have to uncomment these lines as well:</p>\n\n<pre><code>#movd %xmm0, %eax\n#pushl %eax\n</code></pre>\n\n<p>so that they appear this way:</p>\n\n<pre><code>movd %xmm0, %eax\npushl %eax\n</code></pre>\n\n<hr>\n\n<p><strong>Note</strong>: Although I use <em>memset</em> to zero out the float array like <em>calloc</em> would have, it isn't actually needed in your code since you initialize all the elements to specific values afterwards. In your case the call to <em>memset</em> can be removed.</p>\n"}], "owner": {"reputation": 604, "user_id": 4911524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/604f28c275d13ec7fb763d6449a1f944?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele", "link": "https://stackoverflow.com/users/4911524/daniele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1137, "favorite_count": 0, "accepted_answer_id": 43374825, "answer_count": 1, "score": 3, "last_activity_date": 1492379321, "creation_date": 1492008085, "last_edit_date": 1492379321, "question_id": 43372750, "link": "https://stackoverflow.com/questions/43372750/sum-array-of-float-in-assembly", "title": "Sum array of float in assembly", "body": "<p>I'm implementing a function in assembly x86, called from a C program, to add an array of float. The first argument of the function is the pointer to the array and the second is the number of elements. When I run the code in linux, I get a segmentation fault. What did I do wrong?</p>\n\n<pre><code>.text\n.globl floatsum\n\nfloatsum:\npush %ebp\nmovl %esp, %ebp\n\nmovl  8(%ebp), %eax\nmovl 12(%ebp), %edx\nshrl $2, %edx\n\nxorps %xmm0, %xmm0\nloop:\ntestl %edx, %edx\nje end  \nmovaps (%eax), %xmm1\naddps %xmm1, %xmm0\naddl $16, %eax\ndecl %edx\njmp loop \n\nend:\n                            #         3       2      1       0\nmovaps %xmm0, %xmm1         # xmm0:   w       z      y       x \n                            # xmm1:   z       w      x       y\nshufps $0xb1, %xmm1, %xmm1  #        10      11      00      01  = 0xb1\naddps  %xmm1, %xmm0         # xmm0:  w+z     z+w     y+x     x+y\nmovaps %xmm0, %xmm1         # xmm1:  w+z     z+w     y+x     x+y\n                            # xmm1:  x+y     y+x     z+w     w+z\nshufps $0x1b, %xmm1, %xmm1  #        00      01      10      11  = 0x1b\naddps  %xmm1, %xmm0         # xmm0:  w+z+x+y z+w+y+x y+x+z+w x+y+w+z\n                            #\n#movd %xmm0, %eax\n#pushl %eax\n\nfinst:\n\nflds (%esp)\npopl %eax\n\nmovl %ebp, %esp\npopl %ebp\nret\n</code></pre>\n\n<p>// C Code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nfloat\nfloatsum(float *array, size_t number_of_items);\n\nfloat\nfloatsum_c(float *array, size_t number_of_items){\nfloat sum;\nsize_t i;\n\nsum=0.0;\nfor(i=0; i&lt;number_of_items;i++){\n    sum+=array[i];\n}\nreturn sum;\n}\n\nfloat *\ncreate_array(size_t number_of_items){\nfloat *array;\nsize_t i;\n\narray=calloc(number_of_items, sizeof(float));\nif(array){\n    for(i=0; i&lt;number_of_items; i++){\n        array[i]=1.0+(float)i;\n    }\n   }\n   return array;\n }\n\nint\nmain(int argc, char **argv){\nfloat *a;\nfloat result;\nsize_t number_of_items, i;\n\nnumber_of_items=8;\na=create_array(number_of_items);\nif(a){\n    result=floatsum_c(a, number_of_items);\n    printf(\"Sum (c version): %f\\n\", result);    \n    result=floatsum(a, number_of_items);\n    printf(\"Sum (asm version): %f\\n\", result);  \n    free(a);\n}\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1492008058, "post_id": 43372515, "comment_id": 73807375, "body": "You can do something like, pushing the directories in a stack. If not found you can pop a directory, <code>cd</code> into it and so on, like implementing a BFS."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1492008072, "post_id": 43372515, "comment_id": 73807388, "body": "&quot;<i>How can I refactor this method in order to recursively search</i>&quot; When would you call an algorithm (or its implementation, perhaps as a function) being &quot;recursive&quot;?"}, {"owner": {"reputation": 1, "user_id": 7857001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80a2418991b1e2f4024f60a7425fd4e?s=128&d=identicon&r=PG&f=1", "display_name": "chx28464", "link": "https://stackoverflow.com/users/7857001/chx28464"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1492008185, "post_id": 43372515, "comment_id": 73807485, "body": "@alk Depends what you&#39;re trying to tell me? I also replaced method with function, my bad."}, {"owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "edited": false, "score": 0, "creation_date": 1492008378, "post_id": 43372515, "comment_id": 73807665, "body": "Can you tell us why you are returning <code>0</code> for your search which requires a pointer to integer <code>static int *search</code>?"}, {"owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "edited": false, "score": 0, "creation_date": 1492008484, "post_id": 43372515, "comment_id": 73807766, "body": "You have to also read the man page well because when <code>opendir</code> fails it set  <code>errno</code> and you have to check that."}, {"owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "edited": false, "score": 0, "creation_date": 1492008711, "post_id": 43372515, "comment_id": 73807958, "body": "You should be avoiding <code>..</code> and <code>.</code> which is the previous directory and current directory so that <code>opendir</code> doesn&#39;t break its neck looking up and down. <code>strcmp(ent-&gt;d_name, &quot;.&quot;) == 0 || strcmp(ent-&gt;d_name, &quot;..&quot;) ==0) continue;</code>"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1492009297, "post_id": 43372515, "comment_id": 73808433, "body": "Missing recursive call..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1492010214, "post_id": 43372515, "comment_id": 73809212, "body": "You&#39;re missing a <code>closedir()</code> so you can easily run out of resources."}], "answers": [{"tags": [], "owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "is_accepted": false, "score": 0, "last_activity_date": 1492180907, "last_edit_date": 1592644375, "creation_date": 1492012974, "answer_id": 43374483, "question_id": 43372515, "link": "https://stackoverflow.com/questions/43372515/recursively-searching-directories-for-a-file/43374483#43374483", "title": "Recursively searching directories for a file", "body": "<p>As already point out in the comments by many. Your code is not recursive with the missing recursive call (function calling itself). You have a lot of mistake. Not checking for errors with various system calls and forgetting to close the directory stream. I don't know what you want to achieve with your various parameters <code>int depth</code>, <code>bool verbose</code>. But this is another way of looking for a specific file and returning <code> 0 --&gt; EXIT_SUCCESS</code> on success and <code>1 --&gt;EXIT_FAILURE</code> on failure.</p>\n<p>The are various ways things can go wrong when using system calls and some them set errnos, which is important to look at them and print to STDERR</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\n\n#define DEBUG 1\n\nstatic int search(char *path,const char *file){\n    DIR *dir;\n    char *slash = &quot;/&quot;;\n\n    int ret = 1;\n\n    struct dirent *entry;\n//checking if it failed to open and report errors to STDERR\n    if((dir = opendir(path)) == NULL){\n        fprintf(stderr,&quot;opendir: %s\\n&quot;,strerror(errno));\n        return EXIT_FAILURE;\n    }\n\n    while ((entry = readdir(dir))){\n\n//if is . or .. we continue to prevent winging back and forth\n\n        if(strcmp(entry-&gt;d_name,&quot;.&quot;) == 0 || strcmp(entry-&gt;d_name,&quot;..&quot;) == 0)\n            continue;\n\n//we check if the path has already a / if not we add one\n\n        int length = strlen(path);\n\n        if(path[length-1] != '/'){\n            slash = &quot;/&quot;;\n        }\n\n        length += strlen(entry-&gt;d_name)+2;\n        char *newpath = malloc(length);\n        if (!newpath){\n            fprintf(stderr,&quot;malloc: %s\\n&quot;,strerror(errno));\n            break;\n        }\n\n        snprintf(newpath,length,&quot;%s%s%s&quot;,path,slash,entry-&gt;d_name);\n\n        if(strcmp(entry-&gt;d_name,file) ==0){\n#if DEBUG\n            printf(&quot;Was found here %s\\n&quot;,newpath);\n#endif\n            ret =  EXIT_SUCCESS;\n            break;\n        }\n        //checking if is a directory to do a recursive call\n        // using DT_DIR to avoid the use of lstat or stat\n        // if not directory we free the memory and move on\n        if(entry-&gt;d_type == DT_DIR)\n            search(newpath,file);\n        else{\n            free(newpath);\n            continue;\n        }\n\n        free(newpath);\n    }\n    if(closedir(dir) != 0){\n        fprintf(stderr,&quot;closedir: %s\\n&quot;,strerror(errno));\n        return EXIT_FAILURE;\n    }\n\n    return ret;\n\n}\n\n\nint main() {\n    \n\n    char *file = &quot;algo.c&quot;;\n\n    int ret = search(&quot;/&quot;,file);\n\n    printf(&quot;%d The file %s was %s\\n&quot;,ret,file,(ret == 0 ? &quot;found&quot;:&quot;not found&quot;));\n\n\n\n    return 0;\n}\n</code></pre>\n<p>With DEBUG set to 1</p>\n<blockquote>\n<p>Was found here /Users/addodennis/CLionProjects/BluePrint/algo.c</p>\n<p>The file algo.c was found</p>\n</blockquote>\n<p>With DEBUG set to 0</p>\n<blockquote>\n<p>file algo.c was found</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 7857001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d80a2418991b1e2f4024f60a7425fd4e?s=128&d=identicon&r=PG&f=1", "display_name": "chx28464", "link": "https://stackoverflow.com/users/7857001/chx28464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492180907, "creation_date": 1492007469, "last_edit_date": 1492008131, "question_id": 43372515, "link": "https://stackoverflow.com/questions/43372515/recursively-searching-directories-for-a-file", "title": "Recursively searching directories for a file", "body": "<p>I'm trying to recursively search a directory for a file and output the file if it matches the given:</p>\n\n<pre><code>static int *search(char *path, const char *request, int depth, bool verbose)\n{\n    DIR *dir;\n    struct dirent *ent;\n    char *start_dir = strcmp(path, \"/\") == 0 ? \"root\" : path;\n\n    printf(\"\\nStarting in '%s' directory..\\n\\n\", start_dir);\n\n    if ((dir = opendir(path)) != NULL)\n    {\n        while ((ent = readdir(dir)) != NULL)\n        {\n            if (verbose == true)\n            {\n                printf(\"Searching directory %s for file %s\\n\", ent-&gt;d_name, request);\n            }\n            if (ent-&gt;d_type == DT_DIR)\n            {\n                if ((strlen(path) + strlen(ent-&gt;d_name) + 1) &gt; PATH_MAX)\n                {\n                    puts(\"Path to long, cannot continue..\");\n                }\n                else\n                {\n                    if (ent-&gt;d_name == DT_DIR &amp;&amp; strcmp(ent-&gt;d_name, \".\") != 0 &amp;&amp;\n                            strcmp(ent-&gt;d_name, \"..\") != 0 )\n                    {\n                        printf(\"%s\\n\", ent-&gt;d_name);\n                    }\n                }\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This will work but it will not output the files or directories inside of the directory. Example:</p>\n\n<pre><code>@ubuntu:~/bin/c/find-files$ ./utilis test / -V\nInitialized to search for file: 'test'..\nStarting in 'root' directory..\n\nSearching directory vmlinuz.old for file test\nSearching directory boot for file test\nSearching directory home for file test\nSearching directory libx32 for file test\nSearching directory lib32 for file test\nSearching directory lib64 for file test\nSearching directory initrd.img for file test\nSearching directory srv for file test\nSearching directory usr for file test\nSearching directory . for file test\nSearching directory cdrom for file test\nSearching directory tmp for file test\nSearching directory initrd.img.old for file test\nSearching directory bin for file test\nSearching directory .. for file test\nSearching directory proc for file test\nSearching directory lib for file test\nSearching directory var for file test\nSearching directory dev for file test\nSearching directory sys for file test\nSearching directory media for file test\nSearching directory root for file test\nSearching directory snap for file test\nSearching directory run for file test\nSearching directory sbin for file test\nSearching directory opt for file test\nSearching directory lost+found for file test\nSearching directory mnt for file test\nSearching directory vmlinuz for file test\nSearching directory etc for file test\n</code></pre>\n\n<p>How can I refactor this function in order to recursively search for the given filename in all directories and sub directories?</p>\n"}, {"tags": ["c", "database", "bubble-sort"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1492007579, "post_id": 43372508, "comment_id": 73806966, "body": "<code>len</code> isn&#39;t number of records. and Need rewind each inner loop."}, {"owner": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "edited": false, "score": 0, "creation_date": 1492007826, "post_id": 43372508, "comment_id": 73807176, "body": "Why should the program display anything at all? I can not find any <code>printf</code> call."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1492007892, "post_id": 43372508, "comment_id": 73807235, "body": "<code>fseek(fd,-sizeof(Ficha_t),SEEK_SET);</code> has to be done always at end of loop"}, {"owner": {"reputation": 31, "user_id": 7312697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kS6KD.jpg?s=128&g=1", "display_name": "Albermonte", "link": "https://stackoverflow.com/users/7312697/albermonte"}, "reply_to_user": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "edited": false, "score": 0, "creation_date": 1492008509, "post_id": 43372508, "comment_id": 73807778, "body": "@ceving It&#39;s used later and if it&#39;s not correctly ordered will return an error"}, {"owner": {"reputation": 31, "user_id": 7312697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kS6KD.jpg?s=128&g=1", "display_name": "Albermonte", "link": "https://stackoverflow.com/users/7312697/albermonte"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1492008568, "post_id": 43372508, "comment_id": 73807829, "body": "@BLUEPIXY rewind to the beginning of file?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1492008672, "post_id": 43372508, "comment_id": 73807926, "body": "@Albermonte Yes, I think so."}, {"owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "edited": false, "score": 2, "creation_date": 1492008682, "post_id": 43372508, "comment_id": 73807937, "body": "SEEK_SET is the beginning of the file -- I don&#39;t think negative offsets make sense there.  SEEK_CUR is the current location"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1492011887, "post_id": 43372508, "comment_id": 73810524, "body": "No one would do it this way in real life. a) merge sort is already better with files, b) mmap is faster anyway..."}], "answers": [{"tags": [], "owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "is_accepted": false, "score": 0, "last_activity_date": 1492008982, "last_edit_date": 1492008982, "creation_date": 1492008575, "answer_id": 43372947, "question_id": 43372508, "link": "https://stackoverflow.com/questions/43372508/c-bubble-sort-program-binary-file/43372947#43372947", "title": "C - Bubble Sort Program binary file", "body": "<p>As mentioned in the comments, you want:</p>\n\n<pre><code>len=ftell(fd) / sizeof(Ficha_t);\n</code></pre>\n\n<p>to get the number of records in the file.</p>\n\n<p>If you are trying to seek with offsets to the current location, use <code>SEEK_CUR</code>, not <code>SEEK_SET</code>.</p>\n\n<p>I would add a bunch of printfs for <code>ftell(fd) / sizeof(Ficha_t)</code> so you can see that it's doing everything correctly. Also, you could be checking the return values of functions you are calling (they were probably returning errors as you tried to seek before the beginning and read/write there)</p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1492090470, "creation_date": 1492090470, "answer_id": 43393765, "question_id": 43372508, "link": "https://stackoverflow.com/questions/43372508/c-bubble-sort-program-binary-file/43393765#43393765", "title": "C - Bubble Sort Program binary file", "body": "<p>Specific code example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\nvoid fbubble_sort(const char *filename, size_t rec_size, bool (*needSwap)(const void *, const void *)){\n    FILE *fp = fopen(filename, \"r+b\");\n    if(!fp){\n        perror(\"fopen, r+\");\n        exit(EXIT_FAILURE);\n    }\n    void *first  = malloc(rec_size);\n    void *second = malloc(rec_size);\n    if(!first || !second){\n        perror(\"malloc\");\n        exit(EXIT_FAILURE);\n    }\n    enum { NO_SWAP = -1};\n\n    long last_swap_pos;\n    do {\n        rewind(fp);\n        long pos_1 = 0;//first record position\n        last_swap_pos = NO_SWAP;\n        if(0==fread(first, rec_size, 1, fp))\n            break;\n        while((pos_1 &lt;= last_swap_pos || last_swap_pos == NO_SWAP) &amp;&amp; 1==fread(second, rec_size, 1, fp) ){\n            if(needSwap(first, second)){\n                fseek(fp, pos_1, SEEK_SET);\n                fwrite(second, rec_size, 1, fp);\n                fwrite(first,  rec_size, 1, fp);\n                fflush(fp);\n                last_swap_pos = pos_1;\n            } else {\n                //exchange buffer\n                void *temp = first;\n                first = second;\n                second = temp;\n            }\n            pos_1 += rec_size;\n        }\n    }while(last_swap_pos != NO_SWAP);\n\n    free(first);free(second);\n    fclose(fp);\n}\n\n#define DATA_FILE \"test.dat\"\n#define GREATERi(type, member)\\\nbool greater_i(const void *first, const void *second){\\\n    return ((type*)first)-&gt;member &gt; ((type*)second)-&gt;member;\\\n}\\\n/**/\n#define GREATERs(type, member)\\\nbool greater_s(const void *first, const void *second){\\\n    return strcmp((type*)first)-&gt;member, ((type*)second)-&gt;member) &gt; 0;\\\n}\\\n/**/\n#define LESSi(type, member)\\\nbool less(const void *first, const void *second){\\\n    return ((type*)first)-&gt;member &lt; ((type*)second)-&gt;member;\\\n}\\\n/**/\n\ntypedef struct {\n    unsigned v;\n} Record;\n\nGREATERi(Record, v)\n\nint main(void){\n    void make_test_data(void);\n    void print_test_data(void);\n\n    make_test_data();\n    print_test_data();\n\n    fbubble_sort(DATA_FILE, sizeof(Record), greater_i);\n\n    print_test_data();\n}\n\nvoid make_test_data(void){\n    FILE *fp = fopen(DATA_FILE, \"wb\");\n    if(!fp){\n        perror(\"fopen, w\");\n        exit(EXIT_FAILURE);\n    }\n    Record rec;\n    for(int i = 0; i &lt; 100; ++i){\n        rec.v = rand() % 100;\n        fwrite(&amp;rec, sizeof(rec), 1, fp);\n    }\n    fclose(fp);\n}\nvoid print_test_data(void){\n    FILE *fp = fopen(DATA_FILE, \"rb\");\n    if(!fp){\n        perror(\"fopen, r\");\n        exit(EXIT_FAILURE);\n    }\n    Record rec;\n    int cnt = 0;\n    while(fread(&amp;rec, sizeof(rec), 1, fp)){\n        if(cnt)\n            putchar(' ');\n        printf(\"%2u\", rec.v);\n        if(++cnt == 10){\n            putchar('\\n');\n            cnt = 0;\n        }\n    }\n    putchar('\\n');\n    fclose(fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7312697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kS6KD.jpg?s=128&g=1", "display_name": "Albermonte", "link": "https://stackoverflow.com/users/7312697/albermonte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1492090470, "creation_date": 1492007440, "last_edit_date": 1492008946, "question_id": 43372508, "link": "https://stackoverflow.com/questions/43372508/c-bubble-sort-program-binary-file", "title": "C - Bubble Sort Program binary file", "body": "<p>I'm trying to make a Bubble Sort program in a binary file without using any arrays, instead of I will use fseek and fwrite functions.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>      typedef struct{  //Films\n         short int year;\n         char title[LEN_NAME];\n         Genero_t gendre;\n         float rateIMDB;\n      }Ficha_t;\n\n      FILE * fd;\n      fd = fopen(name,\"r+b\");    \n      Ficha_t aux1;\n      Ficha_t aux2;\n      int i,j,len;\n\n        if (fd != NULL)\n        {\n\n        rewind(fd);\n        fseek(fd, 0, SEEK_END);\n        len=ftell(fd);\n        rewind(fd);\n\n        for(i=0;i&lt;len;i++); \n        {\n        for(j=0;j&lt;len-1;j++)\n        {\n\n          fread(&amp;aux1,sizeof(Ficha_t),1,fd);\n          fread(&amp;aux2,sizeof(Ficha_t),1,fd);\n\n          if(strcmp(aux1.title,aux2.title)&lt;0)\n          {\n\n            fseek(fd,-sizeof(Ficha_t)*2,SEEK_SET); //returning 2 positions for overwriting\n            fwrite(&amp;aux2, sizeof(Ficha_t), 1, fd);\n            fwrite(&amp;aux1, sizeof(Ficha_t), 1, fd);  \n            fseek(fd,-sizeof(Ficha_t),SEEK_SET); //returning 1 position for checking again with the next film\n\n          }\n         }\n        }\n       }\n</code></pre>\n\n<p>It's not working since it's displaying the same 2 films, Where am I wrong? What could I do?</p>\n"}, {"tags": ["c", "haskell", "garbage-collection"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1492007527, "post_id": 43372363, "comment_id": 73806918, "body": "Which Haskell <code>free</code> are you referring to? Do you have a docs reference? Etit: NVM, it&#39;s <a href=\"http://downloads.haskell.org/~ghc/8.0.1-rc2/docs/html/libraries/base-4.9.0.0/Foreign-Marshal-Alloc.html#v:free\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/8.0.1-rc2/docs/html/libraries/&hellip;</a>"}, {"owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1492007657, "post_id": 43372363, "comment_id": 73807026, "body": "<a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Foreign-Marshal-Alloc.html#v:free\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1492007754, "post_id": 43372363, "comment_id": 73807116, "body": "I would guess that it won&#39;t be safe, as the allocation algorithm might be different for C and Haskell. But you can try, and if you are lucky you will get some segmentation fault to know you can&#39;t do this."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1492010634, "post_id": 43372363, "comment_id": 73809567, "body": "You should only ever use the free that matches the allocator user to allocate the memory.  This applies even without crossing language barriers.   Different libraries in C can use different allocators.  You need to use the correct free function for everything."}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1492010980, "post_id": 43372363, "comment_id": 73809844, "body": "To answer your last question (the one with <code>destroy_array</code>): That is one safe solution, yes. Another would be to do the allocation in Haskell using <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Foreign-Marshal-Array.html#v:allocaArray\" rel=\"nofollow noreferrer\"><code>alloca</code></a> (or <code>mallocArray</code> if you don&#39;t want the memory to be managed by GHC) and pass a pointer to the allocated memory to your C function (freeing it from Haskell afterwards in the <code>mallocArray</code> case; in the <code>allocaArray</code> case you won&#39;t need to do anything more). I often find this approach tidier than allocating/freeing on the C side."}, {"owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1492021999, "post_id": 43372363, "comment_id": 73816306, "body": "@gspr I see. So in a nutshell, I should manage both allocation and deallocation only on either Haskell&#39;s or C&#39;s side, right?"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1492030038, "post_id": 43372363, "comment_id": 73820856, "body": "@smilingbuddha: Yup. And at least in my experience, it tends to be a lot nicer and cleaner to do it on the Haskell side. <code>alloca</code> and friends + the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Foreign-C-Types.html#t:CInt\" rel=\"nofollow noreferrer\">C types</a> are nice. Once you get into having to generate a bunch of Haskell versions of more complicated C types (for allocation purposes), I find that the <a href=\"https://hackage.haskell.org/package/bindings-DSL\" rel=\"nofollow noreferrer\">bindings-DSL</a> package can help a lot (while being <i>very</i> simple and magic-free in its use)."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1492068405, "creation_date": 1492068405, "answer_id": 43386041, "question_id": 43372363, "link": "https://stackoverflow.com/questions/43372363/releasing-memory-allocated-by-c-runtime-from-haskell/43386041#43386041", "title": "Releasing memory allocated by C-runtime from Haskell", "body": "<p><strong>TL;DR:</strong> Deallocate memory with the correct corresponding function (e.g. C's <code>malloc</code> with C's <code>free</code>), and prefer <code>alloca</code>-style functions or <code>ForeignPtr</code> if that's not possible.</p>\n\n<hr>\n\n<p>A <code>Ptr</code> is just an address. An <a href=\"https://downloads.haskell.org/~ghc/8.0.1-rc2/docs/html/libraries/ghc-prim-0.5.0.0/GHC-Prim.html#t:Addr-35-\" rel=\"nofollow noreferrer\"><code>Addr#</code></a> usually points outside of the garbage collected machinery. With this knowledge, we can answer your first implicit question: no, the memory allocated by the C-runtime won't get garbage collected when the C function finishes.</p>\n\n<p>Next, it isn't safe <em>in general</em> to free the memory from Haskell itself. You've used C's <code>malloc</code>, so you should use C's <code>free</code>. While the current implementation of Haskell's <code>free</code> uses C's, you cannot count on that, as  <a href=\"https://downloads.haskell.org/~ghc/8.0.1-rc2/docs/html/libraries/base-4.9.0.0/Foreign-Marshal-Alloc.html#v:free\" rel=\"nofollow noreferrer\"><code>Foreign.Marshal.Alloc.free</code></a> is meant for the Haskell variants. </p>\n\n<p>Note that I said <em>in general</em>. The current implementation in GHC uses just the C counterparts, but one should not count on that and instead use the corresponding function. This corresponds to your <code>destroy_array</code> approach: Lucky for us, that's not hard:</p>\n\n<pre><code>foreign import ccall \"stdlib.h free\" c_free :: Ptr CInt -&gt; IO ()\n</code></pre>\n\n<p>Your C documentation should include a remark that <code>free</code> is the correct function though. Now, you <em>could</em> write your <code>main</code> like this:</p>\n\n<pre><code>main :: IO()\nmain = do\n  let numelements = 5\n  ptr &lt;-  c_get_non_freed_array  numelements\n  w0  &lt;-  peek $ advancePtr ptr 0 \n  w1  &lt;-  peek $ advancePtr ptr 1 \n  w2  &lt;-  peek $ advancePtr ptr 2 \n  w3  &lt;-  peek $ advancePtr ptr 3 \n  w4  &lt;-  peek $ advancePtr ptr 4 \n  print [w0, w1, w2, w3, w4]\n  c_free ptr\n  return ()\n</code></pre>\n\n<p>But that's just as error prone as in C. You've asked for garbage collection. That's what a <a href=\"https://downloads.haskell.org/~ghc/8.0.1-rc2/docs/html/libraries/base-4.9.0.0/Foreign-ForeignPtr.html#v:ForeignPtr\" rel=\"nofollow noreferrer\"><code>ForeignPtr</code></a> is for. We can create one from a normal <code>Ptr</code>  with <code>newForeignPtr</code>:</p>\n\n<pre><code>newForeignPtr :: FinalizerPtr a -&gt; Ptr a -&gt; IO (ForeignPtr a)\n</code></pre>\n\n<p>Source\nThe <code>FinalizerPtr</code> (<code>type FinalizerPtr a = FunPtr (Ptr a -&gt; IO ())</code> is a function pointer. So we need to adjust our previous import slightly:</p>\n\n<pre><code>--                                    v\nforeign import ccall unsafe \"stdlib.h &amp;free\" c_free_ptr :: FinalizerPtr CInt\n--                                    ^\n</code></pre>\n\n<p>Now we can create your array:</p>\n\n<pre><code>makeArray :: Int -&gt; ForeignPtr CInt\nmakeArray n = c_get_non_freed_array &gt;&gt;= newForeignPtr c_free_ptr\n</code></pre>\n\n<p>In order to actually work with the <code>ForeignPtr</code>, we need to use <code>withForeignPtr</code>:</p>\n\n<pre><code>main :: IO()\nmain = do\n  let numelements = 5\n  fptr &lt;-  makeArray  numelements\n  withForeignPtr fptr $ \\ptr -&gt; do\n      w0  &lt;-  peek $ advancePtr ptr 0 \n      w1  &lt;-  peek $ advancePtr ptr 1 \n      w2  &lt;-  peek $ advancePtr ptr 2 \n      w3  &lt;-  peek $ advancePtr ptr 3 \n      w4  &lt;-  peek $ advancePtr ptr 4 \n      print [w0, w1, w2, w3, w4]\n  return ()\n</code></pre>\n\n<p>The difference between <code>Ptr</code> and <code>ForeignPtr</code> is that the latter will call a finalizer. But this example is slightly contrived. The <code>alloca*</code> functions make your life a lot easier if you just want to allocate something, work with a function on it, and then return, e.g.</p>\n\n<pre><code>withArrayLen xs $ \\n ptr -&gt; do\n   c_fast_sort n ptr\n   peekArray n ptr\n</code></pre>\n\n<p>The <code>Foreign.Marshal.*</code> modules have many useful functions for that.</p>\n\n<p><strong>Final remark:</strong> working with raw memory can be a nuisance and an error source. Hide it if you make a library for public use.</p>\n"}], "owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1492068405, "creation_date": 1492007067, "last_edit_date": 1492008168, "question_id": 43372363, "link": "https://stackoverflow.com/questions/43372363/releasing-memory-allocated-by-c-runtime-from-haskell", "title": "Releasing memory allocated by C-runtime from Haskell", "body": "<p>I am learning how to use Haskell's C FFI. </p>\n\n<p>Suppose I am calling a C-function which creates an object and then returns a pointer to that object. Am I allowed to free this memory from the Haskell run-time using <code>free</code>? \n(I am referring to Haskell's<code>free</code> <strong>not</strong> C's <code>free</code>)</p>\n\n<p>Consider the following code: </p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\nmodule Main where\nimport Prelude hiding (exp)\nimport Foreign.Marshal.Alloc\nimport Foreign.Storable\nimport Foreign.C.Types\nimport Foreign.Ptr \nimport Foreign.Marshal.Array\n\nforeign import ccall \"get_non_freed_array\"  c_get_non_freed_array :: CInt -&gt; IO (Ptr CInt) -- An array initialized\n\nmain :: IO()\nmain = do\n  let numelements = 5\n  ptr &lt;-  c_get_non_freed_array  numelements\n  w0  &lt;-  peek $ advancePtr ptr 0 \n  w1  &lt;-  peek $ advancePtr ptr 1 \n  w2  &lt;-  peek $ advancePtr ptr 2 \n  w3  &lt;-  peek $ advancePtr ptr 3 \n  w4  &lt;-  peek $ advancePtr ptr 4 \n  print [w0, w1, w2, w3, w4]\n  return ()\n</code></pre>\n\n<p>The <code>get_non_freed_array</code> function I have written in C99 is as follows</p>\n\n<pre><code>#include \"test.h\"\n#include &lt;stdlib.h&gt;\n// return a memory block that is not freed.\nint* get_non_freed_array(int n)\n{\n  int* ptr = (int*) malloc(sizeof(int)*n);\n\n  for(int i=0 ; i&lt;n ; ++i){\n          ptr[i] = i*i;\n   }\n  return ptr;\n}\n</code></pre>\n\n<p>(<code>test.h</code> just contains a single line containing the function signature of <code>get_non_freed_array</code> for Haskell's FFI to access it.)</p>\n\n<p>I am confused because I don't know whether the memory allocated by the C-runtime is garbage collected when that C function \"finishes\" running after being called from Haskell's run-time. I mean, if it were another <em>C</em> function calling it, then I know the memory would be safe to use, but since a Haskell function is calling <code>get_non_freed_array</code>, I don't know if this is true anymore. </p>\n\n<p>Even though the above Haskell code prints correct results, I don't know if the memory returned by the C-function is safe to use via <code>ptr</code>. </p>\n\n<p>If it is safe, can we free this memory from Haskell itself? Or do I have to write another C-function, say, <code>destroy_array(int* ptr)</code> inside test.c and then call it from Haskell? </p>\n\n<hr>\n\n<p><strong>Edit:</strong> In short, I need more information on how to work with pointers to objects created inside C-functions when writing code in Haskell. </p>\n"}, {"tags": ["c", "arrays", "structure"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1492005119, "post_id": 43371480, "comment_id": 73804863, "body": "You copy strings using the <code>strcpy</code> family of functions."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1492005343, "post_id": 43371480, "comment_id": 73805041, "body": "Why swap structures around?  Simply find the five indices that correspond to the five elements of the array with the largest values.    Remember to allow for possibility of duplicate values."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1492005587, "post_id": 43371480, "comment_id": 73805252, "body": "<code>struct info temp = people[i]; people[i] = people[max]; people[max] = temp;</code>"}, {"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1492005806, "post_id": 43371480, "comment_id": 73805456, "body": "Sort using this example.. <a href=\"http://www.cplusplus.com/forum/general/97555/\" rel=\"nofollow noreferrer\">cplusplus.com/forum/general/97555</a>"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 1, "creation_date": 1492007969, "post_id": 43371480, "comment_id": 73807309, "body": "@4py - not very helpful to a <code>c</code> programmer :("}, {"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1492008146, "post_id": 43371480, "comment_id": 73807455, "body": "@KevinDTimm, Yea! I missed the tag."}], "answers": [{"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1492006559, "post_id": 43371789, "comment_id": 73806093, "body": "This is only the easiest way if you use existing functions for sorting... Otherwise, if programmed from scratch, scanning through the array and remembering the top-5-indices is easier to code."}, {"owner": {"reputation": 17700, "user_id": 50902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19d468858e7d32da4a5bb6e49394fd52?s=128&d=identicon&r=PG", "display_name": "kmkaplan", "link": "https://stackoverflow.com/users/50902/kmkaplan"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1492006865, "post_id": 43371789, "comment_id": 73806357, "body": "Shouldn&#39;t he use existing functions?"}], "tags": [], "owner": {"reputation": 17700, "user_id": 50902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19d468858e7d32da4a5bb6e49394fd52?s=128&d=identicon&r=PG", "display_name": "kmkaplan", "link": "https://stackoverflow.com/users/50902/kmkaplan"}, "is_accepted": false, "score": 0, "last_activity_date": 1492005737, "creation_date": 1492005737, "answer_id": 43371789, "question_id": 43371480, "link": "https://stackoverflow.com/questions/43371480/write-a-function-that-finds-the-top-5-max-values-in-array-of-structures/43371789#43371789", "title": "Write a function that finds the top 5 max values in array of structures?", "body": "<p>The easiest and most general way would probably be to first sort the <code>people</code> array. Once this is done just pick the first five elements.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2753592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2abdd5e126c40bc4944fbdc7537862?s=128&d=identicon&r=PG&f=1", "display_name": "aital", "link": "https://stackoverflow.com/users/2753592/aital"}, "is_accepted": false, "score": 0, "last_activity_date": 1492008092, "creation_date": 1492008092, "answer_id": 43372755, "question_id": 43371480, "link": "https://stackoverflow.com/questions/43371480/write-a-function-that-finds-the-top-5-max-values-in-array-of-structures/43372755#43372755", "title": "Write a function that finds the top 5 max values in array of structures?", "body": "<p>Best way is to sort the array people based on the number attribute iso individual swaps.</p>\n\n<p>If you want to go ahead with current approach use strcpy functions iso \"=\" operator for name</p>\n"}, {"tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": false, "score": 0, "last_activity_date": 1492072764, "last_edit_date": 1492072764, "creation_date": 1492008167, "answer_id": 43372782, "question_id": 43371480, "link": "https://stackoverflow.com/questions/43371480/write-a-function-that-finds-the-top-5-max-values-in-array-of-structures/43372782#43372782", "title": "Write a function that finds the top 5 max values in array of structures?", "body": "<p>Rather than keeping track of 5 out of total 10 indices, sorting seems better to me.\nYou can use qsort to sort the 10 elements and then pick the top 5.</p>\n\n<pre><code> int cmp(void *a,void *b)\n {\n   struct info as=*((struct info*)a);\n   struct info bs=*((struct info*)b)\n   return bs.number-as.number;  //sorting in descending order\n }\n</code></pre>\n\n<p>and then </p>\n\n<pre><code>    qsort(people,10,sizeof people[0],cmp);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17700, "user_id": 50902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19d468858e7d32da4a5bb6e49394fd52?s=128&d=identicon&r=PG", "display_name": "kmkaplan", "link": "https://stackoverflow.com/users/50902/kmkaplan"}, "edited": false, "score": 0, "creation_date": 1492026475, "post_id": 43373689, "comment_id": 73818799, "body": "That&#39;s what I meant. Plussed."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1492068746, "last_edit_date": 1492068746, "creation_date": 1492010570, "answer_id": 43373689, "question_id": 43371480, "link": "https://stackoverflow.com/questions/43371480/write-a-function-that-finds-the-top-5-max-values-in-array-of-structures/43373689#43373689", "title": "Write a function that finds the top 5 max values in array of structures?", "body": "<p>Just sort the array and then take the 5 first/last (depending on the sort order) entries of the sorted array.</p>\n\n<p>1st define a compare function:</p>\n\n<pre><code>#include &lt;stdlib.h&gt; /* for qsort() */\n#include &lt;stdio.h&gt; /* for printf() */\n\n\nstruct info\n{\n  char name[100];\n  int number;\n};\n\nint cmp_struct_info_desc(const void * pv1, const void * pv2)\n{\n  const struct info * pi1 = pv1;\n  const struct info * pi2 = pv2;\n\n  return pi2-&gt;number - pi1-&gt;number;\n}\n</code></pre>\n\n<p>2ndly use the <a href=\"http://www.iso-9899.info/n1570.html#7.22.5.2\" rel=\"nofollow noreferrer\">Standard C function <code>qsort()</code></a>.</p>\n\n<pre><code>struct info people[] =  {\n  ... /* initialise array people here ... */\n}\n\nint main(void)\n{\n  size_t number_of_array_elements = sizeof people/sizeof *people;\n\n  qsort(people, number_of_array_elements, sizeof *people, cmp_struct_info_desc);\n\n  for (size_t s = 0; s &lt; number_of_array_elements; ++s)\n  {\n    printf(\"%zu. = {%d, '%s'}\\n\", s, people[s].number, people[s].name);\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1492035749, "last_edit_date": 1495541850, "creation_date": 1492035407, "answer_id": 43380527, "question_id": 43371480, "link": "https://stackoverflow.com/questions/43371480/write-a-function-that-finds-the-top-5-max-values-in-array-of-structures/43380527#43380527", "title": "Write a function that finds the top 5 max values in array of structures?", "body": "<p>Starting from OP's code, just swap the structure.  <a href=\"https://stackoverflow.com/questions/43371480/write-a-function-that-finds-the-top-5-max-values-in-array-of-structures/43380527#comment73805252_43371480\">@BLUEPIXY</a>. Only a small changed needed for OP's code.</p>\n\n<p>Arrays can not be copied with assignments but <em>objects</em>, like <code>struct info</code> can be assigned.</p>\n\n<pre><code>int i, j, k=5;\n\n//move maximum `k` numbers to the front of the array\nfor (i=0; i&lt;k; i++) {\n  int max=i;\n  for (j=i+1; j&lt;10; j++) {\n    if (people[i].number &gt; people[max].number) {\n      max=j;\n    }\n  }\n  //swap info\n  struct info temp = people[i];\n  people[i] = people[max];\n  people[max] = temp;\n}\n\nfor (i=0; i&lt;k; i++) {\n  printf(\"%s  %d\\n\", people[i].name, people[i].number);\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7096357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2f5c5f59820a3f627254a980e8fa3071?s=128&d=identicon&r=PG&f=1", "display_name": "tmp657", "link": "https://stackoverflow.com/users/7096357/tmp657"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1248, "favorite_count": 0, "accepted_answer_id": 43380527, "answer_count": 5, "score": 1, "last_activity_date": 1492072764, "creation_date": 1492004998, "last_edit_date": 1492005158, "question_id": 43371480, "link": "https://stackoverflow.com/questions/43371480/write-a-function-that-finds-the-top-5-max-values-in-array-of-structures", "title": "Write a function that finds the top 5 max values in array of structures?", "body": "<p>Find the top 5 maximum values in array of structures (for C programming)?\nI have an array of structures as follows:</p>\n\n<pre><code>struct info {\nchar name[100];\nint number;\n}\nstruct info people[10]\n</code></pre>\n\n<p>In char name[100] are names of people (up to 10) and they have a corresponding value in int balance:</p>\n\n<pre><code>Jane 10\nJohn 40\nHarry 16\nEva -5\n...\n</code></pre>\n\n<p>until it gets to 10 people.\nHow do I find and print the 5 people who have the highest numbers?<br>\ni.e:</p>\n\n<pre><code>John 40\nHarry 16\nJane 10\n...\n</code></pre>\n\n<p>I have tried the following code:</p>\n\n<pre><code>int i,j, k=5, max, temp;\n//move maximum 5 numbers to the front of the array\nfor (i=0; i&lt;k; i++) {\n    max=i;\nfor (j=i+1; j&lt;10; j++) {\n    if (people[i].number&gt;people[max].number) {\n        max=j;\n    }\n}\n//swap numbers\ntemp=people[i].number;\npeople[i].number=people[max].number;\npeople[max].number=temp;\n\n//swap names to match swapped numbers so they correspond\ntemp=people[i].name;\npeople[i].name=people[max].name;\npeople[max]=temp;\n}\nfor (i=0; i&lt;k; i++) {\n    printf(\"%s  %d\\n\", people[i].name, people[i].number);\n}\n</code></pre>\n\n<p>However, I get an error message on the second swap since its char type. How should I fix this or what else would work for this objective?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 3, "creation_date": 1492003308, "post_id": 43370745, "comment_id": 73803326, "body": "Mark it volatile."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 0, "creation_date": 1492003523, "post_id": 43370745, "comment_id": 73803503, "body": "@Joe <code>volatile</code> doesn&#39;t guarantee that. Compiler may still remove it, if value isn&#39;t used."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1492003788, "post_id": 43370745, "comment_id": 73803728, "body": "Use inline assembly, but even then, it is not guaranteed that your data is written to memory instantly, because it might be buffered in a (write-back)-cache"}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1492004012, "post_id": 43370745, "comment_id": 73803946, "body": "Volatile alone doesn&#39;t prevent code from be optimized away, though it could work for a specific compiler. The simplest answer is probably to just use it in an innocuous way. Assign it to a global variable, write it to /dev/null, etc."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1492005851, "post_id": 43370745, "comment_id": 73805500, "body": "@user694733: That&#39;s not true unless it is an automatic variable without pointer taken (which we safely can exclude here). Please provide a reference to where the standard allows it. Don&#39;t forget to look at the corresponding defect report."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1492005964, "post_id": 43370745, "comment_id": 73805603, "body": "@Gene: see above ^"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492006021, "post_id": 43370745, "comment_id": 73805655, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and follow the advice."}, {"owner": {"reputation": 395, "user_id": 4391643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3d135c95c4c9a676c3149ebc800d908?s=128&d=identicon&r=PG&f=1", "display_name": "Stack Over", "link": "https://stackoverflow.com/users/4391643/stack-over"}, "edited": false, "score": 0, "creation_date": 1492016192, "post_id": 43370745, "comment_id": 73813200, "body": "I solved the problem by saving the content in a local variable, then set the memory to the content of the local variable. I don&#39;t want  that because this operation requires Read-Write access. Is that a good approach?"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 7547836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xk1Xm.jpg?s=128&g=1", "display_name": "Sandesh Nimhan", "link": "https://stackoverflow.com/users/7547836/sandesh-nimhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1492016605, "last_edit_date": 1492016605, "creation_date": 1492016241, "answer_id": 43375491, "question_id": 43370745, "link": "https://stackoverflow.com/questions/43370745/avoid-compiler-optimization-while-reading-memory/43375491#43375491", "title": "Avoid compiler optimization while reading memory", "body": "<p>Using volatile keyword might help.</p>\n\n<p><a href=\"http://www.keil.com/support/man/docs/armcc/armcc_chr1359124222941.htm\" rel=\"nofollow noreferrer\">http://www.keil.com/support/man/docs/armcc/armcc_chr1359124222941.htm</a></p>\n\n<p>Above article will help you understand use of volatile. </p>\n"}], "owner": {"reputation": 395, "user_id": 4391643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3d135c95c4c9a676c3149ebc800d908?s=128&d=identicon&r=PG&f=1", "display_name": "Stack Over", "link": "https://stackoverflow.com/users/4391643/stack-over"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492016605, "creation_date": 1492003226, "last_edit_date": 1492005994, "question_id": 43370745, "link": "https://stackoverflow.com/questions/43370745/avoid-compiler-optimization-while-reading-memory", "title": "Avoid compiler optimization while reading memory", "body": "<p>I want to check an ECC error in a cell of RAM memory.</p>\n\n<p>In order to check ECC errors, I must read or write this memory. So I have chosen to read the memory's value, but the compiler clean this line because I don't use it in rest of my code.</p>\n\n<p>Is there any way to avoid the optimization without modifying the compiler options.</p>\n\n<p>Find below the sequences:</p>\n\n<pre><code> 1. Clear flags\n 2. Read memory &lt;==&gt; Rt_value = (unsigned short *) Address\n 3. Check flags\n</code></pre>\n\n<p>Note: I use GHS compiler.</p>\n"}, {"tags": ["c", "graph"], "comments": [{"owner": {"reputation": 1015, "user_id": 7691497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-46wzsjmiSDg/AAAAAAAAAAI/AAAAAAAAAAk/qjgRQMlHINA/photo.jpg?sz=128", "display_name": "Ben Steffan", "link": "https://stackoverflow.com/users/7691497/ben-steffan"}, "edited": false, "score": 0, "creation_date": 1492004084, "post_id": 43370481, "comment_id": 73804002, "body": "Well, you have a return statement in your <code>for</code>-loop, so obviously there can only be a single iteration. Probably you want to have that return statement at the very end of your function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7827823"}, "reply_to_user": {"reputation": 1015, "user_id": 7691497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-46wzsjmiSDg/AAAAAAAAAAI/AAAAAAAAAAk/qjgRQMlHINA/photo.jpg?sz=128", "display_name": "Ben Steffan", "link": "https://stackoverflow.com/users/7691497/ben-steffan"}, "edited": false, "score": 0, "creation_date": 1492004535, "post_id": 43370481, "comment_id": 73804384, "body": "Thank you, Ben Steffan. I have just done what you said. However there is no output in this way now."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4092110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d03f078ef5db85089bc93b1dc005f1?s=128&d=identicon&r=PG&f=1", "display_name": "Pektraan", "link": "https://stackoverflow.com/users/4092110/pektraan"}, "is_accepted": true, "score": 0, "last_activity_date": 1492009460, "creation_date": 1492009460, "answer_id": 43373261, "question_id": 43370481, "link": "https://stackoverflow.com/questions/43370481/cerdos-renyi-graph-loop-will-run-at-most-once-error/43373261#43373261", "title": "[C]Erdos-Renyi graph: &quot;Loop will run at most once&quot; error", "body": "<p>As Ben Steffan said, the <code>return</code> statement should be outside of the for loop. The reason why there is not output is because you are not printing anything. I'm not sure how you want to display the data, but the two most common ways would be to print to console (<code>stdin</code>) or to a file.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7827823"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 43373261, "answer_count": 1, "score": 0, "last_activity_date": 1494949005, "creation_date": 1492002480, "last_edit_date": 1494949005, "question_id": 43370481, "link": "https://stackoverflow.com/questions/43370481/cerdos-renyi-graph-loop-will-run-at-most-once-error", "title": "[C]Erdos-Renyi graph: &quot;Loop will run at most once&quot; error", "body": "<p>I am writing the C code for an Erdos-Renyi graph. I hope that the 'if condition' for creating edges could be correct (I need to consider a uniform distribution, in order to satisfy the connectivity of the graph). However I have received this message \"Loop will run at most once (loop increment never executed\" (please have a look at (*) in my code): </p>\n"}, {"tags": ["c", "arrays", "unions"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1492002601, "post_id": 43370480, "comment_id": 73802749, "body": "<code>sizeof(trainer_pokemon)</code> will be increased by the biggest element in your union. If this is what you meant."}, {"owner": {"reputation": 131, "user_id": 7292394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-nGmm2Ddv8B8/AAAAAAAAAAI/AAAAAAAAABM/5Ar1t99PWOI/photo.jpg?sz=128", "display_name": "PfannkuchenXD", "link": "https://stackoverflow.com/users/7292394/pfannkuchenxd"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1492002779, "post_id": 43370480, "comment_id": 73802902, "body": "And thats what I want to prevent. I think i have to remodell my data structure but how to do so? Is there a better way?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1492002874, "post_id": 43370480, "comment_id": 73802969, "body": "What if you use pointers in side structure and then init your data outside this variable? So your structure just holds pointer to somewhere. If it is non-null, you know that it has valid value, otherwise you ignore it."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1492002942, "post_id": 43370480, "comment_id": 73803018, "body": "How is <code>build_field</code> defined?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1492003111, "post_id": 43370480, "comment_id": 73803157, "body": "&quot;The problem is that the game engine expects the structure to fit the minimum size&quot; How is this expectation expressed in engine&#39;s code? Maybe the engine is doing something crazy, but maybe you misunderstand something about the way the engine runs."}, {"owner": {"reputation": 131, "user_id": 7292394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-nGmm2Ddv8B8/AAAAAAAAAAI/AAAAAAAAABM/5Ar1t99PWOI/photo.jpg?sz=128", "display_name": "PfannkuchenXD", "link": "https://stackoverflow.com/users/7292394/pfannkuchenxd"}, "edited": false, "score": 0, "creation_date": 1492003155, "post_id": 43370480, "comment_id": 73803200, "body": "I can not change the data structure, that is the problem. The bytewise structure is already predefined by the game engine. That means i can not insert a random pointer somewhere. I need to model it properly into c code tho.  The definition of build_field is kind of irrelevant, it provides an 8-bit value but since all union types share it it is not what causes the problems.  Also the engine&#39;s code is assembly, since I am reverse engineering, I have no clue how the developers modelled this..."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 1, "creation_date": 1492005438, "post_id": 43370480, "comment_id": 73805107, "body": "A variable size struct is not possible. For the compiler sizeof(struct) is a constant. If there is a union inside, the largest size will be used."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1492005911, "post_id": 43370480, "comment_id": 73805554, "body": "Can&#39;t you just model it differently from how the original does it?"}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1492005608, "creation_date": 1492005608, "answer_id": 43371733, "question_id": 43370480, "link": "https://stackoverflow.com/questions/43370480/array-of-union-with-members-of-different-size/43371733#43371733", "title": "Array of union with members of different size", "body": "<p>It sounds like what you're after is some kind of polymorphism(sp?). Instead of using unions, you can define your structures something like this</p>\n\n<pre><code>struct base_type\n  {\n  int type;\n  };\n\nstruct type_a\n  {\n  struct base_type base;\n  long some_value;\n  };\n\nstruct type_b\n  {\n  struct base_type base;\n  char tiny_value;\n  };\n\nstruct base_type *my_type_a=malloc(sizeof(struct type_a));\nmy_type_a.type=1;\nstruct base_type *my_type_b=malloc(sizeof(struct type_b));\nmy_type_b.type=2;\nstruct type_a *a=(struct type_a *) my_type_a;\n</code></pre>\n\n<p>Both the \"type\" structs share the same common attributes as provided by the base_type struct, but they can be of different sizes as required. You just need to make sure that when allocating the memory you populate the right values to be able to correctly identify which actual struct it is.</p>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "is_accepted": false, "score": 0, "last_activity_date": 1492006162, "creation_date": 1492006162, "answer_id": 43371972, "question_id": 43370480, "link": "https://stackoverflow.com/questions/43370480/array-of-union-with-members-of-different-size/43371972#43371972", "title": "Array of union with members of different size", "body": "<p>You can use several structs and a base struct:</p>\n\n<pre><code>typedef struct {\n    build_field build;\n    u8 field_1;\n    u8 level;\n    u8 field_3;\n    u16 species;\n} trainer_pokemon_base;\n\ntypedef struct {\n    build_field build;\n    u8 field_1;\n    u8 level;\n    u8 field_3;\n    u16 species;\n\n    u16 field_6;\n} trainer_pokemon_did;\n\ntypedef struct {\n    build_field build;\n    u8 field_1;\n    u8 level;\n    u8 field_3;\n    u16 species;\n\n    u16 moves[4];\n    u16 field_E;\n} trainer_pokemon_dic;\n\ntypedef struct {\n    build_field build;\n    u8 field_1;\n    u8 level;\n    u8 field_3;\n    u16 species;\n\n    u16 item;\n} trainer_pokemon_cid;\n\ntypedef struct {\n    build_field build;\n    u8 field_1;\n    u8 level;\n    u8 field_3;\n    u16 species;\n\n    u16 item;\n    u16 moves[4];\n} trainer_pokemon_cic;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1492007090, "creation_date": 1492007090, "answer_id": 43372371, "question_id": 43370480, "link": "https://stackoverflow.com/questions/43370480/array-of-union-with-members-of-different-size/43372371#43372371", "title": "Array of union with members of different size", "body": "<p>I would use several different struct types:</p>\n\n<pre><code>typedef struct {\n    build_field build;\n    u8 field_1;\n    u8 level;\n    u8 field_3;\n    u16 species;\n} trainer_base;\n\ntypedef struct {\n    trainer_base b;\n    u16 field_6;\n} trainer_pokemon_default_item_default_attacks;\n\ntypedef struct {\n    trainer_base b;\n    u16 moves[4];\n    u16 field_E;\n} trainer_pokemon_default_item_custom_attacks;\n\ntypedef struct {\n    trainer_base b;\n    u16 item;\n} trainer_pokemon_custom_item_default_attacks;\n\ntypedef struct {\n    trainer_base b;\n    u16 item;\n    u16 moves[4];\n} trainer_pokemon_custom_item_custom_attacks;\n</code></pre>\n\n<p>You could also define a custom type that can \"be\" any type and where you can access the extra fields as <code>trainer-&gt;extra_field[i]</code>:</p>\n\n<pre><code>typedef struct {\n    trainer_base b;\n    u16 extra_field[0];\n} trainer_pokemon;\n</code></pre>\n\n<p>You would use the custom type like this: </p>\n\n<pre><code>trainer_pokemon *trainer = malloc(sizeof(trainer_pokemon_default_item_custom_attacks));\ntrainer-&gt;extra_field[2]; // This would access moves[2].\ntrainer-&gt;extra_field[4]; // This would access field_E.\n</code></pre>\n\n<p>Note: You need to take special care when using <code>sizeof</code> and array arithmetic. You always need to use the correct specific type.</p>\n\n<p>Note: <strong>Very important!</strong> If you use the custom type and the other types mixed, then you need to be very aware of the strict aliasing rule and its implications. If you don't know the strict aliasing rule well you should stick to using the specific types.</p>\n"}], "owner": {"reputation": 131, "user_id": 7292394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-nGmm2Ddv8B8/AAAAAAAAAAI/AAAAAAAAABM/5Ar1t99PWOI/photo.jpg?sz=128", "display_name": "PfannkuchenXD", "link": "https://stackoverflow.com/users/7292394/pfannkuchenxd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 875, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1492007090, "creation_date": 1492002478, "question_id": 43370480, "link": "https://stackoverflow.com/questions/43370480/array-of-union-with-members-of-different-size", "title": "Array of union with members of different size", "body": "<p>I have a somewhat unusual question. Since I am reverse engineering code the data structure I use (which is terrible by the way) can not be changed. First of all this is the struct which causes my trouble right now:</p>\n\n<pre><code>typedef struct {\n    build_field build;\n    u8 field_1;\n    u8 level;\n    u8 field_3;\n    u16 species;\n    union{\n        struct {\n            u16 field_6;\n        } default_item_default_attacks;\n        struct {\n            u16 moves[4];\n            u16 field_E;\n        } default_item_custom_attacks;\n        struct {\n            u16 item;\n        } custom_item_default_attacks;\n        struct {\n            u16 item;\n            u16 moves[4];\n        } custom_item_custom_attacks;\n    } item_and_moves;\n} trainer_pokemon;\n</code></pre>\n\n<p>As you can see the size of the struct <code>trainer_pokemon</code> varies depending on which uninion member I use to instanciate. The problem is that I need to instanciate several <code>trainer_pokemon[]</code>. As expected my C-Compiler just expands the size of each member of this array to the maximum (as if I always used the union member <code>custom_item_custom_attacks</code> for instanciating). However the game I am reverse engineering expects the array's members to match the size of the union used. That may sound somewhat confusing, so I will provide a more concrete example:</p>\n\n<pre><code>trainer_pokemon[] t = {\n                {\n                        0x0, //build\n                        0x0, //ability bit\n                        false, //hidden ability\n                        false, //shiny\n                },\n                0x0, //field_1\n                8, //Level\n                0, //field_3\n                POKEMON_LICHTEL, {\n                        .default_item_default_attacks = {\n                                0x0, //field_6,\n                        }\n                }\n        },\n        {\n                {\n                        0x0, //build\n                        0x0, //ability bit\n                        false, //hidden ability\n                        false, //shiny\n                },\n                0x0, //field_1\n                6, //Level\n                0, //field_3\n                POKEMON_TRAUMATO,\n                {\n                        .default_item_default_attacks = {\n                                0x0, //field_6,\n                        }\n                }\n        }\n};\n</code></pre>\n\n<p>As you can see 8 Bytes per element of this array would be sufficient to instanciate this array (total size 16 bytes). However each member is zero-filled up to the size of 16 bytes (total size of 32 bytes) since the compiler just assumes that i instanciated with <code>custom_item_custom_attacks</code> which would need an additional amount of 8 bytes. The problem is that the game engine expects the structure to fit the minimum size (in this case 8 bytes).\nHow do I best remodell or fix this issue? Please also note that inside one array all members are of the same size and must be instanciated with the same union member.</p>\n"}, {"tags": ["c", "header-files", "forward-declaration"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 7, "creation_date": 1492000063, "post_id": 43369505, "comment_id": 73800753, "body": "Simple, provide the forward declarations manually."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1492000065, "post_id": 43369505, "comment_id": 73800755, "body": "Why would you want to do this?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 4, "creation_date": 1492000574, "post_id": 43369505, "comment_id": 73801127, "body": "I think <code>main(){puts(&quot;Hello world&quot;);}</code> will compile successfully on most systems (albeit with a few warnings)."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1492001947, "post_id": 43369505, "comment_id": 73802226, "body": "<code>main</code> returns an <i>integer</i>, so the declaration must be <code>int main()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1492010657, "post_id": 43369505, "comment_id": 73809581, "body": "@ForceBru With <code>main()</code>, the C spec specially allows &quot; or in some other implementation-de\ufb01ned manner&quot; 5.1.2.2.1 1 which could include <code>void main()</code> on OP&#39;s platform.  Yet returning <code>int</code> is best."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1492004041, "post_id": 43370390, "comment_id": 73803968, "body": "Writing your own forward declarations of standard C functions is a bad idea. Some functions are implemented as macros, and some library functions might have extra pragmas (For example <code>printf</code> functions might have special pragma to enable type checking for format string arguments)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 4, "creation_date": 1492004147, "post_id": 43370390, "comment_id": 73804065, "body": "@user694733 it still works, though. The standard requires that a non-macro version be available for all standard functions"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 4, "creation_date": 1492004541, "post_id": 43370390, "comment_id": 73804388, "body": "@user694733 and that&#39;s why the headers are there, to save from all the trouble. Please note, I wrote <i>&quot;just fine&quot;</i>, not <i>&quot;the same&quot;</i> :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 7, "last_activity_date": 1492002248, "creation_date": 1492002248, "answer_id": 43370390, "question_id": 43369505, "link": "https://stackoverflow.com/questions/43369505/how-to-write-hello-world-without-using-header-file-in-c/43370390#43370390", "title": "How to write hello world without using header file in c", "body": "<p>You need header files primarily because of the prototype declaration of library functions plus any necessary types and additional macros\nneeded to facilitate their use. They are provided in form of header files for ease of re-use.</p>\n\n<p>In your case, you can write the prototypes on your own and you should be okay Something like</p>\n\n<pre><code>/*  Prototypes on your own */\nint getchar(void);\nint printf(const char *format, ...);\nint puts(const char *s);\n\nint main(void) {  //this is the prescribed signature for hosted environment\n    //printf(\"Hello World\\n\");    //not good to use printf if don;t need conversion\n    puts(\"Hello World\");\n    //getchar();\n    return 0;\n}\n</code></pre>\n\n<p>should do just fine.</p>\n"}], "owner": {"reputation": 327, "user_id": 5203392, "user_type": "registered", "profile_image": "https://graph.facebook.com/726850087443676/picture?type=large", "display_name": "kundan bora", "link": "https://stackoverflow.com/users/5203392/kundan-bora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 0, "accepted_answer_id": 43370390, "answer_count": 1, "score": 1, "last_activity_date": 1492003725, "creation_date": 1492000003, "last_edit_date": 1492003725, "question_id": 43369505, "link": "https://stackoverflow.com/questions/43369505/how-to-write-hello-world-without-using-header-file-in-c", "title": "How to write hello world without using header file in c", "body": "<p>How to write hello world without using header files in C?</p>\n\n<pre><code>#include&lt;conio.h&gt;\n#include&lt;stdio.h&gt;\n\nvoid main(){\n\nprintf(\"Hello World\");\ngetch();\n\n}\n</code></pre>\n\n<p>This is simple C program with header file...</p>\n\n<ul>\n<li><code>conio.h</code> - for console</li>\n<li><code>stdio.h</code> - is used for <code>printf</code> and <code>scanf</code></li>\n</ul>\n"}, {"tags": ["c", "data-structures", "interrupt", "stm32", "dma"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492000203, "post_id": 43369421, "comment_id": 73800865, "body": "If you have DMA, then the only reason why you would ever use interrupts is when you have hard real-time requirements. Otherwise, avoid them. A circular DMA buffer probably makes most sense for received serial data. You just have to ensure that you read it often enough so that it can never overflow."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1492000287, "post_id": 43369421, "comment_id": 73800924, "body": "&quot;what is the best way to interact with sensors?&quot; is a very broad question that probably can&#39;t be answered. &quot;Best&quot; leads to opinion-based answers."}, {"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 0, "creation_date": 1492000305, "post_id": 43369421, "comment_id": 73800933, "body": "UARTs don&#39;t work in &quot;frames.&quot; They only send characters of some number of data bits, surrounded by a start bit and stop bit. It sounds like you have some higher-level protocol that you&#39;d like to use over the UART link, which is just fine. You just break your frames down into the individual characters that constitute them and send them one by one. On the other end, receive them one by one and decode the packet. Your UART driver can be interrupt-driven, pollling, and/or DMA-driven, depending on your application&#39;s needs."}, {"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492000384, "post_id": 43369421, "comment_id": 73800996, "body": "@Lundin: It&#39;s pretty common to still use interrupts in concert with DMA, for instance so you know when a DMA finishes so you can reload its source/destination address registers as needed."}, {"owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492000440, "post_id": 43369421, "comment_id": 73801035, "body": "This is a massive question; I don&#39;t know where to start.  Mostly it depends completely on your protocol.  Is it a standard, like Modbus, or one you&#39;ve designed yourself?  Are the frames fixed length (it appears not)?  Is it peer-to-peer, or master and slave or ACK/NAK?  Whatever the protocol, don&#39;t implement it in the UART driver: that&#39;s for controlling the hardware (except that some old protocols, like Modbus, need layer 2 &amp; layer 3 all muddled up)."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 0, "creation_date": 1492001103, "post_id": 43369421, "comment_id": 73801512, "body": "@JasonR Yes.   The interrupt-handler can just set a semaphore and request a scheduler run, so setting a thread ready to process the received DMA buffer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 0, "creation_date": 1492001317, "post_id": 43369421, "comment_id": 73801669, "body": "@JasonR That would reduce the interrupt frequency compared to plain UART rx interrupts, but it is still an interrupt, which should be avoided if possible - particularly asynchronous interrupts. If you can set aside enough RAM for the DMA buffer, interrupts shouldn&#39;t be necessary. Based on UART baudrate, it is easy to calculate how often the buffer needs to be read to handle the worst case - continuous reception. It&#39;s just a matter of allocating enough RAM."}, {"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1492001387, "post_id": 43369421, "comment_id": 73801736, "body": "@Lundin: I just wouldn&#39;t agree with a blanket statement to &quot;avoid interrupts.&quot; They&#39;re used all the time, for good reasons, even in non-hard-real-time systems."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492001730, "post_id": 43369421, "comment_id": 73802051, "body": "Avoiding interrupts means no preemptive multitasker.  That pretty much is the end of good I/O performance overall.  Still, I suppose, in a uController, it may not matter much...."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 0, "creation_date": 1492001760, "post_id": 43369421, "comment_id": 73802076, "body": "@JasonR They are also implemented incorrectly in, I would guess, 80% of the cases. Programmers screw up flag clearing, or they screw up semaphores, they get tricked by compiler optimizations (no volatile on shared variables), they don&#39;t consider max stack usage, they don&#39;t consider worst-case interrupt latency and overall real-time performance. Etc etc."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 0, "creation_date": 1492001793, "post_id": 43369421, "comment_id": 73802104, "body": "@ThingyWotsit If you have a RTOS, then you have hard real-time requirements, and you&#39;ll obviously have to (let the RTOS) use interrupts."}, {"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492001915, "post_id": 43369421, "comment_id": 73802196, "body": "@Lundin: We&#39;ll have to agree to disagree on this one. Yes, there are some subtleties to using interrupts correctly, but you can say that about almost any tool to do a job. Also, usage of an RTOS does not imply hard-real-time requirements. RTOSes are commonly used when the services that they provide (e.g. multitasking, synchronization, possibly things like file/network I/O) are useful for the application writer, but not necessarily in service of hard real-time requirements."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492002131, "post_id": 43369421, "comment_id": 73802361, "body": "Just FYI, I can&#39;t remember the last time when I wrote a program without interrupts in it. It is often a necessary evil that should be used with caution and as a last-time resort."}], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492001870, "post_id": 43369651, "comment_id": 73802164, "body": "This doesn&#39;t look like a robust serial protocol. 1) <code>START</code> &amp; <code>STOP</code> are going to be a pain unless DATA is restricted so that it <i>cannot ever</i> contain either, as interrupted frames will cause erroneous resynchronisation mid-data. 2) <code>CMD</code> is application-specific and should be in a higher layer, not the frame. 3) You&#39;re going to need a bit more than just <code>ADDRESS</code> in a multi-drop bus implementation, but these will usually have some hardware impact, such as time slots or handshaking (like RTS/CTS on RS232). 4) Even <code>CRC</code> may be a bit too much, unless you have a noisy, error-prone connection."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492002109, "post_id": 43369651, "comment_id": 73802342, "body": "Thanks for your comment. I&#39;m happy to give you answers. 1) With START I know when protocol starts, so that I know when to start my state machine. For <code>CMD</code>part I use is it read/write/broadcast 2) With STOP I just check if STOP is there. Even if STOP is inside data, you still have data length info. I use this in single master mode, in multi master address is splitted in <code>sender</code> and <code>receiver</code>. CRC is used to check everything between START and STOP. For parsing packet, there is state machine and this concept is so far very robust, even in very noisy (EMC) environment as well as in program flow."}, {"owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492003154, "post_id": 43369651, "comment_id": 73803198, "body": "It works for your system so it can&#39;t be all bad.  :-)  The explanation of each component will be useful to the OP.  Plus, the difference in our opinions highlights that the choice of protocol is strongly dependent on the system requirements and operating environment."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492003274, "post_id": 43369651, "comment_id": 73803307, "body": "I totally agree with you about protocol choice. If you want to make ti for everyone, then as you mentioned, add CMD part inside DATA and parse it by APP yourself."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492004081, "post_id": 43369651, "comment_id": 73803999, "body": "@MikeofSST CRC is absolutely necessary when using UART or RS-232. Though of course there&#39;s not many reasons to use RS-232 nowadays - PC:s don&#39;t have it any longer. So if stuck with UART-based interfaces, you&#39;d use RS-422/485."}, {"owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492005496, "post_id": 43369651, "comment_id": 73805169, "body": "@Lundin Some kind of checksum, or error detection, sure, but not necessarily CRC.  If you do go for a CRC, which polynomial do you use?  Getting the right one is tricky unless you do a rigorous data and fault analysis.  Then, if you find that you do need a CRC over a checksum, you&#39;d probably consider using something more robust at the hardware layer, or extending your protocol to use error correction instead of just detection.  CRC always strikes me as being not quite right for most jobs, but pretty easy to find example code to make it work."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1492005622, "post_id": 43369651, "comment_id": 73805284, "body": "In most cases, it is enough to detect &quot;packet&quot; error and then request retransmit by yourself, just like done in ethernet or somewhere else. If you don&#39;t want CRC; you can just XOR your data bytes or something. Just to know if valid or not. I use CRC16 or when I work with STM32 MCU, CRC32 is best fit (the same as in ethernet)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492007131, "post_id": 43369651, "comment_id": 73806560, "body": "@MikeofSST CRC-16-CCITT 0x1021 should be perfectly fine in the general case and there are MCUs with on-chip hardware support for it. Of course it all depends on the amount of data getting moved. It is rather that <i>UART</i> (and friends) is the wrong tool for most tasks... for high data integrity you&#39;d use CAN and for high speed you&#39;d use ethernet."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492007532, "post_id": 43369651, "comment_id": 73806924, "body": "The reason why you shouldn&#39;t use &quot;byte sum&quot;, &quot;xor&quot;, &quot;parity&quot; or some other home-brewn amateur solution, is because they have a very poor probability of catching single bit and double bit errors, whereas any CRC catches all/most of those."}, {"owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1492008620, "post_id": 43369651, "comment_id": 73807877, "body": "@Ludin XOR has probability 1 of catching single bit errors!  LRC8 (byte sum) has similar performance.  If neither of these is sufficient, you need to understand the source of the errors and then, either pick an appropriate CRC, or change the layer 1 (as you say, CAN and other physical layers have better error correction &amp; detection built in.  <a href=\"https://users.ece.cmu.edu/~koopman/pubs/KoopmanCRCWebinar9May2012.pdf\" rel=\"nofollow noreferrer\">This</a> has a good analysis of some simple error detection mechanisms."}, {"owner": {"reputation": 11, "user_id": 4779708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b22d0ffb9a13929f012f1872cf055056?s=128&d=identicon&r=PG&f=1", "display_name": "guillaume", "link": "https://stackoverflow.com/users/4779708/guillaume"}, "edited": false, "score": 0, "creation_date": 1492156791, "post_id": 43369651, "comment_id": 73874479, "body": "@tilz0R Thank you for your answer. What I finally did is :  USART DMA on Rx with a fix length and I added padding. So, when my buffer is full, I have an interrupt and I &quot;set&quot; the boolean new_frame = TRUE.  And in my state_machine (inside my while(1) I always &quot;get&quot; the value of new_frame, and if it&#39;s TRUE, I check the SOF, the CRC etc to give it to my state machine. Is it a good way?"}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1492000383, "creation_date": 1492000383, "answer_id": 43369651, "question_id": 43369421, "link": "https://stackoverflow.com/questions/43369421/implement-uart-frame-controller/43369651#43369651", "title": "Implement UART frame controller", "body": "<p>Absolutelly in DMA when it is available.</p>\n\n<p>You have one big (good solution is cyclic) buffer and you just write data from one side. If DMA does not already work, you start the DMA with your buffer.</p>\n\n<p>If DMA works, you just write your data to buffer and you wait DMA transfer complete interrupt.</p>\n\n<p>Later in this interrupt you increase read pointer of buffer (as you sent some data already) and check if any data available to send over DMA. Set memory address to DMA and number of bytes in buffer to send.</p>\n\n<p>Again, when DMA TC IRQ happens, do process again.</p>\n\n<p>There is no support for FRAME, but only in plain bytes. It means you have to \"invent\" your own frame protocol and use it in app.</p>\n\n<p>Later, when you want to send that FRAME over UART, you have to:</p>\n\n<ul>\n<li>Write start byte to buffer</li>\n<li>Write other header bytes</li>\n<li>Write actual data</li>\n<li>Write stop bytes/CRC/whatever</li>\n<li>Check if DMA does not work, if it does not, start it.</li>\n</ul>\n\n<p>Normally, I use this frame concept:</p>\n\n<hr>\n\n<p>[START, ADDRESS, CMD, LEN, DATA, CRC, STOP]</p>\n\n<ul>\n<li>START: Start byte indicating start of frame</li>\n<li>ADDRESS: Address of device when multiple devices are in use on bus</li>\n<li>CMD: Command ID</li>\n<li>LEN: 2 bytes for data length</li>\n<li>DATA: Actual data in bytes of variable length</li>\n<li>CRC: 2 bytes for CRC including: address, cmd, len, data</li>\n<li>STOP: Stop byte indicating end of frame</li>\n</ul>\n\n<hr>\n\n<p>This is how I do it in every project where necessary. This does not use CPU to send data, just sets DMA and starts transmission.</p>\n\n<p>From app perspective, you just have to create <code>send_send(data, len)</code> function which will create frame and put it to buffer for transmission.</p>\n\n<p>Buffer size must be big enough to fit your requirements:</p>\n\n<ul>\n<li>How much data at particular time (is it continues or a lot of data at small time)</li>\n<li>UART baudrate</li>\n</ul>\n\n<p>For specific question, ask and maybe I can provide some code examples from my libraries as reference.</p>\n"}, {"comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 1, "creation_date": 1492002140, "post_id": 43370117, "comment_id": 73802368, "body": "<code>DMA doesn&#39;t sound like a good fit for this, to me...</code> DMA is the best fit for this and it sounds like Beethoven&#39;s music."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492002384, "post_id": 43370117, "comment_id": 73802580, "body": "To write an interrupt-based ring buffer on byte-per-byte basis, when you have DMA available, should be made criminal. What if your CPU has other things to do than to continuously serving the interrupt? Suppose the UART is using a high baudrate... you are creating a tight coupling between the UART baudrate and <i>everything else</i> in your program. Someone changes baudrate and suddenly some completely unrelated part of your program will crash and burn."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "edited": false, "score": 0, "creation_date": 1492003155, "post_id": 43370117, "comment_id": 73803199, "body": "STM32 UARTs can detect an <b>idle</b> line, generating an interrupt when no start bit arrives within the time needed to transmit 10 bits. So it&#39;s perfectly possible to receive variable length frames with DMA, without polling and checking something all the time."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "edited": false, "score": 0, "creation_date": 1492004174, "post_id": 43370117, "comment_id": 73804088, "body": "@berendi this is really perfect for it. You have DMA TC or UART IDLE interrupts to detect received data for processing. I use this concept when I use DMA for UART RX."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1492011221, "post_id": 43370117, "comment_id": 73810016, "body": "@Lundin My experience with DMA and a ring buffer for UART traffic did reveal a significant higher interrupt latency/handling with DMA vs a simple ring buffer.  So for high bandwidth, DMA is certainly preferable,  Yet for low bandwidth, critical timed UART data flow (it was a keyboard in my case where a life critical application needed to respond within a sub-fraction of a second), the ring buffer performed better.  Use the implementation that best fits the need."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1492064604, "post_id": 43370117, "comment_id": 73831356, "body": "DMA is <code>always</code> better as you don&#39;t waste CPU IRQ. Ok, maybe if you receive 1 byte per second, then is it probably better RXNE IRQ on UART. But in general, DMA is better and when it finishes with transmission or IDLE detected, set new memory for DMA and start it. Then copy your received data to (in most cases) ring buffer to use it later up upper layer of application."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1492072927, "post_id": 43370117, "comment_id": 73836193, "body": "@chux If you use DMA it should be possible to design the system so that you never need any interrupt at all (except maybe for UART errors like overrun, framing etc). If the DMA is configured to whine with interrupts, you lose most of the benefits. But I take it that with &quot;interrupt latency&quot; you mean general response time. Yes, that will be some 100us slower or whatever. If that is too slow, then you have hard real-time requirements and then need to use UART interrupts."}], "tags": [], "owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "is_accepted": false, "score": 0, "last_activity_date": 1492001972, "last_edit_date": 1492001972, "creation_date": 1492001569, "answer_id": 43370117, "question_id": 43369421, "link": "https://stackoverflow.com/questions/43369421/implement-uart-frame-controller/43370117#43370117", "title": "Implement UART frame controller", "body": "<p>In this case, where you need to implement that protocol, I would probably use plain interrupts and, in the handler, use a byte-by-byte state-machine to parse the incoming bytes into a frame buffer.</p>\n\n<p>Only when a complete, valid frame has been received is it necessary to signal some semaphore/event and requuest a scheduler run, otherwise, you can handle any protocol error as you require - maybe tx some 'error-repeat' message and reset the state-machine to await the nexx start-of-frame buyte.</p>\n\n<p>If you use DMA for this, then the variable frame-length is going to be awkward and you STILL have to iterate the received data to validate you protocol:(   </p>\n\n<p>DMA doesn't sound like a good fit for this, to me...</p>\n\n<p>EDIT:  if no preemptive multitasker, then forget about all that semaphore gunge above:)   Still, it's easier to check a boolean 'validFrameRx' flag than parse DMA block data.</p>\n"}], "owner": {"reputation": 11, "user_id": 4779708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b22d0ffb9a13929f012f1872cf055056?s=128&d=identicon&r=PG&f=1", "display_name": "guillaume", "link": "https://stackoverflow.com/users/4779708/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1954, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1492001972, "creation_date": 1491999778, "question_id": 43369421, "link": "https://stackoverflow.com/questions/43369421/implement-uart-frame-controller", "title": "Implement UART frame controller", "body": "<p>I'm programming on a STM32 board and I'm confused on how to use my peripherals : polling, interrupt, DMA, DMA interrupt...</p>\n\n<p>Actually, I coded an UART module which send basics data and it works in polling, interrupt and DMA mode.</p>\n\n<p>But I'd like to be able to send and receive specific frames with variable lengths, for example: <hr>\n[ START | LGTH | CMD_ID | DATA(LGTH) | CRC ]</p>\n\n<hr>\n\n<p>I also have sensors and I'd like to interact received DATA in these UART frames with sensors.</p>\n\n<p>So, what I don't understand is:</p>\n\n<ul>\n<li><p>how to program the UART module to work in \"frame\" mode? (buffer? circular DMA? interrupt? where, when..)</p></li>\n<li><p>when I'm able to send or receive frame with my UART, what is the best way to interact with sensors? (inside a timer interrupt? in a state machine ? with extern variable? ...)</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/pTRd1.jpg\" rel=\"nofollow noreferrer\">Here is my Libraries tree</a></p>\n\n<p>In future, the idea is to carry this application in freertos</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "is_accepted": true, "score": 0, "last_activity_date": 1492000844, "creation_date": 1492000844, "answer_id": 43369825, "question_id": 43369406, "link": "https://stackoverflow.com/questions/43369406/c-copying-integer/43369825#43369825", "title": "C - Copying integer", "body": "<p>Okey, i read this <a href=\"http://denniskubes.com/2012/08/20/is-c-pass-by-value-or-reference/\" rel=\"nofollow noreferrer\">This article</a> and i understood. I don't need to copy integer i am passing to <code>json_integer()</code>, because it's is not a pointer and is completely isolated from the structs integer.</p>\n"}], "owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 43369825, "answer_count": 1, "score": 0, "last_activity_date": 1492000844, "creation_date": 1491999752, "question_id": 43369406, "link": "https://stackoverflow.com/questions/43369406/c-copying-integer", "title": "C - Copying integer", "body": "<p>so i am using <code>jansson</code> library and i want to set a value:\njson_object_set_new(event, \"error_code\", json_integer(response->error_code));</p>\n\n<p>The problem is that, i need to <code>free</code> <code>response</code> struct,  but still use the value i have set in <code>json_object_set_new</code>.</p>\n\n<p>Should i copy the value from <code>response-&gt;error_code</code> and how can i do that?</p>\n\n<p>Some context:</p>\n\n<pre><code>plugin_response: {\n    if(!response-&gt;message &amp;&amp; response-&gt;error_code == 0) {\n            response-&gt;error_code = JANUS_AUDIOBRIDGE_ERROR_UNKNOWN_ERROR;\n      if(response-&gt;error_cause == NULL) {\n              response-&gt;error_cause = g_strdup_printf(\"%s\", \"Invalid response\");\n      }\n    }\n\n        json_t *event = json_object();\n        if(!response-&gt;message &amp;&amp; response-&gt;error_code != 0) {\n            /* Prepare JSON error event */\n            json_object_set_new(event, \"audiobridge\", json_string(\"event\"));\n            json_object_set_new(event, \"error_code\", json_integer(response-&gt;error_code));\n            json_object_set_new(event, \"error\", json_string(response-&gt;error_cause));\n        } else {\n          event = json_deep_copy(response-&gt;message);\n    }\n\n        if(root != NULL)\n            json_decref(root);\n        if(jsep != NULL)\n            json_decref(jsep);\n        g_free(transaction);\n        g_free(response);\n\n\n\nreturn janus_plugin_result_new(JANUS_PLUGIN_OK, NULL, event);\n}\n</code></pre>\n\n<p><strong>EDIT:</strong> I am also using GLib, so if there is a nifty method for this, i am all ears.</p>\n"}, {"tags": ["c++", "c", "windows", "stdout", "io-redirection"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1491998667, "post_id": 43368941, "comment_id": 73799664, "body": "<a href=\"https://en.wikipedia.org/wiki/Tee_(command)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Tee_(command)</a>"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1491998669, "post_id": 43368941, "comment_id": 73799667, "body": "Are you not allowed to use Boost&#39;s tee?"}, {"owner": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "edited": false, "score": 0, "creation_date": 1491998771, "post_id": 43368941, "comment_id": 73799758, "body": "<a href=\"http://man7.org/linux/man-pages/man2/dup.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/dup.2.html</a>"}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1491999101, "post_id": 43368941, "comment_id": 73800021, "body": "@AndyG I am. I just don&#39;t understand how to use it in conjunction with stdout. Examples online like <a href=\"http://stackoverflow.com/a/5942532/1594014\">this</a> use an std::ostream like std::cout. I want to capture all standard output."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1491999277, "post_id": 43368941, "comment_id": 73800155, "body": "@squeamishossifrage I am on Windows. I cannot use the powershell command. I also cannot create my own tee program because I can&#39;t create the process that I wish to log. It is already running and I attach to it."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1491999288, "post_id": 43368941, "comment_id": 73800170, "body": "@AidanMcArthur: I think I see what you&#39;re asking. You want to intercept all calls to std::cout, and treat that stream itself as the tee, rather than use a tee as the stream instead, yes?"}, {"owner": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1491999495, "post_id": 43368941, "comment_id": 73800351, "body": "This is ridiculous that people are voting to close. OP has researched the problem, and has linked to a Stack Overflow question that discusses dup2. The <code>tee</code> command wouldn&#39;t work directly in this scenario, either, as the process is already started. @AidanMcArthur One possible approach is to create a pipe, replace stdout with the write end of the pipe, and create a thread that reads from the read end, writing to whichever file(s) you want."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1491999883, "post_id": 43368941, "comment_id": 73800636, "body": "@AndyG I&#39;m not sure about that. I want to intercept all calls to std::cout AND printf, WriteConsole, etc; anything that writes to the standard output. The example <a href=\"http://stackoverflow.com/a/5942532/1594014\">here</a> is exactly what I want, except instead of <code>Tee tee( std::cout, file );</code> I would want something like <code>Tee tee( stdout, file );</code> This seems like it would be too good to be true."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1492000371, "post_id": 43368941, "comment_id": 73800982, "body": "&quot;I can*t create the process that I whish to log.&quot; So it is already running - but how was it created then? As a system service?"}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492000648, "post_id": 43368941, "comment_id": 73801162, "body": "@DanielTrebbien Thanks, I will look into this. But why create a new thread?"}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1492000759, "post_id": 43368941, "comment_id": 73801238, "body": "@Aconcagua Possibly. Or another process started it. There is not a single scenario in mind, this is for the purpose of debugging processes."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1492001018, "post_id": 43368941, "comment_id": 73801446, "body": "With windows services, you should have a problem - although not 100% sure (linux: yes), your processes should not be connected to a console any more, thus stdout being closed (or just dropping the output...) and there is nothing to catch any more. &quot;Or another process started it&quot; - well, just redirecting the same problem to that other process - if that one is not linked to a console, the child will not be either again."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1492001378, "post_id": 43368941, "comment_id": 73801724, "body": "@Aconcagua I understand and appreciate your points, but I am just making a debugging tool for myself and I would like the ability to attach to a running process and intercept it&#39;s standard output. There are many scenarios I could give you where this could be useful (at least for myself)."}, {"owner": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492002184, "post_id": 43368941, "comment_id": 73802412, "body": "@AidanMcArthur The purpose of the thread is to take whatever is written to the pipe and write that to the file(s) you want to contain copies of what the process is writing to &quot;stdout&quot; (which is actually the write end of a pipe). Without a thread, you could periodically transfer the data in the pipe to the destination file(s), but you run the risk of deadlock if the pipe ever becomes full. See this blog post from Raymond Chen: <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20110707-00/?p=10223\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/oldnewthing/20110707-00/?p=10223</a>"}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492002840, "post_id": 43368941, "comment_id": 73802947, "body": "@DanielTrebbien Awesome thanks."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492067925, "post_id": 43368941, "comment_id": 73833207, "body": "@DanielTrebbien Sorry to bug you, only if you have time, could you check out what I have so far and tell me if I&#39;m on the right track: <a href=\"https://pastebin.com/gaGSCE1F\" rel=\"nofollow noreferrer\">pastebin.com/gaGSCE1F</a> This is allowing me to block on ReadFile and wait for output to arrive that I could then write to a file, but this redirects output away from the console. Am I not doing what you suggested correctly, or is this the expected result?"}, {"owner": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492173748, "post_id": 43368941, "comment_id": 73882230, "body": "Hi @AidanMcArthur: I coded up a demonstration here: <a href=\"https://gist.github.com/dtrebbien/519b1cfeb12f372642c7deb771e190ea\" rel=\"nofollow noreferrer\">gist.github.com/dtrebbien/519b1cfeb12f372642c7deb771e190ea</a> I have only tested it on macOS, but I think that it will work on Windows. (If it doesn&#39;t, would you please let me know what fixes are required?) Taking a look at your pastebin, I think that you want to duplicate the current stdout before replacing it, as that way you can write to stdout <i>and</i> any other file(s). Also, you probably want to use binary I/O rather than text I/O."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492189980, "post_id": 43368941, "comment_id": 73890912, "body": "@DanielTrebbien Wow, thank you so much. The exact code you wrote works just how it&#39;s supposed to. The only thing I need to do is make it make it continue to duplicate output for the entire life of the process. This is interesting because I believe after I exit the scope of my function, the tee device is destroyed, resulting in an exception. Maybe a simple inf. loop at the end of my function? Or maybe an inf. loop within the tee thread, and instead of .join(), .detach()? Also, would I want <code>boost::iostreams::never_close_handle</code>? Thanks for your help. Your gist should be the accepted answer."}, {"owner": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492432106, "post_id": 43368941, "comment_id": 73958335, "body": "By moving the setup code within a class, you can implement this behavior. Please see the updated gist. If you comment out the <code>delete tee</code> line, then the tee redirection is enabled for the life of the process. However, note that this can result in not all bytes written to stdout being saved in the file. If you have the option of implementing a &quot;tear down&quot; type of plugin API, this would be a good place to delete the <code>stdout_tee</code> object."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492451612, "post_id": 43368941, "comment_id": 73969003, "body": "@DanielTrebbien I&#39;m getting an exception when I hit <code>tee_os &lt;&lt; &amp;pipe_readbuf;</code> It is thrown by the <code>write</code> method in boost&#39;s <code>tee</code> class. Specifically this line <code>BOOST_ASSERT(result1 == n &amp;&amp; result2 == n);</code> On breaking, result1 == 4096, result2 == 0 and n = 4096. <a href=\"http://imgur.com/a/BXrsF\" rel=\"nofollow noreferrer\">Image</a>. I haven&#39;t changed anything else with your code. Let me know if you need more info. Thanks."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492452947, "post_id": 43368941, "comment_id": 73969741, "body": "@DanielTrebbien Disregard that I&#39;m an idiot. Was using a directory path as the sink instead of a file path. New issue though. But the same issue I was having with your original code. After removing <code>delete tee</code>, it fails to finish writing the for loop of numbers to the console and to the file, and fails to write anything else after. Is this what you were warning me of in your last comment? Even if I called <code>delete</code> in DLL_PROCESS_DETACH, why is nothing being outputted in the mean time? Is there some way to force flush everything? <code>tee_os &lt;&lt; std::unitbuf &lt;&lt; &amp;pipe_readbuf;</code> doesn&#39;t work."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "edited": false, "score": 0, "creation_date": 1492453471, "post_id": 43368941, "comment_id": 73970023, "body": "I get <a href=\"http://imgur.com/a/yHCjz\" rel=\"nofollow noreferrer\">this</a> every time, or something close to it. Why does it stop working before the loop is finished? Wouldn&#39;t the <code>std::cout &lt;&lt; std::endl;</code> at the end of every for loop iteration cause it to flush?"}, {"owner": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492466934, "post_id": 43368941, "comment_id": 73976791, "body": "<code>std::cout &lt;&lt; std::endl</code> does flush <code>std::cout</code>, so any bytes that were written to <code>std::cout</code> will have been written to the pipe. The issue is that as the tee thread is attempting to finish transferring the contents of the pipe to <code>tee_os</code>, the program exits. I don&#39;t know whether it is specified what happens to threads that are running when a program exits, but it appears to be that the running threads are terminated or maybe the stdout file description that <code>tee_os</code> is writing to is closed. Either way, the tee thread does not get to finish."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "reply_to_user": {"reputation": 35530, "user_id": 196844, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20232ad0698d2ac6c0f127d5eb850254?s=128&d=identicon&r=PG", "display_name": "Daniel Trebbien", "link": "https://stackoverflow.com/users/196844/daniel-trebbien"}, "edited": false, "score": 0, "creation_date": 1492471956, "post_id": 43368941, "comment_id": 73978297, "body": "@DanielTrebbien My process doesn&#39;t exit after the output calls that you wrote. After your for loop that cout&#39;s numbers, the process&#39;s main thread is resumed, which does additional printf&#39;s and cout&#39;s, each with a sleep in between the calls. I should have been more specific. My flow currently is: create a process in suspended mode, inject my dll which works by creating a remote thread which contains the tee solution you made, then the process&#39;s main thread is resumed, which does the additional printing. The important thing is that my process doesn&#39;t exit and the threads are alive."}, {"owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "edited": false, "score": 1, "creation_date": 1492472563, "post_id": 43368941, "comment_id": 73978495, "body": "I&#39;m beginning to think this is just something unrelated to the original question that I am doing wrong, I think what you gave me is probably perfect. I just need to do some serious debugging. So thank you very much for your help Daniel, I really appreciate your continual help."}], "owner": {"reputation": 59, "user_id": 1594014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34a5db104bb5fc209871ba336d597dc?s=128&d=identicon&r=PG", "display_name": "Aidan McArthur", "link": "https://stackoverflow.com/users/1594014/aidan-mcarthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "closed_date": 1492002063, "answer_count": 0, "score": 1, "last_activity_date": 1492002387, "creation_date": 1491998426, "last_edit_date": 1495540945, "question_id": 43368941, "link": "https://stackoverflow.com/questions/43368941/duplicating-stdout", "closed_reason": "Duplicate", "title": "Duplicating stdout", "body": "<p>There are countless articles and answers online explaining how to redirect standard output, like <a href=\"https://stackoverflow.com/a/617158\">this</a> or <a href=\"https://stackoverflow.com/a/573733/1594014\">this</a>. However, I want to duplicate/mirror what is written to stdout/stderr without completely redirecting it. When I do a printf or an std::cout, I want it to simultaneously write to the console and to a file. This is a plugin of sorts; I do not have control over when or how the process calls printf/std::cout/etc. I only need to support Windows. I sort of want something like Boost's <a href=\"http://www.boost.org/doc/libs/1_49_0/libs/iostreams/doc/functions/tee.html\" rel=\"nofollow noreferrer\">tee device</a> but that somehow uses stdout. Is this possible?</p>\n\n<p>Edit: I wonder if the people who closed this really understood what I am asking, or if I am missing something? I don't want to duplicate the std::cout stream buffer, I want to duplicate standard output. None of those answers linked in the \"duplicate\" question link could intercept/duplicate a call to printf.</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491998770, "post_id": 43368928, "comment_id": 73799754, "body": "Well I think you need to do so, since that will [I think] create a memory leaks since you do not close the file descriptor."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1492008976, "post_id": 43368928, "comment_id": 73808175, "body": "If you don&#39;t call close(), and keep creating new sockets (e.g. via accept()), then eventually your process&#39;s sockets-table will fill up with leftover sockets, and then your process won&#39;t be able to create anymore, so accept(), socket(), etc will all fail with errno=EMFILE, and then your program will not work very well anymore :("}], "answers": [{"tags": [], "owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "is_accepted": false, "score": 1, "last_activity_date": 1491999002, "creation_date": 1491999002, "answer_id": 43369155, "question_id": 43368928, "link": "https://stackoverflow.com/questions/43368928/do-i-have-to-close-the-socket-on-the-server-side-after-client-disconnects/43369155#43369155", "title": "Do I have to close the socket on the server side after client disconnects?", "body": "<p>You need to close the descriptor to release the resources bound to it. </p>\n"}, {"comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1492000023, "post_id": 43369167, "comment_id": 73800728, "body": "Ad1: the client (remote host) does not need to be informed(it is already dead), but the entry in the connection-table needs to be deallocated (it will probably first stay in a time-wait state for some time) This is automatically dealt with in your (2) : it is handled via the close(fd)"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1492000407, "post_id": 43369167, "comment_id": 73801016, "body": "@wildplasser Re: 1 I think you missed my point. The client may not be &quot;dead&quot; - he could have only called <code>shutdown(fd, SHUT_WR)</code> and could be still waiting for more data from the server. In this case he <i>does</i> need to be informed."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1492000624, "post_id": 43369167, "comment_id": 73801150, "body": "That is correct; it could be half-closed. But I fully agree with you: calling close(fd) is the way to go."}, {"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "edited": false, "score": 0, "creation_date": 1492065350, "post_id": 43369167, "comment_id": 73831720, "body": "@Jonathon Receiving an EOF, calling shutdown is pointless since the other side has already closed the connection or has at least shutdown its sending part of the connection. Invoking shutdown() would close the other half of the connection the same way as close() will do anyways. Regarding &quot;needs to be informed&quot; this will also happen with close(), no need to call shutdown()."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "edited": false, "score": 0, "creation_date": 1492080991, "post_id": 43369167, "comment_id": 73841461, "body": "Thanks @Meixner, but why was that comment directed at me? I&#39;m well aware that <code>close()</code> implies <code>shutdown()</code>. Nowhere did I suggest that calling <code>shutdown</code> was required."}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": true, "score": 11, "last_activity_date": 1491999740, "last_edit_date": 1491999740, "creation_date": 1491999026, "answer_id": 43369167, "question_id": 43368928, "link": "https://stackoverflow.com/questions/43368928/do-i-have-to-close-the-socket-on-the-server-side-after-client-disconnects/43369167#43369167", "title": "Do I have to close the socket on the server side after client disconnects?", "body": "<p>Yes.</p>\n\n<p>When you <code>recv()</code> 0 bytes, that's the kernel's way of letting you know that the remote host has shut down their <em>sending</em> side of the connection. It's possible that they still have the socket open and could receive more data you send (but not reply).</p>\n\n<p>When you call <code>close()</code> on a TCP socket, you are doing two things:</p>\n\n<ol>\n<li>Shutting down the local side of the socket, letting the remote host know that you're also finished transmitting. Without doing so, you potentially leave the clients hanging, waiting for you to send more data.</li>\n<li>Closing the file descriptor. This releases the entry in your process open file table. Without doing so, you are wasting resources and could find yourself out of memory or available file descriptors. Most every OS has a hard limit on the number of file descriptors  (or handles) that a process can have open at one time.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 2, "creation_date": 1491999412, "post_id": 43369214, "comment_id": 73800272, "body": "The memory itself isn&#39;t really through issue. It&#39;s the limit on open file descriptors that&#39;s going to bite you. I think you need to re-word your answer because it is not clear that this sentence is hypothetical: <i>&quot;Every time you call accept(), it allocates 1GB of RAM.&quot;</i>"}], "tags": [], "owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "is_accepted": false, "score": 1, "last_activity_date": 1492005198, "last_edit_date": 1492005198, "creation_date": 1491999163, "answer_id": 43369214, "question_id": 43368928, "link": "https://stackoverflow.com/questions/43368928/do-i-have-to-close-the-socket-on-the-server-side-after-client-disconnects/43369214#43369214", "title": "Do I have to close the socket on the server side after client disconnects?", "body": "<p>The answer is yes.  The reason is that accept() allocates memory, close() frees that memory.</p>\n\n<p>Imagine a theoretical situation where your code is in a loop and that every time you call accept(), it allocates 1GB of RAM (pretend that it is a really inefficient socket library :-) ).  Whenever you call close(), it frees up 1GB of RAM.  If you never call close(), how many times round the loop will accept() happen before you run out of memory?   </p>\n\n<p>Of course accept() only allocates a small chunk of memory, but eventually, you will run out of memory, unless you do something about it.</p>\n"}], "owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7748, "favorite_count": 1, "accepted_answer_id": 43369167, "answer_count": 3, "score": 6, "last_activity_date": 1492005198, "creation_date": 1491998392, "question_id": 43368928, "link": "https://stackoverflow.com/questions/43368928/do-i-have-to-close-the-socket-on-the-server-side-after-client-disconnects", "title": "Do I have to close the socket on the server side after client disconnects?", "body": "<p>So let me simplify the code I'm working on:</p>\n\n<pre><code>int fd = socket(...);\nint client = accept(fd, ...);\nwhile (true) {\n    int bytes_read = recv(client, ...);\n    if (bytes_read == 0) {\n        break;\n    }\n};\n</code></pre>\n\n<p>At this point I already know that the client is disconnected (<code>recv</code> returned 0). But do I still have to call</p>\n\n<pre><code>close(client);\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["c", "compilation"], "comments": [{"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491997959, "post_id": 43368753, "comment_id": 73799220, "body": "It compile because it&#39;s well written, and correct."}, {"owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 4, "creation_date": 1491997964, "post_id": 43368753, "comment_id": 73799226, "body": "Duffs device. See wikipedia."}, {"owner": {"reputation": 360, "user_id": 3492498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b22bd84245bf80211b37cc5ccf73def?s=128&d=identicon&r=PG&f=1", "display_name": "Nish", "link": "https://stackoverflow.com/users/3492498/nish"}, "edited": false, "score": 0, "creation_date": 1491998133, "post_id": 43368753, "comment_id": 73799322, "body": "its a memcpy in blocks of 8, taking care of the fact not all &quot;copy lengths&quot; are divisible by 8."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1491998777, "post_id": 43368753, "comment_id": 73799766, "body": "that said it is not worth using this nowadays. memcpy should that just fine and loopunroling is a common feature in optimizing compilers afaik."}, {"owner": {"reputation": 336, "user_id": 7761980, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1d0b835989e13bd56acf5c18117d4c47?s=128&d=identicon&r=PG", "display_name": "ThingyWotsit", "link": "https://stackoverflow.com/users/7761980/thingywotsit"}, "edited": false, "score": 1, "creation_date": 1492002107, "post_id": 43368753, "comment_id": 73802340, "body": "Yeah - whenever you see something like Duff, or similar, think hard about how difficult it will be to debug..."}], "owner": {"reputation": 1619, "user_id": 228965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3566b571bcdc2b608ec0ed3ad0c790f?s=128&d=identicon&r=PG", "display_name": "zardosht", "link": "https://stackoverflow.com/users/228965/zardosht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1491998092, "answer_count": 0, "score": 1, "last_activity_date": 1491997907, "creation_date": 1491997853, "last_edit_date": 1491997907, "question_id": 43368753, "link": "https://stackoverflow.com/questions/43368753/why-how-does-this-c-code-compile-and-what-does-it-do", "closed_reason": "Duplicate", "title": "Why / how does this C code compile? and What does it do?", "body": "<p>I have a C code, in which a do loop is started in the first branch of a switch statement. What is weird, is that the rest of the branches of the switch statement are inside the body of the do loop. First, how is it possible that this code compiles? Second, what does it possibly do? </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void f(char *x, char *y, int z) {\n    int z2 = (z + 7) / 8;\n    switch(z % 8) {\n        case 0: do { *x++ = *y++;\n        case 7: *x++ = *y++;\n        case 6: *x++ = *y++;\n        case 5: *x++ = *y++;\n        case 4: *x++ = *y++;\n        case 3: *x++ = *y++;\n        case 2: *x++ = *y++;\n        case 1: *x++ = *y++;\n                } while(--z2 &gt; 0);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1491997309, "post_id": 43368496, "comment_id": 73798825, "body": "No, that construct doesn&#39;t exist in C."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1491997347, "post_id": 43368496, "comment_id": 73798851, "body": "But also, think about what you&#39;re trying to do.  If you&#39;re defining these as bitfields, what would it mean to &quot;share&quot; these fields between separate instances?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491998403, "post_id": 43368496, "comment_id": 73799475, "body": "With respect to <code>uint32_t  End : 28;</code> do you know <i>which</i> 28 bits are being used?"}, {"owner": {"reputation": 345, "user_id": 7402897, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/660d276e5c398a797bf406e995a78a20?s=128&d=identicon&r=PG&f=1", "display_name": "Aeonos", "link": "https://stackoverflow.com/users/7402897/aeonos"}, "edited": false, "score": 0, "creation_date": 1491998949, "post_id": 43368496, "comment_id": 73799930, "body": "@ Andrew Henle: No, i dont. The values are going to be initialiezed to zero and starting from that point it does not matter, which bits are going to be used as i see it, but that is a good remark."}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 7402897, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/660d276e5c398a797bf406e995a78a20?s=128&d=identicon&r=PG&f=1", "display_name": "Aeonos", "link": "https://stackoverflow.com/users/7402897/aeonos"}, "edited": false, "score": 0, "creation_date": 1491997582, "post_id": 43368573, "comment_id": 73799014, "body": "that totally makes sense :D. You are right, i am going to implement it in the transfer protocoll instead of the struct. Thanks!"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 1, "last_activity_date": 1491997375, "creation_date": 1491997375, "answer_id": 43368573, "question_id": 43368496, "link": "https://stackoverflow.com/questions/43368496/static-const-struct-member/43368573#43368573", "title": "static const struct member", "body": "<p>No, that's not possible.</p>\n\n<p>It doesn't make sense, the members of a struct need to be together in memory, but you somehow want to \"pull out\" a couple of fields and have them live elsewhere.</p>\n\n<p>Would you expect e.g.</p>\n\n<pre><code>TModbusFrameRtu frame_a, frame_b; // two instances\n</code></pre>\n\n<p>to have the same value for <code>&amp;frame_a.Start</code> and <code>&amp;frame_b.Start</code>? That's not how things work, at all.</p>\n\n<p>The solution is probably to not include these in the structure at all, but instead make them ordinary constants inside the implementation.</p>\n"}], "owner": {"reputation": 345, "user_id": 7402897, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/660d276e5c398a797bf406e995a78a20?s=128&d=identicon&r=PG&f=1", "display_name": "Aeonos", "link": "https://stackoverflow.com/users/7402897/aeonos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "closed_date": 1543503901, "accepted_answer_id": 43368573, "answer_count": 1, "score": 0, "last_activity_date": 1491997375, "creation_date": 1491997109, "question_id": 43368496, "link": "https://stackoverflow.com/questions/43368496/static-const-struct-member", "closed_reason": "Duplicate", "title": "static const struct member", "body": "<p>I am setting up a structure for Modbus RTU communication, but i got problems writing the apropriate structure. Here is the structure i got up to now:</p>\n\n<pre><code>#include \"stdint.h\"\n\ntypedef struct TModbusFrameRtu_tag\n{\n  static const uint32_t  Start : 28;\n  uint8_t         Address;\n  uint8_t         Function;\n  uint8_t         Data;\n  uint16_t        Crc16;\n  static const uint32_t  End : 28;\n}TModbusFrameRtu;\n\nconst uint32_t TModbusFrameRtu_tag::Start = 0x0000;\nconst uint32_t TModbusFrameRtu_tag::End   = 0x0000;\n</code></pre>\n\n<p>But the compiler doesnt like the <code>static const</code> combination. Trying to compile this code the compiler prints</p>\n\n<pre><code>error: expected specifier-qualifier-list before 'static'|\nerror: expected '=', ',', ';', 'asm' or '__attribute__' before ':' token|\nerror: expected '=', ',', ';', 'asm' or '__attribute__' before ':' token|\nerror: expected identifier before numeric constant|\nerror: unknown type name 'TModbusFrameRtu'|\n</code></pre>\n\n<p>I thought i could save some space by declaring the Start and End member static, as they are always going to be the same and will never change for any message that is going to be send. Is this not possible in that combination or how can i solve this?</p>\n"}, {"tags": ["c", "encryption", "server", "client", "xor"], "comments": [{"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 3, "creation_date": 1491997156, "post_id": 43368472, "comment_id": 73798746, "body": "What exactly are you asking?"}, {"owner": {"reputation": 17, "user_id": 7456300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f10be94f1dbd95f916729c52d22490?s=128&d=identicon&r=PG&f=1", "display_name": "Megha", "link": "https://stackoverflow.com/users/7456300/megha"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1491997297, "post_id": 43368472, "comment_id": 73798818, "body": "i need a code for sending message from client to server with xor encryption"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1491997372, "post_id": 43368472, "comment_id": 73798871, "body": "Do not try to create your own encryption. For client server communications just use https, everything will be encrypted. <a href=\"https://www.schneier.com/blog/archives/2011/04/schneiers_law.html\" rel=\"nofollow noreferrer\">&quot;Schneier&#39;s Law&quot;</a>: Anyone, from the most clueless amateur to the best cryptographer, can create an algorithm that he himself can&#39;t break."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 3, "creation_date": 1491997415, "post_id": 43368472, "comment_id": 73798902, "body": "Show us what you have and what you&#39;re struggling with. You have the xor code? What have you done towards the networking code? What is the issue with it? From StackOverflow you will receive a great deal of expert assistance to a well written question, showing you&#39;ve made an effort. You will receive little help when just asking for someone else to do your work."}, {"owner": {"reputation": 17, "user_id": 7456300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f10be94f1dbd95f916729c52d22490?s=128&d=identicon&r=PG&f=1", "display_name": "Megha", "link": "https://stackoverflow.com/users/7456300/megha"}, "edited": false, "score": 0, "creation_date": 1491997631, "post_id": 43368472, "comment_id": 73799042, "body": "how to send code,, here its not taking my code"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 1, "creation_date": 1491998024, "post_id": 43368472, "comment_id": 73799257, "body": "Separating your encryption into encrypt and decrypt functions doesn&#39;t make sense, they would be identical. There&#39;s nothing to do with sending any result to a server in your code. The first thing to do is find a networking tutorial, and try following it. Feel free to ask any specific questions you have here which you&#39;re unable to solve with a simple search."}, {"owner": {"reputation": 17, "user_id": 7456300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f10be94f1dbd95f916729c52d22490?s=128&d=identicon&r=PG&f=1", "display_name": "Megha", "link": "https://stackoverflow.com/users/7456300/megha"}, "edited": false, "score": 0, "creation_date": 1491998252, "post_id": 43368472, "comment_id": 73799387, "body": "i tried with sending message from client to server ... its working,, but when i include this xor program its not sending to server"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1491998409, "post_id": 43368472, "comment_id": 73799482, "body": "@Megha don&#39;t put tons of code in comments, it&#39;s unreadable, but edit your question instead."}, {"owner": {"reputation": 405, "user_id": 3645308, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/2nZYZ.png?s=128&g=1", "display_name": "Slaiyer", "link": "https://stackoverflow.com/users/3645308/slaiyer"}, "edited": false, "score": 0, "creation_date": 1491998691, "post_id": 43368472, "comment_id": 73799684, "body": "It seems that you are not familiar with how to ask for help on online forums. Please understand that you need to provide specifics of your implementation in the format and conventions commonly used."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1491998943, "post_id": 43368472, "comment_id": 73799921, "body": "@Colin__s Using XOR encryption, in fact any do-it-yourself encryption, is not secure and should not be done."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1491999243, "post_id": 43368472, "comment_id": 73800132, "body": "@Megha So your actual question is not about XOR encryption, but how to send data from one computer to another via the network, right?"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1491999494, "post_id": 43368472, "comment_id": 73800349, "body": "@zaph I appreciate that, but the question at hand isn&#39;t whether the encryption is good, or should be used. I have neither endorsed nor condemned it."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1492000023, "post_id": 43368472, "comment_id": 73800729, "body": "@zaph There is nothing in the question about HTTP, there is mention of client server comms, so if you want to push anything I suggest TLS or SSL. My point still stands, this question is <b>not</b> about the strength of encryption."}, {"owner": {"reputation": 17, "user_id": 7456300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f10be94f1dbd95f916729c52d22490?s=128&d=identicon&r=PG&f=1", "display_name": "Megha", "link": "https://stackoverflow.com/users/7456300/megha"}, "edited": false, "score": 0, "creation_date": 1492000110, "post_id": 43368472, "comment_id": 73800797, "body": "using Client and server i need to send text file with encryption"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1492000476, "post_id": 43368472, "comment_id": 73801059, "body": "@Colin__s The question is: &quot;... client send the data/string message to Server .... &quot; and &quot;... want encryption and decryption ...&quot;. The most common method using encryption is with HTTPS. If you feel TLS or SSL is mote appropriate supply that help. Simple XOR encryption is a joke and would put users at risk and needs to be avoided."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1492000601, "post_id": 43368472, "comment_id": 73801141, "body": "@zaph I give up. You win."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1492000640, "post_id": 43368472, "comment_id": 73801156, "body": "@Colin__s I am not looking for a &quot;win&quot;, I am looking out for the users. I feel it is possible to both help the OP and protect the users."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1492001099, "post_id": 43368472, "comment_id": 73801509, "body": "@Megha You can send a text file from a client to a server with encryption using HTTPS with the file data as the POST data. Another solution is to use <a href=\"https://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol\" rel=\"nofollow noreferrer\">SFTP</a>."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1492002975, "post_id": 43368472, "comment_id": 73803046, "body": "You ignore the terminations. <code>char encrypted[strlen(baseStr)]</code> add <code>+1</code> and in your function you should do a <code>output[i]=&#180;\\0&#180;;</code> after the loop."}], "answers": [{"comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1492092687, "post_id": 43390907, "comment_id": 73850109, "body": "There is no real security in such a simple scheme."}, {"owner": {"reputation": 382, "user_id": 6497318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa77f317c9ab7eccb840dd907015175?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin shihab", "link": "https://stackoverflow.com/users/6497318/yasin-shihab"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1492152096, "post_id": 43390907, "comment_id": 73872693, "body": "Yes, its a hint. You&#39;ve to implement your security scheme."}], "tags": [], "owner": {"reputation": 382, "user_id": 6497318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa77f317c9ab7eccb840dd907015175?s=128&d=identicon&r=PG&f=1", "display_name": "Yasin shihab", "link": "https://stackoverflow.com/users/6497318/yasin-shihab"}, "is_accepted": false, "score": 0, "last_activity_date": 1492082520, "creation_date": 1492082520, "answer_id": 43390907, "question_id": 43368472, "link": "https://stackoverflow.com/questions/43368472/how-to-implement-xor-encryption-in-c-to-send-data-from-client-toserver/43390907#43390907", "title": "How to implement XOR encryption in C to send data from Client toServer", "body": "<p>Try to align with my thinking on your problem.\nI have edited your code a little bit:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nvoid encryptDecrypt(char *input, char *output)\n{\n    char key[] = { 'K', 'C', 'Q' }; //Can be any chars, and any size array\n    int i;\n    for (i = 0; i &lt; strlen(input); i++) {\n        output[i] = input[i] ^ key[i % (sizeof(key) / sizeof(char))];\n    }\n    output[strlen(input)] = '\\0';\n}\nvoid serverDecryptedText(char* encryptedText, char* decryptedNormalText)\n{\n    /*Assumed: Server got encryptedText*/\n    encryptDecrypt(encryptedText, decryptedNormalText);\n    /*You will get original text in decryptedNormalText*/\n}\nvoid sendToServerWithEncryption(char* normalText, char* encryptedText)\n{\n    encryptDecrypt(normalText, encryptedText);\n    /*Implement code to send encryptedText to server here */\n}\nint main()\n{\n    char baseStr[1000];\n    printf(\"Enter string:\");\n    scanf(\"%s\",baseStr);\n\n    char *encrypted = (char*)malloc(strlen(baseStr)+1); \n    char *decrypted = (char*)malloc(strlen(baseStr) + 1);\n\n    sendToServerWithEncryption(baseStr, encrypted);\n\n    printf(\"Encrypted:%s\\n\\n\\n\", encrypted);\n\n    serverDecryptedText(encrypted, decrypted);\n\n    printf(\"Decrypted:%s\\n\\n\\n\", decrypted);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7456300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f10be94f1dbd95f916729c52d22490?s=128&d=identicon&r=PG&f=1", "display_name": "Megha", "link": "https://stackoverflow.com/users/7456300/megha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 672, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1492082520, "creation_date": 1491997063, "last_edit_date": 1491998909, "question_id": 43368472, "link": "https://stackoverflow.com/questions/43368472/how-to-implement-xor-encryption-in-c-to-send-data-from-client-toserver", "title": "How to implement XOR encryption in C to send data from Client toServer", "body": "<p>I'm so confused, I have an XOR encryption Program in c which do encryption and decryption in same program , but i want encryption and decryption to be separate.</p>\n\n<p>Then i want code where client send the data/string message to Server with encryption (XOR) then Server Should receive encrypted string message in c program.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nvoid encryptDecrypt(char *input, char *output)\n{\n char key[] = {'K', 'C', 'Q'}; //Can be any chars, and any size array\n int i;\n for(i = 0; i &lt; strlen(input); i++) {\n   output[i] = input[i] ^ key[i % (sizeof(key)/sizeof(char))]; \n }\n}\n\nint main()\n{\n char baseStr[1000];\n\n printf(\"Enter string:\");\n fgets(baseStr, sizeof baseStr, stdin);\n char encrypted[strlen(baseStr)];\n encryptDecrypt(baseStr, encrypted);\n printf(\"Encrypted:%s\\n\\n\\n\", encrypted);\n char decrypted[strlen(baseStr)];\n encryptDecrypt(encrypted, decrypted);\n printf(\"Decrypted:%s\\n\\n\\n\", decrypted);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 360, "user_id": 3492498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b22bd84245bf80211b37cc5ccf73def?s=128&d=identicon&r=PG&f=1", "display_name": "Nish", "link": "https://stackoverflow.com/users/3492498/nish"}, "edited": false, "score": 0, "creation_date": 1491997907, "post_id": 43368167, "comment_id": 73799189, "body": "you are not reversing a string, you are just printing in reverse order"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 5, "last_activity_date": 1491997155, "last_edit_date": 1491997155, "creation_date": 1491996364, "answer_id": 43368225, "question_id": 43368167, "link": "https://stackoverflow.com/questions/43368167/reverse-function-array-string/43368225#43368225", "title": "Reverse Function Array String", "body": "<p>Because you never modify <code>arr[]</code> inside <code>reverse()</code>, you just print it in the order you iterate.</p>\n\n<p>It should be something like:</p>\n\n<pre><code>void reverse(char *s, size_t length)\n{\n  for(size_t i = 0; i &lt; length / 2; ++i)\n  {\n    const size_t tail = length - (i + 1);\n    const char tmp = s[tail];\n    s[tail] = s[i];\n    s[i] = tmp;\n  }\n}\n</code></pre>\n\n<p>Also no weird <code>getchar()</code> call in  <code>reverse()</code>, that makes no sense.</p>\n"}, {"tags": [], "owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "is_accepted": false, "score": 0, "last_activity_date": 1491996482, "creation_date": 1491996482, "answer_id": 43368263, "question_id": 43368167, "link": "https://stackoverflow.com/questions/43368167/reverse-function-array-string/43368263#43368263", "title": "Reverse Function Array String", "body": "<p>You are using the same string the second time as well. Your function is void, you practically are doing nothing with the string itself, just printing the letters in reverse order. For what you want, you should save what you are doing in a variable and then return it, and maybe use a function to print separately.</p>\n"}, {"tags": [], "owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1491996671, "creation_date": 1491996671, "answer_id": 43368322, "question_id": 43368167, "link": "https://stackoverflow.com/questions/43368167/reverse-function-array-string/43368322#43368322", "title": "Reverse Function Array String", "body": "<p>The argument (myString) to the reverse function is same in two times when you called from the main function. You are just printing the char in reverse format instead of reverse in sub module.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 7500873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/075c48ee8523a45ffa46d35571f066c3?s=128&d=identicon&r=PG&f=1", "display_name": "C. zero", "link": "https://stackoverflow.com/users/7500873/c-zero"}, "is_accepted": false, "score": 1, "last_activity_date": 1496539418, "creation_date": 1496539418, "answer_id": 44349953, "question_id": 43368167, "link": "https://stackoverflow.com/questions/43368167/reverse-function-array-string/44349953#44349953", "title": "Reverse Function Array String", "body": "<p>If you want to reverse the words \"Hello!\", it is more convenient to define it as string and then use <code>reverse(myString.begin(), myString.end())</code> or<code>reverse(&amp;myString[0], myString.length())</code> </p>\n\n<p>The parameter of the function<code>reverse(p1, p2)</code> should be <code>reverse(first_position, last_position)</code></p>\n\n<p>Besides, if you really want to define the string as char, you should put them inside iteration and then reverse them one by one as @unwind said.</p>\n\n<p>More details about the <code>reverse</code> function can be found at <a href=\"http://www.cplusplus.com/reference/algorithm/reverse/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/algorithm/reverse/</a></p>\n"}], "owner": {"reputation": 55, "user_id": 7856051, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e83368418503d98d2d7c25a5b5c276aa?s=128&d=identicon&r=PG&f=1", "display_name": "Cutik", "link": "https://stackoverflow.com/users/7856051/cutik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1496539418, "creation_date": 1491996160, "last_edit_date": 1492001699, "question_id": 43368167, "link": "https://stackoverflow.com/questions/43368167/reverse-function-array-string", "title": "Reverse Function Array String", "body": "<ul>\n<li><p>Why is my reverse function not reversing my string back to Hello! when i am calling my function the second time?</p></li>\n<li><p>What could i change to use my function to reverse + dereverse my string multiple times?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid reverse(char arr[], int numberOfChars);\n\nint main()\n{\n    char myString[] = \"Hello!\";\n    int length = strlen(myString);\n\n    for (int i = 0; i &lt; length; i++)\n    {\n        printf(\"%c\", myString[i]);\n    }\n    printf(\"\\n\");\n\n    reverse(myString, length);\n    reverse(myString, length);\n\n    getchar();\n    return 0;\n}\n\nvoid reverse(char arr[], int numberOfChars)\n{\n    for (int i = numberOfChars - 1; i &gt;= 0; i--)\n    {\n        printf(\"%c\", arr[i]);\n    }\n    getchar();\n}\n</code></pre></li>\n</ul>\n"}, {"tags": ["java", "c", "android-studio"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1491995590, "post_id": 43367940, "comment_id": 73797622, "body": "Can&#39;t you use <code>native</code> and a JNI? Might be overkill, but worth looking at. At least then you keep the C code intact. Otherwise use a <code>byte[3]</code> in Java. And a nicely worded question. Not sure about the downvote. By the way the size of <code>unsigned short</code> varies from platform to platform."}, {"owner": {"reputation": 779, "user_id": 7556432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76677ad4bb571a6918d02f59d52fe03b?s=128&d=identicon&r=PG&f=1", "display_name": "Jure Kolenko", "link": "https://stackoverflow.com/users/7556432/jure-kolenko"}, "edited": false, "score": 0, "creation_date": 1491997771, "post_id": 43367940, "comment_id": 73799114, "body": "Java primitive data types have a fixed size that should not depend on the platform, so hardcoding the values should not be a problem. You can simply write a deserialize function that takes a ByteInputStream then reads the appropriate number of bytes into your fields."}, {"owner": {"reputation": 549, "user_id": 7694476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qx3BS.png?s=128&g=1", "display_name": "G. Fiedler", "link": "https://stackoverflow.com/users/7694476/g-fiedler"}, "edited": false, "score": 0, "creation_date": 1492015566, "post_id": 43367940, "comment_id": 73812836, "body": "When you call <code>RxData()</code> more than 20 times it will raise a buffer overflow."}, {"owner": {"reputation": 75, "user_id": 5506984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3790e63edf14b2f538cf9bd1ea4705a?s=128&d=identicon&r=PG&f=1", "display_name": "Hneel", "link": "https://stackoverflow.com/users/5506984/hneel"}, "edited": false, "score": 0, "creation_date": 1492065857, "post_id": 43367940, "comment_id": 73832014, "body": "Your&#39;e right. I simplified it a bit too much. In the real thing It would do something when all expected bytes are in, and also make the idx variable back to zero."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5506984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3790e63edf14b2f538cf9bd1ea4705a?s=128&d=identicon&r=PG&f=1", "display_name": "Hneel", "link": "https://stackoverflow.com/users/5506984/hneel"}, "edited": false, "score": 0, "creation_date": 1492001284, "post_id": 43368796, "comment_id": 73801643, "body": "Thanks. This looks like a neat solution. Although I still don&#39;t like the fixed value of 3, but there might not be another way.  Another thing though: in my C code the next step would be something like addr_t* ptr = (addr_t*) buffer;  Then I would have a handy structure to work with, which will be automatically filled, without having to assign each of its members separately."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 75, "user_id": 5506984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3790e63edf14b2f538cf9bd1ea4705a?s=128&d=identicon&r=PG&f=1", "display_name": "Hneel", "link": "https://stackoverflow.com/users/5506984/hneel"}, "edited": false, "score": 0, "creation_date": 1492003758, "post_id": 43368796, "comment_id": 73803692, "body": "I thought that might be the next step, but it&#39;s quite a bad way to do it. You&#39;re trusting that the endianness of your machine is the same as the protocol."}], "tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 0, "last_activity_date": 1492005033, "last_edit_date": 1492005033, "creation_date": 1491998025, "answer_id": 43368796, "question_id": 43367940, "link": "https://stackoverflow.com/questions/43367940/can-a-packed-c-structure-and-function-be-ported-to-java/43368796#43368796", "title": "Can a packed C structure and function be ported to java?", "body": "<p>Your C code has its problems too. Technically, you do not know how big a <code>char</code> and a <code>short</code> is. You probably want <code>uint8_t</code> and <code>uint16_t</code> respectively. Also, I'm not sure how portable packing is. </p>\n\n<p>In Java, you need a class. The class might as well tell you how many bytes you need to initialise it.</p>\n\n<pre><code>class Addr\n{\n    private byte foo;\n    private short bar;\n    public final static int bufferBytes = 3;\n\n    public int getUnsignedFoo()\n    {\n        return (int)foo &amp; 0xff;\n    }\n    public int getUnsignedBar()\n    {\n        return (int)bar &amp; 0xffff;\n    }\n}\n</code></pre>\n\n<p>Probably a class for the buffer too although there may already be a suitable class in the standard library.</p>\n\n<pre><code>class Buffer\n{\n    private final static int maxSize = 20;\n\n    private byte[] bytes = new byte[maxSize];\n    private int idx = 0;\n    private bool rxData(byte b)\n    {\n        bytes[idx++] = b;\n        return idx == Addr.bufferBytes;\n    }\n}\n</code></pre>\n\n<p>To answer the question about the hardcodedness of the 3, this is actually the better way to do it because your the specification of your protocol should say \"one byte for foo and two bytes for bar\" not \"a packed C struct with a char and a short in it\". One way to deserialise the buffer is like this:</p>\n\n<pre><code> public class Addr\n {\n     // All the stuff from above\n     public Addr(byte[] buffer)\n     {\n         foo = buffer[0];\n         bar = someFunctionThatGetsTheEndiannessRight(buffer[1], buffer[2]);\n     }\n }\n</code></pre>\n\n<p>TI have left the way bar is calculated deliberately vague because it depends on your platform as much as anything. You can do it simply with bit shifts e.g.</p>\n\n<pre><code>    (((short)buffer[1] &amp; 0xff) &lt;&lt; 8) | ((short)buffer[2] &amp; 0xff)\n</code></pre>\n\n<p>However, there are better options available. For example, you can use a <a href=\"https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html\" rel=\"nofollow noreferrer\">java.nio.ByteBuffer</a> which has the machinery to cope with endian isssues.</p>\n"}], "owner": {"reputation": 75, "user_id": 5506984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3790e63edf14b2f538cf9bd1ea4705a?s=128&d=identicon&r=PG&f=1", "display_name": "Hneel", "link": "https://stackoverflow.com/users/5506984/hneel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 43368796, "answer_count": 1, "score": 0, "last_activity_date": 1492005033, "creation_date": 1491995496, "last_edit_date": 1491996646, "question_id": 43367940, "link": "https://stackoverflow.com/questions/43367940/can-a-packed-c-structure-and-function-be-ported-to-java", "title": "Can a packed C structure and function be ported to java?", "body": "<p>In the past I have written code which handles incoming data from a serial port. The data has a fixed format. \nNow I want to migrate this code to java (android). However, I see many obstacles.</p>\n\n<p>The actual code is more complex, but I have a simplified version here:</p>\n\n<pre><code>#define byte unsigned char\n#define word unsigned short\n\n#pragma pack(1);\nstruct addr_t\n{\n  byte foo;\n  word bar;\n};\n#pragma pack();\n\n\nbool RxData( byte val )\n{\n  static byte buffer[20];\n  static int  idx = 0;\n\n  buffer[idx++] = val;\n\n  return ( idx == sizeof(addr_t) );\n}  \n</code></pre>\n\n<p>The RxData function is called everytime a byte is received. When the complete chunk of data is in, it returns true.</p>\n\n<p>Some of the obstacles:</p>\n\n<p>The used data types are not available to java. In other threads it is recommended to use larger datatypes, but in this case this is not a workable solution. </p>\n\n<p>The size of the structure is in this case exactly 3 bytes. That's also why the #pragma statement is important. Otherwise the C compiler might \"optimize\" it for memory use, with a different size as a result. </p>\n\n<p>Java also doesn't have a sizeof function and I have found no alternative for this kind of situation. </p>\n\n<p>I could replace the 'sizeof' with a fixed value of 3, but that would be very bad practice IMO. </p>\n\n<p>Is it at all possible to write such a code in java? Or is it wiser to try to add native c source into Android Studio?</p>\n"}, {"tags": ["c", "glib"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1491994841, "post_id": 43367597, "comment_id": 73797041, "body": "Show the definition of <code>janus_audiobridge_sync_endpoint_response</code>; and possibly a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1491994977, "post_id": 43367597, "comment_id": 73797158, "body": "@Evert Hey Evert! I updated my question."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1491995078, "post_id": 43367597, "comment_id": 73797246, "body": "So, if you place a breakpoint on <code>goto plugin_response</code>, <code>response-&gt;error_cause</code> is null right there?"}, {"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1491995147, "post_id": 43367597, "comment_id": 73797297, "body": "When i try to LOG the <code>response-&gt;error_cause</code> right under the <code>g_snprintf(response...</code> line. Its null."}], "answers": [{"comments": [{"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1491995205, "post_id": 43367810, "comment_id": 73797348, "body": "I don&#39;t think i understand. Why does it work in the first example then? And what is the solution?"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1491995383, "post_id": 43367810, "comment_id": 73797480, "body": "@IvRRimUm: it works by accident the first time, the pointer is not pointing to an allocated buffer."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1491995426, "post_id": 43367810, "comment_id": 73797509, "body": "@IvRRimUm It doesn&#39;t &quot;work&quot;, it just fails to fail in a manner that you notice. Undefined behavior is undefined, it might do the exact thing you expect but still be wrong."}, {"owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1491995534, "post_id": 43367810, "comment_id": 73797578, "body": "Another question. Why do i have to allocate memory in one case and not in the direct assignment?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "edited": false, "score": 0, "creation_date": 1491995659, "post_id": 43367810, "comment_id": 73797675, "body": "@IvRRimUm I did cover that, see the final paragraph."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 3, "last_activity_date": 1491995445, "last_edit_date": 1491995445, "creation_date": 1491995127, "answer_id": 43367810, "question_id": 43367597, "link": "https://stackoverflow.com/questions/43367597/c-g-snprintf-works-in-one-scenario-but-not-in-another/43367810#43367810", "title": "C - g_snprintf works in one scenario but not in another", "body": "<p>It's clear from the declaration that <code>error_cause</code> is just a pointer, not an array.</p>\n\n<p>So it won't point at anything valid when you allocate (and clear) an instance of <code>janus_audiobridge_sync_endpoint_response</code>. Thus you get undefined behavior.</p>\n\n<p>To fix this, you need to allocate room for the string. In glib-land, you can use the nice <a href=\"https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-strdup-printf\" rel=\"nofollow noreferrer\"><code>g_strdup_printf()</code></a> function for this:</p>\n\n<pre><code>response-&gt;error_cause = g_strdup_printf(\"%s - %s\", \"Failed to find about page with locale - \", \"foo\", locale_text);\n</code></pre>\n\n<p>Note that I added a <code>foo</code> to that call, your original code seems to fail to provide the proper number of arguments considering the format string, which (again!) gives you undefined behavior.</p>\n\n<p>Doing e.g. <code>error_cause = \"hello\";</code> is always kind of safe, since that just sets the pointer in the struct to point at a static array somewhere in memory, it doesn't copy any characters. The only risk with that is that since the pointer in the struct is not <code>const</code>, somebody might try to modify the string which again would bring undefined behavior.</p>\n"}], "owner": {"reputation": 1506, "user_id": 2831700, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5e40a909ecdd6e94a32e120c0044ac9d?s=128&d=identicon&r=PG", "display_name": "IvRRimUm", "link": "https://stackoverflow.com/users/2831700/ivrrimum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 43367810, "answer_count": 1, "score": 0, "last_activity_date": 1491995445, "creation_date": 1491994509, "last_edit_date": 1491994883, "question_id": 43367597, "link": "https://stackoverflow.com/questions/43367597/c-g-snprintf-works-in-one-scenario-but-not-in-another", "title": "C - g_snprintf works in one scenario but not in another", "body": "<p>Pretty simple situation.</p>\n\n<p>I have a <code>response</code> pointer to struct and i want to populate its values.</p>\n\n<p>In one palce it's working:</p>\n\n<pre><code>janus_audiobridge_sync_endpoint_response *response = g_malloc0(sizeof(janus_audiobridge_sync_endpoint_response));\nresponse-&gt;error_code = JANUS_AUDIOBRIDGE_ERROR_UNKNOWN_ERROR;\ng_snprintf(response-&gt;error_cause, 512, \"%s - %s\", \"Failed to find about page with locale - \", locale_text);\nreturn response;\n</code></pre>\n\n<p>However when i do basicly the same thing another method, the <code>response-&gt;error_cause</code> turns out to be <code>null</code>:</p>\n\n<pre><code>janus_audiobridge_sync_endpoint_response *response = g_malloc0(sizeof(janus_audiobridge_sync_endpoint_response));\nresponse-&gt;error_code = 0;\nresponse-&gt;error_code = JANUS_AUDIOBRIDGE_ERROR_UNAUTHORIZED;\ng_snprintf(response-&gt;error_cause, 512, \"You need to pass a valid user_secret, before you continue.\");\ngoto plugin_response;\n</code></pre>\n\n<p>My question: Why does it work in one context and not another? What is the best Practive in C, to do this kind of stuff?</p>\n\n<p>Thanks!</p>\n\n<p><strong>EDIT:</strong> And even weirder is that when i do:</p>\n\n<pre><code>response-&gt;error_cause = \"You need to pass a valid user_secret, before you continue.\";\n</code></pre>\n\n<p>It works on the second example, why is that?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As requested:</p>\n\n<pre><code>typedef struct janus_audiobridge_sync_endpoint_response {\n    gint error_code;\n    gchar *error_cause;\n    json_t *message;\n} janus_audiobridge_sync_endpoint_response;\n</code></pre>\n"}, {"tags": ["c", "mpi"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 2, "last_activity_date": 1492082066, "last_edit_date": 1492082066, "creation_date": 1491996813, "answer_id": 43368377, "question_id": 43367479, "link": "https://stackoverflow.com/questions/43367479/mpi-communicator-mpi-comm-split-without-groups/43368377#43368377", "title": "MPI Communicator MPI_Comm_split without Groups", "body": "<p>You are basically asking whether it makes sense to use <code>MPI_Comm_split</code> without having different groups. No it does not. It doesn't provide any benefits or make any sense.</p>\n\n<p>It can be useful to use separate communicators of the same group for two reasons:</p>\n\n<ul>\n<li>Have private communicators for different modules in the application that may have overlapping tags. That way, you ensure that there is no mismatching. For this case, use <code>MPI_Comm_dup</code>.</li>\n<li>Use topologies. In that case, use the appropriate constructor e.g. <code>MPI_Cart_create</code>.</li>\n</ul>\n\n<p>There may be some overhead in creating excess communicators. Further you may lose specific optimizations for <code>MPI_COMM_WORLD</code>. That shouldn't stop you from using communicators when it makes sense.</p>\n"}], "owner": {"reputation": 63, "user_id": 1528675, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/79cd9faa95078564c6654fa08c240116?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1528675/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 43368377, "answer_count": 1, "score": 0, "last_activity_date": 1492082066, "creation_date": 1491994236, "last_edit_date": 1495535454, "question_id": 43367479, "link": "https://stackoverflow.com/questions/43367479/mpi-communicator-mpi-comm-split-without-groups", "title": "MPI Communicator MPI_Comm_split without Groups", "body": "<p>I'm learning about MPI using C in class. I'm currently trying to get my head around when you'd use <code>MPI_Comm_split</code> and what the advantages are. I'm also trying to figure out if there are any benefits of using this over just using <code>MPI_COMM_WORLD</code> if I don't use groups or if all my processes are in one group.</p>\n\n<p>From what I understand, <code>MPI_Comm_split</code> provides a unique communicator to each 'color' which is different from using <code>MPI_COMM_WORLD</code> (not sure if this last part is correct). MPI groups are a set of processes and communicators help you to communicate within and between these groups. </p>\n\n<p>I was looking at the comment on <a href=\"https://stackoverflow.com/questions/32468876/can-anyone-help-me-understand-how-mpi-communicator-groups-partitioning-works\">this question</a> </p>\n\n<blockquote>\n  <p>For example, given a shape e.g. square, the program splits\n  MPI_COMM_WORLD into two groups grpArea and grpPerimeter which compute\n  the area and perimeter of the given shape. These groups should do\n  their private computations and return result to root(rank 0) of\n  MPI_COMM_WORLD.</p>\n</blockquote>\n\n<p>Let's say that instead of calculating the area and perimeter, we only calculated the area and so we don't use groups. Would there be any point in splitting the communicators using <code>MPI_Comm_split</code> so that each processor has its own communicator? Are there any benefits or drawbacks of doing so?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 6, "creation_date": 1491994272, "post_id": 43367476, "comment_id": 73796601, "body": "Do you know what <a href=\"https://en.wikipedia.org/wiki/Rounding\" rel=\"nofollow noreferrer\">rounding</a> is?"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 3, "last_activity_date": 1491994888, "last_edit_date": 1495540445, "creation_date": 1491994888, "answer_id": 43367734, "question_id": 43367476, "link": "https://stackoverflow.com/questions/43367476/what-is-wrong-with-c-conversion-character-8f/43367734#43367734", "title": "What is wrong with C conversion character %.8f ?", "body": "<p>It seems that you expect the specifier <code>\"%.8f\"</code> to truncate the number at the 8th digit after decimal point. The precision specifier does, however, not truncate digits but rounds the number as stated in this <a href=\"https://stackoverflow.com/a/24120950/2630032\">SO answer</a> (please upvote this reference if applicable):</p>\n\n<blockquote>\n  <p><strong>C99 \u00a77.19.6.1 The fprintf function; f,F</strong></p>\n  \n  <p>A double argument representing a floating-point number is converted to\n  decimal notation in the style [\u2212]ddd.ddd, where the number of digits\n  after the decimal-point character is equal to the precision\n  specification. If the precision is missing, it is taken as 6; if the\n  precision is zero and the # flag is not specified, no decimal-point\n  character appears. If a decimal-point character appears, at least one\n  digit appears before it. <strong>The value is rounded to the appropriate\n  number of digits.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 7855988, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6DkXoijeI9M/AAAAAAAAAAI/AAAAAAAAATE/bufyxvqTsgM/photo.jpg?sz=128", "display_name": "Technical People", "link": "https://stackoverflow.com/users/7855988/technical-people"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1492012099, "accepted_answer_id": 43367734, "answer_count": 1, "score": 0, "last_activity_date": 1491994888, "creation_date": 1491994234, "question_id": 43367476, "link": "https://stackoverflow.com/questions/43367476/what-is-wrong-with-c-conversion-character-8f", "closed_reason": "Duplicate", "title": "What is wrong with C conversion character %.8f ?", "body": "<p>when I try this code </p>\n\n<pre><code>printf(\"something %.8f\",1.123456789);\n</code></pre>\n\n<p>It Gives This Result</p>\n\n<pre><code>1.12345679 \n</code></pre>\n\n<p>There Is No 8 Why Is This</p>\n"}, {"tags": ["c", "arrays", "pointers", "realloc"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1491994734, "post_id": 43367449, "comment_id": 73796965, "body": "<code>Is there an elegant way to detect &quot;out-of-array-bounds&quot; but &quot;inside-allocated-memory-by-the-whole-program&quot;</code> Short answer :no."}, {"owner": {"reputation": 360, "user_id": 3492498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b22bd84245bf80211b37cc5ccf73def?s=128&d=identicon&r=PG&f=1", "display_name": "Nish", "link": "https://stackoverflow.com/users/3492498/nish"}, "edited": false, "score": 0, "creation_date": 1491994919, "post_id": 43367449, "comment_id": 73797104, "body": "NO. otherwise there is no need to create efence"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1491996077, "post_id": 43367449, "comment_id": 73797976, "body": "Can&#39;t you compile and run it on intel with valgrind for debugging purposes?"}, {"owner": {"reputation": 416, "user_id": 2087442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wTVoi.jpg?s=128&g=1", "display_name": "MrD", "link": "https://stackoverflow.com/users/2087442/mrd"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1491997070, "post_id": 43367449, "comment_id": 73798683, "body": "@Ctx The error does not seem to show up on x86_64 hardware"}], "owner": {"reputation": 416, "user_id": 2087442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wTVoi.jpg?s=128&g=1", "display_name": "MrD", "link": "https://stackoverflow.com/users/2087442/mrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491994159, "creation_date": 1491994159, "question_id": 43367449, "link": "https://stackoverflow.com/questions/43367449/detect-out-of-designated-usage-accessing-other-arrays-memory-in-c", "title": "Detect &quot;out-of-designated-usage&quot; (accessing other arrays memory) in C", "body": "<p>On ARM (Raspbian), I'm receiving <code>SIGABRT</code> with my application. From <code>gdb</code>'s backtrace I extract (mainly) the error message: <code>realloc(): invalid next size</code>.</p>\n\n<p>The data structure of the program is quite complicated, but may be understood (very simplified) as several arrays of structs (members with different types) allocated directly one after another (and later dynamically resized on demand using <code>realloc()</code>).</p>\n\n<p>I think (correct me if you think I'm mistaken) that the error comes due to the fact that a part of the code is writing out of bounds of one of the arrays. However, by chance, the memory it writes to is allocated <strong>for a different</strong> array. Hence, the code does not receive <code>SIGSEGV</code>.</p>\n\n<p><code>array1</code> has been allocated to have 1000 members.\n<code>array2</code> has been allocated directly afterwards to also hold 1000 members.</p>\n\n<p>Using <code>gdb</code>, I can do the following:</p>\n\n<pre><code>(gdb) print array1[999]\n$1 = {count = 0, blockedcount = 0, domain = 0x0, wildcard = false}\n(gdb) print array1[1000]\n$2 = {count = 0, blockedcount = 249, domain = 0x166 &lt;error: Cannot access memory at address 0x166&gt;, wildcard = 32}\n(gdb) print array1[1001]\n$10 = {count = 1420597384, blockedcount = 1015, domain = 0x54acf6a0 \"192.168.2.157\", wildcard = 200}\n</code></pre>\n\n<p>As can be seen, the array can be accessed at <code>1000</code> and beyond, although this memory was <strong>never</strong> allocated for <code>array1</code>, but for <code>array2</code> (having slightly different internal data types):</p>\n\n<pre><code>(gdb) print &amp;array1[999]\n$3 = (array1DataStruct *) 0x54acf170\n(gdb) print &amp;array1[1000]\n$4 = (array1DataStruct *) 0x54acf180\n(gdb) print &amp;array2[0]\n$5 = (array2DataStruct *) 0x54acf188\n(gdb) print &amp;array1[1001]\n$6 = (array1DataStruct *) 0x54acf190\n</code></pre>\n\n<p>to see that through too large indices of <code>array1</code> I can (foolishly) access memory in <code>array2</code>.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there an elegant way to detect \"out-of-array-bounds\" but \"inside-allocated-memory-by-the-whole-program\" accesses error using some simple measure (like a compiler flag like <code>-fsanitize=address</code>)?</p>\n\n<p>Unfortunately, it seems like <code>valgrind</code> isn't capable of doing proper analysis on ARMv6 hardware:</p>\n\n<pre><code>disInstr(arm): unhandled instruction: 0xF1010200\n                 cond=15(0xF) 27:20=16(0x10) 4:4=0 3:0=0(0x0)\n==6318== valgrind: Unrecognised instruction at address 0x48426f4.\n==6318==    at 0x48426F4: ??? (in /usr/lib/arm-linux-gnueabihf/libarmmem.so)\n==6318== Your program just tried to execute an instruction that Valgrind\n==6318== did not recognise.  There are two possible reasons for this.\n==6318== 1. Your program has a bug and erroneously jumped to a non-code\n==6318==    location.  If you are running Memcheck and you just saw a\n==6318==    warning about a bad jump, it's probably your program's fault.\n==6318== 2. The instruction is legitimate but Valgrind doesn't handle it,\n==6318==    i.e. it's Valgrind's fault.  If you think this is the case or\n==6318==    you are not sure, please let us know and we'll try to fix it.\n==6318== Either way, Valgrind will now raise a SIGILL signal which will\n==6318== probably kill your program.\n==6318== \n==6318== Process terminating with default action of signal 4 (SIGILL)\n==6318==  Illegal opcode at address 0x48426F4\n==6318==    at 0x48426F4: ??? (in /usr/lib/arm-linux-gnueabihf/libarmmem.so)\n</code></pre>\n"}, {"tags": ["c++", "c", "class", "data-structures"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491993825, "post_id": 43367249, "comment_id": 73796286, "body": "What&#39;s &quot;ANSI-C&quot;? C90 or standard C?"}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491994114, "post_id": 43367249, "comment_id": 73796493, "body": "@Lundin: In this case, <a href=\"http://www.bellard.org/tcc/tcc-doc.html#SEC7\" rel=\"nofollow noreferrer\">Tiny C Compiler</a>, call parameters under my control, so C99 and GNU C extensions are available although not used currently; otherwise, &quot;TCC implements all the ANSI C standard, including structure bit fields and floating point numbers (long double, double, and float fully supported).&quot;"}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1491994685, "post_id": 43367249, "comment_id": 73796917, "body": "I&#39;m in a similar situation with the GSL library. Would RAII (resource allocation is initialization) work? This might be the cleanest way to wrap your code. However, it depends on how exactly your C structs are allocated and how much control you have over them (e.g. the shared memory constraint you briefly mention), and maybe you&#39;ve ruled this out. Your C++ class could always just contain a pointer to the C struct in shared memory. Can you provide more details?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491995638, "post_id": 43367249, "comment_id": 73797667, "body": "The question is what is the benefit of C++ here? Is the aim to port to C++ in the long term? Are there other libraries or GUI that need C++? If not, then simply stick to C. Otherwise, if there are real reasons to switch to C++, probably just write a wrapper class around the struct, and keep the struct as a public, exposed member."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491997970, "post_id": 43367249, "comment_id": 73799231, "body": "@Lundin: <code>frame.isValid()</code> vs <code>frame.type != VDV_FRAME_INVALID_TOKEN</code>, <code>if(frame1 == frame2)</code> vs <code>if(memcmp(&amp;frame1, &amp;frame2, sizeof(frame1) == 0)</code>, <code>frame.cmd = x; frame.adr = y; frame.send()</code> vs <code>frame.id = framehandler::convert_to_id(x,y); interface::Instance()-&gt;send(frame);</code> and many such. Being a smart object instead of a (complex but dumb) data structure is a big benefit."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491998811, "post_id": 43367249, "comment_id": 73799803, "body": "@SF. Function pointers have been in the C language since the beginning. No need to call your struct dumb just because you don&#39;t know of them. Nothing in C would prevent you to encapsulate the original struct then use function pointers to get identical syntax. If you want polymorphism then function pointers are preferred. Though traditional C would probably rather use &quot;ADT member functions&quot;: <code>frame_is_valid(frame)</code>, <code>frame_is_equal(frame1, frame2)</code> and so on.  What you can&#39;t get in C is RAII behavior out of constructors/destructors, otherwise it is quite similar to C++."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491999105, "post_id": 43367249, "comment_id": 73800024, "body": "@Lundin: Ever used C function pointers through a shared memory?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491999852, "post_id": 43367249, "comment_id": 73800612, "body": "@SF. As I said, you&#39;d write a wrapper."}], "answers": [{"comments": [{"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "edited": false, "score": 0, "creation_date": 1491994744, "post_id": 43367465, "comment_id": 73796973, "body": "I would add that this class that contains the struct could employ RAII (resource allocation is initialization), if that&#39;s possible for the OP&#39;s work case. I was in a similar situation recently, wrapping GSL&#39;s structs in C++ ... but unfortunately because of other constraints I&#39;ve had to use the <code>reinterpret_cast</code> trick as well, and it&#39;s been such a pain."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1491995059, "post_id": 43367465, "comment_id": 73797225, "body": "Business logic is in the C library, custom, per device - generated code; the user uses a friendly graphical application to create the business logic, which is then compiled to ANSI C, then that C is (cross-)compiled into the library using TCC and deployed on the device. We can&#39;t require the user to install a C++ cross-compiler (installing it and getting it to run is an hour for a skilled IT person, not a task for a common user), we&#39;re stuck with TCC which is easily bundled with the generator app, supports cross-compile to the target device but provides ANSI C only."}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1491995287, "post_id": 43367465, "comment_id": 73797403, "body": "@SF. What&#39;s the exact relationship between the C and C++ code? Are you saying that these are separate programs, compiled separately, accessing the same shared memory? In that case, how does the C++ get the the pointer to the shared memory - through a C API?"}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1491997313, "post_id": 43367465, "comment_id": 73798826, "body": "C++ generates the shared memory space, initializes it, and serves as interface between the whole world and the shared memory. It also performs cyclic calls of the C code library functions (which has no own thread/engine; just logic). The C code performs all the calculations/decisions basing on the (very broad) input, and produces (equally broad) output (stored in shared memory) which then the C++ app &quot;delivers to the world&quot;."}], "tags": [], "owner": {"reputation": 329, "user_id": 610605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52676a7f64a6723d917d6cc7be176ec8?s=128&d=identicon&r=PG", "display_name": "Paul Bentley", "link": "https://stackoverflow.com/users/610605/paul-bentley"}, "is_accepted": false, "score": 1, "last_activity_date": 1491994207, "creation_date": 1491994207, "answer_id": 43367465, "question_id": 43367249, "link": "https://stackoverflow.com/questions/43367249/how-to-turn-an-ansi-c-struct-into-a-c-class-but-keep-it-ansi-c-friendly/43367465#43367465", "title": "How to turn an ANSI C struct into a C++ class, but keep it ANSI C friendly?", "body": "<p>If you somehow subclass this, the base structure would need a vtable.  Can you change the struct to include these elements, and then cast it to/from the class/struct.  You'd need to use reinterpret_cast&lt;>().</p>\n\n<p>However that is a terrible idea.  Please do not do it.</p>\n\n<p>Instead, implement your business logic in a class, that contains the struct.  This way you won't need to support marshalling the structure between the two codebases, you can keep one copy of the struct.</p>\n\n<p>However remember to mark the struct as volatile, if it needs to be altered by any form of background thread that the C++ code is not aware of.</p>\n"}, {"comments": [{"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "edited": false, "score": 0, "creation_date": 1491999661, "post_id": 43367997, "comment_id": 73800469, "body": "This fails if your data structure is to be allocated in C-code."}, {"owner": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "reply_to_user": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "edited": false, "score": 0, "creation_date": 1492044319, "post_id": 43367997, "comment_id": 73825630, "body": "@Meixner that case could be avoid, if the allocate code is in c++ class."}], "tags": [], "owner": {"reputation": 1714, "user_id": 7404323, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jYEFn.png?s=128&g=1", "display_name": "sailfish009", "link": "https://stackoverflow.com/users/7404323/sailfish009"}, "is_accepted": false, "score": 0, "last_activity_date": 1491995668, "creation_date": 1491995668, "answer_id": 43367997, "question_id": 43367249, "link": "https://stackoverflow.com/questions/43367249/how-to-turn-an-ansi-c-struct-into-a-c-class-but-keep-it-ansi-c-friendly/43367997#43367997", "title": "How to turn an ANSI C struct into a C++ class, but keep it ANSI C friendly?", "body": "<p>simple, move your c struct to c++ PIMPL</p>\n\n<pre><code>// A.h\nclass A\n{\n //...\nprivate:\n struct impl;\n static std::unique_ptr&lt;impl&gt; p_impl;\n}\n\n// A.cpp\nstd::unique_ptr&lt;A::impl&gt;  A::p_impl;\n\nstruct A::impl\n{\n  // c code here\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1491999526, "post_id": 43369239, "comment_id": 73800371, "body": "It&#39;s much simpler: the shared memory doesn&#39;t ever store any pointers, just values. It&#39;s just an enormous, very complex <code>struct</code>. C++ holds it as a plain variable (which happens to be located over a shared memory fragment), and performs all operations as on normal variable. C holds it as a pointer to a variable of the same type, performs all operations just the same. There are no dynamic allocations (the hardware is always the same and must work in most pessimistic configuration variant, so there&#39;s no point in savings through dynamic allocations; shm is just the max size it can ever be.)"}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1491999834, "post_id": 43369239, "comment_id": 73800604, "body": "@SF. So it&#39;s one giant struct with dozens/hundreds/thousands of fields? Ok... but there&#39;s just one? You mentioned you wanted copy constructors and comparison operators, so I presumed you had multiple objects of the same type."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492000391, "post_id": 43369239, "comment_id": 73801002, "body": "One enormous struct, with about 5 fields for structs of varied classes of subsystems, each with a dozen or so structs for subsystems, these with static arrays of structs for input/output channels, and variables for configurations, and so on. This is the shared memory, only one instance of it ever, and with all writes and most reads synchronized. But outside it (in the C++ app) there are converters, parsers, queues, loggers, and so on and so on, which operate on copies of structures picked from the shared memory struct tree or create them (to prepare a write),"}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492000687, "post_id": 43369239, "comment_id": 73801191, "body": "...and I need these functions primarily for these - but maintaining two versions of every data type (or even some of them), one smart, and one dumb, would bothersome, so it would be great if the same &#39;smart&#39; type of data was a member of the shm super-struct and usable as independent instance."}], "tags": [], "owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "is_accepted": false, "score": 0, "last_activity_date": 1491999227, "creation_date": 1491999227, "answer_id": 43369239, "question_id": 43367249, "link": "https://stackoverflow.com/questions/43367249/how-to-turn-an-ansi-c-struct-into-a-c-class-but-keep-it-ansi-c-friendly/43369239#43369239", "title": "How to turn an ANSI C struct into a C++ class, but keep it ANSI C friendly?", "body": "<p>My understanding is that the C++ managing code allocates a block of shared memory, and the C and C++ code coordinate what type of information will be written where. The C++ manager periodically examines locations in memory, knowing what type of data it expects to find. I imagine then that the C++ code has a table of <code>void*</code> pointers to <code>your_c_struct*</code> pointers to examine. In the former case, these can always be converted as necessary via <code>reinterpret_cast&lt;your_c_struct*&gt;(void_ptr)</code>. So, I'll assume that the C++ code has a table of pointers to C structs in shared memory. In that case I think a solution is to create a pseudo-RAII class, which can either point to un-owned locations in shared memory <em>or</em> own and allocate/deallocate memory on the heap. This would look something like:</p>\n\n<pre><code>class Wrapper {\npublic:\n    Wrapper() : owned(true), data(new your_c_struct{}) {}\n    Wrapper(your_c_struct* _data) : owned(false), data(_data) {}\n    ~Wrapper() {\n        if (owned)\n            delete data;\n    }\n\n    // copy constructors\n    // overloaded comparison operators\n\nprivate:\n    bool owned;\n    your_c_struct* data;\n};\n</code></pre>\n\n<p>There are two main ways to construct this class: either making a new object on the heap or passing it a pointer to shared memory that it does not own. I've used this technique for the GSL library successfully, where the equivalent of C structs in shared memory are C structs allocated within and returned by GSL numerical algorithms. I went a further step of making the second constructor provide and providing a named constructor <code>Wrapper Wrapper::SoftWrap(your_c_struct* _data)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1491999860, "post_id": 43369358, "comment_id": 73800616, "body": "This would work. How should I access the instance of the &quot;C-struct - as - Class&quot; though? Create pointer to Class, reinterpret_cast&lt;&gt; the pointer to struct?"}, {"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 2, "creation_date": 1492000364, "post_id": 43369358, "comment_id": 73800980, "body": "Using a pointer would be one option. The other would be to use a reference, e.g. YourClass &amp;cxx=reinterpret_cast&lt;YourClass &amp;&gt;(c)."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492000903, "post_id": 43369358, "comment_id": 73801344, "body": "It seems like a very nice option but I&#39;ll wait for input of others... May be just me, but reinterpretation of the underlying object like that feels a little... <i>precarious</i>. Also, if I do need some more member variables after all (say, to hold some file handles or pointers, e.g. to reader/writer), is there some trick to get them?"}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492001176, "post_id": 43369358, "comment_id": 73801557, "body": "@SF. If you do need extra member variables, you can create a struct <code>struct containing_struct { &#47;&#47; extra data members };</code> and another <code>struct isomorphic_struct : containing_struct { &#47;&#47; identical to C struct }</code>. Then given the containing struct, you can <code>static_cast</code> it to the <code>isomorphic_struct</code> and then <code>reinterpret_cast</code> it as your C struct, if need be (or some combination of these techniques). This keeps the struct in standard layout."}, {"owner": {"reputation": 1568, "user_id": 5526072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588896494e8fd23bb0092474a5cf958d?s=128&d=identicon&r=PG", "display_name": "jwimberley", "link": "https://stackoverflow.com/users/5526072/jwimberley"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492001456, "post_id": 43369358, "comment_id": 73801799, "body": "@SF. Or, you can just put the extra members at the end, and <code>reinterpret_cast</code> the address of the struct."}, {"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "edited": false, "score": 0, "creation_date": 1492001570, "post_id": 43369358, "comment_id": 73801895, "body": "You can add member variables in the derived class but then you are no longer able to allocate this struct/class from within C code, since the allocation would lack the added member variables."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492002435, "post_id": 43369358, "comment_id": 73802622, "body": "@Meixner: Allocation is in C++, but if it&#39;s a member of a different struct (it is), the consecutive fields of the parent on the C side will be mismatched. OTOH I suspect I could (ab)use static variables in methods as static members, say, a method containing a (local, static) file handle and returning a reference to it. (I will hardly ever need custom per-instance members.)"}, {"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492009749, "post_id": 43369358, "comment_id": 73808838, "body": "@SF: If the C++ class has been derived from the C struct, the consecutive fields match. BTW there is no need to cast to the base class (the C struct), i.e.  explicit cast operations like static_cast&lt;&gt; or the like are not required. This is handled by C++ automatically. An explicit cast is only required for the opposite direction and since these are related types static_cast&lt;&gt; is sufficient and reinterpret_cast&lt;&gt; is not required."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492011849, "post_id": 43369358, "comment_id": 73810496, "body": "@Meixner: Not sure if we&#39;re talking about the same thing. C++ instantiates <code>super_struct { smart_class X; int Y }</code>. C acquires access to the instance (in shm) as <code>super_struct { dumb_struct X; int Y }</code>. If <code>smart_class</code> derived from <code>dumb_struct</code> is larger (has extra member variables at the end), Y will be misaligned."}, {"owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492064914, "post_id": 43369358, "comment_id": 73831513, "body": "@SF: In this case we are no longer talking about inheritance only. This is a different situation and has nothing to do with compatibility between C and C++."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1492068534, "post_id": 43369358, "comment_id": 73833565, "body": "@Meixner: it has everything to do with compatibility... just fails at it. My current situation is <code>super_struct { dumb_struct X; int Y }</code> on both sides, and if I understand correctly, casting reference to the <code>dumb_struct</code> member into reference to <code>smart_class</code> solves my problem - as long as all the data members match 1:1, no extras at the end."}], "tags": [], "owner": {"reputation": 517, "user_id": 4782519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3fa52fd7fe4d43019523fb87a2e7274?s=128&d=identicon&r=PG&f=1", "display_name": "Meixner", "link": "https://stackoverflow.com/users/4782519/meixner"}, "is_accepted": true, "score": 2, "last_activity_date": 1492001899, "last_edit_date": 1492001899, "creation_date": 1491999598, "answer_id": 43369358, "question_id": 43367249, "link": "https://stackoverflow.com/questions/43367249/how-to-turn-an-ansi-c-struct-into-a-c-class-but-keep-it-ansi-c-friendly/43369358#43369358", "title": "How to turn an ANSI C struct into a C++ class, but keep it ANSI C friendly?", "body": "<p>Create a class that is derived from the C-struct but make sure that the memory layout stays untouched, i.e. do not use virtual methods (these would add a vtable) or add member variables. In C++11 terms this would be called a standard-layout class. For more information see here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/4178175/what-are-aggregates-and-pods-and-how-why-are-they-special/7189821#7189821\">What are Aggregates and PODs and how/why are they special?</a></p>\n\n<p>Obeying this rule you can safely cast between the C struct and C++ class and use the appropriate member functions.</p>\n\n<p>Note: Regarding allocating the data structure you need to use the same set of functions for release as for allocation, i.e. if it has been allocated using malloc(), it must be released using free() and if it has been allocated using new it must be released using delete. Therefore, if you want to allocate objects both from within C and C++ code, you are limited to malloc/free since new/delete is not available from within C.</p>\n"}], "owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 43369358, "answer_count": 4, "score": 0, "last_activity_date": 1492001899, "creation_date": 1491993583, "last_edit_date": 1491997120, "question_id": 43367249, "link": "https://stackoverflow.com/questions/43367249/how-to-turn-an-ansi-c-struct-into-a-c-class-but-keep-it-ansi-c-friendly", "title": "How to turn an ANSI C struct into a C++ class, but keep it ANSI C friendly?", "body": "<p>A frame read out from external device is stored in shared memory (in a struct), to be used both by main (C++) application, and an ANSI C library.</p>\n\n<p>For reasons a bit too broad to explain here the library must remain pure ANSI C, and must retain access to the structure in its \"pure ANSI C\" form. But the main application uses the data in a lot of places, and it's a nuisance to do this the \"ANSI C\" way, treating it as a dumb data container. It would be much nicer if it was a class - if I could add constructors, copy constructor, comparison operators, a neater 'is valid' method (currently checked as absence of a magic number in one of the struct fields), generally a lot of stuff that a C++ class can do, but an ANSI C struct can't. Except if I replace the struct with the class in the shared memory, it will break compatibility with the library.</p>\n\n<p>What's a neat way to achieve this? Create a class that inherits from the struct? Inheritance through composition? A separate class with a set of conversion methods? Something else I didn't think about? Some transparent way to keep the data visible to C unchanged, but enhanced with class features for C++?</p>\n\n<p>Note: both C++ and C operate on the same <em>instance</em> of the structure. Main app reads out the frame out of the device, writes to the structure in shared memory, then calls the library functions to do their magic on the frame (possibly, but not necessarily modifying it; business logic), then performs own operations on it (display, logging, re-broadcasting on other media etc. </p>\n\n<p>I have full control over the C++ code, but C code is <em>mostly</em> out of my control; I can create a local copy of the structure, if that's beneficial, but my copy and the 'business logic instance' should remain in sync, or at least be synced before and after each library function call (operation under my control, but timing dictated by system requirements.)</p>\n\n<p>edit: \nsome extra details, as requested:</p>\n\n<ul>\n<li><p>the \"business logic\" is implemented in the C library, customized C code generated by an external application (for PC) from input from user (graphical interface for drafting the logic; think \"block diagram\"), varies per device (many users, even more devices). The device requires cross-compiling; only an ANSI C cross-compiler is available in a form that can be easily bundled with the PC application; C++ cross-compiler is available only on the system developer's (my) PCs ; its installation process and license make it impossible to bundle with the (sold) generator app.</p></li>\n<li><p>the library and the C++ application on the device use shared memory as storage of about all input and output data, for two reasons:</p>\n\n<ul>\n<li>primarily because the volume and variety of that data would make it extremely difficult to provide it as parameters in function calls (over 20 wildly varying external systems the device can cooperate with, each with own communication protocol, each providing inputs and/or accepting outputs which may be utilized in business logic). C++ app handles all communication and converts the data back and forth between the various interfaces and an \"easily digestible\" data format stored in the shared memory for consumption by the library as required (by the particular instance of business logic). </li>\n<li>But there are other applications running on the device - a WWW server, a debug app, etc - which can peer into the shared memory too, to display current state, allow real-time parameter tweaks etc. While such \"centralized storage\"/\"superglobal\" may be considered an anti-pattern, considering the wild variety of interactions between the systems (internal, and external, where the C++ serves as a central hub for connecting them) and makes for a much clearer structure than what kind of byzantine web would arise if I tried to connect every data provider with every data consumer directly. </li>\n</ul></li>\n<li>The main app handles synchronization (timing, locking) reads from shared memory for all interfaces where it matters; others can just peer into the shared memory and pick what they need whenever they want (read-only); resulting race condition errors will result in a perfectly acceptable momentary glitch that will be corrected come next 'tick'. All writes are synchronized.</li>\n<li>because the C library is the primary, most important consumer and provider for the shared memory, the structure in shared memory must remain C compatible.</li>\n</ul>\n"}, {"tags": ["c", "eclipse", "debugging", "gdb", "eclipse-cdt"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user184968"}, "edited": false, "score": 2, "creation_date": 1491995011, "post_id": 43367191, "comment_id": 73797184, "body": "If the variable indeed has been optimized out you won&#39;t be able to get its value even under pure <code>gdb</code>.  Do you build your program without optimization (like gcc -O2 flag)?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1492021762, "post_id": 43367191, "comment_id": 73816180, "body": "In Project-&gt;Properties-&gt;C/C++ Build-&gt;Settings-&gt;GCC C Compiler-&gt;Optimization, what optimization level and flags are configured?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1492022680, "post_id": 43367191, "comment_id": 73816711, "body": "In Project-&gt;Build Configurations-&gt;Set Active, are you building a Debug version or a Release version? They use different optimization options by default."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user184968"}, "edited": false, "score": 0, "creation_date": 1491999362, "post_id": 43368558, "comment_id": 73800235, "body": "This is not true. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html</a>: <code>-O0 -- Reduce compilation time and make debugging produce the expected results. This is the default.</code>"}], "tags": [], "owner": {"reputation": 8504, "user_id": 1391924, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nmIlx.jpg?s=128&g=1", "display_name": "Chandrayya G K", "link": "https://stackoverflow.com/users/1391924/chandrayya-g-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1491997334, "creation_date": 1491997334, "answer_id": 43368558, "question_id": 43367191, "link": "https://stackoverflow.com/questions/43367191/gdb-debug-using-eclipse-cdt-not-able-to-show-correctly-varibles-values/43368558#43368558", "title": "gdb debug using eclipse CDT: not able to show correctly varibles values", "body": "<p>Make sure you compiled your code with -g and -O0 options. By default compiler not uses -O0.</p>\n"}], "owner": {"reputation": 1108, "user_id": 1934741, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9fcef56e9894bc4ef3c2ee71921ef6a?s=128&d=identicon&r=PG", "display_name": "Kallel Omar", "link": "https://stackoverflow.com/users/1934741/kallel-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491997334, "creation_date": 1491993445, "question_id": 43367191, "link": "https://stackoverflow.com/questions/43367191/gdb-debug-using-eclipse-cdt-not-able-to-show-correctly-varibles-values", "title": "gdb debug using eclipse CDT: not able to show correctly varibles values", "body": "<p>I'm debugging a C application using eclipse CDT. Generally I can go up in breakpoints and also step by step. But the problem is that I have problem to see the variable in steps. But if I want to see the content of a char** variable called path_list, I see in the variables window this error:</p>\n\n<pre><code>Failed to execute MI command:\n-data-evaluate-expression *(*(path_list))\nError message from debugger back end: \nvalue has been optimized out\n</code></pre>\n\n<p>So I tried to see the memory content of the variable path_list but I got an error popup:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8QsUT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8QsUT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Has someone an idea about this problem and how I can see the content of path_list?</p>\n"}, {"tags": ["c", "csv"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1491992552, "post_id": 43366806, "comment_id": 73795267, "body": "Too broad as stated. Show us your efforts, we will try to help you on problems..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491992668, "post_id": 43366806, "comment_id": 73795361, "body": "<a href=\"http://stackoverflow.com/questions/12911299/read-csv-file-in-c\">This SO question</a> can give you a hand."}, {"owner": {"reputation": 1699, "user_id": 4891815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/niZw9.jpg?s=128&g=1", "display_name": "Gnqz", "link": "https://stackoverflow.com/users/4891815/gnqz"}, "edited": false, "score": 0, "creation_date": 1491992669, "post_id": 43366806, "comment_id": 73795365, "body": "What are you going to do with your structure?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1491992729, "post_id": 43366806, "comment_id": 73795416, "body": "Google is your friend."}, {"owner": {"reputation": 34174, "user_id": 65464, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1fc3a85db4ff7618a7639742f356b3b?s=128&d=identicon&r=PG", "display_name": "Erich Kitzmueller", "link": "https://stackoverflow.com/users/65464/erich-kitzmueller"}, "edited": false, "score": 1, "creation_date": 1491992748, "post_id": 43366806, "comment_id": 73795437, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14115529/parse-csv-file-in-c\">Parse CSV file in C</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491993610, "post_id": 43366933, "comment_id": 73796087, "body": "Ok, thank&#39;s! I was hoping there was a function like fget it couldn&#39;t returns me a char* but a generic void*."}, {"owner": {"reputation": 724, "user_id": 7438356, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3b94d667c9db8baa2b9ab57502b4a82?s=128&d=identicon&r=PG&f=1", "display_name": "RomMer", "link": "https://stackoverflow.com/users/7438356/rommer"}, "reply_to_user": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491993725, "post_id": 43366933, "comment_id": 73796204, "body": "then you can use read which takes a void * as buffer but it&#39;s, i think easiest, to use a simple char * depend of what you want to do then @EnricoArnaudo"}, {"owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491994526, "post_id": 43366933, "comment_id": 73796782, "body": "I would like to read the elements in csv, insert elements in the struct and then using sorting algorithm to ordered the struct."}, {"owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491996555, "post_id": 43366933, "comment_id": 73798302, "body": "In the sort algorithm my compare function is:                                                  typedef int (CompareFunction)(void, void); the function and the elem are pointer"}, {"owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491997080, "post_id": 43366933, "comment_id": 73798690, "body": "The read() functions returns the number of byte read, how can i use this in my case?"}, {"owner": {"reputation": 724, "user_id": 7438356, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3b94d667c9db8baa2b9ab57502b4a82?s=128&d=identicon&r=PG&f=1", "display_name": "RomMer", "link": "https://stackoverflow.com/users/7438356/rommer"}, "reply_to_user": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491997460, "post_id": 43366933, "comment_id": 73798929, "body": "@EnricoArnaudo it takes a pointer as second parameter, it&#39;s your buffer; read will write the data in this buffer"}, {"owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491998124, "post_id": 43366933, "comment_id": 73799316, "body": "Ok, i see now an example, I understood what buffer return. It took me a while but I understood."}, {"owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491998261, "post_id": 43366933, "comment_id": 73799392, "body": "But if I don&#39;t know the size of my file, what can I put on count? Insert an approximate number is not a good solution"}, {"owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "edited": false, "score": 0, "creation_date": 1491998761, "post_id": 43366933, "comment_id": 73799749, "body": "Is there any function in C that determin the size of a file?"}], "tags": [], "owner": {"reputation": 724, "user_id": 7438356, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3b94d667c9db8baa2b9ab57502b4a82?s=128&d=identicon&r=PG&f=1", "display_name": "RomMer", "link": "https://stackoverflow.com/users/7438356/rommer"}, "is_accepted": true, "score": 0, "last_activity_date": 1491992744, "creation_date": 1491992744, "answer_id": 43366933, "question_id": 43366806, "link": "https://stackoverflow.com/questions/43366806/how-can-i-read-a-csv-file-in-c/43366933#43366933", "title": "How can i read a csv file in C?", "body": "<p>you can use a lot of function</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\">read function</a></p>\n\n<p><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm\" rel=\"nofollow noreferrer\">fgets function as you said</a></p>\n\n<p>of course you don't know the content of your file but using a char * is the best solution</p>\n\n<p>in both cases you will use a char * because it's the best way to read your file; and can convert your data to an other type really easily</p>\n\n<p>for example if you read a number in your file, then you can convert it to an integer using <a href=\"http://man7.org/linux/man-pages/man3/atoi.3.html\" rel=\"nofollow noreferrer\">atoi</a> for example </p>\n"}], "owner": {"reputation": 17, "user_id": 7855680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8Mxl-Z386c/AAAAAAAAAAI/AAAAAAAAAmg/FA52G3QfCXI/photo.jpg?sz=128", "display_name": "Enrico Arnaudo", "link": "https://stackoverflow.com/users/7855680/enrico-arnaudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1151, "favorite_count": 0, "closed_date": 1491992805, "accepted_answer_id": 43366933, "answer_count": 1, "score": 0, "last_activity_date": 1491997510, "creation_date": 1491992453, "last_edit_date": 1491997510, "question_id": 43366806, "link": "https://stackoverflow.com/questions/43366806/how-can-i-read-a-csv-file-in-c", "closed_reason": "Needs more focus", "title": "How can i read a csv file in C?", "body": "<p>I need to reed a csv file in C.\nI made a struct like this:</p>\n\n<pre><code>typedef struct Node{\n  void** elem;\n  List* next;\n}List;\n</code></pre>\n\n<p>If I dont'know what's in csv file, how can I read the elements? They can be different in the same record.\nA sample of a record is this:\n12,ciao,45,2.4\nWhere i have a different type in the same record.\nI saw fget function yet, but it return a char* or char... I would like something more generic because I don't know what there's in the record. \nI will use this struct with sorting algorithm.\nIn sorting algorithm i have a compare function like this</p>\n\n<pre><code>typedef int (*CompareFunction)(void*, void*);`\n</code></pre>\n\n<p>so if i can read void* on csv file and than put the element on the struct this wuold make easy the compare function.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491992554, "post_id": 43366803, "comment_id": 73795270, "body": "You use another loop, up to how many elements you have... with a formatted printing..."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 2, "creation_date": 1491992558, "post_id": 43366803, "comment_id": 73795275, "body": "&quot;Enter 10 numbers:&quot; , when you have only allocated space for 9 <code>int a[9]</code>. The result of that program will just be excessive amounts of sadness."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1491992568, "post_id": 43366803, "comment_id": 73795284, "body": "You have two big problems with the code you show: The first is that you want to enter ten elements into an array containing only nine elements. The second problem is the condition <code>a[i] != 0</code> where you use <code>a[i]</code> before it has been initialized (and therefore will haven an <i>indeterminate</i> value)."}, {"owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "edited": false, "score": 0, "creation_date": 1491992703, "post_id": 43366803, "comment_id": 73795395, "body": "Where do I put that another loop?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1491992750, "post_id": 43366803, "comment_id": 73795439, "body": "@SvenB Think a little! If you want to do A followed by B, you would not do B first would you?"}], "answers": [{"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 3, "last_activity_date": 1491992765, "creation_date": 1491992765, "answer_id": 43366944, "question_id": 43366803, "link": "https://stackoverflow.com/questions/43366803/how-to-print-all-elements-of-an-array-in-c-after-i-enter-all-of-them/43366944#43366944", "title": "How to print all elements of an array in C after I enter all of them?", "body": "<p>You should use another for loop, like:</p>\n\n<pre><code>for(i=0;i&lt;number_of_elements;i++)\n{\n        printf(\"%d \",a[i]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1491993570, "creation_date": 1491993570, "answer_id": 43367243, "question_id": 43366803, "link": "https://stackoverflow.com/questions/43366803/how-to-print-all-elements-of-an-array-in-c-after-i-enter-all-of-them/43367243#43367243", "title": "How to print all elements of an array in C after I enter all of them?", "body": "<p>After implementing @rsp's code, I fixed my code. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nint main() {\n\n    int a[10], number_of_elements;\n    printf(\"Enter 10 numbers: \\n\");\n    for (int i = 0; ((i &lt; 10) &amp;&amp; (a[i] != 0)); i++) {\n\n        scanf_s(\"%d\", &amp;a[i]);\n        if (a[i] == 0) {\n            number_of_elements = i;\n            break;\n        }\n        if (a[i] != 0) {\n\n            number_of_elements = i + 1;\n\n        }\n\n    }\n    for (int i = 0; i&lt;number_of_elements; i++)\n    {\n        printf(\"%d \", a[i]);\n    }\n    printf(\"\\nThere are %d elements.\\n\", number_of_elements);\n    return 0;\n}\n</code></pre>\n\n<p>Tnx everyone for help and tnx @George for being so funny :)</p>\n"}], "owner": {"reputation": 29, "user_id": 7323225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7032dcec2fc24575553ab1f910dd6e60?s=128&d=identicon&r=PG&f=1", "display_name": "Sven B", "link": "https://stackoverflow.com/users/7323225/sven-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3546, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1491993570, "creation_date": 1491992446, "question_id": 43366803, "link": "https://stackoverflow.com/questions/43366803/how-to-print-all-elements-of-an-array-in-c-after-i-enter-all-of-them", "title": "How to print all elements of an array in C after I enter all of them?", "body": "<p>So I have this code in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a[9], number_of_elements;\n    printf(\"Enter 10 numbers: \\n\");\n    for (int i = 0; ((i &lt; 10) &amp;&amp; (a[i] != 0)); i++) {\n        scanf_s(\"%d\", &amp;a[i]);\n        if (a[i] == 0) {\n            number_of_elements = i;\n            break;\n        }\n        if (a[i] != 0) {\n            number_of_elements = i + 1;\n        }   \n    }\n    printf(\"There is %d elements.\\n\", number_of_elements);\n    return 0;\n}\n</code></pre>\n\n<p>As you can see, I have to enter max 10 elements into an array, or stop entering when you enter 0, and after that I have to print all elements of that array and how many elements array have. I sorted all things except printing all elements of the array, can anyone help me how to do that?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1491991404, "post_id": 43366321, "comment_id": 73794442, "body": "You need to learn the concept of looping and apply it to your case."}, {"owner": {"reputation": 23, "user_id": 7792712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc6fe10ea10644326bc6ffa335aabe7f?s=128&d=identicon&r=PG&f=1", "display_name": "user7792712", "link": "https://stackoverflow.com/users/7792712/user7792712"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1491991749, "post_id": 43366321, "comment_id": 73794686, "body": "i cant use looping, the asigment only allows if/else and switch"}, {"owner": {"reputation": 360, "user_id": 3492498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b22bd84245bf80211b37cc5ccf73def?s=128&d=identicon&r=PG&f=1", "display_name": "Nish", "link": "https://stackoverflow.com/users/3492498/nish"}, "edited": false, "score": 0, "creation_date": 1491992017, "post_id": 43366321, "comment_id": 73794897, "body": "loop, create a result, with every loop do &quot;something&quot; to the result. Ex. 25 in string is 2*10 + 5, and 253 is 25*10 + 3"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 0, "last_activity_date": 1491992116, "creation_date": 1491992116, "answer_id": 43366670, "question_id": 43366321, "link": "https://stackoverflow.com/questions/43366321/binary-operations-on-a-decimal-input/43366670#43366670", "title": "Binary operations on a decimal input", "body": "<p>You seem to have various weird restrictions on what you \"can\" use, which makes this a guessing contest.</p>\n\n<p>Anyway, to limit your decimal number to a certain number of digits, you can use modulo:</p>\n\n<pre><code>b1 %= 100000000;\n</code></pre>\n\n<p>This will remove any part exceeding 10,000,000, limiting it to 8 decimal digits which you can then interpret as binary bits.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1491998397, "creation_date": 1491998397, "answer_id": 43368929, "question_id": 43366321, "link": "https://stackoverflow.com/questions/43366321/binary-operations-on-a-decimal-input/43368929#43368929", "title": "Binary operations on a decimal input", "body": "<p>These artificial requirements serve no other purpose but to teach you bad habits. In a real-world application, you would read the input as a string, which would the most convenient and safe format. Then use loops or <code>strtol</code>.</p>\n\n<p>That being said, you could read the unsigned integer as hex, which doesn't contradict the requirements. It would make the task slightly less absurd. Then mask each digit of the hex and translate to actual binary.</p>\n\n<pre><code>// don't write code like this in the real world\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nuint32_t wannabe_binary;\nuint32_t actual_binary = 0;\nuint32_t shift;\n\nprintf(\"Input a binary number and decimal shifting in the following format: 8-bit dec\\n\");\nscanf(\"%\"SCNx32 \"%\"SCNd32, &amp;wannabe_binary, &amp;shift);\n\nactual_binary += (wannabe_binary &amp; 0x10000000) ? 1&lt;&lt;7 : 0;\nactual_binary += (wannabe_binary &amp; 0x01000000) ? 1&lt;&lt;6 : 0;\nactual_binary += (wannabe_binary &amp; 0x00100000) ? 1&lt;&lt;5 : 0;\nactual_binary += (wannabe_binary &amp; 0x00010000) ? 1&lt;&lt;4 : 0;\nactual_binary += (wannabe_binary &amp; 0x00001000) ? 1&lt;&lt;3 : 0;\nactual_binary += (wannabe_binary &amp; 0x00000100) ? 1&lt;&lt;2 : 0;\nactual_binary += (wannabe_binary &amp; 0x00000010) ? 1&lt;&lt;1 : 0;\nactual_binary += (wannabe_binary &amp; 0x00000001) ? 1&lt;&lt;0 : 0;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7792712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc6fe10ea10644326bc6ffa335aabe7f?s=128&d=identicon&r=PG&f=1", "display_name": "user7792712", "link": "https://stackoverflow.com/users/7792712/user7792712"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 43366670, "answer_count": 2, "score": -1, "last_activity_date": 1491998397, "creation_date": 1491991179, "last_edit_date": 1491992070, "question_id": 43366321, "link": "https://stackoverflow.com/questions/43366321/binary-operations-on-a-decimal-input", "title": "Binary operations on a decimal input", "body": "<p>I'm creating a binary calculator in C for a school project and I'm having trouble getting the right answer.</p>\n\n<p>The assignment specificies that I can only read and print unsigned integer from the user and i cant use looping, so I created a variable that converts the binary input into decimal and then I apply the operator on those decimal numbers.</p>\n\n<p>Code: </p>\n\n<pre><code>case 1:\n        printf_s(\"Input a binary number and decimal shifting in the following format: 8-bit dec\\n\");\n        scanf_s(\"%u %u\", &amp;b1, &amp;b2);\n        /*conversion of binary to decimal*/\n        result1 = (b1 % 10) + (b1 / 10 % 10) * 2 + (b1 / 100 % 10) * 4 + (b1 / 1000 % 10) * 8 + (b1 / 10000 % 10) * 16 + (b1 / 100000 % 10) * 32 + (b1 / 1000000 % 10) * 64 + (b1 / 10000000 % 10) * 128;\n\n        printf_s(\"\\nThe result is %u\\n\", result1 &lt;&lt; b2);\n        break;\n</code></pre>\n\n<p>The problem I have is when I enter for example <code>00111100</code> and <code>3</code>, the program apparently doesn't know what to do the with the extra <code>1</code> and I get a wrong answer.</p>\n"}, {"tags": ["c", "gcc", "buffer-overflow"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1491991130, "post_id": 43366242, "comment_id": 73794243, "body": "Undefined behavior = behavior that is not defined. There is no guarantee where those variables are allocated in memory."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1491991166, "post_id": 43366242, "comment_id": 73794271, "body": "@Lundin Sir, please emphasise that these two are not related points."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1491991208, "post_id": 43366242, "comment_id": 73794305, "body": "You&#39;re exploiting <i>undefined behavior</i>, and undefined behavior is by its very definition undefined. Also, the stack layout created by a compiler depends very much on the compiler, and a hack like this may not work on all compilers. Especially if there&#39;s some optimizations going on (which might optimize out the <code>val</code> variable completely)."}, {"owner": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1491991929, "post_id": 43366242, "comment_id": 73794807, "body": "@Someprogrammerdude This is NOT undefined behaviour. This code is expected to cause an overflow. Like I mentioned, this is a challenge from overthewire.org. I managed to solve it on their remote shell. I understood the memory layout, predicted the input, handcrafted the input, and sure enough, the var got overwritten(with 0xdeadbeef) spawning me the shell! My question is: Why am I not able to reproduce this very same problem on my local system? What is it that I am missing? What optimisations (if any) should I remove form my compiler?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1491992132, "post_id": 43366242, "comment_id": 73794970, "body": "Writing out of bounds leads to undefined behavior. That you know (or <i>think</i> that you know) what will happen doesn&#39;t make it less UB in the term of the C specification. That it apparently doesn&#39;t work as you expected it to is a clear evidence of UB."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1491992470, "post_id": 43366242, "comment_id": 73795193, "body": "@JayBhavsar If multiple people tell you it is undefined behaviour, there might be some truth to the statement. And just to make sure yes this is undefined behaviour. I am suprised that this even worked once."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1491992503, "post_id": 43366242, "comment_id": 73795223, "body": "@JayBhavsar google &quot;C undefined behaviour&quot;. Yes, the code causes a buffer overflow, but the consequences of the buffer overflow cannot be generally predicted, because it is &quot;undefined behaviour&quot;."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1491992678, "post_id": 43366242, "comment_id": 73795373, "body": "<i>Why am I not able to reproduce this very same problem on my local system?</i> : because it is not exactly the same platform (same OS, same compiler version, same compiler flags used etc.)"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1491993334, "post_id": 43366242, "comment_id": 73795869, "body": "Apparantly the variables get laid out differently on the stack on your mac. Printing the address of <code>val</code> and <code>buf</code> should be helpful."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "edited": false, "score": 0, "creation_date": 1491992069, "post_id": 43366465, "comment_id": 73794928, "body": "This is NOT undefined behaviour. This code is expected to cause an overflow. Like I mentioned, this is a challenge from overthewire.org. I managed to solve it on their remote shell. I understood the memory layout, predicted the input, handcrafted the input, and sure enough, the var got overwritten(with 0xdeadbeef) spawning me the shell! My question is: Why am I not able to reproduce this very same problem on my local system? What is it that I am missing? What optimisations (if any) should I remove form my compiler? Also, for scanf function, it will read 24 characters, no more, no less."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "edited": false, "score": 2, "creation_date": 1491993695, "post_id": 43366465, "comment_id": 73796171, "body": "@JayBhavsar: actually it <i>is</i> undefined behaviour - the fact that you made this exploit work in one scenario proves nothing - you are making a lot of assumptions about how undefined behaviour will play out, which happened to work for you in one case, but which can not be relied upon in the general case."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 3, "last_activity_date": 1491991589, "creation_date": 1491991589, "answer_id": 43366465, "question_id": 43366242, "link": "https://stackoverflow.com/questions/43366242/why-the-buffer-isnt-overflowing-with-this-code/43366465#43366465", "title": "Why the buffer isn&#39;t overflowing with this code?", "body": "<p>It's <strong>undefined behavior</strong> because C functions do not check whether an argument is too big for its buffer or not.</p>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 5799892, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/549c8d3e3f2bb3041f24177a5fcdb031?s=128&d=identicon&r=PG&f=1", "display_name": "cdcdcd", "link": "https://stackoverflow.com/users/5799892/cdcdcd"}, "is_accepted": false, "score": 0, "last_activity_date": 1491991595, "creation_date": 1491991595, "answer_id": 43366468, "question_id": 43366242, "link": "https://stackoverflow.com/questions/43366242/why-the-buffer-isnt-overflowing-with-this-code/43366468#43366468", "title": "Why the buffer isn&#39;t overflowing with this code?", "body": "<p>I'm not sure what you mean. </p>\n\n<p>1) Are you concerned that your input string will create a number that will be too big to store in a long. This will not happen the number will simply wrap round.\n2) Are you concerned that you'll read to memory beyond the bounds of buf? In C this will produce undefined behavior not necessarily a crash.</p>\n\n<p>buf is on the stack (could be just as well on the heap) so you can just keep writing to memory from the address where buf starts. The compiler will generate code that will not do a bounds check for you. So if you go beyond the 20byte you'll eventually start overwriting other parts of memory that do not belong block of memory you've set aside for buf.  </p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "edited": false, "score": 0, "creation_date": 1491994904, "post_id": 43367285, "comment_id": 73797086, "body": "Yes, wrapping them ensures their place. I did so, and printed their addresses (<code>printf(&quot;%p\\n&quot;,(void*)&amp;a);</code>) in both cases, with wrapping and without wrapping. The difference between those 2 addresses is 24 bytes, which is expected. Even so, entering 24 char long string does not overwrite <code>val</code>."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "edited": false, "score": 0, "creation_date": 1491995313, "post_id": 43367285, "comment_id": 73797428, "body": "I would expect the difference between the adresses to be 20 bytes, not 24. Sometimes the compiler inserts extra bytes between variables when you use the debug flag, so try skipping the <code>-g</code> from the compile command."}, {"owner": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "edited": false, "score": 0, "creation_date": 1491996181, "post_id": 43367285, "comment_id": 73798058, "body": "Yes, I agree that the difference should be 20 bytes. Even with <code>-g</code> flag removed, it&#39;s still 24 bytes. Instead of scanning 24 char, if I scan 28 chars and input 28 char long string, the last 4 bytes do overwrite <code>val</code> (This makes sense). Now I understand why the binary behaves the way id does. This was helpful. Now if you can explain this, you&#39;ll make my day: Why did my compiler inserted extra 4 bytes between those two variables?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "edited": false, "score": 1, "creation_date": 1491997080, "post_id": 43367285, "comment_id": 73798693, "body": "I probably tries to always place <code>long</code> variables on an address that is a multiple of 8. Look for <code>#pragma pack</code> in the compiler manual and surround the struct declaration with suitable values. <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.3.1/gcc/Structure_002dPacking-Pragmas.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-4.3.1/gcc/&hellip;</a>"}, {"owner": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "edited": false, "score": 0, "creation_date": 1492005188, "post_id": 43367285, "comment_id": 73804923, "body": "Thanks! This is exactly what I was looking for :)"}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 2, "last_activity_date": 1491997447, "last_edit_date": 1491997447, "creation_date": 1491993677, "answer_id": 43367285, "question_id": 43366242, "link": "https://stackoverflow.com/questions/43366242/why-the-buffer-isnt-overflowing-with-this-code/43367285#43367285", "title": "Why the buffer isn&#39;t overflowing with this code?", "body": "<p>Apparantly the variables get laid out differently on the stack on your mac. </p>\n\n<p>Wrapping them in a struct will ensure that they are placed in the order you want. </p>\n\n<p>Since there is the possibility of padding, let's turn it off. For <code>gcc</code>, the precompiler directe <code>#pragma pack</code> controls struct packing.</p>\n\n<pre><code>int main(){\n#pragma pack(1)\n  struct {\n    char buf[20];\n    long val=0x41414141;\n  } s;\n#pragma pack()\n  printf(\"Correct val's value from 0x41414141 -&gt; 0xdeadbeef!\\n\");\n  printf(\"Here is your chance: \");\n  scanf(\"%24s\",&amp;s.buf);\n\n  printf(\"buf: %s\\n\",s.buf);\n  printf(\"val: 0x%08x\\n\",s.val);\n\n  if(s.val==0xdeadbeef)\n    system(\"/bin/sh\");\n  else {\n    printf(\"WAY OFF!!!!\\n\");\n    exit(1);\n  }\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4853360, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-SiVTjG3twrk/AAAAAAAAAAI/AAAAAAAAAMA/qmnjqySxvl0/photo.jpg?sz=128", "display_name": "Jay Bhavsar", "link": "https://stackoverflow.com/users/4853360/jay-bhavsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 43367285, "answer_count": 3, "score": 0, "last_activity_date": 1491997447, "creation_date": 1491990960, "last_edit_date": 1491993581, "question_id": 43366242, "link": "https://stackoverflow.com/questions/43366242/why-the-buffer-isnt-overflowing-with-this-code", "title": "Why the buffer isn&#39;t overflowing with this code?", "body": "<p>This is the C code that I am compiling:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\nlong val=0x41414141;\nchar buf[20];\n\nprintf(\"Correct val's value from 0x41414141 -&gt; 0xdeadbeef!\\n\");\nprintf(\"Here is your chance: \");\nscanf(\"%24s\",&amp;buf);\n\nprintf(\"buf: %s\\n\",buf);\nprintf(\"val: 0x%08x\\n\",val);\n\nif(val==0xdeadbeef)\nsystem(\"/bin/sh\");\nelse {\nprintf(\"WAY OFF!!!!\\n\");\nexit(1);\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>Here, I am expecting an overflow in <code>long val</code> if user inputs string 24 character long, changing the value in <code>val</code>. But it just doesn't get overflowed even if string is long enough. Can someone please explain this behaviour?</p>\n\n<p>I am on macOS. This is what <code>gcc -v</code> spits out:</p>\n\n<pre><code>Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk/usr/include/c++/4.2.1\nApple LLVM version 8.0.0 (clang-800.0.42.1)\nTarget: x86_64-apple-darwin16.0.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n</code></pre>\n\n<p>Also, after googling a bit I tried gcc with these flags:</p>\n\n<pre><code>gcc -g -fno-stack-protector -D_FORTIFY_SOURCE=0 -o overflow_example overflow_example.c\n</code></pre>\n\n<p>still, the result is same.</p>\n\n<p>This code is part of <code>narnia</code> wargame challenge on <a href=\"http://overthewire.org/wargames/narnia/\" rel=\"nofollow noreferrer\">overthewire</a>. I managed to crack this challenge on their remote shell, where it was behaving as expected. Now, I am trying to reproduce this same challenge on my local system and facing this issue. Please help.</p>\n\n<p>EDIT: For all the people yelling out about UB: like I said, this was one of the challenge to be solved on <a href=\"http://overthewire.org/wargames/narnia/\" rel=\"nofollow noreferrer\">overthewire</a>, so it cannot have UB. There are some blogs (<a href=\"https://infamoussyn.com/2013/11/18/overthewire-narnia-level-0-4-writeup/\" rel=\"nofollow noreferrer\">here's on I found</a>) that provide walkthrough for this challenge with reasonable logical explanation for <em>why</em> the code behaves the way it does, with which I agree. I also understand that the compiled binary is platform dependent. <em>So, what am I to do to produce this binary with potential overflow on my local system?</em></p>\n"}, {"tags": ["c", "jna", "spss"], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 2964164, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3e6a0f932115207b25ac3fdfa2a48111?s=128&d=identicon&r=PG&f=1", "display_name": "Blue", "link": "https://stackoverflow.com/users/2964164/blue"}, "edited": false, "score": 0, "creation_date": 1492072000, "post_id": 43374832, "comment_id": 73835626, "body": "Thank you, that&#39;s it. I tried IntByReference, since i thought that would be the right idea, but did not try just setting that value to an integer and work with that."}], "tags": [], "owner": {"reputation": 5374, "user_id": 1161484, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lg24v.png?s=128&g=1", "display_name": "Daniel Widdis", "link": "https://stackoverflow.com/users/1161484/daniel-widdis"}, "is_accepted": true, "score": 0, "last_activity_date": 1492020738, "last_edit_date": 1492020738, "creation_date": 1492014072, "answer_id": 43374832, "question_id": 43365977, "link": "https://stackoverflow.com/questions/43365977/jna-pointer-to-store-file-handle/43374832#43374832", "title": "JNA pointer to store file handle", "body": "<p>The \"value\" of <code>fH</code> would be the same memory address that you originally defined.  If you attempted to read that value, however, you should get the result, e.g., <code>fH.getInt(0)</code>.</p>\n\n<p>However, allocating 4096 bytes to hold an integer is overkill.  Why not just use the <code>IntByReference</code> class designed specifically for this purpose?</p>\n\n<pre><code>int fH; /* file handle */\nint error; /* error code */\nIntByReference pFH = new IntByReference(); // allocates memory for the int\nerror = CLibrary.INSTANCE.spssOpenWrite(\"mydata.sav\", pFH);\n// TODO: test error value before proceeding\nfH = pFH.getValue();\n</code></pre>\n"}], "owner": {"reputation": 561, "user_id": 2964164, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3e6a0f932115207b25ac3fdfa2a48111?s=128&d=identicon&r=PG&f=1", "display_name": "Blue", "link": "https://stackoverflow.com/users/2964164/blue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 43374832, "answer_count": 1, "score": 0, "last_activity_date": 1492020738, "creation_date": 1491990260, "question_id": 43365977, "link": "https://stackoverflow.com/questions/43365977/jna-pointer-to-store-file-handle", "title": "JNA pointer to store file handle", "body": "<p>I'm using JNA to use a .dll in Java.</p>\n\n<p>The method i'm trying to use is this (in C):</p>\n\n<pre><code>int fH; /* file handle */\nint error; /* error code */\nerror = spssOpenWrite(\"mydata.sav\", &amp;fH);\n</code></pre>\n\n<p>It creates a new file and stores the file handle in hFile and returns an error code.\nI'm not sure how to recreate that with JNA, i tried using the pointer-object like this:</p>\n\n<pre><code>Pointer fH = new Memory(4096);\nint error = 0;\nerror = CLibrary.INSTANCE.spssOpenWrite(\"mydata.sav\", fH);\n</code></pre>\n\n<p>But that doesn't change the value of fH.</p>\n"}, {"tags": ["c", "sdl", "game-physics", "sdl-2"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6782445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954c679d8146f674dab5f45ca3b76c4e?s=128&d=identicon&r=PG&f=1", "display_name": "JLW", "link": "https://stackoverflow.com/users/6782445/jlw"}, "edited": false, "score": 0, "creation_date": 1492105705, "post_id": 43390445, "comment_id": 73858104, "body": "So do you mean I should initiate the move function before the event queue?"}, {"owner": {"reputation": 3046, "user_id": 3013887, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1396249d91442e1dde6e93197c0b94a?s=128&d=identicon&r=PG&f=1", "display_name": "pingul", "link": "https://stackoverflow.com/users/3013887/pingul"}, "reply_to_user": {"reputation": 9, "user_id": 6782445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954c679d8146f674dab5f45ca3b76c4e?s=128&d=identicon&r=PG&f=1", "display_name": "JLW", "link": "https://stackoverflow.com/users/6782445/jlw"}, "edited": false, "score": 0, "creation_date": 1492168078, "post_id": 43390445, "comment_id": 73879410, "body": "@JLW I am not sure what that means. My suggestion is to <i>check and see if your next position is an allowed position</i>, not to check if your current position is allowed or not. If you have moving collision bodies, you&#39;ll have to do some extra modifications however."}, {"owner": {"reputation": 9, "user_id": 6782445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954c679d8146f674dab5f45ca3b76c4e?s=128&d=identicon&r=PG&f=1", "display_name": "JLW", "link": "https://stackoverflow.com/users/6782445/jlw"}, "edited": false, "score": 0, "creation_date": 1492171806, "post_id": 43390445, "comment_id": 73881250, "body": "Ah ok yes I get what you mean now. I&#39;ll give that a go in a day or two, thanks for the help, will let you know if it solved things! Thanks!"}], "tags": [], "owner": {"reputation": 3046, "user_id": 3013887, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c1396249d91442e1dde6e93197c0b94a?s=128&d=identicon&r=PG&f=1", "display_name": "pingul", "link": "https://stackoverflow.com/users/3013887/pingul"}, "is_accepted": false, "score": 0, "last_activity_date": 1492172363, "last_edit_date": 1492172363, "creation_date": 1492081173, "answer_id": 43390445, "question_id": 43365730, "link": "https://stackoverflow.com/questions/43365730/after-detecting-collision-between-my-character-and-an-object-the-character-is-n/43390445#43390445", "title": "After detecting collision between my character and an object, the character is no longer able to move?", "body": "<p>My guess: your <code>collision(c, scene)</code> method looks at collisions <em>for the current time step</em>. In that case, your if statement in the <code>move</code> function </p>\n\n<pre><code>                                                      //  \\/ This here is the problem -- if you're currently colliding with an object you don't allow any movement, even if you're moving out of the object  \nif(((c-&gt;xPos &lt; 0) || (c-&gt;xPos + c-&gt;dest.w &gt; WIDTH)) || (collision(c, scene))) {\n    c-&gt;xPos -= c-&gt;xVel * timeStep;\n}\n</code></pre>\n\n<p>the player is not allowed to move after she has collided with an object. The solution is to check for collision <em>before</em> you take the step:</p>\n\n<pre><code>float newX = c-&gt;xPos + c-&gt;xVel*timeStep;\nfloat newY = ...;\nif (!collision(newX, newY, scene)) {\n    c-&gt;xPos = newX;\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6782445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954c679d8146f674dab5f45ca3b76c4e?s=128&d=identicon&r=PG&f=1", "display_name": "JLW", "link": "https://stackoverflow.com/users/6782445/jlw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492172363, "creation_date": 1491989643, "question_id": 43365730, "link": "https://stackoverflow.com/questions/43365730/after-detecting-collision-between-my-character-and-an-object-the-character-is-n", "title": "After detecting collision between my character and an object, the character is no longer able to move?", "body": "<p>I'm creating a game where you can move a dot along the x axis in the middle of the screen and there will be elements falling from the top that you will need to try and dodge, clearly for this I need some form of collision detection, which I have implemented and it appears to work correctly. </p>\n\n<p>My problem is that when the character (dot) has moved towards the object and the collision has occurred, you are no longer able to move the character, it simply stays in a fixed position. This does not happen when the character collides with the edges of the window, however as you will see below both the window collision and object collision have the same code to run.</p>\n\n<p>Main game loop:</p>\n\n<pre><code>  while(running) {\n\n    // Queue of the events happening\n    while(SDL_PollEvent(&amp;event)) {\n      if(event.type == SDL_QUIT) {\n        running = false;\n      }\n      else if(event.type == SDL_KEYDOWN &amp;&amp; event.key.repeat == 0) {\n        switch(event.key.keysym.sym) {\n          case SDLK_UP:\n            //sprite-&gt;yVel -= VELOCITY;\n            break;\n          case SDLK_DOWN:\n            //sprite-&gt;yVel += VELOCITY;\n            break;\n          case SDLK_LEFT:\n            sprite-&gt;xVel -= VELOCITY;\n            break;\n          case SDLK_RIGHT:\n            sprite-&gt;xVel += VELOCITY;\n            break;\n        }\n     }\n     else if(event.type == SDL_KEYUP &amp;&amp; event.key.repeat == 0) {\n       switch(event.key.keysym.sym) {\n         case SDLK_UP:\n           //sprite-&gt;yVel += VELOCITY;\n           break;\n         case SDLK_DOWN:\n           //sprite-&gt;yVel -= VELOCITY;\n           break;\n         case SDLK_LEFT:\n           sprite-&gt;xVel += VELOCITY;\n           break;\n         case SDLK_RIGHT:\n           sprite-&gt;xVel -= VELOCITY;\n           break;\n       }\n     }\n   } // Poll event loop\n\n   float timeStep = getTicks(ticks) / (float) 1000;\n   move(sprite, timeStep, WINDOW_WIDTH, WINDOW_HEIGHT, head);\n\n   startTimer(ticks);\n\n   // Clear window then draw image\n   SDL_RenderClear(rend);\n   SDL_RenderCopy(rend, background-&gt;element, NULL, NULL);\n   SDL_RenderCopy(rend, sofa-&gt;element, NULL, &amp;sofa-&gt;dest);\n\n   setPosition(sprite, sprite-&gt;xPos, sprite-&gt;yPos);\n   SDL_RenderCopy(rend, sprite-&gt;element, NULL, &amp;sprite-&gt;dest);\n\n   SDL_RenderPresent(rend);\n   capFrameRate(timeStep);\n} // Main game loop\n</code></pre>\n\n<p>Move and Collision functions:</p>\n\n<pre><code>void move(Character *c, float timeStep, const int WIDTH, const int HEIGHT, Scene *scene) {\n  c-&gt;xPos += c-&gt;xVel * timeStep;\n\n  // Collision check for the walls\n  if(((c-&gt;xPos &lt; 0) || (c-&gt;xPos + c-&gt;dest.w &gt; WIDTH)) || (collision(c, scene))) {\n    c-&gt;xPos -= c-&gt;xVel * timeStep;\n  }\n}\n\nbool collision(Character *character, Scene *scene) {\n  if(SDL_HasIntersection(&amp;character-&gt;dest, &amp;scene-&gt;element-&gt;dest)) {\n    return true;\n  }\n  else {\n    if(scene-&gt;nextElement == NULL) {\n      return false;\n    }\n    else {\n      collision(character, scene-&gt;nextElement);\n    }\n  }\n  return false;\n}\n</code></pre>\n\n<p>As there will be a few elements falling from the top of the screen I've implemented a Linked list for those, hence why the recursion on the collision function. If anyone has any idea on why the character does not move after collision I'll be very grateful.</p>\n"}, {"tags": ["c", "math", "bit-manipulation", "bitwise-operators", "twos-complement"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1491989864, "post_id": 43365703, "comment_id": 73793228, "body": "Read up on <a href=\"https://en.wikipedia.org/wiki/Adder_(electronics)#Half_adder\" rel=\"nofollow noreferrer\">half-adders</a> and <a href=\"https://en.wikipedia.org/wiki/Adder_(electronics)#Full_adder\" rel=\"nofollow noreferrer\">full-adders</a> - the logic here is more or less a direct translation of how you might implement addition in hardware."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1491990409, "post_id": 43365703, "comment_id": 73793672, "body": "It seems logical to only continue adding (part of) <code>y</code> as long as it&#39;s non-zero: if it&#39;s zero you&#39;re doen since <code>x + 0 == x</code> for all <code>x</code>."}, {"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491990821, "post_id": 43365703, "comment_id": 73793995, "body": "Just try it with an example and you will understand :p"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1491991719, "post_id": 43365703, "comment_id": 73794665, "body": "Pencil and paper works great here too,"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1491992022, "post_id": 43365703, "comment_id": 73794899, "body": "When you add two digits, you may get a carry bit; when you add it to the next two digits, you may get a carry bit again, etc. That&#39;s what the loop does. It stops when there&#39;s nothing more to carry."}], "answers": [{"tags": [], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "is_accepted": false, "score": 0, "last_activity_date": 1491993359, "last_edit_date": 1491993359, "creation_date": 1491992319, "answer_id": 43366758, "question_id": 43365703, "link": "https://stackoverflow.com/questions/43365703/bitwise-carry-applications/43366758#43366758", "title": "Bitwise carry applications", "body": "<p>I will try to explain it on a simple 3 bits example (you can skip this example to the actual explanation which marked in bold font and starts at <em>Now to the way we achieve the same flow from the posted code</em>).</p>\n\n<p>Lets say we want to add x=0b011 with y=0b101. First we add the least significant bits <code>1+1 = 0b10</code></p>\n\n<pre><code>carry: x10\nx:     011\n      +\ny:     101\n      -----\n       xx0\n</code></pre>\n\n<p>Then we add the second bits (and by the book we need to add also the carry from the previous stage but we can also skip it for later stage): <code>1+0 = 0b1</code></p>\n\n<pre><code>carry: 010\nx:     011\n      +\ny:     101\n      -----\n       x10\n</code></pre>\n\n<p>Do the same for the third bit: <code>0+1 = 0b1</code></p>\n\n<pre><code>carry: 010\nx:     011\n      +\ny:     101\n      -----\n       110\n</code></pre>\n\n<p>So now we have <code>carry = 0b010</code> and some partial result <code>0b110</code>. \nRemember my comment earlier that we take care of carry at some later stage? So now is this \"later stage\". Now we add the carry to the partial result we got (note that it is the same if we added the carry for each bit separately at the earlier stages). LSB bits addition:</p>\n\n<pre><code>NEW carry:    x00\ncarry:        010\n             +\npart. res.:   110\n             -----\n              xx0\n</code></pre>\n\n<p>Second bits addition:</p>\n\n<pre><code>NEW carry:    100\ncarry:        010\n             +\npart. res.:   110\n             -----\n              x00\n</code></pre>\n\n<p>Third bit addition:</p>\n\n<pre><code>NEW carry:      100\ncarry:          010\n               +\npart. res.:     110\n               -----\nnew part. res.  100\n</code></pre>\n\n<p>Now <code>carry = NEW carry, part. res. = new part. res.</code> and we do the same iteration once again.</p>\n\n<p>For LSB</p>\n\n<pre><code>NEW carry:    x00\ncarry:        100\n             +\npart. res.:   100\n             -----\n              xx0\n</code></pre>\n\n<p>For the second bits:</p>\n\n<pre><code>NEW carry:    000\ncarry:        100\n             +\npart. res.:   100\n             -----\n              x00\n</code></pre>\n\n<p>Third bits:</p>\n\n<pre><code>NEW carry:   1000 --&gt; 000 since we are working with 3 bits only\ncarry:        100\n             +\npart. res.:   100\n             -----\n              000\n</code></pre>\n\n<p>Now <code>NEW carry</code> is 0 so we have finished the calculation.The final result is 0b000 (overflow).</p>\n\n<p>I am sure I haven't discovered anything to here. <strong>Now to the way we achieve the same flow from the posted code:</strong></p>\n\n<p>The <code>partial result</code> is the result without the <code>carry</code>, which means when <code>x</code> and <code>y</code> have different bits at the same position, the sum of these bits will be 1. If the same bits are identical, the result will be 0 (1+1 => 0, <code>carry</code> 1 and 0+0 => 0, <code>carry</code> 0). </p>\n\n<p>Thus <strong>partial result</strong> is <code>x ^ y</code> (see the properties of the <a href=\"https://en.wikipedia.org/wiki/Exclusive_or\" rel=\"nofollow noreferrer\">XOR operation</a>). In the posted code it is <code>x = x ^ y;</code>.</p>\n\n<p>Now let's look at the <code>carry</code>. We will get carry from a single bit addition only if both bits are 1. So the bits which will set the carry bits to 1 are marked as 1 in the following expression: <code>x &amp; y</code> (only the set bits at the same position will remain 1). <strong>But</strong> the carry should be added to the next (more significant) bit! Thus </p>\n\n<pre><code>carry = (x &amp; y) &lt;&lt; 1; // in the posted code it is y = carry &lt;&lt; 1\n</code></pre>\n\n<p>And the iterations are performed unless <code>carry</code> is 0 (like in our example).</p>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 7, "last_activity_date": 1491995942, "last_edit_date": 1491995942, "creation_date": 1491995305, "answer_id": 43367887, "question_id": 43365703, "link": "https://stackoverflow.com/questions/43365703/bitwise-carry-applications/43367887#43367887", "title": "Bitwise carry applications", "body": "<p>Basics first. Exclusive or'ing two bits is the same as the bottom digit of their sum. And'ing two bits is the same as the top bit of their sum.</p>\n\n<pre><code>A | B | A&amp;B | A^B | A+B\n-----------------------\n0 | 0 |  0  |  0  |  00\n0 | 1 |  0  |  1  |  01\n1 | 0 |  0  |  1  |  01\n1 | 1 |  1  |  0  |  10\n</code></pre>\n\n<p>As you can see the exclusive-or result is the same as the last digit of the sum. You can also see that the first digit of the sum is only 1 when A is 1 and B is 1.</p>\n\n<p>[If you have a circuit with two inputs and two outputs, one of which is the <code>exclusive or</code> of the inputs and the other is the <code>and</code> of the inputs, it is called a half adder - because there is no facility to also input a carry (from a previous digit).]</p>\n\n<p>So, to sum two bits, you calculate the XOR to get the lowest digit of the result and the AND to get the highest digit of the result. </p>\n\n<p>For each individual pair of bits in a pair of numbers, I can calculate the sum of those two bits by doing both an XOR and an AND. Using four bit numbers, for example 3 and 5</p>\n\n<pre><code>3 0011\n5 0101\n------\n  0110 3^5 = 6 (low bit)\n  0001 3&amp;5 = 1 (high bit)\n</code></pre>\n\n<p>In order to treat the 3 and 5 as single numbers rather than collections of four bits, each of those high bits needs to be treated as a carry and added to the next low bit to the left. We can do this by shifting the 3&amp;5 left 1 bit and adding to the 3^5 which we do by repeating the two operations</p>\n\n<pre><code>6    0110\n1&lt;&lt;1 0010\n     ----\n     0100 6^(1&lt;&lt;1) = 4\n     0010 6&amp;(1&lt;&lt;1) = 2\n</code></pre>\n\n<p>Unfortunately, one of the additions resulted in another carry being generated. So we can just repeat the operation.</p>\n\n<pre><code>4    0100\n2&lt;&lt;1 0100\n     ----\n     0000 4^(2&lt;&lt;1) = 0\n     0100 4&amp;(2&lt;&lt;1) = 4\n</code></pre>\n\n<p>We <em>still</em> have a carry, so round we go again.</p>\n\n<pre><code>0    0000\n4&lt;&lt;1 1000\n     ----\n     1000 4^(4&lt;&lt;1) = 8\n     0000 4&amp;(4&lt;&lt;1) = 0\n</code></pre>\n\n<p>This time, all the carries are 0 so more iterations are not going to change anything. We've finished.</p>\n"}], "owner": {"reputation": 51, "user_id": 7149345, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10153745202726887/picture?type=large", "display_name": "Puneet Goswami", "link": "https://stackoverflow.com/users/7149345/puneet-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1384, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1491995942, "creation_date": 1491989587, "last_edit_date": 1491989691, "question_id": 43365703, "link": "https://stackoverflow.com/questions/43365703/bitwise-carry-applications", "title": "Bitwise carry applications", "body": "<p>Call me naive but in this area I always struggled. So I was just browsing through the code for adding two numbers without + operator and bumped into this code:</p>\n\n<pre><code>int Add(int x, int y)\n{\n    // Iterate till there is no carry  \n    while (y != 0)\n    {\n        // carry now contains common set bits of x and y\n        int carry = x &amp; y;  \n\n        // Sum of bits of x and y where at least one of the bits is not set\n        x = x ^ y; \n\n        // Carry is shifted by one so that adding it to x gives the \n        // required sum\n        y = carry &lt;&lt; 1;\n    }\n    return x;\n}\n</code></pre>\n\n<p>Now I understand, how he is calculating the carry but why y!=0 and how this code is achieving the result for adding two numbers?</p>\n"}, {"tags": ["c", "cross-compiling", "yocto", "openembedded"], "answers": [{"tags": [], "owner": {"reputation": 12075, "user_id": 2241569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMrPS.jpg?s=128&g=1", "display_name": "Jussi Kukkonen", "link": "https://stackoverflow.com/users/2241569/jussi-kukkonen"}, "is_accepted": true, "score": 1, "last_activity_date": 1491999873, "creation_date": 1491999873, "answer_id": 43369461, "question_id": 43365674, "link": "https://stackoverflow.com/questions/43365674/permission-denied-hello-world-yocto-openembedded/43369461#43369461", "title": "Permission denied Hello world Yocto/Openembedded", "body": "<pre><code>install -m 0644 ${S}/helloworld ${D}${bindir}\n</code></pre>\n\n<p>You are telling install to set no execute permission for anyone: try \"0755\" instead.</p>\n"}], "owner": {"reputation": 363, "user_id": 5934952, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6s8o2.jpg?s=128&g=1", "display_name": "Tagadac", "link": "https://stackoverflow.com/users/5934952/tagadac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1347, "favorite_count": 0, "accepted_answer_id": 43369461, "answer_count": 1, "score": 2, "last_activity_date": 1491999873, "creation_date": 1491989519, "question_id": 43365674, "link": "https://stackoverflow.com/questions/43365674/permission-denied-hello-world-yocto-openembedded", "title": "Permission denied Hello world Yocto/Openembedded", "body": "<p>I want to cross compile with Yocto a simple C Hello World for my Colibri iMX7 from Toradex.\nThe tree of my meta-hellow is as follow :</p>\n\n<pre><code> meta-hellow\n \u251c\u2500\u2500 conf\n \u2502   \u2514\u2500\u2500 layer.conf\n \u2514\u2500\u2500 recipes-myhello\n     \u2514\u2500\u2500 files\n         \u2514\u2500\u2500 helloworld.c\n         \u2514\u2500\u2500 README.TXT\n     \u2514\u2500\u2500 myhello_0.0.bb\n</code></pre>\n\n<p><strong>helloworld.c</strong> :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char** argv)\n{\n        printf(\"Hello World!\\n\");\n        return 0;\n}\n</code></pre>\n\n<p><strong>myhello_0.0.bb</strong> inspired from <a href=\"http://docs.openembedded.org/usermanual/usermanual.html#recipes_helloworld_example\" rel=\"nofollow noreferrer\">this one</a> :</p>\n\n<pre><code>DESCRIPTION = \"Hello world program\"\n#To prevent the LICENSE field not set error\nLICENSE = \"CLOSED\" \nPR = \"r0\"\n\nSRC_URI = \"file://helloworld.c \\\n           file://README.txt\"\n\ndo_compile() {\n        ${CC} ${CFLAGS} ${LDFLAGS} ${WORKDIR}/helloworld.c -o helloworld\n}\n\ndo_install() {\n        install -m 0755 -d ${D}${bindir} ${D}${docdir}/helloworld\n        install -m 0644 ${S}/helloworld ${D}${bindir}\n        install -m 0644 ${WORKDIR}/README.txt ${D}${docdir}/helloworld\n}\n</code></pre>\n\n<p>I have added my layer in my my bblayers.conf like so <code>${TOPDIR}/../layers/meta-hellow \\</code> and added the package in the local.conf like so <code>IMAGE_INSTALL_append = \"myhello\"</code>.</p>\n\n<p>But the problem I have, after installing it on my board with <code>opkg install</code>, is as follow :</p>\n\n<pre><code>root@colibri-imx7:~# myhello\n-sh: /usr/bin/myhello: Permission denied\n</code></pre>\n\n<p>Why is there a <code>Permission denied</code> since I'm root ?<br><br> Thank you for your help !</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1491988876, "post_id": 43365376, "comment_id": 73792454, "body": "You create one thread, so it is normal it only runs once. What exactly do you expect? Did you forget the <code>for (x = 1; x &lt; NBOFTHREADS; x++)</code> loop around <code>if(pthread_create(&amp;thread1, NULL, print_thread, &amp;x)) </code>?"}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 1, "creation_date": 1491988892, "post_id": 43365376, "comment_id": 73792467, "body": "Why do you expect it to run multiple times?"}, {"owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "edited": false, "score": 0, "creation_date": 1491989195, "post_id": 43365376, "comment_id": 73792688, "body": "This is a new thing for me, I got it now. thanks a lot."}], "answers": [{"tags": [], "owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "is_accepted": true, "score": 2, "last_activity_date": 1491989022, "creation_date": 1491989022, "answer_id": 43365468, "question_id": 43365376, "link": "https://stackoverflow.com/questions/43365376/c-thread-runs-only-once/43365468#43365468", "title": "C Thread runs only once", "body": "<p>You should think of print_thread as your new threads \"main\". It will run from start to finish and then the thread will exit. Unless you have some kind of loop inside of print_thread, it will never persist.</p>\n"}], "owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 43365468, "answer_count": 1, "score": 0, "last_activity_date": 1491989022, "creation_date": 1491988807, "question_id": 43365376, "link": "https://stackoverflow.com/questions/43365376/c-thread-runs-only-once", "title": "C Thread runs only once", "body": "<p>I want to run some jobs in parallel inside a single process.\nFor some reason the thread I've created runs only once, please help me understand where is my mistake.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid * print_thread (void * var)\n{\n    int *p_var = (int *)var;\n    printf(\"this is a thread %d\\n\", ++(*p_var));\n\n}\n\nint main()\n{\n    int x=0;\n    pthread_t thread1;\n\n\n    if(pthread_create(&amp;thread1, NULL, print_thread, &amp;x)) \n    {\n        fprintf(stderr, \"Error creating thread\\n\");\n        return 1;\n    }\n\n    while (1)\n    {\n        usleep(100000);\n    }\n\n    return 0;\n}\n\n\n# gcc -o thread pthread_example.c -lpthread\n# ./thread \nthis is a thread 1\n</code></pre>\n"}, {"tags": ["c", "math", "3d", "trigonometry"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491987692, "post_id": 43364944, "comment_id": 73791545, "body": "What is this new language called <code>C&#47;C++</code>?"}, {"owner": {"reputation": 818, "user_id": 3966756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb9b20ead96aca0c12944cc8bf60a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian L", "link": "https://stackoverflow.com/users/3966756/sebastian-l"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491987961, "post_id": 43364944, "comment_id": 73791755, "body": "such a constructive comment. I meant it doesn&#39;t matter if you compile it with <b>g++</b> or <b>gcc</b>"}, {"owner": {"reputation": 566, "user_id": 7664731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjiDx.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7664731/jay"}, "edited": false, "score": 0, "creation_date": 1491987981, "post_id": 43364944, "comment_id": 73791771, "body": "amplitudeHeight should be 5? You&#39;re just clipping the wave where the amplitude goes from 0..10 and taking the mod 5."}, {"owner": {"reputation": 566, "user_id": 7664731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjiDx.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7664731/jay"}, "edited": false, "score": 2, "creation_date": 1491988052, "post_id": 43364944, "comment_id": 73791834, "body": "Sorry, it should even be 2.5 since your taking amp * (sin() + 1)"}, {"owner": {"reputation": 818, "user_id": 3966756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb9b20ead96aca0c12944cc8bf60a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian L", "link": "https://stackoverflow.com/users/3966756/sebastian-l"}, "reply_to_user": {"reputation": 566, "user_id": 7664731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjiDx.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7664731/jay"}, "edited": false, "score": 0, "creation_date": 1491988172, "post_id": 43364944, "comment_id": 73791935, "body": "@Jay thats it, i feel kind of dumb now. Thank you :)"}, {"owner": {"reputation": 818, "user_id": 3966756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb9b20ead96aca0c12944cc8bf60a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian L", "link": "https://stackoverflow.com/users/3966756/sebastian-l"}, "reply_to_user": {"reputation": 566, "user_id": 7664731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjiDx.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7664731/jay"}, "edited": false, "score": 0, "creation_date": 1491988524, "post_id": 43364944, "comment_id": 73792193, "body": "@Jay if you post your comment as an answer i will accept it so it isn&#39;t marked as unanswered anymore ;)"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1491995924, "post_id": 43364944, "comment_id": 73797858, "body": "&quot;C or C++&quot; matters if you have to choose between <code>std::sin</code> from <code>&lt;cmath&gt;</code> or <code>sin</code> from <code>&lt;math.h&gt;</code>. Thats just a stupid example, but in general it does matter for answers if it is C or C++, even if the code in your question in principle is valid C and valid C++ (which is actually quite rare)"}], "answers": [{"tags": [], "owner": {"reputation": 566, "user_id": 7664731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjiDx.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7664731/jay"}, "is_accepted": true, "score": 1, "last_activity_date": 1491996650, "creation_date": 1491996650, "answer_id": 43368314, "question_id": 43364944, "link": "https://stackoverflow.com/questions/43364944/3d-ascii-sine-wave-generator-generates-weird-sine-waves/43368314#43368314", "title": "3D ASCII Sine wave generator generates weird sine waves", "body": "<p>The value of amplitudeHeight should be 2.5 to account for the number of symbols. You're clipping the wave where the amplitude goes from 0..20 and taking the mod 5.</p>\n"}], "owner": {"reputation": 818, "user_id": 3966756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb9b20ead96aca0c12944cc8bf60a4f?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian L", "link": "https://stackoverflow.com/users/3966756/sebastian-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 43368314, "answer_count": 1, "score": 0, "last_activity_date": 1491996650, "creation_date": 1491987645, "last_edit_date": 1491987978, "question_id": 43364944, "link": "https://stackoverflow.com/questions/43364944/3d-ascii-sine-wave-generator-generates-weird-sine-waves", "title": "3D ASCII Sine wave generator generates weird sine waves", "body": "<p>I coded a 3D sine wave generator in C/C++</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;unistd.h&gt;\n\n#define cursorForward(x) printf(\"\\033[%dC\", (x))\n#define cursorBackward(x) printf(\"\\033[%dD\", (x))\n#define cursorUp(x) printf(\"\\033[%dA\", (x))\n#define cursorDown(x) printf(\"\\033[%dB\", (x))\n#define clearScreen printf(\"\\033[2J\")\n#define width 40\n#define height 15\n#define amplitudeHeight 10\n#define period 0.1\n\nchar *values = \" .,o#\";\nfloat time = 0;\n\nint main()\n{\n    while(1) {\n        for(int y = 0; y &lt; heigth; y++) {\n            for(int x = 0; x &lt; width; x++) {\n                printf(\"%c \", values[(int) (amplitudeHeight * (sin(period * sqrt((x - width / 2) * (x - width / 2) + (y - height/ 2) * (y - height/ 2)) + time) + 1)) % 5]);\n            }\n        printf(\"\\n\");\n        }\n        usleep(1000 * 100);\n        time += 0.1;\n        cursorBackward(width);\n        cursorUp(heigth);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>you need to compile it with <strong>gcc source.c -std=c99</strong> or <strong>g++ source.c</strong></p>\n\n<p>I expected a smooth 3D sinewave as output</p>\n\n<p>My Problem is that somewhere in the formula</p>\n\n<pre><code>amplitudeHeight * //controls the AmplitudeHeight\n(sin(period * //controls the period width\nsqrt((x - width / 2) * (x - width / 2) + //controls x position \n(y - height/ 2) * (y - height/ 2)) +  //controls the y position\ntime) + 1) //time\n% 5 // i only have 5 representative chars\n</code></pre>\n\n<p>i have an error so the output looks cool but not what i expected:</p>\n\n<pre><code>. . , , o # #   . , o # #   . . , , o o o o o , , . .   # # o , .   # # o , , .\n. . , o o #   . , , o #   . . , o o o # # # o o o , . .   # o , , .   # o o , .\n. , , o # #   . , o #     . , o o # #       # # o o , .     # o , .   # # o , ,\n. , , o #     . , o #   . , o o #               # o o , .   # o , .     # o , ,\n. , , o #   . , o # #   . , o #     . . . . .     # o , .   # # o , .   # o , ,\n. , o o #   . , o #   . , o o #   . . , , , . .   # o o , .   # o , .   # o o ,\n. , o o #   . , o #   . , o #     . , , o , , .     # o , .   # o , .   # o o ,\n. , o o #   . , o #   . , o #     . , o o o , .     # o , .   # o , .   # o o ,\n. , o o #   . , o #   . , o #     . , , o , , .     # o , .   # o , .   # o o ,\n. , o o #   . , o #   . , o o #   . . , , , . .   # o o , .   # o , .   # o o ,\n. , , o #   . , o # #   . , o #     . . . . .     # o , .   # # o , .   # o , ,\n. , , o #     . , o #   . , o o #               # o o , .   # o , .     # o , ,\n. , , o # #   . , o #     . , o o # #       # # o o , .     # o , .   # # o , ,\n. . , o o #   . , , o #   . . , o o o # # # o o o , . .   # o , , .   # o o , .\n. . , , o # #   . , o # #   . . , , o o o o o , , . .   # # o , .   # # o , , .\n</code></pre>\n\n<p>the result i want to achieve is a smooth 3D sinewave, but i don't see the error in my code.</p>\n\n<p>EDIT: \nthere seems to be a little more wrong than i thought if i set the period to <strong>0.5</strong> i get:</p>\n\n<pre><code># # , o o # .     , .   o . o # # # o o , o o # # # o . o   . ,     . # o o , #\n# o   . . ,     . # o o . o # # o .   # # #   . o # # o . o o # .     , . .   o\n# o # #   .     o . .   o # # o   o . # # # . o   o # # o   . . o     .   # # o\n# , o o # .   . # o o , # # o   , # .   #   . # ,   o # # , o o # .   . # o o ,\n# . , , o     .     # o # # . o #   , . . . ,   # o . # # o #     .     o , , .\n# . . . ,     , . .   o # o   . . ,           , . .   o # o   . . ,     , . . .\n# . . . ,     , , , . # # o # #   .     .     .   # # o # # . , , ,     , . . .\n#   . . ,     o , , . # # , # # # .   . # .   . # # # , # # . , , o     , . .\n# . . . ,     , , , . # # o # #   .     .     .   # # o # # . , , ,     , . . .\n# . . . ,     , . .   o # o   . . ,           , . .   o # o   . . ,     , . . .\n# . , , o     .     # o # # . o #   , . . . ,   # o . # # o #     .     o , , .\n# , o o # .   . # o o , # # o   , # .   #   . # ,   o # # , o o # .   . # o o ,\n# o # #   .     o . .   o # # o   o . # # # . o   o # # o   . . o     .   # # o\n# o   . . ,     . # o o . o # # o .   # # #   . o # # o . o o # .     , . .   o\n# # , o o # .     , .   o . o # # # o o , o o # # # o . o   . ,     . # o o , #\n</code></pre>\n\n<p>which looks like its resonating in itself.</p>\n"}, {"tags": ["c", "arrays", "xcode"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491987559, "post_id": 43364873, "comment_id": 73791415, "body": "Source of all problems: <code>scanf(&quot;%s%s&quot;,a,b);</code>"}, {"owner": {"reputation": 35, "user_id": 7820673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc9JQ.jpg?s=128&g=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/7820673/brian-ho"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491987605, "post_id": 43364873, "comment_id": 73791460, "body": "Could you please tell me more?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7820673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc9JQ.jpg?s=128&g=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/7820673/brian-ho"}, "edited": false, "score": 0, "creation_date": 1491987709, "post_id": 43364924, "comment_id": 73791556, "body": "Is there any reason why it was moved to the front for array a?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 35, "user_id": 7820673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc9JQ.jpg?s=128&g=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/7820673/brian-ho"}, "edited": false, "score": 2, "creation_date": 1491987786, "post_id": 43364924, "comment_id": 73791611, "body": "@BrianHo <i>Undefined behavior</i> is by its very definition undefined. But it&#39;s likely that the array <code>b</code> is before <code>a</code> in memory, and the terminator for <code>b</code> is written in the first element of <code>a</code>. However, that memory layout should not be counted upon, it&#39;s a compiler-specific implementation detail and can change between platforms, compilers or even after updating the current compiler to a new version."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1491987730, "last_edit_date": 1491987730, "creation_date": 1491987597, "answer_id": 43364924, "question_id": 43364873, "link": "https://stackoverflow.com/questions/43364873/c-array-first-input-0/43364924#43364924", "title": "C Array First Input &quot;\\0&quot;", "body": "<p>Strings in C are really called <a href=\"http://en.cppreference.com/w/c/string/byte\" rel=\"nofollow noreferrer\"><strong><em>null terminated</strong> byte strings</em></a>. That name gives a hint that there is a special terminator for the strings, which is the <code>'\\0'</code> character.</p>\n\n<p>A string of four characters needs space for <em>five</em> characters, with the fifth being the null terminator.</p>\n\n<p>When you input four characters with your <code>scanf</code> call, the function will write the fifth (the terminator) <em>out of bounds</em>. And writing out of bounds leads to <em>undefined behavior</em>.</p>\n"}], "owner": {"reputation": 35, "user_id": 7820673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc9JQ.jpg?s=128&g=1", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/7820673/brian-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 43364924, "answer_count": 1, "score": 0, "last_activity_date": 1491987730, "creation_date": 1491987441, "question_id": 43364873, "link": "https://stackoverflow.com/questions/43364873/c-array-first-input-0", "title": "C Array First Input &quot;\\0&quot;", "body": "<p>The arrays <code>[a]</code> and <code>[b]</code> are supposed to take in 4 numbers each on two separate lines, and output <code>?A?B</code>, as in the famous number guessing game. (For instance, <code>1234\\n1347</code> should output <code>1A2B</code>.) However, I found out that the <code>1</code> at <code>a[0]</code> gets replaced by <code>\\0</code> while the others are still fine. (Side-note: This happened on XCode, but not on Visual Studio.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char a[4], b[4];\n    int i, j;\n    int A = 0, B = 0;\n\n    scanf(\"%s%s\",a,b);\n\n    for(i=0;i&lt;4;i++)\n        if(a[i] == b[i])\n            A++;\n    for(i=0;i&lt;4;i++)\n        for(j=0;j&lt;4;j++)\n            if(a[i] == b[j])\n                B++;\n\n    B = B-A;\n\n    printf(\"%dA%dB\\n\",A,B);\n\n    return 0;\n}\n</code></pre>\n\n<p>Changing the arrays to size <code>[5]</code> solves the problem, but I want to understand what's going on. Thanks!</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491987375, "post_id": 43364836, "comment_id": 73791282, "body": "<code>after long time and effort I finished my 1500 rows code in C.</code>...well, think again of your learning approach."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1491987454, "post_id": 43364836, "comment_id": 73791343, "body": "<code>while (n &gt; MAXLOGGERS)</code> is false for anything <code>n &lt; 26</code>, so how do you enter the input exactly?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491987582, "post_id": 43364836, "comment_id": 73791438, "body": "<i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</i>"}, {"owner": {"reputation": 208, "user_id": 3811082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391bfa8fef884a411face8df93934c4?s=128&d=identicon&r=PG&f=1", "display_name": "user3811082", "link": "https://stackoverflow.com/users/3811082/user3811082"}, "edited": false, "score": 0, "creation_date": 1491987620, "post_id": 43364836, "comment_id": 73791477, "body": "Check your max heap size value"}, {"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491987699, "post_id": 43364836, "comment_id": 73791547, "body": "Did you saw that you allocate <code>5000 * (n + 1 ) * ( sizeof(int) * 6 + 3 * sizeof(float))</code> around : 5000 * 12 * ( 2 * 6 + 3 * 4 ) = <b>1 440 000 bytes</b>. [Estimated size of int and float, which may change for each system]. Check the max size you can allocate ;)"}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491987951, "post_id": 43364836, "comment_id": 73791747, "body": "@Sourav Ghoshwhile: (n &gt; MAXLOGGERS) {Prompts you to use n &lt; 26}  I guess the desired behavior is not to crash? :D"}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "reply_to_user": {"reputation": 208, "user_id": 3811082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391bfa8fef884a411face8df93934c4?s=128&d=identicon&r=PG&f=1", "display_name": "user3811082", "link": "https://stackoverflow.com/users/3811082/user3811082"}, "edited": false, "score": 0, "creation_date": 1491988249, "post_id": 43364836, "comment_id": 73791996, "body": "@user3811082: How do I do that?"}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "reply_to_user": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491988255, "post_id": 43364836, "comment_id": 73792001, "body": "@kaldoran: Yes I know, I have in total 15 loggers (want to make the code run for up to 26) and each one has usually about 4100 rows (I used 5000 just to be sure), but is there a restriction in the maximum size to allocate? And can I change that?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1491988299, "post_id": 43364836, "comment_id": 73792037, "body": "@Segmentationfault Large allocations are typically better on the heap, not on the stack. Operating systems might impose limits on stack size, but more rarely on heap usage. Use <code>malloc()</code>."}, {"owner": {"reputation": 208, "user_id": 3811082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8391bfa8fef884a411face8df93934c4?s=128&d=identicon&r=PG&f=1", "display_name": "user3811082", "link": "https://stackoverflow.com/users/3811082/user3811082"}, "edited": false, "score": 0, "creation_date": 1491988326, "post_id": 43364836, "comment_id": 73792063, "body": "look here <a href=\"http://stackoverflow.com/questions/14697170/program-heap-size\">stackoverflow.com/questions/14697170/program-heap-size</a>"}, {"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1491988548, "post_id": 43364836, "comment_id": 73792212, "body": "As @unwind point out, there is a limit on the stack, see <a href=\"http://lists.gnu.org/archive/html/bug-coreutils/2009-10/msg00262.html\" rel=\"nofollow noreferrer\">lists.gnu.org/archive/html/bug-coreutils/2009-10/msg00262.ht&zwnj;&#8203;ml</a> for example. Btw, if you use 4100 rows, you still allocated 5000 ^^"}], "answers": [{"comments": [{"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491989113, "post_id": 43365204, "comment_id": 73792617, "body": "You should avoid casting the return of the malloc <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\" title=\"do i cast the result of malloc\">stackoverflow.com/questions/605845/&hellip;</a>. And as you do, always free the memory that have been allocated [We are not doing Java here]"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491989460, "post_id": 43365204, "comment_id": 73792889, "body": "@kaldoran Well, there are different oppinions about doing the cast or not (showing 216 upvotes for the answer &#39;why you should do it&#39;...). I personally (admitted, coming from C++) adhere the opinion of the &#39;do cast&#39; fraction (admitted again: a minority...)."}, {"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491989603, "post_id": 43365204, "comment_id": 73793011, "body": "Well indeed, then the user will choose to do so or not ^^"}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "edited": false, "score": 0, "creation_date": 1491991206, "post_id": 43365204, "comment_id": 73794301, "body": "Thanx, this is working very well! Unfortunately, even though I changed all my mydata[x][y] to mydata[x*(n+1) + y]; the results I get are not as they were before, data from one x are getting overwritten on the other. This makes sense because before I used the mydata[x][y].hour/minute/second to calibrate loggers so they all start from the same time, so I need to change a big part of the code to compete for the lack of a 2x matrix.  Any idea if there is a way just to increase the stack capacity, so I do not need to run all over it again?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1491998163, "post_id": 43365204, "comment_id": 73799335, "body": "<code>x*(n+1)</code> was just to illustrate - instead, I would increase n first and use the increased value further on: <code>++n; malloc([...] * n * [...]); array[x*n+y];</code> - if you need both (n, n+1), you could use a second variable. You should not get a difference compared to <code>[x][y]</code>, actually, the latter is under the hoods transformed to the former by the compiler anyway..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "edited": false, "score": 0, "creation_date": 1491998295, "post_id": 43365204, "comment_id": 73799406, "body": "@Segmentationfault Unfortunately, I there was an error in my answer: it must, of course, be <code>array[x * ROWS + y]</code> for the index access. This is the reason for &quot;one x overwriting another one&quot;! Sorry for that..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1491998521, "post_id": 43365204, "comment_id": 73799560, "body": "Explanation: You &quot;wrap&quot; n+1 arrays, each of size ROWS, one after another into a large array. Distance from one wrapped array to the next one is, of course, the size of such a wrapped array, which is ROWS, thus <code>x*ROWS + y</code>."}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "edited": false, "score": 0, "creation_date": 1491998826, "post_id": 43365204, "comment_id": 73799822, "body": "@Aconcagua Not a problem! It&#39;s a mathematical issue after all how will I manipulate my 1x matrix in place of the 2x. Probably thinking something like assigning the first 5000 values to each n, exactly as you said.I&#39;m just a bit too tired to do the changes right now. Thank you very much for your help!"}, {"owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "edited": false, "score": 0, "creation_date": 1492015248, "post_id": 43365204, "comment_id": 73812655, "body": "Works like a charm!"}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 1, "last_activity_date": 1491998221, "last_edit_date": 1491998221, "creation_date": 1491988318, "answer_id": 43365204, "question_id": 43364836, "link": "https://stackoverflow.com/questions/43364836/struct-array-length-error/43365204#43365204", "title": "struct array length error", "body": "\n\n<pre><code>struct data mydata[n+1][ROWS];\n</code></pre>\n\n<p>You are allocating a very large (two-dimensional) array on the stack, which is consumed up entirely with <code>n &gt;= 11</code> (on my system, too, leading to a stack overflow which shows up as a segmentation fault).</p>\n\n<p>For such large data, you should rather allocate memory on the heap. This worked fine (on my machine at least):</p>\n\n<pre><code>//struct data mydata[n+1][ROWS];\nstruct data* mydata = (struct data*)malloc(sizeof(struct data) * (n+1) * ROWS);\nprintf(\"\\n\\nSuccess!!\\n\");\nfree(mydata);\n</code></pre>\n\n<p>Only, access to the array is not that nice any more, as you cannot use the double index operator. You'd have to calculate your offsets yourself:</p>\n\n<pre><code>// mydata[x][y]; gets: \nmydata[x*ROWS + y];\n</code></pre>\n\n<p>Do not oversee the call to <code>free</code> - every data <code>malloc</code>ed should be <code>free</code>d again. Getting used to this principle right from the start (thinking of <code>free</code> right the same time when typing <code>malloc</code>) will help you in preventing memory leaks.</p>\n\n<p>As hinted in the comments (and answers referenced from), stack size is normally limited, whereas the only limits imposed for the heap is the size of the (yet unused) physical memory of your machine, which (typically) is far larger. If you happen to run out of system memory, <code>malloc</code> won't crash but return a null pointer. So you actually should check for:</p>\n\n<pre><code>struct data* mydata = (struct data*)malloc(sizeof(struct data) * (n+1) * ROWS);\nif(mydata)\n{\n    printf(\"\\n\\nSuccess!!\\n\");\n    free(mydata);\n}\nelse\n{\n    printf(\"\\n\\nOut of memory!!\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7804708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KE7eH.jpg?s=128&g=1", "display_name": "Segmentation fault", "link": "https://stackoverflow.com/users/7804708/segmentation-fault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 43365204, "answer_count": 1, "score": 1, "last_activity_date": 1491998221, "creation_date": 1491987345, "question_id": 43364836, "link": "https://stackoverflow.com/questions/43364836/struct-array-length-error", "title": "struct array length error", "body": "<p>I'm a beginner in C and after long time and effort I finished my 1500 rows code in C. It was running perfectly and producing results as expected, but when I tried to add more input than the tests I faced a breakdown.</p>\n\n<p>More specifically, I managed to find the source of the problem in the struct array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;windows.h&gt;\n\n#define ROWS 5000\n#define MAXLOGGERS 26\n\nstruct data\n    {\n        int day;\n        int month;\n        int year;\n        int hour;\n        int minute;\n        int second;\n        float value;\n        float temp;\n        float hum;\n    };  \n\nint main()\n{\n    printf(\"Enter the number of loggers that you want to import: \");\n    int n = 10;\n\n    while (n &gt; MAXLOGGERS)\n    {\n        printf(\"You can input data from maximum %d loggers: \", MAXLOGGERS);\n        scanf(\"%d\", &amp;n);\n    }\n\n    struct data mydata[n+1][ROWS];\n\n    printf(\"\\n\\nSuccess!!\\n\");\n}\n</code></pre>\n\n<p>Now when I use n = 10 or less, the program finishes as expected. When I change n to 11 or more it crashes.</p>\n\n<p>I'm suspecting something is wrong with the declaration of the struct array, but I can really not figure it out.</p>\n\n<p>Any help would be more than welcome!\nThanx (:</p>\n"}, {"tags": ["c", "winapi"], "answers": [{"tags": [], "owner": {"reputation": 5010, "user_id": 773879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zqTIy.jpg?s=128&g=1", "display_name": "Mark Segal", "link": "https://stackoverflow.com/users/773879/mark-segal"}, "is_accepted": true, "score": 4, "last_activity_date": 1491987610, "creation_date": 1491987610, "answer_id": 43364929, "question_id": 43364802, "link": "https://stackoverflow.com/questions/43364802/should-i-free-global-memory-after-globalrealloc/43364929#43364929", "title": "Should I free global memory after GlobalRealloc?", "body": "<ol>\n<li><p>No, if the function succeeded, the old memory is now invalid, the contents were copied to the newly allocated area, and you should use the new pointer from now on. So if the function succeed, do not free the old memory</p></li>\n<li><p>If the function fails, no changes were done. This means that the old pointer is still valid and you can use it. Now, if you want to free the old pointer, you can. Generally, the state of the program now is the same as before you called <code>GlobalReAlloc</code>.</p></li>\n</ol>\n"}], "owner": {"reputation": 3946, "user_id": 4444768, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vVqiI.jpg?s=128&g=1", "display_name": "LmTinyToon", "link": "https://stackoverflow.com/users/4444768/lmtinytoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 43364929, "answer_count": 1, "score": 1, "last_activity_date": 1491987610, "creation_date": 1491987258, "question_id": 43364802, "link": "https://stackoverflow.com/questions/43364802/should-i-free-global-memory-after-globalrealloc", "title": "Should I free global memory after GlobalRealloc?", "body": "<p>I just want to check whether I understood meaning of <code>GlobalReAlloc</code> function correctly. Shortly, <code>GlobablRealloc</code> changes size or memory object or its attributes. I have following questions:</p>\n\n<pre><code> HGlobal old_mem = GlobalAlloc(...);\n HGlobal new_mem = GlobalReAlloc(12345, old_mem, 0); // Should I free old_mem?\n</code></pre>\n\n<ol>\n<li>Should I free old memory object after reallocing? As I understood function just changes memory object itself and returns updated memory object. Please, correct me if I am wrong</li>\n<li>Should I free old memory object in the case of failed reallocation?</li>\n</ol>\n"}, {"tags": ["c", "data-structures", "linked-list"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5435034, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/724652329/picture?type=large", "display_name": "Jerome Papalie", "link": "https://stackoverflow.com/users/5435034/jerome-papalie"}, "edited": false, "score": 0, "creation_date": 1491987215, "post_id": 43364690, "comment_id": 73791136, "body": "So if I wanted to write a function to insert data into the list, I&#39;d have to create new nodes using the struct ListNode? @fluter"}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1491987309, "post_id": 43364690, "comment_id": 73791227, "body": ":@JeromePapalie Yes. The LinkedList represents the whole list and ListNode represents individual items in the list."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1491987312, "post_id": 43364690, "comment_id": 73791233, "body": "Yes, that is what ListNode for."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 21, "user_id": 5435034, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/724652329/picture?type=large", "display_name": "Jerome Papalie", "link": "https://stackoverflow.com/users/5435034/jerome-papalie"}, "edited": false, "score": 0, "creation_date": 1491987996, "post_id": 43364690, "comment_id": 73791781, "body": "@JeromePapalie If it is inside a function, you cannot do that, as it contains  uninitiazlied data. You have to set the fields."}, {"owner": {"reputation": 21, "user_id": 5435034, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/724652329/picture?type=large", "display_name": "Jerome Papalie", "link": "https://stackoverflow.com/users/5435034/jerome-papalie"}, "edited": false, "score": 0, "creation_date": 1491988358, "post_id": 43364690, "comment_id": 73792088, "body": "Could you please help me with that? I just started learning Data Structures and C, and I&#39;m still struggling to wrap my head around initializing it inside a function. @fluter"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1491988508, "post_id": 43364690, "comment_id": 73792186, "body": "You could use the code in my post to initialize it, another way is to set each member one by one: <code>LinkedList list;    list.size = 0;  list.head = NULL;</code>"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 1, "last_activity_date": 1491987251, "last_edit_date": 1491987251, "creation_date": 1491986967, "answer_id": 43364690, "question_id": 43364604, "link": "https://stackoverflow.com/questions/43364604/linked-list-definition/43364690#43364690", "title": "Linked List Definition", "body": "<p><code>LinkedList</code> is a struct denoting a linked list by holding its head and its size, while each node in the list is denoted by struct <code>ListNode</code>. This is a common paradigm if you want to maintain the size of the linked list, in the case you can easily get the number of nodes in the list without have to iterate through it. On the other hand, if size is not concern, you can just use a pointer to node for the head without have to define the <code>LinkedList</code> struct.</p>\n\n<p>So for an empty list, you would have:</p>\n\n<pre><code>LinkedList list = (struct LinkedList){0, NULL};\n</code></pre>\n\n<p>For a list with one node:</p>\n\n<pre><code>ListNode node;\nnode.item = 0;\nnode.next = NULL;\nlist.head = &amp;node;\nlist.size = 1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 2044349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c17b7c75ccc7a39cb85effee61a04f?s=128&d=identicon&r=PG&f=1", "display_name": "vcode", "link": "https://stackoverflow.com/users/2044349/vcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1492045655, "last_edit_date": 1492045655, "creation_date": 1491990189, "answer_id": 43365944, "question_id": 43364604, "link": "https://stackoverflow.com/questions/43364604/linked-list-definition/43365944#43365944", "title": "Linked List Definition", "body": "<p>A linked list is held using a local pointer variable which points to the first item of the list. If that pointer is also NULL, then the list is considered to be empty.</p>\n\n<p><img src=\"https://i.stack.imgur.com/y63By.gif\" alt=\"\"></p>\n\n<pre><code>include &lt;stdio.h&gt;\n\nint main() {\n    typedef struct node {\n        int val;\n        struct node * next;\n    } node_t;\n\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5435034, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/724652329/picture?type=large", "display_name": "Jerome Papalie", "link": "https://stackoverflow.com/users/5435034/jerome-papalie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 43364690, "answer_count": 2, "score": 1, "last_activity_date": 1492045655, "creation_date": 1491986732, "last_edit_date": 1491987401, "question_id": 43364604, "link": "https://stackoverflow.com/questions/43364604/linked-list-definition", "title": "Linked List Definition", "body": "<p>This snippet of code is from an assignment I'm working on at school for a data structures module. This bit of code is provided in the question, and I can't understand this.    </p>\n\n<pre><code>typedef struct _listnode {\n    int item;\n    struct _listnode *next;\n} ListNode; // You should not change the definition of ListNode\n\ntypedef struct _linkedlist {\n    int size;\n    ListNode *head;\n} LinkedList; // You should not change the definition of LinkedList \n</code></pre>\n\n<p>I am confused because my lecture slides and sites I've been to check this out have just defined the node, and not the second one.</p>\n\n<p>Can anyone help me with this please?</p>\n"}, {"tags": ["c", "string", "char", "int", "hex"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1491987143, "post_id": 43364420, "comment_id": 73791079, "body": "<code>char tempTime = &quot;082431&quot;;</code> won&#39;t compile. Please create <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491987887, "post_id": 43364420, "comment_id": 73791688, "body": "<code>hex_response</code> in the calling code has wrong type; you should really post accurate code that compiles - i.e. the question should include the code you are asking about, rather than code that bares a passing similarity - otherwise we will be addressing the wrong problem."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491988060, "post_id": 43364420, "comment_id": 73791843, "body": "The function <code>dec_hex</code> is misleadingly named since it is not converting &quot;decimal to hex&quot;, but rather an integer to a hex string representation; you already performed the decimal string reprsentation to integer conversion with <code>atoi()</code>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491988388, "post_id": 43364420, "comment_id": 73792106, "body": "It is also not a good idea to pass a variable string as the format string argument to <code>printf()</code>; use instead the format string &quot;%s&quot;, and pass the string to be output as a second argument."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491988657, "post_id": 43364420, "comment_id": 73792288, "body": "Making the buffer length for the hex the same as the length of the decimal is safe (because it will always be as long to longer) but makes little sense.  Hex representation requires exactly one character for each four bits, so the buffer can more appropriately be sized for the length of a <code>long int</code>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491998667, "post_id": 43364420, "comment_id": 73799665, "body": "It is not clear what <code>tempTime</code> is or contains, but presumably points to <code>&quot;095154.000...&quot;</code> given the expected value?  You should ideally post complete code that reproduces the problem - these are still broken fragments."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491999040, "post_id": 43364420, "comment_id": 73799987, "body": "This is still not &quot;real&quot; code; <code>int_hex()</code> takes an argument named <code>hextresponse</code>, but writes to <code>hex_response</code>.  Write the code, compile it, and copy &amp; paste code that at least compiles!"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1491999933, "post_id": 43364420, "comment_id": 73800663, "body": "Array elements are indexed from from zero, and charavter constants use single quotes, so should be <code>tempTime[6 ]= &#39;\\0&#39; ;</code>.  Your inability to post plausible/compilable code is severely hampering giving an accurate answer.  There is no point in addressing this question when this is certainly not the actual code producing the error - we&#39;ll just end up addressing the flaws in your post rather than the actual problem."}], "answers": [{"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1492000078, "post_id": 43367252, "comment_id": 73800764, "body": "While it is certainly correct in this case to use <code>atol()</code>; what platform are you using where <code>int</code> and <code>long int</code> are not the same size?  Or are you using some antique 16 bit compiler? That would have been useful information."}, {"owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1492032382, "post_id": 43367252, "comment_id": 73821930, "body": "I&#39;m using the latest version of Atmel Studio 6."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1492033092, "post_id": 43367252, "comment_id": 73822193, "body": "I meant the <i>target</i> platform, not the <i>development</i> platform.  Moreover Atmel Studio can be used for developing for Atmel&#39;s ARM and AVR, so the answer is not enlightening, but given that this is the solution, you are presumably targeting AVR?  My point is that had you stated that in the question or tagged it, the error may have been spotted more quickly.  Credit for posting an answer however rather then just &quot;disappearing&quot;."}, {"owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1492034955, "post_id": 43367252, "comment_id": 73822959, "body": "It is an AVR platform. My apologies for the confusion."}, {"owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1492041031, "post_id": 43367252, "comment_id": 73824829, "body": "Clifford, Just have one question for you so I understand better. Can you explain the &quot;(sizeof(long int) * CHAR_BIT / 4) + 1&quot; part of the code? Thank you"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1492068074, "post_id": 43367252, "comment_id": 73833313, "body": "<code>CHAR_BIT</code> is defined in limits.h and is the number of bits in a <code>char</code> (typically but not universally 8); <code>sizeof(long int)</code> is the size in <code>char</code>s of a <code>long int</code>, <code>4</code> is the number of bits which a hex digit <i>exactly</i> represents (0x0 to 0xF).  So the expression calculates the number of characters needed to represent then maximum length hex string possible from a <code>long int</code>.  Say a <code>long int</code> is 4 bytes (32 bit), then the expression yields (4 * 8) / 4 = 8 - the number of characters needed to represent a 32 bit value in hex."}], "tags": [], "owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "is_accepted": false, "score": 1, "last_activity_date": 1491993586, "creation_date": 1491993586, "answer_id": 43367252, "question_id": 43364420, "link": "https://stackoverflow.com/questions/43364420/converting-decimal-to-hex-is-truncating-the-first-digit/43367252#43367252", "title": "Converting Decimal to Hex is truncating the first digit", "body": "<p>The solution was to change the following code</p>\n\n<pre><code>num = atoi(tempTime);  // String to int conversion\n</code></pre>\n\n<p>to</p>\n\n<pre><code>num = atol(tempTime);  // String to long conversion\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492068330, "creation_date": 1491986258, "last_edit_date": 1492068300, "question_id": 43364420, "link": "https://stackoverflow.com/questions/43364420/converting-decimal-to-hex-is-truncating-the-first-digit", "title": "Converting Decimal to Hex is truncating the first digit", "body": "<p>I have a function to convert decimal to HEX but it's truncating the first character when returning the hex string. Why and how is it truncating the returned string?</p>\n\n<p>this is the char string I'm dissecting:</p>\n\n<pre><code>str = \"095154.000,4506.1389N,07389.6017W,2.00,290.0,3,299.12,0.08,0.04,120417,05\";\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>char str[90];\nchar** tokens;\ntokens = str_split(str, ',');\n\nstrncpy(tempTime, *(tokens)+9, 6);tempTime[7]=\"\\0\";\n\nnum = atoi(tempTime);\nchar hex_response[(sizeof(long int) * CHAR_BIT / 4) + 1];\nprintf(\"%s\", int_hex(num, hex_response));\n\nchar* int_hex(long int num, char* hextresponse)\n{\n    sprintf(hex_response, \"%lX\", (unsigned long)num);\n\n    return hextresponse;\n}\n</code></pre>\n\n<p>hex_response returns 73B2 and it should return 173B2</p>\n"}, {"tags": ["c", "arrays", "casting", "memcpy", "atoi"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1491989901, "post_id": 43364389, "comment_id": 73793264, "body": "When you read a book, do you tear off pages you have read?"}], "answers": [{"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 1, "last_activity_date": 1491987074, "last_edit_date": 1491987074, "creation_date": 1491986770, "answer_id": 43364613, "question_id": 43364389, "link": "https://stackoverflow.com/questions/43364389/wrong-values-breaking-big-char-into-int-array/43364613#43364613", "title": "Wrong values - Breaking big char into int Array", "body": "<p>Here is something that works.</p>\n\n<ol>\n<li>I used pointer arithmetic in place of shifting the while character array.</li>\n<li>I used a specific conversion function as you already know that all your numbers are written using two digits (using a generic function is then not necessary).</li>\n<li>I corrected your string as there was two spaces between \"99 16\". </li>\n<li>I used an appropriate format string in printf to avoid the testing for length of number representation.</li>\n</ol>\n\n<p>Here is what I get:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint convertTwoDigitsToInt(char *p) {\n  return (p[0]-'0')*10+p[1]-'0';\n}\n\nint main(void){\n\n    char str[3]; \n    char stringArr[] \n    =\"08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08 49 49 99 40 17 81 18 57 60 87 17 40 98 43 69 48 04 56 62 00 81 49 31 73 55 79 14 29 93 71 40 67 53 88 30 03 49 13 36 65 52 70 95 23 04 60 11 42 69 24 68 56 01 32 56 71 37 02 36 91 22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 33 13 80 24 47 32 60 99 03 45 02 44 75 33 53 78 36 84 20 35 17 12 50 32 98 81 28 64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70 67 26 20 68 02 62 12 20 95 63 94 39 63 08 40 91 66 49 94 21 24 55 58 05 66 73 99 26 97 17 78 78 96 83 14 88 34 89 63 72 21 36 23 09 75 00 76 44 20 45 35 14 00 61 33 97 34 31 33 95 78 17 53 28 22 75 31 67 15 94 03 80 04 62 16 14 09 53 56 92 16 39 05 42 96 35 31 47 55 58 88 24 00 17 54 24 36 29 85 57 86 56 00 48 35 71 89 07 05 44 44 37 44 60 21 58 51 54 17 58 19 80 81 68 05 94 47 69 28 73 92 13 86 52 17 77 04 89 55 40 04 52 08 83 97 35 99 16 07 97 57 32 16 26 26 79 33 27 98 66 88 36 68 87 57 62 20 72 03 46 33 67 46 55 12 32 63 93 53 69 04 42 16 73 38 25 39 11 24 94 72 18 08 46 29 32 40 62 76 36 20 69 36 41 72 30 23 88 34 62 99 69 82 67 59 85 74 04 36 16 20 73 35 29 78 31 90 01 74 31 49 71 48 86 81 16 23 57 05 54 01 70 54 71 83 51 54 69 16 92 33 48 61 43 52 01 89 19 67 48\";                \n\n    int Arr[20][20] = { 0 };\n    int num;    \n    int liner,row;\n    int i,j;\n\n    char *current = stringArr;                        // point to the beginning\n\n    for(i = 0; i &lt; 20; i++){\n        for(j = 0 ; j &lt; 20; j++){\n          Arr[i][j] = convertTwoDigitsToInt(current); // convert the two chars pointed\n          printf(\"%2d  \",Arr[i][j]);                  // print the conversion\n          current += 3;                               // advance pointer by three places\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;        \n}\n</code></pre>\n\n<p>Execution produces:</p>\n\n<pre><code> 8   2  22  97  38  15   0  40   0  75   4   5   7  78  52  12  50  77  91   8  \n49  49  99  40  17  81  18  57  60  87  17  40  98  43  69  48   4  56  62   0  \n81  49  31  73  55  79  14  29  93  71  40  67  53  88  30   3  49  13  36  65  \n52  70  95  23   4  60  11  42  69  24  68  56   1  32  56  71  37   2  36  91  \n22  31  16  71  51  67  63  89  41  92  36  54  22  40  40  28  66  33  13  80  \n24  47  32  60  99   3  45   2  44  75  33  53  78  36  84  20  35  17  12  50  \n32  98  81  28  64  23  67  10  26  38  40  67  59  54  70  66  18  38  64  70  \n67  26  20  68   2  62  12  20  95  63  94  39  63   8  40  91  66  49  94  21  \n24  55  58   5  66  73  99  26  97  17  78  78  96  83  14  88  34  89  63  72  \n21  36  23   9  75   0  76  44  20  45  35  14   0  61  33  97  34  31  33  95  \n78  17  53  28  22  75  31  67  15  94   3  80   4  62  16  14   9  53  56  92  \n16  39   5  42  96  35  31  47  55  58  88  24   0  17  54  24  36  29  85  57  \n86  56   0  48  35  71  89   7   5  44  44  37  44  60  21  58  51  54  17  58  \n19  80  81  68   5  94  47  69  28  73  92  13  86  52  17  77   4  89  55  40  \n 4  52   8  83  97  35  99  16   7  97  57  32  16  26  26  79  33  27  98  66  \n88  36  68  87  57  62  20  72   3  46  33  67  46  55  12  32  63  93  53  69  \n 4  42  16  73  38  25  39  11  24  94  72  18   8  46  29  32  40  62  76  36  \n20  69  36  41  72  30  23  88  34  62  99  69  82  67  59  85  74   4  36  16  \n20  73  35  29  78  31  90   1  74  31  49  71  48  86  81  16  23  57   5  54  \n 1  70  54  71  83  51  54  69  16  92  33  48  61  43  52   1  89  19  67  48\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1491988143, "last_edit_date": 1491988143, "creation_date": 1491987686, "answer_id": 43364957, "question_id": 43364389, "link": "https://stackoverflow.com/questions/43364389/wrong-values-breaking-big-char-into-int-array/43364957#43364957", "title": "Wrong values - Breaking big char into int Array", "body": "<p>Why not using standard <a href=\"https://linux.die.net/man/3/sscanf\" rel=\"nofollow noreferrer\">sscanf</a> function?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char stringArr[] = \"08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08 49 49 99 40 17 81 18 57 60 87 17 40 98 43 69 48 04 56 62 00 81 49 31 73 55 79 14 29 93 71 40 67 53 88 30 03 49 13 36 65 52 70 95 23 04 60 11 42 69 24 68 56 01 32 56 71 37 02 36 91 22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 33 13 80 24 47 32 60 99 03 45 02 44 75 33 53 78 36 84 20 35 17 12 50 32 98 81 28 64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70 67 26 20 68 02 62 12 20 95 63 94 39 63 08 40 91 66 49 94 21 24 55 58 05 66 73 99 26 97 17 78 78 96 83 14 88 34 89 63 72 21 36 23 09 75 00 76 44 20 45 35 14 00 61 33 97 34 31 33 95 78 17 53 28 22 75 31 67 15 94 03 80 04 62 16 14 09 53 56 92 16 39 05 42 96 35 31 47 55 58 88 24 00 17 54 24 36 29 85 57 86 56 00 48 35 71 89 07 05 44 44 37 44 60 21 58 51 54 17 58 19 80 81 68 05 94 47 69 28 73 92 13 86 52 17 77 04 89 55 40 04 52 08 83 97 35 99 16  07 97 57 32 16 26 26 79 33 27 98 66 88 36 68 87 57 62 20 72 03 46 33 67 46 55 12 32 63 93 53 69 04 42 16 73 38 25 39 11 24 94 72 18 08 46 29 32 40 62 76 36 20 69 36 41 72 30 23 88 34 62 99 69 82 67 59 85 74 04 36 16 20 73 35 29 78 31 90 01 74 31 49 71 48 86 81 16 23 57 05 54 01 70 54 71 83 51 54 69 16 92 33 48 61 43 52 01 89 19 67 48\";\n\n    int Arr[20][20];\n    int i, j;\n    size_t strIndex = 0;\n\n    size_t strLength = sizeof(stringArr)-1;\n\n    for (i = 0; i &lt; 20; i++)\n    {\n        for (j = 0; j &lt; 20; j++)\n        {\n            if (strIndex &lt; strLength)\n            {\n                sscanf(&amp;stringArr[strIndex], \"%02d \", &amp;Arr[i][j]);\n                strIndex += 3;\n\n                printf(\" %2d\", Arr[i][j]);\n            }\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>OUTPUT</p>\n\n<pre><code>  8  2 22 97 38 15  0 40  0 75  4  5  7 78 52 12 50 77 91  8\n 49 49 99 40 17 81 18 57 60 87 17 40 98 43 69 48  4 56 62  0\n 81 49 31 73 55 79 14 29 93 71 40 67 53 88 30  3 49 13 36 65\n 52 70 95 23  4 60 11 42 69 24 68 56  1 32 56 71 37  2 36 91\n 22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 33 13 80\n 24 47 32 60 99  3 45  2 44 75 33 53 78 36 84 20 35 17 12 50\n 32 98 81 28 64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70\n 67 26 20 68  2 62 12 20 95 63 94 39 63  8 40 91 66 49 94 21\n 24 55 58  5 66 73 99 26 97 17 78 78 96 83 14 88 34 89 63 72\n 21 36 23  9 75  0 76 44 20 45 35 14  0 61 33 97 34 31 33 95\n 78 17 53 28 22 75 31 67 15 94  3 80  4 62 16 14  9 53 56 92\n 16 39  5 42 96 35 31 47 55 58 88 24  0 17 54 24 36 29 85 57\n 86 56  0 48 35 71 89  7  5 44 44 37 44 60 21 58 51 54 17 58\n 19 80 81 68  5 94 47 69 28 73 92 13 86 52 17 77  4 89 55 40\n  4 52  8 83 97 35 99 16  7 97 57 32 16 26 26 79 33 27 98 66\n 88 36 68 87 57 62 20 72  3 46 33 67 46 55 12 32 63 93 53 69\n  4 42 16 73 38 25 39 11 24 94 72 18  8 46 29 32 40 62 76 36\n 20 69 36 41 72 30 23 88 34 62 99 69 82 67 59 85 74  4 36 16\n 20 73 35 29 78 31 90  1 74 31 49 71 48 86 81 16 23 57  5 54\n  1 70 54 71 83 51 54 69 16 92 33 48 61 43 52  1 89 19 67 48\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6326677, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-S0KD5rFu4IM/AAAAAAAAAAI/AAAAAAAAABc/mUvTLW_Tvdc/photo.jpg?sz=128", "display_name": "Omri Ziner", "link": "https://stackoverflow.com/users/6326677/omri-ziner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491988143, "creation_date": 1491986150, "question_id": 43364389, "link": "https://stackoverflow.com/questions/43364389/wrong-values-breaking-big-char-into-int-array", "title": "Wrong values - Breaking big char into int Array", "body": "<p>I have a very big string which contains 2 digit numbers and space between them in that order xx xx xx ... etc'.\nI'm trying to convert every to digits to int and store in in 20x20 int array.\nFor this mission I'm using memcpy to coppy the first 2 digit of the string, atoi to cast in to int from char and inner function I wrote which moves the string \"left\" every for round.\nit works fine for something like 60 number and then it gets wrong number to the end of the program.\nthis is the code :</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid shiftRightStrign(char * string){\n\n    int i;\n\n    for(i = 0 ; i &lt; 397 ; i++){string[i] = string[i+3];}\n}\n\nint main(void){\n\n    char str[3]; \n    char stringArr[] \n    =\"08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08 49 49 99 40 17 81 18 57 60 87 17 40 98 43 69 48 04 56 62 00 81 49 31 73 55 79 14 29 93 71 40 67 53 88 30 03 49 13 36 65 52 70 95 23 04 60 11 42 69 24 68 56 01 32 56 71 37 02 36 91 22 31 16 71 51 67 63 89 41 92 36 54 22 40 40 28 66 33 13 80 24 47 32 60 99 03 45 02 44 75 33 53 78 36 84 20 35 17 12 50 32 98 81 28 64 23 67 10 26 38 40 67 59 54 70 66 18 38 64 70 67 26 20 68 02 62 12 20 95 63 94 39 63 08 40 91 66 49 94 21 24 55 58 05 66 73 99 26 97 17 78 78 96 83 14 88 34 89 63 72 21 36 23 09 75 00 76 44 20 45 35 14 00 61 33 97 34 31 33 95 78 17 53 28 22 75 31 67 15 94 03 80 04 62 16 14 09 53 56 92 16 39 05 42 96 35 31 47 55 58 88 24 00 17 54 24 36 29 85 57 86 56 00 48 35 71 89 07 05 44 44 37 44 60 21 58 51 54 17 58 19 80 81 68 05 94 47 69 28 73 92 13 86 52 17 77 04 89 55 40 04 52 08 83 97 35 99 16  07 97 57 32 16 26 26 79 33 27 98 66 88 36 68 87 57 62 20 72 03 46 33 67 46 55 12 32 63 93 53 69 04 42 16 73 38 25 39 11 24 94 72 18 08 46 29 32 40 62 76 36 20 69 36 41 72 30 23 88 34 62 99 69 82 67 59 85 74 04 36 16 20 73 35 29 78 31 90 01 74 31 49 71 48 86 81 16 23 57 05 54 01 70 54 71 83 51 54 69 16 92 33 48 61 43 52 01 89 19 67 48\";                \n\n    int Arr[20][20] = { 0 };\n    int num;    \n    int liner,row;\n    int i,j;\n\n\n    for(i = 0; i &lt; 20; i++){\n        for(j = 0 ; j &lt; 20; j++){\n            memcpy(str,stringArr,2);\n            Arr[i][j] = atoi(str);\n            //printf(\"atoi value is %d\\n\",atoi(str));\n            if(Arr[i][j] &lt; 9){printf(\"%d   \",Arr[i][j]);}\n            else{printf(\"%d  \",Arr[i][j]);}\n            shiftRightStrign(stringArr);           \n        }\n        printf(\"\\n\");\n    }\n\n    return 0;        \n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp", "network-programming", "ip"], "comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1491986668, "post_id": 43364318, "comment_id": 73790734, "body": "at which point does he throw that error`?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1491992218, "post_id": 43364318, "comment_id": 73795017, "body": "You are using INET sockets, not <a href=\"https://stackoverflow.com/questions/tagged/unix-socket\">unix-socket</a>s."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491987498, "post_id": 43364482, "comment_id": 73791374, "body": "serverip is the server&#39;s ip address - I am just hard coding that for now to test if I can successfully connect to the server. I used uint32_t because that is the type the address is stored in struct in_addr according to: <a href=\"https://linux.die.net/man/7/ip\" rel=\"nofollow noreferrer\">linux.die.net/man/7/ip</a>. I changed it and tried using inet_pton but I am still getting the same error."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491987586, "post_id": 43364482, "comment_id": 73791440, "body": "What is the hardcoded value? It might play a role since you are also calling <code>htonl</code> on that."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491987823, "post_id": 43364482, "comment_id": 73791627, "body": "@AliSyed Please post the exact error you get and the location where you get the error?"}, {"owner": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491988180, "post_id": 43364482, "comment_id": 73791946, "body": "Connect returns -1 and then this code executes: if (retval == -1)         {             printf(&quot;error: %i\\n&quot;, errno);             retval = connect(clientfd, (struct sockaddr*) &amp;clientsock,                     sizeof(struct sockaddr_in));         }."}, {"owner": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491988208, "post_id": 43364482, "comment_id": 73791961, "body": "the lines &quot;error while connecting..\\n&quot; and &quot;error: 22&quot; print to screen iteratively then due to the while loop"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491988423, "post_id": 43364482, "comment_id": 73792129, "body": "@AliSyed There isn&#39;t &quot;error while connecting&quot; code in your post, so maybe update with the new code."}, {"owner": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491988659, "post_id": 43364482, "comment_id": 73792289, "body": "Apologies. Just did it. The gist of it is that connect() keeps returning -1."}, {"owner": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "edited": false, "score": 0, "creation_date": 1491989767, "post_id": 43364482, "comment_id": 73793143, "body": "I researched and used the inet_pton method and it worked. Thank you!"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 0, "last_activity_date": 1491986743, "last_edit_date": 1491986743, "creation_date": 1491986427, "answer_id": 43364482, "question_id": 43364318, "link": "https://stackoverflow.com/questions/43364318/connect-call-on-client-side-unix-socket-programming/43364482#43364482", "title": "connect call on client side unix socket programming", "body": "<p>Errno 22 is <code>EINVAL</code>, which means some of the arguments you passed to <code>connect</code> are not valid. One of the possible error is that you are setting the sockaddr with assigning to a <code>uint32_t</code>:</p>\n\n<pre><code>uint32_t serverip=; //ip goes here\nclientsock.sin_addr.s_addr = htonl(serverip);\n</code></pre>\n\n<p>What is exactly the serverip? How do you get it? Generally you should call <code>getaddrinfo</code> or <code>inet_pton</code> to convert hostname or dotted ip string to <code>sockaddr.sin_addr</code>. For example, if you use <code>getaddrinfo</code>, you can use the <code>sockaddr</code> directly returned by it:</p>\n\n<pre><code>connect(clientfd, res-&gt;ai_addr, res-&gt;ai_addrlen);\n</code></pre>\n\n<p>or if you use <code>inet_pton</code>,</p>\n\n<pre><code>inet_pton(AF_INET, ipstr, &amp;clientsock.sin_addr.s_addr);\n</code></pre>\n\n<p>Also, it's better to check <code>socket</code> return value for any errors:</p>\n\n<pre><code>int clientfd = socket(AF_INET, SOCK_STREAM, 0);\nif (clientfd &lt; 0) {\n      // error\n      exit(1);\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6906849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e86acc3098892984d24e6095f27cf3a?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/6906849/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491990733, "creation_date": 1491985947, "last_edit_date": 1491990733, "question_id": 43364318, "link": "https://stackoverflow.com/questions/43364318/connect-call-on-client-side-unix-socket-programming", "title": "connect call on client side unix socket programming", "body": "<p>I am a newbie to Unix networking and I cannot understand what is wrong with my code. I have researched a lot and logically the code should work but I am pulling my hair out right now. The client side connect call keeps throwing an error - setting <code>errno</code> to <code>22</code>. I don't understand what is wrong with the way arguments to connect are being passed.</p>\n\n<p>The client side code is:</p>\n\n<pre><code>#include &lt;netinet/in.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n\n    char buffer[256];\n    uint32_t\n    serverip=; //ip goes here\n\n    struct sockaddr_in clientsock;\n    memset(&amp;clientsock, 0, sizeof(clientsock));\n    clientsock.sin_family = AF_INET;\n    clientsock.sin_addr.s_addr = htonl(serverip);\n    clientsock.sin_port = htons((unsigned short) 5000);\n    socklen_t clientsocksize = sizeof(clientsock);\n    int clientfd = socket(AF_INET, SOCK_STREAM, 0);\n    int retval = -1;\n\n    retval = connect(clientfd, (struct sockaddr*) &amp;clientsock,\n            sizeof(struct sockaddr_in));\n\n    while (1)\n    {\n        if (retval == -1)\n        {\n            printf(\"error while connecting...\\n\");\n            printf(\"error: %i\\n\", errno);\n            retval = connect(clientfd, (struct sockaddr*) &amp;clientsock,\n                    sizeof(struct sockaddr_in));\n        }\n        else if (retval == 0)\n        {\n            printf(\"connection returned: %i\\n\", retval);\n            printf(\"please enter data: \");\n            bzero((char *) &amp;buffer, sizeof(buffer));\n            fgets(buffer, 255, stdin);\n            write(clientfd, buffer, sizeof(buffer));\n        }\n        else\n        {\n            printf(\"error in else: %i\\n\", errno);\n\n        }\n    }\n}\n</code></pre>\n\n<p>Any guidance and critique would be greatly appreciated. </p>\n"}, {"tags": ["c", "pointers", "structure"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1491985978, "post_id": 43364218, "comment_id": 73790247, "body": "Node juggling in linked lists is all about changing the <i>pointers</i> that point to those nodes. Take your time, and it will become clearer how to do that."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1491986051, "post_id": 43364218, "comment_id": 73790291, "body": "Are you <i>sure</i> the new list should be &quot;C 3, B 2, C 3&quot; and not &quot;C 3, B 2, A 1&quot;? If you want to sort you usually <i>swap</i> &quot;elements&quot; (nodes in your case), and the name &quot;interchange&quot; also implies that the nodes switches places with each other."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1491986232, "post_id": 43364218, "comment_id": 73790418, "body": "And <i>swapping</i> nodes in a double-linked list is actually really simple: Keep track of each of the two nodes previous and next nodes, and make their prev/next links point to the other node in the swap, and finally update the nodes you swap to point their prev/next links to the correct nodes. Try to do it on paper first, and when you think you got it right try to code it."}, {"owner": {"reputation": 89, "user_id": 6024047, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bbe61b9cb85afcc96c870ab5c8532972?s=128&d=identicon&r=PG&f=1", "display_name": "sNow 11", "link": "https://stackoverflow.com/users/6024047/snow-11"}, "edited": false, "score": 0, "creation_date": 1491986372, "post_id": 43364218, "comment_id": 73790528, "body": "Yes, sorry, I edited it. Should be C 3, B 2, A 1. The interchange function works properly. My problem is when I try to sort it using the QSNode* tmp. I am going to post  a print with the interchange as well."}, {"owner": {"reputation": 842, "user_id": 6572460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3c0888e8617ae4a4c18fc6b3cba6d517?s=128&d=identicon&r=PG&f=1", "display_name": "Nguai al", "link": "https://stackoverflow.com/users/6572460/nguai-al"}, "edited": false, "score": 0, "creation_date": 1492012680, "post_id": 43364218, "comment_id": 73811073, "body": "I don&#39;t see any  typedef declarations.   Isn&#39;t it supposed to be &quot;struct DataNode * instead of &quot;DataNode *&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 432, "user_id": 7245173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-gktj-toDgUk/AAAAAAAAAAI/AAAAAAAAAj0/4ZKPOh6tRbc/photo.jpg?sz=128", "display_name": "Emil Terman", "link": "https://stackoverflow.com/users/7245173/emil-terman"}, "is_accepted": false, "score": 1, "last_activity_date": 1492012087, "creation_date": 1492012087, "answer_id": 43374193, "question_id": 43364218, "link": "https://stackoverflow.com/questions/43364218/how-to-change-2-nodes-in-a-double-linked-list-by-using-pointers-c/43374193#43374193", "title": "How to change 2 nodes in a double Linked List by using pointers? C", "body": "<p>Here's a quick implementation of your problem in C.</p>\n\n<p>Includes: swapping and sorting (merge sort).</p>\n\n<p>Hope it helps :)</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct      DataNode {\n    char*           name;\n    int             number;\n}                   DataNode;\n\ntypedef struct      QSNode {\n    DataNode*       data;\n    struct QSNode*  prev;\n    struct QSNode*  next;\n}                   QSNode;\n\nvoid            node_swap(QSNode **head, QSNode *first, QSNode *second)\n{\n    QSNode  *tmp;\n\n    if (first-&gt;next != NULL)\n        first-&gt;next-&gt;prev = second;\n    if (first-&gt;prev != NULL)\n        first-&gt;prev-&gt;next = second;\n\n    if (second-&gt;next != NULL)\n        second-&gt;next-&gt;prev = first;\n    if (second-&gt;prev != NULL)\n        second-&gt;prev-&gt;next = first;\n    tmp = first-&gt;next;\n    first-&gt;next = second-&gt;next;\n    second-&gt;next = tmp;\n\n    tmp = first-&gt;prev;\n    first-&gt;prev = second-&gt;prev;\n    second-&gt;prev = tmp;\n    if (first == *head)\n        *head = second;\n}\n\nDataNode        *new_data(char *name, int nr)\n{\n    DataNode    *result;\n\n    result = (DataNode*)malloc(sizeof(DataNode));\n    result-&gt;name = name;\n    result-&gt;number = nr;\n    return (result);\n}\n\nQSNode          *new_node(DataNode *data)\n{\n    QSNode  *result;\n\n    result = (QSNode*)malloc(sizeof(QSNode));\n    result-&gt;next = NULL;\n    result-&gt;prev = NULL;\n    result-&gt;data = data;\n    return (result);\n}\n\nvoid            add_node(QSNode **head, QSNode *new_node, QSNode *prev)\n{\n    if (*head == NULL)\n    {\n        *head = new_node;\n        new_node-&gt;prev = prev;\n    }\n    else\n        add_node(&amp;((*head)-&gt;next), new_node, *head);\n}\n\nvoid            print_list(QSNode *head)\n{\n    if (head)\n    {\n        printf(\"%d\\n\", head-&gt;data-&gt;number);\n        if (head-&gt;prev)\n            printf(\"\\tprev: %d\\n\", head-&gt;prev-&gt;data-&gt;number);\n        else\n            printf(\"\\tprev: NULL\\n\");\n        printf(\"\\n\");\n        print_list(head-&gt;next);\n    }\n}\n\n/*\n** Merge sort\n*/\n\nstatic void     arrange_prev_vals(QSNode *head, QSNode *prev)\n{\n    if (head != NULL)\n    {\n        head-&gt;prev = prev;\n        arrange_prev_vals(head-&gt;next, head);\n    }\n}\n\nstatic void     front_back_split(\n                    QSNode *source,\n                    QSNode **front_ref,\n                    QSNode **back_ref)\n{\n    QSNode  *fast;\n    QSNode  *slow;\n\n    if (source == NULL || source-&gt;next == NULL)\n    {\n        *front_ref = source;\n        *back_ref = NULL;\n    }\n    else\n    {\n        slow = source;\n        fast = source-&gt;next;\n        while (fast != NULL)\n        {\n            fast = fast-&gt;next;\n            if (fast != NULL)\n            {\n                slow = slow-&gt;next;\n                fast = fast-&gt;next;\n            }\n        }\n        *front_ref = source;\n        *back_ref = slow-&gt;next;\n        slow-&gt;next = NULL;\n    }\n}\n\nstatic QSNode   *sorted_merge(QSNode *a, QSNode *b, int (*cmp)(DataNode*, DataNode*))\n{\n    QSNode  *result;\n\n    if (a == NULL)\n        return (b);\n    else if (b == NULL)\n        return (a);\n    if (cmp(a-&gt;data, b-&gt;data) &gt; 0)\n    {\n        result = a;\n        result-&gt;next = sorted_merge(a-&gt;next, b, cmp);\n    }\n    else\n    {\n        result = b;\n        result-&gt;next = sorted_merge(a, b-&gt;next, cmp);\n    }\n    return (result);\n}\n\nvoid            ft_lst_merge_sort(QSNode **head_ref, int (*cmp)(DataNode*, DataNode*))\n{\n    QSNode  *head;\n    QSNode  *a;\n    QSNode  *b;\n\n    head = *head_ref;\n    if (head == NULL || head-&gt;next == NULL)\n        return ;\n    front_back_split(head, &amp;a, &amp;b);\n    ft_lst_merge_sort(&amp;a, cmp);\n    ft_lst_merge_sort(&amp;b, cmp);\n    *head_ref = sorted_merge(a, b, cmp);\n    arrange_prev_vals(*head_ref, NULL);\n}\n\n/*\n** A function used to compare nodes\n*/\n\nint     cmp_numbers(DataNode *data1, DataNode *data2)\n{\n    return (data2-&gt;number - data1-&gt;number);\n}\n\nint     cmp_rev_numbers(DataNode *data1, DataNode *data2)\n{\n    return (data1-&gt;number - data2-&gt;number);\n}\n\n\nint     main()\n{\n    QSNode *head;\n    QSNode  *swap1;\n    QSNode  *swap2;\n\n    head = NULL;\n    add_node(&amp;head, new_node(new_data(\"1\", 1)), NULL);\n    add_node(&amp;head, new_node(new_data(\"2\", 2)), NULL);\n    add_node(&amp;head, new_node(new_data(\"3\", 3)), NULL);\n    add_node(&amp;head, new_node(new_data(\"4\", 4)), NULL);\n    add_node(&amp;head, new_node(new_data(\"5\", 5)), NULL);\n\n    /*\n    ** Swap demonstration\n    */\n\n    swap1 = head;                           //node 1\n    swap2 = head-&gt;next-&gt;next-&gt;next-&gt;next;   //node 5\n\n    printf(\"Swaping: %d with %d\\n\", swap1-&gt;data-&gt;number, swap2-&gt;data-&gt;number);\n    node_swap(&amp;head, swap1, swap2);\n    print_list(head);\n\n    /*\n    ** Sort demonstration\n    */\n\n    printf(\"Sorting ascending:\\n\");\n    ft_lst_merge_sort(&amp;head, &amp;cmp_numbers);\n\n    print_list(head);\n    printf(\"Sorting descending:\\n\");\n    ft_lst_merge_sort(&amp;head, &amp;cmp_rev_numbers);\n\n    print_list(head);\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Swaping: 1 with 5\n5\n    prev: NULL\n\n2\n    prev: 5\n\n3\n    prev: 2\n\n4\n    prev: 3\n\n1\n    prev: 4\n\nSorting ascending:\n1\n    prev: NULL\n\n2\n    prev: 1\n\n3\n    prev: 2\n\n4\n    prev: 3\n\n5\n    prev: 4\n\nSorting descending:\n5\n    prev: NULL\n\n4\n    prev: 5\n\n3\n    prev: 4\n\n2\n    prev: 3\n\n1\n    prev: 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1492530476, "creation_date": 1492530476, "answer_id": 43476740, "question_id": 43364218, "link": "https://stackoverflow.com/questions/43364218/how-to-change-2-nodes-in-a-double-linked-list-by-using-pointers-c/43476740#43476740", "title": "How to change 2 nodes in a double Linked List by using pointers? C", "body": "<p><em>(Posted on behalf of the OP)</em>.</p>\n\n<p>The problem was in the <em>interchange function</em>.</p>\n\n<p>Correct function:</p>\n\n<pre><code>QSNode* test123(QSNode* list, QSNode* first, QSNode* second) {\nQSNode* mark1 = first;\nQSNode* mark2 = second;\nfirst-&gt;prev-&gt;next = second;\nsecond-&gt;next-&gt;prev = first;\n\nfirst-&gt;next = second-&gt;next;\nsecond-&gt;next = first;\nsecond-&gt;prev = first-&gt;prev;\nfirst-&gt;prev = second;\n\nif (mark1 == list)\n    return second;\nelse\nif (mark2 == list)\n    return first;\nelse\n    return list;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6024047, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bbe61b9cb85afcc96c870ab5c8532972?s=128&d=identicon&r=PG&f=1", "display_name": "sNow 11", "link": "https://stackoverflow.com/users/6024047/snow-11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492530490, "creation_date": 1491985638, "last_edit_date": 1492530490, "question_id": 43364218, "link": "https://stackoverflow.com/questions/43364218/how-to-change-2-nodes-in-a-double-linked-list-by-using-pointers-c", "title": "How to change 2 nodes in a double Linked List by using pointers? C", "body": "<p>The problem goes like this: I have to sort a double linked list by changing the nodes(NOT THE VALUES in it).\nSo, lets say I have this list:</p>\n\n<pre><code>struct DataNode {\n    char* name;\n    int number;\n};\n\nstruct QSNode {\n    DataNode* data;\n    QSNode* prev;\n    QSNode* next;\n};\n</code></pre>\n\n<p>I create 3 nodes with the data: ( A 1, B 2, C 3).</p>\n\n<p>Now, what I want to do is interchange A 1 with C 3 so it will look like this ( C 3, B 2, A 1), but not changing the values, but the actual nodes.\nNow, I did that by using this function:</p>\n\n<pre><code>QSNode* interchangeNodes(QSNode* list, QSNode* first, QSNode* second) {\n    QSNode* mark1 = first;\n    QSNode* mark2 = second;\n\n    first-&gt;next = second-&gt;next;\n    second-&gt;next = first;\n    first-&gt;prev-&gt;next = second;\n    second-&gt;prev = first-&gt;prev;\n    second-&gt;next-&gt;prev = first;\n    first-&gt;prev = second;\n    QSNode* mark3 = second;\n        second = first;\n        first = mark3;\n\n\n    if (mark1 == list)\n         return first;\n    else\n    if (mark2 == list)\n        return second;\n    else \n    if (mark2 == list-&gt;prev){\n        list-&gt;prev = second;\n        return list;\n    }\n    else\n        return list;    \n}\n</code></pre>\n\n<p>Why it looks like this? Because even if I change the nodes, say: C 3, B 2, A 1, I want C 3 to be my header. So when I call the function to preview data in the list, C 3 will be first.</p>\n\n<pre><code>void previewList(QSNode* list) {\n\n    QSNode* marker = list;  \n    while (list-&gt;next != marker) {\n        cout &lt;&lt; \"Name: \" &lt;&lt; list-&gt;data-&gt;name &lt;&lt; \" Number: \" &lt;&lt; list-&gt;data-&gt;number &lt;&lt; endl;\n        list = list-&gt;next;\n    }\n    cout &lt;&lt; \"Name: \" &lt;&lt; list-&gt;data-&gt;name &lt;&lt; \" Number: \" &lt;&lt; list-&gt;data-&gt;number &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Ok, and now the problem. When I try to sort it (the point is not to destroy the list and rearrange it, but to change the node`s pointers.)</p>\n\n<p>Ok, the problem is I tried so many options, I do not care for complexity at this point, so Bubble sort could work. The problem is here:</p>\n\n<pre><code>QSNode* sortFinale1(QSNode* list){\n    int count = 1;\n    QSNode * tmp = list;\n    while (tmp-&gt;next != list) {\n        if (tmp-&gt;data-&gt;number &gt; tmp-&gt;next-&gt;data-&gt;number){\n            list = interchangeNodes(list, tmp, tmp-&gt;next);\n        }\n        tmp = tmp-&gt;next;\n    }\n    return list;\n}\n</code></pre>\n\n<p><strong>NOTE:</strong> This function is just a test one, to show that one nodes is not pointed to after one iteration.</p>\n\n<p>I try to make a tmp so that my list stays the same and behaves like an array. But the problem is that I lose connections.\nInput:</p>\n\n<pre><code>Name4 3\nName3 4\nName2 1\nName1 2\n</code></pre>\n\n<p>preview List output &amp;&amp; call to sortFinale1 function:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TRyju.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TRyju.png\" alt=\"enter image description here\"></a></p>\n\n<p>output with interchange:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Wnn6Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wnn6Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>My guess is that I am missing something in that sortFinale1 condition. </p>\n"}, {"tags": ["c", "encryption", "openssl", "javacard"], "comments": [{"owner": {"reputation": 471, "user_id": 4635695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jFKTv.png?s=128&g=1", "display_name": "JavaCardOS", "link": "https://stackoverflow.com/users/4635695/javacardos"}, "edited": false, "score": 0, "creation_date": 1492046781, "post_id": 43363617, "comment_id": 73826174, "body": "Give us your RSA key and all data."}], "answers": [{"tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": false, "score": 1, "last_activity_date": 1492001620, "creation_date": 1492001620, "answer_id": 43370132, "question_id": 43363617, "link": "https://stackoverflow.com/questions/43363617/is-rsa-no-pad-algorithm-different-in-copenssl-and-javacard/43370132#43370132", "title": "Is RSA_NO_PAD algorithm different in C(openssl) and Javacard", "body": "<p>Your data is probably larger than the modulus when <em>interpreted</em> as a unsigned big endian integer value. RSA in the end works on numbers, not bytes. If the value is larger then the value will first be converted into the value Y = X % N where X is the original value and N is the modulus (and % is the modulus or remainder operation).</p>\n\n<p>So you can only encrypt data that represents a number between 0 and N, otherwise your result is ambiguous (it can be either Y or Y + N). A useful trick is to make sure that your input data length is at least one bit smaller than the modulus length (although often the complete most significant / leftmost byte is set to either <code>00</code> or <code>01</code>).</p>\n\n<hr>\n\n<p>Note that - with the possible exception of RSA-KEM - using RSA without PKCS#1 v1.5 padding or OAEP padding is <em>insecure</em>.</p>\n"}], "owner": {"reputation": 191, "user_id": 6135078, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/jcYIp.png?s=128&g=1", "display_name": "Pranay Kumar", "link": "https://stackoverflow.com/users/6135078/pranay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1492001620, "creation_date": 1491983911, "question_id": 43363617, "link": "https://stackoverflow.com/questions/43363617/is-rsa-no-pad-algorithm-different-in-copenssl-and-javacard", "title": "Is RSA_NO_PAD algorithm different in C(openssl) and Javacard", "body": "<p>I have a 128 byte RSA Key. I have encrypted data of length 128 bytes in the javacard applet using the public key and decrypted it in the C application using private key of the same key pair. The resultant data is different than the original data. What is the reason for it? </p>\n\n<p>Javacard Code</p>\n\n<pre><code>asymCipher = Cipher.getInstance(Cipher.ALG_RSA_NOPAD, false);\nasymCipher.init(PkTCA, Cipher.MODE_ENCRYPT);\nasymCipher.doFinal(data, (short)0, (short)data.length, encrypted, (short)0);\n</code></pre>\n\n<p>C Code</p>\n\n<pre><code>int padding = RSA_NO_PADDING;\n\nint private_decrypt(unsigned char * enc_data,int data_len,unsigned char * key, unsigned char *decrypted)\n{\n    RSA * rsa = createRSA(key,0);\n    int  result = RSA_private_decrypt(data_len,enc_data,decrypted,rsa,padding);\n    return result;\n}\n\nencrypted_length = private_decrypt(PkAIKR,strlen(PkAIKR),privateKeyTCA,PkAIKR_dec);\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1491983205, "post_id": 43363367, "comment_id": 73788446, "body": "That said, use <code>%p</code> for printing pointers."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1491983246, "post_id": 43363367, "comment_id": 73788463, "body": "... which you must manually cast to <code>void*</code> when you pass them as arguments"}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1491984855, "post_id": 43363367, "comment_id": 73789499, "body": "Probably <code>b</code> is loaded with LF (new line) code. You enter e.g. <code>Y</code>, hit enter - first <code>scanf</code> gets <code>Y</code>, second - LF (new line/enter). Add 2-3 additional <code>scanf</code>-s."}], "owner": {"reputation": 11, "user_id": 7653984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X7Hii6g_Ek4/AAAAAAAAAAI/AAAAAAAACe4/TUf9SLfWqAg/photo.jpg?sz=128", "display_name": "Kin Hang Lee", "link": "https://stackoverflow.com/users/7653984/kin-hang-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1491983180, "answer_count": 0, "score": 0, "last_activity_date": 1491983065, "creation_date": 1491983065, "question_id": 43363367, "link": "https://stackoverflow.com/questions/43363367/this-program-only-allow-me-to-enter-once-why", "closed_reason": "Duplicate", "title": "This program only allow me to enter once, why?", "body": "<pre><code> char a;\n char b;\n\nprintf(\"Enter a charater: \");\nscanf(\"%c\", &amp;a);\nprintf(\"Your input is: %c\\n\", a);\nprintf(\"The address of this charater is: %u\\n\", &amp;a);\n\nprintf(\"Enter a charater: \");\nscanf(\"%c\", &amp;b);\nprintf(\"Your input is: %c\\n\", b);\nprintf(\"The address of this charater is: %u\\n\", &amp;b);    \n</code></pre>\n\n<p>I can only input the first one, it skips the second input, why???</p>\n"}, {"tags": ["c", "visual-studio", "char", "flex-lexer", "lex"], "comments": [{"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1491980442, "post_id": 43362015, "comment_id": 73786734, "body": "Code is text, please include it as such. Images cannot be copied to editors and cannot be searched. All in all create a <a href=\"http://stackoverflow.com/help/mcve\">minimal, complete and verifiable example</a>. It does not have to be your code verbatim. You can create a separate little example that demonstrates your problem."}, {"owner": {"reputation": 393, "user_id": 6714635, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56089c2b976d8df8cc3135c0bb58d7f7?s=128&d=identicon&r=PG&f=1", "display_name": "secret", "link": "https://stackoverflow.com/users/6714635/secret"}, "reply_to_user": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1491981300, "post_id": 43362015, "comment_id": 73787253, "body": "added the code as asked...."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 1, "creation_date": 1491981668, "post_id": 43362015, "comment_id": 73787509, "body": "On buglet: the printfs have excess args without a format, atoi(yytext). Did you enable all warnings from your compiler?"}, {"owner": {"reputation": 393, "user_id": 6714635, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56089c2b976d8df8cc3135c0bb58d7f7?s=128&d=identicon&r=PG&f=1", "display_name": "secret", "link": "https://stackoverflow.com/users/6714635/secret"}, "reply_to_user": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1491982365, "post_id": 43362015, "comment_id": 73787952, "body": "@Jens , that is not the issue, I fixed it and yet problem stays the same..."}], "answers": [{"tags": [], "owner": {"reputation": 393, "user_id": 6714635, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56089c2b976d8df8cc3135c0bb58d7f7?s=128&d=identicon&r=PG&f=1", "display_name": "secret", "link": "https://stackoverflow.com/users/6714635/secret"}, "is_accepted": true, "score": 1, "last_activity_date": 1491989164, "creation_date": 1491989164, "answer_id": 43365526, "question_id": 43362015, "link": "https://stackoverflow.com/questions/43362015/char-is-always-changing-using-flex/43365526#43365526", "title": "char is always changing using flex", "body": "<p>Problem was since yytext update itself, you need to copy it to a new char in order to work</p>\n"}], "owner": {"reputation": 393, "user_id": 6714635, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/56089c2b976d8df8cc3135c0bb58d7f7?s=128&d=identicon&r=PG&f=1", "display_name": "secret", "link": "https://stackoverflow.com/users/6714635/secret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1492029412, "accepted_answer_id": 43365526, "answer_count": 1, "score": 0, "last_activity_date": 1492244958, "creation_date": 1491978850, "last_edit_date": 1492244958, "question_id": 43362015, "link": "https://stackoverflow.com/questions/43362015/char-is-always-changing-using-flex", "closed_reason": "Duplicate", "title": "char is always changing using flex", "body": "<p>I'm trying to learn how to use flex and I'm having some issues:</p>\n\n<ul>\n<li>each time when a token is found I want it to be store in a token I created, that part works just fine!</li>\n<li><p>the issue begins when it gets to the next token for example, if I've written:\n\"a bcd\" , it should identify it as a token a, and then as a token bcd, instead I'm getting the next:</p>\n\n<p>token a(at the first scan),<br>\nand at the second scan I'm getting 2 tokens:<br>\ntoken a<br>\ntoken a bcd.  </p></li>\n</ul>\n\n<p>What am I missing? (When it recognize bcd, it just changes the token a to a bcd for some reason).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 8, "creation_date": 1491978557, "post_id": 43361911, "comment_id": 73785656, "body": "s/<code>pos = sprintf</code>/<code>pos += sprintf</code>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1491978942, "post_id": 43361911, "comment_id": 73785828, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "reply_to_user": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 1, "creation_date": 1491979172, "post_id": 43361911, "comment_id": 73785950, "body": "Yep - @a3f has it.  Also this line <code>tagstr[strlen(tagstr) - 1] = &#39;\\0&#39;;</code> is....wrong...as well as unnecessary.  Also the initial size of your array is not big enough until about n=4"}, {"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 1, "creation_date": 1491979394, "post_id": 43361911, "comment_id": 73786099, "body": "Also, why is your loop going from 1 to n instead of 0 to n-1?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 0, "creation_date": 1491979427, "post_id": 43361911, "comment_id": 73786123, "body": "@NoseKnowsAll probably for printing only. :)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 0, "creation_date": 1491979429, "post_id": 43361911, "comment_id": 73786126, "body": "@NoseKnowsAll because the values being printed warrant it. It has nothing to do with indexing."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "edited": false, "score": 0, "creation_date": 1491979485, "post_id": 43361911, "comment_id": 73786165, "body": "@LoztInSpace that line has purpose (trim the last <code>+</code> from the string), but it could be better done with simply <code>tagstr[pos-1] = 0;</code> once the fix from a3f is deployed."}, {"owner": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1491979685, "post_id": 43361911, "comment_id": 73786298, "body": "@WhozCraig Ah yes."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 2, "last_activity_date": 1491980171, "creation_date": 1491980171, "answer_id": 43362430, "question_id": 43361911, "link": "https://stackoverflow.com/questions/43361911/c-programming-sprinf-issue/43362430#43362430", "title": "C programming sprinf issue", "body": "<p>There are two main issues in your code; the one - as already mentioned in the comments - is that you do not increase <code>pos</code> but reassign it again and again with (almost) the same value. Hence, after the first iteration, you will constantly write to a position at <code>4</code> (or <code>5</code> if <code>k</code> would become >=10 and the numbers would thereby get more digits),</p>\n\n<p>Second, your <code>malloc</code> will not work for small <code>k</code>s, since each string like <code>\"+1^2\"</code> takes at least 4 characters; so if you size the buffer with <code>n * n</code>,  then the buffer will be too small if <code>n</code> is &lt;= 3, and (probably much) too big if <code>n</code> becomes larger.</p>\n\n<p>I'd suggest to assume a maximum range of <code>n</code> (let's say up to 7 digits) and dimension the buffer accordingly.</p>\n\n<p>A minor thing (and not essential) is that you probably could avoid writing superfluous <code>+</code> at all in that you use a different format string for the first iteration; just do show the idea, really not essential:</p>\n\n<pre><code>char* formatSeries(int n)\n{\n    const size_t maxSize = n * (7+3) + 1;\n\n    char *tagstr = (char *)malloc(sizeof(char)*maxSize);\n\n    int pos = 0 ;\n    int k;\n    for (k = 1; k &lt;= n; k++)\n    {\n        const char* formatStr = (k==1) ? \"%d^2\" : \"+%d^2\";\n        pos += sprintf(&amp;tagstr[pos], formatStr, k);\n\n    }\n    return tagstr;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7572884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d589ba8d66eda1b5210dc9756b315ed?s=128&d=identicon&r=PG&f=1", "display_name": "Noct", "link": "https://stackoverflow.com/users/7572884/noct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 43362430, "answer_count": 1, "score": -1, "last_activity_date": 1491998296, "creation_date": 1491978474, "last_edit_date": 1491998296, "question_id": 43361911, "link": "https://stackoverflow.com/questions/43361911/c-programming-sprinf-issue", "title": "C programming sprinf issue", "body": "<p>I'm using <code>sprintf</code> to print <code>int</code> variable which should display <code>1^2+2^2+3^2+4^2+5^2+6^2</code>. But my code only prints <code>1^2+6^2</code>. I don't know why the middle part is missing. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar* formatSeries(int n)\n{\n  char *tagstr = (char *)malloc(sizeof(char)*n*n);\n\n  int pos = 0 ;\n  int k;\n\n  for (k = 1; k &lt;= n; k++)\n  {\n    pos = sprintf(&amp;tagstr[pos], \"%d^2+\", k);\n  }\n  tagstr[strlen(tagstr) - 1] = '\\0';\n\n  return tagstr;\n}\n\n void main()\n{\n  int n = 6;\n  printf(\"%s \\n\", formatSeries(n));\n}\n</code></pre>\n"}, {"tags": ["c", "producer-consumer"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1491978951, "post_id": 43361830, "comment_id": 73785831, "body": "That does not look appropriate to me. A common queue makes sense if any of the consumers can handle any of the messages, which is not the case in your example. What would consumer 2 do if next message in the queue it gets actually is for consumer 1 and vice versa?"}, {"owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1491983210, "post_id": 43361830, "comment_id": 73788447, "body": "@Aconcagua: that is what the message type is for."}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "is_accepted": false, "score": 1, "last_activity_date": 1491983152, "creation_date": 1491983152, "answer_id": 43363397, "question_id": 43361830, "link": "https://stackoverflow.com/questions/43361830/how-to-use-the-same-fifo-for-more-consumers-and-producers/43363397#43363397", "title": "How to use the same fifo for more consumers and producers?", "body": "<p>The key is a randomly selectable integer. If you generate the key with <code>ftok()</code>, you get the same key as long you refer to the same path and the same id, cf. the <a href=\"http://man7.org/linux/man-pages/man3/ftok.3.html\" rel=\"nofollow noreferrer\">man page</a>. If you want the same key, it is a bad idea to use a relative path (as you did), since your programs may have different directories. Use an absolute path.</p>\n\n<p>However, please consider the remark of Aconcagua. If you use a common queue, you need different type ids (you use id=1 for both).  </p>\n"}], "owner": {"reputation": 39, "user_id": 7818917, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09bbe5216c04e2a5db754be479637685?s=128&d=identicon&r=PG&f=1", "display_name": "Laurentiu", "link": "https://stackoverflow.com/users/7818917/laurentiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491983152, "creation_date": 1491978241, "question_id": 43361830, "link": "https://stackoverflow.com/questions/43361830/how-to-use-the-same-fifo-for-more-consumers-and-producers", "title": "How to use the same fifo for more consumers and producers?", "body": "<p>I created the two producers and two consumers, producer1 sent to consumer1 two integer number and consumer1 print the sum of numbers, and I have another consumer and producer, producer2 sent to consumer2 the path for folder and consumer2 print the all files from directory (ls command from linux). An now I want to merge together this, for example I want as all producers and consumer to use the same message queue.</p>\n\n<p>This is my code for producer1:\n//IPC_msgq_send.c</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAXSIZE     128\n\nstruct msgbuf\n{\n    long    mtype;\n    char    mtext[MAXSIZE];\n};\n\nint main() {\n    int msqid;\n    // int msgflg = IPC_CREAT | 0666;\n    key_t key;\n    struct msgbuf sbuf;\n    size_t buflen;\n\n    key = ftok(\".\", 'g');\n\n    //Get the message queue ID for the given key\n    if ((msqid = msgget(key, IPC_CREAT | 0666 )) &lt; 0) {\n      perror(\"Could not get message queue\\n\");\n      exit(1);\n    }\n    printf(\"MSQID value: %d\\n\", msqid);\n    //Message Type\n    sbuf.mtype = 1;\n    printf(\"Enter a path for a folder : \");\n    scanf(\"%[^\\n]\",sbuf.mtext);\n\n    // getchar();\n\n    buflen = strlen(sbuf.mtext) + 1 ;\n\n    if (msgsnd(msqid, &amp;sbuf, buflen, IPC_NOWAIT) &lt; 0)\n    {\n        printf (\"%d, %ld, %s, %d\\n\", msqid, sbuf.mtype, sbuf.mtext, (int)buflen);\n        perror(\"Could not send message!\\n\");\n        exit(1);\n    }\n    else\n        printf(\"Message Sent\\n\");\n\n    exit(0);\n}\n</code></pre>\n\n<p>Consumer1:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXSIZE 128\n\nstruct msgbuf\n{\n    long    mtype;\n    char    mtext[MAXSIZE];\n};\nint main() {\n  int msqid;\n  key_t key;\n  struct msgbuf rcvbuffer;\n  char pathForPrint[1024] = \"\";\n\n  // key = 1234;\n  key = ftok(\".\", 'g');\n\n  if ((msqid = msgget(key, 0666)) &lt; 0) {\n    perror(\"Could not get message queue\\n\");\n    exit(1);\n  }\n  printf(\"MSQID value: %d\\n\", msqid);\n  //  Receive an answer of message type 1.\n  if (msgrcv(msqid, &amp;rcvbuffer, MAXSIZE, 1, 0) &lt; 0) {\n    perror(\"Could not receive message!\\n\");\n    exit(1);\n  }\n\n   //printf(\"%s\\n\", rcvbuffer.mtext);\n  strcat(pathForPrint, \"ls \");\n  strcat(pathForPrint, rcvbuffer.mtext);\n  system(pathForPrint);\n return 0;\n}\n</code></pre>\n\n<p>Producer2:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define VECTOR_SIZE 2\n\nstruct msgbuf\n{\n    long    mtype;\n    int     vector[VECTOR_SIZE];\n};\n\nint main() {\n    int msqid;\n    // int msgflg = IPC_CREAT | 0666;\n    key_t key;\n    struct msgbuf sbuf;\n    size_t buflen;\n    int i;\n\n    key = ftok(\".\", 'g');\n\n    //Get the message queue ID for the given key\n    if ((msqid = msgget(key, IPC_CREAT | 0666 )) &lt; 0) {\n      perror(\"Could not get message queue\\n\");\n      exit(1);\n    }\n    printf(\"MSQID value: %d\\n\", msqid);\n    //Message Type\n    sbuf.mtype = 1;\n    while(1){\n        printf(\"Enter a message to add to message queue : \");\n        for(i = 0; i &lt; 2; i++){\n            scanf(\"%d\",&amp;(sbuf.vector[i]));\n\n            buflen = sizeof(sbuf.vector[i]) + 1 ;\n        }\n\n    // getchar();\n\n        if (msgsnd(msqid, &amp;sbuf, buflen, IPC_NOWAIT) &lt; 0)\n        {\n            printf (\"%d, %ld, %d, %d, %d\\n\", msqid, sbuf.mtype, sbuf.vector[0], sbuf.vector[1], (int)buflen);\n            perror(\"Could not send message!\\n\");\n            exit(1);\n        }\n        else\n            printf(\"Message Sent\\n\");\n\n        sleep(3);\n    }\n\n    exit(0);\n}\n</code></pre>\n\n<p>Consumer2:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAXSIZE 128\n\n#define VECTOR_SIZE 2\n\nstruct msgbuf\n{\n    long    mtype;\n    int     vector[VECTOR_SIZE];\n};\nint main() {\n    int msqid;\n    key_t key;\n    struct msgbuf rcvbuffer;\n\n    // key = 1234;\n    key = ftok(\".\", 'g');\n    while(1){  \n      if ((msqid = msgget(key, 0666)) &lt; 0) {\n        perror(\"Could not get message queue\\n\");\n        exit(1);\n      }\n      printf(\"MSQID value: %d\\n\", msqid);\n      //  Receive an answer of message type 1.\n      if (msgrcv(msqid, &amp;rcvbuffer, MAXSIZE, 1, 0) &lt; 0) {\n        perror(\"Could not receive message!\\n\");\n        exit(1);\n      }\n\n      printf(\"%d\\n\", (rcvbuffer.vector[0] + rcvbuffer.vector[1]));\n    }\n    return 0;\n}\n</code></pre>\n\n<p>For use the same queue is necessary to have the same key, but how to make it ? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "arrays", "pointers", "embedded", "structure"], "comments": [{"owner": {"reputation": 390, "user_id": 7299836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb6d7dc256d73019c6ecc00f9d55d24?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Apple", "link": "https://stackoverflow.com/users/7299836/christopher-apple"}, "edited": false, "score": 1, "creation_date": 1491976343, "post_id": 43361176, "comment_id": 73784590, "body": "You may want to check out something like this answer, it seems like you want to do something polymorphic with structs in c (being able to pass in different object types to the same function)  <a href=\"http://stackoverflow.com/a/18422235/7299836\">stackoverflow.com/a/18422235/7299836</a>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491977666, "post_id": 43361176, "comment_id": 73785187, "body": "For option 2 you should have matrix with enough rows to have arrays for all structs on your firmware, so UB is just behind the corner..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491977794, "post_id": 43361176, "comment_id": 73785267, "body": "If <code>SIZE_A</code> and <code>SIZE_B</code> (as I suppose) are different, using <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>, you cannot &quot;cast&quot; values, you must code a conversion function. That means you must pre declare 2 struct for each case..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1491977842, "post_id": 43361176, "comment_id": 73785295, "body": "BTW It seems an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. What you want to achieve? Describe your objective and tell us all constrains."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491986849, "post_id": 43361176, "comment_id": 73790856, "body": "<i>How</i> do you prefer to allocate these structures?  Doing what you want is relatively simple with a flexible array member, but that&#39;s not easy to use outside of dynamic allocation using <code>malloc()</code> <i>et al</i>."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491989371, "post_id": 43361176, "comment_id": 73792817, "body": "@AndrewHenle On a MCU with limited resources, you should avoid dynamic allocation and prefer memory profiling."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 2765418, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001085962444/picture?type=large", "display_name": "Dominic Gibson", "link": "https://stackoverflow.com/users/2765418/dominic-gibson"}, "is_accepted": false, "score": 1, "last_activity_date": 1491976320, "creation_date": 1491976320, "answer_id": 43361297, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size/43361297#43361297", "title": "C same structure different size", "body": "<p>Create the arrays globally and use a pointer pointig to the big or small array.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 5255429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNrPt.png?s=128&g=1", "display_name": "Gadam", "link": "https://stackoverflow.com/users/5255429/gadam"}, "edited": false, "score": 4, "creation_date": 1491979319, "post_id": 43361975, "comment_id": 73786053, "body": "This would not be useful since this struct is as large as the larger one (right ?). What I am trying to do is memory optimization (see EDIT)"}, {"owner": {"reputation": 737, "user_id": 3373945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oa5aU.jpg?s=128&g=1", "display_name": "ViKiG", "link": "https://stackoverflow.com/users/3373945/vikig"}, "reply_to_user": {"reputation": 59, "user_id": 5255429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNrPt.png?s=128&g=1", "display_name": "Gadam", "link": "https://stackoverflow.com/users/5255429/gadam"}, "edited": false, "score": 0, "creation_date": 1491981095, "post_id": 43361975, "comment_id": 73787115, "body": "Hmm. If you are trying to allocate memory according to the input size then <code>unions</code> might not be the right approach since always allocate memory as per the larger element inside it."}], "tags": [], "owner": {"reputation": 737, "user_id": 3373945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oa5aU.jpg?s=128&g=1", "display_name": "ViKiG", "link": "https://stackoverflow.com/users/3373945/vikig"}, "is_accepted": false, "score": 0, "last_activity_date": 1491978714, "creation_date": 1491978714, "answer_id": 43361975, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size/43361975#43361975", "title": "C same structure different size", "body": "<p>You should try to keep a single structure and for the different array sizes put them in an <code>union</code>. I don't know whether the following structure would make sense to your case. </p>\n\n<pre><code>    typedef struct {\n        short isLarge;         //manually set to 0 or 1 after creating structure \n                               //and accordingly initialize the arrays in below union\n        union my_varying_arrays {\n            short array_A[SIZE_A];\n            short array_B[SIZE_B];\n        };\n        //more arrays\n    } doc_t;\n</code></pre>\n\n<p>If <code>isLarge</code> is <code>0</code>, set the value for <code>array_A</code> array and if <code>1</code> set the value for array <code>array_B</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 2, "last_activity_date": 1491981316, "creation_date": 1491981316, "answer_id": 43362795, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size/43362795#43362795", "title": "C same structure different size", "body": "<p>Idea similar to what you mentioned in your question already (pointers to arrays), but with only one single pointer:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct\n{\n     short array[SIZE_B - SIZE_A];\n     // more arrays alike...\n} Extension;\ntypedef struct\n{\n    short array[SIZE_A];\n    //more arrays (all the small ones!)\n    Extension* extraData;\n} doc_t;\n</code></pre>\n\n<p>If extraData is NULL, you have a small polygone, otherwise, you find the additional data in the struct referenced. Admitted, iterating over all values for large polygons gets a little nasty...</p>\n\n<p>If you <em>can</em> use global arrays of predefined size for each object type (as Dominic Gibson proposed - a good proposition, by the way), you could spare the isLarge flag by replacing it with a function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int isLarge(void* ptr)\n{\n    return\n        (uintptr_t)globalLargeArray &lt;= (uintptr_t)ptr\n        &amp;&amp;\n        (uintptr_t)ptr &lt; (uintptr_t)globalLargeArray + sizeof(globalLargeArray);\n}\n</code></pre>\n\n<p>Of course, <em>all</em> polygons (in above case: the large ones at least) would have to live in this array to make it work. If you create at least one dynamically or otherwise elsewhere (stack, another global variable) - we are out...</p>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 1850429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aeac2c1534ffc9cd94072b3196838b9?s=128&d=identicon&r=PG", "display_name": "Jeroen3", "link": "https://stackoverflow.com/users/1850429/jeroen3"}, "is_accepted": false, "score": 0, "last_activity_date": 1491981390, "creation_date": 1491981390, "answer_id": 43362819, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size/43362819#43362819", "title": "C same structure different size", "body": "<p>You can do this is the data is <code>const</code> by using a <code>void *</code> to the specific array.\nThen you just cast the <code>void *</code> to what you need it to be depending on the attributes in the structure.</p>\n\n<p>It becomes more complicated when you need the structures in runtime.\nEspecially on embedded targets.</p>\n\n<pre><code>typedef struct {\n    short size;\n    void *array;\n} doc_t;\n</code></pre>\n\n<p>Where <code>array</code> points to a memory block allocated by the memory manager.</p>\n\n<p>You now have to decide whether to use C standard <code>malloc</code> or use some pooled memory system based on the largest block size.\nAn example would be <a href=\"https://github.com/ChibiOS/ChibiOS/blob/577d33e5301ad23a3ef46811fcb20218d81e8f0e/os/common/oslib/src/chmempools.c\" rel=\"nofollow noreferrer\">ChibiOS Memory pools</a>. \nIf you are allocating and freeing variable sized memory blocks at random you risk memory fragmentation.</p>\n\n<p>If you allocate incrementally you don't have to worry about much about memory. Just create one large block and keep track of where you are. A bit like a stack.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 5255429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNrPt.png?s=128&g=1", "display_name": "Gadam", "link": "https://stackoverflow.com/users/5255429/gadam"}, "edited": false, "score": 1, "creation_date": 1491984265, "post_id": 43363474, "comment_id": 73789120, "body": "The thing with embedded sys is to know the memory footprint. This seems appropriate. I&#39;ll go with this and report conclusions. Thank you."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1491985336, "last_edit_date": 1491985336, "creation_date": 1491983427, "answer_id": 43363474, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size/43363474#43363474", "title": "C same structure different size", "body": "<p>After the edit, I think the best thing you can do is to profile your needs defining max simple and complex polygons your target can manage and then declare a pool of simplex and common polygons, like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define MAX_COMPLEX 16\n#define MAX_SIMPLE  16\n\nuint16_t g_Simple_Poly_set[MAX_COMPLEX][SIZE_A];\nuint16_t g_Complex_Poly_set[MAX_COMPLEX][SIZE_B];\n\nuint16_t g_Simple_Poly_used = 0;\nuint16_t g_Complex_Poly_used = 0;\n\nstruct poly\n{\n    bool     isLarge;\n    uint16_t *vetexes;\n};\n\n\nbool create_poly_simple (struct poly *p)\n{\n    bool retVal = false; // default: not more space for poly\n\n    if (g_Simple_Poly_used &lt; MAX_SIMPLE)\n    {\n        p-&gt;isLarge = false;\n        p-&gt;vetexes = &amp;g_Simple_Poly_set[g_Simple_Poly_used][0];\n\n        g_Simple_Poly_used++;\n\n        retVal = true;\n    }\n\n    return retVal;\n}\n\nbool create_poly_compleX (struct poly *p)\n{\n    bool retVal = false; // default: not more space for poly\n\n    if (g_Complex_Poly_used &lt; MAX_COMPLEX)\n    {\n        p-&gt;isLarge = true;\n        p-&gt;vetexes = &amp;g_Complex_Poly_set[g_Complex_Poly_used][0];\n\n        g_Complex_Poly_used++;\n\n        retVal = true;\n    }\n\n    return retVal;\n}\n\nvoid your_stuff_with_poly ( struct poly *p)\n{\n    uint32_t poly_size = (p-&gt;isLarge == false) ? SIZE_A : SIZE_B;\n\n    // your stuff with the correct size\n}\n</code></pre>\n\n<p>This is a simple implementation designed for a static \"instantiation\" of structs. You can also enhance the code with a create/destroy function that trace which array into pool is free to be used.</p>\n"}, {"comments": [{"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 0, "creation_date": 1491986884, "post_id": 43364572, "comment_id": 73790878, "body": "&quot;However, I do NOT want to use dynamic allocation (embedded target).&quot;, Well, I would definilty use this answer, but the user do not want dynamic allocation"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 1, "creation_date": 1491986979, "post_id": 43364572, "comment_id": 73790950, "body": "@kaldoran I understand the OP doesn&#39;t want to use dynamic allocation.  But he hasn&#39;t specified how he <i>is</i> allocating the structure(s).  Without that information, it&#39;s just about impossible to provide an answer precisely while using a flexible array member."}, {"owner": {"reputation": 59, "user_id": 5255429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNrPt.png?s=128&g=1", "display_name": "Gadam", "link": "https://stackoverflow.com/users/5255429/gadam"}, "edited": false, "score": 0, "creation_date": 1491987256, "post_id": 43364572, "comment_id": 73791177, "body": "Indeed, this would be great but memory footprint would not be masterized anymore. I prefer an algorithm that cannot produce result, rather than crash because of full memory."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492019951, "post_id": 43364572, "comment_id": 73815213, "body": "1) There is no guarantee there is no padding between <code>array</code> and <code>largeArray</code>. 2) Accessing <code>largeArray</code> through a pointer initialised from <code>array</code> invokes undefined behaviour (out of bounds access). 3) Why not use a single FAM? 4) FAMs don&#39;t work with static or automatic objects."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": -2, "last_activity_date": 1491987693, "last_edit_date": 1491987693, "creation_date": 1491986632, "answer_id": 43364572, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size/43364572#43364572", "title": "C same structure different size", "body": "<p>It's easy with <code>malloc()</code> or similar dynamic allocation methods.  Just use a flexible array member:</p>\n\n<pre><code>typedef struct {\n    short isLarge;         //set 0 at initialization\n     .\n     .\n     .\n    short array[SIZE_A];\n    short largeArray[];\n} doc_t;\n</code></pre>\n\n<p>To allocate a \"small structure\":</p>\n\n<pre><code>doc_t *small = malloc( sizeof( *small ) );\nsmall-&gt;isLarge = 0;\n</code></pre>\n\n<p>To allocate a \"large structure\":</p>\n\n<pre><code>doc_t *large = malloc( sizeof( *large ) + ( SIZE_B - SIZE_A ) * sizeof( large-&gt;largeArray[ 0 ] );\nlarge-&gt;isLarge = 1;\n</code></pre>\n\n<p>Note that you must keep the <code>largeArray</code> element <em>last</em>, which means that the <code>array</code> element must be next-to-last for this to work.</p>\n\n<p>Depending on how you do your own allocation, this may or may not be applicable.</p>\n\n<p>(It's also a bit of a hack, since it depends on being able to access data in <code>largeArray</code> by using an index of <code>SIZE_A</code> or greater on <code>array</code>.  That's accessing an object outside its bounds...)</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492019783, "post_id": 43370508, "comment_id": 73815117, "body": "These are completely different datatypes and this is completely wrong! A pointer is not an array and an array is not a pointer!"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492024876, "post_id": 43370508, "comment_id": 73817928, "body": "@Olaf I&#39;m not sure what you mean.  My intention is that base.array_ptr be set to point to the first element of the array (for example:   <code>doc_instance_1.base.array_ptr = doc_instance_1.array;</code>).  Is it your position that a pointer cannot point to an array?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492032020, "post_id": 43370508, "comment_id": 73821786, "body": "Hmm, I might have missunderstood what you intend. However, the UB stands: How are you going to get the actual type for the access, i.e. set the pointer to the array? I&#39;m really curious how you do this without invoking UB by violating the effective type rule. Let this UB apart: how is that diffferent from casting the types without the pointer?"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492044460, "post_id": 43370508, "comment_id": 73825660, "body": "@Olaf I&#39;m assuming the designer knows the number of small and large doc instances they require at design time.  They will write the code to statically allocate the appropriate number of instances.  And there will be an initialization routine that runs at startup to initialize the base members of each instance.  I&#39;ve added more example code to my answer to make this more clear."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492047783, "post_id": 43370508, "comment_id": 73826421, "body": "Did you even understand what the effective type rule is?? Please read the standard."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492088103, "post_id": 43370508, "comment_id": 73846683, "body": "@Olaf I don&#39;t understand what you&#39;re concerned about.  I&#39;ve tried to clarify for you twice but you just get more obscure with each comment."}], "tags": [], "owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "is_accepted": false, "score": -1, "last_activity_date": 1492044189, "last_edit_date": 1492044189, "creation_date": 1492002580, "answer_id": 43370508, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size/43370508#43370508", "title": "C same structure different size", "body": "<p>Your number 2 solution is the right idea.  It's unclear to me why you think that is ugly.  Maybe this beautiful implementation will change your mind.</p>\n\n<p>You can implement single inheritance is C by placing the base structure as the first member of the inheriting structure.  Then inheriting objects can be referenced with a pointer to the base type.</p>\n\n<pre><code>typedef struct {\n    short doc_type;\n    short *array_ptr;\n    // more array pointers\n} doc_base_t;\n\ntypedef struct {\n    doc_base_t base;         // base.doc_type set 0 at initialization\n    short array[SIZE_A];     // base.array_ptr initialized to point here\n    //more arrays\n} doc_small_t;\n\ntypedef struct {\n    doc_base_t base;         // base.doc_type set 1 at initialization\n    short array[SIZE_B];     // base.array_ptr initialized to point here\n    //more arrays\n} doc_large_t;\n\nvoid function( doc_base_t* document ) {\n    if ( document-&gt;doc_type == 1) {\n         // array size is large\n    } else {\n         // array size is small\n    }\n\n    //common code referencing arrays through doc_base_t-&gt;array_ptr\n}\n</code></pre>\n\n<p>The <code>array_ptr</code> member in <code>doc_base_t</code> isn't necessary for the inheritance mechanism.  But I added that specifically for the \"common code\" portion of your function.  If <code>doc_base_t</code> didn't include the <code>array_ptr</code> then you could cast the generic <code>document</code> to either a<code>doc_small_t</code> or <code>doc_large_t</code> type based upon the <code>base_type</code> value.  But then you might need a different implementation for each inherited type.  By adding the <code>array_ptr</code> member to <code>doc_base_t</code> I suspect you could write a common implementation for all inherited types.</p>\n\n<p>So you will statically declare all your instances of <code>doc_small_t</code> and <code>doc_large_t</code>.  And you'll initialize both the <code>base.doc_type</code> and <code>base.array_ptr</code> members when initializing each object.  Then you will cast both types of objects to doc_base_t before calling <code>function</code>.  (Or pass the address of the <code>base</code> member, which results in the same pointer value.)</p>\n\n<p><strong>Updated example:</strong></p>\n\n<pre><code>static doc_small_t doc_small_instances[NUM_SMALL_INSTANCES];\nstatic doc_large_t doc_large_instances[NUM_LARGE_INSTANCES];\n\n// DocInit must be called once at startup to initialize all the instances.\nvoid DocInit()\n{\n    int index;\n\n    for (index = 0; index &lt; NUM_SMALL_INSTANCES; index++)\n    {\n        doc_small_instances[index].base.doc_type = SMALL;\n        doc_small_instances[index].base.array_ptr = doc_small_instances[index].array;\n    }\n\n    for (index = 0; index &lt; NUM_LARGE_INSTANCES; index++)\n    {\n        doc_large_instances[index].base.doc_type = LARGE;\n        doc_large_instances[index].base.array_ptr = doc_large_instances[index].array;\n    }\n}\n\n// DocProcess processes one doc, large or small.\nvoid DocProcess(doc_base_t *document)\n{\n    int index;\n    short *array_member_ptr = document-&gt;array_ptr;\n\n    int array_size = SMALL;\n    if (document-&gt;doc_type == LARGE)\n    {\n        array_size = LARGE;\n    }\n\n    for (index = 0; index &lt; array_size; index++)\n    {\n        // Application specific processing of *array_member_ptr goes here.\n\n        array_member_ptr++;\n    }\n}\n\n// ProcessAllDocs processes all large and small docs.\nvoid ProcessAllDocs(void)\n{\n    int index;\n\n    for (index = 0; index &lt; NUM_SMALL_INSTANCES; index++)\n    {\n        DocProcess(&amp;doc_small_instances[index].base);\n    }\n\n    for (index = 0; index &lt; NUM_LARGE_INSTANCES; index++)\n    {\n        DocProcess(&amp;doc_large_instances[index].base);\n    }\n}    \n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5255429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNrPt.png?s=128&g=1", "display_name": "Gadam", "link": "https://stackoverflow.com/users/5255429/gadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 1, "answer_count": 7, "score": 3, "last_activity_date": 1492063160, "creation_date": 1491975879, "last_edit_date": 1495541385, "question_id": 43361176, "link": "https://stackoverflow.com/questions/43361176/c-same-structure-different-size", "title": "C same structure different size", "body": "<p>My question is related to this one :\n<a href=\"https://stackoverflow.com/questions/17956697/c-define-arrays-in-struct-with-different-sizes\">c define arrays in struct with different sizes</a></p>\n\n<p>However, I do NOT want to use dynamic allocation (embedded target).</p>\n\n<ul>\n<li>Problem recap :</li>\n</ul>\n\n<p>In <strong>C</strong>, I want to have two versions of the same structure, each one with a different size for its <em>static</em> arrays.\nBoth the structures will be used by the same functions through pointer parameter.</p>\n\n<pre><code>    typedef struct {\n        short isLarge;         //set 0 at initialization\n        short array[SIZE_A];\n        //more arrays\n    } doc_t;\n\n    typedef struct {\n        short isLarge;         //set 1 at initialization\n        short array[SIZE_B];\n        //more arrays\n    } doc_large_t;\n\n    void function( doc_t* document ) {\n        if ( document-&gt;isLarge ) {\n             //change document into doc_large_t* [1]\n        } \n        //common code for both doc_t and doc_large_t\n    }\n</code></pre>\n\n<ul>\n<li>Questions :</li>\n</ul>\n\n<p>(1) The above description needs a way to dynamically cast the pointer doc_t* pointer to doc_large_t* document [1]. Is that possible ? How ?</p>\n\n<p>(2) An other solution i came with is to have a common header data part for both structure, including not only the isLarge flag, but also the pointers to the following static arrays. How ugly is that ?</p>\n\n<p>(3) Also, do you have a good trick or workarround I could use ?</p>\n\n<p>EDIT :</p>\n\n<ul>\n<li>More context :</li>\n</ul>\n\n<p>My application is a path finding on an embedded MCU.</p>\n\n<p>I have geometrical objects, like polygons. Polygons can describe simple rectangular obstacles, as well as more complex shapes (such as the accessible area).</p>\n\n<p>Complex polygons can have a huge amount of vertices, but are in small quantity. Simple polygons are very common.</p>\n\n<p>Both will use the same algorithms.\nI know in advance which polygon will need more vertices.</p>\n\n<p>What I am trying to do is to optimize working memory to make it fit into the MCU. (i.e. small shapes get small arrays; complex ones get large arrays)</p>\n"}, {"tags": ["c", "gcc", "gnu"], "comments": [{"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1491976366, "post_id": 43361131, "comment_id": 73784603, "body": "In both the cases performance will be the same. In first case clean_up func is called by main. In second case <b>cleanup</b> attribute will invoke the clean_up function when main ends."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1491976530, "post_id": 43361131, "comment_id": 73784687, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1491977363, "post_id": 43361131, "comment_id": 73785051, "body": "@Rajeshkumar: The cleanup happens at end of containing block, not at end of <code>main</code>"}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1491977432, "post_id": 43361131, "comment_id": 73785083, "body": "@BasileStarynkevitch okay, thanks for the info"}], "answers": [{"tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": false, "score": 1, "last_activity_date": 1491976427, "creation_date": 1491976427, "answer_id": 43361326, "question_id": 43361131, "link": "https://stackoverflow.com/questions/43361131/how-does-gnu-c-extension-attribute-cleanup-work/43361326#43361326", "title": "How does GNU C extension __attribute__(__cleanup__) work\uff1f", "body": "<p>The cleanup function is called when the variable goes out of scope. It doesn't care, whether this would leave other pointers dangling.</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 3, "last_activity_date": 1491977137, "last_edit_date": 1491977137, "creation_date": 1491976762, "answer_id": 43361419, "question_id": 43361131, "link": "https://stackoverflow.com/questions/43361131/how-does-gnu-c-extension-attribute-cleanup-work/43361419#43361419", "title": "How does GNU C extension __attribute__(__cleanup__) work\uff1f", "body": "<p>You'll better compile with some optimization, in particular if you want to look into the generated assembler code (compile with <code>gcc -S -fverbose-asm -O</code>)</p>\n\n<p>The intuition <a href=\"http://echorand.me/site/notes/articles/c_cleanup/cleanup_attribute_c.html\" rel=\"nofollow noreferrer\">behind</a> <code>__attribute__((cleanup))</code> is that GCC is in fact a compiler for all of C, C++, Ada, Fortran, Go.... That attribute is forcing the same internal representation than for C++ destructors of local variables. The cleanup happens at end of current block scope (e.g. at closing brace <code>}</code> of the block). So the compiler is transforming your code2 with cleanup into the equivalent of code1.</p>\n\n<p>The thing for destructors of global or static variables (which are run after <code>main</code> has returned) is <code>__attribute__((destructor))</code> on functions (which are also run at <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/dlclose.html\" rel=\"nofollow noreferrer\">dlclose</a> time for plugins).</p>\n\n<p>So to understand these attributes, you'll better think in C++ terms.</p>\n\n<p>My opinion is that if you need these <code>cleanup</code> attributes, you should code your thing in C++ not in C. Your code would be much more readable and less compiler dependent. I feel that <code>cleanup</code> is in practice only useful in generated C code. I never used it (and feel that when I need it, I should switch to C++).</p>\n"}], "owner": {"reputation": 632, "user_id": 4068848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FD7nX.png?s=128&g=1", "display_name": "huron", "link": "https://stackoverflow.com/users/4068848/huron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 43361419, "answer_count": 2, "score": 1, "last_activity_date": 1491984849, "creation_date": 1491975683, "last_edit_date": 1491984849, "question_id": 43361131, "link": "https://stackoverflow.com/questions/43361131/how-does-gnu-c-extension-attribute-cleanup-work", "title": "How does GNU C extension __attribute__(__cleanup__) work\uff1f", "body": "<p>Does it analysis the lifecycle of the variable and simply insert the cleanup function call at the right place? Does it have any overhead cost?</p>\n\n<p>I've written two pieces of simple code to compare the performance, and compiled them without optimization.</p>\n\n<p>code1:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid clean_up(int **final_value)\n{\n    free(*final_value);\n}\n\nint main(int argc, char **argv)\n{\n  for (int i = 0; i &lt; 10000000; i++) { \n    int *avar = malloc(sizeof(int));\n    clean_up(&amp;avar);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>code2:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid clean_up(int **final_value)\n{\n    free(*final_value);\n}\n\nint main(int argc, char **argv)\n{\n  for (int i = 0; i &lt; 10000000; i++) { \n    int *avar __attribute__ ((__cleanup__(clean_up))) = malloc(sizeof(int));\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>And their performance are quite similar.</p>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1491975689, "post_id": 43361097, "comment_id": 73784299, "body": "How do you know <code>j</code> never exceeds <code>N</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1491975765, "post_id": 43361097, "comment_id": 73784327, "body": "<code>*str &lt; *str + length</code> Explain to your <a href=\"https://en.m.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck</a> what this line does."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1491978544, "post_id": 43361097, "comment_id": 73785652, "body": "And show how you call <code>encrypt</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1492010595, "post_id": 43361097, "comment_id": 73809531, "body": "this expression: <code>*str &lt; *str + length;</code> says to take the char pointed to by <code>str</code> and check if it is less than that same char + some value.  it &#39;might&#39; exit the <code>for()</code> statement IF the value wrapped around beyond 0xFF, but this is VERY unlikely and certainly not what you intended"}, {"owner": {"reputation": 1, "user_id": 7818136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256cb4adfb4ed716b83e4de44a5770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Str8Dev", "link": "https://stackoverflow.com/users/7818136/str8dev"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1492019235, "post_id": 43361097, "comment_id": 73814808, "body": "@DYZ  N is set to 100. Whatever the user enters into str will be less than 100 so the length will be less than 100. The for loop will only go as long as &#39;*str&#39; is less than whatever the length is"}, {"owner": {"reputation": 1, "user_id": 7818136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256cb4adfb4ed716b83e4de44a5770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Str8Dev", "link": "https://stackoverflow.com/users/7818136/str8dev"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1492019544, "post_id": 43361097, "comment_id": 73814991, "body": "@n.m. I honestly don&#39;t know how to explain this. All I know is that it works and that I can&#39;t do what I would normally do with a for loop if I wasn&#39;t using a pointer. I also don&#39;t know how to just pass the array     str as an argument without using a pointer."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1492020474, "post_id": 43361097, "comment_id": 73815493, "body": "Basically <code>*str &lt; *str + length</code> is <code>A &lt; A + B</code>. Which is equivalent to <code>B &gt; 0</code>, which is <code>length &gt; 0</code>, which makes no sense as loop a condition."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1492034047, "post_id": 43361097, "comment_id": 73822606, "body": "&quot;don&#39;t know how to explain this&quot; Then hit backspace as many times as needed for being able to explain what&#39;s left. &quot;it works&quot; Apparently not very well."}], "answers": [{"comments": [{"owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 1, "creation_date": 1491984129, "post_id": 43362245, "comment_id": 73789031, "body": "Please note that the code samples are not equivalent. While <code>str &lt; str + length</code> is always false, <code>j&lt; length</code> is not."}, {"owner": {"reputation": 1, "user_id": 7818136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256cb4adfb4ed716b83e4de44a5770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Str8Dev", "link": "https://stackoverflow.com/users/7818136/str8dev"}, "edited": false, "score": 0, "creation_date": 1492020331, "post_id": 43362245, "comment_id": 73815404, "body": "This works but there are a few stray random characters at the end. Like if I enter &#39;Hello&#39;  this gets stored in &#39;temp&#39; &#39;Hello\u2592a&#39;"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1491986199, "last_edit_date": 1491986199, "creation_date": 1491979627, "answer_id": 43362245, "question_id": 43361097, "link": "https://stackoverflow.com/questions/43361097/segmentation-fault-core-dumped/43362245#43362245", "title": "Segmentation fault (core dumped)", "body": "<p>I suppose you actually wanted to write this:</p>\n\n<pre><code>for (j = 0; str &lt; str + length; *str++, *str++, j++)\n</code></pre>\n\n<p>which could be written like this which is a bit more clear:</p>\n\n<pre><code>for (j = 0; str &lt; str + length; str++, str++, j++)\n</code></pre>\n\n<p>But this is wrong anyway because <code>str &lt; str + length</code> is always true.</p>\n\n<p>This is what you need:</p>\n\n<pre><code>for (j = 0; j &lt; length; j++)\n{\n  temp[j] = *str;\n  str += 2;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7818136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/256cb4adfb4ed716b83e4de44a5770eb?s=128&d=identicon&r=PG&f=1", "display_name": "Str8Dev", "link": "https://stackoverflow.com/users/7818136/str8dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492020090, "creation_date": 1491975517, "last_edit_date": 1492020090, "question_id": 43361097, "link": "https://stackoverflow.com/questions/43361097/segmentation-fault-core-dumped", "title": "Segmentation fault (core dumped)", "body": "<p>The code below works out in copying every other element of 'str' in 'temp' but if I only increment '*str' once it gives me a segmentation fault(core dumped).\nI was trying to copy all of the even letters of the string into the 'even' array, same with the odd letters.('even' being the second letter, the fourth, the sixth, etc.) But I realized that when I increment it stays incremented. I don't really know how to work around that so I tried storing the letters in a different array within the function but got a segmentation fault. I don't understand why incrementing twice is ok but once is not.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define N 100\n\nvoid encrypt(const char*);\n\nint main(void)\n{\n    char str[N];\n    printf(\"Please enter a message: \");\n    gets(str);\n\n    encrypt(&amp;str);\nreturn 0;\n}\n\nvoid encrypt(const char *str)\n{\n    int i, j, length;\n    char temp[N], odd[N], even[N];\n\n    length = strlen(str);\n\n    for (j = 0; *str &lt; *str + length; *str++, *str++, j++)\n    {\n        temp[j] = *str;\n    }\n    printf(\"%s\", temp);\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "time-complexity", "heap", "binary-heap"], "comments": [{"owner": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 0, "creation_date": 1491975056, "post_id": 43360930, "comment_id": 73784056, "body": "If heap size is always 15, you have a constant time complexity here. O(1). It&#39;s not a function of the input, because there&#39;s no input."}, {"owner": {"reputation": 53, "user_id": 5956401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe555c77ed57d4ae95567a86ea62f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "labyrinthdeux", "link": "https://stackoverflow.com/users/5956401/labyrinthdeux"}, "reply_to_user": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 0, "creation_date": 1491975265, "post_id": 43360930, "comment_id": 73784146, "body": "@LukeLee  I think you need to consider the deleteMax function inside the for loop - O(logn) and also the number of iterations in the for loop? What I&#39;m confused is that the for loop will only iterate up to 7 elements and not the whole heap_size."}, {"owner": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 0, "creation_date": 1491975404, "post_id": 43360930, "comment_id": 73784196, "body": "Well you picked a bad example. If the for loop runs <code>n&#47;2</code> times, that&#39;s more interesting."}, {"owner": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 0, "creation_date": 1491975442, "post_id": 43360930, "comment_id": 73784209, "body": "It might be what you actually asked."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5956401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe555c77ed57d4ae95567a86ea62f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "labyrinthdeux", "link": "https://stackoverflow.com/users/5956401/labyrinthdeux"}, "edited": false, "score": 1, "creation_date": 1491975643, "post_id": 43361048, "comment_id": 73784286, "body": "So, if I make i &lt; 7 to i &lt; 20 (assuming that this is error-free), the time complexity will still be O(logn) since it is not dependent on the size of the data? Am I correct with this one?"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1491976666, "post_id": 43361048, "comment_id": 73784754, "body": "@Archmede: If the loop runs a fixed number of times then the complexity will be <i>the same as that of deleteMax,</i> which was stated to be O(log n)."}], "tags": [], "owner": {"reputation": 1054, "user_id": 6106641, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/652b9195ab2ad7effd41fd7410661c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Archmede", "link": "https://stackoverflow.com/users/6106641/archmede"}, "is_accepted": false, "score": 1, "last_activity_date": 1491975295, "creation_date": 1491975295, "answer_id": 43361048, "question_id": 43360930, "link": "https://stackoverflow.com/questions/43360930/time-complexity-or-big-o-of-the-code/43361048#43361048", "title": "Time complexity or Big O of the code", "body": "<p>If the loop only runs 7 times then the complexity is O(1). This is for the reason that the loop does not depend on the size of the data and will always run in constant time.</p>\n"}, {"tags": [], "owner": {"reputation": 463, "user_id": 3710722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eaAuC.png?s=128&g=1", "display_name": "vantony", "link": "https://stackoverflow.com/users/3710722/vantony"}, "is_accepted": false, "score": 0, "last_activity_date": 1491975719, "creation_date": 1491975719, "answer_id": 43361140, "question_id": 43360930, "link": "https://stackoverflow.com/questions/43360930/time-complexity-or-big-o-of-the-code/43361140#43361140", "title": "Time complexity or Big O of the code", "body": "<p>Here, both the heap size and number of times the loop runs are constant. So the code will have a time complexity of O(1), i.e., constant time complexity.</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 7744232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34328c2246fd41a20b9407f825fc8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "slzy", "link": "https://stackoverflow.com/users/7744232/slzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1491975824, "creation_date": 1491975824, "answer_id": 43361165, "question_id": 43360930, "link": "https://stackoverflow.com/questions/43360930/time-complexity-or-big-o-of-the-code/43361165#43361165", "title": "Time complexity or Big O of the code", "body": "<p>I think you were leaning the heap sort algorithm, and I'm sure the complexity is O(nlogn).</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5956401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe555c77ed57d4ae95567a86ea62f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "labyrinthdeux", "link": "https://stackoverflow.com/users/5956401/labyrinthdeux"}, "edited": false, "score": 0, "creation_date": 1491976071, "post_id": 43361187, "comment_id": 73784476, "body": "So, if I make i &lt; 7 to i &lt; 20 (assuming that this is error-free), the time complexity will still be O(logn) since it is not dependent on the size of the data? Am I correct with this one? Btw, answer accepted. Thanks"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 53, "user_id": 5956401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe555c77ed57d4ae95567a86ea62f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "labyrinthdeux", "link": "https://stackoverflow.com/users/5956401/labyrinthdeux"}, "edited": false, "score": 1, "creation_date": 1491976230, "post_id": 43361187, "comment_id": 73784542, "body": "@labyrinthdeux Correct. Changing from 7 to 20 doesn&#39;t impact complexity. The notation is <b>not</b> for saying how long it takes to execute a piece of code. The notation tells youhow execution time changes when you change something, e.g. the length of an array that you give as input"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 53, "user_id": 5956401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe555c77ed57d4ae95567a86ea62f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "labyrinthdeux", "link": "https://stackoverflow.com/users/5956401/labyrinthdeux"}, "edited": false, "score": 0, "creation_date": 1491976343, "post_id": 43361187, "comment_id": 73784592, "body": "@labyrinthdeux - But if you made the loop limit depend on something, e.g. <code>i &lt; someInputValue</code>, then the complexity would change."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1491977644, "post_id": 43361187, "comment_id": 73785170, "body": "@4386427: I&#39;d add that the complexity tells you how execution time changes when some input is changed, <i>for large inputs</i>. This is because we only keep the dominant term. If the execution time is given by T(n) = n^2 + 1000*n, the complexity is O(n^2), but the increase will be near linear for small ns. It is only for larger ns it becomes (near) quadratic."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 5, "last_activity_date": 1491977170, "last_edit_date": 1491977170, "creation_date": 1491975906, "answer_id": 43361187, "question_id": 43360930, "link": "https://stackoverflow.com/questions/43360930/time-complexity-or-big-o-of-the-code/43361187#43361187", "title": "Time complexity or Big O of the code", "body": "<p>In general it is pointless to talk about complexity when a number is fixed (aka constant). The whole purpose of the notation is to evaluate how execution time changes when a number changes. A constant number of loops will never change execution time nor complexity. If you change the number of loops to <strong>another</strong> constant value, it will change execution time <strong>but</strong> complexity is the same.</p>\n\n<p>The typical use is to calculate the complexity of a function in order to give the user of the function an idea about how execution time changes when the user changes some input value. Example:</p>\n\n<pre><code>void foo()                 // Pointless to talk about complexity as there is no input\n\nvoid foo(int x)            // Complexity tells you how execution time change \n                           // when you change x\n\nvoid foo(char* someString) // Complexity tells you how execution time change \n                           // when you change the length of someString\n</code></pre>\n\n<p>Note: Complexity never tells you the actual execution time! Only how execution time changes when some input is changed.</p>\n\n<p>So in your case, it is still <code>deleteMax</code> that determines complexity, i.e. it is still O(log n). Simply because there is no input changing the number of loops.</p>\n"}], "owner": {"reputation": 53, "user_id": 5956401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe555c77ed57d4ae95567a86ea62f3ce?s=128&d=identicon&r=PG&f=1", "display_name": "labyrinthdeux", "link": "https://stackoverflow.com/users/5956401/labyrinthdeux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 43361187, "answer_count": 4, "score": 3, "last_activity_date": 1491977170, "creation_date": 1491974705, "question_id": 43360930, "link": "https://stackoverflow.com/questions/43360930/time-complexity-or-big-o-of-the-code", "title": "Time complexity or Big O of the code", "body": "<p>I have this array which has a max heap property. The time complexity of deleteMax is O(logn). If the code below will iterate for only 7 times, what would be the time complexity of the below code (big O)? </p>\n\n<pre><code>int heap_size = 15;\nint i, value, heap_array[]; // array is in the form of max heap\n....\nfor(i = 0; i &lt; 7; i++){ // iterates seven times\n    value = deleteMax(heap_array);\n    printf(\"%d \", value);\n}\n</code></pre>\n\n<p>I have two solutions in my mind. First: The time complexity is O(7 * logn) or simply O(logn). </p>\n\n<p>Then the second one is O(1/2 * n * logn) or O(nlogn) since 1/2 is just a constant and I'm assuming that since the number of iteration is 7 which is almost the same as the half the heap_size, I can disregard 1/2. Thus O(nlogn)</p>\n\n<p>Which one would be correct?</p>\n"}, {"tags": ["c", "file", "loops", "while-loop", "binary"], "comments": [{"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 2, "creation_date": 1491974209, "post_id": 43360789, "comment_id": 73783764, "body": "This is infinite loop because you are initializing <code>counter</code> to 0 every time in the loop and <code>fseek</code> taking the pointer to the beginning of the file. Take out <code>int counter = 0;</code> outside your loop"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1491994860, "post_id": 43360789, "comment_id": 73797060, "body": "and <code>fread(nums2,sizeof(int),1,fptr);</code> --&gt; <code>fread(nums2+counter, sizeof(int),1,fptr);</code> , Need <code>end &#47;= sizeof(int);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3333, "user_id": 1129667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a56d7975ff6832cee73c7c7d862512b?s=128&d=identicon&r=PG", "display_name": "Maurizio Benedetti", "link": "https://stackoverflow.com/users/1129667/maurizio-benedetti"}, "is_accepted": false, "score": 0, "last_activity_date": 1491982946, "creation_date": 1491982946, "answer_id": 43363328, "question_id": 43360789, "link": "https://stackoverflow.com/questions/43360789/writing-and-reading-an-array-of-integers-from-a-binary-file/43363328#43363328", "title": "writing and reading an array of integers from a binary file", "body": "<p>the problem is in the combination of the seek/counter initialization.</p>\n\n<p>If you set every time the counter to 0 (first record) and the you seek for it, you will always be in a \"valid range\" in the file records. The end of file condition will never occur, hence, the while look will enter an infinite loop</p>\n\n<p>I do believe that the if condition \"if(counter>=end)\" is useless as well, I would remove it. The while loop will complete once eof, this is the way it should be.</p>\n\n<pre><code> FILE *fptr = fopen(\"number.db\", \"wb\");\n int nums[100] = {1,2,3,4,5,6,7,8,9,100,101,102,103,104,105};\n int nums2[100];\n\n fwrite(nums,sizeof(int),15,fptr);\n fclose(fptr);\n\n fptr = fopen(\"number.db\", \"rb\");\n fseek(fptr,0,SEEK_END);\n long end = ftell(fptr); //finds length of the file\n fseek(fptr,0,SEEK_SET);\n int counter = 0;\n while(!feof(fptr)){\n      fread(nums2,sizeof(int),1,fptr);\n      fseek(fptr,counter,SEEK_SET);\n      counter++;\n      if(counter&gt;=end){ //Breaks when it seeks to the end\n           break;\n      }\n }\n fclose(fptr);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7831871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e6dd69d2766548371dd6a85e3a96c?s=128&d=identicon&r=PG&f=1", "display_name": "iHugo Scape", "link": "https://stackoverflow.com/users/7831871/ihugo-scape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491982946, "creation_date": 1491974041, "last_edit_date": 1491976075, "question_id": 43360789, "link": "https://stackoverflow.com/questions/43360789/writing-and-reading-an-array-of-integers-from-a-binary-file", "title": "writing and reading an array of integers from a binary file", "body": "<p>Hi there I am trying to write and read an array of integers from a file, However, The loop that I am using to read them back is in an infinite loop. How would I fix this infinite-loop so that when it reaches the end of the file it exits the loop. Also, I am not entirely sure if the fread is doing what I expect it to.</p>\n\n<pre><code> FILE *fptr = fopen(\"number.db\", \"wb\");\n int nums[100] = {1,2,3,4,5,6,7,8,9,100,101,102,103,104,105};\n int nums2[100];\n\n fwrite(nums,sizeof(int),15,fptr);\n fclose(fptr);\n\n fptr = fopen(\"number.db\", \"rb\");\n  fseek(fptr,0,SEEK_END);\n  long end = ftell(fptr); //finds length of the file\n  fseek(fptr,0,SEEK_SET);\n\n while(!feof(fptr)){\n   int counter = 0;\n   fread(nums2,sizeof(int),1,fptr);\n   fseek(fptr,counter,SEEK_SET);\n   counter++;\n   if(counter&gt;=end){ //Breaks when it seeks to the end\n      break;\n    }\n fclose(fptr);\n</code></pre>\n\n<p>I feel like there is something with the logic of the fread, however I am not too sure. When I print out the numbers that are saves in \"nums2\" its only the last number that is read: 105 for all elements of nums2.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1491973962, "post_id": 43360713, "comment_id": 73783687, "body": "could you check the hexdump of output file?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1491973964, "post_id": 43360713, "comment_id": 73783688, "body": "How are you validating your result? By opening the file in a <i>text</i> editor? <code>map[i] = i;</code> creates <i>binary</i> data. It will look like junk if viewed with a text tool."}, {"owner": {"reputation": 1982, "user_id": 916173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/46023e482c60329a251a137848f8f5f5?s=128&d=identicon&r=PG", "display_name": "Nikhil", "link": "https://stackoverflow.com/users/916173/nikhil"}, "edited": false, "score": 0, "creation_date": 1491974189, "post_id": 43360713, "comment_id": 73783754, "body": "Oops my bad.. hexdump shows the right output. How do I write text data and not binary?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1491974276, "post_id": 43360713, "comment_id": 73783791, "body": "That would be <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>printf()</code></a> then..."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1491974620, "post_id": 43360713, "comment_id": 73783904, "body": "@DevSolar I think you mean <code>snprintf</code> as OP needs to output to a buffer not to <code>stdout</code>."}, {"owner": {"reputation": 1982, "user_id": 916173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/46023e482c60329a251a137848f8f5f5?s=128&d=identicon&r=PG", "display_name": "Nikhil", "link": "https://stackoverflow.com/users/916173/nikhil"}, "edited": false, "score": 0, "creation_date": 1491975574, "post_id": 43360713, "comment_id": 73784259, "body": "How to use sprintf in a loop to print 5 integers? It is an int and sprintf expects char pointer?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1491977370, "post_id": 43360713, "comment_id": 73785055, "body": "<code>sprintf(msg, &quot;%d&quot;, i);</code>. Need to adjust <code>msg</code> after each call to point past what was written in preparation for next call."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1493133529, "post_id": 43360713, "comment_id": 74278420, "body": "You can use <code>%n</code> in that <code>snprintf()</code> call to get the number of characters written by the previous <code>%d</code> in the same <code>snprintf()</code>. That&#39;s what you need to shift <code>msg</code> by for the next iteration."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491974417, "post_id": 43360814, "comment_id": 73783844, "body": "Amazing what a stop by <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\"><b>www.asciitable.com</b></a> can help clear up <code>:)</code>"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1493133281, "post_id": 43360814, "comment_id": 74278227, "body": "@DavidC.Rankin: As I am handling various encodings, and have to check the 0x80-0xff range on a regular basis to figure out which encoding <i>exactly</i>, I wrote up my own version, <a href=\"http://encoding.rootdirectory.de\" rel=\"nofollow noreferrer\">encoding.rootdirectory.de</a>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1493168804, "post_id": 43360814, "comment_id": 74295609, "body": "That makes more sense, sorry for the confusion."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": true, "score": 4, "last_activity_date": 1491974243, "last_edit_date": 1491974243, "creation_date": 1491974166, "answer_id": 43360814, "question_id": 43360713, "link": "https://stackoverflow.com/questions/43360713/c-writing-data-to-memory-mapped-file-shows-junk/43360814#43360814", "title": "C: Writing data to memory mapped file shows junk", "body": "<p>The contents of <code>test</code> look just as I would have expected:</p>\n\n<pre><code>$ hexdump -C test\n00000000  00 00 00 00 01 00 00 00  02 00 00 00 03 00 00 00  |................|\n00000010  04 00 00 00 05 00 00 00  06 00 00 00 07 00 00 00  |................|\n00000020  08 00 00 00 09 00 00 00  0a 00 00 00 00 00 00 00  |................|\n00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n00000fa0\n</code></pre>\n\n<p>There are your 10 ints.</p>\n\n<p>Of course, in a <em>text editor</em> that looks like garbage, because it's the <em>binary</em> value of the ints, not the ASCII <code>\"1\"</code>, <code>\"2\"</code>...</p>\n"}], "owner": {"reputation": 1982, "user_id": 916173, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/46023e482c60329a251a137848f8f5f5?s=128&d=identicon&r=PG", "display_name": "Nikhil", "link": "https://stackoverflow.com/users/916173/nikhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 43360814, "answer_count": 1, "score": 1, "last_activity_date": 1491974243, "creation_date": 1491973658, "question_id": 43360713, "link": "https://stackoverflow.com/questions/43360713/c-writing-data-to-memory-mapped-file-shows-junk", "title": "C: Writing data to memory mapped file shows junk", "body": "<p>I'm trying to write data to memory mapped file and it showing junk. Not sure what I'm doing wrong. I'm creating a memory mapped file and writing int to it. I'm seeing junk output. </p>\n\n<p>The file I'm opening as read/write and I ideally want other process to read the data written to it</p>\n\n<p>Code below</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/mman.h&gt;\n\n#define FILEPATH \"test\"\n#define NUMINTS  (1000)\n#define FILESIZE (NUMINTS * sizeof(int))\n\nint main(int argc, char *argv[])\n{\n    int i;\n    int fd;\n    int result;\n    int *map;  /* mmapped array of int's */\n\n    /* Open a file for writing.\n     *  - Creating the file if it doesn't exist.\n     *  - Truncating it to 0 size if it already exists. (not really needed)\n     *\n     * Note: \"O_WRONLY\" mode is not sufficient when mmaping.\n     */\n    fd = open(FILEPATH, O_RDWR | O_CREAT | O_TRUNC, (mode_t)0600);\n    if (fd == -1) {\n    perror(\"Error opening file for writing\");\n    exit(EXIT_FAILURE);\n    }\n\n    /* Stretch the file size to the size of the (mmapped) array of ints\n     */\n    result = lseek(fd, FILESIZE-1, SEEK_SET);\n    if (result == -1) {\n    close(fd);\n    perror(\"Error calling lseek() to 'stretch' the file\");\n    exit(EXIT_FAILURE);\n    }\n\n    /* Something needs to be written at the end of the file to\n     * have the file actually have the new size.\n     * Just writing an empty string at the current file position will do.\n     *\n     * Note:\n     *  - The current position in the file is at the end of the stretched\n     *    file due to the call to lseek().\n     *  - An empty string is actually a single '\\0' character, so a zero-byte\n     *    will be written at the last byte of the file.\n     */\n    result = write(fd, \"\", 1);\n    if (result != 1) {\n    close(fd);\n    perror(\"Error writing last byte of the file\");\n    exit(EXIT_FAILURE);\n    }\n\n    /* Now the file is ready to be mmapped.\n     */\n    map = mmap(0, FILESIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);\n    if (map == MAP_FAILED) {\n    close(fd);\n    perror(\"Error mmapping the file\");\n    exit(EXIT_FAILURE);\n    }\n\n    /* Now write int's to the file as if it were memory (an array of ints).\n     */\n    for (i = 1; i &lt;=10; ++i) {\n        map[i] = i;\n    }\n\n    /* Don't forget to free the mmapped memory\n     */\n    if (munmap(map, FILESIZE) == -1) {\n    perror(\"Error un-mmapping the file\");\n    /* Decide here whether to close(fd) and exit() or not. Depends... */\n    }\n\n    /* Un-mmaping doesn't close the file, so we still need to do that.\n     */\n    close(fd);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "compiler-errors", "compiler-warnings"], "comments": [{"owner": {"reputation": 19948, "user_id": 3150853, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qIPrg.jpg?s=128&g=1", "display_name": "Jayesh Bhoi", "link": "https://stackoverflow.com/users/3150853/jayesh-bhoi"}, "edited": false, "score": 4, "creation_date": 1491973116, "post_id": 43360603, "comment_id": 73783410, "body": "there is no array bound check in <code>c</code>. It will Undefined Behaviour."}, {"owner": {"reputation": 9119, "user_id": 2729109, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1254b21c13af8f443246cbcf1404ed4f?s=128&d=identicon&r=PG&f=1", "display_name": "ikh", "link": "https://stackoverflow.com/users/2729109/ikh"}, "edited": false, "score": 4, "creation_date": 1491973160, "post_id": 43360603, "comment_id": 73783429, "body": "It is <b>undefined behavior</b>. Standard doesn&#39;t guarantee <i>anything</i>; There may or may not be compile error or runtime error. It might even wipe your all data, because there is no guarantee."}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1491973735, "post_id": 43360603, "comment_id": 73783627, "body": "In first two cases assignment of value to the array will be done in runtime. But in third case it will be in compile time. So it throws error."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "reply_to_user": {"reputation": 9119, "user_id": 2729109, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1254b21c13af8f443246cbcf1404ed4f?s=128&d=identicon&r=PG&f=1", "display_name": "ikh", "link": "https://stackoverflow.com/users/2729109/ikh"}, "edited": false, "score": 0, "creation_date": 1491974069, "post_id": 43360603, "comment_id": 73783716, "body": "@ikh Don&#39;t forget it is legal for it to make demons fly out of your nose too."}], "answers": [{"comments": [{"owner": {"reputation": 1485, "user_id": 4143312, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RtGaS.jpg?s=128&g=1", "display_name": "Ka-Wa Yip", "link": "https://stackoverflow.com/users/4143312/ka-wa-yip"}, "edited": false, "score": 0, "creation_date": 1491975868, "post_id": 43360809, "comment_id": 73784370, "body": "yes. it is quite strange that <code>4</code> does not show any sign but <code>3</code> does show me some warning. Also, <code>for</code> loop clearly does something more and is &quot;safer&quot; in this sense."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 1, "last_activity_date": 1491975042, "last_edit_date": 1491975042, "creation_date": 1491974153, "answer_id": 43360809, "question_id": 43360603, "link": "https://stackoverflow.com/questions/43360603/c-strange-behavior-of-wrong-initialization-of-array/43360809#43360809", "title": "C: strange behavior of wrong initialization of array", "body": "<p>In the third case, the compiler is alerting you of an out of bound access. The standard doesn't require it to complain but it does so.</p>\n\n<p>For the first two cases there is no point in thinking what is happening. You said the first program runs <em>fine</em>. It doesn't - It has an UB.</p>\n\n<p>For your question about how 3 &amp; 4 changes anything, it could be dependent on how the stack frame is layed out. Due to alignment difference maybe the return address gets mucked in one case but doesn't in another. You will have to look at the generated assembly file to see what is actually going wrong.</p>\n\n<p>This <a href=\"https://godbolt.org/g/gqz39q\" rel=\"nofollow noreferrer\">https://godbolt.org/g/gqz39q</a> shows that in case where you set the array size to be 3 it is placing <code>position</code> at <code>%rbp - 32</code> and <code>step</code> at <code>%rbp - 4</code>. So in case when you write <code>position[3]</code>, <code>step</code> is being overwritten ( I don't want to think about what is being written). </p>\n\n<p>When you make size of <code>position</code> to be 4, it places <code>step</code> at <code>%rbp - 4</code> and <code>position</code> at <code>%rbp - 48</code>. Now you write to <code>position[4]</code> ie <code>%rbp - 48 + 4 * 8 = %rbp - 16</code>. This will write till <code>%rbp - 8</code>. So <code>%rbp - 4</code> (<code>step</code>) is not changed.</p>\n\n<p>Long story short, the padding saved you in case 1 but not in case 2.</p>\n\n<p>PS: Again this is specific to the chosen compiler gcc 6.2 with O0 optimization level. The reason could be entirely different in your case.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1491977332, "last_edit_date": 1491977332, "creation_date": 1491974631, "answer_id": 43360919, "question_id": 43360603, "link": "https://stackoverflow.com/questions/43360603/c-strange-behavior-of-wrong-initialization-of-array/43360919#43360919", "title": "C: strange behavior of wrong initialization of array", "body": "<p>There is nothing mentioned in the C language that <em>stops you</em> from writing a code that access out of bound memory, standard just clearly mentions that any attempt of doing so will causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Any diagnostic, if provided is at sole discretion of the compiler, maybe tied to the supplied compiler options, standard mentions no requirement of this.</p>\n\n<p>For example, <a href=\"https://ideone.com/EBdNBL\" rel=\"nofollow noreferrer\">for some compiler, the last snippet compiles just fine</a> (and receives runtime error, too).</p>\n\n<p><em><strong>Note 1:</strong> In the shown snippets, the statements are <strong>not</strong> initialization, they are <strong>assignments</strong>.</em></p>\n\n<p><em><strong>Note 2:</strong> I've modified the code a bit, but the invalid accesses made are same</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    //int step;             // remove unused variable warning\n    double position[4];\n    position[0] = 1;\n    position[1] = 99;\n    position[2] = 99;\n    position[3] = 99;\n    position[4] = 99;\n\n    (void) position;          // suppress unused variable warning\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1485, "user_id": 4143312, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RtGaS.jpg?s=128&g=1", "display_name": "Ka-Wa Yip", "link": "https://stackoverflow.com/users/4143312/ka-wa-yip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 43360809, "answer_count": 2, "score": -4, "last_activity_date": 1491977332, "creation_date": 1491972978, "last_edit_date": 1491977295, "question_id": 43360603, "link": "https://stackoverflow.com/questions/43360603/c-strange-behavior-of-wrong-initialization-of-array", "title": "C: strange behavior of wrong initialization of array", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int step;\n    double position[4];\n    position[0] = 1;\n    for (step = 1;step&lt;=4;step++){\n        position[step] = 99;\n    }\n    return 0;\n\n}\n</code></pre>\n\n<p>can compile without error and the resulting program can run.</p>\n\n<p>However, </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int step;\n    double position[3];\n    position[0] = 1;\n    for (step = 1;step&lt;=3;step++){\n        position[step] = 99;\n    }\n    return 0;\n\n}\n</code></pre>\n\n<p>can compile also but the program cannot run: The error is <code>Abort trap: 6</code>.</p>\n\n<p>In both cases above, the (wrongly) initialized array is of size one less than what I fill in the for loop. But why do <code>4</code> and <code>3</code> make a difference here?</p>\n\n<p>Now, more interestingly, </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\n    int step;\n    double position[4];\n    position[0] = 1;\n    position[1] = 99;\n    position[2] = 99;\n    position[3] = 99;\n    position[4] = 99;\n    return 0;\n}\n</code></pre>\n\n<p>cannot even compile (Error is <code>array index 4 is past the end of the array (which contains 4 elements</code>). So why does for loop make a difference here?</p>\n"}, {"tags": ["c", "linux", "gcc", "linker", "ld"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1491974119, "post_id": 43360529, "comment_id": 73783725, "body": "The behaviour of this program is <a href=\"https://en.m.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined</a>. Also please don&#39;t post images of code."}, {"owner": {"reputation": 116, "user_id": 6660178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ZckF.jpg?s=128&g=1", "display_name": "Dhavalkumar Prajapati", "link": "https://stackoverflow.com/users/6660178/dhavalkumar-prajapati"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1491974453, "post_id": 43360529, "comment_id": 73783849, "body": "@n.m. ok i changed in the code thanks for suggesting"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491975633, "post_id": 43360529, "comment_id": 73784284, "body": "When you lie to your compiler, it will get its own back by not doing what you expected."}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 6660178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ZckF.jpg?s=128&g=1", "display_name": "Dhavalkumar Prajapati", "link": "https://stackoverflow.com/users/6660178/dhavalkumar-prajapati"}, "edited": false, "score": 0, "creation_date": 1491976400, "post_id": 43361099, "comment_id": 73784626, "body": "i little got you but still confusing in why x=0 and y=1078263808 ? can explain in details?  i didn&#39;t get this line &quot;1078263808 value is floating point representation of 42 in double.&quot; ! @Rajeshkumar"}, {"owner": {"reputation": 4074, "user_id": 4154350, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70e00ce9458ef1e59ce5734fd6e377f6?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre G.", "link": "https://stackoverflow.com/users/4154350/pierre-g"}, "edited": false, "score": 1, "creation_date": 1492062809, "post_id": 43361099, "comment_id": 73830544, "body": "this is a very clear answer. to enforce it you may generate a map file to demonstrate the respective position of x and y. More over you can make another small program to show that 42.0 (double) is encoded in 1078263808 by casting (printf(&quot;%ld\\n&quot; (int) (42.0))."}], "tags": [], "owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "is_accepted": true, "score": 2, "last_activity_date": 1491975531, "creation_date": 1491975531, "answer_id": 43361099, "question_id": 43360529, "link": "https://stackoverflow.com/questions/43360529/what-if-we-link-both-same-name-variable-with-different-data-type/43361099#43361099", "title": "what if we link both same name variable with different data type?", "body": "<p>In foo1.c you have two variables x and y each having 4 bytes totally 8 bytes. In foo2.c you are having x variable as double.</p>\n\n<p>While execution x in foo1 (4 bytes) is replaced by x in foo2 (8 bytes). Ultimately memory of x &amp; y (totally 8 bytes) in foo1 is overwritten by x in foo2 (8 bytes).</p>\n\n<p>1078263808 value is floating point representation of 42 in double.</p>\n\n<p>NOTE: x &amp; y memories in foo1 are successive.</p>\n"}], "owner": {"reputation": 116, "user_id": 6660178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ZckF.jpg?s=128&g=1", "display_name": "Dhavalkumar Prajapati", "link": "https://stackoverflow.com/users/6660178/dhavalkumar-prajapati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 43361099, "answer_count": 1, "score": 1, "last_activity_date": 1492002801, "creation_date": 1491972532, "last_edit_date": 1492002801, "question_id": 43360529, "link": "https://stackoverflow.com/questions/43360529/what-if-we-link-both-same-name-variable-with-different-data-type", "title": "what if we link both same name variable with different data type?", "body": "<p>I have tried below code foo1.c </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid f(void);\nint x = 38;\nint y = 39;\n\nint main() {\nf();\nprintf(\"x = %d\\n\", x);\nprintf(\"y = %d\\n\", y);\nreturn 0;\n}\n</code></pre>\n\n<p>foo2.c</p>\n\n<pre><code>double x;\n\nvoid f() {\nx = 42.0;\n}\n</code></pre>\n\n<p>output: </p>\n\n<pre><code>$ gcc -o myprog foo1.c foo2.c\n$ ./myprog\nx = 0\ny = 1078263808\n</code></pre>\n\n<p>i got weird output for this code can some one explain how it will come? </p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 1, "creation_date": 1491972500, "post_id": 43360440, "comment_id": 73783207, "body": "You are not assigning your array to any value. That is why before any assignment it is filler with <b>garbage</b> value."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1491973087, "post_id": 43360440, "comment_id": 73783399, "body": "Perhaps <code>float array [7] = {0};</code> would give you more predictable results and prevent <b>Undefined Behavior</b> that takes place when you <b>attempt to access an uninitialized element</b> within the array beginning at <code>array[3]</code>. If you initialize all elements of the array, you can iterate over the entire array without invoking undefined behavior, if you fail to initialize the array, you must limit your iteration to only the first three defined elements in your array."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1492009098, "post_id": 43360440, "comment_id": 73808268, "body": "note: this statement: <code>float f = 3.24; is assigning a </code>double` literal to a <code>float</code> variable.  To corrected produce a <code>float</code> literal, the last char of the literal must be a <code>f</code>  I.E. <code>float f = 3.24f;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 4591020, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002230606185/picture?type=large", "display_name": "Rushal Verma", "link": "https://stackoverflow.com/users/4591020/rushal-verma"}, "is_accepted": true, "score": 4, "last_activity_date": 1491972481, "creation_date": 1491972481, "answer_id": 43360524, "question_id": 43360440, "link": "https://stackoverflow.com/questions/43360440/explain-the-result-values-of-c-program-relevant-with-printf/43360524#43360524", "title": "Explain the result values of c program relevant with printf", "body": "<p>The last values are known as garbage values in C. \nIf you do not initialize a variable explicitly in C, it's value could be anything before you explicitly assign something to it. This anything could be garbage; the language standard does not specify what it should be.</p>\n\n<p>You can read this blog for How C compiler decides garbage values: <a href=\"http://blog.aditech.info/2008/02/how-c-compiler-decides-garbage-values.html\" rel=\"nofollow noreferrer\">http://blog.aditech.info/2008/02/how-c-compiler-decides-garbage-values.html</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 731, "user_id": 3744013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fvioU.jpg?s=128&g=1", "display_name": "SimpleBeat", "link": "https://stackoverflow.com/users/3744013/simplebeat"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491973434, "post_id": 43360534, "comment_id": 73783530, "body": "Thank you, David, just appended it to the answer!"}, {"owner": {"reputation": 188, "user_id": 5849792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O30tc.jpg?s=128&g=1", "display_name": "Randula Koralage", "link": "https://stackoverflow.com/users/5849792/randula-koralage"}, "edited": false, "score": 0, "creation_date": 1491974555, "post_id": 43360534, "comment_id": 73783884, "body": "Thank you for your clear answer and is there any reason to have values such as &quot;-1.#R &quot; and &quot;0.00&quot; ?. I am asking that because these two values are different from &quot;96627196995476105000000000000000.00 &quot; and &quot;96629547147269436000000000000000.00&quot;"}, {"owner": {"reputation": 731, "user_id": 3744013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fvioU.jpg?s=128&g=1", "display_name": "SimpleBeat", "link": "https://stackoverflow.com/users/3744013/simplebeat"}, "reply_to_user": {"reputation": 188, "user_id": 5849792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O30tc.jpg?s=128&g=1", "display_name": "Randula Koralage", "link": "https://stackoverflow.com/users/5849792/randula-koralage"}, "edited": false, "score": 0, "creation_date": 1491974947, "post_id": 43360534, "comment_id": 73784011, "body": "Thank you! There is no reason whatsoever! It just happened so that on your machine the region of memory you&#39;ve marked for your array and didn&#39;t overwrite with a default value contained some bits that the compiler interpreted as those numbers."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1492009197, "post_id": 43360534, "comment_id": 73808338, "body": "With modern C compilers, when the returned value from <code>main()</code> is 0 then not actual <code>return</code> statement is necessary."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1492009259, "post_id": 43360534, "comment_id": 73808392, "body": "to avoid implicit conversions, this line: <code>float array[7] = {0}</code> should be: <code>float array[7] = {0.0f}</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1492009408, "post_id": 43360534, "comment_id": 73808547, "body": "@SimpleBeat, the compiler did not interpret any of those uninitialized values.  Rather the values were treated as if they were valid values by the application as it ran."}], "tags": [], "owner": {"reputation": 731, "user_id": 3744013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fvioU.jpg?s=128&g=1", "display_name": "SimpleBeat", "link": "https://stackoverflow.com/users/3744013/simplebeat"}, "is_accepted": false, "score": 2, "last_activity_date": 1491973404, "last_edit_date": 1491973404, "creation_date": 1491972600, "answer_id": 43360534, "question_id": 43360440, "link": "https://stackoverflow.com/questions/43360440/explain-the-result-values-of-c-program-relevant-with-printf/43360534#43360534", "title": "Explain the result values of c program relevant with printf", "body": "<p><em>First.</em><br>\nYes, your code is correct (add <code>return 0</code> command at the end of your <code>main()</code> function though). However, it needs to be more specific, which leads to your second question.</p>\n\n<p><em>Second.</em><br>\nC is a language that allows a programmer to do lots of things, but it also requires the programmer to do lots of manual coding.</p>\n\n<p>So, when you declare an array of 7 items, C compiler marks a region of memory to accommodate those items (in this case of the type of <code>float</code>). But it doesn't actually check what that region of memory contains until you explicitly assign the values. In your case the last four values (which you have not assigned yourself) are just garbage left in the region of memory marked for your array.</p>\n\n<p>Once again, <em>compiler does <strong>not</strong> clear the memory for you when you declare the array</em>, it just marks the region of memory. It's your responsibility to assign default values to the array.</p>\n\n<p>Your possible solution is to manually initialize all of the elements of your array to some default value (for example, a <code>0</code>), like this:</p>\n\n<pre><code>float array[7] = {0}\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 5849792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O30tc.jpg?s=128&g=1", "display_name": "Randula Koralage", "link": "https://stackoverflow.com/users/5849792/randula-koralage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 43360524, "answer_count": 2, "score": 1, "last_activity_date": 1491973404, "creation_date": 1491972093, "question_id": 43360440, "link": "https://stackoverflow.com/questions/43360440/explain-the-result-values-of-c-program-relevant-with-printf", "title": "Explain the result values of c program relevant with printf", "body": "<p>I was tried to print values of a float array with 7 elements. I assigned only 3 values and they are belong to float, double and integer. </p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(){   \n    float array [7];\n\n    float f = 3.24;\n    double d = 23.5;\n    int i = 4;\n\n    array[0] = f;\n    array[1] = i;\n    array[2] = d;\n\n    int n = sizeof(array)/sizeof(float);\n    printf(\"Number of Elements : %d \\n\\n\\n\",n);\n\n    for(int j = 0; j &lt; n ; j++){\n        printf(\"%.2f ,\",array[j]);\n    }\n    printf(\"\\b \");\n\n}\n</code></pre>\n\n<p>I got an output as follows :\nNumber of Elements : 7</p>\n\n<p>3.24 ,4.00 ,23.50 ,-1.#R ,96627196995476105000000000000000.00 ,96629547147269436000000000000000.00 ,0.00</p>\n\n<p>I want to clear is my code correct? And why last four values are different to each other. What are these values?</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 4559989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-eRpedyCStI0/AAAAAAAAAAI/AAAAAAAAAB4/MKAPxowX8ZA/photo.jpg?sz=128", "display_name": "coco", "link": "https://stackoverflow.com/users/4559989/coco"}, "edited": false, "score": 0, "creation_date": 1491973544, "post_id": 43360619, "comment_id": 73783556, "body": "Thank you very much! After I move it, it has the error like &quot;error: implicit declaration of function &#39;execvpe&#39; is invalid in C99 [-Werror,-Wimplicit-function-declaration]     execvpe(tests[0], tests, envp);&quot;"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "reply_to_user": {"reputation": 503, "user_id": 4559989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-eRpedyCStI0/AAAAAAAAAAI/AAAAAAAAAB4/MKAPxowX8ZA/photo.jpg?sz=128", "display_name": "coco", "link": "https://stackoverflow.com/users/4559989/coco"}, "edited": false, "score": 0, "creation_date": 1491973646, "post_id": 43360619, "comment_id": 73783589, "body": "@coco It works here with GCC 6.3.1 and Glibc 2.25. Are you possibly using some other C standard library that doesn&#39;t provide <code>execvpe</code>?"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "reply_to_user": {"reputation": 503, "user_id": 4559989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-eRpedyCStI0/AAAAAAAAAAI/AAAAAAAAAB4/MKAPxowX8ZA/photo.jpg?sz=128", "display_name": "coco", "link": "https://stackoverflow.com/users/4559989/coco"}, "edited": false, "score": 0, "creation_date": 1491975104, "post_id": 43360619, "comment_id": 73784079, "body": "You can see a demonstration of the lack of warnings online here: <a href=\"https://godbolt.org/g/m2eyRi\" rel=\"nofollow noreferrer\">godbolt.org/g/m2eyRi</a>"}, {"owner": {"reputation": 503, "user_id": 4559989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-eRpedyCStI0/AAAAAAAAAAI/AAAAAAAAAB4/MKAPxowX8ZA/photo.jpg?sz=128", "display_name": "coco", "link": "https://stackoverflow.com/users/4559989/coco"}, "edited": false, "score": 0, "creation_date": 1492044897, "post_id": 43360619, "comment_id": 73825753, "body": "I tried your link, didn&#39;t find my current gcc version (4.3.1). I use mac, and I brew installed gcc (6.3.0) after I saw your comment, here is the same error:                                                   <code>warning: implicit declaration of function &#39;execvpe&#39; [-Wimplicit-function-declaration]      execvpe(tests[0], tests, envp);      ^~~~~~~ Undefined symbols for architecture x86_64:   &quot;_execvpe&quot;, referenced from:       _main in cc0Bn7X3.o ld: symbol(s) not found for architecture x86_64 collect2: error: ld returned 1 exit status</code>"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "reply_to_user": {"reputation": 503, "user_id": 4559989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-eRpedyCStI0/AAAAAAAAAAI/AAAAAAAAAB4/MKAPxowX8ZA/photo.jpg?sz=128", "display_name": "coco", "link": "https://stackoverflow.com/users/4559989/coco"}, "edited": false, "score": 0, "creation_date": 1492045882, "post_id": 43360619, "comment_id": 73825946, "body": "brew? OS X? If so, you can&#39;t use <code>_GNU_SOURCE</code> . (Well technically you could if you installed and linked with Glibc, but that would be pretty unusual.)"}, {"owner": {"reputation": 503, "user_id": 4559989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-eRpedyCStI0/AAAAAAAAAAI/AAAAAAAAAB4/MKAPxowX8ZA/photo.jpg?sz=128", "display_name": "coco", "link": "https://stackoverflow.com/users/4559989/coco"}, "edited": false, "score": 0, "creation_date": 1492047289, "post_id": 43360619, "comment_id": 73826288, "body": "Thanks for your help! I will try to use other functions."}], "tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": true, "score": 0, "last_activity_date": 1491973089, "creation_date": 1491973089, "answer_id": 43360619, "question_id": 43360387, "link": "https://stackoverflow.com/questions/43360387/execvpe-implicit-declaration-error/43360619#43360619", "title": "execvpe implicit declaration error", "body": "<p>Move the <code>#define _GNU_SOURCE</code> directive to before any of the <code>#include</code> directives, e.g.</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n</code></pre>\n\n<p>In Glibc, all of these headers pull in <code>features.h</code> which sets various macros based on the setting of <code>_XOPEN_SOURCE</code>, <code>_POSIX_SOURCE</code>, <code>_GNU_SOURCE</code>, etc. At the time of the first include, it is not set. When you get down to <code>unistd.h</code>, <code>features.h</code> has already been included and won't be applied again.</p>\n"}], "owner": {"reputation": 503, "user_id": 4559989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-eRpedyCStI0/AAAAAAAAAAI/AAAAAAAAAB4/MKAPxowX8ZA/photo.jpg?sz=128", "display_name": "coco", "link": "https://stackoverflow.com/users/4559989/coco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1443, "favorite_count": 0, "accepted_answer_id": 43360619, "answer_count": 1, "score": 1, "last_activity_date": 1491973089, "creation_date": 1491971720, "last_edit_date": 1495542741, "question_id": 43360387, "link": "https://stackoverflow.com/questions/43360387/execvpe-implicit-declaration-error", "title": "execvpe implicit declaration error", "body": "<p>I'm testing the execvpe() in c, I tried the below code, which cause the error as \"implicit declaration of function 'execvpe' is invalid in C99 [-Wimplicit-function-declaration]\".</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define _GNU_SOURCE\n#include &lt;unistd.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    //execl(\"/bin/echo\", \"echo\", \"Hello, world\", NULL);\n    char *path = getenv(\"PATH\");\n    char  pathenv[strlen(path) + sizeof(\"PATH=\")];\n    sprintf(pathenv, \"PATH=%s\", path);\n    char *envp[] = {pathenv, NULL};\n    char *tests[] = {\"ls\", \"-lR\", NULL};\n    execvpe(tests[0], tests, envp);\n    fprintf(stderr, \"failed to execute \\\"%s\\\"\\n\", tests[0]);\n    return 0;\n}\n</code></pre>\n\n<p>Then I test this code as below to test the existing status (which I copied from <a href=\"https://stackoverflow.com/questions/37241835/compiler-warnings-for-execvpe-function\">Compiler warnings for execvpe function</a>, this time no error. Is there anyone can help me to figure out what's wrong in my above code? Thanks!</p>\n\n<pre><code>#include &lt;unistd.h&gt;\nextern int execvpe(const char *file, char *const argv[], char *const envp[]);\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1491971850, "post_id": 43360381, "comment_id": 73782965, "body": "You&#39;re trying to use a pointer as a different type of pointer. That rarely goes well."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 275, "user_id": 4944033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ooK9.jpg?s=128&g=1", "display_name": "Rohit Mourya", "link": "https://stackoverflow.com/users/4944033/rohit-mourya"}, "edited": false, "score": 0, "creation_date": 1491974221, "post_id": 43360381, "comment_id": 73783768, "body": "@RohitMourya: Something like <code>int **</code> is not a 2D array, nor can it point to one! It is a completely different datastructure."}, {"owner": {"reputation": 275, "user_id": 4944033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ooK9.jpg?s=128&g=1", "display_name": "Rohit Mourya", "link": "https://stackoverflow.com/users/4944033/rohit-mourya"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1491974339, "post_id": 43360381, "comment_id": 73783820, "body": "@Olaf Yes I agree but in this case OP has created list[] and each index acts as a list in itself."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 275, "user_id": 4944033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ooK9.jpg?s=128&g=1", "display_name": "Rohit Mourya", "link": "https://stackoverflow.com/users/4944033/rohit-mourya"}, "edited": false, "score": 0, "creation_date": 1492005490, "post_id": 43360381, "comment_id": 73805160, "body": "@RohitMourya: <b>NO</b>. This is a pointer, not an array! Different type and properties! An <code>int **</code>can point to an array of <b>pointers</b>, Each of these pointers <b>can</b> point to the first element of another array itself.But such _jagged arrays are completely different from a 2D array! Just because you can use the index-operator on both does not make them even related! Please refrain from telling this to beginners; there is already enough confusion about pointers and arrays, see other questions. And the question uses a 1D array of structs` which is even more different."}, {"owner": {"reputation": 275, "user_id": 4944033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ooK9.jpg?s=128&g=1", "display_name": "Rohit Mourya", "link": "https://stackoverflow.com/users/4944033/rohit-mourya"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1492005562, "post_id": 43360381, "comment_id": 73805228, "body": "@Olaf Yeah. I agree."}], "owner": {"reputation": 61, "user_id": 1248785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e78225936fdff48f1c45b7e29c98abfc?s=128&d=identicon&r=PG", "display_name": "x7qiu", "link": "https://stackoverflow.com/users/1248785/x7qiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491971670, "creation_date": 1491971670, "question_id": 43360381, "link": "https://stackoverflow.com/questions/43360381/c-passing-address-of-pointer-vs-passing-address-of-array", "title": "C: passing address of pointer vs passing address of array", "body": "<p>This was an remote coding test I got a few days ago, and I've already submitted the answers so I'm not cheating here.</p>\n\n<p>The question is fairly simple: implement a function to delete an item from a linked list. But with one catch: the linked list is in the form of an array.</p>\n\n<pre><code>typedef struct _Node{\n    int val;\n    struct _Node* next;\n} Node;\n</code></pre>\n\n<p>Test input provided by the interviewer, which we can modify slightly</p>\n\n<pre><code>void printLL(Node* root){\n    Node* current = root;\n    while (current){\n        printf(\"%d\\n\", current-&gt;val);\n        current = current-&gt;next; \n    }\n}\n\nint main(){\n   Node list[6];\n   list[0].value =1; list[0].next = list+1;\n   list[1].value =2; list[1].next = list+2;\n   list[2].value =3; list[2].next = list+3;\n   list[3].value =4; list[3].next = list+4;\n   list[4].value =5; list[4].next = list+5;\n   list[5].value =6; list[5].next = 0;\n\n   delete(&amp;list, 3) // this gives segmentation error with my implementation;\n   printLL(list);\n   return 0;\n}\n</code></pre>\n\n<p>My answer, which is standard for linked list deletion:</p>\n\n<pre><code>void delete(Node** root, int val){\n    Node* current = *root;\n    Node* prev = NULL;\n\n    if ((*root)-&gt;val == val){\n        *root = (*root)-&gt;next;\n        //free(current); // test case not dynamically allocated\n        return;\n    }\n    while (current &amp;&amp; (current-&gt;val != val)){\n        prev = current;\n        current = current-&gt;next;\n     }\n    if (!current){\n       printf(\"value not found\\n\");\n       return ;\n     }\n    else{\n       prev-&gt;next = current-&gt;next;\n       //free(current);\n    }\n}\n</code></pre>\n\n<p>However, if I use pointers instead, then the function works</p>\n\n<pre><code> Node* p = list;\n delete(&amp;p, 3);\n</code></pre>\n\n<p>I think I understand the difference between &amp;list and &amp;p as function argument:</p>\n\n<pre><code>**Variable name  |  Variable value      |     Variable address**\n\nlist             | address of first elem |     address of first elem\n\np                | address of first elem | some random address of the pointer\n</code></pre>\n\n<p>But since in the delete function we are operating with *list and *p respectively, their value should also be the same.</p>\n\n<p>My guess now is because of in</p>\n\n<pre><code>   *root = (*root)-&gt;next;\n</code></pre>\n\n<p>if *root is an array name, then it's illegal as we cannot reassign it. But if *root is a pointer, then we are freely to reassign them. Am I correct on this?</p>\n\n<p>Thank you for reading through this long and messy post.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1491972211, "post_id": 43360368, "comment_id": 73783088, "body": "<code>char** argv</code> is not a 2D array, but a pointer to a pointer.  <code>char a[3][4]</code> is a 2D array."}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1491972235, "post_id": 43360368, "comment_id": 73783098, "body": "<i>&quot;But can I get a 2d char array like below to avoid memory allocation&quot;</i> what do you mean by &quot;can I get&quot;? Get from where? Do you know the size of that array in advance?"}, {"owner": {"reputation": 1323, "user_id": 4526762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/435c180747c0e6dfa55d96b308b3b7a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yuan Wen", "link": "https://stackoverflow.com/users/4526762/yuan-wen"}, "edited": false, "score": 0, "creation_date": 1491972563, "post_id": 43360368, "comment_id": 73783230, "body": "I want to transform the original cmd to a 2d array. I want to use it like a 2d array afterwards.@AlexLop."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491973440, "post_id": 43360368, "comment_id": 73783532, "body": "Yes, you can <b>tokenize</b> your string into discrete words with <code>strtok</code> or <code>strsep</code> or by simply walking a pair of pointers down your string an identifying the individual words directly and assigning each word to a successive <i>pointer-to-pointer-to-char</i> or by copying the words to a 2D array of chars of sufficient size.."}, {"owner": {"reputation": 690, "user_id": 4187370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240cfc5c0fab089cfe9035e9bc85f421?s=128&d=identicon&r=PG&f=1", "display_name": "Rogus", "link": "https://stackoverflow.com/users/4187370/rogus"}, "edited": false, "score": 0, "creation_date": 1491973672, "post_id": 43360368, "comment_id": 73783607, "body": "Do those pointer-to-pointers have to point at your <code>cmd</code> string? Do you need to keep this string in one place and not copy it anywhere?"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1491974597, "post_id": 43360368, "comment_id": 73783899, "body": "You can just replace the spaces for null terminators and store the pointers for each word. Just keep in mind you cannot modify string literals. You will still need to allocate an array of pointers with as many elements as there are words."}], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 4187370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240cfc5c0fab089cfe9035e9bc85f421?s=128&d=identicon&r=PG&f=1", "display_name": "Rogus", "link": "https://stackoverflow.com/users/4187370/rogus"}, "edited": false, "score": 0, "creation_date": 1491974544, "post_id": 43360826, "comment_id": 73783881, "body": "what if there are 20 tokens? or 100? The last token will be composed of <code>X-MAX</code> space-separated substrings"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 690, "user_id": 4187370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240cfc5c0fab089cfe9035e9bc85f421?s=128&d=identicon&r=PG&f=1", "display_name": "Rogus", "link": "https://stackoverflow.com/users/4187370/rogus"}, "edited": false, "score": 0, "creation_date": 1491975315, "post_id": 43360826, "comment_id": 73784164, "body": "You either set <code>MAX</code> sufficiently large or you <i>dynamically allocate</i> as needed, your choice. However, in the context of this question the problem definition was for a set of <code>5</code> tokens. If I were implementing this, then I would dynamically allocate the first <code>MAX</code> pointers in <code>arr</code> and then call <code>realloc</code> as required to handle as many words there are in the line."}, {"owner": {"reputation": 690, "user_id": 4187370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240cfc5c0fab089cfe9035e9bc85f421?s=128&d=identicon&r=PG&f=1", "display_name": "Rogus", "link": "https://stackoverflow.com/users/4187370/rogus"}, "edited": false, "score": 0, "creation_date": 1491975713, "post_id": 43360826, "comment_id": 73784311, "body": "That&#39;s correct, but OP stated that the number of tokens is not fixed and he wants to avoid memory allocation. Most of the times setting <code>MAX</code> to a sufficiently large value works, but IMHO it&#39;s bad practice."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1491977982, "last_edit_date": 1491977982, "creation_date": 1491974208, "answer_id": 43360826, "question_id": 43360368, "link": "https://stackoverflow.com/questions/43360368/transform-1d-char-array-to-2d-char-array-without-allocating-memory/43360826#43360826", "title": "Transform 1D char array to 2D char array without allocating memory", "body": "<p>Continuing from my comment, you can <em>tokenize</em> your string with, e.g. <code>strtok</code> and assign the pointers to the individual words to a <em>pointer-to-pointer-to-char</em>. For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 10\n\nint main (void) {\n\n    char *cmd = (char[]){\"a bcd ef hijk lmmopq\"},       /* compound literal */\n    // char cmd[] = \"a bcd ef hijk lmmopq\";   /* otherwise declare as array */\n        *arr[MAX] = {NULL},\n        *delim = \" \\n\";\n    size_t n = 0;\n\n    for (char *p = strtok (cmd, delim); n &lt; MAX &amp;&amp; p; p = strtok (NULL, delim))\n        arr[n++] = p;\n\n    for (int i = 0; i &lt; (int)n; i++)\n        printf (\"arr[%d]: %s\\n\", i, arr[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>*Example Use/Output**</p>\n\n<pre><code>$./bin/str2ptp\narr[0]: a\narr[1]: bcd\narr[2]: ef\narr[3]: hijk\narr[4]: lmmopq\n</code></pre>\n\n<p><strong>Note:</strong> You cannot pass a <strong><em>string literal</em></strong> to <code>strtok</code> as <code>strtok</code> modifies the string. Either use a pointer to an array or declare and initialize as a normal <code>char[]</code> array to begin with.</p>\n\n<hr>\n\n<p><strong>Dynamically allocating pointer for unknown number of words</strong></p>\n\n<p>If you have no idea whether you could read twenty words or 2000 words, you can easily handle the situation by dynamically allocating blocks of pointers, and then <code>realloc</code>ating again if the prior max allocation is again reached. It is a simple process, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 10\n#define MAXB 4096\n\nint main (void) {\n\n    char cmd[MAXB] = \"\",  /* buffer of 4096 chars to hold each line input */\n        **arr = calloc (MAX, sizeof *arr),\n        *delim = \" \\n\";\n    size_t n = 0, max = MAX;\n\n    while (fgets (cmd, MAXB, stdin)) { /* read each line of input on stdin */\n\n        size_t len = strlen (cmd);  /* get line length */\n        if (cmd[len - 1] == '\\n')   /* test for trailing '\\n'  */\n            cmd[--len] = 0;         /* overwrite with nul-byte */\n\n        for (char *p = strtok (cmd, delim); p; p = strtok (NULL, delim)) {\n            arr[n++] = p;\n\n            if (n == max) { /* realloc arr by MAX if n == MAX */\n                void *tmp = realloc (arr, (max + MAX) * sizeof *arr);\n                if (!tmp) {\n                    fprintf (stderr, \"error: memory exhausted.\\n\");\n                    break;\n                }\n                arr = tmp;  /* zero new pointers (optional) */\n                memset (arr + max, 0, MAX * sizeof *arr);\n                max += MAX; /* update current max iteration */\n            }\n        }\n        for (int i = 0; i &lt; (int)n; i++)\n            printf (\"arr[%2d]: %s\\n\", i, arr[i]);\n    }\n\n    free (arr);  /* don't forget, if you allocate it -&gt; you free it. */\n\n    return 0;\n}\n</code></pre>\n\n<p>Above, always validate your allocations with, e.g. <code>if (!arr) { /* handle error */ }</code> which was omitted from the initial allocation of <code>arr</code> for brevity.</p>\n\n<p><strong>Example Use/Input</strong></p>\n\n<pre><code>$ echo \"A quick brown fox jumps over the lazy dog while the dog watched\" | \\\n./bin/strtop2pdyn\narr[ 0]: A\narr[ 1]: quick\narr[ 2]: brown\narr[ 3]: fox\narr[ 4]: jumps\narr[ 5]: over\narr[ 6]: the\narr[ 7]: lazy\narr[ 8]: dog\narr[ 9]: while\narr[10]: the\narr[11]: dog\narr[12]: watched\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1491987877, "creation_date": 1491987877, "answer_id": 43365036, "question_id": 43360368, "link": "https://stackoverflow.com/questions/43360368/transform-1d-char-array-to-2d-char-array-without-allocating-memory/43365036#43365036", "title": "Transform 1D char array to 2D char array without allocating memory", "body": "<p>As pointed out in another answer, <code>strtok</code> can be used to split up your string in-place so that delimiters (spaces) are replaced with null terminators. </p>\n\n<p>To know how many strings there will be, you'll have to iterate through the string twice. For the first iteration, invent some quick &amp; simple function that doesn't alter the string, like this:</p>\n\n<pre><code>size_t count_spaces (const char* src)\n{\n  size_t spaces=0;\n  for(; *src != '\\0'; src++)\n  {\n    if(*src == ' ')\n    {\n      spaces++;\n    }\n  }\n  return spaces;\n}\n</code></pre>\n\n<p>Then for the second iteration, use <code>strtok</code>. Full example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nsize_t count_spaces (const char* src)\n{\n  size_t spaces=0;\n  for(; *src != '\\0'; src++)\n  {\n    if(*src == ' ')\n    {\n      spaces++;\n    }\n  }\n  return spaces;\n}\n\nvoid tokenize (char* restrict src, \n               size_t dst_size, \n               char* restrict dst [dst_size])\n{\n  size_t i;\n  char* ptr = strtok(src, \" \");\n  for(i=0; i&lt;dst_size &amp;&amp; ptr != NULL; i++)\n  {\n    dst[i] = ptr;\n    ptr = strtok(NULL, \" \");\n  }\n}\n\nint main (void) \n{\n  char str [] = \"a bcd ef hijk lmmopq\";\n  size_t size = count_spaces(str) + 1;\n  char* ptr_arr [size];\n\n  tokenize(str, size, ptr_arr);\n\n  for(size_t i=0; i&lt;size; i++)\n  {\n    puts(ptr_arr[i]);\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 1323, "user_id": 4526762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/435c180747c0e6dfa55d96b308b3b7a4?s=128&d=identicon&r=PG&f=1", "display_name": "Yuan Wen", "link": "https://stackoverflow.com/users/4526762/yuan-wen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 43360826, "answer_count": 2, "score": 0, "last_activity_date": 1491987877, "creation_date": 1491971608, "last_edit_date": 1491972502, "question_id": 43360368, "link": "https://stackoverflow.com/questions/43360368/transform-1d-char-array-to-2d-char-array-without-allocating-memory", "title": "Transform 1D char array to 2D char array without allocating memory", "body": "<p>I have a string, for example\uff1a  </p>\n\n<p><code>char* cmd = \"a bcd ef hijk lmmopq\";</code>  </p>\n\n<p>The string is composed with segments split by space, the number of segments is not fixed.</p>\n\n<p>Intuitively, I can get a 2D char string by allocating memory dynamically, for example:</p>\n\n<pre><code>char** argv = malloc();\nchar* argv[0] = malloc();\n...\nchar* argv[i] = malloc();\n</code></pre>\n\n<p>But can I transform the original array to 2d char array like below to avoid memory allocation?</p>\n\n<pre><code>char* argv[] = {\"a\", \"bcd\", \"ef\", \"hijk\", \"lmmopq\"};  \n</code></pre>\n"}, {"tags": ["c", "producer-consumer"], "comments": [{"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 0, "creation_date": 1491972079, "post_id": 43360270, "comment_id": 73783045, "body": "In producer you are using <code>strlen</code> on a integer i.e. <code>buflen = strlen(sbuf.vector[i]) + 1 ;</code>"}, {"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 0, "creation_date": 1491972284, "post_id": 43360270, "comment_id": 73783113, "body": "Also in <code>scanf()</code> it should be <code>scanf(&quot;%d&quot;, &amp;(sbuf.vector[i]));</code>. The address of <code>sbuf.vector[i]</code>"}, {"owner": {"reputation": 184, "user_id": 713450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XKtcX.png?s=128&g=1", "display_name": "EmbedWise", "link": "https://stackoverflow.com/users/713450/embedwise"}, "edited": false, "score": 0, "creation_date": 1491972445, "post_id": 43360270, "comment_id": 73783185, "body": "And the second last printf of the producer also contains more arguments than the format expects. 4 expected 5 given."}], "owner": {"reputation": 39, "user_id": 7818917, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/09bbe5216c04e2a5db754be479637685?s=128&d=identicon&r=PG&f=1", "display_name": "Laurentiu", "link": "https://stackoverflow.com/users/7818917/laurentiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491971048, "creation_date": 1491971048, "question_id": 43360270, "link": "https://stackoverflow.com/questions/43360270/producer-and-consumer-segmentation-fault", "title": "Producer and consumer - segmentation fault", "body": "<p>I'm a beginner in concurrent programming and I want to implement a consumer and producer. I want to send after 3 seconds from producer two integers and I want to print the sum of numbers from producer.</p>\n\n<p>After running the code I have Segmentation fault :(.\nThank you for help :D</p>\n\n<p>This is my code for producer:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define VECTOR_SIZE 2\n\nstruct msgbuf\n{\n    long    mtype;\n    int     vector[VECTOR_SIZE];\n};\n\nint main() {\n    int msqid;\n    // int msgflg = IPC_CREAT | 0666;\n    key_t key;\n    struct msgbuf sbuf;\n    size_t buflen;\n    int i;\n\n    key = ftok(\".\", 'g');\n\n    //Get the message queue ID for the given key\n    if ((msqid = msgget(key, IPC_CREAT | 0666 )) &lt; 0) {\n      perror(\"Could not get message queue\\n\");\n      exit(1);\n    }\n    printf(\"MSQID value: %d\\n\", msqid);\n    //Message Type\n    sbuf.mtype = 1;\n    while(1){\n        for(i = 0; i &lt; 2; i++){\n            printf(\"Enter a message to add to message queue : \");\n            scanf(\"%d\",sbuf.vector[i]);\n\n            buflen = strlen(sbuf.vector[i]) + 1 ;\n        }\n        sleep(3);\n    }\n\n    // getchar();\n\n    if (msgsnd(msqid, &amp;sbuf, buflen, IPC_NOWAIT) &lt; 0)\n    {\n        printf (\"%d, %ld, %d, %d\\n\", msqid, sbuf.mtype, sbuf.vector[0], sbuf.vector[1], (int)buflen);\n        perror(\"Could not send message!\\n\");\n        exit(1);\n    }\n    else\n        printf(\"Message Sent\\n\");\n\n    exit(0);\n}\n</code></pre>\n\n<p>And here I have the code for consumer:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAXSIZE 128\n\n#define VECTOR_SIZE 2\n\nstruct msgbuf\n{\n    long    mtype;\n    char    vector[VECTOR_SIZE];\n};\nint main() {\n  int msqid;\n  key_t key;\n  struct msgbuf rcvbuffer;\n\n  // key = 1234;\n  key = ftok(\".\", 'g');\n\n  if ((msqid = msgget(key, 0666)) &lt; 0) {\n    perror(\"Could not get message queue\\n\");\n    exit(1);\n  }\n  printf(\"MSQID value: %d\\n\", msqid);\n  //  Receive an answer of message type 1.\n  if (msgrcv(msqid, &amp;rcvbuffer, MAXSIZE, 1, 0) &lt; 0) {\n    perror(\"Could not receive message!\\n\");\n    exit(1);\n  }\n\n  printf(\"%d\\n\", rcvbuffer.vector[0] + rcvbuffer.vector[1]);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "keil"], "comments": [{"owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491969920, "post_id": 43360075, "comment_id": 73782428, "body": "Header file mostly does not sence at linker errors. you need to specify library or object file to linker where required symbols is defined."}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491970184, "post_id": 43360075, "comment_id": 73782493, "body": "@oklas I&#39;m sorry I do not understand. Could you please specify what I need to do in terms of my code?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970234, "post_id": 43360075, "comment_id": 73782507, "body": "@15ongm can you show how are you trying to compile the code? Most probably you are not using the lock.o while linking."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1491970256, "post_id": 43360075, "comment_id": 73782515, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491970336, "post_id": 43360075, "comment_id": 73782535, "body": "Most possible your code have not errors and nothing to specify in its terms. This is build configuration problem."}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970360, "post_id": 43360075, "comment_id": 73782541, "body": "@AjayBrahmakshatriya What do you want specifically? B/c to compile I just click a button. Is there smtg I could print to give you more information? I&#39;m sorry if I annoy you if I sound very uneducated about this but much of this stuff wasn&#39;t explained to me"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491970429, "post_id": 43360075, "comment_id": 73782564, "body": "@oklas Yeah that&#39;s another possibility I read about. How can I check to see if the build configuration is right (I use Keil uVision)?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1491970430, "post_id": 43360075, "comment_id": 73782566, "body": "How did you compile your program?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970434, "post_id": 43360075, "comment_id": 73782568, "body": "When you click the compile button, there might be a compile log or a build log being generated. Could you copy it and share? Also which IDE are you using? Which operating system?"}, {"owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491970523, "post_id": 43360075, "comment_id": 73782593, "body": "You say click button - mean you use development environment, so you need to open configuartions of current project or build unit and add required library. Read in manual about <code>l_lock</code> and so on which library need to add."}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970601, "post_id": 43360075, "comment_id": 73782611, "body": "@AjayBrahmakshatriya I&#39;m using Keil uVision &amp; Windows. I put the build output in my question post"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491970608, "post_id": 43360075, "comment_id": 73782612, "body": "@oklas He has defined the missing symbols in a separate c file. So it is not a missing library but an issue with not including the lock.c in the project."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1491970627, "post_id": 43360075, "comment_id": 73782618, "body": "I notice that it did not compile lock.c. Why not?"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1491970688, "post_id": 43360075, "comment_id": 73782635, "body": "@immibis I wish I knew. I only am following directions I was told to do. So hypothetically following those direction lock.c should be compiled but I guess not."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970699, "post_id": 43360075, "comment_id": 73782640, "body": "@15ongm you can see in the build output that lock.c is not being compiled. Are you sure you have added it in the project? Or it just resides it the source directory?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970837, "post_id": 43360075, "comment_id": 73782676, "body": "@15ongm can you check if lock.c appears in the source folder under the &quot;Project&quot; tab on the left. I am assuming this is the Keil uVision you are using - <a href=\"http://www2.keil.com/mdk5/uvision/\" rel=\"nofollow noreferrer\">www2.keil.com/mdk5/uvision</a>"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970899, "post_id": 43360075, "comment_id": 73782694, "body": "@AjayBrahmakshatriya Yeah I realized I didn&#39;t add it. I&#39;m compiling it right now to see if it works now"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491970919, "post_id": 43360075, "comment_id": 73782698, "body": "@AjayBrahmakshatriya omg it compiles! I can&#39;t believe it was that stupid of a mistake! THANK-YOU!"}], "answers": [{"tags": [], "owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "is_accepted": false, "score": 0, "last_activity_date": 1491971154, "creation_date": 1491971154, "answer_id": 43360290, "question_id": 43360075, "link": "https://stackoverflow.com/questions/43360075/undefined-symbol-even-when-include-header-file/43360290#43360290", "title": "Undefined symbol even when include header file?", "body": "<p>Thanks to @AjayBrahmakshatriya, it turns out I didn't add <code>lock.c</code> to my project. That fixed everything. Whew.</p>\n"}], "owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1816, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491971154, "creation_date": 1491969762, "last_edit_date": 1491970575, "question_id": 43360075, "link": "https://stackoverflow.com/questions/43360075/undefined-symbol-even-when-include-header-file", "title": "Undefined symbol even when include header file?", "body": "<p>When I try to compile my code, I'm getting the error:</p>\n\n<pre><code>.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_init (referred from lab4_t0.o).\n.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_lock (referred from lab4_t0.o).\n.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_unlock (referred from lab4_t0.o).\n</code></pre>\n\n<p>I read that \"Undefined symbol errors can occur when a function is declared (as is the case for the lock functions in <code>lock.h</code>), but it is not properly implemented.\" But I feel that I am implementing all the functions in <code>lock.h</code> properly since all the functions are of type <code>void</code>and I don't <code>return</code> anything. So I don't know what I could be doing wrong to get this error.</p>\n\n<p>Any help would greatly be appreciated!</p>\n\n<p><strong><em>Note:</em></strong> Please let me know if I need to provide more code. I don't think I need to write what I put in the function implementations of <code>lock.h</code> since I feel all you need to know is that the function implementations do not return anything, but please let me know if I need to include that.</p>\n\n<h2>Code</h2>\n\n<p><strong>lock.c</strong></p>\n\n<pre><code>#include \"lock.h\"\n\nextern process_t * current_process; \nextern process_t * process_queue;\n\nvoid l_init(lock_t* l){\n    //Does stuff but never type return or return anything\n}\n\nvoid l_lock(lock_t* l){\n    //Does stuff but never type return or return anything\n}\n\nvoid l_unlock(lock_t* l){\n    //Does stuff but never type return or return anything\n}\n</code></pre>\n\n<p><strong>lock.h</strong></p>\n\n<pre><code>#ifndef __LOCK_H_INCLUDED__\n#define __LOCK_H_INCLUDED__\n\n#include \"3140_concur.h\"\n#include \"shared_structs.h\"\n\nvoid l_init(lock_t* l);\n\nvoid l_lock(lock_t* l);\n\nvoid l_unlock(lock_t* l);\n\n#endif /* __LOCK_H_INCLUDED */\n</code></pre>\n\n<p><strong>3140_concur.c</strong></p>\n\n<pre><code>#include \"3140_concur.h\"\n#include &lt;stdlib.h&gt;\n</code></pre>\n\n<p><strong>3140_concur.h</strong></p>\n\n<pre><code>#ifndef __3140_CONCUR_H__\n#define __3140_CONCUR_H__\n\n#include &lt;stdlib.h&gt;\n#include &lt;fsl_device_registers.h&gt;\n#include \"process.h\"\n\nvoid process_blocked (void);\n\nvoid process_terminated (void);\n\nunsigned int * process_stack_init (void (*f)(void), int n);\n\nvoid process_stack_free (unsigned int *sp, int n);\n\nvoid process_begin (void);\n\n#endif\n</code></pre>\n\n<p><strong>process.h</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;fsl_device_registers.h&gt;\n#include \"3140_concur.h\"\n\nstruct process_state;\ntypedef struct process_state process_t;\n\nunsigned int * process_select (unsigned int * cursp);\n\nextern process_t * current_process; \nextern process_t * process_queue;\n\nvoid process_start (void);\n\nint process_create (void (*f)(void), int n);\n</code></pre>\n\n<p><strong>process.c</strong> </p>\n\n<p>(I do <code>process_t* process_queue = NULL; &amp; process_t* current_process = NULL;</code> b/c I want them to be NULL before any functions are called)</p>\n\n<pre><code>#include \"3140_concur.h\" \n#include \"shared_structs.h\"\n#include &lt;stdlib.h&gt; \n#include &lt;fsl_device_registers.h&gt;\n\nprocess_t* process_queue = NULL;\nprocess_t* current_process = NULL;\n</code></pre>\n\n<p><strong>lab4_t0.c</strong></p>\n\n<pre><code>#include \"process.h\"\n#include \"utils.h\"\n#include \"lock.h\"\n\nlock_t l;\n\n\\\\uses functions in lock.h\n</code></pre>\n\n<h2>Update</h2>\n\n<p><strong>Build output</strong></p>\n\n<pre><code>*** Using Compiler 'V5.06 update 4 (build 422)', folder: 'C:\\Keil_v5\\ARM\\ARMCC\\Bin'\nBuild target 'Target 1'\ncompiling 3140_concur.c...\ncompiling lab4_t0.c...\nlab4_t0.c(42): warning:  #111-D: statement is unreachable\n        return 0;       \nlab4_t0.c: 1 warning, 0 errors\ncompiling process.c...\nprocess.c(100): warning:  #1-D: last line of file ends without a newline\n  }\nprocess.c: 1 warning, 0 errors\nlinking...\n.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_init (referred from lab4_t0.o).\n.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_lock (referred from lab4_t0.o).\n.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_unlock (referred from lab4_t0.o).\nNot enough information to list image symbols.\nFinished: 1 information, 0 warning and 3 error messages.\n\".\\Objects\\Lab4.axf\" - 3 Error(s), 2 Warning(s).\nTarget not created.\nBuild Time Elapsed:  00:00:39\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1491971316, "post_id": 43360069, "comment_id": 73782817, "body": "Well, do you want to <b>load</b> in <code>column order</code> and print in that same order, or do you want to load in <code>row order</code> and print in <code>column order</code> -- your statement is unclear. You can load//print in the same loop if you are not outputting in a different order. Regardless, both circumstances are covered in the answers below."}], "answers": [{"comments": [{"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1491970938, "post_id": 43360202, "comment_id": 73782704, "body": "It is said <code>load my matrix so that consecutive numbers will go down the columns</code> But you are loading it in the wrong way, just tweaking the output."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1491971033, "post_id": 43360202, "comment_id": 73782737, "body": "I misread it, in that case you get the gold star. I though the point was to change the row/col output using the pointer. Otherwise, what is the point of the pointer and single subscript if you just change <code>i</code>, <code>j</code> on initialization?"}, {"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1491971139, "post_id": 43360202, "comment_id": 73782764, "body": "Yes! that&#39;s pretty lame. I also have no clue about the pointer."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "edited": false, "score": 0, "creation_date": 1491971193, "post_id": 43360202, "comment_id": 73782783, "body": "Yes, I just edited and told them to use your answer if that was the intent."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1491971159, "last_edit_date": 1491971159, "creation_date": 1491970630, "answer_id": 43360202, "question_id": 43360069, "link": "https://stackoverflow.com/questions/43360069/converting-to-column-major-fashion-with-two-dimensional-array/43360202#43360202", "title": "Converting to column major fashion with two dimensional array", "body": "<p>If your point is to <code>load</code> the matrix with the opposite order, go with 4py's solution, if your point is to make use of the pointer to access the array in column order, then your solution is below.</p>\n\n<hr>\n\n<p>You were SO CLOSE, your problem is here (you had <code>i</code> and <code>j</code> swapped). To change from row/col major ordering, you can do:</p>\n\n<pre><code>    printf (\" %2d\", *(twodArrayptr + ((j * MAX) + i)));\n</code></pre>\n\n<p>Also note the <code>main</code> is type <code>int</code> and therefore returns a value.</p>\n\n<p>Putting it together, you could do something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX 5\n\nint main (void)\n{\n    int i, j, twodArray[MAX][MAX] = {{0}}, *twodArrayptr = (int *)twodArray;\n\n    for (i = 0; i &lt; MAX; i++) {\n        for (j = 0; j &lt; MAX; j++) {\n            twodArray[i][j] = (i * MAX) + j;\n            printf (\" %2d\", twodArray[i][j]);\n        }\n        putchar ('\\n');\n    }\n\n    putchar ('\\n');\n\n    for (i = 0; i &lt; MAX; i++) {\n        for (j = 0; j &lt; MAX; j++)\n            printf (\" %2d\", *(twodArrayptr + ((j * MAX) + i)));\n        putchar ('\\n');\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$./bin/rowcol2d\n  0  1  2  3  4\n  5  6  7  8  9\n 10 11 12 13 14\n 15 16 17 18 19\n 20 21 22 23 24\n\n  0  5 10 15 20\n  1  6 11 16 21\n  2  7 12 17 22\n  3  8 13 18 23\n  4  9 14 19 24\n</code></pre>\n\n<p>Also <strong>note:</strong>, you do not need to use the <em>variadic function</em> <code>printf</code> to output a single <em>character</em> use <code>putchar</code> instead <code>:)</code></p>\n"}, {"tags": [], "owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "is_accepted": false, "score": 0, "last_activity_date": 1491970803, "creation_date": 1491970803, "answer_id": 43360229, "question_id": 43360069, "link": "https://stackoverflow.com/questions/43360069/converting-to-column-major-fashion-with-two-dimensional-array/43360229#43360229", "title": "Converting to column major fashion with two dimensional array", "body": "<p>Change the assignment logic to <code>twodArray[i][j]= (j*5) + i;</code></p>\n\n<p>Works like a charm.</p>\n\n<pre><code>for(i = 0; i &lt; 5; i++)\n{\n    for(j = 0; j &lt; 5; j++)\n    {   \n        twodArray[i][j]= (j*5) + i;\n\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7853934, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6196d0794e9198bddfee1b0ddb2ae42b?s=128&d=identicon&r=PG&f=1", "display_name": "Mrs.Jones", "link": "https://stackoverflow.com/users/7853934/mrs-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 43360202, "answer_count": 2, "score": 0, "last_activity_date": 1491971159, "creation_date": 1491969725, "last_edit_date": 1491971155, "question_id": 43360069, "link": "https://stackoverflow.com/questions/43360069/converting-to-column-major-fashion-with-two-dimensional-array", "title": "Converting to column major fashion with two dimensional array", "body": "<p>I am trying to load my matrix so that consecutive numbers will go down the columns using pointer/addressing methods.  Currently my program prints the consecutive numbers across the rows. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\nint i,j;\nint twodArray[5][5], *twodArrayptr;\n\n\nint add = 0;\n\nfor(i = 0; i &lt; 5; i++)\n{\n    for(j = 0; j &lt; 5; j++)\n    {   \n        twodArray[i][j]= (i*5) + j;\n\n    }\n\n}\n\ntwodArrayptr = &amp;(twodArray[0][0]);\n\nfor(i = 0; i &lt; 5; i++)\n{\n    for(j = 0; j &lt; 5; j++)\n    {\n        printf(\"%d \", *(twodArrayptr +((i*5)+j)));\n\n\n    }\n    printf(\" \\n\");\n\n}\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "stack", "mips", "stack-pointer"], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 6907380, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/31f33090406e100c561dd39c8781af82?s=128&d=identicon&r=PG&f=1", "display_name": "CodeFreak", "link": "https://stackoverflow.com/users/6907380/codefreak"}, "edited": false, "score": 0, "creation_date": 1491969695, "post_id": 43359941, "comment_id": 73782374, "body": "thank you. I guess my main confusion is declaring the memory size and figuring out how to implement my variables based on the 8,4,0($sp) lines."}, {"owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "reply_to_user": {"reputation": 70, "user_id": 6907380, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/31f33090406e100c561dd39c8781af82?s=128&d=identicon&r=PG&f=1", "display_name": "CodeFreak", "link": "https://stackoverflow.com/users/6907380/codefreak"}, "edited": false, "score": 0, "creation_date": 1491969997, "post_id": 43359941, "comment_id": 73782450, "body": "I am happy to help. Good luck."}, {"owner": {"reputation": 70, "user_id": 6907380, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/31f33090406e100c561dd39c8781af82?s=128&d=identicon&r=PG&f=1", "display_name": "CodeFreak", "link": "https://stackoverflow.com/users/6907380/codefreak"}, "edited": false, "score": 0, "creation_date": 1491970314, "post_id": 43359941, "comment_id": 73782525, "body": "could you explain the whole allocating enough memory part?"}, {"owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "reply_to_user": {"reputation": 70, "user_id": 6907380, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/31f33090406e100c561dd39c8781af82?s=128&d=identicon&r=PG&f=1", "display_name": "CodeFreak", "link": "https://stackoverflow.com/users/6907380/codefreak"}, "edited": false, "score": 0, "creation_date": 1491971098, "post_id": 43359941, "comment_id": 73782754, "body": "do not understand what you mean, may be this is another question. Memory allocation is operation system responsibility. You need to call function to allocate memory. It need to read manual of your os."}], "tags": [], "owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "is_accepted": true, "score": 1, "last_activity_date": 1491968984, "creation_date": 1491968984, "answer_id": 43359941, "question_id": 43359785, "link": "https://stackoverflow.com/questions/43359785/how-to-manipulate-mips-code-and-use-stack-pointers/43359941#43359941", "title": "How to manipulate MIPS code and use stack pointers?", "body": "<p>Most common the command determines the mind of data.</p>\n\n<p>For example in pseudo code</p>\n\n<pre><code>inc $a0\n</code></pre>\n\n<p>this command increment data in register <code>$a0</code> work with it as with number</p>\n\n<pre><code>lw $s1, 0($a0)\n</code></pre>\n\n<p>this command load data from memory pointed by register <code>$a0</code> work with it as with pointer</p>\n"}, {"tags": [], "owner": {"reputation": 786, "user_id": 2851871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ebd4a137bbfc9f615802a3d41887bd9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/2851871/adam"}, "is_accepted": false, "score": 1, "last_activity_date": 1586326313, "last_edit_date": 1586326313, "creation_date": 1492515623, "answer_id": 43471134, "question_id": 43359785, "link": "https://stackoverflow.com/questions/43359785/how-to-manipulate-mips-code-and-use-stack-pointers/43471134#43471134", "title": "How to manipulate MIPS code and use stack pointers?", "body": "<p>Here is an example code that translate the flowing C code in MIPS.\nIn order to save and restore the preserved registers it make some place on the stack then using <code>sw</code> and <code>lw</code> to save and restore those registers.</p>\n\n<pre><code>int leaf_example(int g, int h, int i, int j) {\n    int f;\n    f = (g + h) - (i + j);\n    return f;\n}    \n\n\n\n.text\n main:\n\n        addi $a0,$0,1       #argument 0 = 1\n        addi $a1,$0,2       #argument 1 = 2\n        addi $a2,$0,3       #argument 2 = 3\n        addi $a3,$0,4       #argument 3 = 4\n        jal  leaf           # call function leaf\n        add  $s0,$v0,$zero  # return value\n\n        li $v0,10\n        syscall\n\n\n    leaf:\n        addi $sp, $sp, -12  #adjust stack to make room for 3 items\n        sw $s0, 8($sp)      #save register $s0 for use in memory location 8\n        sw $t0, 4($sp)      #save register $t0 for use in memory location 4\n        sw $t1, 0($sp)      #save register $t1 for use in memory location 0\n\n        add $t0, $a0, $a1   #register $t0 contains $a0 + $a1\n        add $t1, $a2, $a3   #register $t1 contains $a2 + $a3\n        sub $s0, $t0, $t1   #$t0 = $t0 - $t1 -&gt; $t0 = ($a0 + $a1) - ($a2 + $a3)\n\n        add $v0, $s0, $zero #copy $s0 to return register $v0\n\n        #Before returning, we restore three original values \n        #of registers we pushed onto stack by popping them\n        lw $t1, 0($sp)      #restore register $t1 for caller\n        lw $t0, 4($sp)      #restore register $t0 for caller\n        lw $s0, 8($sp)      #restore register $s0 for caller\n        addi $sp, $sp, 12    #adjust stack to delete 3 items\n\n        jr $ra         #jump back to calling routine\n</code></pre>\n"}], "owner": {"reputation": 70, "user_id": 6907380, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/31f33090406e100c561dd39c8781af82?s=128&d=identicon&r=PG&f=1", "display_name": "CodeFreak", "link": "https://stackoverflow.com/users/6907380/codefreak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1933, "favorite_count": 0, "accepted_answer_id": 43359941, "answer_count": 2, "score": 1, "last_activity_date": 1586326313, "creation_date": 1491967967, "last_edit_date": 1491971047, "question_id": 43359785, "link": "https://stackoverflow.com/questions/43359785/how-to-manipulate-mips-code-and-use-stack-pointers", "title": "How to manipulate MIPS code and use stack pointers?", "body": "<p>So, I recently made a code to count the number of binary 1's in C-code and in MIPS code. I did so in C by using a remainder value and increment a count_one variable. In MIPS, I did the same program but I shifted the bytes of the number until it counted all of the 1's. Howver, I want to try to learn how to use pointers but I can not seem to grasp the concept. My MIPS code is as follows:</p>\n\n<pre><code>.data\n  prompt: .asciiz \"Enter a integer: \"\n\n.text\n  li $v0,4\n  la $a0, prompt\n  syscall\n\n  li $v0,5\n  syscall\n  move $s0,$v0\n  j count\n\ncount:\n  beq $s0,0, exit\n  andi $t0,$s0,1\n  add $t1,$t1,$t0\n  srl $s0,$s0,1\n  j count\n\nexit:\n  move $a0,$t1\n  la $v0,1\n  syscall\n  li $v0,10\n  syscall\n</code></pre>\n\n<p>I get this complete MIPS code but I am unsure on how pointers completely work in MIPS and after reading I still don't understand. Any advice on how to implement pointers?</p>\n"}, {"tags": ["c", "keil"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491968005, "post_id": 43359731, "comment_id": 73781965, "body": "See the second section of my answer to <a href=\"http://stackoverflow.com/questions/1433204/\">How do I use <code>extern</code> to share variables between source files in C?</a>  \u2014 that part titled &#39;Not so good way to define global variables&#39;. You should use <code>extern</code> before the variable names in <code>process.h</code>.  If more than one source file includes <code>process.h</code>, a compiler is within its rights to complain about multiple definition, though on many systems you&#39;ll get away with it.  (If only one file includes <code>process.h</code>, why do you have the header?)"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491968492, "post_id": 43359731, "comment_id": 73782076, "body": "@JonathanLeffler Oh well that fixed my &quot;multiply defined&quot; error but now I&#39;m back to my original error (which is why I created <code>process.h</code> in the first place):"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491968510, "post_id": 43359731, "comment_id": 73782079, "body": "<code>.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_init (referred from lab4_t0.o).</code>"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491968535, "post_id": 43359731, "comment_id": 73782085, "body": "<code>.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_lock (referred from lab4_t0.o).</code>"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491968541, "post_id": 43359731, "comment_id": 73782091, "body": "<code>.\\Objects\\Lab4.axf: Error: L6218E: Undefined symbol l_unlock (referred from lab4_t0.o).</code>"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491968570, "post_id": 43359731, "comment_id": 73782098, "body": "@JonathanLeffler Do you know why I&#39;m getting these errors?"}, {"owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491968892, "post_id": 43359731, "comment_id": 73782174, "body": "@JonathanLeffler Tbh I don&#39;t know why I have <code>process.h</code>. It was just something I was told would fix the errors ` Undefined symbol l_init`, etc, but clearly it has not"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491973363, "post_id": 43359731, "comment_id": 73783503, "body": "On the face of it, the <code>l_init()</code>, <code>l_lock()</code> and <code>l_unlock()</code> undefined errors are because you aren&#39;t linking <code>lock.o</code> into the executable, or you haven&#39;t yet created <code>lock.c</code> (so you aren&#39;t linking it), or you have not defined the functions in <code>lock.c</code> even though the file exists, or the functions defined in another file that you aren&#39;t linking, or \u2026 The functions you try to call are not defined in the object files (or libraries) that you&#39;re trying to link."}], "answers": [{"tags": [], "owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "is_accepted": true, "score": 0, "last_activity_date": 1491971449, "creation_date": 1491971449, "answer_id": 43360343, "question_id": 43359731, "link": "https://stackoverflow.com/questions/43359731/getting-error-symbol-current-process-multiply-defined-confused-on-what-error-me/43360343#43360343", "title": "Getting error Symbol current_process multiply defined, confused on what error means and how to fix?", "body": "<p>Adding <code>extern</code> to my defintion of <code>current_process</code> and <code>process_queue</code> in <code>process.h</code> removed my \"multiply defined\" errors (thanks to @JonathanLeffler)</p>\n\n<p>Now I'm getting a different error, but at least I resolved this one :)</p>\n"}], "owner": {"reputation": 3250, "user_id": 4581003, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c8143ad891538b384fc7995ff0f7da0?s=128&d=identicon&r=PG&f=1", "display_name": "14wml", "link": "https://stackoverflow.com/users/4581003/14wml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 43360343, "answer_count": 1, "score": 0, "last_activity_date": 1491971449, "creation_date": 1491967619, "last_edit_date": 1592644375, "question_id": 43359731, "link": "https://stackoverflow.com/questions/43359731/getting-error-symbol-current-process-multiply-defined-confused-on-what-error-me", "title": "Getting error Symbol current_process multiply defined, confused on what error means and how to fix?", "body": "<p>I'm just trying to get my code to compile, but I keep running into errors:</p>\n<pre><code>.\\Objects\\Lab4.axf: Error: L6200E: Symbol current_process multiply defined (by lab4_t0.o and 3140_concur.o).\n.\\Objects\\Lab4.axf: Error: L6200E: Symbol current_process multiply defined (by process.o and 3140_concur.o).\n.\\Objects\\Lab4.axf: Error: L6200E: Symbol process_queue multiply defined (by lab4_t0.o and 3140_concur.o).\n.\\Objects\\Lab4.axf: Error: L6200E: Symbol process_queue multiply defined (by process.o and 3140_concur.o).\n</code></pre>\n<p>I really don't understand the error message.</p>\n<p>First, I'm not sure if <code>process.o</code> is referring to <code>process.h</code> or <code>process.c</code> (so I don't know which file to focus on). Same goes for <code>3140_concur.o</code> which has <code>3140_concur.c</code> and <code>3140_concur.h</code>.</p>\n<p>Secondly, I'm not sure what &quot;multiply defined&quot; means. I figure that means I instantiate <code>current_process</code> &amp; <code>process_queue</code> twice, but honestly I can't see how because I only &quot;define&quot; <code>current_process</code> and <code>process_queue</code> in <code>process.h</code>:</p>\n<pre><code>process_t * current_process; \nprocess_t * process_queue;\n</code></pre>\n<p>I don't even see how <code>lab4_t0.c</code> could be defining <code>process_queue</code> either so I'm confused by why these &quot;multiply defined&quot; error messages are popping up.</p>\n<p>ALTHOUGH, I have a feeling its because in<code>3140_concur.h</code> I <code>#include &quot;process.h&quot;</code> AND in <code>process.h</code> I define <code>process_queue</code> and <code>current_process</code> AND I also <code>#include &quot;3140_concur.h&quot;</code>. Same goes for <code>lab4_t0.c</code> (I <code>#include &quot;process.h&quot;</code>). But the reason I do that is b/c <code>process.c</code> uses methods from <code>3140_concur.h</code> and also <code>lab4_t0.c</code> uses methods from from <code>process.h</code>.</p>\n<p>So if my hunch is correct, and that's the reason I'm getting the errors, how can I properly modularize my code (aka what should I <code>#include</code> and not <code>#include</code>) so that I don't get these errors?</p>\n<p>If someone could type the code I need to do to remove these errors that would be great!</p>\n<p>Note: If you were wondering why I created <code>process.h</code> and why I didn't just put everything in <code>process.h</code> in <code>3140_concur.h</code> file, the reason for that is that it caused errors w/ <code>lock.c</code> that I don't want to go into here.</p>\n<h2>Brief summary of my code</h2>\n<p><strong>lock.c</strong></p>\n<pre><code>#include &quot;lock.h&quot;\nextern process_t * current_process; \nextern process_t * process_queue;\n</code></pre>\n<p><strong>lock.h</strong></p>\n<pre><code>#ifndef __LOCK_H_INCLUDED__\n#define __LOCK_H_INCLUDED__\n#include &quot;3140_concur.h&quot;\n#include &quot;shared_structs.h&quot;\nvoid l_init(lock_t* l);\nvoid l_lock(lock_t* l);\nvoid l_unlock(lock_t* l);\n#endif /* __LOCK_H_INCLUDED */\n</code></pre>\n<p><strong>3140_concur.c</strong></p>\n<pre><code>#include &quot;3140_concur.h&quot;\n#include &lt;stdlib.h&gt;\n</code></pre>\n<p><strong>3140_concur.h</strong></p>\n<pre><code>#ifndef __3140_CONCUR_H__\n#define __3140_CONCUR_H__\n\n#include &lt;stdlib.h&gt;\n#include &lt;fsl_device_registers.h&gt;\n#include &quot;process.h&quot;\n\nvoid process_blocked (void);\n\nvoid process_terminated (void);\n\nunsigned int * process_stack_init (void (*f)(void), int n);\n\nvoid process_stack_free (unsigned int *sp, int n);\n\nvoid process_begin (void);\n\n#endif\n</code></pre>\n<p><strong>process.h</strong></p>\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;fsl_device_registers.h&gt;\n#include &quot;3140_concur.h&quot;\n\nstruct process_state;\ntypedef struct process_state process_t;\n\nunsigned int * process_select (unsigned int * cursp);\n\nprocess_t * current_process; \nprocess_t * process_queue;\n\nvoid process_start (void);\n\nint process_create (void (*f)(void), int n);\n</code></pre>\n<p><strong>process.c</strong></p>\n<p>(I do <code>process_t* process_queue = NULL; &amp; process_t* current_process = NULL;</code> b/c I want them to be NULL before any functions are called)</p>\n<pre><code>#include &quot;3140_concur.h&quot; \n#include &quot;shared_structs.h&quot;\n#include &lt;stdlib.h&gt; \n#include &lt;fsl_device_registers.h&gt;\n\nprocess_t* process_queue = NULL;\nprocess_t* current_process = NULL;\n</code></pre>\n<p><strong>lab4_t0.c</strong></p>\n<pre><code>#include &quot;process.h&quot;\n#include &quot;utils.h&quot;\n#include &quot;lock.h&quot;\n\nlock_t l;\n</code></pre>\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["c", "compilation"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 3, "creation_date": 1491966933, "post_id": 43359515, "comment_id": 73781672, "body": "It&#39;s not a direct copy... in the link, the <code>#define e();</code> and the four lines under it are on a single line.  If you want to break up a macro like that, you have to put a backslash before the line endings that are within the macro."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1491967169, "post_id": 43359515, "comment_id": 73781747, "body": "That semicolon after <code>e()</code> is puzzling/intriguing.  It is part of the expansion of <code>e()</code>.  It means there&#39;s an empty statement after the <code>default:</code> before the text of the macro.  Weird.  Harmless, but weird."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1491968708, "post_id": 43359515, "comment_id": 73782120, "body": "As Dmitri said, you need to put the expansion of e() in the same line or use backslash to escape the new line. Secondly can you mention how you are compiling the code? Flags would be useful. Since the file has errors I am sure it won&#39;t generate .o too. It could be a stray .o from before."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 3358064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/022ecc1393facf4988c6de12334b1aee?s=128&d=identicon&r=PG&f=1", "display_name": "user3358064", "link": "https://stackoverflow.com/users/3358064/user3358064"}, "edited": false, "score": 0, "creation_date": 1491967282, "post_id": 43359622, "comment_id": 73781780, "body": "Ah i see being on windows must be my problem then, i&#39;ll try it in a VM"}, {"owner": {"reputation": 1785, "user_id": 692104, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/7ichc.jpg?s=128&g=1", "display_name": "AgnosticDev", "link": "https://stackoverflow.com/users/692104/agnosticdev"}, "reply_to_user": {"reputation": 7, "user_id": 3358064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/022ecc1393facf4988c6de12334b1aee?s=128&d=identicon&r=PG&f=1", "display_name": "user3358064", "link": "https://stackoverflow.com/users/3358064/user3358064"}, "edited": false, "score": 0, "creation_date": 1491967551, "post_id": 43359622, "comment_id": 73781851, "body": "Yes, I would try that as a first shot.  From the command line you can do gcc -o vortex vortex1.c and then run ./vortex"}], "tags": [], "owner": {"reputation": 1785, "user_id": 692104, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/7ichc.jpg?s=128&g=1", "display_name": "AgnosticDev", "link": "https://stackoverflow.com/users/692104/agnosticdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1491966855, "creation_date": 1491966855, "answer_id": 43359622, "question_id": 43359515, "link": "https://stackoverflow.com/questions/43359515/i-cannot-get-the-vortex1-c-file-to-compile-it-also-gives-back-an-o-file-when-i/43359622#43359622", "title": "I cannot get the vortex1.c file to compile, it also gives back an .o file when i&#39;m trying to get an .exe file", "body": "<p>What type of operating system are you on?  If you are trying to get an exe file and the program is referencing bash (\"bin/bash\") there will be some problems there.</p>\n\n<p>Also, I believe that <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/unistd.h.html\" rel=\"nofollow noreferrer\">unistd.h</a> is a unix library and may be causing you some problems if you are on a Windows machine.  </p>\n\n<p>Another thing to keep in mind is that the author of this file had the macro all defined on one line and it looks like you have it broken up into two lines which may or may not be causing problems.  Just something to take a look at.</p>\n\n<pre><code> #define e(); if(((unsigned int)ptr &amp; 0xff000000)==0xca000000) { setresuid(geteuid(), geteuid(), geteuid()); execlp(\"/bin/sh\", \"sh\", \"-i\", NULL); }\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 3358064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/022ecc1393facf4988c6de12334b1aee?s=128&d=identicon&r=PG&f=1", "display_name": "user3358064", "link": "https://stackoverflow.com/users/3358064/user3358064"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491966855, "creation_date": 1491966179, "question_id": 43359515, "link": "https://stackoverflow.com/questions/43359515/i-cannot-get-the-vortex1-c-file-to-compile-it-also-gives-back-an-o-file-when-i", "title": "I cannot get the vortex1.c file to compile, it also gives back an .o file when i&#39;m trying to get an .exe file", "body": "<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\n\n#define e(); \nif(((unsigned int)ptr &amp; 0xff000000)==0xca000000) \n    { \n        setresuid(geteuid(), geteuid(), geteuid()); execlp(\"/bin/sh\", \"sh\", \"-i\", NULL); \n}\n\nvoid print(unsigned char *buf, int len)\n{\n        int i;\n\n        printf(\"[ \");\n        for(i=0; i &lt; len; i++) printf(\"%x \", buf[i]);\n        printf(\" ]\\n\");\n}\n\nint main()\n{\n        unsigned char buf[512];\n        unsigned char *ptr = buf + (sizeof(buf)/2);\n        unsigned int x;\n\n        while((x = getchar()) != EOF) {\n                switch(x) {\n                        case '\\n': print(buf, sizeof(buf)); continue; break;\n                        case '\\\\': ptr--; break;\n                        default: e(); if(ptr &gt; buf + sizeof(buf)) continue; ptr++[0] = x; break;\n                }\n        }\n        printf(\"All done\\n\");\n}\n</code></pre>\n\n<p>My errors include: |8|error: expected identifier or '(' before 'if'|</p>\n\n<p>This is a direct copy from <a href=\"http://overthewire.org/wargames/vortex/vortex1.html\" rel=\"nofollow noreferrer\">http://overthewire.org/wargames/vortex/vortex1.html</a> so i assume the syntax is correct</p>\n"}, {"tags": ["c"], "owner": {"reputation": 1485, "user_id": 4143312, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RtGaS.jpg?s=128&g=1", "display_name": "Ka-Wa Yip", "link": "https://stackoverflow.com/users/4143312/ka-wa-yip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1491965185, "answer_count": 0, "score": 1, "last_activity_date": 1491964567, "creation_date": 1491964567, "question_id": 43359272, "link": "https://stackoverflow.com/questions/43359272/c-language-is-it-redundant-now-to-link-lm-as-of-now", "closed_reason": "Duplicate", "title": "C language: Is it redundant now to link `-lm` as of now?", "body": "<p><code>cc -o task task.c -lm</code> produces the same result as <code>cc -o task task.c</code>. My operating system is Mac Maverick. The <code>cc</code> version is:</p>\n\n<pre><code>Apple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn)\n</code></pre>\n\n<p>In my program <code>task.c</code>, I have include:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n</code></pre>\n\n<p>I use <code>log()</code>,<code>cos()</code>,<code>sqrt()</code> function from <code>&lt;math.h&gt;</code>. Since I included <code>&lt;math.h&gt;</code>, I heard that I have to include <code>-lm</code> to link it when I am compiling. However, I produce the same results whether I did the linking or not. Is typing <code>-lm</code> no longer necessary as of now or in Mac platform?</p>\n"}, {"tags": ["c", "visual-studio", "function"], "comments": [{"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "edited": false, "score": 2, "creation_date": 1491964596, "post_id": 43359263, "comment_id": 73781143, "body": "Make a place to store them and return a pointer to it."}, {"owner": {"reputation": 520, "user_id": 5455966, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/74882f5054200f9ab65418e3e1681143?s=128&d=identicon&r=PG&f=1", "display_name": "MateoConLechuga", "link": "https://stackoverflow.com/users/5455966/mateoconlechuga"}, "edited": false, "score": 1, "creation_date": 1491964756, "post_id": 43359263, "comment_id": 73781179, "body": "Do you want to return the end values of h and n, or an array/list of all those values?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 1, "creation_date": 1491965300, "post_id": 43359263, "comment_id": 73781318, "body": "Search around for arrays in C, and passing arrays to functions."}], "answers": [{"comments": [{"owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491966443, "post_id": 43359488, "comment_id": 73781555, "body": "Memory allocation for <code>h</code> is absent. And this example currently does not demonstrate how to return multiple values."}, {"owner": {"reputation": 1054, "user_id": 6106641, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/652b9195ab2ad7effd41fd7410661c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Archmede", "link": "https://stackoverflow.com/users/6106641/archmede"}, "reply_to_user": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491966512, "post_id": 43359488, "comment_id": 73781572, "body": "@oklas Multiple values cannot be returned in C programming language.  That is why you need to use a pointer. And yes, h is declared in main()"}, {"owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491966661, "post_id": 43359488, "comment_id": 73781606, "body": "You declare <code>double * h = 0.1;</code> this will compile with warn and <code>h</code>  pointer  will be initialized to 0. And you try to use like this <code>*h = (*h) &#47; 10;</code> - this will - segmentation fault"}, {"owner": {"reputation": 1054, "user_id": 6106641, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/652b9195ab2ad7effd41fd7410661c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Archmede", "link": "https://stackoverflow.com/users/6106641/archmede"}, "reply_to_user": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "edited": false, "score": 0, "creation_date": 1491975128, "post_id": 43359488, "comment_id": 73784086, "body": "@oklas  I updated my answer to answer your question,  I misunderstood at first"}], "tags": [], "owner": {"reputation": 1054, "user_id": 6106641, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/652b9195ab2ad7effd41fd7410661c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Archmede", "link": "https://stackoverflow.com/users/6106641/archmede"}, "is_accepted": false, "score": 0, "last_activity_date": 1491975062, "last_edit_date": 1491975062, "creation_date": 1491966005, "answer_id": 43359488, "question_id": 43359263, "link": "https://stackoverflow.com/questions/43359263/returning-two-variables-that-have-multiple-values/43359488#43359488", "title": "returning two variables that have multiple values", "body": "<p>Read into pointers if you want to learn more. But essentially by sending h as a pointer it will return it's value to main.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint findN(double xI, double xF, double h[]) {\n    int i = 0;\n    int n;\n\n    h[i] = 0.1;\n    do {\n        i++;\n        printf_s(\"%8.5f \\n\", *h);\n        n = ((xF - xI) / (*h));\n        h[i] = h[i-1] / 10;\n\n\n        printf_s(\"%6d \\n\", n);\n    } while (h[i] &gt;= 0.00001);\n\n\n    return n;\n}\n\nint main()\n{\n    double h[100];\n    double xI = 1.0, xF = 1.0;\n    int n;\n\n    n = findN(xI, xF, h);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6179, "user_id": 2969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b66660630d54cf58a7d4675be1d6ff?s=128&d=identicon&r=PG", "display_name": "oklas", "link": "https://stackoverflow.com/users/2969544/oklas"}, "is_accepted": false, "score": 1, "last_activity_date": 1491979427, "last_edit_date": 1491979427, "creation_date": 1491967062, "answer_id": 43359658, "question_id": 43359263, "link": "https://stackoverflow.com/questions/43359263/returning-two-variables-that-have-multiple-values/43359658#43359658", "title": "returning two variables that have multiple values", "body": "<p>Typical approach to return multpile values is using arrays and pass its pointer to function:</p>\n\n<pre><code>int f(double *h) {\n  h[0] = 1.1;\n  h[1] = 2.2;\n}\n\nint main()\n{\n  // create pointer\n  double *h;\n\n  // initialize it with memory block\n  h = malloc(2*sizeof(double));\n\n  // call the function\n  f(h);\n\n  // show output\n  printf_s(\"%8.5f \\n\", h[0]);\n  printf_s(\"%8.5f \\n\", h[1]);\n\n  // release memory block\n  free(h);\n\n  return 0;\n}\n</code></pre>\n\n<p>Also same array may be created without memory allocation. It is more simple but arrays exists only until execution is not leave away from function scope where it declared.</p>\n\n<pre><code>int main()\n{\n  // create array\n  double h[2];\n\n  // call the function\n  f(h);\n\n  // show output\n  printf_s(\"%8.5f \\n\", h[0]);\n  printf_s(\"%8.5f \\n\", h[1]);\n\n  return 0;\n}\n</code></pre>\n\n<p>And if you can know count of element only during function call you can allocate array in function and return array by pointer and release array at caller.</p>\n\n<pre><code>double* f() {\n  // create pointer\n  double *h;\n\n  // some size calculations\n  int size = 1+1;\n\n  // initialize it with memory block\n  h = malloc(size*sizeof(double));\n\n  // fill the array\n  h[0] = 1.1;\n  h[1] = 2.2;\n\n  // return array by pointer\n  return h;\n}\n\nint main()\n{\n  // create pointer\n  double *h;\n\n  // call the function\n  h = f();\n\n  // show output\n  printf_s(\"%8.5f \\n\", h[0]);\n  printf_s(\"%8.5f \\n\", h[1]);\n\n  // release memory block\n  free(h);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1491971535, "creation_date": 1491971535, "answer_id": 43360354, "question_id": 43359263, "link": "https://stackoverflow.com/questions/43359263/returning-two-variables-that-have-multiple-values/43360354#43360354", "title": "returning two variables that have multiple values", "body": "<p>There are many ways to solve this.  Another is to return a <code>struct</code>.</p>\n\n<p>Below, <code>findN()</code> returns <em>one</em> object.  It just happens that the object contains two members.  This approach is suitable when with small objects.  With large objects,other approaches should be considered.</p>\n\n<pre><code>typedef struct {\n  int n;\n  double h;\n} nh;\n\nnh findN(double xI, double xF) {\n  nh retval;\n  retval.h = 0.1;\n\n  do {\n    printf_s(\"%8.5f\\n\", retval.h);\n    retval.n = ((xF - xI) / retval.h);\n    retval.h = retval.h / 10;\n    printf_s(\"%6d\\n\", retval.n);\n  } while (retval.h &gt;= 0.00001);\n\n  return retval;\n}\n\n// usage exanple\nnh y;\ny = findN(1.23, 4.56);\nprintf_s(\"h:%8.5f, n:%6d\\n\", y.h, y.n);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7838050, "user_type": "registered", "profile_image": "https://graph.facebook.com/439768509689420/picture?type=large", "display_name": "Moses John", "link": "https://stackoverflow.com/users/7838050/moses-john"}, "is_accepted": false, "score": 0, "last_activity_date": 1492016982, "last_edit_date": 1492016982, "creation_date": 1491971901, "answer_id": 43360411, "question_id": 43359263, "link": "https://stackoverflow.com/questions/43359263/returning-two-variables-that-have-multiple-values/43360411#43360411", "title": "returning two variables that have multiple values", "body": "<p>Read pointers,you will be able to return as many values you want to return,when calling function through main add &amp;h in actual parameters,it means findN(xI,xF,&amp;h) and in declaring the function findN add double *h in formal parameters,that is int findN(double xI,double xF,double *h)....\"meaning of * is -value at address of....meaning of &amp; is address of.This will make changes in h globally in this program as the vale is changing in its address.You can return even more values like this using more variables.This is called returning values indirectly.Vote for my answer if its applicable.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1492017459, "creation_date": 1492017459, "answer_id": 43375824, "question_id": 43359263, "link": "https://stackoverflow.com/questions/43359263/returning-two-variables-that-have-multiple-values/43375824#43375824", "title": "returning two variables that have multiple values", "body": "<p>The simplest way to handle this is change the function to accept pointers to variables that will accept the values of <code>n</code> and <code>h</code>.  Then the function will <em>dereference</em> those pointers to update the relevant variables in the calling function.</p>\n\n<pre><code>void findN(double xI, double xF, int *ret_n, double *ret_h)\n{\n    ...\n    *ret_n = n;\n    *ret_h = h;\n}\n</code></pre>\n\n<p>Then you can call your function like this:</p>\n\n<pre><code>int n;\ndouble h;\nfindN(1.2, 3.4, &amp;n, &amp;h);\n</code></pre>\n\n<p>This method is fine for a relatively small number of parameters.  If the number of parameters gets to be too large, you can instead create a <code>struct</code> containing all of the values to be returned either pass in the address of the <code>struct</code> or just return the <code>struct</code> outright.</p>\n"}], "owner": {"reputation": 21, "user_id": 7853911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de89af2d9020c09e5208492b9dd73690?s=128&d=identicon&r=PG&f=1", "display_name": "S Maxwell", "link": "https://stackoverflow.com/users/7853911/s-maxwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1492017459, "creation_date": 1491964496, "question_id": 43359263, "link": "https://stackoverflow.com/questions/43359263/returning-two-variables-that-have-multiple-values", "title": "returning two variables that have multiple values", "body": "<p>I am trying to use a function that will calculate values for h and then input these values of h into an equation that will calculate n. This is what my code currently looks like... </p>\n\n<pre><code>int findN(double xI, double xF) {\n\n\ndouble h = 0.1;\nint n;\n\ndo {\n    printf_s(\"%8.5f \\n\", h);\n    n = ((xF - xI) / h);\n    h = h / 10;\n\n\n    printf_s(\"%6d \\n\", n);\n} while (h &gt;= 0.00001);\n\n\nreturn n;\n}\n</code></pre>\n\n<p>I know that this function will only return n currently, but as i am new to this i am unsure as to how to also return all the values of h as well as all the values of n... If someone could assist me and show me how to return all the values for n &amp; h, it would be much appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "multithreading", "data-structures"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491964617, "post_id": 43359241, "comment_id": 73781148, "body": "Look into read-write locks..."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491964740, "post_id": 43359241, "comment_id": 73781176, "body": "@Dmitri Is what I have for read/write locks not even remotely close of what the real implementation would look like?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491965198, "post_id": 43359241, "comment_id": 73781294, "body": "If you&#39;re sharing a variable among threads, you should be using atomic accesses or some sort of synchronisation mechanism like a mutex.  A read-write lock is like a mutex, except that it allows multiple threads to read, but requires exclusive access for writing.  For posix threads, there&#39;s <code>pthread_rwlock_t</code>, and windows has &quot;slim reader writer locks&quot;"}, {"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1491965279, "post_id": 43359241, "comment_id": 73781314, "body": "you need an atomic check and mutate, your version multiple threads could check mutating and it be false, and all move into setting the mutating variable all at the same time"}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491965294, "post_id": 43359241, "comment_id": 73781317, "body": "@Dmitri I understand threads contain mutexes but isn&#39;t it my <b>structure itself</b> that needs a mutex or lock? Like, inside my <code>struct</code> there must be some variable of some sort that handles that right?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1491965510, "post_id": 43359241, "comment_id": 73781367, "body": "You acquire (lock) the mutex/rwlock/etc. before accessing a resource, and release (unlock) when you&#39;re done... as long as <i>all</i> code that accesses it does this, the resource is protected.  It doesn&#39;t matter whether it&#39;s part of the structure or not, as long as you use it when accessing the structure."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1491977074, "post_id": 43359241, "comment_id": 73784934, "body": "@KeithNicholas Yeah I definitely understand that. How does one implement an &#39;atomic check and mutate&#39; ?"}], "answers": [{"comments": [{"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1491969976, "post_id": 43359418, "comment_id": 73782442, "body": "So the implementation is library dependent? That doesn&#39;t seem right. I thought inside of my <code>struct</code>, I need to add some variables to lock my threads since my <code>struct</code> <b>is the mutex</b>?"}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1491971454, "post_id": 43359418, "comment_id": 73782853, "body": "Let me restate: is there any way to do this without use of any thread libraries? The developer that uses my structure may not be on the operating system I design it for. So instead, can I just have a variable inside my <code>struct</code> that dictates when it is or is not safe to use that <code>struct</code> ?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1491972312, "post_id": 43359418, "comment_id": 73783123, "body": "@Hatefiend if you don&#39;t want to tie your code to any particular thread API, it may be better to leave the locking up to the user rather than trying to implement your own one-off mutex or read-write lock (which may be more difficult to do correctly than you expect).  All they&#39;d need to do is acquire/release the lock of their choice (presumably one that goes with whatever threading implementation they&#39;re using) before/after calling your access functions."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1491993002, "post_id": 43359418, "comment_id": 73795624, "body": "@Hatefiend <i>is there any way to do this without use of any thread libraries?</i>  Yes.  You can reimplement what the thread libraries already do.  There&#39;s a reason those libraries exist..."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1491994404, "post_id": 43359418, "comment_id": 73796690, "body": "@AndrewHenle It&#39;s just that I really hate having to learn new libraries and I&#39;ll avoid it at all costs. External libraries require a ton of hassle to download, link with visual studio, lot of reading and after finally learning how it all works, there might be a better library out there or maybe your library isn&#39;t cross platform so now your amazing cross platform project is windows only, etc. I do like the idea of the user providing the locking/unlocking mechanism though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user208608"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1492049315, "post_id": 43359418, "comment_id": 73826753, "body": "@Hatefiend If you&#39;re on Windows and using Visual Studio, you likely won&#39;t have to link any new libraries.  You just have to add a #include to your source file.  Most C++ projects in visual studio already link the Windows API library."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user208608"}, "is_accepted": false, "score": 0, "last_activity_date": 1491965501, "last_edit_date": 1495540447, "creation_date": 1491965501, "answer_id": 43359418, "question_id": 43359241, "link": "https://stackoverflow.com/questions/43359241/c-how-to-make-my-data-structure-implementation-synchronized/43359418#43359418", "title": "C - How to make my data structure implementation synchronized?", "body": "<p>You have the right idea, just the wrong approach.  I'm not sure what OS you're programming on, but you want to look at the concepts of <code>mutex</code> or <code>semaphore</code> to do what you want to do.</p>\n\n<p>On Linux/Unix that is POSIX compliant, you can look at pthreads:</p>\n\n<p><a href=\"http://www.cs.wm.edu/wmpthreads.html\" rel=\"nofollow noreferrer\">http://www.cs.wm.edu/wmpthreads.html</a></p>\n\n<p>On Windows, you can look at <code>Critical Sections</code> for something close to a <code>mutex</code> concept:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682530(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms682530(v=vs.85).aspx</a></p>\n\n<p>Or <code>WaitForMultipleObjects</code> for something close to a <code>semaphore</code>:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms687025(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms687025(v=vs.85).aspx</a></p>\n\n<p>And, yes, using <code>while</code> loops are a bad idea.  In this case, you are using what is known as a busy loop.  More reading on it here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/4911397/what-is-a-busy-loop\">What is a busy loop?</a></p>\n\n<p>Using <code>mutex</code> or <code>semaphore</code>, no while loop is required.  Good luck!</p>\n"}], "owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491965501, "creation_date": 1491964368, "question_id": 43359241, "link": "https://stackoverflow.com/questions/43359241/c-how-to-make-my-data-structure-implementation-synchronized", "title": "C - How to make my data structure implementation synchronized?", "body": "<p>I have a data structure which I personally implemented that now needs to be used across multiple threads.</p>\n\n<pre><code>typedef struct \n{\n    void** array_of_elements;\n    size_t size;\n} myStruct;\n</code></pre>\n\n<p>For simplicity, let's say my data structure has these functions:</p>\n\n<pre><code>// Gets a data element from the structure.\nvoid* get(myStruct *x);\n// Prints out all the data elements.\nvoid print(myStruct *x);\n// Adds an element into the structure.\nvoid add(myStruct *x, void *to_be_added);\n</code></pre>\n\n<p>It's not a problem whatsoever to call <code>get</code> while another thread is calling <code>print</code> since they are both accessors. However, <code>get</code> and <code>print</code> cannot work while <code>add</code> is currently being called. Vice versa, <code>add</code> cannot work if <code>get</code> and <code>print</code> are currently in-progress.</p>\n\n<p>So I changed <code>myStruct</code> to look like the following: </p>\n\n<pre><code>typedef struct \n{\n    void** array_of_elements;\n    size_t size;\n\n    // True when a mutator is editing this struct.\n    bool mutating;\n    // The number of threads currently accessing this struct.\n    int accessors;\n} myStruct;\n</code></pre>\n\n<p>Now my functions look like the following:</p>\n\n<pre><code>void* get(myStruct *x)\n{\n    // Wait for mutating to end.\n    while (x-&gt;mutating);\n    // Indicate that another accessor is now using this struct.\n    x-&gt;accessors++;\n\n    // get algorithm goes here\n\n    // Declare we are finished reading.\n    x-&gt;accessors--;\n\n    return ...\n}\n\n// Same as above...\nvoid print(myStruct *x)\n...\n\nvoid add(myStruct *x)\n{\n    // Wait for any accessors or mutators to finish.\n    while (x-&gt;mutating || x-&gt;accessors &gt; 0);    \n    x-&gt;mutating = true;\n\n    // add algorithm here\n\n    x-&gt;mutating = false;\n}\n</code></pre>\n\n<p><strong>BUT</strong>, I think there are a lot of problems with this approach and I can't find a way to solve them:</p>\n\n<ul>\n<li>One of my classmates told me using while loops like this slows the thread down immensely.</li>\n<li>It has no sense of a queue. The first method that begins waiting for the <code>myStruct</code> to finish being used isn't necessarily the one that goes next.</li>\n<li>Even IF I had a queue data structure for which thread goes next, <strong>that data structure would also need to be synchronized, which in itself is an infinite loop of needing a synchronized data structure to synchronize itself</strong>.</li>\n<li>I think it's possible that in the same nano second one thread changes the <code>accessors</code> counter from <code>0</code> to <code>1</code> (meaning they want to start reading), it's possible for a mutator thread to see it's value is <code>0</code> and start mutating. Then, both a mutator thread and an accessor thread would be going at the same time.</li>\n<li>I'm pretty sure this logic can cause grid-lock (threads waiting on each other infinitely).</li>\n<li>I don't know how to make certain threads sleep and wake up right when they need to for this task, besides having it stuck in a <code>while</code> loop.</li>\n</ul>\n"}, {"tags": ["c", "linked-list", "char", "compare", "strcmp"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 2, "creation_date": 1491962811, "post_id": 43359003, "comment_id": 73780699, "body": "What exactly are <i>handwritten</i> chars?"}, {"owner": {"reputation": 105, "user_id": 5422163, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/9de18e183e0f45f467153f85eb3de7e1?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightP", "link": "https://stackoverflow.com/users/5422163/midnightp"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1491962937, "post_id": 43359003, "comment_id": 73780727, "body": "Sorry I meant hardcoded,fixed values"}], "answers": [{"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 1, "last_activity_date": 1491962778, "creation_date": 1491962778, "answer_id": 43359025, "question_id": 43359003, "link": "https://stackoverflow.com/questions/43359003/how-to-compare-char-with-a-char-linked-list-value/43359025#43359025", "title": "How to compare char with a char linked list value?", "body": "<p><code>strcmp</code> is used to compare strings; you are trying to compare individual characters here, which can be done with just <code>==</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 1, "last_activity_date": 1491962834, "creation_date": 1491962834, "answer_id": 43359028, "question_id": 43359003, "link": "https://stackoverflow.com/questions/43359003/how-to-compare-char-with-a-char-linked-list-value/43359028#43359028", "title": "How to compare char with a char linked list value?", "body": "<p>You don't need to (read: can't) use <code>strcmp()</code> to compare single characters. Assuming <code>temp-&gt;missed</code> is a <code>char</code> then all you need is <code>if (&amp;temp-&gt;missed == 'a') { ...</code></p>\n\n<p>You can also possibly simplify: <code>if (temp.missed == 'a') { ...</code></p>\n"}], "owner": {"reputation": 105, "user_id": 5422163, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/9de18e183e0f45f467153f85eb3de7e1?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightP", "link": "https://stackoverflow.com/users/5422163/midnightp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1491962834, "creation_date": 1491962562, "last_edit_date": 1491962815, "question_id": 43359003, "link": "https://stackoverflow.com/questions/43359003/how-to-compare-char-with-a-char-linked-list-value", "title": "How to compare char with a char linked list value?", "body": "<p>So basically I have a linked list node that has a char variable called missed that takes in a single char earlier on in my program. I am just trying to compare that char to a hardwritten char 'a','b','c' or 'd' in order to increment a counter.Running the program is giving me an Access Violation.</p>\n\n<pre><code>if (strcmp(&amp;temp-&gt;missed, 'a') == 0) {\nnoTackle++;\n}\n</code></pre>\n\n<p>I am comfortable with Java but new to C so is this an issue with how I am comparing or how I am calling my node or have I got it all horribly wrong?Any help appreciated</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1491962662, "post_id": 43358989, "comment_id": 73780647, "body": "What is the question here?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1491962769, "post_id": 43358989, "comment_id": 73780678, "body": "You&#39;ve not explained a problem or asked a question. This is a question and answer site. In order to get an answer, there needs to be a <i>clear problem description</i> and a <i>specific question</i>. You&#39;ve posted your assignment and dumped your code. Pasting your assignment is the problem <i>you</i> were given, but you&#39;ve not explained a problem related to the code you&#39;ve posted, or asked a question about that problem yet."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1491963094, "post_id": 43358989, "comment_id": 73780767, "body": "The temptation to post a <a href=\"https://en.wikipedia.org/wiki/Rube_Goldberg\" rel=\"nofollow noreferrer\">Rube Goldberg</a> solution is almost too strong to resist."}], "answers": [{"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": -1, "last_activity_date": 1491962666, "creation_date": 1491962666, "answer_id": 43359015, "question_id": 43358989, "link": "https://stackoverflow.com/questions/43358989/how-to-eliminates-all-letters-ch1-which-also-appear-ch2-language-c/43359015#43359015", "title": "how to eliminates all letters ch1 which also appear ch2 (language c)", "body": "<p>I think you're trying to use <code>X</code> as a <code>skip</code> flag. Rename it. </p>\n\n<p>You will have to reset that flag inside the <code>i</code> loop, as it will possibly have a different value for each letter.</p>\n\n<pre><code>for (i...) {\n    skip_this_letter = 0;\n\n    for (j...) {\n        if (...) {\n            skip_this_letter = 1;\n            break;\n        }\n    }\n\n    if (!skip_this_letter) {\n        // copy letter\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6025733, "user_type": "registered", "profile_image": "https://graph.facebook.com/175122079536374/picture?type=large", "display_name": "Samiir Tafrout", "link": "https://stackoverflow.com/users/6025733/samiir-tafrout"}, "edited": false, "score": 0, "creation_date": 1491964838, "post_id": 43359212, "comment_id": 73781196, "body": "thank you for that, but this is not what i want i will give you an exemple: abacab   aa        ==&gt;  bcab"}, {"owner": {"reputation": 1054, "user_id": 6106641, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/652b9195ab2ad7effd41fd7410661c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Archmede", "link": "https://stackoverflow.com/users/6106641/archmede"}, "reply_to_user": {"reputation": 11, "user_id": 6025733, "user_type": "registered", "profile_image": "https://graph.facebook.com/175122079536374/picture?type=large", "display_name": "Samiir Tafrout", "link": "https://stackoverflow.com/users/6025733/samiir-tafrout"}, "edited": false, "score": 0, "creation_date": 1491965428, "post_id": 43359212, "comment_id": 73781348, "body": "@SamiirTafrout can you vote my answer as correct, please.  Thank you"}], "tags": [], "owner": {"reputation": 1054, "user_id": 6106641, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/652b9195ab2ad7effd41fd7410661c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Archmede", "link": "https://stackoverflow.com/users/6106641/archmede"}, "is_accepted": true, "score": 1, "last_activity_date": 1491965155, "last_edit_date": 1491965155, "creation_date": 1491964153, "answer_id": 43359212, "question_id": 43358989, "link": "https://stackoverflow.com/questions/43358989/how-to-eliminates-all-letters-ch1-which-also-appear-ch2-language-c/43359212#43359212", "title": "how to eliminates all letters ch1 which also appear ch2 (language c)", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char ch1[30], ch2[30], ch3[30];\n    int i, j, L1, L2, X, k;\n\n    printf(\"veuillez saisir ch1: \\n\");\n    scanf(\"%s\",ch1);\n    printf(\"veuillez saisir ch2 : \\n\");\n    scanf(\"%s\",ch2);\n\n    L1=strlen(ch1);\n    L2=strlen(ch2);\n\n    for(i=0;i&lt;L1;i++)\n        for(j=0;j&lt;L2;j++){\n            if(ch1[i]==ch2[j]){\n                for(k = i; k &lt; L1 - 1; k++) {\n                    ch1[k]=ch1[k+1];\n                }\n                i--;\n                L1--;\n                ch1[L1] = '\\0';\n                for(k = j; k &lt; L2 - 1; k++) {\n                    ch2[k]=ch2[k+1];\n                }\n                L2--;\n                ch2[L2] = '\\0';\n                break;\n            } \n        }\n    printf(\"Cha\u00eene r\u00e9sultat : %s\\n\" , ch1);\n\n    return 0;\n}\n</code></pre>\n\n<p>What I'm basically doing is shifting the string down every time I find a char in ch1 which is in ch2. And then I'm null terminating the string so it prints correctly and reducing the size by 1.</p>\n"}], "owner": {"reputation": 11, "user_id": 6025733, "user_type": "registered", "profile_image": "https://graph.facebook.com/175122079536374/picture?type=large", "display_name": "Samiir Tafrout", "link": "https://stackoverflow.com/users/6025733/samiir-tafrout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 43359212, "answer_count": 2, "score": -1, "last_activity_date": 1491965155, "creation_date": 1491962461, "last_edit_date": 1491964689, "question_id": 43358989, "link": "https://stackoverflow.com/questions/43358989/how-to-eliminates-all-letters-ch1-which-also-appear-ch2-language-c", "title": "how to eliminates all letters ch1 which also appear ch2 (language c)", "body": "<p>Write a program that reads two strings of characters CH1 and CH2 on the keyboard and eliminates all the letters of CH1 which also appear in CH2.\nNote: without using pointer and strcpy.</p>\n\n<p>Could you please tell me why the characters aren't shifting correctly. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() \n{\n    char ch1[30], ch2[30], ch3[30];\n    int i, j, L1, L2, X;\n\n    printf(\"please enter ch1: \");\n    scanf(\"%s\",ch1);\n    printf(\"please enter ch2 : \");\n    scanf(\"%s\",ch2);\n\n    L1=strlen(ch1);\n    L2=strlen(ch2);\n\n    for(i=0;i&lt;L1;i++)\n        X=0;\n        for(j=0;j&lt;L2;j++){\n            if(ch1[i]==ch2[j]){\n                X=1;\n                ch1[i]=ch1[i+1];\n            } \n        }\n    printf(\"result : %s\" , ch1);\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "makefile", "arm"], "comments": [{"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1491962488, "post_id": 43358967, "comment_id": 73780601, "body": "See this question: <a href=\"http://stackoverflow.com/questions/4827618/compiling-c-file-with-assembler-file-dependencies#4827835\" title=\"compiling c file with assembler file dependencies%234827835\">stackoverflow.com/questions/4827618/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7853818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3901085b0aa7c1ac4eb8f1bde77e61b1?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Adams", "link": "https://stackoverflow.com/users/7853818/wesley-adams"}, "edited": false, "score": 0, "creation_date": 1491969590, "post_id": 43359090, "comment_id": 73782349, "body": "This is very helpful. There are examples out there but i&#39;m just not sure if it works differently when linking assembly files."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 1, "user_id": 7853818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3901085b0aa7c1ac4eb8f1bde77e61b1?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Adams", "link": "https://stackoverflow.com/users/7853818/wesley-adams"}, "edited": false, "score": 2, "creation_date": 1491986577, "post_id": 43359090, "comment_id": 73790672, "body": "Think of makefiles as having nothing to do with compiling or linking, it is just a scripty language used to run programs.  The programs can be anything, dont have to be related to toolchains.  Could have a program parse an audio file that does an FFT and creates a gnuplot formatted data file, then another rule takes the data file and calls gnuplot to generate a png."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 1, "last_activity_date": 1491964361, "last_edit_date": 1491964361, "creation_date": 1491963401, "answer_id": 43359090, "question_id": 43358967, "link": "https://stackoverflow.com/questions/43358967/how-do-i-write-a-makefile-to-link-c-code-with-arm-assembly-code/43359090#43359090", "title": "How do I write a Makefile to link C code with Arm assembly code?", "body": "<p>The same way you would make any make file. I am sure there are tons of examples out there and web pages.</p>\n\n<pre><code>ideally_the_result : dependencies\n&lt;tab&gt;the commands\n&lt;tab&gt;the commands\n&lt;tab&gt;the commands\n</code></pre>\n\n<p>so</p>\n\n<pre><code>printS.o : printS.c\n    gcc -c printS.c -o printS.o\n</code></pre>\n\n<p>And make a rule for each of the commands you are using.  I recommend you put the last one first so that it is the default if you dont have a command line option on make</p>\n\n<p>also </p>\n\n<pre><code>clean : \n   rm -f *.o\n   rm -f lab8test\n</code></pre>\n\n<p>to cover cleanup (make clean)</p>\n\n<p>That is the super simple way that just works.  From there you can dig into all kinds of (make program specific, gnu make vs others) special characters that mean things to make more complicated rules.</p>\n"}], "owner": {"reputation": 1, "user_id": 7853818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3901085b0aa7c1ac4eb8f1bde77e61b1?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Adams", "link": "https://stackoverflow.com/users/7853818/wesley-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1491964361, "creation_date": 1491962261, "last_edit_date": 1491962375, "question_id": 43358967, "link": "https://stackoverflow.com/questions/43358967/how-do-i-write-a-makefile-to-link-c-code-with-arm-assembly-code", "title": "How do I write a Makefile to link C code with Arm assembly code?", "body": "<p>The following terminal commands will compile and link my .c and .s files in linux</p>\n\n<pre><code>rm *.o\ngcc -c printS.c -o printS.o\nas lab8.S -o lab8.o\ngcc lab8.o printS.o -o lab8test\n</code></pre>\n\n<p>I have never written a make file and I figure something like this deserves one. Any help is appreciated.  </p>\n"}, {"tags": ["c", "linux-kernel", "raspberry-pi", "cross-compiling"], "comments": [{"owner": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 3, "creation_date": 1491964965, "post_id": 43358853, "comment_id": 73781235, "body": "These errors are not a problem with bounds.c but likely with your environment setup, include path, etc.  You might want to check the output file to see how the tool chain resolved the macros to setup things like CCPREFIX."}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1491978094, "post_id": 43358853, "comment_id": 73785421, "body": "(1) Edit your post to include the output of the <code>printenv</code> command before step #6. (2) Show the output of step #6."}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1491979808, "post_id": 43358853, "comment_id": 73786364, "body": "Is your host machine is 32 bit where you cross compile the kernel?"}, {"owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "reply_to_user": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1492045114, "post_id": 43358853, "comment_id": 73825793, "body": "@LethalProgrammer the host machine is 64 bit and I have libraries installed for cross-compiling on 64 bit machine"}, {"owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "reply_to_user": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 0, "creation_date": 1492045212, "post_id": 43358853, "comment_id": 73825813, "body": "@Peter L Could you elaborate little more? I am totally new to this stuff.."}, {"owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1492045854, "post_id": 43358853, "comment_id": 73825935, "body": "@sawdust Just edited the question. Please check."}, {"owner": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 0, "creation_date": 1492109544, "post_id": 43358853, "comment_id": 73860099, "body": "@EmbeddedManiac This is one of the most common issues when fresh building open source projects.  The first hint is <code>error: unknown type name &#39;u32&#39;</code>.  The path to required headers is not resolved.  Those who put together this package probably included the necessary paths within a config file.  However, they are not being picked up in your build.  The good news is that once you fix the build environment things normally go smoothly -- you usually get no build errors vs. a gazillion."}, {"owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "reply_to_user": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 0, "creation_date": 1492994657, "post_id": 43358853, "comment_id": 74206125, "body": "@Peter L. Thanks.. Tried couple of things but no luck.."}, {"owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "edited": false, "score": 0, "creation_date": 1492998236, "post_id": 43358853, "comment_id": 74206919, "body": "The problem is solved. I made a mistake in kernel version in the KERNEL_SRC path. Thanks to all of you for help. :)"}], "owner": {"reputation": 133, "user_id": 3686399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8631459a788cc61de468afddcd69227?s=128&d=identicon&r=PG&f=1", "display_name": "EmbeddedManiac", "link": "https://stackoverflow.com/users/3686399/embeddedmaniac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 953, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492045713, "creation_date": 1491961455, "last_edit_date": 1492045713, "question_id": 43358853, "link": "https://stackoverflow.com/questions/43358853/how-do-i-resolve-this-error-in-the-raspberry-pi-kernel-file-bounds-c", "title": "How do I resolve this error in the Raspberry Pi Kernel file bounds.c?", "body": "<p>I am new to kernel compilation. I want to create the Blinking LED driver for Raspberry Pi 1 Model B but as a first step towards the goal, I am trying to cross-compile unmodified Raspberry pi Kernel and following <a href=\"https://kerneltweaks.wordpress.com/2014/06/09/led-blinking-driver-for-raspberry-pi/\" rel=\"nofollow noreferrer\">this article.</a></p>\n\n<p>Everything goes fine until step 7. In step 7, when I enter cross compile command, it shows this:</p>\n\n<pre><code>$ make ARCH=arm CROSS_COMPILE=${CCPREFIX}  \n  CHK     include/config/kernel.release\n  CHK     include/generated/uapi/linux/version.h\n  CHK     include/generated/utsrelease.h\nmake[1]: 'include/generated/mach-types.h' is up to date.\n  CC      kernel/bounds.s\nIn file included from ./arch/arm/include/asm/bug.h:6:0,\n                 from include/linux/bug.h:4,\n                 from include/linux/page-flags.h:9,\n                 from kernel/bounds.c:9:\n./arch/arm/include/asm/opcodes.h:14:52: error: unknown type name 'u32'\n./arch/arm/include/asm/opcodes.h:14:64: error: unknown type name 'u32'\nIn file included from ./arch/arm/include/asm/irqflags.h:6:0,\n                 from include/linux/irqflags.h:15,\n                 from ./arch/arm/include/asm/bitops.h:27,\n                 from include/linux/bitops.h:36,\n                 from include/linux/log2.h:16,\n                 from kernel/bounds.c:12:\n./arch/arm/include/asm/ptrace.h:125:1: error: unknown type name 'bool'\n./arch/arm/include/asm/ptrace.h: In function 'regs_get_register':\n./arch/arm/include/asm/ptrace.h:141:6: error: expected expression before 'struct'\nIn file included from include/linux/bitops.h:36:0,\n                 from include/linux/log2.h:16,\n                 from kernel/bounds.c:12:\n./arch/arm/include/asm/bitops.h: In function '____atomic_set_bit':\n./arch/arm/include/asm/bitops.h:38:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\n./arch/arm/include/asm/bitops.h:38:23: note: each undeclared identifier is reported only once for each function it appears in\n./arch/arm/include/asm/bitops.h: In function '____atomic_clear_bit':\n./arch/arm/include/asm/bitops.h:50:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\n./arch/arm/include/asm/bitops.h: In function '____atomic_change_bit':\n./arch/arm/include/asm/bitops.h:62:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\n./arch/arm/include/asm/bitops.h: In function '____atomic_test_and_set_bit':\n./arch/arm/include/asm/bitops.h:76:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\n./arch/arm/include/asm/bitops.h: In function '____atomic_test_and_clear_bit':\n./arch/arm/include/asm/bitops.h:93:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\n./arch/arm/include/asm/bitops.h: In function '____atomic_test_and_change_bit':\n./arch/arm/include/asm/bitops.h:110:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\nIn file included from ./arch/arm/include/asm/bitops.h:122:0,\n                 from include/linux/bitops.h:36,\n                 from include/linux/log2.h:16,\n                 from kernel/bounds.c:12:\ninclude/asm-generic/bitops/non-atomic.h: In function '__set_bit':\ninclude/asm-generic/bitops/non-atomic.h:17:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\ninclude/asm-generic/bitops/non-atomic.h: In function '__clear_bit':\ninclude/asm-generic/bitops/non-atomic.h:25:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\ninclude/asm-generic/bitops/non-atomic.h: In function '__change_bit':\ninclude/asm-generic/bitops/non-atomic.h:42:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\ninclude/asm-generic/bitops/non-atomic.h: In function '__test_and_set_bit':\ninclude/asm-generic/bitops/non-atomic.h:59:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\ninclude/asm-generic/bitops/non-atomic.h: In function '__test_and_clear_bit':\ninclude/asm-generic/bitops/non-atomic.h:78:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\ninclude/asm-generic/bitops/non-atomic.h: In function '__test_and_change_bit':\ninclude/asm-generic/bitops/non-atomic.h:90:23: error: 'BITS_PER_LONG' undeclared (first use in this function)\ninclude/asm-generic/bitops/non-atomic.h: In function 'test_bit':\ninclude/asm-generic/bitops/non-atomic.h:105:21: error: 'BITS_PER_LONG' undeclared (first use in this function)\nIn file included from ./arch/arm/include/asm/bitops.h:312:0,\n                 from include/linux/bitops.h:36,\n                 from include/linux/log2.h:16,\n                 from kernel/bounds.c:12:\ninclude/asm-generic/bitops/fls64.h: At top level:\ninclude/asm-generic/bitops/fls64.h:33:2: error: #error BITS_PER_LONG not 32 or 64\nIn file included from ./arch/arm/include/asm/bitops.h:314:0,\n                 from include/linux/bitops.h:36,\n                 from include/linux/log2.h:16,\n                 from kernel/bounds.c:12:\ninclude/asm-generic/bitops/sched.h: In function 'sched_find_first_bit':\ninclude/asm-generic/bitops/sched.h:27:2: error: #error BITS_PER_LONG not defined\nIn file included from include/linux/log2.h:16:0,\n                 from kernel/bounds.c:12:\ninclude/linux/bitops.h: At top level:\ninclude/linux/bitops.h:202:37: error: unknown type name 'u64'\ninclude/linux/bitops.h:208:2: error: #error BITS_PER_LONG not 32 or 64\nIn file included from kernel/bounds.c:12:0:\ninclude/linux/log2.h:32:17: error: unknown type name 'u32'\ninclude/linux/log2.h:40:17: error: unknown type name 'u64'\ninclude/linux/log2.h:52:1: error: unknown type name 'bool'\nKbuild:44: recipe for target 'kernel/bounds.s' failed\nmake[1]: *** [kernel/bounds.s] Error 1\nMakefile:1004: recipe for target 'prepare0' failed\nmake: *** [prepare0] Error 2\n</code></pre>\n\n<p>I have not made any changes in any kernel file. I am not sure why bounds.c has a problem. Also, I downloaded the compressed version of the kernel file so I don't think it is a checkout/update issue. I have to confess I am confused as to what this error actually means. Am I missing something?</p>\n\n<p>Thanks in advance</p>\n\n<p>EDIT: \n(1) <code>printenv</code> before step #6</p>\n\n<pre><code>$ printenv\nXDG_VTNR=7\nXDG_SESSION_ID=c2\nCLUTTER_IM_MODULE=xim\nXDG_GREETER_DATA_DIR=/var/lib/lightdm-data/omkar\nSESSION=ubuntu\nGPG_AGENT_INFO=/home/omkar/.gnupg/S.gpg-agent:0:1\nSHELL=/bin/bash\nTERM=xterm-256color\nVTE_VERSION=4205\nQT_LINUX_ACCESSIBILITY_ALWAYS_ON=1\nWINDOWID=58720266\nKERNEL_SRC=/home/bhargav/rpi/linux-rpi-3.2.27\nOLDPWD=/home/omkar/rpi\nUPSTART_SESSION=unix:abstract=/com/ubuntu/upstart-session/1000/1623\nGNOME_KEYRING_CONTROL=\nGTK_MODULES=gail:atk-bridge:unity-gtk-module\nUSER=omkar\nLS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:\nQT_ACCESSIBILITY=1\nXDG_SESSION_PATH=/org/freedesktop/DisplayManager/Session0\nXDG_SEAT_PATH=/org/freedesktop/DisplayManager/Seat0\nSSH_AUTH_SOCK=/run/user/1000/keyring/ssh\nDEFAULTS_PATH=/usr/share/gconf/ubuntu.default.path\nXDG_CONFIG_DIRS=/etc/xdg/xdg-ubuntu:/usr/share/upstart/xdg:/etc/xdg\nPATH=/home/omkar/bin:/home/omkar/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\nDESKTOP_SESSION=ubuntu\nQT_IM_MODULE=ibus\nQT_QPA_PLATFORMTHEME=appmenu-qt5\nXDG_SESSION_TYPE=x11\nPWD=/home/omkar/rpi/linux-rpi-4.4.y\nJOB=unity-settings-daemon\nXMODIFIERS=@im=ibus\nGNOME_KEYRING_PID=\nLANG=en_US.UTF-8\nGDM_LANG=en_US\nMANDATORY_PATH=/usr/share/gconf/ubuntu.mandatory.path\nIM_CONFIG_PHASE=1\nCOMPIZ_CONFIG_PROFILE=ubuntu\nGDMSESSION=ubuntu\nSESSIONTYPE=gnome-session\nGTK2_MODULES=overlay-scrollbar\nHOME=/home/omkar\nXDG_SEAT=seat0\nSHLVL=1\nLANGUAGE=en_US\nGNOME_DESKTOP_SESSION_ID=this-is-deprecated\nUPSTART_INSTANCE=\nUPSTART_EVENTS=xsession started\nXDG_SESSION_DESKTOP=ubuntu\nLOGNAME=omkar\nCOMPIZ_BIN_PATH=/usr/bin/\nQT4_IM_MODULE=xim\nXDG_DATA_DIRS=/usr/share/ubuntu:/usr/share/gnome:/usr/local/share/:/usr/share/:/var/lib/snapd/desktop\nDBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-S9i5BrLSwB\nCCPREFIX=/home/omkar/rpi/tools-master/arm-bcm2708/arm-bcm2708-linux-gnueabi/bin/arm-bcm2708-linux-gnueabi-\nLESSOPEN=| /usr/bin/lesspipe %s\nINSTANCE=\nUPSTART_JOB=unity7\nXDG_RUNTIME_DIR=/run/user/1000\nDISPLAY=:0\nXDG_CURRENT_DESKTOP=Unity\nGTK_IM_MODULE=ibus\nLESSCLOSE=/usr/bin/lesspipe %s %s\nXAUTHORITY=/home/omkar/.Xauthority\n_=/usr/bin/printenv\n</code></pre>\n\n<p>(2) Output of step #6</p>\n\n<pre><code>$ make ARCH=arm CROSS_COMPILE=${CCPREFIX} bcmrpi_defconfig\n  HOSTCC  scripts/basic/fixdep\n  HOSTCC  scripts/kconfig/conf.o\n  SHIPPED scripts/kconfig/zconf.tab.c\n  SHIPPED scripts/kconfig/zconf.lex.c\n  SHIPPED scripts/kconfig/zconf.hash.c\n  HOSTCC  scripts/kconfig/zconf.tab.o\n  HOSTLD  scripts/kconfig/conf\n#\n# configuration written to .config\n#\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "coredump"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491960048, "post_id": 43358650, "comment_id": 73780006, "body": "Investigate each warning."}, {"owner": {"reputation": 1, "user_id": 7376088, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154797098768116/picture?type=large", "display_name": "Alp Oflas", "link": "https://stackoverflow.com/users/7376088/alp-oflas"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1491960266, "post_id": 43358650, "comment_id": 73780051, "body": "@DavidSchwartz like (do not use &quot;gets&quot;)"}, {"owner": {"reputation": 8555, "user_id": 1402846, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/z5AzI.png?s=128&g=1", "display_name": "Pang", "link": "https://stackoverflow.com/users/1402846/pang"}, "edited": false, "score": 1, "creation_date": 1491995130, "post_id": 43358650, "comment_id": 73797281, "body": "<code>int flag; flag = &quot;FALSE&quot;; while (flag=&quot;FALSE&quot;)</code> doesn&#39;t look right at all."}, {"owner": {"reputation": 1, "user_id": 7376088, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154797098768116/picture?type=large", "display_name": "Alp Oflas", "link": "https://stackoverflow.com/users/7376088/alp-oflas"}, "edited": false, "score": 0, "creation_date": 1491999820, "post_id": 43358650, "comment_id": 73800589, "body": "Hmm flag must be string right but still same error"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7376088, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154797098768116/picture?type=large", "display_name": "Alp Oflas", "link": "https://stackoverflow.com/users/7376088/alp-oflas"}, "is_accepted": false, "score": 0, "last_activity_date": 1492041765, "creation_date": 1492041765, "answer_id": 43381493, "question_id": 43358650, "link": "https://stackoverflow.com/questions/43358650/segmentation-fault-on-string-c/43381493#43381493", "title": "Segmentation Fault on String C", "body": "<p>Solved... Problem on <code>\"\\0\"</code> it must be <code>'\\0'</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7376088, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154797098768116/picture?type=large", "display_name": "Alp Oflas", "link": "https://stackoverflow.com/users/7376088/alp-oflas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1492041765, "creation_date": 1491959858, "last_edit_date": 1491992449, "question_id": 43358650, "link": "https://stackoverflow.com/questions/43358650/segmentation-fault-on-string-c", "title": "Segmentation Fault on String C", "body": "<p>I am trying to do code for getting student name, surname and ID then printing it wtih stabil format. Example: ( Enter name and surname: \"Alp David Oflas\" Enter ID: \"20110702037\" then output should be like \"OFLAS, Alp David, joined the Engineering in 2011 as 37st student.\") So I'm trying to do with this code that except ID part but on repl.it I'm gettin \"exited with non-zero status\" error and when I'm tryin on Ubuntu I'm gettin \"Segmentation fault (core dumped)\". So can not solve this problem till 4 hours. Can you help me which part of code cause that error?</p>\n\n<p>Note: I can not use any other function. I must do it with loops and comparison.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid output(char name[100],char ID[100]){\n\n    char surname[100];\n//Calculating name string's length//    \n    int nameL;\n    for(nameL=0;name[nameL]!=\"\\0\";nameL++);\n\n    int i=nameL;\n    int j=0;\n    int flag;\n    flag = \"FALSE\";\n//Geting surname from value with decreasing i. It could be something like \"Alp David Oflas\" so we need just surname//   \n    while (flag=\"FALSE\"){\n        if (name[i] == \" \"){\n            flag=\"TRUE\";\n        }\n        else{\n            surname[j] = name[i];\n            i--;\n            j++;\n            flag = \"FALSE\";\n        }\n    }\n    surname[j]=\"\\0\";\n//Previous surname just be like \"salfO\" so need to convert it// \n    char newsurname[100]; \n    int surnameL;\n    for(surnameL=0;surname[surnameL] !=\"\\0\";surnameL++);\n    int k=0;\n\n    while (surname[k] != \"\\0\"){\n        newsurname[k]=surname[surnameL];\n        k++;\n        surnameL--;\n    }\n    newsurname[k] = \"\\0\";\n\n//Just capitalizing surname for dependant output//  \n    int x=0;\n    while (newsurname[x] !=\"\\0\"){\n        if (newsurname[x] &gt;= \"a\" &amp;&amp; newsurname[x] &lt;= \"z\"){\n            newsurname[x] = (newsurname[x] -32);\n        }\n        x++;\n    }           \n\n    printf(\"%s\",newsurname);\n\n}\n\n//Geting values from keyboard//\nint main (){\n\n    char name[100];\n    char ID[100];\n    printf(\"Enter name and surname:\\n\");\n    gets (name);\n    printf(\"Enter ID:\\n\");\n    gets (ID);\n    output(name,ID);\n    return 0;\n}\n</code></pre>\n"}]