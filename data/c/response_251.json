[{"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572478524, "post_id": 58634957, "comment_id": 103576887, "body": "Aside: can you figure out why the program always outputs <code>1</code> for any non-0 value?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1572510330, "post_id": 58634988, "comment_id": 103584448, "body": "<code>integer % 2;</code> returns 0, 1 or -1."}, {"owner": {"reputation": 1, "user_id": 12152466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176bb9077eaa95121a2fa0ad7942e23b?s=128&d=identicon&r=PG&f=1", "display_name": "tz013", "link": "https://stackoverflow.com/users/12152466/tz013"}, "edited": false, "score": 0, "creation_date": 1572548482, "post_id": 58634988, "comment_id": 103604232, "body": "Thanks this helped"}], "tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": false, "score": 3, "last_activity_date": 1572481406, "last_edit_date": 1572481406, "creation_date": 1572478186, "answer_id": 58634988, "question_id": 58634957, "link": "https://stackoverflow.com/questions/58634957/how-to-convert-integer-to-binary-form-in-c/58634988#58634988", "title": "How to convert integer to binary form in C", "body": "<p>Welcome to Stack Overflow.</p>\n\n<p>The value <code>binary</code> is set during the <code>while</code> loop, but what happens if you actually enter a zero for the integer? In that case the loop doesn't run, and the value <code>binary</code> has no initialized value. Surprise!</p>\n\n<p>That's why it's complaining.</p>\n\n<p>However, the algorithm you're using, even if you enter a nonzero value, will only give <code>binary</code> the value of the lowest bit in the number you're converting, so you'll need different code to make it work to build up the binary value as you run through the integer.</p>\n\n<p>Basically what you're trying to do is turn a binary value in to a kind of decimal representation of binary, which has enough limitations that I'm not sure it's worth doing.</p>\n\n<p>Still:</p>\n\n<pre><code>long int binary = 0;\n\n   while (integer != 0)\n   {\n       binary += integer % 2;  // 1 or 0\n       binary *= 10;           // a \"binary\" decimal shift left\n       integer /= 2;\n   }\n   printf(\"Integer in binary is %ld\", binary);\n   return 0;\n}\n</code></pre>\n\n<p>This works, but it has a severe limitation of only being able to represent relatively small binary values.</p>\n\n<p>The most common way people solve this exercise is to convert the integer value to a <em>string</em> rather than an integer, for easy display.</p>\n\n<p>I wonder if that's the problem you're trying to solve?</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1572511897, "last_edit_date": 1572511897, "creation_date": 1572483603, "answer_id": 58635602, "question_id": 58634957, "link": "https://stackoverflow.com/questions/58634957/how-to-convert-integer-to-binary-form-in-c/58635602#58635602", "title": "How to convert integer to binary form in C", "body": "<p>An integer comprised of only <em>decimal</em> 1 and 0 digits is not <em>binary</em>.  An <code>int</code> on a computer is already binary; the <code>%d</code> format specifier creates a <em>character string representation</em> of that value in <em>decimal</em>.  It is mathematically nonsensical to generate a binary value that when represented as a decimal looks like some other binary value.  Not least because that approach is good for only a 10 bit value (on a 32 bit int), or 19 bits using a 64bit int.  </p>\n\n<p>Moreover, the solution requires further consideration (and more code) to handle negative integer values - although how you do that is ambiguous due to the limited number of bits you can represent. </p>\n\n<p>Since the <code>int</code> is already a binary value, it is far simpler to present the binary bit pattern directly than to calculate some decimal value that happens to resemble a binary value:</p>\n\n<pre><code>    // Skip leading zero bits\n    uint32_t mask = 0x80000000u ;\n    while( mask != 0 &amp;&amp; (integer &amp; mask) == 0 ) mask &gt;&gt;= 1 ;\n\n    // Output remaining significant digits \n    printf(\"The integer in binary is \");\n    while( mask != 0 )\n    {\n        putchar( (integer &amp; mask) == 0 ? '0' : '1' ) ;\n        mask &gt;&gt;= 1 ;\n    }\n    putchar( '\\n' ) ;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12152466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176bb9077eaa95121a2fa0ad7942e23b?s=128&d=identicon&r=PG&f=1", "display_name": "tz013", "link": "https://stackoverflow.com/users/12152466/tz013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "closed_date": 1572524175, "answer_count": 2, "score": -1, "last_activity_date": 1572511897, "creation_date": 1572477981, "last_edit_date": 1572478225, "question_id": 58634957, "link": "https://stackoverflow.com/questions/58634957/how-to-convert-integer-to-binary-form-in-c", "closed_reason": "Duplicate", "title": "How to convert integer to binary form in C", "body": "<p>I'm trying to convert a user entered integer to binary form, but I keep getting a warning that \"binary\" is not initialized in the last printf statement.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\nlong int integer, binary;\n\n    printf(\"Enter an integer: \\n\");\n    scanf(\"%ld\", &amp;integer);\n    while(integer != 0)\n    {\n        binary = integer % 2;\n        integer = integer / 2;\n    }\n    printf(\"The integer in binary is %ld\", binary);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 6, "creation_date": 1572477914, "post_id": 58634929, "comment_id": 103576743, "body": "Because the factorial calculation for 13! and more, overflows <code>int</code>, and 21! and more will overflow <code>long long int</code>."}, {"owner": {"reputation": 41, "user_id": 12229169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCtuOL-z1AW1JF__HlkVGeo5hvMxXR39-6YJxjz=k-s128", "display_name": "Tomiisme", "link": "https://stackoverflow.com/users/12229169/tomiisme"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572479540, "post_id": 58634929, "comment_id": 103577111, "body": "Ah yes, thank you a lot, I just made it long factorial and everything worked."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1572520691, "post_id": 58634929, "comment_id": 103589752, "body": "So please write an answer and mark it. This will help others with similar problems to find it."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 12229169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCtuOL-z1AW1JF__HlkVGeo5hvMxXR39-6YJxjz=k-s128", "display_name": "Tomiisme", "link": "https://stackoverflow.com/users/12229169/tomiisme"}, "is_accepted": false, "score": 1, "last_activity_date": 1572531761, "creation_date": 1572531761, "answer_id": 58645394, "question_id": 58634929, "link": "https://stackoverflow.com/questions/58634929/why-when-i-input-any-number-between-14-and-20-the-output-is-incorrect/58645394#58645394", "title": "why when I input any number between 14 and 20, the output is incorrect?", "body": "<p>The problem was in the declaration of the Factorial functions, as int type would overflow if the input is more than 13!, so we should declare the Factorial function as long, so that it does not overflow.</p>\n"}], "owner": {"reputation": 41, "user_id": 12229169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCtuOL-z1AW1JF__HlkVGeo5hvMxXR39-6YJxjz=k-s128", "display_name": "Tomiisme", "link": "https://stackoverflow.com/users/12229169/tomiisme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572531761, "creation_date": 1572477735, "question_id": 58634929, "link": "https://stackoverflow.com/questions/58634929/why-when-i-input-any-number-between-14-and-20-the-output-is-incorrect", "title": "why when I input any number between 14 and 20, the output is incorrect?", "body": "<p>'I need to calculate and print an upside down pascal triangle, so I wrote down 2 functions for factorial and for the nCr, and I have followed, the equation x! / (y! * (x - y)!)'</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint Factorial (int value)\n{\nif (value == 1 || value == 0)\n{\n    return 1;\n}\n\nreturn value*Factorial(value - 1);\n}\nint nCr(int value, int r)\n{\nreturn Factorial(value)/(Factorial(r) * Factorial(value - r));\n}\n\nint main(int argc, char **argv)\n{\nint value, i, j, k;\nchar* p;\nvalue = strtol(argv[1], &amp;p, 10);\nif (*p != '\\0')\n{\n    return 1;\n}\nif (argc != 2)\n{\n    return 1;\n}\nif (value &lt; 1 || value &gt; 20)\n{\n    printf(\"Error: Please enter a value between 1 and 20 inclusively\\n\");\n    return 1;\n}\nelse\n</code></pre>\n\n<p>'The problem is supposed to be in the nested loops I guess'</p>\n\n<pre><code> {\n for (i = value - 1; i &gt;= 0; i--)\n {\n    for (j = value - i; j &gt; 0; j--)\n    {\n        printf(\" \");\n    }\n    for (k = 0; k &lt;= i; k++)\n    {\n        printf(\"%d \", nCr(i, k));\n    }\n    printf(\"\\n\");\n}\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "stack", "reverse"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 1171987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21daf662836b4c8f91ab329024bb254d?s=128&d=identicon&r=PG", "display_name": "user4252523", "link": "https://stackoverflow.com/users/1171987/user4252523"}, "edited": false, "score": 0, "creation_date": 1572482191, "post_id": 58635038, "comment_id": 103577661, "body": "Thank you so much. I had a feeling NULL termination might have been causing the issue, but never thought too much of it."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1572478575, "creation_date": 1572478575, "answer_id": 58635038, "question_id": 58634887, "link": "https://stackoverflow.com/questions/58634887/unable-to-reverse-a-simple-string-using-stacks-pop-function/58635038#58635038", "title": "Unable to reverse a simple string using Stack&#39;s Pop() function", "body": "<p>The last thing you pushed onto the stack was the null terminator of the string. So the first thing you popped was this null terminator. When you assigned <code>str[i] = Pop(&amp;head);</code>, you made the first character the null terminator. As a result, <code>strlen(str)</code> is now <code>0</code>, and the loop stops on the next iteration because <code>1 &lt;= 0</code> is not true.</p>\n\n<p>You shouldn't push the null terminator onto the stack. The first loop should use <code>i &lt; strlen(str)</code> rather than <code>i &lt;= strlen(str)</code> (a more efficient way would be <code>str[i] != 0</code>).</p>\n\n<p>And when popping, you shouldn't use <code>strlen()</code> of the resulting string, since you don't know yet how long it will be. You should call <code>Pop(&amp;head)</code> until it returns <code>'\\0'</code>, which indicates that you've emptied the stack.</p>\n\n<pre><code>int main()\n{\n    Node *head = NULL;\n\n    char str[] = \"helloworld\";\n    printf(\"Original String is:%s\\n\", str);\n    printf(\"Length is:%lu\\n\", strlen(str));\n\n    for (int i = 0; str[i] != 0; i++)\n    {\n        Push(&amp;head, str[i]);\n    }\n\n    printf (\"String has been pushed to the stack.\\n\");\n    PrintAll(head);\n    printf(\"\\nString has been printed. Now popping:%ld.\\n\", strlen(str));\n\n    for (int i = 0; str[i] = Pop(&amp;head); i++)\n    {\n        printf(\"%c, \", str[i]); //Pop() is returning the value from a global variable 'ret'\n    }\n    printf(\"\\n\");\n    printf (\"String has been popped from the stack.\\n\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 1171987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/21daf662836b4c8f91ab329024bb254d?s=128&d=identicon&r=PG", "display_name": "user4252523", "link": "https://stackoverflow.com/users/1171987/user4252523"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58635038, "answer_count": 1, "score": 0, "last_activity_date": 1572478575, "creation_date": 1572477430, "question_id": 58634887, "link": "https://stackoverflow.com/questions/58634887/unable-to-reverse-a-simple-string-using-stacks-pop-function", "title": "Unable to reverse a simple string using Stack&#39;s Pop() function", "body": "<p>I have a simple stack program which is trying to reverse a string. I am able to 'display' the reversed string, but when it comes to storing the character returned by the Pop() function, I am failing to do so. What I am doing below is that in the <code>main()</code> after I have pushed the string to the stack, I try to use re-use <code>str[]</code> to store the reversed string. Since it is an array, I should be able to modify it. However, when I do so, for some strange reason the for-loop runs only ONE time. I am guessing it is doing so because in <code>pop()</code> <code>*head = NULL</code> in second iteration and hence it fails.</p>\n\n<p>I am failing to run the for-loop for more than once. My questions is\nwhat is preventing me from storing the reversed string?</p>\n\n<p>1) Why is the for-loop running only one time when I use str[i]?</p>\n\n<p>2) Am I using str[i] in some strange way which is causing this to happen?</p>\n\n<pre><code>char ret = '\\0';\nvoid Push(Node **head, char data)\n{\n    Node *temp = (Node*)malloc(sizeof(Node));\n    temp-&gt;data = data;\n    temp-&gt;next = NULL;\n    if (*head == NULL)\n    {\n        *head = temp;\n        return;\n    }\n\n    temp-&gt;next = *head;\n    *head = temp;\n    return;\n}\n\nvoid PrintAll(Node *temp)\n{\n    if(temp == NULL) return;\n    printf(\"%c, \", temp-&gt;data);\n    PrintAll(temp-&gt;next);\n}\nchar Pop(Node **head)\n{\n    if(*head == NULL)  \n    {\n        return '\\0';\n    }\n    Node *temp = *head;\n    ret = temp-&gt;data;\n    *head = (*head)-&gt;next;\n    free (temp);\n    return ret;\n}\n\nint main()\n{\n    Node *head = NULL;\n\n    char str[] = \"helloworld\";\n    printf(\"Original String is:%s\\n\", str);\n    printf(\"Length is:%lu\\n\", strlen(str));\n\n    for (int i = 0; i &lt;=strlen(str); i++)\n    {\n        Push(&amp;head, str[i]);\n    }\n\n    printf (\"String has been pushed to the stack.\\n\");\n    PrintAll(head);\n    printf(\"\\nString has been printed. Now popping:%ld.\\n\", strlen(str));\n\n\n    //Problem starts here in this for-loop\n    for (int i = 0; i &lt;=strlen(str); i++)\n    {\n        str[i] = Pop(&amp;head); //When these next lines are enabled, the for-loop runs only once!\n        printf(\"%c, \", str[i]); //Pop() is returning the value from a global variable 'ret'\n        //printf(\"%c \", Pop(&amp;head)); //if two previous lines are disabled, string is displayed in reverse\n\n    }\n    printf(\"\\n\");\n    printf (\"String has been popped from the stack.\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1572477401, "post_id": 58634850, "comment_id": 103576618, "body": "<code>fgets</code> preserves all the characters that were in the file. So each line read into a string still ends in newline <code>\\n</code> and any tab <code>\\t</code> found remains there too."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1572477483, "post_id": 58634850, "comment_id": 103576636, "body": "So your file actually contains literal backslashes, and you want to translate those escape sequences into the corresponding characters?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1572477602, "post_id": 58634850, "comment_id": 103576661, "body": "You need to search for the backslashes, then get the next character after it. You can then use a <code>switch()</code> statement to output the appropriate translation."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572477639, "post_id": 58634850, "comment_id": 103576675, "body": "You can use <code>strchr()</code> to search for the backslashes."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572576199, "post_id": 58636195, "comment_id": 103611518, "body": "If <code>line == &quot;\\\\tx&quot;</code>, this result in <code>&quot;\\t\\n&quot;</code>.   <code>x</code> is lost."}], "tags": [], "owner": {"reputation": 2937, "user_id": 9041075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80dbc57d22544ef4eb8bc06d64ecbb3f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/9041075/dan-m"}, "is_accepted": false, "score": -1, "last_activity_date": 1572489249, "creation_date": 1572489249, "answer_id": 58636195, "question_id": 58634850, "link": "https://stackoverflow.com/questions/58634850/how-to-read-special-characters-from-a-text-file/58636195#58636195", "title": "How to read special characters from a text file?", "body": "<p>Call this function:</p>\n\n<pre><code>void cleanUp(char * line) {\n    int x;\n    int y = 0;\n    for (x = 0; x &lt; strlen(line) - 1; x++) {\n        if (line[x] == '\\\\') {\n            if (line[x + 1] == 'n') {\n                line[y++] = '\\n';\n                x = x + 2; /* if there is always a space after the \\n otherwise x++ */\n                continue;\n            }\n            if (line[x + 1] == 't') {\n                line[y++] = '\\t';\n                x = x + 2; /* if there is always a space after the \\t otherwise x++ */\n                continue;\n            }\n        }\n        line[y++] = line[x];\n    }\n    line[y++] = '\\n';\n    line[y] = '\\0';\n}\n</code></pre>\n\n<p>before printing <em>line</em>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12300224, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mArrMh_Ly6yzgAUX8uMtvxW-lni3SIY-AqyrpFF=k-s128", "display_name": "Eduardo Franco", "link": "https://stackoverflow.com/users/12300224/eduardo-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572489249, "creation_date": 1572477185, "last_edit_date": 1572477425, "question_id": 58634850, "link": "https://stackoverflow.com/questions/58634850/how-to-read-special-characters-from-a-text-file", "title": "How to read special characters from a text file?", "body": "<p>I have a text file with some special characters (<code>\\n</code>, <code>\\t</code>, etc). The question is: is there anyway to print a new line or a tab instead just printing the string <code>\\n</code> or <code>\\t</code>? </p>\n\n<pre><code>int main(){\n\n    char line[10];\n\n    FILE*file= fopen(\"file.txt\", \"r\"); // txt content =&gt; \"line 1 \\n line 2 \\n line 3\"\n    if (file != NULL){\n        while (fgets(line, 10, file) != NULL)\n            printf(\"%s\", line);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1572477023, "post_id": 58634784, "comment_id": 103576523, "body": "It means the same as <code>p[8]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 195828, "user_id": 112968, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zHTaT.png?s=128&g=1", "display_name": "knittl", "link": "https://stackoverflow.com/users/112968/knittl"}, "is_accepted": true, "score": 3, "last_activity_date": 1572477225, "creation_date": 1572477225, "answer_id": 58634857, "question_id": 58634784, "link": "https://stackoverflow.com/questions/58634784/pointer-inside-a-square-bracket/58634857#58634857", "title": "Pointer inside a square bracket?", "body": "<p><code>a[x]</code> is shorthand for <code>*(a + x)</code>. Consequently, <code>a[x]</code> is equivalent to the expression <code>x[a]</code>. (same holds for <code>8[p]</code> and <code>p[8]</code> of course ;))</p>\n"}], "owner": {"reputation": 151, "user_id": 8752013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3c5d349214693407a5617577ee9f25?s=128&d=identicon&r=PG&f=1", "display_name": "So Lo", "link": "https://stackoverflow.com/users/8752013/so-lo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1572477537, "accepted_answer_id": 58634857, "answer_count": 1, "score": 2, "last_activity_date": 1572477989, "creation_date": 1572476659, "last_edit_date": 1572477989, "question_id": 58634784, "link": "https://stackoverflow.com/questions/58634784/pointer-inside-a-square-bracket", "closed_reason": "Duplicate", "title": "Pointer inside a square bracket?", "body": "<p>Consider the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void){\n    char *p=\"A for Apple\";\n    char q[15]=\"B for Ball\";\n    printf(\"x=%c y=%c\\n\",*(p+10)-2,*(&amp;q[4]-2)); \n    printf(\"u=%c v=%c w=%d\\n\",p[8],*q+8,8[p]-q[8]);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>x=c y=f  \nu=p v=J\nw=4\n</code></pre>\n\n<p>Problem, I am having here is determining how <code>w=4</code> was evaluated.</p>\n\n<p>What does <code>8[p]</code> means?</p>\n"}, {"tags": ["c", "fork", "parent-child", "child-process"], "comments": [{"owner": {"reputation": 527, "user_id": 9023747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0524f097a16dc362733b3f590063c503?s=128&d=identicon&r=PG&f=1", "display_name": "sctts-lol", "link": "https://stackoverflow.com/users/9023747/sctts-lol"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1572476665, "post_id": 58634759, "comment_id": 103576435, "body": "I did, but the results are different everytime"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 12279616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d0389818c5f6b55680075fbefcd913?s=128&d=identicon&r=PG&f=1", "display_name": "Linus Gudmundsson", "link": "https://stackoverflow.com/users/12279616/linus-gudmundsson"}, "is_accepted": true, "score": 1, "last_activity_date": 1572476966, "creation_date": 1572476966, "answer_id": 58634830, "question_id": 58634759, "link": "https://stackoverflow.com/questions/58634759/how-many-child-processes-are-created-when-executing-this-program/58634830#58634830", "title": "How many child processes are created when executing this program?", "body": "<p>if fork() is successful it returns 0 to the child and the process id to the parent. So for the parent, pid != 0 and for the children it is.\nAfter the first if, before the </p>\n\n<pre><code>pid = fork()\n</code></pre>\n\n<p>line. There is 3 processes. These 3 processes then create one new child each, which then in turn creates another child.Finally all processes spawn one child. This gives us (3 + 3  + 3) * 2 = 18 processes if none of the fork() fails.</p>\n"}], "owner": {"reputation": 527, "user_id": 9023747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0524f097a16dc362733b3f590063c503?s=128&d=identicon&r=PG&f=1", "display_name": "sctts-lol", "link": "https://stackoverflow.com/users/9023747/sctts-lol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 58634830, "answer_count": 1, "score": -1, "last_activity_date": 1572476966, "creation_date": 1572476412, "question_id": 58634759, "link": "https://stackoverflow.com/questions/58634759/how-many-child-processes-are-created-when-executing-this-program", "title": "How many child processes are created when executing this program?", "body": "<p>I am stuck on the line of code <code>pid = fork();</code>, I understand prior to that there are 2 child process created, but would some please clarify once it reaches to the line <code>pid=fork();</code>, does the previous child being wiped and pid will start forking from 0 again or does it just keep forking with the 2 child ?</p>\n\n<pre><code>void main() {\nint pid = fork();\nif(pid != 0)\n    fork();\npid = fork();\nif(pid == 0)\n    fork();\nfork();\nexit(0);\n }\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1572476628, "post_id": 58634744, "comment_id": 103576423, "body": "Look at the placement of the &quot;return 1&quot; statement."}, {"owner": {"reputation": 113, "user_id": 9245729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e64d86fb3fead9471008ee8dc742877?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Ilie", "link": "https://stackoverflow.com/users/9245729/daniel-ilie"}, "reply_to_user": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1572476738, "post_id": 58634744, "comment_id": 103576454, "body": "@FredK Where should it be?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1572477621, "post_id": 58634744, "comment_id": 103576669, "body": "<code>for(int count2; count2 &lt;= length; count2++)</code> is broken, because you don&#39;t initialize <code>count2</code> with any value"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572477854, "post_id": 58634744, "comment_id": 103576727, "body": "@DanielIlie Outside the <code>for</code> loop."}, {"owner": {"reputation": 427, "user_id": 9988199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWaFH.jpg?s=128&g=1", "display_name": "H4ze", "link": "https://stackoverflow.com/users/9988199/h4ze"}, "edited": false, "score": 0, "creation_date": 1572478099, "post_id": 58634744, "comment_id": 103576787, "body": "@DanielIlie You are returning 1 inside the <code>for</code> loop. Also, I find this code very unreadable."}, {"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1572480043, "post_id": 58634744, "comment_id": 103577202, "body": "You aren&#39;t initializing <code>count</code> to 0, which breaks your string copy (you can use <code>strcpy</code> or <code>strncpy</code>).  You also reverse the string passed to the function, which the caller might not expect."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1572610773, "post_id": 58634744, "comment_id": 103621315, "body": "@Daniel Ilie You selected an answer with a very bad code. See the code presented in my answer. It uses only pointers and correctly declares the function."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 12279616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d0389818c5f6b55680075fbefcd913?s=128&d=identicon&r=PG&f=1", "display_name": "Linus Gudmundsson", "link": "https://stackoverflow.com/users/12279616/linus-gudmundsson"}, "is_accepted": false, "score": 0, "last_activity_date": 1572478481, "last_edit_date": 1572478481, "creation_date": 1572477368, "answer_id": 58634879, "question_id": 58634744, "link": "https://stackoverflow.com/questions/58634744/palindrome-function-not-returning-value-in-c/58634879#58634879", "title": "Palindrome function, not returning value in C", "body": "<p>To check if a string is a palindrome you create a reversed string, after first allocating enough room for all chars, by looping through the original one and changing the order. you can then use a strcmp to check if the reversed and original string are the same.</p>\n\n<pre><code>int isPalindrome (char * str)\n{\n  int length = strlen(str); \n  char* reversed = malloc(sizeof(char)*length); //we allocate enough space for length chars\n\n  for(int i = 0; i &lt; length; i++) {\n    reversed[i] = str[length-1-i]; //populate reversed with the chars in str but in the reversed order\n  }\n\n  if(strcmp(str,reversed) == 0) //strcmo(a,b) return 0 if they are equal\n  {\n    free(reversed); //deallocate the space for reversed\n    return 1;\n  }\n  free(reversed); //deallocate the space for reversed\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1572482679, "post_id": 58635120, "comment_id": 103577768, "body": "<code>Please note that older C versions require you to declare all variables in the beginning of a function block as far as I remember. So this is anyways wrong.</code>  This restriction was removed in C99, which most software written in C adheres to.  You generally shouldn&#39;t write to older standards unless you have a specific reason."}, {"owner": {"reputation": 331, "user_id": 1591869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2084d1618962f1ab8b711b3e1a1d341a?s=128&d=identicon&r=PG", "display_name": "AmN", "link": "https://stackoverflow.com/users/1591869/amn"}, "reply_to_user": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "edited": false, "score": 0, "creation_date": 1572483070, "post_id": 58635120, "comment_id": 103577852, "body": "Thank you for that. I just remembered coding something back in Turbo C (Yeah) and it had given me this error."}], "tags": [], "owner": {"reputation": 331, "user_id": 1591869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2084d1618962f1ab8b711b3e1a1d341a?s=128&d=identicon&r=PG", "display_name": "AmN", "link": "https://stackoverflow.com/users/1591869/amn"}, "is_accepted": true, "score": -1, "last_activity_date": 1572479262, "creation_date": 1572479262, "answer_id": 58635120, "question_id": 58634744, "link": "https://stackoverflow.com/questions/58634744/palindrome-function-not-returning-value-in-c/58635120#58635120", "title": "Palindrome function, not returning value in C", "body": "<p>Your program has multiple problems. Lets see them one by one:</p>\n\n<pre><code>for(int count; count &lt;= length; count++ ){\n            ^^^^\n    def[count] = str[count];\n}\n</code></pre>\n\n<p>You are not initialising count, you are just declaring it. Without any initial value count will just be some garbage. To fix this:</p>\n\n<pre><code>for(int count = 0; count &lt;= length; count++ ){\n    def[count] = str[count];\n}\n</code></pre>\n\n<p><strong><em>Please note that older C versions require you to declare all variables in the beginning of a function block as far as I remember. So this is anyways wrong.</em></strong></p>\n\n<p>Next, your palindrome logic is incorrect. You are just swapping characters between begin and end. </p>\n\n<p>All you have to do is check while iterating HALF THE STRING is whether the characters from the beginning equal to the end.</p>\n\n<pre><code>for (c = 0; c &lt; length/2; c++)\n{\n    // Check if \"begin\" equals to the current \"end\"\n    if (*begin != *end) \n    {\n        return 0;\n    }\n\n    // Move \"begin\" forward and \"end\" backwards\n    begin++;\n    end--;\n}\n</code></pre>\n\n<p>Here is your complete function in working condition:</p>\n\n<pre><code>int isPalindrome(char* str)\n{\n    int length = strlen(str);\n\n    int c;\n    char *begin, *end;\n\n    begin = str;\n\n    // Why use the below for loop when you can directly move end to the end?\n    end = str + length - 1;\n\n    // for (c = 0; c &lt; length - 1; c++)\n    //    end++;\n\n    for (c = 0; c &lt; length / 2; c++) {\n        if (*begin != *end) {\n            return 0;\n        }\n\n        begin++;\n        end--;\n    }\n    return 1;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1572597383, "last_edit_date": 1572597383, "creation_date": 1572514136, "answer_id": 58640260, "question_id": 58634744, "link": "https://stackoverflow.com/questions/58634744/palindrome-function-not-returning-value-in-c/58640260#58640260", "title": "Palindrome function, not returning value in C", "body": "<p>In these loops</p>\n\n<pre><code>for(int count; count &lt;= length; count++ ){\n    def[count] = str[count];\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>for(int count2; count2 &lt;= length; count2++){\n    if(str[count2] != def[count2]){\n        return 0;\n    }\n    return 1;\n}\n</code></pre>\n\n<p>there are used uninitialized variables <code>count</code> and <code>count2</code>. So the function has undefined behavior.</p>\n\n<p>Pay attention the the function is declared and defined incorrectly. It is too complicated and uses a magic number <code>SIZE</code>.</p>\n\n<p>Also you should use the type <code>size_t</code> instead of the type int because the return type of the function <code>strlen</code> is <code>size_t</code> and in general an object of the type <code>int</code> can not accommodate an object of the type <code>size_t</code>.</p>\n\n<p>There is no need to create an auxiliary array and change the original string to check whether the given string is a palindrome. Moreover the parameter shall be defined with the qualifier <code>const</code>. Otherwise you will be unable to check whether a string literal is a palindrome because modifying a string literal invokes undefined behavior.</p>\n\n<p>Also if you are trying to use pointers then there is no need to use also indices in loops.</p>\n\n<p>The function can be defined much simpler.</p>\n\n<p>Here you are.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n_Bool isPalindrome( const char *s )\n{\n    const char *first = s, *last = s + strlen( s );\n\n    if ( first != last )\n    {\n        while ( first &lt; --last &amp;&amp; *first == *last ) ++first;\n    }\n\n    return !( first &lt; last );\n}\n\nint main(void) \n{\n    char *s1 = \"121\";\n\n    printf ( \"\\\"%s\\\" is %s%s\\n\", s1, isPalindrome( s1 ) ? \"a \" : \"not \", \"palindrome.\" );\n\n    char *s2 = \"1221\";\n\n    printf ( \"\\\"%s\\\" is %s%s\\n\", s2, isPalindrome( s2 ) ? \"a \" : \"not \", \"palindrome.\" );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>\"121\" is a palindrome.\n\"1221\" is a palindrome.\n</code></pre>\n\n<p>As you can see the function uses only pointers and neither index.</p>\n"}], "owner": {"reputation": 113, "user_id": 9245729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e64d86fb3fead9471008ee8dc742877?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Ilie", "link": "https://stackoverflow.com/users/9245729/daniel-ilie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 58635120, "answer_count": 3, "score": -1, "last_activity_date": 1572597383, "creation_date": 1572476320, "last_edit_date": 1572477829, "question_id": 58634744, "link": "https://stackoverflow.com/questions/58634744/palindrome-function-not-returning-value-in-c", "title": "Palindrome function, not returning value in C", "body": "<p>When I run this function I don't get a return value of 1 or 0. Im not sure why, I'm new to pointers and any type of help/tips would be greatly appreciated.</p>\n\n<pre><code>int isPalindrome (char * str)\n{\n    char def[SIZE];\n    int length = strlen(str);\n    for(int count; count &lt;= length; count++ ){\n        def[count] = str[count];\n    }\n\n    int c;\n    char *begin, *end, temp;\n\n    begin  = str;\n    end    = str;\n\n    for (c = 0; c &lt; length - 1; c++)\n        end++;\n\n    for (c = 0; c &lt; length/2; c++)\n    {        \n        temp   = *end;\n        *end   = *begin;\n        *begin = temp;\n\n        begin++;\n        end--;\n    }\n\n    for(int count2; count2 &lt;= length; count2++){\n        if(str[count2] != def[count2]){\n            return 0;\n        }\n        return 1;\n    }\n}\n</code></pre>\n\n<p>The function is called with..</p>\n\n<pre><code> if(isPalindrome(arr) == 1) \n     printf (\"\\nIs a palindrome.\\n\\n\");\n</code></pre>\n"}, {"tags": ["c", "pointers", "constants", "declaration"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1572476206, "post_id": 58634707, "comment_id": 103576314, "body": "Does <a href=\"https://stackoverflow.com/questions/5781222/duplicate-const-qualifier-allowed-in-c-but-not-in-c\" title=\"duplicate const qualifier allowed in c but not in c\">stackoverflow.com/questions/5781222/&hellip;</a> answer your question? I guess you could consider it a bug with cdecl, but nobody should be writing code like that anyway\u2026"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1572476393, "post_id": 58634707, "comment_id": 103576369, "body": "@Ry- No it does not. It only says that it is valid. And it does not seem to be a bug either."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1572476457, "post_id": 58634707, "comment_id": 103576387, "body": "Well, okay, I\u2019ll be specific: it means nothing."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1572476614, "post_id": 58634707, "comment_id": 103576418, "body": "And it doesn\u2019t \u201conly say that it is valid\u201d, the meaning is right there in the quote: \u201c\u2026 the behavior is the same as if it appeared only once\u201d."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1572477068, "post_id": 58634707, "comment_id": 103576537, "body": "@Ry- I cannot find that quote"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1572477137, "post_id": 58634707, "comment_id": 103576558, "body": "It\u2019s between \u201cC99 &#167;6.7.3/4\u201d and \u201cYes, that is valid C99, and your discovery is correct.\u201d (If you have a browser with a \u201cFind\u201d function, the previously quoted bit should also be findable.) Also, \u201cThe mistake many make is to believe that it prevents you from doing stuff like <code>*p=5</code>, but what it really does is to prevent you from doing <code>p=&amp;x</code>, which is making it point to another object\u201d is incorrect \u2013 <code>const int *p</code> means exactly that <code>*p = 5</code> isn\u2019t valid and <code>p = &amp;x</code> can be. You\u2019re thinking of <code>int* const p</code>."}], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1572476627, "answer_count": 0, "score": 2, "last_activity_date": 1572476883, "creation_date": 1572476061, "last_edit_date": 1572476883, "question_id": 58634707, "link": "https://stackoverflow.com/questions/58634707/does-multiple-const-mean-something", "closed_reason": "Duplicate", "title": "Does multiple `const` mean something?", "body": "<p>I realised that you can declare a variable like this:</p>\n\n<pre><code>const const const const int i;\n</code></pre>\n\n<p>I know the basics (but admittedly, I do a lot of mistakes with const poinsters) which is that <code>int *p</code> means that <code>p</code> is simply a <code>pointer to int</code>, or in C <code>(int*)</code>. I also know that <code>const int *p</code> means a <code>constant pointer to int</code>. The mistake many make is to believe that it prevents you from doing stuff like <code>*p=5</code>, but what it really does is to prevent you from doing <code>p=&amp;x</code>, which is making it point to another object. After that I did some experiments with the help of <a href=\"https://cdecl.org/\" rel=\"nofollow noreferrer\">https://cdecl.org/</a> and here is what I found</p>\n\n<pre><code>const int p                       : const int\nint const p                       : const int (same as above)\nconst int *p                      : pointer to const int\nint const *p                      : pointer to const int\nint *const p                      : const pointer to int\nconst *int p                      : syntax error\nconst int *const p                : const pointer to const int\n</code></pre>\n\n<p>Nothing weird yet, but wait for it:</p>\n\n<pre><code>const int const *p                : pointer to const const int \nint const *const *p               : const pointer to const int\nint const *const const const p    : const const const pointer to const int\nconst const int const const p     : const const const const int\n</code></pre>\n\n<p>Surely, it must a bug with <a href=\"https://cdecl.org/\" rel=\"nofollow noreferrer\">https://cdecl.org/</a> ? Let's try to compile something.</p>\n\n<pre><code>$ cat foo.c \n#include &lt;stdio.h&gt;\n\nvoid foo(int const const *const *i)\n{\n    printf(\"%d\\n\", *i);\n//    *i=5;\n}\n\nint main(void)\n{\n    const const const const int i;\n    int const const const const *p = &amp;i;\n    int const const const *const *x = &amp;i;\n    int const const *const const *y =p;\n    foo(&amp;i);\n    foo(p);\n    foo(x);\n    foo(y);\n}\n\n$ gcc foo.c \nfoo.c: In function \u2018main\u2019:\nfoo.c:13:39: warning: initialization of \u2018const int * const*\u2019 from incompatible pointer type \u2018const int *\u2019 [-Wincompatible-pointer-types]\n   13 |     int const const const *const *x = &amp;i;\n      |                                       ^\nfoo.c:14:38: warning: initialization of \u2018const int * const*\u2019 from incompatible pointer type \u2018const int *\u2019 [-Wincompatible-pointer-types]\n   14 |     int const const *const const *y =p;\n      |                                      ^\nfoo.c:15:9: warning: passing argument 1 of \u2018foo\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n   15 |     foo(&amp;i);\n      |         ^~\n      |         |\n      |         const int *\nfoo.c:3:34: note: expected \u2018const int * const*\u2019 but argument is of type \u2018const int *\u2019\n    3 | void foo(int const const *const *i)\n      |          ~~~~~~~~~~~~~~~~~~~~~~~~^\nfoo.c:16:9: warning: passing argument 1 of \u2018foo\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n   16 |     foo(p);\n      |         ^\n      |         |\n      |         const int *\nfoo.c:3:34: note: expected \u2018const int * const*\u2019 but argument is of type \u2018const int *\u2019\n    3 | void foo(int const const *const *i)\n      |          ~~~~~~~~~~~~~~~~~~~~~~~~^\n</code></pre>\n\n<p>So, my specific obeying-the-on-topic-criteria question is, does it mean anything to have several <code>const</code> in a variable? Is there any difference between a <code>const const int</code> and <code>const int</code>? Does it matter if it is a pointer or not? My less-specific question is wtf is going on here?</p>\n"}, {"tags": ["c", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1572475648, "post_id": 58634611, "comment_id": 103576159, "body": "Why on earth are you using flex to parse XML??"}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1572476445, "post_id": 58634611, "comment_id": 103576382, "body": "Have you tried debugging it? Which line is it crashing on and why?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12300560, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/29cfc28aa68f92bab23ce0b0c6da801a?s=128&d=identicon&r=PG", "display_name": "presto668", "link": "https://stackoverflow.com/users/12300560/presto668"}, "is_accepted": false, "score": 0, "last_activity_date": 1572484547, "creation_date": 1572484547, "answer_id": 58635689, "question_id": 58634611, "link": "https://stackoverflow.com/questions/58634611/segmentation-fault-while-implementing-a-c-program-for-sorting/58635689#58635689", "title": "Segmentation Fault while implementing a C program for sorting", "body": "<p>You're calling </p>\n\n<blockquote>\n  <p>use = InsertUsageWord(use, word);</p>\n</blockquote>\n\n<p>but you never initialized word to anything</p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 7255243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e768f1646526a56ca7601a3aac9168ff?s=128&d=identicon&r=PG&f=1", "display_name": "mghh", "link": "https://stackoverflow.com/users/7255243/mghh"}, "is_accepted": true, "score": 0, "last_activity_date": 1572546351, "creation_date": 1572546351, "answer_id": 58649315, "question_id": 58634611, "link": "https://stackoverflow.com/questions/58634611/segmentation-fault-while-implementing-a-c-program-for-sorting/58649315#58649315", "title": "Segmentation Fault while implementing a C program for sorting", "body": "<p>You are calling <code>InsertUsageWord(use, word);</code>with <code>word</code> which is not initialized. Did you wanted to call it with <code>utilizacao</code> instead, by any chance? As it has just been initialized with a <code>malloc()</code> through <code>strdup()</code>!</p>\n"}], "owner": {"reputation": 7, "user_id": 7106548, "user_type": "registered", "profile_image": "https://graph.facebook.com/1131091593673316/picture?type=large", "display_name": "Henrique Guimar&#227;es", "link": "https://stackoverflow.com/users/7106548/henrique-guimar%c3%a3es"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58649315, "answer_count": 2, "score": 0, "last_activity_date": 1572546351, "creation_date": 1572475443, "last_edit_date": 1572515846, "question_id": 58634611, "link": "https://stackoverflow.com/questions/58634611/segmentation-fault-while-implementing-a-c-program-for-sorting", "title": "Segmentation Fault while implementing a C program for sorting", "body": "<p>I'm developing a program to sort an XML file that contains an open dictionary. I'm trying to do this using flex to recognize words, tags and etc and linked lists in C to sort them. By now I have a linked list to sort every word alphabetically and I tried to do the same to sort those words inside the usage that each word corresponds. I'm having the segmentation problem, probably because the list is getting a NULL I think from the <code>InsertUsageWord()</code> function, where did I go wrong?\nThanks in advance.</p>\n\n<p>C code</p>\n\n<pre><code>typedef struct _dicio {\n        char *usg, *orth, *def; //uso, palavra e definicao\n        struct _dicio *next;\n} dicio;\n\ntypedef struct _usage {\n    char *word;\n    struct _usage *unext;\n} usage;\n\nusage* InsertUsageWord(usage* ulista, char *palavra) {\n    usage *unode = (usage*)malloc(sizeof(usage));\n    unode-&gt;word = strdup(palavra);\n    unode-&gt;unext = ulista;\n    return unode;\n}\n\ndicio* InsertWord(dicio* lista, char *utilizacao, char *ortografia, char *definicao) {\n        dicio *node = (dicio*)malloc(sizeof(dicio));\n        node-&gt;usg = strdup(utilizacao);\n        node-&gt;orth = strdup(ortografia);\n        node-&gt;def = strdup(definicao);\n        node-&gt;next = lista;\n        return node;\n}\n\nvoid ListWord(usage* ulista, dicio* lista) {\n        if(ulista == NULL) return;\n        printf(\"%s\", ulista-&gt;word);\n    List(lista, ulista-&gt;word);\n    ListWord(ulista-&gt;unext, lista);\n}\n\nvoid List(dicio* lista, char* usg) {\n        if(lista == NULL) return;\n        if (strcmp(usg, lista-&gt;usg) == 0 ) {printf(\"%s\", lista-&gt;usg);}\n    List(lista-&gt;next, usg);\n}\n\n</code></pre>\n\n<p>Flex code</p>\n\n<pre><code>        #include \"dictp16.c\"\n        char *word;\n        char *palavra;\n        char *utilizacao;\n        char *definicao;\n        dicio *dicionario = NULL;\n        usage *use = NULL;\n\nLETRAS [a-zA-Z\u00c1\u00c9\u00cd\u00d3\u00da\u00c0\u00cc\u00fc\u00e7\u00c7\u00e3\u00e1\u00ed\u00e9\u00f3\u00fa\u00e0\u00e2\u00f4\u00ea\u00f5. -;,()_]+\n\n%x ORT USG DEF\n%%\n\\&lt;orth\\&gt;                                { BEGIN(ORT); }\n&lt;ORT&gt;{LETRAS}                               { palavra = strdup(yytext); }\n&lt;ORT&gt;\\&lt;\\/orth\\&gt;                             { BEGIN(INITIAL); }\n\n\\&lt;usg\\ type=\\\"[a-z]+\\\"\\&gt;                        { BEGIN(USG); }\n&lt;USG&gt;{LETRAS}                               { utilizacao = strdup(yytext); }\n&lt;USG&gt;\\&lt;\\/usg\\&gt;                              { use = InsertUsageWord(use, word);\n                                         BEGIN(INITIAL); }\n\n\\&lt;def\\&gt;                                 { BEGIN(DEF); }\n&lt;DEF&gt;{LETRAS}                               { definicao = strdup(yytext); }\n&lt;DEF&gt;\\n                                 {;}\n&lt;DEF&gt;.                                  {;}\n&lt;DEF&gt;\\&lt;\\/def\\&gt;                              { dicionario = InsertWord(dicionario, utilizacao, palavra, definicao);  \n                                              BEGIN(INITIAL); }\n\\n                                  {}   \n&lt;&lt;EOF&gt;&gt;                                 { ListWord(use, dicionario);  return 0; }\n.                                   {;}\n%%\n</code></pre>\n\n<p>Expected output would be something like this:</p>\n\n<pre><code>ant:\n- Alampi~ao: O mesmo que _lampi~ao_. Cf. B. Pereira, _Pros\u00b4odia_, vb. _polymixus_.\n- An^espera: O mesmo que _n^espera_. Cf. B. Pereira, _Prosodia_, vb. _pytmena_.\n- Arraba\u00b8ca: Planta, o mesmo que _raba\u00b8ca_.\n...\nPop.\n- Achafundar: Enterrar no logo; meter no fundo da \u00b4agua.\n- Acarditar: O mesmo que _acreditar_.\n- Alampi~ao: O mesmo que _lampi~ao_. Cf. B. Pereira, _Pros\u00b4odia_, vb. _polymixus_.\n</code></pre>\n"}, {"tags": ["c", "double-pointer"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 12279616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d0389818c5f6b55680075fbefcd913?s=128&d=identicon&r=PG&f=1", "display_name": "Linus Gudmundsson", "link": "https://stackoverflow.com/users/12279616/linus-gudmundsson"}, "is_accepted": false, "score": 0, "last_activity_date": 1572476473, "creation_date": 1572476473, "answer_id": 58634765, "question_id": 58634588, "link": "https://stackoverflow.com/questions/58634588/double-pointers-output-explanation/58634765#58634765", "title": "Double pointers - output explanation", "body": "<p>Yes. *r = p would make the item r points to, q, point to the same address as p, which is &amp;a. \n**r is the same as *q which is the value at &amp;a which is 6.</p>\n"}, {"tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": true, "score": 2, "last_activity_date": 1572476983, "last_edit_date": 1572476983, "creation_date": 1572476625, "answer_id": 58634779, "question_id": 58634588, "link": "https://stackoverflow.com/questions/58634588/double-pointers-output-explanation/58634779#58634779", "title": "Double pointers - output explanation", "body": "<p>Let's break it down:</p>\n\n<ol>\n<li><p><code>int a=1,b=2,c=3;</code></p>\n\n<pre><code>a = 1\nb = 2\nc = 3\n</code></pre></li>\n<li><p><code>int *p,*q,**r;</code></p>\n\n<pre><code>p --&gt; ?\nq --&gt; ?\nr --&gt; ? --&gt; ?\n</code></pre></li>\n<li><p><code>p=&amp;a;</code></p>\n\n<pre><code>p --&gt; a = 1\nq --&gt; ?\nr --&gt; ? --&gt; ?\n</code></pre></li>\n<li><p><code>r=&amp;q;</code></p>\n\n<pre><code>p --&gt; a = 1\nq --&gt; ?\nr --&gt; q --&gt; ?\n</code></pre></li>\n<li><p><code>q=&amp;c;</code></p>\n\n<pre><code>p --&gt; a = 1\nq --&gt; c = 3\nr --&gt; q --&gt; c = 3\n</code></pre></li>\n<li><p><code>a=*q+**r;</code>, as can be seen from the previous point, we have:</p>\n\n<pre><code>a = 3 + 3 = 6\n</code></pre></li>\n<li><p><code>printf(\"x=%d y=%d z=%d\\n\",**r,*p,*q);</code> prints:</p>\n\n<pre><code>x=3 y=6 z=3\n</code></pre></li>\n<li><p><code>*r=p;</code>. This is sneaky: since <code>*r == q</code>, this changes <code>q</code>. This is the same as doing <code>q=p</code>. So we get:</p>\n\n<pre><code>p --&gt; a = 6\nq --&gt; a = 6\nr --&gt; q --&gt; a = 6\n</code></pre></li>\n<li><p><code>a=*q+**r;</code>, as can be seen from the previous point, we have:</p>\n\n<pre><code>a = 6 + 6 = 12\n</code></pre></li>\n<li><p><code>printf(\"w=%d\\n\",a);</code> prints:</p>\n\n<pre><code>w=12\n</code></pre></li>\n</ol>\n\n<p>Conclusion: <strong>your explanation is correct</strong>.</p>\n"}], "owner": {"reputation": 151, "user_id": 8752013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3c5d349214693407a5617577ee9f25?s=128&d=identicon&r=PG&f=1", "display_name": "So Lo", "link": "https://stackoverflow.com/users/8752013/so-lo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58634779, "answer_count": 2, "score": 2, "last_activity_date": 1572476983, "creation_date": 1572475318, "last_edit_date": 1572476852, "question_id": 58634588, "link": "https://stackoverflow.com/questions/58634588/double-pointers-output-explanation", "title": "Double pointers - output explanation", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main(void){\n\n    int a=1,b=2,c=3; int *p,*q,**r; p=&amp;a;\n    r=&amp;q;\n    q=&amp;c;\n    a=*q+**r;\n    printf(\"x=%d y=%d z=%d\\n\",**r,*p,*q); \n    *r=p;\n    a=*q+**r;\n    printf(\"w=%d\\n\",a);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>x=3 y=6 z=3\nw=12\n</code></pre>\n\n<p>I was able to predict the output correctly, but I am not sure whether I have the correct explanation for the output of z.</p>\n\n<p>Please see whether I have the correct understanding:</p>\n\n<ul>\n<li>Right before <code>*r=p;</code> executes, we have <code>a=6,b=2,c=3</code>.</li>\n<li>When  <code>*r=p;</code> executes, the value at the place to which <code>r</code> points to gets changed to <code>p</code>.</li>\n<li>Now <code>r</code> points to <code>q</code> that has address of <code>c</code>, so now <code>q</code> has address of <code>a</code> because <code>p</code> points to <code>a</code>. So <code>q</code> now points to <code>a</code>. So <code>*q</code> gives 6.</li>\n<li>Since <code>r</code> still points to <code>q</code>, and <code>q</code> points to <code>a</code>, <code>**r</code> gives 6.</li>\n<li>So <code>*q + **r = 6+6=12</code></li>\n</ul>\n\n<p>Is this the correct explanation?</p>\n"}, {"tags": ["c", "cs50", "credits"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1572474697, "post_id": 58634475, "comment_id": 103575907, "body": "Best to use a string for a card and phone numbers, not an integer. Suppose the number begins with a <code>0</code> or <code>00</code>? That will make the extraction of its fields so much easier (and obvious) too."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572475052, "post_id": 58634475, "comment_id": 103576003, "body": "...you will find it easier to debug if you distinguish the various identical error messages."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572475286, "post_id": 58634475, "comment_id": 103576064, "body": "Instead of N related variables consider making an array of size N."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12174113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2132d8371d3dcb9ec348b60fa4b2834?s=128&d=identicon&r=PG&f=1", "display_name": "Gregzone", "link": "https://stackoverflow.com/users/12174113/gregzone"}, "edited": false, "score": 0, "creation_date": 1572792393, "post_id": 58636486, "comment_id": 103662178, "body": "Thank you so much for taking time to answer, thanks for the insight too.My program is up and running effectively without any hiccups."}], "tags": [], "owner": {"reputation": 148, "user_id": 10059000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb9e76f84bd927304f853f336da6dab?s=128&d=identicon&r=PG&f=1", "display_name": "sipihr", "link": "https://stackoverflow.com/users/10059000/sipihr"}, "is_accepted": true, "score": 1, "last_activity_date": 1572492047, "creation_date": 1572492047, "answer_id": 58636486, "question_id": 58634475, "link": "https://stackoverflow.com/questions/58634475/why-do-i-keep-getting-an-invalid-feedback/58636486#58636486", "title": "Why do i keep getting an invalid feedback?", "body": "<p>First of all, some of your <code>if</code> conditions are wrong. For example,</p>\n\n<pre><code>if(totaldigits != 13 || totaldigits != 14 || totaldigits != 16)\n</code></pre>\n\n<p>You want to check if the totaldigits is 13 or 14 or 16, but what you check here is <em>if totaldigits is not 13, then print invalid</em> or <em>if totaldigits is not 14 then, print invalid</em> and so on. Hence, it will always print invalid. You need to use <code>&amp;&amp; (AND)</code> instead of <code>|| (OR)</code>.</p>\n\n<p>The same problem exists in this line as well.</p>\n\n<pre><code>if(master!=51 || master!=52 ||master!=53 ||master!=54 ||master!=55)\n</code></pre>\n\n<p>Another problem is that you put 1 unnecessary 0 to division in this line, so it always yields 0.</p>\n\n<pre><code>int number8 = ((ccnumber/10000000000000000) % 10) *2; // 1 zero unnecessary\n</code></pre>\n\n<p>As it is suggested in the comments, you may need to consider creating an array for storing individual digits instead of using 16 different integers. When you have an array you can do the divisions in a for loop so that you don't get confused with a lot of zeros.\nAs an example, you can refer to this link\n<a href=\"https://gist.github.com/mitrnsplt/10945596\" rel=\"nofollow noreferrer\">A solution for cs50's credit card validation problem </a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 12174113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2132d8371d3dcb9ec348b60fa4b2834?s=128&d=identicon&r=PG&f=1", "display_name": "Gregzone", "link": "https://stackoverflow.com/users/12174113/gregzone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58636486, "answer_count": 1, "score": 2, "last_activity_date": 1572492047, "creation_date": 1572474537, "last_edit_date": 1572474627, "question_id": 58634475, "link": "https://stackoverflow.com/questions/58634475/why-do-i-keep-getting-an-invalid-feedback", "title": "Why do i keep getting an invalid feedback?", "body": "<p>I've been working on the cs50 pset1 credit for the past 36 hours.\nMy code is not generating any errors but when i enter my card details it shows invalid, what could be the problem.\nI'm a noob, guys please help out.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\n int main (void)\n{\n    long long ccnumber;\n\n     do \n     {\n         //Prompting the user for his creditcard number\n         ccnumber=get_long_long(\"What is your creditcard number\\n\");\n     }\n     while (ccnumber&lt;= 0);\n\n     //validating the credit card number to ascertain if its upto 13. 14 or 16\n    long long numbers = ccnumber;\n     int totaldigits = 0; \n\n     while (numbers &gt; 0)\n     {\n         numbers = numbers/10;\n         totaldigits++;\n     }\n     if(totaldigits != 13 || totaldigits !=14 || totaldigits !=16)\n     {\n         printf(\"Invalid\\n\");\n     }\n\n     //Starting from the second to last digit\n     //And multiplying through by 2\n     int number1 = ((ccnumber/10) % 10) *2;\n     int number2 = ((ccnumber/1000) % 10) *2;\n     int number3 = ((ccnumber/100000) % 10) *2;\n     int number4 = ((ccnumber/10000000) % 10) *2;\n     int number5 = ((ccnumber/1000000000) % 10) *2;\n     int number6 = ((ccnumber/100000000000) % 10) *2;\n     int number7 = ((ccnumber/10000000000000) % 10) *2;\n     int number8 = ((ccnumber/10000000000000000) % 10) *2;\n\n     //Getting the Sum of the first number series\n     int sum1;\n         sum1 = (number1 + number2 + number3 + number4 + number5 + number6 + number7 + number8);\n\n     //Populating the second number series\n     int number9 = ccnumber % 10;\n     int number10 = ((ccnumber/100) % 10);\n     int number11 = ((ccnumber/10000) % 10);\n     int number12 = ((ccnumber/1000000) % 10);\n     int number13 = ((ccnumber/100000000) % 10);\n     int number14 = ((ccnumber/10000000000) % 10);\n     int number15 = ((ccnumber/1000000000000) % 10);\n     int number16 = ((ccnumber/100000000000000) % 10);\n\n    int sum2;\n        sum2 =(number9 + number10 + number11 + number12 + number13 + number14 + number15 + number16);\n\n     //Adding sum1 and sum2\n     int checksum;\n         checksum = sum1 + sum2;\n     if (checksum % 10 != 0)\n     {\n         printf(\"invalid/n\");\n      }\n\n     //Verifying for visacard(1)\n     if(totaldigits == 13)\n     {\n         printf(\"Visa\\n\");\n     }\n\n     // Verifying for visa(2)\n     if(totaldigits == 16)\n     {\n         long long visa;\n         visa = ccnumber/1000000000000000;\n       if(visa!=4)\n       {\n           printf(\"Invalid\\n\");\n       } \n         else \n         {\n             printf(\"VISA\\n\");\n         }\n         //Verifying for MasterCard\n         long long master;\n         master = ccnumber/100000000000000;\n         if(master!=51 || master!=52 ||master!=53 ||master!=54 ||master!=55)\n         {\n             printf(\"Invalid\\n\");\n         }\n         else\n         {\n             printf(\"MASTER\\n\");\n         }\n     }\n\n       //Verifying for Amex\n     }\n</code></pre>\n\n<p>/counter\nWhat is your creditcard number\n2221000000000009\nInvalid\ninvalid/nInvalid\nInvalid</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 0, "creation_date": 1572473037, "post_id": 58634212, "comment_id": 103575423, "body": "It would be useful to show for some given inputs, what you expect the outputs to be.  It is unclear what you are trying to accomplish."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1572473348, "post_id": 58634212, "comment_id": 103575517, "body": "Hint 1: don&#39;t use macros at your level. Hint 2: using a macro here is pointless, it makes it more complicated than it is."}, {"owner": {"reputation": 1, "user_id": 10913678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rMOuw.jpg?s=128&g=1", "display_name": "Jaycoder", "link": "https://stackoverflow.com/users/10913678/jaycoder"}, "edited": false, "score": 0, "creation_date": 1572473445, "post_id": 58634212, "comment_id": 103575554, "body": "I&#39;m expecting to input the value of 5 and getting 278.5 as the result."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1572473486, "post_id": 58634212, "comment_id": 103575568, "body": "What&#39;s wrong with <code>c + 273.15</code>?"}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1572473567, "post_id": 58634212, "comment_id": 103575593, "body": "<code>printf(..., &amp;X)</code> is wrong, it should just be <code>X</code>.  <code>printf</code> expects the value, not a pointer to the value.  Yes, it is different from <code>scanf</code>, and if you think a little about the fact that C parameters are always passed by value, you&#39;ll see why it should be different."}, {"owner": {"reputation": 1, "user_id": 10913678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rMOuw.jpg?s=128&g=1", "display_name": "Jaycoder", "link": "https://stackoverflow.com/users/10913678/jaycoder"}, "edited": false, "score": 0, "creation_date": 1572473574, "post_id": 58634212, "comment_id": 103575595, "body": "I&#39;ve already tried  float X = SUM(C) + (273.15); and i get 0.00000 as the result"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10913678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rMOuw.jpg?s=128&g=1", "display_name": "Jaycoder", "link": "https://stackoverflow.com/users/10913678/jaycoder"}, "edited": false, "score": 0, "creation_date": 1572474594, "post_id": 58634345, "comment_id": 103575880, "body": "I still get the value of 273.15, it does not add the value of the float to the sum"}, {"owner": {"reputation": 1, "user_id": 10913678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rMOuw.jpg?s=128&g=1", "display_name": "Jaycoder", "link": "https://stackoverflow.com/users/10913678/jaycoder"}, "edited": false, "score": 0, "creation_date": 1572483668, "post_id": 58634345, "comment_id": 103577981, "body": "It works! Thank you so much Omarito. Have a nice day!"}], "tags": [], "owner": {"reputation": 549, "user_id": 7520070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DJrTs.jpg?s=128&g=1", "display_name": "Omarito", "link": "https://stackoverflow.com/users/7520070/omarito"}, "is_accepted": false, "score": 2, "last_activity_date": 1572474715, "last_edit_date": 1572474715, "creation_date": 1572473593, "answer_id": 58634345, "question_id": 58634212, "link": "https://stackoverflow.com/questions/58634212/is-there-a-way-to-implement-macros-define-into-a-c-conversion-program/58634345#58634345", "title": "Is there a way to implement macros (#define) into a C conversion program?", "body": "<p>This what you need :</p>\n\n<pre><code>#define TO_KELVIN(celsuis) ((celsuis) + 273.15)\n</code></pre>\n\n<p>Its considered a bad practice to define macros like this please use functions instead.</p>\n\n<p><strong>Full code :</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;stdlib.h&gt;\n\n#define TO_KELVIN(celsuis) ((celsuis) + 273.15)\n\nint main()\n{\n    float C;\n    printf(\"Enter celsius:\");\n    scanf(\"%f\", &amp;C);\n    float X = TO_KELVIN(C);\n    printf(\"The conversion equals to %5.5f Kelvin\\n\", X);\n    return 0;\n}\n</code></pre>\n\n<p>Your also trying to use <code>scanf(\"%5.5f\", &amp;C);</code> the <em>5.5</em> won't work for <code>scanf</code> its just for the <code>printf</code> function.</p>\n"}], "owner": {"reputation": 1, "user_id": 10913678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rMOuw.jpg?s=128&g=1", "display_name": "Jaycoder", "link": "https://stackoverflow.com/users/10913678/jaycoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572474715, "creation_date": 1572472732, "last_edit_date": 1572474277, "question_id": 58634212, "link": "https://stackoverflow.com/questions/58634212/is-there-a-way-to-implement-macros-define-into-a-c-conversion-program", "title": "Is there a way to implement macros (#define) into a C conversion program?", "body": "<p>I'm trying to do a simple conversion program from Celsius to kelvin implementing the function #define with macros but I am having trouble because i don't know if I can do it this way.</p>\n\n<pre><code>#include &lt;stdio.h&gt;`\n\n#include &lt;stdlib.h&gt;`\n\n#define SUM(C) + (273.15)`\n\nint main()\n{\n    float C;\n\n    printf(\"Enter celsius:\");\n    scanf(\"%5.5f\", &amp;C);\n\n    float X = SUM(%5.5f) + (273.15);\n\n    printf(\"The conversion equals to %5.5f Kelvin\\n\", X);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "double-pointer"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1572472897, "post_id": 58634170, "comment_id": 103575379, "body": "Why do you think <code>b[0]+4</code> points to <code>b[1][1]</code>? You allocated each row separately, they&#39;re not contiguous."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572472953, "post_id": 58634170, "comment_id": 103575403, "body": "All the rows of <code>a</code> are contiguous because it&#39;s a 2-dimensional array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572473203, "post_id": 58634170, "comment_id": 103575479, "body": "Try printing the values of <code>b[0]</code> and <code>b[1]</code> to see that they differ by more than <code>3</code>."}, {"owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572473744, "post_id": 58634170, "comment_id": 103575643, "body": "@Barmar I read calloc allocates contiguous memory?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1572473903, "post_id": 58634170, "comment_id": 103575693, "body": "Each call to <code>calloc()</code> allocates contiguous memory, but it&#39;s not contiguous with other calls."}, {"owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572474003, "post_id": 58634170, "comment_id": 103575727, "body": "@Barmar oh I see, so I am getting garbage values in both the places, right"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1572473645, "creation_date": 1572473645, "answer_id": 58634355, "question_id": 58634170, "link": "https://stackoverflow.com/questions/58634170/double-pointer-getting-unexpected-output/58634355#58634355", "title": "Double pointer - getting unexpected output", "body": "<p>When you declare a 2-dimensional array like <code>a[3][3]</code>, the entire array is contiguous, so <code>a[0][2]</code> is immediately followed by <code>a[1][0]</code>. When you use pointer arithmetic on <code>a</code>, you can depend on this ability to cross rows, as long as you stay within the entire <code>a</code> array.</p>\n\n<p>But when you use an array of pointers, there's no reason to expect each row to be contiguous with the previous row. The memory allocated by each call to <code>malloc()</code> is unrelated to previous calls. Also, <code>malloc()</code> has to ensure that the memory is properly aligned for any datatype; if the size you're allocating is not a multiple of this, they can't possibly be contiguous. And many dynamic memory allocators store bookkeeping information (such as the size of the allocation, so that <code>free()</code> knows how much memory to reclaim) before the allocation, so that also prevents allocations from being contiguous.</p>\n\n<p>It's undefined behavior to access the memory outside the allocation size. Since <code>b[0]</code> points to an allocation of 3 <code>int</code>, <code>b[0]+4</code> is outside this allocation, and <code>*(b[0]+4)</code> causes undefined behavior.</p>\n"}], "owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58634355, "answer_count": 1, "score": 0, "last_activity_date": 1572473645, "creation_date": 1572472518, "last_edit_date": 1572472803, "question_id": 58634170, "link": "https://stackoverflow.com/questions/58634170/double-pointer-getting-unexpected-output", "title": "Double pointer - getting unexpected output", "body": "<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt; \n\nint main()\n{\n    int a[3][3]={{0,1},{2,3},{5,6}},**b,i,j;\n    b=(int **)calloc(3,sizeof(int *));\n    for(i=0;i&lt;3;i++)\n    {\n        b[i]=(int *)calloc(3,sizeof(int));\n    }\n    for(i=0;i&lt;3;i++)\n    {\n        for(j=0;j&lt;3;j++)\n        {\n            b[i][j]=(i+1)*(j+1);\n        }\n    }\n\n    printf(\"%d %d %d %d\\n\",*(*a+4),**a+4,*(*b+4),**b+4); \n    printf(\"%d %d %d %d\\n\",*(a[2]-2),**(a+2),*(b[2]-2),**(b+2)); \n\n    return 0;\n}\n</code></pre>\n\n<p>Output I am getting :</p>\n\n<pre><code>3 4 2 5\n3 5 6 3\n</code></pre>\n\n<p>According to me I should be getting:</p>\n\n<pre><code>3 4 4 5\n3 5 4 3\n</code></pre>\n\n<p>Reason: </p>\n\n<p><code>*(*b+4) = *(b[0]+4)</code>. <code>b[0]+4</code> points to <code>b[1][1]</code> so this value should be <code>4</code>, which is the value of matrix at <code>1,1</code> position</p>\n\n<p><code>*(b[2]-2)</code>, Now <code>b[2]-2</code> points to <code>b[1][1]</code>, so value again should be <code>4</code></p>\n\n<p>please tell me why am getting different output</p>\n"}, {"tags": ["c++", "c", "pointers", "fork", "shared-memory"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1572472697, "post_id": 58634111, "comment_id": 103575317, "body": "You&#39;d need to copy the object into the shared memory. The pointer points to non-shared memory."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1572472863, "post_id": 58634111, "comment_id": 103575370, "body": "The only way to share that object directly is to make sure it is allocated in memory which is shared. If you can&#39;t  change the library, provide the storage for it or copy the object yourself, you&#39;re limited to hacks like figuring out what allocator it uses and intercepting that."}, {"owner": {"reputation": 3, "user_id": 12299900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b62cafb853317b8869fb0206cb5d83?s=128&d=identicon&r=PG", "display_name": "Cristiano Urban", "link": "https://stackoverflow.com/users/12299900/cristiano-urban"}, "edited": false, "score": 0, "creation_date": 1572473098, "post_id": 58634111, "comment_id": 103575444, "body": "The point is that I think the only way to access that object is through a pointer, since the function I call in the main() belongs to another library and returns a pointer."}, {"owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "edited": false, "score": 0, "creation_date": 1572473551, "post_id": 58634111, "comment_id": 103575587, "body": "The shared memory can be mounted at different address in different process. You nees to use offsets instead of pointer value. Boost a a library specifically designed to replicate STL in shared memory: interprocess. Look it up for inspiration."}, {"owner": {"reputation": 3, "user_id": 12299900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b62cafb853317b8869fb0206cb5d83?s=128&d=identicon&r=PG", "display_name": "Cristiano Urban", "link": "https://stackoverflow.com/users/12299900/cristiano-urban"}, "edited": false, "score": 0, "creation_date": 1572551626, "post_id": 58634111, "comment_id": 103605566, "body": "I think I will change approach in order to solve my problem. Thank you all for your suggestions!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1572626700, "post_id": 58634111, "comment_id": 103628888, "body": "a pointer means nothing when in a different process"}, {"owner": {"reputation": 3, "user_id": 12299900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b62cafb853317b8869fb0206cb5d83?s=128&d=identicon&r=PG", "display_name": "Cristiano Urban", "link": "https://stackoverflow.com/users/12299900/cristiano-urban"}, "edited": false, "score": 0, "creation_date": 1573124654, "post_id": 58634111, "comment_id": 103783240, "body": "I know, in fact I had to think to a different solution."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12299900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b62cafb853317b8869fb0206cb5d83?s=128&d=identicon&r=PG", "display_name": "Cristiano Urban", "link": "https://stackoverflow.com/users/12299900/cristiano-urban"}, "edited": false, "score": 0, "creation_date": 1573124349, "post_id": 58718220, "comment_id": 103783061, "body": "Thank you very much Luis, super exhaustive explanation!"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 3, "user_id": 12299900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b62cafb853317b8869fb0206cb5d83?s=128&d=identicon&r=PG", "display_name": "Cristiano Urban", "link": "https://stackoverflow.com/users/12299900/cristiano-urban"}, "edited": false, "score": 0, "creation_date": 1573198978, "post_id": 58718220, "comment_id": 103811167, "body": "youre welcome... you should select the answer as your preferred, if you are satisfied with it."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": true, "score": 0, "last_activity_date": 1572982340, "creation_date": 1572982340, "answer_id": 58718220, "question_id": 58634111, "link": "https://stackoverflow.com/questions/58634111/fork-shared-memory-and-pointers-in-c/58718220#58718220", "title": "fork(), shared memory and pointers in C", "body": "<p>Basically a pointer is an address of some data in the virtual space of one process.  You cannot share pointers between processes because those pointers will be interpreted in a different address space  (in general, this also applies to the kernel mode virtual space and the user mode of <em>the same</em> process).  Let's use an example... you have make some allocations (between them you have made a <code>mmap(2)</code> allocation) and then you <code>fork(2)</code> another process.  Until then, all memory addresses pointed to the same places if we consider that both processes had existed before the fork, they would have been doing the same, getting the same results, etc.</p>\n\n<p>But once both processes depart from each other, all the allocations made in one process can be differently positioned than <em>the same allocations in the other process</em>, as the different histories of each process could provide different results from any allocator. Just assume some temporal order in the tasks and some time dependant state change... after it, the states of both processes will be different. </p>\n\n<p>Now let's suppose you have a pointer in one process, that points to an structure of data, that you want to share with the other.  But the other process has not even allocated the same thing... so passing e.g. <code>0x00456211ff</code> to the other process will point to a place in the other process where nothing has been allocated (leading to a <code>SIGSEGV</code> signal and process abort)</p>\n\n<p>Once the processes divert their virtual spaces store different things, and virtual pointers in one space are not interpretable in the other process'.</p>\n"}], "owner": {"reputation": 3, "user_id": 12299900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b62cafb853317b8869fb0206cb5d83?s=128&d=identicon&r=PG", "display_name": "Cristiano Urban", "link": "https://stackoverflow.com/users/12299900/cristiano-urban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 58718220, "answer_count": 1, "score": 0, "last_activity_date": 1572982340, "creation_date": 1572472112, "last_edit_date": 1572472564, "question_id": 58634111, "link": "https://stackoverflow.com/questions/58634111/fork-shared-memory-and-pointers-in-c", "title": "fork(), shared memory and pointers in C", "body": "<p>I cannot share a pointer to an object among processes with shared memory.</p>\n\n<p>I can successfully share a struct like the one below among different processes:</p>\n\n<pre><code>    // Data to be shared among processes\n    struct Shared_data {\n        int setPointCounter;\n        struct Point old_point;\n        pthread_mutex_t my_mutex;\n    } *shd;\n</code></pre>\n\n<p>The struct is declared as global (it is located before the main(), let's say).</p>\n\n<p>I initialize the shared memory into the main:</p>\n\n<pre><code>shd = (struct Shared_data *) (mmap(NULL, sizeof *shd, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_ANONYMOUS, -1, 0));\n</code></pre>\n\n<p>and then at a certain point I do a fork(). It works fine.</p>\n\n<p>The problem arises when I have to share something like this:</p>\n\n<pre><code>    // Data to be shared among processes\n    struct Shared_data {\n        int setPointCounter;\n        struct Point old_point;\n        MyObject *obj;\n        pthread_mutex_t my_mutex;\n    } *shd;\n</code></pre>\n\n<p>In the main I call a function from a third-party library which returns a pointer to an object of MyObject type and I would like to share it in some way. How can I do this?</p>\n\n<p>By searching on the web I've found something related to relative pointers but I'm not sure it will work and, at the same time, I don't know how to do it the right way.</p>\n\n<p>I'm working on Linux (Slackware 64 14.2) and the language is C/C++ (mostly is C, actually).</p>\n\n<p>Thank you in advance for your time.</p>\n"}, {"tags": ["c", "nested-if"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1572472167, "post_id": 58634089, "comment_id": 103575149, "body": "Constructors and Destructors are not a part of the C language."}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 1, "creation_date": 1572472625, "post_id": 58634089, "comment_id": 103575295, "body": "You can&#39;t have an 2nd else statement after another else statement.  Around line 23 you need an else if statement."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1572472880, "post_id": 58634089, "comment_id": 103575375, "body": "You&#39;re using a C++ compiler.  You must therefore use an ISO-conformant definition of <code>main</code>: <code>int main()</code>.  In addition to the <code>else</code> issue (which is just a misplaced <code>}</code> that could have been avoided if you indented code properly), you are missing some logic.  Note the &quot;fixed&quot; program compiles but doesn&#39;t work: <a href=\"https://godbolt.org/z/RoWlRj\" rel=\"nofollow noreferrer\">godbolt.org/z/RoWlRj</a>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1572472974, "post_id": 58634089, "comment_id": 103575407, "body": "Of course, since this is C++, you could just use <code>int big = std::max(std::max(a, b), std::max(c, d))</code>"}, {"owner": {"reputation": 25, "user_id": 12035606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FCM1C7XgKfg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reD8gc--L_RaRK36n6mRTI806YPOw/photo.jpg?sz=128", "display_name": "Bao", "link": "https://stackoverflow.com/users/12035606/bao"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1572503551, "post_id": 58634089, "comment_id": 103582043, "body": "This is C, not C++. But yes, the compiler is both C &amp; C++ compatible. @paddy"}], "answers": [{"comments": [{"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1572508166, "post_id": 58638147, "comment_id": 103583615, "body": "Will you please explain what you did to solve the problem? OP might not notice, and therefore he cannot learn anything from this. Not my down-vote."}], "tags": [], "owner": {"reputation": 21, "user_id": 5779429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d350aa7ec1d4e076737ba4194a364fc?s=128&d=identicon&r=PG&f=1", "display_name": "Hank", "link": "https://stackoverflow.com/users/5779429/hank"}, "is_accepted": false, "score": -1, "last_activity_date": 1572509765, "last_edit_date": 1572509765, "creation_date": 1572504634, "answer_id": 58638147, "question_id": 58634089, "link": "https://stackoverflow.com/questions/58634089/program-to-find-biggest-of-four-numbers-using-nested-if/58638147#58638147", "title": "Program to find biggest of four numbers using nested-if", "body": "<p>You did not consider case when <code>a &lt;= b</code> or it places in wrong position (inside <code>a &lt; b</code> block).</p>\n\n<p>You can imagine problem in a decision tree similar to <a href=\"https://i.stack.imgur.com/a1QMT.jpg\" rel=\"nofollow noreferrer\">this</a> (3 numbers) for clearer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nmain() {\n  int a, b, c, d, big;\n  printf(\"\\n Enter value to a, b, c, d: \");\n  scanf(\"%d %d %d %d\", &amp;a, &amp;b, &amp;c, &amp;d);\n\n  if (a &gt; b) {\n    if (a &gt; c) {\n      if (a &gt; d)\n        big = a;\n      else\n        big = d;\n    } else {\n      if (c &gt; d)\n        big = c;\n      else\n        big = d;\n    }\n\n  } else {\n    if (b &gt; c) {\n      if (b &gt; d)\n        big = b;\n      else\n        big = d;\n    }\n    else {\n      if (c &gt; d)\n        big = c;\n      else\n        big = d;\n    }\n  }\n\n  printf(\"\\n The biggest number is %d\", big);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "is_accepted": false, "score": 0, "last_activity_date": 1572523341, "last_edit_date": 1572523341, "creation_date": 1572510209, "answer_id": 58639305, "question_id": 58634089, "link": "https://stackoverflow.com/questions/58634089/program-to-find-biggest-of-four-numbers-using-nested-if/58639305#58639305", "title": "Program to find biggest of four numbers using nested-if", "body": "<p>You can use the <code>ternary operator</code> to solve your problem. Thus, the code simplifies to </p>\n\n<pre><code>int main() {\n    int a, b, c, d;\n    printf(\"\\n Enter value to a, b, c, d: \");\n    scanf(\"%d %d %d %d\", &amp;a, &amp;b, &amp;c, &amp;d);\n\n    const int big1 = (a &gt; b) ? a : b;\n    const int big2 = (c &gt; d) ? c : d;\n    int big = (big1 &gt; big2) ? big1 : big2;\n\n    printf(\"\\n The biggest number is %d\", big);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1572536207, "creation_date": 1572536207, "answer_id": 58646787, "question_id": 58634089, "link": "https://stackoverflow.com/questions/58634089/program-to-find-biggest-of-four-numbers-using-nested-if/58646787#58646787", "title": "Program to find biggest of four numbers using nested-if", "body": "<blockquote>\n  <p>I do not know what may be that I'm doing wrong. Logic-wise everything appears correct to me.</p>\n</blockquote>\n\n<p>There are some syntactic errors, though. A construct like</p>\n\n<pre><code>// ...\nif ( a &gt; c ) {\n    // ...\n}\nelse {               // &lt;----\n    // ...\n}\nelse if ( b &gt; c ) {\n    // ...\n}\n</code></pre>\n\n<p>Is not valid in C.</p>\n\n<p>It's unclear to me how the OP was planning to structure the nested <code>if</code>s in order to solve the task, but before going on, I'd suggest to write some simple tests to verify the correctness of the algorithm:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// Prototype of the function which returns the biggest out of the four arguments\nint max_of_four(int a, int b, int c, int d);\n\n// Helper function used to verify the correctness of the results\nint test_(int a, int b, int c, int d, int expected)\n{\n    int result = max_of_four(a, b, c, d);\n    if ( result != expected )\n    {\n        printf(\"FAILED - Expected: %d (given %d, %d, %d and %d), instead of %d.\\n\", \n               expected, a, b, c, d, result);\n        return 1;\n    }\n    return 0;\n}\n\n// Test runner\nint main(void)\n{\n    int failed = 0;\n\n    // The function should be able to find the biggest regardless of its \"position\"\n    failed += test_(1, 2, 3, 4,  4);\n    failed += test_(4, 3, 2, 1,  4);\n    failed += test_(2, 1, 4, 3,  4);\n    failed += test_(3, 4, 1, 2,  4);\n\n    // The function should manage negative values\n    failed += test_(1, -2, -3, -4,    1);\n    failed += test_(-4, -3, -2, -1,  -1);\n    failed += test_(0, -3, -1, -2,    0);\n\n    // The function should manage duplicate values\n    failed += test_(1, -2, 1, 2,      2);\n    failed += test_(-4, -3, -3, -5,  -3);\n    failed += test_(1, 1, 1, 1,       1);\n\n    if ( failed == 0 )\n        puts(\"So far so good.\");\n\n    return 0;\n}\n\n// A simple implentation.\nint max_of_four(int a, int b, int c, int d)\n{\n    int big = a;\n    if ( b &gt; a )\n        big = b;\n    if ( c &gt; big )\n        big = c;\n    if ( d &gt; big )\n        big = d;\n    return big;    \n}\n</code></pre>\n\n<p>You can test it <a href=\"https://wandbox.org/permlink/7ZWUnBhw9EmGoy6X\" rel=\"nofollow noreferrer\">here</a> and try to rewrite the function using nested <code>if</code> statements, if you want. Maybe something like</p>\n\n<pre><code>int max_of_four(int a, int b, int c, int d)\n{\n    if ( b &gt; a )\n    {\n        if ( d &gt; c )\n        {\n            if ( b &gt; d )\n                return b;\n            else\n                return d;\n        }\n        else // d &lt;= c\n        {\n            if ( b &gt; c )\n                return b;\n            else\n                return c;\n        }            \n    }\n    else // b &lt;= a\n    {\n        // You got the idea...\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 12600599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAGBrfly92WnoKWQBu7u4GCXITJoVzFdfWRi3sI=k-s128", "display_name": "Shivam Suchak", "link": "https://stackoverflow.com/users/12600599/shivam-suchak"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1603960934, "post_id": 64391852, "comment_id": 114202581, "body": "@AdrianMole Thank for the info, I&#39;ll try my best next time"}], "tags": [], "owner": {"reputation": 91, "user_id": 12600599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAGBrfly92WnoKWQBu7u4GCXITJoVzFdfWRi3sI=k-s128", "display_name": "Shivam Suchak", "link": "https://stackoverflow.com/users/12600599/shivam-suchak"}, "is_accepted": false, "score": 0, "last_activity_date": 1603960896, "last_edit_date": 1603960896, "creation_date": 1602861119, "answer_id": 64391852, "question_id": 58634089, "link": "https://stackoverflow.com/questions/58634089/program-to-find-biggest-of-four-numbers-using-nested-if/64391852#64391852", "title": "Program to find biggest of four numbers using nested-if", "body": "<p>I used the ternary operator instead of if-else statements it works the same as if-else you can check how <a href=\"https://www.w3schools.com/cpp/cpp_conditions_shorthand.asp\" rel=\"nofollow noreferrer\">ternary operator</a> works.</p>\n<pre><code>int max_of_four(int a,int b,int c,int d){\n     return (a &lt; b ? ((b &gt; c)? ((b &gt; d)? b:d) :((c &gt; d)? c: d))  : ((a &lt; c)? ((c &gt; d)? c: d) : ((a &gt; d) ? a : d)));\n}\n\nint main() {\n    int a, b, c, d;\n    scanf(&quot;%d %d %d %d&quot;, &amp;a, &amp;b, &amp;c, &amp;d);\n    int ans = max_of_four(a, b, c, d);\n    printf(&quot;%d&quot;, ans);\n    \n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12035606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FCM1C7XgKfg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reD8gc--L_RaRK36n6mRTI806YPOw/photo.jpg?sz=128", "display_name": "Bao", "link": "https://stackoverflow.com/users/12035606/bao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4567, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1603960896, "creation_date": 1572471965, "last_edit_date": 1572503816, "question_id": 58634089, "link": "https://stackoverflow.com/questions/58634089/program-to-find-biggest-of-four-numbers-using-nested-if", "title": "Program to find biggest of four numbers using nested-if", "body": "<p>Sir/Ma'am,<br>\nI do not know what may be that I'm doing wrong. Logic- wise everything appears correct to me. The braces seem placed in the correct positions as well. Then why is it that I'm receiving the following error messages?</p>\n\n<blockquote>\n  <p>32    8    [Error] expected constructor, destructor, or type conversion before '(' token<br>\n  33  2   [Error] expected unqualified-id before 'return'<br>\n  34  1 [Error] expected declaration before '}' token</p>\n</blockquote>\n\n<p>What am I doing wrong with this particular program? And, I was hoping for a correction using the same statements, and not any other.</p>\n\n<p>Please help!</p>\n\n<p>The program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n    int a, b, c, d, big;\n    printf(\"\\n Enter value to a, b, c, d: \");\n    scanf(\"%d %d %d %d\", &amp;a, &amp;b, &amp;c, &amp;d);\n    if (a &gt;b)\n    {\n        if(a&gt;c)\n        {\n            if(a&gt;d)\n            big = a;\n            else\n            big=d;\n        }\n        else\n           {\n           if(c&gt;d)\n            big = c;\n            else\n            big = d;\n        }\n        else\n            if(b&gt;c)\n            {\n                if(b&gt;d)\n                big = b;\n                else\n                big = d;\n            }\n    }\n    printf(\"\\n The biggest number is %d\", big);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "conditional-statements"], "comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 1, "creation_date": 1572470757, "post_id": 58633815, "comment_id": 103574689, "body": "It appears that <code>lowch</code> is actually an ASCII character code: if so, I really recommend that you use the actual letter - such as <code>a</code> rather than the decimal value. This would make it easier to read."}, {"owner": {"reputation": 85, "user_id": 12299863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJqQA.jpg?s=128&g=1", "display_name": "Sinking", "link": "https://stackoverflow.com/users/12299863/sinking"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1572471021, "post_id": 58633815, "comment_id": 103574778, "body": "Oh, ok thanks. And what about all this if-else structure? is there any way to make more compact and smarter?"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1572471093, "post_id": 58633815, "comment_id": 103574802, "body": "I believe the answer below - with the macro - will be your best bet (but do include the characters rather than the number)"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1572471296, "last_edit_date": 1572471296, "creation_date": 1572470882, "answer_id": 58633884, "question_id": 58633815, "link": "https://stackoverflow.com/questions/58633815/how-to-simplify-large-conditional-statement/58633884#58633884", "title": "How to simplify large conditional statement", "body": "<p>Define a macro that encapsulates the comparisons, and then use a single condition with <code>||</code>.</p>\n\n<pre><code>#define MATCH(start, end, ch) (lowch &gt;= start &amp;&amp; lowch &lt;= end &amp;&amp; pattern[ptrch] == ch)\nif (MATCH('a', 'c', '2') || \n    MATCH('d', 'f', '3') || \n    MATCH('g', 'i', '4') || \n    MATCH('j', 'l', '5') || \n    MATCH('m', 'o', '6') ||\n    MATCH('p', 's', '7') ||\n    MATCH('t', 'v', '8') ||\n    MATCH('w', 'z', '9') ||\n    MATCH('+', '+', '0')) {\n    ptrch++;\n    mir++;\n} else {\n    ptrch = 0;\n    mir = 0;\n}\n</code></pre>\n\n<p>Another option would be to use an array of structures.</p>\n\n<pre><code>struct key {\n    char start,\n    char end,\n    char ch\n} keys[] = {\n    {'a', 'c', '2'},\n    {'d', 'e', '2'},\n    ...\n    {'+', '+', '0'}\n};\n\nbool found = false;\nfor (int i = 0; i &lt; sizeof keys/sizeof keys[0]; i++) {\n    if (lowch &gt;= keys[i].start &amp;&amp; lowch &lt;= keys[i].end &amp;&amp; pattern[ptrch] == keys[i].ch) {\n        ptrch++;\n        mir++;\n        found = true;\n        break;\n}\nif (!found) {\n    ptrch = 0;\n    mir = 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1572472202, "post_id": 58634052, "comment_id": 103575161, "body": "Creating a table with 256 entries is hardly overkill. On the contrary, without all the range chacking, the code is much simpler."}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 1, "last_activity_date": 1572471767, "creation_date": 1572471767, "answer_id": 58634052, "question_id": 58633815, "link": "https://stackoverflow.com/questions/58633815/how-to-simplify-large-conditional-statement/58634052#58634052", "title": "How to simplify large conditional statement", "body": "<p>A solution you might consider is to map the letters in an array.</p>\n\n<pre><code>// . . . . . . . . . . abcdefghijklmnopqrstuvwxyz\nconst char* numbers = \"22233344455566677778889999\";\n\nchar digit = (lowch &gt;= 'a' &amp;&amp; lowch &lt;= 'z') ? numbers[lowch - 'a'] : 0;\nif (digit == pattern[ptrch]) {\n    ptrch++;\n    mir++;\n}\nelse if(lowch == '+' &amp;&amp; pattern[ptrch] == '0') {\n    ptrch++;\n    mir++;\n}\nelse {\n    ptrch = mir = 0;\n}\n</code></pre>\n\n<p>Or (slightly overkill) you could build a full table to handle any character...</p>\n\n<pre><code>// Build the table once\nchar dialpad[1 &lt;&lt; CHAR_BIT] = { 0 };\nconst unsigned char *map_from = \"abcdefghijklmnopqrstuvwxyz+\";\nconst char          *map_to   = \"222333444555666777788899990\";\n\nfor (int i = 0; map_from[i]; i++) dialpad[map_from[i]] = map_to[i];\n\n// Later on...\nif (dialpad[(unsigned char)lowch] == pattern[ptrch]) {\n    ptrch++;\n    mir++;\n}\nelse {\n    ptrch = mir = 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 0, "last_activity_date": 1572471790, "creation_date": 1572471790, "answer_id": 58634058, "question_id": 58633815, "link": "https://stackoverflow.com/questions/58633815/how-to-simplify-large-conditional-statement/58634058#58634058", "title": "How to simplify large conditional statement", "body": "<p>All your characters (except the plus sign) are lower-case letters. In ASCII, these letters are in a contiguous range. You can therefore use an array to map lower-case letters to a number code:</p>\n\n<pre><code>//                     abcdefghijklmnopqrstuvwxyz\nconst char code[26] = \"22233344455566677778889999\";\n\nif (lowch &gt;= 'a' &amp;&amp; lowch &lt;= 'z' &amp;&amp; code[lowch - 'a'] == pattern[ptrch]) {\n    ptrch++;\n    mir++;\n} else if (lowch == '+' &amp;&amp; pattern[ptrch] == '0') {\n    ptrch++;\n    mir++;\n} else{\n    ptrch = 0;\n    mir = 0;\n}\n</code></pre>\n\n<p>Before accessing the array, you must check whether <code>lowch</code> is a valid lower-case letter. The plus sign must be treated as special case here. (But you could make the array cover the whole 7-bit ASCII range, where the characters that don't have a umber code have a special value, perhaps <code>'\\0'</code>.)</p>\n"}], "owner": {"reputation": 85, "user_id": 12299863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJqQA.jpg?s=128&g=1", "display_name": "Sinking", "link": "https://stackoverflow.com/users/12299863/sinking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58634058, "answer_count": 3, "score": 0, "last_activity_date": 1572483513, "creation_date": 1572470469, "last_edit_date": 1572483513, "question_id": 58633815, "link": "https://stackoverflow.com/questions/58633815/how-to-simplify-large-conditional-statement", "title": "How to simplify large conditional statement", "body": "<p>This conditional statement compares letters with numbers according to the keyboard of old button-phones.</p>\n\n<p>In this statement, every if-else condition is the same. How can I shorten this piece of code?</p>\n\n<pre><code>//compares every name and pattern character\n//every number represents some letters from latin alphabet\n    if(lowch &gt;= 97 &amp;&amp; lowch &lt;= 99 &amp;&amp; pattern[ptrch] == '2'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch &gt;= 100 &amp;&amp; lowch &lt;= 102 &amp;&amp; pattern[ptrch] == '3'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch &gt;= 103 &amp;&amp; lowch &lt;= 105 &amp;&amp; pattern[ptrch] == '4'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch &gt;= 106 &amp;&amp; lowch &lt;= 108 &amp;&amp; pattern[ptrch] == '5'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch &gt;= 109 &amp;&amp; lowch &lt;= 111 &amp;&amp; pattern[ptrch] == '6'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch &gt;= 112 &amp;&amp; lowch &lt;= 115 &amp;&amp; pattern[ptrch] == '7'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch &gt;= 116 &amp;&amp; lowch &lt;= 118 &amp;&amp; pattern[ptrch] == '8'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch &gt;= 119 &amp;&amp; lowch &lt;= 122 &amp;&amp; pattern[ptrch] == '9'){\n        ptrch++;\n        mir++;\n    }\n    else if(lowch == '+' &amp;&amp; pattern[ptrch] == '0'){\n        ptrch++;\n        mir++;\n    }\n    else{\n        ptrch = 0;\n        mir = 0;\n    }\n}\n</code></pre>\n\n<p>**ptrch- pattern char<br>\n*mir - matches in a row</p>\n"}, {"tags": ["c", "operating-system", "kernel"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572471356, "post_id": 58633806, "comment_id": 103574876, "body": "What happens at the end of <code>main()</code> when control returns to your OS? Please post the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal Reproducible Example</a> of this C code that shows the problem. Not that I&#39;ll easily reproduce the boot, but it will show the <i>exact and complete</i> code that causes the problem, not a combination of snippets and contradictory narrative. For example, you <i>say</i> you use <code>char* message = &quot;message\\0&quot; ;</code> but that is <i>not</i> what the code in <code>main()</code> is."}, {"owner": {"reputation": 417, "user_id": 6039697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9BwlWgnx6Ug/AAAAAAAAAAI/AAAAAAAAAC0/YMeRcs4ZStQ/photo.jpg?sz=128", "display_name": "Michael Pacheco", "link": "https://stackoverflow.com/users/6039697/michael-pacheco"}, "edited": false, "score": 0, "creation_date": 1572471694, "post_id": 58633806, "comment_id": 103574995, "body": "Did you tried to dump memory after calling <code>clear_screen();</code> and before calling <code>video_write(&quot;Message\\0&quot;, 0x0E);</code>? The 4K memory block should be 0x0000. Is there another thread writing to <code>VIDEO_MEMORY</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1572471707, "post_id": 58633806, "comment_id": 103574997, "body": "You don&#39;t need to put <code>\\0</code> at the end of the string. This is done automatically for all string literals."}, {"owner": {"reputation": 417, "user_id": 6039697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9BwlWgnx6Ug/AAAAAAAAAAI/AAAAAAAAAC0/YMeRcs4ZStQ/photo.jpg?sz=128", "display_name": "Michael Pacheco", "link": "https://stackoverflow.com/users/6039697/michael-pacheco"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1572471785, "post_id": 58633806, "comment_id": 103575034, "body": "@Barmar and in complement: string literals must be assigned to const char pointers"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 417, "user_id": 6039697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9BwlWgnx6Ug/AAAAAAAAAAI/AAAAAAAAAC0/YMeRcs4ZStQ/photo.jpg?sz=128", "display_name": "Michael Pacheco", "link": "https://stackoverflow.com/users/6039697/michael-pacheco"}, "edited": false, "score": 1, "creation_date": 1572472060, "post_id": 58633806, "comment_id": 103575112, "body": "@MichaelPacheco C doesn&#39;t require that, only C++ does, although it&#39;s a good idea in C."}, {"owner": {"reputation": 417, "user_id": 6039697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9BwlWgnx6Ug/AAAAAAAAAAI/AAAAAAAAAC0/YMeRcs4ZStQ/photo.jpg?sz=128", "display_name": "Michael Pacheco", "link": "https://stackoverflow.com/users/6039697/michael-pacheco"}, "edited": false, "score": 0, "creation_date": 1572472841, "post_id": 58633806, "comment_id": 103575360, "body": "can you try this code version please? <a href=\"https://codeshare.io/5gW8vV\" rel=\"nofollow noreferrer\">codeshare.io/5gW8vV</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572472997, "post_id": 58633806, "comment_id": 103575413, "body": "Why are you using that type in <code>uint8 i = 0; for(i; i &lt; 4000; i++, c++)</code> ? It&#39;s an infinite loop which will trash your memory."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1572492126, "post_id": 58633806, "comment_id": 103579553, "body": "For what it&#39;s worth; I&#39;d expect &quot;linker and/or loader&quot; problems causing the data to be at a different address to what it should be."}, {"owner": {"reputation": 151, "user_id": 5995844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209041650618340/picture?type=large", "display_name": "Amine Bensalem", "link": "https://stackoverflow.com/users/5995844/amine-bensalem"}, "reply_to_user": {"reputation": 417, "user_id": 6039697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9BwlWgnx6Ug/AAAAAAAAAAI/AAAAAAAAAC0/YMeRcs4ZStQ/photo.jpg?sz=128", "display_name": "Michael Pacheco", "link": "https://stackoverflow.com/users/6039697/michael-pacheco"}, "edited": false, "score": 0, "creation_date": 1572516476, "post_id": 58633806, "comment_id": 103587367, "body": "@MichaelPacheco No other thread , and the dump after clear_screen() shows 0 everywhere. I really think it has something to do with the way the string pointer is set and stored , rather than some artifact already present or previously written on the vid memory ."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 5995844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209041650618340/picture?type=large", "display_name": "Amine Bensalem", "link": "https://stackoverflow.com/users/5995844/amine-bensalem"}, "is_accepted": true, "score": 1, "last_activity_date": 1572517520, "creation_date": 1572517520, "answer_id": 58641284, "question_id": 58633806, "link": "https://stackoverflow.com/questions/58633806/weird-behavior-when-writing-to-0xb8000-corrupted-pointer/58641284#58641284", "title": "Weird behavior when writing to 0xB8000 / corrupted pointer", "body": "<p>EDIT : okay , so I just figured where the problem was , but not really why.\nThe problem is from the compilation and the linking ...\nI compiled previously for 64 bits elf , I just changed to 32 bits compiling/linking everywhere and the text prints correctly without artifacts.</p>\n"}], "owner": {"reputation": 151, "user_id": 5995844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209041650618340/picture?type=large", "display_name": "Amine Bensalem", "link": "https://stackoverflow.com/users/5995844/amine-bensalem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 58641284, "answer_count": 1, "score": 1, "last_activity_date": 1572517520, "creation_date": 1572470423, "last_edit_date": 1572517358, "question_id": 58633806, "link": "https://stackoverflow.com/questions/58633806/weird-behavior-when-writing-to-0xb8000-corrupted-pointer", "title": "Weird behavior when writing to 0xB8000 / corrupted pointer", "body": "<p>I'm currently developing an OS kernel from scratch.\nI want to use a function to write characters on the screen , using the 0xB8000 memory location.<br>\nthe problem is the following :<br>\nI use : </p>\n\n<pre><code>void video_write(const unsigned char *string , char color ){                                                                 \n    unsigned char *p = (unsigned char*) string ;                                                                         \n    char *c = (char*) (VIDEO_MEMORY ); //VIDEO_MEMORY is 0XB8000                                                                                                                                                                                           \n    while(*p != '\\0')                                                                                                    \n    {                                                                                                                    \n            *c = p[0] ;                                                                                                 \n            c++ ;                                                                                                       \n            *c = color ;                                                                                                \n            c++ ;                                                                                                       \n            p++ ;                                                                                                       \n    }                                                                                                                   \n\n\n} \nvoid clear_screen(){                                                                                                                                                               \n    char *c = (char*) VIDEO_MEMORY ;                                                                                                                                                                     \n    int i = 0 ;                                                                                                                                  \n    for(i ; i &lt; 4000 ; i++){                                                                                                                                                       \n            *c='\\0' ;                                                                                                    \n            c++ ;                                                                                                         \n\n    }                                                                                                                    \n\n}    \n</code></pre>\n\n<p>to print to the screen .</p>\n\n<p>The function is called by : </p>\n\n<pre><code>void main(){                                                                                                                                                                       \n\n    clear_screen() ;                                                                                                                             \n    video_write(\"Message\\0\"  ,  0x0E);                                                                                                                                             \n\n}  \n</code></pre>\n\n<p>The OS boots correctly , but upon entering 32 bits PM and printing the message , I get this : </p>\n\n<p><a href=\"https://i.stack.imgur.com/TxKqm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TxKqm.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is one additional character , at the beginning of the string , that I did not put.</p>\n\n<p>When I dump the memory at 0xB8000 , I get this : </p>\n\n<pre><code>00000000: c30e 4d0e 650e 730e 730e 610e 670e 650e  ..M.e.s.s.a.g.e.\n00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................\n00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................\n</code></pre>\n\n<p>4D in Hex is \"M\" . It should be the first character in the string , but it isn't , for god knows what reason. \nInstead the first character is C3 , which is the garbage at the beginning of the string.</p>\n\n<p>Nevertheless , printing these characters directly from the main() function works flawlessly , so my guess is that the pointer of the string got corrupted .</p>\n\n<p>Do you guys have any idea of what's happening there ?</p>\n\n<p>EDIT:\nHere's the Bootloader code : </p>\n\n<pre><code>ifndef BOOT_ASM\n%define BOOT_ASM\n[org 0x7C00]\nKERNEL_OFFSET equ 0x1000\n[bits 16]\n\n    mov [BOOT_DRIVE] , dl\n    mov BP , 0x9000\n    mov SP , BP\n\n    call load_kernel\n    call switch_pm\n\n\n    %include \"print.asm\"\n    %include \"hexprint.asm\"\n    %include \"disk_io.asm\" \n    %include \"GDT.asm\" \n\n\n    load_kernel :\n        mov SI , KERNEL_MSG\n        call print_string\n        mov BX , KERNEL_OFFSET\n        mov DH , 15 \n        mov DL , [BOOT_DRIVE]\n        call disk_load\n        ret\n\n    switch_pm:\n        cli\n        lgdt [gdt_descriptor]\n        mov EAX , CR0\n        or EAX , 1\n        mov CR0 , EAX\n        jmp CODE_SEG:PM_init\n\n    [bits 32]\n    PM_init:\n        mov AX , DATA_SEG\n        mov DS , AX\n        mov SS , AX\n        mov ES , AX\n        mov FS , AX\n        mov GS , AX\n\n        mov EBP , 0x90000\n        mov ESP , EBP\n\n        call BEGIN_PM\n        jmp $\n\n    BEGIN_PM : \n        call KERNEL_OFFSET\n        ret\n\n\n\n    BOOT_DRIVE: db 0\n    RM_MSG db \"SAHARA OS , Real mode\" , 0x0\n    PM_MSG db \"SAHARA OS , Protected mode\" , 0x0\n    KERNEL_MSG db \"SaharaOS : Oasis kernel \" , 0x0A , 0x0D , 0x0\n\n    times 510 - ($-$$) db 0 \n    dw 0xaa55\n\n\n\n    %endif \n</code></pre>\n\n<p>(DATA_SEG is the in the GDT , gdt_data - gdt_start)</p>\n\n<p>At 0x1000 I execute this code , which is the kernel entry</p>\n\n<pre><code>[bits 32]\n[extern main]\n    call main\n    jmp $\n</code></pre>\n\n<p>When dumping the memory after clear_screen() , I only get 0 , so this is working as intended.</p>\n\n<p>I think it's really the string variable that contains this character , because when I do : </p>\n\n<pre><code>void video_write(const unsigned char *string , char color ){                                                                 \nunsigned char *p = (unsigned char*) string ;  \np++ ;                                                                        \nchar *c = (char*) (VIDEO_MEMORY ); //VIDEO_MEMORY is 0XB8000                                                                                                                                                                                           \nwhile(*p != '\\0')                                                                                                    \n{                                                                                                                    \n        *c = *p ;                                                                                                 \n        c++ ;                                                                                                       \n        *c = color ;                                                                                                \n        c++ ;                                                                                                       \n        p++ ;                                                                                                       \n}    \n</code></pre>\n\n<p>adding the \"p++;\" , the message prints without artifacts.\nSo I don't think it's some garbage that was put specifically in 0xB8000. \nOffsetting the video memory so that the message prints in the middle of the screen  for example , gives the same result : \nwhen I offset VIDEO_MEMORY by any value :  </p>\n\n<pre><code>void video_write(const unsigned char *string , char color ){                                                                 \nunsigned char *p = (unsigned char*) string ;                                                                         \nchar *c = (char*) (VIDEO_MEMORY + 1980 ); //VIDEO_MEMORY is 0XB8000                                                                                                                                                                                           \nwhile(*p != '\\0')                                                                                                    \n{                                                                                                                    \n        *c = p[0] ;                                                                                                 \n        c++ ;                                                                                                       \n        *c = color ;                                                                                                \n        c++ ;                                                                                                       \n        p++ ;                                                                                                       \n}     \n</code></pre>\n\n<p>I get this : \n<a href=\"https://i.stack.imgur.com/iTrZg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iTrZg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["python", "c", "ctypes", "python-embedding"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "edited": false, "score": 0, "creation_date": 1572523933, "post_id": 58634269, "comment_id": 103591441, "body": "If I do <code>return byref(msg._as_parameter_)</code> I receive a NULL pointer. It messes things up, guess that&#39;s the GC?"}, {"owner": {"reputation": 61, "user_id": 4539104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02fb74c54978cd5f1a019c544a3749e8?s=128&d=identicon&r=PG", "display_name": "ersteller", "link": "https://stackoverflow.com/users/4539104/ersteller"}, "reply_to_user": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "edited": false, "score": 0, "creation_date": 1572635775, "post_id": 58634269, "comment_id": 103632569, "body": "To prevent GC you need to keep a reference of the object in the python scope but i am not familiar with how memory is handled in python when it is embedded in another application. to be sure and if you have the possibillity you could just allocate it in c. ps: I could not find what that &#39;<i>as_parameter</i>&#39; does but I saw &#39;msg.c_address()&#39; is supposed to return the address in C. i would have to read some of the python docs myself. <a href=\"https://docs.python.org/3/c-api/index.html\" rel=\"nofollow noreferrer\">docs.python.org/3/c-api/index.html</a>"}], "tags": [], "owner": {"reputation": 61, "user_id": 4539104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02fb74c54978cd5f1a019c544a3749e8?s=128&d=identicon&r=PG", "display_name": "ersteller", "link": "https://stackoverflow.com/users/4539104/ersteller"}, "is_accepted": false, "score": 1, "last_activity_date": 1572473165, "creation_date": 1572473165, "answer_id": 58634269, "question_id": 58633540, "link": "https://stackoverflow.com/questions/58633540/return-a-ctypes-c-struct-back-to-c/58634269#58634269", "title": "Return a ctypes C struct back to C", "body": "<p>I would try using <code>return byref(msg)</code> and do some C casting and watch out for garbage-collection. But tbh I am usually calling c from a python process.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "is_accepted": false, "score": 1, "last_activity_date": 1579030427, "creation_date": 1579030427, "answer_id": 59740587, "question_id": 58633540, "link": "https://stackoverflow.com/questions/58633540/return-a-ctypes-c-struct-back-to-c/59740587#59740587", "title": "Return a ctypes C struct back to C", "body": "<p>I'm answering my own question as I was pointed by the python mailinglist to the fact that this question approaches it wrongly. It mixes both the ctypes API and the CPython API. Best is to use one approach. Since to embed Python you need the CPython API best is to use the CPython API to wrap to C methods. That way the when Python returns you'll endup with your own defined Python object in C and can access its internal structure. </p>\n\n<p><a href=\"https://docs.python.org/3/extending/newtypes_tutorial.html\" rel=\"nofollow noreferrer\">This tutorial</a> describes in detail how to wrap a C struct to a Python object.</p>\n"}], "owner": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1579030427, "creation_date": 1572469030, "question_id": 58633540, "link": "https://stackoverflow.com/questions/58633540/return-a-ctypes-c-struct-back-to-c", "title": "Return a ctypes C struct back to C", "body": "<p>I'm trying to wrap my head around the ctypes API. I have a C structure (zmsg_t) I wish to create in Python and then return from Python to C.</p>\n\n<p>So a Python method is called from C and needs to return an object which we then process in C again.</p>\n\n<p>I have a binding to access and create the C methods and structures so in Python I can call the Zmsg() constructor. I now need to return this.</p>\n\n<p>My python test method is simply:</p>\n\n<pre><code>def actor_test(*args, **kwargs):\n    print(\"test\")\n    msg = Zmsg()\n    frame = Zframe(b\"Hello\", 5)\n    msg.prepend(frame)\n    return msg\n</code></pre>\n\n<p>the method is called from C as follows:</p>\n\n<p><code>PyObject *pReturn = PyObject_CallObject(pFunc, NULL);</code></p>\n\n<p>This correctly calls the method. However the returned object is of course a PyObject*. The debugger says it's</p>\n\n<pre><code>\"&lt;czmq._czmq_ctypes.Zmsg object at 0x7ffff5f18e50&gt;\"    PyObject\n            [class]    \"&lt;class 'czmq._czmq_ctypes.Zmsg'&gt;\"   \n            [super class]    \"&lt;class 'object'&gt;\"   \n            [meta type]    \"&lt;class 'type'&gt;\"   \n            ob_refcnt    1    Py_ssize_t\n</code></pre>\n\n<p>How I can I get it back to the original C type (zmsg_t *)</p>\n\n<p>Any help really appreciated.</p>\n\n<p>The ctypes definitions for Zmsg can be seen <a href=\"https://github.com/zeromq/czmq/blob/d6283985ba52fd8c3f8fbdc7cd5c08372ff69ca1/bindings/python/czmq/_czmq_ctypes.py#L4392\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["c", "memcpy"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1572468252, "post_id": 58633342, "comment_id": 103573708, "body": "You need to read about <i>padding</i> in structs."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572468314, "post_id": 58633342, "comment_id": 103573736, "body": "Yes, if you output in hexadecimal <code>%lx</code> it will be easier to see the effect."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1572468687, "post_id": 58633342, "comment_id": 103573896, "body": "See also <a href=\"https://stackoverflow.com/q/3318410/555045\">#pragma pack effect</a>"}], "answers": [{"comments": [{"owner": {"reputation": 753, "user_id": 2840470, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e2dd63f64b42d7ba16f86c029f6bf488?s=128&d=identicon&r=PG&f=1", "display_name": "user2840470", "link": "https://stackoverflow.com/users/2840470/user2840470"}, "edited": false, "score": 0, "creation_date": 1572468583, "post_id": 58633389, "comment_id": 103573848, "body": "Ah that makes sense. Rookie mistake. So im guessing the consesus is dont use memcpy to do this type of operation. Better to manually assign each variable (a = buffer[0], b = buffer[2] &lt;&lt; 8 | bufer[1])"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 753, "user_id": 2840470, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e2dd63f64b42d7ba16f86c029f6bf488?s=128&d=identicon&r=PG&f=1", "display_name": "user2840470", "link": "https://stackoverflow.com/users/2840470/user2840470"}, "edited": false, "score": 0, "creation_date": 1572468787, "post_id": 58633389, "comment_id": 103573950, "body": "That completely depends on what you&#39;re trying to achieve.  It&#39;s very common to read and write a struct from/to a buffer with <code>memcpy</code>.  But you must be careful when making assumptions <i>external</i> to the execution environment (<i>e.g.</i> hard-coding memory contents in code, or reading from a file)"}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "reply_to_user": {"reputation": 753, "user_id": 2840470, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e2dd63f64b42d7ba16f86c029f6bf488?s=128&d=identicon&r=PG&f=1", "display_name": "user2840470", "link": "https://stackoverflow.com/users/2840470/user2840470"}, "edited": false, "score": 0, "creation_date": 1572469776, "post_id": 58633389, "comment_id": 103574341, "body": "@user2840470 Not necessarily. A common pratical use of <i>byte streams</i> memcopied into structs is when you receive network data and payload of N-th level protocol have to be forwarded to (N+1)-th level protocol (for example, IP packet payload is forwarded to TCP). In this cases it&#39;s just a design matter: struct are designed to be <i>packed-data friendly</i>, and PACK/UNPACK macros are always present in porting layers to manage special cases. So the question is: can your struct be changed in order to be <i>packed-data friendly</i>? :) (BTW: +1 for both Q&amp;A. Interesting topic)"}, {"owner": {"reputation": 753, "user_id": 2840470, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e2dd63f64b42d7ba16f86c029f6bf488?s=128&d=identicon&r=PG&f=1", "display_name": "user2840470", "link": "https://stackoverflow.com/users/2840470/user2840470"}, "reply_to_user": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 1, "creation_date": 1572525540, "post_id": 58633389, "comment_id": 103592367, "body": "@Cubo78 That makes sense now why I see structs laid out in certain ways. I can definitely change the order of my struct to better match word boundaries. Thanks for explaining more!"}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 5, "last_activity_date": 1572468583, "last_edit_date": 1572468583, "creation_date": 1572468302, "answer_id": 58633389, "question_id": 58633342, "link": "https://stackoverflow.com/questions/58633342/c-memcpy-to-struct-allocation/58633389#58633389", "title": "C memcpy to struct allocation", "body": "<p>The reason for this is the compiler has added <em>padding</em> to your struct in order to ensure that <code>b</code> is aligned on a 16-bit boundary.  As such, the second byte is unused.</p>\n\n<p>You'll see a much bigger variation if you start re-ordering your struct.  Similarly, the 32-bit and 64-bit values will want an alignment suitable to their type.  So you can end up with significant \"holes\" due to padding.  Try it!</p>\n\n<p>Often you will see structures that have <code>reserved</code> members (particularly for binary formats), instead of relying on padding.</p>\n"}], "owner": {"reputation": 753, "user_id": 2840470, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e2dd63f64b42d7ba16f86c029f6bf488?s=128&d=identicon&r=PG&f=1", "display_name": "user2840470", "link": "https://stackoverflow.com/users/2840470/user2840470"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1572468583, "creation_date": 1572468115, "question_id": 58633342, "link": "https://stackoverflow.com/questions/58633342/c-memcpy-to-struct-allocation", "title": "C memcpy to struct allocation", "body": "<p>I wrote a simple program to test copying bytes from a byte buffer to a structure using memcpy. However I am not getting the results expected. </p>\n\n<p>I allocate a buffer of 100 bytes, and set the values 0, 1, 2...99.\nI then copy the bytes to a structure that is 16 bytes.</p>\n\n<p>Somewhere byte 0x01 gets lost. I am trying to understand what is happening</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nstruct Test {\n\n    uint8_t a;\n    uint16_t b;\n    uint32_t c;\n    uint64_t d;\n    uint8_t e;\n};\n\nint main(int argc, char** argv) {\n\n    uint8_t buffer[100];\n    for (uint8_t i = 0; i &lt; 100; i++) {\n        buffer[i] = i;\n    }\n\n    struct Test test;\n    memcpy(&amp;test, buffer, sizeof(struct Test));\n\n    printf(\"A is %ld and should be %ld\\n\", test.a, 0x00);\n    printf(\"B is %ld and should be %ld\\n\", test.b, 0x0201);\n    printf(\"C is %ld and should be %ld\\n\", test.c, 0x06050403);\n    printf(\"D is %ld and should be %ld\\n\", test.d, 0x1413121110090807);\n    printf(\"E is %ld and should be %ld\\n\", test.e, 0x15);\n}\n</code></pre>\n\n<p>And I get a result of:</p>\n\n<pre><code>A is 0 and should be 0\nB is 770 and should be 513\nC is 117835012 and should be 100992003\nD is 1084818905618843912 and should be 1446519769808832519\nE is 16 and should be 21\n</code></pre>\n\n<p>770 (B value) is bytes 0302, not 0201 (int 513)</p>\n"}, {"tags": ["c", "stack", "dereference"], "answers": [{"tags": [], "owner": {"reputation": 1859, "user_id": 2469776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n2eRk.jpg?s=128&g=1", "display_name": "AirXyg&#232;ne", "link": "https://stackoverflow.com/users/2469776/airxyg%c3%a8ne"}, "is_accepted": false, "score": 0, "last_activity_date": 1572470423, "creation_date": 1572470423, "answer_id": 58633805, "question_id": 58633245, "link": "https://stackoverflow.com/questions/58633245/c-stack-implementation-question-about-dereference-and-double-pointers/58633805#58633805", "title": "C stack implementation. Question about dereference and double pointers", "body": "<p>This is all pretty basic C, so I'll try to be as clear as possible, but I suggest you to carefully read reference books on the topic.</p>\n\n<p>This code defines a structure <code>stackNode</code> which contains some data, and a \"pointer\" to this same structure.</p>\n\n<p>Because <code>stackNode</code> is a structure, when you pass it as a parameter to a function, the compiler creates a copy of it and gives it to the function. This is called \"passing parameter by copy\". Example :</p>\n\n<pre><code>StackNode node;\nfoo(node) ;\n\nvoid foo(StackNode  n) {\n   /* foo() function can use the parameter n which is a local copy of node.\n      you can modify n in the foo() function, that will not modify the node variable */\n}\n</code></pre>\n\n<p>This implies that the function can not modify your original data. It can modify the function's local copy, which is lost at the end of the function.</p>\n\n<p>If you want to modify the given parameter, you must pass the parameter \"by address\" rather than \"by copy\". You do it this way :</p>\n\n<pre><code>StackNode node;\nfoo(&amp;node) ;\n\nvoid foo(StackNode  *n) {\n   /* foo() function accesses the node variable via its address n. (*n) represents\n      the content at address n, which is node. */\n}\n</code></pre>\n\n<p>In this code, the function foo() gets the address of a StackNode (and not a copy of a StackNode). By \"de-referencing\" the address, you can access the content that is \"pointed to\" by the pointer, and therefore modify it \"for real\". \"De-referencing\" is performed by the \"*\" operator, while the \"&amp;\" operator gives the \"reference\" (the address) of a variable.</p>\n\n<p>So now, to your code. I'll answer your questions in a slightly different order, to make it clearer (I think).</p>\n\n<p>What <code>void push(StackNodePtr *topPtr, int info)</code> does is to malloc a new node, make it point to the current topPtr, and then modifies topPtr to point to this new node.</p>\n\n<p>Therefore it modifies topPtr.</p>\n\n<p>Therefore topPtr needs to be passed by reference.</p>\n\n<p>Therefore you need <code>void push(StackNodePtr *topPtr, int info)</code> and not <code>void push(StackNodePtr topPtr, int info)</code></p>\n\n<p>Therefore you need to call it with <code>push(&amp;stackPtr ,value)</code></p>\n\n<p>If you call <code>push(stackPtr ,value)</code>, then :</p>\n\n<ul>\n<li>First of all, your compiler should complain (at least raise a warning)</li>\n<li>You will crash one day or another as you will be modifying unknown zones of memory</li>\n</ul>\n\n<p>You should also now understand why you need <code>(*topPtr) = newPtr</code> instead of <code>topPtr = newPtr</code>. Because you want to modify stackPtr, and you need to de-reference topPtr.</p>\n\n<p>Same in the latter code.</p>\n\n<p>This said, I can think of much easier to implement a stack... ;-)</p>\n"}], "owner": {"reputation": 1, "user_id": 11348887, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--bjnRdDuSm4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4pgqZ1RVbHkoo8GzbxhQ9qJWctA/mo/photo.jpg?sz=128", "display_name": "Arturs Sitdikovs", "link": "https://stackoverflow.com/users/11348887/arturs-sitdikovs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572470423, "creation_date": 1572467590, "last_edit_date": 1572469387, "question_id": 58633245, "link": "https://stackoverflow.com/questions/58633245/c-stack-implementation-question-about-dereference-and-double-pointers", "title": "C stack implementation. Question about dereference and double pointers", "body": "<p>Good day everyone. I am new to C and stack overflow too so go easy on me please :)\nI have few question about this stack code in C:</p>\n\n<p>1) <code>push(&amp;stackPtr, value);</code> why stackPtr has to have &amp; sign ? and what function will get without it?</p>\n\n<p>2) <code>topPtr = newPtr;</code> why topPtr has to be *topPtr ? And what is going on with the code without it?</p>\n\n<p>3) <code>*topPtr = (*topPtr)-&gt;nextPtr;</code> why *topPtr has to have * ? and what gonna be without * sign ?</p>\n\n<p>Thank for any answers in advance. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// self-referential structure                     \nstruct stackNode {                                   \n   int data; // define data as an int             \n   struct stackNode *nextPtr; // stackNode pointer\n};\n\ntypedef struct stackNode StackNode; // synonym for struct stackNode\ntypedef StackNode *StackNodePtr; // synonym for StackNode*\n\n// prototypes\nvoid push(StackNodePtr *topPtr, int info);\nint pop(StackNodePtr *topPtr);\nvoid printStack(StackNodePtr currentPtr);\nvoid instructions(void);\n\n// function main begins program execution\nint main(void)\n{ \n   StackNodePtr stackPtr = NULL; // points to stack top\n   int value; // int input by user\n\n   instructions(); // display the menu\n   printf(\"%s\", \"? \");\n   unsigned int choice; // user's menu choice\n   scanf(\"%u\", &amp;choice);\n\n   // while user does not enter 3\n   while (choice != 3) {\n\n      switch (choice) { \n         // push value onto stack\n         case 1:      \n            printf(\"%s\", \"Enter an integer: \");\n            scanf(\"%d\", &amp;value);\n            push(&amp;stackPtr, value);\n            printStack(stackPtr);\n            break;\n         // pop value off stack\n         case 2:      \n            // if stack is not empty\n            if (stackPtr != NULL) {\n               printf(\"The popped value is %d.\\n\", pop(&amp;stackPtr));\n            }\n\n            printStack(stackPtr);\n            break;\n         default:\n            puts(\"Invalid choice.\\n\");\n            instructions();\n            break;\n      } // end switch\n\n      printf(\"%s\", \"? \");\n      scanf(\"%u\", &amp;choice);\n   }\n\n   puts(\"End of run.\");\n}\n\n// display program instructions to user\nvoid instructions(void)\n{ \n   puts(\"Enter choice:\\n\"\n      \"1 to push a value on the stack\\n\"\n      \"2 to pop a value off the stack\\n\"\n      \"3 to end program\");\n}\n\n// insert a node at the stack top\nvoid push(StackNodePtr *topPtr, int info)\n{ \n   StackNodePtr newPtr = malloc(sizeof(StackNode));\n\n   // insert the node at stack top\n   if (newPtr != NULL) {           \n      newPtr-&gt;data = info;\n      newPtr-&gt;nextPtr = *topPtr;\n      topPtr = newPtr; \n   }                     \n   else { // no space available\n      printf(\"%d not inserted. No memory available.\\n\", info);\n   } \n}\n\n// remove a node from the stack top\nint pop(StackNodePtr *topPtr)\n{ \n   StackNodePtr tempPtr = *topPtr;             \n   int popValue = (*topPtr)-&gt;data;  \n   *topPtr = (*topPtr)-&gt;nextPtr;\n   free(tempPtr);               \n   return popValue;\n}\n\n// print the stack\nvoid printStack(StackNodePtr currentPtr)\n{ \n   // if stack is empty\n   if (currentPtr == NULL) {\n      puts(\"The stack is empty.\\n\");\n   } \n   else { \n      puts(\"The stack is:\");\n\n      // while not the end of the stack\n      while (currentPtr != NULL) { \n         printf(\"%d --&gt; \", currentPtr-&gt;data);\n         currentPtr = currentPtr-&gt;nextPtr;\n      }\n\n      puts(\"NULL\\n\");\n   } \n}\n</code></pre>\n"}, {"tags": ["c", "unix", "scanf", "structure"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1572467651, "post_id": 58633117, "comment_id": 103573436, "body": "Don&#39;t use <code>month[3]</code>.  Use at least <code>month[4]</code>, and pair it with <code>%3s</code> in your <code>sscanf</code> statement."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1572468010, "post_id": 58633117, "comment_id": 103573592, "body": "You have missed out the <code>&amp;</code> before some of the arguments in <code>sscanf(&quot;%s %i %i&quot;, bday.month, bday.day, bday.year);</code>, which should be <code>scanf(&quot;%s %i %i&quot;, bday.month, &amp;bday.day, &amp;bday.year);</code> \u2013 don&#39;t ignore warnings, deal with them."}], "answers": [{"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1572469772, "post_id": 58633275, "comment_id": 103574339, "body": "Also -- check the return value of sscanf to see how many items were scanned successfully.  In this case, if it is less than 3, there was a problem with the input, and <code>bday.year</code> (at least) will still be uninitialized."}], "tags": [], "owner": {"reputation": 2653, "user_id": 3515931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0edddc6a265a0a22058bb2343328d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnH", "link": "https://stackoverflow.com/users/3515931/johnh"}, "is_accepted": false, "score": 2, "last_activity_date": 1572468102, "last_edit_date": 1572468102, "creation_date": 1572467746, "answer_id": 58633275, "question_id": 58633117, "link": "https://stackoverflow.com/questions/58633117/how-do-i-get-sscanf-to-run-in-unix-with-a-structure/58633275#58633275", "title": "How do I get sscanf to run in unix with a structure?", "body": "<p>Make sure month can hold 3 chars plus a null terminator: <code>char month[4];</code></p>\n\n<p>Initialize dob, and a buffer for input:</p>\n\n<pre><code>  char inbuf[80] = {0};\n  dob bday = {0};\n</code></pre>\n\n<p>Don't forget to let the user input some data:</p>\n\n<pre><code>  fgets(inbuf, sizeof(inbuf), stdin);\n</code></pre>\n\n<p>Call sscanf correctly, with an input string to scan before the format string (Note, limiting the string scan to 3 chars to be memory safe), then the addresses of the members you want to modify:</p>\n\n<pre><code>  sscanf(inbuf, \"%3s %i %i\", bday.month, &amp;bday.day, &amp;bday.year);\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 12100738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_pa6kLahGiM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf9-q626vhMeowu96OEW6MT2ei4XA/photo.jpg?sz=128", "display_name": "Jacob", "link": "https://stackoverflow.com/users/12100738/jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572468102, "creation_date": 1572467000, "question_id": 58633117, "link": "https://stackoverflow.com/questions/58633117/how-do-i-get-sscanf-to-run-in-unix-with-a-structure", "title": "How do I get sscanf to run in unix with a structure?", "body": "<p>I'm trying to do as the comments state, however my sscanf statement is not working.  Am I supposed to initialize the variables for dob prior to using sscanf?  My program keeps giving me warnings that they aren't initialized but after running it skips over my sscanf.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// define a structure called  dob  that contains an array for month,\n//    an integer for day, and an integer for year\n\ntypedef struct{\n  char month[3];\n  int day;\n  int year;\n}dob;\n\n\nint main(int argc, char *argv[]) {\n   // declare a variable  bday  whose type is the structure  dob\n   dob bday;\n\n   // show  sscanf() statements to get the values entered at the\n   // command line into the variable  bday if user enters the following:\n   // Jan 31 1967 = input   \n   // ./a.out Jan 31 1967\n\n   sscanf(\"%s %i %i\", bday.month, bday.day, bday.year);\n\n\n   // finish the printf statement below\n   printf(\"Your birthday is: %s %d, %d\\n\",  bday.month, bday.day, bday.year);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 5, "creation_date": 1572467010, "post_id": 58633103, "comment_id": 103573201, "body": "Here: <code>pTunnelMap-&gt;matrix = malloc(height * sizeof(int));</code>, you want to use <code>sizeof(int *)</code>, because each element of the array holds a pointer to int."}, {"owner": {"reputation": 321, "user_id": 4997194, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh5.googleusercontent.com/-aZkMeh-_ZNw/AAAAAAAAAAI/AAAAAAAABIE/PsL2ly0VwJM/photo.jpg?sz=128", "display_name": "Trevor Sears", "link": "https://stackoverflow.com/users/4997194/trevor-sears"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1572467121, "post_id": 58633103, "comment_id": 103573241, "body": "@MOehm Ah! Yes -- thank you! If you want to post that as an answer I would be more than happy to mark it as the accepted answer."}, {"owner": {"reputation": 967, "user_id": 2777674, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/add5585ae61f8f313fceb49205ca64e5?s=128&d=identicon&r=PG&f=1", "display_name": "fvdalcin", "link": "https://stackoverflow.com/users/2777674/fvdalcin"}, "edited": false, "score": 0, "creation_date": 1572467276, "post_id": 58633103, "comment_id": 103573295, "body": "Never forget the memory is addressable in a linear fashion, while the matrix access is two-dimensional. So when you are accessing <code>matrix[i][j]</code> you are actually accessing <code>matrix[i * width + j]</code>"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 967, "user_id": 2777674, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/add5585ae61f8f313fceb49205ca64e5?s=128&d=identicon&r=PG&f=1", "display_name": "fvdalcin", "link": "https://stackoverflow.com/users/2777674/fvdalcin"}, "edited": false, "score": 3, "creation_date": 1572467355, "post_id": 58633103, "comment_id": 103573326, "body": "@fvdalcin: That&#39;s not true. It would be true if you defined the array as <code>int matrix[M][N]</code>, but not when you create the matrix with dynamic allocation like it is done here: <code>matrix</code> is an array of pointers and each pointer holds the handle to an array of integers."}], "owner": {"reputation": 321, "user_id": 4997194, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh5.googleusercontent.com/-aZkMeh-_ZNw/AAAAAAAAAAI/AAAAAAAABIE/PsL2ly0VwJM/photo.jpg?sz=128", "display_name": "Trevor Sears", "link": "https://stackoverflow.com/users/4997194/trevor-sears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1572467036, "creation_date": 1572466925, "last_edit_date": 1572467036, "question_id": 58633103, "link": "https://stackoverflow.com/questions/58633103/first-two-indices-of-array-in-matrix-being-overwritten", "title": "First two indices of array in matrix being overwritten", "body": "<p>I have a struct for a matrix defined as follows:</p>\n\n<pre><code>struct tunnelmap {\n    size_t height;\n    size_t width;\n    int** matrix;\n};\ntypedef struct tunnelmap TunnelMap;\n</code></pre>\n\n<p>And an initialization function as follows:</p>\n\n<pre><code>TunnelMap* createTunnelMap(size_t height, size_t width) {\n    TunnelMap* pTunnelMap = malloc(sizeof(TunnelMap));\n    pTunnelMap-&gt;height = height;\n    pTunnelMap-&gt;width = width;\n    pTunnelMap-&gt;matrix = malloc(height * sizeof(int));\n    for (size_t row = 0; row &lt; height; row++) {\n        pTunnelMap-&gt;matrix[row] = malloc(width * sizeof(int));\n        for (size_t column = 0; column &lt; width; column++) {\n            pTunnelMap-&gt;matrix[row][column] = 1;\n        }\n    }\n    return pTunnelMap;\n}\n</code></pre>\n\n<p>When I initialize a new matrix (i.e. the <code>tunnelmap</code> struct):</p>\n\n<pre><code>TunnelMap* tm = createTunnelMap(5, 7);\n</code></pre>\n\n<p>The first two elements of the first 'row' of the matrix seem to be garbled data, while the rest of the matrix appears to be in order:</p>\n\n<pre><code>printf(\"%d\\n\", tm-&gt;matrix[0][0]); // --&gt; -1016700064\nprintf(\"%d\\n\", tm-&gt;matrix[0][1]); // --&gt; 22063\nprintf(\"%d\\n\", tm-&gt;matrix[0][2]); // --&gt; 1\nprintf(\"%d\\n\", tm-&gt;matrix[0][3]); // --&gt; 1\nprintf(\"%d\\n\", tm-&gt;matrix[1][0]); // --&gt; 1\nprintf(\"%d\\n\", tm-&gt;matrix[2][5]); // --&gt; 1\nprintf(\"%d\\n\", tm-&gt;matrix[3][2]); // --&gt; 1\nprintf(\"%d\\n\", tm-&gt;matrix[4][6]); // --&gt; 1\n</code></pre>\n\n<p>I've properly iterated over the items of the matrix to ensure this is actually the case, and it definitely is. After each run of the program, the <code>[0][0]</code> cell and the <code>[0][1]</code> cell are both seemingly random integers, while all other cells are properly initialized to 1.</p>\n\n<p>Does anyone know what I'm doing wrong? My initial though was that somehow the <code>height</code> and <code>width</code> properties on the <code>tunnelmap</code> struct were somehow causing this issue, but I don't know how to prove that.</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1572466872, "creation_date": 1572466872, "answer_id": 58633094, "question_id": 58633006, "link": "https://stackoverflow.com/questions/58633006/expected-declaration-specifier-error-when-declaring-an-external-stack/58633094#58633094", "title": "expected declaration specifier error , when declaring an external stack", "body": "<p>You can't call functions at top-level in C, you can only have declarations and definitions. Move the call to <code>StackInit()</code> into the <code>main()</code> function.</p>\n\n<pre><code>#include \"stack.h\"\n\nstackT s2;\n\nint main(){\n    stackT s1;\n    StackInit(&amp;s1, 10);\n    StackInit(&amp;s2, 15);\n\n    StackDestroy(&amp;s1);\n    StackDestroy(&amp;s2);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "is_accepted": false, "score": 0, "last_activity_date": 1572472548, "creation_date": 1572472548, "answer_id": 58634179, "question_id": 58633006, "link": "https://stackoverflow.com/questions/58633006/expected-declaration-specifier-error-when-declaring-an-external-stack/58634179#58634179", "title": "expected declaration specifier error , when declaring an external stack", "body": "<p>A function can only be called from another function. Imagine functions call like a tree in which the root node is the main() function.</p>\n\n<p>Anyway, besides moving the initialization inside main(), if you really want the struct variable definition outside main you can statically initialize it, just doing what StackInit() would do: a stackElementT array of size 15, contents field pointing to the first element, and the top index initialized to -1.</p>\n\n<pre><code>#include \"stack.h\"\n\nstackElementT elements[15];\n\nstackT s2 = { elements, -1, 15};\n\nint main(){\n    stackT s1;\n    StackInit(&amp;s1, 10);\n\n    StackDestroy(&amp;s1);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12097515"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 58633094, "answer_count": 2, "score": 2, "last_activity_date": 1572472548, "creation_date": 1572466497, "last_edit_date": 1572467142, "question_id": 58633006, "link": "https://stackoverflow.com/questions/58633006/expected-declaration-specifier-error-when-declaring-an-external-stack", "title": "expected declaration specifier error , when declaring an external stack", "body": "<p>There are three files :</p>\n\n<p>test.c</p>\n\n<pre><code>#include \"stack.h\"\n\nstackT s2;\nStackInit(&amp;s2, 15);\n\nint main(){\n stackT s1;\n StackInit(&amp;s1, 10);\n\n StackDestroy(&amp;s1);\n return 0;\n }\n</code></pre>\n\n<p>stack.h</p>\n\n<pre><code>typedef char stackElementT;\n\ntypedef struct {\n        stackElementT *contents;\n        int top;\n        int maxSize;\n} stackT;\n\nvoid StackInit(stackT *stackP, int maxSize);\nvoid StackDestroy(stackT *stackP);\n</code></pre>\n\n<p>stack.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"stack.h\" \n\nvoid StackInit(stackT *stackP, int maxSize)\n{\n stackElementT *newContents; \n newContents = (stackElementT *)malloc(sizeof(stackElementT) * maxSize);\n\n if (newContents == NULL) {\n        fprintf(stderr, \"Insufficient memory to initialize stack.\\n\");\n        exit(1);\n        }\n stackP-&gt;contents = newContents;\n stackP-&gt;maxSize = maxSize;\n stackP-&gt;top = -1; \n}\n\nvoid StackDestroy(stackT *stackP)\n{\n free(stackP-&gt;contents);\n stackP-&gt;contents = NULL;\n stackP-&gt;maxSize  = 0;\n stackP-&gt;top = -1;\n}\n</code></pre>\n\n<p>I really need to have an external stack and </p>\n\n<pre><code>stackT s2;\nStackInit(&amp;s2, 15);\n</code></pre>\n\n<p>in test.c is my attempt to declare that but compiler gives the following error.</p>\n\n<pre><code>test.c:4:11: error: expected declaration specifiers or \u2018...\u2019 before \u2018&amp;\u2019 token\n StackInit(&amp;s2, 15);\n           ^\ntest.c:4:16: error: expected declaration specifiers or \u2018...\u2019 before numeric constant\n StackInit(&amp;s2, 15);\n                ^~\n</code></pre>\n\n<p>Here is what I have tried:</p>\n\n<ol>\n<li><p>I declared stack s1 inside the main function and didn't get any errors for that.</p></li>\n<li><p>I deleted  <code> #include \"stack.h\"  </code> in test.c and I got\nthe same error for the external stack s2. </p></li>\n</ol>\n\n<p>So my questions are:\nWhat is the error for? How can I declare the external stack without any errors?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1572466395, "post_id": 58632789, "comment_id": 103572971, "body": "In your innermost loops, <code>l + 1</code> may be <code>n</code> or <code>z</code>, which is one beyond te valid range of the arrays. By the way, what happens, if the input <code>n</code> or <code>z</code> are greater than 20?"}, {"owner": {"reputation": 45, "user_id": 12292967, "user_type": "registered", "profile_image": "https://graph.facebook.com/832459576933540/picture?type=large", "display_name": "Omar Ashraf", "link": "https://stackoverflow.com/users/12292967/omar-ashraf"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1572467782, "post_id": 58632789, "comment_id": 103573508, "body": "what you mean by In your innermost loops, l + 1 may be n or z, which is one beyond te valid range of the arrays                                                                                 the &lt;20 is the biggest size of array"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1572467901, "post_id": 58632789, "comment_id": 103573545, "body": "I mean that your loop condition enforces that <code>l &lt; n</code>, so that <code>l</code> can be at most <code>n - 1</code>. When that is the case, <code>l + 1</code> is <code>n</code> and <code>a[l + 1]</code> accesses invalid memory."}, {"owner": {"reputation": 45, "user_id": 12292967, "user_type": "registered", "profile_image": "https://graph.facebook.com/832459576933540/picture?type=large", "display_name": "Omar Ashraf", "link": "https://stackoverflow.com/users/12292967/omar-ashraf"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1572468466, "post_id": 58632789, "comment_id": 103573792, "body": "it works in first loop which eliminate duplicates for array a[n] , but do not work for array b[z]"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1572468873, "post_id": 58632789, "comment_id": 103573982, "body": "There&#39;s also an error when you read the input: <code>scanf(&quot;%d&quot;, &amp;b[z])</code> should be <code>scanf(&quot;%d&quot;, &amp;b[i])</code>. The same error happens when you print the second array. Instead of repeating the same code for the two arrays with different indices, consider writing functions for these tasks. That way you have to fix the errors only in one place."}], "owner": {"reputation": 45, "user_id": 12292967, "user_type": "registered", "profile_image": "https://graph.facebook.com/832459576933540/picture?type=large", "display_name": "Omar Ashraf", "link": "https://stackoverflow.com/users/12292967/omar-ashraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572559398, "creation_date": 1572465489, "last_edit_date": 1572559398, "question_id": 58632789, "link": "https://stackoverflow.com/questions/58632789/in-c-program-which-remove-duplicates-from-an-array-when-i-print-an-array-the-o", "title": "In C program which remove duplicates from an array, when I print an array, the output is not true", "body": "<p>This program which written in C should remove duplicated elements from 2 input arrays by user, so when I print the second array which is <code>b[z]</code> after removing duplicates, the output is not true as it prints weird number instead of the input number by the user. <strong>(the problem in code is determined by comment)</strong>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    int n, z ;\n    printf(\"Enter size of array\\n\");\n    scanf(\"%d\", &amp;n);\n    int a[n];\n    if(n &lt;= 20) {\n        for(int i = 0 ; i &lt; n; i++) {\n            printf(\"Enter integer \\n\");\n            scanf(\"%d\", &amp;a[i]);\n        }\n    }\n    for(int i = 0 ; i &lt; n; i++) {\n        printf(\"%d \", a[i]);\n    }\n    printf(\"\\nEnter size of the 2nd array\\n\");\n    scanf(\"%d\", &amp;z);\n    int b[z];\n    if(z &lt;= 20) {\n        for(int i = 0 ; i &lt; z; i++) {\n            printf(\"Enter integer \\n\");\n            scanf(\"%d\", &amp;b[z]);\n        }\n    }\n    for(int i = 0 ; i &lt; z; i++) {\n        printf(\"%d \", b[z]);\n    }\n    for(int i = 0 ; i &lt; n; i++) {\n        for(int j = i + 1; j &lt; n; j++) {\n            if(a[i] == a[j]) {\n                for(int l = j; l &lt; n; l++)\n                {\n                    a[l] = a[l + 1];\n                }\n                n--;\n                j--;\n            }\n        }\n    }\n    printf(\"\\nArray1: \");\n    for(int i = 0; i &lt; n; i++) {\n        printf(\"%d \", a[i]);\n    }\n\n    for(int t = 0; t &lt; z; t++) {\n        for(int u = t + 1; u &lt; z; u++) {\n            if(b[t] == b[u]) {\n                for(int l = u; l &lt; z; l++)\n                {\n                    b[l] = b[l + 1];\n                }\n                z--;\n                u--;\n            }\n        }\n    }\n    printf(\"\\nArray2: \");\n    for(int e = 0; e &lt; z; e++) {\n        printf(\"%d \", b[e]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "clang", "static-analysis", "clang-static-analyzer"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1572465114, "post_id": 58632685, "comment_id": 103572464, "body": "It warns you because the condition <i>could</i> technically evaluate to true, in which case you dereference a uninitialized pointer."}, {"owner": {"reputation": 53623, "user_id": 732284, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f9ece505f2200d96593bc0630a7d0d3?s=128&d=identicon&r=PG", "display_name": "rid", "link": "https://stackoverflow.com/users/732284/rid"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1572465157, "post_id": 58632685, "comment_id": 103572475, "body": "@tkausl, that makes sense, but I can&#39;t figure out in which conditions this could be true. For whatever value <code>o</code> has, this still won&#39;t be true. And this is the only codepath in the entire program, so neither <code>s</code> nor <code>o</code> can have any other values than the ones in the program. I&#39;m also noticing that removing the <code>(char *)</code> cast makes the warning disappear."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1572465400, "post_id": 58632685, "comment_id": 103572584, "body": "if o is over 4096, then it is UB, then could be true"}, {"owner": {"reputation": 53623, "user_id": 732284, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f9ece505f2200d96593bc0630a7d0d3?s=128&d=identicon&r=PG", "display_name": "rid", "link": "https://stackoverflow.com/users/732284/rid"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1572465435, "post_id": 58632685, "comment_id": 103572600, "body": "@OznOg, but <code>o</code> is an <code>unsigned char</code>, so it can only have values between <code>0</code> and <code>255</code>."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1572465492, "post_id": 58632685, "comment_id": 103572628, "body": "Ok, :)  I guess you expect quite a lot from the compiler :)"}, {"owner": {"reputation": 53623, "user_id": 732284, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f9ece505f2200d96593bc0630a7d0d3?s=128&d=identicon&r=PG", "display_name": "rid", "link": "https://stackoverflow.com/users/732284/rid"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1572465652, "post_id": 58632685, "comment_id": 103572690, "body": "@OznOg, the Clang Static Analyzer did a very good job so far, this is the first time I see something that looks like a false positive. But I could be wrong and there might be something I&#39;m simply not seeing."}, {"owner": {"reputation": 2416, "user_id": 12188799, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x2Us7lDjK_k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbvJBo6jnFH2eAReBMTWM_XkFHSw/photo.jpg?sz=128", "display_name": "Javier Silva Ort&#237;z", "link": "https://stackoverflow.com/users/12188799/javier-silva-ort%c3%adz"}, "edited": false, "score": 0, "creation_date": 1572467926, "post_id": 58632685, "comment_id": 103573553, "body": "Let&#39;s go over it step by step. <code>(char *) (s + o)</code>, reduces to <code>(char *) s</code> since <code>o == 0</code>. Now, <code>(char *)s</code> there&#39;s no way that can be zero, unless the OS memory allocator placed it at absolute 0 memory address, the same goes for only <code>s</code>. There&#39;s a limit with static analyzers, and also keep in mind that the <i>rules</i> for the language varies in accordance to dialect version and compiler."}, {"owner": {"reputation": 53623, "user_id": 732284, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f9ece505f2200d96593bc0630a7d0d3?s=128&d=identicon&r=PG", "display_name": "rid", "link": "https://stackoverflow.com/users/732284/rid"}, "reply_to_user": {"reputation": 2416, "user_id": 12188799, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x2Us7lDjK_k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbvJBo6jnFH2eAReBMTWM_XkFHSw/photo.jpg?sz=128", "display_name": "Javier Silva Ort&#237;z", "link": "https://stackoverflow.com/users/12188799/javier-silva-ort%c3%adz"}, "edited": false, "score": 0, "creation_date": 1572468029, "post_id": 58632685, "comment_id": 103573602, "body": "@JavierSilvaOrt&#237;z, indeed, it looks like a bug to me, especially since removing the cast makes the warning disappear, even though the condition is just as false with or without the cast."}], "answers": [{"tags": [], "owner": {"reputation": 53623, "user_id": 732284, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f9ece505f2200d96593bc0630a7d0d3?s=128&d=identicon&r=PG", "display_name": "rid", "link": "https://stackoverflow.com/users/732284/rid"}, "is_accepted": true, "score": 1, "last_activity_date": 1572468137, "creation_date": 1572468137, "answer_id": 58633350, "question_id": 58632685, "link": "https://stackoverflow.com/questions/58632685/clang-static-analyzer-unexpected-null-pointer-warning/58633350#58633350", "title": "Clang Static Analyzer unexpected NULL pointer warning", "body": "<p>I was testing with the Clang Static Analyzer version 8. Version 10 no longer reports the warning.</p>\n"}], "owner": {"reputation": 53623, "user_id": 732284, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f9ece505f2200d96593bc0630a7d0d3?s=128&d=identicon&r=PG", "display_name": "rid", "link": "https://stackoverflow.com/users/732284/rid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 58633350, "answer_count": 1, "score": 1, "last_activity_date": 1572468137, "creation_date": 1572464959, "last_edit_date": 1572465253, "question_id": 58632685, "link": "https://stackoverflow.com/questions/58632685/clang-static-analyzer-unexpected-null-pointer-warning", "title": "Clang Static Analyzer unexpected NULL pointer warning", "body": "<p>I have the following code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int s[4096];\nunsigned char o = 0;\n\nint main(void) {\n    int *n;\n    return ((char *) (s + o)) == 0 ? *n : 0;\n}\n</code></pre>\n\n<p>When I run the Clang Static Analyzer on that code, it warns me that I'm dereferencing <code>n</code> because <code>(char *) (s + o)</code> is a null pointer, which it's not (I can even print it and get an address that's definitely not zero).</p>\n\n<p>What am I missing?</p>\n\n<p><a href=\"https://i.stack.imgur.com/3NPgM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3NPgM.png\" alt=\"Clang Analyzer screenshot\"></a></p>\n\n<p>I'm noticing that removing the <code>(char *)</code> cast makes the warning disappear.</p>\n"}, {"tags": ["c", "windows", "loops", "collatz"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1572465443, "post_id": 58632670, "comment_id": 103572603, "body": "What&#39;s the purpose of <code>graf</code>? You don&#39;t need an array to print <code>count</code> at signs, just <code>putchar(&#39;@&#39;)</code> or <code>printf(&quot;@&quot;)</code> it in a loop."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1572466027, "post_id": 58632670, "comment_id": 103572822, "body": "Have you tried using a larger data type for the candidate, such as <code>long long int</code>? Starting with around 1,000,000 it doesn&#39;t have to take the path <code>n=(3*n)+1;</code> very many times in succession to break the storage range."}, {"owner": {"reputation": 57, "user_id": 12293801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ed0kCJi2KkY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqDolv03gZmm932OjCOeevCKYw_A/photo.jpg?sz=128", "display_name": "sushiwithoutsushi", "link": "https://stackoverflow.com/users/12293801/sushiwithoutsushi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572466665, "post_id": 58632670, "comment_id": 103573075, "body": "Oh, yes. you are right @WeatherVane. With long long int works. Is there  a way to modify how big can it be or is it limited by default?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572466684, "post_id": 58632670, "comment_id": 103573087, "body": "... and indeed <code>1001063</code> does break the <code>int</code> limit after 149 iterations."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572466866, "post_id": 58632670, "comment_id": 103573156, "body": "Well, you can test if it will break the data type before you do <code>n * 3 + 1</code> by comparing with the maximum value that is safe. For example, with <code>int</code> the maximum safe value is <code>(INT_MAX - 1) &#47; 3</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2804, "user_id": 11652943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qw3Ef.png?s=128&g=1", "display_name": "AbdelAziz AbdelLatef", "link": "https://stackoverflow.com/users/11652943/abdelaziz-abdellatef"}, "is_accepted": false, "score": 0, "last_activity_date": 1572488743, "creation_date": 1572488743, "answer_id": 58636141, "question_id": 58632670, "link": "https://stackoverflow.com/questions/58632670/writing-a-txt-file-while-running-some-calculations/58636141#58636141", "title": "Writing a txt file while running some calculations", "body": "<p>This happened because for <code>number</code> = 113,383 the calculations reach the value of 827,370,449 after 119 counts, the next count max the value 2,482,111,348 which is more than the <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/data-type-ranges?view=vs-2019\" rel=\"nofollow noreferrer\">maximum value of int variable 2,147,483,647</a>, which makes the value of <code>n</code> becomes negative, -1812855948, and the loop fails to reach 1. You should use <code>long long n</code> instead to get the results you want. I also recommend that you use <code>for</code> loop instead of <code>while</code> loop.</p>\n"}], "owner": {"reputation": 57, "user_id": 12293801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ed0kCJi2KkY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reqDolv03gZmm932OjCOeevCKYw_A/photo.jpg?sz=128", "display_name": "sushiwithoutsushi", "link": "https://stackoverflow.com/users/12293801/sushiwithoutsushi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572508634, "creation_date": 1572464887, "last_edit_date": 1572508634, "question_id": 58632670, "link": "https://stackoverflow.com/questions/58632670/writing-a-txt-file-while-running-some-calculations", "title": "Writing a txt file while running some calculations", "body": "<p>I am trying to create a program that outputs in a txt file the results of <a href=\"https://en.wikipedia.org/wiki/Collatz_conjecture\" rel=\"nofollow noreferrer\">Collatz conjecture</a>. However when I try to do it with big numbers, like 1,000,000, it does not work properly and always stops at 113383.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>int n, count, number, mayor, masvueltas, top;\nchar c = '@';\nfreopen(\"output MILLION.txt\", \"w\", stdout);\ncount = 0;\nnumber = 1;\nmayor = 0;\nmasvueltas = 0;\nwhile(number != 1000000) {\n    printf(\"\\n%d did \", number);//this will say that number did COUNT loops\n    n = number;\n    while (n != 1) {\n        if (n % 2 == 0) {\n            n = n / 2;\n            count++;\n        }\n        else {\n            n = 3 * n + 1;\n            count++;\n        }\n    }\n    printf(\" %d saltos.\\n\", count);//Here continoues the sentence\n    char graf[count];//creates an array to print the @ character COUNT times\n    for (int i = 0; i &lt; count; i++) {\n        graf[i] = c;\n        printf(\"%c\", graf[i]);\n    }\n    if(masvueltas &lt; count) {\n        masvueltas = count;\n        mayor = number;\n    }\n    number++;\n    count = 0;\n}\n</code></pre>\n\n<p>Also if you know how to print the ASCII character 219, block, in a txt file it would be great. Is not important just so I have a cleaner txt file.</p>\n"}, {"tags": ["c", "linux", "gcc", "linker", "symbols"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1572464735, "post_id": 58632547, "comment_id": 103572300, "body": "What symbols are exported in both libraries? Compile both libraries to a static (or shared) library and list the symbols and compare. Most probably that <code>&#47;FORCE:MULTIPLE</code> picks one of two symbols - just <code>gcc</code> picks the wrong one, but both approaches are bad. Use <code>objcopy</code> to rename the offending symbol and develop against the renamed symbol. Alternatively, and much simpler, just develop two separate processes, one for each library, and do interprocess communication."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1572472647, "post_id": 58632547, "comment_id": 103575304, "body": "You should show the code. It is probably easier to fix the One Definition Rule (ODR) violations then it is to hack around them. Hacking around them will likely cause obscure errors that are hard to diagnose."}, {"owner": {"reputation": 11, "user_id": 12299385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf528256b6c21dbdb000fd014c4cdda?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Gaffney", "link": "https://stackoverflow.com/users/12299385/sean-gaffney"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1572480051, "post_id": 58632547, "comment_id": 103577204, "body": "@jww I do not have access to the code as these are two pre-built libraries I am linking to. Based on the <a href=\"https://i.gyazo.com/13e685d3c08b7bd6b24f12291c64b341.png\" rel=\"nofollow noreferrer\">errors shown in Visual Studio</a> it looks like <code>_get_time</code> is the offending symbol, but I cannot edit the source code of these libraries, nor am I ever referencing this symbol directly in my own code."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1572521314, "post_id": 58632547, "comment_id": 103590042, "body": "Can you confirm that <b>both</b> libraries contain a function named <code>get_time()</code>? You don&#39;t need to call it in your code, it suffices if a function called from your code calls it. Let the linker create a cross reference to have some insight."}, {"owner": {"reputation": 11, "user_id": 12299385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf528256b6c21dbdb000fd014c4cdda?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Gaffney", "link": "https://stackoverflow.com/users/12299385/sean-gaffney"}, "edited": false, "score": 0, "creation_date": 1572523264, "post_id": 58632547, "comment_id": 103591103, "body": "Unfortunately I cannot confirm that both libraries contain a <code>get_time()</code>. I did a grep on the source code from the azure-iot-sdk git repo and can find references to <code>get_time()</code>, but not a definition. I do not have the source for the other library so I cannot check that. The only reason I think <code>get_time()</code> is the offending function is because of the Visual Studio error."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12299385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf528256b6c21dbdb000fd014c4cdda?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Gaffney", "link": "https://stackoverflow.com/users/12299385/sean-gaffney"}, "is_accepted": true, "score": 0, "last_activity_date": 1572528295, "creation_date": 1572528295, "answer_id": 58644352, "question_id": 58632547, "link": "https://stackoverflow.com/questions/58632547/is-there-a-way-to-force-multiply-defined-symbols-using-gcc-clang-on-linux/58644352#58644352", "title": "Is there a way to force multiply defined symbols using GCC/Clang on Linux?", "body": "<p><strong>I decided to move forward with running two separate processes with inter-process communication to solve this problem.</strong> </p>\n\n<p>While it may have been possible to use another solution like <code>objcopy</code>, since I don't know exactly what's going on in these libraries and don't have the time to familiarize myself with all of Microsoft's source code, it seems the path of least resistance is using two processes. Thanks everything for your help with this and hopefully this thread can help someone in the future. </p>\n"}], "owner": {"reputation": 11, "user_id": 12299385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf528256b6c21dbdb000fd014c4cdda?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Gaffney", "link": "https://stackoverflow.com/users/12299385/sean-gaffney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 58644352, "answer_count": 1, "score": 1, "last_activity_date": 1572528295, "creation_date": 1572464343, "last_edit_date": 1572472579, "question_id": 58632547, "link": "https://stackoverflow.com/questions/58632547/is-there-a-way-to-force-multiply-defined-symbols-using-gcc-clang-on-linux", "title": "Is there a way to force multiply defined symbols using GCC/Clang on Linux?", "body": "<p>I am working with two separate libraries (<a href=\"https://www.ctiplcio.com/\" rel=\"nofollow noreferrer\">PLCIO</a> and <a href=\"https://github.com/Azure/azure-iot-sdk-c\" rel=\"nofollow noreferrer\">azure-iot-sdk-c</a>) on a project. This project is being developed primarily on Windows using Visual Studio, but needs to run on Linux in production. I'm currently using a Ubuntu box to simulate production. When compiling the program in Visual Studio on Windows I get the linker errors <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/tool-errors/linker-tools-error-lnk2005?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev16.query%3FappId%3DDev16IDEF1%26l%3DEN-US%26k%3Dk(LNK2005)%26rd%3Dtrue&amp;view=vs-2019\" rel=\"nofollow noreferrer\">LNK2005</a> and <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/tool-errors/linker-tools-error-lnk1169?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev16.query%3FappId%3DDev16IDEF1%26l%3DEN-US%26k%3Dk(LNK1169)%26rd%3Dtrue&amp;view=vs-2019\" rel=\"nofollow noreferrer\">LNK1169</a>.  I solved this problem by using the <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/force-force-file-output?view=vs-2019\" rel=\"nofollow noreferrer\"><strong>/FORCE:MULTIPLE</strong></a> linker option in Visual Studio. Our app compiles and runs as expected on Windows.</p>\n\n<p><img src=\"https://i.gyazo.com/13e685d3c08b7bd6b24f12291c64b341.png\" alt=\"Visual Studio Linker Errors Screenshot\"></p>\n\n<p>When I port the code and libraries over to my Linux test box, I am using cmake to build and link everything. The project builds and links properly, but when it runs I get an unexpected segmentation fault. I've narrowed it down to an interaction between the two libraries by creating stub programs using one library at a time and confirming that they work as expected. It's only when I put both libraries together that I run into problems. I think it is a fair assumption that the same multiply defined symbols error is causing this seg fault on Linux, it just isn't caught during compile for some reason.</p>\n\n<p>I have tried a whole host of compile and linker flags (using both GCC and Clang) to build this project to try and fix this issue. I have tried <code>-fvisibility=hidden</code> <code>-shared</code> <code>-nostdlib</code>. I found <code>-symbolic</code> in the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html\" rel=\"nofollow noreferrer\">GCC documentation</a>, but am getting a \"option not recognized\" error when I try to use it. I was originally statically linking to pre-built libraries, but have also tried both dynamically linking and also building the azure-iot-sdk myself with the rest of my code. I am getting the same result every time.</p>\n\n<p>Essentially my question comes down to, is there any equivalent of <strong>/FORCE:MULTIPLE</strong> for a Linux tool chain (GCC, Clang, I don't care) that can fix this problem. Or, is there some alternative solution that I have somehow missed in my hours and hours of Googling and troubleshooting?</p>\n"}, {"tags": ["c", "strcat", "lzw"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1572463213, "post_id": 58632319, "comment_id": 103571657, "body": "<i>when I run it on a .jpg (which should in theory work)</i> - no it should not work. <code>jpg</code> files are composed of arbitrary binary data and not from strings. Yet you are using string functions which cannot properly process binary data. As a side note - running LZW on JPG is pointless."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1572464072, "post_id": 58632319, "comment_id": 103572030, "body": "Please don&#39;t use <code>strcpy</code> or <code>strcat</code> in new code. Btw; why is this tagged as C++? It looks more like C - you wouldn&#39;t write it like this in modern C++ <i>ever</i>."}], "owner": {"reputation": 1, "user_id": 8756371, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F0mer98cyGk/AAAAAAAAAAI/AAAAAAAAJ2I/aissuLwVi34/photo.jpg?sz=128", "display_name": "Isaac Audet", "link": "https://stackoverflow.com/users/8756371/isaac-audet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572465684, "creation_date": 1572463102, "last_edit_date": 1572465684, "question_id": 58632319, "link": "https://stackoverflow.com/questions/58632319/incomplete-sequence-when-using-strcat-to-with-char-converted-to-char-array-in", "title": "Incomplete sequence when using strcat() to with char converted to char array in LZW compression", "body": "<p>I have the following code below. It can successfully convert .txt files to LZW compressed files, however, when I run it on a .jpg (which should in theory work). The first char/int it reads is \"255\", then strcat() tries to concatenate k_str to wk on the second loop which should in theory be \"216 or \\330\". Wk_ptr ==   \"\\377\", incomplete sequence \\330 . I'm not sure what the issue is.</p>\n\n<p>Thanks</p>\n\n<pre><code>void encode(FILE *in, FILE *out) {\n    unsigned char w[ENTRYSIZE] = \"\";\n    unsigned char *w_ptr = w;\n    unsigned char wk[ENTRYSIZE] = \"\";\n    unsigned char *wk_ptr;\n    unsigned char k;\n    unsigned char k_str[2];\n    unsigned int c;\n    unsigned int i;\n\n    for (i = 0; i &lt; ASCII; i++) {\n        dict[i][1] = i;\n        dict[i][0] = 1;\n    }\n\n    while ((c = fgetc(in)) != EOF) {\n        k_str[0] = c;\n        k_str[1] = '\\0';\n        w_ptr = w;\n        strcpy(wk, w_ptr);\n        strcat(wk, k_str);\n        wk_ptr = wk;\n\n\n        if (check_dict(wk_ptr, 0) == 1) {\n            strcpy(w, wk_ptr);\n        } else {\n            write12(out, check_dict(w_ptr, 1));\n            add_dict(wk_ptr);\n            k_str[0] = c;\n            k_str[1] = '\\0';\n            strcpy(w, k_str);\n        }\n    }\n    write12(out, check_dict(w_ptr, 1));\n    flush12(out);\n    write12(out, check_dict(w_ptr, 1));\n}\n</code></pre>\n"}, {"tags": ["c", "time", "binary"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1572461193, "post_id": 58631706, "comment_id": 103570867, "body": "Note that memcpy() assumes that the first four bytes of your header and your local machine&#39;s integer have the same endianness. Not knowing the protocol, I can&#39;t say for sure, but most network protocols are big-endian and most machines are little-endian, so that may be an issue. And you don&#39;t tell us which way the last three bytes are either."}, {"owner": {"reputation": 130, "user_id": 7432614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--2ytgbMhDsI/AAAAAAAAAAI/AAAAAAAAAGE/GpuydtIRoHA/photo.jpg?sz=128", "display_name": "Alexander Ryker", "link": "https://stackoverflow.com/users/7432614/alexander-ryker"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1572462247, "post_id": 58631706, "comment_id": 103571269, "body": "Yeah, I wanted to keep the question as short and to-the-point as possible. I&#39;m prepared to deal with the endianness issue."}], "answers": [{"comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1572460543, "post_id": 58631745, "comment_id": 103570576, "body": "@RobertHarvey: You appear to think that this doesn\u2019t answer the question. Could you explain the discrepancy?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1572460753, "post_id": 58631745, "comment_id": 103570669, "body": "@RobertHarvey: I think you may be reading the question differently from how I read the question. If that\u2019s the case, ask for clarification from the OP, I can only speak to my own understanding of the question. And I don\u2019t think I\u2019m just fixating on a bug."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1572460826, "post_id": 58631745, "comment_id": 103570702, "body": "Refresh your page."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1572460999, "post_id": 58631745, "comment_id": 103570781, "body": "What about <code>timespec_get</code> then? It&#39;s in C11 but despite that it seems to exist on windows"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1572461169, "post_id": 58631745, "comment_id": 103570855, "body": "@harold: Thanks, forgot about that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1572461416, "post_id": 58631745, "comment_id": 103570951, "body": "@harold My search of  <code>timespec_get()</code>on C11 failed to find it.  Please provide citation of its C11 existence.  Hmm I do see it in C17: 7.27.2.5 The timespec_get function.  Perhaps my C11 is &quot;drafty&quot;?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1572461711, "post_id": 58631745, "comment_id": 103571057, "body": "@chux Perhaps that&#39;s the one normative change in C17... I always wondered what that was. (I don&#39;t see it either, using N1548)"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1572461775, "post_id": 58631745, "comment_id": 103571084, "body": "@chux <a href=\"https://en.cppreference.com/w/c/chrono/timespec_get\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/chrono/timespec_get</a> lists it as &quot;since C11&quot;, could be that they&#39;re wrong"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1572461824, "post_id": 58631745, "comment_id": 103571109, "body": "I found a number of citations that claim it\u2019s in the C11 standard. In glibc, it appears to be guarded by <code>__USE_ISO_C11</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572461877, "post_id": 58631745, "comment_id": 103571126, "body": "Dietrich Epp  thanks about `timespec_get().  Re: &quot;clock_gettime is not found on Windows.&quot; --&gt; its more of a compiler issue than an OS issue."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1572461881, "post_id": 58631745, "comment_id": 103571128, "body": "C11 standard (ISO/IEC 9899:2011): 7.27.2.5 The timespec_get function (p: 390)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1572462116, "post_id": 58631745, "comment_id": 103571219, "body": "@JL2210 Yes it is in C11 <a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> (the latest C11 draft), but not N1548."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1572462450, "post_id": 58631745, "comment_id": 103571350, "body": "Note: <code>int secs = t.tv_sec;</code> OK until <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\" rel=\"nofollow noreferrer\">2038</a>.  Perhaps <code>unsigned secs = t.tv_sec;</code> if <code>time_t</code> is 64-bit to carry OP through to 2108"}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 4, "last_activity_date": 1572461161, "last_edit_date": 1572461161, "creation_date": 1572460418, "answer_id": 58631745, "question_id": 58631706, "link": "https://stackoverflow.com/questions/58631706/storing-a-timestamp-as-a-binary-fraction-in-c/58631745#58631745", "title": "Storing a Timestamp as a Binary Fraction in C", "body": "<p>The <code>time()</code> function will only give you seconds. You a higher resolution timer.</p>\n\n<pre><code>struct timespec t;\ntimespec_get(&amp;ts, TIME_UTC);\nint secs = t.tv_sec; // Whole seconds\nint frac = ((int64_t)t.tv_nsec &lt;&lt; 24) / 1000000000; // Fractional part.\n</code></pre>\n\n<p>If this is not available you can use <code>clock_gettime</code>, but <code>clock_gettime</code> is not found on Windows.</p>\n"}], "owner": {"reputation": 130, "user_id": 7432614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--2ytgbMhDsI/AAAAAAAAAAI/AAAAAAAAAGE/GpuydtIRoHA/photo.jpg?sz=128", "display_name": "Alexander Ryker", "link": "https://stackoverflow.com/users/7432614/alexander-ryker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58631745, "answer_count": 1, "score": 3, "last_activity_date": 1572461161, "creation_date": 1572460178, "question_id": 58631706, "link": "https://stackoverflow.com/questions/58631706/storing-a-timestamp-as-a-binary-fraction-in-c", "title": "Storing a Timestamp as a Binary Fraction in C", "body": "<p>I'm working on an implementation of an obscure network protocol, and one of the requirements is that each packet header should contain a 56-bit timestamp, with the first 4 bytes containing an integer number of seconds since the epoch, and the remaining 3 bytes used to contain a binary fraction of the current second. In other words, the last 3 bytes should represent the number of 2^-24 seconds since the previous second. The first part of the timestamp is trivial, but I'm struggling to implement the C code that would store the fractional part of the timestamp. Can anyone shed some light on how to do this?</p>\n\n<p>For completeness' sake, here's the timestamp code I have so far. <code>primaryHeader</code> is a <code>char*</code> that I'm using to store the header data for the packet. You can assume that the first 6 bytes in <code>primaryHeader</code> contain valid, unrelated data, and that <code>primaryHeader</code> is large enough to contain everything that needs to be stored in it.</p>\n\n<pre><code>int secs = (int)time(NULL);\nmemcpy(&amp;primaryHeader[7], &amp;secs, sizeof(int));\n// TODO: Compute fractional portion of the timestamp and memcpy to primaryHeader[11]\n</code></pre>\n"}, {"tags": ["c", "gcc", "assembly", "x86", "compiler-optimization"], "comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 6, "creation_date": 1572460652, "post_id": 58631698, "comment_id": 103570617, "body": "<code>x</code> is being passed to the function in the register <code>%edi</code>, not on the stack.  The compiler is creating &quot;local&quot; space on the stack to store it (since it&#39;s not used, a higher optimization level would likely omit it entirely)."}, {"owner": {"reputation": 11225, "user_id": 471129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec5a6cce700294c7c564becb11fa3c1?s=128&d=identicon&r=PG", "display_name": "Erik Eidt", "link": "https://stackoverflow.com/users/471129/erik-eidt"}, "edited": false, "score": 0, "creation_date": 1572461122, "post_id": 58631698, "comment_id": 103570835, "body": "How can you tell that <code>x</code> is below the stack??  It would be the caller that passes <code>x</code>.   By the C code, the callee doesn&#39;t ever touch <code>x</code>."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 3, "creation_date": 1572462323, "post_id": 58631698, "comment_id": 103571296, "body": "&quot;Why not place it at <code>-4(%rbp)</code>?&quot; Sure, why not. But then somebody else would ask, &quot;Why not place it at <code>-20(%rbp)</code>?&quot; It doesn&#39;t matter where it gets placed."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1572462899, "post_id": 58631698, "comment_id": 103571531, "body": "It will be placed where the <a href=\"https://en.wikibooks.org/wiki/X86_Disassembly/Calling_Conventions\" rel=\"nofollow noreferrer\">calling convention</a> says it will be placed."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1572463017, "post_id": 58631698, "comment_id": 103571581, "body": "@WeatherVane: No, here it has nothing to do with calling convention. The calling convention governs how the value arrives to the function, not where the function stores the local variable corresponding to it."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1572463140, "post_id": 58631698, "comment_id": 103571632, "body": "You disabled optimisations.  Clearly, the compiler won&#39;t make optimal choices this way."}, {"owner": {"reputation": 711, "user_id": 5736438, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ba716b39bf6f76b0ffa3c6049b024ac7?s=128&d=identicon&r=PG&f=1", "display_name": "Peter234", "link": "https://stackoverflow.com/users/5736438/peter234"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1572463354, "post_id": 58631698, "comment_id": 103571722, "body": "@JohnBode I know that <code>x</code> is passed in the <code>%edi</code> register. But why save it further down the stack later than really necessary?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1572463651, "post_id": 58631698, "comment_id": 103571839, "body": "In this <a href=\"https://reverseengineering.stackexchange.com/a/14883\">answer</a> on Reverse Engineering there is the paragraph <i>However, on i386 architecture systems, GCC aligns the stack to a 16-byte boundary by default: This means that the compiler allocates 16 bytes of space on the stack frame for variables whose type sizes are less than 16 bytes. For example, even though an int is 4 bytes on an i386 system, the compiler would still allocate 16 bytes of space on the stack frame for it.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1595319860, "last_edit_date": 1595319860, "creation_date": 1572495382, "answer_id": 58636835, "question_id": 58631698, "link": "https://stackoverflow.com/questions/58631698/gcc-placing-register-args-on-the-stack-with-a-gap-below-local-variables/58636835#58636835", "title": "GCC placing register args on the stack with a gap below local variables?", "body": "<p>(First of all, don't expect efficient decisions at <code>-O0</code>.  It turns out that the things you noticed at <code>-O0</code> still happen at <code>-O3</code> if we use <code>volatile</code> or other things to force the compiler to allocate stack space otherwise this question would be a lot less interesting.)</p>\n<blockquote>\n<p>What is the reason that the function parameter x gets placed on the stack below the local variables?</p>\n</blockquote>\n<p>The choice is 100% arbitrary, and depends on compiler internals.  GCC and clang both happen to make that choice, but it's basically irrelevant.  The args arrive in registers and basically <em>are</em> just locals so it's totally up to the compiler to decide where to spill them (or not spill at all, if you enable optimization).</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1102049/order-of-local-variable-allocation-on-the-stack\">Order of local variable allocation on the stack</a> links  <a href=\"ftp://gcc.gnu.org/pub/gcc/summit/2003/Optimal%20Stack%20Slot%20Assignment.pdf\" rel=\"nofollow noreferrer\">ftp://gcc.gnu.org/pub/gcc/summit/2003/Optimal%20Stack%20Slot%20Assignment.pdf</a></li>\n</ul>\n<blockquote>\n<p>But why save it further down the stack later than really necessary?</p>\n</blockquote>\n<p><strong>Because of known(?) GCC missed-optimization bugs leading to wasting stack space.</strong>  For example, <a href=\"https://stackoverflow.com/questions/63009070/why-allocate-more-than-necessary-on-stack\">Why does GCC allocate more space than necessary on the stack?</a> demonstrates x86-64 GCC <code>-O3</code> allocating 24 instead of 8 bytes of stack space, where clang allocates 8.  (I think I've seen a bug report about sometimes using an extra 16 bytes of space when GCC needs to move RSP (unlike here where it's just using the red zone) but can't find it on the GCC bugzilla.)</p>\n<p>Note that the x86-64 System V ABI mandates 16-byte stack alignment before <code>call</code>.  After <code>push %rbp</code> and setting up RBP as a frame pointer, RBP and RSP are 16-byte aligned.  <code>-20(%rbp)</code> is in the same aligned 16-byte chunk of stack space as <code>-8(%rbp)</code> so this gap isn't risking touching a new cache line or page that we wouldn't already have touched.  (A naturally-aligned chunk of memory can't cross any boundary wider than itself, and x86-64 cache lines are always at least 32 bytes; these days always 64 bytes.)</p>\n<p>However, this <em>does</em> become a missed optimization if we add a 2nd arg, <code>int y</code>: gcc5.5 (and current gcc9.2 -O0) spills it to <code>-24(%rbp)</code> which could be in a new cache line.</p>\n<hr />\n<p>It turns out this missed optimization is <em>not</em> just because you used <code>-O0</code> (compile fast, skip most optimization passes, <a href=\"https://stackoverflow.com/questions/53366394/why-does-clang-produce-inefficient-asm-with-o0-for-this-simple-floating-point\">make bad asm</a>).  Finding missed optimizations in <code>-O0</code> output is meaningless unless they're still present at an optimization level anyone cares about, specifically <code>-Os</code>, <code>-O2</code> or <code>-O3</code>.</p>\n<p><strong>We can prove it with code that uses <code>volatile</code> to still make gcc allocate stack space for args/locals at <code>-O3</code></strong>  Another option would have been to pass their address to another function, but then GCC would have to reserve space instead of just using the red-zone below RSP.</p>\n<pre><code>int *volatile sink;\n\nint func(int x, int y) {\n    sink = &amp;x;\n    sink = &amp;y;\n    int z = 1337;\n    sink = &amp;z;\n    return z;\n}\n</code></pre>\n<p>(<a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:%27int+*volatile+sink%3B%0A%0Aint+func(int+x,+int+y)+%7B%0A++++sink+%3D+%26x%3B%0A++++sink+%3D+%26y%3B%0A++++int+z+%3D+1337%3B%0A++++sink+%3D+%26z%3B%0A++++return+z%3B%0A%7D%0A%27),l:%275%27,n:%270%27,o:%27C%2B%2B+source+%231%27,t:%270%27)),k:30.731280228271252,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:g92,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%271%27,libraryCode:%271%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-O3+-fverbose-asm%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+gcc+9.2+(Editor+%231,+Compiler+%231)+C%2B%2B%27,t:%270%27)),k:35.93538643839543,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:clang900,filters:(b:%270%27,binary:%271%27,commentOnly:%270%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%271%27,libraryCode:%271%27,trim:%271%27),lang:c%2B%2B,libs:!(),options:%27-O3+-fverbose-asm%27,source:1),l:%275%27,n:%270%27,o:%27x86-64+clang+9.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B%27,t:%270%27)),k:33.33333333333333,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27)),l:%272%27,n:%270%27,o:%27%27,t:%270%27)),version:4\" rel=\"nofollow noreferrer\"><strong>Godbolt</strong>, gcc9.2</a>)</p>\n<pre><code>gcc9.2 -O3  (hand-edited comments)\nfunc(int, int):\n        leaq    -20(%rsp), %rax                 # &amp;x\n        movq    %rax, sink(%rip)        # tmp84, sink\n        leaq    -24(%rsp), %rax                 # &amp;y\n        movq    %rax, sink(%rip)        # tmp86, sink\n        leaq    -4(%rsp), %rax                  # &amp;z\n        movq    %rax, sink(%rip)        # tmp88, sink\n        movl    $1337, %eax     #,\n        ret     \nsink:\n        .zero   8\n</code></pre>\n<p>Fun fact: clang -O3 spills the stack args before storing their address to <code>sink</code>, like it was a <code>std::atomic</code> release-store of the address and another thread could maybe load their value after getting the pointer from <code>sink</code>.  But it doesn't do that for <code>z</code>.  It's just a missed optimization to actually spill <code>x</code> and <code>y</code> and I can only speculate on what part of clang's internal machinery might be to blame.</p>\n<p>Anyway, clang does allocate <code>z</code> at <code>-4(%rsp)</code>, <code>x</code> at -8, <code>y</code> at <code>-12</code>.  So for whatever reason, <strong>clang also chooses to put the spill slots for the args below the locals.</strong></p>\n<hr />\n<p>Related:</p>\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/35249788/waste-in-memory-allocation-for-local-variables\">Waste in memory allocation for local variables</a> discusses GCC's <code>main</code> not assuming 16-byte alignment on entry to <code>main</code>.</p>\n</li>\n<li><p>several possible duplicates about GCC allocating extra stack space for variables, but mostly just as required by alignment, not extra.</p>\n</li>\n</ul>\n"}], "owner": {"reputation": 711, "user_id": 5736438, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ba716b39bf6f76b0ffa3c6049b024ac7?s=128&d=identicon&r=PG&f=1", "display_name": "Peter234", "link": "https://stackoverflow.com/users/5736438/peter234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 1, "accepted_answer_id": 58636835, "answer_count": 1, "score": 2, "last_activity_date": 1595319860, "creation_date": 1572460146, "last_edit_date": 1572501965, "question_id": 58631698, "link": "https://stackoverflow.com/questions/58631698/gcc-placing-register-args-on-the-stack-with-a-gap-below-local-variables", "title": "GCC placing register args on the stack with a gap below local variables?", "body": "<p>I tried to look at the assembly code for a very simple program.</p>\n\n<pre><code>int func(int x) {\n    int z = 1337;\n    return z;\n} \n</code></pre>\n\n<p>With GCC -O0, every C variable has a memory address that's not optimized away, so gcc spills its register arg:  (<a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;int+func(int+x)+%7B%0A++++int+z+%3D+1337%3B%0A++++return+z%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:46.096920342406875,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g550,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O0+-fverbose-asm&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+5.5+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:53.90307965759314,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">Godbolt, gcc5.5 -O0 -fverbose-asm</a>)</p>\n\n<pre><code>func:\n        pushq   %rbp  #\n        movq    %rsp, %rbp      #,\n        movl    %edi, -20(%rbp) # x, x\n        movl    $1337, -4(%rbp) #, z\n        movl    -4(%rbp), %eax  # z, D.2332\n        popq    %rbp    #\n        ret\n</code></pre>\n\n<p>What is the reason that the function parameter x gets placed on the stack below the local variables?  Why not place it at at <code>-4(%rbp)</code> and the local below that?</p>\n\n<p>And when placing it below the local variables, why not place it at <code>-8(%rbp)</code>?</p>\n\n<p>Why leave a gap, using more of the <a href=\"/questions/tagged/red-zone\" class=\"post-tag\" title=\"show questions tagged &#39;red-zone&#39;\" rel=\"tag\">red-zone</a> than necessary?  Couldn't this touch a new cache line that wouldn't otherwise have been touched in this leaf function?</p>\n"}, {"tags": ["c", "overflow"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 5, "creation_date": 1572460182, "post_id": 58631646, "comment_id": 103570392, "body": "<code>binary</code> is uninitialized when you call <code>strlen</code> on it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1572460636, "post_id": 58631646, "comment_id": 103570609, "body": "Have you noticed the fixed formatting of your code that was done by one of the contributors? Please respect it and don&#39;t break it with your edits. You have also introduced an unbalanced bracket."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12295885, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9de0KxYt8QE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuXXiaTkGvu-QEFuPA5ecfZ-QOoA/photo.jpg?sz=128", "display_name": "Jan Stejskal", "link": "https://stackoverflow.com/users/12295885/jan-stejskal"}, "edited": false, "score": 0, "creation_date": 1572463809, "post_id": 58631860, "comment_id": 103571918, "body": "Tried your suggestion  and it helped me. Thank you very much."}], "tags": [], "owner": {"reputation": 827, "user_id": 11603085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8mXp.jpg?s=128&g=1", "display_name": "Edd Inglis", "link": "https://stackoverflow.com/users/11603085/edd-inglis"}, "is_accepted": true, "score": 0, "last_activity_date": 1572460901, "creation_date": 1572460901, "answer_id": 58631860, "question_id": 58631646, "link": "https://stackoverflow.com/questions/58631646/how-do-i-allocate-the-memory-in-this-function-without-any-segmentation-fault/58631860#58631860", "title": "How do I allocate the memory in this function without any segmentation fault", "body": "<p>As @Christian Gibbons points out in his comment, <code>binary</code> is un-initialised when you call <code>strlen</code> on it.  But what does this mean?</p>\n\n<p><code>strlen</code> walks the array, starting at the first element, counting non-terminating characters.  It doesn't stop until it finds a termination (<code>'\\0'</code>).  If you're unlucky, that can be a long way into the un-initialised data, and likely to be well past the 81 chars you've allocated.  After a while, strlen starts looking at memory it's not allowed to and you get a segmentation fault (your program has explored outside its allocated segment of memory).</p>\n\n<p>You can resolve this in a few ways.  The simplest is:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char binary[81] = { 0 };\n</code></pre>\n\n<p>This asks the compiler to set the first element to zero (the terminating character).  That's good, because it's the first character strlen will see and stop immediately, reporting your string has length 0.</p>\n\n<p>But looking at your algorithm, you could just ditch the call to strlen altogether and do:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>size_t len = 0;\n</code></pre>\n\n<p>But even if you take this approach, it's good practice to initialise your buffers with safe values anyway.</p>\n"}], "owner": {"reputation": 1, "user_id": 12295885, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9de0KxYt8QE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfuXXiaTkGvu-QEFuPA5ecfZ-QOoA/photo.jpg?sz=128", "display_name": "Jan Stejskal", "link": "https://stackoverflow.com/users/12295885/jan-stejskal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58631860, "answer_count": 1, "score": -1, "last_activity_date": 1572467002, "creation_date": 1572459985, "last_edit_date": 1572467002, "question_id": 58631646, "link": "https://stackoverflow.com/questions/58631646/how-do-i-allocate-the-memory-in-this-function-without-any-segmentation-fault", "title": "How do I allocate the memory in this function without any segmentation fault", "body": "<p>When I try to run my programme with this function, I get a segmentation fault, because stack buffer gets overflown. Can somebody help?</p>\n\n<pre><code>void converttobin(int a,  int b, char x) {\n    char binary[81];\n    int number = 0;\n    char bit;\n    char original[81];\n    int dividing = 0;\n    number = a;\n    size_t len = strlen(binary);\n    while (a != 0) {\n        dividing = a % 2;\n        bit = dividing + '0';\n        binary[len++] = bit;\n        binary[len] = '\\0';\n        a = a / 2;\n    }\n    if (number == 0) {\n        a = 0;\n        bit = 0 + '0';\n        binary[len++] = bit;\n        binary[len] = '\\0';\n    }\n    strncpy(original, binary, strlen(original));\n    reverse(binary, number, b);\n    comparing(binary, original,number, b, x);\n    memset(binary, 0, strlen(binary));\n    memset(original, 0, strlen(original));\n}\n</code></pre>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1572458371, "post_id": 58631248, "comment_id": 103569574, "body": "You should call <code>perror()</code> if <code>accept()</code> returns <code>-1</code> to find out why."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1572458380, "post_id": 58631248, "comment_id": 103569577, "body": "Please read <code>man 2 accept</code> and see what kind of  errors it can produce."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5469215, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJyJlQdKNlc/AAAAAAAAAAI/AAAAAAAAACY/-r7CBF4XsFk/photo.jpg?sz=128", "display_name": "comander derp", "link": "https://stackoverflow.com/users/5469215/comander-derp"}, "edited": false, "score": 0, "creation_date": 1572458869, "post_id": 58631292, "comment_id": 103569797, "body": "running perror for the accept I get &quot;Error: : Undefined error: 0&quot; and the same with send..."}], "tags": [], "owner": {"reputation": 1929, "user_id": 2550349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/M3Tx5.jpg?s=128&g=1", "display_name": "ArthurChamz", "link": "https://stackoverflow.com/users/2550349/arthurchamz"}, "is_accepted": false, "score": 1, "last_activity_date": 1572458466, "creation_date": 1572458466, "answer_id": 58631292, "question_id": 58631248, "link": "https://stackoverflow.com/questions/58631248/c-sockets-what-would-cause-the-accept-function-to-return-1/58631292#58631292", "title": "C Sockets: What would cause the accept function to return -1", "body": "<p>If -1 is returned by <a href=\"http://man7.org/linux/man-pages/man2/accept.2.html\" rel=\"nofollow noreferrer\"><code>accept</code></a> or <a href=\"https://linux.die.net/man/2/send\" rel=\"nofollow noreferrer\"><code>send</code></a>, <code>errno</code> is set (<a href=\"https://en.wikipedia.org/wiki/Errno.h\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Errno.h</a>)</p>\n\n<p>After errno is set, call <a href=\"http://man7.org/linux/man-pages/man3/perror.3.html\" rel=\"nofollow noreferrer\"><code>perror</code></a> or <a href=\"http://man7.org/linux/man-pages/man3/strerror.3.html\" rel=\"nofollow noreferrer\"><code>strerror</code></a> to find out more about what happened.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5469215, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJyJlQdKNlc/AAAAAAAAAAI/AAAAAAAAACY/-r7CBF4XsFk/photo.jpg?sz=128", "display_name": "comander derp", "link": "https://stackoverflow.com/users/5469215/comander-derp"}, "edited": false, "score": 0, "creation_date": 1572459379, "post_id": 58631364, "comment_id": 103570030, "body": "after fixing some of the things you pointed out like the size of the header, and checking errno I get &quot;Error: Invalid argument&quot;"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 53, "user_id": 5469215, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJyJlQdKNlc/AAAAAAAAAAI/AAAAAAAAACY/-r7CBF4XsFk/photo.jpg?sz=128", "display_name": "comander derp", "link": "https://stackoverflow.com/users/5469215/comander-derp"}, "edited": false, "score": 1, "creation_date": 1572460419, "post_id": 58631364, "comment_id": 103570508, "body": "@comanderderp: Unfortunately you don&#39;t provide enough code to reproduce your problem. Specifically anything about <code>sock</code> as the only non-constant argument to <code>accept</code> and thus likely the cause of your problem is completely unknown. Please see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">How to create a Minimal, Reproducible Example</a> and make sure that the code you provide make it possible to reproduce you problem and is also minimal."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": false, "score": 2, "last_activity_date": 1572459170, "last_edit_date": 1572459170, "creation_date": 1572458811, "answer_id": 58631364, "question_id": 58631248, "link": "https://stackoverflow.com/questions/58631248/c-sockets-what-would-cause-the-accept-function-to-return-1/58631364#58631364", "title": "C Sockets: What would cause the accept function to return -1", "body": "<blockquote>\n  <p>... and when I try to open it through localhost on a browser it just sits there loading but nothing happens ... </p>\n</blockquote>\n\n<p>This is a different issue than <code>accept</code> returning -1 as claimed in the title. You simply never close the socket and you also don't send a valid HTTP response because you use <code>sizeof(httpHeader)</code> as length to sent. But <code>sizeof(httpHeader)</code> is not the length of the (slightly invalid) header but <code>sizeof(char*)</code>, i.e. you send only 8 bytes (on 64 bit).</p>\n\n<blockquote>\n  <p>C Sockets: What would cause the accept function to return -1</p>\n</blockquote>\n\n<p>Typically this is the case when the server socket is somehow invalid or when the client has closed the socket before <code>accept</code> returned to user space (the connection is done inside the OS kernel). Check the <code>errno</code> for details in your specific case. Note that <code>errno</code> or <code>perror</code> are only useful if <code>accept</code> actually returns -1.</p>\n"}], "owner": {"reputation": 53, "user_id": 5469215, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJyJlQdKNlc/AAAAAAAAAAI/AAAAAAAAACY/-r7CBF4XsFk/photo.jpg?sz=128", "display_name": "comander derp", "link": "https://stackoverflow.com/users/5469215/comander-derp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572459170, "creation_date": 1572458295, "question_id": 58631248, "link": "https://stackoverflow.com/questions/58631248/c-sockets-what-would-cause-the-accept-function-to-return-1", "title": "C Sockets: What would cause the accept function to return -1", "body": "<p>Here is the code.</p>\n\n<pre><code>char *httpHeader = \"HTTP/1.1 200 OK\\r\\n\\n\";\n\n/* poll the server for requests */\nint client;\n\nfor (;;) {\n    client = accept(sock, NULL, NULL);\n\n    if (send(client, httpHeader, sizeof(httpHeader), 0) &lt; 0)\n        perror(\"Error\");\n    else\n        printf (\"packet send done\");\n}\n</code></pre>\n\n<p>I know that that server is running and initialized and when I try to open it through localhost on a browser it just sits there loading but nothing happens....</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "posix", "deadlock"], "comments": [{"owner": {"reputation": 303, "user_id": 116432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d912b8a271d1e37840940db7fe3f9fd9?s=128&d=identicon&r=PG", "display_name": "hager", "link": "https://stackoverflow.com/users/116432/hager"}, "edited": false, "score": 0, "creation_date": 1572457591, "post_id": 58631038, "comment_id": 103569211, "body": "I think you have a copy/paste error: <code>pthread_cond_wait(&amp;t1cond,&amp;myMutex)</code> You&#39;re waiting on the same condition variable in all thread functions."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572457668, "post_id": 58631038, "comment_id": 103569253, "body": "\u27fcThis code could benefit greatly if you adopted an <a href=\"https://en.wikipedia.org/wiki/Indentation_style\" rel=\"nofollow noreferrer\">indentation style</a> and apply it consistently. Indentation conveys structure and intent which makes it easier for us to understand your code without having to invest a lot of time deciphering it."}, {"owner": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "reply_to_user": {"reputation": 303, "user_id": 116432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d912b8a271d1e37840940db7fe3f9fd9?s=128&d=identicon&r=PG", "display_name": "hager", "link": "https://stackoverflow.com/users/116432/hager"}, "edited": false, "score": 0, "creation_date": 1572457798, "post_id": 58631038, "comment_id": 103569309, "body": "@hager Yes I corrected it"}, {"owner": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572457872, "post_id": 58631038, "comment_id": 103569349, "body": "@tadman You are right. Actually I posted in a hurry."}, {"owner": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "edited": false, "score": 0, "creation_date": 1572457914, "post_id": 58631038, "comment_id": 103569370, "body": "You figured out the solution ?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1572458520, "post_id": 58631038, "comment_id": 103569637, "body": "You need to acquire the mutex before calling <code>pthread_cond_wait()</code>. <code>pthread_cond_wait()</code> will release the mutex and acquire it again before it returns successfully."}, {"owner": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1572458747, "post_id": 58631038, "comment_id": 103569738, "body": "@IanAbbott I am sorry I am new to multithreading. How do I do that?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "edited": false, "score": 0, "creation_date": 1572462396, "post_id": 58631665, "comment_id": 103571331, "body": "I have tried it. Now the deadlock is not occurring that frequently but still it occurs. I am adding and removing Items from the linked lists in the while loop."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "edited": false, "score": 0, "creation_date": 1572515721, "post_id": 58631665, "comment_id": 103586985, "body": "@TahaKZed Perhaps the structure of the thread functions is wrong. To me, it looks strange that the only place that waits for the thread&#39;s condition variable (e.g. <code>t1cond</code>) to be set is <i>before</i> the infinite <code>while (1)</code> loop, but the other condition variables (e.g. <code>t2cond</code> and <code>t3cond</code>) are signalled <i>inside</i> the infinite <code>while (1)</code> loop."}, {"owner": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "edited": false, "score": 0, "creation_date": 1572690425, "post_id": 58631665, "comment_id": 103642273, "body": "Yeah. I got it! Thanks!"}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 0, "last_activity_date": 1572460048, "creation_date": 1572460048, "answer_id": 58631665, "question_id": 58631038, "link": "https://stackoverflow.com/questions/58631038/problem-in-communication-of-three-threads-in-c-language-deadlock-occurs/58631665#58631665", "title": "Problem in communication of three threads in C language (deadlock occurs)", "body": "<p>The mutex used by <code>pthread_cond_wait()</code> needs to locked before the function is called. Here is an extract from the man page:</p>\n\n<blockquote>\n  <p>The <code>pthread_cond_timedwait()</code> and <code>pthread_cond_wait()</code> functions shall block  on a condition variable. The application shall ensure that these functions are called with mutex locked by the  calling  thread; otherwise, an error (for PTHREAD_MUTEX_ERRORCHECK and robust mutexes) or undefined behavior (for other mutexes) results.</p>\n</blockquote>\n\n<p>Although <code>pthread_cond_wait()</code> unlocks the mutex internally, it is locked again before the function returns successfully:</p>\n\n<blockquote>\n  <p>Upon successful return, the mutex shall have been locked and shall be        owned by the calling thread.</p>\n</blockquote>\n\n<p>Additionally, you should access the shared variables <code>var1InUse</code>, <code>var2InUse</code> and <code>var3InUse</code> with the mutex locked.</p>\n\n<p>Here is a modified version of your <code>thread1()</code> that follows these rules. The modifications to the other thread start routines should be similar:</p>\n\n<pre><code>void* thread1(void* args){\n\n    pthread_mutex_lock(&amp;myMutex);\n\n    while(var1InUse || var2InUse ) {\n         pthread_cond_wait(&amp;t1cond,&amp;myMutex);\n    }\n    var1InUse=1,var2InUse=1;\n\n    pthread_mutex_unlock(&amp;myMutex);\n\n    while(1){\n\n        pthread_mutex_lock(&amp;myMutex);\n        /*\n        some other code about adding and removing from linkedlist\n        */\n        var1InUse=0,var2InUse=0;\n        pthread_cond_signal(&amp;t2cond);\n        pthread_cond_signal(&amp;t3cond);\n        pthread_mutex_unlock(&amp;myMutex);\n    }\n    return NULL;\n}\n</code></pre>\n\n<p>(I'm not entirely sure that the above is correct, because it's not entirely clear from the original code what the <code>while(1)</code> loop is supposed to do.)</p>\n"}], "owner": {"reputation": 27, "user_id": 10290547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c78da1c540c280dfc3288872d4af436?s=128&d=identicon&r=PG&f=1", "display_name": "TahaKZed", "link": "https://stackoverflow.com/users/10290547/tahakzed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58631665, "answer_count": 1, "score": 0, "last_activity_date": 1572460048, "creation_date": 1572457453, "last_edit_date": 1572457749, "question_id": 58631038, "link": "https://stackoverflow.com/questions/58631038/problem-in-communication-of-three-threads-in-c-language-deadlock-occurs", "title": "Problem in communication of three threads in C language (deadlock occurs)", "body": "<p>I am creating a program in which i have 3 linked lists and I am trying to update or remove the nodes from these linked lists in these three threads. But the deadlock is occurring</p>\n\n<p>The insertion and deletion is working fine. Here the three variables var1InUse,var2InUse and var3InUse are indicating that whether the 3 linked lists are in use or not(Not all three are use in the all threads). I am putting the threads on waiting based on var1InUse,var2InUse and var3InUse as you can see in the code. Sometimes this works fine but sometimes deadlock happens. I have searched for the solution on the internet but could find it.\nAm I using the wait and signal methods correctly?</p>\n\n<pre><code>    pthread variables declaration\n\n    pthread_mutex_t myMutex = PTHREAD_MUTEX_INITIALIZER;\n\n     pthread_cond_t t1cond = PTHREAD_COND_INITIALIZER;\n\n     pthread_cond_t t2cond = PTHREAD_COND_INITIALIZER;  \n\n     pthread_cond_t t3cond = PTHREAD_COND_INITIALIZER;\n\n    int var1InUse=0,var2InUse=0,var3InUse=0;\n</code></pre>\n\n<p>THREAD 1</p>\n\n<pre><code>    void* thread1(void* args){\n        while(var1InUse || var2InUse ) {\n                pthread_cond_wait(&amp;t1cond,&amp;myMutex);}\n        var1InUse=1,var2InUse=1;\n        while(1){\n\n                pthread_mutex_lock(&amp;myMutex);\n                /*\n                some other code about adding and removing from                         \n                       linkedlist\n                */\n        var1InUse=0,var2InUse=0;\n        pthread_cond_signal(&amp;t2cond);\n        pthread_cond_signal(&amp;t3cond);\n        pthread_mutex_unlock(&amp;myMutex);}\n     }\n</code></pre>\n\n<p>THREAD 2</p>\n\n<pre><code>    void* thread2(void* args){\n        while(var1InUse || var2InUse || var3InUse) {\n                pthread_cond_wait(&amp;t2cond,&amp;myMutex);}\n        var1InUse=1,var2InUse=1,var3InUse=1;\n        while(1){\n\n                pthread_mutex_lock(&amp;myMutex);\n                /*\n                some other code adding and removing from linkedlist\n                */\n                var1InUse=0,var2InUse=0,var3InUse=0;\n                pthread_cond_signal(&amp;t1cond);\n                pthread_cond_signal(&amp;t3cond);\n                pthread_mutex_unlock(&amp;myMutex);}\n                    }\n</code></pre>\n\n<p>THREAD 3</p>\n\n<pre><code>     void* thread3(void* args){\n        while(var1InUse || var3InUse ) {\n                pthread_cond_wait(&amp;t3cond,&amp;myMutex);}\n        var1InUse=1,var3InUse=1;\n        while(1){\n\n                pthread_mutex_lock(&amp;myMutex);\n                /*\n                some other code adding and removing from linkedlist\n                */\n        var1InUse=0,var3InUse=0;\n        pthread_cond_signal(&amp;t1cond);\n        pthread_cond_signal(&amp;t2cond);\n        pthread_mutex_unlock(&amp;myMutex);}\n            }\n</code></pre>\n\n<p>MAIN METHOD</p>\n\n<pre><code>    int main(){\n        pthread_t t1,t2,t3,t4;\n        pthread_mutex_init(&amp;myMutex,0);\n        pthread_create(&amp;t1,NULL,thread1,NULL);\n        pthread_create(&amp;t2,NULL,thread2,NULL);\n        pthread_create(&amp;t3,NULL,thread3,NULL);\n        pthread_join(t1,NULL); \n        pthread_join(t2,NULL);\n            pthread_join(t3,NULL);\n        pthread_mutex_destroy(&amp;myMutex);\n        return 0\n            }\n</code></pre>\n\n<p>I want the deadlock to be removed.</p>\n"}, {"tags": ["c", "gcc", "optimization"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1572457161, "post_id": 58630922, "comment_id": 103569009, "body": "Tip: Check the compiler assembly output and find out. Most compilers are a lot smarter than you&#39;d think, especially with optimization turned on."}], "answers": [{"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1572470543, "post_id": 58630999, "comment_id": 103574610, "body": "People often use comments like <code>&#47;****************&#47;</code> or <code>&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;&#47;</code> to separate sections of their program.  It had never occurred to me that one might use <code>;;;;;;;;;;;;;;;;;;;;;;</code> as well."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1572473638, "post_id": 58630999, "comment_id": 103575614, "body": "@SteveSummit it actually is much better than ///// or similar comments, because the compiler ignores comments but will detect typos in code :p"}], "tags": [], "owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": true, "score": 4, "last_activity_date": 1572457648, "last_edit_date": 1572457648, "creation_date": 1572457318, "answer_id": 58630999, "question_id": 58630922, "link": "https://stackoverflow.com/questions/58630922/null-statement-execution-time-in-c/58630999#58630999", "title": "Null statement execution time in C", "body": "<p>Compilers only care about observable behaviour. Whether you compile </p>\n\n<pre><code>int main() {\n   ;;;;;;;;;;;;;;;;;;\n   return 0;\n}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>int main() {\n    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n    return 0;\n}\n</code></pre>\n\n<p>does not make any difference regarding the resulting executable. The observable behaviour of both examples is the same. </p>\n\n<p>If you want to convince yourself, look at the compilers output (this is a great tool: <a href=\"https://godbolt.org/z/bnbxiP\" rel=\"nofollow noreferrer\">https://godbolt.org/z/bnbxiP</a>) or try to profile the above examples (but dont expect to get meaningful numbers ;).</p>\n\n<p>My suggestion is to not think about code as a way to talk to your cpu. When you write code you are not expressing instructions for your cpu. Code is rather a recipe for the compiler and your compiler knows much better how to intruct the cpu than any human. Small difference but I think it helps.</p>\n"}], "owner": {"reputation": 35, "user_id": 4160770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XaoYBWzII-0/AAAAAAAAAAI/AAAAAAAABP8/P5KhWpEOhSY/photo.jpg?sz=128", "display_name": "afzal pasha", "link": "https://stackoverflow.com/users/4160770/afzal-pasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 58630999, "answer_count": 1, "score": 0, "last_activity_date": 1572457648, "creation_date": 1572457038, "last_edit_date": 1572457117, "question_id": 58630922, "link": "https://stackoverflow.com/questions/58630922/null-statement-execution-time-in-c", "title": "Null statement execution time in C", "body": "<p>How does the compiler interpret null statements in C? In terms of execution time. ( empty \";\" i.e., without any expression)\nAnd will it optimize code during execution if it encounters null statements,  by removing them.</p>\n"}, {"tags": ["c", "data-structures", "stack"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1572457061, "post_id": 58630919, "comment_id": 103568970, "body": "Why one character is named as word (char word;)?:)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572457466, "post_id": 58630919, "comment_id": 103569147, "body": "@tadman In the function declaration there is already used a pointer to pointer Stack* ptr For example consider the statement *ptr = node;"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1572457577, "post_id": 58630919, "comment_id": 103569203, "body": "@VladfromMoscow If <code>Stack</code> itself is a pointer type that&#39;s really obnoxious. Types should be more explicit about their nature."}, {"owner": {"reputation": 11, "user_id": 8108118, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457468444298426/picture?type=large", "display_name": "Lelre Ferreira", "link": "https://stackoverflow.com/users/8108118/lelre-ferreira"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1572459579, "post_id": 58630919, "comment_id": 103570111, "body": "@VladfromMoscow It&#39;s part of the assigment. I have to deal with that char. I&#39;m suppose the make the code work using char instead of struct student data; But I have no idea how to do so..."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 11714718, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KtrBXH5MuNs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdW7iGTUyd2plJ8adG-cDTDi0xv6A/photo.jpg?sz=128", "display_name": "Robin Schwendele", "link": "https://stackoverflow.com/users/11714718/robin-schwendele"}, "is_accepted": false, "score": 0, "last_activity_date": 1572478535, "creation_date": 1572478535, "answer_id": 58635033, "question_id": 58630919, "link": "https://stackoverflow.com/questions/58630919/how-to-implement-stack-using-char-as-argument/58635033#58635033", "title": "How to implement Stack using Char as argument?", "body": "<p>Have you tried to replace <code>struct student</code> by <code>char</code>?<br>\nOf course in the function header, but also in the <code>Elemn</code> class. </p>\n"}], "owner": {"reputation": 11, "user_id": 8108118, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457468444298426/picture?type=large", "display_name": "Lelre Ferreira", "link": "https://stackoverflow.com/users/8108118/lelre-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572478535, "creation_date": 1572457011, "question_id": 58630919, "link": "https://stackoverflow.com/questions/58630919/how-to-implement-stack-using-char-as-argument", "title": "How to implement Stack using Char as argument?", "body": "<p>I have this assignment where I have to implement a stack to work with the following struct given by my professor. As you know I don't know how to implement a stack using the following struct.</p>\n\n<pre><code>struct elements{\n     char word;\n     struct elements *next;\n}\n</code></pre>\n\n<p>I do know how to do that using the struct below...</p>\n\n<pre><code>struct elements{\n     struct student data;\n     struct elements *next;\n}\n</code></pre>\n\n<p>To insert the data into the stack I'd use... I know dat the code below is correct. I do understand what is happening there. But I cannot see how I can do that using <code>char word</code> instead of          <code>struct student data;</code> Someone could explain it to me? I'm not getting the idea.</p>\n\n<pre><code>int pushStack(Stack* ptr, struct student info){\n    Elemn* node = (Elemn*)malloc(sizeof(Elemn);\n\n    if(node == NULL &amp;&amp; ptr == NULL){\n    printf(\"error.\");\n    return 0;\n    }\n\n    node-&gt;student = info;\n    node-&gt;next = (*ptr);\n    *ptr = node;\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "malloc", "valgrind"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1572649349, "post_id": 58630535, "comment_id": 103636516, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/201745/discussion-on-question-by-atomicnicos-malloc-within-if-statement-assigned-onl\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 11519728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bccc8b0d2b4ddab8486e9eb1f014486?s=128&d=identicon&r=PG&f=1", "display_name": "AtomicNicos", "link": "https://stackoverflow.com/users/11519728/atomicnicos"}, "edited": false, "score": 0, "creation_date": 1572471529, "post_id": 58630615, "comment_id": 103574944, "body": "Doesn&#39;t change anything since the deallocation happens in when the node is deallocated."}, {"owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "reply_to_user": {"reputation": 81, "user_id": 11519728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bccc8b0d2b4ddab8486e9eb1f014486?s=128&d=identicon&r=PG&f=1", "display_name": "AtomicNicos", "link": "https://stackoverflow.com/users/11519728/atomicnicos"}, "edited": false, "score": 0, "creation_date": 1572471738, "post_id": 58630615, "comment_id": 103575013, "body": "You&#39;re stepping through from <code>files[0]</code> to <code>files[count-1]</code> and freeing each block?"}, {"owner": {"reputation": 81, "user_id": 11519728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bccc8b0d2b4ddab8486e9eb1f014486?s=128&d=identicon&r=PG&f=1", "display_name": "AtomicNicos", "link": "https://stackoverflow.com/users/11519728/atomicnicos"}, "edited": false, "score": 0, "creation_date": 1572472375, "post_id": 58630615, "comment_id": 103575219, "body": "Actually I was looking in the wrong place, I do manually free each block later."}], "tags": [], "owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "is_accepted": false, "score": 2, "last_activity_date": 1572455730, "creation_date": 1572455730, "answer_id": 58630615, "question_id": 58630535, "link": "https://stackoverflow.com/questions/58630535/malloc-within-if-statement-assigned-only-if-if-is-entered-but-valgrind-says/58630615#58630615", "title": "malloc() within if statement, assigned only if (if) is entered but valgrind says that bytes are lost", "body": "<p>If you conditionally allocate memory, you've got to <code>free</code> it, as well. Intuitively, one might assume they need to check if the memory is allocated before trying to free it, but luckily, the C standard has us covered.</p>\n\n<p>You can shortcut your way around some code by setting the file pointer to <code>NULL</code> outside the loop (or in an <code>else</code> statement), and then calling <code>free()</code> later in the code, once you know you won't be using the memory anymore. You don't need to check if the pointer has been allocated, since <a href=\"https://stackoverflow.com/a/1938758/7431860\"><code>free(NULL)</code> is a perfectly legal no-op.</a></p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 11519728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bccc8b0d2b4ddab8486e9eb1f014486?s=128&d=identicon&r=PG&f=1", "display_name": "AtomicNicos", "link": "https://stackoverflow.com/users/11519728/atomicnicos"}, "edited": false, "score": 0, "creation_date": 1572621817, "post_id": 58659949, "comment_id": 103626533, "body": "This works with a few amends except for <code>node-&gt;info.st_ino</code> being initialized within <code>getChildren(...)</code> (needs to be declared initialized pre if, and remove the initialisation within <code>getChildren(...)</code> and pass the status of this initialisation down in the function call)."}, {"owner": {"reputation": 81, "user_id": 11519728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bccc8b0d2b4ddab8486e9eb1f014486?s=128&d=identicon&r=PG&f=1", "display_name": "AtomicNicos", "link": "https://stackoverflow.com/users/11519728/atomicnicos"}, "edited": false, "score": 0, "creation_date": 1572651626, "post_id": 58659949, "comment_id": 103636916, "body": "I&#39;ll accept this as this answer gives the source of the problem. A less complicated work around using the same logic will be added to the main question. Thanks again"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1572614514, "creation_date": 1572614514, "answer_id": 58659949, "question_id": 58630535, "link": "https://stackoverflow.com/questions/58630535/malloc-within-if-statement-assigned-only-if-if-is-entered-but-valgrind-says/58659949#58659949", "title": "malloc() within if statement, assigned only if (if) is entered but valgrind says that bytes are lost", "body": "<p>The problem is here in <code>createNode</code>:</p>\n\n<pre><code>struct stat *info = malloc(sizeof(struct stat));\nlstat(filename, info);\nif (S_ISLNK(info-&gt;st_mode) == 1) {\n    getChildren(node-&gt;path[1], &amp;node-&gt;info, files, &amp;node-&gt;numberOfChildren);\n} else {\n    getChildren(node-&gt;path[0], &amp;node-&gt;info, files, &amp;node-&gt;numberOfChildren);\n}\nfree(info);\n\nnode-&gt;children = malloc((1 + node-&gt;numberOfChildren) * sizeof(Object*));\nnode-&gt;children[0] = (struct Object*) parent;\n\nif (rippleCycleCheckUpwards((Object*) parent, node-&gt;info.st_ino) == 1) {\n    node-&gt;numberOfChildren = 0;\n}\n</code></pre>\n\n<p>You first get the list of children which are stored in <code>files</code>.  You then do the cycle check, and if you find a cycle you set <code>node-&gt;numberOfChildren</code> to 0.  This prevents you from entering the loop that follows where the entries of <code>files</code> are freed.  So if you have a cycle you have a memory leak.</p>\n\n<p>You can fix this by doing the cycle check first, then decending into the children if you don't find a cycle:</p>\n\n<pre><code>if (rippleCycleCheckUpwards((Object*) parent, node-&gt;info.st_ino) == 1) {\n    node-&gt;numberOfChildren = 0;\n} else {\n    struct stat *info = malloc(sizeof(struct stat));\n    lstat(filename, info);\n    if (S_ISLNK(info-&gt;st_mode) == 1) {\n        getChildren(node-&gt;path[1], &amp;node-&gt;info, files, &amp;node-&gt;numberOfChildren);\n    } else {\n        getChildren(node-&gt;path[0], &amp;node-&gt;info, files, &amp;node-&gt;numberOfChildren);\n    }\n    free(info);\n}\n\nnode-&gt;children = malloc((1 + node-&gt;numberOfChildren) * sizeof(Object*));\nnode-&gt;children[0] = (struct Object*) parent;\n</code></pre>\n\n<p>Besides this, valgrind also shows several errors on reading uninitialized values, but I'll leave fixing those as an exercise to the reader.</p>\n"}], "owner": {"reputation": 81, "user_id": 11519728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bccc8b0d2b4ddab8486e9eb1f014486?s=128&d=identicon&r=PG&f=1", "display_name": "AtomicNicos", "link": "https://stackoverflow.com/users/11519728/atomicnicos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 58659949, "answer_count": 2, "score": -1, "last_activity_date": 1572651965, "creation_date": 1572455379, "last_edit_date": 1592644375, "question_id": 58630535, "link": "https://stackoverflow.com/questions/58630535/malloc-within-if-statement-assigned-only-if-if-is-entered-but-valgrind-says", "title": "malloc() within if statement, assigned only if (if) is entered but valgrind says that bytes are lost", "body": "<p>In the context of an assignment using C, where I have to create a <code>li</code> clone, I am trying to access all of the names of the child files in my directory.</p>\n<p>By popular demand, here is the minimum code to reproduce this problem (please consider removing your downvotes...) (I wasn't kidding when I said it was a lot).</p>\n<p>To start, have this file structure somewhere (.txt files have keyboard juggling) :</p>\n<pre><code>var\n\u251c\u2500\u2500 file1.txt\n\u2514\u2500\u2500 var2\n    \u251c\u2500\u2500 test -&gt; ../../test\n    \u251c\u2500\u2500 var3\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 file2.txt\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n    \u2514\u2500\u2500 varfind -&gt; ../\n\n4 directories, 3 files\n</code></pre>\n<p>Code to reproduce\n<code>main.c</code></p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &quot;helpers.h&quot;\n\nint main(int argc, char **argv) {\n    char *destination = malloc(sizeof(char[THEORETICAL_MAX_PATH_LENGTH])); \n    switch (argc) {\n        case 1: // (== Error case)\n            fprintf(stderr, &quot;Usage: %s file\\n&quot;, argv[0]);\n            exit(EXIT_FAILURE);\n            break;\n        case 2: // (== List)\n            stripSlash(argv[argc - 1], destination);\n            Object* obj =  createNode(destination, NULL);\n            freeNode(obj);\n            break;\n        default:\n            exit(0);\n            break;\n    }\n    free(destination);\n}\n</code></pre>\n<p><code>helpers.h</code></p>\n<pre class=\"lang-c prettyprint-override\"><code>#ifndef HEADER_UTILITIES\n#define HEADER_UTILITIES\n#define THEORETICAL_MAX_PATH_LENGTH 4096\n\n#include &lt;sys/stat.h&gt;\n\ntypedef struct {\n    int numberOfChildren;\n    char path[2][THEORETICAL_MAX_PATH_LENGTH];\n    struct stat info;\n    struct Object **children; // child[0] is parent.\n} Object;\n\nvoid stripSlash(char arg[], char *filename);\n\nvoid freeNode(Object *node);\nObject * createNode(const char *filename, Object *parent);\n\n#endif\n</code></pre>\n<p><code>helpers.c</code></p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;dirent.h&gt;\n#include &quot;helpers.h&quot;\n\nvoid stripSlash(char arg[], char *filename) {\n    strncpy(filename, arg, THEORETICAL_MAX_PATH_LENGTH);\n    if (filename[strlen(filename) - 1] == '/')\n        filename[strlen(filename) - 1] = '\\0';\n}\n\nvoid getChildren(const char *path, struct stat* statBuffer, char *files[THEORETICAL_MAX_PATH_LENGTH], int *numberOfFiles) {\n    int count = 0;\n    struct dirent *currentDir;\n    if (lstat(path, statBuffer) == 0 &amp;&amp; S_ISDIR(statBuffer-&gt;st_mode)) {\n        DIR *folder = opendir(path);\n        if (access(path, F_OK) != -1) {\n            if (folder)\n                while ((currentDir = readdir(folder))) {\n                    if (strcmp(currentDir-&gt;d_name, &quot;.&quot;) &amp;&amp; strcmp(currentDir-&gt;d_name, &quot;..&quot;)) {\n                        files[count] = (char*) malloc(THEORETICAL_MAX_PATH_LENGTH);\n                        snprintf(files[count], THEORETICAL_MAX_PATH_LENGTH, &quot;%s&quot;, currentDir-&gt;d_name);\n                        count++;\n                    }\n                }\n            free(currentDir);\n        }\n        closedir(folder);\n    } else if (errno &lt; 0)\n        printf(&quot;ERROR %d\\n&quot;, errno);\n\n    *numberOfFiles = count;\n}\n\nint rippleCycleCheckUpwards(Object *parent, __ino_t inode) {\n    if (parent)\n        if (parent-&gt;info.st_ino == inode)\n            return 1;\n        else \n            return rippleCycleCheckUpwards((Object*) parent-&gt;children[0], inode);\n    else \n        return 0;\n}\n\nvoid freeNode(Object *node) {\n    node-&gt;children[0] = NULL;\n    for (int i = 1; i &lt; node-&gt;numberOfChildren + 1; i++)\n        freeNode((Object*) node-&gt;children[i]);\n    free(node-&gt;children[0]);\n    free(node-&gt;children);\n    free(node);\n    node = NULL;\n}\n\nObject * createNode(const char *filename, Object *parent) {\n    Object *node = malloc(sizeof(Object));\n\n    char *files[THEORETICAL_MAX_PATH_LENGTH];\n    char *realDestination = malloc(THEORETICAL_MAX_PATH_LENGTH);\n    char *res = realpath(filename, realDestination);\n\n    strncpy(node-&gt;path[0], filename, THEORETICAL_MAX_PATH_LENGTH - 1);\n    if (res) {\n        strncpy(node-&gt;path[1], realDestination, THEORETICAL_MAX_PATH_LENGTH - 1);\n        strncat(node-&gt;path[1], &quot;\\0&quot;, 1);\n    }\n    free(realDestination);\n    \n    struct stat *info = malloc(sizeof(struct stat));\n    lstat(filename, info);\n    if (S_ISLNK(info-&gt;st_mode) == 1) {\n        getChildren(node-&gt;path[1], &amp;node-&gt;info, files, &amp;node-&gt;numberOfChildren);\n    } else {\n        getChildren(node-&gt;path[0], &amp;node-&gt;info, files, &amp;node-&gt;numberOfChildren);\n    }\n    free(info);\n    \n    node-&gt;children = malloc((1 + node-&gt;numberOfChildren) * sizeof(Object*));\n    node-&gt;children[0] = (struct Object*) parent;\n\n    if (rippleCycleCheckUpwards((Object*) parent, node-&gt;info.st_ino) == 1) {\n        node-&gt;numberOfChildren = 0;\n    }\n\n    for (int i = 0; i &lt; node-&gt;numberOfChildren; i++) {\n        char nextfile[THEORETICAL_MAX_PATH_LENGTH];\n        snprintf(nextfile, THEORETICAL_MAX_PATH_LENGTH - 1, &quot;%s/%s&quot;, filename, files[i]);\n        \n        if (S_ISDIR(node-&gt;info.st_mode) || S_ISLNK(node-&gt;info.st_mode)) {\n            node-&gt;children[i + 1] = (struct Object*) createNode(nextfile, node);\n        }\n        free(files[i]);\n    }\n    return node;\n}\n</code></pre>\n<p>You can build with this Makefile or gcc:</p>\n<pre><code>CC=gcc\nCCFLAGS=-Wall -g\nLDFLAGS=\nSOURCES=$(wildcard *.c)\nOBJECTS=$(SOURCES:.c=.o)\nTARGET=ultra_cp\n\nall: $(TARGET)\n\n$(TARGET): $(OBJECTS)\n        $(CC) -o $@ $^ $(LDFLAGS) \n\n%.o: %.c %.h\n        $(CC) $(CCFLAGS) -c $&lt;\n\n%.o: %.c\n        $(CC) $(CCFLAGS) -c $&lt;\n\nclean:\n        rm -f *.o $(TARGET)\n</code></pre>\n<p>Then test with <code>make</code> then <code>./ultra_cp var</code> for standard use or</p>\n<pre class=\"lang-sh prettyprint-override\"><code>valgrind --tool=memcheck --leak-check=yes --track-origins=yes --read-var-info=yes ./ultra_cp var\n</code></pre>\n<p>My issue is that valgrind prints out:</p>\n<pre><code>HEAP SUMMARY:\n==3221==     in use at exit: 8,192 bytes in 2 blocks\n==3221==   total heap usage: 112 allocs, 110 frees, 670,440 bytes allocated\n==3221==\n==3221== 8,192 bytes in 2 blocks are definitely lost in loss record 1 of 1\n==3221==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==3221==    by 0x108CA1: getChildren (helpers.c:29)\n==3221==    by 0x108F86: createNode (helpers.c:80)\n==3221==    by 0x1090F8: createNode (helpers.c:98)\n==3221==    by 0x1090F8: createNode (helpers.c:98)\n==3221==    by 0x1091E3: main (main.c:15)\n==3221==\n==3221== LEAK SUMMARY:\n==3221==    definitely lost: 8,192 bytes in 2 blocks\n==3221==    indirectly lost: 0 bytes in 0 blocks\n==3221==      possibly lost: 0 bytes in 0 blocks\n==3221==    still reachable: 0 bytes in 0 blocks\n==3221==         suppressed: 0 bytes in 0 blocks\n</code></pre>\n<p><code>helpers.c:29</code> is the line where <code>files[count] = (char*) malloc(THEORETICAL_MAX_PATH_LENGTH);</code> is called and the number of cases where it does not enter within the if statement.</p>\n<p>It does not hinder the functioning of my code, but I'd like to avoid leaking memory if at all possible and would subsequently thank you for any help on this matter.</p>\n<h3>EDIT</h3>\n<p>Thanks to user <a href=\"https://stackoverflow.com/users/1687119/dbush\">dbush</a> who provided the source of the problem, being that in the very specific case where <code>rippleCycleCheckUpwards(...)</code> is called, I do not empty the children of <code>files</code>.</p>\n<p>In <code>helpers.c</code> one can replace</p>\n<pre class=\"lang-c prettyprint-override\"><code>    if (rippleCycleCheckUpwards((Object*) parent, node-&gt;info.st_ino) == 1) {\n        node-&gt;numberOfChildren = 0;\n    }\n</code></pre>\n<p>with</p>\n<pre class=\"lang-c prettyprint-override\"><code>    if (rippleCycleCheckUpwards((Object*) parent, node-&gt;info.st_ino) == 1) {\n        for (int i = 0; i &lt; node-&gt;numberOfChildren; i++) {\n            free(files[i]);\n        }\n        node-&gt;numberOfChildren = 0;\n    }\n</code></pre>\n"}, {"tags": ["c++", "c", "c-preprocessor"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1572455372, "post_id": 58630500, "comment_id": 103568203, "body": "Read up on the &quot;undef-free X-macro&quot; concept. That can do the trick."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1572455392, "post_id": 58630500, "comment_id": 103568210, "body": "please pick one language. They will probably have different solutions. As your code is C++, I guess you want that"}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1572455668, "post_id": 58630500, "comment_id": 103568338, "body": "@formerlyknownas_463035818 I prefer C++, but AFAIK both c &amp; c++  follows the same preprocessor rules, so answer should be applicable to both (assuming the solution does not depend on language-specific constructs like __has_include etc.)"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1572455748, "post_id": 58630500, "comment_id": 103568373, "body": "c++ can avoid the need for most macros, in c I dont know, but if you insist on using them, then actually double tagging is fine"}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1572455769, "post_id": 58630500, "comment_id": 103568381, "body": "@Yunnosch thanks for the comment, i&#39;ll check it"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1572455795, "post_id": 58630500, "comment_id": 103568395, "body": "Why do you need the <code>_fwd.hpp</code> files? What problem do they solve? A real minimal example would be nice to understand what we&#39;re dealing with."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1572455885, "post_id": 58630500, "comment_id": 103568441, "body": "How is this better then just writing two files? One with forward declaration and the other with the definition? Then you include the definition only if you need it. All other files include only the declaration file. In your example you include definition if you include the same file twice."}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1572456175, "post_id": 58630500, "comment_id": 103568574, "body": "@TedLyngmo I use them mainly for two purposes, to minimize the amount of indirect include definitions in consuming code, and to reduce compile times. Usual forward declaration benefits."}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1572456344, "post_id": 58630500, "comment_id": 103568636, "body": "@KamilCuk The focal point of this question is, that &quot;I don&#39;t want to write two separate files&quot;, and the approach I presented is towards to achieve that. This is more like a style thing."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1572456571, "post_id": 58630500, "comment_id": 103568759, "body": "You could just add the forward declarations explicitly where required, rather than including a header. I.e. in &quot;bar.hpp&quot;, replace <code>#include &quot;foo.hpp&quot;</code> with <code>struct foo;</code>."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1572456572, "post_id": 58630500, "comment_id": 103568760, "body": "@MustafaKemalGILOR I can see how that can help those situations, but it&#39;s quite a bit of work to maintain - and there are caching solutions that can help with keeping the compilation times down."}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1572457029, "post_id": 58630500, "comment_id": 103568962, "body": "@TedLyngmo yeah it is. I&#39;m already using ccache, and I&#39;m aware of upcoming &quot;c++ modules&quot; will solve the need of forward declaration and header guards. I just wonder if it&#39;s possible at all to achieve the thing I proposed, because I have never seen a project utilizing stuff like this until now. Pure curiosity."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1572457870, "post_id": 58630500, "comment_id": 103569346, "body": "@MustafaKemalGILOR Then i think it&#39;s better to do like the <code>_KERNEL</code> does. And <code>_POSIX_C_SOURCE</code> and <code>_GNU_SOURCE</code> and all the happy <a href=\"http://man7.org/linux/man-pages/man7/feature_test_macros.7.html\" rel=\"nofollow noreferrer\">feature_test_macros</a>. Och, and <code>FUSE_USE_VERSION</code> serves similar purpose. The header that needs the implementation declares a macro like <code>FOO_NEED_DECLARATION</code> before including anything."}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1572458818, "post_id": 58630500, "comment_id": 103569775, "body": "@IanAbbott yeah, I could do that, but it is harder to maintain, and harder to perform name/namespace changes. also I want to be able to provide forward declarations to consumers, so they don&#39;t have to look up into header files to write their own forward declarations (looking from a library/framework writer&#39;s perspective). It becomes cumbersome especially when template classes are being forward-declared. (and they might have default template parameters and such.). As I library consumer, I wouldn&#39;t want to delve into library internals if I just want to forward-declare a library thing."}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1572459055, "post_id": 58630500, "comment_id": 103569887, "body": "@KamilCuk yeah, I thought about <code>FOO_NEED_DECLARATION</code> too, but in most cases you would need to undef it after use, to not interfere with other headers. I thought wrapping #include in a macro but that way is blocked too, as preprocessor processes each unit for only once. A custom <code>_Include</code> built-in would solve the issue (like in #pragma case), but I am not aware of any compiler which implements such a facility."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1572460888, "post_id": 58630500, "comment_id": 103570728, "body": "Rather than <code>FOO_NEED_DECLARATION</code>, you could have <code>FOO_FWD_ONLY</code>, so the header that only needs forward declarations from &quot;foo.h&quot; could define that macro before `#include &quot;foo.h&quot; and undefine it afterwards. Or you could undefine it inside &quot;foo.h&quot; itself for ease of maintenance."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1572462931, "post_id": 58630500, "comment_id": 103571550, "body": "What do you mean by &quot;actual declaration&quot;?  Do you mean &quot;definition&quot;?"}, {"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1572463407, "post_id": 58630500, "comment_id": 103571744, "body": "@WilliamPursell what I mean with actual declaration is the non-forward declaration of thing."}], "answers": [{"comments": [{"owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "edited": false, "score": 0, "creation_date": 1572465389, "post_id": 58632130, "comment_id": 103572578, "body": "Your implementation gave me an idea to work around double inclusion issue. Working on it right now."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 1, "last_activity_date": 1572462220, "creation_date": 1572462220, "answer_id": 58632130, "question_id": 58630500, "link": "https://stackoverflow.com/questions/58630500/is-it-possible-to-merge-forward-declaration-and-regular-declaration-into-a-singl/58632130#58632130", "title": "Is it possible to merge forward declaration and regular declaration into a single file, then use it as if they&#39;re separated?", "body": "<p>Here is a proposal for consideration (maybe not the best). It involves the includer of an include file setting a macro to indicate that it only needs the forward declarations from that include file. When the macro is not defined, it gets everything from the include file. To avoid problems with header files forgetting to undefine the special macro afterwards, the file being included can be made responsible for undefining it.</p>\n\n<p>It goes something like this:</p>\n\n<p><strong>foo.hpp</strong></p>\n\n<pre><code>#if !defined(FOO_FWD_HPP)\n#define FOO_FWD_HPP\n\n// forward declarations go here\n\nstruct foo;\n\n#endif // FOO_FWD_HPP\n\n#if !defined(FOO_FWD_ONLY)\n// includer wants the full monty\n#if !defined(FOO_HPP)\n#define FOO_HPP\n\n// normal declarations go here\n\nstruct foo{\n   foo(){/*....*/}\n};\n\n#endif // FOO_HPP\n#endif // FOO_FWD_ONLY\n\n#undef FOO_FWD_ONLY\n</code></pre>\n\n<p><strong>bar.hpp</strong></p>\n\n<pre><code>#pragma once\n\n// only need forward declarations from foo.hpp\n#define FOO_FWD_ONLY\n#include \"foo.hpp\"\n\nstruct bar {\n    bar(const foo&amp; f);\n};\n</code></pre>\n\n<p><strong>bar.cpp</strong></p>\n\n<pre><code>#include \"bar.hpp\"\n#include \"foo.hpp\"\n\nbar::bar(const foo&amp; f){\n    f.rab(); // requires actual implementation\n}\n</code></pre>\n\n<p>The main benefit is to reduce the amount of code being compiled. It does not do anything to fix the problem of unintended exposure. For example, if \"bar.hpp\" includes some other file that includes \"foo.hpp\" without defining the <code>FOO_FWD_ONLY</code> macro first, the full definitions from \"foo.hpp\" will be exposed to the remainder of \"bar.hpp\".</p>\n"}], "owner": {"reputation": 96, "user_id": 10872971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyzoD.png?s=128&g=1", "display_name": "Mustafa Kemal GILOR", "link": "https://stackoverflow.com/users/10872971/mustafa-kemal-gilor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572467367, "creation_date": 1572455258, "last_edit_date": 1572467367, "question_id": 58630500, "link": "https://stackoverflow.com/questions/58630500/is-it-possible-to-merge-forward-declaration-and-regular-declaration-into-a-singl", "title": "Is it possible to merge forward declaration and regular declaration into a single file, then use it as if they&#39;re separated?", "body": "<p>I have this crazy idea of merging forward declaration headers and actual declaration files into one by performing some macro trickery. To provide some context, the daily policy I follow for forward declarations is as follows;</p>\n\n<ul>\n<li>Each header file has its \"_fwd.hpp\" complement, which contains forward declarations of all forward-declarable entities in that header file.</li>\n<li>I include the forward declaration header where forward-declaration of the actual thing suffices</li>\n<li>I include the regular declaration header mainly in .cpp files and only when an actual implementation information is required (things requiring size of the implementation, inheritance etc.)</li>\n</ul>\n\n<p>But having a separate _fwd.hpp header for each header pollutes the project, and is kind of hard to maintain. So, I come up with the following idea of merging forward declaration and actual declaration into single file, then enabling them according to include count. I come up with this initial idea of double-inclusion of header;</p>\n\n<p>foo.hpp</p>\n\n<pre><code>#if !defined(FOO_FWD_H)\n#define FOO_FWD_H\n    // Forward declarations goes here\n    struct foo;\n#else // has forward_declaration, include actual if not included yet\n\n#if !defined(FOO_H)\n    #define FOO_H\n    struct foo{\n       foo(){/*....*/}\n    };\n    // Normal declarations goes here\n#endif // FOO_H\n\n#endif // FOO_FWD_H\n</code></pre>\n\n<p>If I include \"foo.hpp\" once, I get forward declaration of foo, but if I include it second time in a translation unit, I get the forward &amp; actual declaration of the foo, which is totally fine by me. (as I'm kinda doing the same thing anyway, include fwdecl in header, actual in cpp). </p>\n\n<p>So, when put into use case described above, it goes like this;</p>\n\n<p><strong>bar.hpp</strong></p>\n\n<pre><code>#pragma once\n\n#include \"foo.hpp\" // forward declaration\n\nstruct bar{\n    bar(const foo&amp; f);\n};\n</code></pre>\n\n<p><strong>bar.cpp</strong></p>\n\n<pre><code>#include \"bar.hpp\" // bar + 1st inclusion of foo.hpp\n#include \"foo.hpp\" // included 2nd time, actual implementation enabled\n\nbar::bar(const foo&amp; f){\n    f.rab(); // requires actual implementation\n}\n</code></pre>\n\n<p>But as you can imagine, this approach has problems. The biggest issue is, if foo.hpp included by another header, tar.hpp, and tar.hpp is included in bar.hpp, causes actual implementation to be exposed to bar.hpp, defeating the purpose. Also, when actual implementation of foo.hpp is required in bar.hpp, it has to be included twice, which looks weird (linters and tools like iwyu might have an issue with that).</p>\n\n<p>So the question boils down to this, can we actually make this work in such a way that;</p>\n\n<ul>\n<li>including headers which using this idiom does not interfere with other headers' inclusion state </li>\n<li>eliminating the need of double-inclusion when actual implementation is needed</li>\n</ul>\n\n<p>Thanks in advance.</p>\n\n<p><strong>UPDATE:</strong> (30/10/19 10:57 PM GMT+2)</p>\n\n<p>Improved version of idiom based on @IanAbbott 's answer:</p>\n\n<p>Try it live : <a href=\"https://repl.it/@mustafakemalgil/single-fwdecl-decl\" rel=\"nofollow noreferrer\">repl.it</a></p>\n\n<p><strong>foo.hpp</strong> (our single fwdecl &amp; decl idiom implementing header)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    // (mgilor): we got ourselves quite a lot boilerplate code, \n    // maybe x-macro concept help us to move away boilerplate to\n    // a separate file?\n\n    #if defined(FOO_FWD_ONLY)\n        #undef FOO_FWD_HPP // prevent accidental implementation inclusion on other headers\n    #endif\n\n    #if defined(FOO_FWD_ONLY) &amp;&amp; !defined(FOO_FWD_HPP) \n        #define FOO_FWD_HPP \n        // forward declarations go here\n        struct foo;\n    #elif !defined(FOO_FWD_ONLY)\n\n         // includer wants the full monty\n        #if !defined(FOO_HPP)\n            #define FOO_HPP\n            // actual declarations go here\n\n            struct foo{\n                foo(){/*....*/}\n                void do_things(){}\n            };\n\n        #endif // FOO_HPP\n\n    #endif // FOO_FWD_HPP\n\n    // undef the macro, so future includes does not get affected\n    #undef FOO_FWD_ONLY\n</code></pre>\n\n<p><strong>tar.hpp</strong> (fwdecl only consumer of foo)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    #pragma once\n\n    #define FOO_FWD_ONLY\n    #include \"foo.hpp\" // this header needs forward declaration\n\n    #ifdef FOO_FWD_HPP \n        #pragma message ( __FILE__ \" has forward declaration of foo\") \n    #endif\n    #ifdef FOO_HPP\n        #pragma message ( __FILE__ \" has full declaration of foo\") \n    #endif\n\n    struct tar{\n        tar(foo &amp; f){ }\n    };\n</code></pre>\n\n<p><strong>bar.hpp</strong> (fwdecl only consumer of foo, also consumes tar.hpp)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    #pragma once\n\n    #include \"tar.hpp\" // tar consumed foo fwdecl-only\n    #define FOO_FWD_ONLY\n    #include \"foo.hpp\" // bar needs fwdecl-only\n\n    #ifdef FOO_FWD_HPP \n        #pragma message ( __FILE__ \" has forward declaration of foo\") \n    #endif\n    #ifdef FOO_HPP\n        #pragma message ( __FILE__ \" has full declaration of foo\") \n    #endif\n\n    struct bar{\n        bar(foo &amp; f);\n    };\n</code></pre>\n\n<p><strong>bar.cpp</strong> (full decl consumer of bar &amp; foo) </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    #include \"bar.hpp\"\n    #include \"foo.hpp\" // second inclusion, should enable full definition\n\n    #ifdef FOO_FWD_HPP \n        #pragma message ( __FILE__ \" has forward declaration of foo\") \n    #endif\n    #ifdef FOO_HPP\n        #pragma message ( __FILE__ \" has full declaration of foo\") \n    #endif\n\n    bar::bar(foo&amp; ref){\n        ref.do_things();\n    }\n</code></pre>\n\n<p><strong>baz.hpp</strong> (no dependencies)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    #pragma once\n\n    struct baz{\n        void do_baz();\n    };\n</code></pre>\n\n<p><strong>baz.cpp</strong> (full decl consumer of foo &amp; baz) </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    #include \"baz.hpp\"\n    #include \"foo.hpp\"  // no prior include of foo, but since FOO_FWD_ONLY is not defined\n                        // baz.cpp will get full declaration.\n\n    #ifdef FOO_FWD_HPP \n        #pragma message ( __FILE__ \" has forward declaration of foo\") \n    #endif\n    #ifdef FOO_HPP\n        #pragma message ( __FILE__ \" has full declaration of foo\") \n    #endif\n\n\n    void baz::do_baz(){\n        foo f;\n        f.do_things(); // completely fine.\n    }\n</code></pre>\n\n<p><strong>main.cpp</strong> (consuming application)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    // consuming application\n    #include \"tar.hpp\" \n    #include \"bar.hpp\" \n    #include \"foo.hpp\"  // already has previous foo fwdecl, so second inclusion will enable full declaration. \n                        // (also FOO_FWD_ONLY is not defined, so first inclusion would enable it too)\n    #include \"baz.hpp\"\n    int main(void){\n\n        foo f;\n        tar t(f);\n        bar b(f);\n        baz bz;\n    }\n</code></pre>\n\n<p>Output when compiled:</p>\n\n<pre><code>    tar.hpp:7:13: warning: tar.hpp has forward declaration of foo \n    bar.hpp:8:13: warning: bar.hpp has forward declaration of foo \n    bar.cpp:6:13: warning: bar.cpp has forward declaration of foo \n    bar.cpp:9:13: warning: bar.cpp has full declaration of foo \n    baz.cpp:9:13: warning: baz.cpp has full declaration of foo \n    tar.hpp:7:13: warning: tar.hpp has forward declaration of foo \n    bar.hpp:8:13: warning: bar.hpp has forward declaration of foo \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1572454594, "post_id": 58630270, "comment_id": 103567785, "body": "<i>&quot;I get a different value&quot;</i> - a value of <i>what</i> ? And fyi, a function call isn&#39;t free, even if  it ultimately does little/nothing within. It&#39;s still a function call. Standing-up/tearing-down the activation record, the actual code within the function even if it ultimately does nothing but enter/check/exit, etc. It all comes with a price."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 4, "last_activity_date": 1572455108, "last_edit_date": 1572455108, "creation_date": 1572454777, "answer_id": 58630376, "question_id": 58630270, "link": "https://stackoverflow.com/questions/58630270/why-does-nanosleep-0-still-execute/58630376#58630376", "title": "why does nanosleep 0 still execute?", "body": "<p>If you don't want a function to run, don't call it.</p>\n\n<p>Functions have overheads. They need to initialize a stackframe, jump to the functions code, do the work and then jump back. It's only the \"do the work\" that can be altered. </p>\n\n<p>You can of course inline the function to skip the jumps and stack frame setup, but you will always need to check the value of the argument. Even such a simple thing as <code>if(x==0)</code> takes time when it comes to the nanoscale.</p>\n\n<p>The problem here is almost more philosophical than technical. A function cannot <em>by itself</em> determine if it should be run or not, because it needs to be run to do anything that all, including determining if it should be run or not. </p>\n"}, {"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1572459302, "post_id": 58630664, "comment_id": 103569987, "body": "This is the answer I was going to post before I was distracted by my day job ;-)  Nowadays we have <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/sched_yield.html\" rel=\"nofollow noreferrer\">sched_yield</a>, but back in the 1990s that function couldn&#39;t be relied on to exist, so older programs rely on <code>[nano]sleep(0)</code> to do a yield, so operating systems have to keep implementing it that way."}], "tags": [], "owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "is_accepted": false, "score": 6, "last_activity_date": 1572455918, "creation_date": 1572455918, "answer_id": 58630664, "question_id": 58630270, "link": "https://stackoverflow.com/questions/58630270/why-does-nanosleep-0-still-execute/58630664#58630664", "title": "why does nanosleep 0 still execute?", "body": "<p><code>sleep(0)</code> and probably <code>nanosleep</code> with zero provide a mechanism for a thread to surrender the rest of its timeslice. This effectively is a thread yield. So when calling <code>sleep(0)</code> we enter kernel mode and places the thread onto the \"runnable\" queue. The thread then is scheduled to resume when the next available timeslot comes available. When this happens is left entirely up to the operating system.</p>\n\n<p>One usecase (maybe not the best usecase) for this is a userspace spinlock. When \"spinning while waiting for a resource, we call sleep(0). This allows the task that may release the resource to be scheduled allowing the lock to be released quicker.</p>\n"}], "owner": {"reputation": 29, "user_id": 10708085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db20c01668665baa5caa57c0fa3375e?s=128&d=identicon&r=PG&f=1", "display_name": "ColeSlaw", "link": "https://stackoverflow.com/users/10708085/coleslaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1572473020, "creation_date": 1572454366, "last_edit_date": 1572473020, "question_id": 58630270, "link": "https://stackoverflow.com/questions/58630270/why-does-nanosleep-0-still-execute", "title": "why does nanosleep 0 still execute?", "body": "<p>Im trying to test the performance of <code>nanosleep</code> in my code. When I call nanosleep and pass in 0 seconds and 0 nanoseconds I get a different value compared to not even calling <code>nanosleep</code>. Shouldn't <code>nanosleep</code> have no effect at all if I call it with 0 as argument?</p>\n"}, {"tags": ["c", "arrays", "initialization", "c-strings", "string-literals"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1572454402, "post_id": 58630253, "comment_id": 103567688, "body": "For your purposes, way #2 should be the best.  Please tell us more abut the &quot;run time error&quot; you got when you tried that."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572454518, "post_id": 58630253, "comment_id": 103567748, "body": "That third one is utterly bizarre. Are you sure that&#39;s what you mean?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1572454572, "post_id": 58630253, "comment_id": 103567773, "body": "Note that if you plan on passing <code>argv</code> to a function like <code>execv()</code>, it needs a null pointer at the end, so it should be <code>{&quot;foo&quot;, &quot;boo&quot;, NULL}</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572454636, "post_id": 58630253, "comment_id": 103567809, "body": "Try compiling with <code>-Wall</code> because these examples make <code>clang</code> refuse to compile due to wildly mismatched types."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1572454655, "post_id": 58630253, "comment_id": 103567814, "body": "<code>char **argv = {&quot;foo&quot;,&quot;boo&quot;};</code> initializes from incompatible pointer types. <code>char ****argv[] = {&quot;foo&quot;,&quot;boo&quot;};</code> has 3-Levels of indirection too many. <code>char *argv[] = {&quot;foo&quot;,&quot;boo&quot;};</code> is the only correct guess...  Always compile with <code>-Wall -Wextra -pedantic</code> as part of your compile string."}, {"owner": {"reputation": 13, "user_id": 12298693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDnvb9HS4j3bggrexIjrmJ5HaFjDuC_FK_E4WkWAg=k-s128", "display_name": "Mahmoud Abdelbary", "link": "https://stackoverflow.com/users/12298693/mahmoud-abdelbary"}, "edited": false, "score": 0, "creation_date": 1572456774, "post_id": 58630253, "comment_id": 103568856, "body": "those are the two warning that i&#39;m getting   main.c:6:19: warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]      char **argv= {&quot;ahmed&quot;,&quot;mohamed&quot;}; =================================== main.c:6:27: warning: excess elements in scalar initializer      char **argv= {&quot;ahmed&quot;,&quot;mohamed&quot;};"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12298693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDnvb9HS4j3bggrexIjrmJ5HaFjDuC_FK_E4WkWAg=k-s128", "display_name": "Mahmoud Abdelbary", "link": "https://stackoverflow.com/users/12298693/mahmoud-abdelbary"}, "edited": false, "score": 0, "creation_date": 1572456349, "post_id": 58630410, "comment_id": 103568643, "body": "so how to initialize the first one properly?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 13, "user_id": 12298693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDnvb9HS4j3bggrexIjrmJ5HaFjDuC_FK_E4WkWAg=k-s128", "display_name": "Mahmoud Abdelbary", "link": "https://stackoverflow.com/users/12298693/mahmoud-abdelbary"}, "edited": false, "score": 0, "creation_date": 1572456399, "post_id": 58630410, "comment_id": 103568669, "body": "@MahmoudAbdelbary I do not understand why you need such an initialization but you can write char *p = &quot;foo&quot;; char **argv = &amp;p;"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1572456835, "last_edit_date": 1572456835, "creation_date": 1572454925, "answer_id": 58630410, "question_id": 58630253, "link": "https://stackoverflow.com/questions/58630253/different-ways-to-initialize-array-of-strings-in-c/58630410#58630410", "title": "different ways to initialize array of strings in c", "body": "<p>Among these declarations</p>\n\n<pre><code>char **argv = {\"foo\",\"boo\"};\nchar *argv[] = {\"foo\",\"boo\"};\nchar ****argv[] = {\"foo\",\"boo\"};\n</code></pre>\n\n<p>only the second declaration is valid.</p>\n\n<p>The first declaration is not valid because you may not use a list in braces with more than one expression to initialize a scalar object. And even if you will use only one string literal in braces in the first declaration nevertheless the type of the declared variable ( <code>char **</code> ) and the type of the initializer ( <code>char *</code> ) are different and there is no implicit conversion between the types.</p>\n\n<p>The third declaration is invalid because there is no implicit conversion between the type <code>char *</code> (the type of the string literals used as initializers) and the type <code>char ****</code>.</p>\n\n<p>Valid declarations in C of character arrays using the presented list of initializers can be</p>\n\n<pre><code>char *argv1[] = {\"foo\",\"boo\"};  \nchar argv2[][3] = {\"foo\",\"boo\"};    \nchar argv3[][4] = {\"foo\",\"boo\"};    \n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    char *argv1[] = {\"foo\",\"boo\"};  \n    char argv2[][3] = {\"foo\",\"boo\"};    \n    char argv3[][4] = {\"foo\",\"boo\"};    \n\n\n    printf( \"%s, %s\\n\", argv1[0], argv1[1] );\n    printf( \"%3.3s, %3.3s\\n\", argv2[0], argv1[1] );\n    printf( \"%s, %s\\n\", argv3[0], argv3[1] );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>foo, boo\nfoo, boo\nfoo, boo\n</code></pre>\n\n<p>To make the first initialization correct you can write</p>\n\n<pre><code>char * p[] = {\"foo\",\"boo\"}\nchar **argv = p;\n</code></pre>\n\n<p>Another way is to use the compound literal like</p>\n\n<pre><code>char **argv= ( char *[] ){\"foo\",\"boo\"};\n</code></pre>\n\n<p>Here is one more demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    char **argv= ( char *[] ){\"foo\",\"boo\"}; \n\n\n    printf( \"%s, %s\\n\", argv[0], argv[1] );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>foo, boo\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12298693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDnvb9HS4j3bggrexIjrmJ5HaFjDuC_FK_E4WkWAg=k-s128", "display_name": "Mahmoud Abdelbary", "link": "https://stackoverflow.com/users/12298693/mahmoud-abdelbary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 58630410, "answer_count": 1, "score": 1, "last_activity_date": 1572456835, "creation_date": 1572454296, "last_edit_date": 1572456221, "question_id": 58630253, "link": "https://stackoverflow.com/questions/58630253/different-ways-to-initialize-array-of-strings-in-c", "title": "different ways to initialize array of strings in c", "body": "<p>i am trying to initialize an array of strings in c in different ways and i'm having trouble to understand how it behaves.</p>\n\n<p>i'm trying to initialize the array and print it \n,i have tried three ways to initialize the array</p>\n\n<pre><code>char **argv = {\"foo\",\"boo\"};\nchar *argv[] = {\"foo\",\"boo\"};\nchar ****argv[] = {\"foo\",\"boo\"};\n</code></pre>\n\n<p>and then print them using </p>\n\n<pre><code>    printf(\"%s\",argv[1]);\n</code></pre>\n\n<p>i expected the first and second one to run and the third to fail but the first one is giving me run time error and the other run without any problem\nwhy? and how does c compile them</p>\n"}, {"tags": ["c", "linux", "hid"], "comments": [{"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 1, "creation_date": 1572470255, "post_id": 58630178, "comment_id": 103574504, "body": "with a <code>-1</code> value, it would seem that the call to <code>enumerate_wheels()</code> isn&#39;t working. Can you step thru that code in a debugger? (Don&#39;t know anything about hid_usb, this is just a general observation). Good luck!"}, {"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1572470425, "post_id": 58630178, "comment_id": 103574567, "body": "And I would expect that <code>devs</code> would be some data structure can that can hold a list. OR as this is <code>c-lang</code>. more likely you need a pointer to an array of pointers, maybe declared as <code>**devs</code>? Really guessing here, but as you&#39;ve had no other feedback, hoping this might give you something new to poke at ;-) . Good luck."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 11935189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-09I5FPBx3dc/AAAAAAAAAAI/AAAAAAAAA74/fXTbaIdcpeo/photo.jpg?sz=128", "display_name": "Ma Ta", "link": "https://stackoverflow.com/users/11935189/ma-ta"}, "is_accepted": false, "score": 0, "last_activity_date": 1573131698, "creation_date": 1573131698, "answer_id": 58749346, "question_id": 58630178, "link": "https://stackoverflow.com/questions/58630178/execution-fails-for-a-hid-device-application/58749346#58749346", "title": "execution fails for a hid device application", "body": "<p>Thanks @shellter. I changed from hid.c that uses libusb to the one for native linux and I got passed the enumeration step. Now it fails at opening the device (/dev/hidraw0). The open(path,0_RDWR) call does not open the device.</p>\n\n<p>I assume it is a permission problem? I read several posts that I should fix it by setuid, how should I change this permission for a program that should communicate with a hid device at some point? Is there an environment variable that I can set?</p>\n\n<p>Thank you so much.</p>\n"}], "owner": {"reputation": 59, "user_id": 11935189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-09I5FPBx3dc/AAAAAAAAAAI/AAAAAAAAA74/fXTbaIdcpeo/photo.jpg?sz=128", "display_name": "Ma Ta", "link": "https://stackoverflow.com/users/11935189/ma-ta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573131698, "creation_date": 1572454077, "question_id": 58630178, "link": "https://stackoverflow.com/questions/58630178/execution-fails-for-a-hid-device-application", "title": "execution fails for a hid device application", "body": "<p>I am very new to programming USB devices, so please accept my apologies if the question is dumb.</p>\n\n<p>I have a simple usb device (It is a filterwheel device) that I want to use in an embedded application. The supplier has provided me with a c source code that works based on hidapi. I am trying to run a simple application on a linux pc first. I can successfully build the project, but as I run the project, it terminates at enumeration step with et value -1. </p>\n\n<p>The device is connected to my computer. I am quite lost on what I should do to make it identify the device.Any suggestions would be very appreciated. </p>\n\n<p>I do not know what information I can add here, the application looks like this:</p>\n\n<pre><code>int main()\n{\n    hsfw_wheel_info *devs, *cur_dev;\n    devs = enumerate_wheels();\n    cur_dev = devs;\n    while (cur_dev) {\n        printf(\"Device Found - type: %04hx %04hx serial_number: %ls\\n\",cur_dev-&gt;vendor_id, cur_dev-&gt;product_id, cur_dev-&gt;serial_number);\n\n        cur_dev = cur_dev-&gt;next;\n    }\n</code></pre>\n\n<p>The enumerate_wheels is a function that uses hid_enumerate. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "sockets", "dns"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572453049, "post_id": 58629797, "comment_id": 103567017, "body": "Tip: Use <a href=\"https://www.tcpdump.org\" rel=\"nofollow noreferrer\">tcpdump</a> to see if your DNS packets can be parsed properly by the dumping tool. This can help identify problems early."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572453142, "post_id": 58629797, "comment_id": 103567073, "body": "Does 8.8.8.8 support TCP resolution? Many of these DNS providers use routing tricks that prevent streams from working properly so that may not be the case."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572453359, "post_id": 58629797, "comment_id": 103567183, "body": "@tadman i am not sure i used this <a href=\"https://developers.google.com/speed/public-dns/\" rel=\"nofollow noreferrer\">google public DNS</a> and there it states it supports TCP. Nevertheless TCP was not my goal initially i only wanted to see if the connection persits as i wait for an answer."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572453398, "post_id": 58629797, "comment_id": 103567211, "body": "@tadman also i would really like to use that tool but my problem is i do not know how to assemble a package which could be parsed :)"}, {"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572502377, "post_id": 58629797, "comment_id": 103581714, "body": "@tadman &quot;Does 8.8.8.8 support TCP resolution? &quot;  Of course, this is mandatory per the DNS protocol, DNS works over UDP and TCP any conforming nameserver has to provide both."}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1572453846, "post_id": 58630084, "comment_id": 103567437, "body": "No problem. I also expanded it a bit just now with information on parsing."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 2, "last_activity_date": 1572453827, "last_edit_date": 1572453827, "creation_date": 1572453691, "answer_id": 58630084, "question_id": 58629797, "link": "https://stackoverflow.com/questions/58629797/send-request-to-dns-server-via-udp-socket/58630084#58630084", "title": "Send request to DNS server via UDP socket", "body": "<p>The function <code>res_mkquery</code>, which was originally from BIND/libresolv but appears in almost every version of libc out there (albeit not being defined in any standard), can produce query packets for you, and you can inspect the output without sending it. Playing around with it would be very informative.</p>\n\n<p>As for your specific question about <code>OPCODE</code>, and DNS query format in general, you should be referring to <a href=\"https://tools.ietf.org/html/rfc1035\" rel=\"nofollow noreferrer\">RFC 1035</a>, not 1034; the latter is higher-level principles not protocol. Page 26 defines the <code>OPCODE</code> values, and 0 (standard query, \"SQUERY\") is the only meaningful one.</p>\n\n<p>Note that the <code>ns_*</code> functions from <code>&lt;arpa/nameser.h&gt;</code> (also nonstandard but widely available) can be used to parse your query packet or answers received by sending it to a nameserver and getting a response.</p>\n"}], "owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "accepted_answer_id": 58630084, "answer_count": 1, "score": 2, "last_activity_date": 1572453827, "creation_date": 1572452545, "last_edit_date": 1592644375, "question_id": 58629797, "link": "https://stackoverflow.com/questions/58629797/send-request-to-dns-server-via-udp-socket", "title": "Send request to DNS server via UDP socket", "body": "<p>currently i am learning about DNS servers in my lectures. As we had berkeley sockets before, i thought i may combine my knowledge and try to send a request to a DNS via a socket and process the answer myself. I wrote a little C program on linux which takes 3 arguments: an IP a port (most likely 53 as i found out) and the data which should be send to the given server.</p>\n<p>First i tried simply sending the host name as a string. Then i discovered <a href=\"https://tools.ietf.org/html/rfc1034\" rel=\"nofollow noreferrer\">RFC1034</a> where it becomes clear that a request is more complex and contains several fields. However i somehow can not find out the possible values i can fill in the fields. For example under 6.2.1 in the link it says <code>Header: OPCODE=SQUERY</code> whereas OPCODE is stated to be a 4 bit integer so i believe these codes are implementation defined and determined by the DNS server? Or did i miss a section of the RFC? It only states type and class are &quot;encoded 16 bit values&quot;.</p>\n<p>when i try to call my program like this</p>\n<pre><code>client 8.8.8.8 53 www.example.com\n</code></pre>\n<p>for the google DNS, it actually connects and sends the data but then waits for an answer which never comes. When using TCP i noticed the DNS server instantly closes the connection after receiving the domain name.</p>\n<p>As i understand now i need to assemble a request according to the RFC with a Header containing the opcode for a request and the question containing the domain name and further options like type and class as binary information. But where do i get the possible values for <code>OPCODE, QCLASS, QTYPE</code>?</p>\n<p>I am aware that <code>getaddrinfo</code> essentially does this for me and that i can get the IP from the sockaddr structure already but this is a matter of experimenting and learning.</p>\n<p>I appreciate any help :)</p>\n<h1>My Program</h1>\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;unistd.h&gt;\n\nint main (int argc, char **argv) {\n    if (argc &lt; 4) {\n        printf(&quot;Error to few arguments.\\nUsage: client &lt;ip/host name&gt; &lt;port&gt; &lt;query&gt;\\n&quot;);\n        exit(1);\n    }\n\n    struct addrinfo *server_addr;\n    struct addrinfo hint;\n    memset(&amp;hint, 0, sizeof(hint));\n\n    hint.ai_family = AF_UNSPEC;\n    hint.ai_socktype = SOCK_DGRAM;\n    hint.ai_protocol = IPPROTO_UDP;\n\n    printf(&quot;getting server info\\n&quot;);\n    /* Heh...ironic */\n    int err = getaddrinfo(argv[1], argv[2], &amp;hint, &amp;server_addr);\n    if (err != 0) {\n        perror(&quot;Error while getting server address info&quot;);\n        exit(1);\n    }\n\n    int client;\n    /* Iterate over the provided addresses and try to establish a connection */\n    for (struct addrinfo *cur_info = server_addr; cur_info != NULL; cur_info = cur_info-&gt;ai_next) {\n        /* Create corresponding socket */\n        client = socket(cur_info-&gt;ai_family, cur_info-&gt;ai_socktype, cur_info-&gt;ai_protocol);\n\n        printf(&quot;Trying to establish connection\\n&quot;);\n        err = connect(client, cur_info-&gt;ai_addr, sizeof(*(cur_info-&gt;ai_addr)));\n        /* If connection was established leave loop */\n        if (err == 0) break;\n        /* If an error occured notify */\n        if (err == -1) perror(&quot;Error while connecting&quot;);\n        close(client);\n        /* If the current info was the last one consider connection failed */\n        if (cur_info-&gt;ai_next == NULL) {\n            printf(&quot;Error could not connect to any service\\n&quot;);\n            exit(1);\n        }\n\n    }\n    /* Release information as it is no longer needed */\n    freeaddrinfo(server_addr);\n\n    printf(&quot;Sending request\\n&quot;);\n    err = send(client, argv[3], strlen(argv[3]), 0);\n    if (err &lt; 1) {\n        perror(&quot;Error while sending request&quot;);\n        exit(1);\n    }\n    printf(&quot;%d b sent\\n&quot;, err);\n\n    char buffer[512];\n    int bytes_received = 0;\n\n    printf(&quot;receiving answer\\n&quot;);\n    while ((bytes_received = recv(client, buffer, sizeof(buffer), 0)) != 0) {\n        if (bytes_received == -1) {\n            perror(&quot;Error while receiving message from server&quot;);\n            break;\n        }\n        fwrite(buffer, bytes_received, 1, stdout);\n    }\n\n    close(client);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc", "segmentation-fault"], "comments": [{"owner": {"reputation": 421, "user_id": 3642304, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f79bdbc49e15165aba9b94addcab951e?s=128&d=identicon&r=PG&f=1", "display_name": "mban", "link": "https://stackoverflow.com/users/3642304/mban"}, "edited": false, "score": 0, "creation_date": 1572450763, "post_id": 58629090, "comment_id": 103565693, "body": "Does your program provide any output prior to the segmentation fault? I would also consider printing your errors to stderr instead of stdout."}, {"owner": {"reputation": 421, "user_id": 3642304, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f79bdbc49e15165aba9b94addcab951e?s=128&d=identicon&r=PG&f=1", "display_name": "mban", "link": "https://stackoverflow.com/users/3642304/mban"}, "edited": false, "score": 0, "creation_date": 1572451337, "post_id": 58629090, "comment_id": 103566024, "body": "Because <code>size</code> and <code>numbers</code> are uninitialized, if you have an invalid size, you will dereference a NULL pointer in <code>numbers</code> when you try and check for powers of two (at the bottom of <code>main</code>). The <code>malloc</code> for <code>numbers</code> never is executed."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1572452351, "post_id": 58629090, "comment_id": 103566611, "body": "It&#39;s a good time to learn how to use a debugger."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1572452553, "post_id": 58629090, "comment_id": 103566738, "body": "By the way sizeof(int) has nothing to do with reading strings and scanning integers. <code>sizeof(int)*(size+1) + ...</code> makes no sense. Your method of parsing input is overcomplicated and there is absolutely no need to go to such lengths just to read a bunch of number. <code>scanf(&quot;%d&quot;, &amp;num)</code> in a loop would work perfectly fine."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1572454141, "post_id": 58629090, "comment_id": 103567572, "body": "There is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a> Use the dereferenced pointer to set the <i>type-size</i> (e.g. <code>numbers = malloc (size * sizeof *numbers);</code>) and  you will never get the <i>type-size</i> wrong. <code>sizeof(char);</code> is always <code>1</code> and should be omitted. <code>scanf (&quot;%d%c&quot;...</code> is horribly fragile, instead just remove any chars that remain in <code>stdin</code> with a loop over <code>getchar();</code> while the character isn&#39;t <code>&#39;\\n&#39;</code> or <code>EOF</code>. S p a c e  Y o u r C o d e...."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1572454948, "post_id": 58629090, "comment_id": 103567980, "body": "Given that <code>str</code> is a char pointer, the line <code>str=(char*)malloc(sizeof(int)*(size+1) + (size-1)*sizeof(char));</code> should cause all kinds of alarms to go off in your head :)"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1572451359, "creation_date": 1572451359, "answer_id": 58629451, "question_id": 58629090, "link": "https://stackoverflow.com/questions/58629090/segmentation-fault-on-linux-working-on-windows/58629451#58629451", "title": "Segmentation fault on linux-working on windows", "body": "<p>Your program logic is wrong:</p>\n\n<pre><code>  for (int i = 0; i &lt; size; i++) {\n    sscanf(token, \"%d\", &amp;numbers[i]);\n    token = strtok(NULL, \" \");\n\n    // token may become NULL here\n    // and sscanf will segfault right after\n  }\n</code></pre>\n\n<p>There may be other problems though.</p>\n"}, {"comments": [{"owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "edited": false, "score": 0, "creation_date": 1572453513, "post_id": 58629795, "comment_id": 103567262, "body": "That fixed the segmentation error.  The sscanf line you wrote should be False whenever a non integer type is inside token ?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1572454324, "post_id": 58629795, "comment_id": 103567645, "body": "Good job combining the <code>while (token != NULL) {</code> and <code>for(int i=0;i&lt;size;i++) {</code> conditionals. A one-too-few, or one-too-many on input would almost guarantee a SegFault otherwise."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "edited": false, "score": 0, "creation_date": 1572459360, "post_id": 58629795, "comment_id": 103570020, "body": "@eliranT see my clarification added to the answer"}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 3, "last_activity_date": 1572459335, "last_edit_date": 1572459335, "creation_date": 1572452540, "answer_id": 58629795, "question_id": 58629090, "link": "https://stackoverflow.com/questions/58629090/segmentation-fault-on-linux-working-on-windows/58629795#58629795", "title": "Segmentation fault on linux-working on windows", "body": "<p>With the input file <code>test1.in</code> as shown in the question you specify a size of 8 and provide 9 numbers.</p>\n\n<p>Your code</p>\n\n<pre><code>        while(token!=NULL){\n            for(int i=0;i&lt;size;i++){\n                //printf(\"token is %s\\n\",token);\n                //numbers[i]=token;\n                sscanf(token,\"%d\",&amp;numbers[i]);\n                //printf(\"Inserting %s to the array\\n \",numbers[i]);\n                token=strtok(NULL,\" \");\n            }\n        }\n</code></pre>\n\n<p>will enter the outer <code>while</code> loop and process 8 numbers in the first run of the inner <code>for</code> loop.\nAs you have entered 9 numbers, <code>token</code> will not be <code>NULL</code> and the outer loop will repeat and run the inner loop again. This will partially overwrite the numbers in the array. After processing the 9th number in the first cycle, <code>token</code> will become <code>NULL</code> and in the 2nd cycle <code>sscanf</code> will try to use the <code>NULL</code> pointer which may lead to a segmentation fault.</p>\n\n<p>You should combine the counter and the check for <code>NULL</code> in the loop condition.\nI also recommend to check the return value of <code>sscanf</code> because a value <code>!= 1</code> will indicate invalid input.</p>\n\n<pre><code>        for(int i=0; (i&lt;size) &amp;&amp; (token!=NULL); i++) {\n            if(sscanf(token,\"%d\",&amp;numbers[i]) != 1) {\n                /* invalid input */\n                break;\n            }\n            token=strtok(NULL,\" \");\n        }\n</code></pre>\n\n<p>Of course the code following the loop must handle the case that the loop ends with <code>i &lt; size</code> if not enough values were present.</p>\n\n<p><strong>Edit:</strong> additional clarification below</p>\n\n<p>Note: The error checking for <code>scanf</code> is incomplete. It will return <code>0</code> if it couldn't convert an integer number, but it will also return <code>1</code> if it converted an integer number and anything is following it, e.g. for <code>123abc</code> it will convert <code>123</code> and return <code>1</code>. To check what may follow the number you could add a <code>%c</code> conversion and if the return values is <code>2</code> check the converted character. (<code>'\\n'</code> or <code>'\\r'</code> may be OK here.)</p>\n\n<p>I would prefer to use <code>strtol</code> in a loop to parse the numbers in <code>str</code>.  </p>\n\n<p>BTW: The size calculation for the allocation of <code>str</code> is wrong. <code>sizeof int</code> is the size of the internal binary representation of an <code>int</code> value which is 4 (4 bytes = 32 bits) on many systems. It has nothing to do with how many characters are needed for a string representation of a number. A valid number <code>-2147483648</code> needs 11 characters.</p>\n\n<p>(You could use a buffer <code>str</code> that is too small for the whole line but big enough for more than a valid number if you move the remaining data to the beginning and append new data after pasing a number until you have read the terminating newline.)</p>\n"}], "owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58629795, "answer_count": 2, "score": 1, "last_activity_date": 1572459335, "creation_date": 1572450335, "last_edit_date": 1572454416, "question_id": 58629090, "link": "https://stackoverflow.com/questions/58629090/segmentation-fault-on-linux-working-on-windows", "title": "Segmentation fault on linux-working on windows", "body": "<p>The goal of this program is to scan a string populated with numbers and white spaces between them and insert each number into an array. Then each number from the array is sent to <code>checkPowerOfTwo</code> function which determines if the number sent is a power of two and prints the calculation.</p>\n\n<p>When I run this program on windows everything is workingfine. Running on Linux causes a segmentation fault.</p>\n\n<p>I'm compiling my code on a Linux server with : <code>gcc -std=c99 -Wall -pedantic-errors -Werror -DNDEBUG main.c -o mtm_tot</code>. It compiles successfully with no errors or warnings. The problem arises when I try to run a tester : <code>./mtm_tot&lt; test1.in &gt; tmpout</code>. After pressing <kbd>enter</kbd> on this line <code>Segmentation fault</code> rises.</p>\n\n<pre><code>test1.in contains : 8\n\n5 9 -1 4 20 256 -32 17 32\n</code></pre>\n\n<p>The code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint checkPowerOfTwo(int x);\nint main()\n{\n    int exp,size,sum=0,*numbers;\n    char term,*str=NULL,*token;\n\n    printf(\"Enter size of input:\\n\");\n    if(scanf(\"%d%c\", &amp;size, &amp;term) != 2 || term != '\\n'){\n        printf(\"Invalid Size\\n\");\n        return 0;\n    } if(size&lt;=0){\n        printf(\"Invalid size\\n\");\n        return 0;\n    } else{\n        numbers=(int*)malloc(size * sizeof(int));\n        str=(char*)malloc(sizeof(int)*(size+1) + (size-1)*sizeof(char));\n        if(numbers==NULL||str==NULL){\n            printf(\"Out of memory\\n\");\n            return 0;\n        } //else{\n        //printf(\"Memory allocated\\n\");\n        //}\n        printf(\"Enter numbers:\");\n        fgets (str, sizeof(int)*(size+1) + (size-1), stdin);\n        //printf(\"%s\",str);\n        token=strtok(str,\" \");\n        while(token!=NULL){\n            for(int i=0;i&lt;size;i++){\n                //printf(\"token is %s\\n\",token);\n                //numbers[i]=token;\n                sscanf(token,\"%d\",&amp;numbers[i]);\n                //printf(\"Inserting %s to the array\\n \",numbers[i]);\n                token=strtok(NULL,\" \");\n            }\n        }\n    }\n\n    for(int j =0;j&lt;size;j++)\n    {\n        //sscanf(numbers[j],\"%d\",&amp;x);\n        //printf(\"the number im sending is : %d \",x);\n        exp=checkPowerOfTwo(numbers[j]);\n        if (exp&gt;=0){\n            printf(\"The number %d is a power of 2: %d=2^%d\\n\",numbers[j],numbers[j],exp);\n            sum+=exp;\n        }\n    }\n    printf(\"Total exponent sum is %d\",sum);\n    free(numbers);\n    free(str);\n}\n\nint checkPowerOfTwo(int x)\n{\n    int exponent=0;\n    //sscanf(n,\"%d\",&amp;x);\n    //printf(\"checking number %d\\n\",x);\n    if (x==0){\n        return -1;\n    } if  (x==1){\n        return 0;\n    }\n    while( x != 1)\n    {\n        if(x % 2 != 0){\n            return -1;\n        }\n        x /= 2;\n        exponent++;\n    }\n    return exponent;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1572450294, "post_id": 58628974, "comment_id": 103565410, "body": "That error means you&#39;ve written beyond your allocated memory."}, {"owner": {"reputation": 1566, "user_id": 4847311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fbb34e156577e5c3a5b3b3d1b30f83?s=128&d=identicon&r=PG", "display_name": "Sven Nilsson", "link": "https://stackoverflow.com/users/4847311/sven-nilsson"}, "edited": false, "score": 0, "creation_date": 1572450698, "post_id": 58628974, "comment_id": 103565648, "body": "Unrelated, but your main IF...ELSE clause has duplicated content and is useless. If you learn to use a debugger it will pretty much eliminate the need to ask similar questions."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1572450732, "post_id": 58628974, "comment_id": 103565675, "body": "<code>I am sorry if this question is not formatted properly</code> - This is a good question. You presented your code - a smallest possible reproducible example, your input, the expected output, and what happens upon execution. To follow the spirit of this forum, the only thing that is lacking is a question - something like &quot;How do I fix my code?&quot; or &quot;Where is the error in my code?&quot; or &quot;Why executing my code results in this error?&quot;"}, {"owner": {"reputation": 35849, "user_id": 1424875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HFA9w.png?s=128&g=1", "display_name": "nanofarad", "link": "https://stackoverflow.com/users/1424875/nanofarad"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1572451011, "post_id": 58628974, "comment_id": 103565833, "body": "I think @KamilCuk&#39;s answer pretty much hits the nail on the head--I&#39;d just like to chime in with a quick tool suggestion: If you use the clang compiler and compile with <code>-fsanitize=asan -g -Og</code>, you&#39;ll get a good amount of additional debug data right when the overflow happens (as opposed to some time later when you try to allocate more memory). It&#39;s a bit hard to understand at first but I strongly recommend trying it out on this sample and seeing if you can correlate what you see to the findings presented in the accepted answer."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1572450617, "last_edit_date": 1572450617, "creation_date": 1572450260, "answer_id": 58629066, "question_id": 58628974, "link": "https://stackoverflow.com/questions/58628974/error-in-a-out-realloc-invalid-next-size-0x00000000009c4010/58629066#58629066", "title": "*** Error in `./a.out&#39;: realloc(): invalid next size: 0x00000000009c4010 ***", "body": "<pre><code>arr[i] = temp;\n</code></pre>\n\n<p><code>i</code> is the iterator over input numbers, not iterator over <code>arr</code>. You meant to set the last new array element:</p>\n\n<pre><code>arr[alen - 1] = temp;\n</code></pre>\n\n<p>Accessing array out of bounds is undefined behavior.</p>\n\n<p>Couple of fast notes:</p>\n\n<ul>\n<li>Rather then handling two separate cases with <code>scanf(\"%d,\"</code> and <code>scanf(\"%d\"</code>, just do <code>scanf(\"%d\"</code>  to get the number and read the comma with <code>getchar</code>, ex. <code>int c = getchar(); if (c != ',') { printf(\"End of input\"); }</code>.</li>\n<li>Your code lacks handling allocation errors. <code>arr = realloc(...); if (arr == NULL) { handle_error(); }</code>.</li>\n<li>Your code lacks handling input errors. <code>int a = scanf(\"%d\", ...); if (a != 1) { fprintf(stderr, \"Wrong input\\n\"); abort(); }</code>.</li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 12139388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c79e784475b63202f46d1ed8c6b083a?s=128&d=identicon&r=PG&f=1", "display_name": "4adelaar", "link": "https://stackoverflow.com/users/12139388/4adelaar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 58629066, "answer_count": 1, "score": 2, "last_activity_date": 1572450617, "creation_date": 1572449976, "question_id": 58628974, "link": "https://stackoverflow.com/questions/58628974/error-in-a-out-realloc-invalid-next-size-0x00000000009c4010", "title": "*** Error in `./a.out&#39;: realloc(): invalid next size: 0x00000000009c4010 ***", "body": "<p>The program is supposed to read a sequence of numbers and print the same sequence but without any duplicates.</p>\n\n<p>Their were others with my problem and I did try and implement what was discussed in those questions, but as far as I could tell I was not making the same mistakes and there was a lot of discussion focused on topics that I have little to no understanding of. I am still quite new to memory related things and I suppose programming in general and as you can probably tell from that lengthy error message I am indeed a student. Any help that can be provided would be greatly appreciated.</p>\n\n<p>(I am sorry if this question is not formatted properly, I am quite new to posting on stack overflow).</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n    int len, alen = 0, temp, found = 0, *arr2;\n\n    int *arr = calloc(alen, sizeof(int));\n\n    scanf(\"%d:\", &amp;len);\n\n    for (int i = 0; i &lt; len; i++) {\n        if (i == len-1) {\n            scanf(\"%d\", &amp;temp);\n            for (int j = 0; j &lt; alen; j++) {\n                if (temp == arr[j]) {\n                    found = 1;\n                }\n            }\n            if (found == 0) {\n                alen++;\n                arr2 = (int *) realloc(arr, sizeof(int)*alen);\n                arr = arr2;\n                arr[i] = temp;\n                printf(\"%d \", temp);\n            }\n        } else {\n            scanf(\"%d,\", &amp;temp);\n            for (int j = 0; j &lt; alen; j++) {\n                if (temp == arr[j]) {\n                    found = 1;\n                }\n            }\n            if (found == 0) {\n                alen++;\n                arr2 = (int *) realloc(arr, sizeof(int)*alen);\n                arr = arr2;\n                arr[i] = temp;\n                printf(\"%d \", temp);\n            }\n        }\n        found = 0;\n    }\n    printf(\"\\n\");\n    free(arr);\n    return 0;\n}\n</code></pre>\n\n<p>Normal input:</p>\n\n<pre><code>8:1,2,4,3,2,1,7,8\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>1 2 4 3 7 8\n</code></pre>\n\n<p>Actual Output:</p>\n\n<pre><code>*** Error in `./a.out': realloc(): invalid next size: 0x00000000009c4010 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x777e5)[0x7f261a3167e5]\n/lib/x86_64-linux-gnu/libc.so.6(+0x834aa)[0x7f261a3224aa]\n/lib/x86_64-linux-gnu/libc.so.6(realloc+0x179)[0x7f261a323839]\n./a.out[0x400812]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0)[0x7f261a2bf830]\n./a.out[0x400659]\n======= Memory map: ========\n00400000-00401000 r-xp 00000000 08:01 788482                             /home/student/impProg/lab7/noDuplicates/a.out\n00600000-00601000 r--p 00000000 08:01 788482                             /home/student/impProg/lab7/noDuplicates/a.out\n00601000-00602000 rw-p 00001000 08:01 788482                             /home/student/impProg/lab7/noDuplicates/a.out\n009c4000-009e5000 rw-p 00000000 00:00 0                                  [heap]\n7f2614000000-7f2614021000 rw-p 00000000 00:00 0 \n7f2614021000-7f2618000000 ---p 00000000 00:00 0 \n7f261a089000-7f261a09f000 r-xp 00000000 08:01 5251                       /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f261a09f000-7f261a29e000 ---p 00016000 08:01 5251                       /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f261a29e000-7f261a29f000 rw-p 00015000 08:01 5251                       /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f261a29f000-7f261a45f000 r-xp 00000000 08:01 933                        /lib/x86_64-linux-gnu/libc-2.23.so\n7f261a45f000-7f261a65f000 ---p 001c0000 08:01 933                        /lib/x86_64-linux-gnu/libc-2.23.so\n7f261a65f000-7f261a663000 r--p 001c0000 08:01 933                        /lib/x86_64-linux-gnu/libc-2.23.so\n7f261a663000-7f261a665000 rw-p 001c4000 08:01 933                        /lib/x86_64-linux-gnu/libc-2.23.so\n7f261a665000-7f261a669000 rw-p 00000000 00:00 0 \n7f261a669000-7f261a68f000 r-xp 00000000 08:01 922                        /lib/x86_64-linux-gnu/ld-2.23.so\n7f261a875000-7f261a878000 rw-p 00000000 00:00 0 \n7f261a88d000-7f261a88e000 rw-p 00000000 00:00 0 \n7f261a88e000-7f261a88f000 r--p 00025000 08:01 922                        /lib/x86_64-linux-gnu/ld-2.23.so\n7f261a88f000-7f261a890000 rw-p 00026000 08:01 922                        /lib/x86_64-linux-gnu/ld-2.23.so\n7f261a890000-7f261a891000 rw-p 00000000 00:00 0 \n7ffca88e2000-7ffca8903000 rw-p 00000000 00:00 0                          [stack]\n7ffca8921000-7ffca8923000 r--p 00000000 00:00 0                          [vvar]\n7ffca8923000-7ffca8925000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n1 2 4 3 7 Aborted (core dumped)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1572449447, "post_id": 58628804, "comment_id": 103564916, "body": "Start from understanding that <code>argv[i]</code> is a <i>string</i>"}, {"owner": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "edited": false, "score": 0, "creation_date": 1572449477, "post_id": 58628804, "comment_id": 103564926, "body": "Use <code>atoi</code> to convert &quot;2&quot; to an <code>int</code> or <code>atof</code> to convert it to a <code>double</code>."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 2, "creation_date": 1572449498, "post_id": 58628804, "comment_id": 103564938, "body": "Also keep in mind that <code>argv</code> isn&#39;t doing any computation, it&#39;s just data. Rather, you&#39;re doing some computation that <i>uses</i> <code>argv</code>."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1572449608, "post_id": 58628804, "comment_id": 103564986, "body": "As posted, <code>argv[i]</code> should be telling you that <code>i</code> is undefined. If you wanted <code>argv[1]</code> you should make sure <code>1</code> is not greater than (or equal to) <code>argc</code>."}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1572449688, "creation_date": 1572449688, "answer_id": 58628883, "question_id": 58628804, "link": "https://stackoverflow.com/questions/58628804/how-do-i-use-argc-argv-to-compute-in-c/58628883#58628883", "title": "How do I use argc, *argv[] to compute in C?", "body": "<p>Command line arguments are passed to the program as <em>strings</em> - you'll need to use <code>atof</code> or <code>strtod</code> to convert the string representation of a value to its numeric equivalent.  </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main( int argc, char **argv )\n{\n  // All kinds of error checking ommitted\n  double input = strtod( argv[1], NULL );\n  double v = 4.0 / 3.0 * 3.14 * input * input * input;\n  ...\n}\n</code></pre>\n\n<p>Unless you're really constrained on space, use <code>double</code> instead of <code>float</code>.  </p>\n"}, {"tags": [], "owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "is_accepted": false, "score": 1, "last_activity_date": 1572449852, "creation_date": 1572449852, "answer_id": 58628940, "question_id": 58628804, "link": "https://stackoverflow.com/questions/58628804/how-do-i-use-argc-argv-to-compute-in-c/58628940#58628940", "title": "How do I use argc, *argv[] to compute in C?", "body": "<p>You don't have a variable <code>i</code>. You can think of <code>argv</code> as a string array if you want, <code>argv[0]</code> is the name of your executable so in this case <code>./radius</code>,  <code>argv[1]</code> in your case will be 2 and so on.</p>\n\n<p>One thing you should keep in mind is that it's good practice to check <code>argc</code> to ensure you have the parameters you want, <code>argc</code> will tell you the length of <code>argv</code> so in your case it will be 2.</p>\n\n<p>you can then use the number you passed like:</p>\n\n<pre><code>double arg = atof(argv[1]);\ndouble v = 4.0 / 3.0 * 3.14 * arg * arg * arg;\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>int i = 1;\ndouble arg = atof(argv[i]);\ndouble v = 4.0 / 3.0 * 3.14 * arg * arg * arg;\n</code></pre>\n\n<p>or again (the worst method):</p>\n\n<pre><code>double v = 4.0 / 3.0 * 3.14 * atof(argv[1]) * atof(argv[1]) * atof(argv[1]);\n</code></pre>\n\n<p>If for some reason you <strong>REALLY</strong> don't want to have separate variables</p>\n\n<p>but like i said, you should first check that you have enough arguments with <code>argc</code> and that the argument is what you actually want (E.G. a number and not a string)</p>\n"}], "owner": {"reputation": 1, "user_id": 12298186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5889f57af7f6963be22dc59016a910b8?s=128&d=identicon&r=PG&f=1", "display_name": "asheseux16", "link": "https://stackoverflow.com/users/12298186/asheseux16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1572449852, "creation_date": 1572449405, "last_edit_date": 1572449669, "question_id": 58628804, "link": "https://stackoverflow.com/questions/58628804/how-do-i-use-argc-argv-to-compute-in-c", "title": "How do I use argc, *argv[] to compute in C?", "body": "<p>I'm calculating the volume of a sphere with a r-meter radius using argc and *argv[], I'm thinking if I enter \"./radius 2\" on the command line, argv[1] would become \"2\", so that the code would be:</p>\n\n<pre><code>        int main(int argc, char *argv[]){\n        float v;\n\n        v = 4.0 / 3.0 * 3.14 * argv[1] * argv[1] * argv[1];\n        printf(\"V = %f\\n\", v);\n        return 0;\n        }\n</code></pre>\n\n<p>but it seems that argv can't do the calculation.\nWhat should I do?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1572448874, "post_id": 58628595, "comment_id": 103564581, "body": "You should distinguish &quot;character&quot; and &quot;string&quot;. (String in C is NUL-terminated array of characters.)"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1572449035, "post_id": 58628595, "comment_id": 103564660, "body": "I think you simply mean &quot;space&quot;, not &quot;backspace&quot;."}, {"owner": {"reputation": 1, "user_id": 12298161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92db6e009d31d6e766dca4a36dbf0986?s=128&d=identicon&r=PG&f=1", "display_name": "StYl3z", "link": "https://stackoverflow.com/users/12298161/styl3z"}, "edited": false, "score": 0, "creation_date": 1572449078, "post_id": 58628595, "comment_id": 103564696, "body": "to explain what the code SHOULD do, is reading the textfile character by character into the variable ch and if the current character is a space, which is compared by the function ascii to integer to its value and if it&#39;S a backspace, so as an int &#39;32&#39;, it&#39;s adding the end-of-string NULL! to the file, but I do not know how it should go on :/  edit:\\\\ oh, yeah i mean space not backspace :D"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1572449202, "post_id": 58628595, "comment_id": 103564783, "body": "You should really consider limiting the nesting, as that makes the code harder to read, understand, follow and maintain."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1572449224, "post_id": 58628595, "comment_id": 103564796, "body": "Also please read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1572449622, "post_id": 58628595, "comment_id": 103564991, "body": "Algorithm you want: 1. read a line. 2. process the line,that is put a <code>NUL</code> character at the first occurence of <code>&#39; &#39;</code> (space). 3. write the line. Repeat this until the end of the file. Hint 3: read the chapter dealing with strings in your beginner&#39;s C text book."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1572449916, "post_id": 58628595, "comment_id": 103565149, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 12298161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92db6e009d31d6e766dca4a36dbf0986?s=128&d=identicon&r=PG&f=1", "display_name": "StYl3z", "link": "https://stackoverflow.com/users/12298161/styl3z"}, "edited": false, "score": 0, "creation_date": 1572450002, "post_id": 58628595, "comment_id": 103565194, "body": "I was thinking about using fgets but I do not find the correct way using it in my book @ the library explaining part :/"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1572450194, "post_id": 58628595, "comment_id": 103565331, "body": "@StYl3z then maybe you should post a question about <i>that</i>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1572458771, "post_id": 58628595, "comment_id": 103569753, "body": "You don&#39;t want <code>strtok</code> here but the simpler and more appropriate <code>strchr</code> here"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12298161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92db6e009d31d6e766dca4a36dbf0986?s=128&d=identicon&r=PG&f=1", "display_name": "StYl3z", "link": "https://stackoverflow.com/users/12298161/styl3z"}, "edited": false, "score": 0, "creation_date": 1572453596, "post_id": 58629178, "comment_id": 103567304, "body": "yeah, saw that it*s ugly putting code in answer and toggling code is not working for any reason. nvm. the solution with strtok using &quot; &quot; as delimiter is cutting it off, but will repeat code like this:  I am a String Iam a String Im a String &gt;&gt;&gt; IaaString for any reason, although I read I have to use it multiple times :/"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1572450544, "creation_date": 1572450544, "answer_id": 58629178, "question_id": 58628595, "link": "https://stackoverflow.com/questions/58628595/searching-a-text-file-for-string-separated-by-space-and-cut-off-everything-afte/58629178#58629178", "title": "Searching a text file for string, separated by space and cut off everything after the space", "body": "<p>You want something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char* argv[])\n{\n  if (argc != 3)\n  {\n    display error message\n    return 1;\n  }\n\n  FILE *infile = fopen(argv[1], \"r\");  // Use \"r\", not 'w'.\n                                       // Use consistant variable naming: infile and outfile\n  if (infile == NULL)                  // file could be opened?\n  {\n    display error message\n    return 1;\n  }\n\n  FILE *outfile = fopen(argv[2], \"w\");   // Use \"w\", not 'a'\n  if (outfile == NULL)                   // file could be opened?\n  {\n    display error message\n\n    fclose(infile);                   // close infile that is obviously open here\n    return 1;\n  }\n\n  do\n  {\n    char line[1000];\n\n    if (fgets(line, sizeof line, infile) == NULL)   // read complete line\n      break;                                        // enf of file : stop loop\n\n      process line\n\n      fputs(line, outfile);                         // write line\n  } while (1);\n\n  fclose(infile);\n  fclose(outfile);\n}\n</code></pre>\n\n<p>There is still code for you to write.\nThere may be errors in this code, but you should get the idea.</p>\n"}], "owner": {"reputation": 1, "user_id": 12298161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92db6e009d31d6e766dca4a36dbf0986?s=128&d=identicon&r=PG&f=1", "display_name": "StYl3z", "link": "https://stackoverflow.com/users/12298161/styl3z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572454170, "creation_date": 1572448754, "last_edit_date": 1572454170, "question_id": 58628595, "link": "https://stackoverflow.com/questions/58628595/searching-a-text-file-for-string-separated-by-space-and-cut-off-everything-afte", "title": "Searching a text file for string, separated by space and cut off everything after the space", "body": "<p>I want to cut off everything in a text file after the strings being separated by a space on each line, so if for example the text file contains the Line:</p>\n\n<pre><code>I am a String.\nIam a String too.\n</code></pre>\n\n<p>There would only be <code>I</code> in the output file on the first line of the output file, and on the second line there only would be <code>Iam</code> left of the line.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n    FILE *input,*output;\n    char line[40];\n    if(argc == 3){\n        input = fopen(argv[1],\"r\");\n        output = fopen(argv[2],\"w\");\n        if(input!= NULL){\n                while(!feof(input)){\n                    fgets(line,sizeof line,input);\n                    strtok(line,\" \");                    \n                    fputs(line,output);                  \n\n                }\n                fclose(input);\n                fclose(output);\n        }\n    }\n}\n\n</code></pre>\n\n<p>this is how it'S almost completeley is working although its obfuscating more lines with each others :/</p>\n"}, {"tags": ["c", "arrays", "labview"], "comments": [{"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1572449948, "post_id": 58628446, "comment_id": 103565169, "body": "What&#39;s the function prototype look like?"}, {"owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "reply_to_user": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1572470572, "post_id": 58628446, "comment_id": 103574625, "body": "@Nina if Joymaker is writing the C code, then joymaker is in charge of creating the function prototype."}], "answers": [{"comments": [{"owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "edited": false, "score": 0, "creation_date": 1572470720, "post_id": 58633803, "comment_id": 103574675, "body": "The memory layout for strings and arrays hasn&#39;t changed since LabVIEW 1.0 back in 1986, which is why screenshots in that PDF file are taken from the original Macintosh."}, {"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1572512246, "post_id": 58633803, "comment_id": 103585233, "body": "And if you need any further support on the PDF, just dial into NI&#39;s BBS or fax their faxback service!"}], "tags": [], "owner": {"reputation": 2522, "user_id": 1332468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/47c408da0aac005a99e87161caf3b903?s=128&d=identicon&r=PG", "display_name": "srm", "link": "https://stackoverflow.com/users/1332468/srm"}, "is_accepted": true, "score": 3, "last_activity_date": 1572470422, "creation_date": 1572470422, "answer_id": 58633803, "question_id": 58628446, "link": "https://stackoverflow.com/questions/58628446/labview-call-library-function-yielding-array-of-strings/58633803#58633803", "title": "LabVIEW Call Library Function yielding array of strings", "body": "<p>You need the <a href=\"http://www.ni.com/pdf/manuals/320539c\" rel=\"nofollow noreferrer\">LabVIEW Code Interface Reference Manual</a> to figure this stuff out. </p>\n\n<p>You are writing a C function that will return a 2D array of strings to LabVIEW. That means you need to be returning LabVIEW's data structure and using LabVIEW's memory allocator. Include \"extcode.h\" in your C file (ships with LabVIEW). Then create the following C code: </p>\n\n<pre><code>#include \"extcode.h\"\n\nstruct String2DArrayBlock {\n    int32 dimensionSize1;\n    int32 dimensionSize2;\n    LStrHandle stringArray[1]; // Yes, this is intentional. Do not use LStrHandle* because that syntax changes the memory allocation. Old-school C code. LabVIEW's own C++ code has wrappers for managing this with more type safety. \n};\n\ntypedef String2DArrayBlock** String2DArrayHandle;\n\nMgErr GenerateMyStrings(String2DArrayHandle *ptrToHandle) {\n    if (!ptrToHandle)\n        return mgArgErr; // Gotta pass a location for us to allocate.\n\n    if (*ptrToHandle) {\n        // This handle is already allocated. I'm not going to walk you through all the code needed to deallocate.\n        return mgArgErr;\n    }\n\n    const int32 dimSize1 = ComputeHeight(); // This is your function... whereever your data is coming from.\n    const int32 dimSize2 = ComputeWidth(); // Same here. \n\n    const int32 numberOfElements = dimSize1 * dimSize2;\n\n    if (numberOfElements == 0) {\n        return mgNoErr; // Done. NULL means empty array, and the handle is already NULL.\n    }\n\n    // DSNewHClr allocates the block and flood fills it with all zeros.\n    *ptrToHandle = (String2DArrayHandle)DSNewHClr(sizeof(String2DArrayBlock) + ((numberOfElements - 1) * sizeof(LStrHandle))); // -1 because the sizeof block has 1 element. \n    if (!*ptrToHandle)\n        return mFullErr; // Out of memory\n\n    (**ptrToHandle)-&gt;dimensionSize1 = dimSize1;\n    (**ptrToHandle)-&gt;dimensionSize2 = dimSize2;\n\n    LStrHandle *current = (**ptrToHandle)-&gt;stringArray;\n    for (int32 i = 0; i &lt; numberOfElements; ++i, ++current) {\n        std::string myCurrentString = GetMyCurrentString(i); // You write this however you look up the individual strings.\n        if (myCurrentString.empty())\n            continue; // NULL means empty string\n        *current = (LStrHandle)DSNewHClr(sizeof(LStr)); // Allocates a zero-length LStrHandle.\n        if (!*current)\n            return mFullErr; // The array will be partially filled, but it is in a safe state for early return.\n        MgErr err = LStrPrintf(*current, (CStr)\"%s\", myCurrentString.c_str());\n        if (err)\n            return err; // The array will be partially filled, but it is in a safe state for early return.\n    }\n\n    return mgNoErr;\n}\n</code></pre>\n\n<p>Compile your code against the LabVIEW run-time engine (lvrt.dll).</p>\n\n<p>In your G code, drop a Call Library Node, add a parameter that is \"Adapt to type\" and \"Pointers to Handles\", and wire it with an empty 2D array. And you're done. </p>\n"}], "owner": {"reputation": 519, "user_id": 512480, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5ef1b2bd21509574a018660d74da5923?s=128&d=identicon&r=PG", "display_name": "Joymaker", "link": "https://stackoverflow.com/users/512480/joymaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 1, "accepted_answer_id": 58633803, "answer_count": 1, "score": 2, "last_activity_date": 1572813353, "creation_date": 1572448270, "last_edit_date": 1572813353, "question_id": 58628446, "link": "https://stackoverflow.com/questions/58628446/labview-call-library-function-yielding-array-of-strings", "title": "LabVIEW Call Library Function yielding array of strings", "body": "<p>I need to interface C code to LabVIEW, and my C function needs to give back a two dimensional array of strings. I would rather not be forced to predetermine the size of the array in advance. So I want to know, what is the right data format to use (handle to array of C string pointers? Handle to array of string handles?), how to properly do the allocation, and whether it is better to use an array parameter or a return type. The dialog provided for Call Library Function Node only supports arrays of numeric types, so I'm a little bit lost on how to structure this.</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1572447919, "post_id": 58628305, "comment_id": 103564039, "body": "If you use <code>free</code> inside the loop you are trying to free the same pointer multiple times. And clearly you don&#39;t want to do this as it is only allocated once. The whole &quot;re-use&quot; thing is irrelevant"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 4, "creation_date": 1572448033, "post_id": 58628305, "comment_id": 103564120, "body": "Each value returned by malloc can be freed only once."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1572448035, "post_id": 58628305, "comment_id": 103564121, "body": "No, each time <code>malloc()</code> is called, an area of memory is given to it my the OS, and there is no guarantee that it comes from the same location.  Do you know about <code>realloc()</code>?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1572448142, "post_id": 58628305, "comment_id": 103564173, "body": "You are using <code>assert</code> incorrectly.  It may have such uses in other languages, but not in C.  You should check for errors, and assert is <i>not</i> a mechanism for doing error checking.  It is a mechanism for documenting the logic of your code."}], "answers": [{"comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 1443, "user_id": 1738879, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c8b6bb8a36582396e2afdac592b8a7c4?s=128&d=identicon&r=PG&f=1", "display_name": "PedroA", "link": "https://stackoverflow.com/users/1738879/pedroa"}, "edited": false, "score": 0, "creation_date": 1572448532, "post_id": 58628407, "comment_id": 103564403, "body": "@PedroA sorry, I made an error. It doesn&#39;t use different memory every time, it uses the same memory every iteration."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 3, "last_activity_date": 1572448460, "last_edit_date": 1572448460, "creation_date": 1572448137, "answer_id": 58628407, "question_id": 58628305, "link": "https://stackoverflow.com/questions/58628305/does-malloc-reuse-the-same-memory-address-in-loop/58628407#58628407", "title": "Does malloc() reuse the same memory address in loop?", "body": "<p><code>free(x);</code> frees the memory allocated by <code>char *x = malloc(...</code>. It frees all of the memory, and you don't have to worry about how much memory that was, as it keeps track of that. You just have to call <code>free(x);</code> <strong>once</strong> as you correctly do. This is why you get the error if you free it inside the loop.</p>\n\n<blockquote>\n  <p>Does it mean that the memory address block of x will be \"re-used\" at\n  each iteration? (I'd say yes, and that would actually be what I wanted\n  in this case)</p>\n</blockquote>\n\n<p>Yes, you use the same memory. It overwrites the memory every time.</p>\n\n<blockquote>\n  <p>In this case, is it safe to only free the allocated memory of x\n  outside the loop scope?</p>\n</blockquote>\n\n<p>Yes, you have to free it outside of the loop. Because if you free it, then all of it is freed. If you did that inside the loop, then it would be undefined behavior to keep accessing that memory in following loop iterations.</p>\n"}, {"tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": false, "score": 1, "last_activity_date": 1572448568, "creation_date": 1572448568, "answer_id": 58628542, "question_id": 58628305, "link": "https://stackoverflow.com/questions/58628305/does-malloc-reuse-the-same-memory-address-in-loop/58628542#58628542", "title": "Does malloc() reuse the same memory address in loop?", "body": "<p>You can use and reuse dynamically allocated memory as long as you have not called free() on it. If you free it and attempt to use it again, then you will have undefined behaviour. </p>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1572451018, "last_edit_date": 1572451018, "creation_date": 1572449225, "answer_id": 58628754, "question_id": 58628305, "link": "https://stackoverflow.com/questions/58628305/does-malloc-reuse-the-same-memory-address-in-loop/58628754#58628754", "title": "Does malloc() reuse the same memory address in loop?", "body": "<p>You can continue to reusing memory (eg <code>buf</code> created by <code>char *buf = calloc(sizeOfBuf);</code> ) allocated to you on a single call to <code>calloc()</code>, until <code>free(buf)</code> is called, just as if buf was created statically, eg <code>char buf[sizeOfBuf]; = 0</code>.  However, <em>if the size of the buffer initially created by using <code>calloc()</code> needs to change</em>,  <em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_realloc.htm\" rel=\"nofollow noreferrer\">realloc()</a></em> is available to do this, and is the preferable method. There are some caveats about using realloc however.  Here is an example of using <code>realloc</code>, this one packaged into a function that resizes an existing dynamically allocated buffer, and takes care of some of the caveats:</p>\n\n<p>realloc usage example:</p>\n\n<pre><code>// initial call to calloc\nchar *buf = calloc(sizeOfBuf);\nif(buf)\n{\n    while(someConditionIsTrue)\n    {\n        // read new content\n        //...\n        //new content needs to be added to buf\n        char *tmp = realloc(buf, newSizeOfBuffer);\n        if(!tmp)//if failed...\n        {\n            free(buf);//... free original buf to prevent memory loss\n            return NULL;// return null, caller must test for this\n        }\n        buf = tmp;//...else copy new mem location back to original pointer\n        //continue doing stuff with buf\n    }\n\n    //when done with buf, free it\n    free(buf);\n}\n</code></pre>\n\n<p>One other suggestion, consider <code>calloc()</code> returns uninitialized memory, i.e. you own a space that contains whatever was occupying it when it was given to you.  It is a good idea to follow that command with a method to clean up the buffer:</p>\n\n<pre><code>memset(buf, 0, sizeOfBuf);\n</code></pre>\n\n<p>Or use <em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_calloc.htm\" rel=\"nofollow noreferrer\">calloc()</a></em>.  </p>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": true, "score": 2, "last_activity_date": 1572459405, "last_edit_date": 1572459405, "creation_date": 1572449992, "answer_id": 58628980, "question_id": 58628305, "link": "https://stackoverflow.com/questions/58628305/does-malloc-reuse-the-same-memory-address-in-loop/58628980#58628980", "title": "Does malloc() reuse the same memory address in loop?", "body": "<p>The <code>malloc()</code> function provides a pointer to an area of memory that can then be used just like any pointer to a memory location.</p>\n\n<p>The way to think of <code>malloc()</code> and <code>free()</code> is to consider it in terms of who owns a memory area. The <code>malloc()</code> function owns the memory that it is managing. When you call the <code>malloc()</code> function, or <code>calloc()</code> function, the function takes some of the memory it is managing and transfers ownership to you. When the function is called and the memory allocated there is a transfer of ownership from the memory management system of <code>malloc()</code> to you and at that point you own that memory and it is up to you to manage it. When the <code>free()</code> function is called to release the memory, you are transferring ownership of the memory area from you back to the memory management system of <code>malloc()</code>.</p>\n\n<p>Whenever a transfer of ownership is done, the entity that is giving up ownership is not supposed to do anything further with the memory area since it no longer owns it.</p>\n\n<p>So when you do the <code>malloc()</code> you now own the memory and can use and reuse the memory area as much or as little as you want until such time that you call the <code>free()</code> function to give it back to <code>malloc()</code>.</p>\n\n<p>A pointer to a memory region given by <code>malloc()</code> is like any other pointer so far as using it is concerned.</p>\n\n<p>Once you have transferred ownership of a memory area back to <code>malloc()</code> by using thee <code>free()</code> function, you can't call <code>free()</code> again with the same pointer without introducing an error. Once a memory area has been returned using <code>free()</code> you no longer have ownership of the memory so you shouldn't try to do anything else with it and that includes calling <code>free()</code> with the pointer again.</p>\n\n<p>How <code>malloc()</code> manages memory is an implementation detail that will vary depending on the compiler and the C Runtime used. In some cases if you <code>malloc()</code> memory then <code>free()</code> the memory and then <code>malloc()</code> the same amount of memory again you may get lucky and get the same memory area again however it is not something you can count on or should expect.</p>\n\n<p><code>malloc()</code> provides you a pointer to a memory area that has a couple of guarantees. First of all the memory area provided will be at least as large as you requested. It may be larger but it won't be smaller than what you requested. Secondly the address provided will be on a memory boundary suitable for the machine architecture so that you can use the address provided for any variable type whether a built in such as <code>int</code> or <code>double</code> or a <code>struct</code> or an array of some type.</p>\n\n<p>As the owner of the memory area provided by <code>malloc()</code> you are responsible for giving the memory area back to the <code>malloc()</code> functionality once you are done with it.</p>\n\n<p>Your other primary responsibility is to respect the size of the memory area and to not write a larger data block into the area than the size requested when the <code>malloc()</code> was done. You are guaranteed only the amount of memory requested and writing a larger block of data into the memory will probably overwrite memory that you do not own but is owned by something else.</p>\n\n<p>Unfortunately because the <code>malloc()</code> functionality, at least the optimized or non-debug version of the library, is designed with little as possible overhead, the functionality has few consistency and sanity checks in place. The <code>malloc()</code> functionality trusts that you will obey the rules and guidelines and only use what you own. And often when you break the rules and guidelines, you won't see the effect at the point where you have made a mistake but rather at some other point when some mysterious memory corruption is discovered and your program crashes.</p>\n"}], "owner": {"reputation": 1443, "user_id": 1738879, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c8b6bb8a36582396e2afdac592b8a7c4?s=128&d=identicon&r=PG&f=1", "display_name": "PedroA", "link": "https://stackoverflow.com/users/1738879/pedroa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "accepted_answer_id": 58628980, "answer_count": 4, "score": 3, "last_activity_date": 1572459904, "creation_date": 1572447821, "last_edit_date": 1572459904, "question_id": 58628305, "link": "https://stackoverflow.com/questions/58628305/does-malloc-reuse-the-same-memory-address-in-loop", "title": "Does malloc() reuse the same memory address in loop?", "body": "<p>I'm starting to learn C programming and stumbled upon a situation that shows my lack of understanding of how memory allocation with <code>malloc()</code> works. </p>\n\n<p>In a loop like the following:</p>\n\n<pre><code>// will only know `xlen` at runtime so I guess I have to use malloc here\nchar *x = malloc((xlen + 1) * sizeof(*x));\nassert(x != NULL);  // memory allocation failed\n\nwhile (fgets(line, sizeof(line), fp) != NULL) {\n    strncpy(x, line, xlen);  // copy first xlen characters of line\n    x[xlen] = '\\0';          // ensure null terminating string\n\n    // do something with x\n    // x can now be \"reused\" for another line/loop iteration\n\n    // free(x) - errors out with \"pointer being freed was not allocated\"\n}\nfclose(fp)\nfree(x);\n</code></pre>\n\n<p>If the statement <code>free(x)</code> is called inside the loop then when I run this program I get an error message something like <code>a.out(37575,0x7fff964ce3c0) malloc: *** error for object 0x7fab47c02630: pointer being freed was not allocated</code>.</p>\n\n<p>Why am I seeing this error message and what is causing it?</p>\n\n<p>Will the memory address block of <code>x</code> be \"re-used\" at each iteration of the loop? (I'd say yes, and that would actually be what I wanted in this case) In this case, is it safe to <em>only</em> free the allocated memory of <code>x</code> outside the scope of the loop?</p>\n"}, {"tags": ["c", "undefined-behavior", "sizeof", "c-strings", "strlen"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1572446410, "post_id": 58627814, "comment_id": 103563074, "body": "Because if the array does not have the static storage duration then the code snippet behavior is undefined because the array is not initialized."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1572446428, "post_id": 58627814, "comment_id": 103563085, "body": "<i>Undefined behavior</i> because the array is not initialized? Please post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. Your <code>printf</code> format doesn&#39;t contain conversion specifiers, so <code>22</code> nor <code>7</code> won&#39;t be printed."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 4, "creation_date": 1572446609, "post_id": 58627814, "comment_id": 103563213, "body": "The new code also invokes <i>undefined behavior</i> for type mismatch: <code>strlen</code> and <code>sizeof</code> returns <code>size_t</code> while <code>%d</code> requires <code>int</code>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1572453229, "post_id": 58627814, "comment_id": 103567127, "body": "The array is not &quot;empty&quot;, it is unitialised."}, {"owner": {"reputation": 9263, "user_id": 1536976, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cc2372591e00f2ab504b59b4f7cbed43?s=128&d=identicon&r=PG", "display_name": "Trilarion", "link": "https://stackoverflow.com/users/1536976/trilarion"}, "edited": false, "score": 0, "creation_date": 1572453538, "post_id": 58627814, "comment_id": 103567279, "body": "This question should motivate more why both functions are expected to return the same value here?"}], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 2235468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3811eb9dbd96a4078c61f641545de1a1?s=128&d=identicon&r=PG", "display_name": "Roel Balink", "link": "https://stackoverflow.com/users/2235468/roel-balink"}, "is_accepted": false, "score": 3, "last_activity_date": 1572446536, "creation_date": 1572446536, "answer_id": 58627885, "question_id": 58627814, "link": "https://stackoverflow.com/questions/58627814/why-is-it-that-the-string-length-of-an-empty-array-differs-from-the-array-size/58627885#58627885", "title": "Why is it that the string length of an empty array differs from the array size?", "body": "<p>This is due to the fact that the allocated space of your array isn't cleared.\nSo on the stack where you <code>char b[7];</code> is placed there is random data.\nThe strlen() function starts on you the memory location b[0] to search for an end character '\\0'. </p>\n\n<p>In your case the first '\\0' character is found and the 23rd location resulting in a length of 22. This number of 22 is undefined behaviour and can be different everytime you run your code. </p>\n\n<p>If you initialize your array with '\\0' at b[0] it will return a length of 0.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1572447311, "last_edit_date": 1572447311, "creation_date": 1572446610, "answer_id": 58627909, "question_id": 58627814, "link": "https://stackoverflow.com/questions/58627814/why-is-it-that-the-string-length-of-an-empty-array-differs-from-the-array-size/58627909#58627909", "title": "Why is it that the string length of an empty array differs from the array size?", "body": "<blockquote>\n  <p>When returning the length and the size of an empty string in C, the\n  values differ. Why is that so?</p>\n</blockquote>\n\n<p>If the array does not have the static storage duration then it does not contain a string even empty. It is just uninitialized and has indeterminate value. So using the function <code>strlen</code> results in undefined behavior.</p>\n\n<p>Pay attention to that these calls</p>\n\n<pre><code>printf(\"String Length: %d\", strlen(b));\nprintf(\"String Size: %d\", sizeof(b));\n</code></pre>\n\n<p>have undefined behavior because there are used incorrect conversion specifiers. You have to use <code>%zu</code> instead of <code>%d</code>.</p>\n\n<p>You could declare the array like</p>\n\n<pre><code>char b[7] = \"\";\n</code></pre>\n\n<p>or like</p>\n\n<pre><code>char b[7] = { '\\0' };\n</code></pre>\n\n<p>or even like</p>\n\n<pre><code>char b[7] = { [6] = '\\0' };\n</code></pre>\n\n<p>In these cases the array indeed contains an empty string and the function <code>strlen</code> will return 0.</p>\n\n<p>In any case the function <code>strlen</code> and the operator <code>sizeof</code> return different values because the function <code>strlen</code> does not count the terminating zero of a string stored in an array.</p>\n\n<p>Consider the following demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) \n{\n    char s[] = \"Hello\";\n\n    printf( \"strlen( s ) = %zu\\n\", strlen( s ) );\n    printf( \"sizeof( s ) = %zu\\n\", sizeof( s ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>strlen( s ) = 5\nsizeof( s ) = 6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1572446904, "creation_date": 1572446904, "answer_id": 58628008, "question_id": 58627814, "link": "https://stackoverflow.com/questions/58627814/why-is-it-that-the-string-length-of-an-empty-array-differs-from-the-array-size/58628008#58628008", "title": "Why is it that the string length of an empty array differs from the array size?", "body": "<p>The reason why <code>strlen</code> and <code>sizeof</code> gives different results is that the <code>sizeof</code> operator gives you the size of the array itself (in bytes) while the <code>strlen</code> function counts the number of \"characters\" until it finds a string null-terminator.</p>\n\n<p>Even if you initialized the array (like e.g. <code>char b[7] = \"a\";</code>) the <code>strlen</code> function would give a different result from the <code>sizeof</code> operator.</p>\n\n<p>There's simply no way you can make both give the same result without having undefined behavior one way or another.</p>\n\n<hr>\n\n<p>Now as for why <code>strlen</code> returns <code>22</code> in your case, it's because uninitialized local variables, even arrays, really <em>are</em> uninitialized. Their values and contents are <em>indeterminate</em> and could be seen as random or garbage. Your array just happen to not have a random null-terminator inside it.</p>\n\n<p>When you pass a pointer to the first element of the array to the <code>strlen</code> function, it will continue to look for the null-terminator even if it goes out of bounds. And in your specific case there just happens to be a byte corresponding to the null-terminator after <code>strlen</code> have counted 22 \"random\" or \"garbage\" characters.</p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 0, "last_activity_date": 1572453188, "last_edit_date": 1572453188, "creation_date": 1572447202, "answer_id": 58628104, "question_id": 58627814, "link": "https://stackoverflow.com/questions/58627814/why-is-it-that-the-string-length-of-an-empty-array-differs-from-the-array-size/58628104#58628104", "title": "Why is it that the string length of an empty array differs from the array size?", "body": "<p>One [fixed-size] array can hold different length strings (at different times, of course)</p>\n\n<pre><code>char t[10]; x = sizeof t; /* 10 */\nx = strlen(t); /* BANG: t  is not valid */\nt[0] = '\\0'; x = strlen(t); /* 0 */\nstrcpy(t, \"1\"); x = strlen(t); /* 1 */\nstrcpy(t, \"12345678\"); x = strlen(t); /* 8 */\nstrcpy(t, \"123456789\"); x = strlen(t); /* 9 */\nstrcpy(t, \"1234567890\"); /* BANG */\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9086136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CkFRO.gif?s=128&g=1", "display_name": "\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u958b\u767a\u8005", "link": "https://stackoverflow.com/users/9086136/%e3%82%bd%e3%83%95%e3%83%88%e3%82%a6%e3%82%a7%e3%82%a2%e9%96%8b%e7%99%ba%e8%80%85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "answer_count": 4, "score": -3, "last_activity_date": 1572453188, "creation_date": 1572446316, "last_edit_date": 1572453054, "question_id": 58627814, "link": "https://stackoverflow.com/questions/58627814/why-is-it-that-the-string-length-of-an-empty-array-differs-from-the-array-size", "title": "Why is it that the string length of an empty array differs from the array size?", "body": "<p>When returning the length and the size of an empty string in C, the values differ. Why is that so?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char b[7];\n\nprintf(\"String Length: %d\", strlen(b)); // Returns 22\nprintf(\"String Size: %d\", sizeof(b));   // Returns 7\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1572446303, "post_id": 58627731, "comment_id": 103563008, "body": "What is <code>REAL</code>? Please post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. Also you may want to see <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">language agnostic - Is floating point math broken? - Stack Overflow</a>."}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 3, "creation_date": 1572446311, "post_id": 58627731, "comment_id": 103563012, "body": "The precision seems to be the one expected for a <code>float</code>."}, {"owner": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 1, "creation_date": 1572446313, "post_id": 58627731, "comment_id": 103563015, "body": "Can you define REAL as a double? Float in c has 7 digits of precision, so it isn&#39;t an error just the way float is implemented"}, {"owner": {"reputation": 1605, "user_id": 1769975, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/1Ubk4.png?s=128&g=1", "display_name": "Marvin Effing", "link": "https://stackoverflow.com/users/1769975/marvin-effing"}, "reply_to_user": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 0, "creation_date": 1572446868, "post_id": 58627731, "comment_id": 103563381, "body": "@Tyler I will try that"}, {"owner": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 1, "creation_date": 1572446930, "post_id": 58627731, "comment_id": 103563415, "body": "Double has 15 digits of precision so it still will be <i>slightly</i> off because your file has 17 digits of precision"}], "answers": [{"tags": [], "owner": {"reputation": 27045, "user_id": 5923139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dvoYw.png?s=128&g=1", "display_name": "Aplet123", "link": "https://stackoverflow.com/users/5923139/aplet123"}, "is_accepted": false, "score": -1, "last_activity_date": 1572446466, "creation_date": 1572446466, "answer_id": 58627860, "question_id": 58627731, "link": "https://stackoverflow.com/questions/58627731/char-array-to-float-conversion-error-in-c/58627860#58627860", "title": "char array to float conversion error in C", "body": "<p>Floating point numbers cannot accurately represent many decimal places, so if you want more precision you have to switch away from standard floating points to a library like <a href=\"https://en.wikipedia.org/wiki/GNU_Multiple_Precision_Arithmetic_Library\" rel=\"nofollow noreferrer\">GMP</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 622, "user_id": 4979479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a26cf8324748a667e4f70e99d41cb4?s=128&d=identicon&r=PG&f=1", "display_name": "izzy", "link": "https://stackoverflow.com/users/4979479/izzy"}, "is_accepted": true, "score": 2, "last_activity_date": 1572446600, "creation_date": 1572446600, "answer_id": 58627906, "question_id": 58627731, "link": "https://stackoverflow.com/questions/58627731/char-array-to-float-conversion-error-in-c/58627906#58627906", "title": "char array to float conversion error in C", "body": "<p>Float isn't perfectly precise, and small fractional values might not come out the same way they were put in. Double is better, if you can use that. See this related question: See this related question: <a href=\"https://stackoverflow.com/questions/5098558/float-vs-double-precision\">&#39;float&#39; vs. &#39;double&#39; precision</a></p>\n"}], "owner": {"reputation": 1605, "user_id": 1769975, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/1Ubk4.png?s=128&g=1", "display_name": "Marvin Effing", "link": "https://stackoverflow.com/users/1769975/marvin-effing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1572488996, "accepted_answer_id": 58627906, "answer_count": 2, "score": -1, "last_activity_date": 1572446600, "creation_date": 1572446072, "last_edit_date": 1572446305, "question_id": 58627731, "link": "https://stackoverflow.com/questions/58627731/char-array-to-float-conversion-error-in-c", "closed_reason": "Duplicate", "title": "char array to float conversion error in C", "body": "<p>I have the following situation wherein I'm reading a file line-by-line where the first few lines (example) are as follows:</p>\n\n<pre><code>0.00000000000000000, 0.00000000000000000, 0.00000000000000000, 20.00000000000000000, 0.18854095325733133\n0.00000000000000000, 0.00000000000000000, 0.00000000000000000, 28.88888888888888900, 0.18861310382752311\n0.00000000000000000, 0.00000000000000000, 0.00000000000000000, 37.77777777777777900, 0.18870756072971304\n0.00000000000000000, 0.00000000000000000, 0.00000000000000000, 46.66666666666667100, 0.18876790723761561\n0.00000000000000000, 0.00000000000000000, 0.00000000000000000, 55.55555555555555700, 0.18879081871602224\n</code></pre>\n\n<p>and the processing of the lines:</p>\n\n<pre><code>fp = fopen(fn, \"r\");\n\nif (fp == NULL) {\n    &lt;...&gt;\n}\n\nwhile ((read = getline(&amp;line, &amp;len, fp)) !=-1) {\n    &lt;...&gt;\n    char *pt;\n    pt = strtok(line,\",\");\n    while (pt != NULL) {\n        //order: pressure, velocity, strain, temp\n        pnn = atof(pt);             //pressure\n        pt = strtok(NULL, \",\");\n\n        vrm = atof(pt);             //velocity\n        pt = strtok(NULL, \",\");\n\n        epx = atof(pt);             //elastic strain\n        pt = strtok(NULL, \",\");\n\n        temp = atof(pt);            //temperature\n        pt = strtok(NULL, \",\");\n\n        //reference friction coefficient\n        REAL ref_ffric = (REAL)atof(pt);\n        ref_fric = &amp;ref_ffric;\n        pt = strtok(NULL, \",\");\n</code></pre>\n\n<p><code>REAL</code> is in this context defined as a float</p>\n\n<p>However the <code>ref_fric</code> is never the correct amount, i.e the first line it should be 0.18854095325733133 but rather when I print it out it's 0.18854095041751862.</p>\n\n<p>How do I solve this char* to float conversion precision problem?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1572445876, "post_id": 58627641, "comment_id": 103562766, "body": "About performance, is that really such a bottleneck in your code that you need to micro optimize it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1572445880, "post_id": 58627641, "comment_id": 103562770, "body": "No, it is not possible. You can define a macro for the initializer string though and take its <code>sizeof</code>"}, {"owner": {"reputation": 51, "user_id": 11790801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191ca55ba4ccf1e4a3b2af8cb2ca714e?s=128&d=identicon&r=PG&f=1", "display_name": "Elec", "link": "https://stackoverflow.com/users/11790801/elec"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1572445969, "post_id": 58627641, "comment_id": 103562817, "body": "I have a lot of string compares in my code. @EugeneSh. What do you mean?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1572445999, "post_id": 58627641, "comment_id": 103562838, "body": "<code>#define MYSTRING  &quot;Hello world&quot;</code> then <code>char const * string = MYSTRING</code> and then you can take <code>sizeof(MYSTRING)</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1572446024, "post_id": 58627641, "comment_id": 103562855, "body": "Remembering that literal strings are really arrays, you can use <code>sizeof</code> on the literal string itself (as in <code>sizeof &quot;Hello World&quot; - 1</code>). But if all you have is a pointer to a single character in a string, that&#39;s all you have and you can&#39;t get the length at compile-time in a standards-compliant way."}, {"owner": {"reputation": 51, "user_id": 11790801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191ca55ba4ccf1e4a3b2af8cb2ca714e?s=128&d=identicon&r=PG&f=1", "display_name": "Elec", "link": "https://stackoverflow.com/users/11790801/elec"}, "edited": false, "score": 0, "creation_date": 1572446424, "post_id": 58627641, "comment_id": 103563084, "body": "Okay thanks. We can close this request I think."}], "answers": [{"tags": [], "owner": {"reputation": 27045, "user_id": 5923139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dvoYw.png?s=128&g=1", "display_name": "Aplet123", "link": "https://stackoverflow.com/users/5923139/aplet123"}, "is_accepted": false, "score": 0, "last_activity_date": 1572446037, "creation_date": 1572446037, "answer_id": 58627723, "question_id": 58627641, "link": "https://stackoverflow.com/questions/58627641/get-string-len-of-char-ptr-at-compile-time/58627723#58627723", "title": "Get string len of char ptr at compile time", "body": "<p>The contents of pointers are subject to change, so the compiler cannot make any assumptions about the length of the string, so you cannot get the length with <code>sizeof</code>. If you want to use pointers, you must get the string length with <code>strlen</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 0, "last_activity_date": 1572451002, "last_edit_date": 1572451002, "creation_date": 1572450195, "answer_id": 58629046, "question_id": 58627641, "link": "https://stackoverflow.com/questions/58627641/get-string-len-of-char-ptr-at-compile-time/58629046#58629046", "title": "Get string len of char ptr at compile time", "body": "<p>You could define a helper macro:</p>\n\n<pre><code>#define DEF_STRINGVARS(ptrvar, lenvar, literal) \\\n    const char *ptrvar = \"\" literal \"\"; \\\n    int lenvar = sizeof \"\" literal \"\" - 1;\n</code></pre>\n\n<p>Note:</p>\n\n<p>The <code>\"\"</code> before and after <code>literal</code> is just to make the compiler produce an error if it does not expand to a string literal. (There are devious ways to defeat the check if you try hard enough.)</p>\n\n<p>Usage:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define DEF_STRINGVARS(ptrvar, lenvar, literal) \\\n    const char *ptrvar = \"\" literal \"\"; \\\n    int lenvar = sizeof \"\" literal \"\" - 1;\n\nint main(void)\n{\n    DEF_STRINGVARS(hello, len, \"Hello World\")\n\n    printf(\"%s %d\\n\", hello, len);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Hello World 11\n</code></pre>\n\n<p>Note that the length does not take into account any null characters in the string literal. For example:</p>\n\n<pre><code>DEF_STRINGVARS(hello, len, \"Hello\\0World\")\n</code></pre>\n\n<p>will initialize the <code>len</code> variable to 11, not 5.</p>\n"}], "owner": {"reputation": 51, "user_id": 11790801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191ca55ba4ccf1e4a3b2af8cb2ca714e?s=128&d=identicon&r=PG&f=1", "display_name": "Elec", "link": "https://stackoverflow.com/users/11790801/elec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1572451002, "creation_date": 1572445776, "last_edit_date": 1572446335, "question_id": 58627641, "link": "https://stackoverflow.com/questions/58627641/get-string-len-of-char-ptr-at-compile-time", "title": "Get string len of char ptr at compile time", "body": "<p>I would like to get the string length during compile time.</p>\n\n<p>I know if I have a static string I can do it like this here:</p>\n\n<pre><code>char string[] = \"Hello World\";\nint len = sizeof( string ) - 1;\n</code></pre>\n\n<p>This will give me the same output like strlen.</p>\n\n<p>But is this also possible for a char ptr?</p>\n\n<pre><code>char const * string = \"Hello World\";\nint len = sizeof( string ) - 1;\n</code></pre>\n\n<p>This gave me as len 7, because I get the sizeof the type. strlen gave me the correct during runtime, but I would like to optimize code during compile time.</p>\n"}, {"tags": ["c", "freebsd"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1573568177, "post_id": 58627561, "comment_id": 103918030, "body": "As a rule of thumb, assume that any positive <code>pid_t</code> could be a valid PID.  Everything else means your code could break when the kernel-internal limit is increased."}], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 3, "last_activity_date": 1572447230, "creation_date": 1572447230, "answer_id": 58628118, "question_id": 58627561, "link": "https://stackoverflow.com/questions/58627561/how-to-get-pid-max-macro/58628118#58628118", "title": "How to get PID_MAX macro?", "body": "<p>There is no platform-independent method for retrieving the maximum pid value.\nUnder Linux, for example, you can determine the value through the <code>/proc/sys</code> interface</p>\n\n<pre><code>$ sysctl kernel/pid_max\n32768\n</code></pre>\n\n<p>Under FreeBSD, the value is <code>99999</code>. If you look closely in <code>sys/proc.h</code>, you will notice that the macro <code>PID_MAX</code> is guarded by</p>\n\n<pre><code>#ifdef _KERNEL\n...\n#define PID_MAX 99999\n...\n#endif\n</code></pre>\n\n<p>This is, why you cannot (and should not) use it in userspace programs.</p>\n"}, {"tags": [], "owner": {"reputation": 236, "user_id": 3732220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52e62d15d1d75c48c524125becbb52d?s=128&d=identicon&r=PG&f=1", "display_name": "Low power", "link": "https://stackoverflow.com/users/3732220/low-power"}, "is_accepted": false, "score": 0, "last_activity_date": 1608531892, "creation_date": 1608531892, "answer_id": 65388363, "question_id": 58627561, "link": "https://stackoverflow.com/questions/58627561/how-to-get-pid-max-macro/65388363#65388363", "title": "How to get PID_MAX macro?", "body": "<p>The <code>PID_MAX</code> macro defines the hard limit of PID values by BSD kernels (such as kFreeBSD); it shouldn't be used by user space programs because the actual maximum PID value could be further lowered in the runtime, controlled by <code>kern.pid_max</code> sysctl.</p>\n<p>To get such runtime limitation in an user space program, use <strong>sysctlbyname(3)</strong>; for example:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/sysctl.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n        int pid_max;\n        size_t len = sizeof pid_max;\n        if(sysctlbyname(&quot;kern.pid_max&quot;, &amp;pid_max, &amp;len, NULL, 0) &lt; 0) {\n                perror(&quot;sysctlbyname: kern.pid_max&quot;);\n                return 1;\n        }\n        printf(&quot;kern.pid_max=%d\\n&quot;, pid_max);\n        return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10061435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e369a6715742fb50e5a2f1c00af842?s=128&d=identicon&r=PG&f=1", "display_name": "Momonosoke", "link": "https://stackoverflow.com/users/10061435/momonosoke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1608531892, "creation_date": 1572445514, "last_edit_date": 1572445788, "question_id": 58627561, "link": "https://stackoverflow.com/questions/58627561/how-to-get-pid-max-macro", "title": "How to get PID_MAX macro?", "body": "<p>I would like to get the value of the <code>PID_MAX</code> macro present in the file <code>/sys/sys/proc.h</code>.</p>\n\n<p>My current code (main.c) :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;sys/types.h&gt; /* type pid_t */\n#include &lt;sys/proc.h&gt; /* macro PID_MAX */\n#include &lt;sys/unistd.h&gt; /* function getpid, getppid */\n\n/*\ngcc -Wall -Wextra main.c -o main\n./main\n*/\n\nint main ()\n{\n    pid_t pidmax = PID_MAX;\n\n    printf ( \"Value = %d\\n\", pidmax );\n\n    return 0;\n}\n</code></pre>\n\n<p>Return the following error :</p>\n\n<pre><code>error: 'PID_MAX' undeclared (first use in this function); did you mean 'UID_MAX'?\n</code></pre>\n\n<p>How is it possible?</p>\n\n<p>Another method to recover the <code>PID_MAX</code>?</p>\n"}, {"tags": ["python", "c", "python-2.7", "solaris", "computer-forensics"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11985252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAHaU5xk3RGxN0T92FwEttjuqQt3aYZBz4mWIA3=k-s128", "display_name": "drop table", "link": "https://stackoverflow.com/users/11985252/drop-table"}, "edited": false, "score": 0, "creation_date": 1572453664, "post_id": 58628262, "comment_id": 103567347, "body": "Of course Solaris would use a protocol literally nobody else uses and is far past deprecated, unfortunately I don&#39;t know if this puts me any closer to solving the problem, as it appears I need to figure out whatever this arbitrary buffer is that they have set. Thank you!"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 0, "last_activity_date": 1572447707, "creation_date": 1572447707, "answer_id": 58628262, "question_id": 58627421, "link": "https://stackoverflow.com/questions/58627421/creating-an-implimentation-of-netstat-for-solaris-in-python2-6/58628262#58628262", "title": "Creating an implimentation of netstat for Solaris in Python2.6+", "body": "<p><code>getmsg()</code> and <code>struct strbuf</code> are <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/getmsg.html\" rel=\"nofollow noreferrer\">specified by POSIX, albeit marked as obsolescent in POSIX 7</a>:</p>\n\n<blockquote>\n  <p><strong>NAME</strong></p>\n  \n  <p>getmsg, getpmsg - receive next message from a STREAMS file (STREAMS)</p>\n  \n  <p><strong>SYNOPSIS</strong></p>\n\n<pre><code>[OB XSR] [Option Start] #include &lt;stropts.h&gt;\n\nint getmsg(int fildes, struct strbuf *restrict ctlptr,\n       struct strbuf *restrict dataptr, int *restrict flagsp);\nint getpmsg(int fildes, struct strbuf *restrict ctlptr,\n       struct strbuf *restrict dataptr, int *restrict bandp,\n       int *restrict flagsp); [Option End]\n</code></pre>\n  \n  <p><strong>DESCRIPTION</strong></p>\n  \n  <p>The <code>getmsg()</code> function shall retrieve the contents of a message\n  located at the head of the STREAM head read queue associated with a\n  STREAMS file and place the contents into one or more buffers. The\n  message contains either a data part, a control part, or both. The data\n  and control parts of the message shall be placed into separate\n  buffers, as described below. The semantics of each part are defined by\n  the originator of the message.</p>\n  \n  <p>...</p>\n</blockquote>\n\n<p>I'm not aware of any Python bindings for STREAMS on Solaris.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/STREAMS\" rel=\"nofollow noreferrer\">STREAMS functionality</a> was never implemented on Linux. </p>\n"}], "owner": {"reputation": 37, "user_id": 11985252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAHaU5xk3RGxN0T92FwEttjuqQt3aYZBz4mWIA3=k-s128", "display_name": "drop table", "link": "https://stackoverflow.com/users/11985252/drop-table"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58628262, "answer_count": 1, "score": 1, "last_activity_date": 1572447707, "creation_date": 1572445124, "last_edit_date": 1572446114, "question_id": 58627421, "link": "https://stackoverflow.com/questions/58627421/creating-an-implimentation-of-netstat-for-solaris-in-python2-6", "title": "Creating an implimentation of netstat for Solaris in Python2.6+", "body": "<p>I am writing a collection script in python to grab forensic artifacts from various *nix hosts using Python 2 scripts, however I am running into some issues writing netstat collection for Solaris.</p>\n\n<p>There are a few limitations to how I am to achieve this. I cannot use the ELF binaries (except Python) on the computer (as they are often manipulated when *nix machines are attacked), I cannot import external libraries (as this will not run on computers which I administer), and it must be written in Python 2 for backwards compatibility reasons.</p>\n\n<p>All this being said, I am using the netstat.c document by Illumos (an open source Solaris implementation) as my base, and essentially trying to reverse engineer this and rewrite it in Python 2.</p>\n\n<p><a href=\"https://searchcode.com/codesearch/raw/52916131/\" rel=\"nofollow noreferrer\">https://searchcode.com/codesearch/raw/52916131/</a></p>\n\n<p>What I've figured out so far is, the script opens '/dev/arp' and '/dev/kstat' to ensure there are return values.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import os\nsd = os.open('/dev/arp', os.O_RDWR)\nkc = os.open('/dev/kstat', os.O_RDWR)\n</code></pre>\n\n<p>After this has been done, the 'sd' value is used to collect network statistics with the mibget() method.</p>\n\n<p>And here's the rub. To collect the netstat information, Solaris is querying <code>sd</code> with the syscall <code>getmsg</code>, however it is using a datastructure I am unfamiliar with.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>getcode = getmsg(sd, &amp;ctlbuf, (struct strbuf *)0, &amp;flags);\n</code></pre>\n\n<p>I have no idea how to rebuild this in Python 2, do any of you fine people have any ideas of where I can go from here? Am I interpreting this wrong?</p>\n\n<p>I understand the <code>psutil</code> implementation of netstat works on Solaris, so there must be a means to accomplish this. </p>\n\n<p>Thank you all for your help.</p>\n\n<p>Edit:</p>\n\n<p>This appears to be the relevant section of <code>truss netstat</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>open(\"/etc/default/inet_type\", O_RDONLY)        Err#2 ENOENT\nopen(\"/dev/arp\", O_RDWR)                        = 3\nioctl(3, I_PUSH, \"tcp\")                         = 0\nioctl(3, I_PUSH, \"udp\")                         = 0\nioctl(3, I_PUSH, \"icmp\")                        = 0\nputmsg(3, 0x08047E3C, 0x00000000, 0)            = 0\ngetmsg(3, 0x08047E3C, 0x00000000, 0x08047E5C)   = 2\ngetmsg(3, 0x00000000, 0x08047E48, 0x08047E5C)   = 0\ngetmsg(3, 0x08047E3C, 0x00000000, 0x08047E5C)   = 2\ngetmsg(3, 0x00000000, 0x08047E48, 0x08047E5C)   = 0\ngetmsg(3, 0x08047E3C, 0x00000000, 0x08047E5C)   = 2\ngetmsg(3, 0x00000000, 0x08047E48, 0x08047E5C)   = 0\ngetmsg(3, 0x08047E3C, 0x00000000, 0x08047E5C)   = 2\ngetmsg(3, 0x00000000, 0x08047E48, 0x08047E5C)   = 0\ngetmsg(3, 0x08047E3C, 0x00000000, 0x08047E5C)   = 2\ngetmsg(3, 0x00000000, 0x08047E48, 0x08047E5C)   = 0\ngetmsg(3, 0x08047E3C, 0x00000000, 0x08047E5C)   = 2\nbrk(0x080736E0)                                 = 0\n</code></pre>\n"}, {"tags": ["c", "printf", "padding"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1572445083, "post_id": 58627344, "comment_id": 103562232, "body": "Hi, please edit the question and show your existing output and what you are expecting."}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 12118994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YsfqmOfpJnw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZrUTFcV7z_x8ZDm3hfsk_PCB1Og/photo.jpg?sz=128", "display_name": "Francisco Basadre", "link": "https://stackoverflow.com/users/12118994/francisco-basadre"}, "is_accepted": false, "score": 1, "last_activity_date": 1572448160, "last_edit_date": 1572448160, "creation_date": 1572445099, "answer_id": 58627410, "question_id": 58627344, "link": "https://stackoverflow.com/questions/58627344/printf-padding-for-columns-in-c/58627410#58627410", "title": "printf() Padding for columns in C", "body": "<p>If I understood it right, why not just put the space in the printf, something like:</p>\n\n<pre><code>printf(\" %s\");\n</code></pre>\n\n<p>if you want to print a column length 10 with right justify:</p>\n\n<pre><code>printf(\"%10s\");\n</code></pre>\n\n<p>if you want to print a column with length 10 left justify:</p>\n\n<pre><code>printf(\"%-10s\");\n</code></pre>\n\n<p>columns will be padded with whites spaces, if the column is bigger than 10 will push other columns.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1572445621, "last_edit_date": 1572445621, "creation_date": 1572445161, "answer_id": 58627435, "question_id": 58627344, "link": "https://stackoverflow.com/questions/58627344/printf-padding-for-columns-in-c/58627435#58627435", "title": "printf() Padding for columns in C", "body": "<p>Why not simply add a space after each output yourself? Very easy if you combine all the small <code>printf</code> calls into a single call that prints all:</p>\n\n<pre><code>printf(\"%hu %d %s %s %lld %s %s\\n\",\n       sfile.st_mode, sfile.st_nlink, pwd-&gt;pw_name, grp-&gt;gr_name, sfile.st_size, MY_TIME, sd-&gt;d_name);\n</code></pre>\n\n<p>If you want specific widths of each column, use the field-width specifier of the <a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>printf</code></a> format, like</p>\n\n<pre><code>printf(\"%-4hu %-5d %10s %10s %lld %10s %s\\n\",\n       sfile.st_mode, sfile.st_nlink, pwd-&gt;pw_name, grp-&gt;gr_name, sfile.st_size, MY_TIME, sd-&gt;d_name);\n</code></pre>\n\n<p><sub>[Note that the field widths above are just <em>examples</em>, experiment to get the widths you want]</sub></p>\n\n<hr>\n\n<p>Lastly note that you can never gett columns to align 100% of the time, sooner or later you will get some data that is to long to fit in the width you decided. The best solution is to check how common it is, and if it's common then adjust the widths, but otherwise there's really no need to bother.</p>\n"}, {"tags": [], "owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1572445177, "creation_date": 1572445177, "answer_id": 58627440, "question_id": 58627344, "link": "https://stackoverflow.com/questions/58627344/printf-padding-for-columns-in-c/58627440#58627440", "title": "printf() Padding for columns in C", "body": "<p>if u want them to be separated by space just add space after \"%lld \" or in front of next one\nif u want all be justify add \\t</p>\n"}], "owner": {"reputation": 1, "user_id": 11397079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b631a93636ef59930e35a1c5b21b889?s=128&d=identicon&r=PG&f=1", "display_name": "hbrown", "link": "https://stackoverflow.com/users/11397079/hbrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1572448160, "creation_date": 1572444915, "last_edit_date": 1572445253, "question_id": 58627344, "link": "https://stackoverflow.com/questions/58627344/printf-padding-for-columns-in-c", "title": "printf() Padding for columns in C", "body": "<p>I have a C program that is printing the details of files in the current directory. It is a more specific version of ls. I am having trouble getting the columns to be separated by one space character. My function is as follows: </p>\n\n<pre><code>    while ( (sd = readdir(dir)) != NULL) {\n    lstat(sd-&gt;d_name, &amp;sfile);\n\n    printf(\"%hu\", sfile.st_mode);\n\n    printf(\"%d\", sfile.st_nlink);\n\n    pwd = getpwuid(sfile.st_uid);\n    printf(\"%s\", pwd-&gt;pw_name);\n\n    grp = getgrgid(sfile.st_gid);\n    printf(\"%s\", grp-&gt;gr_name);\n\n    printf(\"%lld\", sfile.st_size);\n\n    t = sfile.st_mtime;\n    tmp = localtime(&amp;t);\n    strftime(MY_TIME, sizeof(MY_TIME), \"%Y-%m-%d %H:%M\", tmp);\n    printf(\"%s\", MY_TIME);\n\n    printf(\"%s\\n\", sd-&gt;d_name);\n</code></pre>\n\n<p>I have tried adding %-1s to the printf statements but that only gives me a seg fault. If anyone can help me that would be greatly appreciated. Thank you. </p>\n\n<p>I cannot just add spaces because the columns will not be aligned when you have, for example, file link number > 10 in one column and a single digit link number in the next. </p>\n\n<pre><code>Current output:\n16877  5  bobmichaels  staff  160  2019-10-30 09:54\n16832  23  bobmichaels  staff  736  2019-10-29 22:24\n\nDesired output:\n16877  5   bobmichaels  staff  160  2019-10-30 09:54\n16832  23  bobmichaels  staff  736  2019-10-29 22:24\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 2, "creation_date": 1572441819, "post_id": 58626120, "comment_id": 103560305, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1350376/function-pointer-as-a-member-of-a-c-struct\">Function pointer as a member of a C struct</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11399849"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1572441821, "post_id": 58626120, "comment_id": 103560308, "body": "@paul Very helpful indeed. I should try it."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 4, "last_activity_date": 1572442043, "creation_date": 1572442043, "answer_id": 58626444, "question_id": 58626120, "link": "https://stackoverflow.com/questions/58626120/running-a-function-defined-in-a-struct/58626444#58626444", "title": "Running a function defined in a struct", "body": "<p>In C, you cannot declare functions in structs. You can store a pointer to a function in a struct. For example:</p>\n\n<pre><code>int jk = 0;\nconst int WAVFILE_SAMPLES_PER_SECOND = 44100;\n\ndouble wavsaw(int i)\n    {return ((double) i / WAVFILE_SAMPLES_PER_SECOND);}\n\nstruct waveform_data\n{\n    char *waves;\n    double (*f)(int i);\n};\n\nstruct waveform_data tag[] = {\n    {\"saw\", wavsaw},\n    {\"triangle\", ...},\n    {\"sawtooth\", ...},\n    {\"NULL\", 0}\n};\n</code></pre>\n\n<p>and call as:</p>\n\n<pre><code>tag[0].f(jk);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11399849"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58626444, "answer_count": 1, "score": -1, "last_activity_date": 1579021461, "creation_date": 1572440961, "last_edit_date": 1579021461, "question_id": 58626120, "link": "https://stackoverflow.com/questions/58626120/running-a-function-defined-in-a-struct", "title": "Running a function defined in a struct", "body": "<p>I'll explain this below:</p>\n\n<pre><code>int jk = 0;\nconst int WAVFILE_SAMPLES_PER_SECOND = 44100;\nstruct waveform_data\n{\n    char *waves;\n    double func;\n};\n\nstruct waveform_data tag[] = {\n    {\"saw\", (double) jk / WAVFILE_SAMPLES_PER_SECOND}, //This func\n    {\"triangle\", ...},\n    {\"sawtooth\", ...},\n    {\"NULL\", 0}\n};\n\nint main(int argc, char **argv){\n\n    if (argc &lt; 2){\n        return 1;\n    }\n\n    char *waveform = argv[1];\n    // Do a search of waveform\n    for (int i = 0; i &lt; 4; i++){\n        if (!strcmp(waveform, tag[i].waves)){\n            for (int g = 0; g &lt; 30; g++){\n                printf(\"%4f\", tag[i].func);\n                jk++; // modify the const jk means ERROR\n\n            }\n            break;\n        }\n        if (!strcmp(tag[i].waves, \"NULL\")){\n            printf(\"waveform not found: %s\\n\", waveform);\n            break;\n        }\n    }\n}\n</code></pre>\n\n<p>So I have this function <code>(double) jk / WAVFILE_SAMPLES_PER_SECOND}</code> in <code>struct waveform_data tag[]</code>.</p>\n\n<p>While though I'm almost complete at it, this function wants <code>jk</code> to be a const. And if I replace it as const, then I can't modify it by using <code>jk++</code> (found near at \"//Do a search of waveform\"). </p>\n\n<p>So how can I solve it so that it would accept non const int?</p>\n\n<p>Edit: The problem is that I cannot declare a func inside a struct. I can only store a pointer to a function in a struct.</p>\n"}, {"tags": ["c", "stack"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1572440019, "post_id": 58625800, "comment_id": 103559204, "body": "Wouldn&#39;t a simple <code>memcpy</code> suffice?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1572440076, "post_id": 58625800, "comment_id": 103559240, "body": "It could possibly be simpler, but it really depends on the implementation of the stack and if you control and can modify that implementation."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1572441291, "post_id": 58625800, "comment_id": 103559978, "body": "@PaulOgilvie Only if stack implementation is based on arrays."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1572441570, "post_id": 58625800, "comment_id": 103560147, "body": "Off-topic: I see a <code>createStack</code> function, but not a <code>destroyStack</code> counterpart. Depending on implementation of your stack, that might (or not) result in a memory leak..."}], "answers": [{"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1572441198, "post_id": 58625914, "comment_id": 103559912, "body": "Actually worse than pointer type not matching is that pointer addresses differ. Counter example: <code>print(int* array); int array[7]; print(&amp;array);</code> \u2013 creating pointer of bad type, but that refers to correct address, and when converted back should run fine. Not sure if technically still UB, though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11231270"}, "edited": false, "score": 0, "creation_date": 1572498895, "post_id": 58625914, "comment_id": 103580879, "body": "@kiran Biradar after changing the pointer as you mentioned, still it&#39;s not working"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 4, "last_activity_date": 1572440876, "last_edit_date": 1572440876, "creation_date": 1572440231, "answer_id": 58625914, "question_id": 58625800, "link": "https://stackoverflow.com/questions/58625800/how-to-duplicate-a-stack-from-original-stack/58625914#58625914", "title": "How to duplicate a stack from original stack", "body": "<p>It seems prototype of <code>push/pop</code> is as below.</p>\n\n<pre><code>void push (stack *, int);\nvoid pop (stack *);\n</code></pre>\n\n<p>In that case you have undefined behavior.</p>\n\n<pre><code>    n = pop(&amp;s);\n    push(&amp;s,n);\n    push(&amp;s1,n);\n</code></pre>\n\n<p>The above calls in <code>DuplicateStack</code> function are actually passing <code>stack **</code> to <code>push/pop</code> function instead of <code>stack *</code>. Since <code>s</code> and <code>s1</code> are already <code>stack *</code> , <code>&amp;s</code> and <code>&amp;s1</code> gives you the <code>stack **</code>.</p>\n\n<p>Try changing them to.</p>\n\n<pre><code>void DuplicateStack(stack *s, stack *s1){\n    int n;\n    stack s3;\n    CreateStack(&amp;s3);\n    while(!isEmpty(s)){\n        n = pop(s);  // &lt;&lt;&lt;-- &amp;s to s\n        push(&amp;s3,n);\n    }\n    while(!isEmpty(&amp;s3)){\n        n = pop(&amp;s3);\n        push(s,n);   // &lt;&lt;&lt;--- &amp;s to s\n        push(s1,n);  // &lt;&lt;&lt;----&amp;s1 to s1\n    }\n }\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11231270"}, "is_accepted": false, "score": 0, "last_activity_date": 1572531564, "creation_date": 1572531564, "answer_id": 58645317, "question_id": 58625800, "link": "https://stackoverflow.com/questions/58625800/how-to-duplicate-a-stack-from-original-stack/58645317#58645317", "title": "How to duplicate a stack from original stack", "body": "<pre><code>`void binary(stack *s, int num){\n    int n;\n    while(num != 0){\n        if(!isFull(s)){\n            n = num % 2;\n            push(s,n);\n            num = num / 2;\n        }\n        else{\n            exit(1);\n        }\n    }\n}\n</code></pre>\n\n<p>@kiran This is another code i made to convert a decimal number into binary number and store it on a stack. This code also deals with the same problem and terminates at that position too.Below is the minimal code of the original problem i have asked.</p>\n\n<pre><code>  while(!isEmpty(s)){\n        n = pop(&amp;s);\n        c1 = c1 + 1;\n        if(n%2 != 0)\n            push(&amp;s1,n);\n    }\n    while(!isEmpty(s1)){\n        n = pop(&amp;s1);\n        push(&amp;s,n);\n        c2 = c2 + 1;\n    }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11231270"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1572531564, "creation_date": 1572439891, "question_id": 58625800, "link": "https://stackoverflow.com/questions/58625800/how-to-duplicate-a-stack-from-original-stack", "title": "How to duplicate a stack from original stack", "body": "<p>I tried to write a c program which will have a function that returns a duplicate stack of the given stack. The duplicate stack contains the same elements as the original stack, and in the same order. The original stack must stay unchanged.\nBut I didn't get the desired output.The last two printf() outputs are not showed when running the code. The code terminates at the end of printf() command which shows the peak element of input stack.</p>\n\n<pre><code>void DuplicateStack(stack *s, stack *s1){\n    int n;\n    stack s3;\n    CreateStack(&amp;s3);\n    while(!isEmpty(s)){\n        n = pop(&amp;s);\n        push(&amp;s3,n);\n    }\n    while(!isEmpty(&amp;s3)){\n        n = pop(&amp;s3);\n        push(&amp;s,n);\n        push(&amp;s1,n);\n    }\n }\n  void main(){\n     stack s,s1;\n     CreateStack(&amp;s);\n    CreateStack(&amp;s1);\n    int num,n;\n    printf(\"Enter no.of numbers you want to enter: \");\n    scanf(\"%d\",&amp;num);\n    for(int i=0; i&lt;num; i++){\n        scanf(\"%d\",&amp;n);\n        push(&amp;s,n);\n    }\n    printf(\"Top element: %d\\n\",peek(&amp;s));\n    DuplicateStack(&amp;s,&amp;s1);\n    printf(\"Top Element in the Original Stack: %d\\n\",peek(&amp;s));\n    printf(\"Top Element in the Duplicate Stack: %d\\n\",peek(&amp;s1));\n }\n</code></pre>\n"}, {"tags": ["c", "structure", "typedef"], "answers": [{"comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1572439674, "post_id": 58625704, "comment_id": 103559007, "body": "OP didn&#39;t ask if they are the same variable! The question was &quot;are they the same type?&quot;"}, {"owner": {"reputation": 37, "user_id": 12098560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041f3ce53f43ae7d3372196c0df02ae7?s=128&d=identicon&r=PG&f=1", "display_name": "NVA", "link": "https://stackoverflow.com/users/12098560/nva"}, "edited": false, "score": 0, "creation_date": 1572439726, "post_id": 58625704, "comment_id": 103559031, "body": "Thank you for your answer! I&#39;m just asking to see if they are the same type, I&#39;m aware that they are 2 different variables and do not share the same values or memory locations"}], "tags": [], "owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "is_accepted": false, "score": 1, "last_activity_date": 1572439558, "creation_date": 1572439558, "answer_id": 58625704, "question_id": 58625685, "link": "https://stackoverflow.com/questions/58625685/differences-between-2-kinds-of-structure-declare/58625704#58625704", "title": "Differences between 2 kinds of structure declare", "body": "<p>No although they share a type they are completely different variables with a different memory location.</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 12098560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041f3ce53f43ae7d3372196c0df02ae7?s=128&d=identicon&r=PG&f=1", "display_name": "NVA", "link": "https://stackoverflow.com/users/12098560/nva"}, "edited": false, "score": 0, "creation_date": 1572440030, "post_id": 58625802, "comment_id": 103559211, "body": "Thank you for this answer!"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 7, "last_activity_date": 1572439900, "creation_date": 1572439900, "answer_id": 58625802, "question_id": 58625685, "link": "https://stackoverflow.com/questions/58625685/differences-between-2-kinds-of-structure-declare/58625802#58625802", "title": "Differences between 2 kinds of structure declare", "body": "<p>The type-name <code>book_t</code> is an <em>alias</em> for <code>struct book_s</code>. They're identical types, and can be used interchangeably. Therefore the structure <em>objects</em> (structure instances) are of identical type as well.</p>\n\n<p>The structure objects (instances) are different and distinct, but they have the same type.</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 12098560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041f3ce53f43ae7d3372196c0df02ae7?s=128&d=identicon&r=PG&f=1", "display_name": "NVA", "link": "https://stackoverflow.com/users/12098560/nva"}, "edited": false, "score": 1, "creation_date": 1572440296, "post_id": 58625894, "comment_id": 103559385, "body": "I&#39;m just asking if they were the same type. Anyway thanks for answering!"}], "tags": [], "owner": {"reputation": 66, "user_id": 11752998, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mhN5WktlH_M/AAAAAAAAAAI/AAAAAAAAZW0/zpqGv17QH5k/photo.jpg?sz=128", "display_name": "Ruben van Leeuwen", "link": "https://stackoverflow.com/users/11752998/ruben-van-leeuwen"}, "is_accepted": false, "score": 1, "last_activity_date": 1572440191, "creation_date": 1572440191, "answer_id": 58625894, "question_id": 58625685, "link": "https://stackoverflow.com/questions/58625685/differences-between-2-kinds-of-structure-declare/58625894#58625894", "title": "Differences between 2 kinds of structure declare", "body": "<p>Yes, they are both a \"book_s\" structure <strong>type</strong>\nBUT! they are not the same instance/object.</p>\n\n<p>e.g.:</p>\n\n<p>struct book_s first_book; <br>\n// ^- you now have an object called \"first_book\" of the type book_s<br><br>\nbook_t second_book; <br>\n// ^ you now have a second object called \"second_book\" of the type book_t <br>\n//   which is the alias for struct book_s</p>\n\n<p>setting a string to: first_book.name\nwill not affect the string in: second_book.name</p>\n\n<p>calling: first_book.name\nwill return a string but not the same string as the other object \"second_book.name\"</p>\n\n<p>they both return the same type: string\nthey both have other values.</p>\n\n<p>hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1572440917, "last_edit_date": 1572440917, "creation_date": 1572440329, "answer_id": 58625945, "question_id": 58625685, "link": "https://stackoverflow.com/questions/58625685/differences-between-2-kinds-of-structure-declare/58625945#58625945", "title": "Differences between 2 kinds of structure declare", "body": "<p>These two object declarations</p>\n\n<pre><code>struct book_s first_book;\nbook_t second_book;\n</code></pre>\n\n<p>are equivalent.</p>\n\n<p>In the first declaration there is used the type specifier <code>struct book_s</code>. In the second declaration there is used the typedef name that is an alias for the type specifier <code>struct book_s</code>.</p>\n\n<p>Moreover you could write the typedef even the following way</p>\n\n<pre><code>typedef struct book_s{\n    char name[50];\n    char author[50];\n    int price;\n} book_s;\n</code></pre>\n\n<p>And define the objects like</p>\n\n<pre><code>struct book_s first_book;\nbook_s second_book;\n</code></pre>\n\n<p>These expressions</p>\n\n<pre><code>first_book.name\n\nsecond_book.name\n</code></pre>\n\n<p>are member access expressions to the data member <code>name</code> of the declared structure of the two objects <code>first_book</code> and <code>second_book</code>. </p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct book_s{\n    char name[50];\n    char author[50];\n    int price;\n} book_t;\n\nint main(void) \n{\n    struct book_s first_book = \n    { \n        \"Expert C Programming\", \"Peter van der Linden\", 10\n    };\n    book_t second_book =\n    {\n        \"Head First C\", \"David Griffiths and Dawn Griffiths\", 15\n    };\n\n    printf( \"%s by %s (%d)\\n\", first_book.name, \n                               first_book.author, \n                               first_book.price );\n    printf( \"%s by %s (%d)\\n\", second_book.name, \n                               second_book.author, \n                               second_book.price );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Expert C Programming by Peter van der Linden (10)\nHead First C by David Griffiths and Dawn Griffiths (15)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12098560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041f3ce53f43ae7d3372196c0df02ae7?s=128&d=identicon&r=PG&f=1", "display_name": "NVA", "link": "https://stackoverflow.com/users/12098560/nva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58625802, "answer_count": 4, "score": 3, "last_activity_date": 1572443290, "creation_date": 1572439481, "last_edit_date": 1572443290, "question_id": 58625685, "link": "https://stackoverflow.com/questions/58625685/differences-between-2-kinds-of-structure-declare", "title": "Differences between 2 kinds of structure declare", "body": "<p>For this code:</p>\n\n<pre><code>typedef struct book_s{\nchar name[50];\nchar author[50];\nint price;\n} book_t;\n</code></pre>\n\n<p>I'm going to declare 2 variables of this structure:</p>\n\n<pre><code>struct book_s first_book;\nbook_t second_book;\n</code></pre>\n\n<p>Are  <code>first_book</code> and <code>second_book</code> the same type?\nIf so, are these 2 lines</p>\n\n<pre><code>first_book.name\n\nsecond_book.name\n</code></pre>\n\n<p>are going to give the same type of string for output?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1572439200, "post_id": 58625552, "comment_id": 103558738, "body": "The statement <code>sscanf((int)n,&quot;%d&quot;,&amp;x);</code> needs a <i>string</i> as its first argument. The function behaves like <code>scanf</code>but, like <code>fscanf</code>, the <i>source</i> to be scanned must be given as the first argument."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1572439208, "post_id": 58625552, "comment_id": 103558744, "body": "It seems your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> could be a lot more minimal."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1572439255, "post_id": 58625552, "comment_id": 103558773, "body": "On an unrelated note, casting a variable to the exact same type as the variable already is, is kind of pointless."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1572439403, "post_id": 58625552, "comment_id": 103558853, "body": "And why do you use <code>sscanf</code> here to begin with? To get an integer value from an integer variable? I&#39;m very interested in your reasoning here."}, {"owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "edited": false, "score": 0, "creation_date": 1572439857, "post_id": 58625552, "comment_id": 103559105, "body": "You&#39;ll have to excuse me im a begginer in c .. recollecting my thoughts  , will edit post after im done"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1572441286, "creation_date": 1572441286, "answer_id": 58626219, "question_id": 58625552, "link": "https://stackoverflow.com/questions/58625552/sscanf-casting-warning-c/58626219#58626219", "title": "sscanf casting warning c", "body": "<p>Here is an example which extracts an unknown number of integers from a string.</p>\n\n<p>It does not use <code>strtok</code> but works by advancing a buffer pointer past each item that was successfully scanned.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (void)\n{\n    char input[256];\n\n    puts(\"Enter some numbers on one line:\");\n    if(fgets(input, sizeof input, stdin) == NULL) {\n        puts(\"Error in input\");\n        exit(1);\n    }\n\n    int num;\n    int len;\n    char *buf = input;\n\n    puts(\"The numbers are:\");\n    while(sscanf(buf, \"%d%n\", &amp;num, &amp;len) == 1) {\n        if(!isspace(buf[len])) {\n            puts(\"Error in input\");\n            exit(1);\n        }\n        printf(\"num=%d\\n\", num);\n        buf += len;\n    }\n}\n</code></pre>\n\n<p>Program sessions:</p>\n\n<pre>\nEnter some numbers on one line:\n123 456 789\nThe numbers are:\nnum=123\nnum=456\nnum=789\n\nEnter some numbers on one line:\n123a 456\nThe numbers are:\nError in input\n</pre>\n"}], "owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572441286, "creation_date": 1572439001, "question_id": 58625552, "link": "https://stackoverflow.com/questions/58625552/sscanf-casting-warning-c", "title": "sscanf casting warning c", "body": "<p>The program's purpose is to get as an input a string containing numbers and white spaces then split the string with strtok and insert every number in an array. \nLastly , from the array i send the numbers to the function checkPowerOfTwo which determines if the number is a power of two and prints a string with the calculation. </p>\n\n<p>The warning says : <code>passing argument 1 of 'sscanf' makes pointer from integer without a cast [-Wint-conversion]|</code></p>\n\n<p>The warning happen on both of the lines containing sscanf . \nAny ideas of how I can resolve these warnings ? \nMy code : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint checkPowerOfTwo(int x);\nint main()\n{\n    int exp,size,*numbers,sum=0;\n    char term,*str=NULL,*token;\n\n\n    printf(\"Enter size of input:\");\n    if(scanf(\"%d%c\", &amp;size, &amp;term) != 2 || term != '\\n'){\n        printf(\"Invalid Size\\n\");\n        return 0;\n    } if(size&lt;=0){\n        printf(\"Invalid size\\n\");\n        return 0;\n    } else{\n        numbers=(int*)malloc(size * sizeof(int));\n        str=(char*)malloc(sizeof(int)*(size+1) + (size-1)*sizeof(char));\n        if(numbers==NULL||str==NULL){\n            printf(\"Out of memory\\n\");\n            return 0;\n        } //else{\n            //printf(\"Memory allocated\\n\");\n        //}\n        printf(\"Enter numbers:\");\n        fgets (str, sizeof(int)*(size+1) + (size-1), stdin);\n        //printf(\"%s\",str);\n        token=strtok(str,\" \");\n        while(token!=NULL){\n            for(int i=0;i&lt;size;i++){\n            //printf(\"%s\\n\",token);\n            numbers[i]=(int)token;\n            token=strtok(NULL,\" \");\n            }\n        }\n    }\n\n    for(int j =0;j&lt;size;j++)\n    {\n    exp=checkPowerOfTwo(numbers[j]);\n    if (exp&gt;=0){\n        int x;\n        sscanf((int)numbers[j],\"%d\",&amp;x);\n        printf(\"The number %d is a power of 2: %d=2^%d\\n\",x,x,exp);\n        sum+=exp;\n    }\n    }\n    printf(\"Total exponent sum is %d\",sum);\n        free(numbers);\n        free(str);\n}\n\nint checkPowerOfTwo(int n)\n{\n   int x;\n   int exponent=0;\n   sscanf((int)n,\"%d\",&amp;x);\n   //printf(\"checking number %d\\n\",x);\n   if (x==0){\n        return -1;\n   } if  (x==1){\n      return 0;\n   }\n   while( x != 1)\n   {\n      if(x % 2 != 0){\n         return -1;\n      }\n      x /= 2;\n      exponent++;\n   }\n   return exponent;\n\n}\n\n\n</code></pre>\n\n<p>I tried to use the casting to (int) in both sscanf lines but the warning remains.</p>\n"}, {"tags": ["c", "time-limiting"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1572438889, "post_id": 58625485, "comment_id": 103558555, "body": "The first thing you should do is run your existing program to generate the list of the first say 30 results, and edit those into your question so we (and you) can look for patterns."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1572438973, "post_id": 58625485, "comment_id": 103558602, "body": "You should find a better algorithm. :)"}, {"owner": {"reputation": 88, "user_id": 11970851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c61430bfbd391650558a9865d1ee156?s=128&d=identicon&r=PG&f=1", "display_name": "CKoorosh", "link": "https://stackoverflow.com/users/11970851/ckoorosh"}, "edited": false, "score": 0, "creation_date": 1572439510, "post_id": 58625485, "comment_id": 103558908, "body": "I do not have the entry k numbers.(There is no specific algorithm to find it).@john zwinck"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1572439648, "post_id": 58625485, "comment_id": 103558985, "body": "@CKoorosh Use math to calculate the all the divisors of a number."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1572439657, "post_id": 58625485, "comment_id": 103558988, "body": "Question is unclear. Do you mean exactly k divisors or at least?"}, {"owner": {"reputation": 88, "user_id": 11970851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c61430bfbd391650558a9865d1ee156?s=128&d=identicon&r=PG&f=1", "display_name": "CKoorosh", "link": "https://stackoverflow.com/users/11970851/ckoorosh"}, "edited": false, "score": 0, "creation_date": 1572439674, "post_id": 58625485, "comment_id": 103559006, "body": "I asked for some help to find that algorithm.@klutt"}, {"owner": {"reputation": 88, "user_id": 11970851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c61430bfbd391650558a9865d1ee156?s=128&d=identicon&r=PG&f=1", "display_name": "CKoorosh", "link": "https://stackoverflow.com/users/11970851/ckoorosh"}, "edited": false, "score": 0, "creation_date": 1572439735, "post_id": 58625485, "comment_id": 103559038, "body": "k is the exact number."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1572439826, "post_id": 58625485, "comment_id": 103559089, "body": "Google &quot;c number of divisors&quot; and you will find examples of better algorithms"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1572440100, "post_id": 58625485, "comment_id": 103559261, "body": "C++, not C, but should <a href=\"https://stackoverflow.com/questions/26753839/efficiently-getting-all-divisors-of-a-given-number\">fit your problem</a>, too..."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 0, "last_activity_date": 1572442262, "last_edit_date": 1572442262, "creation_date": 1572440193, "answer_id": 58625895, "question_id": 58625485, "link": "https://stackoverflow.com/questions/58625485/how-to-fix-time-limit-exceeded-in-some-test-cases-when-using-the-for-loop/58625895#58625895", "title": "How to fix &#39;time limit exceeded&#39; in some test cases when using the for loop?", "body": "<p>Did not find a good dup. Here is a solution with O(sqrt(n)) complexity. It's taken from <a href=\"https://www.geeksforgeeks.org/count-divisors-n-on13/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/count-divisors-n-on13/</a></p>\n\n<pre><code>// function to count the divisors \nint countDivisors(int n) \n{ \n    int cnt = 0; \n    for (int i = 1; i &lt;= sqrt(n); i++) { \n        if (n % i == 0) { \n            // If divisors are equal, \n            // count only one \n            if (n / i == i) \n                cnt++; \n\n            else // Otherwise count both \n                cnt = cnt + 2; \n        } \n    } \n    return cnt; \n} \n</code></pre>\n\n<p>On the same site, there is one that runs in O(n^(1/3)) that is slightly more complex. It's for C++, but just add <code>#include &lt;stdbool.h&gt;</code> and it should work.</p>\n\n<pre><code>void SieveOfEratosthenes(int n, bool prime[], \n                         bool primesquare[], int a[]) \n{ \n    // Create a boolean array \"prime[0..n]\" and initialize all entries as\n    // true. A value in prime[i] will finally be false if i is  Not a prime,\n    // else true. \n    for (int i = 2; i &lt;= n; i++) \n        prime[i] = true; \n\n    // Create a boolean array \"primesquare[0..n*n+1]\" and initialize all \n    // entries it as false. A value in squareprime[i] will finally be true \n    // if i is square of prime, else false. \n    for (int i = 0; i &lt;= (n * n + 1); i++) \n        primesquare[i] = false; \n\n    // 1 is not a prime number (Look it up if you doubt it) \n    prime[1] = false; \n\n    for (int p = 2; p * p &lt;= n; p++) { \n        // If prime[p] is not changed, then it is a prime \n        if (prime[p] == true) { \n            // Update all multiples of p \n            for (int i = p * 2; i &lt;= n; i += p) \n                prime[i] = false; \n        } \n    } \n\n    int j = 0; \n    for (int p = 2; p &lt;= n; p++) { \n        if (prime[p]) { \n            // Storing primes in an array \n            a[j] = p; \n\n            // Update value in primesquare[p*p], if p is prime. \n            primesquare[p * p] = true; \n            j++; \n        } \n    } \n} \n\n// Function to count divisors \nint countDivisors(int n) \n{ \n    // If number is 1, then it will have only 1 \n    // as a factor. So, total factors will be 1. \n    if (n == 1) \n        return 1; \n\n    bool prime[n + 1], primesquare[n * n + 1]; \n\n    int a[n]; // for storing primes upto n \n\n    // Calling SieveOfEratosthenes to store prime factors of n and to store\n    // square of prime factors of n \n    SieveOfEratosthenes(n, prime, primesquare, a); \n\n    // ans will contain total number of distinct divisors \n    int ans = 1; \n\n    // Loop for counting factors of n \n    for (int i = 0;; i++) { \n        // a[i] is not less than cube root n \n        if (a[i] * a[i] * a[i] &gt; n) \n            break; \n\n        // Calculating power of a[i] in n. \n        int cnt = 1; // cnt is power of prime a[i] in n. \n        while (n % a[i] == 0) // if a[i] is a factor of n \n        { \n            n = n / a[i]; \n            cnt = cnt + 1; // incrementing power \n        } \n\n        // Calculating number of divisors. If n = a^p * b^q then total\n        // divisors of n are (p+1)*(q+1) \n        ans = ans * cnt; \n    } \n\n    // if a[i] is greater than cube root of n \n\n    // First case \n    if (prime[n]) \n        ans = ans * 2; \n\n    // Second case \n    else if (primesquare[n]) \n        ans = ans * 3; \n\n    // Third casse \n    else if (n != 1) \n        ans = ans * 4; \n\n    return ans; // Total divisors \n} \n</code></pre>\n\n<p>If the above is not enough, you should look into some kind of <em>dynamic programming</em>. Both of the above method is calculating each number from scratch. But if you're going to do it for several numbers, it is quite possible that you can use information from previous numbers. Just to give an idea for how it works, here is an algorithm calculating all primes from 2 to n:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\n// After running this function, prime[n] will be true iff n is a prime\nvoid createPrimeArray(bool *prime, size_t size)\n{\n    prime[0] = prime[1] = false;\n\n    for(size_t i=2; i&lt;size; i++)\n        prime[i] = true;\n\n    for(size_t i=2; i&lt;sqrt(size); i++) {\n        size_t j=i;\n        while(!prime[j])\n            j++;\n\n        for(size_t k=2*j; k&lt;size; k+=j)\n            prime[k] = false;\n    }\n}\n\nint main(void)\n{\n    bool prime[200];\n    createPrimeArray(prime, 200);\n    for(int i=0; i&lt;200; i++) {\n        if(prime[i])\n            printf(\"%d \", i);\n    }\n}\n</code></pre>\n\n<p>The above can possibly be optimized further. It's purpose is to show how you can reuse information. After the first run in the second for loop in <code>createPrimeArray</code> we have marked all numbers that are dividable by 2 as non-primes, and thus we don't have to care about those anymore.  </p>\n"}], "owner": {"reputation": 88, "user_id": 11970851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c61430bfbd391650558a9865d1ee156?s=128&d=identicon&r=PG&f=1", "display_name": "CKoorosh", "link": "https://stackoverflow.com/users/11970851/ckoorosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 58625895, "answer_count": 1, "score": -1, "last_activity_date": 1572442262, "creation_date": 1572438760, "question_id": 58625485, "link": "https://stackoverflow.com/questions/58625485/how-to-fix-time-limit-exceeded-in-some-test-cases-when-using-the-for-loop", "title": "How to fix &#39;time limit exceeded&#39; in some test cases when using the for loop?", "body": "<p><strong>We have a series of numbers which is the sum of numbers from 1 to n.(1,3,6,10,...)\nThe question wants me to find the smallest number in this series which has k divisors.</strong></p>\n\n<p>My code works properly on all test cases but it exceeds the time limits.\nIt has one while loop and one for loop inside it.</p>\n\n<pre><code>int main()\n{\n        int k, sum, counter = 0, n = 1;\n    scanf(\"%d\", &amp;k);\n    while (counter != k) {\n        counter = 0;\n        sum = n*(n + 1) / 2;  //sum of numbers from 1 to n.(formula)\n        for (int i = 1; i &lt;= sum / 2; i++) //counts the divisors\n            if (sum%i == 0)counter++;\n        counter++;  //adds one to the counter because of number 1\n        n++;\n}\n    printf(\"%d\",sum);\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>And here is a example:</p>\n</blockquote>\n\n<pre><code>Input:k=4\nOutput:6\n</code></pre>\n\n<p>What should I do to have a faster and better program?</p>\n"}, {"tags": ["c++", "c", "windows", "memory-management", "heap-memory"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1572438891, "post_id": 58625435, "comment_id": 103558556, "body": "Hypothesis 1 can be ruled out on 64-bit machines. Hypothesis 2 may be possible, but it is extremely unlikely that such a specific corruption occurs; Your process is thousands of times more likely to crash."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1572439036, "post_id": 58625435, "comment_id": 103558649, "body": "When you say &quot;assertions&quot; do you mean the <a href=\"https://en.cppreference.com/w/cpp/error/assert\" rel=\"nofollow noreferrer\"><code>assert</code></a> macro which is not doing anything in typical release builds?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1572439146, "post_id": 58625435, "comment_id": 103558708, "body": "@Ctx Why could hypothesis 1 be ruled out? Even if the virtual address space on a 64-bit system is unlikely to run out, the actual physical address space could become fragmented enough to lead to allocation problems."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1572439639, "post_id": 58625435, "comment_id": 103558981, "body": "@Someprogrammerdude Oh, I misread your comment; no, fragmentation of the physical address space cannot lead to allocation problems. The addresses are mapped on page granularity."}, {"owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1572445135, "post_id": 58625435, "comment_id": 103562266, "body": "@Someprogrammerdude No, I mean a custom alternative to <code>assert</code>, which is definitely enabled in release builds. At least, it helped to catch a zero-argument bug once."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1572447684, "post_id": 58625435, "comment_id": 103563890, "body": "Double check that you use unsigned and preferably size_t types for your malloc bytes and assert check. Strange things happen if you get multiplication overflow into negative numbers, for example."}], "owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1572438626, "creation_date": 1572438626, "question_id": 58625435, "link": "https://stackoverflow.com/questions/58625435/malloc-occasionally-returns-null-on-win64", "title": "Malloc occasionally returns null on Win64", "body": "<p>Disclaimer: I tag the question as both C and C++ as I use <code>std::malloc</code> in a C++ project.</p>\n\n<p>My C++ application allocates/deallocates some memory repeatedly. In most cases I use <code>new</code>/<code>delete</code>, but in some of them (custom containers) I use <code>std::malloc</code>. Operator <code>new</code> never returns nullptr or throws <code>bad_alloc</code>, but <code>std::malloc</code> return nullptr occasionally on some machines.</p>\n\n<p>For now we build for Win64 only, and the vast majority of users use Windows 10.</p>\n\n<p>What the reason can be?</p>\n\n<ul>\n<li>I exclude physical memory depletion, as the application allocates less than 3 Gb of memory, and those machines have 8-16 Gb + swap.</li>\n<li>Malloc argument is always greater than zero and less than 256 Mb. It's verified with assertions.</li>\n<li>Hypothesis 1: can it be address space exhaustion due to fragmentation? Small buffer reallocations in the application may occur many times a second, but their sizes are usually a few kilobytes.</li>\n<li>Hypothesis 2: can it be a memory corruption due to a bug in the application? Does Windows store some heap service information in application-accessible memory, where the application can overwrite it without crashing by access violation? Could you please provide some links to Windows heap management explanation.</li>\n</ul>\n\n<p>P.S. I use the default heap only, no custom-allocated WinAPI heaps.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1572437046, "post_id": 58624920, "comment_id": 103557496, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please tell us what input you give, what output was expected, and what output you actually get."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 2, "creation_date": 1572437048, "post_id": 58624920, "comment_id": 103557500, "body": "Your first line <code>scanf(&quot;%d %d&quot;,&amp;n,&amp;m);</code> will not consume the space following the second number (<code>m</code>). You can maybe fix your code by checking for <code>c==&#39; &#39; || c==&#39;\\n&#39;</code> inside the <code>for()</code> loop. Or better still, ignore everything I just said and learn how to use a debugger. Seriously, it&#39;s worth the effort, and this is a great opportunity to get started."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1572437249, "post_id": 58624920, "comment_id": 103557602, "body": "@Ali Hatami The description does not correspond to examples. For example n is not a number of characters in a row."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1572447667, "post_id": 58624920, "comment_id": 103563877, "body": "Would the text: <i>Input : m,n that the program get n characters just including &#39;W&#39; and &#39;B&#39; in m lines</i>. be better stated as: <i>Input : rows,cols. Where the program will then expect the user to input rows*cols characters comprised only of &#39;W&#39; or &#39;B&#39;. The program will arrange this input into m columns of n rows</i>?  Using variable names that are descriptive of what they are used for is preferable <b><i>always</i></b>."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1572451375, "post_id": 58624920, "comment_id": 103566050, "body": "How big can <code>n</code> or <code>m</code> be? Are you aware of the  maximum value an <code>int</code> can store and what happens in case of overflow? Is there a particular reason why you are not storing the inputs or some partial result in an array?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1572452468, "post_id": 58626687, "comment_id": 103566680, "body": "Fair enough, yet if <code>array</code> could be a pointer, I&#39;d go for <code>sizeof array[0][0] * rows * cols</code> to 1) not have to maintain/check the type and 2) avoid overflow in extreme cases of <code>int*int*size_t</code>"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 2, "last_activity_date": 1572520981, "last_edit_date": 1572520981, "creation_date": 1572442777, "answer_id": 58626687, "question_id": 58624920, "link": "https://stackoverflow.com/questions/58624920/i-got-some-wrong-answers-in-my-test-cases/58626687#58626687", "title": "I got Some wrong answers in my test cases,", "body": "<p>There are several items in your code that are problematic, including such things as your prompt for user input:  <code>scanf(\"%d %d\",&amp;n,&amp;m);</code>.  This will not handle the white space that comes with the user input.</p>\n\n<p>These are not hard rules, just some suggestions:<br>\n(followed by example code with alternative methods of user input and temporary data storage.)</p>\n\n<ul>\n<li>When asking for user input, use simple clear directions that allow no ambiguity.   </li>\n<li>Allow for 1 entry at a time.  </li>\n<li>Use variable values that describe what you are doing. (<code>rows</code> <code>cols</code> are more descriptive than\n<code>m</code> <code>n</code>)  </li>\n<li>Create an appropriate container for holding user data as it is entered.</li>\n</ul>\n\n<p>For example:  </p>\n\n<pre><code>int main(void)\n{\n    char str[4];\n    int chr;\n    int rows, cols;\n    int i, j;\n\n    char sDataConv[][2] = { \"W\", \"B\" };\n\n    printf(\"Enter number of rows: \");\n    if(fgets(str, 4, stdin)) \n    {\n        rows = atoi(str);   \n    }\n    printf(\"Enter number of columns: \");\n    if(fgets(str, 4, stdin)) \n    {\n        cols = atoi(str);   \n    }\n    int array[rows][cols];//read data in as char values such as 'W' and 'B'\n    memset(array, 0, sizeof(array));\n\n    //Now a loop can be used prompting user\n    //to enter  values, and placing values\n    //into array as they are entered, eg using\n    // array[i][j] = getc(stdin);\n    // if((array[i][j] == 'W') || (array[i][j] == 'B'))\n\n    for(i = 0; i&lt;rows; i++)\n    {\n        for(j = 0;j&lt;cols;j++)\n        {\n            printf(\"Enter either W or B one at a time\");\n            if(fgets(str, 4, stdin))\n            {\n                array[i][j] = str[0];\n                //test - limit to allow only W or B\n                while(!((array[i][j] == 'W') || (array[i][j] == 'B')))\n                {\n                    printf(\"Wrong entry, enter either W or B.\");\n                    if(fgets(str, 4, stdin))\n                    {\n                        array[i][j] = str[0];\n                    }\n                }\n            }\n        }\n    }\n    //display data entered\n    for(i = 0; i&lt;rows; i++)\n    {\n        for(j = 0;j&lt;cols;j++)\n        {\n            printf(\"%c \", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n\n\n    return 0;\n}\n</code></pre>\n\n<p>This should provide a start. The rest is up to you, but the array should help to make the comparisons, and present results.</p>\n"}], "owner": {"reputation": 122, "user_id": 12296966, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC3lub6CRUU6YcfY-arUpFF0J8_Q0UusguGIO4q=k-s128", "display_name": "Ali Hatami", "link": "https://stackoverflow.com/users/12296966/ali-hatami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1572456190, "accepted_answer_id": 58626687, "answer_count": 1, "score": -2, "last_activity_date": 1572520981, "creation_date": 1572436800, "last_edit_date": 1572455383, "question_id": 58624920, "link": "https://stackoverflow.com/questions/58624920/i-got-some-wrong-answers-in-my-test-cases", "closed_reason": "Needs details or clarity", "title": "I got Some wrong answers in my test cases,", "body": "<p>My assignment is:\n\"Input : m,n\nthat the program get n characters just including 'W' and 'B' in m lines.\nOutput: if quantity of 'W's are even in each column it'll return a 'B' instead else it returns 'F'.</p>\n\n<blockquote>\n  <p>Note : We Are NOT allowed to use arrays!</p>\n</blockquote>\n\n<p>Example:\ninput:</p>\n\n<pre><code>3 2\nWBW\nBBW\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>FBB\n</code></pre>\n\n<p>\u00a0My Code : </p>\n\n<pre><code>scanf(\"%d %d\",&amp;n,&amp;m);\nfor(int i=1;i&lt;=m;i++)\n{\n    str = 0;\n    for(int j=1;j&lt;=n+1;j++)\n    {\n       scanf(\"%c\",&amp;c);\n\n       if(c=='W')\n           str = str*1000+1;\n       else\n            str = str*1000;\n    }//end of getting characters\n\n    sumstr += str;\n}//end of getting lines\n\n//Reversing the \"sumstr\"\nwhile(sumstr&gt;0)\n{\n    a = sumstr%1000;\n    reverse = (reverse+a)*1000;\n    sumstr/=1000;\n}\nreverse/=1000;\n\nfor(int k =1;k&lt;=n;k++)\n{\n    a=reverse%1000;\n\n    if(a%2==0)\n        printf(\"B\");\n    else\n        printf(\"F\");\n   reverse /= 1000;\n}//End of printing 'B' and 'F'\n</code></pre>\n"}, {"tags": ["c", "clion"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1572435069, "post_id": 58624409, "comment_id": 103556489, "body": "Please, choose either XCode or CLion, as the answers will be different."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1572441740, "post_id": 58624409, "comment_id": 103560255, "body": "Are you asking for arguments passed into <code>argv[]</code>? Or are you trying to redirect <code>stdin</code> to a file?"}, {"owner": {"reputation": 51, "user_id": 2953801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c84d93e885277363275d6b75f9926082?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/2953801/danny"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1572449417, "post_id": 58624409, "comment_id": 103564900, "body": "@thebusybee I am trying to redirect <code>stdin</code> to a file."}], "answers": [{"tags": [], "owner": {"reputation": 1726, "user_id": 1414496, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c75b36035fb412c9f2629a888bfb977e?s=128&d=identicon&r=PG", "display_name": "Joel Bodenmann", "link": "https://stackoverflow.com/users/1414496/joel-bodenmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1572436085, "last_edit_date": 1572436085, "creation_date": 1572435264, "answer_id": 58624492, "question_id": 58624409, "link": "https://stackoverflow.com/questions/58624409/run-with-stdin-in-clion/58624492#58624492", "title": "Run with stdin in CLion", "body": "<p>In CLion, go to your <code>Run/Debug Configurations</code>. There's a field named <code>Program arguments</code>. This field allows you to set \"a custom parameter\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/lxqVM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lxqVM.png\" alt=\"&quot;Run/Debug Configurations&quot; Dialog - CLion 2019.2.2\"></a></p>\n\n<p>You can find the corresponding documentation <a href=\"https://www.jetbrains.com/help/clion/creating-and-editing-run-debug-configurations.html\" rel=\"nofollow noreferrer\">here</a>.\nAn excerpt from the documentation to help finding the correct dialog:</p>\n\n<blockquote>\n  <p>With the Navigation bar visible (View | Appearance | Navigation Bar), the available run/debug configurations are displayed in the run/debug configuration selector in the Run area:</p>\n</blockquote>\n\n<p>Note that this of course only works for executable targets (or non executable targets that have an executable set).</p>\n\n<p>Also note that this will most likely not allow you to do any shell redirection. Setting the field to <code>&lt; myfile.txt</code> will not have the effects you are looking for. It will literally copy the strings <code>&lt;</code> and <code>myfile.txt</code> as input arguments 1 and 2 (0 being the binary name).\nIf you want to pass file contents in this manner you'll have to just pass the file path using this method and then open &amp; load the file in your application.</p>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 1, "last_activity_date": 1572469555, "creation_date": 1572469555, "answer_id": 58633649, "question_id": 58624409, "link": "https://stackoverflow.com/questions/58624409/run-with-stdin-in-clion/58633649#58633649", "title": "Run with stdin in CLion", "body": "<p>It seems as if redirection of <code>stdin</code> for the program to be run or debugged is still not implemented. See the issue <a href=\"https://youtrack.jetbrains.com/issue/CPP-3153\" rel=\"nofollow noreferrer\">\"Add an option to specify default input and output streams for console applications\"</a> at JetBrain's bugtracker.</p>\n\n<p>Other IDEs like Eclipse can do this.</p>\n"}], "owner": {"reputation": 51, "user_id": 2953801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c84d93e885277363275d6b75f9926082?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/2953801/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572469555, "creation_date": 1572434970, "last_edit_date": 1572439687, "question_id": 58624409, "link": "https://stackoverflow.com/questions/58624409/run-with-stdin-in-clion", "title": "Run with stdin in CLion", "body": "<p>I would like to ask if there is any possibility to run code with custom parameters in CLion. And where to put the file.txt in project folder.</p>\n\n<p>Something equivalent to <code>./program &lt;file.txt</code></p>\n"}, {"tags": ["c++", "c", "llvm", "compiler-optimization"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1572435980, "post_id": 58624398, "comment_id": 103556931, "body": "Contact the third party, present what you are seeing.  Beyond that, this question presents too little specific information for any useful answers to be possible."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1572436468, "post_id": 58624398, "comment_id": 103557192, "body": "A segfault arising from (mis)optimization of C code almost always can be traced back to undefined behavior of the code.  In a very few cases it arises from a flaw in the compiler. Any way around, if the workaround you discovered is unsatisfactory then this is a problem that the purveyors of the library in question are best prepared to handle, and one which I suppose they would <i>want</i> to know about and handle."}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 0, "creation_date": 1572436491, "post_id": 58624398, "comment_id": 103557200, "body": "LLVM&#39;s <a href=\"http://llvm.org/docs/CommandGuide/opt.html\" rel=\"nofollow noreferrer\">opt</a> has options to run and rerun with different combinations of passes, and to print what each pass does. That said, I agree this is too vague to be on-topic, and will vote to close."}, {"owner": {"reputation": 143, "user_id": 4268324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1777f59325d41215213b8a2a90a893ff?s=128&d=identicon&r=PG&f=1", "display_name": "Conanap", "link": "https://stackoverflow.com/users/4268324/conanap"}, "edited": false, "score": 0, "creation_date": 1572438278, "post_id": 58624398, "comment_id": 103558197, "body": "I think I should mention that with SLP Vectorizer on, the code segfaults, but without it, it does not, which is why I didn&#39;t think this would be an appropriate question for the 3rd party library providers. Thank you regardless."}], "owner": {"reputation": 143, "user_id": 4268324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1777f59325d41215213b8a2a90a893ff?s=128&d=identicon&r=PG&f=1", "display_name": "Conanap", "link": "https://stackoverflow.com/users/4268324/conanap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1589202737, "creation_date": 1572434933, "last_edit_date": 1589202737, "question_id": 58624398, "link": "https://stackoverflow.com/questions/58624398/approaches-in-debugging-segfaults-caused-by-llvm-optimization", "title": "Approaches in debugging segfaults caused by LLVM optimization", "body": "<p>We have a third party library, SPEC, that we use to test with. An optimizer pass in our local LLVM version causes SPEC to crash after SPEC has been optimized by our version of SLP Vectorizer.</p>\n\n<p>I know specifically which file in the 3rd party library is segfaulting, but I do not know exactly what the transformation that is happening causes the segfault. I know that with SLP enabled, it causes it to crash. I also have the IR / assembly of the optimized vs unoptimized code, but I do not know which line in the library it actually segfaults.</p>\n\n<p>I've been able to narrow down the file that causes the segfault in the library, and I know that it's a vectorization of a store that's causing problems (ie, if I disable that transformation, the library no longer segfaults). However, I didn't write the passes nor the libraries. I don't know how to continue. What approaches can I take to identify such problems?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1572432693, "post_id": 58623710, "comment_id": 103555222, "body": "<code>if(fgets(buf, MAX, stdin) == EOF)</code> &lt;&lt;-- fgets() never returns EOF."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1572432931, "post_id": 58623710, "comment_id": 103555366, "body": "Maybe you could change the condition to <code>if(fgets(buf, MAX, stdin) == NULL)</code>"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1572433048, "post_id": 58623710, "comment_id": 103555428, "body": "\u201chow to read the numbers and store them inside a linked list\u201d \u2014 why? This isn\u2019t a particularly useful representation for an expression parser."}, {"owner": {"reputation": 141, "user_id": 11527052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lS_-2UaV8G0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcje4dKnsWqzoTS4MSOeukJWFHTwA/mo/photo.jpg?sz=128", "display_name": "Michaelangelo Meucci", "link": "https://stackoverflow.com/users/11527052/michaelangelo-meucci"}, "edited": false, "score": 0, "creation_date": 1572434049, "post_id": 58623710, "comment_id": 103555981, "body": "the question is about reading data, for the moment I&#39;m not focusing on parsing I could have used also an array."}, {"owner": {"reputation": 373, "user_id": 6044375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i5SDT.jpg?s=128&g=1", "display_name": "JL. Sanchez", "link": "https://stackoverflow.com/users/6044375/jl-sanchez"}, "edited": false, "score": 0, "creation_date": 1572434586, "post_id": 58623710, "comment_id": 103556260, "body": "On your &#39;while&#39; loop, add a condition for the string terminator: <code>while (*buf &amp;&amp; *buf != &#39;\\n&#39;) {</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1572434871, "post_id": 58623710, "comment_id": 103556394, "body": "Please find out where the compiler warnings go to and act upon them!"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1572442196, "post_id": 58623710, "comment_id": 103560530, "body": "Also: by incrementing buf, you loose grip on the pointer returned by malloc(). So you can never reuse or free it. Use a separate pointer (or an index) to walk the buffer."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 0, "last_activity_date": 1572434942, "creation_date": 1572434942, "answer_id": 58624401, "question_id": 58623710, "link": "https://stackoverflow.com/questions/58623710/read-expressions-at-the-command-line/58624401#58624401", "title": "read expressions at the command line", "body": "<p>Simple mistake</p>\n\n<pre><code>if (isdigit(*buf)) {\n    sscanf(buf, \"%lf%n\", &amp;num, &amp;n);\n    add_item(&amp;head, &amp;num);\n    buf += n; // Here we are incrementing buf\n}\n\nif (!isdigit(*buf)){ // So here we are looking at index buf+n\n    buf++;\n}\n</code></pre>\n\n<p>What you need to do here is a couple of <code>if else</code>. But another thing here is that it is pretty redundant to first check if it is a digit, and then check if it's not. Rewrite to this:</p>\n\n<pre><code>if (isdigit(*buf)) {\n    sscanf(buf, \"%lf%n\", &amp;num, &amp;n);\n    add_item(&amp;head, &amp;num);\n    buf += n;\n} else {\n    buf++;\n}\n</code></pre>\n\n<p>But, as have already been mentioned in comments, a linked list is not a very good strategy when constructing a parser. You should use a tree instead. You should also read about grammars to define the syntax. Read about grammars here: <a href=\"https://en.wikipedia.org/wiki/Regular_grammar\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Regular_grammar</a></p>\n"}], "owner": {"reputation": 141, "user_id": 11527052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lS_-2UaV8G0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcje4dKnsWqzoTS4MSOeukJWFHTwA/mo/photo.jpg?sz=128", "display_name": "Michaelangelo Meucci", "link": "https://stackoverflow.com/users/11527052/michaelangelo-meucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572435075, "creation_date": 1572432574, "last_edit_date": 1572435075, "question_id": 58623710, "link": "https://stackoverflow.com/questions/58623710/read-expressions-at-the-command-line", "title": "read expressions at the command line", "body": "<p>I'm trying to write a calculator which is able to read expression like (5+12*5)^2; it is not a polish calculator.</p>\n\n<p>For the moment I'm focusing on how to read the numbers and store them inside a linked list. The program should read a line compute the result and wait for the next input (like commands are take in a shell).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n#define MAX 100\n\nstruct n{\n    double value;\n    char op;\n    struct n *next;\n};\n\nvoid print_list(struct n *head);\nvoid add_item(struct n **ptr, double *data);\nvoid free_all(struct n *head);\nvoid f(double x);\n\nint main()\n{\n    struct n *head = NULL;\n\n    char *buf = malloc(MAX * sizeof (*buf));\n    int n;\n    double num;\n\n    for(;;) {\n\n        if(fgets(buf, MAX, stdin) == NULL)\n            return 0;\n\n        while (*buf != '\\n') {\n\n            if (isdigit(*buf)) {\n                sscanf(buf, \"%lf%n\", &amp;num, &amp;n);\n                add_item(&amp;head, &amp;num);\n                buf += n;\n            }\n\n            if (!isdigit(*buf)){\n                buf++;\n            }\n\n            print_list(head);   \n        }\n       free(head);\n    }\n\n\n\n    return 0;\n}\n\nvoid print_list(struct n *head) {\n\n    if (head != NULL) {\n        f(head-&gt;value);\n        print_list(head-&gt;next);\n    }\n}\n\nvoid add_item(struct n **ptr, double *data)\n{\n        struct n *item = malloc(sizeof *item);\n\n        item-&gt;value = *data;\n        item-&gt;next = *ptr;\n        item-&gt;op = '*';\n        *ptr = item;\n}\n\nvoid free_all(struct n *head)\n{\n    struct n *tmp;\n\n    while (head != NULL)\n    {\n       tmp = head;\n       head = head-&gt;next;\n       free(tmp);\n    }\n}\n\nvoid f(double x)\n{\n    double i, r = modf(x, &amp;i);\n\n    if(fabs(r)&lt;.00001)\n        printf(\"%.f \",i);\n\n    else printf(\"%f \",x);\n}\n</code></pre>\n\n<p>I'm using fgets and I'm able to read the input but the program gets into an infinite loop. I'm not sure what's the best function to read data for this purpose.</p>\n"}, {"tags": ["c", "struct", "offsetof"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1572432492, "post_id": 58623573, "comment_id": 103555122, "body": "<code>struct osc_in_data *ptr;</code> --&gt;&gt; <code>char *ptr;</code> [for raw pointer arithmetic] And: you&#39;ll need some ugly casts..."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1572433266, "post_id": 58623573, "comment_id": 103555545, "body": "There is a high correlation between having a good reason to use <code>offsetof</code> and having the knowledge to use it correctly."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 3, "last_activity_date": 1572432517, "creation_date": 1572432517, "answer_id": 58623690, "question_id": 58623573, "link": "https://stackoverflow.com/questions/58623573/what-is-correct-way-to-access-a-struct-using-pointer-and-offsetof/58623690#58623690", "title": "What is correct way to access a struct using pointer and offsetof()", "body": "<p>The members have <code>int32_t</code> type so pointers to them are <code>int32_t*</code>.</p>\n\n<p>The <code>offsetof(...)</code> is just the offset in bytes. So you just take the pointer to the structure which member you want to modify. Then add to the pointer the offset using plain addition and remembering to use <code>char*</code> pointers to add one byte at a time. Then just cast the pointer to proper type and dereference and access it.</p>\n\n<pre><code>void SetADSRvalues(size_t offset, int32_t data)\n{\n    for (size_t harmonic = 0; harmonic &lt; NumHarmonics; harmonic++) {\n          // take the pointer to the structure we want to modify\n          void *base = &amp;OscControl[harmonic];\n          // arithmetic using void* pointers is invalid\n          // so convert to `char*` pointer before arithmetic\n          char *basechar = base;\n          // then add the offset - just plain addition\n          // results in the address of the member inside the struct\n          void *memberpnt = basechar + offset;\n          // the member is `int32_t`, so the pointer has to be `int32_t*`\n          int32_t *memberpnt_int32 = memberpnt;\n          // finally set the value\n          *memberpnt_int32 = data;\n\n          // or a oneliner version:\n          *(int32_t*)((char*)&amp;OscControl[harmonic] + offset) = data;\n    }\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 189, "user_id": 10829471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34770f92d5a756d0ca7b88c0631f2e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Bryant", "link": "https://stackoverflow.com/users/10829471/mike-bryant"}, "edited": false, "score": 1, "creation_date": 1572433835, "post_id": 58623698, "comment_id": 103555852, "body": "@MikeBryant It shouldn&#39;t give a warning if you&#39;re compiling with a C++ compiler. This solution is also more correct -- the solution mentioned in the other answer has undefined behavior due to the strict aliasing rule."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1572432538, "creation_date": 1572432538, "answer_id": 58623698, "question_id": 58623573, "link": "https://stackoverflow.com/questions/58623573/what-is-correct-way-to-access-a-struct-using-pointer-and-offsetof/58623698#58623698", "title": "What is correct way to access a struct using pointer and offsetof()", "body": "<p>The <code>offsetoff</code> function tells you the distance in bytes between 2 memory adresses inside the same structure.</p>\n\n<p>With below code you are telling,</p>\n\n<pre><code>   *(ptr + offset) = data;\n</code></pre>\n\n<p>do pointer arithmetic on <code>struct osc_in_data</code> pointer, that is same as <code>ptr[offset] = data;</code></p>\n\n<p>Instead what you can try is.</p>\n\n<pre><code>memcpy((char *)ptr + offset, data, sizeof data);\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 10829471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34770f92d5a756d0ca7b88c0631f2e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Bryant", "link": "https://stackoverflow.com/users/10829471/mike-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 58623690, "answer_count": 2, "score": 0, "last_activity_date": 1572432538, "creation_date": 1572432160, "question_id": 58623573, "link": "https://stackoverflow.com/questions/58623573/what-is-correct-way-to-access-a-struct-using-pointer-and-offsetof", "title": "What is correct way to access a struct using pointer and offsetof()", "body": "<p>I have the following code so as to be able to access numerous fields in array of structs (I've reduced it to two for simplicity).  What is the correct incantation for the final pointer calculation \n    <code>*(ptr + offset) = data;</code> \nbecause I always get :</p>\n\n<p>error: incompatible types when assigning to type \u2018struct osc_in_data\u2019 from type \u2018int32_t\u2019 {aka \u2018int\u2019}</p>\n\n<pre><code>#define NumHarmonics   10\n\nint32_t data1;\nint32_t data2;\n\n\n\nstruct osc_in_data                                                           \n{\n    int32_t     LevelAttackRate;                                                \n    int64_t     LevelPeakLevel;                                                 \n    int32_t     LevelDecayRate;                                                 \n} OscControl[NumHarmonics];\n\n\n\nvoid SetADSRvalues(int32_t offset, int32_t data)\n{\n    int32_t harmonic;\n    struct osc_in_data *ptr;\n    for (harmonic = 0; harmonic &lt; NumHarmonics; harmonic++)\n    {\n       ptr = &amp;OscControl[harmonic];\n       *(ptr + offset) = data;\n    }\n} \n\n\nSetADSRvalues(offsetof(struct osc_in_data, LevelAttackRate), data1)\nSetADSRvalues(offsetof(struct osc_in_data, LevelDecayRate), data2)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1572431270, "post_id": 58623250, "comment_id": 103554450, "body": "Try <code>printf(&quot;%s&quot;, str);</code> instead."}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1572431283, "post_id": 58623250, "comment_id": 103554459, "body": "What are <code>term</code> and <code>term2</code> for???"}, {"owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "edited": false, "score": 0, "creation_date": 1572431497, "post_id": 58623250, "comment_id": 103554585, "body": "<code>printf(&quot;%s&quot;, str);</code> prints the first number (stopped where the first white space is )   ignore the unused variables - they appear later in the code"}, {"owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "edited": false, "score": 0, "creation_date": 1572431811, "post_id": 58623250, "comment_id": 103554747, "body": "changed for fgets . now for example i enter the string <code>542 2452 425</code> and the output is <code>542 2</code> ; another example - input : <code>312 4356 52</code> , output - <code>312 435</code> . If i had to guess maybe im not allocationg enough space with malloc for the string ?"}, {"owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "edited": false, "score": 0, "creation_date": 1572431978, "post_id": 58623250, "comment_id": 103554823, "body": "Thank you , it is working now"}, {"owner": {"reputation": 394, "user_id": 2023321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1iHEw.jpg?s=128&g=1", "display_name": "Eduardo Fernandes", "link": "https://stackoverflow.com/users/2023321/eduardo-fernandes"}, "edited": false, "score": 0, "creation_date": 1572437012, "post_id": 58623250, "comment_id": 103557480, "body": "Use fgets() instead of scanf() to get the string from the user. scantf() doesn&#39;t read white spaces."}], "owner": {"reputation": 728, "user_id": 11918269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164413c80736b589e0d3bc55ae4d97e1?s=128&d=identicon&r=PG&f=1", "display_name": "Eliran Turgeman", "link": "https://stackoverflow.com/users/11918269/eliran-turgeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572431167, "creation_date": 1572431167, "question_id": 58623250, "link": "https://stackoverflow.com/questions/58623250/converting-a-string-populated-with-numbers-and-white-spaces-to-int", "title": "Converting a string (populated with numbers and white spaces) to int", "body": "<p>The goal of this program is to scan a string populated with numbers and white spaces between them and insert each number into an array. </p>\n\n<p>This is the relevent part of my code - im encountering a weird phenomena after trying to scan and print the string supplied by the user . </p>\n\n<pre><code>int main()\n{\n    int exp,size,*numbers,sum=0;\n    char term,term2,*str=NULL,*n;\n\n\n    printf(\"Enter size of input:\");\n    if(scanf(\"%d%c\", &amp;size, &amp;term) != 2 || term != '\\n'){//checking if a valid size was entered\n        printf(\"Invalid Size\\n\");\n        return 0;\n    } if(size&lt;=0){//checking if a valid size was entered\n        printf(\"Invalid size\\n\");\n        return 0;\n    } else{//allocating memory to an array and a string with the supplied size\n        numbers=(int*)malloc(size * sizeof(int));\n        str=(char*)malloc(sizeof(int)*(size+1) + (size-1)*sizeof(char));\n        if(numbers==NULL||str==NULL){// in case memory allocation didn't work\n            printf(\"Out of memory\\n\");\n            return 0;\n        } else{\n            printf(\"Memory allocated\\n\");\n        }\n        printf(\"Enter numbers:\");\n        scanf(\"%s\",str);//trying to scan the string\n        printf(\"%s\",*str);\n        free(numbers);\n        free(str);\n}\n}\n</code></pre>\n\n<p>The moment im done writing an input for the scanf line and press enter the program just ends without printing and i get a warning : \n<code>warning : forat '%s' expects argument of type ' char *' , but argument 2 has type 'int' ..</code></p>\n\n<p>So i went to the <code>printf(\"%s\",*str);</code> and changed it to <code>printf(\"%d\",*str);</code> but as you might have guessed it spits random numbers. </p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 3, "creation_date": 1572429831, "post_id": 58622788, "comment_id": 103553664, "body": "The error messages are clear enough. Why do not you read them?! Use scanf(&quot;%d&quot;,&amp;x); and scanf(&quot;%lf&quot;,&amp;f);"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1572431276, "post_id": 58622788, "comment_id": 103554453, "body": "Although you didn&#39;t ask,   <code>scanf(&quot;%s&quot;, r)</code> gives undefined behaviour if <code>r</code> is an array with one element (as it is in your code) and the user enters any non-whitespace character (like <code>&#39;A&#39;</code>) followed by a newline.    The <code>%s</code> format as-is causes <code>scanf()</code> to ASSUME the array passed is long enough to hold a string the user enters, plus a following nul character.   Providing an array that does not satisfy that assumption gives undefined behaviour."}, {"owner": {"reputation": 11, "user_id": 3253021, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000145584887/picture?type=large", "display_name": "user3253021", "link": "https://stackoverflow.com/users/3253021/user3253021"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1572431778, "post_id": 58622788, "comment_id": 103554731, "body": "@Peter to prevent that from happening i used the While Loop and a 1-character string instead of a character."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1572433059, "post_id": 58622788, "comment_id": 103555434, "body": "@user3253021 - that doesn&#39;t fix it.   If the user enters the letter <code>A</code> followed by anything (even a newline, or a space, or a character then a space),  <code>scanf()</code> will write more than one character to the array.   For an array with one element, that gives undefined behaviour.    <code>strlen(r)</code> will also have undefined behaviour."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1572433865, "post_id": 58622788, "comment_id": 103555874, "body": "@VladfromMoscow: The messages are not clear to somebody who has not learned that <code>int*</code> means a pointer to an <code>int</code>. To their eye, the <code>*</code> is some cryptic character the computer inserted."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 5, "last_activity_date": 1572430018, "creation_date": 1572430018, "answer_id": 58622905, "question_id": 58622788, "link": "https://stackoverflow.com/questions/58622788/i-keep-getting-type-related-errors/58622905#58622905", "title": "i keep getting type-related errors", "body": "<p>It's like the warning says: The function is expecting pointers to the types that you're giving it. Fix it by putting a <code>&amp;</code> before the variable, which makes it pass the address instead:</p>\n\n<pre><code>printf(\"Geben Sie eine ganze Zahl\");\nscanf(\"%d\", &amp;x);\nprintf(\"Geben Sie eine reele Zahl\");\nscanf(\"%lf\", &amp;f);\n</code></pre>\n\n<p>There's also an issue with how you're reading in characters. This here</p>\n\n<pre><code>char r[1] = \"\";\nchar s[1] = \"\";\n</code></pre>\n\n<p>Makes two arrays that contain nothing else than a null terminator. It doesn't have any capacity to read in a non-empty string, which you're doing here:</p>\n\n<pre><code>scanf(\"%s\", r);\n</code></pre>\n\n<p>It's unclear whether you're trying to read in a whole string or just a character, as your output implies. For just one character, your code should look like this:</p>\n\n<pre><code>char r;\nscanf(\"%c\", &amp;r);\n</code></pre>\n\n<p>And for a whole string:</p>\n\n<pre><code>char r[20]; // can hold 19 chars plus a null terminator\nscanf(\"%19s\", r);\n</code></pre>\n\n<p>Adjust those sizes to match the length of the string that you need to read.</p>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 10135172, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s9S7viF0Q7w/AAAAAAAAAAI/AAAAAAAAFAE/zqAsbnP9nsE/photo.jpg?sz=128", "display_name": "Yasir", "link": "https://stackoverflow.com/users/10135172/yasir"}, "is_accepted": false, "score": 0, "last_activity_date": 1572430851, "creation_date": 1572430851, "answer_id": 58623162, "question_id": 58622788, "link": "https://stackoverflow.com/questions/58622788/i-keep-getting-type-related-errors/58623162#58623162", "title": "i keep getting type-related errors", "body": "<p><code>scanf()</code> requires the memory address of the variable to assign the value. and you need to specify the address with an ampersand before the variable like <code>&amp;variable</code> . There's the problem. But when working with strings you don't need that, remember strings are array of characters. So when addressing a string you don't address a variable, you give the first index of the array.So you don't add ampersand there.</p>\n\n<pre><code>int x=0;\nint l=0;\ndouble f=0;\n\nprintf(\"Geben Sie eine ganze Zahl\");\n\nscanf(\"%d\",&amp;x);\n\nprintf(\"Geben Sie eine reele Zahl\");\n\nscanf(\"%lf\",&amp;f);\n\nl=-1;\nchar r[1]=\"\";\nchar s[1]=\"\";\nwhile(l !=1){\n    printf(\"Geben Sie ein Zeichen\");\n    scanf(\"%s\",r);\n    l=strlen(r);\n}\nreturn 0;\n</code></pre>\n\n<p>and why are you taking 1 character as a string? you could just do it this way</p>\n\n<pre><code>char r='';\nwhile( r==''){\n     scanf(\"%c\",&amp;r);\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3253021, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000145584887/picture?type=large", "display_name": "user3253021", "link": "https://stackoverflow.com/users/3253021/user3253021"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1572430851, "creation_date": 1572429636, "last_edit_date": 1572430377, "question_id": 58622788, "link": "https://stackoverflow.com/questions/58622788/i-keep-getting-type-related-errors", "title": "i keep getting type-related errors", "body": "<p>I'm writing this program for my homework and i keep getting type errors. To my knowledge %d reads integer which is in this case the variable x and %lf reads double \" variable f\"</p>\n\n<p>i've tried to remove \"\\n\" in scanf() function as it was requested in other Questions </p>\n\n<pre><code>int x=0;\nint l=0;\ndouble f=0;\nprintf(\"Geben Sie eine ganze Zahl\");\nscanf(\"%d\",x);\nprintf(\"Geben Sie eine reele Zahl\");\nscanf(\"%lf\",f);\nl=-1;\nchar r[1]=\"\";\nchar s[1]=\"\";\n  while(l !=1){\n    printf(\"Geben Sie ein Zeichen\");\n    scanf(\"%s\",r);\n    l=strlen(r);\n}\nreturn 0;\n</code></pre>\n\n<p><strong>Errors:</strong></p>\n\n<pre><code>C:/Users/---(9): warning in format string of scanf(): the conversion %d expects type int* but given type is int (argument 1).\nC:/Users/---(11): warning in format string of scanf(): the conversion %lf expects type double* but given type is double (argument 1).\n</code></pre>\n"}, {"tags": ["c", "memory-management", "buffer-overflow"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1572428482, "post_id": 58622402, "comment_id": 103552911, "body": "<i>&quot;I shouldn&#39;t be able to ....&quot;</i> - you <i>can</i>, but you incur <i>undefined behavior</i> when doing so, and with that, all sanity and predictable behavior of your program goes down the drain. Your assessment of validity of &quot;without any buffer overflows or segmentation faults.&quot;is a point of confusion. You&#39;re assuming the behavior you <i>observed</i> is defined; the very structure of your program says otherwise. Don&#39;t confuse defined behavior with observed behavior. The former leads to the latter; the latter proves <i>nothing</i> if the former isn&#39;t there to begin with."}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1572428509, "post_id": 58622402, "comment_id": 103552927, "body": "Depends on the current memory layout, your OS, etc. You&#39;re either overriding accessible memory, or you are performing an illegal memory write-access. The behavior of your program is not well defined when executed on different platforms (and even on a single platform where conditions change from one execution to another)."}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 1, "creation_date": 1572428639, "post_id": 58622402, "comment_id": 103552994, "body": "And BTW, this forum is kinda like a cult, with a very strict set of rules, one of the basic of which being &quot;shalt not perform or even think about performing any type of undefined behavior&quot;... So get ready for some dislikes (not by me of course)."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1572430159, "post_id": 58622402, "comment_id": 103553870, "body": "The worst of scenarios is exactly what you are experiencing; everything <i>appears</i> to work, but in reality all is not well. Such situations tend to rear the nature of undefined behavior at the most inopportune times, such as when code that appears to run fine on <i>your</i> machine pukes its guts out on, say, a professor&#39;s rig, or even work, a <i>customer&#39;s</i> environment. Fail-hard/Fail-fast is far more preferential to appears to work; at least then there is less of a chance of false, misplaced, contentment just waiting to gouge us with a dull spoon."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1572433721, "post_id": 58622402, "comment_id": 103555785, "body": "@goodvibration Except from compiler extensions, I don&#39;t see any reason to invoke UB. At least not when you are learning. If you really know what you&#39;re doing and you&#39;re doing some heavy micro optimizations (Carmack trick) for a specific platform, then it&#39;s another thing. But UB:s are the source of so many bugs that are really tricky to find, so you should be able to motivate invoking it EVERY time."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 4, "last_activity_date": 1572429531, "last_edit_date": 1572429531, "creation_date": 1572428684, "answer_id": 58622501, "question_id": 58622402, "link": "https://stackoverflow.com/questions/58622402/why-am-i-able-to-copy-more-bytes-than-defined-in-the-char-array/58622501#58622501", "title": "Why am I able to copy more bytes than defined in the char array?", "body": "<p>The simple answer is that C does not protect you from yourself. It's YOUR responsibility to check boundaries. The program will happily read and write wherever you instruct it to. However, the operating system may say something if you do this, which is usually a \"segmentation fault\". A worse scenario is that it may overwrite other variables.</p>\n\n<p>This is a source of many bugs in C, so be careful. Whenever you're writing outside outside a buffer, you're invoking <em>undefined behavior</em> and these can manifest themselves in various ways, including the program working as it should, overwriting variables and segmentation faults.</p>\n\n<blockquote>\n  <p>I shouldn't be able to put in more than 2 char plus null terminating character</p>\n</blockquote>\n\n<p>This is a common bug. It's NOT \"plus null terminating character\". It's INCLUDING null terminating character.</p>\n"}], "owner": {"reputation": 681, "user_id": 6418023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10210108852944510/picture?type=large", "display_name": "Devanshu Misra", "link": "https://stackoverflow.com/users/6418023/devanshu-misra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1572429533, "accepted_answer_id": 58622501, "answer_count": 1, "score": 0, "last_activity_date": 1572429531, "creation_date": 1572428325, "question_id": 58622402, "link": "https://stackoverflow.com/questions/58622402/why-am-i-able-to-copy-more-bytes-than-defined-in-the-char-array", "closed_reason": "Duplicate", "title": "Why am I able to copy more bytes than defined in the char array?", "body": "<p>I have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char buffer[2];\n    strcpy(buffer, \"12345678910\");\n    printf(\"%s\\n\", buffer);\n    return 0;\n}\n</code></pre>\n\n<p>Since, I have already defined the char array with size <code>2</code>, I shouldn't be able to put in more than <code>2 char plus null terminating character</code>. Yet, it is able to take more than that without any buffer overflows or segmentation faults. Even if I copy the string <code>strcpy(buffer, \"123456789101298362936129736129369182\");</code>, it works fine. The error is generated when I push <code>strcpy(buffer, \"1234567891012983629361297361293691823691823869182632918263918\");</code>.</p>\n\n<p>More of a theroetical question than a practical, but I hope it helps the new and the experienced programmers alike since it talks about the fundamentals, and helps improving coding ethics. Thanks in advance.</p>\n"}, {"tags": ["c", "performance", "boolean", "c99", "unsigned"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 4, "creation_date": 1572428204, "post_id": 58622239, "comment_id": 103552744, "body": "Does it matter?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1572429018, "post_id": 58622239, "comment_id": 103553210, "body": "<code>int</code> is kinda the &quot;default&quot; datatype, I do not believe that there is a deeper reason than that."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1572445312, "post_id": 58622239, "comment_id": 103562387, "body": "Also if we had <code>#define true ((_Bool)1)</code>, then it wouldn&#39;t be valid in an <code>#if</code> directive."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1572453108, "post_id": 58622239, "comment_id": 103567050, "body": "@aschepler Note: <code>#define true 1u</code> would be fine in an <code>#if</code> directive."}], "answers": [{"comments": [{"owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572431054, "post_id": 58622992, "comment_id": 103554342, "body": "And there&#39;s no performance difference in comparison (<code>1 == 1</code> vs <code>1U</code> == <code>1U</code>)? What about <code>if (1)</code> vs <code>if (1U)</code>? Have you some bench?"}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "reply_to_user": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572432629, "post_id": 58622992, "comment_id": 103555194, "body": "You can generate asm file (gcc -S). You will see that it generates the same code for both signed and signed values - the compiler skip the test, as this is a constant expression."}, {"owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572435278, "post_id": 58622992, "comment_id": 103556595, "body": "Mmmmh.... I just have a simple question now: <code>1U == 1U</code> what does return, an <code>int</code> or an <code>unsigned int</code>?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572435978, "post_id": 58622992, "comment_id": 103556928, "body": "@MarcoSulla The result of <code>==</code> operator has the type <code>int</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572452111, "post_id": 58622992, "comment_id": 103566470, "body": "&quot;As such, they are not signed or unsigned&quot;  --&gt; Disagree.   <code>true</code> is specified as a &quot;integer constant 1&quot;.  An integer constant  of 1 in code has type <code>int</code>.  C11 &#167;6.4.4.1 5"}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": false, "score": 3, "last_activity_date": 1572430229, "creation_date": 1572430229, "answer_id": 58622992, "question_id": 58622239, "link": "https://stackoverflow.com/questions/58622239/why-in-stdbool-h-are-used-integers-and-not-unsigned-ones/58622992#58622992", "title": "Why in stdbool.h are used integers and not unsigned ones?", "body": "<p>Both true and false are '#defined' to 0, 1. As such, they are not signed or unsigned, just token. They will be 'typed' on assignment, comparison, usually at no run-time cost.</p>\n\n<pre><code>bool b = true ;\nunsigned int uv = true ;\nint sv = true ;\n</code></pre>\n\n<p>Both will take same time to executed</p>\n"}, {"comments": [{"owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572430675, "post_id": 58623063, "comment_id": 103554139, "body": "Apart the fact that your professor&#39;s affirmation is highly questionable, <code>0U</code> does not means zero? :D"}, {"owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "reply_to_user": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572430833, "post_id": 58623063, "comment_id": 103554238, "body": "I meant more about the reference system in which we consider the voltage as the zero level of the system and the higher voltage is an 1 :&#39;)"}], "tags": [], "owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1572430472, "creation_date": 1572430472, "answer_id": 58623063, "question_id": 58622239, "link": "https://stackoverflow.com/questions/58622239/why-in-stdbool-h-are-used-integers-and-not-unsigned-ones/58623063#58623063", "title": "Why in stdbool.h are used integers and not unsigned ones?", "body": "<p>Once in one of my lectures my professor said that bool implementation in C as integers was dedicated to electric rules. 1 electricity flows, 0 no signal. So 1-true 0 false</p>\n"}, {"comments": [{"owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572431794, "post_id": 58623323, "comment_id": 103554739, "body": "Why could you want a <code>int minust = -true;</code> in your code? IMHO <code>-true</code> makes no sense, what you want is <code>! true</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572432742, "post_id": 58623323, "comment_id": 103555252, "body": "@MarcoSulla It&#39;s just an example."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572434777, "post_id": 58623323, "comment_id": 103556343, "body": "@MarcoSulla: Another reason is consistency with types produced by various operators. See the third paragraph I just added to my answer."}, {"owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572435661, "post_id": 58623323, "comment_id": 103556786, "body": "Yes, we arrived to the <a href=\"https://stackoverflow.com/questions/58622239/why-in-stdbool-h-are-used-integers-and-not-unsigned-ones/58623323#comment103556595_58622992\">same conclusion</a> :)"}, {"owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572435977, "post_id": 58623323, "comment_id": 103556927, "body": "I can accept your answer, if you remove the first part :P"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572436359, "post_id": 58623323, "comment_id": 103557131, "body": "@MarcoSulla: I&#39;d rather keep the first part, but I&#39;ve rearranged the parts to make it the last part, more of an aside."}, {"owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "edited": false, "score": 0, "creation_date": 1572436524, "post_id": 58623323, "comment_id": 103557220, "body": "Well, IMHO if you get a <code>-true</code> in a code, you&#39;re authorized to slap the coder :D Anyway I accept your answer :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572453651, "post_id": 58623323, "comment_id": 103567342, "body": "The first part is good UV. The 2nd <code>-true</code> example is weak.  Similar weak argument could be made for <code>~false</code> favoring <code>unsigned</code> - it&#39;s always well defined.  As <code>int</code> can lead to troubles with archaic sign-magnitude, ones&#39; complement.  <code>~false</code> is still false with ones&#39; complement."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572455596, "post_id": 58623323, "comment_id": 103568291, "body": "@chux I&#39;ve added another paragraph to try and explain what I was trying to get at with my somewhat weak example."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 4, "last_activity_date": 1572455298, "last_edit_date": 1572455298, "creation_date": 1572431390, "answer_id": 58623323, "question_id": 58622239, "link": "https://stackoverflow.com/questions/58622239/why-in-stdbool-h-are-used-integers-and-not-unsigned-ones/58623323#58623323", "title": "Why in stdbool.h are used integers and not unsigned ones?", "body": "<p>Using the type <code>int</code> for the values <code>false</code> and <code>true</code> makes them agree with the type and set of values resulting from the logical negation operator (<code>!</code>), the relational operators (<code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>), the equality operators (<code>==</code>, <code>!=</code>), the logical AND operator (<code>&amp;&amp;</code>), and the logical OR operator (<code>||</code>), all of which produce the value 0 or 1 of type <code>int</code>.</p>\n\n<p>Also, if <code>true</code> was defined as <code>1u</code>, then <code>int minust = -true;</code> would initialize <code>minust</code> to an implementation-defined value (or raise an implementation-defined signal), rather than initializing <code>minust</code> to the value <code>-1</code>. The compiler may issue a warning. This is because <code>1u</code> is of type <code>unsigned int</code>, <code>-1u</code> has the value <code>UINT_MAX</code>, and <code>UINT_MAX</code> cannot be represented by an <code>int</code>.</p>\n\n<p>I realize the <code>-true</code> argument is a bit weak. The point I am trying to get across is that defining the <code>false</code> and <code>true</code> constants to be of type <code>unsigned int</code>, rather than the type of the purely numeric values 0 and 1 (i.e. <code>int</code>), would impose restrictions (unwarranted restrictions in my view) of what you can do with those constants.</p>\n"}], "owner": {"reputation": 13481, "user_id": 1763602, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uZ8dA.gif?s=128&g=1", "display_name": "Marco Sulla", "link": "https://stackoverflow.com/users/1763602/marco-sulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 58623323, "answer_count": 3, "score": 3, "last_activity_date": 1572455298, "creation_date": 1572427829, "last_edit_date": 1572431087, "question_id": 58622239, "link": "https://stackoverflow.com/questions/58622239/why-in-stdbool-h-are-used-integers-and-not-unsigned-ones", "title": "Why in stdbool.h are used integers and not unsigned ones?", "body": "<p>In <code>stdbool.h</code>, <code>true</code> and <code>false</code> are simply integers. Why not unsigned? Is there performance motivations?</p>\n"}, {"tags": ["c", "math", "addition"], "comments": [{"owner": {"reputation": 312, "user_id": 3529065, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d3b2ce14931ce2caede7e1896a0bb15?s=128&d=identicon&r=PG&f=1", "display_name": "Hagadol", "link": "https://stackoverflow.com/users/3529065/hagadol"}, "edited": false, "score": 0, "creation_date": 1572427881, "post_id": 58622209, "comment_id": 103552578, "body": "Side remark: in your first code block you say uint32 but in the second one you use signed!?"}, {"owner": {"reputation": 39, "user_id": 2105261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3eb151ff5e176bfade680ed3b0eb88d?s=128&d=identicon&r=PG", "display_name": "Vili", "link": "https://stackoverflow.com/users/2105261/vili"}, "reply_to_user": {"reputation": 312, "user_id": 3529065, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d3b2ce14931ce2caede7e1896a0bb15?s=128&d=identicon&r=PG&f=1", "display_name": "Hagadol", "link": "https://stackoverflow.com/users/3529065/hagadol"}, "edited": false, "score": 0, "creation_date": 1572428162, "post_id": 58622209, "comment_id": 103552718, "body": "@Hagadol I have corrected."}, {"owner": {"reputation": 83, "user_id": 3682683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc85c7108502ef625fa844a9bfa54d63?s=128&d=identicon&r=PG&f=1", "display_name": "kakkoko", "link": "https://stackoverflow.com/users/3682683/kakkoko"}, "edited": false, "score": 2, "creation_date": 1572428384, "post_id": 58622209, "comment_id": 103552856, "body": "How do you represent 123.04?"}, {"owner": {"reputation": 39, "user_id": 2105261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3eb151ff5e176bfade680ed3b0eb88d?s=128&d=identicon&r=PG", "display_name": "Vili", "link": "https://stackoverflow.com/users/2105261/vili"}, "reply_to_user": {"reputation": 83, "user_id": 3682683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc85c7108502ef625fa844a9bfa54d63?s=128&d=identicon&r=PG&f=1", "display_name": "kakkoko", "link": "https://stackoverflow.com/users/3682683/kakkoko"}, "edited": false, "score": 0, "creation_date": 1572428495, "post_id": 58622209, "comment_id": 103552921, "body": "@kakkoko 1 min ago signed int a_fxd = 123; signed int a_frx = 4;"}, {"owner": {"reputation": 18474, "user_id": 53328, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5146a847dccfbe3a906e327b8493f58d?s=128&d=identicon&r=PG", "display_name": "Martin Wickman", "link": "https://stackoverflow.com/users/53328/martin-wickman"}, "edited": false, "score": 0, "creation_date": 1572429418, "post_id": 58622209, "comment_id": 103553440, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/14008330/how-do-you-multiply-two-fixed-point-numbers\" title=\"how do you multiply two fixed point numbers\">stackoverflow.com/questions/14008330/&hellip;</a>"}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 1, "creation_date": 1572429511, "post_id": 58622209, "comment_id": 103553491, "body": "But a_fxd = 123; a_frx = 4 can can also represent 123.4, 123.004, 123.0004, ..."}, {"owner": {"reputation": 39, "user_id": 2105261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3eb151ff5e176bfade680ed3b0eb88d?s=128&d=identicon&r=PG", "display_name": "Vili", "link": "https://stackoverflow.com/users/2105261/vili"}, "reply_to_user": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1572436393, "post_id": 58622209, "comment_id": 103557148, "body": "@dash-o   Input data length is 16 bit. I shall multiply two 16 bit numbers. In worst case i need 32 bit for the result. Since I shall also multiply with some sin(x)value, I have also fractional part. So, i shall separate the fixed part and fractional part into two 32 bit variable."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 2, "last_activity_date": 1572443055, "last_edit_date": 1572443055, "creation_date": 1572436081, "answer_id": 58624704, "question_id": 58622209, "link": "https://stackoverflow.com/questions/58622209/how-to-multiply-fixed-point-numbers-if-fixed-and-fractional-part-are-stored-sepa/58624704#58624704", "title": "How to multiply fixed-point numbers if fixed and fractional part are stored separately?", "body": "<p>You need to decide what the actual <em>scaling factor</em> for your fractional part is.  For your particular example, it looks like an appropriate factor might be 1/1000, or 0.001.  What this means is that 56.789 is represented as 56 + 789 &times; 0.001.  But it means that 123.4 will be represented as 12 + 400 &times; 0.001.  That is, you had a mistake in your question: <code>a_frx</code> will be 400, not 4.</p>\n\n<p>I don't know <a href=\"https://en.wikipedia.org/wiki/Karatsuba_algorithm\" rel=\"nofollow noreferrer\">Karatsuba's algorithm</a>, and I suspect it's not really applicable to this problem anyway.  I only know what I earned in elementary school.</p>\n\n<p>Let's represent the scaling factor by <code>sc</code>.  So our multiplication is actually</p>\n\n<pre><code>( a_fxd + a_frx * sc ) * ( b_fxd + b_frx * sc )\n</code></pre>\n\n<p>Multiplying this out, we get</p>\n\n<pre><code>a_fxd * b_fxd + a_fxd * b_frx * sc + a_frx * b_fxd * sc + a_frx * b_frx * sc * sc\n</code></pre>\n\n<p>Collecting terms, we have</p>\n\n<pre><code>a_fxd * b_fxd + (a_fxd * b_frx + a_frx * b_fxd + a_frx * b_frx * sc) * sc\n</code></pre>\n\n<p>So if we represent the product as <code>p_fxd</code> and <code>p_frx</code>, it looks like we'll have</p>\n\n<pre><code>p_fxd = a_fxd * b_fxd\np_frx = a_fxd * b_frx + a_frx * b_fxd + a_frx * b_frx * sc\n</code></pre>\n\n<p>Let's plug in the actual values:</p>\n\n<pre><code>p_fxd = 123 * 56 = 6888\np_frx = 123 * 789 + 400 * 56 + 400 * 789 * 0.001 = 119762.600\n</code></pre>\n\n<p>But there's an additional wrinkle, because <code>p_frx</code> is really supposed to be an integer in the range 0..999.  So we need to discard the .600, and carry the 119.  So our final result is</p>\n\n<pre><code>p_fxd = 6888 + 119 = 7007\np_frx = 762\n</code></pre>\n\n<p>And this corresponds to the correct result, 123.4 &times; 56.789 = 7007.762.</p>\n\n<p>...Well, actually, the <em>correct</em> correct result is 7007.7626, or rounded to three digits, 7007.763.  So strictly speaking we shouldn't have thrown away that .600 we ended up with in <code>p_frx</code>, we should have rounded.</p>\n\n<p>There may also be some extra wrinkles to take care of when we consider the possibility of negative numbers.</p>\n\n<p>Finally, there's the choice of scaling factor.  In practice, the 0.001 I've used here isn't really a realistic value.  For a general-purpose algorithm you'd probably use something more like 1/10000, or 1/1000000000, or 1/32768, or 1/65536, or something like that.  (Using powers of two makes for larger ranges and typically more efficient calculations, but less-obvious fractional parts and less-efficient conversions to and from decimal representations.  For example, if you used a scaling factor of 1/32768, <code>a_frx</code> would be 13107, and <code>b_frx</code> would be 25853 or 25854.)</p>\n"}], "owner": {"reputation": 39, "user_id": 2105261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3eb151ff5e176bfade680ed3b0eb88d?s=128&d=identicon&r=PG", "display_name": "Vili", "link": "https://stackoverflow.com/users/2105261/vili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 58624704, "answer_count": 1, "score": 1, "last_activity_date": 1572448668, "creation_date": 1572427753, "last_edit_date": 1572428074, "question_id": 58622209, "link": "https://stackoverflow.com/questions/58622209/how-to-multiply-fixed-point-numbers-if-fixed-and-fractional-part-are-stored-sepa", "title": "How to multiply fixed-point numbers if fixed and fractional part are stored separately?", "body": "<p>I want to multiply two fixed-point numbers with different fractional length.\nFixed point part and fractional one are stored separately:</p>\n\n<pre><code>123    . 4\nfix    . frac\nsint32 . sint32\n</code></pre>\n\n<p>I use two variables, one for the fixed part and one for the fractional one.</p>\n\n<p>I tried to use the Karatsuba algorithm. But this one is working only with fixed length of fractional. The fractional part of the two numbers is varying. They could be the same, but there is any guarantee for this.\nOf course, the max possible value is (2^32) - 1.</p>\n\n<p>What is the best way to multiply 123.4 with 56.789?</p>\n\n<pre><code>// a = 123.4\nsigned int a_fxd = 123;\nsigned int a_frx = 4;\n// b = 56.789\nsigned int b_fxd = 56\nsigned int b_frc = 789;\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 5, "creation_date": 1572425877, "post_id": 58621640, "comment_id": 103551476, "body": "Does your compiler not issue a warning about uninitialized local variables?"}, {"owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1572425925, "post_id": 58621640, "comment_id": 103551504, "body": "@Blaze No, it doesn&#39;t. There is not warning."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1572426024, "post_id": 58621640, "comment_id": 103551555, "body": "What compiler are you using?"}, {"owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1572426128, "post_id": 58621640, "comment_id": 103551607, "body": "@Blaze clang. Sublime text and am compiling in terminal using clang"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1572426252, "post_id": 58621640, "comment_id": 103551675, "body": "Make sure to compile with the <code>-Wall</code> option."}, {"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 0, "creation_date": 1572426334, "post_id": 58621640, "comment_id": 103551735, "body": "initialize <code>int sum;</code> make it <code>int sum=0</code>."}, {"owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1572426379, "post_id": 58621640, "comment_id": 103551769, "body": "@Blaze I see sum was not initialized. thanks its working now. I ll remember to use that option from now"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1572426391, "post_id": 58621640, "comment_id": 103551773, "body": "Do you expect <code>55</code> or <code>45</code> as result?"}, {"owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1572426524, "post_id": 58621640, "comment_id": 103551851, "body": "@mch ya I fixed it. it should be &lt;= in for loop"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1572427277, "post_id": 58621640, "comment_id": 103552250, "body": "@Abhay: You&#39;d better use <code>&lt;</code> and pass <code>a + 10</code>, because it is idiomatic. In C, ranges are described by an inclusive lower bound <code>start</code> and an exclusive upper bound <code>end</code>, so that the length of the range is <code>end - start</code>. Forward loops look like this: <code>for (x = start; x &lt; end; x++)</code>, no matter whether <code>x</code> is a pointer or an index."}], "answers": [{"tags": [], "owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "is_accepted": false, "score": 2, "last_activity_date": 1572426883, "creation_date": 1572426883, "answer_id": 58621960, "question_id": 58621640, "link": "https://stackoverflow.com/questions/58621640/sum-of-array-using-pointers/58621960#58621960", "title": "Sum of array using pointers", "body": "<p>Replace:</p>\n\n<pre><code>int sum;\n</code></pre>\n\n<p>with</p>\n\n<pre><code>int sum = 0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12296457, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDv28n0-go-UpYkfN0GcugrwQ8CSraLNs6B0WDsxg=k-s128", "display_name": "Tarun", "link": "https://stackoverflow.com/users/12296457/tarun"}, "is_accepted": false, "score": -1, "last_activity_date": 1572429562, "creation_date": 1572429562, "answer_id": 58622765, "question_id": 58621640, "link": "https://stackoverflow.com/questions/58621640/sum-of-array-using-pointers/58622765#58622765", "title": "Sum of array using pointers", "body": "<p>Every statement is write \nJust initialise Sum to any number because a complier assinged a garbage value to Sum .</p>\n"}], "owner": {"reputation": 161, "user_id": 10160166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8fe9419b769d0c196053aa7c8cdf88?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay", "link": "https://stackoverflow.com/users/10160166/abhay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1572429562, "creation_date": 1572425818, "last_edit_date": 1572426490, "question_id": 58621640, "link": "https://stackoverflow.com/questions/58621640/sum-of-array-using-pointers", "title": "Sum of array using pointers", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n\nint arrsum(int *, int *);\n\nint main(void){\n    int a[]={1,2,3,4,5,6,7,8,9,10};\n\n\n    printf(\"\\nSum: %d\\n\", arrsum(a,a+9));\n    return 0;\n}\n\nint arrsum(int *p, int *q){\n    int sum;\n    for(;p&lt;=q;++p){\n        sum+=*p;\n    }\n    return sum;\n}\n</code></pre>\n\n<p>I want to print the sum of elements of array using pointers because I am learning pointers.\nWhen I run this code, I am getting 32811 as output which is wrong.\nPlease help.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 1, "creation_date": 1572426110, "post_id": 58621584, "comment_id": 103551596, "body": "you allocated memory pointed by <code>d</code> and then you freed that mem."}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1572426396, "post_id": 58621666, "comment_id": 103551777, "body": "... and <code>create_array(array, n);</code> should read <code>create_array(&amp;array, n);</code>"}], "tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 3, "last_activity_date": 1572425884, "creation_date": 1572425884, "answer_id": 58621666, "question_id": 58621584, "link": "https://stackoverflow.com/questions/58621584/allocation-of-memory-segmentation-error-in-c/58621666#58621666", "title": "Allocation of memory, segmentation error in C", "body": "<p>The problem is, in both code and snippet provided, the variable assigned by <code>malloc</code>'s return value lives until the function returns. So you need to use pointer-to-pointer. Moreover, in the first snippet, if you <code>free</code> the area allotted already, you can't use the space anymore.</p>\n\n<pre><code>void create_array(double **x, unsigned long n) {\n    *x = malloc(n *sizeof(double));\n    if(*x == NULL){\n        printf(\"Sorry Memory Not Available. Program Terminated.\\n\");\n        exit(1);\n    }\n}\n</code></pre>\n\n<p>In main, you can call it as <code>create_array(&amp;array, n);</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1572426329, "post_id": 58621736, "comment_id": 103551732, "body": "Why the need for <code>d</code> in <code>create_array</code>? Could just use <code>x</code>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1572426387, "post_id": 58621736, "comment_id": 103551771, "body": "@EdHeal There is no need. In that version I only corrected the most critical things. As you can see I wrote a better one below."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1572426627, "post_id": 58621736, "comment_id": 103551908, "body": "@EdHeal Besides, using an extra pointer like that can make the code easier to read by avoiding pointer to pointer. I don&#39;t see the harm of it."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 1, "last_activity_date": 1572426801, "last_edit_date": 1572426801, "creation_date": 1572426103, "answer_id": 58621736, "question_id": 58621584, "link": "https://stackoverflow.com/questions/58621584/allocation-of-memory-segmentation-error-in-c/58621736#58621736", "title": "Allocation of memory, segmentation error in C", "body": "<p>There are several errors in <code>create_array</code>. <code>x</code> is a local variable, so it will not change. Also, you <code>free</code> the memory after initialization, which in practice makes the whole function useless. Free should be done after you're done with the memory.</p>\n\n<p>Here is a corrected version</p>\n\n<pre><code>void create_array(double **x, unsigned long n) {\n    double *d = malloc((int)n *sizeof(double));\n\n    if(d == NULL){\n        printf(\"Sorry Memory Not Available. Program Terminated.\\n\");\n        exit(1);\n    }\n\n    *x=d;\n}\n</code></pre>\n\n<p>And then you call it like this:</p>\n\n<pre><code>double *p;\ncreate_array(&amp;p, size);\n/* Do something */\nfree(p);\n</code></pre>\n\n<p>But, IMHO it would be better to do like this:</p>\n\n<pre><code>double *create_array(size_t n) {\n    double *d = malloc(n*sizeof(*d));\n\n    if(d == NULL){\n        fprintf(stderr, \"Sorry Memory Not Available. Program Terminated.\\n\");\n        exit(1);\n    }\n\n    return d;\n}\n</code></pre>\n\n<p>Changes:</p>\n\n<ul>\n<li>Returns the pointer instead of using an output parameter</li>\n<li>Use <code>size_t</code> instead of <code>unsigned long</code></li>\n<li>Print errors to <code>stderr</code> insteadd of <code>stdio</code></li>\n<li>Use <code>malloc(size *sizeof(&lt;var&gt;))</code> instead of <code>malloc(size * sizeof(&lt;type&gt;))</code></li>\n</ul>\n\n<p>And here is the call:</p>\n\n<pre><code>double *p = create_array(&amp;p, size);\n/* Do something */\nfree(p);\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12192681, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IUYlUkHBFPs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerB-gFRxDa2850m4_hkWeKj0UUoQ/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/12192681/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58621736, "answer_count": 2, "score": 0, "last_activity_date": 1572438142, "creation_date": 1572425606, "last_edit_date": 1572438142, "question_id": 58621584, "link": "https://stackoverflow.com/questions/58621584/allocation-of-memory-segmentation-error-in-c", "title": "Allocation of memory, segmentation error in C", "body": "<p>I have this problem I need to solve. I am given a program which is supposed to allocate memory to create an array of doubles, but something is wrong with it. Basically, main and the function create_array are broken, and I need to fix it. The solution I came up with comes up with a segmentation error and i am not sure why. </p>\n\n<p>First off I decided to delete the \"free(array)\" in main b/c array is a pointer which does not exist in heap from my understanding.\nI tried changing the function \"create_array\" to the following</p>\n\n<pre><code>void create_array(double *x, unsigned long n) {\n\n   double *d = malloc((int)n *sizeof(double));\n\n    if(d == NULL){\n        printf(\"Sorry Memory Not Available. Program Terminated.\\n\");\n        exit(1);\n\n    }\n\n    x=d;\n    free(d);\n\n}\n</code></pre>\n\n<p>Here is what I was provided with:</p>\n\n<pre><code>int main(void) {\n    printf(\"\\nProgram started...\\n\");\n    double *array = NULL;\n    int n = 20;\n    create_array(array, n);\n\n    if( array != NULL) {\n        populate_array(array, n);\n\n        // displays half of the values of the array\n        for(int i = 0; i &lt; n/2; i++){\n            printf(\"%f\\n\", *array++);\n        }\n\n        // According to C standard, the program's behaviour, after the following\n        // call to the function free is considered \"Undefined\" and needs to be\n        // fixed.\n        free(array);\n    }\n\n    printf(\"Program terminated...\\n\");\n    return 0;\n}\n\n// THE FOLLOWING FUNCTION IS NOT PROPERLY DESINGED AND NEEDS TO BE FIXED\nvoid create_array(double *x, unsigned long n) {\n    x = malloc(n *sizeof(double));\n    if(x == NULL){\n        printf(\"Sorry Memory Not Available. Program Terminated.\\n\");\n        exit(1);\n    }\n}\n\nvoid populate_array(double *array, int n) {\n    int i;\n    for(i = 0; i &lt; n; i++)\n        array[i] = (i + 1) * 100;\n}\n</code></pre>\n\n<p>When I run the code with my edit, i get segmentation error. When I run the code with no changes, it simply outputs \"program started \\n program terminated\".</p>\n"}, {"tags": ["c", "networking", "network-programming", "arp"], "answers": [{"tags": [], "owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "is_accepted": true, "score": 1, "last_activity_date": 1572438214, "last_edit_date": 1572438214, "creation_date": 1572436967, "answer_id": 58624968, "question_id": 58621469, "link": "https://stackoverflow.com/questions/58621469/arp-response-over-router/58624968#58624968", "title": "ARP Response over router", "body": "<p>ARP requests are for IPv4 only, and use broadcast (IPv6 does not have broadcast, and it uses NDP, not ARP), but routers do not forward broadcasts to a different network.</p>\n\n<p>A source host will mask the destination address with its configured mask to determine if the destination address is on the same network. If the destination is on the same network, it will use ARP (either in the ARP table, or send a new ARP request) to determine the destination host data-link address and use that to build the data-link frame. If the destination is on a different network, the source host will use ARP (either in the ARP table, or send a new ARP request) to determine the data-link address of its configured gateway, and it will use the gateway data-link address to build the data-link frame.</p>\n\n<p>You are trying to use an ARP request for a host on a different network, and that will not work. Trying to send an ARP request for a destination on a different network will get no response, and you are seeing that (you need to implement a timeout for your ARP requests, and send an error message up the network stack to the requesting process when it times out).</p>\n\n<p>The IPv6 traffic you see is normal IPv6 maintenance traffic that periodically happens on a LAN where IPv6 is configured.</p>\n"}], "owner": {"reputation": 95, "user_id": 8842080, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/82e4cca95746d6d6962c98b33e71e0ce?s=128&d=identicon&r=PG&f=1", "display_name": "TrashMachine139", "link": "https://stackoverflow.com/users/8842080/trashmachine139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 58624968, "answer_count": 1, "score": 0, "last_activity_date": 1572438214, "creation_date": 1572425135, "question_id": 58621469, "link": "https://stackoverflow.com/questions/58621469/arp-response-over-router", "title": "ARP Response over router", "body": "<p>I am pretty new to networking and I have been trying to understand ARP requests. I've been using mininet and wireshark in order to test what I'm doing.</p>\n\n<p>When I use mininet to generate 2 hosts (h1 and h2) and a switch, my ARP broadcast is immediately responded with an ARP reply, everything works correctly. </p>\n\n<p>When I use a given router.py script that generates the following on mininet -</p>\n\n<pre><code>*** Creating network\n*** Adding controller\n*** Adding hosts:\nh1x1 h1x2 h2x1 h2x2 h3x1 h3x2 r0 \n*** Adding switches:\ns1 s2 s3 \n*** Adding links:\n(h1x1, s1) (h1x2, s1) (h2x1, s2) (h2x2, s2) (h3x1, s3) (h3x2, s3) (s1, r0) (s2, r0) (s3, r0) \n*** Configuring hosts\nh1x1 h1x2 h2x1 h2x2 h3x1 h3x2 r0 \n*** Starting controller\nc0 \n*** Starting 3 switches\ns1 s2 s3 ...\n*** Routing Table on Router:\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n10.0.0.0        0.0.0.0         255.0.0.0       U     0      0        0 r0-eth3\n172.16.0.0      0.0.0.0         255.240.0.0     U     0      0        0 r0-eth2\n192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 r0-eth1\n</code></pre>\n\n<pre><code>// ./a.out Send &lt;InterfaceName&gt;  &lt;DestIP&gt; &lt;RouterIP&gt; &lt;Message&gt;\nmininet&gt; h1x1 ./a.out Send h1x1-eth0 10.0.0.1 192.168.1.100 'This is a test'\n</code></pre>\n\n<p>This is how I run my command on mininet to run the ARP request. </p>\n\n<p>When I try to run the ARP request using destination IP 10.0.0.1 and the router IP 192.168.1.00 my ARP request broadcasts normally, but I do not get the ARP reply, instead I get a series of ICMPv6 responses. </p>\n\n<p><a href=\"https://i.stack.imgur.com/29llM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/29llM.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Here is how I am creating my ARP header</p>\n\n<pre><code>struct arp_hdr construstArpRequest(char if_name[], int sockfd, struct in_addr dst, struct ifreq if_hwaddr) {\n    printf(\"Constructing ARP request --\\n\");\n    struct arp_hdr arphdr;\n    arphdr.ar_hrd = htons(0x0001);\n    arphdr.ar_pro = htons(0x0800);\n    arphdr.ar_hln = 6;\n    arphdr.ar_pln = 4;\n    arphdr.ar_op = htons(0x0001);\n\n    unsigned long sip = get_ip_saddr(if_name, sockfd); // source IP\n    memcpy(arphdr.ar_sip, &amp;sip, 4); // source IP\n    memcpy(arphdr.ar_tip, &amp;dst.s_addr, 4); // taget IP\n    memset(arphdr.ar_tha, 0, 6); // taget HA\n    memcpy(arphdr.ar_sha, if_hwaddr.ifr_hwaddr.sa_data, 6); // source HA\n\n    return arphdr;\n}\n</code></pre>\n\n<p>And I create my ARP request </p>\n\n<pre><code>        int sockfd = -1;\n        if((sockfd = socket(AF_PACKET, SOCK_RAW, htons(ETH_P_ALL))) &lt; 0){\n            perror(\"socket() failed!\");\n        }\n\n        // connect to an internet frame\n        struct ifreq if_hwaddr;\n        memset(&amp;if_hwaddr, 0, sizeof(struct ifreq));\n        strncpy(if_hwaddr.ifr_name, interfaceName, IFNAMSIZ-1);\n        if(ioctl(sockfd, SIOCGIFHWADDR, &amp;if_hwaddr) &lt; 0){\n            perror(\"SIOCGIFHWADDR\");\n        }\n\n        struct arp_hdr arpRequest;\n        arpRequest = construstArpRequest(interfaceName, sockfd, router_ip, if_hwaddr);\n</code></pre>\n\n<p>If I need to include code about how I am actually sending the request, I can but not sure if it  is necessary code. Throughout my research I have come across some answers saying that you will not get the broadcast response because you are running it over a network, it that's the case, how do you get the target MAC address? </p>\n"}, {"tags": ["python", "c", "sockets", "winapi"], "comments": [{"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 1, "creation_date": 1572423226, "post_id": 58620932, "comment_id": 103550311, "body": "<i>&quot;client: C/C++&quot;</i>... There is no such language called C/C++. C and C++ are completely different languages. So choose one and don&#39;t spam language tags as much as possible."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1572423240, "post_id": 58620932, "comment_id": 103550318, "body": "Are there the Ascii values of <code>&quot;Done&quot;</code> somewhere in the file?"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1572423731, "post_id": 58620932, "comment_id": 103550531, "body": "You need to open your file in binary mode"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1572423836, "post_id": 58620932, "comment_id": 103550574, "body": "You have to check the return code of <code>send()</code>. A value &gt;0 is the number of bytes passed to the send buffer, which can be less than what you want to send. (In non-blocking mode even 0 is possible.) You would have to increase the buffer pointer and to decrease the number of bytes to send accordingly and retry until you reach the end of the buffer. On error a value &lt;0 (-1) is returned. Similar with <code>fread</code>: You have the number of items (bytes) in <code>readedChar</code>, which may be less than 1024, but you always try to send <code>sizeof(buffer)</code>, so you may send undefined/old data from <code>buffer</code>."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1572423845, "post_id": 58620932, "comment_id": 103550580, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7182957/read-syscall-on-windows-fails-to-read-binary-file\">read() syscall on windows fails to read binary file</a>"}, {"owner": {"reputation": 33, "user_id": 10235591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bhUafr1ROys/AAAAAAAAAAI/AAAAAAAAAVE/7G6HoCSy_08/photo.jpg?sz=128", "display_name": "Brian MJ", "link": "https://stackoverflow.com/users/10235591/brian-mj"}, "reply_to_user": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1572424308, "post_id": 58620932, "comment_id": 103550777, "body": "@Fareanor im sorry. i still new to it."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1572424492, "post_id": 58620932, "comment_id": 103550862, "body": "Unrelated, but <code>char buffer[1024] = { NULL };</code> is an anti-idiom. NULL is intended to represent a pointer, not a character. You should write <code>char buffer[1024] = { &#39;\\0&#39; };</code> to explicitely use a <code>char</code> or <code>char buffer[1024] = { 0};</code> to have an int implicitely converted to a char."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1572424795, "post_id": 58620932, "comment_id": 103550994, "body": "@BrianMJ You don&#39;t have to be sorry, that was just an advice, we&#39;re all here to improve, there&#39;s no problem at all :)"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1572427701, "post_id": 58620932, "comment_id": 103552497, "body": "You should add a description of the transfer protocol to the question. When do you open and close the connection? Do you transfer any other data/commands/replies before or after the file contents? (Apart from <code>&quot;Done&quot;</code>) Do you want to transfer multiple files in a single connection? When transferring both commands and data over the same data stream, error handling may be difficult, and communication can get out of sync. In your example the Python code may not receive the string <code>&quot;Done&quot;</code> in a single block. It may as well be <code>&quot;Do&quot;</code> at the end of one block and <code>&quot;ne&quot;</code> at the start of the next block."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 4, "last_activity_date": 1572425047, "last_edit_date": 1572425047, "creation_date": 1572423602, "answer_id": 58621106, "question_id": 58620932, "link": "https://stackoverflow.com/questions/58620932/transfer-a-big-file-though-socket/58621106#58621106", "title": "Transfer a big file though socket", "body": "<p><code>Done</code> is no more than an arbitrary sequence of 4 bytes. If it is present in the tranfered file, it will stop the transfer. For binary files, the common way is to first send the size and then the file, or to send blocks with a well known structure (for example starting with the block size) and an empty block indicating the end of the file.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10235591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bhUafr1ROys/AAAAAAAAAAI/AAAAAAAAAVE/7G6HoCSy_08/photo.jpg?sz=128", "display_name": "Brian MJ", "link": "https://stackoverflow.com/users/10235591/brian-mj"}, "edited": false, "score": 0, "creation_date": 1572503222, "post_id": 58621951, "comment_id": 103581956, "body": "Thanks a lot for your comment, it help me alot to understand what i should doing when send and recv."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1572428059, "last_edit_date": 1572428059, "creation_date": 1572426864, "answer_id": 58621951, "question_id": 58620932, "link": "https://stackoverflow.com/questions/58620932/transfer-a-big-file-though-socket/58621951#58621951", "title": "Transfer a big file though socket", "body": "<p>Your sending code has many logic errors:</p>\n\n<ul>\n<li><p>lack of adequate error handling.</p></li>\n<li><p>passing the wrong buffer size to <code>send()</code> (hint, it won't be 1024 for the last buffer if the file size is not an even multiple of 1024).</p></li>\n<li><p>assuming <code>send()</code> sends the entire buffer in one go (hint, it rarely does). You need to call <code>send()</code> in a loop until the entire buffer has been sent.</p></li>\n<li><p>misinterpreting the return value of <code>send()</code> (hint, it doesn't return a boolean). It returns the actual number of bytes sent (well, the number of bytes accepted into the socket's internal buffer for transmission in the background).</p></li>\n<li><p>adding the wrong value to <code>total</code> after each <code>send()</code>, since you are assuming <code>send()</code> the entire buffer in one go.</p></li>\n<li><p>sending a delimiter string at the end of the file, without regard to whether such delimiter may have appeared in the file being sent. It would be safer to instead send the file's size before sending the file's bytes.</p></li>\n<li><p>specifying the wrong buffer size when sending the delimiter string (hint, <code>\"Done\"</code> is not 1024 bytes in size).</p></li>\n<li><p>leaking the <code>filewrite</code> handle. You are not calling <code>fclose()</code> for it.</p></li>\n</ul>\n\n<p>With that said, try something more like this instead:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>BOOL SendRaw(const void *buffer, int size) {\n    const char *ptr = (const char*)buffer;\n    int numSent;\n    while (size &gt; 0) {\n        numSent = send(s, ptr, size, 0);\n        if (numSent == -1)\n            return FALSE;\n        ptr += numSent;\n        size -= numSent;\n    }\n    return TRUE;\n}\n\nBOOL SendFile(const wchar_t* file) {\n    FILE* filewrite = fopen(\"test.txt\", \"a\");\n    if (!filewrite)\n        return FALSE;\n\n    FILE* fp = _wfopen(file, L\"rb\");\n    if (!fp) {\n        fclose(filewrite);\n        return FALSE;\n    }\n\n    if (fseek(fp,\u00a00,\u00a0SEEK_END) != 0) {\n        fclose(fp);\n        fclose(filewrite);\n        return FALSE;\n    }\n\n    long\u00a0size = ftell(fp);\n    if (size == -1L) {\n        fclose(fp);\n        fclose(filewrite);\n        return FALSE;\n    }\n\n    rewind(fp);\n\n    uint32_t tmp = htonl(size);\n    if (!SendRaw(&amp;tmp, sizeof(tmp))) {\n        fclose(fp);\n        fclose(filewrite);\n        return FALSE;\n    }\n\n    unsigned char buffer[1024];\n    int numBytes, numSent, total = 0;\n\n    while (size &gt; 0) {\n        numBytes = fread(buffer, 1, min(sizeof(buffer), size), fp);\n        if (numBytes &lt; 1) {\n            fclose(fp);\n            fclose(filewrite);\n            return FALSE;\n        }\n        if (!SendRaw(buffer, numBytes)) {\n            fclose(fp);\n            fclose(filewrite);\n            return FALSE;\n        }\n        size -= numBytes;\n        total += numBytes;\n        fprintf(filewrite, \"%d\\n\", total);\n    }\n\n    fclose(fp);\n    fclose(filewrite);\n    return TRUE;\n}\n</code></pre>\n\n<pre class=\"lang-py prettyprint-override\"><code>import struct\n\ndef recv_file_from_client(conn):\n    f = open(\"torecv\",\"wb\")\n    data = conn.recv(4)\n    if not data:\n        print \"Error recv\"\n        return\n    size = struct.unpack(\"!I\", data)[0]\n    while(size &gt; 0):\n        data = conn.recv(min(1024, size))\n        if not data:\n            print \"Error recv\"\n            return\n        f.write(data)\n        size -= len(data)\n    f.close()\n    print \"Done recv\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10235591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bhUafr1ROys/AAAAAAAAAAI/AAAAAAAAAVE/7G6HoCSy_08/photo.jpg?sz=128", "display_name": "Brian MJ", "link": "https://stackoverflow.com/users/10235591/brian-mj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 58621951, "answer_count": 2, "score": 3, "last_activity_date": 1572428059, "creation_date": 1572422880, "last_edit_date": 1572424184, "question_id": 58620932, "link": "https://stackoverflow.com/questions/58620932/transfer-a-big-file-though-socket", "title": "Transfer a big file though socket", "body": "<p>I practice in socket programming, I wrote a code (server: python, client: C/C++) to transfer data though socket. With small file, it works perfectly. Then I try with bigger file, it only transfers part of that file. Here is my code:</p>\n\n<p><strong>Server</strong></p>\n\n<pre><code>def recv_file_from_client(conn):\n    f = open(\"torecv\",\"wb\")\n    while(True):\n        l = conn.recv(1024)\n        if \"Done\" in l:\n            break\n        f.write(l)\n    f.close()\n    print \"Done recv\"\n</code></pre>\n\n<p><strong>Client</strong></p>\n\n<pre><code>BOOL SendFile(TCHAR* file) {\n    FILE* filewrite = fopen(\"test.txt\", \"a\");\n    FILE* fp = _wfopen(file, L\"rb\");\n    unsigned char buffer[1024] = { NULL };\n    int readedChar;\n    int total = 0;\n    char log[128] = { NULL };\n    while ((readedChar = fread(buffer, 1, 1024, fp)) &gt; 0) {\n        if (send(s, (const char*)buffer, sizeof(buffer), 0)) {\n            total += readedChar;\n            sprintf(log, \"%d\\n\", total);\n            fputs(log,filewrite);\n        }\n        memset(buffer, 0, 1024);\n    }\n    send(s, \"Done\", 1024, 0);\n    fclose(fp);\n    return TRUE;\n}\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/fG9Um.png\" alt=\"Result\"></p>\n"}, {"tags": ["c", "macos", "sockets"], "comments": [{"owner": {"reputation": 848, "user_id": 9815377, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_ix-HrP8dks/AAAAAAAAAAI/AAAAAAAAAGQ/EsjH8FtkC2k/photo.jpg?sz=128", "display_name": "sephiroth", "link": "https://stackoverflow.com/users/9815377/sephiroth"}, "edited": false, "score": 0, "creation_date": 1572422045, "post_id": 58620608, "comment_id": 103549823, "body": "How do you know they return successfully?"}, {"owner": {"reputation": 1, "user_id": 12199491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XdynxKck5eg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reCMRY9OHKXVgzRda4e667gzeGfeQ/photo.jpg?sz=128", "display_name": "kadd xu", "link": "https://stackoverflow.com/users/12199491/kadd-xu"}, "reply_to_user": {"reputation": 848, "user_id": 9815377, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_ix-HrP8dks/AAAAAAAAAAI/AAAAAAAAAGQ/EsjH8FtkC2k/photo.jpg?sz=128", "display_name": "sephiroth", "link": "https://stackoverflow.com/users/9815377/sephiroth"}, "edited": false, "score": 0, "creation_date": 1572423395, "post_id": 58620608, "comment_id": 103550383, "body": "the return value of &#39;sendto&#39; is 1000"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1572427051, "post_id": 58620608, "comment_id": 103552134, "body": "Just an idea for better analysis: Put an index in every packet and look at the receiving end which ones are missing."}, {"owner": {"reputation": 1, "user_id": 12199491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XdynxKck5eg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reCMRY9OHKXVgzRda4e667gzeGfeQ/photo.jpg?sz=128", "display_name": "kadd xu", "link": "https://stackoverflow.com/users/12199491/kadd-xu"}, "edited": false, "score": 0, "creation_date": 1572428177, "post_id": 58620608, "comment_id": 103552729, "body": "I indexed every packet.  The first packet loss happened at No.882, the next packet captured by wireshark is No.1198. This situation happened every few hundred packets. I guess the kernel&#39;s buffer may be the reason, but I&#39;m not sure\u3002"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1572430142, "post_id": 58620608, "comment_id": 103553864, "body": "What do you think UDP is supposed to do?"}, {"owner": {"reputation": 1, "user_id": 12199491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XdynxKck5eg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reCMRY9OHKXVgzRda4e667gzeGfeQ/photo.jpg?sz=128", "display_name": "kadd xu", "link": "https://stackoverflow.com/users/12199491/kadd-xu"}, "edited": false, "score": 0, "creation_date": 1572430918, "post_id": 58620608, "comment_id": 103554293, "body": "I capture the packet on my local macbook using wireshark, the same problem occurred when I use libpcap to send raw link frame. The problem is those packets were NOT actually sent by the kernel, which has nothing to do with the network. And this problem only appears on macOS"}, {"owner": {"reputation": 18474, "user_id": 53328, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5146a847dccfbe3a906e327b8493f58d?s=128&d=identicon&r=PG", "display_name": "Martin Wickman", "link": "https://stackoverflow.com/users/53328/martin-wickman"}, "edited": false, "score": 0, "creation_date": 1572433222, "post_id": 58620608, "comment_id": 103555521, "body": "Is it possible that you fill up some kind of buffer in the OS network stack which simply discards the packages rather than blocking until sent? I mean, udp is fire-and-forget, after all?"}], "owner": {"reputation": 1, "user_id": 12199491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XdynxKck5eg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reCMRY9OHKXVgzRda4e667gzeGfeQ/photo.jpg?sz=128", "display_name": "kadd xu", "link": "https://stackoverflow.com/users/12199491/kadd-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572431867, "creation_date": 1572421462, "last_edit_date": 1572431867, "question_id": 58620608, "link": "https://stackoverflow.com/questions/58620608/packet-loss-when-sending-too-fast-on-macos", "title": "Packet loss when sending too fast on macos", "body": "<p>environment: macbook pro, macOS Mojave 10.14.6</p>\n\n<p>I was testing the throughput of injecting packets into wireless network.</p>\n\n<p>The problem is, when I send udp packets to my router for 100K times in a loop, only about 16K are actually injected into the network, but all 100K calls to 'sendto' return successfully.</p>\n\n<pre><code>char dbuf[1100] = \"\\0\";\nint sockfd = socket(AF_INET, SOCK_DGRAM, 0);\nuint32_t ip_binary_net = inet_addr(\"192.168.0.1\");\nstruct sockaddr_in sa;\nsa.sin_family = AF_INET;\nsa.sin_port = htons(5577);\nsa.sin_addr.s_addr = ip_binary_net;\n\nfor(int i = 0; i &lt; 100000; i++){\n    int send_num = sendto(sockfd, dbuf, 1000, 0, (struct sockaddr *)&amp;sa, sizeof(sa));\n    if(send_num != 1000)\n        printf(\"send_num err!\\n\");\n}\n</code></pre>\n\n<p>My program shows the throughput is 2G Mbps, which is absolutely impossible.</p>\n\n<p>I checked the Network Utility, wireshark on my macbook and the router. Cleary only small part of those packets were actually injected into the network.</p>\n\n<p>I met the same problem using libpcap.\nBut this problem did not happen on my windows machine.\nIs this some feature of the macOS kernel?</p>\n"}, {"tags": ["c", "compiler-errors", "kernel"], "comments": [{"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 0, "creation_date": 1572422864, "post_id": 58620575, "comment_id": 103550173, "body": "how many cores do you have?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1572424359, "post_id": 58620575, "comment_id": 103550796, "body": "The line <code>extern bool state_suspended;</code> only <b>declares</b> the variable. But the error message is about not <b>defined</b> variable."}, {"owner": {"reputation": 1, "user_id": 12295707, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ItxxCO-TS88/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYJYcZHOWZ5oYWFQtPVwaVV2IUog/photo.jpg?sz=128", "display_name": "ehjwbeh yshwbhe", "link": "https://stackoverflow.com/users/12295707/ehjwbeh-yshwbhe"}, "edited": false, "score": 0, "creation_date": 1572424483, "post_id": 58620575, "comment_id": 103550856, "body": "I see Tsyvarev, but then how do i know what to ddefine it as"}], "owner": {"reputation": 1, "user_id": 12295707, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ItxxCO-TS88/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYJYcZHOWZ5oYWFQtPVwaVV2IUog/photo.jpg?sz=128", "display_name": "ehjwbeh yshwbhe", "link": "https://stackoverflow.com/users/12295707/ehjwbeh-yshwbhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572421291, "creation_date": 1572421291, "question_id": 58620575, "link": "https://stackoverflow.com/questions/58620575/getting-undefined-reference-errors-when-trying-to-compile-android-kernel", "title": "Getting undefined reference errors when trying to compile android kernel", "body": "<p>Im trying to compile an android kernel, but shortly after running make -j4 it spits out an error.</p>\n\n<pre><code>drivers/built-in.o: In function `cs_check_cpu':\n/home/jack/Downloads/NethunterKernel/drivers/cpufreq/cpufreq_relaxed.c:67: undefined reference to `state_suspended'\n/home/jack/Downloads/GCCToolchain/bin/aarch64-linux-android-ld: drivers/built-in.o: relocation R_AARCH64_ADR_PREL_PG_HI21 against external symbol `state_suspended' can not be used when making a shared object; recompile with -fPIC\n/home/jack/Downloads/NethunterKernel/drivers/cpufreq/cpufreq_relaxed.c:67: undefined reference to `state_suspended'\nblock/built-in.o: In function `maple_add_request':\n/home/jack/Downloads/NethunterKernel/block/maple-iosched.c:81: undefined reference to `state_suspended'\n/home/jack/Downloads/GCCToolchain/bin/aarch64-linux-android-ld: block/built-in.o: relocation R_AARCH64_ADR_PREL_PG_HI21 against external symbol `state_suspended' can not be used when making a shared object; recompile with -fPIC\n/home/jack/Downloads/NethunterKernel/block/maple-iosched.c:81: undefined reference to `state_suspended'\nblock/built-in.o: In function `maple_dispatch_requests':\n/home/jack/Downloads/NethunterKernel/block/maple-iosched.c:209: undefined reference to `state_suspended'\n/home/jack/Downloads/GCCToolchain/bin/aarch64-linux-android-ld: block/built-in.o: relocation R_AARCH64_ADR_PREL_PG_HI21 against external symbol `state_suspended' can not be used when making a shared object; recompile with -fPIC\nblock/built-in.o:/home/jack/Downloads/NethunterKernel/block/maple-iosched.c:209: more undefined references to `state_suspended' follow\nmake: *** [Makefile:995: vmlinux] Error 1\n</code></pre>\n\n<p>Im pretty sure state_suspended is declared in include/linux/state_notifier.h with </p>\n\n<blockquote>\n  <p>extern bool state_suspended;</p>\n</blockquote>\n\n<p>state_notifier.h is included in all the files it complains about though. Could anyone help?</p>\n\n<p>This is the kernel im trying to compile: <a href=\"https://github.com/Svirusx/Nethunter-s7-kernel-WirusMOD-AiO\" rel=\"nofollow noreferrer\">https://github.com/Svirusx/Nethunter-s7-kernel-WirusMOD-AiO</a></p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 0, "last_activity_date": 1572420713, "creation_date": 1572420713, "answer_id": 58620454, "question_id": 58620337, "link": "https://stackoverflow.com/questions/58620337/add-zero-padding-to-string-in-c/58620454#58620454", "title": "Add zero padding to string in c?", "body": "<p>You need to use <code>sprintf</code></p>\n\n<pre><code>sprintf(file_frame, \"%04d\", 34);\n</code></pre>\n\n<p>The <code>0</code> indicates what you are padding with and the <code>4</code> shows the length of the integer number.</p>\n\n<hr>\n\n<p>Also you should be using mutable array as below.</p>\n\n<pre><code>char *file_frame = \"shots\"; --&gt; char file_frame[100] = \"shots\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 1, "last_activity_date": 1572426774, "last_edit_date": 1572426774, "creation_date": 1572425868, "answer_id": 58621656, "question_id": 58620337, "link": "https://stackoverflow.com/questions/58620337/add-zero-padding-to-string-in-c/58621656#58621656", "title": "Add zero padding to string in c?", "body": "<p>First you need some space to store the string. Then you \"print\" into this string:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char file_name[8 + 1]; // \"shots###\" is 8 characters, plus 1 for end-of-string marker '\\0'\n    int number = 23;\n    sprintf(file_name, \"shots%03d\", number);\n\n    printf(\"\\\"%s\\\"\\n\", file_name);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>You can combine literal parts with formatting parts in any <code>*printf()</code> function.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11399849"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 58620454, "answer_count": 2, "score": 0, "last_activity_date": 1572426774, "creation_date": 1572420189, "last_edit_date": 1572426555, "question_id": 58620337, "link": "https://stackoverflow.com/questions/58620337/add-zero-padding-to-string-in-c", "title": "Add zero padding to string in c?", "body": "<p>The concept is very similar to this <a href=\"https://stackoverflow.com/questions/3122677/add-zero-padding-to-a-string\">Add zero-padding to a string</a> but it's a question from c# NOT C.</p>\n\n<p>While you can add a zero padding in printf like this <code>printf(\"%4d\", number)</code></p>\n\n<p>How can I have a zero padding to a string? ex:</p>\n\n<pre><code>char *file_frame = \"shots\";\nstrcat(file_frame, \"%3d\", number); // It's my attempt to solve it. I know it's wrong\n</code></pre>\n\n<p>so that I would get <code>shots000</code> from <code>file_frame</code></p>\n"}, {"tags": ["c", "pointers", "char", "malloc"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1572419917, "post_id": 58620242, "comment_id": 103549037, "body": "You need <code>strlen</code> to determine the length of a string."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 4, "creation_date": 1572419938, "post_id": 58620242, "comment_id": 103549046, "body": "Please enable all warnings in your compiler. You should get some hints about type mismatch. Reading an integer via <code>gets</code> does not work. (and you shouldn&#39;t use <code>gets</code> anyway)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1572419979, "post_id": 58620242, "comment_id": 103549058, "body": "Oh, and <code>gets</code> has been deprecated 20 years ago, don&#39;t use it anymore, use <code>fgets</code>."}, {"owner": {"reputation": 92, "user_id": 4108566, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SKPOs.jpg?s=128&g=1", "display_name": "VMi", "link": "https://stackoverflow.com/users/4108566/vmi"}, "edited": false, "score": 0, "creation_date": 1572420055, "post_id": 58620242, "comment_id": 103549084, "body": "ok will use scanf. But please explain the output."}], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 4108566, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SKPOs.jpg?s=128&g=1", "display_name": "VMi", "link": "https://stackoverflow.com/users/4108566/vmi"}, "edited": false, "score": 0, "creation_date": 1572421654, "post_id": 58620518, "comment_id": 103549673, "body": "Can you also explain why sizeof(*text) is giving one byte while sizeof(++text) is again 4 bytes? (My compiler takes 4 bytes for char pointer)"}, {"owner": {"reputation": 448, "user_id": 5197136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/00nOW.jpg?s=128&g=1", "display_name": "Mostafa", "link": "https://stackoverflow.com/users/5197136/mostafa"}, "reply_to_user": {"reputation": 92, "user_id": 4108566, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SKPOs.jpg?s=128&g=1", "display_name": "VMi", "link": "https://stackoverflow.com/users/4108566/vmi"}, "edited": false, "score": 1, "creation_date": 1572421950, "post_id": 58620518, "comment_id": 103549787, "body": "text is a char*, in your machine pointer is 4 bytes(32 bits) so any pointer will have sizeof 4.  text++ is the next address(of char) after text, so it is a pointer also and will have size of 4. while *text is a char (that has address text) and the char size is 1 byte."}], "tags": [], "owner": {"reputation": 448, "user_id": 5197136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/00nOW.jpg?s=128&g=1", "display_name": "Mostafa", "link": "https://stackoverflow.com/users/5197136/mostafa"}, "is_accepted": false, "score": 5, "last_activity_date": 1584396600, "last_edit_date": 1584396600, "creation_date": 1572421021, "answer_id": 58620518, "question_id": 58620242, "link": "https://stackoverflow.com/questions/58620242/why-char-pointer-saving-data-more-than-allocated-memory-in-c/58620518#58620518", "title": "Why char pointer saving data more than allocated memory in C?", "body": "<p>It works because malloc usually doesn't allocate the same number of bytes you pass to it. \nIt reserves memory multiple of \"blocks\". It usually reserve more memory to \"cache\" it for next malloc calls as an optimization. (it is an implementation specific)\ncheck  <a href=\"https://sourceware.org/glibc/wiki/MallocInternals\" rel=\"nofollow noreferrer\">glibc malloc internals</a> for example.</p>\n\n<p>Using more memory than allocated by malloc is an undefined behavior. you may overwrite metadata of malloc saved on heap or corrupt other data.</p>\n\n<blockquote>\n  <p>Also I have tried to find sizes of pointer before and after input. How\n  can I understand what is happening here? The output is confusing me.</p>\n</blockquote>\n\n<p>The size of pointer is fixed for all pointer types in a machine, it is usually 4/8 bytes depending on the address size. It doesn't have anything to do with data size.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1572421895, "creation_date": 1572421895, "answer_id": 58620728, "question_id": 58620242, "link": "https://stackoverflow.com/questions/58620242/why-char-pointer-saving-data-more-than-allocated-memory-in-c/58620728#58620728", "title": "Why char pointer saving data more than allocated memory in C?", "body": "<p>Welcome to the world of Undefined Behaviour!</p>\n\n<p><code>char *text = malloc(limit*4);</code> (<a href=\"https://stackoverflow.com/a/605858/3545273\">don't cast malloc in C</a>) will make <code>text</code> point the the first element of an array of size <code>limit*4</code>.</p>\n\n<p>C will not prevent you to write past the end of any array, simply the behaviour is undefined by the standard. It may work fine, or it may crash immediately, or you may experience abnormal behaviour later in the program.</p>\n\n<p>Here, the underlying system call has probably allocated a full memory page (often 4k), and as you have not used another <code>malloc</code> you have just used a memory belonging to the process but still <em>officially</em> unused. But do not rely on that and <strong>never</strong> use it in production code.</p>\n\n<p>And <code>sizeof</code> does not make sense with pointers. <code>sizeof(text)</code> is <code>sizeof(char *)</code> (same for <code>sizeof(++text)</code> for same reason) and is the size of a pointer (generaly 2, 4 or 8 bytes) and <code>sizeof(*text)</code> is <code>sizeof(char)</code> which by definition is 1.</p>\n\n<p>C is confident that <strong>you</strong> as the programmer know how much memory you have asked, and will not try to use more. <strong>Anything</strong> can happen if you do (including expected result) but do not blame the language or the compiler if it breaks: only you will be guilty.</p>\n"}], "owner": {"reputation": 92, "user_id": 4108566, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SKPOs.jpg?s=128&g=1", "display_name": "VMi", "link": "https://stackoverflow.com/users/4108566/vmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1584396600, "creation_date": 1572419773, "last_edit_date": 1584396503, "question_id": 58620242, "link": "https://stackoverflow.com/questions/58620242/why-char-pointer-saving-data-more-than-allocated-memory-in-c", "title": "Why char pointer saving data more than allocated memory in C?", "body": "<p>While working on dynamic memory allocation in C, I am getting confused when allocating size of memory to a char pointer. While I am only giving 1 byte as limit, <strong>the char pointer successfully takes input as long as possible,</strong> given that each letter corresponds to 1 byte.</p>\n\n<p>Also I have tried to find sizes of pointer before and after input. How can I understand what is happening here? The output is confusing me.</p>\n\n<p>Look at this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int limit;\n\n    printf(\"Please enter the limit of your string - \");\n    gets(&amp;limit);\n\n    char *text = (char*) malloc(limit*4);\n\n    printf(\"\\n\\nThe size of text before input is %d bytes\",sizeof(text));\n\n    printf(\"\\n\\nPlease input your string - \");\n    scanf(\"%[^\\n]s\",text);\n\n    printf(\"\\n\\nYour string is %s\",text);\n\n    printf(\"\\n\\nThe size of char pointer text after input is %d bytes\",sizeof(text));\n\n    printf(\"\\n\\nThe size of text value after input is %d bytes\",sizeof(*text));\n\n    printf(\"\\n\\nThe size of ++text value after input is %d bytes\",sizeof(++text));\n\n    free(text);\n\n\n\n    return 0;\n\n\n}\n</code></pre>\n\n<p>Check this output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WSHZI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WSHZI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "edited": false, "score": 1, "creation_date": 1572417339, "post_id": 58619732, "comment_id": 103548184, "body": "The &#39;address&#39; never manages a memory size, It just points to one single address in memory. What is there depends on (a) the type the pointer is pointing at and (b) you, what you put there in case of malloc. The increment always refers to the type the pointer is of,"}, {"owner": {"reputation": 1, "user_id": 12295362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b4e7244bacd44da871efd3d8d30ca?s=128&d=identicon&r=PG&f=1", "display_name": "onnelim7791", "link": "https://stackoverflow.com/users/12295362/onnelim7791"}, "reply_to_user": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "edited": false, "score": 0, "creation_date": 1572417497, "post_id": 58619732, "comment_id": 103548225, "body": "Then, how can i write down the type for x1++ will be the same expression as &amp;A++? It means how can i edit the increment."}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1572418694, "post_id": 58619732, "comment_id": 103548597, "body": "Note you&#39;re casting all pointers to the same <code>int*</code>..."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 2, "creation_date": 1572418767, "post_id": 58619732, "comment_id": 103548631, "body": "@JHBonarius: There are no casts in the code. Casts are explicit operators. There are implicit conversions."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1572418944, "post_id": 58619732, "comment_id": 103548701, "body": "Turn on warnings in your compiler and pay attention to them. The initializations of <code>x1</code> and <code>x2</code> violate rules in the C standard, and the compiler is required to diagnose those violations."}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1572419158, "post_id": 58619732, "comment_id": 103548772, "body": "@EricPostpischil yes of course, I switching languages too often, so mixing up the terminology and concepts."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12295362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b4e7244bacd44da871efd3d8d30ca?s=128&d=identicon&r=PG&f=1", "display_name": "onnelim7791", "link": "https://stackoverflow.com/users/12295362/onnelim7791"}, "edited": false, "score": 0, "creation_date": 1572427117, "post_id": 58620069, "comment_id": 103552174, "body": "Thank you very much. This is what i want to know."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 3, "last_activity_date": 1572419139, "last_edit_date": 1572419139, "creation_date": 1572418782, "answer_id": 58620069, "question_id": 58619732, "link": "https://stackoverflow.com/questions/58619732/use-of-pointer-type/58620069#58620069", "title": "Use of pointer type", "body": "<p>These variables are not correctly initialized:</p>\n\n<pre><code>int* x1 = &amp;A;\nint* x2 = &amp;A[0];\n</code></pre>\n\n<p><code>&amp;A</code> is not an <code>int *</code>, and neither is <code>&amp;A[0]</code>. If you declare <code>x1</code> and <code>x2</code> properly, you will get the behavior you want when you increment.</p>\n\n<pre><code>int (*x1)[100][100] = &amp;A;\nint (*x2)[100] = &amp;A[0];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12295362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b4e7244bacd44da871efd3d8d30ca?s=128&d=identicon&r=PG&f=1", "display_name": "onnelim7791", "link": "https://stackoverflow.com/users/12295362/onnelim7791"}, "edited": false, "score": 0, "creation_date": 1572427277, "post_id": 58620101, "comment_id": 103552252, "body": "Thank you for your detailed explaination."}], "tags": [], "owner": {"reputation": 8243, "user_id": 1629262, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/F9Q4g.jpg?s=128&g=1", "display_name": "doptimusprime", "link": "https://stackoverflow.com/users/1629262/doptimusprime"}, "is_accepted": false, "score": -1, "last_activity_date": 1572418932, "creation_date": 1572418932, "answer_id": 58620101, "question_id": 58619732, "link": "https://stackoverflow.com/questions/58619732/use-of-pointer-type/58620101#58620101", "title": "Use of pointer type", "body": "<p>All your pointer are of type <code>int *</code>. When you increment them, they will be incremented by <code>sizeof(int)</code>.</p>\n\n<blockquote>\n  <p>Pointer type means the size of what address be saved in this pointer has an effect on.\n  No. Pointer type means type of the object to which the given address points to.</p>\n</blockquote>\n\n<p>In your code, to move to next element, you need to use following formula:</p>\n\n<pre><code>x + (number of columns)*(current row) + row\n</code></pre>\n\n<p>which in your case would be for (i,j)</p>\n\n<pre><code>x + 100*i + j\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1572446242, "creation_date": 1572446242, "answer_id": 58627787, "question_id": 58619732, "link": "https://stackoverflow.com/questions/58619732/use-of-pointer-type/58627787#58627787", "title": "Use of pointer type", "body": "<p>If <code>E</code> is an lvalue expression of type <code>T</code>, then <code>&amp;E</code> is an expression of type \"pointer to <code>T</code>\" (<code>T *</code>).  Remember that an array's size is part of its type - <code>int [10]</code> is a different type than <code>int [11]</code> or <code>int [9]</code>.  </p>\n\n<p>The expression <code>A</code> has type \"one-hundred element array of one-hundred element array of <code>int</code>\" (<code>int [100][100]</code>), so the expression <code>&amp;A</code> has type \"pointer to 100-element array of 100-element array of <code>int</code>\" (<code>int (*)[100][100]</code>), so <code>x1</code> needs to be declared as</p>\n\n<pre><code>int (*x1)[100][100] = &amp;A;\n</code></pre>\n\n<p>Similarly, the expression <code>A[0]</code> has type \"100-element array of <code>int</code>\" (<code>int [100]</code>), so the type of <code>&amp;A[0]</code> has type \"pointer to 100-element array of <code>int</code>\" (<code>int (*)[100]</code>), so <code>x2</code> needs to be declared as</p>\n\n<pre><code>int (*x2)[100] = &amp;A[0];\n</code></pre>\n\n<p>Thus, <code>x1++</code> will advance to point to the next 100x100 element array following <code>A</code>, while <code>x2++</code> will advance to point to <code>A[1]</code>.  </p>\n"}], "owner": {"reputation": 1, "user_id": 12295362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b4e7244bacd44da871efd3d8d30ca?s=128&d=identicon&r=PG&f=1", "display_name": "onnelim7791", "link": "https://stackoverflow.com/users/12295362/onnelim7791"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1572446242, "creation_date": 1572416987, "last_edit_date": 1572418356, "question_id": 58619732, "link": "https://stackoverflow.com/questions/58619732/use-of-pointer-type", "title": "Use of pointer type", "body": "<p>I'm studying pointer and have had some questions about this.</p>\n\n<p>Pointer type means the size of what address be saved in this pointer has an effect on.</p>\n\n<p>I don't know it is the right expression.</p>\n\n<p>About 2 demensional array,</p>\n\n<pre><code>int A[100][100] = {1,2,3,.....} ;\nint* x1 = &amp;A;\nint* x2 = &amp;A[0];\nint* x3 = &amp;A[0][0];\n</code></pre>\n\n<p>In this case, &amp;A,&amp; A[0], &amp;A[0][0] have same address but different size of what these addresses manage.</p>\n\n<p>For example, <code>&amp;A++</code> is equal to <code>address + 4byte * 100 * 100</code></p>\n\n<p><code>&amp;A[0]++ = address + 4byte * 100</code></p>\n\n<p>But, <code>x1++, x2++, x3++</code> are all same Incremental value about that expression.\nI know this reason is caused by the cast.</p>\n\n<p>Then, what should <code>i</code> do for <code>x1++</code> will be the same expression as <code>&amp;A++</code>?</p>\n"}, {"tags": ["c", "mac-address"], "comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 0, "creation_date": 1572419914, "post_id": 58619725, "comment_id": 103549036, "body": "As @doptimusprimes answer indicates, there are other ways to get the mac address. But if you want to read the output of a system call, that question is already asked and answered on SO several times.  e.g. <a href=\"https://stackoverflow.com/questions/43116/how-can-i-run-an-external-program-from-c-and-parse-its-output\" title=\"how can i run an external program from c and parse its output\">stackoverflow.com/questions/43116/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8243, "user_id": 1629262, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/F9Q4g.jpg?s=128&g=1", "display_name": "doptimusprime", "link": "https://stackoverflow.com/users/1629262/doptimusprime"}, "is_accepted": false, "score": 0, "last_activity_date": 1572419589, "creation_date": 1572419589, "answer_id": 58620213, "question_id": 58619725, "link": "https://stackoverflow.com/questions/58619725/how-to-assign-the-mac-address-of-a-windows-pc-to-string-variable-using-c/58620213#58620213", "title": "How to assign the MAC address of a Windows PC to string variable using C?", "body": "<p>Welcome to the world of programming. You need to use Win32 or system level API to get MAC address. You can read more on MSDN especially about winsock and use that to find MAC address.</p>\n\n<p>Also refer <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/ed1f0702-cb8a-4795-a512-667f1cf4617b/how-to-get-the-mac-address-of-local-computer-?forum=vcgeneral\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/vstudio/en-US/ed1f0702-cb8a-4795-a512-667f1cf4617b/how-to-get-the-mac-address-of-local-computer-?forum=vcgeneral</a></p>\n\n<p>Read doc here: <a href=\"https://docs.microsoft.com/en-us/windows/win32/winsock/windows-sockets-start-page-2\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/winsock/windows-sockets-start-page-2</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10310904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a210033505ed99f41e86673bc1dffd3d?s=128&d=identicon&r=PG&f=1", "display_name": "HasiruNMP", "link": "https://stackoverflow.com/users/10310904/hasirunmp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572419589, "creation_date": 1572416962, "question_id": 58619725, "link": "https://stackoverflow.com/questions/58619725/how-to-assign-the-mac-address-of-a-windows-pc-to-string-variable-using-c", "title": "How to assign the MAC address of a Windows PC to string variable using C?", "body": "<p>I want to get the MAC address of my PC and assign it to a variable.</p>\n\n<p>I have already tried this code and it outputs the address but I don't know how to assign it to a variable. Also I don't want to prompt anything. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    system(\"getmac\");\n    getch();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 1, "creation_date": 1572414006, "post_id": 58619313, "comment_id": 103547353, "body": "Pointers cannot store a data rather than an address, instead they can just point."}, {"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 0, "creation_date": 1572414459, "post_id": 58619313, "comment_id": 103547444, "body": "make your <code>perms</code> a <code>static</code> char array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 0, "creation_date": 1572414570, "post_id": 58619313, "comment_id": 103547469, "body": "@Revolver Please don&#39;t recommend that, it will cause other problems unless they&#39;re careful."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1572414944, "post_id": 58619313, "comment_id": 103547564, "body": "Have a look at <code>strdup</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1572421611, "post_id": 58619313, "comment_id": 103549661, "body": "One needs to use precise language. You don&#39;t store the contents of an array in a pointer, ever. You make a pointer <b>point at</b> an array. That&#39;s what pointers do. They point at things. They store <b>addresses</b> of things, not their contents."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1572415707, "post_id": 58619359, "comment_id": 103547754, "body": "The dynamic allocation is likely the best here as it allows for any number of file permission to be handled and collected in a list.."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1572419292, "post_id": 58619359, "comment_id": 103548817, "body": "A <code>char []</code> is not a <code>char *</code>. The fact it is automatically converted in many contexts does not make it one. Do not teach people this wrong information."}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1572421984, "post_id": 58619359, "comment_id": 103549799, "body": "@EricPostpischil I edited the answer in order to clarify the <i>pratical</i> meaning of my sentence. Check if it&#39;s better."}], "tags": [], "owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "is_accepted": false, "score": 1, "last_activity_date": 1572421326, "last_edit_date": 1572421326, "creation_date": 1572414318, "answer_id": 58619359, "question_id": 58619313, "link": "https://stackoverflow.com/questions/58619313/is-there-way-to-take-the-contents-of-an-array-and-store-it-into-a-pointer/58619359#58619359", "title": "Is There way to take the contents of an array and store it into a pointer?", "body": "<p>A char [] symbol can be accessed exactly like a char *. It can be easily returned, but it has to be dynamically allocated inside the function or otherwise passed as a parameter of the function.</p>\n\n<p>Returning a local variable is a mistake that leads to undefined behaviour, because it is stored in the stack and will be overwritten as soon as the funtion returns.</p>\n\n<p>In your function returning <code>perms</code> is ok (no need to define another pointer) if you allocate it with\n<code>perms = malloc (11);</code></p>\n\n<p>(You will have to free it outside your function).</p>\n"}], "owner": {"reputation": 27, "user_id": 12216468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66747f5b959202eeef9a9846862a8140?s=128&d=identicon&r=PG&f=1", "display_name": "JonnyMca1081", "link": "https://stackoverflow.com/users/12216468/jonnymca1081"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572421326, "creation_date": 1572413915, "question_id": 58619313, "link": "https://stackoverflow.com/questions/58619313/is-there-way-to-take-the-contents-of-an-array-and-store-it-into-a-pointer", "title": "Is There way to take the contents of an array and store it into a pointer?", "body": "<p>I am writing a a program that produces similar results to the command ls -l. Currently I can produce the results through loops, but now I want to store certain variables into a linked list so I can later put it through a lexical-graphic sorter. I can store most of the variable into the node properly, but the problems stems from when I'm trying to store the permission variable. Is there a way I can get the contents of an char[] to a char *?</p>\n\n<p>With the way I have it set up the permissions are stored in a char[], but I haven't found away to use char[] as a return type, so I decided a char * would be more appropriate but now I'm trying to figure out how to go from char[] to a char*.</p>\n\n<pre><code>char* find_perms(mode_t st) {\n    char* perms_ptr;\n    char perms[11];\n    if(st &amp;&amp; S_ISREG(st)) perms[0]='-';\n    else if(st &amp;&amp; S_ISDIR(st)) perms[0]='d';\n    else if(st &amp;&amp; S_ISFIFO(st)) perms[0]='|';\n    else if(st &amp;&amp; S_ISSOCK(st)) perms[0]='s';\n    else if(st &amp;&amp; S_ISCHR(st)) perms[0]='c';\n    else if(st &amp;&amp; S_ISBLK(st)) perms[0]='b';\n    else perms[0]='l';  // S_ISLNK\n    perms[1] = (st &amp;&amp; S_IRUSR) ? 'r':'-';\n    perms[2] = (st &amp;&amp; S_IWUSR) ? 'w':'-';\n    perms[3] = (st &amp;&amp; S_IXUSR) ? 'x':'-';\n    perms[4] = (st &amp;&amp; S_IRGRP) ? 'r':'-';\n    perms[5] = (st &amp;&amp; S_IWGRP) ? 'w':'-';\n    perms[6] = (st &amp;&amp; S_IXGRP) ? 'x':'-';\n    perms[7] = (st &amp;&amp; S_IROTH) ? 'r':'-';\n    perms[8] = (st &amp;&amp; S_IWOTH) ? 'w':'-';\n    perms[9] = (st &amp;&amp; S_IXOTH) ? 'x':'-';\n    perms[10] = '\\0';\n    printf(\"%s \",perms);\n    perms_ptr = perms;\n    return perms_ptr;\n}\n</code></pre>\n\n<p>as it is right now this does return a char*, but instead of pointing to the array that I was hoping I could use later it points to an empty string. When I used gdb to view what perms_ptr was pointing to it just showed up as \"\".</p>\n"}, {"tags": ["c", "function", "macros", "type-safety", "variadic"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1572415586, "post_id": 58619266, "comment_id": 103547720, "body": "&quot;<i>I declared a function with the following signature</i>&quot; are you bound to this using exactly this signature, or are you free to change it?"}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1572415642, "post_id": 58619266, "comment_id": 103547736, "body": "@alk Yes, the signature can be changed if it would simplify function call"}, {"owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1572415689, "post_id": 58619266, "comment_id": 103547749, "body": "@alk But I need to support <code>malloc</code>ed pointers as well. This was the reason it was declared that way"}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 1, "last_activity_date": 1572422966, "last_edit_date": 1572422966, "creation_date": 1572416667, "answer_id": 58619674, "question_id": 58619266, "link": "https://stackoverflow.com/questions/58619266/macro-function-to-avoid-sizeof-boilerplate-during-function-call/58619674#58619674", "title": "Macro function to avoid sizeof boilerplate during function call", "body": "<p>Instead of complicating things even more by wrapping the complicate initialisation into a complicated (if even possible) variadic macro, just declare the function in question as a variadic one itself.</p>\n\n<p>This might look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdarg.h&gt;\n\n/* expects: number-of-arrays followed by \n   number-of-arrays tuples {arrays-size,  pointer to array's 1st element} */\n\nstruct test_s{\n  int a, b;\n};\n\nvoid foo(size_t arr_len, ...)\n{\n  va_list vl;\n\n  va_start(vl, arr_len);\n\n  for (size_t i = 0; i &lt; arr_len; ++i) \n  {\n    size_t s = va_arg(vl, size_t);\n    struct test_s * p = va_arg(vl, struct test_s *);\n\n    for (size_t j = 0; j &lt; s; ++j)\n    {\n      struct test_s ts = p[j];\n      printf(\"a = %d; b = %d\\n\", ts.a, ts.b);\n    }\n  }\n\n  va_end(vl);\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>struct test_s{\n  int a, b;\n};\n\nvoid foo(size_t, ...);\n\nint main(void)\n{\n  /* using two arrays: */\n  {\n    struct test_s a1[] = {{0, 1}, {2, 3}, {4, 5}};\n    struct test_s a2[] = {{4, 6}};\n\n    foo(2, \n      sizeof a1 / sizeof *a1, a1, \n      sizeof a2 / sizeof *a2, a2\n    );\n  }\n\n  /* using three arrays: */\n  {\n    struct test_s a1[] = {{0, 1}, {2, 3}, {4, 5}};\n    struct test_s a2[] = {{4, 6}};\n    struct test_s a3[] = {{2, 3}, {4, 5}};\n\n    foo(3, \n      sizeof a1 / sizeof *a1, a1, \n      sizeof a2 / sizeof *a2, a2,\n      sizeof a3 / sizeof *a3, a3\n    );\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 23069, "user_id": 2786156, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fWMLm.jpg?s=128&g=1", "display_name": "St.Antario", "link": "https://stackoverflow.com/users/2786156/st-antario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58619674, "answer_count": 1, "score": 1, "last_activity_date": 1572422966, "creation_date": 1572413425, "last_edit_date": 1572418047, "question_id": 58619266, "link": "https://stackoverflow.com/questions/58619266/macro-function-to-avoid-sizeof-boilerplate-during-function-call", "title": "Macro function to avoid sizeof boilerplate during function call", "body": "<p>I declared a function with the following signature (implementation is simplified):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct test_s{\n    int a, b;\n};\n\nvoid foo(struct test_s **out, size_t *szs, size_t arr_len){\n    for(size_t i = 0; i &lt; arr_len; i++){\n        for(size_t j = 0; j &lt; szs[i]; j++){\n            struct test_s ts = out[i][j];\n            printf(\"a = %d; b = %d\\n\", ts.a, ts.b);\n        }\n    }\n}\n</code></pre>\n\n<p>In case a caller uses arrays to be adjusted to pointers it can be called as follows:</p>\n\n<pre><code>int main(void){\n    struct test_s a1[] = {{0, 1}, {2, 3}, {4, 5}};\n    struct test_s a2[] = {{4, 6}};\n    foo((struct test_s *[]){a1, a2}, \n        (size_t[]){sizeof a1 / sizeof(struct test_s), sizeof a2 / sizeof(struct test_s)}, \n        2);\n}\n</code></pre>\n\n<p>As can be seen the function call looks complicated, error-prone and hard to read.</p>\n\n<p>When it comes to using 3 arguments things get worse:</p>\n\n<pre><code>int main(void){\n    struct test_s a1[] = {{0, 1}, {2, 3}, {4, 5}};\n    struct test_s a2[] = {{4, 6}};\n    struct test_s a3[] = {{2, 3}, {4, 5}};\n    foo((struct test_s *[]){a1, a2, a3},\n        (size_t[]){sizeof a1 / sizeof(struct test_s), sizeof a2 / sizeof(struct test_s), sizeof a3 / sizeof(struct test_s)},\n        3);\n}\n</code></pre>\n\n<p>So it would be perfect to implement it as macro when it comes to arrays. It is pretty straightforward to implement it as follows:</p>\n\n<pre><code>#define FOO_ARR_2(a1, a2) \\\n    do{ \\\n        foo((struct test_s *[]){a1, a2},  \\\n        (size_t[]){sizeof a1 / sizeof(struct test_s), sizeof a2 / sizeof(struct test_s)}, \\\n        2);\\\n    } while(0)\n</code></pre>\n\n<p>I see 2 problems with such a macro:</p>\n\n<ol>\n<li>I would have to define <code>FOO_ARR_3</code>, <code>FOO_ARR_4</code>, etc...</li>\n<li>Lack of type safety. In case a caller pass something different then <code>struct test_s[]</code></li>\n</ol>\n\n<p><strong><em>QUESTION:</em></strong> Would it be possible to implement it as a variadic macro function like <code>#define FOO_ARR(...)</code>?</p>\n"}, {"tags": ["c", "performance", "for-loop", "gcc", "runtime"], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 12019759, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JZgqKSRmOCc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8Z-h5WL6sPHEJ3lGKmjW4tSDhcA/photo.jpg?sz=128", "display_name": "Sandeep Tadepalli", "link": "https://stackoverflow.com/users/12019759/sandeep-tadepalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1572413207, "creation_date": 1572413207, "answer_id": 58619232, "question_id": 58619121, "link": "https://stackoverflow.com/questions/58619121/unexpected-runtime-of-loop/58619232#58619232", "title": "Unexpected runtime of loop", "body": "<p>The problem is in your code. If all the characters match then it will do the check for 100000 times. But if the any one character doesn't match then you will return from the loop in the first iteration itself. Hence the time difference is small when all the characters don't match.</p>\n\n<p>Instead of return put a break statement inside the if block</p>\n\n<pre><code>        for (int j = 0; j &lt; 100000; j++) {\n                 for (int i = 0; i &lt; 26; i++) {\n                     if (a[i] != in[i]) {\n                         break;\n                     }\n                  }\n        }\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 9182179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd10427565682da7411ee66b29a0057d?s=128&d=identicon&r=PG&f=1", "display_name": "sviamwvnb", "link": "https://stackoverflow.com/users/9182179/sviamwvnb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572413207, "creation_date": 1572412320, "question_id": 58619121, "link": "https://stackoverflow.com/questions/58619121/unexpected-runtime-of-loop", "title": "Unexpected runtime of loop", "body": "<p>I am coding a side channel attack demo. I expected a simple character-by-character check with early return to take a linearly-proportional time to the first incorrect character. For example, if I have the password <code>password</code> and a input of <code>qassword</code> (first letter wrong) and <code>passwore</code> (last letter wrong), I expected <code>qassword</code> to take less time to compare than <code>passwore</code> (because it exits early, on the first wrong letter).</p>\n\n<p>The loop in question is:</p>\n\n<pre><code>for (int i = 0; i &lt; 26; i++) {\n    if (a[i] != in[i]) {\n        return 1;\n    }\n}\nreturn 1;\n</code></pre>\n\n<p>I have disabled optimizations with <code>-O0</code>.</p>\n\n<p>The output of the full code is:</p>\n\n<pre><code>Diff(9326)\nDiff(2)\nDiff(1)\nDiff(9292)\n</code></pre>\n\n<p>This is surprising to me because the first case is checking all the letters (ok, should take the longest time), the second case is checking all but the last letter (should take about the same amount of time as first case?) and the last case should only be checking the first letter (ok, taking the least amount of time).</p>\n\n<p>My question is why does it take so long for the case where it is completely correct and so quick for all other cases (even if the wrong letter is in the middle)?</p>\n\n<p>The full code is (<a href=\"https://tio.run/##vVLRTsMgFH0uX3GtMaHOuc0HX7qZGI1PJn6ALgYptGyUTqBOZ/rr1ku3pW/GaJSEcDkc7jn3Ah/mnLftoTJc15mAqfOZqk6LC9JDXpUiIEQZD7wQfEl5wewxKJPAO4l4ZVw4CBCDGcTsiWdC5oVaLHVpqtWzdb5@Wb@@beKUkEhWFmjItUDyOMVlCpNxGBgPBl3OnqS2JIWks3Nc94RISaDsXs3hYIZOMNjhkRW@tgYmadg1pJsN6vZ4s62lZMrQbQm64stHD84z69N@nykpg@XRCC61Bl5ZK7gnUcdDYx2PJuFG15evSg@skK@/BsO9IIlWFh1JGl8jgx7pLHkw8Umnn@wM3DLsshbeCwtrW5n8JzbYr23cKPt9H5u/a8dVUAD8BJyhGCjnagHUsVIAcwg6AZPk31@qadsPLjXLXTu8G38C\" rel=\"nofollow noreferrer\">Try It Online</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint check(char* in) {\n    const char* a = \"abcdefghijklmnopqrstuvwxyz\";\n\n    for (int j = 0; j &lt; 100000; j++) {\n        for (int i = 0; i &lt; 26; i++) {\n            if (a[i] != in[i]) {\n                return 1;\n            }\n        }\n    }\n\n    return 1;\n}\n\nint main() {\n    clock_t start;\n    clock_t diff;\n\n    // All correct\n    start = clock();\n    check(\"abcdefghijklmnopqrstuvwxyz\");\n    diff = clock() - start;\n\n    printf(\"Diff(%ld)\\n\", diff);\n\n    // Last letter wrong\n    start = clock();\n    check(\"abcdefghijklmnopqrstuvwxya\");\n    diff = clock() - start;\n\n    printf(\"Diff(%ld)\\n\", diff);\n\n    // First letter wrong\n    start = clock();\n    check(\"zbcdefghijklmnopqrstuvwxyz\");\n    diff = clock() - start;\n\n    printf(\"Diff(%ld)\\n\", diff);\n\n    // Check if cache issue (same as case 1)\n    start = clock();\n    check(\"abcdefghijklmnopqrstuvwxyz\");\n    diff = clock() - start;\n\n    printf(\"Diff(%ld)\\n\", diff);\n}\n</code></pre>\n"}, {"tags": ["debian", "c", "gcc"], "comments": [{"owner": {"reputation": 1041, "user_id": 5419599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SbCyV.png?s=128&g=1", "display_name": "Wildcard", "link": "https://stackoverflow.com/users/5419599/wildcard"}, "edited": false, "score": 4, "creation_date": 1572414218, "post_id": 58620783, "comment_id": 103549863, "body": "Just a friendly tip: when you try to preemptively argue against responses that people <i>might</i> have to your question, preemptively accuse people of \u201clecturing\u201d you, and also don\u2019t bother to clarify <i>why</i> those responses you predict and reject ahead of time don\u2019t apply to you\u2014all this just comes across as highly belligerent, even combative.  Don\u2019t expect many strangers to remain willing to help you with this degree of belligerence up front."}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "reply_to_user": {"reputation": 1041, "user_id": 5419599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SbCyV.png?s=128&g=1", "display_name": "Wildcard", "link": "https://stackoverflow.com/users/5419599/wildcard"}, "edited": false, "score": 0, "creation_date": 1572415672, "post_id": 58620783, "comment_id": 103549864, "body": "I&#39;m not trying to be belligerent.  I&#39;m just trying to avoid off-topic <i>answers</i> that are of no help at all, or answer the wrong question (also known as XY-ing)."}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "reply_to_user": {"reputation": 1041, "user_id": 5419599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SbCyV.png?s=128&g=1", "display_name": "Wildcard", "link": "https://stackoverflow.com/users/5419599/wildcard"}, "edited": false, "score": 0, "creation_date": 1572415760, "post_id": 58620783, "comment_id": 103549865, "body": "Progress report: I found gets() in /usr/include also with all sorts of fire-and-brimstone warnings against using it.  I copied the good parts to my source file."}, {"owner": {"reputation": 294, "user_id": 2007980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gEDH.gif?s=128&g=1", "display_name": "schaiba", "link": "https://stackoverflow.com/users/2007980/schaiba"}, "edited": false, "score": 5, "creation_date": 1572416104, "post_id": 58620783, "comment_id": 103549866, "body": "So what you&#39;re saying is &quot;I want to use something that&#39;s frowned upon (at best), but still, don&#39;t tell me what to do, I want to use it anyway&quot;. I suggest you read the manpages for the library functions involved (<code>gets()</code>, <code>fgets()</code> at least) and try to understand why <code>gets()</code> is not recommended."}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "edited": false, "score": 0, "creation_date": 1572416339, "post_id": 58620783, "comment_id": 103549867, "body": "What I&#39;m saying is, I&#39;m already aware of the arguments against gets() and yes, I want to continue using it.  And I&#39;m sure the manpages will just talk about buffer overflows and stuff which I already mentioned in the OP."}, {"owner": {"reputation": 12533, "user_id": 931027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lWhaB.jpg?s=128&g=1", "display_name": "Kusalananda", "link": "https://stackoverflow.com/users/931027/kusalananda"}, "edited": false, "score": 1, "creation_date": 1572417337, "post_id": 58620783, "comment_id": 103549868, "body": "What is the actual issue here? Too many compiler warnings? You have shown none of these. Also, if it&#39;s compiler warnings you&#39;re concerned about, can you say something about why you are concerned about these (presumably, you aren&#39;t compiling your code more often than actually running it)?"}, {"owner": {"reputation": 166, "user_id": 11747252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rm_VanUFE_8/AAAAAAAAAAI/AAAAAAAABWc/I_W7oml-Tys/photo.jpg?sz=128", "display_name": "Johan Myr&#233;en", "link": "https://stackoverflow.com/users/11747252/johan-myr%c3%a9en"}, "edited": false, "score": 4, "creation_date": 1572417862, "post_id": 58620783, "comment_id": 103549869, "body": "@Jennifer You don&#39;t like <code>fgets</code> because it truncates the string if it does not fit in the destination buffer, so <code>gets</code> is better, because it overruns the buffer instead? If you let this happen, you have a serious bug in your program, almost guaranteed to make your program malfunction, crash it, or make it vulnerable to exploits."}, {"owner": {"reputation": 166, "user_id": 11747252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rm_VanUFE_8/AAAAAAAAAAI/AAAAAAAABWc/I_W7oml-Tys/photo.jpg?sz=128", "display_name": "Johan Myr&#233;en", "link": "https://stackoverflow.com/users/11747252/johan-myr%c3%a9en"}, "edited": false, "score": 3, "creation_date": 1572418007, "post_id": 58620783, "comment_id": 103549862, "body": "This question is a troll. Just close it and ignore it."}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "edited": false, "score": 0, "creation_date": 1572420654, "post_id": 58620783, "comment_id": 103549870, "body": "The ACTUAL issue is stated in the topic name: gets() without apology.  I want to use gets() and avoid all the warnings.  I am NOT trolling.  I have an issue and I&#39;m trying to solve it.  I have NOT ever overrun the buffer -- so it doesn&#39;t matter if I use a depricated function, I just don&#39;t want to see the warnings."}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "edited": false, "score": 0, "creation_date": 1572420835, "post_id": 58620783, "comment_id": 103549871, "body": "The warning message is: &quot;/home/user/src9/ProCheck.c:119:11: warning: implicit declaration of function \u2018gets\u2019 [-Wimplicit-function-declaration] -- if ( !gets(g.workarea)) goto MAIN3;&quot;.  After I copied over the declaration (without the part that makes is not work without diddling with it), I got &quot;warning: the `gets&#39; function is dangerous and should not be used.&quot; (from the linker)."}, {"owner": {"reputation": 166, "user_id": 11747252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rm_VanUFE_8/AAAAAAAAAAI/AAAAAAAABWc/I_W7oml-Tys/photo.jpg?sz=128", "display_name": "Johan Myr&#233;en", "link": "https://stackoverflow.com/users/11747252/johan-myr%c3%a9en"}, "edited": false, "score": 2, "creation_date": 1572420955, "post_id": 58620783, "comment_id": 103549872, "body": "@Jennifer If you have never overrun the buffer, and don&#39;t expect to, then why are you worried about truncating the string when using <code>fgets</code>? It&#39;s the same thing."}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "edited": false, "score": 0, "creation_date": 1572421131, "post_id": 58620783, "comment_id": 103549873, "body": "I suppose it is but if I can avoid the gets() warnings that&#39;s what I want to do."}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "edited": false, "score": 0, "creation_date": 1572424379, "post_id": 58620783, "comment_id": 103550803, "body": "Can anybody tell me WHY my question was moved?  It happened in a Linux environment, after all.  I made that clear at the end of the OP.  And no, I don&#39;t want it moved to chat."}, {"owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "edited": false, "score": 1, "creation_date": 1572425534, "post_id": 58620783, "comment_id": 103551315, "body": "<a href=\"https://unix.stackexchange.com/help/on-topic\">unix.stackexchange.com/help/on-topic</a> =&gt; &quot;If your question is a programming question, requiring knowledge of programming languages other than unix shell scripting languages, ask on Stack Overflow.&quot;"}, {"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "edited": false, "score": 0, "creation_date": 1572426104, "post_id": 58620783, "comment_id": 103551595, "body": "It&#39;s more of a question on using the compiler and linker than it is on programming.  The program it came from is just a container for the actual problem; that of using gets() under gcc."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "edited": false, "score": 0, "creation_date": 1572416048, "post_id": 58620784, "comment_id": 103549874, "body": "I knew about checking for newlines, and I have actually used that technique.  But it&#39;s awkward.  I was hoping for some sort of flag that says it was truncated.  But I do like the idea of a dynamically allocated buffer that gets copied to and re-allocated if it wasn&#39;t big enough."}], "tags": [], "owner": {"reputation": 404, "user_id": 12298006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1Oje.gif?s=128&g=1", "display_name": "icarus", "link": "https://stackoverflow.com/users/12298006/icarus"}, "is_accepted": true, "score": 5, "last_activity_date": 1572414220, "creation_date": 1572414220, "answer_id": 58620784, "question_id": 58620783, "link": "https://stackoverflow.com/questions/58620783/gets-without-apology/58620784#58620784", "title": "gets() without apology", "body": "<p>Your assertion that fgets <code>just returns whatever will fit without any indication the string has been truncated</code> is obviously incorrect. If the character at the end of the input is not a newline and you have not reached the end of file then it is truncated. At this point you can allocate a bigger buffer, copy what you have so far into it and do another fgets.</p>\n\n<p>What you seem to want is a function that reads an unlimited string. This means it will need to do memory allocation and therefor it will have a different signature than <code>gets(char *buffer)</code>, and you will need to free the result. This means that however much you don't want to change away from gets, you have no choice if you want to be able to handle arbitrary long lines.</p>\n\n<p>This matches what the function <a href=\"https://linux.die.net/man/3/getline\" rel=\"noreferrer\">getline</a> does.</p>\n\n<p>So replace </p>\n\n<pre><code>  char buffer[128];\n  char *input=gets(buffer);\n  /* do something with input or buffer */\n</code></pre>\n\n<p>with</p>\n\n<pre><code>  char *input=NULL;\n  size_t len=0;\n  getline(&amp;input, &amp;len, stdin);\n  /* do something with input */\n  free(input);\n</code></pre>\n\n<p>See the manual page for more details.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1572422111, "question_id": 549414}, "owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "accepted_answer_id": 58620784, "answer_count": 1, "score": -4, "last_activity_date": 1572422111, "creation_date": 1572410376, "question_id": 58620783, "link": "https://stackoverflow.com/questions/58620783/gets-without-apology", "title": "gets() without apology", "body": "<p>I use the gets() function a lot in my own programming.  I know that:</p>\n\n<ul>\n<li><p>the input string may overflow the allocated space</p></li>\n<li><p>in some environments, the above can be used to create an exploit</p></li>\n<li><p>that fgets() can be used instead to read standard input</p></li>\n<li><p>that the header declaration has been removed (from stdio.h?)</p></li>\n<li><p>that use of gets() is not recommended</p></li>\n<li><p>that gets() is deprecated</p></li>\n</ul>\n\n<p>But I want to use it anyway; perhaps \"saving\" a copy of the headers and object code before it disappears altogether.</p>\n\n<p>I don't like fgets() because if the input is too long, it just returns whatever will fit without any indication the string has been truncated.  The rest (or at least the next portion) of the string is returned on the next call, which is fine if you're simply writing a program to copy standard input to standard output or a file (why would anyone want to write a program to do that?) but useless if you're processing the data in some way.</p>\n\n<p>Please don't answer the question how do I know the input string has been truncated by fgets()?  That is not the question I'm trying to answer.  The correct question is how do I use gets() without a lot of warnings of doom and disaster?</p>\n\n<p>And please, no lectures about how I don't want to use gets().</p>\n\n<p>I'm using gcc c under Debian 9; no IDE.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 2, "creation_date": 1572410956, "post_id": 58618840, "comment_id": 103546699, "body": "Your question&#39;s body does not match the question&#39;s title.  Above, the body has been answered.  To answer the question&#39;s title: the difference is that in the first case, you&#39;re adding two <code>int</code> values, while in the second case you&#39;re adding two <code>double</code> values and then implicitly converting the result to <code>int</code>."}, {"owner": {"reputation": 1591, "user_id": 7264980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6251945f2fe3a58c482788f1cd20fa9?s=128&d=identicon&r=PG", "display_name": "Anatoliy R", "link": "https://stackoverflow.com/users/7264980/anatoliy-r"}, "edited": false, "score": 0, "creation_date": 1572410960, "post_id": 58618840, "comment_id": 103546701, "body": "yes we are, for example in your subject, the first expression will assign integer to b while the second expression will attempt to assign and implicitly convert float value to integer b"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11399849"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1572412590, "post_id": 58618840, "comment_id": 103547013, "body": "@paddy sorry for that. I just didn&#39;t write more code in the title because it would confuse the readers. Anyway, the concept is the same. I&#39;ll try to fix it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1572412932, "post_id": 58618840, "comment_id": 103547101, "body": "One uses an implicit conversion and the other uses explicit conversion aka cast. The net result is the same."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1572417019, "post_id": 58618840, "comment_id": 103548103, "body": "The initial title (now edited) and the &quot;bland&quot; (but correct) answer in the comment by n.m., which illustrates that the question lacks some &quot;fire&quot;, seem to indicate that you might want to make a more complicated point. I.e. I assume that you are thinking of something else &quot;behind&quot; this. Consider elaborating, maybe by making an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of what you are trying. Maybe the idea of an XY problem, <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a> , can help you making such a question. But don&#39;t get me wrong, this kind of very simple questions is absolutely fine here, if it helps you."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1572419755, "post_id": 58618840, "comment_id": 103548975, "body": "In some places, the compiler will automatically convert one type to another without complaint. These are generally places where type conversions are normal (like one numeric type to another) or safe (like adding a qualifier to a pointer, such as from <code>char *</code> to <code>const char *</code>). When you want to do an abnormal unsafe conversion, you must use an explicit cast."}], "answers": [{"tags": [], "owner": {"reputation": 1957, "user_id": 12056564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec003d02adbcf6a3065097f6f29fa29?s=128&d=identicon&r=PG&f=1", "display_name": "Gerd", "link": "https://stackoverflow.com/users/12056564/gerd"}, "is_accepted": true, "score": 1, "last_activity_date": 1572441616, "creation_date": 1572441616, "answer_id": 58626324, "question_id": 58618840, "link": "https://stackoverflow.com/questions/58618840/what-is-the-difference-between-int-b-int-45-0-and-int-b-45-0/58626324#58626324", "title": "what is the difference between &quot;int b = (int) 45.0&quot; and &quot;int b = 45.0&quot;?", "body": "<p><a href=\"https://www.oreilly.com/library/view/c-in-a/0596006977/ch04.html\" rel=\"nofollow noreferrer\">C in a Nutshell (chapter 4)</a> explains the topic: </p>\n\n<blockquote>\n  <p>In C, operands of different types can be combined in one operation.\n  [...] When the operands have different types, the compiler tries to\n  convert them to a uniform type before performing the operation.</p>\n</blockquote>\n\n<p>This is known as <strong>implicit type conversion</strong>. </p>\n\n<blockquote>\n  <p>You can also convert values from one type to another explicitly using\n  the cast operator [...]. You should always use the cast operator\n  whenever there is a possibility of losing information, as in a\n  conversion from <code>int</code> to <code>unsigned int</code>, for example. Explicit casts avoid\n  compiler warnings, and also signpost your program\u2019s type conversions\n  for other programmers.</p>\n</blockquote>\n\n<p>This is known as <strong>explicit type conversion</strong> and is done with the cast operator: <code>(type_name) expression</code></p>\n\n<p>As n.m. has already pointed pointed out, the result is the same in your example. </p>\n\n<p><a href=\"https://www.geeksforgeeks.org/type-conversion-c/\" rel=\"nofollow noreferrer\">Here is</a> another helpful article. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11399849"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 58626324, "answer_count": 1, "score": 0, "last_activity_date": 1572441616, "creation_date": 1572410337, "last_edit_date": 1572412649, "question_id": 58618840, "link": "https://stackoverflow.com/questions/58618840/what-is-the-difference-between-int-b-int-45-0-and-int-b-45-0", "title": "what is the difference between &quot;int b = (int) 45.0&quot; and &quot;int b = 45.0&quot;?", "body": "<p>I have a question.\nI was wondering that by adding \"(int)\" (or any kind of data type), this means that we're converting it into int. ex</p>\n\n<pre><code>double lk = 45.0;\nint nm = (int) lk; //not tested though\n</code></pre>\n\n<p>Anyway, is there a terminology for this?</p>\n"}, {"tags": ["c", "arrays", "pointers", "parameter-passing", "cc"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1572411213, "post_id": 58618767, "comment_id": 103546748, "body": "The compiler error should tell you quite clearly what you&#39;re doing wrong and why."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 1, "last_activity_date": 1572411164, "creation_date": 1572411164, "answer_id": 58618954, "question_id": 58618767, "link": "https://stackoverflow.com/questions/58618767/why-does-the-const-clause-not-work-if-i-try-to-use-it-when-i-want-to-protect-the/58618954#58618954", "title": "Why does the const clause not work if I try to use it when I want to protect the modification of a vector?", "body": "<p>Since <code>vettore</code> is a pointer to <code>const int</code>, you must make <code>i</code> have the same type.</p>\n\n<pre><code>const int *i;\nint max = *vettore;\n\nfor(i = vettore; i &lt; vettore + n; i++)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1572411739, "creation_date": 1572411739, "answer_id": 58619041, "question_id": 58618767, "link": "https://stackoverflow.com/questions/58618767/why-does-the-const-clause-not-work-if-i-try-to-use-it-when-i-want-to-protect-the/58619041#58619041", "title": "Why does the const clause not work if I try to use it when I want to protect the modification of a vector?", "body": "<p>Short Version: Adding a const qualifier will address the compiler warning.</p>\n\n<pre><code>int find_largest_with_pointer(const int *vettore, int n) {\n//    int *i, max = *vettore;\n    const int *i ;\n    int max = *vettore;\n    ...\n}\n</code></pre>\n\n<p><strong>Long Version:</strong></p>\n\n<p>In the second function, you use two variables. Expanding the code a little bit</p>\n\n<pre><code>   int *i ;l\n   it max = a[0] ;\n   for (\n       i = vettore;\n       i &lt; vettore + n;\n       i++\n   ) { ... }\n</code></pre>\n\n<p>Note the line <code>i = vettore</code>, which will attempt to copy the 'const int * vettore<code>into non-const 'int *i</code>. This has the potential of allowing modification to the const vector (e.g. <code>*i = 5</code>), and the compiler complain: </p>\n\n<pre><code>c.c:33:11: warning: assignment discards \u2018const\u2019 qualifier from pointer target type [-Wdiscarded-qualifiers]\n     for(i = vettore; i &lt; vettore + n; i++)\n</code></pre>\n\n<p>Solution is simple: add const qualifier on <code>const int *i</code>. See above.</p>\n"}], "owner": {"reputation": 387, "user_id": 11736671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZzcK.jpg?s=128&g=1", "display_name": "Roberto Rocco", "link": "https://stackoverflow.com/users/11736671/roberto-rocco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 58618954, "answer_count": 2, "score": 2, "last_activity_date": 1572411739, "creation_date": 1572409702, "question_id": 58618767, "link": "https://stackoverflow.com/questions/58618767/why-does-the-const-clause-not-work-if-i-try-to-use-it-when-i-want-to-protect-the", "title": "Why does the const clause not work if I try to use it when I want to protect the modification of a vector?", "body": "<p>In the book I am studying it says that if I pass a vector to a function, the name of the vector is always treated as a pointer.\nIn fact it's so.\nBut I can't understand why in the first function the const clause is allowed by the compiler, while in the second function (where I use pointers to search for the maximum value between the elements) no.\nIn the functions I would simply like to protect against the modification of the vector.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint find_largest(const int a[], int n);\nint find_largest_with_pointer(const int *vettore, int n);\n\nint main(void) {\n    int my_number[] = {5, 7, 90, 34, 12};\n    int n = sizeof(my_number) / sizeof(my_number[0]);\n    int *pmy_number = my_number;\n\n    printf(\"%d\\n\", find_largest(my_number, n));\n    printf(\"%d\\n\", find_largest(pmy_number, n));\n    printf(\"%d\\n\", find_largest_with_pointer(my_number, n));\n    printf(\"%d\\n\", find_largest_with_pointer(pmy_number, n));\n\n    return 0;\n}\n\nint find_largest(const int a[], int n) {\n    int i, max;\n    max = a[0];\n\n    for(i = 0; i &lt; n; i++)\n        if(a[i] &gt; max)\n            max = a[i];\n\n    return max;\n}\n\nint find_largest_with_pointer(const int *vettore, int n) {\n    int *i, max = *vettore;\n\n    for(i = vettore; i &lt; vettore + n; i++)\n        if(*i &gt; max)\n            max = *i;\n\n    return max;\n}\n</code></pre>\n"}, {"tags": ["c", "cmake", "sdl", "clion"], "comments": [{"owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "edited": false, "score": 1, "creation_date": 1572408301, "post_id": 58618558, "comment_id": 103546159, "body": "I&#39;m assuming <code>deplacerJoueur</code> is a function you wrote?  If so, make sure you&#39;re compiling the source file where the function is implemented."}, {"owner": {"reputation": 173, "user_id": 9613780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/De6o7.jpg?s=128&g=1", "display_name": "Mahamad A. Kanout&#233;", "link": "https://stackoverflow.com/users/9613780/mahamad-a-kanout%c3%a9"}, "reply_to_user": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "edited": false, "score": 0, "creation_date": 1572408873, "post_id": 58618558, "comment_id": 103546269, "body": "It&#39;s in jeu.h defined as a prototype. Also, since you mentioned that, when I hover my mouse pointer over the function jouer in jeu.h I see SDL_Surface as an unknown type name ."}, {"owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "edited": false, "score": 2, "creation_date": 1572408942, "post_id": 58618558, "comment_id": 103546282, "body": "Where is it implemented?  You need to make sure you&#39;re building that source file.  Your build errors are because the linker can&#39;t find that function&#39;s implementation."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 9613780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/De6o7.jpg?s=128&g=1", "display_name": "Mahamad A. Kanout&#233;", "link": "https://stackoverflow.com/users/9613780/mahamad-a-kanout%c3%a9"}, "edited": false, "score": 0, "creation_date": 1572454710, "post_id": 58622237, "comment_id": 103567842, "body": "By following a course on C and been stuck on this part for a months. Anyways everything you said helped as I had the functions used in another function and the order of included in the main.c wasn&#39;t the best also. Merci !"}, {"owner": {"reputation": 173, "user_id": 9613780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/De6o7.jpg?s=128&g=1", "display_name": "Mahamad A. Kanout&#233;", "link": "https://stackoverflow.com/users/9613780/mahamad-a-kanout%c3%a9"}, "edited": false, "score": 0, "creation_date": 1572454886, "post_id": 58622237, "comment_id": 103567949, "body": "Fixed the target library issue by downloading the right one and replaced it in use/include on my system"}], "tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": true, "score": 2, "last_activity_date": 1572427824, "creation_date": 1572427824, "answer_id": 58622237, "question_id": 58618558, "link": "https://stackoverflow.com/questions/58618558/is-there-an-easier-way-to-compile-this-project/58622237#58622237", "title": "Is there an easier way to compile this project", "body": "<p>If you get such errors you need to look into each of them:</p>\n\n<hr>\n\n<pre><code>CMakeFiles/SOKOBANR.dir/jeu.c.o: In function `jouer':\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:12: multiple definition of `jouer'\nCMakeFiles/SOKOBANR.dir/main.c.o:/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:12: first defined here\n</code></pre>\n\n<p>The linker thinks that you have (at least) two definitions of <code>jouer</code>. Since both referenced locations are the same I assume that you 1. include \"jeu.c\" instead of \"jeu.h\" in your \"main.c\", and 2. link both \"main.o\" and \"jeu.o\".</p>\n\n<hr>\n\n<pre><code>/usr/bin/ld: skipping incompatible /home/mahamad/github/SOKOBAN/SOKOBAN/lib/libSDL.a when searching for -lSDL\n</code></pre>\n\n<p>The library \"libSDL.a\" you provide is not compatible to the target system. Your target system seems to be Linux.</p>\n\n<p>For which system is the library?</p>\n\n<p>Did you compile it yourself or did you download it?</p>\n\n<hr>\n\n<pre><code>CMakeFiles/SOKOBANR.dir/main.c.o: In function `jouer':\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:72: undefined reference to `deplacerJoueur'\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:76: undefined reference to `deplacerJoueur'\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:80: undefined reference to `deplacerJoueur'\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:84: undefined reference to `deplacerJoueur'\nCMakeFiles/SOKOBANR.dir/jeu.c.o: In function `jouer':\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:72: undefined reference to `deplacerJoueur'\nCMakeFiles/SOKOBANR.dir/jeu.c.o:/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:76: more undefined references to `deplacerJoueur' follow\n</code></pre>\n\n<p>There are references (calls) of <code>deplacerJoueur</code> but you don't define it. Or the source file with the definition (implementation) is not added to the list of modules.</p>\n\n<hr>\n\n<pre><code>CMakeFiles/SOKOBANR.dir/fichiers.c.o: In function `sauvegarderNiveau':\n/home/mahamad/github/SOKOBAN/SOKOBAN/fichiers.c:67: undefined reference to `fprint'\n</code></pre>\n\n<p>This is clearly a typo. You mean <code>fprintf()</code> with a trailing 'f' for sure.</p>\n\n<hr>\n\n<pre><code>collect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Because of all the errors the linker is not successful, and it tells you.</p>\n\n<hr>\n\n<pre><code>CMakeFiles/SOKOBANR.dir/build.make:128: recipe for target 'SOKOBANR' failed\n</code></pre>\n\n<p>Because of all the errors the build is not successful, and it tells you.</p>\n"}], "owner": {"reputation": 173, "user_id": 9613780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/De6o7.jpg?s=128&g=1", "display_name": "Mahamad A. Kanout&#233;", "link": "https://stackoverflow.com/users/9613780/mahamad-a-kanout%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58622237, "answer_count": 1, "score": -1, "last_activity_date": 1572427824, "creation_date": 1572407921, "question_id": 58618558, "link": "https://stackoverflow.com/questions/58618558/is-there-an-easier-way-to-compile-this-project", "title": "Is there an easier way to compile this project", "body": "<p>Under Linux(Ubuntu) I'm writing a CMakeLists.txt with CLion to compile my project which is a little game written in C. How do I fix these errors?</p>\n\n<p>Here's a <a href=\"https://easyupload.io/ybuhcv\" rel=\"nofollow noreferrer\">link</a> to the entire source code.</p>\n\n<p>Any help will be greatly appreciated  </p>\n\n<p>I have tried to rewrite my .h files. It was primarily an issue about linking SDL and  SDL_images. </p>\n\n<p>I have tried to compile the main with <code>gcc main.c -o main -lSDL -lSDL_image</code>. </p>\n\n<p>Here's the CMakeLists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.7)\n\nproject(SOKOBAN)\n\nset(CMAKE_C_STANDARD 99)\n\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11 -lmingw32\")\nset(CMAKE_EXE_LINKER_FLAGS \"-static-libgcc -static-libstdc++\")\n\ninclude_directories(${PROJECT_SOURCE_DIR}/include)\nlink_directories(${PROJECT_SOURCE_DIR}/lib)\n\nfind_package(SDL REQUIRED)\nfind_package(SDL)\nfind_package(SDL_image)\n\n\n\nset(SOURCE_FILES main.c jeu.c jeu.h editeur.c editeur.h\n        fichiers.c fichiers.h Constantes.h  hsokoban.h)\n\nadd_executable(SOKOBANR ${SOURCE_FILES})\n\ntarget_link_libraries(SOKOBANR SDL_image SDL)\n\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>[ 20%] Linking C executable SOKOBANR\nCMakeFiles/SOKOBANR.dir/jeu.c.o: In function `jouer':\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:12: multiple definition of `jouer'\nCMakeFiles/SOKOBANR.dir/main.c.o:/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:12: first defined here\n/usr/bin/ld: skipping incompatible /home/mahamad/github/SOKOBAN/SOKOBAN/lib/libSDL.a when searching for -lSDL\nCMakeFiles/SOKOBANR.dir/main.c.o: In function `jouer':\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:72: undefined reference to `deplacerJoueur'\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:76: undefined reference to `deplacerJoueur'\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:80: undefined reference to `deplacerJoueur'\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:84: undefined reference to `deplacerJoueur'\nCMakeFiles/SOKOBANR.dir/jeu.c.o: In function `jouer':\n/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:72: undefined reference to `deplacerJoueur'\nCMakeFiles/SOKOBANR.dir/jeu.c.o:/home/mahamad/github/SOKOBAN/SOKOBAN/jeu.c:76: more undefined references to `deplacerJoueur' follow\nCMakeFiles/SOKOBANR.dir/fichiers.c.o: In function `sauvegarderNiveau':\n/home/mahamad/github/SOKOBAN/SOKOBAN/fichiers.c:67: undefined reference to `fprint'\ncollect2: error: ld returned 1 exit status\nCMakeFiles/SOKOBANR.dir/build.make:128: recipe for target 'SOKOBANR' failed\nmake[3]: *** [SOKOBANR] Error 1\nCMakeFiles/Makefile2:72: recipe for target 'CMakeFiles/SOKOBANR.dir/all' failed\nmake[2]: *** [CMakeFiles/SOKOBANR.dir/all] Error 2\nCMakeFiles/Makefile2:84: recipe for target 'CMakeFiles/SOKOBANR.dir/rule' failed\nmake[1]: *** [CMakeFiles/SOKOBANR.dir/rule] Error 2\nMakefile:118: recipe for target 'SOKOBANR' failed\nmake: *** [SOKOBANR] Error 2```\n</code></pre>\n"}, {"tags": ["c", "pointers", "double-pointer"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1572404711, "post_id": 58618173, "comment_id": 103545501, "body": "Kahl,  If <code>*head-&gt;next</code> like <code>(*head)-&gt;next</code> or <code>*(head-&gt;next)</code>?"}, {"owner": {"reputation": 49, "user_id": 4385709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb243ab832e89635961fc4ea52260343?s=128&d=identicon&r=PG", "display_name": "YenBenLemon", "link": "https://stackoverflow.com/users/4385709/yenbenlemon"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572404890, "post_id": 58618173, "comment_id": 103545528, "body": "When I make head <code>Node *head = NULL;</code>, and the function call would look like <code>foo(&amp;head)</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1572406593, "post_id": 58618173, "comment_id": 103545845, "body": "According to <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/operator_precedence</a> your <code>*head-&gt;next</code> is equivalent to <code>*(head-&gt;next)</code> . I doubt it is what you mean. More like <code>(*head)-&gt;next</code> don&#39;t you?"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 12019759, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JZgqKSRmOCc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8Z-h5WL6sPHEJ3lGKmjW4tSDhcA/photo.jpg?sz=128", "display_name": "Sandeep Tadepalli", "link": "https://stackoverflow.com/users/12019759/sandeep-tadepalli"}, "is_accepted": true, "score": 2, "last_activity_date": 1572406639, "creation_date": 1572406639, "answer_id": 58618395, "question_id": 58618173, "link": "https://stackoverflow.com/questions/58618173/i-am-using-but-output-is-still-asking-me-if-i-meant-to-use/58618395#58618395", "title": "I am using &#39;-&gt;&#39; but output is still asking me if I meant to use &#39;-&gt;&#39;", "body": "<p>The line inside foo should be</p>\n\n<pre><code>     *head = (*head)-&gt;next\n</code></pre>\n\n<p>because '->' has higher precedence than *</p>\n\n<p>You can learn more about operator precedence here (<a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/operator_precedence</a>)</p>\n"}], "owner": {"reputation": 49, "user_id": 4385709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb243ab832e89635961fc4ea52260343?s=128&d=identicon&r=PG", "display_name": "YenBenLemon", "link": "https://stackoverflow.com/users/4385709/yenbenlemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58618395, "answer_count": 1, "score": 1, "last_activity_date": 1572406639, "creation_date": 1572404619, "question_id": 58618173, "link": "https://stackoverflow.com/questions/58618173/i-am-using-but-output-is-still-asking-me-if-i-meant-to-use", "title": "I am using &#39;-&gt;&#39; but output is still asking me if I meant to use &#39;-&gt;&#39;", "body": "<p>I am trying to create the functionality of a Single-Linked List in C, but I am having an issue accessing the next node of my Head node. </p>\n\n<pre><code>typedef struct node {\n  struct node *next;\n} Node;\n\nint foo(Node **head){\n  *head = *head-&gt;next;\n}\n</code></pre>\n\n<p>When I run this code, I expect it to change the address of my head node pointer to the next node over, but instead I receive the following error:</p>\n\n<pre><code>\u2018*head\u2019 is a pointer; did you mean to use \u2018-&gt;\u2019?\n     *head = *head-&gt;next;\n</code></pre>\n"}, {"tags": ["c", "linux", "data-segment"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1572403159, "post_id": 58617905, "comment_id": 103545200, "body": "Start with <code>man elf</code> - that will lead you in the right direction."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1572407168, "post_id": 58617905, "comment_id": 103545957, "body": "Check Binutils&#39; <a href=\"https://en.wikipedia.org/wiki/Binary_File_Descriptor_library\" rel=\"nofollow noreferrer\">BFD library</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3008, "user_id": 1863938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ec4e16681460302ea67bfc201b76f3?s=128&d=identicon&r=PG", "display_name": "parktomatomi", "link": "https://stackoverflow.com/users/1863938/parktomatomi"}, "is_accepted": false, "score": 0, "last_activity_date": 1572402827, "creation_date": 1572402827, "answer_id": 58617969, "question_id": 58617905, "link": "https://stackoverflow.com/questions/58617905/is-there-a-c-function-to-get-the-size-of-a-files-data-segment/58617969#58617969", "title": "Is there a C function to get the size of a file&#39;s data segment?", "body": "<p>It doesn't look like there's single function to get it, but the size source code is pretty small (~500 lines). Is what you're looking for in here?\n<a href=\"https://github.com/pathscale/binutils/blob/master/binutils/size.c\" rel=\"nofollow noreferrer\">https://github.com/pathscale/binutils/blob/master/binutils/size.c</a></p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 1, "last_activity_date": 1572406111, "creation_date": 1572406111, "answer_id": 58618343, "question_id": 58617905, "link": "https://stackoverflow.com/questions/58617905/is-there-a-c-function-to-get-the-size-of-a-files-data-segment/58618343#58618343", "title": "Is there a C function to get the size of a file&#39;s data segment?", "body": "<p>Using <code>elf.h</code> you have all the data structures you need. Follow the main ELF header to the program headers, then iterate through them. The <code>PT_LOAD</code> header(s) with write permission is/are the data segment(s).</p>\n"}], "owner": {"reputation": 161, "user_id": 5266608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c233fe30f6a002653653cd3b57f2433e?s=128&d=identicon&r=PG&f=1", "display_name": "justin", "link": "https://stackoverflow.com/users/5266608/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58618343, "answer_count": 2, "score": 0, "last_activity_date": 1572406111, "creation_date": 1572402237, "question_id": 58617905, "link": "https://stackoverflow.com/questions/58617905/is-there-a-c-function-to-get-the-size-of-a-files-data-segment", "title": "Is there a C function to get the size of a file&#39;s data segment?", "body": "<p>I'm wondering if there's a C function that can be used to get another executable file's data segment size? For example, something that works like the <code>size</code> utility in Linux? The output of <code>size</code> includes the information I'm after, the data segment size; for example, it might look like:</p>\n\n<pre><code>text    data    bss     dec     hex     filename\n294880  81920   11592   388392  5ed28   ranlib\n</code></pre>\n"}, {"tags": ["c", "stack"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1573056806, "post_id": 58617797, "comment_id": 103758805, "body": "[Added in relation to now-deleted comments about editing] You&#39;re new here William, and that&#39;s OK. You have the expectation that Stack Overflow is a chatroom or a forum, and it is neither. Stack Overflow Inc and the long-term community have struggled for years to make this clear to newcomers, and we find ourselves stuck in a daily Groundhog Day explaining this. The edits are not trivial given that technical writing is an expectation, but we understand every time a newcomer has this erroneous expectation."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1573056913, "post_id": 58617797, "comment_id": 103758870, "body": "The canonical advice about brevity <a href=\"https://meta.stackoverflow.com/questions/260776/should-i-remove-fluff-when-editing-questions/260824\">is probably this question</a>."}], "answers": [{"tags": [], "owner": {"reputation": 820, "user_id": 12062017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXiJu.jpg?s=128&g=1", "display_name": "Pickle Rick", "link": "https://stackoverflow.com/users/12062017/pickle-rick"}, "is_accepted": false, "score": 1, "last_activity_date": 1572403659, "last_edit_date": 1572403659, "creation_date": 1572402712, "answer_id": 58617958, "question_id": 58617797, "link": "https://stackoverflow.com/questions/58617797/segmentation-fault-when-reading-from-stack/58617958#58617958", "title": "Segmentation fault when reading from stack", "body": "<p>This is really confusingly written code (i.e globals with the same name as variables in the local scope). I'm just going to rewrite it, untested and on mobile but should be fine. You can diff to see the issue(s). For one thing though you're setting local variable root to the newest allocation rather than global root.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct stackNode\n{\n    char letter;\n    struct stackNode* prev;    \n};\n\nstackNode* kTailStack = NULL;\n\nvoid push(char data)\n{\n    stackNode* p=(stackNode *)malloc(sizeof(stackNode));\n    p-&gt;letter=data;\n    p-&gt;prev=kTailStack;\n    kTailStack = p;\n}\n\nchar pop()\n{\n    stackNode* prev_tail = kTailStack;\n    char n = 0;\n\n    if (prev_tail != NULL)\n    {\n        n = prev_tail-&gt;letter;\n        kTailStack = prev_tail-&gt;prev;\n        free(prev_tail);\n    }\n\n    return n;\n}\n\nint main()\n{\n    push('c', kTailStack);\n    push('v', kTailStack);\n    push('n', kTailStack);\n\n    printf(\"%c %c %c\", pop(kTailStack), pop(kTailStack), pop(kTailStack));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 169, "user_id": 11725189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ycjyq.jpg?s=128&g=1", "display_name": "William R. Ebenezer", "link": "https://stackoverflow.com/users/11725189/william-r-ebenezer"}, "edited": false, "score": 0, "creation_date": 1572410128, "post_id": 58618092, "comment_id": 103546518, "body": "The Creator is good, your answer came in just in time. You saved the day: my test went well. Thanks for such a comprehensive answer!"}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": true, "score": 1, "last_activity_date": 1572404994, "last_edit_date": 1572404994, "creation_date": 1572403930, "answer_id": 58618092, "question_id": 58617797, "link": "https://stackoverflow.com/questions/58617797/segmentation-fault-when-reading-from-stack/58618092#58618092", "title": "Segmentation fault when reading from stack", "body": "<p>The main issue is usage of unnecessary global variables which seem to be causing confusion. In <code>push</code>, the parameter is of type <code>struct stackNode *</code> yet it's being manipulated as if it referred to the global <code>root</code>. But <code>root = new</code> is purely local and has no impact on the global <code>root</code>. However, <code>size++</code> <em>does</em> impact the global scope. This corrupts the stack's logical state, and your error handler at the beginning of <code>pop</code> thinks that <code>size == 3</code> and doesn't complain. The function then dutifully dereferences <code>root</code>, crashing the program.</p>\n\n<p>A correct stack class should not use global data. It should encapsulate all necessary state in structs. This makes it reusable, enabling creation of multiple stacks (a property I'd want in most classes I'm using).</p>\n\n<p>A few other suggestions:</p>\n\n<ul>\n<li>Avoid <a href=\"https://en.wikipedia.org/wiki/Side_effect_(computer_science)\" rel=\"nofollow noreferrer\">side effects</a> where possible. Prints are OK for temporary debugging purposes but should be completely separated from program logic otherwise.</li>\n<li>If you are planning on writing error handlers, print to <code>stderr</code> and avoid magic values like <code>return '\\0';</code> that might be mistaken for actual node data.</li>\n<li><a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Don't cast the result of <code>malloc</code></a>. This can suppress errors and is visually noisy.</li>\n<li>Hardcoding <code>capacity</code> feels pretty arbitrary. I'm not sure there's any point to having this (but if there is, add it to the struct). If there's too much metadata about the stack inside each node (ideally, there should be none), create a <code>Stack</code> struct to contain this metadata and point it to the actual <code>stackNode</code> chain. </li>\n<li>Another stack design point: <code>malloc</code>/<code>free</code> are slow. For character data, a simple array with a <code>top</code> pointer will be faster and simpler to implement. You can amortize allocation calls with periodic doubling the array when <code>top &gt;= capacity</code> and contracting when <code>top &lt; capacity / 2</code>.</li>\n</ul>\n\n<p>Here's a quick re-write (without the suggestion for the <code>Stack</code> wrapper struct or the array):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct stackNode {\n    char letter;\n    struct stackNode *next;\n    int size;\n};\n\nvoid push(char data, struct stackNode **root) {\n    struct stackNode *new = malloc(sizeof(*new));\n    new-&gt;size = *root ? (*root)-&gt;size + 1 : 1;\n    new-&gt;letter = data;\n    new-&gt;next = *root;\n    *root = new;\n}\n\nchar pop(struct stackNode **root) {\n    if (!*root || !(*root)-&gt;size) {\n        fprintf(stderr, \"pop from empty stack\\n\");\n        exit(1);\n    }\n\n    char popped = (*root)-&gt;letter;\n    struct stackNode *cull = *root;\n    *root = (*root)-&gt;next;\n    free(cull);\n    return popped;\n}\n\nint main() {  \n    struct stackNode *root = NULL;\n    push('c', &amp;root);\n    push('v', &amp;root);\n    push('n', &amp;root);\n\n    while (root) {\n        printf(\"%c \", pop(&amp;root));\n    }\n\n    puts(\"\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 11725189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ycjyq.jpg?s=128&g=1", "display_name": "William R. Ebenezer", "link": "https://stackoverflow.com/users/11725189/william-r-ebenezer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 58618092, "answer_count": 2, "score": 0, "last_activity_date": 1573024133, "creation_date": 1572401341, "last_edit_date": 1573024133, "question_id": 58617797, "link": "https://stackoverflow.com/questions/58617797/segmentation-fault-when-reading-from-stack", "title": "Segmentation fault when reading from stack", "body": "<p>This is my first time creating stacks. I'm quite clear at what I must do, but am quite discouraged by the code not working.</p>\n\n<p>It runs fine till I try to retrieve any data from the root, which immediately results in a segfault.</p>\n\n<p>Here's my program:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct stackNode\n{\n    char letter;\n    struct stackNode * next;    \n};\n\nint size=0;\nint capacity=10;\n\nstruct stackNode * root=NULL;\n\nvoid push(char data, struct stackNode * root)\n{\n    if(size==capacity)\n    {\n        printf(\"Error: Stack Overflow\\n\");\n        return;\n    }\n\n    struct stackNode * new=(struct stackNode *)malloc(sizeof(struct stackNode *));\n    new-&gt;letter=data;\n    new-&gt;next=root;\n    printf(\"%c,%u\", new-&gt;letter, new-&gt;next);\n    root=new;\n    printf(\"%c,%u\", new-&gt;letter, new-&gt;next);\n    size++;\n}\n\nchar pop(struct stackNode ** root)\n{\n    if(size==0)\n    {\n        printf(\"Error: Stack is Empty\\n\");\n        return '\\0';\n    }\n\n    printf(\"\\npop*\\n\");\n\n    char temp;\n    printf(\"\\n*\\n\");\n    struct stackNode * tempad;\n    printf(\"\\n*\\n\");\n    temp=(*root)-&gt;letter;\n    printf(\"\\n*\\n\");\n    tempad=*root;\n    printf(\"\\n*\\n\");\n    *root=(*root)-&gt;next;\n    printf(\"\\n*\\n\");\n    free(tempad);\n    printf(\"\\n*\\n\");\n    size--;\n    return temp;\n}\n\nint main()\n{\n    push('c', root);\n    push('v', root);\n    push('n', root);\n\n    printf(\"%c %c %c\", pop(&amp;root), pop(&amp;root), pop(&amp;root));\n}\n</code></pre>\n\n<p>Here's the output:</p>\n\n<pre><code>pop*\n\n*\n\n*\nSegmentation fault\n</code></pre>\n\n<p>Could someone point out the mistake?</p>\n"}, {"tags": ["c++", "c", "linker"], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1572402257, "post_id": 58617794, "comment_id": 103545022, "body": "I don&#39;t think OP is static linking. By &quot;static linker&quot; they seem to just mean the link stage of building."}, {"owner": {"reputation": 21, "user_id": 10783774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xv_oPj4GTjg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hy7brPKAq4gkhWIciCzno8ofm0Dw/mo/photo.jpg?sz=128", "display_name": "newmacuser", "link": "https://stackoverflow.com/users/10783774/newmacuser"}, "edited": false, "score": 0, "creation_date": 1572404248, "post_id": 58617794, "comment_id": 103545417, "body": "Yes, I was talking about the link step that produces the binary."}], "tags": [], "owner": {"reputation": 820, "user_id": 12062017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXiJu.jpg?s=128&g=1", "display_name": "Pickle Rick", "link": "https://stackoverflow.com/users/12062017/pickle-rick"}, "is_accepted": false, "score": 0, "last_activity_date": 1572401315, "creation_date": 1572401315, "answer_id": 58617794, "question_id": 58617777, "link": "https://stackoverflow.com/questions/58617777/when-linking-a-binary-or-shared-library-why-do-i-have-to-pass-in-shared-librari/58617794#58617794", "title": "When linking a binary or shared library, why do I have to pass in shared libraries I depend on?", "body": "<p>You're confusing static and dynamic linked libraries. Dynamic libraries rely on a runtime module being loaded into memory and accesses what it needs via exported methods. Static libraries are actually embedded directly into your own binary rather than loaded separately.</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 0, "last_activity_date": 1572402370, "creation_date": 1572402370, "answer_id": 58617921, "question_id": 58617777, "link": "https://stackoverflow.com/questions/58617777/when-linking-a-binary-or-shared-library-why-do-i-have-to-pass-in-shared-librari/58617921#58617921", "title": "When linking a binary or shared library, why do I have to pass in shared libraries I depend on?", "body": "<blockquote>\n  <p>What is the static linker doing with <code>libfoo.so</code> other than putting its name into the list of shared libraries?</p>\n</blockquote>\n\n<p>For producing a dynamic-linked executable, that's basically it! It also confirms that, with the versions of the shared libraries available at link time, all undefined symbol references get defined by one of the shared libraries. This property allows you to make meaningful build-time (autoconf style) tests, e.g. to make sure <code>libfoo.so</code> is a new enough version to have the <code>bar</code> function in it.</p>\n"}], "owner": {"reputation": 21, "user_id": 10783774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xv_oPj4GTjg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hy7brPKAq4gkhWIciCzno8ofm0Dw/mo/photo.jpg?sz=128", "display_name": "newmacuser", "link": "https://stackoverflow.com/users/10783774/newmacuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1572402370, "creation_date": 1572401092, "question_id": 58617777, "link": "https://stackoverflow.com/questions/58617777/when-linking-a-binary-or-shared-library-why-do-i-have-to-pass-in-shared-librari", "title": "When linking a binary or shared library, why do I have to pass in shared libraries I depend on?", "body": "<p>Let's say I am trying to create a binary <code>myprogram</code>. <code>myprogram</code> includes a file <code>foo.h</code> which has some functions declared; those functions are defined in <code>libfoo.so</code>. Therefore, when building <code>myprogram</code>, I pass in <code>libfoo.so</code> to the linker...no, not the name \"libfoo.so\" but the actual shared library file.</p>\n\n<p>My question is, why is this necessary? My understanding is that the shared library will be needed only at runtime, when the dynamic linker will load it into memory and fix up all references to it in <code>myprogram</code>. What is the static linker doing with <code>libfoo.so</code> other than putting its name into the list of shared libraries?</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572402438, "post_id": 58617800, "comment_id": 103545053, "body": "Sorry, but I don\u2019t understand the meaning of &quot;you were writing to the memory that held the variables in main&quot;."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572402961, "post_id": 58617800, "comment_id": 103545159, "body": "@Arthasum - In C (and generally in computers), everything is either a <code>0</code> or a <code>1</code> in some <code>bit</code> located somewhere. The variables in <code>main</code> are zeros and ones somewhere in the memory (allocated on the stack). Pointers allow you to access these bits in the computers memory - assuming you know their address. In <code>main</code>, you retrieved a variable&#39;s memory address using <code>&amp;a</code>. Later, in <code>swap</code>, you accessed that variable&#39;s memory using <code>*a</code> (dereferencing the pointer)."}, {"owner": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572406240, "post_id": 58617800, "comment_id": 103545781, "body": "Sorry, but where is the difference between code one and code two?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572429231, "post_id": 58617800, "comment_id": 103553331, "body": "The difference is in the dereferencing operator <code>*</code>... it looks something like this (to clarify I use the same variable name and operation): <code>*p = *p + 1</code> vs <code>p = p + 1</code>"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572465265, "post_id": 58617800, "comment_id": 103572528, "body": "I got downvoted because...?"}, {"owner": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572505543, "post_id": 58617800, "comment_id": 103582675, "body": "I don&#39;t know, that&#39;s not what I did."}, {"owner": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572505921, "post_id": 58617800, "comment_id": 103582788, "body": "I understand now, thank you."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "edited": false, "score": 0, "creation_date": 1572649714, "post_id": 58617800, "comment_id": 103636575, "body": "@Arthasum  - if my answer helped at all, feel free to upvote or accept the answer."}, {"owner": {"reputation": 4597, "user_id": 6689725, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qsOMmN7fB4g/AAAAAAAAAAI/AAAAAAAAAEI/vTvjt2dZck4/photo.jpg?sz=128", "display_name": "Z4-tier", "link": "https://stackoverflow.com/users/6689725/z4-tier"}, "edited": false, "score": 0, "creation_date": 1572662034, "post_id": 58617800, "comment_id": 103638455, "body": "upvoted...not sure why you got downvoted, since this is perfectly reasonable. (maybe it was the grammar police; some things just have the <i>wrong effect</i> on those people...)"}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": true, "score": 0, "last_activity_date": 1572401369, "creation_date": 1572401369, "answer_id": 58617800, "question_id": 58617713, "link": "https://stackoverflow.com/questions/58617713/questions-about-pointers-in-c-language-functions/58617800#58617800", "title": "Questions about pointers in C language functions", "body": "<p>Variables in C have a value (content) and they have a memory address (location) - the address may be optimized away by the compiler when not in use.</p>\n\n<p>C passes arguments to functions by value (always), so the arguments (variables) in the function occupy a different memory location (even if they are initialized with the same value).</p>\n\n<p>The value of the pointer can be manipulated (<code>p++</code>), effecting its data (changing the location to which <code>p</code> is pointing).</p>\n\n<p>Pointers can also be dereferenced (<code>*p</code>), effecting the data in the location they point to.</p>\n\n<p>In the function <code>test(int* p)</code>, the argument <code>p</code> is placed in the scope of the function. It can't accessed by other functions and it isn't available outside of the function (unless it's location is known by someone else, then they can access it).</p>\n\n<p>When you edit the content of the <code>p</code> variable, it only effects the value of <code>p</code> within the function - it changes the location to which <code>p</code> is pointing.</p>\n\n<p>However, when you <strong>dereference</strong> the value of <code>p</code>, you read / write to the location to which <code>p</code> is pointing (the location in the memory that holds the variable in <code>main</code>).</p>\n\n<p>This is why the <code>p++</code> in <code>test</code> doesn't effect the value in <code>main</code>.</p>\n\n<p>On the other hand, in the <code>swap</code> function, you were writing to the memory that held the variables in <code>main</code>, which has side effects in <code>main</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 12254997, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAdpGiwiYXUPVn7huWRT7wAkAuIIj0ESCi6Yps7=k-s128", "display_name": "Wayne", "link": "https://stackoverflow.com/users/12254997/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1572420572, "accepted_answer_id": 58617800, "answer_count": 1, "score": 0, "last_activity_date": 1572420635, "creation_date": 1572400443, "question_id": 58617713, "link": "https://stackoverflow.com/questions/58617713/questions-about-pointers-in-c-language-functions", "closed_reason": "Duplicate", "title": "Questions about pointers in C language functions", "body": "<p>Under what circumstances, the pointer in the C language function will change after the function is executed, and under what circumstances will not change.</p>\n\n<p>I am learning pointers now, but I am having some trouble now.</p>\n\n<p>The first code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid test(int* p);\n\nint main()\n{\n    int a[] = {2, 4, 6, 8, 0};\n    int* p = a;\n\n    printf(\"before p = %p, *p = %d\\n\", p, *p);\n    test(p);\n    printf(\"after p = %p, *p = %d\\n\", p, *p);\n\n    system(\"pause\");\n    return 0;\n}\n\nvoid test(int* p)\n{\n    p++;\n    printf(\"In test p = %p, *p = %d\\n\", p, *p);\n}\n</code></pre>\n\n<p>The second code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid swap (int* a, int* b);\nint main()\n{\n    int a, b;\n\n    scanf(\"%d %d\", &amp;a, &amp;b);\n    swap(&amp;a, &amp;b);\n    printf(\"%d %d\\n\", a, b);\n\n    system(\"pause\");\n    return 0;\n}\n\nvoid swap (int* a, int* b)\n{\n    int t;\n    t = *a;\n    *a = *b;\n    *b = t;\n}\n</code></pre>\n\n<p>I want to know why p has not changed in the first program after the execution of the function, and the second program a, b has changed.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572404003, "post_id": 58617610, "comment_id": 103545374, "body": "When <code>scanf(&quot; %d&quot;, &amp;num)</code> returns 0, read a single character."}], "answers": [{"tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 0, "last_activity_date": 1572400064, "creation_date": 1572400064, "answer_id": 58617680, "question_id": 58617610, "link": "https://stackoverflow.com/questions/58617610/terminate-scanf-on-eof-and-ignore-strings/58617680#58617680", "title": "Terminate scanf on EOF and ignore strings", "body": "<p><code>scanf()</code> returns the number of input items successfully assigned. That is, in your example, <code>1</code> if a number is entered, or <code>0</code> otherwise. (Unless an input error occurs prior to the first input item, in which case it returns <code>EOF</code>.)</p>\n\n<p>In case a string is entered, this fails to match <code>%d</code>, <code>scanf()</code> returns zero, the loop is entered, <code>\"Do something\"</code> is printed, and <code>scanf()</code> is called again.</p>\n\n<p><em>But the string has not been consumed by any input function.</em></p>\n\n<p>So the string fails to match, <code>\"Do something\"</code> is printed... you get the idea.</p>\n\n<p>Be happy you do not access <code>num</code>, because if you haven't initialized that beforehand, accessing it would be undefined behaviour (as it <em>still</em> isn't initialized)...</p>\n\n<p>Generally speaking, do not use <code>scanf()</code> on potentially malformed (user) input. By preference, read whole lines of user input with <code>fgets()</code> and then parse them in-memory with e.g. <code>strtol()</code>, <code>strtof()</code>, <code>strtok()</code> or whatever is appropriate -- this allows you to backtrack, identify exactly the point where the input failed to meet your expectations, and print meaningful error messages including the full input.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1572404098, "creation_date": 1572404098, "answer_id": 58618112, "question_id": 58617610, "link": "https://stackoverflow.com/questions/58617610/terminate-scanf-on-eof-and-ignore-strings/58618112#58618112", "title": "Terminate scanf on EOF and ignore strings", "body": "<blockquote>\n  <p>How can I stop the loop only when End of line occurs, but ignore string inputs and only perform my logic if integer inputs have occured?</p>\n</blockquote>\n\n<p>When <code>scanf(\" %d\", &amp;num)</code> returns 0, read a single character and toss it.</p>\n\n<pre><code>int count;\nwhile ((count = scanf(\"%d\", &amp;num)) != EOF) {\n  if (count &gt; 0) printf(\"Do something with %d\\n\", num);\n  else getchar();\n}\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 11181461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76327eb1fe7cd4a638b1776a77858d2c?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/11181461/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572404098, "creation_date": 1572399369, "question_id": 58617610, "link": "https://stackoverflow.com/questions/58617610/terminate-scanf-on-eof-and-ignore-strings", "title": "Terminate scanf on EOF and ignore strings", "body": "<p>I am using the following code to scan for integers input from the user until end of line occurs. </p>\n\n<pre><code>while (scanf(\" %d\", &amp;num) != EOF) {\n   printf(\"Do something\")\n}\n</code></pre>\n\n<p>This works as expected until the user inputs a string instead of an integer. The program would then endlessly keep printing <code>Do something</code>. Why is that happening? </p>\n\n<p>How can I stop the loop only when End of line occurs, but ignore string inputs and only perform my logic if integer inputs have occured?</p>\n"}, {"tags": ["c", "assign", "infinity"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1572398650, "post_id": 58617476, "comment_id": 103544331, "body": "There is no integer representation for infinity.  If you want the most negative possible signed integer, use <code>INT_MIN</code> from <code>&lt;stdint.h&gt;</code>."}, {"owner": {"reputation": 3, "user_id": 12294429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d045c24492f1ccfd7a81a2cb83174676?s=128&d=identicon&r=PG&f=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/12294429/murphy"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1572399086, "post_id": 58617476, "comment_id": 103544411, "body": "oh thank you, can you explain more or make a sample for me ?"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1572400665, "post_id": 58617476, "comment_id": 103544713, "body": "Ummm... <code>first = second = INT_MIN;</code>"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1572401838, "post_id": 58617476, "comment_id": 103544930, "body": "Th title of the question has nothing to do with its content... I updated the title."}, {"owner": {"reputation": 3, "user_id": 12294429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d045c24492f1ccfd7a81a2cb83174676?s=128&d=identicon&r=PG&f=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/12294429/murphy"}, "edited": false, "score": 0, "creation_date": 1572404528, "post_id": 58617476, "comment_id": 103545468, "body": "yeah it has extra functions, i am gonna try it"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1572426332, "post_id": 58617476, "comment_id": 103551734, "body": "@Myst How does the title now connect to the content? I don&#39;t see any pointers there."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1572429533, "post_id": 58617476, "comment_id": 103553507, "body": "@thebusybee - I don&#39;t know what happened... I updated the title again."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1572429734, "post_id": 58617476, "comment_id": 103553621, "body": "<code>second</code> is uninitialized when used for the first time."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1572429968, "post_id": 58617476, "comment_id": 103553748, "body": "@Myst: Great, now it&#39;s clear. --- Concerning your comment: More exactly: it is read unitialized if the first <code>if</code> is <code>false</code> on the first loop run. You should make this an answer. ;-)"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1572435761, "post_id": 58617476, "comment_id": 103556829, "body": "@thebusybee true :) ... I just noticed JeremyP posted an answer, so I&#39;ll move on."}], "answers": [{"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 0, "last_activity_date": 1572430188, "creation_date": 1572430188, "answer_id": 58622971, "question_id": 58617476, "link": "https://stackoverflow.com/questions/58617476/calculating-min-max-from-the-terminal-in-c/58622971#58622971", "title": "Calculating min/max from the terminal in C", "body": "<p>There are two problems:</p>\n\n<ul>\n<li><code>first</code> starts out as <code>0</code>. If <code>number</code> is negative, <code>if (number &gt; first)</code> is false. </li>\n<li><code>second</code> is used uninitialised if <code>number &lt;= first</code>.</li>\n</ul>\n\n<p>Use <code>INT_MIN</code> for your initial values, this is the most negative integer you can have. Use this declaration</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main()\n{\n    int number = 0, first = INT_MIN, second = INT_MIN, numbercounter = 0;\n</code></pre>\n\n<p>Also get rid of the line </p>\n\n<pre><code>    first = number;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12294429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d045c24492f1ccfd7a81a2cb83174676?s=128&d=identicon&r=PG&f=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/12294429/murphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 58622971, "answer_count": 1, "score": 0, "last_activity_date": 1572430188, "creation_date": 1572397924, "last_edit_date": 1572429509, "question_id": 58617476, "link": "https://stackoverflow.com/questions/58617476/calculating-min-max-from-the-terminal-in-c", "title": "Calculating min/max from the terminal in C", "body": "<p>i want to create a program which prints biggest first number and biggest second number when i enter 5 number.(1.value of the number is=0) .there is no problem when i enter 5 numbers bigger than 0, but when i enter 5 numbers smaller than 0 , program prints first biggest number is 0 and second biggest number is 1. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int number = 0, first, second, numbercounter = 0;\n    first = number;\n\n    while (numbercounter &lt; 5) {\n        printf(\"5 tamsayi girin:\", ++numbercounter);\n        scanf(\"%d\", &amp;number);\n\n        if (number &gt; first) {\n            second = first;\n            first = number;\n        } else if (number &gt; second)\n            second=number;\n    }\n\n    printf(\"En buyuk sayi: %d \\n\", first);\n    printf(\"En buyuk ikinci sayi:%d \\n\", second);\n\n    if (first % second == 0) {\n        printf(\"%d, %d'nin tam katidir.\\n\", first, second);\n    } else {\n        printf(\"%d, %d'nin tam kati degildir.\\n\", first, second);\n    }\n\n    if (first == second) {\n        printf(\"%d ve % esittir.\\n\", first, second);\n    } else {\n        printf(\"%d ve %d esit degildir.\\n\", first, second);\n    }\n    if (first % 2 != 0) {\n        printf(\"%d tektir.\\n\", first);\n    } else {\n        printf(\"%d cifttir.\\n\", first);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "filesystems", "system-calls", "ls"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1572395576, "post_id": 58617161, "comment_id": 103543770, "body": "You&#39;re asking too early. Read the man pages for those functions, see how to use them and write some code, then come here if you encounter any problem and explain what precisely is the issue you are facing. This question is unfortunately both off topic and too broad."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1572398282, "post_id": 58617161, "comment_id": 103544260, "body": "<i>&quot;I am having trouble getting started&quot;</i>.   I suggest you start with <code>int main(void) { return 0; }</code>, since you don&#39;t even seem to have that much yet."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11397079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b631a93636ef59930e35a1c5b21b889?s=128&d=identicon&r=PG&f=1", "display_name": "hbrown", "link": "https://stackoverflow.com/users/11397079/hbrown"}, "edited": false, "score": 0, "creation_date": 1572440694, "post_id": 58617353, "comment_id": 103559599, "body": "This is a huge help. I am on the right track now, thanks."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1572457783, "last_edit_date": 1572457783, "creation_date": 1572396855, "answer_id": 58617353, "question_id": 58617161, "link": "https://stackoverflow.com/questions/58617161/c-program-to-write-the-contents-of-a-directory/58617353#58617353", "title": "C Program to write the contents of a directory", "body": "<p>Work backward from the output, field by field:</p>\n\n<pre><code>-rw-r--r--   1 kaz  kaz       3573 2018-06-07 13:59 .bashrc\n</code></pre>\n\n<p>The name <code>.bashrc</code> comes from the <code>readdir</code> traversal.</p>\n\n<p>Everything other than the name comes from the <code>lstat</code> system call invoked on the name.</p>\n\n<p>The <code>-rw...</code> type and flags representation comes from <code>st_mode</code> which you have to decode into that form. There are access macros that can help like like <code>S_ISDIR(mode)</code> for testing whether it's a directory or <code>(mode &amp; S_IXUSR) != 0</code> for testing whether it's executable by the owner.  The <code>1</code> is the link count, <code>st_nlink</code>. The <code>kaz</code> and <code>kaz</code> are user and group ID's, converted to text using (for instance) <code>getpwuid</code> to obtain a <code>struct passwd *</code>, and <code>getgrgid</code> to get a <code>struct group *</code> which have name fields.  The <code>3753</code> is <code>st_size</code>.  The date output can be obtained by formatting <code>st_mtime</code> using the <code>strftime</code> function.</p>\n\n<p>Formatting into padded columns can be done using <code>printf</code> or <code>sprintf</code>, like: <code>printf(\"&lt;%-50s&gt;\", \"this-is-left-aligned-in-50-col-field\")</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11397079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b631a93636ef59930e35a1c5b21b889?s=128&d=identicon&r=PG&f=1", "display_name": "hbrown", "link": "https://stackoverflow.com/users/11397079/hbrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572457783, "creation_date": 1572395231, "question_id": 58617161, "link": "https://stackoverflow.com/questions/58617161/c-program-to-write-the-contents-of-a-directory", "title": "C Program to write the contents of a directory", "body": "<p>I need to write a simplified version of the ls program in C. It is going to list all of the contents of the current directory. When ran, it should display the same output as this command:</p>\n\n<pre><code>ls -alU --time-style=long-iso\n</code></pre>\n\n<p>No arguments are provided to the program. I am having trouble getting started, but I do know I am going to have to make some system calls such as, opendir(), readdir(), lstat(), and getpwuid(). Any help in getting me off the ground and into it is greatly appreciated. I also really want to understand this. Thanks!</p>\n"}, {"tags": ["c", "char", "decimal", "bit", "base"], "comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 1, "creation_date": 1572395743, "post_id": 58617154, "comment_id": 103543805, "body": "In <code>reVal</code> your <code>if</code> tests are using <code>=</code> instead of <code>==</code>: the latter is an equality test, the former is <i>assignment</i> and is surely not what you want."}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "reply_to_user": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1572395916, "post_id": 58617154, "comment_id": 103543835, "body": "@SteveFriedl alright, I fixed that, but I am still receiving the same error that I had previously with my return statement, res."}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572396245, "post_id": 58617274, "comment_id": 103543904, "body": "can I call the char *outbuf out locally instead in the parameters? Will that work too?"}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572396605, "post_id": 58617274, "comment_id": 103543976, "body": "I did it within the method. I called it out there. I now receive a warning with the malloc saying  warning: &quot; incompatible implicit declaration of built-in function \u2018malloc\u2019 &quot;"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572396688, "post_id": 58617274, "comment_id": 103543991, "body": "I updated my answer to show how you&#39;d use it with <code>outbuf</code>; you really really should not use <code>malloc</code> because it&#39;s memory you have to keep track of, and it&#39;s far better to just pass the buffer as the updated code shows."}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572396930, "post_id": 58617274, "comment_id": 103544041, "body": "Alright, well it got rid of that warning. My only problem now is I receive a segmentation fault when I run the code. Also, in the main, you have it as a char but not a char *, even though the method has it like that. Is there an explanation with that? I struggle with Char pointers personally."}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572396968, "post_id": 58617274, "comment_id": 103544047, "body": "Oh I also declared it inside the method and not in the parameters. Is that fine?"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572397174, "post_id": 58617274, "comment_id": 103544084, "body": "If you&#39;re not using the code as shown, there&#39;s a fair chance you&#39;re going down the wrong road: declared <i>what</i> inside the method?  Pointers are always tricky and there&#39;s a certain learning curve for sure. When you pass the <code>decbuf</code> array to the function, it&#39;s not actually giving the whole array, but just a pointer to the start of that array - this is intentional."}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572397260, "post_id": 58617274, "comment_id": 103544094, "body": "I declared decbuf inside the function decToBase. Would that affect anything? It shouldn&#39;t though right?"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572397474, "post_id": 58617274, "comment_id": 103544121, "body": "Is there some reason you&#39;re not declaring it in main as has been offered?  Also: please look carefully at <code>strev()</code> and make sure it works correctly for strings of even length and of odd lengths, it doesn&#39;t look right."}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572397514, "post_id": 58617274, "comment_id": 103544130, "body": "I just want to see if I can try it without it being declared in the main. For a project."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "reply_to_user": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572397551, "post_id": 58617274, "comment_id": 103544137, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/201574/discussion-between-steve-friedl-and-adan-vivero\">continue this discussion in chat</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572465267, "post_id": 58617274, "comment_id": 103572529, "body": "<code>decToBase(16, 0, decbuf);</code> --&gt; <code>&quot;&quot;</code> rather than <code>&quot;0&quot;</code>."}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572465465, "post_id": 58617274, "comment_id": 103572615, "body": "Well I was able to malloc it with the #include &lt;stdlib.h&gt; on the top."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1572466062, "post_id": 58617274, "comment_id": 103572839, "body": "Use of <code>malloc()</code> was a terrible idea in this case; I hope nobody consults this for an example"}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572471535, "post_id": 58617274, "comment_id": 103574947, "body": "@SteveFriedl but it worked. What issues will it cause if I use it?"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 1, "creation_date": 1572471641, "post_id": 58617274, "comment_id": 103574981, "body": "It &quot;worked&quot; but it leaked memory; it&#39;s just a bad practice, especially if you&#39;re learning. This is why I was trying to steer you down the other road with a caller-provided buffer."}, {"owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "edited": false, "score": 0, "creation_date": 1572485449, "post_id": 58617274, "comment_id": 103578320, "body": "@SteveFriedl Makes sense, but I was wondering if there were a way I could do it without having it in the parameter. Also, can&#39;t I free my memory?"}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1572486198, "post_id": 58617274, "comment_id": 103578471, "body": "This is a fair question, but in the end you have to take to heart the limitations of C: it&#39;s not a memory-managed language, and you have to <i>either</i> pass the output buffer as a parameter <i>or</i> deal with the consequences of memory management.  In my mind, this is a slam dunk: pass the output buffer to the function and tell it &quot;put my stuff here&quot;.  This is how most of the C library is evolving, and it&#39;s just how it is.   Is there a non-aesthetic reason you&#39;d prefer not to do it this way?"}], "tags": [], "owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "is_accepted": true, "score": 1, "last_activity_date": 1572397214, "last_edit_date": 1572397214, "creation_date": 1572396096, "answer_id": 58617274, "question_id": 58617154, "link": "https://stackoverflow.com/questions/58617154/error-with-my-dectobase-method-in-c-with-a-return/58617274#58617274", "title": "Error with my decToBase method in C with a return", "body": "<p>In your <code>decToBase()</code> function, the issue it's warning about is the use of <code>char res[500];</code>, which is an array that's allocated on the stack as a local variable. These are all thrown away when the function returns, so if you return a pointer to (or: the address of) the <code>res</code> array, this pointer points to junk on the stack.</p>\n\n<p>You have to find some other way to manage this allocation, and though some might suggest using <code>malloc()</code> to allocate memory from the system, this is probably a bad idea because it's asking for problems with memory leaks.</p>\n\n<p>Better is to pass in the buffer you want it to fill, and use that. Then the <em>caller</em> does the allocation and you don't worry about memory leaks.</p>\n\n<pre><code>char *decToBase(int base, int dec, char *outbuf)\n{\nint index = 0; // Initialize index of result \n               // Convert input number is given base by repeatedly \n               // dividing it by base and taking remainder \n   while (dec &gt; 0)\n   {\n      outbuf[index++] = reVal(dec % base);\n      dec /= base;\n   }\n\n   outbuf[index] = '\\0';\n   // Reverse the result \n   strev(outbuf);\n   return outbuf;\n}\n</code></pre>\n\n<p>and then your <code>main</code> function would look like:</p>\n\n<pre><code>int main()\n{\n   char decbuf[500];\n\n   decToBase(16, 248, decbuf);\n   printf(\"Buffer is %s\\n\", decbuf);\n}\n</code></pre>\n\n<p>This is still not super ideal, because your <code>decToBase()</code> function doesn't know how big <code>outbuf</code> is, and overflows are possible, so the experience and/or paranoid programmer will also pass in the size of outbuf so your function knows how much to use.</p>\n\n<p>But that's a step you'll get to later.</p>\n"}], "owner": {"reputation": 393, "user_id": 10572727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bnMJo.jpg?s=128&g=1", "display_name": "Adan Vivero", "link": "https://stackoverflow.com/users/10572727/adan-vivero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 58617274, "answer_count": 1, "score": -1, "last_activity_date": 1572397214, "creation_date": 1572395171, "last_edit_date": 1572395561, "question_id": 58617154, "link": "https://stackoverflow.com/questions/58617154/error-with-my-dectobase-method-in-c-with-a-return", "title": "Error with my decToBase method in C with a return", "body": "<p>I am working on a method in C where I am trying to convert a decimal to its base. I am having trouble with returning a Char*. I still am unsure how to return a pointer. When I compile this code, I get a warning saying </p>\n\n<p>\"warning: function returns address of local variable [-Wreturn-local-addr]\".\nand it has to do with my res character. I am uncertain with why I cannot return res, if it's a char. I don't understand what I am suppose to return if I can't return res. Please help. </p>\n\n<pre><code> //return res;\n\n\nchar reVal(int num)\n{\n if (num &gt;= 0 &amp;&amp; num &lt;= 9)\n return (char)(num + '0');\n else if(num = 10)\n {\n return (char)(num - 10 + 'A');\n }\n else if(num = 11)\n {\n return (char)(num - 11 + 'B');\n }\n else if(num = 12)\n {\n return (char)(num - 12 + 'C');\n }\n else if(num = 13)\n {\n return (char)(num - 13 + 'D');\n }\n else if(num = 14)\n {\n return (char)(num - 14 + 'E');\n }\n else if(num = 15)\n {\n return (char)(num - 15 + 'F');\n }\n}\n\n\n// Utility function to reverse a string \nvoid strev(char *str)\n{\n  int len = strlen(str);\n  int i;\n  for (i = 0; i &lt; len/2; i++)\n  {\n     char temp = str[i];\n     str[i] = str[len-i-1];\n     str[len-i-1] = temp;\n  }\n}\n\nchar* decToBase(int base, int dec)\n{\nint index = 0; // Initialize index of result \nchar res[100]; // Convert input number is given base by repeatedly \n               // dividing it by base and taking remainder \nwhile (dec &gt; 0)\n{\n    res[index++] = reVal(dec % base);\n    dec /= base;\n}\n\nres[index] = '\\0';\n// Reverse the result \nstrev(res);\nreturn res;\n\nint main()\n{\n    char* base = decToBase(16, 248);\n}\n</code></pre>\n\n<p>Regardless, the outcome I want is to have the method return \"f8\" as the outcome. </p>\n"}, {"tags": ["c", "pointers"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12294261, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l9phRAS-6kE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddrDjUjg15WUBBlLYg6-RR2VPZZQ/photo.jpg?sz=128", "display_name": "user12294261", "link": "https://stackoverflow.com/users/12294261/user12294261"}, "edited": false, "score": 0, "creation_date": 1572449044, "post_id": 58619145, "comment_id": 103564669, "body": "I need to use the pointer notations in scanf. and in my input I use 1 or something like that"}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1572412552, "creation_date": 1572412552, "answer_id": 58619145, "question_id": 58617049, "link": "https://stackoverflow.com/questions/58617049/my-code-stops-running-after-it-takes-first-input-of-scanf/58619145#58619145", "title": "My code stops running after it takes first input of scanf", "body": "<p>The question does not specify the input. Most likely, it's something like '1.2 3.4' (or similar, may be with new line between the numbers).</p>\n\n<p>Since the code is using '%f' to read each number, it will fail to skip over the space/newline (or whatever other separators exists). Consider adding leading ' ' to the scanf format to allow skipping over white spaces.</p>\n\n<pre><code>scanf(\" %f\", &amp;a[i][j]).\n</code></pre>\n\n<p>No need to do pointer math - let the compiler do the hard job.</p>\n\n<p>Side note, you want to add a check on scanf return code. If it's not 1, you want to exit, as this indicate EOF, or other parsing errors.  Currently, the code does not have have any recovery/error handling, better to fail fast.</p>\n"}], "owner": {"reputation": 1, "user_id": 12294261, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l9phRAS-6kE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddrDjUjg15WUBBlLYg6-RR2VPZZQ/photo.jpg?sz=128", "display_name": "user12294261", "link": "https://stackoverflow.com/users/12294261/user12294261"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572412552, "creation_date": 1572394142, "question_id": 58617049, "link": "https://stackoverflow.com/questions/58617049/my-code-stops-running-after-it-takes-first-input-of-scanf", "title": "My code stops running after it takes first input of scanf", "body": "<p>I have to write a code using ONLY 2D pointers, and it should include functions to allocate: a 1D array, an array of arrays, and a 2D array. However in a function to read the arrays, it stops after first input of scanf  </p>\n\n<p>In the function \"info\" (where the problem is) I tried changing it to ((A+i)+j), (*(A+I)+j) and <em>(</em>(A+i)+j). None worked.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;malloc.h&gt;\n.\n.\n.\nvoid allocate1(float *A, int N)\n  {\n    A=(float*)malloc(N*sizeof(float*));\n  }\nvoid allocate2(float **A, int N)\n   {\n     A=(float**)malloc(N*sizeof(float**));\n   }\nvoid allocate(float **A, int M, int N)\n   {\n      int i;\n      allocate2(A,M);\n      for(i=0;i&lt;M;i++)\n      allocate1(*(A+i),N);\n   }\n  void info(float **A, int N, int M)\n    {\n      int i,j;\n      for(i=0;i&lt;M;i++)\n      for(j=0;j&lt;N;j++)\n       {\n         printf(\"input element (%d,%d)\\n\", i+1,j+1);\n         scanf(\"%f\",(*(A+i)+j));\n       }\n     }\n     .\n     .\n     .\n     void main()\n      {\n        float **A,**B,**C;\n         int N,M,P,D;\n        do\n          {\n            M=read();\n            N=read();\n            D=read();\n            P=read();\n          }while(D!=N);\n         allocate(A,M,N);\n         allocate(B,N,P);\n         info(A,N,M);\n       .\n       .\n</code></pre>\n"}, {"tags": ["c", "sorting", "clion"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1572393793, "post_id": 58616934, "comment_id": 103543386, "body": "Review <code>free(newabcorder);     return *newabcorder;</code>  Code is errantly using <code>newabcorde</code> after <code>free()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572393862, "post_id": 58616934, "comment_id": 103543403, "body": "Kiera White, &quot; and returns a pointer to this sorted array of characters.&quot; .  Code return a <code>char</code>, not a pointer.  What is the goal here?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572393927, "post_id": 58616934, "comment_id": 103543413, "body": "&quot;the only thing it prints is  ....&quot; --&gt; code does no printing.  Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1572394997, "post_id": 58616934, "comment_id": 103543622, "body": "You could probably choose better names than <code>throwaway</code>, <code>anotherthrowaway</code>, <code>characters</code> etc. for your variables... just saying."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 12294274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5a960f5aed4f34819e272340e9e7c0?s=128&d=identicon&r=PG&f=1", "display_name": "Kiera White", "link": "https://stackoverflow.com/users/12294274/kiera-white"}, "edited": false, "score": 0, "creation_date": 1572406827, "post_id": 58617197, "comment_id": 103545896, "body": "Thanks! For the cutting out spaces part, should I turn the fgets in main to scanf or fscanf? So far I put     for (i = 0; throwaway[i] != &#39;\\0&#39;;i++)     {         if (throwaway[i] == &#39; &#39;)         {             continue;         }         throwaway[j++] = throwaway[i];     } into the function after the initilization of those things, but it didnt like that :("}], "tags": [], "owner": {"reputation": 61, "user_id": 10940779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec2991d4303367e10feb4a548302d6?s=128&d=identicon&r=PG&f=1", "display_name": "Spanching", "link": "https://stackoverflow.com/users/10940779/spanching"}, "is_accepted": false, "score": 0, "last_activity_date": 1572395513, "creation_date": 1572395513, "answer_id": 58617197, "question_id": 58616934, "link": "https://stackoverflow.com/questions/58616934/how-to-alphabetize-a-string-and-return-a-pointer-to-the-sorted-array-of-characte/58617197#58617197", "title": "How to alphabetize a string and return a pointer to the sorted array of characters?", "body": "<p>there are multiple issues on your code:</p>\n\n<ul>\n<li>throwaway = characters does <strong>not</strong> copy your string, with the equal sign it is the same pointer (both are the same in the memory of your pc, threrfore you can not just edit one of them) for copying char pointers you have to use strcpy(dest, src) </li>\n<li>you return a char and your text says you want to return a string (char*)</li>\n<li>I don't know what you want to print out, but as you only have one line with print function, this should be clear..</li>\n<li>Don't free your pointer if you want to return it, but free all the others</li>\n</ul>\n\n<p>As you should learn something I wrote a basis from your on which you can build up. Maybe it is not the most elegant way, but I am sure it's the best way for you to find your mistakes.</p>\n\n<p>The sorting should work but you should not return a value, but store it in the char* you got as parameter. </p>\n\n<p>In addition you still have to do the sorting out of punktuation and spaces.</p>\n\n<p>Here is the basis:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *sortString(char *characters)\n{\n    int i = 0;\n    int j = 0;\n    char anotherthrowaway;\n\n    int lengthofstring = strlen(characters);\n\n    char * newabcorder = (char *)malloc(lengthofstring + 1);\n    memset(newabcorder, '\\0', lengthofstring+1);\n\n    char * throwaway = (char *)malloc(lengthofstring + 1);\n\n    strcpy(throwaway, characters);\n\n    for (anotherthrowaway = 'a'; anotherthrowaway &lt;= 'z'; anotherthrowaway++)\n    {\n        for (i = 0; i &lt; lengthofstring; i++)\n        {\n            if (*(throwaway+i) == anotherthrowaway)\n            {\n                *(newabcorder + j) = anotherthrowaway;\n                j++;\n            }\n        }\n    }\n    free(throwaway);\n    return newabcorder;\n}\n\nint main(){\n    printf(\"%s\\n\", sortString(\"bcdajktzy\"));\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 363, "user_id": 12107182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf3FT.jpg?s=128&g=1", "display_name": "ValeriF21", "link": "https://stackoverflow.com/users/12107182/valerif21"}, "is_accepted": false, "score": 0, "last_activity_date": 1572395915, "creation_date": 1572395915, "answer_id": 58617258, "question_id": 58616934, "link": "https://stackoverflow.com/questions/58616934/how-to-alphabetize-a-string-and-return-a-pointer-to-the-sorted-array-of-characte/58617258#58617258", "title": "How to alphabetize a string and return a pointer to the sorted array of characters?", "body": "<p>First, you wrote that the function must return a pointer value but your return type is just char, change it to <strong>char* sortString</strong>.</p>\n\n<p>Second you freeing the memory before you return it, means you returning nothing, delete this line. you need to declare a pointer variable in the main func that receive the abcorder from sortString and this is the variable you sould free in the end of the program.</p>\n\n<p>Third you need to return the address of the pointer and not a pointer variable, change it from *newabcorder to <strong>return newabcorder</strong>.</p>\n\n<p>Fixed Function:</p>\n\n<pre><code>char* sortString(char *characters) {\nint i = 0;\nint j = 0;\nint lengthofstring;\nchar *throwaway;\nchar *newabcorder;\nchar anotherthrowaway;\n\nlengthofstring = strlen(characters);\n\nnewabcorder = (char*)malloc(lengthofstring + 1);\n\nprintf(\"Enter a string you want alphabetized: \\n\");\n\nthrowaway = characters;\n\nfor (anotherthrowaway = 'a'; anotherthrowaway &lt;= 'z'; anotherthrowaway++) {\n    for (i = 0; i &lt; lengthofstring; i++) {\n        if (*throwaway == anotherthrowaway) {\n            *(newabcorder + j) = *throwaway;\n            j++;\n        }\n        throwaway++;\n    }\n    throwaway = characters;\n}\n*(newabcorder + j) = '\\0';\n\nstrcpy(characters, newabcorder);\nreturn newabcorder;\n}\n</code></pre>\n\n<p>and main function:</p>\n\n<pre><code>int main() {\nchar str[50], *ptr;\nfgets(str, 49, stdin);\nptr = sortString(str);\nprintf(\"%s \\n\", ptr);\nfree(ptr);\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12294274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5a960f5aed4f34819e272340e9e7c0?s=128&d=identicon&r=PG&f=1", "display_name": "Kiera White", "link": "https://stackoverflow.com/users/12294274/kiera-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572395915, "creation_date": 1572393193, "last_edit_date": 1572393611, "question_id": 58616934, "link": "https://stackoverflow.com/questions/58616934/how-to-alphabetize-a-string-and-return-a-pointer-to-the-sorted-array-of-characte", "title": "How to alphabetize a string and return a pointer to the sorted array of characters?", "body": "<p>The problem to be specific I'm working on is \"Define a function called sortString that expects an array of characters array and returns a pointer to an array of characters.  The function sorts the characters in the string in alphabetic order, stores them in this order, and returns a pointer to this sorted array of characters.The character array may contain spaces and punctuation. When sorting, spaces and punctuation should be ignored and all alphabetic characters should be changed to lowercase for sorting and output.\"</p>\n\n<p>I'm in CLion and attempted the code, but when I run it, the only thing it prints is enter a string you want alphabetized. What could be the problem? I have my code copied below.</p>\n\n<pre><code>char sortString(char *characters) {\n    int i = 0;\n    int j = 0;\n    int lengthofstring;\n    char *throwaway;\n    char *newabcorder;\n    char anotherthrowaway;\n\n    lengthofstring = strlen(characters);\n\n    newabcorder = (char*)malloc(lengthofstring+1);\n\n    printf(\"Enter a string you want alphabetized: \\n\");\n\n    throwaway = characters;\n\n    for ( anotherthrowaway = 'a' ; anotherthrowaway &lt;= 'z' ; anotherthrowaway++ ) {\n        for ( i = 0 ; i &lt; lengthofstring ; i++ ) {\n            if ( *throwaway == anotherthrowaway ) {\n                *(newabcorder+j) = *throwaway;\n                j++;\n            }\n            throwaway++;\n        }\n        throwaway = characters;\n    }\n    *(newabcorder+j) = '\\0';\n\n    strcpy(characters, newabcorder);\n    free(newabcorder);\n    return *newabcorder;\n}\n</code></pre>\n"}, {"tags": ["c", "error-handling", "sentinel"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572394082, "post_id": 58616920, "comment_id": 103543446, "body": "&quot;error value that is encapsulated in a string.&quot; --&gt; The <i>string</i> ends with the fist <i>null character</i>.  Looks like you want to hide info <i>after</i> the string."}, {"owner": {"reputation": 117, "user_id": 12282936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nC3rV.png?s=128&g=1", "display_name": "user12282936", "link": "https://stackoverflow.com/users/12282936/user12282936"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572394507, "post_id": 58616920, "comment_id": 103543527, "body": "@chux perhaps could use <code>\\x01</code> instead then? Basically, any rare character that we can show &quot;what follows is an error value&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1572394578, "post_id": 58616920, "comment_id": 103543539, "body": "What if the original string begins with <code>&quot;\\x01&quot;</code>?  Something has to give up general string usage.  I think you are looking for an &quot;out-of-band&quot; character or escape character.  To meet your goal, perhaps post the higher level usage to add clarity."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1572395110, "post_id": 58616920, "comment_id": 103543654, "body": "<code>int a = &quot;asd&quot;</code>... what?"}], "owner": {"reputation": 117, "user_id": 12282936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nC3rV.png?s=128&g=1", "display_name": "user12282936", "link": "https://stackoverflow.com/users/12282936/user12282936"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572393704, "creation_date": 1572393083, "last_edit_date": 1572393704, "question_id": 58616920, "link": "https://stackoverflow.com/questions/58616920/opposite-of-a-sentinel-value", "title": "Opposite of a sentinel value", "body": "<p>I need to indicate an error value that is encapsulated in a string. For example, here would be an example:</p>\n\n<pre><code>int a = \"asd\";\n==&gt; '\\x00asd'\n// meaning an error was generated and the original value\n// that generated it was 'asd'\n</code></pre>\n\n<p>Where <code>\\x00</code> at the start would indicate that the value to follow is actually an error. Is there a term for this type of \"sentinel-value\" at the start of a string?</p>\n"}, {"tags": ["c", "gcc", "intrinsics", "stdatomic"], "answers": [{"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1580929406, "post_id": 58617065, "comment_id": 106263175, "body": "It still seems to me like there should be no need to have two versions for this. Sure, with functions, it&#39;d be wise to take big objects by reference, but these are compiler builtins. A compiler should be able to use pointers internally where needed without having to bother users with two APIs."}, {"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 2, "creation_date": 1580950112, "post_id": 58617065, "comment_id": 106270180, "body": "@PSkocik <i>shrug</i> I&#39;m certain there&#39;s some reason behind why they chose not to do that (compiler teams generally have some sort of policy behind why they choose one mechanism over another).  If you&#39;re really curious about it, then I&#39;d encourage you to reach out to the gcc community (via their gcc list--see the <a href=\"https://gcc.gnu.org/lists.html\" rel=\"nofollow noreferrer\">mailing lists</a> page).  It&#39;s been a while since I&#39;ve interacted with the gcc community, but I&#39;ve found them pleasant and helpful in the past."}], "tags": [], "owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "is_accepted": true, "score": 4, "last_activity_date": 1572394235, "creation_date": 1572394235, "answer_id": 58617065, "question_id": 58616883, "link": "https://stackoverflow.com/questions/58616883/why-do-gcc-atomic-builtins-need-an-additional-generic-version/58617065#58617065", "title": "Why do GCC atomic builtins need an additional &quot;generic&quot; version?", "body": "<p>The answer is right in the GCC manual in <a href=\"https://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html\" rel=\"nofollow noreferrer\">section 6.55</a>, which says: </p>\n\n<blockquote>\n  <p>The \u2018__atomic\u2019 builtins can be used with any integral scalar or pointer type that is 1, 2, 4, or 8 bytes in length. 16-byte integral types are also allowed if \u2018__int128\u2019 (see __int128) is supported by the architecture.</p>\n  \n  <p>The four non-arithmetic functions (load, store, exchange, and compare_exchange) all have a generic version as well. This generic version works on any data type. It uses the lock-free built-in function if the specific data type size makes that possible; otherwise, an external call is left to be resolved at run time. This external call is the same format with the addition of a \u2018size_t\u2019 parameter inserted as the first parameter indicating the size of the object being pointed to. All objects must be the same size.</p>\n</blockquote>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 58617065, "answer_count": 1, "score": 8, "last_activity_date": 1572419397, "creation_date": 1572392797, "last_edit_date": 1572419397, "question_id": 58616883, "link": "https://stackoverflow.com/questions/58616883/why-do-gcc-atomic-builtins-need-an-additional-generic-version", "title": "Why do GCC atomic builtins need an additional &quot;generic&quot; version?", "body": "<p>According to <a href=\"https://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html</a>, there's:</p>\n\n<pre><code>type __atomic_load_n (type *ptr, int memorder)\n</code></pre>\n\n<p>and (the \"generic\"):</p>\n\n<pre><code>void __atomic_load (type *ptr, type *ret, int memorder)\n</code></pre>\n\n<p>then</p>\n\n<pre><code>void __atomic_store_n (type *ptr, type val, int memorder)\n</code></pre>\n\n<p>and (\"the generic\") </p>\n\n<pre><code>void __atomic_store (type *ptr, type *val, int memorder)\n</code></pre>\n\n<p>etc.</p>\n\n<p>What is generic about the latter versions (that's not generic about the former ones) and why are they needed?</p>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1572391475, "post_id": 58616717, "comment_id": 103542884, "body": "<code>fprintf(out_file, &quot;%-10d&quot;, matrix1[i][j])</code> is probably what you want."}, {"owner": {"reputation": 41, "user_id": 11411854, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wf1qhbexaps/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3fUvqesIdynm2jZwB5zCVdtJILg/mo/photo.jpg?sz=128", "display_name": "John Fore", "link": "https://stackoverflow.com/users/11411854/john-fore"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1572391767, "post_id": 58616717, "comment_id": 103542959, "body": "@MarcoBonelli That worked. Thank you!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1572394281, "post_id": 58616717, "comment_id": 103543476, "body": "<code>&quot;%-10d&quot;</code> will print 10 or 11 characters. Not quite uniform.  Try <code>&quot;%- 10d&quot;</code> to always print 11."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1572401419, "post_id": 58617241, "comment_id": 103544860, "body": "What if you include the <code>&quot;% d&quot;</code> in <code>int w = snprintf(NULL, 0, &quot;% d&quot;, matrix1[i][j]);</code> instead of the space before <code>&quot; %*d&quot;</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1572401651, "post_id": 58617241, "comment_id": 103544891, "body": "@DavidC.Rankin I&#39;d expect that to work too.  Yet conceptually, to me, <code>&quot;%d&quot;</code> makes more sense as that is the width of the number."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1572399858, "last_edit_date": 1572399858, "creation_date": 1572395770, "answer_id": 58617241, "question_id": 58616717, "link": "https://stackoverflow.com/questions/58616717/how-to-print-a-neat-2d-array-in-c/58617241#58617241", "title": "How to print a &quot;neat&quot; 2D array in C", "body": "<blockquote>\n  <p>How to print a \u201cneat\u201d 2D array in C (?)</p>\n</blockquote>\n\n<p>Find the longest <em>text</em> width using <code>snprintf(NULL, 0, some_format, ...</code></p>\n\n<pre><code>    int width = 1;\n    for(i = 0; i &lt; 5; i++ ) {\n        for(j = 0; j &lt; random; j++) {\n            int rand = randomNumber(0, numbsinfile);\n            matrix1[i][j] = nums[rand];\n            int w = snprintf(NULL, 0, \"%d\", matrix1[i][j]);\n            if (w &gt; width) width = w;\n        }\n    }\n</code></pre>\n\n<p>Use <code>*</code> in the specifier and <code>width</code> for printing. </p>\n\n<pre><code>    for(i = 0; i &lt; 5; i++ ) {\n        for(j = 0; j &lt; random; j++) {\n            fprintf(out_file, \" %*d\", width, matrix1[i][j]);\n        }\n        fprintf(out_file, \"\\n\");\n    }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11411854, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wf1qhbexaps/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3fUvqesIdynm2jZwB5zCVdtJILg/mo/photo.jpg?sz=128", "display_name": "John Fore", "link": "https://stackoverflow.com/users/11411854/john-fore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572399858, "creation_date": 1572391329, "question_id": 58616717, "link": "https://stackoverflow.com/questions/58616717/how-to-print-a-neat-2d-array-in-c", "title": "How to print a &quot;neat&quot; 2D array in C", "body": "<p>I am able to print out a 2D array into an output file but it is not uniform. I would like to have the 2D array evenly spaced when it is printed out. I am fairly new at programing in C so any help would be greatly appreciated!</p>\n\n<p>My Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/**\n * Driver method for program\n */\n\nint main()\n{\n    int nums[200];\n    int i = 0;\n    int j = 0;\n    FILE * in_file;\n    FILE * out_file;\n    srand(time(0)); //seed for random generator\n\n    /**\n     * if loop reads text file and stores numbers into array\n     */\n    if (in_file = fopen(\"Data.txt\", \"r\")) {\n        while (fscanf(in_file, \"%d\", &amp;nums[i]) != EOF) {\n            i++;\n        }\n\n        int numbsinfile = i;\n        int random = randomNumber(2, 12);\n\n        int matrix1[5][random];\n        int matrix2[random][5];\n        out_file = fopen(\"out.txt\", \"w\");\n\n        fprintf(out_file, \"Matrix 1: \\n\");\n        fprintf(out_file, \"Rows = 5 \\n\");\n        fprintf(out_file, \"Columns = %d \\n\\n\", random);\n\n        for(i = 0; i &lt; 5; i++ ){\n            for(j = 0; j &lt; random; j++){\n                int rand = randomNumber(0, numbsinfile);\n                matrix1[i][j] = nums[rand];\n                fprintf(out_file, \"%d \\t\\t\", matrix1[i][j]);\n            }\n            fprintf(out_file, \"\\n\");\n        }\n        fclose(in_file);\n        fclose(out_file);\n    }\n\n    return 0;\n\n}\n\n/**\n * Generates and prints random\n * numbers in range [lower, upper].\n */\n\nint randomNumber(int lower, int upper) {\n\n    int num = (rand() % (upper - lower + 1)) + lower;\n    return num;\n\n}\n</code></pre>\n\n<p>The input file I am using along with the output file that my code produces. I am basically just wanting to clean up the 2D array that is printed to the output file. </p>\n\n<p>input file:</p>\n\n<pre><code>23 34 -54 21 45 34 65 -54 21 45 34 65 -34 24 58\n       49 45 10     -57 20\n57 39 20    58 23 10 20 58 -60 76   -82 28\n    28 -37 49 358 47 -50 37 29\n57 -29 -20 47 69\n    93 57   23 49 -38 49        27 -40 48 39\n56 -30 47 28 49\n37 49 \n        27 26 10 20 58 -60 26 10 20 58 -60 76   -82 28\n    28 -37 49 -28 93 28\n73 47     27 83     37 -29 40 37 49 20\n17 -26 12    17 17\n18 38 29 39 -118\n19 10 20 58 -60 76   -82 28\n    28 -37 49 59 10 58 -60 76   -82 28\n    28 -37 49 59 10 20 58 -60 76   -82 28\n    28 -37 49 30 -58 58     38 49 30 -58 58     38 \n49 30 -58 58    38 \n28 39\n39 48     23 -50 28\n48 29 39 40 29\n</code></pre>\n\n<p>My output file:</p>\n\n<pre><code>Matrix 1: \nRows = 5 \nColumns = 12 \n\n28      39      20      49      58      76      37      -26         47      -40         216309856       26      \n57      -50         30      47      29      58      73      20      26      216309856       49      26      \n216309856       30      59      45      20      23      -50         83      -50         -37         28      30      \n10      10      23      28      47      45      34      10      19      -38         -118        28      \n47      49      -40         20      49      29      10      20      58      69      10      28      \n</code></pre>\n"}]