[{"tags": ["c", "list", "dynamic"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515021905, "post_id": 48086485, "comment_id": 83148124, "body": "<code>struct node* head;</code> is just a pointer to a <code>struct node</code>, which doesn&#39;t exist yet. You use <code>malloc</code> to allocate memory,, in this case for a <code>struct node</code>. Your <code>head-&gt;</code> invokes undefined behavior since <code>head</code> doesn&#39;t yet point to valid memory. You say it should just print the data in the first node .. you have zero nodes. You must allocate some memory for a node first to create one."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515025825, "post_id": 48086570, "comment_id": 83149120, "body": "It would be better to have <code>destroy()</code> return nothing than just a null pointer."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515027096, "post_id": 48086570, "comment_id": 83149363, "body": "No, I disagree. It is better to return a value to assign to the caller\u2019s head pointer, as in the example. But \u201cbetter\u201d in this case is opinion either way."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515028862, "post_id": 48086570, "comment_id": 83149755, "body": "OK. I see why you\u2019re doing it. If I wanted to be sure the pointer in the calling code was null, I\u2019d use a pointer to pointer argument. But it\u2019s not worth fighting over. What you have is OK."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515029368, "post_id": 48086570, "comment_id": 83149869, "body": "I\u2019ve done it both ways. I have come to think this way is cleaner (at least, that\u2019s my current opinion, LOL), but either way is just as good."}], "tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": true, "score": 3, "last_activity_date": 1515022216, "last_edit_date": 1515022216, "creation_date": 1515021885, "answer_id": 48086570, "question_id": 48086485, "link": "https://stackoverflow.com/questions/48086485/malloc-function-in-dynamic-lists/48086570#48086570", "title": "Malloc function in dynamic lists", "body": "<p>You don\u2019t technically, but maintaining all nodes with the same memory pattern is only an advantage to you, with no real disadvantages. </p>\n\n<p>Just assume that <em>all</em> nodes are stored in the dynamic memory.</p>\n\n<p>Your \u201cinsert\u201d procedure would be better named something like \u201cadd\u201d or (for full functional context) \u201ccons\u201d, and it should return the new node:</p>\n\n<pre><code>struct node* cons(int val, struct node* next)\n{\n  struct node* this = (struct node*)malloc( sizeof struct node );\n  if (!this) return next;  // or some other error condition!\n  this-&gt;data = val;\n  this-&gt;next = next;\n  return this;\n}\n</code></pre>\n\n<p>Building lists is now very easy:</p>\n\n<pre><code>int main()\n{\n  struct node* xs = cons( 2, cons( 3, cons( 5, cons( 7, NULL ) ) ) );\n  // You now have a list of the first four prime numbers.\n</code></pre>\n\n<p>And it is easy to handle them.</p>\n\n<pre><code>  // Let\u2019s print them!\n  {\n    struct node* p = xs;\n    while (p)\n    {\n      printf( \"%d \", p-&gt;data );\n      p = p-&gt;next;\n    }\n    printf( \"\\n\" );\n  }\n\n  // Let\u2019s get the length!\n  int length = 0;\n  {\n    struct node* p = xs;\n    while (p)\n    {\n      length += 1;\n      p = p-&gt;next;\n    }\n  }\n  printf( \"xs is %d elements long.\\n\", length );\n</code></pre>\n\n<p>By the way, you should try to be as consistent as possible when naming things. You have named the node data \u201cdata\u201d but the constructor\u2019s argument calls it \u201cval\u201d. You should pick one and stick to it.</p>\n\n<p>Also, it is common to:</p>\n\n<pre><code>typedef struct node node;\n</code></pre>\n\n<p>Now in every place except inside the definition of <code>struct node</code> you can just use the word <code>node</code>.</p>\n\n<p>Oh, and I almost forgot: Don\u2019t forget to clean up with a proper destructor.</p>\n\n<pre><code>node* destroy( node* root )\n{\n  if (!root) return NULL;\n  destroy( root-&gt;next );\n  free( root );\n  return NULL;\n}\n</code></pre>\n\n<p>And an addendum to <code>main()</code>:</p>\n\n<pre><code>int main()\n{\n  node* xs = ...\n\n  ...\n\n  xs = destroy( xs );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1515023089, "creation_date": 1515023089, "answer_id": 48086746, "question_id": 48086485, "link": "https://stackoverflow.com/questions/48086485/malloc-function-in-dynamic-lists/48086746#48086746", "title": "Malloc function in dynamic lists", "body": "<p>When you declare a variable, you define the type of the variable, then it's\nname and optionally you declare it's initial value.</p>\n\n<p>Every type needs an specific amount of memory. For example <code>int</code> would be\n32 bit long on a 32bit OS, 8 bit long on a 64.</p>\n\n<p>A variable declared in a function is usually stored in the stack associated\nwith the function. When the function returns, the stack for that function is\nno longer available and the variable does not longer exist.</p>\n\n<p>When you need the value/object of the variable to exist even after a function\nreturns, then you need to allocate memory on a different part of the program,\nusually the heap. That's exactly what <code>malloc</code>, <code>realloc</code> and <code>calloc</code> do.</p>\n\n<p>Doing</p>\n\n<pre><code>struct node* head ;\nhead-&gt;data = 2;\n</code></pre>\n\n<p>is just wrong. You've declaring a pointer named <code>head</code> of type <code>struct node</code>,\nbut you are not assigning anything to it. So it points to an unspecified\nlocation in memory. <code>head-&gt;data = 2</code> tries to store a value at an unspecified\nlocation and the program will most likely crash with a segfault.</p>\n\n<p>In main you could do this:</p>\n\n<pre><code>int main(void)\n{\n    struct node head;\n    head.data = 2;\n    printf(\"%d \\n\", head.data);\n    return 0;\n}\n</code></pre>\n\n<p><code>head</code> will be saved in the stack and will persist as long as <code>main</code> doesn't\nreturn. But this is only a very small example. In a complex program where you\nhave many more variables, objects, etc. it's a bad idea to simply declare all\nvariables you need in <code>main</code>. So it's best that objects get created when they\nare needed.</p>\n\n<p>For example you could have a function that creates the object and another one\nthat calls <code>create_node</code> and uses that object.</p>\n\n<pre><code>struct node *create_node(int data)\n{\n    struct node *head = malloc(sizeof *head);\n    if(head == NULL)\n        return NULL; // no more memory left\n\n    head-&gt;data = data;\n    head-&gt;next = NULL;\n\n    return head;\n}\n\nstruct node *foo(void)\n{\n    struct node *head = create_node(112);\n\n    // do somethig with head\n\n    return head;\n}\n</code></pre>\n\n<p>Here <code>create_node</code> uses malloc to allocate memory for one <code>struct node</code>\nobject, initializes the object with some values and returns a pointer to that memory location.\n<code>foo</code> calls <code>create_node</code> and does something with it and it returns the\nobject. If another function calls <code>foo</code>, this function will get the object.</p>\n\n<p>There are also other reasons for <code>malloc</code>. Consider this code:</p>\n\n<pre><code>void foo(void)\n{\n    int numbers[4] = { 1, 3, 5, 7 };\n\n    ...\n}\n</code></pre>\n\n<p>In this case you know that you will need 4 integers. But sometimes you need an\narray where the number of elements is only known during runtime, for example\nbecause it depends on some user input. For this you can also use <code>malloc</code>.</p>\n\n<pre><code>void foo(int size)\n{\n    int *numbers = malloc(size * sizeof *numbers);\n\n    // now you have \"size\" elements\n    ...\n    free(numbers);   // freeing memory\n}\n</code></pre>\n\n<p>When you use <code>malloc</code>, <code>realloc</code>, <code>calloc</code>, you'll need to free the memory. If\nyour program does not need the memory anymore, you have to use <code>free</code> (like in\nthe last example. Note that for simplicity I omitted the use of <code>free</code> in the\nexamples with <code>struct head</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8824918, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1511408268950170/picture?type=large", "display_name": "Antonio Pavan", "link": "https://stackoverflow.com/users/8824918/antonio-pavan"}, "edited": false, "score": 0, "creation_date": 1515027020, "post_id": 48086756, "comment_id": 83149355, "body": "ok thanks very much for the answer, but i still don&#39;t get why we don&#39;t need to follow the same process when it comes to simple variables like int. For istance when i declare a pointer to an integer value, why don&#39;t i need to declare an integer and then assign to the pointer its adress before actually being able to modify the variable&#39;s value through the pointer preceded by the * operator?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 55, "user_id": 8824918, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1511408268950170/picture?type=large", "display_name": "Antonio Pavan", "link": "https://stackoverflow.com/users/8824918/antonio-pavan"}, "edited": false, "score": 0, "creation_date": 1515046444, "post_id": 48086756, "comment_id": 83153697, "body": "@AntonioPavan I think you&#39;ve got it now, but see my edit for further explanation if you wish."}], "tags": [], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "is_accepted": false, "score": 2, "last_activity_date": 1515046400, "last_edit_date": 1515046400, "creation_date": 1515023134, "answer_id": 48086756, "question_id": 48086485, "link": "https://stackoverflow.com/questions/48086485/malloc-function-in-dynamic-lists/48086756#48086756", "title": "Malloc function in dynamic lists", "body": "<p>What you have invokes undefined behavior because you don't really have a node,, you have a <em>pointer</em> to a node that doesn't actually point to a node.  Using <code>malloc</code> and friends creates a memory region where an actual node object can reside, and where a node pointer can point to.</p>\n\n<p>In your code, <code>struct node* head</code> is a pointer that points to nowhere, and dereferencing it as you have done is undefined behavior (which can commonly cause a segfault).  You must point <code>head</code> to a valid <code>struct node</code> before you can safely dereference it.  One way is like this:</p>\n\n<pre><code>int main() {\n    struct node* head;\n    struct node myNode;\n    head = &amp;myNode;  // assigning the address of myNode to head, now head points somewhere\n    head-&gt;data = 2;  // this is legal\n    printf(\"%d \\n\", head-&gt;data);  // will print 2\n\n}\n</code></pre>\n\n<p>But in the above example, <code>myNode</code> is a local variable, and will go out of scope as soon as the function exists (in this case <code>main</code>).  As you say in your question, for linked lists you generally want to <code>malloc</code> the data so it can be used outside of the current scope.</p>\n\n<pre><code>int main() {\n    struct node* head = malloc(sizeof struct node);\n    if (head != NULL)\n    {\n        // we received a valid memory block, so we can safely dereference\n        // you should ALWAYS initialize/assign memory when you allocate it.\n        // malloc does not do this, but calloc does (initializes it to 0) if you want to use that\n        // you can use malloc and memset together.. in this case there's just\n        // two fields, so we can initialize via assignment.\n        head-&gt;data = 2;\n        head-&gt;next = NULL;\n        printf(\"%d \\n\", head-&gt;data);\n\n        // clean up memory when we're done using it\n        free(head);\n    }\n    else\n    {\n        // we were unable to obtain memory\n        fprintf(stderr, \"Unable to allocate memory!\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This is a very simple example.  Normally for a linked list, you'll have insert function(s) (where the <code>malloc</code>ing generally takes place and remove function(s) (where the <code>free</code>ing generally takes place.  You'll at least have a <code>head</code> pointer that always points to the first item in the list, and for a double-linked list you'll want a <code>tail</code> pointer as well.  There can also be print functions, <code>deleteEntireList</code> functions, etc.  But one way or another, you must allocate space for an actual object.  <code>malloc</code> is a way to do that so the validity of the memory persists throughout runtime of your program.</p>\n\n<hr>\n\n<p>edit:</p>\n\n<p>Incorrect. This absolutely applies to <code>int</code> and <code>int*</code>,, it applies to any object and pointer(s) to it.  If you were to have the following:</p>\n\n<pre><code>int main() {\n    int* head;\n    *head = 2;  // head uninitialized and unassigned, this is UB\n    printf(\"%d\\n\", *head); // UB again\n\n    return 0;\n}\n</code></pre>\n\n<p>this is every bit of undefined behavior as you have in your OP.  A pointer <strong>must</strong> point to something valid before you can dereference it.  In the above code, <code>head</code> is uninitialized, it doesn't point to anything deterministically, and as soon as you do <code>*head</code> (whether to read or write), you're invoking undefined behavior.  Just as with your <code>struct node</code>, you must do something like following to be correct:</p>\n\n<pre><code>int main() {\n        int myInt;  // creates space for an actual int in automatic storage (most likely the stack)\n        int* head = &amp;myInt;  // now head points to a valid memory location, namely myInt\n        *head = 2;  // now myInt == 2\n        printf(\"%d\\n\", *head);  // prints 2\n\n        return 0;\n    }\n</code></pre>\n\n<p>or you can do</p>\n\n<pre><code>int main() {\n        int* head = malloc(sizeof int);  // silly to malloc a single int, but this is for illustration purposes\n        if (head != NULL)\n        {\n            // space for an int was returned to us from the heap\n            *head = 2; // now the unnamed int that head points to is 2\n            printf(\"%d\\n\", *head);  // prints out 2\n            // don't forget to clean up\n            free(head);\n        }\n        else\n        {\n            // handle error, print error message, etc\n        }\n\n        return 0;\n    }\n</code></pre>\n\n<p>These rules are true for any primitive type or data structure you're dealing with.  Pointers must point to something, otherwise dereferencing them is undefined behavior, and you <em>hope</em> you get a segfault when that happens so you can track down the errors before your TA grades it or before the customer demo.  Murphy's law dictates UB will always crash your code when it's being presented.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8824918, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1511408268950170/picture?type=large", "display_name": "Antonio Pavan", "link": "https://stackoverflow.com/users/8824918/antonio-pavan"}, "edited": false, "score": 0, "creation_date": 1515027213, "post_id": 48087078, "comment_id": 83149398, "body": "ok thanks very much for the answer, but i still don&#39;t get why we don&#39;t need to follow the same process when it comes to simple variables like int. For istance when i declare a pointer to an integer value, why don&#39;t i need to declare an integer and then assign to the pointer its adress before actually being able to modify the variable&#39;s value through the pointer preceded by the * operator?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 55, "user_id": 8824918, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1511408268950170/picture?type=large", "display_name": "Antonio Pavan", "link": "https://stackoverflow.com/users/8824918/antonio-pavan"}, "edited": false, "score": 0, "creation_date": 1515027892, "post_id": 48087078, "comment_id": 83149556, "body": "No difference actually; <code>int *iptr; *iptr=10;</code> yields undefined  behaviour, too."}, {"owner": {"reputation": 55, "user_id": 8824918, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1511408268950170/picture?type=large", "display_name": "Antonio Pavan", "link": "https://stackoverflow.com/users/8824918/antonio-pavan"}, "edited": false, "score": 0, "creation_date": 1515028525, "post_id": 48087078, "comment_id": 83149672, "body": "Thanks again, i somehow thought the contrary."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1515025664, "creation_date": 1515025664, "answer_id": 48087078, "question_id": 48086485, "link": "https://stackoverflow.com/questions/48086485/malloc-function-in-dynamic-lists/48087078#48087078", "title": "Malloc function in dynamic lists", "body": "<p>Statement <code>struct node* head;</code> defines a <em>pointer</em> to a node object, but not the node object itself. As you do not initialize the pointer (i.e. by letting it point to a node object created by, for example, a <code>malloc</code>-statement), dereferencing this pointer as you do with <code>head-&gt;data</code> yields undefined behaviour.</p>\n\n<p>Two ways to overcome this, (1) either allocate memory dynamically - yielding an object with dynamic storage duration, or (2) define the object itself as an, for example, local variable with automatic storage duration:</p>\n\n<p><strong>(1) dynamic storage duration</strong></p>\n\n<pre><code>int main() {\n    struct node* head = calloc(1, sizeof(struct node));\n    if (head) {\n      head-&gt;data = 2;\n      printf(\"%d \\n\", head-&gt;data);\n      free(head);\n    }\n}\n</code></pre>\n\n<p><strong>(2) automatic storage duration</strong></p>\n\n<pre><code>int main() {\n    struct node head;\n    head.data = 2;\n    printf(\"%d \\n\", head.data);\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8824918, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1511408268950170/picture?type=large", "display_name": "Antonio Pavan", "link": "https://stackoverflow.com/users/8824918/antonio-pavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 48086570, "answer_count": 4, "score": 1, "last_activity_date": 1515046400, "creation_date": 1515021226, "question_id": 48086485, "link": "https://stackoverflow.com/questions/48086485/malloc-function-in-dynamic-lists", "title": "Malloc function in dynamic lists", "body": "<p>I'm getting started with dynamic lists and i don't understand why it is necessary to use the malloc function even when declaring the first node in the main() program, the piece of code below should just print the data contained in the first node but if i don't initialize the node with the malloc function it just doesn't work:</p>\n\n<pre><code> struct node{\n    int data;\n    struct node* next;\n};\n\nvoid insert(int val, struct node*);\n\nint main() {\n    struct node* head ;\n    head-&gt;data = 2;\n    printf(\"%d \\n\", head-&gt;data);\n\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "linker", "ld", "undefined-symbol"], "comments": [{"owner": {"reputation": 491, "user_id": 2685897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rBkFR.png?s=128&g=1", "display_name": "AlbusMPiroglu", "link": "https://stackoverflow.com/users/2685897/albusmpiroglu"}, "edited": false, "score": 0, "creation_date": 1515021060, "post_id": 48086133, "comment_id": 83147888, "body": "So from a shared lib, you are using symbols in the executable that calls the same shared lib? Not knowing rust, I still wonder what the linking command is. It may be an ordering of objects given to ld."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515021652, "post_id": 48086133, "comment_id": 83148054, "body": "This is platform and toolchain specific.  As a first guess, however, make sure you are compiling your module as a shared library, not an executable.  On many -- but not all -- platforms, shared libraries are permitted to have undefined symbols."}, {"owner": {"reputation": 6509, "user_id": 356011, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d17ff41be1044be6fb5ef186b83efb20?s=128&d=identicon&r=PG", "display_name": "marathon", "link": "https://stackoverflow.com/users/356011/marathon"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515022821, "post_id": 48086133, "comment_id": 83148371, "body": "@JohnBollinger mac doesn&#39;t allow it, but after reading your comment, I looked around and found a flag to ignore specific symbols rather than globally allowing undefined symbols:  <code>-Wl,-U,_symbol</code>.   That solved it."}], "answers": [{"comments": [{"owner": {"reputation": 6509, "user_id": 356011, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d17ff41be1044be6fb5ef186b83efb20?s=128&d=identicon&r=PG", "display_name": "marathon", "link": "https://stackoverflow.com/users/356011/marathon"}, "edited": false, "score": 0, "creation_date": 1515178366, "post_id": 48098597, "comment_id": 83215620, "body": "Thanks.  I&#39;m finding the macos linker doesn&#39;t exactly follow what other unixes do by default.  adding <code>-undefined dynamic_lookup</code> also appears to work."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1515080217, "creation_date": 1515080217, "answer_id": 48098597, "question_id": 48086133, "link": "https://stackoverflow.com/questions/48086133/when-creating-a-shared-library-how-to-tell-the-linker-that-a-symbol-is-in-the-e/48098597#48098597", "title": "When creating a shared library, how to tell the linker that a symbol is in the executable?", "body": "<blockquote>\n  <p>How do I tell the linker the symbols are in httpd ?</p>\n</blockquote>\n\n<p>You shouldn't need to: UNIX linkers by default assume that a shared library will have unresolved symbols.</p>\n\n<p>Your problem appears to be: missing <code>-shared</code> flag on the link line (without it, the linker is trying to link an executable, and not a shared library that you want to link).</p>\n\n<p>P.S. Using <code>-nodefaultlibs</code> is <em>ill</em>-advised. You should <em>never</em> use it unless you know what you are doing.</p>\n"}, {"tags": [], "owner": {"reputation": 6509, "user_id": 356011, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d17ff41be1044be6fb5ef186b83efb20?s=128&d=identicon&r=PG", "display_name": "marathon", "link": "https://stackoverflow.com/users/356011/marathon"}, "is_accepted": false, "score": 0, "last_activity_date": 1556554984, "last_edit_date": 1556554984, "creation_date": 1515178564, "answer_id": 48119670, "question_id": 48086133, "link": "https://stackoverflow.com/questions/48086133/when-creating-a-shared-library-how-to-tell-the-linker-that-a-symbol-is-in-the-e/48119670#48119670", "title": "When creating a shared library, how to tell the linker that a symbol is in the executable?", "body": "<p>Just for future reference in case anyone else has the same problem, I solved this by telling the linker to ignore the specific symbols.   </p>\n\n<pre><code>... -Wl,-U,_ap_is_initial_req -Wl,-U,_ap_hook_handler -Wl,-U,_ap_server_root  \n</code></pre>\n"}], "owner": {"reputation": 6509, "user_id": 356011, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d17ff41be1044be6fb5ef186b83efb20?s=128&d=identicon&r=PG", "display_name": "marathon", "link": "https://stackoverflow.com/users/356011/marathon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556554984, "creation_date": 1515018715, "last_edit_date": 1556554967, "question_id": 48086133, "link": "https://stackoverflow.com/questions/48086133/when-creating-a-shared-library-how-to-tell-the-linker-that-a-symbol-is-in-the-e", "title": "When creating a shared library, how to tell the linker that a symbol is in the executable?", "body": "<p>I'm creating a an apache module which is basically a shared library (not in C, but in rust, so I can't use the usual apache tooling that hides all this stuff).</p>\n\n<p>When I go to link, <code>ld</code> is telling me there's a bunch of undefined symbols.   These symbols are all defined in the executable that will be loading this shared library, namely <code>/usr/sbin/httpd</code>.   I verified this with <code>nm</code>.   I can't find them in any other static or shared libs.</p>\n\n<p>How do I tell the linker the symbols are in <code>httpd</code> ?   </p>\n\n<p>here is an abbreviated linker command it is firing off:</p>\n\n<pre><code>\"cc\" \"-m64\" \"-L\" \"/Users/me/.rustup/toolchains/nightly-x86_64-apple-darwin/lib/rustlib/x86_64-apple-darwin/lib\" \"/Users/me/dev/apacheagent-myco/target/debug/deps/apacheagentmyco.apacheagentmyco0.rcgu.o\" ...&lt;tons of .o files&gt;  \"-Wl,-exported_symbols_list,/var/folders/6h/qx6jssj16q95_h_kqjd6qt_00000gn/T/rustc.xMMi8AxcVg62/list\"  \"-Wl,-dead_strip\" \"-nodefaultlibs\" \"-L\" &lt;tons of rlibs&gt;  \"-l\" \"onig\" \"-framework\" \"Security\" \"-framework\" \"CoreFoundation\" \"-l\" \"System\" \"-l\" \"resolv\" \"-l\" \"pthread\" \"-l\" \"c\" \"-l\" \"m\" \"-dynamiclib\" \"-Wl,-dylib\" \"-lapr-1\" \"-laprutil-1\"\n</code></pre>\n\n<p>here are the errors:</p>\n\n<pre><code>note: Undefined symbols for architecture x86_64:\n            \"_ap_is_initial_req\", referenced from:\n                apache2::httpd::_$LT$impl$u20$apache2..wrapper..Wrapper$LT$apache2..ffi..request_rec$GT$$GT$::is_initial_req::h078b0dbdc2d2d488 in libapache2-850bd4b18832aac1.rlib(apache2-850bd4b18832aac1.apache20.rcgu.o)\n            \"_ap_hook_handler\", referenced from:\n                apacheagentmyco::apache_agent_myco_hooks::h3461197a43567639 in apacheagentmyco.apacheagentmyco7.rcgu.o\n            \"_ap_server_root\", referenced from:\n                apacheagentmyco::myco_child_init::h52c8c1513f7742ef in apacheagentmyco.apacheagentmyco7.rcgu.o\n            \"_ap_get_brigade\", referenced from:\n                apacheagentmyco::myco_apache2::apache2_body::read_body::h41bdc64c0c81a6d6 in apacheagentmyco.apacheagentmyco15.rcgu.o\n          ld: symbol(s) not found for architecture x86_64\n          clang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>These symbols are all in /usr/sbin/httpd.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 5, "creation_date": 1515017284, "post_id": 48085841, "comment_id": 83146623, "body": "that &quot;function prototype&quot; looks like a function pointer."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 2, "creation_date": 1515017325, "post_id": 48085841, "comment_id": 83146637, "body": "What do you mean by \u201cscanleft() is a fuction and has the type of static char *.\u201d? The keyword <code>static</code> is not part of a type, and <code>char *</code> is not a function type. Unrelated, what is <code>zero</code>? If it\u2019s a numeric constant with value <code>0</code>, why not just use that? If it\u2019s something else, why call it <code>zero</code>?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1515017466, "post_id": 48085841, "comment_id": 83146699, "body": "<a href=\"https://cdecl.org/?q=char+%2A%28%2Ascan%29%28char+%2A%2C+char+%2A%2C+char+%2A%2C+char+%2A%2C+int+%2C+int%29%3B\" rel=\"nofollow noreferrer\">cdecl</a>"}, {"owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "edited": false, "score": 1, "creation_date": 1515018230, "post_id": 48085841, "comment_id": 83147005, "body": "To flesh out the above comment a little: the cdecl program (or the website <a href=\"http://cdecl.org\" rel=\"nofollow noreferrer\">cdecl.org</a>) is your friend--it converts C declarations to English and vice versa.  In the case of the above scan declaration, it yields: &quot;declare scan as pointer to function (pointer to char, pointer to char, pointer to char, pointer to char, int, int) returning pointer to char&quot;"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1515028794, "post_id": 48085841, "comment_id": 83149737, "body": "How is <code>scanleft</code> declared? We are not interested in vague verbal description. Post the exact full declaration of <code>scanleft</code>."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 2, "last_activity_date": 1515017277, "creation_date": 1515017277, "answer_id": 48085872, "question_id": 48085841, "link": "https://stackoverflow.com/questions/48085841/deciphering-a-confusing-function-prototype/48085872#48085872", "title": "Deciphering a Confusing Function Prototype", "body": "<p><code>scan</code> is not a function; it has no prototype.</p>\n\n<p><code>scan</code> is a pointer to a function (taking a pointer to <code>char</code>, pointer to <code>char</code>, pointer to <code>char</code>, pointer to <code>char</code>, <code>int</code>, and <code>int</code>) and returning a pointer to <code>char</code>.</p>\n\n<p>According to your description, <code>scanleft</code> isn't a function either; it's a pointer to <code>char</code>.</p>\n\n<hr>\n\n<p>The only prototype in your question is this:</p>\n\n<pre><code>char *, char *, char *, char *, int , int\n</code></pre>\n\n<p>... which doesn't look particularly confusing to me. It's 6 straightforward parameters.</p>\n"}, {"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1515029945, "creation_date": 1515029945, "answer_id": 48087558, "question_id": 48085841, "link": "https://stackoverflow.com/questions/48085841/deciphering-a-confusing-function-prototype/48087558#48087558", "title": "Deciphering a Confusing Function Prototype", "body": "<pre><code>char *(*scan)(char *, char *, char *, char *, int , int);\n</code></pre>\n\n<p>This defines a function pointer <code>scan</code>, which points to a function that accepts four <code>char *</code> and two <code>int</code> parameters, and returns a <code>char *</code>.</p>\n\n<p>That means you can do things like:</p>\n\n<pre><code>char *scanLeft(char *p1, char *p2, char *p3, char *p4, int p5, int p6) {\n    // do something\n}\nchar *scanRight(char *p1, char *p2, char *p3, char *p4, int p5, int p6) {\n    // do something else\n}\n:\nscan = scanLeft;  char *xyzzy = scan(\"a\", \"b\", \"c\", \"d\", 271828, 314159);\nscan = scanRight; char *plugh = scan(\"a\", \"b\", \"c\", \"d\", 271828, 314159);\n</code></pre>\n\n<p>and the two calls via the <code>scan</code> function pointer will go to <em>different</em> functions.</p>\n"}], "owner": {"reputation": 11, "user_id": 8669406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79501dc2b28417b948628b91add64f14?s=128&d=identicon&r=PG&f=1", "display_name": "user8669406", "link": "https://stackoverflow.com/users/8669406/user8669406"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515029945, "creation_date": 1515017130, "last_edit_date": 1515028450, "question_id": 48085841, "link": "https://stackoverflow.com/questions/48085841/deciphering-a-confusing-function-prototype", "title": "Deciphering a Confusing Function Prototype", "body": "<p>I have the following function prototype:</p>\n\n<pre><code>char *(*scan)(char *, char *, char *, char *, int , int);\n</code></pre>\n\n<p>scanleft() is a function and has the type of static char *.</p>\n\n<p>When I try to compile, I found that there is a pointer type mismatch between scan and scanleft.</p>\n\n<pre><code>if ((subtype &amp; 1) ^ zero) scan = scanleft; else scan = scanright;\n</code></pre>\n\n<p>What does the prototype of scan() mean?</p>\n"}, {"tags": ["c", "linux", "pthreads", "named-pipes", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 8577747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea872b0dc450389a49ff4ee71f7196e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelve", "link": "https://stackoverflow.com/users/8577747/kelve"}, "edited": false, "score": 0, "creation_date": 1515283473, "post_id": 48086782, "comment_id": 83243490, "body": "how to do it ? sorry , im new here xD"}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 2, "last_activity_date": 1515284354, "last_edit_date": 1515284354, "creation_date": 1515023320, "answer_id": 48086782, "question_id": 48085700, "link": "https://stackoverflow.com/questions/48085700/how-to-unblock-wgetch/48086782#48086782", "title": "How to unblock wgetch?", "body": "<p>In curses, you have three choices</p>\n\n<ul>\n<li>blocking reads with no time limit (which is what you're doing now)</li>\n<li>blocking reads with a time limit, using <a href=\"https://invisible-island.net/ncurses/man/curs_inopts.3x.html#h3-timeout_wtimeout\" rel=\"nofollow noreferrer\"><strong><code>wtimeout</code></strong></a></li>\n<li>non-blocking reads, using <a href=\"https://invisible-island.net/ncurses/man/curs_inopts.3x.html#h3-nodelay\" rel=\"nofollow noreferrer\"><strong><code>nodelay</code></strong></a></li>\n</ul>\n\n<p>Both of those (<code>wtimeout</code> and <code>nodelay</code>) are set on the given window, and can be modified as needed.  A <code>wgetch</code> on a <em>different</em> window is unaffected.</p>\n\n<p>For example, to use non-blocking reads for <code>game_win</code>, you could add this near the <code>keypad</code> call:</p>\n\n<pre><code>nodelay(game_win, TRUE);\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 8577747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea872b0dc450389a49ff4ee71f7196e8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelve", "link": "https://stackoverflow.com/users/8577747/kelve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 48086782, "answer_count": 1, "score": 4, "last_activity_date": 1515284354, "creation_date": 1515016531, "last_edit_date": 1515019148, "question_id": 48085700, "link": "https://stackoverflow.com/questions/48085700/how-to-unblock-wgetch", "title": "How to unblock wgetch?", "body": "<p>I have one school assignment in which I shall implement one game based on client-server architecture.\nThe server side controls all of the game, and the client side has just an image of what is going on.\nOne of the features of the server is to kick out clients from the game, and here comes the problem.</p>\n\n<p>I have one thread on client to receive messages from the server and the main thread receives input from the user, but when the first thread receives shutdown comand, the main thread is waiting for one key from the client before executing the shutdown.</p>\n\n<p>My question is : is there any way to unblock the wgetch on the main thread to make it not stay waiting for a key and execute the shutdown ? </p>\n\n<p>Code : </p>\n\n<pre><code>    void *trata_fifo(void *dados) {\n\nint i;\n\nRESPONSE resp;\nchar namepipe[MAX];\n\nsprintf(namepipe, CLIENT_FIFO, getpid());\nmkfifo(namepipe, 0600);\nfd_res = open(namepipe, O_RDWR);\n\n\ndo {\n    i = read(fd_res, &amp;resp, sizeof (RESPONSE));\n\n        drawGame(resp);\n        if (resp.command == 3) {\n            wclear(info_win);\n            box(info_win, 0, 0);\n            wattron(info_win, A_REVERSE | A_BOLD);\n            mvwprintw(info_win, 2, 4, \"Score\");\n            mvwprintw(info_win, 4, 5, \" %d \", resp.points);\n            mvwprintw(info_win, 6, 2, \"Bombinhas\");\n            mvwprintw(info_win, 8, 5, \" %d \", resp.bombinha);\n            mvwprintw(info_win, 10, 2, \"Megabombas\");\n            mvwprintw(info_win, 12, 5, \" %d \", resp.megaBomba);\n            wrefresh(info_win);\n        }\n\n        if (resp.command == 4) {//here\n            SHUTDOWN = true;\n            write(STDIN_FILENO,NULL,0);//i tried this , but its not working\n        }\n        if (resp.command == 5) {\n            SHUTDOWN = true;\n        }\n    }\n\n} while (!SHUTDOWN);\n\nclose(fd_res);\npthread_exit(NULL);\n\n    }\n\n\n    int main() {\n\nREQUEST client;\npthread_t tarefa;\nint highlight = 1, choice = 0, opt;\n\nint startx = 0, starty = 0;\n\nsignal(SIGINT, handleSignalCli);\nsignal(SIGUSR1, handleSignalCli);\nsignal(SIGALRM, handleSignalCli);\n\n\n\nif (access(SERVER_FIFO, F_OK) != 0) //Verificar se servidor esta correndo\n{\n    perror(\"[ERROR] Server ins't running...!/n\");\n    exit(EXIT_FAILURE);\n}\n\nif (pthread_create(&amp;tarefa, NULL, trata_fifo, NULL) != 0) {\n    fprintf(stderr, \"[ERROR] Creating Thread\\n\");\n    exit(EXIT_FAILURE);\n}\n\nfd = open(SERVER_FIFO, O_WRONLY);\nif (!fd) {\n    perror(\"[ERROR] Opening Server Fifo...!\\n\");\n    exit(EXIT_FAILURE);\n}\n\n    /*...*/\nwhile (!SHUTDOWN) {\n    cbreak();\n    keypad(game_win, TRUE);\n    noecho();\n    client.command = 3;\n    client.tecla = wgetch(game_win);\n    res = write(fd, &amp;client, sizeof (client));\n}\n\nclose(fd);\npthread_join(tarefa, NULL);\n\ndelwin(game_win);\ndelwin(main_win);\nendwin();\n\nexit(0);\n\n    }\n</code></pre>\n\n<p>PS:resp.comand = 4 means server is kicking out the player/client.\nSorry for bad english :)</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1515013673, "post_id": 48085126, "comment_id": 83145154, "body": "that should be <code>void func(const char* test){ ... }</code>"}, {"owner": {"reputation": 3147, "user_id": 1255516, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f345325356e7d0cbb23abcaa9bdd796?s=128&d=identicon&r=PG&f=1", "display_name": "abhi", "link": "https://stackoverflow.com/users/1255516/abhi"}, "edited": false, "score": 1, "creation_date": 1515013679, "post_id": 48085126, "comment_id": 83145158, "body": "how about using void* type as the parameter type."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1515013714, "post_id": 48085126, "comment_id": 83145178, "body": "What do you mean by &quot;anonymous parameters&quot;? Can you post a link to the comment mentioning it (we really need the context)? And what is the <i>actual</i> problem you want to solve? Why do you want to use &quot;anonymous parameters&quot;?"}, {"owner": {"reputation": 121, "user_id": 7122068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlGGj.png?s=128&g=1", "display_name": "Glick", "link": "https://stackoverflow.com/users/7122068/glick"}, "edited": false, "score": 1, "creation_date": 1515013836, "post_id": 48085126, "comment_id": 83145239, "body": "try to compile with posix standard flag"}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1515013940, "post_id": 48085126, "comment_id": 83145279, "body": "What&#39;s the idea?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515015187, "post_id": 48085126, "comment_id": 83145749, "body": "Are you thinking of &#39;compound literals&#39; for structures, such as <code>(struct timespec){ .tv_sec = 23, .tv_nsec = 500000000 }</code> which could be passed to a function expecting a <code>struct timespec</code> (or you could take the address of the compound literal and pass that to a function expecting a <code>struct timespec *</code> without problem)? Your cast on a string literal is unexciting \u2014 the cast doesn&#39;t do anything useful. (Are you thinking of the C++ style function definition <code>void func(char *) { \u2026 }</code> where the function takes a <code>char *</code> parameter but never uses it, presumably to meet an interface definition.)"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515018107, "post_id": 48085205, "comment_id": 83146956, "body": "Detail: String literals might be able to be modified - it is UB.    Code has undefined behavior in <i>attempting</i> to modify a string literal."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515047745, "post_id": 48085205, "comment_id": 83154179, "body": "@chux I&#39;m not sure I understand your comment. To me it seems to be exactly what I wrote in the answer. Please clarify."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515078455, "post_id": 48085205, "comment_id": 83171103, "body": "Code that tries to <code>test[0] = &#39;A&#39;;</code> may succeed in modifying the <i>string literal</i>. &quot;string literal can&#39;t be modified&quot; is not specified by C.  Attempting to do so is UB.  It may sound subtle, yet many a learner thinks attempting to modify a <code>const</code> like memory is supposed to not work and is surprised when the modification occurs.  As UB, it might work, it might not, etc."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515082793, "post_id": 48085205, "comment_id": 83173715, "body": "@chux ahh - ok, I see what you mean. You disliked the wording <code>can&#39;t be modified</code> - I&#39;ll change that bit"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1515082832, "last_edit_date": 1515082832, "creation_date": 1515013999, "answer_id": 48085205, "question_id": 48085126, "link": "https://stackoverflow.com/questions/48085126/passing-anonymous-parameters-to-functions-in-c/48085205#48085205", "title": "Passing anonymous parameters to functions in C", "body": "<p>It depends on what you are doing in the function. As long as you don't try to modify what <code>test</code> is pointing to, there is no problem. To indicate that it can't be changed, it is good to add <code>const</code>.</p>\n\n<p>Like this the code is fine:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid func(const char* test){\n    printf(\"%s\\n\", test);\n}\n\nint main(void) {\n    func(\"smaps1\");\n    func(\"smaps2\");\n    func(\"smaps3\");\n    func(\"smaps4\");\n    return 0;\n}\n</code></pre>\n\n<p>But if you try to change the value like:</p>\n\n<pre><code>void func(char* test){\n    test[0] = 'A';\n    printf(\"%s\\n\", test);\n}\n</code></pre>\n\n<p>you have undefined behavior because modifying a string literal is undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1515014101, "creation_date": 1515014101, "answer_id": 48085224, "question_id": 48085126, "link": "https://stackoverflow.com/questions/48085126/passing-anonymous-parameters-to-functions-in-c/48085224#48085224", "title": "Passing anonymous parameters to functions in C", "body": "<p>All parameters in C are passed by value. No information about the original object from which the value came is passed to the called function. In this sense, all C arguments are anonymous; no information about the identifier used in the calling function is passed.</p>\n\n<p>In <code>func((char*) \"smaps\");</code>, the string literal <code>\"smaps\"</code> is converted to a pointer to <code>char</code>. Only the value of the pointer is passed to <code>func</code>. This is standard C.</p>\n\n<p>(If you do want to pass information about an object to a function, you must do that manually. For example, you can take the address of an object and pass the resulting pointer to the function. Or you can pass the number of elements in an array to a function, along with the address of the first element.)</p>\n\n<p>(In C, string literals such as <code>\"smaps\"</code> are automatically converted to a pointer to their first character, so you do not need to manually convert them with a <code>char *</code> cast. [This automatic conversion does not occur when the string literal is the operand of <code>sizeof</code>, <code>_Alignof</code>, or <code>&amp;</code> or when it is used to initialize an array.])</p>\n"}], "owner": {"reputation": 11, "user_id": 5585745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/332caea5b0116f2e1f87eadeb3719fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Moneeb Azhar", "link": "https://stackoverflow.com/users/5585745/moneeb-azhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "closed_date": 1515015088, "accepted_answer_id": 48085205, "answer_count": 2, "score": 0, "last_activity_date": 1515140784, "creation_date": 1515013573, "last_edit_date": 1515140784, "question_id": 48085126, "link": "https://stackoverflow.com/questions/48085126/passing-anonymous-parameters-to-functions-in-c", "closed_reason": "Needs details or clarity", "title": "Passing anonymous parameters to functions in C", "body": "<p>I can pass arguments to a function in C in the following manner without any warnings or errors using gcc on ubuntu-64bit:</p>\n\n<pre><code>void func(char* test){\n    // do something here\n}\n\nvoid main() {\n    func((char*) \"smaps\");\n}\n</code></pre>\n\n<p>I did not find a lot of examples about passing anonymous parameters to functions in C apart from one comment on a similar question about C++. I am thinking of using this technique (a lot) in my code which would be compiled on multiple AMD64/ARM devices as they become available (with mostly debian-based OSes). My question is, is this compiler-specific?</p>\n\n<p>Output of gcc --version:</p>\n\n<pre><code>$ gcc --version\ngcc (Ubuntu 6.3.0-12ubuntu2) 6.3.0 20170406\n</code></pre>\n\n<p>UPDATE: Even though I think 4386427's was good enough for me, I would explain a bit more about the question as it was put on hold. I have a script which makes several calls to a specific function which takes in a char** as argument. I was of the view that I would need to explicitly declare a char** separately and pass it to the function by name every time I made a call to the function. I thought it would be more convenient to declare a string and pass it to the function at the same time; something like: </p>\n\n<pre><code>func( (char**) {\"first_string\", \"second_string\"} ). \n</code></pre>\n\n<p>My initial concern was is this allowed in C generally or is this a compiler-specific feature? 4386427's answer suggests that it is not compiler-specific, however I should be careful that the char** passed to the function would be immutable.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 3, "creation_date": 1515014312, "post_id": 48085009, "comment_id": 83145416, "body": "Always try to remove casts like (LPDWORD) because they tend to hide errors. It is not the problem in this case but could be a issue in other cases in 64-bit programs."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1515014462, "post_id": 48085009, "comment_id": 83145460, "body": "In particular, the type of <code>sidSize</code> should be <code>DWORD</code>, not <code>SIZE_T</code> (at least, if you want to use it also for <code>LookupAccountNameW</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "edited": false, "score": 0, "creation_date": 1515015149, "post_id": 48085155, "comment_id": 83145735, "body": "I changed the first parameter to add the machine variable, but still getting the same error. Like this: <code>LPCWSTR machine = NULL; if (!LookupAccountNameW(machine, argv[1], accountSID, \t\t\t\t\t\t\t\t\t(LPDWORD)&amp;sidSize, NULL, 0, &amp;typeOfAccount)) \t\t\t{ \t\t\t\tfwprintf(stderr, L&quot;Error getting SID from name.\\n&quot;);\t\t\t\t \t\t\t\treturn 1;  \t\t\t}  </code>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1515015297, "post_id": 48085155, "comment_id": 83145798, "body": "Actually, the <code>ReferencedDomainName</code> parameter <i>is</i> optional. It&#39;s the <code>cchReferencedDomainName</code> that isn&#39;t, and that&#39;s what&#39;s causing the AV, as the API is trying to write the required buffer size to that address, as <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa379159.aspx\" rel=\"nofollow noreferrer\">documented</a>."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1515015510, "post_id": 48085155, "comment_id": 83145888, "body": "@IInspectable, yes, that is how it is documented but I&#39;m not sure if it has always been true on every system but my memory might be wrong. Even if it is optional all the way back to Win 95, the function is going to &quot;fail&quot; if the string parameter is NULL and then you have to allocate and call it again. Might as well just supply a large buffer in the first place."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1515015728, "post_id": 48085155, "comment_id": 83145989, "body": "The documentation need not be true for every version of Windows ever released. It references only supported versions of Windows (that is, Windows Vista and later, as of today). The issue here is, that the OP failed to provide a valid pointer to a <code>DWORD</code> variable, receiving the required size. Passing <code>nullptr</code> as the <code>ReferenceDomainName</code> is valid, and follows a common pattern in the API."}, {"owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1515016051, "post_id": 48085155, "comment_id": 83146117, "body": "@IInspectable, I have changed the <code>cchReferencedDomainName</code> and worked, but now it is telling me that <i>The data area passed to a system call is too small</i>. Does the <code>sidSize</code> need to be bigger? Let me know if I need to put this as different question. Thank you both!"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "edited": false, "score": 1, "creation_date": 1515018533, "post_id": 48085155, "comment_id": 83147116, "body": "@SergioCalderon When cchReferencedDomainName is 0 (that is, cchReferencedDomainName=0 and calling the function with &amp;cchReferencedDomainName) you are asking the function to report the required size. The function will return failure and you need to allocate a buffer and call the function again. In my example I just pass a buffer that is large enough in the first place. For the function to succeed you must pass a valid buffer for the ReferencedDomainName parameter."}, {"owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "edited": false, "score": 0, "creation_date": 1515031340, "post_id": 48085155, "comment_id": 83150299, "body": "@Anders, did you try using those buffer sizes? I just tried, but still getting same error. I might need to use the function twice so I can get the needed size. Gonna try and get back here. Thanks for your answers!"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1515032128, "post_id": 48085155, "comment_id": 83150433, "body": "There is no way your domain/computer name is longer than 259 characters. And yes, I tested my code."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 1, "last_activity_date": 1515018802, "last_edit_date": 1515018802, "creation_date": 1515013725, "answer_id": 48085155, "question_id": 48085009, "link": "https://stackoverflow.com/questions/48085009/access-violation-writing-location-0x00000000-when-using-lookupaccountname/48085155#48085155", "title": "Access violation writing location 0x00000000 when using LookupAccountName", "body": "<p>The ReferencedDomainName parameter is not actually optional.</p>\n\n<pre><code>LPCTSTR machine = NULL, username = /*TEXT(\"Anders\")*/ argv[1];\nTCHAR domain[MAX_PATH];\nBYTE accountSIDbuf[SECURITY_MAX_SID_SIZE];\nPSID accountSID = (PSID) accountSIDbuf;\nDWORD cbSid = SECURITY_MAX_SID_SIZE, cchRD = MAX_PATH;\nSID_NAME_USE snu;\n\nif (!LookupAccountName(machine, username, accountSID, &amp;cbSid, domain, &amp;cchRD, &amp;snu))\n{\n    printf(\"Error %u\\n\", GetLastError());\n    return ;\n}\n\nLPTSTR sidstr;\nif (!ConvertSidToStringSid(accountSID, &amp;sidstr)) { return ; }\n_tprintf(_T(\"SID of %s\\\\%s is %s\\n\"), domain, username, sidstr);\nLocalFree(sidstr);\n</code></pre>\n\n<p>Another problem with your code is <code>ShowError(GetLastError());</code> You cannot use <code>GetLastError()</code> after calling some other function. Rewrite as</p>\n\n<pre><code>DWORD error = GetLastError();\nfwprintf(stderr, L\"Error getting SID from name: \\n\");\nShowError(error);\n</code></pre>\n\n<p>but in this case even that is wrong because <code>NetLocalGroupAddMembers</code> does not call <code>SetLastError</code>, it just returns the error code directly.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Just to clarify the paramter usage; If you want to query the required size of the domain buffer you can do this:</p>\n\n<pre><code>DWORD cchRD = 0;\nLookupAccountName(..., NULL, &amp;cchRD, &amp;snu); // The function is still going to report failure\nLPTSTR domain = malloc(cchRD * sizeof(*domain));\nLookupAccountName(..., domain, &amp;cchRD, &amp;snu);\n</code></pre>\n\n<p>In my example I avoid this by just passing in a buffer that is \"large enough\".</p>\n"}], "owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 48085155, "answer_count": 1, "score": 2, "last_activity_date": 1515018802, "creation_date": 1515012987, "last_edit_date": 1515013634, "question_id": 48085009, "link": "https://stackoverflow.com/questions/48085009/access-violation-writing-location-0x00000000-when-using-lookupaccountname", "title": "Access violation writing location 0x00000000 when using LookupAccountName", "body": "<p>After creating a user account with <code>NetUserAdd</code>, I found out that I would need to use <code>NetLocalGroupAddMembers</code> to add the user to the Users group, so I called <code>CreateWellKnownSid</code> to get the Users' SID, LookupAccountSid to get the string name from that SID and pass it to <code>NetLocalGroupAddMembers.</code> </p>\n\n<p>I also needed to specify the user name, but the function required <strong>domain\\name</strong> format as <code>level 3</code> (<code>LOCALGROUP_MEMBERS_INFO_3</code>), but I did not have that. I decided to call <code>LookupAccountName</code> to get the user name SID and pass it to <code>level 0</code> (<code>LOCALGROUP_MEMBERS_INFO_0</code>). </p>\n\n<p>This is how I did it:</p>\n\n<pre><code>//LocalAlloc\n    UINT memAttributes = LMEM_FIXED;\n    SIZE_T sidSize = SECURITY_MAX_SID_SIZE;\n\n//LookupAccountName\n    PSID accountSID;\n    SID_NAME_USE typeOfAccount;\n\n//NetLocalGroupAddMembers\n    NET_API_STATUS localGroupAdd;\n    DWORD levelOfData = 0;  //LOCALGROUP_MEMBERS_INFO_0\n    LOCALGROUP_MEMBERS_INFO_0 localMembers;\n    DWORD totalEntries = 0;\n\n\n\n//Allocate memory for LookupAccountName\n        if (!(accountSID = LocalAlloc(memAttributes, sidSize)))\n        {\n            wprintf(L\"\\nMemory allocation for account SID failed: \\n\");\n            ShowError(GetLastError());\n            exit(1);\n\n        }\n\n\nif (!LookupAccountNameW(NULL, argv[1], accountSID,\n                                    (LPDWORD)&amp;sidSize, NULL, 0, &amp;typeOfAccount))\n            {\n                fwprintf(stderr, L\"Error getting SID from name: \\n\");\n                ShowError(GetLastError());\n                return 1;\n\n            }\n\n//Here I should be able to use NetLocalGroupAddMembers\n            //to add the user passed as argument to the Users group. \n            localMembers.lgrmi0_sid = accountSID;\n\n            localGroupAdd = NetLocalGroupAddMembers(NULL, name, levelOfData, (LPBYTE)&amp;localMembers, totalEntries);\n\n            if (localGroupAdd != NERR_Success)\n            {\n                fwprintf(stderr, L\"Error adding member to the local group: \\n\");\n                ShowError(GetLastError());\n                return 1;\n            }\n            else\n            {\n                wprintf(L\"\\nUser %s has been successfully added.\\n\", argv[1]);\n\n            }\n</code></pre>\n\n<p>This is the error I am getting:</p>\n\n<blockquote>\n  <p>Exception thrown at 0x743F059A (sechost.dll) in UserCreator.exe:\n  0xC0000005: Access violation writing location 0x00000000.</p>\n</blockquote>\n\n<p>Any clues?</p>\n\n<p>Thanks in advanced!</p>\n"}, {"tags": ["c", "thread-safety"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1515013093, "post_id": 48085000, "comment_id": 83144905, "body": "There is no data race, it&#39;s that the function is not <i>reentrant</i>. You can not call it in different contexts (like from different threads, or even nested inside another loop already using <code>strtok</code>). If you don&#39;t use it in a threaded application, or do not nest <code>strtok</code> calls, then there is no problem."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515015028, "post_id": 48085000, "comment_id": 83145682, "body": "As long as you don&#39;t call <code>strtok</code> with NULL, I think you are safe. But why use <code>strtok</code>? I think <code>strstr</code> would make it much simpler"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1515015138, "post_id": 48085000, "comment_id": 83145731, "body": "@4386427 <code>strstr()</code> and <code>strtok()</code> work quite differently when the delimiter string is more than 1 character.  If code limits to 1 character, might as well use <code>strchr()</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515015274, "post_id": 48085000, "comment_id": 83145791, "body": "@chux True - but the example shows a single character"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515015397, "post_id": 48085000, "comment_id": 83145837, "body": "@chux - and yes - <code>strchr</code> would be fine as well. Much better than <code>strtok</code>IMO"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1515024231, "post_id": 48085000, "comment_id": 83148720, "body": "strtok() is crippled by design. Trying to control or regulate its behaviour is useless. IMnsvHO"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1515018301, "post_id": 48085847, "comment_id": 83147034, "body": "I think <code>strcspn()</code> would be even a better substitute for <code>strtok()</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515082931, "post_id": 48085847, "comment_id": 83173804, "body": "@chux Added your suggestion"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1515082917, "last_edit_date": 1515082917, "creation_date": 1515017164, "answer_id": 48085847, "question_id": 48085000, "link": "https://stackoverflow.com/questions/48085000/does-explicit-usage-of-strtok-is-enough-to-make-it-reentrant/48085847#48085847", "title": "Does explicit usage of strtok is enough to make it reentrant?", "body": "<blockquote>\n  <p>Does explicit usage of strtok is enough to make it reentrant?</p>\n</blockquote>\n\n<p>If \"explicit\" is meaning \"only call strtok with a non-null pointer\", the answer is yes. But I wouldn't call it reentrant, though. Calling <code>strtok</code> with a non-null pointer simply means that you restart the process of splitting a string.</p>\n\n<p>It is stated in the standard (draft (N1539) in 7.24.5.8 (2)</p>\n\n<blockquote>\n  <p>The \ufb01rst call in the sequence has a non-null \ufb01rst argument;</p>\n</blockquote>\n\n<p>But if you want to bypass the basic functionality of <code>strtok</code> why use it at all? You could use <code>strstr</code> or <code>strchr</code> instead. Or - as suggested by @chux in a comment - <code>strcspn</code></p>\n"}, {"comments": [{"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 1, "creation_date": 1515019847, "post_id": 48086001, "comment_id": 83147527, "body": "That&#39;s right. It is rather unlikely to happen, but in theory nothing stops <code>strtok</code> to work with its internal state during the finding process. For instance, it may store the address first, and refer to it when it&#39;s about to return, which may result in some sort of data corruption, assuming that its internal state has been changed by another instance of <code>strtok</code>, that is executed in a different thread."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515084189, "post_id": 48086001, "comment_id": 83174564, "body": "Agree all  points, especially the <code>strcspn()</code> which does what is required by OP&#39;s &quot;non-reentrant&quot; <code>strtok()</code> usage.  So much so, I see <code>strcspn()</code> a good candidate replacement for <code>strtok()</code> - just need to add the offset."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1515018420, "last_edit_date": 1515018420, "creation_date": 1515017975, "answer_id": 48086001, "question_id": 48085000, "link": "https://stackoverflow.com/questions/48085000/does-explicit-usage-of-strtok-is-enough-to-make-it-reentrant/48086001#48086001", "title": "Does explicit usage of strtok is enough to make it reentrant?", "body": "<blockquote>\n  <p>would the following usage be sufficient for reentrancy, since it ignores the internal state entirely? [...]</p>\n</blockquote>\n\n<p>How do you know whether your alternative ignores <code>strtok()</code>'s internal state entirely?  The specifics of that state's nature and use are unspecified.  Therefore, without reference to a particular implementation, we know only that it is sufficient to track the start of the next token in the event that the function is called again with <code>NULL</code> as its first argument.  Nothing says it cannot be relied upon for more than that.</p>\n\n<p>Now, I acknowledge that it seems <em>likely</em> that the static state should consist solely of a single <code>char *</code>, and that the function's behavior when passed a non-null first argument should not depend on the value of that static state.  I guess that's what you're describing as \"reentrant\".  I would not use that term for it, however, because although your approach may produce results that are unaffected by the actions of other threads, it still can affect (and engage in a data race with) other threads that do not follow the same pattern.</p>\n\n<p>Finally, yes, there really is a potential for a data race involving <code>strtok()</code>.  If two different threads call <code>strtok()</code> and at least one passes <code>NULL</code> as the first argument, then both threads modify that function's static state, and at least one reads it.  <code>strtok()</code> is not required to protect its internal state in any particular way, so if the calls are not externally synchronized in some manner then there likely is a data race.  In that event program behavior is undefined.</p>\n\n<p>Thus, if you have reason to be concerned about the non-reentrancy and data race risks associated with <code>strtok()</code>, and you do not want to rely on <code>strtok_s()</code> or POSIX's <code>strtok_r()</code>, then I would suggest avoiding <code>strtok()</code> altogether.  You can build a solution based on <code>strcspn()</code> instead, and such an alternative would likely be more efficient than your approach, too, because it would not need any of the <code>strlen()</code> calls.</p>\n"}, {"tags": [], "owner": {"reputation": 821, "user_id": 4459923, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SVEeL.jpg?s=128&g=1", "display_name": "Giorgian Borca-Tasciuc", "link": "https://stackoverflow.com/users/4459923/giorgian-borca-tasciuc"}, "is_accepted": false, "score": 0, "last_activity_date": 1515020952, "creation_date": 1515020952, "answer_id": 48086441, "question_id": 48085000, "link": "https://stackoverflow.com/questions/48085000/does-explicit-usage-of-strtok-is-enough-to-make-it-reentrant/48086441#48086441", "title": "Does explicit usage of strtok is enough to make it reentrant?", "body": "<p>I'm a bit late, but it is re-entrant. Conventionally, <code>strtok</code> has an internal <code>static</code> variable that it uses to keep of the position within the string. If the first parameter of <code>strtok</code> is <code>NULL</code>, it refers to this internal variable in order to scan for the next token. Thus, if you yourself always provide the first parameter, it will work as you are allowed to use <code>strtok</code> for as many separate strings as you want (in this case it just so happens that the string we're passing it are all substrings of a larger string). <code>strtok</code> will simply assume you passed it a new string and work as expected.</p>\n\n<p>Just keep in mind that you need to pass a non-<code>NULL</code> paramater  for every call to <code>strtok</code> for your method to work. Alternatively, I would define the following function.</p>\n\n<pre><code>char *my_strtok(char *str, const char *delim, char **saveptr) {\n  if (*saveptr == NULL)\n    return NULL;\n  char *last = (str) ? str + strlen(str) : *saveptr + 1 + strlen(*saveptr + 1);\n  char *ret = (str) ? strtok(str, delim) : strtok(*saveptr + 1, delim);\n  *saveptr = (ret) ? ret + strlen(ret) : ret;\n  *saveptr = (*saveptr != last) ? *saveptr : NULL;\n\n  return ret;\n}\n</code></pre>\n\n<p>Then your code would look like this:</p>\n\n<pre><code>char *str = \"ab;cd\";\nconst char *delim = \";\";\nchar *state = str;\n\nchar *p = my_strtok(str, delim, &amp;state);\nwhile (p != NULL)\n{\n    puts(p);\n    p = strtok(NULL, delim, &amp;state);\n}\n</code></pre>\n\n<p>The advantage of <code>my_strtok</code> is that it also works with nested calls.</p>\n"}], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 48086001, "answer_count": 3, "score": 4, "last_activity_date": 1515082917, "creation_date": 1515012930, "last_edit_date": 1515060564, "question_id": 48085000, "link": "https://stackoverflow.com/questions/48085000/does-explicit-usage-of-strtok-is-enough-to-make-it-reentrant", "title": "Does explicit usage of strtok is enough to make it reentrant?", "body": "<p>Reffering to C11 (N1570 draft), 7.24.5.8 <em>The strtok function</em>:</p>\n\n<blockquote>\n  <p>The <code>strtok</code> function is not required to avoid data races with other\n  calls to the <code>strtok</code> function.<sup>311)</sup></p>\n  \n  <p><sup>311) The <code>strtok_s</code> function can be used instead to avoid data races.</sup></p>\n</blockquote>\n\n<p>As I understand, this is due to its (global) <em>internal state</em>, which keeps information about the current position of the next token. This allows to use it like in the following idiom:</p>\n\n<pre><code>p = strtok(str, delim);\nwhile (p != NULL)\n{\n    puts(p);\n    p = strtok(NULL, delim);\n}\n</code></pre>\n\n<p>Assuming that <code>strtok_s</code> (defined in Annex K) is not available, would the following usage be sufficient for reentrancy, since it ignores the internal state entirely?</p>\n\n<pre><code>char str[] = \"ab;cd\";\nchar * const endstr = str + strlen(str);\nconst char *delim = \";\";\n\nchar *p = strtok(str, delim);\nwhile (p != NULL)\n{\n    puts(p);\n\n    if (p + strlen(p) == endstr) // detect ending token\n        break;\n    p = strtok(p + strlen(p)+1, delim);\n}\n</code></pre>\n\n<hr>\n\n<h3>Update:</h3>\n\n<p>On second thought, this technique probably should never be used, as it may lead to security issue. Since a sequence is never finished by the last call with <code>NULL</code>, the <code>strtok</code>'s internal state (consisting of an address to a token string) may be preserved during the remaining lifetime of an application.</p>\n"}, {"tags": ["c", "recursion", "visual-studio-2017"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1515011824, "post_id": 48084720, "comment_id": 83144307, "body": "Unless you enter give a negative number as input, no calls to <code>num_incr</code> will be called with <code>number &lt; 0</code>. That means you actually have infinite recursion. That would have been easy to find out if you <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">knew how to debug your programs</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6280245"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515011943, "post_id": 48084720, "comment_id": 83144353, "body": "we should assume we get a positive whole number"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515012008, "post_id": 48084720, "comment_id": 83144385, "body": "Infinite recursion it is then, no matter the (positive) input."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1515012035, "post_id": 48084720, "comment_id": 83144395, "body": "You are missing the point. Your stop condition is never true. Also re: <i>&quot;The function should return a new number&quot;</i> - printing and returning are vastly different things."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6280245"}, "edited": false, "score": 0, "creation_date": 1515012360, "post_id": 48084720, "comment_id": 83144543, "body": "it is true as i divide the number by 10 each time the function calls"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515012512, "post_id": 48084720, "comment_id": 83144622, "body": "@ElenaGo Yes. And what is e.g. <code>930 &#47; 10</code>? It&#39;s <code>93</code> and <code>93 &gt;= 0</code>. Then you continue with <code>93 &#47; 10</code> which is <code>9</code>, and <code>9 &gt;= 0</code>. Then you continue with <code>9 &#47; 10</code> which is <code>0</code> and <code>0 &gt;= 0</code> is true so you continue with <code>0 &#47; 10</code> which is <code>0</code> and so on and on and on and on... The function <i>never</i> reaches the <code>printf</code> call, and it should not print anything at all. In fact it should lead to a <i>crash</i> (after a long while)."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515012546, "post_id": 48084720, "comment_id": 83144633, "body": "so it works except you print out leading 0s and you&#39;re not supposed to?"}, {"owner": {"reputation": 51, "user_id": 7445165, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zzpEC-eXmaA/AAAAAAAAAAI/AAAAAAAAABw/HBHEUO0pXko/photo.jpg?sz=128", "display_name": "Devang Patel", "link": "https://stackoverflow.com/users/7445165/devang-patel"}, "edited": false, "score": 0, "creation_date": 1515012670, "post_id": 48084720, "comment_id": 83144693, "body": "If ( number == 0 ){ return; }"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6280245"}, "edited": false, "score": 0, "creation_date": 1515013418, "post_id": 48084720, "comment_id": 83145050, "body": "but i check if my number is less then or equal to 0, not greater"}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1515015635, "post_id": 48084720, "comment_id": 83145946, "body": "@ElenaGo Please read the comment from StoyTeller. Moreover, the statement should be phrased very carefully to avoid doubts. Specifically the number should probably be non negative. Solve this: &quot;Write a function which receives an unsigned int and returns an unsigned int in which every digit of its decimal representation is substituted by its successor (9 becomes 0).&quot; After you wrote such a function, test it with this: <code>int main(void) { unsigned int x = num_incr(930); }</code>. <b>Use a debugger</b> to read the value of x."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "edited": false, "score": 0, "creation_date": 1515012211, "post_id": 48084781, "comment_id": 83144460, "body": "It works on my server (Linux, only changing scanf_s to scanf).. can I ask for specific inputs which is not correct?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6280245"}, "edited": false, "score": 0, "creation_date": 1515012302, "post_id": 48084781, "comment_id": 83144512, "body": "on visual studio 2017 it requires use of scanf_s()"}, {"owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "edited": false, "score": 0, "creation_date": 1515012306, "post_id": 48084781, "comment_id": 83144515, "body": "Oh I didn&#39;t understand the question cleary. Sorry for that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1515012958, "post_id": 48084781, "comment_id": 83144840, "body": "@ElenaGo nope, Visual C is trying to force you to use MS non standard functions. The sooner you escape their clutches, the better. At the top (before any <code>#include</code>) I have the following three lines: <code>#define _CRT_SECURE_NO_WARNINGS \\ #define _CRT_SECURE_NO_DEPRECATE \\ #define _CRT_NONSTDC_NO_DEPRECATE</code> so I can ignore their attempts to hi-jack C."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6280245"}, "edited": false, "score": 0, "creation_date": 1515013536, "post_id": 48084781, "comment_id": 83145095, "body": "still didn&#39;t solve the problem, but thanks for that! yet helpful!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1515014205, "post_id": 48084781, "comment_id": 83145373, "body": "@ElenaGo my comment wasn&#39;t a solution, but a reply to your <i>&quot;on visual studio 2017 it requires use of <code>scanf_s()</code>&quot;</i>. Either stop using Visual C, or <b>force</b> it to allow standard C functions like <code>scanf</code> without it complaining. If you go along with MS demands, your code will be non-standard and non-portable."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1515016657, "post_id": 48084781, "comment_id": 83146373, "body": "@WeatherVane <code>scanf_s()</code> echos <a href=\"https://en.wikipedia.org/wiki/Embrace,_extend,_and_extinguish\" rel=\"nofollow noreferrer\">the 3 E&#39;s</a>"}], "tags": [], "owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "is_accepted": false, "score": 1, "last_activity_date": 1515012533, "last_edit_date": 1515012533, "creation_date": 1515011916, "answer_id": 48084781, "question_id": 48084720, "link": "https://stackoverflow.com/questions/48084720/c-language-increase-each-number-of-sequence-by-1-how-to-remove-0-in-the-begini/48084781#48084781", "title": "C language, increase each number of sequence by 1. how to remove 0 in the begining", "body": "<p>To remove 0 in beginning, first make the return function as integer and print at last.</p>\n\n<p>also In current code, the recursion is not finished because positive integer will be still positive when it is divided by 0.</p>\n\n<pre><code>//if input 879021 - output 980132\n//if input 930 - output 41\n//if input 9999 - output 0\n//working with visual studio 2017\n\nint num_incr(int number);\n\nvoid main(){\n   int number = 0;\n   printf(\"Enter a whole number: \");\n   scanf_s(\"%d\", &amp;number);\n   printf(\"%d\\n\", num_incr(number));\n}\n\nint num_incr(int number) {\n   if (number &lt;= 0) {\n      return 0;\n   }\n   int up_part = num_incr(number / 10);\n   return up_part * 10 + ((number % 10 + 1) % 10);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6280245"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515022538, "creation_date": 1515011640, "last_edit_date": 1515012089, "question_id": 48084720, "link": "https://stackoverflow.com/questions/48084720/c-language-increase-each-number-of-sequence-by-1-how-to-remove-0-in-the-begini", "title": "C language, increase each number of sequence by 1. how to remove 0 in the begining", "body": "<p>You receive a number. Function should create a new number by changing each number (d=1,2,3,...) of the number to d+1. If 9 is in the middle of the number will be turned into 0. You should not check if the specific number is 9 (!) .\nThe function should return a new number.</p>\n\n<p>The problem in my code is that when I get a number that starts with 9, in the beginning it shows 0 (but it shouldn't as shown in examples below). </p>\n\n<pre><code>//if input 879021 - output 980132\n//if input 930 - output 41\n//if input 9999 - output 0\n//working with visual studio 2017\n\nvoid num_incr(int number);\n\nvoid main(){\n   int number = 0;\n   printf(\"Enter a whole number: \");\n   scanf_s(\"%d\", &amp;number);\n   num_incr(number);\n}\n\nvoid num_incr(int number) {\n   if (number &lt;= 0) {\n      return;\n   }\n   num_incr(number / 10);\n   printf(\"%d\", (number % 10 + 1) % 10);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1515009459, "post_id": 48084276, "comment_id": 83143358, "body": "<code>longitud=&amp;cable1;</code> doesn&#39;t make much sense without knowing what <code>cable1</code> is."}, {"owner": {"reputation": 192, "user_id": 7002816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zZvm.jpg?s=128&g=1", "display_name": "LosWochos", "link": "https://stackoverflow.com/users/7002816/loswochos"}, "edited": false, "score": 0, "creation_date": 1515009545, "post_id": 48084276, "comment_id": 83143404, "body": "Its basically the same what happens in the first 3 lines. The pointer longitud gets assigned with the adress of cable1, whatever cable1 might be. After that, you dereference the pointer to assign a value to cable1."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1515011294, "post_id": 48084276, "comment_id": 83144100, "body": "For strict type agreement use <code>*longitud = 40.5f ;</code> - the unadorned <code>40.5</code> is a <code>double</code> not a <code>float</code>.  Your compiler may otherwise issue warnings."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1515013076, "post_id": 48084276, "comment_id": 83144895, "body": "Don&#39;t edit your entire question away when it&#39;s solved. If someone answered your question you should accept their answer."}], "answers": [{"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1515011192, "creation_date": 1515011192, "answer_id": 48084638, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48084638#48084638", "title": "Difference between pointer declaration and indirection", "body": "<p><code>longitude</code> is a pointer to a float variable</p>\n\n<p><code>longitud=&amp;cable1</code> assigns the address of <code>cable1</code> (presumably a float?) to <code>longitud</code>, which now <em>references</em> <code>cable1</code>.</p>\n\n<p><code>*longitud=40.5</code> dereferences longitude and assign it value 40.5.  Because <code>longitud</code> references <code>cable1</code>, this assigns the value to <code>cable1</code>.  That is <code>*longitud</code> and <code>cable1</code> are the same thing.</p>\n\n<p>None of this really relates to the question title <em>\"Difference between pointer declaration and indirection\"</em> - <em>indirection</em> is a general computing concept, and <em>pointers</em> are the means by which indirection is effected in C and C++.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1515011371, "creation_date": 1515011371, "answer_id": 48084671, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48084671#48084671", "title": "Difference between pointer declaration and indirection", "body": "<p>Suppose you add one more (different) line in each section:</p>\n\n<pre><code>int m;              // m is int variable \nint *p;             // pointer p is pointing to an integer value\np = &amp;m;             // the memory address of m is assigned to p\n*p = 42;            // ADDED: assign 42 to m, where p points to\n\nfloat cable1;       // ADDED: the variable where longitud points\nfloat *longitud;    // pointer longitud is pointing to a float value\nlongitud = &amp;cable1; // the memory address of cable1 is assigned to longitud\n*longitud = 40.5f;  // assign 40.5 to cable1, where longitud points to\n</code></pre>\n\n<p>This completes the similar examples, which use different variable types.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "is_accepted": false, "score": 0, "last_activity_date": 1515012854, "last_edit_date": 1515012854, "creation_date": 1515012052, "answer_id": 48084815, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48084815#48084815", "title": "Difference between pointer declaration and indirection", "body": "<p>Cable1 needs to have a place memory before longitud can point to it. </p>\n\n<p>The first 3 lines do this:</p>\n\n<ol>\n<li>Set aside memory for an int.</li>\n<li>Create an int pointer.</li>\n<li>Get the int pointer to point at the int's memory address. Pointer references int.</li>\n</ol>\n\n<p>The second 3 lines do this:</p>\n\n<ol>\n<li>Create a float pointer.</li>\n<li>Get the float pointer to point to a nonexistent address.</li>\n<li>Try to assign a float value to that address.</li>\n</ol>\n\n<p>If on line 4 you wrote:</p>\n\n<pre><code>float cable1;\n</code></pre>\n\n<p>You would have set aside memory and everything would work fine.</p>\n\n<p>On the topic, you mean pointer declaration and dereferencing. I can give a short set of examples, though it mostly takes reading and practice to learn. Try these out and get a feel.</p>\n\n<pre><code>float f = 22.2f;   //sets aside memory for a float with the name \"f\", stores 22.2\nfloat *pf;         //declares a float pointer.\npf = &amp;f;           //sets pf to point to f's memory address. pf references p.\nprintf(\"%f\", *pf); //prints the value at the referenced address (22.2)\nprintf(\"%x\", pf);  //prints the memory address of the pointer itself\n*pf = 33.3f;       //changes the value at f's address to 33.3 (from 22.2)\nf = 44.4f;         //changes the value at f's address to 44.4 (from 33.3)\nfloat *pf2;\n*pf2 = 33.3        //BAD. pf2 is not assigned to an address, no value to change.\n*pf2 = f;          //BAD. pf2 has no memory address to copy the value to.\n*pf2 = pf;         //BAD. several reasons.\npf2 = pf;          //pf2 now points to f's address, too.\npf2 = &amp;f;          //redundant. Same as the last line.\n*pf2 = 55.5        //f has changed to 55.5. both pf2 and pf point to it.\n</code></pre>\n\n<p>Just think of the * as standing for \"pointer\" when you declare. When you use * later, it means \"dereference.\" Dereferencing a pointer means you want to look at/use/change the referenced value. Later on, you'll learn that pointers can point to other pointers. So the value of a (char **) type is type (char *), rather than type (char).</p>\n\n<p>If you don't have a book, I recommend C Programming - A Modern Approach 2nd Edition. It's a little dated but an excellent way to learn the fundamentals.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1515013760, "creation_date": 1515013760, "answer_id": 48085159, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48085159#48085159", "title": "Difference between pointer declaration and indirection", "body": "<p>After executing the lines</p>\n\n<pre><code>float cable1;       // ADDED: the variable where longitud points\nfloat *longitud;    // pointer longitud is pointing to a float value\nlongitud = &amp;cable1; // the memory address of cable1 is assigned to longitud\n</code></pre>\n\n<p>the following conditions are true:</p>\n\n<pre><code> longitude == &amp;cable1\n*longitude ==  cable1\n</code></pre>\n\n<p>IOW, the <em>expression</em> <code>*longitud</code> is equivalent to the expression <code>cable1</code>.  So when you write</p>\n\n<pre><code>*longitud = 40.5f;\n</code></pre>\n\n<p>this is equivalent to writing </p>\n\n<pre><code>cable1 = 40.5f;\n</code></pre>\n\n<p>The <code>*</code> operator <em>dereferences</em> the <code>longitud</code> pointer, such that the <em>expression</em> <code>*longitud</code> evaluates to the same thing as <code>cable1</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515018781, "post_id": 48085310, "comment_id": 83147194, "body": "Overall - quite good.  <code>int* p =     &#47;&#47; &quot;p&quot; is a pointer  ... </code> (<code>p</code> looks like an <i>object</i> here.) and &quot;A <b>pointer</b> is a value.&quot; could use some clarification."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515019905, "post_id": 48085310, "comment_id": 83147541, "body": "@chux Thanks. Let me know if the fix needs more work."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515020324, "post_id": 48085310, "comment_id": 83147664, "body": "Good luck on a potential <a href=\"https://stackoverflow.com/help/badges/95/reversal\">reversal</a>"}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515020420, "post_id": 48085310, "comment_id": 83147696, "body": "Ah, thanks. I still don\u2019t get all the tags and badges and hats and stuff."}], "tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": false, "score": 2, "last_activity_date": 1515019778, "last_edit_date": 1515019778, "creation_date": 1515014569, "answer_id": 48085310, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection/48085310#48085310", "title": "Difference between pointer declaration and indirection", "body": "<p>The concepts of <strong>value</strong>, <strong>pointer</strong>, and <strong>reference</strong> often trip people up, especially as they are often taught to look at them in terms of <em>implementation</em> and not in terms of the language.</p>\n\n<p>A <strong>value</strong> is a thing that exists and has meaning. It always has a <em>type</em> (a constraint on its meaning) like <code>int</code>, <code>float</code>, <code>char</code>, and <code>vector&lt;string&gt;</code>.</p>\n\n<p>An <strong>object</strong> is a <em>value that exists somewhere in memory</em>. (And not, say, mangled into a machine instruction code or produced on-the-fly in some way. That is, I could take out my memory chip and stick my finger on it, were my fingers nimble enough.)</p>\n\n<p>A <strong>reference</strong> is an <em>alias</em> \u2014 a name for an object. The name is convenient for us as programmers. How the compiler maintains that name does not really matter. All that matters (language perspective!) is that if you have a name, you have <em>direct access</em> to an object.</p>\n\n<p>To put that into perspective, whenever you <em>name</em> an object, you obtain a <em>direct reference</em> to that object. You can manipulate that object directly using its name.</p>\n\n<p>A <strong>pointer</strong> is a value. Its type is a location in the computer\u2019s memory of some object. With this location, I can gain access to the object\u2019s value. In other words, I can use a pointer to gain a direct reference to an object.</p>\n\n<p>Vocabulary + time = fickle understandings and encourage people to ask useless things<sup>2</sup>. Let\u2019s clean our minds up a little.</p>\n\n<ul>\n<li>First, a pointer is <em>not</em> a reference, it is an <em>indirect</em> reference. In order to get an actual, or <em>direct</em>, reference to a pointed-to object, we \u201c<em>dereference</em>\u201d the pointer. In other words, we perform a magic that transforms a pointer value to obtain a reference to an object.</li>\n</ul>\n\n<p>The mechanics of how a pointer works are typically framed in terms of how the underlying hardware does something like \u201cfollows a pointer to a value\u201d. We draw pictures with arrows and everything. We seem to forget to ask how this magic works. No one asks how variable names work either, but it is the exact same kind of magic. We simply trust when told \u201cthe compiler takes care of it\u201d.</p>\n\n<ul>\n<li>What is missed is the distinction between a (direct) reference (an alias or name for an object) and an indirect reference (a pointer or other thing that can be used to obtain a reference to an object).</li>\n</ul>\n\n<p>Before C++ the difference between direct and indirect references really only made sense in the context of a pointer, and it was easy to call a pointer \u201ca reference\u201d instead of the full phrase \u201can indirect reference\u201d, and so the vocabulary words mixed around in our heads, and we began to misunderstand the actual concepts involved.</p>\n\n<p>Enter C++, stage left. We now have things called \u201creferences\u201d in addition to pointers. In terms of the language, they are true aliases for other objects<sup>1</sup>.</p>\n\n<p>To put it to example:</p>\n\n<pre><code>int  x = 7;   // \"x\" is a reference to the integer object with value 7\nint&amp; y = x;   // \"y\" is a reference to the same integer object as \"x\".\n\nint* p =      // \"p\" is a pointer object whose value is an \n              //     indirect reference to some integer object:\n         &amp;x;  // The &amp; operator obtains an indirect reference (or pointer value) to \"x\"\n</code></pre>\n\n<p>And here is the last point. There are more than one meaning for \"&amp;\"!</p>\n\n<ul>\n<li>When attached to a type, it means that the type is a direct reference to some object</li>\n<li>When attached to an object, it means that an indirect reference to that object is obtained</li>\n</ul>\n\n<p><sub><sup>1</sup> In C++, the abstraction leaks, because the lifetime of an object is bound only to the original reference. But that\u2019s neither here nor there. There are other topics that deal with that here at SO.</sub></p>\n\n<p><sub><sup>2</sup> So, to answer everyone\u2019s favorite question: is a reference a pointer or not? The answer is, <em>it doesn\u2019t matter</em>. (Unless you are writing a compiler.) You are asking implementation details about magic used to maintain a language-level concept. So sometimes it may be an actual pointer, sometimes it may simply be another entry in the compiler\u2019s local symbol table, and it may even be something else if the compiler writer thinks it useful and appropriate.</sub></p>\n\n<p><sub><sup>3</sup>Language gets to be fuzzy. I had previously said <code>\"p\" is a pointer</code>. Technically, it is an object whose value is a pointer type. We can usually get away by just saying what type of thing an object is, though, and be well-understood. It is only when we are splitting hairs (in context) that the vocabulary needs more care, as it does here.</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 9169269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b93604b4f84403e745233ab37bef36c6?s=128&d=identicon&r=PG&f=1", "display_name": "mechanicalgirl", "link": "https://stackoverflow.com/users/9169269/mechanicalgirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 1, "answer_count": 5, "score": -5, "last_activity_date": 1515019778, "creation_date": 1515009372, "last_edit_date": 1515013018, "question_id": 48084276, "link": "https://stackoverflow.com/questions/48084276/difference-between-pointer-declaration-and-indirection", "title": "Difference between pointer declaration and indirection", "body": "<p>I'm reading a book and I have doubts about what each of these syntax does. The first three lines I can understand but the following do not. Thank you very much if you help me, Julieta</p>\n\n<pre><code>int m; //m is int variable \nint *p; //Pointer p pointing to an integer value\np=&amp;m //The memory address of the variable m is assigned to p\n\nfloat *longitud;\nlongitud=&amp;cable1;\n*longitud=40.5;\n</code></pre>\n"}, {"tags": ["c", "linux", "driver", "gpu", "performance-testing"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1515008985, "post_id": 48084174, "comment_id": 83143112, "body": "This is probably generated automatically by some kind of macro. It might have a bit-shifted version for use in bitfield-type values as well as an enum-type version."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 1, "creation_date": 1515009279, "post_id": 48084174, "comment_id": 83143272, "body": "I wouldn&#39;t rule out that it is just a bug in how the code was written. I&#39;m pretty well versed in this sort of thing and I can&#39;t think of a good reason to write this. It could fall out of a badly written automatic code generator, but even that is fairly sloppy."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1515010669, "post_id": 48084174, "comment_id": 83143859, "body": "@Zalman Stern: Nope. If this is intended for placing an integer value into a manually impemented bit-field at bit-offset <code>0</code>, then shift by <code>0</code> is a very good programming practice. I&#39;d go as far as state that this is <i>required</i> in any self-respecting code."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1515018792, "post_id": 48084174, "comment_id": 83147198, "body": "Ok, I can see that, though in that case, I&#39;d probably go ahead and mask it with the bitfield mask as well."}], "answers": [{"comments": [{"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 1, "creation_date": 1515009358, "post_id": 48084235, "comment_id": 83143310, "body": "The values given are linearly consecutive, not powers of two so the usage is just very confusing. Making conceptually different things -- single bit flags vs. a linear enumeration -- visually consistent is not helpful."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1515009833, "post_id": 48084235, "comment_id": 83143519, "body": "@Zalman Stern: This could simply mean that these values are intended for placement onto a multi-bit bit-field located at offset <code>0</code> in the containing word. See the extra example above."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1515010041, "post_id": 48084235, "comment_id": 83143621, "body": "I usually shift by 0 for this reason .. surely the compiler just optimizes it out."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515013097, "post_id": 48084235, "comment_id": 83144908, "body": "Good use of <code>u</code> in forming the shift values."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1515018960, "post_id": 48084235, "comment_id": 83147240, "body": "Answer is much better after addition of context on bitfields. Once again, the original header should document that and such if this is the use. Really though, I cannot recall having seen this <i>ever</i> in a vast experience of programming. I&#39;ve seen techniques that use a single macro to put the value into a bitfield and I&#39;ve seen using a named constant for the shift offset. (Where the value of one of the shift constants might be zero.)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1515028434, "post_id": 48084235, "comment_id": 83149652, "body": "Even more it is the constant value which is evaluated the compile time and those &quot;shifts&quot; will not appear in the compiled code \\."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 10, "last_activity_date": 1515020434, "last_edit_date": 1515020434, "creation_date": 1515009189, "answer_id": 48084235, "question_id": 48084174, "link": "https://stackoverflow.com/questions/48084174/what-is-the-purpose-of-bitshifting-by-0/48084235#48084235", "title": "What is the purpose of bitshifting by 0", "body": "<p>Things like that could be done just for the sake of consistency (not necessarily applicable to your specific case). For example, I can describe a set of single-bit flags as</p>\n\n<pre><code>#define FLAG_1 0x01\n#define FLAG_2 0x02\n#define FLAG_3 0x04\n#define FLAG_4 0x08\n</code></pre>\n\n<p>or as</p>\n\n<pre><code>#define FLAG_1 (1u &lt;&lt; 0)\n#define FLAG_2 (1u &lt;&lt; 1)\n#define FLAG_3 (1u &lt;&lt; 2)\n#define FLAG_4 (1u &lt;&lt; 3)\n</code></pre>\n\n<p>In the first line of the latter approach I did not have to shift by <code>0</code>. But it just looks more consistent that way and emphasizes the fact that <code>FLAG_1</code> has the same nature as the rest of the flags. And <code>0</code> acts as a placeholder for a different value, if I some day decide to change it.</p>\n\n<p>You can actually see exactly that in the linked code with shift by <code>0</code> in the definitions of <code>DYN_OR_EN</code> and <code>DYN_RR_EN</code> macros.</p>\n\n<hr>\n\n<p>The approach can be extended to multi-bit fields within a word, like in the following (contrived) example</p>\n\n<pre><code>// Bits 0-3 - lower counter, bits 4-7 - upper counter\n\n#define LOWER_0  (0u &lt;&lt; 0)\n#define LOWER_1  (1u &lt;&lt; 0)\n#define LOWER_2  (2u &lt;&lt; 0)\n#define LOWER_3  (3u &lt;&lt; 0)\n\n#define UPPER_0  (0u &lt;&lt; 4)\n#define UPPER_1  (1u &lt;&lt; 4)\n#define UPPER_2  (2u &lt;&lt; 4)\n#define UPPER_3  (3u &lt;&lt; 4)\n\nunsigned packed_counters = LOWER_2 + UPPER_3; /* or `LOWER_2 | UPPER_3` */\n</code></pre>\n\n<p>Again, shifts by <code>0</code> bits are present purely for visual consistency. As well as shifts of <code>0</code> values.</p>\n\n<p>You can actually see exactly that in the linked code with shift by <code>0</code> in the definitions of <code>LC_XMIT_N_FTS</code> and <code>LC_XMIT_N_FTS_MASK</code> macros.</p>\n"}], "owner": {"reputation": 83, "user_id": 8078297, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-37IesAjs3CY/AAAAAAAAAAI/AAAAAAAAMpc/0Luaphlaa60/photo.jpg?sz=128", "display_name": "Michael Honey", "link": "https://stackoverflow.com/users/8078297/michael-honey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 48084235, "answer_count": 1, "score": 4, "last_activity_date": 1515020434, "creation_date": 1515008900, "last_edit_date": 1515009282, "question_id": 48084174, "link": "https://stackoverflow.com/questions/48084174/what-is-the-purpose-of-bitshifting-by-0", "title": "What is the purpose of bitshifting by 0", "body": "<p>I am reviewing the open source AMD GPU drivers for Linux. I noticed something I haven't seen before, and I would like to know the purpose. On line 1441 of the sid.h file, there are a series of defines that are integers being bitshifted left by 0. Wouldn't this just result in the original integer being operated on?</p>\n\n<p>Here is an excerpt and a link to the head</p>\n\n<pre><code>    #define VGT_EVENT_INITIATOR                      0xA2A4\n    #define SAMPLE_STREAMOUTSTATS1                   (1 &lt;&lt; 0)\n    #define SAMPLE_STREAMOUTSTATS2                   (2 &lt;&lt; 0)\n    #define SAMPLE_STREAMOUTSTATS3                   (3 &lt;&lt; 0)\n</code></pre>\n\n<p><a href=\"https://github.com/torvalds/linux/blob/master/drivers/gpu/drm/amd/amdgpu/sid.h#L1441\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/drivers/gpu/drm/amd/amdgpu/sid.h#L1441</a></p>\n\n<p>Also, I am learning to access the performance counter registers of AMD GPUs in order to calculate the GPU load. Any tips on that would be appreciated as well.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1515008867, "post_id": 48084160, "comment_id": 83143051, "body": "The indentation here is total chaos. Can you fix that?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 7, "creation_date": 1515008919, "post_id": 48084160, "comment_id": 83143082, "body": "It&#39;s entirely unclear why the return type of <code>reading</code> is <code>float***</code>. It&#39;s also returning a pointer to a stack-allocated <code>x</code> which falls out of scope, so that&#39;s undefined behaviour."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1515009254, "post_id": 48084160, "comment_id": 83143253, "body": "Who the h*** forces you to become a <a href=\"http://wiki.c2.com/?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">three star programmer</a>? It&#39;s <i>not</i> a compliment to be called that. As for the rest of the code, perhaps you misunderstand what you&#39;re supposed to do?"}, {"owner": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "edited": false, "score": 0, "creation_date": 1515009449, "post_id": 48084160, "comment_id": 83143351, "body": "I need to return a pointer to the array containing the values from the file."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515009556, "post_id": 48084160, "comment_id": 83143411, "body": "You need to allocate memory on the heap"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515011541, "post_id": 48084160, "comment_id": 83144183, "body": "@ClaudiusDan Well you&#39;ve allocated space for your <code>float *</code>, but you are returning a <code>float ***</code>, so you&#39;d need to allocate space for the <code>float **</code> that holds your <code>float *</code>, and for the <code>float ***</code> that holds your <code>float **</code>. All of this just to satisfy the necessity of returning a <code>float ***</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515011798, "post_id": 48084160, "comment_id": 83144295, "body": "@ClaudiusDan With all that said, looking at the math you are using to calculate how much to allocate, I can&#39;t help but wonder if the intention of this is to be a 3D array."}, {"owner": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515011983, "post_id": 48084160, "comment_id": 83144374, "body": "@ChristianGibbons Thank you for your time. I figured that this is total garbage and I will create it with just one pointer. The numbers in the binary file represent the elements of two matrices. I needed to create a function that points to an array containing the elements from both matrices."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515015621, "post_id": 48084160, "comment_id": 83145937, "body": "You can&#39;t (safely) return pointers to local arrays \u2014 hence the duplicate.  You also appear to have or possibly two too many stars in your return type.  Being a <a href=\"http://c2.com/cgi/wiki?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">Three-Star Programmer</a> is not a good idea.  Occasionally, it may be necessary; it almost certainly isn&#39;t necessary here."}], "answers": [{"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 0, "last_activity_date": 1515009051, "creation_date": 1515009051, "answer_id": 48084205, "question_id": 48084160, "link": "https://stackoverflow.com/questions/48084160/values-in-pointer-automatically-deleted/48084205#48084205", "title": "Values in pointer automatically deleted", "body": "<p>The problem is that when you create the local variable, in this manner <code>*p</code> pointer to local array variable <code>float x[n]</code>, it is allocated on the stack and is hence unavailable once the function finishes execution. That is, you call the tune until end of its scope. So it causes <em>undefined behaviour</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "edited": false, "score": 0, "creation_date": 1515009632, "post_id": 48084271, "comment_id": 83143436, "body": "I&#39;m getting this error when trying to use <code>static float</code>: <code>storage size of \u2018x\u2019 isn\u2019t constant</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515009943, "post_id": 48084271, "comment_id": 83143572, "body": "It seems the C standard does not allow for Variable Length Arrays to be static."}, {"owner": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "edited": false, "score": 0, "creation_date": 1515010410, "post_id": 48084271, "comment_id": 83143757, "body": "Can there be a solution with <code>float *** reading(char* read_from) </code>? As it is mandatory to have it that way. Every other part of the code can be modified."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "edited": false, "score": 0, "creation_date": 1515010569, "post_id": 48084271, "comment_id": 83143817, "body": "@ClaudiusDan refer back to my comment on the main thread.  You need to allocate space on the heap if you wish to return a pointer to something created in your function."}, {"owner": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515011133, "post_id": 48084271, "comment_id": 83144026, "body": "@ChristianGibbons <code>float *p=malloc(2*n*n*sizeof(float));</code> still has undefined behaviour. Is there another way to allocate space?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "edited": false, "score": 0, "creation_date": 1515014187, "post_id": 48084271, "comment_id": 83145368, "body": "@ClaudiusDan: I thought <code>n</code> were a constant as it was  not  passed to the function. See edited answer."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 0, "last_activity_date": 1515014144, "last_edit_date": 1515014144, "creation_date": 1515009350, "answer_id": 48084271, "question_id": 48084160, "link": "https://stackoverflow.com/questions/48084160/values-in-pointer-automatically-deleted/48084271#48084271", "title": "Values in pointer automatically deleted", "body": "<p>One problem is that you return the address of a local variable (with automatic storage duration), which's lifetime ends at the end of the function. Dereferencing such a pointer after the lifetime has ended is undefined behaviour. If <code>n</code> is a compile time constant, a quick fix would be to declare the array <code>static</code>, such that its lifetime is up to the end of your program. Otherwise, you'll either have to pass the buffer to the function or let the function create the buffer dynamically.</p>\n\n<p>Further, your return type is pointer to pointer to pointer to float, which cannot be reinterpreted as a pointer to float.</p>\n\n<p>And you read in up to <code>2*n*n</code> values, whereas your array is declared of  size <code>n</code>. BTW: you can read in  the  buffer in one step (no  need for a loop here).</p>\n\n<p>The following code should fix these issues:</p>\n\n<pre><code>float * reading(char* read_from) {\n    float *p = calloc(2*n*n, sizeof(float));\n    FILE *fh= fopen (read_from, \"rb\");\n    fread (p, 2*n*n, sizeof (float), fh);\n    fclose (fh);\n    return p;\n}\n</code></pre>\n\n<p>Note that the caller is obliged to free the  memory once not uses any more.</p>\n"}], "owner": {"reputation": 223, "user_id": 7922052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e499dcd425b42b685b2eecaa8aef25b?s=128&d=identicon&r=PG&f=1", "display_name": "ClaudiusDan", "link": "https://stackoverflow.com/users/7922052/claudiusdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1515015519, "accepted_answer_id": 48084271, "answer_count": 2, "score": 0, "last_activity_date": 1515014144, "creation_date": 1515008833, "last_edit_date": 1515009144, "question_id": 48084160, "link": "https://stackoverflow.com/questions/48084160/values-in-pointer-automatically-deleted", "closed_reason": "Duplicate", "title": "Values in pointer automatically deleted", "body": "<p>I have a binary file which contains N numbers from an array. I want to return a pointer to the elements in the array.</p>\n\n<pre><code>float *** reading(char* read_from) {\n    float x[n], *p;\n    p=x;\n    int i;\n    FILE *fh= fopen (read_from, \"rb\");\n    for (i=0;i&lt;2*n*n;i++)\n        fread (&amp;x[i], sizeof (x[i]), 1, fh);\n    fclose (fh);\n    return p;\n}\n\nint main()\n{\n    float *var;\n    char *file=\"input.bin\"; //this would be user input\n    var=reading(file);\n    printf(\"%f\",*var);\n}\n</code></pre>\n\n<p>If I'm running this, the content of <code>var</code> gets deleted after I handle it. I tried switching to another pointer (declaring a <code>var1</code>) and it is not working.</p>\n\n<p>Edit: The function header is mandatory. It can not be modified. </p>\n"}, {"tags": ["c++", "c", "include", "shared-libraries"], "comments": [{"owner": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 3, "creation_date": 1515008752, "post_id": 48084107, "comment_id": 83142988, "body": "yes create namespace"}, {"owner": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 0, "creation_date": 1515008813, "post_id": 48084107, "comment_id": 83143024, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/namespace\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/namespace</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1515009041, "post_id": 48084107, "comment_id": 83143150, "body": "The solutions for this problem differ greatly between C and C++. Which is the target language?"}, {"owner": {"reputation": 1, "user_id": 7151238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419ca18d385523eea5e0b022ce27b07?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7151238/dan"}, "edited": false, "score": 0, "creation_date": 1515009475, "post_id": 48084107, "comment_id": 83143369, "body": "The library (solver) that I am including is itself written in C, and my code is in C++."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 3080, "user_id": 7590993, "user_type": "registered", "accept_rate": 94, "profile_image": "https://graph.facebook.com/10154373026397157/picture?type=large", "display_name": "Hariom Singh", "link": "https://stackoverflow.com/users/7590993/hariom-singh"}, "edited": false, "score": 1, "creation_date": 1515011864, "post_id": 48084107, "comment_id": 83144323, "body": "That&#39;s that I figured. Start with @HariomSingh &#39;s suggestion. This should be as simple as wrapping just about everything in the headers and C files for the first solver in <code>namespace solver1 { code goes here }</code> and hoping that a C++ compiler will happily compile the solvers (usually does). If it works, I&#39;d also wrap the second solver for consistency."}, {"owner": {"reputation": 1, "user_id": 7151238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419ca18d385523eea5e0b022ce27b07?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7151238/dan"}, "edited": false, "score": 0, "creation_date": 1515014070, "post_id": 48084107, "comment_id": 83145330, "body": "I am getting &quot;unknown type name &#39;namespace&#39;&quot; when I try to compile, with or without using inline <code>extern&quot;C&quot;</code> while including the solvers. These are my cmake flags: inline <code>set(CMAKE_CXX_FLAGS &quot;-std=c++11 -Os -fno-diagnostics-color -Wall&quot;)</code>"}], "owner": {"reputation": 1, "user_id": 7151238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8419ca18d385523eea5e0b022ce27b07?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7151238/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515008602, "creation_date": 1515008602, "question_id": 48084107, "link": "https://stackoverflow.com/questions/48084107/c-c-include-two-copies-of-the-same-library-different-code-same-method-names", "title": "C/C++ Include two copies of the same library (different code, same method names/variable names)", "body": "<p>I have two C solvers generated by CVXGEN, and I need to use them both in my code. I need to include solver.h from both of the solvers, which each contains a lot of structs and functions. It would be really hard to rename them all in all of the code (about 10k lines per solver). Is there a way to include them and use them in my code at the same time?</p>\n"}, {"tags": ["c", "visual-c++", "malloc", "heap", "free"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1515008590, "post_id": 48084042, "comment_id": 83142910, "body": "When you say the C and C++ layers - are they within the same application?  Also, if you are truly worried, you can overload the memory operators and put a debug shim in there to print who is calling what and going where.  My first thought was this might have something to do with .dll code as dynamic memory access within there can be finicky."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515008711, "post_id": 48084042, "comment_id": 83142970, "body": "If you get a crash in release builds only, that&#39;s a clear sign that you&#39;re doing something you should not, probably something leading to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a>. Typically, crashes that only happens in release builds but not debug builds tend to be because of uninitialized variables. A debug build may cause those to actually <i>be</i> initialized, probably as zero which for a pointer means it will be a null pointer. If you check for null pointers it will be caught in the debug build, but not in the release when the value is indeterminate."}, {"owner": {"reputation": 2351, "user_id": 95652, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ec011cd82cb04ba9519320c184623fc?s=128&d=identicon&r=PG", "display_name": "greggorob64", "link": "https://stackoverflow.com/users/95652/greggorob64"}, "edited": false, "score": 0, "creation_date": 1515008806, "post_id": 48084042, "comment_id": 83143020, "body": "the layer is a C# exe-&gt;C++\\CLI dll-&gt;linked in lib C file.  All in the same application.  We tried (as a test), to just put a simple call to a new method in the C layer (called do_call_free), and if we free the memory there, we&#39;re fine."}, {"owner": {"reputation": 2351, "user_id": 95652, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ec011cd82cb04ba9519320c184623fc?s=128&d=identicon&r=PG", "display_name": "greggorob64", "link": "https://stackoverflow.com/users/95652/greggorob64"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1515008914, "post_id": 48084042, "comment_id": 83143077, "body": "@Someprogrammerdude I thought the same thing.  The example we&#39;re working with is a simple malloc, setting the allocated memory to a string, and returning it.  We&#39;re allocating a char* (which we have verified is correct) and then freeing it later in the same method.    I am assuming there&#39;s something wrong in our project configuration somewhere, but that&#39;s exactly what i&#39;m posting here for :)"}], "answers": [{"tags": [], "owner": {"reputation": 2351, "user_id": 95652, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ec011cd82cb04ba9519320c184623fc?s=128&d=identicon&r=PG", "display_name": "greggorob64", "link": "https://stackoverflow.com/users/95652/greggorob64"}, "is_accepted": false, "score": 0, "last_activity_date": 1515767326, "creation_date": 1515767326, "answer_id": 48228268, "question_id": 48084042, "link": "https://stackoverflow.com/questions/48084042/debug-assertion-failed-invalid-heap-pointer-after-vs-upgrade/48228268#48228268", "title": "Debug Assertion Failed! Invalid Heap Pointer after VS upgrade", "body": "<p>So we figured it out.  There was a mistake in my project files where the Release builds where using the Debug C-runtime-library (the XML node was DebugLibrary, and we where using MultiThreadedDebugDLL instead of MulthThreadedDLL)</p>\n"}], "owner": {"reputation": 2351, "user_id": 95652, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4ec011cd82cb04ba9519320c184623fc?s=128&d=identicon&r=PG", "display_name": "greggorob64", "link": "https://stackoverflow.com/users/95652/greggorob64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 653, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1515767326, "creation_date": 1515008188, "question_id": 48084042, "link": "https://stackoverflow.com/questions/48084042/debug-assertion-failed-invalid-heap-pointer-after-vs-upgrade", "title": "Debug Assertion Failed! Invalid Heap Pointer after VS upgrade", "body": "<p>We recently upgrade our enterprise app from vs2015 to vs2017.  This entailed quite a bit of upgrades:</p>\n\n<p>Windows SDK to the newest version to 16299\nNewest C++ Runtime\n2017 debug support\nothers</p>\n\n<p>We have 3 layers to our application: A C# UI layer, a VC++\\CLI middle layer, and a C system layer.</p>\n\n<p>When EITHER of the following happen:\n-malloc memory in C layer, free in C++ layer\n-malloc in C++, free in C</p>\n\n<p>I get the following debug assertion <strong>(IN RELEASE BUILDS ONLY!)</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/rHS7E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rHS7E.png\" alt=\"Debug assertion failure\"></a></p>\n\n<p>At first we thought we didnt properly upgrade some of the Windows SDK's, but it doesn't seem to be that (after I removed every SDK other than 16299 and it still reproduced).  We did the same thing with debug support and the C++ runtime.</p>\n\n<p>For some reason, it's like the C layer and the C++ layer are now using thier own heap.  This worked before our upgrade, and I cannot figure out what changed.</p>\n\n<p>Any ideas?\nThanks</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1515008239, "post_id": 48084028, "comment_id": 83142758, "body": "Why don&#39;t you show us the code that didn&#39;t work?  Don&#39;t make us guess what you did when using a <code>char</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 9, "creation_date": 1515008269, "post_id": 48084028, "comment_id": 83142772, "body": "<code>scanf</code> doesn&#39;t consume input that doesn&#39;t match, so the letter stays on the input. Check the return value from <code>scanf</code> to see if it succeeded."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1515008403, "post_id": 48084028, "comment_id": 83142836, "body": "Check by checking the return value of <code>scanf()</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1515008440, "post_id": 48084028, "comment_id": 83142853, "body": "Aside: <code>while (i == 0)</code> is an infinite loop anyway."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1515008710, "post_id": 48084028, "comment_id": 83142969, "body": "@WeatherVane there&#39;s a <code>break</code> hidden in there"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515008761, "post_id": 48084028, "comment_id": 83142994, "body": "@ChristianGibbons oh OK thanks myblind."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1515008918, "post_id": 48084028, "comment_id": 83143079, "body": "Another aside: <code>int number;</code> is <i>uninitialised</i>, so when a letter is typed the test may accidentally pass."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1515009038, "post_id": 48084028, "comment_id": 83143139, "body": "Apart from checking the return value from <code>scanf</code> I suggest adding <code>while(getchar() != &#39;\\n&#39;);</code> into the <code>else</code> block, to clear out the input buffer."}, {"owner": {"reputation": 99, "user_id": 9169708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-ltTzstleDDM/AAAAAAAAAAI/AAAAAAAAAAc/Q35uyOg64Bg/photo.jpg?sz=128", "display_name": "Adam Grey", "link": "https://stackoverflow.com/users/9169708/adam-grey"}, "edited": false, "score": 0, "creation_date": 1515009861, "post_id": 48084028, "comment_id": 83143527, "body": "So I printed the &quot;number&quot; variable after putting in &#39;r&#39; and it printed 0. But I still don&#39;t understand why it became an infinite loop as opposed to just printing &quot;success!&quot;. Also, how can I fix this? How can I make it print invalid number when the user puts in a character? Thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 9169708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-ltTzstleDDM/AAAAAAAAAAI/AAAAAAAAAAc/Q35uyOg64Bg/photo.jpg?sz=128", "display_name": "Adam Grey", "link": "https://stackoverflow.com/users/9169708/adam-grey"}, "edited": false, "score": 0, "creation_date": 1515010288, "post_id": 48084389, "comment_id": 83143707, "body": "Thanks, but how can I &quot;check the return value from <code>scanf</code>? I don&#39;t really know what that means."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 99, "user_id": 9169708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-ltTzstleDDM/AAAAAAAAAAI/AAAAAAAAAAc/Q35uyOg64Bg/photo.jpg?sz=128", "display_name": "Adam Grey", "link": "https://stackoverflow.com/users/9169708/adam-grey"}, "edited": false, "score": 0, "creation_date": 1515010560, "post_id": 48084389, "comment_id": 83143815, "body": "I did that in the <code>if</code> conditions. <code>scanf</code> will return <code>1</code> if there was one format specifer, which successfully converted the input. When you enter <code>&#39;a&#39;</code> it will not be converted to <code>int</code>, so <code>scanf</code> will return <code>0</code>, and the <code>&#39;a&#39;</code> remains in the input buffer. That is why your code went into infinite loop - the input is continuously refused."}, {"owner": {"reputation": 99, "user_id": 9169708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-ltTzstleDDM/AAAAAAAAAAI/AAAAAAAAAAc/Q35uyOg64Bg/photo.jpg?sz=128", "display_name": "Adam Grey", "link": "https://stackoverflow.com/users/9169708/adam-grey"}, "edited": false, "score": 0, "creation_date": 1515012071, "post_id": 48084389, "comment_id": 83144415, "body": "I think I get it now. Thanks."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 3, "last_activity_date": 1515009864, "creation_date": 1515009864, "answer_id": 48084389, "question_id": 48084028, "link": "https://stackoverflow.com/questions/48084028/if-else-statement-only-works-as-intended-with-integers/48084389#48084389", "title": "If/else statement only works as intended with integers.", "body": "<p>There were several suggestions to improve your code:</p>\n\n<ul>\n<li>Always check the return value from <code>scanf</code>, which tells you how many\ninputs were successfully read.</li>\n<li>Unprocessed input remains in the input buffer - and has to be cleared\nout.</li>\n<li>Uninitialised variables can mislead you.</li>\n<li>Make use of the <code>i</code> variable which controls the loop.</li>\n</ul>\n\n<p>Amended with comments:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    int i = 0;\n    int number = 0;                                 // an invalid value\n    while (i == 0) {\n        printf(\"Enter a number greater than 0 and smaller than 23.\\n\");\n        if(scanf(\"%d\", &amp;number) == 1 &amp;&amp; number &lt; 23 &amp;&amp; number &gt; 0 ) {\n            printf(\"Success!\\n\");\n            i = 1;                                  // satisfy the loop control\n        } else {\n            printf(\"Invalid number.\\n\");\n            while(getchar() != '\\n');               // clear the input buffer\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "is_accepted": false, "score": 0, "last_activity_date": 1515014418, "creation_date": 1515014418, "answer_id": 48085277, "question_id": 48084028, "link": "https://stackoverflow.com/questions/48084028/if-else-statement-only-works-as-intended-with-integers/48085277#48085277", "title": "If/else statement only works as intended with integers.", "body": "<p>Simply, the entered value is out of the checked span 0 to 23. What you get when enter a character puts some very bad value in your int variable width. Why? Because the scanf function takes the input as a decimal number, so it reads more than a character, and whatever is in memory around, gets picked as a number. I hope that his helps.\nThis is a commonly encountered problem, please look into the usage of scanf here: <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdio/scanf/</a></p>\n"}], "owner": {"reputation": 99, "user_id": 9169708, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-ltTzstleDDM/AAAAAAAAAAI/AAAAAAAAAAc/Q35uyOg64Bg/photo.jpg?sz=128", "display_name": "Adam Grey", "link": "https://stackoverflow.com/users/9169708/adam-grey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 48084389, "answer_count": 2, "score": 0, "last_activity_date": 1515014418, "creation_date": 1515008132, "last_edit_date": 1515008459, "question_id": 48084028, "link": "https://stackoverflow.com/questions/48084028/if-else-statement-only-works-as-intended-with-integers", "title": "If/else statement only works as intended with integers.", "body": "<p>It works fine until you put in a character, then it becomes an infinite loop, as opposed to just saying \"invalid number\". I don't understand why. Please help?    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main (void)\n{\nint i = 0;\nint number;\nwhile (i == 0){\n        printf(\"Enter a number greater than 0 and smaller than 23.\\n\");\n        scanf (\" %d\", &amp;number);\n        if (number &lt; 23 &amp;&amp; number &gt; 0 ){\n            printf(\"Sucess!\\n\");\n            break;\n        } else {\n            printf(\"Invalid number.\\n\");\n}\n}\n}\n</code></pre>\n"}, {"tags": ["android", "c++", "c", "android-ndk"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1515007881, "post_id": 48083883, "comment_id": 83142587, "body": "Possible duplicate? <a href=\"https://stackoverflow.com/questions/270113/how-do-i-stop-sem-open-failing-with-enosys\" title=\"how do i stop sem open failing with enosys\">stackoverflow.com/questions/270113/&hellip;</a>"}, {"owner": {"reputation": 175, "user_id": 7880116, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FjWjc.jpg?s=128&g=1", "display_name": "KoLiBer", "link": "https://stackoverflow.com/users/7880116/koliber"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1515014489, "post_id": 48083883, "comment_id": 83145471, "body": "i use semaphores in android ( elinux ) not in linux kernel base os - is there any way or another header to use semaphores on android ? or i only can use pthread mutex , cond vars for android native synchronization ?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1515015269, "post_id": 48083883, "comment_id": 83145788, "body": "According to a comment on this answer: <a href=\"https://stackoverflow.com/a/18606519/8513665\">stackoverflow.com/a/18606519/8513665</a> , Android does not implement <code>sem_open(3)</code> (hence the ENOSYS).  Nor does it apparently support <code>SysV semaphores</code>.  Another comment on that answer mentions using an unnamed semaphore (with <code>sem_init</code>) in shared memory, so maybe that&#39;ll work."}, {"owner": {"reputation": 175, "user_id": 7880116, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FjWjc.jpg?s=128&g=1", "display_name": "KoLiBer", "link": "https://stackoverflow.com/users/7880116/koliber"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1524817359, "post_id": 48083883, "comment_id": 87132877, "body": "thank&#39;s , using pthread mutexes solved my problem"}], "owner": {"reputation": 175, "user_id": 7880116, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/FjWjc.jpg?s=128&g=1", "display_name": "KoLiBer", "link": "https://stackoverflow.com/users/7880116/koliber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 896, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1515007502, "creation_date": 1515007502, "question_id": 48083883, "link": "https://stackoverflow.com/questions/48083883/android-native-semaphore-not-implemented", "title": "Android Native Semaphore Not implemented", "body": "<p>When using native semaphores (semaphore.h) on android i faced with this error : </p>\n\n<p><code>Error : Function not implemented\n</code></p>\n\n<p>My native code : </p>\n\n<p><code>sem_t *sem = sem_open(name , O_CREAT | O_EXCL , 0666 , value);\n</code></p>\n\n<p>i think this error is related to <code>rt</code> library, is there any way to link <code>librt</code> to toolchain ?</p>\n"}, {"tags": ["c", "gcc", "glibc", "backtrace"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1515006586, "post_id": 48083494, "comment_id": 83142002, "body": "symbol names are looked up in debug sections of the executable. So, you need to allow some &#39;-g&#39; flag, like &#39;-g2&#39;. Also, you might want to turn off optimizations with &#39;-O0&#39;"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1515007485, "post_id": 48083494, "comment_id": 83142428, "body": "The stack trace you showed <i>does</i> have function names in it.  See where it says <code>a.out(foo+0x9)</code>? <code>foo</code> is the function name.  There is one on each line of the trace."}, {"owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1515007754, "post_id": 48083494, "comment_id": 83142539, "body": "@zwol Ahem -- please pardon me while I firmly palm my face. the different format of the backtrace (from what MacOS/clang produced) tricked me. Thank you for pointing out the obvious.  Happy to mark that as the accepted answer if it&#39;s a real answer.  Otherwise I&#39;ll add the answer myself (tagging you) later today."}], "answers": [{"comments": [{"owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "edited": false, "score": 0, "creation_date": 1515014793, "post_id": 48084084, "comment_id": 83145582, "body": "Ha!  My favorite type of problem:  The non-problem.  :)"}, {"owner": {"reputation": 121, "user_id": 2374597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42193bdb87d005156fcb286b188c6312?s=128&d=identicon&r=PG", "display_name": "Dima Litvinov", "link": "https://stackoverflow.com/users/2374597/dima-litvinov"}, "edited": false, "score": 1, "creation_date": 1589330807, "post_id": 48084084, "comment_id": 109249929, "body": "In addition to using <code>-rdynamic</code>, also check that your build system doesn&#39;t add <code>-fvisibility=hidden</code> option! (as it will completely  discard the effect of <code>-rdynamic</code>)"}], "tags": [], "owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "is_accepted": true, "score": 3, "last_activity_date": 1515008469, "creation_date": 1515008469, "answer_id": 48084084, "question_id": 48083494, "link": "https://stackoverflow.com/questions/48083494/how-do-i-use-the-rdynamic-linker-flag/48084084#48084084", "title": "How Do I use The -rdynamic Linker Flag?", "body": "<p>Per comments above, the <code>-rdynamic</code> flag was working without issue.  The problem was that clang on MacOS produced its output in a different format than GCC on my ubuntu VM.  </p>\n\n<p>The function name was there all along.</p>\n\n<pre><code># notice the function name `foo`\n./a.out(foo+0x9) [0x400b63]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1515009824, "creation_date": 1515009824, "answer_id": 48084377, "question_id": 48083494, "link": "https://stackoverflow.com/questions/48083494/how-do-i-use-the-rdynamic-linker-flag/48084377#48084377", "title": "How Do I use The -rdynamic Linker Flag?", "body": "<p>You could consider using Ian Taylor's <a href=\"https://github.com/ianlancetaylor/libbacktrace\" rel=\"nofollow noreferrer\">libbacktrace</a> (which is also part of recent <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>) for your backtracing goals. It wants the libraries and executables to be compiled with <a href=\"https://en.wikipedia.org/wiki/DWARF\" rel=\"nofollow noreferrer\">DWARF</a> information (so you compile with <code>-g</code> passed to <code>gcc</code>, and that can be mixed with optimization flags like <code>-O2</code>). But it gives more precise output (including line numbers for your call stack frames).</p>\n"}], "owner": {"reputation": 156951, "user_id": 4668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5abe1d27b286199c319b0cbe75596c3?s=128&d=identicon&r=PG", "display_name": "Alan Storm", "link": "https://stackoverflow.com/users/4668/alan-storm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 48084084, "answer_count": 2, "score": 1, "last_activity_date": 1515009824, "creation_date": 1515005752, "question_id": 48083494, "link": "https://stackoverflow.com/questions/48083494/how-do-i-use-the-rdynamic-linker-flag", "title": "How Do I use The -rdynamic Linker Flag?", "body": "<p>How can I use the <code>-rdynamic</code> flag to ensure glibc's backtrace functions will report the actual function/symbol names in a backtrace?</p>\n\n<p>I'm trying to use <a href=\"https://stackoverflow.com/questions/6934659/how-to-make-backtrace-backtrace-symbols-print-the-function-names\">C's backtrace functions</a> to create a backtrace.  On my MacOS machine, if I use the program <a href=\"https://stackoverflow.com/questions/6934659/how-to-make-backtrace-backtrace-symbols-print-the-function-names\">from this question</a></p>\n\n<pre><code>#include &lt;execinfo.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void full_write(int fd, const char *buf, size_t len)\n{\n        while (len &gt; 0) {\n                ssize_t ret = write(fd, buf, len);\n\n                if ((ret == -1) &amp;&amp; (errno != EINTR))\n                        break;\n\n                buf += (size_t) ret;\n                len -= (size_t) ret;\n        }\n}\n\nvoid print_backtrace(void)\n{\n        static const char start[] = \"BACKTRACE ------------\\n\";\n        static const char end[] = \"----------------------\\n\";\n\n        void *bt[1024];\n        int bt_size;\n        char **bt_syms;\n        int i;\n\n        bt_size = backtrace(bt, 1024);\n        bt_syms = backtrace_symbols(bt, bt_size);\n        full_write(STDERR_FILENO, start, strlen(start));\n        for (i = 1; i &lt; bt_size; i++) {\n                size_t len = strlen(bt_syms[i]);\n                full_write(STDERR_FILENO, bt_syms[i], len);\n                full_write(STDERR_FILENO, \"\\n\", 1);\n        }\n        full_write(STDERR_FILENO, end, strlen(end));\n    free(bt_syms);\n}\nvoid foo()\n{\n    print_backtrace();\n}\n\nint main()\n{\n    foo();\n    return 0;\n}\n</code></pre>\n\n<p>and then compile it, I end up with a program that outputs a stack trace including function names. </p>\n\n<pre><code>$ clang main.c \n$ ./a.out \nBACKTRACE ------------\n1   a.out                               0x0000000100c9fec9 foo + 9\n2   a.out                               0x0000000100c9fee4 main + 20\n3   libdyld.dylib                       0x00007fff9669f235 start + 1\n----------------------\n</code></pre>\n\n<p>However, if I attempt to compile the program on an Ubuntu virtual machine using gcc, I get no function names. </p>\n\n<pre><code>$ gcc-5 main.c \n$ ./a.out \nBACKTRACE ------------\n./a.out() [0x4008c3]\n./a.out() [0x4008d4]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0) [0x7fbc9fee2830]\n./a.out() [0x400649]\n----------------------\n</code></pre>\n\n<p>The aformentioned previous question says the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html\" rel=\"nofollow noreferrer\">-rdynamic</a> flag is my savior, but when I try that flag I still don't get function names in my backtrace</p>\n\n<pre><code>$ gcc-5 -rdynamic main.c\n$ ./a.out \nBACKTRACE ------------\n./a.out(foo+0x9) [0x400b63]\n./a.out(main+0xe) [0x400b74]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0) [0x7f8cbbf20830]\n./a.out(_start+0x29) [0x4008e9]\n</code></pre>\n\n<p>I'm a little overwhelmed at what to do next -- am I using the flag wrong?  Or am I using it correctly and there's something else that might prevent the symbols from showing up in this simple program. </p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1515005406, "post_id": 48083376, "comment_id": 83141402, "body": "Well, for one thing, you must terminate the argument list to <code>execlp()</code> with a null pointer of type <code>char *</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1515005440, "post_id": 48083376, "comment_id": 83141423, "body": "What\u2019s in <code>buffer</code>?  Unless it is a single word command like <code>ls</code> or <code>who</code>, it won\u2019t work.  Note that a newline would screw things up.  Shells take care of newlines for you. When you write your own shell, you have to take care of them."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1515005478, "post_id": 48083376, "comment_id": 83141448, "body": "Note also that outputting error messages via <code>perror()</code> is usually more informative than is printing return codes."}, {"owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515005487, "post_id": 48083376, "comment_id": 83141458, "body": "@JohnBollinger so <code>buffer[bytes_read-1] = &#39;\\0&#39;;</code> isn&#39;t doing what I though ti would do? @JonathanLeffler I know, I am trying to build it step by step"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1515005508, "post_id": 48083376, "comment_id": 83141472, "body": "Isn&#39;t because you did <code>exit(1);</code>?"}, {"owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "reply_to_user": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1515005553, "post_id": 48083376, "comment_id": 83141492, "body": "@smac89 <code>exec*</code> functions shouldn&#39;t return so this code should be unreachable"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1515005572, "post_id": 48083376, "comment_id": 83141504, "body": "No, @gonczor, that&#39;s not at all the same thing.  You <i>do</i> need to terminate each argument string with a null terminator, but what I&#39;m talking about is adding <code>(char *) NULL</code> as a whole additional argument."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1515005576, "post_id": 48083376, "comment_id": 83141507, "body": "@gonczor that isn&#39;t doing what John described. That is terminating a string. You need to also terminate the <i>argument list</i> with an additional null <i>pointer</i>."}, {"owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1515005669, "post_id": 48083376, "comment_id": 83141562, "body": "@JohnBollinger it helped. I&#39;ll be happy to accept it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1515006267, "creation_date": 1515006267, "answer_id": 48083615, "question_id": 48083376, "link": "https://stackoverflow.com/questions/48083376/fork-exec-wait-exits-with-error-code/48083615#48083615", "title": "fork exec wait exits with error code", "body": "<p>Together, the second argument argument to <code>execlp()</code> and any subsequent arguments correspond to the strings provided to the new program's <code>main()</code> function in its argument vector.  They must all be pointers to null-terminated C strings, except that the end of the list <em>must</em> be marked by a null pointer of type <code>char *</code>.  For example:</p>\n\n<pre><code>execlp(buffer, buffer, (char *) NULL);\n</code></pre>\n\n<p>This is a documented requirement for the arguments to this function, and your program mail fail if you do not satisfy it.  If you wish, you may rationalize it as providing a means for the system to count the elements of the argument vector, so as to pass that number to the new <code>main()</code>.  You may also consider that the argument vector itself is documented to be terminated by a null pointer.</p>\n"}], "owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 48083615, "answer_count": 1, "score": 2, "last_activity_date": 1515006267, "creation_date": 1515005203, "last_edit_date": 1515005420, "question_id": 48083376, "link": "https://stackoverflow.com/questions/48083376/fork-exec-wait-exits-with-error-code", "title": "fork exec wait exits with error code", "body": "<p>I am writing own shell-like program and I keep getting errors on <code>exec*</code> function call.</p>\n\n<p>Here is source code of core <code>processes.c</code>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/uio.h&gt;\n\n#define BUFSIZE 128\n#define EXIT_STR \"exit\"\n\nint main(int argc, char ** argv) {\n    const char *prompt = \"&gt; \";\n    char buffer[BUFSIZE];\n    int bytes_read;\n    int status;\n    pid_t child_p;\n\n    while(1) {\n        printf(\"%s\", prompt);\n        fflush(stdout);\n        bytes_read = read(0, buffer, BUFSIZE);\n        buffer[bytes_read-1] = '\\0';\n\n        if(strncmp(EXIT_STR, buffer, bytes_read) == 0)\n            exit(0);\n\n        if((child_p = fork()) == 0) {\n            printf(\"[*] %d executing: %s\\n\", getpid(), buffer);\n            execlp(buffer, buffer);\n            printf(\"[*] %d got error on execlp\\n\", getpid());\n            exit(1);\n        } else {\n            waitpid(child_p, &amp;status, 0);\n            printf(\"[*] child returned: %d\\n\", status);\n        }\n    }\n}\n</code></pre>\n\n<p>I have also simple <code>other.c</code> program for testing:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char **argv){\n    printf(\"Hello. I am %s with pid: %d\\n\", argv[0], getpid());\n    exit(0);\n}\n</code></pre>\n\n<p>I use <code>llvm</code> on MacOS High Sierra for compilation:</p>\n\n<pre><code> $  llvm-gcc processes.c -o processes -Wall\n $  ./processes\n&gt; other\n[*] 6040 executing: other\n[*] 6040 got error on execl\n[*] child returned: 256\n&gt; ls\n[*] 6041 executing: ls\n[*] 6041 got error on execl\n[*] child returned: 256\n&gt; exit\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c", "multithreading", "posix"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1515004432, "post_id": 48083061, "comment_id": 83140907, "body": "For gcc, thread local storage (TLS) is allocated in the thread stack memory, so exists as soon as the stack is allocated.  Note that the stack size in the pthread attributes must be large enough to include the TLS."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 3, "creation_date": 1515004687, "post_id": 48083061, "comment_id": 83141040, "body": "@stark, the local variables of a thread function are not at all the same thing as TLS."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1515015664, "post_id": 48083061, "comment_id": 83145962, "body": "Obviously, local variables of a function are allocated on the stack at entry to the function whether it is a thread or not.  I assumed this was not what the OP meant to ask."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1515049716, "post_id": 48083061, "comment_id": 83154897, "body": "<code>auto</code> variables have block scope, so you are not supposed to care. At the return of pthread_create they may, or may not, exist (probably not - the thread exists but has not yet begun executing)"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1515004528, "creation_date": 1515004528, "answer_id": 48083237, "question_id": 48083061, "link": "https://stackoverflow.com/questions/48083061/when-are-thread-function-local-variables-allocated-with-posix/48083237#48083237", "title": "When are thread function local variables allocated with Posix?", "body": "<blockquote>\n  <p>in other words after</p>\n\n<pre><code>pthread_create(&amp;thread, &amp;function, ...)\n</code></pre>\n  \n  <p>is executed, can I say that they exists in memory or not (considering\n  that the scheduler could have not executed the thread yet)?</p>\n</blockquote>\n\n<p>POSIX does not give you any reason for confidence that the local variables of the initial call to function <code>function()</code> in the created thread will have been allocated by the time <code>pthread_create()</code> returns.  They might or might not have been, and indeed, the answer might not even be well defined inasmuch as different threads do not necessarily have a consistent view of machine state.</p>\n\n<p>There is no special significance to the local variables of a thread's start function relative to the local variables of any other function called in that thread.  Moreover, although <code>pthread_create()</code> will not return successfully until the new thread has been created, that's a separate question from whether the start function has even been entered, much less whether its local variables have been allocated.</p>\n"}], "owner": {"reputation": 192, "user_id": 3146304, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/910a00fe8ce2c21e16e131ebf88316e2?s=128&d=identicon&r=PG&f=1", "display_name": "Vitto", "link": "https://stackoverflow.com/users/3146304/vitto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515019632, "creation_date": 1515003803, "question_id": 48083061, "link": "https://stackoverflow.com/questions/48083061/when-are-thread-function-local-variables-allocated-with-posix", "title": "When are thread function local variables allocated with Posix?", "body": "<p>I know it's a very specific question and it's not very interesting for a high level programmer, but I would like to know when exactly are allocated the local variables of a thread function, in other words after</p>\n\n<pre><code>pthread_create(&amp;thread, &amp;function, ...)\n</code></pre>\n\n<p>is executed, can I say that they exists in memory or not (considering that the scheduler could have not executed the thread yet)? \nI tried to search in the posix library code but it's not easy to understand, I arrive at the <code>clone</code> function, written in assembly, but than I cannot find che code of the system call service routine <code>sys_clone</code> to understand what exactly it does. I see in the <code>clone</code> code the invocation of the thread function, but I think this should happen only in the created thread (which could have never been executed by the scheduler when pthread_create is terminated) and not in the creator. </p>\n"}, {"tags": ["c", "redis", "segmentation-fault", "hiredis"], "answers": [{"tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": false, "score": 1, "last_activity_date": 1515006723, "last_edit_date": 1515006723, "creation_date": 1515006068, "answer_id": 48083567, "question_id": 48083028, "link": "https://stackoverflow.com/questions/48083028/libhiredis-does-not-work-when-passing-rediscontext-into-another-function/48083567#48083567", "title": "libhiredis does not work when passing redisContext into another function", "body": "<p><code>redis_context</code> in <code>redis_wrapper_init</code> should be passed by <em>reference</em> (in C by pointer) to keep result of assignment <code>redis_context = redisConnect(ip, port);</code> after calling this function. Without this, you assign pointer returned by redisConnect to local variable, which is destroyed when function returns.</p>\n\n<p>So definition should be </p>\n\n<pre><code>int redis_wrapper_init(redisContext ** redis_context, char* ip, int port) {\n  *redis_context = redisConnect(ip, port);\n\n  if (*redis_context == NULL || (*redis_context)-&gt;err) {\n      if (*redis_context) {\n        fprintf(stderr, \"cget: redis init error: %s\\n\", (*redis_context)-&gt;errstr);\n      }\n      ...\n  }\n}\n</code></pre>\n\n<p>in <em>main</em> you get address of <code>redis_context</code> variable and pass it to <code>redis_wrapper_init</code></p>\n\n<pre><code>redisContext *redis_context = 0;\nredis_wrapper_init(&amp;redis_context, \"127.0.0.1\", 6379);\n</code></pre>\n"}], "owner": {"reputation": 1371, "user_id": 964491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4758a41e90f6f8189bc6b7c4404dcf09?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/964491/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515006723, "creation_date": 1515003635, "last_edit_date": 1515004756, "question_id": 48083028, "link": "https://stackoverflow.com/questions/48083028/libhiredis-does-not-work-when-passing-rediscontext-into-another-function", "title": "libhiredis does not work when passing redisContext into another function", "body": "<p>I am trying to write my own wrapper function to libhiredis to use in my project but when i try to pass the redis_context into another function to issue commands from there. The code segfaults and reports this through gdb:</p>\n\n<p>GDB Error:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\nsdscatlen (s=0x0, t=0x555555757690, len=22) at sds.c:239\n239     sds.c: No such file or directory.\n(gdb) backtrace \n#0  sdscatlen (s=0x0, t=0x555555757690, len=22) at sds.c:239\n#1  0x00007ffff7bcd300 in __redisAppendCommand (c=0x7fffffffddd0, cmd=&lt;optimized out&gt;, len=&lt;optimized out&gt;) at hiredis.c:910\n#2  0x00007ffff7bcd38c in redisvAppendCommand (c=0x7fffffffddd0, format=&lt;optimized out&gt;, ap=&lt;optimized out&gt;) at hiredis.c:942\n#3  0x00007ffff7bcd579 in redisvCommand (c=0x7fffffffddd0, format=&lt;optimized out&gt;, ap=ap@entry=0x7fffffffdcc0) at hiredis.c:1003\n#4  0x00007ffff7bcd634 in redisCommand (c=&lt;optimized out&gt;, format=&lt;optimized out&gt;) at hiredis.c:1012\n#5  0x0000555555554b9e in getnow (redis_context=0x7fffffffddd0) at src/testRedis.c:18\n#6  0x0000555555554c14 in main () at src/testRedis.c:49\n</code></pre>\n\n<p>Here is the code:</p>\n\n<p>RedisWrapper.h:</p>\n\n<pre><code>#ifndef REDIS_WRAPPER_H\n#define REDIS_WRAPPER_H\n\nint redis_wrapper_init(redisContext *redis_context, char *ip, int port);\nint redis_wrapper_set(redisContext *redis_context, char *key, char *value);\nint redis_wrapper_get(redisContext *redis_context, char *key, char *retrieved_value);\n\n#endif\n</code></pre>\n\n<p>RedisWrapper.c:</p>\n\n<pre><code>#include &lt;hiredis.h&gt;\n\nint redis_wrapper_init(redisContext *redis_context, char* ip, int port) {\n\n    redis_context = redisConnect(ip, port);\n\n    if (redis_context == NULL || redis_context-&gt;err) {\n        if (redis_context) {\n            fprintf(stderr, \"cget: redis init error: %s\\n\", redis_context-&gt;errstr);\n        } else {\n            fprintf(stderr, \"cget: can't allocate redis context\\n\");\n        }\n        return 1;\n    }\n\n    return 0;\n}\n\nint redis_wrapper_set(redisContext *redis_context, char *key, char *value) {\n\n    redisReply *reply = redisCommand(redis_context, \"SET %s %s\", key, value);\n\n    if(reply == NULL) {\n        fprintf(stderr, \"cget: redis set error key: %s, val: %s\\n\", key, value);\n        fprintf(stderr, \"cget: redis set error: %s\\n\", redis_context-&gt;errstr);\n        return 1;\n    }\n\n    freeReplyObject(reply);\n\n    return 0;\n}\n\nint redis_wrapper_get(redisContext *redis_context, char *key, char *retrieved_value) {\n\n    redisReply *reply = redisCommand(redis_context, \"GET foo\");\n\n    if(reply == NULL) {\n        fprintf(stderr, \"cget: redis get error key: %s\\n\", key);\n        fprintf(stderr, \"cget: redis get error: %s\\n\", redis_context-&gt;errstr);\n        return 1;\n    }\n\n    printf(\"GET: %s\\n\", reply-&gt;str);\n    retrieved_value = reply-&gt;str;\n    freeReplyObject(reply);\n\n    return 0;\n\n}\n</code></pre>\n\n<p>Main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;hiredis.h&gt;\n\n#include \"RedisWrapper.h\"\n\nvoid getnow(redisContext *redis_context) {\n    redisReply *reply = redisCommand(redis_context, \"GET foo\");\n\n    printf(\"GET foo: %s\\n\", reply-&gt;str);\n\n    freeReplyObject(reply);\n}\n\nint main() {\n\n    redisContext *redis_context;\n\n    redis_wrapper_init(redis_context, \"127.0.0.1\", 6379);\n\n    getnow(redis_context);\n\n    return 0;\n}\n</code></pre>\n\n<p>My compile command:</p>\n\n<pre><code>gcc -Wall -g -o src/redisTest src/RedisWrapper.c `pkg-config --cflags hiredis` src/Main.c `pkg-config --libs hiredis`\n</code></pre>\n\n<p>More Details:</p>\n\n<pre><code># uname -a\nLinux node1 4.13.0-21-generic #24-Ubuntu SMP Mon Dec 17 17:29:16 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n# locate libhiredis\n/usr/lib/x86_64-linux-gnu/libhiredis.a\n/usr/lib/x86_64-linux-gnu/libhiredis.so\n/usr/lib/x86_64-linux-gnu/libhiredis.so.0.13\n/usr/share/doc/libhiredis-dbg\n/usr/share/doc/libhiredis-dev\n/usr/share/doc/libhiredis0.13\n/usr/share/doc/libhiredis-dbg/changelog.Debian.gz\n/usr/share/doc/libhiredis-dbg/copyright\n/usr/share/doc/libhiredis-dev/README.md.gz\n/usr/share/doc/libhiredis-dev/changelog.Debian.gz\n/usr/share/doc/libhiredis-dev/copyright\n/usr/share/doc/libhiredis0.13/changelog.Debian.gz\n/usr/share/doc/libhiredis0.13/copyright\n/var/cache/apt/archives/libhiredis-dbg_0.13.3-2_amd64.deb\n/var/cache/apt/archives/libhiredis0.13_0.13.3-2_amd64.deb\n/var/lib/dpkg/info/libhiredis-dbg:amd64.list\n/var/lib/dpkg/info/libhiredis-dbg:amd64.md5sums\n/var/lib/dpkg/info/libhiredis-dev:amd64.list\n/var/lib/dpkg/info/libhiredis-dev:amd64.md5sums\n/var/lib/dpkg/info/libhiredis0.13:amd64.list\n/var/lib/dpkg/info/libhiredis0.13:amd64.md5sums\n/var/lib/dpkg/info/libhiredis0.13:amd64.shlibs\n/var/lib/dpkg/info/libhiredis0.13:amd64.symbols\n/var/lib/dpkg/info/libhiredis0.13:amd64.triggers\n</code></pre>\n\n<p>What i found strange is that if i do all the operations all in the Main.c and not use the wrapper files it works. That is not useful to my project though, i need to be able to pass the redis_context around and have it work.</p>\n"}, {"tags": ["c", "linux", "makefile", "macros", "centos7"], "comments": [{"owner": {"reputation": 9689, "user_id": 1475324, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59dca664e41227733ba8a0d1b4f9d73f?s=128&d=identicon&r=PG", "display_name": "iamauser", "link": "https://stackoverflow.com/users/1475324/iamauser"}, "edited": false, "score": 0, "creation_date": 1515003402, "post_id": 48082836, "comment_id": 83140386, "body": "What&#39;s the version of <code>libgcrypt</code> on your Debian ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1515003496, "post_id": 48082836, "comment_id": 83140430, "body": "Does your program actually <code>#include</code> the appropriate header file for gcrypt?  More generally, do edit your question to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1515004166, "post_id": 48082836, "comment_id": 83140760, "body": "on Debian, libgcrypt20, and yes, I include properly the header file"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1515004252, "post_id": 48082836, "comment_id": 83140810, "body": "&quot;<i>The macro is inside the libgcrypt</i>&quot;: Macros are <i>never</i> defined in libraries, but always in source files, in this case typically in headers coming with the development packages to the libraries."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1515004417, "post_id": 48082836, "comment_id": 83140899, "body": "@alk I wanna say that, of course, I mean in the header file."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1515004629, "post_id": 48082836, "comment_id": 83141010, "body": "@JohnBollinger Is very difficult to create a minimal example to reproduce that. The problem is not inside a standalone program. But I&#39;ll try."}], "answers": [{"comments": [{"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1515005140, "post_id": 48083207, "comment_id": 83141252, "body": "Thanks. So it seems the only way is to install the 1.6 (or more) for Centos ?"}, {"owner": {"reputation": 9689, "user_id": 1475324, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59dca664e41227733ba8a0d1b4f9d73f?s=128&d=identicon&r=PG", "display_name": "iamauser", "link": "https://stackoverflow.com/users/1475324/iamauser"}, "reply_to_user": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 1, "creation_date": 1515005337, "post_id": 48083207, "comment_id": 83141364, "body": "Yeah, or get one that&#39;s already built and compatible, for example in Fedora(22). <a href=\"http://archives.fedoraproject.org/pub/archive/fedora/\" rel=\"nofollow noreferrer\">archives.fedoraproject.org/pub/archive/fedora</a>"}], "tags": [], "owner": {"reputation": 9689, "user_id": 1475324, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/59dca664e41227733ba8a0d1b4f9d73f?s=128&d=identicon&r=PG", "display_name": "iamauser", "link": "https://stackoverflow.com/users/1475324/iamauser"}, "is_accepted": true, "score": 3, "last_activity_date": 1515004391, "creation_date": 1515004391, "answer_id": 48083207, "question_id": 48082836, "link": "https://stackoverflow.com/questions/48082836/macro-not-found-in-libgcrypt-on-centos-7/48083207#48083207", "title": "Macro not found in libgcrypt on Centos 7", "body": "<p><code>CentOS-7</code> uses <code>libgcrypt</code> and <code>libgcrypt-devel</code> version 1.5 (patched), which seems to not include <code>GCRY_CIPHER_MODE_GCM</code> declaration.</p>\n\n<p>Looking at the git commits, it seems to have been available in 1.6+.</p>\n\n<p><a href=\"https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commit;h=90cce18b9eced4f412ceeec5bcae18c4493322df\" rel=\"nofollow noreferrer\">https://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=commit;h=90cce18b9eced4f412ceeec5bcae18c4493322df</a></p>\n\n<p>On a newer version, you would see a line in <code>/usr/include/gcrypt.h</code>, like the following:</p>\n\n<pre><code>GCRY_CIPHER_MODE_GCM      = 9,   /* Galois Counter Mode. */\n</code></pre>\n"}], "owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 48083207, "answer_count": 1, "score": 1, "last_activity_date": 1515004391, "creation_date": 1515002792, "question_id": 48082836, "link": "https://stackoverflow.com/questions/48082836/macro-not-found-in-libgcrypt-on-centos-7", "title": "Macro not found in libgcrypt on Centos 7", "body": "<p>I have a C program that uses <em>libgcrypt</em>.\nI put this string in the builder to install the libraries for Centos 7:</p>\n\n<pre><code>yum -y install json-c-devel expat-devel libpcap-devel flex-devel automake libtool bison libuv-devel openssl-devel libgcrypt-devel\n</code></pre>\n\n<p>and no problem come out.</p>\n\n<p>Unfortunately, the compilation of the code terminate with an error caused by a macro cannot be found:</p>\n\n<blockquote>\n  <p>error: 'GCRY_CIPHER_MODE_GCM' undeclared (first use in this function)</p>\n</blockquote>\n\n<p>The macro is inside the <strong>libgcrypt</strong> for sure, so I really don't understand how cannot be found at all.</p>\n\n<p>If I compile the same code in Debian, it works well and the macro is resolved properly.</p>\n\n<p><strong>P.S.</strong> My system is Debian 8 and I use docker for Centos 7</p>\n"}, {"tags": ["c", "debugging", "codeblocks"], "comments": [{"owner": {"reputation": 1389, "user_id": 6561404, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d34c8d367fd19cab8acbdcc11ded821a?s=128&d=identicon&r=PG&f=1", "display_name": "MMAdams", "link": "https://stackoverflow.com/users/6561404/mmadams"}, "edited": false, "score": 0, "creation_date": 1515000854, "post_id": 48082267, "comment_id": 83139087, "body": "Do other programs you write compile properly? If not, it could be a configuration issue, perhaps try using a different program to compile your code."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 3, "creation_date": 1515001360, "post_id": 48082267, "comment_id": 83139358, "body": "the <code>n</code> you use in <code>findMaxElem()</code> is never assigned to anything"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1515002897, "post_id": 48082267, "comment_id": 83140121, "body": "Have you seen <a href=\"https://stackoverflow.com/questions/966428/how-do-you-use-gdb?s=14|77.2083\" title=\"how do you use gdb\">stackoverflow.com/questions/966428/&hellip;</a> Does that help in the more general situation of learning to debug?"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 4, "last_activity_date": 1515002511, "last_edit_date": 1592644375, "creation_date": 1515000595, "answer_id": 48082285, "question_id": 48082267, "link": "https://stackoverflow.com/questions/48082267/ej4-exe-has-stopped-working-how-to-use-a-debugger/48082285#48082285", "title": "&quot;Ej4.exe has stopped working&quot; \u2013 How to use a debugger?", "body": "<p>In the other function <code>findMaxElem()</code> you have used <code>n</code> which is uninitialized. As a result you have undefined behavior - and that undefined behavior that made your program to stop. (Maybe the garbage value is making you access the out of bound array access). Here <code>n</code> is uninitialized. Pass the <code>n</code> from <code>main</code> to this function.</p>\n<pre><code>mxelem=findMaxElem(n,arr1);\n</code></pre>\n<p>and use it</p>\n<pre><code>int findMaxElem(int n, int arr1[])\n{\n   int i=1,mxelem;\n   mxelem=arr1[0];\n   while(i &lt; n)\n   {\n      if(mxelem &lt; arr1[i])\n         mxelem = arr1[i];\n      i++;\n   }\n   return mxelem;\n}\n</code></pre>\n<hr />\n<h3>How did I debug it?</h3>\n<pre><code>&gt;&gt;gcc -g prog.c -o prog.x\n&gt;&gt;gdb prog.x\n(gdb) run\n\n..\n</code></pre>\n<p>Then everyhting I run it returned me <code>0</code>-th element. Something is wrong. The most important function being <code>findMaxElem</code> I put a breakpoint there.</p>\n<pre><code>(gdb) break findMaxElem\n...\n\n(gdb) run\n</code></pre>\n<p>Now it stopped at that point after I got there (by that I meant after giving inputs).</p>\n<pre><code>Breakpoint 1, findMaxElem (arr1=0xbffff1e8) at prog.c:30\n30          int i=1,mxelem,n;\n(gdb) next\n31          mxelem=arr1[0];\n(gdb) print mxelem\n$3 = 1  &lt;-- for me first element entered was 1\n(gdb) next\n32          while(i &lt; n)\n(gdb) print i\n$4 = 1\n(gdb) print n\n$5 = -2147475456 &lt;---- this gave me the idea that it is the error over here.\n(gdb) \n</code></pre>\n<hr />\n<p>So the answer is yes. You can use debugger to find out where the problem is. You didn't mention what debugger you have used but I have shown you a small debugging steps using <code>gdb</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9169269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b93604b4f84403e745233ab37bef36c6?s=128&d=identicon&r=PG&f=1", "display_name": "mechanicalgirl", "link": "https://stackoverflow.com/users/9169269/mechanicalgirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515002511, "creation_date": 1515000524, "last_edit_date": 1515001092, "question_id": 48082267, "link": "https://stackoverflow.com/questions/48082267/ej4-exe-has-stopped-working-how-to-use-a-debugger", "title": "&quot;Ej4.exe has stopped working&quot; \u2013 How to use a debugger?", "body": "<p>When compiling the following program appears \"Ej4.exe has stopped working\". Can I find the error with a debugger? I have never used this and would like to know in which cases it is used and how.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX 100\n\nint findMaxElem(int []);\n\nint main(){\n    int arr1[MAX],mxelem,i,n;\n\n    printf(\" Ingrese el numero de elementos a almacenar en el arreglo :\");\n    scanf(\"%d\",&amp;n);\n\n    printf(\" Ingrese %d elementos en el arreglo:\\n\",n);\n    for(i=0;i&lt;n;i++)\n    {\n        printf(\" elemento - %d : \",i);\n        scanf(\"%d\",&amp;arr1[i]);\n    }\n    mxelem=findMaxElem(arr1);\n\n    printf(\" El maximo elemento en el arreglo es: %d\\n\\n\",mxelem);\n    return 0;\n\n}\n\n\nint findMaxElem(int arr1[])\n{\n    int i=1,mxelem,n;\n    mxelem=arr1[0];\n    while(i &lt; n)\n    {\n        if(mxelem&lt;arr1[i])\n        mxelem=arr1[i];\n        i++;\n    }\n    return mxelem;\n}\n</code></pre>\n"}, {"tags": ["objective-c", "c", "automatic-ref-counting"], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 3328736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaZjw.jpg?s=128&g=1", "display_name": "itMaxence", "link": "https://stackoverflow.com/users/3328736/itmaxence"}, "edited": false, "score": 1, "creation_date": 1515001239, "post_id": 48082172, "comment_id": 83139311, "body": "Indeed, the doc is pretty self explanatory. So it means that I should only use UTF8String to copy that C string somewhere else, even if the lifetime of NSString have not ended up yet? I would have not expect this, thanks"}, {"owner": {"reputation": 716, "user_id": 3328736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaZjw.jpg?s=128&g=1", "display_name": "itMaxence", "link": "https://stackoverflow.com/users/3328736/itmaxence"}, "edited": false, "score": 0, "creation_date": 1515002210, "post_id": 48082172, "comment_id": 83139773, "body": "yeah I am just surprised of that part of the doc <code>which may have a lifetime shorter than the string object</code>, which basically means that even if I keep the NSString alive somewhere (let&#39;s say using static or as a global var), the pointer might be invalid at a certain point in time"}, {"owner": {"reputation": 21971, "user_id": 169394, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb61781f55bda1790e6216a2dee08b11?s=128&d=identicon&r=PG", "display_name": "Itai Ferber", "link": "https://stackoverflow.com/users/169394/itai-ferber"}, "reply_to_user": {"reputation": 716, "user_id": 3328736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaZjw.jpg?s=128&g=1", "display_name": "itMaxence", "link": "https://stackoverflow.com/users/3328736/itmaxence"}, "edited": false, "score": 1, "creation_date": 1515002336, "post_id": 48082172, "comment_id": 83139838, "body": "@itMaxence Sorry, deleted my original comment instead of editing it like I&#39;d meant to. This can happen in vary rare circumstances (you have a <i>lot</i> of tagged pointer strings, get all of their <code>UTF8String</code> values in a tight loop, and drain the current autoreleasepool before using the <code>UTF8String</code> values), but this is exceedingly rare."}, {"owner": {"reputation": 21971, "user_id": 169394, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb61781f55bda1790e6216a2dee08b11?s=128&d=identicon&r=PG", "display_name": "Itai Ferber", "link": "https://stackoverflow.com/users/169394/itai-ferber"}, "reply_to_user": {"reputation": 716, "user_id": 3328736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaZjw.jpg?s=128&g=1", "display_name": "itMaxence", "link": "https://stackoverflow.com/users/3328736/itmaxence"}, "edited": false, "score": 0, "creation_date": 1515002386, "post_id": 48082172, "comment_id": 83139856, "body": "@itMaxence If you want to be really safe, yes, copy the UTF-8 string before using it, and certainly do so before passing the value along to different functions (which can do whatever they want)."}, {"owner": {"reputation": 21971, "user_id": 169394, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb61781f55bda1790e6216a2dee08b11?s=128&d=identicon&r=PG", "display_name": "Itai Ferber", "link": "https://stackoverflow.com/users/169394/itai-ferber"}, "reply_to_user": {"reputation": 716, "user_id": 3328736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaZjw.jpg?s=128&g=1", "display_name": "itMaxence", "link": "https://stackoverflow.com/users/3328736/itmaxence"}, "edited": false, "score": 1, "creation_date": 1515003388, "post_id": 48082172, "comment_id": 83140375, "body": "Basically, it&#39;s not always safe to call <code>-UTF8String</code> inside of an autorelease pool, then using the result outside of the autorelease pool. If you call <code>-UTF8String</code> and use it in the same scope (without something doing fiddly things with your autorelease pool, which is really difficult if not impossible in ARC), you should be safe."}, {"owner": {"reputation": 716, "user_id": 3328736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaZjw.jpg?s=128&g=1", "display_name": "itMaxence", "link": "https://stackoverflow.com/users/3328736/itmaxence"}, "edited": false, "score": 0, "creation_date": 1515003567, "post_id": 48082172, "comment_id": 83140471, "body": "yeah your example easily show how this could end up. thanks!"}], "tags": [], "owner": {"reputation": 21971, "user_id": 169394, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb61781f55bda1790e6216a2dee08b11?s=128&d=identicon&r=PG", "display_name": "Itai Ferber", "link": "https://stackoverflow.com/users/169394/itai-ferber"}, "is_accepted": true, "score": 5, "last_activity_date": 1515000155, "creation_date": 1515000155, "answer_id": 48082172, "question_id": 48082094, "link": "https://stackoverflow.com/questions/48082094/does-arc-keep-track-of-the-const-char-produced-by-nsstring-utf8string/48082172#48082172", "title": "Does ARC keep track of the const char* produced by [NSString UTF8String]?", "body": "<p>No, ARC does not (and cannot) manage lifetimes of non-object types. If you take a look at the <a href=\"https://developer.apple.com/documentation/foundation/nsstring/1411189-utf8string?language=objc\" rel=\"noreferrer\">documentation for <code>-[NSString UTF8String]</code></a>, you can also see the following:</p>\n\n<blockquote>\n  <p>This C string is a pointer to a structure inside the string object, which may have a lifetime shorter than the string object and will certainly not have a longer lifetime. Therefore, you should copy the C string if it needs to be stored outside of the memory context in which you use this property.</p>\n</blockquote>\n\n<p>The UTF-8 string you get back has a maximum lifetime of the lifetime of the source <code>NSString</code> (which ARC will clean up at the end of the function), so if you need to hold on to the string, you'll need to make a copy using <code>strdup</code> or similar (and manage the lifetime yourself).</p>\n"}, {"comments": [{"owner": {"reputation": 12147, "user_id": 4244136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee698ef15036e2393a30962db90cfa3?s=128&d=identicon&r=PG&f=1", "display_name": "Willeke", "link": "https://stackoverflow.com/users/4244136/willeke"}, "edited": false, "score": 0, "creation_date": 1515058730, "post_id": 48082205, "comment_id": 83159114, "body": "How do you add 1 to the retain count of the pointer and make <code>NSString</code> not dispose it?"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1515000263, "creation_date": 1515000263, "answer_id": 48082205, "question_id": 48082094, "link": "https://stackoverflow.com/questions/48082094/does-arc-keep-track-of-the-const-char-produced-by-nsstring-utf8string/48082205#48082205", "title": "Does ARC keep track of the const char* produced by [NSString UTF8String]?", "body": "<blockquote>\n  <p>Is the pointer non-valid after the end of the function?</p>\n</blockquote>\n\n<p>You are correct. ARC keeps track only of memory allocated to reference-counted objects. Sinc <code>char*</code> returned by <code>UTF8String</code> does not refer to a reference-counted object, ARC does not know of its existence.</p>\n\n<blockquote>\n  <p>If non-valid, is there a way to explicitly ask ARC to keep track of it?</p>\n</blockquote>\n\n<p>No, because <code>char*</code> lacks \"infrastructure\" for keeping reference count. You could either return a reference-counted object which encloses your <code>char*</code>, or use <code>malloc</code>, make a copy, and let the caller <code>free</code> the string.</p>\n"}], "owner": {"reputation": 716, "user_id": 3328736, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaZjw.jpg?s=128&g=1", "display_name": "itMaxence", "link": "https://stackoverflow.com/users/3328736/itmaxence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 48082172, "answer_count": 2, "score": 2, "last_activity_date": 1515000263, "creation_date": 1514999818, "question_id": 48082094, "link": "https://stackoverflow.com/questions/48082094/does-arc-keep-track-of-the-const-char-produced-by-nsstring-utf8string", "title": "Does ARC keep track of the const char* produced by [NSString UTF8String]?", "body": "<p>Is the <code>const char*</code> valid?\nDoes ARC keep track of the pointer returned by this function?</p>\n\n<pre><code>const char* getUrl()\n{\n    // retrieve an url with obj-c\n    NSString *maybeTmp = [[NSString alloc] initWithString:@\"some url\"];\n    return [maybeTmp UTF8String];\n}\n</code></pre>\n\n<p><em>This code is used as a bridge. A C library is going to call this function.</em></p>\n\n<p>I would guess that ARC doesn't keep track of that pointer and will release this NSString once the function getUrl() returns, leaving the pointer as non valid.</p>\n\n<ul>\n<li>Is the pointer non-valid after the end of the function?</li>\n<li>If non-valid, is there a way to explicitly ask ARC to keep track of it?</li>\n</ul>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 11, "creation_date": 1514999625, "post_id": 48082040, "comment_id": 83138405, "body": "<i>Why</i> do you want to do that? What is the <i>real</i> problem you want to solve? Please <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">read about the XY problem</a> and think about how this question might be one."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 3, "creation_date": 1514999658, "post_id": 48082040, "comment_id": 83138425, "body": "You can&#39;t, and you shouldn&#39;t have a legitimate need to do it."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1514999980, "post_id": 48082040, "comment_id": 83138593, "body": "what about disassembling with mixed symbols ?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1515000436, "post_id": 48082040, "comment_id": 83138848, "body": "Please <b>edit your question</b> to improve it, give a lot more details (in what program, what compiler, what operating system, what optimization options, what kind of code) and give <i>motivation</i> and <i>context</i>. Without it, your question has no sense."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1515000761, "post_id": 48082040, "comment_id": 83139035, "body": "C is usually compiled, but there are also <a href=\"https://stackoverflow.com/q/584714/2564301\">interpreters</a>. A hypothetical routine to locate the &quot;end of a function&quot;  would thus return the line of text containing its closing <code>}</code>."}, {"owner": {"reputation": 25, "user_id": 7148069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d36870b4639b4d161c068e69857a04b?s=128&d=identicon&r=PG&f=1", "display_name": "Bar Fins", "link": "https://stackoverflow.com/users/7148069/bar-fins"}, "edited": false, "score": 0, "creation_date": 1515697788, "post_id": 48082040, "comment_id": 83410141, "body": "Sorry, I will rephrase my question."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1515737153, "post_id": 48082040, "comment_id": 83422439, "body": "How much time (in years) do you have for your project? Are you working alone? What is the size of your team? Are you aware that your project is very ambitious (and any program doing well what you wish needs to be very big: millions of lines of source code). Malware software is not naive! So there is <i>no simple way</i> to get what you want."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1515737929, "post_id": 48082040, "comment_id": 83422711, "body": "What will happen if you fail your (incredibly ambitious) project? This is a question to ask yourself!"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515003609, "post_id": 48082084, "comment_id": 83140485, "body": "Agree with all of this very good answer aside from the Harvard architecture part.  That architecture does not present any more or less applicability to OP&#39;s question even if its function addresses are not comparable to object ones.  It does present perhaps additional challenges."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 8, "last_activity_date": 1515739272, "last_edit_date": 1515739272, "creation_date": 1514999780, "answer_id": 48082084, "question_id": 48082040, "link": "https://stackoverflow.com/questions/48082040/how-can-i-know-where-function-ends-in-memoryget-the-address-c-c/48082084#48082084", "title": "How can I know where function ends in memory(get the address)- c/c++", "body": "<p>In general, you cannot find where the function is ending in memory, because the compiler could have <a href=\"https://en.wikipedia.org/wiki/Optimizing_compiler\" rel=\"nofollow noreferrer\">optimized</a>, <a href=\"https://en.wikipedia.org/wiki/Inline_expansion\" rel=\"nofollow noreferrer\">inlined</a>, cloned or removed that function, split it in different parts, etc. That function could be some <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow noreferrer\">system call</a> mostly implemented in the kernel, or some function in an external <a href=\"https://en.wikipedia.org/wiki/Library_(computing)#Shared_libraries\" rel=\"nofollow noreferrer\">shared library</a> (\"outside\" of your program's <a href=\"https://en.wikipedia.org/wiki/Executable\" rel=\"nofollow noreferrer\">executable</a>)... For the C11 standard (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>) point of view, your question has no sense. That standard defines the <a href=\"https://en.wikipedia.org/wiki/Semantics_(computer_science)\" rel=\"nofollow noreferrer\">semantics</a> of the language, i.e. properties on the behavior of the produced program. See also explanations in <a href=\"https://stackoverflow.com/a/48081361/841108\">this</a> answer.</p>\n\n<p><sup>On some computers (<a href=\"https://en.wikipedia.org/wiki/Harvard_architecture\" rel=\"nofollow noreferrer\">Harvard architecture</a>) the code would stay in a different memory, so there is no point in asking where that function starts or ends.</sup></p>\n\n<p>If you restrict your question to a particular C <em>implementation</em> (that is a specific <a href=\"https://en.wikipedia.org/wiki/Compiler\" rel=\"nofollow noreferrer\">compiler</a> with particular optimization settings, for a specific <a href=\"https://en.wikipedia.org/wiki/Operating_system\" rel=\"nofollow noreferrer\">operating system</a> and <a href=\"https://en.wikipedia.org/wiki/Instruction_set_architecture\" rel=\"nofollow noreferrer\">instruction set architecture</a> and <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">ABI</a>) you might (in <em>some</em> cases,  not in all of them) be able to find the \"end of a function\" (but that won't be simple, and won't be failproof). For example, you could post-process the assembler code and/or the <a href=\"https://en.wikipedia.org/wiki/Object_file\" rel=\"nofollow noreferrer\">object file</a> produced by the compiler, inspect the <a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">ELF</a> executable and its symbol table, examine <a href=\"https://en.wikipedia.org/wiki/DWARF\" rel=\"nofollow noreferrer\">DWARF</a> debug information, etc...</p>\n\n<p>Your question smells a lot like some <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>, so you should motivate it, whith <em>a lot more</em> explanation and context.</p>\n\n<blockquote>\n  <p>I need to know where functions start and end in stack.</p>\n</blockquote>\n\n<p>Functions don't sit on the stack, but mostly in the <a href=\"https://en.wikipedia.org/wiki/Code_segment\" rel=\"nofollow noreferrer\">code segment</a> of your executable (or library). What is on the <a href=\"https://en.wikipedia.org/wiki/Call_stack\" rel=\"nofollow noreferrer\">call stack</a> is a sequence of call frames. The organization of the call frames is specific to your ABI. Some compiler <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">options</a> (e.g. <code>-fomit-frame-pointer</code>) would make difficult to explore the call stack (without access to the source code and help from the compiler).</p>\n\n<blockquote>\n  <p>I don't have access to the source code itself. I would like to examine only specific functions from it. </p>\n</blockquote>\n\n<p>Your problem is still ill-defined, probably <a href=\"https://en.wikipedia.org/wiki/Undecidable_problem\" rel=\"nofollow noreferrer\">undecidable</a>, much more complex than what you believe (since related to the <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow noreferrer\">halting problem</a>), and there is considerable literature related to it (read about <a href=\"https://en.wikipedia.org/wiki/Decompiler\" rel=\"nofollow noreferrer\">decompiler</a>, <a href=\"https://en.wikipedia.org/wiki/Static_program_analysis\" rel=\"nofollow noreferrer\">static code analysis</a>, <a href=\"https://en.wikipedia.org/wiki/Antivirus_software\" rel=\"nofollow noreferrer\">anti-virus</a> &amp; <a href=\"https://en.wikipedia.org/wiki/Malware_analysis\" rel=\"nofollow noreferrer\">malware analysis</a>). I recommend spending several months or years learning more about compilers (start with the <a href=\"https://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools\" rel=\"nofollow noreferrer\">Dragon Book</a>), <a href=\"http://iecc.com/linkers/\" rel=\"nofollow noreferrer\">linkers</a>, instruction set architecture, ABIs. Then look into several proceedings of conferences related to ACM <a href=\"http://www.sigplan.org/\" rel=\"nofollow noreferrer\">SIGPLAN</a> etc. On a practical side, study the assembler code generated by compilers (e.g. use <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> with <code>gcc -O2 -S -fverbose-asm</code>....); the CppCon 2017 talk: Matt Godbolt <a href=\"https://youtu.be/bSkpMdDe4g4\" rel=\"nofollow noreferrer\">\u201cWhat Has My Compiler Done for Me Lately? Unbolting the Compiler's Lid\u201d</a> is a nice introduction.</p>\n\n<blockquote>\n  <p>I'm working on a project that will find problems on run time in other code, such as: code injection, viruses and so fourth. </p>\n</blockquote>\n\n<p>I hope you can dedicate several years of full time work to your ambitious project. It probably is much more difficult than what you thought, because optimizing compilers are <a href=\"https://softwareengineering.stackexchange.com/a/273711/40065\">much more complex</a> than what you believe (and <a href=\"https://en.wikipedia.org/wiki/Malware\" rel=\"nofollow noreferrer\">malware</a> software uses various complex tricks to hide itself from inspection). <a href=\"https://en.wikipedia.org/wiki/Malware_research\" rel=\"nofollow noreferrer\">Malware research</a> is really difficult, but interesting.</p>\n"}], "owner": {"reputation": 25, "user_id": 7148069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d36870b4639b4d161c068e69857a04b?s=128&d=identicon&r=PG&f=1", "display_name": "Bar Fins", "link": "https://stackoverflow.com/users/7148069/bar-fins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515739272, "creation_date": 1514999562, "last_edit_date": 1515698454, "question_id": 48082040, "link": "https://stackoverflow.com/questions/48082040/how-can-i-know-where-function-ends-in-memoryget-the-address-c-c", "title": "How can I know where function ends in memory(get the address)- c/c++", "body": "<p>I'm looking for a simple way to find function ending in memory. I'm working on a project that will find problems on run time in other code, such as: code injection, viruses and so fourth. My program will run with the code that is going to be checked on run time, so that I will have access to memory. I don't have access to the source code itself. I would like to examine only specific functions from it. I need to know where functions start and end in stack. I'm working with windows 8.1 64 bit. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1515005343, "post_id": 48081986, "comment_id": 83141371, "body": "You may also consider preprocessing the file with tools like <i>sed</i> and <i>awk</i>."}], "answers": [{"comments": [{"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515000429, "post_id": 48082181, "comment_id": 83138843, "body": "&quot;3. Use a for loop for 0 to <code>arrsize</code>&quot; - perhaps you meant <code>arrsize-1</code>?"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515000467, "post_id": 48082181, "comment_id": 83138866, "body": "@BobJarvis Non-inclusive; <code>i &lt; arrSize</code>. Generally &quot;to&quot; is <code>&lt;</code> and &quot;through&quot; is <code>&lt;=</code> You&#39;re right, though, that I could have made that clearer. I&#39;ll edit it."}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515000597, "post_id": 48082181, "comment_id": 83138945, "body": "Thanks you. Should I use a for inside a for?"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515000634, "post_id": 48082181, "comment_id": 83138963, "body": "@Sombrito Shouldn&#39;t need to (I&#39;d just use <code>strncpy</code> or <code>strlcpy</code>), although you could. Be careful when you do the last string, though. If it&#39;s less than eight characters, only copy the number of characters that are left (plus the null terminator, of course). Otherwise you&#39;ll run past the end of the buffer. <code>strncpy</code> or <code>strlcpy</code> should handle that for you, if you use them."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1515000908, "post_id": 48082181, "comment_id": 83139116, "body": "And if you declare <code>arr</code> on the stack in a subroutine, make sure you don&#39;t return it to the caller or you may find yourself living in a shotgun shack and you may find yourself living in another part of the world and and you may find yourself behind the wheel of a large automobile and you may find yourself in a beautiful house with a beautiful wife and you may ask yourself &quot;Well, how did I get here?&quot;"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1515000974, "post_id": 48082181, "comment_id": 83139161, "body": "you&#39;ll also need to ensure the string is NUL terminated as <code>strncpy</code> will only do that on the last chunk"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515001004, "post_id": 48082181, "comment_id": 83139185, "body": "@BobJarvis Lol, true. If you want to return it out of the function, you can&#39;t use an array. Use <code>malloc</code>&#39;ed memory instead in that case (and remember to <code>free</code> it when you&#39;re done with it)."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1515001031, "post_id": 48082181, "comment_id": 83139204, "body": "@ChrisTurner Yep, as I said, make sure the null terminator gets put at the end if you&#39;re not using <code>strlcpy</code>. This is why I generally prefer <code>strlcpy</code> on platforms that have it."}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515007679, "post_id": 48082181, "comment_id": 83142512, "body": "@CharlesSrstka Thank yo for your help, however could you show me how you would code it? Thanks"}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515009369, "post_id": 48082181, "comment_id": 83143315, "body": "Im struggling particularly in  &quot;Calculate the position in the buffer using i * 8&quot;, not sure where I should use it"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515011207, "post_id": 48082181, "comment_id": 83144058, "body": "@Sombrito You&#39;ll learn more if you write it yourself, but the gist: If you have <code>i</code> be 0, 1, 2, etc., then <code>i * 8</code> will be 0, 8, 16, etc. These will be the addresses for the string slices that you can then copy into your array."}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515012317, "post_id": 48082181, "comment_id": 83144521, "body": "I still can&#39;t get it to function. I have done this, not sure if remotely correct   <i>italic</i> <b>bold  &#39;  char arr[arrSize][9];       for(i=0;i&lt;arrSize;i*=8)     {         strncpy(arr, buffer, 8);     }      free(buffer); } &#39;</b>"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515015496, "post_id": 48082181, "comment_id": 83145881, "body": "@Sombrito My comments: 1) Add one to <code>i</code> on each run through the loop, don&#39;t multiply. 2) Use <code>&amp;buffer[i * 8]</code> as the source pointer for <code>strncpy</code>. 3) Each time through the loop, make sure to set the null terminator at the end of the string after you call <code>strncpy</code>!"}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515016550, "post_id": 48082181, "comment_id": 83146325, "body": "@CharlesSrstka I have done as you said, apart from the null pointer (which I don&#39;t know how to set). Its giving me a Seg Fault, which could be from that"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515016626, "post_id": 48082181, "comment_id": 83146362, "body": "@Sombrito Post what you&#39;ve got, and I&#39;ll critique it."}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515017150, "post_id": 48082181, "comment_id": 83146574, "body": "inline <code>for(i=0;i&lt;arrSize;i++)     {         strncpy(arr, &amp;buffer[i*8], 8);      }      free(buffer); }</code>  I got this, just as you said, the only thing I can&#39;t seem to do is to set the null terminator"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515017356, "post_id": 48082181, "comment_id": 83146655, "body": "@Sombrito 1) Notice what you&#39;ve set as the destination pointer for <code>strncpy</code>. Do you want to write your chars directly to the array, or into the strings inside the array? 2) If there are 8 characters in a C string, what should come immediately after those 8 characters?"}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515018238, "post_id": 48082181, "comment_id": 83147009, "body": "@CharlesSrstka I would like to write it to the strings inside the array"}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515018464, "post_id": 48082181, "comment_id": 83147090, "body": "@CharlesSrstka So far I have this inline `    printf(&quot;\\n%d&quot;, arrSize);     char arr[arrSize][9];       for(i=0;i&lt;arrSize;i++)     {        strncpy(arr[i], &amp;buffer[i*8], 8);        arr[i][9]=&#39;\\0&#39;;      }      free(buffer); } `"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1515020574, "post_id": 48082181, "comment_id": 83147748, "body": "One little mistake here; which byte of the string should get the null terminator? (Hint: what index do C arrays start at?)"}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515021624, "post_id": 48082181, "comment_id": 83148043, "body": "Well, the byte of the string to get the null terminator should be the last, by that I mean <code>arr[i][9]=&#39;\\0</code>. C-arrays start at index 0. I&#39;m clueless now"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515021807, "post_id": 48082181, "comment_id": 83148098, "body": "@Sombrito Spell it all out. Starting at zero, what are the eight indexes where your characters will go? And then where does the terminator need to be?"}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515022198, "post_id": 48082181, "comment_id": 83148198, "body": "@CharlesSrstka According to that, the charactes would be stored from &#39;arr[i][0]&#39; to &#39;arr[i][7]&#39; where the null terminator would be &#39;arr[i][8]&#39;. Again not sure if im thinking this correctly. I have this &#39; for(i=0;i&lt;arrSize;i++)     {        strncpy(arr, &amp;buffer[i*8], 8);        arr[i][8]=&#39;\\0&#39;;      }&#39;"}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515022330, "post_id": 48082181, "comment_id": 83148248, "body": "Just to say that when I run the debugger, it gives me a Seg Fault on ` char arr[arrSize][9];`"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515022617, "post_id": 48082181, "comment_id": 83148324, "body": "@Sombrito Yup, in an array of size 9, the last element has index 8, because the indices start at 0. If you write to element 9, you overflow the buffer and can either cause a crash, or worse. Same goes for <code>arr[arrSize]</code>\u2014that&#39;s an overflow. The last element is at <code>arrSize - 1</code>."}, {"owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515023320, "post_id": 48082181, "comment_id": 83148481, "body": "I got it working by doing this <code>char **arr=(char**)malloc(arrSize*sizeof(char*));     for(i=0;i&lt;arrSize;i++)     {         arr[i]=(char *)malloc(9*sizeof(char));     }        for(i=0;i&lt;arrSize;i++)     {        strncpy(arr[i], &amp;buffer[i*8], 8);        arr[i][8]=&#39;\\0&#39;;      }     for(i=0;i&lt;arrSize;i++)     {         puts(arr[i]);     }      free(buffer); }</code>  So thanks a lot man, sorry for any nuisance. Give yourself a beer. You deserve it :D"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "edited": false, "score": 0, "creation_date": 1515025141, "post_id": 48082181, "comment_id": 83148961, "body": "@Sombrito That&#39;s the way to go if you have too much data to allocate on the stack. Just make sure to <code>free</code> all those pointers when you&#39;re done with them (loop through first and free all the strings, then free <code>arr</code>)."}], "tags": [], "owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "is_accepted": false, "score": 3, "last_activity_date": 1515001528, "last_edit_date": 1515001528, "creation_date": 1515000166, "answer_id": 48082181, "question_id": 48081986, "link": "https://stackoverflow.com/questions/48081986/splitting-a-string-8-characters-at-the-time/48082181#48082181", "title": "Splitting a string 8 characters at the time", "body": "<ol>\n<li><p>Calculate the length of your array <code>arrSize</code> (it'll be the buffer length divided by 8, plus 1 if the remainder isn't zero)</p></li>\n<li><p>Create a variable-length array of <code>char[9]</code> with the size computed in step 1, i.e. <code>char arr[arrSize][9]</code></p></li>\n<li><p>Use a <code>for</code> loop from 0 to <code>arrSize</code> (non-inclusive). Calculate the position in the buffer using <code>i * 8</code>, and copy either 8 bytes (if it's not the last string) or less (if it is the last string). You can use either <code>strncpy</code> or, if your platform has it, <code>strlcpy</code>, which is slightly safer, to do this. Make sure to put the null terminator at the end if you're not using <code>strlcpy</code>. Also, make sure not to overflow the buffer by writing more than 9 characters into it (shouldn't happen with <code>strncpy</code> or <code>strlcpy</code>, but if you do something else, watch out for this).</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1515001752, "last_edit_date": 1515001752, "creation_date": 1515001018, "answer_id": 48082379, "question_id": 48081986, "link": "https://stackoverflow.com/questions/48081986/splitting-a-string-8-characters-at-the-time/48082379#48082379", "title": "Splitting a string 8 characters at the time", "body": "<p>Print up to 8 characters at a time using <code>\"%.*s\"</code>.</p>\n\n<p><code>\"%s\"</code> with a precision field prints up to that many characters.</p>\n\n<pre><code>size_t n = fread(buffer, fileLength, 1, filePtr);\nint delta; \nfor(size_t i=0; i&lt;n; i += delta) {\n  delta = 8;\n  if (fileLength - i &lt; delta) delta = fileLength - i;\n  printf(\"\\\"%.*s\\\",\" delta, buffer + i);\n}\n</code></pre>\n\n<p>Or simplify by appending a <em>null character</em> to <code>buffer[]</code></p>\n\n<pre><code>size_t n = fread(buffer, fileLength, 1, filePtr);\nbuffer[n] = '\\0';\n\nfor(size_t i=0; i&lt;n; i += 8) {\n  printf(\"\\\"%.8s\\\",\", buffer + i);\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9097075, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744566878896563/picture?type=large", "display_name": "Sombrito", "link": "https://stackoverflow.com/users/9097075/sombrito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516421326, "creation_date": 1514999363, "last_edit_date": 1516421326, "question_id": 48081986, "link": "https://stackoverflow.com/questions/48081986/splitting-a-string-8-characters-at-the-time", "title": "Splitting a string 8 characters at the time", "body": "<p>I am trying to divide a buffer as I go along, 8 characters at the time. </p>\n\n<p>I have my buffer running correctly, the only thing I do not have a clue is to how to do this.</p>\n\n<p>What I have for now is this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid splittingFunction(FILE *filePtr, long fileLength)\n{\n    char *buffer=(char*)malloc(fileLength+1);\n    if(!buffer)\n        printf(\"Out of Memory\");\n    n=fread(buffer, fileLength, 1, filePtr);\n\n    for(i=0; i&lt;fileLength; i++)\n        printf(\"%c\",buffer[i]);\n\n    free(buffer);\n}\n</code></pre>\n\n<p>So this will print me to the screen something like this:</p>\n\n<pre><code>10111010001101000001000000111010001101000011001010010000001100001011100100110110101111001001000000110111101100110001000000111010001101000011001010010000001100100011001010110000101100100001011100000110100001010010101000110100001100101001000000100111001101001011001110110100001110100001000000100101101101001011011100110011\n</code></pre>\n\n<p>What I am trying to do is this:</p>\n\n<pre><code>arr[]={\"10111010\",\"00011010\",\"00000100\", ...}\n</code></pre>\n\n<p>I know this might sound silly, but I just can't seem to figure it out. Any help would be appreciated</p>\n"}, {"tags": ["c", "ethernet", "mac-address"], "comments": [{"owner": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "edited": false, "score": 0, "creation_date": 1514999784, "post_id": 48081951, "comment_id": 83138495, "body": "The program you link to sets the Ethernet interface to promiscuous mode. That means it will receive all packets on the interface, not just packets meant for the local host. Thus, they added a check for the destination MAC address."}, {"owner": {"reputation": 143, "user_id": 9169178, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/37746c5a3aa3c38307f91b8721b65276?s=128&d=identicon&r=PG&f=1", "display_name": "netleap tom", "link": "https://stackoverflow.com/users/9169178/netleap-tom"}, "reply_to_user": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "edited": false, "score": 0, "creation_date": 1515000470, "post_id": 48081951, "comment_id": 83138869, "body": "Ok thanks, are you saying that destination MAC address in the program that receives the frames has to match the  destination MAC address specified in the program that sends the frames<a href=\"https://gist.github.com/austinmarton/1922600\" rel=\"nofollow noreferrer\">link</a>?"}], "owner": {"reputation": 143, "user_id": 9169178, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/37746c5a3aa3c38307f91b8721b65276?s=128&d=identicon&r=PG&f=1", "display_name": "netleap tom", "link": "https://stackoverflow.com/users/9169178/netleap-tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514999225, "creation_date": 1514999225, "question_id": 48081951, "link": "https://stackoverflow.com/questions/48081951/c-program-receiving-ethernet-frames-why-specify-the-destination-mac-address", "title": "c program receiving ethernet frames - why specify the destination mac address", "body": "<p>I am using these projects on github to send and receive ethernet frames over the two ethernet interfaces on my machine. </p>\n\n<p><a href=\"https://gist.github.com/austinmarton/2862515\" rel=\"nofollow noreferrer\">Recieve ethernet</a></p>\n\n<p>My question is in relation to the program for receiving the ethernet frames. Why do you have to supply the destination MAC in the receiving program? Should it not just be listening on the <code>eth0</code> interface?  </p>\n\n<pre><code>#define DEST_MAC0   0x00\n#define DEST_MAC1   0x00\n#define DEST_MAC2   0x00\n#define DEST_MAC3   0x00\n#define DEST_MAC4   0x00\n#define DEST_MAC5   0x00\n\n#define ETHER_TYPE  0x0800\n\n#define DEFAULT_IF  \"eth0\"\n#define BUF_SIZ     1024\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1514997816, "post_id": 48081271, "comment_id": 83137419, "body": "If you&#39;d copied the array, you&#39;d not modify the (external) original!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514997985, "post_id": 48081271, "comment_id": 83137521, "body": "You can&#39;t do array assignment in C; you have to use a subterfuge such as <code>memmove(S, B, sizeof(VAR))</code> (or <code>memcpy()</code>), or embed the array within a structure and use structure assignment.  Note that your code seems to be trying to initialize a local array from the external array, whereas you say you&#39;d like to modify the external array from the local variable.  Ultimately, it doesn&#39;t matter; you can&#39;t assign one array to another regardless.  But your question is currently mildly confusing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1514998985, "post_id": 48081271, "comment_id": 83138056, "body": "How about <code>static VAR *p = &amp;B; ....  (*p)[42] = &#39;x&#39;;</code>?  Is this the kind of &quot;like to be able to modify it by using local variable&quot; you are looking for?"}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1515004562, "post_id": 48081271, "comment_id": 83140974, "body": "chux has a good idea about it. Use a local pointer to external array, and use it as an array."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1515039230, "post_id": 48081271, "comment_id": 83151759, "body": "<code>extern VAR B={0}</code> is a mistake. Besides the missing semicolon, having an initializer would make this a definition rather than a declaration , so including the header from multiple units causes undefined behaviour.  Please post real code"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1515039360, "post_id": 48081271, "comment_id": 83151787, "body": "You could do <code>char *S = B;</code> and then use <code>S</code> like <code>B</code> in most ways"}], "answers": [{"comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1577974403, "post_id": 48083816, "comment_id": 105297301, "body": "<code>[42]</code> =&gt; <code>[i]</code>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1577986828, "last_edit_date": 1592644375, "creation_date": 1515007190, "answer_id": 48083816, "question_id": 48081271, "link": "https://stackoverflow.com/questions/48081271/assign-extern-array-to-local-variable-without-copying-the-array/48083816#48083816", "title": "Assign extern array to local variable without copying the array", "body": "<blockquote>\n<p>I would like to be able to modify it by using local variable</p>\n<p>Is there any way that I can do that without copying the array?</p>\n</blockquote>\n<p>Create a pointer the to <code>extern</code> array.</p>\n<pre><code>#define VAR_N 200\ntypedef char VAR[VAR_N];\nextern VAR B;\n\nvoid foo(void) {\n  VAR *p = &amp;B;  // p is a pointer to B\n\n  printf(&quot;%c\\n&quot;, B[42]); // print original value of one element\n  (*p)[42] = 'x';\n  printf(&quot;%c\\n&quot;, B[42]); // print changed value of one element\n\n  // modify all elements of B\n  for (size_t i=0; i&lt;VAR_N; i++) {\n    (*p)[i] = 'y';\n  }\n  printf(&quot;%c\\n&quot;, B[42]); // print changed value of one element\n\n  // modify all elements of B\n  // Notice *p has the same size as B\n  size_t n = sizeof *p / sizeof (*p)[0];\n  memset(p, 'z', n);\n  printf(&quot;%c\\n&quot;, B[42]); // print changed value of one element\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9168990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2b80052da7c1cc679e5a91c2db96fbb?s=128&d=identicon&r=PG&f=1", "display_name": "deedee", "link": "https://stackoverflow.com/users/9168990/deedee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577986828, "creation_date": 1514996686, "last_edit_date": 1514998112, "question_id": 48081271, "link": "https://stackoverflow.com/questions/48081271/assign-extern-array-to-local-variable-without-copying-the-array", "title": "Assign extern array to local variable without copying the array", "body": "<p>I have an extern array, and I would like to be able to modify it by using local variable like:</p>\n\n<p><strong>Header file</strong></p>\n\n<pre><code>typedef char VAR[200]\nextern VAR B={0}\n</code></pre>\n\n<p><strong>Main file</strong></p>\n\n<pre><code>VAR S=B;\n</code></pre>\n\n<p>Is there any way that I can do that without copying the array? </p>\n"}, {"tags": ["c", "initialization", "stm32", "gpio", "hal"], "comments": [{"owner": {"reputation": 72, "user_id": 8900754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDhvL.jpg?s=128&g=1", "display_name": "dernst", "link": "https://stackoverflow.com/users/8900754/dernst"}, "edited": false, "score": 0, "creation_date": 1514995941, "post_id": 48080365, "comment_id": 83136292, "body": "Code looks correct.  I noticed that you configured this output differently than the others.  (Open Drain) and speed is different as well.  I would look at the hardware that was added. You might want to add some delay after you put the GPIO in reset before calling HAL_GPIO_Init to simulate what the could be happening by using the debugger.  Maybe the hardware needs some time to settle after you put the IO in reset? If you shared the schematic that might help."}, {"owner": {"reputation": 1473, "user_id": 6517894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0511b1daef16fed51233f70c4370dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Realtime Rik", "link": "https://stackoverflow.com/users/6517894/realtime-rik"}, "edited": false, "score": 0, "creation_date": 1515013479, "post_id": 48080365, "comment_id": 83145072, "body": "Sounds like you might be browning out. Otherwise you might have some other fault like a hard fault, bus fault etc as these do not always show up when single step debugging."}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1515052665, "post_id": 48080365, "comment_id": 83156158, "body": "dernst: yes, is diferent because I was doing many changes of all parametres and those are the ones left when I wrote the wuestion, with other velocities, pull up and pull down,... the error was the same."}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1515053220, "post_id": 48080365, "comment_id": 83156389, "body": "Realtime Rik: I have put waits long as 100 ms and the problem stills there. With wirerap I have connected PE10 to PE8 and PE8 don&#39;t gives any problem. For now I will work with PE8, and when the second board is mounted i will see if it is a systematic error or a MCU error"}, {"owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "edited": false, "score": 0, "creation_date": 1515138004, "post_id": 48080365, "comment_id": 83193441, "body": "In the second PCB, the code works fine. So must be a problem with the chip. I would mark as correct answer when I have tried more boards to be sure."}], "answers": [{"tags": [], "owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "is_accepted": false, "score": 0, "last_activity_date": 1516002184, "creation_date": 1516002184, "answer_id": 48258741, "question_id": 48080365, "link": "https://stackoverflow.com/questions/48080365/stm32l476-hal-gpio-init-sends-program-counter-to-position-0000-0000/48258741#48258741", "title": "stm32l476 HAl GPIO Init sends program counter to position 0000 0000", "body": "<p>After mounting 10 PCBs there is only one with this issue, so I will answer it was a problem with the MCU</p>\n"}], "owner": {"reputation": 472, "user_id": 3990801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6fba76487c37b838fb4de5f51aaf1f59?s=128&d=identicon&r=PG&f=1", "display_name": "taquionbcn", "link": "https://stackoverflow.com/users/3990801/taquionbcn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516002184, "creation_date": 1514993281, "question_id": 48080365, "link": "https://stackoverflow.com/questions/48080365/stm32l476-hal-gpio-init-sends-program-counter-to-position-0000-0000", "title": "stm32l476 HAl GPIO Init sends program counter to position 0000 0000", "body": "<p>I've been some months working on a Firmware for STM32L476VG. I've made a second version of my PCB adding more hardware as 6 MOSFET controlled from MCU.</p>\n\n<p>The problem is with the MOSFET controlled from PE10, as seen in the code below when I put the declarations and initialization which is correct or that\u2019s what I think because I\u2019ve been using same type of declarations and initializations in more projects, then the running/debug has strange behavior. It goes thru the code until it finds:\nHAL_GPIO_Init(GPIOE, &amp;GPIO_InitStruct);\nHere sometimes jumps to memory position 0000 0000,\nOther it gets stuck at startup_stm32l476xxx.s LoopForever(line 118) \uf0df here it gets because strange or unexpected ISR, I have to investigate more about this.</p>\n\n<p>If comment  lines</p>\n\n<pre><code>HAL_GPIO_WritePin(GPIOE,GPIO_PIN_10,GPIO_PIN_RESET);\n    GPIO_InitStruct.Pin = GPIO_PIN_10;\n    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_OD;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_LOW;\n    HAL_GPIO_Init(GPIOE, &amp;GPIO_InitStruct);\n</code></pre>\n\n<p>All runs perfect, except PE10</p>\n\n<pre><code>void MX_GPIO_Init(void)\n{\n\n    GPIO_InitTypeDef GPIO_InitStruct;\n\n    /* GPIO Ports Clock Enable */\n\n    __HAL_RCC_GPIOA_CLK_ENABLE();\n    __HAL_RCC_GPIOB_CLK_ENABLE();\n    __HAL_RCC_GPIOC_CLK_ENABLE();\n    __HAL_RCC_GPIOD_CLK_ENABLE();\n    __HAL_RCC_GPIOE_CLK_ENABLE();\n    __HAL_RCC_GPIOH_CLK_ENABLE();\n\n\n    HAL_GPIO_WritePin(GPIOE,GPIO_PIN_10,GPIO_PIN_RESET);\n    GPIO_InitStruct.Pin = GPIO_PIN_10;\n    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_OD;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_LOW;\n    HAL_GPIO_Init(GPIOE, &amp;GPIO_InitStruct);\n\n    HAL_GPIO_WritePin(GPIOE,GPIO_PIN_9,GPIO_PIN_RESET);\n    GPIO_InitStruct.Pin = GPIO_PIN_9;\n    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n    HAL_GPIO_Init(GPIOE, &amp;GPIO_InitStruct);\n\n    HAL_GPIO_WritePin(GPIOE,GPIO_PIN_11,GPIO_PIN_RESET);\n    GPIO_InitStruct.Pin = GPIO_PIN_11;\n    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n    HAL_GPIO_Init(GPIOE, &amp;GPIO_InitStruct);\n\n    HAL_GPIO_WritePin(GPIOE,GPIO_PIN_12,GPIO_PIN_RESET);\n    GPIO_InitStruct.Pin = GPIO_PIN_12;\n    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n    HAL_GPIO_Init(GPIOE, &amp;GPIO_InitStruct);\n\n    HAL_GPIO_WritePin(GPIOA,GPIO_PIN_11,GPIO_PIN_RESET);\n    GPIO_InitStruct.Pin = GPIO_PIN_11;\n    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;\n    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);\n\n    HAL_GPIO_WritePin(GPIOE,GPIO_PIN_1,GPIO_PIN_RESET);\n    GPIO_InitStruct.Pin = GPIO_PIN_1;\n    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;    \nHAL_GPIO_Init(GPIOE, &amp;GPIO_InitStruct);\n}\n</code></pre>\n\n<p>Debugging in step by step mode I'm unable to recreate the error i go thru all the HAL and GPIO libraries and I'm able to continue with normal program.</p>\n\n<p>What is happening?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 4, "creation_date": 1514992752, "post_id": 48080212, "comment_id": 83134406, "body": "Undefined behaviour? Why are you trying to print a float using the integer indicator? And how are you sure that <code>int</code> is 2 bytes?"}, {"owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "reply_to_user": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1514992821, "post_id": 48080212, "comment_id": 83134456, "body": "Why is it undefined ? I should get first 2 bytes because I am using %d specifier right?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1514992849, "post_id": 48080212, "comment_id": 83134474, "body": "No - it&#39;s UB - you investigate and tell us why it is happening on your machine, with your compiler, your environment etc."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1514992852, "post_id": 48080212, "comment_id": 83134476, "body": "What use cases are there for using <code>&quot;%d&quot;</code> with a <code>float</code>?"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 2, "creation_date": 1514992892, "post_id": 48080212, "comment_id": 83134493, "body": "Undefined behaviour because you&#39;re using something in a way it wasn&#39;t designed to be, and are getting strange results because of it."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1514992921, "post_id": 48080212, "comment_id": 83134511, "body": "Also, your umm.. forgot to tell us what output you did get when you tried it."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1514993334, "post_id": 48080212, "comment_id": 83134756, "body": "@SagarP When you use &quot;%d&quot; with printf, you promise printf that you will pass an integer. But you did not, you lied, and passed a float instead. This results in undefined behavior."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1514993351, "post_id": 48080212, "comment_id": 83134766, "body": "If you&#39;re working on an x86-64 system, the first few arguments to <code>printf</code> are passed via <i>registers</i>, not the stack, and different registers are used for floating point data vs. integer data.  So <code>printf</code> is effectively looking in the wrong place.  You can&#39;t rely on UB to produce <i>any</i> particular result."}, {"owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1514993381, "post_id": 48080212, "comment_id": 83134788, "body": "@lurker, I completely forgot that floats are stored as single point precision. Thanks for pointing that out. Now I used char pointer and when I tried *(p+3), I got 64 as output (as expected)."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 3, "creation_date": 1514993429, "post_id": 48080212, "comment_id": 83134814, "body": "Also don&#39;t forget <code>float</code> is promoted to a <code>double</code> in variadic parameter lists. So even if the hack works it won&#39;t do what is expected. If that sentence makes sense..."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1514994291, "post_id": 48080212, "comment_id": 83135349, "body": "Voted to close as &quot;unclear what you&#39;re asking&quot; as this is clearly a XY problem. OP doesn&#39;t wand to &quot;know what&#39;s happening&quot; with his specific code, he wants to know how to access his <code>float</code> byte-wise or int-wise (which is a different question, really). He should have been asking that, instead of having us gaze into the crystal ball of figuring out UB."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1514996874, "post_id": 48080212, "comment_id": 83136837, "body": "@DevSolar: It is not clearly an XY problem. OP asks \u201cCan someone tell me why is it happening?\u201d It is perfectly feasible that they started by attempting to examine the bytes in a float, encountered behavior they did not understand, and are now inquiring about that in a desire to understand the internal workings of computers and compilers. You might suspect it is an XY problem, but it is certainly not clear. You can ask the OP to clarify."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 0, "creation_date": 1514993450, "post_id": 48080281, "comment_id": 83134833, "body": "Yeah, I completely forgot that floats are represented using IEEE 754. Thanks."}, {"owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 0, "creation_date": 1514993951, "post_id": 48080281, "comment_id": 83135135, "body": "In my machine it would be stored as 0x00 00 00 40 right ? When I tried *(p+3) with p as char pointer, it printed 64 as expected. But when I tried it with int as *(p+1) with p as int pointer, it is printing 16384. Can you tell me why is it happening? I think that with int too, output should be 64."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 0, "creation_date": 1514994182, "post_id": 48080281, "comment_id": 83135276, "body": "@SagarP: When you&#39;re using an <code>int</code> pointer, <code>p + 3</code> means &quot;three times <code>sizeof int</code> from where <code>p</code> is pointing&quot;. How do you figure that should also print 64?"}, {"owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1514994328, "post_id": 48080281, "comment_id": 83135375, "body": "I wrote that I am using *(p+1) with int and not *(p+3) @DevSolar"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 0, "creation_date": 1514994425, "post_id": 48080281, "comment_id": 83135433, "body": "@SagarP: Yea, you edited your comment a couple of times... this is neither here or there. You didn&#39;t really ask what you wanted to know, now did you?"}, {"owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1514994533, "post_id": 48080281, "comment_id": 83135483, "body": "@DevSolar, Can you please tell me why is not printing 64?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 0, "creation_date": 1514994659, "post_id": 48080281, "comment_id": 83135548, "body": "@SagarP: The only conversion specified by the standard is from <code>type</code> to a sequence of <code>unsigned char</code> and back <i>to the same type</i>. You&#39;re looking at undefined behaviour.... <i>again</i>. Why not ask what you are <i>actually</i> trying to achieve?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1514993339, "last_edit_date": 1514993339, "creation_date": 1514992959, "answer_id": 48080281, "question_id": 48080212, "link": "https://stackoverflow.com/questions/48080212/endianess-using-d-specifier-for-float/48080281#48080281", "title": "Endianess using %d specifier for float", "body": "<p>Using the wrong format specifier to <code>printf</code> invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  </p>\n\n<p>In this particular case, what it probably happening is that floating point types are not pushed onto the stack the same way integer types are.  You can't however depend on this behavior as the standard does not dictate what will happen.</p>\n\n<p>If you want to print the bytes in a <code>float</code>, point an <code>unsigned char</code> to it and loop through the bytes:</p>\n\n<pre><code>float a=2;\nunsigned char *c = (unsigned char *)&amp;a;\nint i;\nfor (i=0; i&lt;sizeof(float); i++) {\n    printf(\"%02x \", c[i]);\n}\nprintf(\"\\n\");\n</code></pre>\n\n<p>Also, assuming your machine uses <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">IEEE754</a> format for floating point numbers, the representation for 2 isn't <code>0x00000002</code>, but <code>0x40000000</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 0, "creation_date": 1514994111, "post_id": 48080419, "comment_id": 83135232, "body": "In my machine the number would be stored as 0x00 00 00 40 right ? When I tried *(p+3) with p as char pointer, it printed 64 as expected. But when I tried it with int as *(p+1) with p as int pointer, it is printing 16384. Can you tell me why is it happening? I think that with int too, output should be 64"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 1, "creation_date": 1514995361, "post_id": 48080419, "comment_id": 83135953, "body": "@SagarP <code>*(p+1)</code> is the next <code>int</code>, not the next <code>unsigned char</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "edited": false, "score": 0, "creation_date": 1514996723, "post_id": 48080419, "comment_id": 83136744, "body": "@SagarP: With a little endian machine, the bytes 00 00 00 40 as one four-byte integer would be 40000000. As two two-byte integers, they would be 0000 and 4000. 4000 (hex) is 16384."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1514993461, "creation_date": 1514993461, "answer_id": 48080419, "question_id": 48080212, "link": "https://stackoverflow.com/questions/48080212/endianess-using-d-specifier-for-float/48080419#48080419", "title": "Endianess using %d specifier for float", "body": "<p>You seem to be assuming that, in <code>printf(\"%d\", a)</code>, the <code>float</code> value of <code>a</code> will be put in the same place that an <code>int</code> value would be put when passing an <code>int</code> parameter, and the <code>printf</code> will therefore read the bytes of the <code>float</code> as if they were an <code>int</code>.</p>\n\n<p>This is not what happens in many C implementations. The C standard does not say that all parameters are passed in the same place or the same way regardless of their type. It does not define what the behavior is when you pass mismatched parameters to <code>printf</code>. In many C implementations, the first few floating-point arguments are passed in floating-point registers of the processor, which are separate from the general integer registers.</p>\n\n<p>If you want to examine the bytes of an object, supported ways to do that include:</p>\n\n<ul>\n<li><p>Convert a pointer to the object to a pointer to <code>unsigned char</code> and then examine the bytes via the pointer to <code>unsigned char</code>.</p></li>\n<li><p>Use <code>memcpy</code> to copy the bytes to another object, such as <code>int x; memcpy(&amp;x, &amp;a, sizeof a);</code>. (The destination object should be the same size as the source object, so this is implementation-dependent.)</p></li>\n<li><p>Declare a union containing two types of object, the type you want to examine and another type such as <code>int</code> or an array of <code>unsigned char</code>. Write the value into one member of the union and read it from the other. E.g., <code>union { float f; int i; } x; x.f = a; printf(\"%d\", x.i);</code>. Again, the sizes of the two objects should match.</p></li>\n</ul>\n"}], "owner": {"reputation": 157, "user_id": 8784027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a5cb403293c0885af9b9d3cfceefc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sagar P", "link": "https://stackoverflow.com/users/8784027/sagar-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1515019292, "answer_count": 2, "score": -2, "last_activity_date": 1514993461, "creation_date": 1514992693, "question_id": 48080212, "link": "https://stackoverflow.com/questions/48080212/endianess-using-d-specifier-for-float", "closed_reason": "Needs details or clarity", "title": "Endianess using %d specifier for float", "body": "<pre><code>void main()\n{\n  float a=2;\n  printf(\"%d\",a);\n}\n</code></pre>\n\n<p>In my machine, float is 4 bytes, int is 2 bytes and bytes are stored in little-endian format.</p>\n\n<p>a is 0x 00 00 00 02</p>\n\n<p>Now as my machine is little endian, the bytes should be stored as 0x 02 00 00 00</p>\n\n<p>Now when I use %d specifer, first 2 bytes should be fetched and output should be 512, but I am not getting that output.</p>\n\n<p>Can someone tell me why is it happening?</p>\n"}, {"tags": ["c", "while-loop", "misra"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1514992553, "post_id": 48080136, "comment_id": 83134280, "body": "Which compiler are you using?"}, {"owner": {"reputation": 384, "user_id": 1852752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ae9674a894c9af62cd1151cda5ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "Segmentation", "link": "https://stackoverflow.com/users/1852752/segmentation"}, "edited": false, "score": 2, "creation_date": 1514992564, "post_id": 48080136, "comment_id": 83134288, "body": "How about using sleep()? Is it a requirement to create this function?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1514992600, "post_id": 48080136, "comment_id": 83134317, "body": "Is the compiler generating this warning, or a source code analysis tool?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514992631, "post_id": 48080136, "comment_id": 83134333, "body": "@alk A compiler that doesn&#39;t need a <code>;</code> after <code>int t = get_time() + time_in_ms</code>"}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 2, "creation_date": 1514992644, "post_id": 48080136, "comment_id": 83134345, "body": "is the warning also generated when using <code>while (...);</code>, i.e. without braces/body?"}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1514992975, "post_id": 48080136, "comment_id": 83134535, "body": "@wildplasser: I forgot do add ;"}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1514993000, "post_id": 48080136, "comment_id": 83134556, "body": "@dbush it&#39;s a source code analysis tool"}, {"owner": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "edited": false, "score": 1, "creation_date": 1514993009, "post_id": 48080136, "comment_id": 83134561, "body": "How <code>get_time()</code> is defined? Does it return a <code>const</code>?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1514993117, "post_id": 48080136, "comment_id": 83134641, "body": "Maybe get_time() returns a larger type than int? We&#39;ll never know..."}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "reply_to_user": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "edited": false, "score": 0, "creation_date": 1514993118, "post_id": 48080136, "comment_id": 83134644, "body": "@OlivierM No it returns the value of an free running counter register"}, {"owner": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "edited": false, "score": 0, "creation_date": 1514993185, "post_id": 48080136, "comment_id": 83134680, "body": "@JohnDoe could you add <code>get_time()</code> prototype to the original post?"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1514993187, "post_id": 48080136, "comment_id": 83134682, "body": "What about <code>t = t;</code> inside the loop?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1514993278, "post_id": 48080136, "comment_id": 83134722, "body": "<a href=\"https://stackoverflow.com/posts/48080136/edit\">Edit</a> your post to tag which static analyser you are using and quote the full error, preferably including any ID the analyser assigns. And show all the code needed to understand the fragment you posted, including the declaration and definition of any symbols you use in it. There is not enough information here to answer."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 6, "creation_date": 1514993779, "post_id": 48080136, "comment_id": 83135037, "body": "Busy-waiting is kind of a hack (CPU-and-energy-inefficient) way to implement a delay; perhaps your system&#39;s APIs have a better method (usleep() or similar) that you could use instead?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514996173, "post_id": 48080136, "comment_id": 83136450, "body": "Technically the tool is in error and you should forward this to their help desk."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1515004312, "post_id": 48080136, "comment_id": 83140842, "body": "Why are you trying to roll your own sleep function? Most OS&#39;s come with the sleep function built in and it is implemented in a much nicer way (scheduled) than endless-looping. You should consider using that if available."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1515404911, "post_id": 48080136, "comment_id": 83273530, "body": "Your tool fails to spot that <code>get_time</code> contains any side effects. What is <code>get_time()</code>? Does it contain any side effects? If this is some home-brewed code and you failed to include a <code>volatile</code> register access somewhere, then your code has a bug and the tool is correct to warn you. If there are such side effects present, then it is a tool bug."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1514994458, "post_id": 48080555, "comment_id": 83135447, "body": "Right, the lack of <code>const</code>-correctness could well be the culprit here (though I&#39;m not familiar with MISRA specifically). I guess I&#39;d be fine if I ever ran my code through something like this, as I put <code>const</code> everywhere possible. :)"}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1515063002, "post_id": 48080555, "comment_id": 83161706, "body": "@Melebius: The second proposal with the do-while loop fix the warning! Just as an review, are we sure that we do not change the logic on that way?"}, {"owner": {"reputation": 4604, "user_id": 711006, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/332d86b71d1ba573668d6620e2121a37?s=128&d=identicon&r=PG", "display_name": "Melebius", "link": "https://stackoverflow.com/users/711006/melebius"}, "reply_to_user": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 1, "creation_date": 1515063641, "post_id": 48080555, "comment_id": 83162067, "body": "@JohnDoe You can check the generated code using disassembler if the result remains same instruction after instruction. The logic definitely remains unchanged, I just added an auxiliary variable. MISRA requires them in some cases, e.g. for more complicated type casts."}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1515073860, "post_id": 48080555, "comment_id": 83168243, "body": "@Melebius Yes you are right. Your solution is also correct!"}], "tags": [], "owner": {"reputation": 4604, "user_id": 711006, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/332d86b71d1ba573668d6620e2121a37?s=128&d=identicon&r=PG", "display_name": "Melebius", "link": "https://stackoverflow.com/users/711006/melebius"}, "is_accepted": false, "score": 2, "last_activity_date": 1514998877, "last_edit_date": 1514998877, "creation_date": 1514994006, "answer_id": 48080555, "question_id": 48080136, "link": "https://stackoverflow.com/questions/48080136/bypass-the-warning-control-variable-is-not-modified-inside-the-loop/48080555#48080555", "title": "Bypass the warning: &quot;Control variable is not modified inside the loop&quot;", "body": "<p>The static analysis tool seems to be expecting a common case like:</p>\n\n<pre><code>int i = 0;\nwhile(i &lt; get_size(var))\n{\n    do_something(var[i]);\n    i++;\n}\n</code></pre>\n\n<p>However, in your case, the loop control variable is the result of <code>getTime()</code> while <code>t</code> is a limit.</p>\n\n<p>You can use a real loop control variable. The compiler will probably optimize it out.</p>\n\n<pre><code>void delay(int time_in_ms)\n{\n   int t = get_time() + time_in_ms;\n   int current_time;\n   do\n   {\n      current_time = getTime();\n   } while(current_time &lt; t);\n}\n</code></pre>\n\n<p>Or you can try to discover what makes your static analysis tool think that <code>t</code> is the loop control variable. A <code>const int t</code> declaration could help.</p>\n"}, {"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1515014545, "post_id": 48081492, "comment_id": 83145486, "body": "The first paragraph may explain the reasoning, though by the time you answered it was very clear that the question is about a static analyser, not a compiler. I also don&#39;t see how your 2nd suggestion could possibly produce different results in any case: it merely inverts the comparison and drops the empty block, neither of which I can imagine making any difference to optimisation or warnings, especially not the latter."}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1515059770, "post_id": 48081492, "comment_id": 83159790, "body": "@underscore_d, Thanks for the correction. Even this kind of tools to create code reviews and memory leak etc having their own logic. A warning from this tools should not be taken very seriously every time. I am agree that first while loop I have just removed the block but in the second code the tool might consider get_time() as control variable. I am just asking for try or else just ignore the warning which is base less in this case."}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1515062596, "post_id": 48081492, "comment_id": 83161485, "body": "@Abhijit You are right, the proposed code also didn&#39;t fix the warning."}], "tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1515061659, "last_edit_date": 1515061659, "creation_date": 1514997447, "answer_id": 48081492, "question_id": 48080136, "link": "https://stackoverflow.com/questions/48080136/bypass-the-warning-control-variable-is-not-modified-inside-the-loop/48081492#48081492", "title": "Bypass the warning: &quot;Control variable is not modified inside the loop&quot;", "body": "<p>Every Compiler or code review tools or memory leak analyzer tool has its own logic and based on it's logic it gives you warning or error message. Here in this case you compiler/tool is considering <code>t</code> as a control variable based on which <code>while loop</code> should break. As compiler/tool did not find any code inside while loop block to manipulate variable <code>t</code> its raised a warning for you, because it thought that your <code>while loop</code> might be a infinite <code>while loop</code>. Either you can ignore it as you are sure that it will never be a infinite loop or you can modify your code in a different way (see below, but might not fix this warning) to avoid this warning.</p>\n\n<pre><code>void delay(int time_in_ms)\n{\n   int t = get_time() + time_in_ms;\n   while ( t &gt; get_time() );\n}\n\ndelay(750);      \n</code></pre>\n\n<p>In the above changes I moved <code>t</code> to left hand side so that your tool should not consider <code>t</code> as control variable and should not raise any warning.  </p>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1515674721, "post_id": 48095090, "comment_id": 83395681, "body": "Oh, for goodness sake, no!  There is nothing wrong with the code ass shown above - although as LundIn points out, maybe in the implementation of get_time().  Trying to be clever to quieten your SA tool is the wrong approach!"}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "reply_to_user": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1515675904, "post_id": 48095090, "comment_id": 83396430, "body": "@Andrew what are you trying to say? I think it&#39;s clear that the question code is correct without any change (just the static analyzer doesn&#39;t understand this), so the whole question is, how to make the code pass some analyzer tests without warning."}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1515686131, "post_id": 48095090, "comment_id": 83403254, "body": "The OP&#39;s example code doesn&#39;t show if get_time() has a side effect (ie LundIn&#39;s point) - the SA tool seems to think that both t and get_time() are invariant.  Changing the do/while to an if will not change that."}], "tags": [], "owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "is_accepted": true, "score": 0, "last_activity_date": 1515067998, "creation_date": 1515067998, "answer_id": 48095090, "question_id": 48080136, "link": "https://stackoverflow.com/questions/48080136/bypass-the-warning-control-variable-is-not-modified-inside-the-loop/48095090#48095090", "title": "Bypass the warning: &quot;Control variable is not modified inside the loop&quot;", "body": "<p>While you may have some knowledge about <code>getTime()</code>, the static analyzer basically assumes that the return value of <code>getTime()</code> might never trigger the loop end condition, thus the loop would potentially be infinite.</p>\n\n<p>So what you need is an infinite loop that's accepted by the analyzer, combined with a break-condition within the loop body. As far as I can tell from a quick search, only <code>for(;;)</code> is accepted as an infinite loop by MISRA.</p>\n\n<pre><code>for ( ; ; )\n{\n    if (t &lt;= get_time()) break;\n}\n</code></pre>\n\n<p>This should not trigger a warning.</p>\n"}], "owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 48095090, "answer_count": 3, "score": 5, "last_activity_date": 1515067998, "creation_date": 1514992396, "last_edit_date": 1514995467, "question_id": 48080136, "link": "https://stackoverflow.com/questions/48080136/bypass-the-warning-control-variable-is-not-modified-inside-the-loop", "title": "Bypass the warning: &quot;Control variable is not modified inside the loop&quot;", "body": "<p>I have a very simple function which created a time delay:</p>\n\n<pre><code>void delay(int time_in_ms)\n{\n   int t = get_time() + time_in_ms;\n   while (get_time() &lt; t)\n   {\n   };\n}\n\ndelay(750);\n</code></pre>\n\n<p>I'm getting the warning that the control variable t is not modified inside the while loop. I don't need to modify the variable, I just need to be inside the while loop as long as the condition is met. How to bypass this in a \"nice\" way?</p>\n\n<p>The warning is created by MISRA static analysis tool. The full message:</p>\n\n<blockquote>\n  <p>\"The control variable in this loop construct is never modified\"<br>\n  MISRA C:2012 Rules applicable to message 2467: </p>\n</blockquote>\n"}, {"tags": ["java", "c", "linux", "vpn", "iptables"], "comments": [{"owner": {"reputation": 273, "user_id": 1794469, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ba04c6934be0e98a164f4992fde4a50?s=128&d=identicon&r=PG", "display_name": "user1794469", "link": "https://stackoverflow.com/users/1794469/user1794469"}, "edited": false, "score": 0, "creation_date": 1515008431, "post_id": 48080090, "comment_id": 83142849, "body": "What do you see with a <code>tcpdump</code> on eth0? Do they not make it there at all? What are the rules on filter table (<code>sudo iptables -L</code>)?"}, {"owner": {"reputation": 1039, "user_id": 7491770, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2683a57be298e228cfbf1070f586a675?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/7491770/ram"}, "reply_to_user": {"reputation": 273, "user_id": 1794469, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ba04c6934be0e98a164f4992fde4a50?s=128&d=identicon&r=PG", "display_name": "user1794469", "link": "https://stackoverflow.com/users/1794469/user1794469"}, "edited": false, "score": 0, "creation_date": 1515008740, "post_id": 48080090, "comment_id": 83142983, "body": "@user1794469 all chains have <code>ACCEPT</code> as default policy, and there are no other rules."}, {"owner": {"reputation": 1039, "user_id": 7491770, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2683a57be298e228cfbf1070f586a675?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/7491770/ram"}, "reply_to_user": {"reputation": 273, "user_id": 1794469, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ba04c6934be0e98a164f4992fde4a50?s=128&d=identicon&r=PG", "display_name": "user1794469", "link": "https://stackoverflow.com/users/1794469/user1794469"}, "edited": false, "score": 0, "creation_date": 1515008806, "post_id": 48080090, "comment_id": 83143021, "body": "@user1794469 since the responses are not coming back, I thought they are not arriving <code>eth0</code> at all but let me make sure about this. will update."}, {"owner": {"reputation": 1039, "user_id": 7491770, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2683a57be298e228cfbf1070f586a675?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/7491770/ram"}, "reply_to_user": {"reputation": 273, "user_id": 1794469, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ba04c6934be0e98a164f4992fde4a50?s=128&d=identicon&r=PG", "display_name": "user1794469", "link": "https://stackoverflow.com/users/1794469/user1794469"}, "edited": false, "score": 0, "creation_date": 1515009732, "post_id": 48080090, "comment_id": 83143477, "body": "@user1794469 please see edit. shortly, the packets do not appear on <code>eth0</code>. Do you have any idea about what is going on? It&#39;s a very basic routing problem actually."}, {"owner": {"reputation": 273, "user_id": 1794469, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ba04c6934be0e98a164f4992fde4a50?s=128&d=identicon&r=PG", "display_name": "user1794469", "link": "https://stackoverflow.com/users/1794469/user1794469"}, "edited": false, "score": 0, "creation_date": 1515013827, "post_id": 48080090, "comment_id": 83145233, "body": "Maybe someone more knowledgeable than me can chime in but, i think you need to bridge <code>tap0</code> with <code>eth0</code>. Here is info on how to: <a href=\"https://help.ubuntu.com/community/NetworkConnectionBridge\" rel=\"nofollow noreferrer\">help.ubuntu.com/community/NetworkConnectionBridge</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1039, "user_id": 7491770, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2683a57be298e228cfbf1070f586a675?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/7491770/ram"}, "is_accepted": true, "score": 3, "last_activity_date": 1515166054, "creation_date": 1515166054, "answer_id": 48116586, "question_id": 48080090, "link": "https://stackoverflow.com/questions/48080090/how-to-masquerade-tap-interface-traffic/48116586#48116586", "title": "How to MASQUERADE tap interface traffic", "body": "<p>As always, the reason was quite simple: While injecting the packets, I miscalculated the checksum in IP header. Namely, I forgot to flip the bits after the additions. Shame on me :(.</p>\n\n<p>I am not deleting the whole question since it might help people while developing similar applications.</p>\n\n<p>To checkout whether the checksums are OK, you can run <code>tcpdump</code> in a more verbose mode, i.e. including a few <code>-v</code> parameters. I used <code>tcpdump -i tap0 -n -X -s 0 -vvv</code> to also observe the content of the packets. It helped me a lot.</p>\n\n<p>Regarding the bridging option suggested by user1794469, you need to have additional IPs at the subnet of <code>eth0</code> that are available to assign to the clients, because bridging makes a client as if a new participant (without any NAT) joined to the subnet. However, my VPS has a single IP assigned to it, and it is not behind a NAT, so no DHCP etc. That's why I need to have my own NAT. Now it works flawlessly.</p>\n"}], "owner": {"reputation": 1039, "user_id": 7491770, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2683a57be298e228cfbf1070f586a675?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/7491770/ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 0, "accepted_answer_id": 48116586, "answer_count": 1, "score": 3, "last_activity_date": 1515166054, "creation_date": 1514992233, "last_edit_date": 1515009653, "question_id": 48080090, "link": "https://stackoverflow.com/questions/48080090/how-to-masquerade-tap-interface-traffic", "title": "How to MASQUERADE tap interface traffic", "body": "<p>I am currently developing a VPN server in Java, at least as much in Java as possible, and I am planning to perform routing of client packets through <code>tap</code> devices.</p>\n\n<p>Currently, I am able to write <code>ethernet</code> frames to the <code>tap</code> device and I can observe these packets through <code>tcpdump</code>. However they are not routed over <code>eth0</code>, although I enabled ip forwarding and added a <code>MASQUERADE</code> rule to the <code>iptables</code>. (This problem seems identical with <a href=\"https://unix.stackexchange.com/questions/222054/how-can-i-use-linux-as-a-gateway\">that</a>, except that the gateway interface is a real interface there and a virtual interface in my situation.)</p>\n\n<p>The output of <code>ifconfig tap0</code> is as follows:</p>\n\n<pre><code>tap0      Link encap:Ethernet  HWaddr 82:7d:95:39:71:a1  \n          inet addr:10.1.0.1  Bcast:10.1.255.255  Mask:255.255.0.0\n          inet6 addr: fe80::807d:95ff:fe39:71a1/64 Scope:Link\n          UP BROADCAST MULTICAST  MTU:1500  Metric:1\n          RX packets:767 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:56838 (56.8 KB)  TX bytes:0 (0.0 B)\n</code></pre>\n\n<p>The output of <code>ip link show tap0</code> is as follows:</p>\n\n<pre><code>12: tap0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000\n    link/ether 82:7d:95:39:71:a1 brd ff:ff:ff:ff:ff:ff\n</code></pre>\n\n<p>Here is how I attach to the tap device:</p>\n\n<pre><code>int helper_open(const char* dev_name, int tun_or_tap) {\n    struct ifreq ifr;\n    int fd;\n\n    if ((fd = open(\"/dev/net/tun\", O_RDWR)) == -1) {\n        return -1;\n    }\n\n    memset(&amp;ifr, 0, sizeof (ifr));\n    strncpy(ifr.ifr_name, dev_name, IFNAMSIZ);\n    ifr.ifr_flags = IFF_NO_PI;\n    if (tun_or_tap == DEVICE_TUN) {\n        ifr.ifr_flags |= IFF_TUN;\n    } else if (tun_or_tap == DEVICE_TAP) {\n        ifr.ifr_flags |= IFF_TAP;\n    } else {\n        return -2;\n    }\n\n    if (ioctl(fd, TUNSETIFF, (void *) &amp;ifr) == -1) {\n        close(fd);\n        return -3;\n    }\n\n    return fd;\n}\n</code></pre>\n\n<p>After successfully obtaining a file descriptor, it is trivial to write to the device through <code>write()</code> calls.</p>\n\n<p>How I prepare the ethernet frame is as follows:</p>\n\n<pre><code>public boolean sendIp(byte[] buffer, int start, int length) {\n    byte[] frame = new byte[length+14];\n    System.arraycopy(mac, 0, frame, 0, 6);\n    System.arraycopy(mac, 0, frame, 6, 2);\n    byte[] ip = IpUtils.getSourceIp(buffer, start).getAddress();\n    for (int i = 0; i &lt; 4; i++) {\n        frame[8+i] = (byte) (0xFF &amp; (ip[i] ^ mac[i+2]));\n    }\n    frame[12] = 0x08;\n    frame[13] = 0x00;\n    System.arraycopy(buffer, start, frame, 14, length);\n    try {\n        write(frame, 0, frame.length);\n        return true;\n    } catch (IOException e) {\n        logger.error(\"cannot send ip packet.\", e);\n        return false;\n    }\n}\n</code></pre>\n\n<p><code>mac</code> is the MAC address of the <code>tap</code> device, and I generate the MAC address of the client by XORing the last four bytes of the tap device's MAC with the virtual IP that is assigned by me. (In my tests, the client's IP is 10.1.0.2.) In this way, it will be unique for all participants and also it will be easy to handle ARP/RARP protocols.</p>\n\n<p>As it can be seen from <code>RX packets</code> field of <code>ifconfig</code> output, packets are received in <code>tap</code> device. Also, sample <code>tcpdump -i tap0 -n</code> output is as follows:</p>\n\n<pre><code>15:53:48.395082 IP 10.1.0.2.47132 &gt; 216.58.208.34.443: Flags [S], seq 3162009985, win 65535, options [mss 1460,sackOK,TS val 4294939804 ecr 0,nop,wscale 6], length 0\n15:53:49.396355 IP 10.1.0.2.39713 &gt; 216.58.208.42.443: Flags [S], seq 2459164785, win 65535, options [mss 1460,sackOK,TS val 4294939905 ecr 0,nop,wscale 6], length 0\n15:53:49.678691 IP 10.1.0.2.58306 &gt; 194.177.210.54.123: NTPv3, Client, length 48\n15:53:50.508132 IP 10.1.0.2.38112 &gt; 172.217.22.110.443: Flags [S], seq 3132386571, win 65535, options [mss 1460,sackOK,TS val 4294940016 ecr 0,nop,wscale 6], length 0\n15:53:51.519119 IP 10.1.0.2.37492 &gt; 216.58.207.42.443: Flags [S], seq 3750738666, win 65535, options [mss 1460,sackOK,TS val 4294940117 ecr 0,nop,wscale 6], length 0\n</code></pre>\n\n<p>The packets are correctly decoded by tcpdump, so it seems I am preparing ethernet frames successfully. <code>sysctl net.ipv4.ip_forward</code> shows that ip forwarding is enabled. Then why are they not routed through <code>eth0</code>?</p>\n\n<p>Output of <code>iptables -L -n -v -t nat</code>:</p>\n\n<pre><code>Chain PREROUTING (policy ACCEPT 2436 packets, 132K bytes)\n pkts bytes target     prot opt in     out     source               destination         \n\nChain INPUT (policy ACCEPT 2436 packets, 132K bytes)\n pkts bytes target     prot opt in     out     source               destination         \n\nChain OUTPUT (policy ACCEPT 20 packets, 1462 bytes)\n pkts bytes target     prot opt in     out     source               destination         \n\nChain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source               destination         \n   20  1462 MASQUERADE  all  --  *      eth0    0.0.0.0/0            0.0.0.0/0\n</code></pre>\n\n<p>and output of <code>route -n</code>:</p>\n\n<pre><code>Kernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         173.212.233.1   0.0.0.0         UG    0      0        0 eth0\n10.1.0.0        0.0.0.0         255.255.0.0     U     0      0        0 tap0\n173.212.233.0   173.212.233.1   255.255.255.0   UG    0      0        0 eth0\n173.212.233.0   0.0.0.0         255.255.255.0   U     0      0        0 eth0\n</code></pre>\n\n<p>Any kind of help is highly appreciated.</p>\n\n<p>P.S: I am developing on Ubuntu 16.04.</p>\n\n<p><strong>EDIT:</strong>\nTo make sure that the packets do not depart from <code>eth0</code>, I started <code>tcpdump -i eth0 host 5.189.147.197 -n</code> and <code>tcpdump -i tap0 host 5.189.147.197 -n</code> on separate terminals and in the meanwhile the client attempted to connect to <code>5.189.147.197</code>. I observed the traffic on <code>tap0</code> interface but not on <code>eth0</code> interface. So they are not forwarded, for sure.</p>\n"}, {"tags": ["c", "encryption", "openssl", "cryptography", "cfb-mode"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1514991965, "post_id": 48079986, "comment_id": 83133935, "body": "You should show example input and output data. Also, that&#39;s not the code so far, because that code wouldn&#39;t compile. Post all of the code required to replicate/analyse the problem."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1514992978, "post_id": 48079986, "comment_id": 83134540, "body": "Why are you using IDEA, AES is more secure and is often has hardware support for performance."}, {"owner": {"reputation": 121, "user_id": 4937086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b506ecd27241ffa378f97d0093771a?s=128&d=identicon&r=PG&f=1", "display_name": "Twin322", "link": "https://stackoverflow.com/users/4937086/twin322"}, "edited": false, "score": 0, "creation_date": 1514993430, "post_id": 48079986, "comment_id": 83134816, "body": "Yeah... I know, but it is a task at my university."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514999278, "post_id": 48079986, "comment_id": 83138212, "body": "Rather than edit your question when an acceptable answer occurs, read <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1515039258, "post_id": 48079986, "comment_id": 83151765, "body": "You should add a hex dump of <code>cipher.bin</code> and <code>key.bin</code>. Also see <a href=\"http://wiki.openssl.org/index.php/EVP_Symmetric_Encryption_and_Decryption\" rel=\"nofollow noreferrer\">EVP Symmetric Encryption and Decryption</a> on the OpenSSL wiki."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 4937086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b506ecd27241ffa378f97d0093771a?s=128&d=identicon&r=PG&f=1", "display_name": "Twin322", "link": "https://stackoverflow.com/users/4937086/twin322"}, "is_accepted": true, "score": 0, "last_activity_date": 1514995880, "creation_date": 1514995880, "answer_id": 48081061, "question_id": 48079986, "link": "https://stackoverflow.com/questions/48079986/idea-cfb-mode-decryption-and-corrupted-block/48081061#48081061", "title": "IDEA/CFB mode decryption and corrupted block", "body": "<p><strong>Big mistake on my side</strong> </p>\n\n<p>I read the keys out of the file and messed up with the index...</p>\n\n<p>the IV vector was corrupted </p>\n\n<pre><code>int j=0;\nfor(int i = 16;i&lt;24;i++){\n    iv[j] = buffer[i];\n    printf(\"0x%02x,\", iv[i]);\n    j++;\n}\n</code></pre>\n\n<p>That fixed it</p>\n"}], "owner": {"reputation": 121, "user_id": 4937086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b506ecd27241ffa378f97d0093771a?s=128&d=identicon&r=PG&f=1", "display_name": "Twin322", "link": "https://stackoverflow.com/users/4937086/twin322"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 48081061, "answer_count": 1, "score": 0, "last_activity_date": 1515038694, "creation_date": 1514991835, "last_edit_date": 1515038694, "question_id": 48079986, "link": "https://stackoverflow.com/questions/48079986/idea-cfb-mode-decryption-and-corrupted-block", "title": "IDEA/CFB mode decryption and corrupted block", "body": "<p>I'm trying to understand the OpenSSL library. I have written a program in C which should decrypt an IDEA/CFB mode encrypted using OpenSSL 1.1.0g. This is the code so far:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;fcntl.h&gt;                     /* O_RDONLY */\n#include &lt;stdio.h&gt;                       /* printf */\n#include &lt;string.h&gt;                      /* memcpy */\n#include &lt;unistd.h&gt;                        /* read */\n#include &lt;openssl/idea.h&gt;                  /* BF_* */\n#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/ripemd.h&gt;\n\n#define BUFFER_SIZE 861\n\nunsigned char key[16];\nunsigned char iv[8];\n\nint read_file(char *file, unsigned char *buffer);\n\nint main(void)\n{\n\n    unsigned char buffer[BUFFER_SIZE];\n    unsigned char cipher_buffer[BUFFER_SIZE];\n    unsigned char plain[BUFFER_SIZE];\n    unsigned char iv_buffer[BUFFER_SIZE];\n    unsigned char hash_buffer[BUFFER_SIZE];\n    unsigned char final[BUFFER_SIZE];\n    EVP_CIPHER_CTX *ctx = EVP_CIPHER_CTX_new(); \n    EVP_CIPHER *ciph;    \n    char *cipher = \"./cipher.bin\";\n    char *key1 = \"./key.bin\";\n\n    //read key\n    int blah = read_file(key1,buffer);\n    printf(\"\\nKeylength: %d\\n\", EVP_CIPHER_key_length(EVP_idea_cfb64()));\n    printf(\"IV Length: %d\\n\",EVP_CIPHER_iv_length(EVP_idea_cfb64()));\n    printf(\"\\nKEY:\");\n    for(int i = 0;i&lt;16;i++){\n        key[i] = buffer[i];\n        printf(\"%d \", buffer[i]);\n    }\n\n    printf(\"\\nIV : \");\n    for(int i = 16;i&lt;24;i++){\n        iv[i] = buffer[i];\n        printf(\"%d \", iv[i]);\n    }\n\n    //read cipher\n    int cipherLen = read_file(cipher,cipher_buffer);\n    unsigned char cipher_text[cipherLen];\n    for(int i = 0; i&lt;861;i++){\n        cipher_text[i] = cipher_buffer[i];\n    }\n\n    int outlen = 0;  \n    unsigned char lastl[BUFFER_SIZE];\n    int last;\n    EVP_CIPHER_CTX_init(ctx);\n    EVP_CipherInit_ex(ctx,EVP_idea_cfb(),NULL,key,iv,0);\n    EVP_CipherUpdate(ctx,plain,&amp;last,cipher_buffer,BUFFER_SIZE);\n    EVP_DecryptFinal_ex(ctx,plain,&amp;last);\n\n    printf(\"%s\",plain);\n\n    return 0;\n}\n\nint read_file(char *file, unsigned char *buffer){\n    int fp = open(file,O_RDONLY);\n    //printf(\"fd:%d File: %s\\n\",fp,file);\n    if(fp == -1){\n        perror(\"File not found\");\n    }\n    int f_size = lseek (fp , 0 , SEEK_END);\n    lseek (fp , 0 ,SEEK_SET);\n    printf(\"     f_size:%d\\n\",f_size);\n    read(fp,buffer,BUFFER_SIZE);\n\n    //printf(\"lol:%d\\n\", f_size);\n    return f_size;\n}\n</code></pre>\n\n<p>The problem I have is that when I print the result everything is fine but the first block of the text is corrupted ( the first 8 byte) I think it has something to do with the CFB mode, but I can't wrap my head around this. :(</p>\n\n<p>This is the Output:\n<a href=\"https://i.stack.imgur.com/Q5EY3.png\" rel=\"nofollow noreferrer\">Output</a></p>\n\n<p>And these are the two files (cipher.bin and key.bin):</p>\n\n<p><a href=\"https://drive.google.com/file/d/12MseLV3uHXHseEhOih7t7804-cqCZjWT/view?usp=sharing\" rel=\"nofollow noreferrer\">cipher.bin</a></p>\n\n<p><a href=\"https://drive.google.com/file/d/1r25y81j6_P0aPepSSKk3BlJ0p8_0m2Gh/view?usp=sharing\" rel=\"nofollow noreferrer\">key.bin</a></p>\n"}, {"tags": ["c", "shell"], "comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 3, "creation_date": 1514990828, "post_id": 48079509, "comment_id": 83133194, "body": "Let the mother process parse commands, and only then fork"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514990948, "post_id": 48079509, "comment_id": 83133278, "body": "Normally you exit your program by calling <code>exit</code>. Have you tried that? Are you sure the flag is set? <code>if ( strcmp(line, &quot;quit&quot;)</code> doesn&#39;t seem to be formatted correctly and may not do what you think it should do. Please don&#39;t type your code when posting questions. Copy and paste from actual buildable code instead."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6420403"}, "edited": false, "score": 0, "creation_date": 1514991065, "post_id": 48079509, "comment_id": 83133348, "body": "I&#39;ve put a <code>printf</code> statement inside the <code>if-clase</code> checking for <code>quit</code> and checked that it gets it when <code>quit</code> command is placed. My actual code is too many lines that&#39;s why I tried to shrink it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514991336, "post_id": 48079509, "comment_id": 83133505, "body": "It&#39;s OK to shrink your code but it&#39;s not OK to maim it in process. Please produce a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1514991732, "post_id": 48079509, "comment_id": 83133746, "body": "wouldn&#39;t you rather want <code>strcmp(line_1 ...</code>? or <code>strstr(line, &quot;quit&quot;)</code>?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6420403"}, "edited": false, "score": 0, "creation_date": 1515023051, "post_id": 48079755, "comment_id": 83148426, "body": "Checking if <code>quit</code> is present in the mother proccess did the job for me!"}], "tags": [], "owner": {"reputation": 121, "user_id": 7122068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlGGj.png?s=128&g=1", "display_name": "Glick", "link": "https://stackoverflow.com/users/7122068/glick"}, "is_accepted": true, "score": 1, "last_activity_date": 1523628784, "last_edit_date": 1523628784, "creation_date": 1514991068, "answer_id": 48079755, "question_id": 48079509, "link": "https://stackoverflow.com/questions/48079509/c-command-line-interpreter/48079755#48079755", "title": "C - Command line interpreter", "body": "<p>You need to check if quit is present in the parent process.\nYou can then fork and use <strong>wait()</strong> in order to wait your child proccess to terminate and then exited normally.\nOr even fork and exit directly.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6420403"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 48079755, "answer_count": 1, "score": 1, "last_activity_date": 1523628784, "creation_date": 1514990232, "last_edit_date": 1514991862, "question_id": 48079509, "link": "https://stackoverflow.com/questions/48079509/c-command-line-interpreter", "title": "C - Command line interpreter", "body": "<p>I am implementing a command line interpreter as a university homework assignment. I get the string of commands and then I have to fork and execute the commands in the child proccess. Here is a sample of my code:</p>\n\n<pre><code>do\n{\n    if (argc == 1)\n    {\n        do\n        {\n            do\n            {   \n                printf(\"prompt&gt;&gt; \");\n                line = get_string();\n            }while(strcmp(line, \"\") == 0 || line[0] == ';');\n\n        if ( (pid = fork()) &lt; 0 )\n        {\n            perror(\"error in forking.\");\n            exit(1);\n        }\n        else if (pid == 0)\n        {\n            // execute the commands with format: cmd1 ; cmd2 ; cmd3\n            line_1 = strtok(line, NULL);\n            if ( strcmp(line_1, \"quit\")\n            {\n                flag = 1;\n            }\n\n        }\n        else\n        {\n            printf(\"...mother proccess...\\n\");\n        }\n        while ( (wpid = wait(&amp;stat)) &gt; 0)\n    }while(status);\n}\n}while(something);\n</code></pre>\n\n<p>If I have a <code>quit</code> command in the commands format <code>cmd1 ; cmd2; cmd3</code>, I have to execute all the command and then exit the programm independent of where the <code>quit</code> command has been placed in the command's format. I have managed to execute all the commands and set the <code>flag</code> variable to 1 if I find quit. Problem is I cannot exit my program if <code>flag == 1</code> after execution of all the commands has finished. I tried by send a <code>SIGTERM</code> signal from child with the parent's id but id didn't work. How could I do that ?</p>\n"}, {"tags": ["c#", "c", "dll", "process", "access-violation"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1514990607, "post_id": 48079356, "comment_id": 83133052, "body": "You should find out where the crash happens in <code>program.exe</code>."}, {"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1514994076, "post_id": 48079356, "comment_id": 83135212, "body": "Is that <i>all</i> your C# program does? It doesn&#39;t do anything with USB devices or anything?"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 1328511, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/edead36b8c0d606942eb2171b62ded1a?s=128&d=identicon&r=PG", "display_name": "Marvos", "link": "https://stackoverflow.com/users/1328511/marvos"}, "edited": false, "score": 0, "creation_date": 1515143518, "post_id": 48079407, "comment_id": 83196038, "body": "I tried it now and it does not work, the result is the same."}], "tags": [], "owner": {"reputation": 353, "user_id": 2167335, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-GCKcL236wXU/AAAAAAAAAAI/AAAAAAAAJSw/Jr_5-7rPaEM/photo.jpg?sz=128", "display_name": "The Whether Man", "link": "https://stackoverflow.com/users/2167335/the-whether-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1514989929, "creation_date": 1514989929, "answer_id": 48079407, "question_id": 48079356, "link": "https://stackoverflow.com/questions/48079356/c-console-program-crashes-on-exit-access-violation-only-when-run-as-an-externa/48079407#48079407", "title": "C console program crashes on exit (Access Violation) only when run as an external program in C# using Process.Start()", "body": "<p>This is kind of a shot in the dark, but have to tried changing <code>UseShellExecute</code> to false?</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.useshellexecute(v=vs.110).aspx\" rel=\"nofollow noreferrer\" title=\"MSDN\">MSDN Process Docs</a></p>\n"}, {"tags": [], "owner": {"reputation": 255, "user_id": 1328511, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/edead36b8c0d606942eb2171b62ded1a?s=128&d=identicon&r=PG", "display_name": "Marvos", "link": "https://stackoverflow.com/users/1328511/marvos"}, "is_accepted": true, "score": 1, "last_activity_date": 1515260240, "creation_date": 1515260240, "answer_id": 48130027, "question_id": 48079356, "link": "https://stackoverflow.com/questions/48079356/c-console-program-crashes-on-exit-access-violation-only-when-run-as-an-externa/48130027#48130027", "title": "C console program crashes on exit (Access Violation) only when run as an external program in C# using Process.Start()", "body": "<p>I solved the issue. Michael's suggestion to find the crash in program.exe made me look at the output in the IDE for program.exe, and I noticed the errors were happening there too, it just wasn't crashing.</p>\n\n<p>Turns out I had a couple of <em>malloc</em>'d variables that I forgot to <em>free</em>. Fixing that fixed the errors and the crashing in the C# application.</p>\n"}], "owner": {"reputation": 255, "user_id": 1328511, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/edead36b8c0d606942eb2171b62ded1a?s=128&d=identicon&r=PG", "display_name": "Marvos", "link": "https://stackoverflow.com/users/1328511/marvos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 48130027, "answer_count": 2, "score": 0, "last_activity_date": 1515260240, "creation_date": 1514989753, "question_id": 48079356, "link": "https://stackoverflow.com/questions/48079356/c-console-program-crashes-on-exit-access-violation-only-when-run-as-an-externa", "title": "C console program crashes on exit (Access Violation) only when run as an external program in C# using Process.Start()", "body": "<p>I have a console program written in C that uses an unmanaged library (dll) to perform actions with a USB device. It reads and uses the parameters passed to the main function. This program works and exits OK when compiled and executed standalone (in a command line).</p>\n\n<p>Then I have a second program written in C# that should call the first program with some parameters, using the following code:</p>\n\n<pre><code>Process runProg = new Process(); \nrunProg.StartInfo.FileName = @\"C:\\Path\\to\\my\\program.exe\";\nrunProg.StartInfo.Arguments = @\"hello123 testing123@test.com\";\nrunProg.Start();\nrunProg.WaitForExit();\n</code></pre>\n\n<p>It runs the first program which does what it was supposed to do (I checked what the USB device did), but when returning from the program it crashes and shows me the \"This program has stopped working\" window.</p>\n\n<p>Debugger says: </p>\n\n<pre><code>\"Unhandled exception at 0x77962EE5 (ntdll.dll) in program.exe: 0xC0000005: Access violation reading location 0x6E650254.\"\n</code></pre>\n\n<p>What would be different when running the first program from the C# program as opposed to the windows command line that would cause this? Have I forgotten some part?</p>\n\n<p>Is there another way to run the first program? Maybe a way to tell Windows to execute the first program with cmd.exe, not try whatever it is trying to do now that causes this crash? A way to make it functionally the same as if I execute the first program exe manually, which works OK?</p>\n"}, {"tags": ["c", "arrays", "unix", "struct", "shared-memory"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1514987980, "post_id": 48078841, "comment_id": 83131580, "body": "Does the code you posted represent something you have that compiles? (because as is, what you have posted does not)"}, {"owner": {"reputation": 3, "user_id": 9168300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cec25db7bb42e62ac21cb5d5fe8b81?s=128&d=identicon&r=PG&f=1", "display_name": "iAnwar", "link": "https://stackoverflow.com/users/9168300/ianwar"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1514991217, "post_id": 48078841, "comment_id": 83133419, "body": "the code I have does not compile, i&#39;m just trying to work out how to put the array in the shared memory that i create"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1514992515, "post_id": 48078841, "comment_id": 83134260, "body": "See this answer <i><a href=\"https://stackoverflow.com/a/43923618/645128\">HERE</a></i>. It goes into sufficient detail to get you started.  BTW, this is actually a very useful site for getting answers from people, but as with anything, you should know the <i><a href=\"https://stackoverflow.com/help/mcve\">rules of the road</a></i> to maximize your experience here."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1514992644, "post_id": 48078841, "comment_id": 83134348, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43923518/how-to-put-a-variable-in-a-shared-memory\">How to put a variable in a shared memory?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9168300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cec25db7bb42e62ac21cb5d5fe8b81?s=128&d=identicon&r=PG&f=1", "display_name": "iAnwar", "link": "https://stackoverflow.com/users/9168300/ianwar"}, "edited": false, "score": 0, "creation_date": 1515081475, "post_id": 48082450, "comment_id": 83172920, "body": "but would i not need a key to access the shared memory in the client"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 3, "user_id": 9168300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cec25db7bb42e62ac21cb5d5fe8b81?s=128&d=identicon&r=PG&f=1", "display_name": "iAnwar", "link": "https://stackoverflow.com/users/9168300/ianwar"}, "edited": false, "score": 0, "creation_date": 1515084200, "post_id": 48082450, "comment_id": 83174571, "body": "Yes created shared memory will be identified by <code>shmid</code> and <code>key</code>,  you can check using <code>ipcs  -m</code> command. <code>Key</code> is not required because once data is copied into pointer(<code>shmat</code> address) you can use that <code>pointer</code> to access shared memory in the client."}, {"owner": {"reputation": 3, "user_id": 9168300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cec25db7bb42e62ac21cb5d5fe8b81?s=128&d=identicon&r=PG&f=1", "display_name": "iAnwar", "link": "https://stackoverflow.com/users/9168300/ianwar"}, "edited": false, "score": 0, "creation_date": 1515167654, "post_id": 48082450, "comment_id": 83210242, "body": "Thank you for the help. if I wanted to put a char into the shared memory in front of the array. How would I go about doing that?"}, {"owner": {"reputation": 3, "user_id": 9168300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cec25db7bb42e62ac21cb5d5fe8b81?s=128&d=identicon&r=PG&f=1", "display_name": "iAnwar", "link": "https://stackoverflow.com/users/9168300/ianwar"}, "edited": false, "score": 0, "creation_date": 1515326059, "post_id": 48082450, "comment_id": 83250964, "body": "Hi sorry to keep bothering you but, there was an issue with receiving the array in the client program. i tried to print it out but all I am getting is ones I was wondering if you could help"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 3, "user_id": 9168300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cec25db7bb42e62ac21cb5d5fe8b81?s=128&d=identicon&r=PG&f=1", "display_name": "iAnwar", "link": "https://stackoverflow.com/users/9168300/ianwar"}, "edited": false, "score": 0, "creation_date": 1515338037, "post_id": 48082450, "comment_id": 83254377, "body": "@iAnwar sorry is not required bro. I don&#39;t know how you are receiving array in client program so I can&#39;t guess. Can you modify your question and put that particular portion of code where you are not receiving not correctly ?"}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 1, "last_activity_date": 1515001300, "creation_date": 1515001300, "answer_id": 48082450, "question_id": 48078841, "link": "https://stackoverflow.com/questions/48078841/putting-an-array-of-structs-into-shared-memory-in-unix-so-that-it-can-be-accesse/48082450#48082450", "title": "putting an array of structs into shared memory in unix so that it can be accessed by a client program", "body": "<p><strong>I have an array of 10 structs and I would like to put that array into shared memory ?</strong> It's very simple, first create <code>array 10 struct variable</code> and then create the <code>shared memory</code> using <code>shmget</code> of required <code>size</code> and then <code>attach</code> that <code>shared memory</code> with <code>pointer</code> and finally <code>copy</code> array of 10 structs into pointer attached with <code>shmat</code>. I added below simple code to understand your requirement.</p>\n\n<pre><code>typedef struct company {\n        int emp_id;\n}cmp;\nint main(int argc,char *argv[]) {\n        cmp cmp_info[10];\n        int shm_id, sze = sizeof(cmp_info) ,i;\n        /* I have an array of 10 structs -- with some data like emp_id*/\n        for(i=0 ;i&lt;10 ;i++) {\n        printf(\"\\n enter emp % Id \\n\",i);\n        scanf(\"%d\",&amp;cmp_info[i].emp_id);\n        }\n        /* create the shared memory of 'sze' size. */\n        shm_id = shmget(10,sze, IPC_CREAT | 0664);\n        perror(\"shmget\");\n        /* attach the shared memory with shm_id */\n        cmp *shm_ptr = shmat(shm_id, NULL, 0);\n        perror(\"shmat\");\n        /* I have an array of 10 structs and I would like to put that array into shared memory  */\n        shm_ptr = cmp_info;//now shared memory contains array of 10 struct data \n\n        /** print using shm_ptr to verify **/\n        for(i=0;i&lt;10;i++) {\n        printf(\"Employee[%d] Id is : [%d]\\n\",i,shm_ptr[i].emp_id);\n        }\n        /* once above things are done clients program can read from shared memory */\n        /** finaly de-atach the shared memory */\n        shmdt(shm_ptr);\n}\n</code></pre>\n\n<p>Below snapshot is for your code, Explanation is in comments.</p>\n\n<pre><code>struct strProcess {\n        int nPriority;\n        int nPid;\n};\nint main(int argc,char *argv[]) {\n        // Variable Declarations\n        int     nShmid,i,arraySize,nRpriority,j, nInput;\n        key_t   nKey;\n        char    *ptrshm, *ptrs;\n        int     nSize;\n        struct  strProcess pArray[10];//array of 10 structure\n        struct  strProcess *Array;\n        //Array = pArray;\n        nKey = 5678;\n        FILE *f = fopen(\"logfile.txt\", \"w\");\n        if(f == NULL) {\n                printf(\"Error opening file!\\n\");\n                exit(1);\n        }\n        nSize = sizeof(pArray);\n        //create segment\n        if((nShmid = shmget(nKey,nSize, IPC_CREAT | 0666)) &lt; 0) {\n                perror(\"shmget\");\n                exit(1);\n        }\n        else {\n                perror(\"shmget\");\n                fprintf(f, \"\\n shared memory segment created\\n\");\n        }\n        Array  = shmat(nShmid, NULL, 0);\n        perror(\"shmat\");\n        /** loop to create exaCtly 10 process */\n        nInput = 10; /** call finval function **/\n        for(i = 0 ; i &lt; nInput; i++) {\n                if(fork() == 0) {\n                        srand(getpid());\n                        Array[i].nPid = getpid();\n                        nRpriority = rand()%10 + 1;//putting random no b/w 1 to 10..u can call your function also\n                        Array[i].nPriority = nRpriority;\n                        fprintf(f, \"\\nprint job created with Pid [%d] and priority number [%d]\\n\",\n                                        Array[i].nPid, Array[i].nPriority);\n                        break;//must to avoid repeating\n                }\n                else {\n                        ;//parent does nothing\n                }\n        }\n        shmdt(Array);\n        //fprintf(f,\"\\n total [%d] processes have been created\\n\",nInput);\n        /* call fsortasc(pArray, nInput); */\n        fclose(f);\n}\n</code></pre>\n\n<p>I hope it helps.    </p>\n"}], "owner": {"reputation": 3, "user_id": 9168300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70cec25db7bb42e62ac21cb5d5fe8b81?s=128&d=identicon&r=PG&f=1", "display_name": "iAnwar", "link": "https://stackoverflow.com/users/9168300/ianwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 48082450, "answer_count": 1, "score": 0, "last_activity_date": 1515001300, "creation_date": 1514987784, "question_id": 48078841, "link": "https://stackoverflow.com/questions/48078841/putting-an-array-of-structs-into-shared-memory-in-unix-so-that-it-can-be-accesse", "title": "putting an array of structs into shared memory in unix so that it can be accessed by a client program", "body": "<p>So i'm currently trying to code in unix using shared memory and the fork() function, I have an array of 10 structs and I would like to put that array into shared memory so that it can be accessed by a client program. I was hoping someone could point me in the right direction on how to do this.</p>\n\n<p>the code I currently have is:</p>\n\n<pre><code>//  Compiler Directives\n\n\n//  Standard Library Inclusions\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;time.h&gt;\n//Other Inclusions\n\nstruct strProcess \n{\n  int nPriority;\n  int nPid;\n};\n//  Function Prototypes (if not included within a header file)\nint frand (int nInput);\nint finval (int nInput);\nvoid fsortasc(struct strProcess pArray[],int nInput);\n//  Main\nint main(void)\n{\n// Variable Declarations\nint     nShmid,i,arraySize,nRpriority,j, nInput;\nkey_t   nKey;\nchar    *ptrshm, *ptrs;\nint     nSize;\npid_t   pid; \nstruct  strProcess pArray[10];\nstruct  strProcess *Array;\n\nArray = pArray;\n// Code start\n\nnKey = 5678;\nFILE *f = fopen(\"logfile.txt\", \"w\");\n\nif (f == NULL)\n{\n      printf(\"Error opening file!\\n\");\n      exit(1);\n}\n\nprintf(\"please enter the amount of processes to create for this cycle between 1 and 10 \\n\");\nscanf(\"%d\",&amp;nInput);\nif (nInput &lt;= 0 || nInput &gt; 10)\n{\n  nInput = finval(nInput);\n}\nprintf(\"%d\", nInput);\n\nnSize = sizeof(pArray) * 10;\n //create segment\nif ((nShmid = shmget(nKey,nSize, IPC_CREAT | 0666)) &lt;0)\n{\n      perror(\"shmget\");\n      exit(1);\n}\nprintf(\"segment created \\n\\n\");\nfprintf(f, \"shared memory segment created\");\n\nArray *pArray = shmat(shmid,NULL, 0);\nif (Array* pArray (-1)) \n{\n      perror(\"shmat\");\n      exit(1);\n}\nprintf(\"segment attached \\n\\n\");\nfprintf(f, \"shared memory segment attached\");\n\nfor(i = 0 ; i &lt; nInput; i++)\n{\n    if ((pid = fork()) &lt; 0)\n    {\n      perror(\"fork\");\n      exit(1);\n    }\n    if (pid == 0)\n    {\n      Array[i].nPid = getpid();\n      nRpriority = frand(nInput);\n      Array[i].nPriority = nRpriority;\n      printf(\"print job created with Pid %d and priority number %d\", \n      getpid(), nRpriority);\n      fprintf(f, \"print job created with Pid %d and priority number %d\", \n      getpid(), nRpriority);\n    }\n}\n\nfprintf(f, \" %d processes have been created\", nInput);\nfsortasc(pArray, nInput);   /*sort array into ascending order by nRpriority values*/\n\n// Function Definitions - in alphabetical order\nint finval (int nInput)\n{\nwhile(nInput &lt;= 0 || nInput &gt; 10)                               \n{\n    printf(\"please enter a number between 1 and 10 \\n\");\n    scanf(\"%d\", &amp;nInput);                                       \n} \nreturn nInput;                                                \n}\n\nint frand (int nInput)\n{   \nint nRand;\nnRand = (rand() % nInput)+1;                  /*set nRand == a random number \n                                               inbetween nInput and 1*/\nreturn nRand;                                 /*return the random number*/\n}\n\nvoid fsortasc(struct strProcess pArray[],int nInput)  \n{\nstruct strProcess temp;     /*temporary storage for elements being swapped*/\nint i, j;\n\nfor (i = 0; i &lt; nInput - 1; i++)                                 \n{\n    for (j = 0; j &lt; (nInput - 1-i); j++)\n    {\n        if (pArray[j].nPriority &gt; pArray[j + 1].nPriority)                      /*if the current element is greater than the next element*/\n        {\n            temp = pArray[j];                                                   \n            pArray[j] = pArray[j + 1];                                          \n            pArray[j + 1] = temp;                                               \n        }                                                                       \n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "concurrency", "compiler-construction", "lock-free"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1514986938, "post_id": 48078415, "comment_id": 83131007, "body": "@RudyVelthuis Without a prototype and calling convention, the compiler cannot use a call at all. The problem with opaque functions is the lack of knowledge about side effects."}, {"owner": {"reputation": 400, "user_id": 6821151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i7osM.png?s=128&g=1", "display_name": "Gamer.Godot", "link": "https://stackoverflow.com/users/6821151/gamer-godot"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1514989416, "post_id": 48078415, "comment_id": 83132336, "body": "Thank you.So how does the compiler treat opaque function calls?Can you give an example about this question?I cannot understand this question very well."}], "answers": [{"comments": [{"owner": {"reputation": 400, "user_id": 6821151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i7osM.png?s=128&g=1", "display_name": "Gamer.Godot", "link": "https://stackoverflow.com/users/6821151/gamer-godot"}, "edited": false, "score": 0, "creation_date": 1515030336, "post_id": 48081016, "comment_id": 83150068, "body": "Thank you. Your answer seems to match my requirement. I&#39;ll re-read the paper and re-think base on your answer. If I still have questions, I&#39;ll ask you again. Thanks again!"}], "tags": [], "owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "is_accepted": true, "score": 4, "last_activity_date": 1514995739, "creation_date": 1514995739, "answer_id": 48081016, "question_id": 48078415, "link": "https://stackoverflow.com/questions/48078415/what-does-an-opaque-function-call-mean-in-compiler-optimization/48081016#48081016", "title": "What does an opaque function call mean in compiler optimization?", "body": "<p>As you mention in the question, an opaque function call is a call to a function that the compiler has no prior information about. This implies that the compiler can make no assumptions about the side effects of this call except what is guaranteed by the language definition. For example, since the compiler has no other information it must assume that the function call can modify any global variable and must ensure that any local changes are stored before the call, it must also reload global variables used after the call. Further, the compiler can never skip making a call to this function even when calling it looks useless since there is no way for the compiler to know this for certain.</p>\n"}], "owner": {"reputation": 400, "user_id": 6821151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i7osM.png?s=128&g=1", "display_name": "Gamer.Godot", "link": "https://stackoverflow.com/users/6821151/gamer-godot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 2, "accepted_answer_id": 48081016, "answer_count": 1, "score": 0, "last_activity_date": 1514995739, "creation_date": 1514986183, "question_id": 48078415, "link": "https://stackoverflow.com/questions/48078415/what-does-an-opaque-function-call-mean-in-compiler-optimization", "title": "What does an opaque function call mean in compiler optimization?", "body": "<p>What does an opaque function call mean in the compiler optimization?I'v found it in <a href=\"https://stackoverflow.com/questions/26476139/why-do-global-variables-cause-trouble-for-compiler-optimizations-in-function-cal\">Why do global variables cause trouble for compiler optimizations in function calls?</a>, and 'opaque function call' really confuses me.\nIt seems that an opaque function call is the function call that the compiler has no information about it. But what does it mean?</p>\n"}, {"tags": ["c", "stack", "realloc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1514986068, "post_id": 48078325, "comment_id": 83130508, "body": "<code>d = u;</code> only changes the local value that was passed to <code>resize</code> which is then forgotten."}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 1, "creation_date": 1514986400, "post_id": 48078325, "comment_id": 83130694, "body": "A stack of what? This code is very unclear because of the meaningless identifiers. What the heck do <code>d</code>, <code>n</code>, <code>u</code>, <code>nmax</code> stand for? You&#39;ve also made things much more complicated (and hard to follow) than necessary; for example with all those explicit array index calculations. Why?"}, {"owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514988358, "post_id": 48078325, "comment_id": 83131767, "body": "@WeatherVane Thank you very much for your help! However, I am getting a &#39;normal&#39; behavior (at least, I see what I anticipate I should see) if I am not &quot;printf-ing&quot; before the push operations. Shouldn&#39;t I get a wrong result most of the time if your suggestion was what was going on?"}, {"owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "reply_to_user": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514988493, "post_id": 48078325, "comment_id": 83131835, "body": "@meaning-matters Thank you very much for your comment. A stack of nothing. It is an exercise I put myself. I changed all the d, n, u, nmax so they reflect somehow what I wanted them to be. I hope the code improved readability-wise. Anyway, I take the point you are making."}, {"owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1514988576, "post_id": 48078325, "comment_id": 83131879, "body": "@Jean-Fran&#231;oisFabre Thank you!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514990601, "post_id": 48078325, "comment_id": 83133049, "body": "@moijoune it is a classic sympton of undefined behaviour when adding or removing statements makes it &quot;seem to work&quot;. Undefined behaviour may or may not cause a crash. If it was certain then it would be defined!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "edited": false, "score": 0, "creation_date": 1514988936, "post_id": 48079011, "comment_id": 83132083, "body": "Thank you so much! Do you mean that I should also make int* push(...)?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "edited": false, "score": 1, "creation_date": 1514988992, "post_id": 48079011, "comment_id": 83132121, "body": "@moijoune yes, you are in essence wrapping <code>realloc</code>, so behave like <code>realloc</code>."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514989097, "post_id": 48079011, "comment_id": 83132186, "body": "I think that it&#39;s bad idea when a function fails to call <code>exit</code> right away. When a call fails it doesn&#39;t mean that the whole process should end. Just return an error value (<code>NULL</code> in this case) and let the user decide what to do."}, {"owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514989435, "post_id": 48079011, "comment_id": 83132347, "body": "@Pablo \u03a4\u0397\u0391\u039d\u039a YOU SO MUCH!!! Yes, this is what solved the problem. I still feel a little bemused that the printf in the middle was causing all of this but, perhaps, that was accidental. I am not sure why the array wasn&#39;t passed by reference which means more reading. Thank you so much again!"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "edited": false, "score": 0, "creation_date": 1514990285, "post_id": 48079011, "comment_id": 83132851, "body": "@moijoune it was causing trouble because it was accessing memory that was invalid at the time. In your implementation <code>realloc</code> might&#39;ve returned a different pointer, thus making the original one invalid. Accessing such an invalid pointer yields undefined behaviour, for example it could print some numbers but it also can crash. <b>Beacause</b> your implementation throw away the new pointer and you kept the old one, this undefined behaviour happened and in your case it lead into a crash with your first version and with garbage with the second version."}, {"owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514990858, "post_id": 48079011, "comment_id": 83133212, "body": "@Pablo Thank you very much. I suppose that this will escalate my situation much further :) but \u0399 honestly thought that I was passing the real myArray by reference. Thus, I was wrongly anticipating that the reallocation would affect the original array. But you are absolutely correct that I was getting garbage one way or another. Thank you!"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "edited": false, "score": 0, "creation_date": 1514993073, "post_id": 48079011, "comment_id": 83134613, "body": "@moijoune: <i>I am not sure why the array wasn&#39;t passed by reference which means more reading.</i> because in C there is not such thing as <i>pass by reference</i>, it&#39;s always by value. With pointers you simulate the <i>by reference</i>. Bah, I was writing an long answer and the thread has been closed, so I cannot post it anymore. It was a rather long answer. If you are interested in my answer: <a href=\"https://pastebin.com/t5tmX5U2\" rel=\"nofollow noreferrer\">pastebin.com/t5tmX5U2</a>"}, {"owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514993842, "post_id": 48079011, "comment_id": 83135081, "body": "@Pablo I so appreciate your help! You are wonderful and THANK YOU SO MUCH! I am now getting an idea of my profound misconceptions. I can&#39;t thank you enough!"}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": -1, "last_activity_date": 1514988448, "creation_date": 1514988448, "answer_id": 48079011, "question_id": 48078325, "link": "https://stackoverflow.com/questions/48078325/realloc-invalid-next-size-in-c/48079011#48079011", "title": "realloc(): invalid next size in C", "body": "<p><code>int *myArray</code> is locale to your function, the statement <code>myArray = u;</code> will only change the locale value, not the value of calling function.</p>\n\n<p>You must use double pointer or return the value.</p>\n\n<pre><code>int *resize(int *sizeOfArray, int *myArray){\n    *sizeOfArray *= 2;\n    int *u = realloc(myArray, *sizeOfArray * sizeof *myArray);\n    if (u == NULL) {\n        printf(\"Error!\\n\");\n        exit(1);\n    }\n    return u;\n}\n\nmyArray = resize(sizeOfArray, myArray);\n</code></pre>\n\n<p>Of course, you must change for this behavior in your <code>push()</code> too.</p>\n"}], "owner": {"reputation": 21, "user_id": 3543877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4vzqI.jpg?s=128&g=1", "display_name": "moijoune", "link": "https://stackoverflow.com/users/3543877/moijoune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "closed_date": 1514990343, "accepted_answer_id": 48079011, "answer_count": 1, "score": -4, "last_activity_date": 1514988448, "creation_date": 1514985849, "last_edit_date": 1514988015, "question_id": 48078325, "link": "https://stackoverflow.com/questions/48078325/realloc-invalid-next-size-in-c", "closed_reason": "Duplicate", "title": "realloc(): invalid next size in C", "body": "<p>Happy New Year!</p>\n\n<p>I have been struggling to find what causes the error I will explain below for some time now and I would be so very grateful for any help. I have the following code which, in principle, should implement a stack:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid resize(int *nmax, int *d){\n    int i, *u;\n    *nmax *= 2;\n    u = (int *)realloc(d,sizeof(int)*(*nmax));\n    if(u == NULL){\n        printf(\"Error!\\n\");\n        exit(1);\n    }\n    d = u;\n}\n\nvoid push(int *n, int *d, int *nmax){\n    int u = *n , i;\n    if(u == *nmax) {\n        resize(nmax, d);\n    }\n    *(d + u) = u;\n    u++;\n    *n = u;\n}\n\nvoid pop(int *n){\n    int u = *n;\n    *n = u - 1;\n}\n\nint main(){\n    int *d, n = 0, i, nmax = 5;\n    d = (int *)malloc(sizeof(int)*nmax);\n    *(d+(n))= n;\n    n++;\n    *(d+(n)) = n;\n    n++;\n    *(d+(n)) = n;\n    n++;\n    //for(i = 0;i &lt; n;i++)\n        //printf(\"%d\\n\",*(d+i));\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    push(&amp;n,d, &amp;nmax);\n    //pop(&amp;n);\n    //pop(&amp;n);\n    //pop(&amp;n);\n    for(i = 0;i&lt;n;i++)\n        printf(\"%d\\n\",*(d+i));\n\n    return 0;\n}\n</code></pre>\n\n<p>It seems to behave normally until I un-comment the printf statement before the stack of push operations. The error I get is:</p>\n\n<pre><code>0\n1\n2\n*** Error in `./a.out': realloc(): invalid next size: 0x0000000000f08010 ***\n</code></pre>\n\n<p>I am not sure I have explained it ok and if I didn't please let me know of any additional details I could add so as to make it more clear. </p>\n\n<p>Thank you very much for your help!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>With the hope that the code has now become a little more readable, this is what I have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid resize(int *sizeOfArray, int *myArray){\n    int i, *u;\n    *sizeOfArray *= 2;\n    u = (int *)realloc(myArray,sizeof(int)*(*sizeOfArray));\n    if(u == NULL){\n        printf(\"Error!\\n\");\n        exit(1);\n    }\n    myArray = u;\n}\n\nvoid push(int *pos, int *myArray, int *sizeOfArray){\n    int i;\n    if(*pos == *sizeOfArray) {\n        resize(sizeOfArray, myArray);\n    }\n    *(myArray + (*pos)) = *pos;\n    (*pos)++;\n}\n\nvoid pop(int *pos){\n    (*pos)--;\n}\n\nint main(){\n    int *myArray, pos = 0, i, sizeOfArray = 5;\n    myArray = (int *)malloc(sizeof(int)*sizeOfArray);\n    *(myArray + pos)= pos;\n    pos++;\n    *(myArray + pos) = pos;\n    pos++;\n    *(myArray + pos) = pos;\n    pos++;\n    //for(i = 0;i &lt; pos;i++)\n        //printf(\"%d\\n\",*(myArray+i));\n    push(&amp;pos, myArray, &amp;sizeOfArray);\n    push(&amp;pos, myArray, &amp;sizeOfArray);\n    push(&amp;pos, myArray, &amp;sizeOfArray);\n    push(&amp;pos, myArray, &amp;sizeOfArray);\n    //pop(&amp;pos);\n    //pop(&amp;pos);\n    //pop(&amp;pos);\n    for(i = 0;i&lt;pos;i++)\n        printf(\"** %d\\n\",*(myArray+i));\n\n    return 0;\n}\n</code></pre>\n\n<p>Now, the error has changed - which, perhaps, is an indication that there is something wrong with the approach - and it reads:</p>\n\n<p>I should get:</p>\n\n<pre><code>** 0\n** 1\n** 2\n** 3\n** 4\n** 5\n** 6\n</code></pre>\n\n<p>Instead, I get:</p>\n\n<pre><code>** 0\n** 0\n** 2\n** 3\n** 4\n** 5\n** 6\n</code></pre>\n\n<p>Why? I only get this when I un-comment the printf in the middle. </p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["c", "makefile", "posix"], "answers": [{"tags": [], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": true, "score": 2, "last_activity_date": 1514988510, "creation_date": 1514988510, "answer_id": 48079025, "question_id": 48078283, "link": "https://stackoverflow.com/questions/48078283/are-escaped-newlines-part-of-posix-make/48079025#48079025", "title": "Are escaped newlines part of POSIX make?", "body": "<p>The POSIX standard says this about escaped newlines (this is in the actual standard text not in the informative sections or rational):</p>\n\n<blockquote>\n  <p>When an escaped &lt;<em>newline</em>> (one preceded by a &lt;<em>backslash</em>>) is found\n  anywhere in the makefile except in a command line, an include line, or\n  a line immediately preceding an include line, it shall be replaced,\n  along with any leading white space on the following line, with a\n  single &lt;<em>space</em>>. When an escaped &lt;<em>newline</em>> is found in a command line\n  in a makefile, the command line shall contain the &lt;<em>backslash</em>>, the\n  &lt;<em>newline</em>>, and the next line, except that the first character of the\n  next line shall not be included if it is a &lt;<em>tab</em>>. When an escaped\n  &lt;<em>newline</em>> is found in an include line or in a line immediately\n  preceding an include line, the behavior is unspecified.</p>\n</blockquote>\n\n<p>That is the POSIX mandated behavior you an rely on with respect to escaped newlines.</p>\n"}], "owner": {"reputation": 692, "user_id": 8590292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/27c446b7440b709c72ed36ed2307c427?s=128&d=identicon&r=PG&f=1", "display_name": "MarkWeston", "link": "https://stackoverflow.com/users/8590292/markweston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48079025, "answer_count": 1, "score": 2, "last_activity_date": 1514988695, "creation_date": 1514985741, "question_id": 48078283, "link": "https://stackoverflow.com/questions/48078283/are-escaped-newlines-part-of-posix-make", "title": "Are escaped newlines part of POSIX make?", "body": "<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/007904975/utilities/make.html\" rel=\"nofollow noreferrer\">POSIX make</a> standard page has this to say about escaped newlines (emphasis mine):</p>\n\n<blockquote>\n  <p>The treatment of escaped s throughout the makefile is <strong>historical practice</strong>. For example, the inference rule:</p>\n\n<pre><code>.c.o\\\n:\n</code></pre>\n  \n  <p>works, and the macro:</p>\n\n<pre><code>f=  bar baz\\\n   biz\na:\n   echo ==$f==\n</code></pre>\n  \n  <p>echoes <code>\"==bar baz biz==\"</code>.</p>\n</blockquote>\n\n<p>What does \"historical practice\" mean?</p>\n\n<p>Can I use escaped newlines in a strictly conforming POSIX makefile or not?</p>\n"}, {"tags": ["c", "pointers", "malloc", "memory-address"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1514985496, "post_id": 48078188, "comment_id": 83130176, "body": "That&#39;s not a <a href=\"http://stackoverflow.com/help/mcve\"><b><i>Minimal</i></b>, Complete, and Verifiable Example</a>. Therefore <a href=\"http://idownvotedbecau.se/toomuchcode/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/toomuchcode</a>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1514985522, "post_id": 48078188, "comment_id": 83130189, "body": "Too much code, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, chances are that you can&#39;t write one because your code suffers a lot from repetition which is perhaps the real cause of the problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1514985597, "post_id": 48078188, "comment_id": 83130234, "body": "Besides that, have you tried looking at line 590 of your code? What happens <i>around</i> there? And if you don&#39;t know where to start debugging, then just start at the beginning. It might be tedious but it&#39;s a part of working as a programmer."}, {"owner": {"reputation": 241, "user_id": 5252013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Stuc9.png?s=128&g=1", "display_name": "Riddle00", "link": "https://stackoverflow.com/users/5252013/riddle00"}, "edited": false, "score": 0, "creation_date": 1514986020, "post_id": 48078188, "comment_id": 83130481, "body": "Thanks, duly noted. I will try to reframe (MCVE) my question next time."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 5252013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Stuc9.png?s=128&g=1", "display_name": "Riddle00", "link": "https://stackoverflow.com/users/5252013/riddle00"}, "edited": false, "score": 0, "creation_date": 1514989326, "post_id": 48078865, "comment_id": 83132285, "body": "Thank you for taking the time to look through the code and answer. Those mistakes (kinda silly, actually) were exactly the reason! D\u0117kui! :)"}], "tags": [], "owner": {"reputation": 1329, "user_id": 1280414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab3fd0499936f30bceb77e053520dd6?s=128&d=identicon&r=PG", "display_name": "Sergej Christoforov", "link": "https://stackoverflow.com/users/1280414/sergej-christoforov"}, "is_accepted": true, "score": 1, "last_activity_date": 1514987886, "creation_date": 1514987886, "answer_id": 48078865, "question_id": 48078188, "link": "https://stackoverflow.com/questions/48078188/is-not-stackd-mallocd-or-recently-freed-when-the-amount-of-operations-get/48078865#48078865", "title": "Is not stack&#39;d, malloc&#39;d or (recently) free&#39;d, when the amount of operations gets large", "body": "<ol>\n<li><p>The size of <code>Algorithm.iterations</code> is <code>MAX_ITER</code> which is 100. And then you access <code>Algorithm.iterations</code> elements up to 1000th. This is undefined behavior.</p></li>\n<li><p><code>Algorithm** target = malloc(18 * sizeof(Algorithm));</code> is wrong for sure. The type of <code>target</code> should be <code>Algorithm *</code>.</p></li>\n</ol>\n"}], "owner": {"reputation": 241, "user_id": 5252013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Stuc9.png?s=128&g=1", "display_name": "Riddle00", "link": "https://stackoverflow.com/users/5252013/riddle00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 48078865, "answer_count": 1, "score": -3, "last_activity_date": 1601067364, "creation_date": 1514985447, "last_edit_date": 1601067364, "question_id": 48078188, "link": "https://stackoverflow.com/questions/48078188/is-not-stackd-mallocd-or-recently-freed-when-the-amount-of-operations-get", "title": "Is not stack&#39;d, malloc&#39;d or (recently) free&#39;d, when the amount of operations gets large", "body": "<p>This is my code (sorry, it's long, but there is a lot of repeating code).</p>\n<p>{Description}\nSorting algortihm testing program using pseudo randomly\ngenerated number array. User can specify array length,\nits min and max elements, the least number of repeating\nvalues. User can also choose how many arrays to be tested.</p>\n<pre><code>     1  /*=============================================================================\n     2   |\n     3   |  Assignment:  Program 12\n     4   |\n     8   |        Class:  Programming Basics\n     9   |         Date:  December 13th, 2017\n    10   |\n    11   |     Language:  GNU C (using gcc on Lenovo Y50-70, OS: Arch Linux x86_64)\n    12   |     Version:   0.0\n    13   |   To Compile:  gcc -Wall -g -std=c11 pratybos12.c -o pratybos12\n    14   |\n    15   +-----------------------------------------------------------------------------\n    16   |\n    17   |  Description:  Sorting algortihm testing program using pseudo randomly \n    18   |                generated number array. User can specify array length, \n    19   |                its min and max elements, the least number of repeating \n    20   |                values. User can also choose how many arrays to be tested.\n    21   |\n    22   |      Input:    Command line input by user\n    23   |\n    24   |      Output:   Prompt messages, validation errors and final results\n    25   |                are displayed one per line to the standard output.\n    26   |                The output is each algorithm's each iteration, with\n    27   |                comparison and assignment counts, and also processor\n    28   |                clock times and average completion time, in seconds.\n    29   |                Finally, the average data of each algorithm is presented.\n    30   |                At the end, the algorithms are sorted from best to worst\n    31   |                by their average time.\n    32   |\n    33   | Version\n    34   | updates:     Currently this is the intial version\n    35   |\n    36   +===========================================================================*/\n    37  \n    38  #include &lt;stdio.h&gt;\n    39  #include &lt;stdlib.h&gt;\n    40  #include &lt;time.h&gt;\n    41  \n    42  #include &quot;dbg.h&quot;\n    43  \n    44  #include &quot;helpers.h&quot;\n    45  #include &quot;test_algorithm.h&quot;\n    46  \n    47  #include &quot;bubble_sort_a.h&quot;\n    48  #include &quot;bubble_sort_b.h&quot;\n    49  #include &quot;bubble_sort_c.h&quot;\n    50  #include &quot;bubble_sort_d.h&quot;\n    51  #include &quot;bubble_sort_e.h&quot;\n    52  #include &quot;bubble_sort_e_and_f.h&quot;\n    53  #include &quot;bubble_sort_f.h&quot;\n    54  #include &quot;bubble_sort_b_and_c.h&quot;\n    55  #include &quot;bubble_sort_b_and_e.h&quot;\n    56  #include &quot;bubble_sort_b_and_f.h&quot;\n    57  #include &quot;bubble_sort_c_and_e.h&quot;\n    58  #include &quot;bubble_sort_c_and_f.h&quot;\n    59  #include &quot;bubble_sort_b_and_e_and_f.h&quot;\n    60  #include &quot;bubble_sort_b_and_c_and_e_and_f.h&quot;\n    61  #include &quot;insertion_sort.h&quot;\n    62  #include &quot;quicksort_pivot_first.h&quot;\n    63  #include &quot;selection_sort.h&quot;\n    64  #include &quot;top_down_merge_sort.h&quot;\n    65  \n    66  #define MAX_ITER 100\n    67  #define MAX_ALGO 100\n    68  \n    69  \n    70  typedef struct {\n    71      char* pointerName;\n    72      int pointerMemory;\n    73  } PointerStats;\n    74  \n    75  typedef struct {\n    76      PointerStats* memJournal;\n    77      int JournalPointerCount;\n    78      int memUsed;\n    79      int memUsedByJournal;\n    80  } MemoryStats;\n    81  \n    82  \n    83  typedef struct {\n    84      int no;\n    85      int is_sorted;\n    86      int comp_count;\n    87      int assign_count;\n    88      double clocks_total;\n    89      double time_spent;\n    90  } Iteration;\n    91  \n    92  typedef struct {\n    93      char* type;\n    94      char* complexity;\n    95      int iter_count;\n    96      int rank;\n    97      int avg_comp;\n    98      int avg_assign;\n    99      double avg_clocks;\n   100      double avg_time;\n   101      Iteration* iterations[MAX_ITER];\n   102  } Algorithm;\n   103  \n   104  typedef struct {\n   105      char* date;\n   106      char* arch;\n   107      char* compiler;\n   108      Algorithm* algorithms[MAX_ALGO];\n   109  } Results;\n   110  \n   111  // a typedef creates a fake type, in this\n   112  // case for a sort function pointer\n   113  typedef int* (*sort_pointer)(int* target, int size);\n   114  \n   115  // function pointer to a quicksort function\n   116  typedef int* (*quicksort_pointer)(int* target, int first, int last);\n   117  \n   118  // function pointer to a mergesort function\n   119  typedef void (*mergesort_pointer)(int* target, int* working_array, int size);\n   120  \n   121  \n   122  void filldata(int* data, int size, int min, int max, int repeat);\n   123  void test_sort( int* data, int size, sort_pointer func, Algorithm* Algo, int no);\n   124  void test_quicksort( int* data, int size, quicksort_pointer func, Algorithm* Algo, int no);\n   125  void test_mergesort( int* data, int size, mergesort_pointer func, Algorithm* Algo, int no);\n   126  void print_algo(Algorithm* Algo);\n   127  void calculate_average(Algorithm* Algo);\n   128  Algorithm** rank_algorithms(Algorithm** target, int first, int last);\n   129  \n   130  MemoryStats memoryStats;\n   131  \n   132  int array_count;\n   133  \n   134  int main(int argc, char* argv[])\n   135  {\n   136      srand(time(NULL));\n   137  \n   138      Results* Res = malloc(sizeof(Results));\n   139  \n   140      Res-&gt;date = &quot;2017-12-16&quot;;\n   141      Res-&gt;arch = &quot;Arch Linux x86_64&quot;;\n   142      Res-&gt;compiler = &quot;gcc&quot;;\n   143  \n   144      // creating algorithm structures\n   145      Algorithm* Algo1 = malloc(sizeof(Algorithm));\n   146      Algo1-&gt;type = &quot;bubble_sort_a&quot;;\n   147      Algo1-&gt;complexity = &quot;O (n^2)&quot;;\n   148  \n   149      Algorithm* Algo2 = malloc(sizeof(Algorithm));\n   150      Algo2-&gt;type = &quot;bubble_sort_b&quot;;\n   151      Algo2-&gt;complexity = &quot;O (n^2)&quot;;\n   152  \n   153      Algorithm* Algo3 = malloc(sizeof(Algorithm));\n   154      Algo3-&gt;type = &quot;bubble_sort_c&quot;;\n   155      Algo3-&gt;complexity = &quot;O (n^2)&quot;;\n   156  \n   157      Algorithm* Algo4 = malloc(sizeof(Algorithm));\n   158      Algo4-&gt;type = &quot;bubble_sort_d&quot;;\n   159      Algo4-&gt;complexity = &quot;O (n^2)&quot;;\n   160  \n   161      Algorithm* Algo5 = malloc(sizeof(Algorithm));\n   162      Algo5-&gt;type = &quot;bubble_sort_e&quot;;\n   163      Algo5-&gt;complexity = &quot;O (n^2)&quot;;\n   164  \n   165      Algorithm* Algo6 = malloc(sizeof(Algorithm));\n   166      Algo6-&gt;type = &quot;bubble_sort_f&quot;;\n   167      Algo6-&gt;complexity = &quot;O (n^2)&quot;;\n   168  \n   169      Algorithm* Algo7 = malloc(sizeof(Algorithm));\n   170      Algo7-&gt;type = &quot;bubble_sort_b_and_c&quot;;\n   171      Algo7-&gt;complexity = &quot;O (n^2)&quot;;\n   172  \n   173      Algorithm* Algo8 = malloc(sizeof(Algorithm));\n   174      Algo8-&gt;type = &quot;bubble_sort_b_and_e&quot;;\n   175      Algo8-&gt;complexity = &quot;O (n^2)&quot;;\n   176  \n   177      Algorithm* Algo9 = malloc(sizeof(Algorithm));\n   178      Algo9-&gt;type = &quot;bubble_sort_b_and_f&quot;;\n   179      Algo9-&gt;complexity = &quot;O (n^2)&quot;;\n   180  \n   181      Algorithm* Algo10 = malloc(sizeof(Algorithm));\n   182      Algo10-&gt;type = &quot;bubble_sort_c_and_e&quot;;\n   183      Algo10-&gt;complexity = &quot;O (n^2)&quot;;\n   184  \n   185      Algorithm* Algo11 = malloc(sizeof(Algorithm));\n   186      Algo11-&gt;type = &quot;bubble_sort_c_and_f&quot;;\n   187      Algo11-&gt;complexity = &quot;O (n^2)&quot;;\n   188  \n   189      Algorithm* Algo12 = malloc(sizeof(Algorithm));\n   190      Algo12-&gt;type = &quot;bubble_sort_e_and_f&quot;;\n   191      Algo12-&gt;complexity = &quot;O (n^2)&quot;;\n   192  \n   193      Algorithm* Algo13 = malloc(sizeof(Algorithm));\n   194      Algo13-&gt;type = &quot;bubble_sort_b_and_e_and_f&quot;;\n   195      Algo13-&gt;complexity = &quot;O (n^2)&quot;;\n   196  \n   197      Algorithm* Algo14 = malloc(sizeof(Algorithm));\n   198      Algo14-&gt;type = &quot;bubble_sort_b_and_c_and_e_and_f&quot;;\n   199      Algo14-&gt;complexity = &quot;O (n^2)&quot;;\n   200  \n   201      Algorithm* Algo15 = malloc(sizeof(Algorithm));\n   202      Algo15-&gt;type = &quot;quicksort&quot;;\n   203      Algo15-&gt;complexity = &quot;O (n logn n)&quot;;\n   204  \n   205      Algorithm* Algo16 = malloc(sizeof(Algorithm));\n   206      Algo16-&gt;type = &quot;insertion_sort&quot;;\n   207      Algo16-&gt;complexity = &quot;O (2n)&quot;;\n   208  \n   209      Algorithm* Algo17 = malloc(sizeof(Algorithm));\n   210      Algo17-&gt;type = &quot;selection_sort&quot;;\n   211      Algo17-&gt;complexity = &quot;O (2n)&quot;;\n   212  \n   213      Algorithm* Algo18 = malloc(sizeof(Algorithm));\n   214      Algo18-&gt;type = &quot;top down merge sort&quot;;\n   215      Algo18-&gt;complexity = &quot;O (n log n)&quot;;\n   216  \n   217      Res-&gt;algorithms[0] = Algo1;\n   218      Res-&gt;algorithms[1] = Algo2;\n   219      Res-&gt;algorithms[2] = Algo3;\n   220      Res-&gt;algorithms[3] = Algo4;\n   221      Res-&gt;algorithms[4] = Algo5;\n   222      Res-&gt;algorithms[5] = Algo6;\n   223      Res-&gt;algorithms[6] = Algo7;\n   224      Res-&gt;algorithms[7] = Algo8;\n   225      Res-&gt;algorithms[8] = Algo9;\n   226      Res-&gt;algorithms[9] = Algo10;\n   227      Res-&gt;algorithms[10] = Algo11;\n   228      Res-&gt;algorithms[11] = Algo12;\n   229      Res-&gt;algorithms[12] = Algo13;\n   230      Res-&gt;algorithms[13] = Algo14;\n   231      Res-&gt;algorithms[14] = Algo15;\n   232      Res-&gt;algorithms[15] = Algo16;\n   233      Res-&gt;algorithms[16] = Algo17;\n   234      Res-&gt;algorithms[17] = Algo18;\n   235  \n   236      memoryStats.memJournal = malloc(10 * sizeof(int));\n   237  \n   238      memoryStats.memUsedByJournal = 10;\n   239  \n   240      memoryStats.JournalPointerCount = 0;\n   241  \n   242      printf(&quot;Mem used total: %d\\n&quot;, memoryStats.memUsed);\n   243  \n   244      int size;\n   245      int min;\n   246      int max;\n   247      int repeat;\n   248  \n   249      array_count = get_pos_num(&quot;How many arrays would you like to test? &gt; &quot;, 0);\n   250      size = get_pos_num(&quot;What is the size of each array? &gt; &quot;, 0);\n   251      min = get_pos_num(&quot;What is the minimum number in each array? &gt; &quot;, 0);\n   252      max = get_pos_num(&quot;What is the maximum number in each array? &gt; &quot;, 0);\n   253  \n   254      while (1) {\n   255          printf(&quot;How many repeating values there will be AT LEAST? &gt; &quot;);\n   256          if (scanf(&quot;%d&quot;, &amp;repeat) == 1 &amp;&amp; repeat &gt;= 0\n   257              &amp;&amp; repeat &lt;= (max - min + 1) &amp;&amp; getchar() == '\\n') {\n   258              break;\n   259          } else {\n   260              while (getchar() != '\\n')\n   261                  ;\n   262              printf(&quot;Please enter a positive integer or zero, which is not &quot;\n   263                     &quot;greater than the &quot;\n   264                     &quot;size of the array\\n&quot;);\n   265          }\n   266      }\n   267  \n   268      for (int i = 0; i &lt; array_count; i++) {\n   269          int* data = malloc(size * sizeof(int));\n   270  \n   271          filldata(data, size, min, max, repeat);\n   272          if (data == NULL)\n   273              die(&quot;Atminties problema&quot;);\n   274  \n   275          printf(&quot;i: %d&quot;, i);\n   276          print_array(data, size, &quot;Your generated numbers:&quot;);\n   277          //---------------------------USING FUNCTION POINTERS-----------------//\n   278  \n   279          test_sort(data, size, &amp;bubble_sort_a, Algo1, i + 1);\n   280          test_sort(data, size, &amp;bubble_sort_b, Algo2, i + 1);\n   281          test_sort(data, size, &amp;bubble_sort_c, Algo3, i + 1);\n   282          test_sort(data, size, &amp;bubble_sort_d, Algo4, i + 1);\n   283          test_sort(data, size, &amp;bubble_sort_e, Algo5, i + 1);\n   284          test_sort(data, size, &amp;bubble_sort_f, Algo6, i + 1);\n   285          test_sort(data, size, &amp;bubble_sort_b_and_c, Algo7, i + 1);\n   286          test_sort(data, size, &amp;bubble_sort_b_and_e, Algo8, i + 1);\n   287          test_sort(data, size, &amp;bubble_sort_b_and_f, Algo9, i + 1);\n   288          test_sort(data, size, &amp;bubble_sort_c_and_e, Algo10, i + 1);\n   289          test_sort(data, size, &amp;bubble_sort_c_and_f, Algo11, i + 1);\n   290          test_sort(data, size, &amp;bubble_sort_e_and_f, Algo12, i + 1);\n   291          test_sort(data, size, &amp;bubble_sort_b_and_e_and_f, Algo13, i + 1);\n   292          test_sort(data, size, &amp;bubble_sort_b_and_c_and_e_and_f, Algo14, i + 1);\n   293  \n   294          test_sort(data, size, &amp;bubble_sort_c_and_f, Algo15, i + 1);\n   295          test_sort(data, size, &amp;bubble_sort_e_and_f, Algo16, i + 1);\n   296          test_sort(data, size, &amp;bubble_sort_b_and_e_and_f, Algo17, i + 1);\n   297          test_sort(data, size, &amp;bubble_sort_b_and_c_and_e_and_f, Algo18, i + 1);\n   298  \n   299  \n   300          free(data);\n   301      }\n   302  \n   303      calculate_average(Algo1);\n   304      calculate_average(Algo2);\n   305      calculate_average(Algo3);\n   306      calculate_average(Algo4);\n   307      calculate_average(Algo5);\n   308      calculate_average(Algo6);\n   309      calculate_average(Algo7);\n   310      calculate_average(Algo8);\n   311      calculate_average(Algo9);\n   312      calculate_average(Algo10);\n   313      calculate_average(Algo11);\n   314      calculate_average(Algo12);\n   315      calculate_average(Algo13);\n   316      calculate_average(Algo14);\n   317      calculate_average(Algo15);\n   318      calculate_average(Algo16);\n   319      calculate_average(Algo17);\n   320      calculate_average(Algo18);\n   321  \n   322  \n   323      for (int i = 0; i &lt; 18; i++) {\n   324          print_algo(Res-&gt;algorithms[i]);\n   325      }\n   326  \n   327  \n   328      Algorithm** target = malloc(18 * sizeof(Algorithm));\n   329  \n   330      target[0] = Algo1;\n   331      target[1] = Algo2;\n   332      target[2] = Algo3;\n   333      target[3] = Algo4;\n   334      target[4] = Algo5;\n   335      target[5] = Algo6;\n   336      target[6] = Algo7;\n   337      target[7] = Algo8;\n   338      target[8] = Algo9;\n   339      target[9] = Algo10;\n   340      target[10] = Algo11;\n   341      target[11] = Algo12;\n   342      target[12] = Algo13;\n   343      target[13] = Algo14;\n   344      target[14] = Algo15;\n   345      target[15] = Algo16;\n   346      target[16] = Algo17;\n   347      target[17] = Algo18;\n   348  \n   349      target = rank_algorithms(target, 0, 17);\n   350  \n   351      printf(&quot;Fastest algorithms (ranking):\\n&quot;);\n   352      printf(&quot;=============================\\n&quot;);\n   353  \n   354      for (int i = 0; i &lt; 18; i++) {\n   355          printf(&quot;%d. &quot;, i + 1);\n   356          printf(&quot;%s\\n&quot;, target[i]-&gt;type);\n   357          printf(&quot;Average time: %f\\n&quot;, target[i]-&gt;avg_time);\n   358          printf(&quot;---------------------------------\\n&quot;);\n   359      }\n   360  \n   361      printf(&quot;================================\\n&quot;);\n   362      printf(&quot;Date: %s\\n&quot;, Res-&gt;date);\n   363      printf(&quot;Architecture: %s\\n&quot;, Res-&gt;arch);\n   364      printf(&quot;Compiler: %s\\n&quot;, Res-&gt;compiler);\n   365      printf(&quot;================================\\n&quot;);\n   366  \n   367      printf(&quot;Mem used total: %d\\n&quot;, memoryStats.memUsed);\n   368  \n   369  \n   370      free(Res);\n   371  \n   372  \n   373      for (int i = 0; i &lt; array_count; i++) {\n   374          free(Algo1-&gt;iterations[i]);\n   375      }\n   376      free(Algo1);\n   377  \n   378      for (int i = 0; i &lt; array_count; i++) {\n   379          free(Algo2-&gt;iterations[i]);\n   380      }\n   381      free(Algo2);\n   382  \n   383      for (int i = 0; i &lt; array_count; i++) {\n   384          free(Algo3-&gt;iterations[i]);\n   385      }\n   386      free(Algo3);\n   387  \n   388      for (int i = 0; i &lt; array_count; i++) {\n   389          free(Algo4-&gt;iterations[i]);\n   390      }\n   391      free(Algo4);\n   392  \n   393      for (int i = 0; i &lt; array_count; i++) {\n   394          free(Algo5-&gt;iterations[i]);\n   395      }\n   396      free(Algo5);\n   397  \n   398      for (int i = 0; i &lt; array_count; i++) {\n   399          free(Algo6-&gt;iterations[i]);\n   400      }\n   401      free(Algo6);\n   402  \n   403      for (int i = 0; i &lt; array_count; i++) {\n   404          free(Algo7-&gt;iterations[i]);\n   405      }\n   406      free(Algo7);\n   407  \n   408      for (int i = 0; i &lt; array_count; i++) {\n   409          free(Algo8-&gt;iterations[i]);\n   410      }\n   411      free(Algo8);\n   412  \n   413      for (int i = 0; i &lt; array_count; i++) {\n   414          free(Algo9-&gt;iterations[i]);\n   415      }\n   416      free(Algo9);\n   417  \n   418      for (int i = 0; i &lt; array_count; i++) {\n   419          free(Algo10-&gt;iterations[i]);\n   420      }\n   421      free(Algo10);\n   422  \n   423      for (int i = 0; i &lt; array_count; i++) {\n   424          free(Algo11-&gt;iterations[i]);\n   425      }\n   426      free(Algo11);\n   427      \n   428      for (int i = 0; i &lt; array_count; i++) {\n   429          free(Algo12-&gt;iterations[i]);\n   430      }\n   431      free(Algo12);\n   432  \n   433      for (int i = 0; i &lt; array_count; i++) {\n   434          free(Algo13-&gt;iterations[i]);\n   435      }\n   436      free(Algo13);\n   437      \n   438      for (int i = 0; i &lt; array_count; i++) {\n   439          free(Algo14-&gt;iterations[i]);\n   440      }\n   441      free(Algo14);\n   442  \n   443      for (int i = 0; i &lt; array_count; i++) {\n   444          free(Algo15-&gt;iterations[i]);\n   445      }\n   446      free(Algo15);\n   447      \n   448      for (int i = 0; i &lt; array_count; i++) {\n   449          free(Algo16-&gt;iterations[i]);\n   450      }\n   451      free(Algo16);\n   452  \n   453      for (int i = 0; i &lt; array_count; i++) {\n   454          free(Algo17-&gt;iterations[i]);\n   455      }\n   456      free(Algo17);\n   457  \n   458      for (int i = 0; i &lt; array_count; i++) {\n   459          free(Algo18-&gt;iterations[i]);\n   460      }\n   461      free(Algo18);\n   462  \n   463      free(target);\n   464      free(memoryStats.memJournal);\n   465  }\n   466  \n   467  \n   468  void filldata(int* data, int size, int min, int max, int repeat)\n   469  {\n   470      int i;\n   471  \n   472      for (i = 0; i &lt; size; i++) {\n   473          data[i] = min + rand() % (max - min + 1);\n   474      }\n   475  \n   476      if (repeat &gt; 1) {\n   477          int repeat_value = min + rand() % (max - min + 1);\n   478  \n   479          int indexes[repeat];\n   480  \n   481          int x;\n   482  \n   483          // Non-duplicate number generation\n   484  \n   485          i = 0;\n   486          while (i &lt; repeat) {\n   487              int index = rand() % size;\n   488  \n   489              for (x = 0; x &lt; i; x++) {\n   490                  if (indexes[x] == index) {\n   491                      break;\n   492                  }\n   493              }\n   494              if (x == i) {\n   495                  indexes[i++] = index;\n   496              }\n   497          }\n   498  \n   499          for (i = 0; i &lt; repeat; i++) {\n   500              data[indexes[i]] = repeat_value;\n   501          }\n   502      }\n   503  }\n   504  \n   505  \n   506  void test_sort(int* data, int size, sort_pointer func, Algorithm* Algo, int no)\n   507  {\n   508  \n   509      count_ncomp = 0;\n   510      count_assign = 0;\n   511  \n   512      begin = clock();\n   513  \n   514      int* target = NULL;\n   515      target = malloc(size * sizeof(int));\n   516      if (!target)\n   517          die(&quot;Memory error.&quot;);\n   518  \n   519      memcpy(target, data, size * sizeof(int));\n   520  \n   521      Iteration* Iter = malloc(sizeof(Iteration));\n   522      if (Iter == NULL) {\n   523          exit(1);\n   524      }\n   525      Iter-&gt;no = no;\n   526  \n   527      if (is_sorted(func(target, size), size)) {\n   528          end = clock();\n   529          clocks = (double)(end - begin);\n   530          time_spent = clocks / CLOCKS_PER_SEC;\n   531  \n   532          Iter-&gt;is_sorted = 1;\n   533          Iter-&gt;comp_count = count_ncomp;\n   534          Iter-&gt;assign_count = count_assign;\n   535          Iter-&gt;clocks_total = clocks;\n   536          Iter-&gt;time_spent = time_spent;\n   537      } else {\n   538          Iter-&gt;is_sorted = 0;\n   539          \n   540      };\n   541  \n   542      Algo-&gt;iterations[no - 1] = Iter;\n   543  \n   544      if (target == NULL) {\n   545          debug(&quot;Target is NULL&quot;);\n   546      }\n   547  \n   548      free(target);\n   549  }\n   550  \n   551  \n   552  void print_algo(Algorithm* Algo)\n   553  {\n   554  \n   555      printf(&quot;Algorithm type: %s\\n&quot;, Algo-&gt;type);\n   556      printf(&quot;Time complexity: %s\\n&quot;, Algo-&gt;complexity);\n   557      printf(&quot;----------------------------------\\n&quot;);\n   558      for (int i = 0; i &lt; array_count; i++) {\n   559          if (!Algo-&gt;iterations[i]-&gt;is_sorted) {\n   560              printf(&quot;Not sorted&quot;);\n   561          } else {\n   562              printf(&quot;no: %d\\n&quot;, Algo-&gt;iterations[i]-&gt;no);\n   563              printf(&quot;is_sorted: True\\n&quot;);\n   564              printf(&quot;comp_count: %d\\n&quot;, Algo-&gt;iterations[i]-&gt;comp_count);\n   565              printf(&quot;assign count: %d\\n&quot;, Algo-&gt;iterations[i]-&gt;assign_count);\n   566              printf(&quot;clocks total: %f\\n&quot;, Algo-&gt;iterations[i]-&gt;clocks_total);\n   567              printf(&quot;time spent: %f\\n&quot;, Algo-&gt;iterations[i]-&gt;time_spent);\n   568          }\n   569          printf(&quot;----------------------------------\\n&quot;);\n   570      }\n   571      printf(&quot;Iteration count: %d\\n&quot;, Algo-&gt;iter_count);\n   572      printf(&quot;Average compare count: %d\\n&quot;, Algo-&gt;avg_comp);\n   573      printf(&quot;Average assign count: %d\\n&quot;, Algo-&gt;avg_assign);\n   574      printf(&quot;Average clocks: %f\\n&quot;, Algo-&gt;avg_clocks);\n   575      printf(&quot;Average time spent: %f\\n&quot;, Algo-&gt;avg_time);\n   576  \n   577      printf(&quot;===================================\\n&quot;);\n   578  }\n   579  \n   580  void calculate_average(Algorithm* Algo)\n   581  {\n   582      int sum_comp = 0;\n   583      int sum_assign = 0;\n   584      double sum_clocks = 0;\n   585      double sum_time = 0;\n   586      int sorted_count = array_count;\n   587  \n   588      for (int i = 0; i &lt; array_count; i++) {\n   589  \n   590          debug(&quot;is sorted %d&quot;, Algo-&gt;iterations[i]-&gt;is_sorted);\n   591          debug(&quot;Array count: %d&quot;, i);\n   592  \n   593          if (!Algo-&gt;iterations[i]-&gt;is_sorted) {\n   594              sorted_count--;\n   595          } else {\n   596              sum_comp += Algo-&gt;iterations[i]-&gt;comp_count;\n   597              sum_assign += Algo-&gt;iterations[i]-&gt;assign_count;\n   598              sum_clocks += Algo-&gt;iterations[i]-&gt;clocks_total;\n   599              sum_time += Algo-&gt;iterations[i]-&gt;time_spent;\n   600          }\n   601      }\n   602      if (sorted_count &gt; 0) {\n   603          Algo-&gt;avg_comp = sum_comp / sorted_count;\n   604          Algo-&gt;avg_assign = sum_assign / sorted_count;\n   605          Algo-&gt;avg_clocks = (double)(sum_clocks / sorted_count);\n   606          Algo-&gt;avg_time = (double)(sum_time / sorted_count);\n   607          Algo-&gt;iter_count = sorted_count;\n   608      }\n   609  }\n   610  \n   611  Algorithm** rank_algorithms(Algorithm** target, int first, int last)\n   612  {\n   613  \n   614      Algorithm* temp;\n   615      int pivot, j, i;\n   616  \n   617      if (first &lt; last) {\n   618          pivot = first;\n   619          i = first;\n   620          j = last;\n   621  \n   622          while (i &lt; j) {\n   623              while (\n   624                  target[i]-&gt;avg_time &lt;= target[pivot]-&gt;avg_time &amp;&amp; i &lt; last) {\n   625                  i++;\n   626              }\n   627              while (target[j]-&gt;avg_time &gt; target[pivot]-&gt;avg_time) {\n   628                  j--;\n   629              }\n   630              if (i &lt; j) {\n   631                  temp = target[i];\n   632                  target[i] = target[j];\n   633                  target[j] = temp;\n   634              }\n   635          }\n   636  \n   637          temp = target[pivot];\n   638          target[pivot] = target[j];\n   639          target[j] = temp;\n   640  \n   641          rank_algorithms(target, first, j - 1);\n   642          rank_algorithms(target, j + 1, last);\n   643      }\n   644      return target;\n   645  }\n   646  \n</code></pre>\n<p>What I can successfully do (running a program):</p>\n<pre><code>How many arrays would you like to test? &gt; 100\nWhat is the size of each array? &gt; 10\nWhat is the minimum number in each array? &gt; 1\nWhat is the maximum number in each array? &gt; 10\nHow many repeating values there will be AT LEAST? &gt; 0\n</code></pre>\n<p>What I can't do:</p>\n<pre><code>How many arrays would you like to test? &gt; 1000\nWhat is the size of each array? &gt; 10\nWhat is the minimum number in each array? &gt; 1\nWhat is the maximum number in each array? &gt; 10\nHow many repeating values there will be AT LEAST? &gt; 0\n</code></pre>\n<p>The problem is when there are 1000 arrays to be tested (instead of 100).\nThis is the same error I get:</p>\n<pre><code>DEBUG pratybos12.c:590: is sorted 1\nDEBUG pratybos12.c:591: Array count: 919\n==5798== Invalid read of size 4\n==5798==    at 0x10A646: calculate_average (pratybos12.c:590)\n==5798==    by 0x1096F5: main (pratybos12.c:313)\n==5798==  Address 0x2d2d2d2d2d2d2d31 is not stack'd, malloc'd or (recently) free'd\n==5798==\n==5798==\n==5798== Process terminating with default action of signal 11 (SIGSEGV): dumping core\n==5798==  General Protection Fault\n==5798==    at 0x10A646: calculate_average (pratybos12.c:590)\n==5798==    by 0x1096F5: main (pratybos12.c:313)\n</code></pre>\n<p>The question is, how to even start debugging it, ie where the problem might be.</p>\n<p>A few notes:\n(1) When I run it with 100 arrays (first case), Valgrind reports that all memory is successfully freed, no leaks occur.</p>\n<p>(2) I had a &quot;double free or corruption error&quot; in line 300:</p>\n<pre><code>  300          free(data);\n</code></pre>\n<p>but I turned it off by setting MALLOC_CHECK_ to 0.</p>\n"}, {"tags": ["c", "coccinelle"], "owner": {"reputation": 31, "user_id": 9118678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb592b31176e05d0152919e8448855c?s=128&d=identicon&r=PG&f=1", "display_name": "curious_penguin", "link": "https://stackoverflow.com/users/9118678/curious-penguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514984142, "creation_date": 1514984035, "last_edit_date": 1514984142, "question_id": 48077836, "link": "https://stackoverflow.com/questions/48077836/change-struct-names-from-upper-case-to-lower-case-using-coccinelle", "title": "Change struct names from upper-case to lower-case using coccinelle", "body": "<p>I am trying to use Coccinelle to update a large number of files with C code to the Linux coding styles, but I can't manage to change the struct names. I am using the following script:</p>\n\n<pre><code>@rule1 disable all@\ntype t;\n@@\ntypedef struct {\n...\n} t;\n\n@ script:python foo @\nt_fixed;\nvar;\nt &lt;&lt; rule1.t;\n@@\nimport re\ndef split_uppercase(s):\n    return re.sub(r'([a-z-0-9])((?&lt;![0-9]{4})[A-Z])',r'\\1_\\2',s).replace(\"_k_Hz\", \"_kHz\").replace(\"_M_Hz\", \"_MHz\").replace(\"d_B\", \"dB\").lower()\n\nprint coccinelle.t\ncoccinelle.t_fixed = split_uppercase(t)\nprint coccinelle.t_fixed\ncoccinelle.var = cocci.make_type(t_fixed)\nprint var\n\n@rule2 disable all@\ntype rule1.t;\ntype foo.var;\n@@\n+ var\n- t\n</code></pre>\n\n<p>The desired result is to change:</p>\n\n<pre><code>typedef struct {\n    char me;\n    long you;\n} strName;\n\nint main (void) {\n    strName *DeV;\n    return 0;\n}\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>typedef struct {\n    char me;\n    long you;\n} str_name;\n\nint main (void) {\n    str_name *DeV;\n    return 0;\n}\n</code></pre>\n\n<p>But I am getting the following error:</p>\n\n<pre><code>init_defs_builtins: /usr/lib/coccinelle/standard.h\n----------------------------------------------------------------------- processing semantic patch file: structs_test.cocci with isos from:\n/usr/lib/coccinelle/standard.iso\n-----------------------------------------------------------------------\n\ndependencies for script satisfied: HANDLING: test_basic.c dependencies\nfor rule rule1 satisfied:\n     transformation info is empty dependencies for script satisfied: Traceback (most recent call last):   File \"&lt;string&gt;\", line 10, in\n&lt;module&gt; AttributeError: Cocci instance has no attribute 'make_type'\nwhile running simple python string: from coccinelle import *\n\nimport re def split_uppercase(s):\n    return re.sub(r'([a-z-0-9])((?&lt;![0-9]{4})[A-Z])',r'\\1_\\2',s).replace(\"_k_Hz\",\n\"_kHz\").replace(\"_M_Hz\", \"_MHz\").replace(\"d_B\", \"dB\").lower()\n\nprint coccinelle.t coccinelle.t_fixed = split_uppercase(t) print\ncoccinelle.t_fixed coccinelle.var = cocci.make_type(t_fixed) print var\n\n\n\n\n\n\n\n: Failure in foo Fatal error: exception Yes_pycocci.Pycocciexception\n</code></pre>\n\n<p>I am sorry if the question is wrong.</p>\n"}, {"tags": ["c", "variables", "structure", "unions", "mplab"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1514983776, "post_id": 48077596, "comment_id": 83129204, "body": "Please <a href=\"https://stackoverflow.com/posts/48077596/edit\">edit</a> your question and make clear in your code snippets what works and what does not work instead of describing your code."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1514983901, "post_id": 48077596, "comment_id": 83129278, "body": "It smells like undefined behavior..."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1514983922, "post_id": 48077596, "comment_id": 83129297, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514984438, "post_id": 48077596, "comment_id": 83129580, "body": "How do you know that the value is wrong?"}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514984672, "post_id": 48077596, "comment_id": 83129722, "body": "@4386427 This code drives an LCD  which includes 7 segments display in it.  0xFF draws &quot;8&quot; on the screen for example. Each bit presents a segment. (8th one is not used). I see undefined symbols on the screen if i try to pass a variable to another. (else, I do see the right one if I pass the value directly )"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514984906, "post_id": 48077596, "comment_id": 83129852, "body": "How do you connect the variable <code>UpdatedDigit</code> to your HW register? I guess that&#39;s where your problem is."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1514985117, "post_id": 48077596, "comment_id": 83129977, "body": "Work for me, <a href=\"http://rextester.com/FVLQ13059\" rel=\"nofollow noreferrer\">rextester.com/FVLQ13059</a>, AFAIK this should not be undefined behavior."}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1514986536, "post_id": 48077596, "comment_id": 83130766, "body": "@Stargateur Thank you for your answer but you directly assigned 0xFF value into the structure. What I can not do is assigning 0xFF to an unsigned char first then passing it to structure."}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514986539, "post_id": 48077596, "comment_id": 83130767, "body": "@4386427 After updating UpdatedDigit, I use the &quot;DigitBit&quot; (like UpdatedDigit.DigitBit.SEG_A ) to update another structre one by one."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1514988649, "post_id": 48077596, "comment_id": 83131917, "body": "Works for me. Look at the generated assembly code."}, {"owner": {"reputation": 99, "user_id": 7151170, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106084696105464/picture?type=large", "display_name": "Orestes Kappa", "link": "https://stackoverflow.com/users/7151170/orestes-kappa"}, "edited": false, "score": 0, "creation_date": 1515030806, "post_id": 48077596, "comment_id": 83150176, "body": "Does UpdatedDigit.DigitChar = (unsigned char) 0xFF work?"}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515050343, "post_id": 48077596, "comment_id": 83155155, "body": "@Stargateur Thank you for your feed-back. I have read the link you have sent and tried to edit my question according to it. Can you please check it and tell me if it is still not proper."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1515054830, "post_id": 48077596, "comment_id": 83157084, "body": "Perhaps the call to <code>LCD_7SEG()</code> gets optimised away?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "edited": false, "score": 0, "creation_date": 1515066494, "post_id": 48077596, "comment_id": 83163718, "body": "@HardikSanghvi: Why? There is not difference between 255 and 0xff?"}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515067779, "post_id": 48077596, "comment_id": 83164531, "body": "@Stargateur FULL code is added."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515068478, "post_id": 48077596, "comment_id": 83164970, "body": "I think you do something wrong with the definition of <code>StructLCD</code> double check your bit field, without documentation it impossible to know if you fail somewhere, Are you sure this work with <code>0xFF</code> (when use printf) too ? If union not working try by hand with bit operator. Note: char is not mandatory to be 8 bit type, use uint8_t ;)."}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515071834, "post_id": 48077596, "comment_id": 83166932, "body": "@Stargateur I have already tested all segments one by one via StructLCD. 8-bit stands for 7 segment of display. (8th one is dummy). 0xFF is randomly chosed by me just to see if it drives all segments (draws &quot;8&quot;). Any other value can be chosen to test if the works or not(I tried any other values too), it is not the case here. I have checked &lt;stdint.h&gt; file and &quot;unsigned char&quot; is defined as uint8_t already. (See the updated question)"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515072301, "post_id": 48077596, "comment_id": 83167213, "body": "@CuriousPuppy You misunderstand it&#39;s uint8_t who is typedef as unsigned char. Anyway, I don&#39;t know why this happen."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1515072681, "post_id": 48077596, "comment_id": 83167459, "body": "Could it be som kind of timing issue? Also, ask your compiler to produce assembly output and compare working vs non-working. Running under debugger would be even better, if you can."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 0, "creation_date": 1515073475, "post_id": 48096441, "comment_id": 83168012, "body": "I tried your suggestion. The problem exists. I see only 2 random digits are driven. Despite it is supposed to drive all of them since the value is 0xFF."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 1, "creation_date": 1515073571, "post_id": 48096441, "comment_id": 83168073, "body": "@CuriousPuppy: Try <code>... = (int) buffer;</code>."}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 0, "creation_date": 1515074273, "post_id": 48096441, "comment_id": 83168528, "body": "It works but why, I would like to know the reason behind it since unsigned char is defined as uint8_t why do I have to put &quot;(int)&quot; instruction in front of the variable again ?  Note : Can you also update your answer since I marked it as accepted."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 0, "creation_date": 1515074642, "post_id": 48096441, "comment_id": 83168759, "body": "What does <code>sizeof UpdatedDigit</code> give you?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 0, "creation_date": 1515074756, "post_id": 48096441, "comment_id": 83168827, "body": "&quot;<i>unsigned char is defined as uint8_t</i>&quot; no, it&#39;s the other way round. <code>uint8_t</code>  is defined a <code>unsigned char</code>. You misread the related <code>typedef</code>."}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 0, "creation_date": 1515078405, "post_id": 48096441, "comment_id": 83171076, "body": "Yes, I have realised it is the other way around. I will check sizeof the variable tomorrow. I cant reach it now."}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1515133333, "post_id": 48096441, "comment_id": 83191772, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/162565/discussion-between-curiouspuppy-and-alk\">continue this discussion in chat</a>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 0, "creation_date": 1515151377, "post_id": 48096441, "comment_id": 83200683, "body": "@CuriousPuppy: Please exactly which compiler are you using?"}, {"owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "edited": false, "score": 0, "creation_date": 1515395366, "post_id": 48096441, "comment_id": 83269407, "body": "Compiler is XC8 v1.45. After a long discussion the problem is solved by changing the definition of DGSeg structure from &quot;unsigned char&quot; to &quot;unsigned int&quot;. It is believed that the compiler bug ( or how you call it) caused this problem."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1515077873, "last_edit_date": 1515077873, "creation_date": 1515072714, "answer_id": 48096441, "question_id": 48077596, "link": "https://stackoverflow.com/questions/48077596/assigning-a-variable-to-another-variable-in-a-union-in-c/48096441#48096441", "title": "Assigning a Variable to Another Variable in a Union in C", "body": "<p>Try this:</p>\n\n<p>Add</p>\n\n<pre><code>void LCD_Set(int value)\n{         \n  UpdatedDigit.DigitChar = value;\n}\n</code></pre>\n\n<p>Modify</p>\n\n<pre><code>void LCD_7SEG(void)\n{         \n  LCD_Set(0xff);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5700526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhUI9.jpg?s=128&g=1", "display_name": "CuriousPuppy", "link": "https://stackoverflow.com/users/5700526/curiouspuppy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1515077873, "creation_date": 1514983125, "last_edit_date": 1515071975, "question_id": 48077596, "link": "https://stackoverflow.com/questions/48077596/assigning-a-variable-to-another-variable-in-a-union-in-c", "title": "Assigning a Variable to Another Variable in a Union in C", "body": "<p>I am working on a project in MPLAB X IDE 3.60. There some union/structure definitions in it. They are used to drive 7 segment LCD.</p>\n\n<p>I can not pass a variable into another one by using its name. It assigns a random value instead. However, I can assign the value itself to the related variable and LCD works perfectly.</p>\n\n<p>main.c</p>\n\n<pre><code>#define _XTAL_FREQ 40000000\n#if defined(__XC)\n    #include &lt;xc.h&gt;        /* XC8 General Include File */\n#elif defined(HI_TECH_C)\n    #include &lt;htc.h&gt;       /* HiTech General Include File */\n#elif defined(__18CXX)\n    #include &lt;p18cxxx.h&gt;   /* C18 General Include File */\n#endif\n\n#if defined(__XC) || defined(HI_TECH_C)\n\n#include &lt;stdint.h&gt;        /* For uint8_t definition */\n#include &lt;stdbool.h&gt;       /* For true/false definition */\n#endif\n\n#include \"system.h\"        /* System funct/params, like osc/peripheral config */\n#include \"user.h\"          /* User funct/params, such as InitApp */\n#include \"lcd_driver.h\"\n\n//CONFIG\n#pragma config SOSCSEL = DIG\n#pragma config FOSC = HS1       // Oscillator (HS oscillator (Medium power, 4 MHz - 16 MHz))\n#pragma config PLLCFG = ON      // PLL x4 Enable bit (Enabled)\n#pragma config FCMEN = OFF      // Fail-Safe Clock Monitor (Disabled)\n#pragma config IESO = OFF       // Internal External Oscillator Switch Over Mode (Disabled)\n\n\n\nvoid main(void)\n{\n    /* Configure the oscillator for the device */\n    ConfigureOscillator();\n    //Variables \n\n    ANCON2 = 0x00;\n    CCP6OD = 0; // RG3, comparator disabled.\n    OSCCONbits.SCS = 0;\n\n\n    LcdInit();\n    LCD_7SEG();\n    LCD_Update();\n\n    while(1)\n    {\n\n    } \n}\n</code></pre>\n\n<p>lcd_driver.c</p>\n\n<pre><code>#include &lt;xc.h&gt;\n\n#include \"lcd_driver.h\"\n#include \"defines.h\"\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\n\nvolatile StructLCD      MediumLCDBuffer; // Not used yet\nvolatile StructLCD      MediumLCD @0xF66;\n\nvolatile UDigit UpdatedDigit;\n\n\nvoid LcdInit(void)\n{\n    // Init ports function for LCD driver\n    LCDSE0bits.SE00 = 1;\n    LCDSE0bits.SE01 = 1;\n    LCDSE0bits.SE02 = 1;\n    LCDSE0bits.SE03 = 1;\n    LCDSE0bits.SE04 = 1;\n    LCDSE0bits.SE05 = 1;\n    LCDSE0bits.SE06 = 1;\n    LCDSE0bits.SE07 = 1;\n\n    LCDSE1bits.SE08 = 1;\n    LCDSE1bits.SE09 = 1;\n    LCDSE1bits.SE10 = 1;\n    LCDSE1bits.SE11 = 1;\n    LCDSE1bits.SE12 = 1;\n    LCDSE1bits.SE13 = 1;\n    LCDSE1bits.SE14 = 1;\n    LCDSE1bits.SE15 = 1;\n\n    LCDSE2bits.SE18 = 1;\n    LCDSE2bits.SE19 = 1;\n    LCDSE2bits.SE20 = 1;\n    LCDSE2bits.SE21 = 1;\n    LCDSE2bits.SE22 = 1;\n    LCDSE2bits.SE23 = 1;\n\n    LCDSE3bits.SE24 = 1;\n    LCDSE3bits.SE25 = 1;\n    LCDSE3bits.SE26 = 1; \n    LCDSE3bits.SE29 = 1;\n    LCDSE3bits.SE29 = 1;\n    LCDSE3bits.SE30 = 1;\n\n    // Reference ladder interval control\n    LCDRLbits.LRLAT0 = 1;\n    LCDRLbits.LRLAT1 = 1;\n    LCDRLbits.LRLAT2 = 1;\n\n    // Reference ladder A Power Control\n    LCDRLbits.LRLAP0 = 1;\n    LCDRLbits.LRLAP1 = 1;\n\n    // Reference ladder B Power Control\n    LCDRLbits.LRLBP0 = 1;\n    LCDRLbits.LRLBP1 = 1;\n\n    // Select internal bias\n    LCDREFbits.VLCD1PE = 0;\n    LCDREFbits.VLCD2PE = 0;\n    LCDREFbits.VLCD3PE = 0;\n\n    // Enable internal reference\n    LCDREFbits.LCDIRE = 1;\n\n    // Select internal reference source (VDD)\n    LCDREFbits.LCDIRS = 0;\n\n    // Select LCD contrast (0 = Max contrast, 7 = min contrast)\n    LCDREFbits.LCDCST0 = 1;\n    LCDREFbits.LCDCST1 = 0;\n    LCDREFbits.LCDCST2 = 0;\n\n    /* LCDCON register */\n    LCDCONbits.LCDEN = 1; //Enable LCD Module\n    LCDCONbits.SLPEN = 0;\n    LCDCONbits.WERR = 0;\n    LCDCONbits.CS = 0; // (Fosc/4)/8192))\n    LCDCONbits.LMUX = 3; // &lt;1:0&gt; 1/4 COM, 1/3 BIAS \n\n\n    /* LCDPS register  */\n    LCDPSbits.WFT = 0; // Type-A Waveform Selection.\n    LCDPSbits.BIASMD = 0;\n    LCDPSbits.LCDA = 1;\n    LCDPSbits.WA = 0;\n    // LCD prescaler bits\n    LCDPSbits.LP0 = 1;\n    LCDPSbits.LP1 = 1;\n    LCDPSbits.LP2 = 0; // 1:4\n    LCDPSbits.LP3 = 0;\n}\n\nvoid LCD_7SEG(void)\n{         \n    unsigned char buffer = 0x12; // assign a value\n    //printf(\"%u\", (unsigned char) buffer); // Does not work without this line, It assigns random value instead of buffer value\n    UpdatedDigit.DigitChar = buffer;        \n}\n\nvoid LCD_Update(void)\n{        \n    MediumLCD.Seg10A = UpdatedDigit.DigitBit.SEG_A;   MediumLCD.Seg10B = UpdatedDigit.DigitBit.SEG_B;\n    MediumLCD.Seg10C = UpdatedDigit.DigitBit.SEG_C;   MediumLCD.Seg10D = UpdatedDigit.DigitBit.SEG_D;\n    MediumLCD.Seg10E = UpdatedDigit.DigitBit.SEG_E;   MediumLCD.Seg10F = UpdatedDigit.DigitBit.SEG_F;\n    MediumLCD.Seg10G = UpdatedDigit.DigitBit.SEG_G;\n\n}\n</code></pre>\n\n<p>lcd_driver.h</p>\n\n<pre><code>#ifndef LCD_DRIVER_H\n#define LCD_DRIVER_H\n\n#ifdef  __cplusplus\nextern \"C\" {\n#endif\n\n#ifdef  __cplusplus\n}\n#endif  \n\n\ntypedef struct \n{\n    // -- COM 3 (LCD)-- //)         PIC(No) |   LCD(no))\n    unsigned char ECOLOWER      :1; //Seg0      LCD1\n    unsigned char Seg5D         :1; //Seg1      LCD2\n    unsigned char DP5           :1; //Seg2      LCD3\n    unsigned char Seg6D         :1; //Seg3      LCD4\n    unsigned char DP6           :1; //Seg4      LCD5\n    unsigned char Seg7D         :1; //Seg5      LCD6\n    unsigned char DEGLOWER      :1; //Seg6      LCD7\n    unsigned char ECOUPPER      :1; //Seg7      LCD8    (LCD9 -&gt; SEG30)\n\n    unsigned char DP7           :1; //Seg8      LCD10\n    unsigned char Seg9D         :1; //Seg9      LCD11\n    unsigned char DP8           :1; //Seg10     LCD12\n    unsigned char Seg10D        :1; //Seg11     LCD13   (LCD14 -&gt; SEG29)\n    unsigned char kW            :1; //Seg12     LCD15\n    unsigned char BarFrame_09   :1; //Seg13     LCD16\n    unsigned char BarGraph_I5   :1; //Seg14     LCD17\n    unsigned char BarFrame_I5   :1; //Seg15     LCD18    \n\n    unsigned char Dummy1        :1; //Seg16     Disabled!\n    unsigned char Dummy2        :1; //Seg17     Disabled!\n    unsigned char Seg4B         :1; //Seg18     LCD19\n    unsigned char Seg4A         :1; //Seg19     LCD20\n    unsigned char Seg3B         :1; //Seg20     LCD21\n    unsigned char Seg3A         :1; //Seg21     LCD22\n    unsigned char Seg2B         :1; //Seg22     LCD23\n    unsigned char Seg2A         :1; //Seg23     LCD24\n\n    unsigned char Seg1B         :1; //Seg24     LCD25\n    unsigned char Seg1A         :1; //Seg25     LCD26\n    unsigned char Service       :1; //Seg26     LCD27\n    unsigned char Dummy3        :1; //Seg27     Disabled\n    unsigned char Dummy4        :1; //Seg28     Disabled\n    unsigned char DummyNC       :1; //Seg29     LCD14\n    unsigned char Seg8D         :1; //Seg30     LCD9\n    unsigned char Dummy5        :1; //Seg31     Disabled\n\n    unsigned char Dummy6        :8; //LCDDATA4 not available\n    unsigned char Dummy7        :8; //LCDDATA5 not available\n\n    // -- COM 2 (LCD)-- //)         PIC(No) |   LCD(no))\n    unsigned char COD           :1; //Seg0      LCD1\n    unsigned char Seg5E         :1; //Seg1      LCD2\n    unsigned char Seg5C         :1; //Seg2      LCD3\n    unsigned char Seg6E         :1; //Seg3      LCD4\n    unsigned char Seg6C         :1; //Seg4      LCD5\n    unsigned char Seg7E         :1; //Seg5      LCD6\n    unsigned char Seg7C         :1; //Seg6      LCD7\n    unsigned char VAL           :1; //Seg7      LCD8    (LCD9 -&gt; SEG30)\n\n    unsigned char Seg8C         :1; //Seg8      LCD10\n    unsigned char Seg9E         :1; //Seg9      LCD11\n    unsigned char Seg9C         :1; //Seg10     LCD12\n    unsigned char Seg10E        :1; //Seg11     LCD13   (LCD14 -&gt; SEG29)\n    unsigned char Lmin          :1; //Seg12     LCD15\n    unsigned char BarFrame_I9   :1; //Seg13     LCD16\n    unsigned char BarFrame_I6   :1; //Seg14     LCD17\n    unsigned char BarGraph_I6   :1; //Seg15     LCD18    \n\n    unsigned char Dummy8        :1; //Seg16     Disabled!\n    unsigned char Dummy9        :1; //Seg17     Disabled!\n    unsigned char Seg4G         :1; //Seg18     LCD19\n    unsigned char Seg4F         :1; //Seg19     LCD20\n    unsigned char Seg3G         :1; //Seg20     LCD21\n    unsigned char Seg3F         :1; //Seg21     LCD22\n    unsigned char Seg2G         :1; //Seg22     LCD23\n    unsigned char Seg2F         :1; //Seg23     LCD24\n\n    unsigned char Seg1G         :1; //Seg24     LCD25\n    unsigned char Seg1F         :1; //Seg25     LCD26\n    unsigned char WaterDrop     :1; //Seg26     LCD27\n    unsigned char Dummy10       :1; //Seg27     Disabled\n    unsigned char Dummy11       :1; //Seg28     Disabled\n    unsigned char Seg10C        :1; //Seg29     LCD14\n    unsigned char Seg8E         :1; //Seg30     LCD9\n    unsigned char Dummy12       :1; //Seg31     Disabled\n\n    unsigned char Dummy13       :8; //LCDDATA10 not available\n    unsigned char Dummy14       :8; //LCDDATA11 not available\n\n    // -- COM 1 (LCD)-- //)         PIC(No) |   LCD(no)\n    unsigned char TAP           :1; //Seg0      LCD1\n    unsigned char Seg5F         :1; //Seg1      LCD2\n    unsigned char Seg5G         :1; //Seg2      LCD3\n    unsigned char Seg6F         :1; //Seg3      LCD4\n    unsigned char Seg6G         :1; //Seg4      LCD5\n    unsigned char Seg7F         :1; //Seg5      LCD6\n    unsigned char Seg7G         :1; //Seg6      LCD7\n    unsigned char Radiator      :1; //Seg7      LCD8    (LCD9 -&gt; SEG30)\n\n    unsigned char Seg8G         :1; //Seg8      LCD10\n    unsigned char Seg9F         :1; //Seg9      LCD11\n    unsigned char Seg9G         :1; //Seg10     LCD12\n    unsigned char Seg10F        :1; //Seg11     LCD13   (LCD14 -&gt; SEG29)\n    unsigned char RPM           :1; //Seg12     LCD15\n    unsigned char Flame         :1; //Seg13     LCD16\n    unsigned char BarGraph_I7    :1; //Seg14     LCD17\n    unsigned char BarFrame_I7   :1; //Seg15     LCD18    \n\n    unsigned char Dummy15       :1; //Seg16     Disabled!\n    unsigned char Dummy16       :1; //Seg17     Disabled!\n    unsigned char Seg4C         :1; //Seg18     LCD19\n    unsigned char Seg4E         :1; //Seg19     LCD20\n    unsigned char Seg3C         :1; //Seg20     LCD21\n    unsigned char Seg3E         :1; //Seg21     LCD22\n    unsigned char Seg2C         :1; //Seg22     LCD23\n    unsigned char Seg2E         :1; //Seg23     LCD24\n\n    unsigned char Seg1C         :1; //Seg24     LCD25\n    unsigned char Seg1E         :1; //Seg25     LCD26\n    unsigned char Phone         :1; //Seg26     LCD27\n    unsigned char Dummy17       :1; //Seg27     Disabled\n    unsigned char Dummy18       :1; //Seg28     Disabled\n    unsigned char Seg10G        :1; //Seg29     LCD14\n    unsigned char Seg8F         :1; //Seg30     LCD9\n    unsigned char Dummy19        :1; //Seg31     Disabled\n\n    unsigned char Dummy20       :8; //LCDDATA16 not available\n    unsigned char Dummy21       :8; //LCDDATA17 not available\n\n    // -- COM 0 (LCD)-- //)         PIC(No) |   LCD(No))\n    unsigned char Line          :1; //Seg0      LCD1\n    unsigned char Seg5A         :1; //Seg1      LCD2\n    unsigned char Seg5B         :1; //Seg2      LCD3\n    unsigned char Seg6A         :1; //Seg3      LCD4\n    unsigned char Seg6B         :1; //Seg4      LCD5\n    unsigned char Seg7A         :1; //Seg5      LCD6\n    unsigned char Seg7B         :1; //Seg6      LCD7\n    unsigned char Dummy22       :1; //Seg7      LCD8    (LCD9 -&gt; SEG30)\n\n    unsigned char Seg8B         :1; //Seg8      LCD10\n    unsigned char Seg9A         :1; //Seg9      LCD11\n    unsigned char Seg9B         :1; //Seg10     LCD12\n    unsigned char Seg10A        :1; //Seg11     LCD13   (LCD14 -&gt; SEG29)\n    unsigned char DEGUPPER      :1; //Seg12     LCD15\n    unsigned char Dummy23       :1; //Seg13     LCD16\n    unsigned char BarFrame_I8   :1; //Seg14     LCD17\n    unsigned char BarGraph_I8   :1; //Seg15     LCD18    \n\n    unsigned char Dummy24       :1; //Seg16     Disabled!\n    unsigned char Dummy25       :1; //Seg17     Disabled!\n    unsigned char BAR           :1; //Seg18     LCD19\n    unsigned char Seg4D         :1; //Seg19     LCD20\n    unsigned char DP4           :1; //Seg20     LCD21\n    unsigned char Seg3D         :1; //Seg21     LCD22\n    unsigned char DP2           :1; //Seg22     LCD23\n    unsigned char Seg2D         :1; //Seg23     LCD24\n\n    unsigned char DP1           :1; //Seg24     LCD25\n    unsigned char Seg1D         :1; //Seg25     LCD26\n    unsigned char DP3           :1; //Seg26     LCD27\n    unsigned char Dummy26       :1; //Seg27     Disabled\n    unsigned char Dummy27       :1; //Seg28     Disabled\n    unsigned char Seg10B        :1; //Seg29     LCD14\n    unsigned char Seg8A         :1; //Seg30     LCD9\n    unsigned char Dummy28       :1; //Seg31     Disabled\n\n    unsigned char Dummy29       :8; //LCDDATA22 not available\n    unsigned char Dummy30       :8; //LCDDATA23 not available\n} StructLCD;\n\ntypedef struct \n{\n    unsigned char SEG_A :1;\n    unsigned char SEG_B :1;\n    unsigned char SEG_C :1;\n    unsigned char SEG_D :1;\n    unsigned char SEG_E :1;\n    unsigned char SEG_F :1;\n    unsigned char SEG_G :1;\n    unsigned char NONE  :1;   \n}DGSeg;\n\ntypedef union \n{\n    unsigned char DigitChar;\n    DGSeg DigitBit;   \n}UDigit;\n\nextern volatile StructLCD MediumLCD;\nextern volatile UDigit UpdatedDigit;\n\nvoid LcdInit(void);\nvoid LCD_7SEG(void);\nvoid LCD_Update(void);\n\n#endif  /* LCD_DRIVER_H */\n</code></pre>\n\n<p>Edit : Adding printf lines between the variable definitions unexpectedly works. If I comment these lines out, the problem persists. This behaviour still does not make sense to me. </p>\n\n<p>Edit2 : Full Code added.</p>\n\n<pre><code>void LCD_7SEG(void)\n{\n    unsigned char buffer= 0x11; // assign a value\n    printf(\"%d\\n\", buffer);\n    UpdatedDigit.DigitChar = buffer; // the value is passed successfully, LCD shows SEG_A and SEGE as expected.\n    printf(\"%d\\n\", UpdatedDigit.DigitChar);      \n</code></pre>\n\n<p>Edit 3 : definition of unsigned char is added.</p>\n\n<pre><code>&lt;stdint.h&gt;\n#ifndef uint8_t\ntypedef unsigned char uint8_t;\n#define uint8_t uint8_t\n#define UINT8_MAX (255)\n#endif\n</code></pre>\n"}, {"tags": ["c++", "c", "cppcheck"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1514981858, "post_id": 48077092, "comment_id": 83128124, "body": "Why do you want this?"}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1514982169, "post_id": 48077092, "comment_id": 83128299, "body": "@HolyBlackCat That would be handy if checking consumes a lot of time. It is common practice to provide such an option. For example gcc offers <code>-Wfatal-errors</code>. Anyway, there is no reason for -3 rating for this question."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1514983644, "post_id": 48077092, "comment_id": 83129128, "body": "@VTT other than lack of research."}, {"owner": {"reputation": 7, "user_id": 9144520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/711b45e78f052813f3dac599d45b5d1d?s=128&d=identicon&r=PG", "display_name": "jonyR", "link": "https://stackoverflow.com/users/9144520/jonyr"}, "edited": false, "score": 0, "creation_date": 1514989568, "post_id": 48077092, "comment_id": 83132433, "body": "i saw this manual you put here... didn&#39;t found any help there. so i asked here... didn&#39;t know its not allowed :/"}, {"owner": {"reputation": 1415, "user_id": 3055724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZGm8W.png?s=128&g=1", "display_name": "Duloren", "link": "https://stackoverflow.com/users/3055724/duloren"}, "edited": false, "score": 0, "creation_date": 1515207803, "post_id": 48077092, "comment_id": 83224705, "body": "Here is not a platform for ask for code. Please show some effort"}], "answers": [{"tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1514981573, "creation_date": 1514981573, "answer_id": 48077163, "question_id": 48077092, "link": "https://stackoverflow.com/questions/48077092/how-to-make-cppcheck-stop-on-error/48077163#48077163", "title": "How to make cppcheck stop on error", "body": "<p>Looking at <a href=\"http://cppcheck.sourceforge.net/manual.pdf\" rel=\"nofollow noreferrer\">http://cppcheck.sourceforge.net/manual.pdf</a>\nThere seems to be no option to stop at first issue.  You could always contact them directly though to confirm or request the feature.</p>\n"}], "owner": {"reputation": 7, "user_id": 9144520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/711b45e78f052813f3dac599d45b5d1d?s=128&d=identicon&r=PG", "display_name": "jonyR", "link": "https://stackoverflow.com/users/9144520/jonyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1514981643, "creation_date": 1514981273, "last_edit_date": 1514981643, "question_id": 48077092, "link": "https://stackoverflow.com/questions/48077092/how-to-make-cppcheck-stop-on-error", "title": "How to make cppcheck stop on error", "body": "<p>I use cppcheck to look for errors.\nnow I'm looking for a way the stop the cppcheck run after he found the first error.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c", "file", "linked-list"], "comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 2, "creation_date": 1514981360, "post_id": 48076991, "comment_id": 83127878, "body": "<a href=\"https://stackoverflow.com/q/605845/5958455\">Don&#39;t cast <code>malloc()</code></a>"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 2, "creation_date": 1514981523, "post_id": 48076991, "comment_id": 83127948, "body": "<a href=\"https://stackoverflow.com/q/2187474/5958455\">Don&#39;t do <code>fflush(stdin)</code></a>"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 2, "creation_date": 1514981601, "post_id": 48076991, "comment_id": 83127980, "body": "<a href=\"https://stackoverflow.com/q/5431941/5958455\">Why <code>while(!feof())</code> is a bad idea</a>"}, {"owner": {"reputation": 8573, "user_id": 1520907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ef775a1d43b1bd7fe3882a2ea469136?s=128&d=identicon&r=PG&f=1", "display_name": "user123", "link": "https://stackoverflow.com/users/1520907/user123"}, "edited": false, "score": 0, "creation_date": 1514981614, "post_id": 48076991, "comment_id": 83127994, "body": "Your bug is most likely the fact that you may not be setting <code>head-&gt;next</code> to <code>NULL</code> upon creation. Also, listen to this guy^; <b>edit</b>: Nevermind, you are."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 8573, "user_id": 1520907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ef775a1d43b1bd7fe3882a2ea469136?s=128&d=identicon&r=PG&f=1", "display_name": "user123", "link": "https://stackoverflow.com/users/1520907/user123"}, "edited": false, "score": 0, "creation_date": 1514981666, "post_id": 48076991, "comment_id": 83128026, "body": "@MohamadAliBaydoun No, it&#39;s well-formed."}, {"owner": {"reputation": 33, "user_id": 8349760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f570921ba231000772365eb6848ad83?s=128&d=identicon&r=PG&f=1", "display_name": "mohammad mozafari", "link": "https://stackoverflow.com/users/8349760/mohammad-mozafari"}, "edited": false, "score": 0, "creation_date": 1514981768, "post_id": 48076991, "comment_id": 83128074, "body": "Did it. Unfortunately, it did&#39;t work."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 3, "creation_date": 1514981871, "post_id": 48076991, "comment_id": 83128137, "body": "Where&#39;s your <code>stdlib.h</code>? You should have received a warning from your compiler for a declaration for <code>malloc()</code>."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1514981911, "post_id": 48076991, "comment_id": 83128161, "body": "I copied the full code and added the missing header. Then it works fine. How?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1514981991, "post_id": 48076991, "comment_id": 83128196, "body": "Eric Lippert&#39;s article about <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> may be worth reading."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1514982097, "post_id": 48076991, "comment_id": 83128256, "body": "You may want to provide us your input and the content of <code>Book.txt</code>. I really can&#39;t reproduce your problem."}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 1, "creation_date": 1514989034, "post_id": 48076991, "comment_id": 83132152, "body": "<code>ite-&gt;next = (NODE*)malloc(sizeof(NODE*));</code> should be <code>ite-&gt;next = malloc(sizeof(NODE));</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515112566, "post_id": 48076991, "comment_id": 83186880, "body": "why does the function: <code>printList()</code> have the local/unused variable <code>i</code>?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515112621, "post_id": 48076991, "comment_id": 83186892, "body": "for flexibility, etc it is best to separate the definition of a struct from a typedef for the struct"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515112681, "post_id": 48076991, "comment_id": 83186914, "body": "the word: <code>read</code> is the name of a well known function in C.  It is best to not use function names for variable names."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515112877, "post_id": 48076991, "comment_id": 83186966, "body": "regarding: <code>if (read == NULL)     {         return;     }</code>  needs some changes.  For instance, there should be a error message to <code>stderr</code> and since <code>fopen()</code> is a system function, should also output to <code>stderr</code> the reason the system thinks the function failed.  Suggest: <code>if( ! read ) { perror( &quot;fopen for reading &#39;Book.txt&#39; failed&quot; ); exit( EXIT_FAILURE ); }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515112984, "post_id": 48076991, "comment_id": 83186999, "body": "regarding: <code>if(!feof(read))</code> will not do what your expecting.  Similar considerations exist for <code>while (!feof(read))</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515113113, "post_id": 48076991, "comment_id": 83187026, "body": "when calling any of the heap allocation functions: (malloc, calloc, realloc, strdup) 1) always check (!=NULL) the returned value to assure the operation was successful.  2) the returned type is <code>void*</code>.  It can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug,. etc."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515113270, "post_id": 48076991, "comment_id": 83187064, "body": "when calling any of the <code>scanf()</code> family of functions, 1) always check the returned value to assure the operation was successful.  2) when using the <code>&quot;%s&quot;</code> or <code>%[...]</code> input format specifiers, always include a MAX CHARACTERS modifier that is one less than the length of the input buffer.  This is because a NUL byte will always be appended to the input buffer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515113432, "post_id": 48076991, "comment_id": 83187103, "body": "the posted code contains some &#39;magic&#39; numbers.  &#39;magic&#39; numbers are numbers with no basis. I.E: 11, 50, 200.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, etc.  Suggest using a <code>enum</code> statement of <code>#define</code> statements to give those &#39;magic&#39; numbers meaningful names, then using those meaningful names throughout the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515113642, "post_id": 48076991, "comment_id": 83187174, "body": "regarding this statement: <code>fflush( stdin );</code>  The function: <code>fflush()</code> is ONLY for output streams, not input streams.  Per the C standard, using it on an input stream is undefined behavior.  (even though visual studio allows it)  Suggest using a loop similar to: <code>int ch;  while( (ch = getchar()) != EOF &amp;&amp; &#39;\\n&#39; != ch );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515114004, "post_id": 48076991, "comment_id": 83187269, "body": "regarding this kind of statement: <code>head = (NODE*)malloc(sizeof(NODE*));</code>  This is only allocating enough room for a pointer.  What is needed is to allocate enough room for a complete &#39;NODE&#39;.  Suggest: <code>head = malloc( sizeof NODE );  if( !head ) { perror( &quot;malloc failed&quot; );  &#47;&#47; cleanup all&#47;any prior allocated memory by passing the pointers to </code>free();` then call <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515114250, "post_id": 48076991, "comment_id": 83187344, "body": "regarding: <code>scanf(&quot;%s&quot;, ite-&gt;ad);</code>   Most addresses have spaces, so this will not work.  Suggest: <code>if( 1 != scanf( &quot;%199[^\\n]&quot;, ite-&gt;ad ) ) { fprintf( stderr, &quot;trying to input the address failed\\n&quot;);  &#47;&#47; pass all&#47;any prior memory allocations to </code>free(); exit( EXIT_FAILURE ); }`"}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 33, "user_id": 8349760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f570921ba231000772365eb6848ad83?s=128&d=identicon&r=PG&f=1", "display_name": "mohammad mozafari", "link": "https://stackoverflow.com/users/8349760/mohammad-mozafari"}, "edited": false, "score": 0, "creation_date": 1514982553, "post_id": 48077367, "comment_id": 83128548, "body": "@mohammadmozafari Yes."}, {"owner": {"reputation": 33, "user_id": 8349760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f570921ba231000772365eb6848ad83?s=128&d=identicon&r=PG&f=1", "display_name": "mohammad mozafari", "link": "https://stackoverflow.com/users/8349760/mohammad-mozafari"}, "edited": false, "score": 0, "creation_date": 1514982613, "post_id": 48077367, "comment_id": 83128579, "body": "What should i use instead of !feof()?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 33, "user_id": 8349760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f570921ba231000772365eb6848ad83?s=128&d=identicon&r=PG&f=1", "display_name": "mohammad mozafari", "link": "https://stackoverflow.com/users/8349760/mohammad-mozafari"}, "edited": false, "score": 1, "creation_date": 1514982771, "post_id": 48077367, "comment_id": 83128665, "body": "@mohammadmozafari Use the return value from <code>fscanf()</code>. It reports how many items are successfully read."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1514983908, "post_id": 48077367, "comment_id": 83129285, "body": "worth elaborating: not having a proper declaration of <code>malloc()</code> available, and not using proper compiler options, means the compiler will assume it has the old, obsolete default of taking no arguments and returning an <code>int</code>, so extremely wrong things will happen when it&#39;s called in any other sense, and crashing is no surprise."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 2, "last_activity_date": 1514982294, "creation_date": 1514982294, "answer_id": 48077367, "question_id": 48076991, "link": "https://stackoverflow.com/questions/48076991/crash-while-working-with-files-and-linked-lists/48077367#48077367", "title": "Crash while working with files and linked lists", "body": "<p>First of all, there are 3 points that are worth noting:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/605845/5958455\">Don't cast <code>malloc()</code></a></li>\n<li><a href=\"https://stackoverflow.com/q/2187474/5958455\">Don't <code>fflush()</code> input streams</a></li>\n<li><a href=\"https://stackoverflow.com/q/5431941/5958455\">Don't use <code>!feof()</code> for loop condition</a></li>\n</ul>\n\n<p>And it seems you're missing <code>#include &lt;stdlib.h&gt;</code>. You should have received a warning from your compiler for missing declaration for <code>malloc()</code>.</p>\n\n<p>After fixing the missing header, I can't reproduce your problem. I created a <code>Book.txt</code> and the program works perfectly fine.</p>\n\n<p>This is my <code>Books.txt</code> for testing.</p>\n\n<pre><code>aaa aaa aaa aaa\naaa aaa aaa aaa\naaa aaa aaa aaa\naaa aaa aaa aaa\naaa aaa aaa aaa\n</code></pre>\n\n<p>My input used for testing:</p>\n\n<pre><code>aaa aaa aaa aaa\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1515001940, "post_id": 48079215, "comment_id": 83139616, "body": "I think that&#39;s it (although using <code>malloc()</code> with cast and without the proper includes is another good candidate)"}], "tags": [], "owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "is_accepted": true, "score": 1, "last_activity_date": 1514989290, "creation_date": 1514989290, "answer_id": 48079215, "question_id": 48076991, "link": "https://stackoverflow.com/questions/48076991/crash-while-working-with-files-and-linked-lists/48079215#48079215", "title": "Crash while working with files and linked lists", "body": "<p>To add to the answers given above, one more change worth noting is <code>ite-&gt;next = (NODE*)malloc(sizeof(NODE*));</code> which should be <code>ite-&gt;next = malloc(sizeof(NODE));</code>\nYou have just done malloc for the size of the pointer <code>NODE*</code> but you need to malloc for the size of the <code>NODE</code></p>\n"}], "owner": {"reputation": 33, "user_id": 8349760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f570921ba231000772365eb6848ad83?s=128&d=identicon&r=PG&f=1", "display_name": "mohammad mozafari", "link": "https://stackoverflow.com/users/8349760/mohammad-mozafari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48079215, "answer_count": 2, "score": 3, "last_activity_date": 1514989290, "creation_date": 1514980905, "last_edit_date": 1514983458, "question_id": 48076991, "link": "https://stackoverflow.com/questions/48076991/crash-while-working-with-files-and-linked-lists", "title": "Crash while working with files and linked lists", "body": "<p>I'm writing a program that takes info from a file and adds it to a linked list then and a function that adds info to the linked list. My problem is that when I call <code>addContact()</code> after <code>openBook()</code> the program crashes, but calling each of them separately works fine.</p>\n\n<p>I can't find the problem.</p>\n\n<p><code>openBook()</code> : opens a file, reads data from file to a linkedList<br>\n<code>addContact()</code> : takes info, saves data to linkedList  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct node {\n    char name[50];\n    char email[50];\n    char ad[200];\n    char phone[11];\n    struct node *next;\n} NODE;\n\nNODE *head = NULL;\n\nvoid openBook()\n{\n    FILE *read = fopen(\"Book.txt\", \"r\");\n\n    if (read == NULL)\n    {\n        return;\n    }\n    NODE *ite = NULL;\n    char name[50] = \"\", email[50] = \"\", ad[200] = \"\", phone[11] = \"\";\n\n    if (!feof(read))\n    {\n        head = (NODE*)malloc(sizeof(NODE));\n        fscanf(read, \"%s%s%s%s\", head-&gt;name, head-&gt;email, head-&gt;ad, head-&gt;phone);\n    }\n    ite = head;\n    while (!feof(read))\n    {\n        ite-&gt;next = (NODE*)malloc(sizeof(NODE));\n        ite = ite-&gt;next;\n        fscanf(read, \"%s%s%s%s\", ite-&gt;name, ite-&gt;email, ite-&gt;ad, ite-&gt;phone);\n    }\n    ite-&gt;next = NULL;\n    fclose(read);\n}\n\nvoid addContact()\n{\n    NODE *ite = head;\n    if (head != NULL)\n    {\n        while (ite-&gt;next!=NULL)\n            ite = ite-&gt;next;\n        ite-&gt;next = (NODE*)malloc(sizeof(NODE*));\n        ite = ite-&gt;next;\n    }\n    else\n    {\n        head = (NODE*)malloc(sizeof(NODE*));\n        ite = head;\n    }\n    fflush(stdin);\n    printf(\"Enter name (no space): \");\n    scanf(\"%s\", ite-&gt;name);\n    fflush(stdin);\n    printf(\"Enter email : \");\n    scanf(\"%s\", ite-&gt;email);\n    fflush(stdin);\n    printf(\"Enter address : \");\n    scanf(\"%s\", ite-&gt;ad);\n    fflush(stdin);\n    printf(\"Enter phone : \");\n    scanf(\"%s\", ite-&gt;phone);\n    fflush(stdin);\n    ite-&gt;next = NULL;\n}\n\nvoid printList()\n{\n    NODE *iterator;\n    int i;\n    iterator = head;\n    while (iterator != NULL)\n    {\n        printf(\"%s\\n\", iterator-&gt;name);\n        iterator = iterator-&gt;next;\n    }\n}\n\nint main()\n{\n    openBook();\n    addContact();\n    printList();\n    return 0;\n}\n</code></pre>\n\n<p>It's amazing the following works :</p>\n\n<pre><code>int main()\n{\n    addContact();\n    printList();\n    return 0;\n}\n</code></pre>\n\n<p>but the following crashes :</p>\n\n<pre><code>int main()\n{\n    FILE *read = fopen(\"Book.txt\", \"r\");\n    fclose(read);\n    addContact();\n    printList();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "graphics"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 4, "creation_date": 1514979417, "post_id": 48076571, "comment_id": 83126839, "body": "It&#39;s very hard to tell what you&#39;re trying to do and what it wrong. Please include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1514979487, "post_id": 48076571, "comment_id": 83126884, "body": "And you should copy and paste error messages exactly."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1514979490, "post_id": 48076571, "comment_id": 83126886, "body": "Turbo C is ancient history by now. So is the <code>&quot;graphics.h&quot;</code> header file and the library. What you learn from using them will have no (or very little) practical bearing on your life later as a programmer."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1514979765, "post_id": 48076571, "comment_id": 83127027, "body": "Turbo C was discontinued ages ago. Do yourself a favor and use something else."}, {"owner": {"reputation": 60876, "user_id": 2060725, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WUKmO.png?s=128&g=1", "display_name": "nvoigt", "link": "https://stackoverflow.com/users/2060725/nvoigt"}, "edited": false, "score": 3, "creation_date": 1514979797, "post_id": 48076571, "comment_id": 83127041, "body": "I have colleagues that are younger than that compiler. Please get a book or teacher that teaches this centuries&#39; programming."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1514980074, "post_id": 48076571, "comment_id": 83127173, "body": "&quot;<i>I uploaded the picture of error on turbo C</i>&quot; <b>Don&#39;t</b> post pictures of errors: <b>copy-paste</b> them."}, {"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1514980103, "post_id": 48076571, "comment_id": 83127186, "body": "@Klutt turbo C discontinued but no IDE supporting graphics. h header file and to manually include it"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 2, "creation_date": 1514980205, "post_id": 48076571, "comment_id": 83127240, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37322352/bgi-in-computer-graphics\">BGI in computer graphics</a>"}, {"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1514980496, "post_id": 48076571, "comment_id": 83127409, "body": "@david I seen that but still getting error and now saying divide error"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1514980790, "post_id": 48076571, "comment_id": 83127578, "body": "@kd vote retracted and possible answer posted."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514980345, "post_id": 48076793, "comment_id": 83127317, "body": "Still getting error of &quot;divide error&quot;"}, {"owner": {"reputation": 438, "user_id": 6024572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa06a94c677c04a72eceba9db3c10d0?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Singh", "link": "https://stackoverflow.com/users/6024572/gaurav-singh"}, "reply_to_user": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514980526, "post_id": 48076793, "comment_id": 83127432, "body": "Made sure that C:\\TURBOC3\\BGI is the address of EGAVGA.BGI file ?"}, {"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514980696, "post_id": 48076793, "comment_id": 83127530, "body": "Yes sure there contains EGAVGA.BGI file at that address"}], "tags": [], "owner": {"reputation": 438, "user_id": 6024572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa06a94c677c04a72eceba9db3c10d0?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Singh", "link": "https://stackoverflow.com/users/6024572/gaurav-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1514980117, "creation_date": 1514980117, "answer_id": 48076793, "question_id": 48076571, "link": "https://stackoverflow.com/questions/48076571/graphics-in-c-and-c/48076793#48076793", "title": "graphics in c and c++", "body": "<p>The path string should be \"C:\\\\TURBOC3\\\\BGI\" (note the double backslashes instead of single backslashes)<br>\nI hope this solves the problem. I can't see any other error in code. </p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "edited": false, "score": 0, "creation_date": 1514981099, "post_id": 48076955, "comment_id": 83127738, "body": "Thanks it works now"}], "tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": true, "score": 1, "last_activity_date": 1514997597, "last_edit_date": 1514997597, "creation_date": 1514980762, "answer_id": 48076955, "question_id": 48076571, "link": "https://stackoverflow.com/questions/48076571/graphics-in-c-and-c/48076955#48076955", "title": "graphics in c and c++", "body": "<p>In addition to the backslash issue in the path, it's <em>extremely</em> unlikely that you are using a 3270 compatible display.  Why don't you pass in the address of <code>a</code> with <code>a=0</code>.  <code>ab</code> must be set to a requested mode unless you set the driver to <code>autodetect</code>, which will then select the highest available mode.  See <a href=\"https://www.cs.colorado.edu/~main/bgi/doc/initgraph.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 61, "user_id": 9123942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ad63f6647147a3fd91e695c19385da?s=128&d=identicon&r=PG&f=1", "display_name": "KD.", "link": "https://stackoverflow.com/users/9123942/kd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "closed_date": 1514984470, "accepted_answer_id": 48076955, "answer_count": 2, "score": -6, "last_activity_date": 1514997597, "creation_date": 1514979315, "last_edit_date": 1514980954, "question_id": 48076571, "link": "https://stackoverflow.com/questions/48076571/graphics-in-c-and-c", "closed_reason": "Needs details or clarity", "title": "graphics in c and c++", "body": "<p>In turbo c 3.2 I am getting   </p>\n\n<blockquote>\n  <p>Divide error</p>\n</blockquote>\n\n<p>and in code blocks IDE I getting error that </p>\n\n<blockquote>\n  <p>initgraph() and closegraph() are refrence at compile time. (I added graphics header and library file in folder of codeblocks).Please give me solution?</p>\n</blockquote>\n\n<p>the code i written is</p>\n\n<pre><code>#include&lt;graphics.h&gt;\nint main()\n{\n   int a=10,ab;\n   initgraph(&amp;a,&amp;ab,\"C:\\\\TURBOC3\\\\BGI\");\n   circle(100,200,20);\n   closegraph();\n   return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "unix", "shared-memory"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1514979168, "post_id": 48076516, "comment_id": 83126692, "body": "You should probably learn how to use header files and separate compilation for common structures and functions. And also do some research about <i>emulating pass by reference in C</i>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1514981382, "post_id": 48076516, "comment_id": 83127897, "body": "<code>updatef(addr[i], p);</code> --&gt;&gt; <code>addr[i] = p;</code> would be a start"}], "answers": [{"tags": [], "owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "is_accepted": true, "score": 0, "last_activity_date": 1514984184, "last_edit_date": 1514984184, "creation_date": 1514983274, "answer_id": 48077637, "question_id": 48076516, "link": "https://stackoverflow.com/questions/48076516/updating-shared-memory-by-different-process/48077637#48077637", "title": "Updating shared memory by different process", "body": "<p>Short answer is of course passing pointer instead of value and that'll do</p>\n\n<pre><code>updatef(&amp;arr[i], p);\n</code></pre>\n\n<p>Long answer lies in pass by value and pass by reference, when <code>updatef</code> is called with <code>addr[i]</code> as in </p>\n\n<pre><code>updatef(arr[i], p);\n</code></pre>\n\n<p>essentially the value is copied to calling function and never gets reflected to attached pointer viz <code>addr</code> as a result the original <code>addr</code> pointer get unchanged  on the other hand when we pass the address like</p>\n\n<pre><code>updatef(&amp;addr[i], p); \n//or\nupdatef(addr+i, p);\n</code></pre>\n\n<p>reference is passed which inturn will update the contents pointed to by <code>addr+i</code> pointer</p>\n\n<p>to add on IMO splitting the code will make this more presentable and readable and maintainable and bla bla bla here is a bit </p>\n\n<p>File 1 - <code>s.h</code>, keep shared and global data here</p>\n\n<pre><code>#ifndef S_H_INCLUDED\n#define S_H_INCLUDED\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/signal.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n\n#define mykey 100\n#define maxname 100\n#define shmsz 5\n#define perms 0666\n\nstruct pdata{\n    pid_t ppid;\n    char ptype;\n    char pname[maxname];\n    unsigned long pgenome; };\n\n\n\n#endif\n</code></pre>\n\n<p><code>t.c</code></p>\n\n<pre><code>#include \"s.h\" // include global header here\n\nint main(){\n    int shmid;\n    struct pdata *addr;\n\n    shmid = shmget(mykey, sizeof(struct pdata) * shmsz, IPC_CREAT | perms);\n    addr = (struct pdata*) shmat(shmid, NULL, 0);\n    for(int i=0; i&lt;shmsz; i++){\n        addr[i].ppid = -1;\n    }\n    switch(fork()){\n        case 0:\n            {\n            char *args[] = {\"u\", NULL};\n            execve(\"u\", args, NULL);\n            }\n            break;\n    }\n    sleep(2);\n    for(int i=0; i&lt;shmsz; i++){\n        printf(\"%d %c %s %lu\\n\", addr[i].ppid, addr[i].ptype, addr[i].pname,    addr[i].pgenome);\n    }\n    shmdt(addr);\n    shmctl(shmid, IPC_RMID, 0);\n\n    return 0;\n    }\n</code></pre>\n\n<p><code>u.c</code></p>\n\n<pre><code>#include \"s.h\" // common included here\n\nstatic void updatef(struct pdata *a, struct pdata p){\n    a-&gt;ppid = p.ppid;\n    a-&gt;ptype = p.ptype;\n    strcpy(a-&gt;pname, p.pname);\n    a-&gt;pgenome = p.pgenome;\n}\n\nint main(){\n    int shmid;\n    struct pdata *addr;\n    struct pdata p;\n    shmid = shmget(mykey, sizeof(struct pdata) * shmsz, perms);\n    addr = (struct pdata*) shmat(shmid, NULL, 0);\n    p.ppid = getpid();\n    p.ptype = 'A';\n    strncpy(p.pname, \"PIPPO\", maxname);\n    p.pgenome = 10;\n\n    for(int i=0; i&lt;shmsz; i++){\n        updatef(addr+i, p);\n    }\n\n    shmdt(addr);\n    return 0;\n}\n</code></pre>\n\n<p>and the final build step</p>\n\n<pre><code>gcc t.c -o t\ngcc u.c -o u\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9151304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd639e8cc7d49b1bce546e9dddf1b489?s=128&d=identicon&r=PG&f=1", "display_name": "Stewe", "link": "https://stackoverflow.com/users/9151304/stewe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "accepted_answer_id": 48077637, "answer_count": 1, "score": 1, "last_activity_date": 1514984317, "creation_date": 1514979084, "last_edit_date": 1514984317, "question_id": 48076516, "link": "https://stackoverflow.com/questions/48076516/updating-shared-memory-by-different-process", "title": "Updating shared memory by different process", "body": "<p>I'm writing some code for a project and I have an issue when I try to update an area of shared memory with another process.\nBasically one process create a shared memory, then it creates one child that, using execve, execute a process the aim of which is to update that shared memory knowing its key.\nAt the end the main process prints all the datas from the shm to stdout.</p>\n\n<p>At that point I have noticed that shm has not been updated. \nI can't understand why. I've tried with regular assignment (<code>=</code>) or assigning every field with a function (<code>updatef</code>), but it doesn't work.\n(Of course in the real program I used semaphores to regulate the access to shm, i wrote this code to minimize the code to see the problem)</p>\n\n<p>Process t:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/signal.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n\n#define mykey 100\n#define maxname 100\n#define shmsz 5\n#define perms 0666\n\nstruct pdata{\n    pid_t ppid;\n    char ptype;\n    char pname[maxname];\n    unsigned long pgenome;\n};\n\nvoid updatef(struct pdata a, struct pdata p){\n    a.ppid = p.ppid;\n    a.ptype = p.ptype;\n    strcpy(a.pname, p.pname);\n    a.pgenome = p.pgenome;\n}\n\nint main(){\n    int shmid;\n    struct pdata *addr;\n\n    shmid = shmget(mykey, sizeof(struct pdata) * shmsz, IPC_CREAT | perms);\n    addr = (struct pdata*) shmat(shmid, NULL, 0);\n    for(int i=0; i&lt;shmsz; i++){\n        addr[i].ppid = -1;\n    }\n    switch(fork()){\n        case 0:\n            {\n            char *args[] = {\"u\", NULL};\n            execve(\"u\", args, NULL);\n            }\n            break;\n    }\n    sleep(2);\n    for(int i=0; i&lt;shmsz; i++){\n        printf(\"%d %c %s %lu\\n\", addr[i].ppid, addr[i].ptype, addr[i].pname,    addr[i].pgenome);\n    }\n    shmdt(addr);\n    shmctl(shmid, IPC_RMID, 0);\n\n    return 0;\n    }\n</code></pre>\n\n<p>Process u:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/signal.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n\n#define mykey 100\n#define maxname 100\n#define shmsz 5\n#define perms 0666\n\nstruct pdata{\n   pid_t ppid;\n   char ptype;\n   char pname[maxname];\n   unsigned long pgenome;\n};\n\nvoid updatef(struct pdata a, struct pdata p){\n    a.ppid = p.ppid;\n    a.ptype = p.ptype;\n    strcpy(a.pname, p.pname);\n    a.pgenome = p.pgenome;\n}\n\nint main(){\n    int shmid;\n    struct pdata *addr;\n    struct pdata p;\n    shmid = shmget(mykey, sizeof(struct pdata) * shmsz, perms);\n    addr = (struct pdata*) shmat(shmid, NULL, 0);\n    p.ppid = getpid();\n    p.ptype = 'A';\n    strncpy(p.pname, \"PIPPO\", maxname);\n    p.pgenome = 10;\n\n    for(int i=0; i&lt;shmsz; i++){\n        updatef(addr[i], p);\n    }\n\n    shmdt(addr);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "core", "argc"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1515036623, "post_id": 48076335, "comment_id": 83151294, "body": "I make a dream that one day people will not learn programmation by starting with C. Hint: index start by 0 in C."}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515036737, "post_id": 48088272, "comment_id": 83151319, "body": "One would declare Min and Max only when needed."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1515037742, "post_id": 48088272, "comment_id": 83151474, "body": "@Stargateur: I was following the OP&#39;s existing style of declaring all (well, most) variables at the top of the block, rather than point of first use. C99 and later are fine with either, but I figured I&#39;d avoid messing with their existing code organization further; some people just really like grouping their declarations. :-)"}, {"owner": {"reputation": 3, "user_id": 8421805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OMI3NWAhD94/AAAAAAAAAAI/AAAAAAAAABs/0AOnff2sCEY/photo.jpg?sz=128", "display_name": "\uff33\uff59\uff55\uff55\u30d0\u30ab", "link": "https://stackoverflow.com/users/8421805/%ef%bc%b3%ef%bd%99%ef%bd%95%ef%bd%95%e3%83%90%e3%82%ab"}, "edited": false, "score": 0, "creation_date": 1515046476, "post_id": 48088272, "comment_id": 83153711, "body": "@ShadowRanger: Thanks man for the answer, really appreciate it :D @ Stargateur: I&#39;m sorry man. Im just a student. Dont be too hard on me just because I&#39;m a beginner at this. Even I hope to improve. But I will take note of what you guys said!  Thanks again :D"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 1, "last_activity_date": 1515036639, "creation_date": 1515036639, "answer_id": 48088272, "question_id": 48076335, "link": "https://stackoverflow.com/questions/48076335/argc-not-working-for-my-c-prog/48088272#48088272", "title": "Argc not working for my C Prog", "body": "<p>You used <code>argv[2]</code> and <code>argv[3]</code> before checking if they even existed. Change:</p>\n\n<pre><code>int Min=atoi(argv[2]);\nint Max=atoi(argv[3]);\n\nif(Min&gt;Max || argc!=4){\n    DisplayHelp();\n}\n</code></pre>\n\n<p>to something like:</p>\n\n<pre><code>int Min, Max;\n\nif (argc != 4) DisplayHelp();\n\nMin = atoi(argv[2]);\nMax = atoi(argv[3]);\n\nif (Min &gt; Max) DisplayHelp();\n</code></pre>\n\n<p>so you don't access elements of <code>argv</code> before you've verified they exist.</p>\n"}], "owner": {"reputation": 3, "user_id": 8421805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OMI3NWAhD94/AAAAAAAAAAI/AAAAAAAAABs/0AOnff2sCEY/photo.jpg?sz=128", "display_name": "\uff33\uff59\uff55\uff55\u30d0\u30ab", "link": "https://stackoverflow.com/users/8421805/%ef%bc%b3%ef%bd%99%ef%bd%95%ef%bd%95%e3%83%90%e3%82%ab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 48088272, "answer_count": 1, "score": -1, "last_activity_date": 1515036639, "creation_date": 1514978378, "last_edit_date": 1515036304, "question_id": 48076335, "link": "https://stackoverflow.com/questions/48076335/argc-not-working-for-my-c-prog", "title": "Argc not working for my C Prog", "body": "<p><a href=\"https://i.stack.imgur.com/uAkwR.png\" rel=\"nofollow noreferrer\">I get Core Dumped when I'm having 3 arg. Please help!</a></p>\n\n<p>I am writing a program to encrypt words. The thing is, the program works fine but when i put in 2/3 arg instead of 4, I'll get core dumped. Please help me.\nBelow, I have included the code. Above (First time using this platform, so idk if its really above) is the picture of the error. Thanks for all the help!</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;crypt.h&gt;\n#include &lt;time.h&gt;\n\nint DisplayHelp(){ \n    printf(\"Usage :./task1 &lt;wordlist&gt; &lt;min&gt; &lt;max&gt;\\n\");\n    printf(\"\\t&lt;wordlist&gt; : A file path/name in which contains the password dictionary \\n\");\n    printf(\"\\t&lt;min&gt; : An integer value greater than 1.\\n\");\n    printf(\"\\t\\tThis value represents the minimum length of the password\\n\");\n    printf(\"\\t&lt;max&gt; : An integer value greater than or equal to &lt;min&gt;.\\n\");\n    printf(\"\\t\\t&lt;max&gt; represents the maximum length of the password.\\n\");\n    exit(1);\n}\n\nint main(int argc, char * argv[] ){ \n    char * type1=\"$1$\";\n    char * type6=\"$6$\";\n    char * salt=\"$\";\n    char * mdresult;\n    char encyption_scheme[20];\n    FILE * fp;\n    FILE * fp1;\n    char input1 [50];\n    int length; \n    int line=0;\n    int line2=0;\n    int Min=atoi(argv[2]);\n    int Max=atoi(argv[3]);\n\n        if(Min&gt;Max || argc!=4){\n            DisplayHelp();\n        }\n\n            fp = fopen(argv[1],\"r\"); //Reading of file\n\n            if(fp == NULL){\n                printf(\"Fatal error! %s file not found\\n\",argv[1]);\n                printf(\"Program halted. Please verify the file path and try again.\\n\");\n                exit(1);\n            }\n            fclose(fp);\n\n            time_t current_time = time(NULL); \n            struct tm *tm = localtime(&amp;current_time);\n\n            printf(\"Program Started At %s\\n\", asctime(tm));\n\n                fp=fopen(argv[1],\"r\");\n            while(fgets(input1,50,fp)){\n                //line++; //Line +1\n                length=strlen(input1)-1;\n                input1[strlen(input1)-1]='\\0';\n\n\n                if(length &gt;= Min &amp;&amp; length &lt;= Max){ \n                line++;\n                strcpy(encyption_scheme,type1); \n                strcat(encyption_scheme,salt);\n                mdresult = crypt(input1,encyption_scheme);\n                line2++;\n\n                strcpy(encyption_scheme,type6); \n                strcat(encyption_scheme,salt);\n                sharesult = crypt(input1,encyption_scheme);\n                line2++;\n\n                fp1=fopen(\"Filename.txt\",\"a\");\n                if (fp1==NULL)\n                    exit(-1);\n                fprintf(fp1, \"%s:%s\\n\", input1, mdresult);\n                fprintf(fp1, \"%s:%s\\n\", input1, sharesult);\n                fclose(fp1);\n                }\n\n            }\n\n            printf(\"Total number of words processed     =&gt; %d\\n\", line);\n            printf(\"Total number of generated entries   =&gt; %d\\n\", line2);\n\n            fclose(fp);\n\n            current_time = time(NULL);\n            tm = localtime(&amp;current_time);\n            printf(\"\\n\");\n            printf(\"Program Ended At %s\\n\", asctime(tm)); //Add time\n\n        }\n</code></pre>\n"}, {"tags": ["c", "string", "strtok"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 4, "creation_date": 1514978045, "post_id": 48076183, "comment_id": 83126089, "body": "<code>if(i=2)</code> should be <code>if(i==2)</code>. Voting to close as a typo."}, {"owner": {"reputation": 13, "user_id": 9144849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195ac28a919da2f908c188f5f545a815?s=128&d=identicon&r=PG&f=1", "display_name": "JonP", "link": "https://stackoverflow.com/users/9144849/jonp"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1514978140, "post_id": 48076183, "comment_id": 83126136, "body": "Oh my goodness ! I should have noticed. Thank you for your help ! I&#39;ll be sure to practise due diligence in the future. Sorry for wasting your time"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1514978175, "post_id": 48076183, "comment_id": 83126145, "body": "You are welcome! If your program works now, please click [delete] link."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1514979025, "post_id": 48076183, "comment_id": 83126608, "body": "If you turned on compiler warnings it would have warned you about the line causing the problem."}, {"owner": {"reputation": 305, "user_id": 1118367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1c5a15a9c878311a33a52fad0a9f84?s=128&d=identicon&r=PG", "display_name": "amasmiller", "link": "https://stackoverflow.com/users/1118367/amasmiller"}, "edited": false, "score": 0, "creation_date": 1514986320, "post_id": 48076183, "comment_id": 83130645, "body": "Consider using <code>if (2 == i)</code> to prevent such an error."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1514978281, "creation_date": 1514978281, "answer_id": 48076309, "question_id": 48076183, "link": "https://stackoverflow.com/questions/48076183/extracting-text-from-char-in-c/48076309#48076309", "title": "Extracting text from char in C", "body": "<p>Initialize the variable <code>i</code> with 0 and use comparison instead of assignment in this condition</p>\n\n<pre><code>int i = 0;\n//...\nif(i == 2){//\n</code></pre>\n\n<p>Take into account that the first call of <code>strcpy</code> is redundant.</p>\n\n<p>In fact you could do the same without a loop.  For example</p>\n\n<pre><code>char a[100] = \"Alex:HeyGoodMorning!:1911hrs:0:1012:2017:::\";\nchar *p;\n\nif ((p = strtok(a, \":\")) &amp;&amp; (p = strtok(NULL, \":\")))\n{\n    puts(p);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9144849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195ac28a919da2f908c188f5f545a815?s=128&d=identicon&r=PG&f=1", "display_name": "JonP", "link": "https://stackoverflow.com/users/9144849/jonp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1514980562, "accepted_answer_id": 48076309, "answer_count": 1, "score": 1, "last_activity_date": 1514981403, "creation_date": 1514977832, "last_edit_date": 1514981403, "question_id": 48076183, "link": "https://stackoverflow.com/questions/48076183/extracting-text-from-char-in-c", "closed_reason": "Not suitable for this site", "title": "Extracting text from char in C", "body": "<p>I am a beginner C-programmer. Recently I've been trying to practise using string functions in C.</p>\n\n<p>As such, I wrote the following program:</p>\n\n<p>MessageDetector.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) \n{\n    char a[100] = \"Alex:HeyGoodMorning!:1911hrs:0:1012:2017:::\";\n    char *p = strtok(a,\":\");\n    char n[20];\n\n    int i = 1;\n\n    while(p != NULL) {\n        strcpy(n,p);\n        p = strtok(NULL,\":\"); //limit to characters before semi-colon\n        i++;\n\n        if (i = 2) { //after 2 occurrences of the semi-colon. print a string\n            printf(\"%s\\n\",n);\n            break;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The output of my program is as follows:</p>\n\n<pre><code>Alex\n</code></pre>\n\n<p>However, I would like the program to output</p>\n\n<pre><code>HeyGoodMorning!\n</code></pre>\n\n<p>What are the changes I should make to the above program? Your help is greatfully appreciated</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 3, "creation_date": 1514976394, "post_id": 48075793, "comment_id": 83125189, "body": "There is no direct conversion. You will have to write code for this."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1514976426, "post_id": 48075793, "comment_id": 83125214, "body": "what if <code>p &gt; 99999999</code>?"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1514976717, "post_id": 48075793, "comment_id": 83125372, "body": "An idea (extremely inefficient) would be to convert the number to string, then split the string into 4 (string) parts, and then convert back each part."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 0, "creation_date": 1514976822, "post_id": 48075793, "comment_id": 83125437, "body": "first convert <code>int</code> to <code>string</code> and then parse it as per your req. <a href=\"https://stackoverflow.com/questions/8257714/how-to-convert-an-int-to-string-in-c\" title=\"how to convert an int to string in c\">stackoverflow.com/questions/8257714/&hellip;</a>"}, {"owner": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "edited": false, "score": 0, "creation_date": 1514977185, "post_id": 48075793, "comment_id": 83125632, "body": "&quot;I would like to convert an int to a char[4] where each byte in the char[4] contains a decimal value of 2&quot;  char k[4] = {2,2,2,2}; ??  Please can you clarify what you mean?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514992155, "post_id": 48075793, "comment_id": 83134048, "body": "What should happen with negative values like <code>int p = -2999999;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2082, "user_id": 205874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665b5f11dfc1fa01685d95dbee607d7b?s=128&d=identicon&r=PG", "display_name": "Mischa", "link": "https://stackoverflow.com/users/205874/mischa"}, "reply_to_user": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 0, "creation_date": 1514976929, "post_id": 48075885, "comment_id": 83125499, "body": "Could you be specific?"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514977409, "post_id": 48075885, "comment_id": 83125738, "body": "Considering <code>int k[5];</code> (one extra (last) element), this does the trick (after all the corrections). +1."}, {"owner": {"reputation": 2082, "user_id": 205874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665b5f11dfc1fa01685d95dbee607d7b?s=128&d=identicon&r=PG", "display_name": "Mischa", "link": "https://stackoverflow.com/users/205874/mischa"}, "edited": false, "score": 0, "creation_date": 1514977487, "post_id": 48075885, "comment_id": 83125786, "body": "Sorry; typed on phone. The syntax is otherwise fine. Does not handle p &lt; 0. Does not handle p &gt; 99999999. Does not declare (i). Is that your problem?"}], "tags": [], "owner": {"reputation": 2082, "user_id": 205874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665b5f11dfc1fa01685d95dbee607d7b?s=128&d=identicon&r=PG", "display_name": "Mischa", "link": "https://stackoverflow.com/users/205874/mischa"}, "is_accepted": false, "score": 1, "last_activity_date": 1514977277, "last_edit_date": 1514977277, "creation_date": 1514976625, "answer_id": 48075885, "question_id": 48075793, "link": "https://stackoverflow.com/questions/48075793/convert-int-to-bytes-array-in-c/48075885#48075885", "title": "Convert int to bytes array in c", "body": "<p>for (i =4; i--; k[i] = p % 100, p /= 100);</p>\n"}, {"comments": [{"owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "reply_to_user": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "edited": false, "score": 0, "creation_date": 1514977195, "post_id": 48075999, "comment_id": 83125635, "body": "I&#39;ve changed looping order. Is there anything else?"}, {"owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "reply_to_user": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "edited": false, "score": 0, "creation_date": 1514977418, "post_id": 48075999, "comment_id": 83125746, "body": "Oh, yes. I&#39;ve included them in my test code but not here. Thanks for pointing out"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1514983973, "post_id": 48075999, "comment_id": 83129321, "body": "It&#39;s not a strange operation at all. This is representation is called <a href=\"https://en.m.wikipedia.org/wiki/Binary-coded_decimal\" rel=\"nofollow noreferrer\">&quot;Binary Coded Decimal&quot;</a>."}, {"owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "edited": false, "score": 0, "creation_date": 1514984015, "post_id": 48075999, "comment_id": 83129354, "body": "I haven&#39;t though about this. OK. makes sense."}], "tags": [], "owner": {"reputation": 3334, "user_id": 4765864, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2M2eC.jpg?s=128&g=1", "display_name": "gonczor", "link": "https://stackoverflow.com/users/4765864/gonczor"}, "is_accepted": true, "score": 5, "last_activity_date": 1514977287, "last_edit_date": 1514977287, "creation_date": 1514977058, "answer_id": 48075999, "question_id": 48075793, "link": "https://stackoverflow.com/questions/48075793/convert-int-to-bytes-array-in-c/48075999#48075999", "title": "Convert int to bytes array in c", "body": "<p>It's strange problem for me but OK. here's what I would have done:</p>\n\n<ol>\n<li>Copy value of <code>p</code> so that it can be used later (I assume that this conversion doesn't intend to change its value).</li>\n<li>Use modulo operation to get 2 last digits</li>\n<li>cut down the copy of <code>p</code> to be able to read next two digits.</li>\n</ol>\n\n<p>So complete answer is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int p = 2999999;\n    char k[4];\n    int p_copy = p;\n    int i;\n    for(i = 3; i &gt;=0; i--)\n    {\n            k[i] = p_copy % 100;\n            p_copy /= 100;\n    }\n    for(i = 0; i &lt; 4; i++)\n            printf(\"k[%d]: %d\\n\",i, k[i]);\n    return 0;\n}\n</code></pre>\n\n<p>And for sanity the output:</p>\n\n<pre><code>gonczor@wiktor-papu:~/tmp$ gcc test.c -o test\ngonczor@wiktor-papu:~/tmp$ ./test\nk[0]: 2\nk[1]: 99\nk[2]: 99\nk[3]: 99\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3212927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/554a520974d72a45b4b55ec986c11b3b?s=128&d=identicon&r=PG", "display_name": "Vis", "link": "https://stackoverflow.com/users/3212927/vis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 1, "accepted_answer_id": 48075999, "answer_count": 2, "score": -3, "last_activity_date": 1514977287, "creation_date": 1514976255, "question_id": 48075793, "link": "https://stackoverflow.com/questions/48075793/convert-int-to-bytes-array-in-c", "title": "Convert int to bytes array in c", "body": "<p>I would like to convert an <code>int</code> to a <code>char[4]</code> where each byte in the <code>char[4]</code> contains a decimal value of 2. So in the following example:</p>\n\n<pre><code>int p = 2999999;\n</code></pre>\n\n<p>Convert <code>p</code> to the array that is identical to <code>k</code> where <code>k</code> is constructed via:</p>\n\n<pre><code>char k[4];\nk[0] = 2;\nk[1] = 99;\nk[2] = 99;\nk[3] = 99;\n</code></pre>\n\n<p>How can I do this in C? </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1514972335, "post_id": 48074732, "comment_id": 83122942, "body": "Enable all warnings and read about <code>scanf</code>. I&#39;m surprised that it &quot;lets you enter the int&quot;."}, {"owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "edited": false, "score": 0, "creation_date": 1514972638, "post_id": 48074732, "comment_id": 83123116, "body": "<code>result</code> is of type <code>double</code>, but <code>coolfunction</code> expects a pointer to <code>int</code>."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1514973169, "post_id": 48074732, "comment_id": 83123430, "body": "<code>scanf(&quot;%d&quot;, n)</code> gives undefined behaviour since <code>n</code> is not an address of an <code>int</code>.   Use <code>scanf(&quot;%d&quot;, &amp;n)</code> instead."}, {"owner": {"reputation": 7, "user_id": 8898957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72996782b1d7f14d1bc427e9ec361c66?s=128&d=identicon&r=PG", "display_name": "Emirhan G.", "link": "https://stackoverflow.com/users/8898957/emirhan-g"}, "edited": false, "score": 0, "creation_date": 1514977491, "post_id": 48074732, "comment_id": 83125788, "body": "My question is not regarding the reason that &#39;&amp;&#39; had to be used in scanf, so I couldn&#39;t have know look for my answer in questions like &quot;Ampersand(&amp;) and scanf in C?&quot;"}, {"owner": {"reputation": 7, "user_id": 8898957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72996782b1d7f14d1bc427e9ec361c66?s=128&d=identicon&r=PG", "display_name": "Emirhan G.", "link": "https://stackoverflow.com/users/8898957/emirhan-g"}, "reply_to_user": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "edited": false, "score": 0, "creation_date": 1514978305, "post_id": 48074732, "comment_id": 83126236, "body": "@PatrickBucher Thank you /\\, I appreciate the find"}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1514973142, "post_id": 48074867, "comment_id": 83123409, "body": "You should check the return value from <code>scanf</code>"}, {"owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1514973776, "post_id": 48074867, "comment_id": 83123769, "body": "@EdHeal Good point, did so."}, {"owner": {"reputation": 7, "user_id": 8898957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72996782b1d7f14d1bc427e9ec361c66?s=128&d=identicon&r=PG", "display_name": "Emirhan G.", "link": "https://stackoverflow.com/users/8898957/emirhan-g"}, "edited": false, "score": 0, "creation_date": 1514978646, "post_id": 48074867, "comment_id": 83126423, "body": "Would you also happen to know WHY I can&#39;t make the function like <code>void coolfunction(int x, double &amp; y)</code> i.e. pass by reference? It works in C++ and it enables one to not deal with dereferencing pointers inside the function."}, {"owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "reply_to_user": {"reputation": 7, "user_id": 8898957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72996782b1d7f14d1bc427e9ec361c66?s=128&d=identicon&r=PG", "display_name": "Emirhan G.", "link": "https://stackoverflow.com/users/8898957/emirhan-g"}, "edited": false, "score": 0, "creation_date": 1514981379, "post_id": 48074867, "comment_id": 83127894, "body": "@EmirhanG. C doesn&#39;t have C++-style references. You either use pointers or or values."}], "tags": [], "owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "is_accepted": true, "score": 1, "last_activity_date": 1514973440, "last_edit_date": 1514973440, "creation_date": 1514972881, "answer_id": 48074867, "question_id": 48074732, "link": "https://stackoverflow.com/questions/48074732/why-do-i-get-a-segmentation-error-here-in-my-code/48074867#48074867", "title": "Why do I get a segmentation error here in my code?", "body": "<p>Here's a version using a double parameter:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nvoid coolfunction(int x, double *y)\n{\n    *y = exp(x);\n}\n\nint main()\n{\n    int n = 0, scanned = 0;\n    double result = 0;\n\n    printf(\"Enter an integer: \");\n    scanned = scanf(\"%d\", &amp;n);\n    if (scanned &lt; 1) {\n        fprintf(stderr, \"value entered not a valid integer\\n\");\n        exit(EXIT_FAILURE);\n    }\n    coolfunction(n, &amp;result);\n    printf(\"\\n e^%d = %g \\n\", n, result);\n    return 0;\n}\n</code></pre>\n\n<p>You also missed the <code>&amp;</code> in your <code>scanf</code> call: the function needs to know the address of your variable, not its value.</p>\n"}], "owner": {"reputation": 7, "user_id": 8898957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72996782b1d7f14d1bc427e9ec361c66?s=128&d=identicon&r=PG", "display_name": "Emirhan G.", "link": "https://stackoverflow.com/users/8898957/emirhan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1514973235, "accepted_answer_id": 48074867, "answer_count": 1, "score": -2, "last_activity_date": 1514980454, "creation_date": 1514972274, "last_edit_date": 1514980454, "question_id": 48074732, "link": "https://stackoverflow.com/questions/48074732/why-do-i-get-a-segmentation-error-here-in-my-code", "closed_reason": "Duplicate", "title": "Why do I get a segmentation error here in my code?", "body": "<p>It's an extremely simple code, when I run it, it lets me enter the int, but when I enter it, the program crashes. I tried putting a printf right after the scanf to check if the program reads the int correctly, it seems it doesn't. I can't output the integer that I input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid coolfunction(int x, int *y)\n{\n    *y = exp(x);\n}\n\nint main()\n{\n    int n;\n    double result = 0;\n\n    printf(\"Enter an integer: \");\n    scanf(\"%d\", n);\n\n    coolfunction(n, &amp;result);\n\n    printf(\"\\n e^%d = %lf \\n\", n, result);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "encryption", "rsa", "verify"], "owner": {"reputation": 11, "user_id": 6408976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a268eaa9a0952a9cd19b706c99a260?s=128&d=identicon&r=PG&f=1", "display_name": "xutao", "link": "https://stackoverflow.com/users/6408976/xutao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514971988, "creation_date": 1514971988, "question_id": 48074652, "link": "https://stackoverflow.com/questions/48074652/rsa-verification-failed-when-i-use-some-code-from-xlnx-uboot", "title": "RSA verification failed when I use some code from xlnx uboot", "body": "<p>I'm trying porting some code to do RSA verification. I googled ,and found some code in <a href=\"https://github.com/Xilinx/u-boot-xlnx/blob/master/lib/rsa/rsa-mod-exp.c\" rel=\"nofollow noreferrer\">xlnx u-boot</a> .<br>\nI put this rsa-mod-exp.c in my code and of course with some other .h files. My SOC is little endian ,so I use the little endian definitions.<br>\nAfter all above are done , I try to create a signature to verify my code. \nBefore that , I noticed that the u-boot rsa structure is different from openssl RSA structure. So to get the u-boot rsa structure , I need to install a tool called dumppublickey . I found one from <a href=\"https://github.com/tgalal/android-dumpkey\" rel=\"nofollow noreferrer\">here</a> and installed.  </p>\n\n<pre><code>OpenSSL RSA public key structure:\n\nstruct {\nBIGNUM *n; // public modulus\nBIGNUM *e; // public exponent\nBIGNUM *d; // private exponent\nBIGNUM *p; // secret prime factor\nBIGNUM *q; // secret prime factor\nBIGNUM *dmp1; // d mod (p-1)\nBIGNUM *dmq1; // d mod (q-1)\nBIGNUM *iqmp; // q^-1 mod p\n// ...\n};RSA\nU-boot RSA public key structure:\n\nstruct rsa_public_key {\nuint len; /* len of modulus[] in number of uint32_t */\nuint32_t n0inv; /* -1 / modulus[0] mod 2^32 */\nuint32_t modulus; / modulus as little endian array */\nuint32_t rr; / R^2 as little endian array */\nuint64_t exponent; /* public exponent */\n};\n</code></pre>\n\n<p>Now, every thing is ready beside a signature. Here is the step I create my signature.  </p>\n\n<pre><code>1. Create private key.It's a 2048 bit and the public exponent is three.  \nopenssl genpkey -algorithm RSA -out key.pem -pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:3  \n2. Create cert file.  \nopenssl req -new -x509 -key key.pem -out newcert.pem -days 3650  \n3. Get the U-boot structure public key.  \ndumppublickey  newcert.pem  \nI got :\n    {\n    64,    //lenth\n    0x63b40d47,   //n0inv\n    {2799858569,......,1105502226,1577608370,1150603850,3030884821},  // modules (N)\n    {909785043,.......,3050452165,3418434484,2529136815,837355943},      // r^2\n    3   //exponent\n    }  \n4. Sign my file using the private key.  \necho \"hello world\" &gt; a.txt  \nopenssl dgst -sign key.pem -sha256 -hex a.txt\nI got :\n    RSA-SHA256(a.txt)= 157eb60ad0c77427cd....6b02b5d331d610b27f32aaa0\n</code></pre>\n\n<p>I put key length, n0inv, modulus, rr, exponent and the signature in my code. Notice that modulus and rr I useu_int32 array like I showed above while signature I use a u_int8 array like below.</p>\n\n<pre><code>{0x15,0x7e.0xb6,0x0a,.......0xaa,0xa0}  \n</code></pre>\n\n<p>Here is what I think the rsa-mod-exp.c (function rsa_mod_exp_sw) will give me . I thought I will get the result of the sha256 hash value of file a.txt. Same as the result I did using openssl.  </p>\n\n<pre><code>openssl dgst -sha256 a.txt\n</code></pre>\n\n<p>However, I did't get this sha256 hash value . I got something strange.\nCould anyone point which part is wrong and how to correct it ?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 394233, "user_id": 50079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ud1xq.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/50079/jon"}, "edited": false, "score": 5, "creation_date": 1514972343, "post_id": 48074650, "comment_id": 83122947, "body": "\u039a\u03b1\u03bb\u03b7\u03bc\u03ad\u03c1\u03b1, welcome to SO! It&#39;s difficult to help with this question because there are things missing that are only obvious to you right now. It&#39;s impossible to say if the &quot;array is correct&quot; -- a data structure is not (in)correct in a vacuum. You don&#39;t show any relevant code, and you don&#39;t mention <i>how</i> you think it might be wrong or not. You need to a) scope down the question (it&#39;s too broad right now) and b) be <i>way</i> more precise and forthcoming with relevant information; you will get much better results asking if you do this. Cheers!"}, {"owner": {"reputation": 916, "user_id": 6763074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NkPGt4saSn4/AAAAAAAAAAI/AAAAAAAAABs/Orsm5ritSTs/photo.jpg?sz=128", "display_name": "Patrick Bucher", "link": "https://stackoverflow.com/users/6763074/patrick-bucher"}, "edited": false, "score": 0, "creation_date": 1514972712, "post_id": 48074650, "comment_id": 83123161, "body": "How about making an array of a struct containing all the individual fields?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1514973428, "post_id": 48074650, "comment_id": 83123590, "body": "<i>&quot;The program runs but probably has a logical problem.&quot;</i> What program? Where is the code? What problem? Why do you think that? I&#39;m voting to close this question as incomplete and vague. SO isn&#39;t a place that does your assignments for you; it can help with specific questions, but you have no such thing here. Also: <i>&quot;The last name must be unique.&quot;</i> =&gt; YAIT."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1514974635, "post_id": 48074650, "comment_id": 83124236, "body": "<i>&quot;but windows displays error!&quot;</i> Again, please read the Help Centre about how to ask a useful question. There is no point telling readers that you get an error without specifying <b>what</b> error: quote it in full. And again, include the full - but minimal - code in your question that readers can use to understand what you&#39;re doing and try it themselves. The Help Centre will show you what is expected, i.e. to create an MCVE."}, {"owner": {"reputation": 1, "user_id": 9167230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ba5ea7089f60785a929882364e7ff2?s=128&d=identicon&r=PG&f=1", "display_name": "\u0394\u0397\u039c\u039f\u039a\u03a1\u0391\u03a4\u0397\u03a3", "link": "https://stackoverflow.com/users/9167230/%ce%94%ce%97%ce%9c%ce%9f%ce%9a%ce%a1%ce%91%ce%a4%ce%97%ce%a3"}, "edited": false, "score": 0, "creation_date": 1514974757, "post_id": 48074650, "comment_id": 83124313, "body": "Sorry! I made edits.Thanks for helping!"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1514975078, "post_id": 48074650, "comment_id": 83124514, "body": "So now there&#39;s <b>no</b> code &amp; the Q is too broad; SO is not a code-writing service. Also, this is an awful assignment for a teacher to give, as it implies that strings, numbers (age), &amp; grades (which should probably be a number or enum) should all be stuffed in an array of <code>char*</code> (or worse, <code>void*</code>) &amp; so lose proper typing or require tedious &amp; dangerous acrobatics to get the right value from that degraded form. Why a teacher would tell you not to use <code>struct</code>, one of the key features of the language, in exchange for the mess that would result from this... is completely beyond me. Again, YAIT."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1514975621, "post_id": 48074650, "comment_id": 83124788, "body": "What is a <i>&quot;multivariable array&quot;</i>?"}, {"owner": {"reputation": 563, "user_id": 1412959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/75cf20c8950e0e3148db5c578b2ed762?s=128&d=identicon&r=PG", "display_name": "Bastien Durel", "link": "https://stackoverflow.com/users/1412959/bastien-durel"}, "edited": false, "score": 0, "creation_date": 1514977038, "post_id": 48074650, "comment_id": 83125556, "body": "you can use this kind of <a href=\"https://git.geekwu.org/snippets/1\" rel=\"nofollow noreferrer\">crappy code</a> ... but @Lanting answer is far better"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9167230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ba5ea7089f60785a929882364e7ff2?s=128&d=identicon&r=PG&f=1", "display_name": "\u0394\u0397\u039c\u039f\u039a\u03a1\u0391\u03a4\u0397\u03a3", "link": "https://stackoverflow.com/users/9167230/%ce%94%ce%97%ce%9c%ce%9f%ce%9a%ce%a1%ce%91%ce%a4%ce%97%ce%a3"}, "edited": false, "score": 0, "creation_date": 1514973597, "post_id": 48074921, "comment_id": 83123676, "body": "Thank you for answering but i must not use struct!!!"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 1, "user_id": 9167230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ba5ea7089f60785a929882364e7ff2?s=128&d=identicon&r=PG&f=1", "display_name": "\u0394\u0397\u039c\u039f\u039a\u03a1\u0391\u03a4\u0397\u03a3", "link": "https://stackoverflow.com/users/9167230/%ce%94%ce%97%ce%9c%ce%9f%ce%9a%ce%a1%ce%91%ce%a4%ce%97%ce%a3"}, "edited": false, "score": 3, "creation_date": 1514974667, "post_id": 48074921, "comment_id": 83124255, "body": "@\u0394\u0397\u039c\u039f\u039a\u03a1\u0391\u03a4\u0397\u03a3 Include such essential info in your question so people don&#39;t waste their time."}, {"owner": {"reputation": 1, "user_id": 9167230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ba5ea7089f60785a929882364e7ff2?s=128&d=identicon&r=PG&f=1", "display_name": "\u0394\u0397\u039c\u039f\u039a\u03a1\u0391\u03a4\u0397\u03a3", "link": "https://stackoverflow.com/users/9167230/%ce%94%ce%97%ce%9c%ce%9f%ce%9a%ce%a1%ce%91%ce%a4%ce%97%ce%a3"}, "edited": false, "score": 0, "creation_date": 1514974920, "post_id": 48074921, "comment_id": 83124413, "body": "edited. I am sorry I am new to this!"}], "tags": [], "owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "is_accepted": false, "score": 3, "last_activity_date": 1514973069, "creation_date": 1514973069, "answer_id": 48074921, "question_id": 48074650, "link": "https://stackoverflow.com/questions/48074650/how-to-make-a-multiple-variable-array-without-a-data-base-in-c/48074921#48074921", "title": "How to make a multiple variable array without a data base in c", "body": "<p><code>C</code> doesn't really have multidimensional arrays, but you can have arrays of arrays, arrays of pointers or arrays of structs.</p>\n\n<p>All elements in an array, however, have to be of the same type. So you cannot store a both a name (c string) and mark (integer or double) in the same array.</p>\n\n<p>The usual C approach is to create a structure containing all the fields, and store those in a single top level array:</p>\n\n<pre><code>typedef struct Student_ student;\nstruct Student_\n{\n  char firstName[20]; //make sure the names aren't longer than 19 chars (use strlcpy!!!), or use char* and malloc for the names!\n  char lastName[20];\n  double cppMark;\n  double javaMark;\n  double cMark;\n};\nStudent students[100];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9167230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ba5ea7089f60785a929882364e7ff2?s=128&d=identicon&r=PG&f=1", "display_name": "\u0394\u0397\u039c\u039f\u039a\u03a1\u0391\u03a4\u0397\u03a3", "link": "https://stackoverflow.com/users/9167230/%ce%94%ce%97%ce%9c%ce%9f%ce%9a%ce%a1%ce%91%ce%a4%ce%97%ce%a3"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1514975425, "answer_count": 1, "score": -7, "last_activity_date": 1514974655, "creation_date": 1514971985, "last_edit_date": 1514974655, "question_id": 48074650, "link": "https://stackoverflow.com/questions/48074650/how-to-make-a-multiple-variable-array-without-a-data-base-in-c", "closed_reason": "Needs details or clarity", "title": "How to make a multiple variable array without a data base in c", "body": "<p>I was given an assignment in my C class, which asks:</p>\n\n<blockquote>\n  <p>Create an array which will contain personal data of 100 students.</p>\n</blockquote>\n\n<p>Those data must be:</p>\n\n<ul>\n<li>last name</li>\n<li>name</li>\n<li>age</li>\n<li>grade in C language</li>\n<li>grade in Java</li>\n<li>grade in C++</li>\n</ul>\n\n<p>Note 1: Every student's data must be saved in a multi-dimensional array, in which every line of the array refers to a particular student and every array column refers to its corresponding data (last name, name, etc.)</p>\n\n<p>I was asked to do this without creating a database. </p>\n\n<p>Is there a way to create a multivariable array using pointers?(and not using struct)</p>\n"}, {"tags": ["c", "arrays", "ascii", "caesar-cipher"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1514971280, "post_id": 48074312, "comment_id": 83122412, "body": "Using <a href=\"http://en.cppreference.com/w/c/language/ascii\" rel=\"nofollow noreferrer\">ASCII</a> <code>&#39;H&#39;</code> (the first character in the input) is equal to <code>72</code>. <code>72 + 50 = 122</code>. That is larger than <code>90</code> (which is <code>&#39;Z&#39;</code>) so you do <code>122 - 90 + 65 - 1</code> which is equal to <code>96</code> and is indeed the character <code>&#39;`&#39;</code>. Your calculations are not correct. I suggest you experiment with <i>modulo</i> (the <code>%</code> operator) instead."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514972019, "post_id": 48074312, "comment_id": 83122792, "body": "In <code>if (shifting &gt; &#39;z&#39;)</code> try replacing if with while, likewise for capital letters."}, {"owner": {"reputation": 19, "user_id": 7049177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gjVn7.jpg?s=128&g=1", "display_name": "Donald Hoegerl", "link": "https://stackoverflow.com/users/7049177/donald-hoegerl"}, "edited": false, "score": 0, "creation_date": 1514973028, "post_id": 48074312, "comment_id": 83123336, "body": "I&#39;ve tried this:  &#39;shifiting = (shifting+z)%26;&#39; But It won&#39;t work.. only strange ascii-letters...."}, {"owner": {"reputation": 19, "user_id": 7049177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gjVn7.jpg?s=128&g=1", "display_name": "Donald Hoegerl", "link": "https://stackoverflow.com/users/7049177/donald-hoegerl"}, "edited": false, "score": 0, "creation_date": 1514973278, "post_id": 48074312, "comment_id": 83123494, "body": "Like n.m. said it was the if. I&#39;ve replaced it with while and now it works... strange... But thank you :)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514975489, "post_id": 48074312, "comment_id": 83124722, "body": "Now the real challenge is to undersrand and be able to explain why this works, and how to express this same thing with the modulus operator (obviously the way you have tried doesn&#39;t work but there&#39;s a better way)."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7049177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gjVn7.jpg?s=128&g=1", "display_name": "Donald Hoegerl", "link": "https://stackoverflow.com/users/7049177/donald-hoegerl"}, "edited": false, "score": 0, "creation_date": 1514974706, "post_id": 48075017, "comment_id": 83124285, "body": "For me the 2nd options seems better, that&#39;s the one I&#39;ve choosed.  Thanks for your help."}], "tags": [], "owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "is_accepted": true, "score": 2, "last_activity_date": 1514984128, "last_edit_date": 1514984128, "creation_date": 1514973423, "answer_id": 48075017, "question_id": 48074312, "link": "https://stackoverflow.com/questions/48074312/c-caesar-chiper-error-with-big-keys/48075017#48075017", "title": "C Caesar Chiper - error with big keys", "body": "<p>The source of your problem is here:</p>\n\n<pre><code>    if (shifting &gt; 'z') {\n        shifting = shifting - 'z' + 'a' - 1; // if go outside the ascii alphabeth this will be done\n    }\n</code></pre>\n\n<p>What's the length of the English alphabet? It's 26.</p>\n\n<p>If you give <code>z</code> greater than 26, a single decrement by the alphabet length does not suffice. You should either make sure <code>z</code> does not exceed the length of alphabet, of repeat decrementing until the result fits the alphabet range.</p>\n\n<p>Solution 1:</p>\n\n<pre><code>    int asciiAlphabetLength = 'z' - 'a' + 1;\n\n    printf(\"Type in the key/shifting of the letters:\\n\");\n    scanf(\"%d\", &amp;z);\n    z %= asciiAlphabetLength;\n</code></pre>\n\n<p>Solution 2:</p>\n\n<pre><code>    shifting += z;\n\n    while (shifting &gt; 'z') {\n        shifting -= asciiAlphabetLength; // while outside the ascii alphabeth reduce\n    }\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7049177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gjVn7.jpg?s=128&g=1", "display_name": "Donald Hoegerl", "link": "https://stackoverflow.com/users/7049177/donald-hoegerl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 2, "accepted_answer_id": 48075017, "answer_count": 1, "score": 0, "last_activity_date": 1514984128, "creation_date": 1514970739, "last_edit_date": 1514971595, "question_id": 48074312, "link": "https://stackoverflow.com/questions/48074312/c-caesar-chiper-error-with-big-keys", "title": "C Caesar Chiper - error with big keys", "body": "<p>I've searched the web quite long for a simple caesar chiper/encryption algorithm in C language.\nI found one but is wasn't perfect so I already changed the code.\nStill having problems, because a friend said that the programm should be able to handle big key's, too.\nFor example text \"Hello World\" with a Key: 50... And if I do that I get the following: (Console output)</p>\n\n<pre><code>This tiny application encodes plain text to the Caesar Encryption\nType in some text to decode: Hello World\nType in the key/shifting of the letters:\n50\n`}\u00e4\u00e4\u00e7 o\u00e7\u00e8\u00e4|\n</code></pre>\n\n<p>Which is wrong.... And maybe the problem is the char/array - I don't know...So I would be happy if you could help me with that :)</p>\n\n<p>Here is the source code(with some comments):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;wchar.h&gt;\n\nint main()\n{\nunsigned char array[100], shifting; //creating 2 arrays for the encryption\n//I changed it to unsigned char because otherwise Z with key 6/7 dosen't work\nint z; //This is our key\nprintf(\"This tiny application encodes plain text to the Caesar Encryption\\n\");\n\nprintf(\"Type in some text to decode :\");\nfgets(array, 100, stdin); //because gets() is bad I'am using fgets()\nprintf(\"Type in the key/shifting of the letters:\\n\");\nscanf(\"%d\", &amp;z);\n\nfor (int i = 0; array[i] != '\\0'; i++) \n{\n    shifting = array[i]; //overgive values from array to shifting\n    if (shifting &gt;= 'a' &amp;&amp; shifting &lt;= 'z') { //check the containing lowercase letters\n        shifting = shifting + z;\n\n        if (shifting &gt; 'z') {\n            shifting = shifting - 'z' + 'a' - 1; // if go outside the ascii alphabeth this will be done\n        }\n\n        array[i] = shifting;\n    }\n    else if (shifting &gt;= 'A' &amp;&amp; shifting &lt;= 'Z') { //the same for uppercase letters\n        shifting = shifting + z;\n\n        if (shifting &gt; 'Z') {\n            shifting = shifting - 'Z' + 'A' - 1;\n        }\n\n        array[i] = shifting;\n    }\n}\n\nprintf(\"%s\\n\", array);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1514970049, "post_id": 48074042, "comment_id": 83121848, "body": "The first error is a compiler error. The compiler need to know the type of x. The second error is a linker error (ld). The linker sees two different variables with the same name. With <code>extern int x</code> the compiler knows, that there is a variable x of type int in another file so no memory is allocated."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514970085, "post_id": 48074042, "comment_id": 83121862, "body": "<code>Now, when I compile this code</code>..show us the statement."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1514970147, "post_id": 48074042, "comment_id": 83121879, "body": "C is not the same as C++. You understood the issue: you need to explicitly declare <code>extern int x;</code> in <code>main</code> function or in <code>main.c</code>. It is needed because the <a href=\"https://en.wikipedia.org/wiki/C11_(C_standard_revision)\" rel=\"nofollow noreferrer\">C11</a> standard (read <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>....) requires that."}, {"owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514973150, "post_id": 48074042, "comment_id": 83123414, "body": "I  still can&#39;t get to what this statement means:&quot; If the declaration of an identifier for an object has file scope and no storage-class specifier, its linkage is external.&quot;--&gt;What exactly does &quot;linkage is external&quot; mean??  The way I understand it is that when I create a global variable in a file without a &#39;storage-class specifier &#39;, this mean I can use it in other .c files without having to declare it using &#39;extern&#39; in those other files."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1514978070, "post_id": 48074042, "comment_id": 83126102, "body": "No, &quot;external linkage&quot; means that you <i>can</i> access it in another file, <i>if</i> you declare it <code>extern</code> there. The opposite is &quot;internal linkage&quot;, where you cannot access it <i>at all</i> from other .c files."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514971979, "post_id": 48074182, "comment_id": 83122773, "body": "So, what does this mean??  &quot;From the C99 standard:  &#167;6.2.2 Linkages of identifiers  3) If the declaration of a file scope identifier for an object or a function contains the storage-class specifier static, the identifier has internal linkage.  5) If the declaration of an identifier for a function has no storage-class specifier, its linkage is determined exactly as if it were declared with the storage-class specifier extern. If the declaration of an identifier for an object has file scope and no storage-class specifier, its linkage is external.&quot;"}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "reply_to_user": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514972387, "post_id": 48074182, "comment_id": 83122970, "body": "Please read carefully the link that @DevSolar inserted into your question."}, {"owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514973043, "post_id": 48074182, "comment_id": 83123342, "body": "I read it, and still can&#39;t get to what this statement means:&quot; If the declaration of an identifier for an object has file scope and no storage-class specifier, its linkage is external.&quot;..The way I understand it is that when I create a global variable in a file without a &#39;storage-class specifier &#39;, this mean I can use it in other .c files without having to declare it using &#39;extern&#39; in those other files."}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "reply_to_user": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514973479, "post_id": 48074182, "comment_id": 83123616, "body": "Use it in other .c files and link it are different terms."}, {"owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514974009, "post_id": 48074182, "comment_id": 83123887, "body": "How, if I may ask?"}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "reply_to_user": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514974083, "post_id": 48074182, "comment_id": 83123929, "body": "You can access it if you declare it before."}], "tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1514970193, "creation_date": 1514970193, "answer_id": 48074182, "question_id": 48074042, "link": "https://stackoverflow.com/questions/48074042/if-a-global-variable-having-no-storage-class-is-extern-by-default-then-why-ca/48074182#48074182", "title": "If a global variable having no storage-class is &#39;extern&#39; by default, then why can&#39;t I access this variable?", "body": "<ol>\n<li><p>You must declare you variable in main.c, so the compiler knows about it: <code>extern int x</code>. The compiler said it to you: <strong>error: 'x' undeclared</strong></p></li>\n<li><p>You added the second definition of <code>x</code> in main.c, the first definition you did in file1.c. The linker informed you about ambiguity between two definitions. You could read the error above the line <strong>error: ld returned 1 exit status</strong></p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514971901, "post_id": 48074192, "comment_id": 83122731, "body": "So, what does this mean?? &quot;From the C99 standard:  &#167;6.2.2 Linkages of identifiers  3) If the declaration of a file scope identifier for an object or a function contains the storage-class specifier static, the identifier has internal linkage.  5) If the declaration of an identifier for a function has no storage-class specifier, its linkage is determined exactly as if it were declared with the storage-class specifier extern. If the declaration of an identifier for an object has file scope and no storage-class specifier, its linkage is external.&quot;"}, {"owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514973186, "post_id": 48074192, "comment_id": 83123445, "body": "I can&#39;t get to what this statement means:&quot; If the declaration of an identifier for an object has file scope and no storage-class specifier, its linkage is external.&quot;--&gt;What exactly does &quot;linkage is external&quot; mean?? The way I understand it is that when I create a global variable in a file without a &#39;storage-class specifier &#39;, this mean I can use it in other .c files without having to declare it using &#39;extern&#39; in those other files."}, {"owner": {"reputation": 5631, "user_id": 1198321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f792e733fbf4e4edd6d64842093b7691?s=128&d=identicon&r=PG", "display_name": "lxop", "link": "https://stackoverflow.com/users/1198321/lxop"}, "reply_to_user": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "edited": false, "score": 0, "creation_date": 1514993057, "post_id": 48074192, "comment_id": 83134604, "body": "No, what that means is that you <i>can</i> use that variable in other .c files, but those files will need to declare the variable so that the compiler knows that the variable exists. When compiling one .c file, the compiler has no idea what is in any other .c file. This is where header files are usually used, to declare the existence of the variable, while it is defined in just one .c file. Better yet, just don&#39;t use global variables, it is a bad idea."}], "tags": [], "owner": {"reputation": 5631, "user_id": 1198321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f792e733fbf4e4edd6d64842093b7691?s=128&d=identicon&r=PG", "display_name": "lxop", "link": "https://stackoverflow.com/users/1198321/lxop"}, "is_accepted": false, "score": 2, "last_activity_date": 1514970223, "creation_date": 1514970223, "answer_id": 48074192, "question_id": 48074042, "link": "https://stackoverflow.com/questions/48074042/if-a-global-variable-having-no-storage-class-is-extern-by-default-then-why-ca/48074192#48074192", "title": "If a global variable having no storage-class is &#39;extern&#39; by default, then why can&#39;t I access this variable?", "body": "<p>Each compilation unit (in this case your individual <code>.c</code> files) is <em>compiled</em> separately. The compiler needs to know the storage class of <code>x</code> in order to handle it, so your first error (<code>undeclared</code>) comes from the compiler not knowing what <code>x</code> is. The compiler does <em>not</em> need to know where <code>x</code> lives.</p>\n\n<p>When you then <em>link</em> your compiled objects together, the linker resolves any external names (including <code>x</code> in <code>main.c</code> if you've marked it <code>extern</code>) and the final executable will then have all its variables in known places. If it finds 2 extern symbols with the same name, then it will fail, giving you your second error (<code>error: ld returned 1 exit status</code>).</p>\n"}], "owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "closed_date": 1514970436, "answer_count": 2, "score": -4, "last_activity_date": 1514972829, "creation_date": 1514969568, "last_edit_date": 1514972829, "question_id": 48074042, "link": "https://stackoverflow.com/questions/48074042/if-a-global-variable-having-no-storage-class-is-extern-by-default-then-why-ca", "closed_reason": "Duplicate", "title": "If a global variable having no storage-class is &#39;extern&#39; by default, then why can&#39;t I access this variable?", "body": "<p>I have two .c files, one of them has the definition of x, and the other file is using x, as follows:</p>\n\n<p>file1.c:</p>\n\n<pre><code>int x;\n//other code...\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>int main(void)\n{\n    printf(\"%d\", x);\n}\n</code></pre>\n\n<p>Now, when I compile this code, I get the following compilation error message:</p>\n\n<pre><code>In function 'main':\n\nerror: 'x' undeclared (first use in this function)\n</code></pre>\n\n<p><strong>So, if a global variable (in this case <code>x</code>) is 'extern' by default, then why can't <code>main.c</code> file see <code>x</code>?</strong></p>\n\n<p>When I now go to <code>main.c</code> and define <code>x</code>, so that <code>main.c</code> now looks like:</p>\n\n<pre><code>int x=9; //This line was added.\n\nint main(void)\n{\n    printf(\"%d\",x);\n}\n</code></pre>\n\n<p>And also initialize x in file1.c, the program doesn't compile and I get the following error message:</p>\n\n<pre><code>error: ld returned 1 exit status\n</code></pre>\n\n<p>So, if <code>main.c</code> can't see <code>x</code> that is in <code>file1.c</code>, then this time what is the problem?</p>\n\n<p>Is this a linking error?</p>\n\n<p>Note that when I add </p>\n\n<pre><code>extern int x;\n</code></pre>\n\n<p>in <code>main.c</code>, the problem disappears.</p>\n"}, {"tags": ["c", "caching", "memory", "gnu", "mips32"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1514967914, "post_id": 48073612, "comment_id": 83120872, "body": "This is very much a CPU-architecture specific thing. Please edit your question to add what CPU-architecture you&#39;re working on (preferably by adding its tag)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1514968574, "post_id": 48073612, "comment_id": 83121137, "body": "So was the program in <b>C</b> or <b>not</b>? In C, the thing is clear. Even calculating misaligned pointer leads to <b>undefined behaviour</b>, let alone dereferencing it!"}, {"owner": {"reputation": 673, "user_id": 4910008, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5f23b3d24343abf121af99ef91515aa2?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4910008/david"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1514976334, "post_id": 48073612, "comment_id": 83125154, "body": "@AnttiHaapala Yes the program is written in c. May you please supply more information about &quot;undefined behavior&quot; also could you explain why?"}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1514981793, "last_edit_date": 1514981793, "creation_date": 1514968154, "answer_id": 48073731, "question_id": 48073612, "link": "https://stackoverflow.com/questions/48073612/why-cached-memory-alignment-required/48073731#48073731", "title": "Why cached memory alignment required?", "body": "<p>Don't reason at such a low level, if you care about portable C. Look into the assembler code generated by your compiler if you don't (e.g. using <code>gcc -O -fverbose-asm -S</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>).</p>\n\n<p>If you care about a particular implementation, you should mention it (compiler and version, <a href=\"https://en.wikipedia.org/wiki/Optimizing_compiler\" rel=\"nofollow noreferrer\">optimization</a> flags, operating system, processor and brand). But beware of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, be <a href=\"https://stackoverflow.com/a/25636788/841108\">scared</a> of UB.</p>\n\n<p>If coding in C: with C99, you need operating system stuff and support, e.g. <a href=\"http://man7.org/linux/man-pages/man7/pthreads.7.html\" rel=\"nofollow noreferrer\">pthreads(7)</a> (which uses <a href=\"http://man7.org/linux/man-pages/man7/futex.7.html\" rel=\"nofollow noreferrer\">futex(7)</a>). So read a <a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">pthread tutorial</a>. with a C11 conforming implementation (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>), you could use <a href=\"http://en.cppreference.com/w/c/atomic\" rel=\"nofollow noreferrer\">atomic operations</a>, and <a href=\"http://en.cppreference.com/w/c/thread\" rel=\"nofollow noreferrer\"><code>&lt;threads.h&gt;</code></a></p>\n\n<blockquote>\n  <p>Do I have to work with an aligned address?</p>\n</blockquote>\n\n<p>Perhaps yes. Your hardware is accessing aligned data in a different (and quicker and more \"atomic\") way than non-aligned data. <a href=\"https://en.wikipedia.org/wiki/Cache_coherence\" rel=\"nofollow noreferrer\">Cache coherence</a> is specific to a particular processor in its details.</p>\n"}], "owner": {"reputation": 673, "user_id": 4910008, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5f23b3d24343abf121af99ef91515aa2?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4910008/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 48073731, "answer_count": 1, "score": 0, "last_activity_date": 1514982238, "creation_date": 1514967604, "last_edit_date": 1514982238, "question_id": 48073612, "link": "https://stackoverflow.com/questions/48073612/why-cached-memory-alignment-required", "title": "Why cached memory alignment required?", "body": "<p>I am working on mips32, gcc compiler with micro-mips optimization. Each core has it's own cache memory. Core A os - ThreadX, Core B os - rtos. I wish to pass pointer and size from Core A to Core B.\nLet's take a look at the following flow:</p>\n\n<pre><code>1. Core A(ThreadX): pass pointer and size to Core B\n2. Core B(RTOS): write to pointer size bytes\n3. Core B(RTOS): flush(pointer)\n4. Core A(ThreadX): pointer cacheInvalidate(pointer)\n5. Core A(RTOS): copy from pointer to buffer\n</code></pre>\n\n<p>I worked with unaligned address, seems that it caused some unexpected issues.\nAfter passing aligned address I failed to reproduce the issues.\nDo I have to work with an aligned address? Why? What behavior should I expect if I will pass unaligned address? </p>\n"}, {"tags": ["c", "arrays", "pointers", "memory"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1514960753, "post_id": 48072219, "comment_id": 83118024, "body": "Please adjust your code so it won&#39;t contain words inappropriate to professional discourse."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1514960776, "post_id": 48072219, "comment_id": 83118031, "body": "<code>#import &lt;stdint.h&gt;</code> ?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1514961380, "post_id": 48072219, "comment_id": 83118262, "body": "Are you sure this is the exact code you compiled? I think this won&#39;t compile without errors."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1514961383, "post_id": 48072219, "comment_id": 83118264, "body": "Wait... what the hack is <code>#import</code>? Visual Studio 2017 style?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1514961435, "post_id": 48072219, "comment_id": 83118289, "body": "@AjayBrahmakshatriya I think it will compile <a href=\"https://blogs.msdn.microsoft.com/vcblog/2017/05/05/cpp-modules-in-visual-studio-2017/\" rel=\"nofollow noreferrer\">in VS 2017</a>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1514961644, "post_id": 48072219, "comment_id": 83118363, "body": "Before you ask this question, ask yourself where would this ever be useful? Why would you ever access beyond your array bounds?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1514962408, "post_id": 48072219, "comment_id": 83118676, "body": "@Stargateur See <a href=\"https://stackoverflow.com/questions/48072219/c-array-index-and-accessing-out-of-bounds/48072459#comment83118289_48072219\">this comment</a> above."}, {"owner": {"reputation": 133, "user_id": 6383761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWAUr.png?s=128&g=1", "display_name": "Lord Stiltskin", "link": "https://stackoverflow.com/users/6383761/lord-stiltskin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1514967264, "post_id": 48072219, "comment_id": 83120625, "body": "@AjayBrahmakshatriya This was written on xcode. Just replace it with inlcude and it should compile fine. If you&#39;re also bothered by the datatype, replace the alias with the right datatype."}, {"owner": {"reputation": 133, "user_id": 6383761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWAUr.png?s=128&g=1", "display_name": "Lord Stiltskin", "link": "https://stackoverflow.com/users/6383761/lord-stiltskin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1514967492, "post_id": 48072219, "comment_id": 83120714, "body": "@AjayBrahmakshatriya If we were all just about the real life feasibility of code, some hideous bugs would never be discovered and exploits could never be developed. Although this little piece of code doesn&#39;t go to that extent, it&#39;s experimental and is used just for learning/tinkering. Programming is not just about checking if it&#39;s really useful in the real-life-context."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1514982761, "post_id": 48072219, "comment_id": 83128658, "body": "@LordStiltskin apart from the usefulness of &#39;I wrote bad code that I knew was bad but want it explained anyway&#39;, there is the other consideration:  this out-of-bounds aray access Q. has been asked [FP overflow] times already:("}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1514962671, "post_id": 48072459, "comment_id": 83118773, "body": "We shouldn&#39;t keep telling nothing more than UB on these questions. It&#39;s important to know how the computer or a specific operating system work in addition to the fact that it&#39;s UB."}, {"owner": {"reputation": 133, "user_id": 6383761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWAUr.png?s=128&g=1", "display_name": "Lord Stiltskin", "link": "https://stackoverflow.com/users/6383761/lord-stiltskin"}, "edited": false, "score": 0, "creation_date": 1514972846, "post_id": 48072459, "comment_id": 83123237, "body": "<code>LONG_BIT</code> indeed is 64 (so a word should be 8 bytes like you said). So what you&#39;re saying is that a new word is used for each of my arrays, right? Considering that each array element takes 8 bits, it does make sense. Is this kind of alignment/padding compiler dependent?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 133, "user_id": 6383761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWAUr.png?s=128&g=1", "display_name": "Lord Stiltskin", "link": "https://stackoverflow.com/users/6383761/lord-stiltskin"}, "edited": false, "score": 0, "creation_date": 1514972988, "post_id": 48072459, "comment_id": 83123314, "body": "@LordStiltskin An array takes a space of a multiple of 8. That doesn&#39;t mean each element takes 8 bytes. Instead 8 elements share the same 8-byte word. If there&#39;s less than 8 elements then padding will fill that space up to a multiple of 8."}, {"owner": {"reputation": 133, "user_id": 6383761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWAUr.png?s=128&g=1", "display_name": "Lord Stiltskin", "link": "https://stackoverflow.com/users/6383761/lord-stiltskin"}, "edited": false, "score": 0, "creation_date": 1514973078, "post_id": 48072459, "comment_id": 83123362, "body": "Regarding the <code>#import</code>, I did it on xcode. It&#39;s nothing serious actually. I won&#39;t use <code>#import</code> unless it&#39;s for just xcode. Sorry if it caused confusion.  Also, if you have have resources for memory padding, alignment etc, please link me. Is there any tool, with which I can inspect memory(graphically)? Thank  you very much for an actual reply. Others just kept ignoring the real question. They never got the real idea behind the question, tbh"}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 2, "last_activity_date": 1514973298, "last_edit_date": 1514973298, "creation_date": 1514961789, "answer_id": 48072459, "question_id": 48072219, "link": "https://stackoverflow.com/questions/48072219/c-array-index-and-accessing-out-of-bounds/48072459#48072459", "title": "C array index and accessing out of bounds", "body": "<p>Looks like alignment matters.</p>\n\n<p><strong>First of all, this is <a href=\"http://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\">undefined behavior</a> so don't rely on it.</strong> Accessing out-of-bound is UB according to ISO C standard.</p>\n\n<p><strong>Warning again</strong>: Whatever below is highly implementation-dependent. Proceed at your own discretion.</p>\n\n<hr>\n\n<p>Well, answer first. Your guess is right:</p>\n\n<blockquote>\n  <p>I guess it's trying to access memory addresses given to the whole program and not just the array indexes.</p>\n</blockquote>\n\n<p>It's a bit interesting that your numbers <code>120</code> and <code>136</code> differs by 16, so I guess it's caused by an alignment of 8 (you have 2 arrays). In modern computers, data in memory is aligned for performance concerns. For a typical 64-bit system, it's aligned to 8, so both of your arrays <code>arr</code> and <code>arrOr</code> are aligned to 8 bytes. That is, when you declare a size of 57, it's actually taking up 64 bytes of memory (so you won't observe any difference if you declare a size between 57 and 64, but you will if it's 65).</p>\n\n<p>For the extra space greater than 64, it's possibly because of the call stack. This means you're accessing the variables in parent functions like <code>main</code> or <code>WinMain</code> or whatever above. There's a few variables defined by the system when your program starts (<code>hInstance</code>, <code>commandLine</code>, <code>hPrevInstance</code> and so on, on Windows). When you access or even modify those memory area, you're risking breaking your program or even the whole system. Again that's one of the reasons why accessing out-of-bound is bad.</p>\n\n<p>Last line (allow my repetitive note because it's important), this is implementation-dependent, and is subject to change when you compile the code on another platform, or even different versions of the same platform.</p>\n\n<p>BTW, <code>#import</code> is <strong>not</strong> a standard preprocessor indicative. It's (most likely) only available <a href=\"https://blogs.msdn.microsoft.com/vcblog/2017/05/05/cpp-modules-in-visual-studio-2017/\" rel=\"nofollow noreferrer\">in Visual Studio 2017</a>. Don't do that later. I guess you're using VS 2017 on Windows based on that code.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 6383761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWAUr.png?s=128&g=1", "display_name": "Lord Stiltskin", "link": "https://stackoverflow.com/users/6383761/lord-stiltskin"}, "edited": false, "score": 0, "creation_date": 1514967956, "post_id": 48073188, "comment_id": 83120889, "body": "You missed the question though. My question clearly says that I&#39;m aware I shouldn&#39;t intentionally be accessing such a memory."}], "tags": [], "owner": {"reputation": 468, "user_id": 8843433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d48ce87f54a32371b91600d41325ecc?s=128&d=identicon&r=PG&f=1", "display_name": "Sujay", "link": "https://stackoverflow.com/users/8843433/sujay"}, "is_accepted": false, "score": 0, "last_activity_date": 1514965580, "last_edit_date": 1592644375, "creation_date": 1514965580, "answer_id": 48073188, "question_id": 48072219, "link": "https://stackoverflow.com/questions/48072219/c-array-index-and-accessing-out-of-bounds/48073188#48073188", "title": "C array index and accessing out of bounds", "body": "<p>Your Defined array and index is</p>\n<blockquote>\n<p>uint8_t arrOr[55];</p>\n<p>uint8_t arr[55];</p>\n<p>index = 119;</p>\n</blockquote>\n<p>which is out of array so you need to reduce index value or increase your array size so it's accessing out of memory location value i.e. garbage or some time segmentation fault</p>\n<pre><code>// accessing array out of bounds\n#include &lt;stdio.h&gt;\nint main()\n{\n    int arr[] = {1,2,3,4,5};\n    printf(&quot;arr [0] is %d\\n&quot;,arr[0]);\n    printf(&quot;arr[10] is %d\\n&quot;,arr[10]);\n     \n    // allocation memory to out of bound \n    // element\n    arr[10] = 11;\n    printf(&quot;arr[10] is %d\\n&quot;,arr[10]);\n    return 0;\n}\n</code></pre>\n<blockquote>\n<p>Output : Runtime Error : Segmentation Fault (SIGSEGV)</p>\n</blockquote>\n<p>Important Points:</p>\n<p>-Stay inside the bounds of the array in C programming while using arrays to avoid any such errors.\n-C++ however offers the std::vector class template, which does not require to perform bounds checking. A vector also has the std::at() member function which can perform bounds-checking.</p>\n<p>In case of java you can handle this exceptions easily using</p>\n<blockquote>\n<p>java.lang.ArrayIndexOutOfBoundsException</p>\n</blockquote>\n"}], "owner": {"reputation": 133, "user_id": 6383761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWAUr.png?s=128&g=1", "display_name": "Lord Stiltskin", "link": "https://stackoverflow.com/users/6383761/lord-stiltskin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1973, "favorite_count": 0, "closed_date": 1514966702, "accepted_answer_id": 48072459, "answer_count": 2, "score": -2, "last_activity_date": 1514978326, "creation_date": 1514960665, "last_edit_date": 1514978326, "question_id": 48072219, "link": "https://stackoverflow.com/questions/48072219/c-array-index-and-accessing-out-of-bounds", "closed_reason": "Duplicate", "title": "C array index and accessing out of bounds", "body": "<p>So I have a program</p>\n\n<pre><code>#include \"main.h\"\n#import &lt;limits.h&gt;\n#import &lt;stdint.h&gt;\n\nint foo(const void *src, void *dst, uint16_t len)\n{\n    uint16_t index;\n    const uint8_t *srcRef = src;\n    uint8_t *dstRef = dst;\n\n    for(index = 0; index &lt;= len; index++)\n    {\n        dstRef[index] = srcRef[index];\n        printf(\"-&gt; %d - %d\\n\", index, srcRef[index]);\n    }\n    printf(\"%d\\n\", index);\n    return 0;\n}\n\nint main()\n{\n    printf(\"max length of UInt16 is : %d\\n\", UINT16_MAX);\n    uint8_t arrOr[55];\n    uint8_t arr[55];\n    arrOr[54] = 7;\n    uint16_t len = 119;\n    foo(arrOr, arr, len);\n    return 0;\n}\n</code></pre>\n\n<p>Is it normal for a program to be able to access an array index out out bounds? (I was actually expecting it to crash)\nIt can access up to 119(120 crashes it) when array length is 55. </p>\n\n<p>When it's 56, I can still only access up to 119 and 120 crashes it </p>\n\n<p>When it's 57, I can access up to 135 and 136 crashes it. </p>\n\n<p>I guess it's trying to access memory addresses given to the whole program and not just the array indexes. But what's actually happening when I change the array length to 57, that lets me access more addresses that I can't do by increasing it to 56? </p>\n"}, {"tags": ["c", "flash", "microcontroller"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1514959402, "post_id": 48071767, "comment_id": 83117530, "body": "Not very clear, also, &#39;sram_area&#39; is a misleading name for a flash sector:("}, {"owner": {"reputation": 3, "user_id": 9055862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f024c917cf8237cb86e48f09dee9fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin N", "link": "https://stackoverflow.com/users/9055862/nithin-n"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1514959682, "post_id": 48071767, "comment_id": 83117623, "body": "It is just a variable with a name given."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1514969240, "post_id": 48071767, "comment_id": 83121449, "body": "What is the problem? Can you show us what is printed by <code>print_sp</code>?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1514969332, "post_id": 48071767, "comment_id": 83121507, "body": "Did you notice that you write <code>sizeof(sram_area)</code> bytes, while you read only one bytes?"}, {"owner": {"reputation": 3, "user_id": 9055862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f024c917cf8237cb86e48f09dee9fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin N", "link": "https://stackoverflow.com/users/9055862/nithin-n"}, "edited": false, "score": 0, "creation_date": 1514974513, "post_id": 48071767, "comment_id": 83124173, "body": "It will print the return value as &#39;0&#39; (which means success) and the sram_area  value which is in turn the sensor value. sizeof(sram_area) is just 1 byte."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 2, "creation_date": 1514986431, "post_id": 48071767, "comment_id": 83130712, "body": "Show the definitions of <code>sram_area</code> and <code>hts_measurement1</code>.  If the size of <code>sram_area</code> is one byte then shouldn&#39;t you cast <code>value</code> to <code>uint8_t</code> rather than <code>int</code>?  What is the range of <code>value</code>?  Do you need to erase the flash before writing it?  You print the write data in hex but the read data in decimal."}, {"owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 1, "creation_date": 1514999899, "post_id": 48071767, "comment_id": 83138544, "body": "Can you show what you written - and what is been read?  from float to uint8!? what is the range of <code>value</code> ? And what is <code>(ptr+=2)</code> in <code>print_sp</code> statement ?"}, {"owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515000285, "post_id": 48071767, "comment_id": 83138766, "body": "You are writing to same address location in every loop, so it is getting over written with new value.  That is the reason, if you write and then read, your values are correct! How many sensor values are you writing ? why are you not increment the nor flasg address location?"}, {"owner": {"reputation": 3, "user_id": 9055862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f024c917cf8237cb86e48f09dee9fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin N", "link": "https://stackoverflow.com/users/9055862/nithin-n"}, "reply_to_user": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515243843, "post_id": 48071767, "comment_id": 83231839, "body": "@Sudhee How i am suppose to increment that address? I thought By increment of ptr which is assigned to write address would do this job."}, {"owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515334067, "post_id": 48071767, "comment_id": 83253133, "body": "You have not provided the full code here, not sure whats happening in <code>WriteData</code> function or other area of code. I also asked question about <code>(ptr+=2)</code> what it means, no answer for that as well. But with your <b>increment of ptr which is assigned to write address would do this job</b> answer, i can guess that changing to <code>rtn = drv_info-&gt;WriteData(ptr, sram_area, 1);</code> would work. if you post your all relevant code here, i can suggest you further."}, {"owner": {"reputation": 3, "user_id": 9055862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f024c917cf8237cb86e48f09dee9fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin N", "link": "https://stackoverflow.com/users/9055862/nithin-n"}, "reply_to_user": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515385775, "post_id": 48071767, "comment_id": 83266571, "body": "@Sudhee Please find the full code here. <a href=\"https://1drv.ms/u/s!ArltqXFAt4b_gfMP-0s0cmklrKE-6g\" rel=\"nofollow noreferrer\">1drv.ms/u/s!ArltqXFAt4b_gfMP-0s0cmklrKE-6g</a>"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1515473312, "post_id": 48161574, "comment_id": 83302501, "body": "@Nithin N - Please compile and correct the compiler errors if any"}, {"owner": {"reputation": 3, "user_id": 9055862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f024c917cf8237cb86e48f09dee9fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin N", "link": "https://stackoverflow.com/users/9055862/nithin-n"}, "edited": false, "score": 0, "creation_date": 1515494574, "post_id": 48161574, "comment_id": 83311783, "body": "It has an error across <code>ptr</code> stating that <code>uint8_t *</code> is incompatible with <code>uint32_t</code>, because of casting <code>ptr</code> to <code>WRITE_ADDRESS</code>. The function takes parameters <code>WriteData( uint32_t addr, uint8_t *data, uint32_t size);</code>"}], "tags": [], "owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "is_accepted": false, "score": 0, "last_activity_date": 1515473181, "creation_date": 1515473181, "answer_id": 48161574, "question_id": 48071767, "link": "https://stackoverflow.com/questions/48071767/reading-from-internal-flash-in-a-microcontroller/48161574#48161574", "title": "Reading from internal flash in a microcontroller", "body": "<p>I have tried give the possible implementation, but i have not compiled or validated on board as I donot have the board.</p>\n\n<pre><code>#define WRITE_ADDRESS            0x0007fff8     // NOR Flash address \n#define DATA_SIZE                0x02\n#Define NO_OF_SAMPLES            10             // Change depending on your requirement and FLASH Size\n#define DEBUG_NOR                1              // Enabled for debug purpose\n\nfloat temperature = 0.0;\nARM_NOR_STATUS rtn;\nuint8_t *ptr = (uint8_t *)WRITE_ADDRESS;\nint32_t temp_i;\nuint8_t sram_area[DATA_SIZE]={0x00,0x00};\n\n\nvoid tmp006_demo_task(void *pvParameters)\n{\n    char input;\n    uint32_t i;\n    unsigned short Temp =0;\n\n    #ifdef NOR_USE_SDMAC\n        Driver_SDMAC.Initialize();\n        Driver_SDMAC.PowerControl(ARM_POWER_FULL);\n    #endif\n\n    rtn = drv_info-&gt;Initialize(0);\n\n    rtn = drv_info-&gt;PowerControl(ARM_POWER_FULL);\n\n    input = prompt_console(\"select :\");\n\n    if ((input &gt;= 'A') &amp;&amp; (input &lt;= 'Z'))\n    {\n        input = input + ('a' - 'A');\n    }\n    while(1)\n    {\n        if (input == 'a')\n        {\n            ptr = (uint8_t *)WRITE_ADDRESS;\n            for (i=0; i &lt; NO_OF_SAMPLES;i++)\n            {\n                #ifdef (DEBUG_NOR)\n                    sram_area[0]  =  i*20;  //Some random number for only debugging purpose\n                    sram_area[1]  =  i*15;\n                #else\n                    read_temp();            //Probable implementation  17.25 value is stored as 1725 \n                    Temp = (unsigned short)(temperature * 100);\n                    sram_area[0] = 0xFF &amp; Temp;\n                    sram_area[1] = 0xFF &amp; (Temp &gt;&gt; 8);\n\n                #endif\n\n                vTaskDelay(1000);\n\n                rtn = drv_info-&gt;WriteData(ptr, sram_area, 2);       //I'm hardcoding the size to 2\n                if (rtn != ARM_NOR_OK)\n                {\n                    print_sp(PREF \"Writing to NOR Flash Failed \\r\\n\"); \n                    break;\n                }\n                print_sp(PREF \"DATA WRITE        rtn=%d  data=0x%x 0x%x \\r\\n\",  rtn, sram_area[0], sram_area[1]); \n\n                ptr = ptr+2; //Increment the pointer  \n                             //Am Assuming atleast you have 20bytes in Nor flash that can be used                                \n\n            }\n\n            input =0 ;  //Making sure again it is not entering into the loop\n\n        }\n\n        if (input == 'b')\n        {\n            ptr = (uint8_t *)WRITE_ADDRESS;\n            for (i=0; i &lt; NO_OF_SAMPLES;i++)\n            {\n                vTaskDelay(1000);\n                rtn = drv_info-&gt;ReadData(ptr, sram_area , 2);\n                if (rtn != ARM_NOR_OK)\n                {\n                    print_sp(PREF \"Reading to NOR Flash Failed \\r\\n\"); \n                    break;\n                }\n                print_sp(PREF \"DATA Read        rtn=%d  data=0x%x 0x%x \\r\\n\",  rtn, sram_area[0], sram_area[1]); \n\n                ptr = ptr+2;\n\n            }\n            input = 0;          \n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9055862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f024c917cf8237cb86e48f09dee9fc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin N", "link": "https://stackoverflow.com/users/9055862/nithin-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1515473181, "creation_date": 1514957967, "last_edit_date": 1514959709, "question_id": 48071767, "link": "https://stackoverflow.com/questions/48071767/reading-from-internal-flash-in-a-microcontroller", "title": "Reading from internal flash in a microcontroller", "body": "<p>I am trying to code a TZ series microcontroller from Toshiba to collect the data from sensor via I2C and store data into internal NOR flash with time stamp every second. I am facing a problem in reading the value from the flash which is the data from the sensor stored. My code is as follows,</p>\n\n<pre><code>   while(1)\n   {\n     if (input == 'a')\n     {\n\n         read_sens();\n         sram_area[0] = (int)value;\n         vTaskDelay(1000);\n\n       rtn = drv_info-&gt;WriteData(WRITE_ADDRESS, sram_area, sizeof(sram_area));\n       print_sp(PREF\"DATA WRITE rtn= %d data=0x%02x\\r\\n\",rtn,*sram_area); \n         print_sp(PREF \"MEM VALUE  0x%08x\\r\\n\", (ptr+=2));\n     }\n\n     if (input == 'b')\n     {\n        rtn = drv_info-&gt;ReadData(WRITE_ADDRESS, hts_measurement1 , 1);\n\n       print_sp(PREF \"DATA READ  rtn=%d  %d  \\r\\n\",rtn, hts_measurement1[0]);\n\n      //print_sp(PREF \"MEM VALUE  0x%08x\\r\\n\", (ptr+=1));\n      vTaskDelay(1000);\n     }\n   }\n</code></pre>\n\n<p>Both variables <code>sram_area</code> and <code>hts_measurement1</code> are global arrays and are of type <code>uint8_t</code> . varialble Value is simple sensor data, which would keep on updating every second and is of type float. Variable <code>rtn</code> represents a return value (either 0 or 1) from the function WriteData and ReadData and is of type <code>uint8_t</code>. If I try to read the data simultaneously with write then I can read the value properly. But the idea is to first write the data to flash first and then read it when required. I request some one to help me out on this.</p>\n\n<p>I am using FREE RTOS and Toshiba series microcontroller.</p>\n\n<p>Thanks in Advance.</p>\n\n<p>Regards, \nNitin</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 3, "creation_date": 1514955438, "post_id": 48071097, "comment_id": 83116372, "body": "The console API uses a 16-color palette, defined in each screen buffer. You can modify the palette in the console registry settings (ColorTable00 -- ColorTable15) for the default and per-title settings; or in the shortcut settings for apps launched from a shortcut; or in code via <code>SetConsoleScreenBufferInfoEx</code>. The API <code>FOREGROUND_*</code> constants are Intensity (8), Red (4), Green (2), and Blue (1) -- the 4 bits of the 16-color palette. The <code>BACKGROUND_*</code> constants are left-shifted by 4 bits, and use the same palette. The upper-byte <code>COMMON_LVB_*</code> constants are for DBCS, reverse, and underscore."}, {"owner": {"reputation": 912, "user_id": 8062151, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/T2Tub.png?s=128&g=1", "display_name": "AlgoRythm", "link": "https://stackoverflow.com/users/8062151/algorythm"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514955561, "post_id": 48071097, "comment_id": 83116404, "body": "@eryksun I wish I could mark that as the answer; very informative! Thank you!"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514955623, "post_id": 48071097, "comment_id": 83116421, "body": "Do you have to support older versions of Windows, or can you use new features in the Windows 10 console?"}, {"owner": {"reputation": 912, "user_id": 8062151, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/T2Tub.png?s=128&g=1", "display_name": "AlgoRythm", "link": "https://stackoverflow.com/users/8062151/algorythm"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514955695, "post_id": 48071097, "comment_id": 83116441, "body": "@eryksun I wish to support older versions, but am interested in what you have in mind as well"}], "answers": [{"comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1514957378, "post_id": 48071483, "comment_id": 83116958, "body": "&quot;HKCU\\Console&quot; has the default console settings. These get overridden by window-title settings. The window title is set in the application <code>STARTUPINFO</code> (e.g. CMD&#39;s <code>start</code> command lets you set the title). It defaults to the application path. The console loads per-title settings from &quot;HKCU\\Console\\&#91;window title]&quot; when an application allocates a new console instead of inheriting its console. However, window-title settings aren&#39;t used if an application is run via a .LNK shortcut. Instead the settings in the shortcut are used to override the defaults."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514957864, "post_id": 48071483, "comment_id": 83117098, "body": "@eryksun Yeah, I&#39;m aware of that."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514971557, "post_id": 48071483, "comment_id": 83122568, "body": "In Windows 10, you can use Virtual Terminal sequences with 24-bit RGB color codes -- i.e. <code>&quot;\\x1b[38;2;&lt;r&gt;;&lt;g&gt;;&lt;b&gt;m&quot;</code> (foreground) and <code>&quot;\\x1b[48;2;&lt;r&gt;;&lt;g&gt;;&lt;b&gt;m&quot;</code> (background). But they&#39;ve divorced this from the 16-color palette data that can be set and read by console API functions such as <code>ReadConsoleOutputAttribute</code>. In this case reading the character attributes lies about what the actual colors are, and I don&#39;t think there&#39;s any way to get the real values using console functions."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 2, "last_activity_date": 1514957835, "last_edit_date": 1514957835, "creation_date": 1514956026, "answer_id": 48071483, "question_id": 48071097, "link": "https://stackoverflow.com/questions/48071097/windows-c-change-console-color-values/48071483#48071483", "title": "Windows c change console color values", "body": "<p>The Windows console uses a 4-bit color palette, so you can have a maximum of 16 colors for foreground and background. The exact values are defined in the registry and is modifiable.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>HKEY_CURRENT_USER\\Console\\ColorTable##\nHKEY_CURRENT_USER\\Console\\(program)\\ColorTable##\n</code></pre>\n\n<p>Where <code>##</code> is two digits from 00 to 15.</p>\n\n<p>A program can set the color palette by calling <a href=\"https://docs.microsoft.com/en-us/windows/console/setconsolescreenbufferinfoex\" rel=\"nofollow noreferrer\"><code>SetConsoleScreenBufferInfoEx()</code></a>, but will not be able to handle more than 16 colors at a time.</p>\n\n<p>Take note that the format for <code>DWORD COLORREF</code>:</p>\n\n<blockquote>\n  <p>When specifying an explicit RGB color, the COLORREF value has the following hexadecimal form:</p>\n\n<pre><code>0x00BBGGRR\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 912, "user_id": 8062151, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/T2Tub.png?s=128&g=1", "display_name": "AlgoRythm", "link": "https://stackoverflow.com/users/8062151/algorythm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 48071483, "answer_count": 1, "score": 1, "last_activity_date": 1514957835, "creation_date": 1514953101, "question_id": 48071097, "link": "https://stackoverflow.com/questions/48071097/windows-c-change-console-color-values", "title": "Windows c change console color values", "body": "<p>Currently, I'm doing this to change my console colors:</p>\n\n<pre><code>SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), BACKGROUND_GREEN);\n</code></pre>\n\n<p>But what if I wanted to set the background color to, for example, <code>#64e0fc</code>? I know the console <em>can</em> render different colors (You can set them in the properties), but do I have any control over the colors displayed?</p>\n"}, {"tags": ["c", "math"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1514954306, "post_id": 48071069, "comment_id": 83116092, "body": "You don&#39;t assign anything to <code>y</code> in <code>main()</code>, yet you pass its value to <code>f()</code>. There, you use it to compute <code>func</code>, but you never use <code>func</code>. <code>j&lt;=ny-1</code> is the same as <code>j&lt;ny</code>. You can also use <code>sumy+=sin()</code> instead of <code>sumy=sumy+sin()</code>. None of these things will make your code a whole lot faster, but cleaning up things like these will make it easier to read and comment on."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1514954415, "post_id": 48071069, "comment_id": 83116115, "body": "Instead of <code>for (i = 1; i &lt;= nx - 1; i++)</code> you can loop as <code>for(x=ax;x&lt;bx;x+=hx)</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1514993326, "post_id": 48071069, "comment_id": 83134748, "body": "@CrisLuengo <code>for(x=ax;x&lt;bx;x+=hx)</code> would be a bad idea due to accumulated round-off errors of <code>x+=hx</code>  <code>for(integer count)</code> is much better."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514993496, "post_id": 48071069, "comment_id": 83134857, "body": "&quot;to not getting the result I want&quot; --&gt; post the input use, output seen, output expected."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514994899, "post_id": 48071069, "comment_id": 83135695, "body": "@chux Sure, <code>for(int...)</code> is better, but if inside the loop you do <code>x=x+hx</code> and the <code>int</code> value is not being used, then there&#39;s no difference. Except with the <code>int</code> count you might end exceeding your upper boundary. Actually, it would be best if the last iteration were computed using <code>bx</code> instead of <code>x+hx</code> as the right end."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514994729, "post_id": 48073606, "comment_id": 83135600, "body": "Very good answer aside from <code>if (fabs(den) &lt; 1.0e-12) {         fprintf(stderr, &quot;Division by zero!\\n&quot;);</code>   The rational for using a non-zero value deserves commentary.  The <code>1.0e-12</code> is arbitrary.  IOWs, a magic number."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1514995539, "post_id": 48073606, "comment_id": 83136047, "body": "Are you sure that numerical integration is not separable? I don&#39;t see a proof for separability immediately, but I also can&#39;t find a counterexample easily. I&#39;m on the fence about this one for now. Other than that, a good answer. With the algorithm written like this. I came to realize that all that the trapezoidal rule does is add the function value at regular points. You are adding the value at each point 4 times, and dividing by 4. You could also just add <code>f(x0,y0)</code> in the inner loop, then not divide by 4 at the end. You would have to adjust the loop limits so that <code>j&lt;=ny</code>. and <code>i&lt;=nx</code>."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1514995599, "post_id": 48073606, "comment_id": 83136090, "body": "...and if you do that, then you immediately see that it&#39;s separable too. And also easy to parallelize."}, {"owner": {"reputation": 13, "user_id": 9166436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3404ccb591ab1698176b4c9535abff?s=128&d=identicon&r=PG&f=1", "display_name": "Julio Silva", "link": "https://stackoverflow.com/users/9166436/julio-silva"}, "edited": false, "score": 0, "creation_date": 1514997191, "post_id": 48073606, "comment_id": 83137032, "body": "I could not understand these two parts       double x0 = ax + i * hx;      double x1 = ax + (i + 1) * hx;  And  double y0 = ay + j * hy; double y1 = ay + (j + 1) * hy;  how are you calculating the volume of the prism within each interval?  and thanks for all the answers"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1515002520, "post_id": 48073606, "comment_id": 83139910, "body": "@CrisLuengo: I had written the nswer the straightforward way and left the optimization &quot;as exercise for the reader&quot;. Unlike you, I didn&#39;t make the next mental step, though. My statement that the order of evaluation matters is clearly wrong. I don&#39;t think that adding all values is the trapezoidal rule, which would require to evaluate edges with a factor of 0.5 and corners with a factor of 0.25. You could turn the rule into a &quot;rectangular&quot;/&quot;cuboid&quot; rule where you evaluate the mid-points of the cells."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515002843, "post_id": 48073606, "comment_id": 83140094, "body": "@chux: Thanks. You are right, the limit was pulled from thin air. I&#39;m not quite sure how to handle the poles here. I guess that any integration interval that is crossed by x&#178; + y = 0 cannot safely be calculated, so that should be checked for beforehand. The evaluation points might even all yield normal values, but they are meaningless if the values in between could be +/- infinity."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 13, "user_id": 9166436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3404ccb591ab1698176b4c9535abff?s=128&d=identicon&r=PG&f=1", "display_name": "Julio Silva", "link": "https://stackoverflow.com/users/9166436/julio-silva"}, "edited": false, "score": 0, "creation_date": 1515002906, "post_id": 48073606, "comment_id": 83140128, "body": "@JulioSilva: In the light of the insighful comments, I will have to update the answer. But not right now -- I must cook and eat dinner first."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515003115, "post_id": 48073606, "comment_id": 83140228, "body": "@MOehm Could use <code>if (fabs(den) &lt;= 1.0&#47;DBL_MAX...</code> to pre-test if <code>sin(x + y) &#47; den</code> will overflow/div0."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1515009550, "post_id": 48073606, "comment_id": 83143408, "body": "@MOehm You&#39;re right, the edge and corner samples need to weighted differently. Using the mid points of the cells is a good solution, but even if  the approximation is equally good, plenty of people will complain it&#39;s not the trapezoidal rule..."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 13, "user_id": 9166436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3404ccb591ab1698176b4c9535abff?s=128&d=identicon&r=PG&f=1", "display_name": "Julio Silva", "link": "https://stackoverflow.com/users/9166436/julio-silva"}, "edited": false, "score": 0, "creation_date": 1515014412, "post_id": 48073606, "comment_id": 83145449, "body": "@JulioSilva: When I revisited my answer, I found the actual error in your code: mispositioned parantheses in the formula when you calculate f(x, y + hy). I&#39;ve edited the answer."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 2, "last_activity_date": 1515014308, "last_edit_date": 1515014308, "creation_date": 1514967567, "answer_id": 48073606, "question_id": 48071069, "link": "https://stackoverflow.com/questions/48071069/double-integral-with-trapezoid-rule-in-language-c/48073606#48073606", "title": "double integral with trapezoid rule in language C", "body": "<p>Your code works in principle, but there are two errors when you accumulate over y.</p>\n\n<p>The most important error is that you have garbled the parentheses when calculating your function. Your function is:</p>\n\n<pre><code>func = sin(x + y) / (x*x + y);\n</code></pre>\n\n<p>When you accumulate the areas in \u00b4f<code>, you calculate</code>func(x, y + hy)` like so:</p>\n\n<pre><code>sumy = sumy + sin(x + (y + hy)/ (x*x) + y + hy);\n</code></pre>\n\n<p>If we assume that the first function is correct, this should be written as:</p>\n\n<pre><code>sumy = sumy + sin(x + (y + hy)) / (x*x + y + hy);\n</code></pre>\n\n<p>If you increment <code>y</code> first, you can use the same expression for <code>func(x, y)</code>. A better way would probably be to put the evaluation of (f(x, y) into a separate function.</p>\n\n<p>The second error is that when you accumulate the trapezoids in <code>f</code>, you must add both end points, but you only add one. Fix this with:</p>\n\n<pre><code>sumy = sumy + sin(x + y) / (x*x + y);\ny = y + hy;\nsumy = sumy + sin(x + y) / (x*x + y);\n</code></pre>\n\n<p>These changes should give you the correct answer. There are other minor errors, for example you don't initialise <code>y</code>, but pass it to <code>f</code>. In your case, this doesn't matter, because you shouldn't pass <code>y</code> to <code>f</code> in the first place; it should be a local variable, because it isn't used outside of <code>f</code>.</p>\n\n<h3>Optimisation</h3>\n\n<p>The code to calculate the trapezoidal rule is the code above is O(n\u00b2), where n is the number of intervals in both x and y direction. That means that execution time will increase drastically if you use many intervals.</p>\n\n<p>A simple optimisation is to improve the constant factor. The algorithm must evaluate all points in the n&times;m grid, but the code above will evaluate all inner points four times all points on the edges twice. You can evaluate all points only once instead and multiply points in the middle, at the edges and at the corners with a factor of 1.0, 0.5 and 1.25 respectively.</p>\n\n<p>[<em>Note</em>: In an earlier version, I wrote that the evaluation of the two directions cannot be separated. The discussion above makes it clear that this isn't true.]</p>\n"}], "owner": {"reputation": 13, "user_id": 9166436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3404ccb591ab1698176b4c9535abff?s=128&d=identicon&r=PG&f=1", "display_name": "Julio Silva", "link": "https://stackoverflow.com/users/9166436/julio-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 0, "accepted_answer_id": 48073606, "answer_count": 1, "score": 1, "last_activity_date": 1515014308, "creation_date": 1514952856, "last_edit_date": 1514953101, "question_id": 48071069, "link": "https://stackoverflow.com/questions/48071069/double-integral-with-trapezoid-rule-in-language-c", "title": "double integral with trapezoid rule in language C", "body": "<p>I was trying to implement a program in which I can calculate a double integral as a function of x and y with the trapezium rule (that's the one I understood the best). However, in addition to not getting the result I want the program has a very large calculation time for very large n ranges.</p>\n\n<p>I thought first of calculating the integral of the function with respect to y, and then in the body of the program it calls it in relation to the parameters presented and calculate its value in function of x, but it did not work very well and I can not think of a way to do it.</p>\n\n<p>Could someone help me to implement the program correctly and more efficiently?</p>\n\n<p>here is the code as far as i did:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ndouble f(double x, double y, double ay,double  by, double ny);\nint main()\n{\n\n    int i;\n    int nx = 0;\n\n\n    double ax, bx;\n    double sumx = 0;\n    double soma=0;\n    double hx,hy;\n    double x,y;\n    double ay,by;\n    int ny;\n\n    printf(\"inferior limit ax = \");\n    scanf(\"%lf\", &amp;ax);\n    printf(\"upper limit  bx (b&gt;a) = \");\n    scanf(\"%lf\", &amp;bx);\n    printf(\"interval nx (n&gt;1) n = \");\n    scanf(\"%d\", &amp;nx);\n\n    hx = (bx - ax) / (nx - 1);\n    x = ax;\n\n    printf(\"inferior limit ay = \");\n    scanf(\"%lf\", &amp;ay);\n    printf(\"upper limit by (b&gt;a) = \");\n    scanf(\"%lf\", &amp;by);\n    printf(\"interval ny (n&gt;1) n = \");\n    scanf(\"%d\", &amp;ny);\n\n    for (i = 1; i &lt;= nx - 1; i++)\n    {\n        sumx = sumx + f(x,y,ay,by,ny) + f(x + hx,y,ay,by,ny);\n        x = x + hx;\n    }\n\n\n    sumx = sumx * (hx / 2);\n\n    printf(\"O resultado da soma e': %lf\\n\", sumx);\n\n    return 0;\n} // end main()\n\n\n//\n//\n//\ndouble f(double x, double y, double ay,double  by, double ny)\n{\n    double func;\n    int j=0;\n    double hy;\n    double sumy=0;\n\n    func= sin(x+y) / ((x*x) + y);\n\n    hy = (by - ay) / (ny -1);\n    y= ay;\n\n    for (j =1; j &lt;= ny - 1; j++)\n    {\n        sumy = sumy + sin(x + (y + hy)/ (x*x) + y+ hy);\n        y = y +hy;\n    }\n\n    return sumy = sumy * (hy / 2);\n} // end f()\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct", "strcmp"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 2, "creation_date": 1514950687, "post_id": 48070800, "comment_id": 83115301, "body": "You&#39;re first 2 questions are too generic: how is &quot;well&quot; defined, for starters? Besides, you&#39;re asking 3 different question in one question. Only the last question has some merit, but it&#39;d be better if you focus your code and question on just that: limit your code to a minimal example producing that error, and let us know what you&#39;ve already done to debug your problem."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514950706, "post_id": 48070800, "comment_id": 83115307, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48069933/c-character-push-and-pop-operation\">C- Character Push and Pop operation</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 1, "creation_date": 1514950815, "post_id": 48070800, "comment_id": 83115334, "body": "Also practical reading: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1514951311, "post_id": 48070800, "comment_id": 83115442, "body": "1/ Don&#39;t cast <code>malloc</code> in C (and don&#39;t use <code>malloc</code> in C++; more on that if you ask about it). 2/ Don&#39;t hide levels of pointer indirection behind <code>typedef</code>. 3/ Your data structure logic should generally not decide whether or not <code>malloc</code> and <code>free</code> are used; in the world of C, that decision should go the person writing the entry point (<code>main</code>, or what-not for whatever dynamic library). As your project is presumably intended for use by other people, you should leave the decision with them as to how to expand their arrays... and... the best tool for the job is likely <code>pipe</code>, not <code>malloc</code>."}, {"owner": {"reputation": 9, "user_id": 8749481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c25e79eabc2accc76628c4af9c5b214?s=128&d=identicon&r=PG&f=1", "display_name": "stella", "link": "https://stackoverflow.com/users/8749481/stella"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514951334, "post_id": 48070800, "comment_id": 83115449, "body": "@pablo Thank you for your previous comments. I tried to follow yours, but it still doesn&#39;t work. So I thought the problem would not just in storing array from pop but also in other parts. As you commented, I changed S into *S by using typedef on top of the code. I thought it would be the same meaning as you commented but if it is not, could you explain to me..? Thank you so much for your help."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1514952090, "post_id": 48070800, "comment_id": 83115598, "body": "Use <code>pipe</code> to create two file descriptors. Write to one when you&#39;re pushing, read from the other when you&#39;re popping. This tool was given to you for a reason. It may not be fast, but my guess is it&#39;ll compete with this, and scale far beyond... with less than half of the code..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 3, "creation_date": 1514952742, "post_id": 48070800, "comment_id": 83115737, "body": "@Sebivor just so you know <code>pipe</code> is not standard C but <code>POSIX</code>. Also, going to the operating system every time for a simple stack sounds a waste of resources."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1514953776, "post_id": 48070800, "comment_id": 83115965, "body": "@Sebivor: I believe a pipe would give a FIFO (first-in, first-out) discipline, not a stack (LIFO \u2014 last-in, first-out) discipline.  There&#39;s a reason <code>mkfifo()</code> is used to create &#39;named pipes&#39;."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 0, "creation_date": 1514954198, "post_id": 48070800, "comment_id": 83116064, "body": "It&#39;s very important that you improve the indentation of your code. The current formatting makes it difficult to read and, ergo, difficult for you to find good help."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 0, "creation_date": 1514954273, "post_id": 48070800, "comment_id": 83116082, "body": "@Richard I&#39;ve made an edit for that. My edit is still on the peer review queue."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514954914, "post_id": 48070800, "comment_id": 83116223, "body": "@Pablo: Good work - I&#39;ve voted for its approval. However, it&#39;s always good to remind new users that the best way of getting value out of a question is to put work into making a good question. (Incidentally, had I edited this myself, I&#39;d probably have converted the bracing to <a href=\"https://en.wikipedia.org/wiki/Indentation_style#K&amp;R\" rel=\"nofollow noreferrer\">K&amp;R style</a> - I find it works better in the limited space SO gives.)"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 0, "creation_date": 1514955348, "post_id": 48070800, "comment_id": 83116348, "body": "@Richard I try not to change to much of the user&#39;s style, but at least make the indentions consistent. I see I&#39;ve missed one line in <code>create</code> though."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514958783, "post_id": 48070800, "comment_id": 83117348, "body": "Note that the semicolons after the close brace <code>}</code> at the end of a function is not part of the function syntax.  Strictly, it marks the end of an empty declaration at file scope.  Simply remove them.  The semicolon is needed after variable and and type declarations or definitions at file scope."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514959814, "post_id": 48070800, "comment_id": 83117665, "body": "@JonathanLeffler thanks for updating my code. I know that about the semicolons. It&#39;s just that I&#39;ve been writing a lot of JavaScript lately and within my company&#39;s coding style are stuff like this <code>$scope.myfunf = function() { ... };</code> and I did it out of habit without realizing it."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1514958927, "last_edit_date": 1514958927, "creation_date": 1514953605, "answer_id": 48071158, "question_id": 48070800, "link": "https://stackoverflow.com/questions/48070800/push-pop-stack-operation-in-c/48071158#48071158", "title": "Push pop stack operation in C", "body": "<p>Here you have again some things wrong. Before you create new threads with\nsimilar content, stick to one thread.</p>\n\n<p>In your code you also never check if <code>malloc</code> fails. It's always better to do that. For simplicity I've omitted these checks in my suggestions. </p>\n\n<p>1.\nWhy do you do <code>S1[0].top=-1;</code> in <code>makeEmpty</code>? <code>create</code> already does that and writing in that way (instead of <code>S1-&gt;top = -1</code>) makes the code hard to interpret, because it could mean that you are treating the result of <code>create</code> as an array of <code>Stack</code>s. It's not wrong, it makes harder for us to interpret your intentions.</p>\n\n<pre><code>Stack makeEmpty(void)\n{\n    Stack S1=create(100);\n    return S1;\n}\n</code></pre>\n\n<p>is enough.</p>\n\n<p>2.\nIn <code>push</code> and <code>pop</code> you have to check first if the operations are valid. That\nmeans:</p>\n\n<ul>\n<li>for <code>push</code>: check that you still have space to do the operation</li>\n<li>for <code>pop</code>: check that you have at least one element on the stack.</li>\n</ul>\n\n<p>The code could be:</p>\n\n<pre><code>int isFull(Stack S)\n{\n    return (S-&gt;size - 1 == S-&gt;top);\n}\n\nint push(char X, Stack S)\n{\n    if(isFull(S))\n        return 0;\n\n    S-&gt;array[++S-&gt;top]=X;\n    return 1;\n}\n\nint pop(Stack S, char *val)\n{\n    if(isEmpty(S))\n        return 0;\n\n    *val = S-&gt;array[S-&gt;top--];\n    return 1;\n}\n</code></pre>\n\n<p>I changed the signatures of these functions to let the user know <strong>if</strong> the\noperation were successful. Otherwise you have no idea and you end up with\nundefined values. In main your should change the <code>pop</code> calls as well:</p>\n\n<pre><code>char el;\npop(S1, &amp;el);\n</code></pre>\n\n<p>3.\nWhat do you want <code>deleteStack</code> to do: reset the stack or free the memory? You\nare mixing those in a bad way.</p>\n\n<p>If you want to reset (meaning to pop all elements at once), then all you have\nto do is set <code>top = -1</code>. You don't have to free <code>array</code>. If you do, then you\nneed to reallocate memory for <code>array</code> again.</p>\n\n<p>When using <code>free</code> you can only pass to <code>free</code> the same pointer\nyou've got from <code>malloc</code>/<code>calloc</code>/<code>realloc</code>. In your code you are passing a\n8 bit integer as a pointer address and freeing that, that will make your\nprogram crash 100% of the time.</p>\n\n<pre><code>void deleteStack(Stack S)\n{\n    S-&gt;top = -1;\n}\n</code></pre>\n\n<p>If you want to free the memory</p>\n\n<pre><code>void freeStack(Stack S)\n{\n    free(S-&gt;array);\n    free(S);\n}\n</code></pre>\n\n<p><strong>but</strong> that also means that you cannot access the stack any more. Note that I\nchanged the name of the function to make it more clear its intention.</p>\n\n<p>If you use my suggestions, you have to change them in <code>main</code> as well,\nspecially the <code>pop</code>s.</p>\n\n<hr>\n\n<p><strong>EDIT</strong>:\nSebivor's quote from the comments:</p>\n\n<blockquote>\n  <p>Don't hide levels of pointer indirection behind <code>typedef</code></p>\n</blockquote>\n\n<p>Yes, that also makes the code hard to read. In my suggestions I didn't change that, but I definitely would change</p>\n\n<pre><code>typedef struct stack Stack;\n</code></pre>\n\n<p>and in every function that has <code>Stack S</code> as argument change it to <code>Stack *S</code>.  (See also <a href=\"https://stackoverflow.com/questions/750178/\">Is it a good idea to typedef pointers</a> \u2014 the short answer is 'No'.)</p>\n"}], "owner": {"reputation": 9, "user_id": 8749481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c25e79eabc2accc76628c4af9c5b214?s=128&d=identicon&r=PG&f=1", "display_name": "stella", "link": "https://stackoverflow.com/users/8749481/stella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4131, "favorite_count": 0, "closed_date": 1566652956, "answer_count": 1, "score": -8, "last_activity_date": 1567367975, "creation_date": 1514950506, "last_edit_date": 1567367975, "question_id": 48070800, "link": "https://stackoverflow.com/questions/48070800/push-pop-stack-operation-in-c", "closed_reason": "Needs more focus", "title": "Push pop stack operation in C", "body": "<p>I tried to make a stack push pop operations with storing values from pop in an array. I have a few questions for this code.<br>\n1. Does the initialization part work well? When compiling, it seems there is no problem but I'm still curious.<br>\n2. Does the deletion part also work well? Although, I typed <code>!</code>, it seems it doesn't goes to <code>else if(strcmp (str[i], \"!\")==0)</code> part.\n3. How could store values after pop operations? I want to store it as an array format but when I print out after storing them in the array, runtime error occured.<br>\n<strong>Here's the code:</strong>  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct stack *Stack;\n\nstruct stack {\n    char *array;\n    int size;\n    int top;\n};//making stack\n\n\nStack create(int c);\nStack makeEmpty(void);//initialization\nint isEmpty(Stack S)\n{\n    if(S-&gt;top==-1)\n        return 0;\n    else\n        return 1;\n};\nvoid push(char X, Stack S)\n{\n    S-&gt;array[++S-&gt;top]=X;\n};\nchar pop(Stack S)\n{\n    return S-&gt;array[S-&gt;top--];\n};\nvoid deleteStack(Stack S)\n{\n    while (S-&gt;top&gt;=0)\n    {\n        free(S-&gt;array[S-&gt;top]);\n        S-&gt;top--;\n    }\n\n};\n\nint main (void)\n{\n    Stack S1=makeEmpty();\n    char input[100], result[30], result1;\n    char *word;\n    int cnt=0,cnt2=0, temp=0, k=0, i,j,l;\n    word=strtok(input, \" \");\n    char *str[20];\n\n    while(1){\n        if(fgets(input,100,stdin)){\n            word=strtok(input, \" \");//get input and tokenize\n            cnt=0;\n            while (word!=NULL)\n            {\n                str[cnt]=strdup(word);\n                cnt++;\n                word=strtok(NULL,\" \");  \n            }       \n        }\n\n        for (i=0; i&lt;cnt; i++)\n        {\n            if (strcmp(str[i],\"(\")==0 &amp;&amp; (isEmpty(S1)==0))\n            {\n                push(str[i],S1);\n                l++;\n            }\n            else if(strcmp(str[i],\")\")==0)\n            {\n                temp++;\n                for(j=0; j&lt;cnt2; j++)\n                {\n                    char result1=pop(S1);\n                    result[k] =result1;\n                    printf(\"%s \", result[k]);//This the place where I got runtime error\n                    k++;\n                }\n                pop(S1);\n                cnt2=0;     \n            }\n            else if(strcmp (str[i], \"!\")==0)\n            {\n                printf(\"in\\n\");\n                deleteStack(S1);\n                return 0;\n            }\n\n            else \n            {\n                if  (isEmpty(S1)==1)\n                {\n\n                    if (l!=0)\n                    {\n                        push(str[i],S1);\n\n                        if (strcmp(str[i],\"(\")!=0)\n                        {\n                            cnt2++;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    return 0;\n}\n\n\nStack create(int c)\n{\nStack S=(Stack)malloc(sizeof(struct stack));\n\n    S-&gt;size=c;\n    S-&gt;top=-1;\n    S-&gt;array=(char *)malloc(sizeof(char)*c);\n\n    return S;\n}\n\nStack makeEmpty(void)\n{\n    Stack S1=create(100);\n    S1[0].top=-1;\n    return S1;\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2017", "linker-errors"], "comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 2, "creation_date": 1514951067, "post_id": 48070780, "comment_id": 83115390, "body": "Suggest you try to create an actual miaimal example that exhibits the problem rather than just telling us things you (think you) know :-) Often that process makes it obvious <i>why</i> you&#39;re having a problem."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1514951730, "post_id": 48070780, "comment_id": 83115520, "body": "Just tested it locally and it works as expected. We use C libraries for a lot of things so I didn&#39;t expect it wouldn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 1469, "user_id": 2397118, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7241c07b5e6a92c24c2e3e2af011153b?s=128&d=identicon&r=PG", "display_name": "Swiss Frank", "link": "https://stackoverflow.com/users/2397118/swiss-frank"}, "is_accepted": false, "score": 0, "last_activity_date": 1514956876, "creation_date": 1514956876, "answer_id": 48071608, "question_id": 48070780, "link": "https://stackoverflow.com/questions/48070780/visual-c-2017-extern-c-ignored-lnk2019-errors-when-linking-c-code-to-c-l/48071608#48071608", "title": "Visual C++ 2017, extern &quot;C&quot; ignored? LNK2019 errors when linking C++ code to C libraries", "body": "<p>Problem is so stupid: is that the closing brace code (below) had been cut and pasted to an alternate location, while re-arranging declarations, leaving several functions outside the extern block.</p>\n\n<pre><code>#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>Sorry I didn't spot that before posting for help.</p>\n\n<p>I leave this shameful post to found by someone equally foolish (possibly me) in the future.</p>\n"}], "owner": {"reputation": 1469, "user_id": 2397118, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7241c07b5e6a92c24c2e3e2af011153b?s=128&d=identicon&r=PG", "display_name": "Swiss Frank", "link": "https://stackoverflow.com/users/2397118/swiss-frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 713, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514956876, "creation_date": 1514950271, "question_id": 48070780, "link": "https://stackoverflow.com/questions/48070780/visual-c-2017-extern-c-ignored-lnk2019-errors-when-linking-c-code-to-c-l", "title": "Visual C++ 2017, extern &quot;C&quot; ignored? LNK2019 errors when linking C++ code to C libraries", "body": "<p>A solution has a project consisting of a static library (one .h file, one .c file) written in C, and a utility program (.cxx) based on that library written in C++.</p>\n\n<p>The library compiles without error.  The utility compiles too, but fails in linkage with errors like:</p>\n\n<pre><code>1&gt;abc.obj : error LNK2019: unresolved external symbol \"struct DEFListen * __cdecl DEFisten(int,char *,int)\" (?DEFListen@@YAPAU0@HPADH@Z) referenced in function _main\n</code></pre>\n\n<p>The header for the library includes extern \"C\" guards:</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n</code></pre>\n\n<p>By putting garbage inside the ifdef, I get compile warnings when compiling (not linking) the utility as expected, so I know __cplusplus is in fact defined when the utility is compiled, and not for instance merely misspelled.</p>\n\n<p>Yet, the error message shows the function signature (and the mangled name) for the function in question.  <code>dumbin /symbols</code> on the utility's object file of course confirms the object contains mangled symbols.</p>\n\n<p>In summary: <code>extern \"C\" {</code> is definitely being parsed at compile time yet ignored.  Why?</p>\n"}, {"tags": ["c", "runtime", "computer-science"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514948858, "post_id": 48070569, "comment_id": 83114980, "body": "<code>O(1)</code> is not a function, you cannot multiply <code>c</code> by <code>O(1)</code>. <code>O(f)</code> is a set of function that behave like <code>f</code> (I&#39;m not gonna write the complete definition here without LaTeX, take a look in wikipedia for that). If your <code>T</code> in in <code>O(1)</code>, then <code>T(n)</code> would be (almost always) constant for all n, otherwise it would be in <code>O(n)</code>. So for me it makes no sense in comparing <code>T(2000)</code> with <code>T(10000)</code>. then it would take also around 8s"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1514952306, "post_id": 48070569, "comment_id": 83115632, "body": "Why did you substitute <code>O(1)</code> as <code>2000</code>? <code>n</code> is <code>2000</code>, how is <code>O(1)</code> related to <code>n</code>. Infact <code>O(1)</code> is not even a real term. You can&#39;t just use it in equations."}], "answers": [{"comments": [{"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1514952304, "post_id": 48070902, "comment_id": 83115631, "body": "but wouldnt it be reasonable to <i>expect</i> 8s in this case?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1514952409, "post_id": 48070902, "comment_id": 83115657, "body": "@Jasen no. It took 8s for <code>n=2000</code> doesn&#39;t mean the constant is <code>8s</code>. It could be any number greater than or equal to <code>8s</code>."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1514953782, "post_id": 48070902, "comment_id": 83115970, "body": "statistically speaking there is some <i>expected value</i> explain why it is not 8s"}, {"owner": {"reputation": 25508, "user_id": 847269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/564ffe2e3f1ffe82696cd1ac01ac035e?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick87", "link": "https://stackoverflow.com/users/847269/patrick87"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1514987713, "post_id": 48070902, "comment_id": 83131441, "body": "@Jasen Without further information, Eric is right that nothing useful can be said about the expected runtime for other values of <code>n</code>. That is to say, it&#39;s easy to define functions that make <code>T(k&#39;)</code> whatever you want it to be given only that <code>T(k) = c</code> and <code>T(n) = O(1)</code>. You&#39;d need more information about <code>T</code> - more data points, guaranteed monotonicity, etc. - to do more than wildly guess. If you want to wildly guess, though, <code>8s</code> is not a bad guess given only this information. That is, it is a bad guess, but the information you have is insufficient to make a good guess."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1514992965, "post_id": 48070902, "comment_id": 83134530, "body": "@Jasen: The statements \u201cThe run-time of the function is O(1)\u201d and \u201cThe run-time of the function with n = 2000 is 8 seconds\u201d are equivalent to \u201cThis car has a finite gas tank\u201d and \u201cThis car drove 8 miles yesterday.\u201d From those statements, you cannot tell how far the car will drive tomorrow."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1514994712, "post_id": 48070902, "comment_id": 83135584, "body": "It&#39;s better to say that the function run in less than C <i>steps</i> as using a time unit is confusing and not strictly correct. I also find the tank analogy puzzling as in my mind I associate it with a finite travel length while O(1) is more like a finite radius, but that&#39;s just me :) Finally, while I generally take the side of pedantry and nitpicking, it is worth noting how in the OP context O(1) is generally understood as constant time (given a set of implict assumptions)"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1514992751, "last_edit_date": 1514992751, "creation_date": 1514951338, "answer_id": 48070902, "question_id": 48070569, "link": "https://stackoverflow.com/questions/48070569/c-empirical-run-time-analysis/48070902#48070902", "title": "c - empirical run-time analysis", "body": "<p>The correct answer is that we could not expect any particular time.</p>\n\n<p>To say a function\u2019s run-time O(1) is to say there is some number C such that the function always runs in less than C seconds. If the function ran in 8 s once, we know C is at least 8. But it could be a million. Or a septillion.</p>\n\n<p>What O(1) does tell us is that the run time is limited regardless of what n is. That run time could go up and down with various n, but it is always limited by C.</p>\n\n<p>In contrast, compare this to a function with run-time O(n). This means there is a number C such that the function\u2019s run-time is always less than C*n seconds (except a finite number of exceptions are allowed). So we do not have a constant limit; we have a limit that depends on n. This function <em>might</em> take more and more time as n grows.</p>\n\n<p>Or it might not. The O notation only tells you a limit on a function\u2019s run-time. It does not tell you the actual run-time. If I know you had a gallon of gas in your car yesterday, and you went 30 miles, I know your car gets at least 30 miles per gallon. If you have two gallons in it today, I know you could go at least 60 miles, but maybe you could go more, and I do not know how far you will actually go. I know there is a limit on your travel, but I do not know what it actually is or how far you will go.</p>\n"}, {"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514993529, "post_id": 48077619, "comment_id": 83134882, "body": "Nice answer, I don&#39;t know why anybody would downvote this one."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514994222, "post_id": 48077619, "comment_id": 83135302, "body": "Thanks @Pablo. Maybe something&#39;s wrong with it but I&#39;m pretty confident that my reasoning is correct (If I do say so myself)."}], "tags": [], "owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "is_accepted": false, "score": 0, "last_activity_date": 1514983201, "creation_date": 1514983201, "answer_id": 48077619, "question_id": 48070569, "link": "https://stackoverflow.com/questions/48070569/c-empirical-run-time-analysis/48077619#48077619", "title": "c - empirical run-time analysis", "body": "<p>More often than not the problem with <a href=\"https://en.wikipedia.org/wiki/Big_O_notation\" rel=\"nofollow noreferrer\">big-O</a> notation is informal (not to say sloppy) notation that carries along a lot of assumption. </p>\n\n<p>First of all, the <strong>\u039f</strong> symbol<sup>1</sup> expects a <em>function</em> between its parenthesis, so a notation like <strong>\u039f</strong>(1) is unclear at first (since 1 is a number).<br>\nIt is customary in some area of math to denote with \"1\" the function <em>f</em>:\u2115\u2192\u2115 defined as <em>f</em>(n) = 1 \u2200n \u220a \u2115.<br>\nThis is just a function returning 1 for every input<sup>2</sup>.</p>\n\n<p>Another point to consider is that the  <strong>\u039f</strong> as defined classically operates on single-variable functions and to avoid ambiguity the independent variable of the two function should always be explicitly written.<br>\nHowever often this is not done since it is clear from the context that we are dealing with a specific kind of functions only.  </p>\n\n<p>For the sake of the reader alertness and at the cost of a cumbersome notation I'll not drop the independent variables thereby writing <strong>\u039f</strong>(1) as <strong>\u039f</strong>(1(n)).</p>\n\n<p>Finally, I prefer the notation <em>f</em>(n) \u220a <strong>\u039f</strong>(1(n)) over the common one that uses an equal sign.</p>\n\n<hr>\n\n<p>We have hopefully clarified that with the notation <em>f</em>(n) \u220a <strong>\u039f</strong>(1(n)) we are asserting a property of a function <em>f</em>(n) w.r.t. another function that returns 1 for every input.  </p>\n\n<p>The big-O notation is a shorthand (just like the limit notation) that in our specific case translates to</p>\n\n<p><em>f</em>(n) \u220a <strong>\u039f</strong>(1(n))  </p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u2203N \u220a \u2115:  \u2200n > N |<em>f</em>(n)| \u2264 M \u00b7 |1(n)| &nbsp;&nbsp;&nbsp;&nbsp;(by definition)<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u2203N \u220a \u2115:  \u2200n > N |<em>f</em>(n)| \u2264 M \u00b7 1(n) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1(n) always positive)<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u2203N \u220a \u2115:  \u2200n > N |<em>f</em>(n)| \u2264 M \u00b7 1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1(n) = 1 for all n)<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u2203N \u220a \u2115:  \u2200n > N |<em>f</em>(n)| \u2264 M &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\n\n<p>So the notation simplifies to <em>f</em>(n) being bounded in absolute value by an (unspecified!) constants <em>M</em>.  </p>\n\n<p>This leaves us with <em>a lot</em> of functions, even given the value of the function at a point.<br>\nFor example, even if we know that <em>f</em>(2000) = 8, the two functions <em>g</em>(n) = 8 cos(n-2000) and <em>h</em>(n) = 8 e<sup>n-2000</sup> both are in <strong>\u039f</strong>(1(n)) but their value at n = 10000 differs!</p>\n\n<hr>\n\n<p>The big-O notation is useful because it <em>simplifies</em> things but so far it seems that it failed by a great length. </p>\n\n<p>The missing piece is that we are dealing with algorithms and their time-complexity<sup>3</sup> so the functions <em>f</em> that we are interested in are:</p>\n\n<ul>\n<li><p><strong>Non-piecewise</strong>.<br>\nWe consider a piecewise function as arising from two algorithms rather than the expression of a single algorithm.  </p></li>\n<li><p><strong>Monotonic non-decreasing</strong>.\nWe assume that for the same problem, a bigger instance is lengthier (in time) to solve.</p></li>\n</ul>\n\n<p>Under this assumptions, we can see that if a function is bounded then at some point it must cease to increase and stay at that value indefinitely.  </p>\n\n<p>This is what the  <em>f</em>(n) \u220a <strong>\u039f</strong>(1(n)) notation expresses: <em>f</em> is a constant function (asymptotically).  </p>\n\n<p>If <em>f</em> is constant then <em>f</em>(n) = c and if <em>f</em>(2000) = 8 then <em>c</em> = 8 and thus <em>f</em>(10000) = 8.  </p>\n\n<p>At its best the big-O notation is used as follow: take the function between the <strong>\u039f</strong>'s parenthesis, multiply it by a constant <em>c</em> and use it in place of <em>f</em>.  </p>\n\n<p>Sometimes we don't even care about constants: <strong>\u039f</strong>(1(n)) means that if we double <em>n</em> the output stays the same, <strong>\u039f</strong>(n) means that if we double <em>n</em> the output doubles (n is 2 for n = 2), <strong>\u039f</strong>(n<sup>2</sup>) means that if we double <em>n</em> the output quadruples (n<sup>2</sup> is 4 for n = 2) and so on.</p>\n\n<hr>\n\n<p>The problem with your approach is two-fold: saying that T(n) = c * O(1) is correct but useless, we made no progress forward since all we are saying is that T(n) is constant multiplied by another constant (remember that O(1) is a constant function) and thus it is a constant.<br>\nThe other mistake is substituting O(1) with <em>n</em> to get the value of <em>c</em>.<br>\nO(1) is a <em>set</em> of functions and even if we write it as <em>c'</em> (meaning all the possible constants) this is not <em>n</em>! <em>n</em> is the input value, the size of the encoding of the problem instance while <em>c'</em> is an <em>arbitrary</em> constant.  </p>\n\n<p>This is the whole point of constant functions: they do not depend on the input, they are <em>arbitrary</em> in this regard if you wish.</p>\n\n<hr>\n\n<p><sup>1</sup> It is not an <a href=\"https://en.wikipedia.org/wiki/Operator_(mathematics)\" rel=\"nofollow noreferrer\">operator</a> in the strict sense. If we focus our attention to functions defined on a set <em>C</em> and <em>C</em>-valued (e.g. <em>f</em> \u220a <em>C</em>\u2192<em>C</em>) then <strong>\u039f</strong> maps a <em>C</em>\u2192<em>C</em> function to a <em>set</em> of <em>C</em>\u2192<em>C</em> functions (e.g. <strong>\u039f</strong>:(<em>C</em>\u2192<em>C</em>)\u2192<em>\u2118</em>(<em>C</em>\u2192<em>C</em>)) and thus is not a map from and to the same set.  </p>\n\n<p><sup>2</sup> The notation is intentionally fuzzy to let the mathematician use it in different contexts; we used it for natural valued sequences but it can be extended to any set and to the meaning of returning the \"unity\" of any context-implied algebraic structure.    </p>\n\n<p><sup>3</sup> Please beware that run-time is a very very misleading term!</p>\n"}], "owner": {"reputation": 27, "user_id": 6531693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b63a55b8707ebfe307bd05707b9755?s=128&d=identicon&r=PG&f=1", "display_name": "cooldude22", "link": "https://stackoverflow.com/users/6531693/cooldude22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 48070902, "answer_count": 2, "score": 1, "last_activity_date": 1514992751, "creation_date": 1514948175, "question_id": 48070569, "link": "https://stackoverflow.com/questions/48070569/c-empirical-run-time-analysis", "title": "c - empirical run-time analysis", "body": "<p>hey so im having a bit of a hard time grasping empirical run-time analysis. so i have this question: </p>\n\n<p>Suppose we have an O(1) function that took 8s to execute with n = 2,000. What would you expect the runtime to be if n = 10,000?  </p>\n\n<p>now here's my thought process which i believe is wrong: \nif T(n) is O(1) then T(n) = c * O(1) where c is just some constant. so solving for c we get c = T(n) / O(1). now since we know T(2000) = 8s and that n = 2000 we can just plug that in to solve for c, c = (8s) / (2000) which gives us 0.004.\nNow we have to the the same for n = 10,000 so in this case T(10,000)= c * O(1)\nin this case we can just plug in the same c we found earlier since it just a constant, and plug in 10,000 for O(1) which would gives us T(10,000) = (0.004) * 10,000 which equals 40s. im just not sure if my thought process was right on this one.</p>\n"}, {"tags": ["c", "linux", "sockets", "signals"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514960805, "post_id": 48070052, "comment_id": 83118040, "body": "Welcome to Stack Overflow. Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon, but even more importantly, please read about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). You&#39;ve done a thorough job on minimizing, but it was probably too thorough.  We certainly can&#39;t compile what you show.  You&#39;ve also not explained how the data is being sent \u2014 how you know that there is more data on the socket, or how the packets are being sent.  Why do you think it is a good idea to be using SIGIO?  Why not simply wait and read?  Or use one of the poll functions (<code>select()</code>, <code>poll()</code>, maybe <code>epoll()</code>, etc)?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1515055778, "post_id": 48070052, "comment_id": 83157515, "body": "To properly debug this, I&#39;d 1st of all add <i>complete</i> logging <i>and</i> handling or what <code>read()</code> returns. Log the value of  <code>bytes</code> and also stop reading if <code>0</code> is returned, as this indicated that the other side closed the connection. Also better log byte wise, just in case a &quot;stray&quot; <code>&#39;\\0&#39;</code> inside the chunk is received which in turn made <code>printf()</code> ignore to print anything after this <code>&#39;\\0&#39;</code>."}], "owner": {"user_type": "does_not_exist", "display_name": "user8767906"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515055335, "creation_date": 1514943093, "last_edit_date": 1515055335, "question_id": 48070052, "link": "https://stackoverflow.com/questions/48070052/signal-handler-triggers-on-first-time-signal-is-raised-but-not-subsequent-times", "title": "Signal handler triggers on first time signal is raised, but not subsequent times", "body": "<p>I'm fairly new to signals. It's an AF_INET socket, handling SIGIO. The first connection and packet are received and handled (displayed) properly, as far as I can tell.</p>\n\n<p>Subsequent sends are not, however. A breakpoint on the signal handler in GDB (as well as the atomic state flag) shows that the signal handler is never raised again when packets are sent.</p>\n\n<p>Relevant portions of my code (sections missing):</p>\n\n<pre><code>char buffer[1024];\nvolatile sig_atomic_t data_waiting = 0;\nstruct sigaction saio;\n\n// [...] Socket setup and accept\n\nsaio.sa_handler = signal_handler_IO;\nsaio.sa_flags = 0; \nsaio.sa_restorer = NULL;\n\nsigemptyset(&amp;saio.sa_mask);\nsigaddset(&amp;saio.sa_mask, SIGINT);\n\nsigaction(SIGIO, &amp;saio, NULL);\n\nfcntl(connected_sockfd, F_SETOWN, getpid());\nfcntl(connected_sockfd, F_SETFL, FASYNC);\n\nwhile(run_main)\n{   \n    usleep(500);\n\n    if(data_waiting == 1)\n    {\n        data_waiting = 0;\n        bytes = read(connected_sockfd, buffer, 1023);\n\n        if(bytes &gt; 0)\n        {\n            buffer[bytes] = 0; // null termination\n            printf(\"Message: %s\\n\", buffer);\n            buffer[0] = 0; // \"reset\" string\n        }\n    }\n}   \n</code></pre>\n\n<p>and my handler:</p>\n\n<pre><code>void signal_handler_IO(int status)\n{\n    data_waiting = 1;\n}\n</code></pre>\n\n<p>I have nearly the same code handling SIGIO on a serial port file descriptor with zero issues, so I'm really stumped. I assumed the handler would be installed identically, but I might be wrong there.</p>\n"}, {"tags": ["c", "signals", "posix", "system-calls"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1514943049, "post_id": 48070017, "comment_id": 83113909, "body": "Your SIGINT handler has only one line - a call to a function that is not async-signal safe:("}, {"owner": {"reputation": 1547, "user_id": 5750052, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/PGxow.png?s=128&g=1", "display_name": "Jules Lamur", "link": "https://stackoverflow.com/users/5750052/jules-lamur"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1514943527, "post_id": 48070017, "comment_id": 83113994, "body": "@MartinJames Thank you for your help! It&#39;s quickly explained in <code>signal-safety(7)</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514961221, "post_id": 48070017, "comment_id": 83118187, "body": "You&#39;ve no idea what the other fields in the <code>struct sigaction</code> are set to because you didn&#39;t initialize <code>act</code>. Maybe you will get better behaviour if you set the documented fields to know values.  You can use <code>write()</code> in a POSIX signal handler (not in standard C, but fortunately you&#39;re not using standard C).  You shouldn&#39;t use <code>printf()</code>, though in this context it is unlikely to cause any trouble.  One minor advantage of <code>write()</code> \u2014 there&#39;s no application level buffering to worry about."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514961242, "post_id": 48070017, "comment_id": 83118199, "body": "Is your problem resolved?  If so, maybe you should delete this question."}, {"owner": {"reputation": 1547, "user_id": 5750052, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/PGxow.png?s=128&g=1", "display_name": "Jules Lamur", "link": "https://stackoverflow.com/users/5750052/jules-lamur"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514974185, "post_id": 48070017, "comment_id": 83123988, "body": "@JonathanLeffler Thanks for your help. I prefer to post an answer based on the problems you&#39;ve pointed instead of deleting my question, with the hope that it will help someone later."}], "answers": [{"tags": [], "owner": {"reputation": 1547, "user_id": 5750052, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/PGxow.png?s=128&g=1", "display_name": "Jules Lamur", "link": "https://stackoverflow.com/users/5750052/jules-lamur"}, "is_accepted": false, "score": 0, "last_activity_date": 1514986842, "last_edit_date": 1514986842, "creation_date": 1514974014, "answer_id": 48075194, "question_id": 48070017, "link": "https://stackoverflow.com/questions/48070017/sigint-caught-only-one-time/48075194#48075194", "title": "SIGINT caught only one time", "body": "<p>I had two problems with my code, first of all, as mentionned by @MartinJames and @j31d0, the <code>printf</code> function is not <a href=\"http://www.man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">async-signal-safe</a>, so it can't be used inside the signal handler. It can be easily replaced by the <code>write</code> system-call which is async-signal-safe:</p>\n\n<pre><code>char message[255] = \"Hey! I caught a SIGINT :)\\n\";\nwrite(1, message, 255);\n</code></pre>\n\n<p>Secondly, the variable <code>act</code> was not properly initialized (as mentionned by @JonathanLeffler):</p>\n\n<pre><code>sigset_t mask;\nstruct sigaction act;\n\nsigemptyset(&amp;mask);\nact.sa_handler = &amp;sigint_handler;\nact.sa_mask = mask;\nact.sa_flags = 0;\n</code></pre>\n\n<p>Finally, a working code would then be the following:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid sigint_handler(int h)\n{\n    char message[255] = \"Hey! I caught a SIGINT :)\\n\";\n    write(1, message, 255);\n}\n\nint main()\n{\n    sigset_t mask;\n    struct sigaction act;\n\n    sigemptyset(&amp;mask);\n    act.sa_handler = &amp;sigint_handler;\n    act.sa_mask = mask;\n    act.sa_flags = 0;\n\n    if (0 != sigaction(SIGINT, &amp;act, NULL)) {\n        perror(\"unable to setup the SIGINT handler!\\n\");\n\n        return 1;\n    }\n\n    while(1) { }\n\n    return 0;\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 1547, "user_id": 5750052, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/PGxow.png?s=128&g=1", "display_name": "Jules Lamur", "link": "https://stackoverflow.com/users/5750052/jules-lamur"}, "edited": false, "score": 1, "creation_date": 1514994041, "post_id": 48080417, "comment_id": 83135191, "body": "Thanks for your complete answer. BTW, in <code>signal-safety(7)</code>, both <code>strlen</code> and <code>strchr</code> are listed as <i>async-signal-safe</i> with the mention: <i>&quot;Added in POSIX.1-2016&quot;</i>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1547, "user_id": 5750052, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/PGxow.png?s=128&g=1", "display_name": "Jules Lamur", "link": "https://stackoverflow.com/users/5750052/jules-lamur"}, "edited": false, "score": 0, "creation_date": 1514994803, "post_id": 48080417, "comment_id": 83135636, "body": "Hmmm; you&#39;re right.  I hadn&#39;t gone back to look at the list recently, as you can tell.  I have some updating to do.  Thank you!  (And thank you POSIX for putting some sanity into the list of signal safe functions.)"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1514995104, "last_edit_date": 1514995104, "creation_date": 1514993453, "answer_id": 48080417, "question_id": 48070017, "link": "https://stackoverflow.com/questions/48070017/sigint-caught-only-one-time/48080417#48080417", "title": "SIGINT caught only one time", "body": "<p>As <a href=\"https://stackoverflow.com/users/758133/martin-james\">Martin James</a> observed in a <a href=\"https://stackoverflow.com/questions/48070017/sigint-caught-only-one-time?noredirect=1#comment83113909_48070017\">comment</a>:</p>\n\n<blockquote>\n  <p>Your SIGINT handler has only one line - a call to a function that is not async-signal safe:(</p>\n</blockquote>\n\n<p>Somewhat later, I <a href=\"https://stackoverflow.com/questions/48070017/sigint-caught-only-one-time?noredirect=1#comment83118187_48070017\">observed</a>:</p>\n\n<blockquote>\n  <p>You've no idea what the other fields in the <code>struct sigaction</code> are set to because you didn't initialize <code>act</code>. Maybe you will get better behaviour if you set the documented fields to known values. You can use <code>write()</code> in a POSIX signal handler (not in standard C, but fortunately you're not using standard C). You shouldn't use <code>printf()</code>, though in this context it is unlikely to cause any trouble. One minor advantage of <code>write()</code> \u2014 there's no application level buffering to worry about.</p>\n</blockquote>\n\n<p>The question <a href=\"https://stackoverflow.com/questions/16891019/\">How to avoid using <code>printf()</code> in a signal handler</a> discusses which functions can be used in a signal handler. <s>Note that the functions from the <code>&lt;string.h&gt;</code> header such as <code>strlen()</code> and <code>strchr()</code> are not listed amongst those that are async-signal safe.  I find that omission puzzling, but that's what POSIX (2008 and earlier) says.</s> (This was accurate for POSIX 2008.  One of the changes in POSIX 2016 is that a number of signal-safe routines have been added to the list in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04\" rel=\"nofollow noreferrer\">Signal Concepts</a>, including both <code>strlen()</code> and <code>strchr()</code> \u2014 this makes a lot of sense to me.)</p>\n\n<p>I adapted your code like this:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nstatic void sigint_handler(int h)\n{\n    char message[] = \"Hey! I caught a SIGINT x! :\\n\";\n    char *x = message;\n    while (*x != 'x' &amp;&amp; *x != '\\0')\n        x++;\n    if (*x != '\\0')\n        *x = (h % 10) + '0';\n    write(1, message, sizeof(message) - 1);\n}\n\nint main(void)\n{\n    struct sigaction act = { 0 };\n    act.sa_handler = &amp;sigint_handler;\n\n    if (0 != sigaction(SIGINT, &amp;act, NULL))\n    {\n        perror(\"Unable to setup the SIGINT handler!\\n\");\n        return 1;\n    }\n\n    while (1)\n    {\n        printf(\"Pausing for a moment...\\n\");\n        pause();\n        printf(\"You interrupted my dozing\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The code uses <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pause.html\" rel=\"nofollow noreferrer\"><code>pause()</code></a> rather than spinning in a busy-loop.  It's an unusual system call; it never returns normally (the <code>exec*()</code> family of functions never return normally either).</p>\n\n<p>I compile with stringent warning options:</p>\n\n<pre><code>$ gcc -O3 -g -std=c11 -Wall -Wextra -Werror -Wmissing-prototypes \\\n&gt;     -Wstrict-prototypes sig13.c -o sig13\n$\n</code></pre>\n\n<p>If I didn't use <code>h</code> (the argument to the signal handler), the code wouldn't compile, so I used it.  The code avoids using string handling functions (<code>char *x = strchr(message, 'x'); if (x != 0) *x = (h % 10) + '0';</code> would be clearer).  The function is <code>static</code> because it won't be used outside this file \u2014 so there isn't a header to declare it.</p>\n\n<p>When executed (on a Mac running macOS High Sierra 10.13.2, using GCC 7.2.0), it produces output like:</p>\n\n<pre><code>$ ./sig13\nPausing for a moment...\n^CHey! I caught a SIGINT 2! :\nYou interrupted my dozing\nPausing for a moment...\n^CHey! I caught a SIGINT 2! :\nYou interrupted my dozing\nPausing for a moment...\n^CHey! I caught a SIGINT 2! :\nYou interrupted my dozing\nPausing for a moment...\n^CHey! I caught a SIGINT 2! :\nYou interrupted my dozing\nPausing for a moment...\n^CHey! I caught a SIGINT 2! :\nYou interrupted my dozing\nPausing for a moment...\n^\\Quit: 3\n$\n</code></pre>\n\n<p>The main moral to this is \"make sure your variables are properly initialized\".  A secondary moral is to make sure your signal handler is clean.</p>\n"}], "owner": {"reputation": 1547, "user_id": 5750052, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/PGxow.png?s=128&g=1", "display_name": "Jules Lamur", "link": "https://stackoverflow.com/users/5750052/jules-lamur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 48080417, "answer_count": 2, "score": -1, "last_activity_date": 1514995104, "creation_date": 1514942690, "last_edit_date": 1514989334, "question_id": 48070017, "link": "https://stackoverflow.com/questions/48070017/sigint-caught-only-one-time", "title": "SIGINT caught only one time", "body": "<p>Given this code:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid sigint_handler(int h)\n{\n    printf(\"Hey! I caught a SIGINT! :)\\n\");\n}\n\nint main()\n{\n    struct sigaction act;\n    act.sa_handler = &amp;sigint_handler;\n\n    if (0 != sigaction(SIGINT, &amp;act, NULL)) {\n        perror(\"unable to setup the SIGINT handler!\\n\");\n\n        return 1;\n    }\n\n    while(1) { }\n\n    return 0;\n}\n</code></pre>\n\n<p>compiled with <code>gcc 7.2.0</code> (kernel <code>4.13.12</code>) using the following options: <code>-Wall -pedantic -ansi -std=gnu11</code>.</p>\n\n<p>The first signal is always caught, but sometimes, the second one is not caught, and sometimes it is.</p>\n\n<p>I encountered this bug while spamming <code>Ctrl-C</code> at process' startup.</p>\n\n<p>What did I miss to catch all signals?</p>\n"}, {"tags": ["c", "arrays", "stack", "strcat"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514942180, "post_id": 48069933, "comment_id": 83113744, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon, but concentrate on how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) more urgently.  &quot;I had a runtime error&quot; is an appalling explanation of what went wrong.  What really happened, and what had you input?  The code you show doesn&#39;t define the structure type, nor show how data is pushed.  Most often, you should predecrement the stack pointer, but it depends...  And the problem is as likely to be in the code you haven&#39;t shown as in the code you do show."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514942184, "post_id": 48069933, "comment_id": 83113745, "body": "I don&#39;t understand what you are asking. Besides, the signature of <code>strcat</code> is <code>char *strcat(char *dest, const char *src);</code>. You are passing a <code>char</code>, your compiler must have warned you about it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514942338, "post_id": 48069933, "comment_id": 83113776, "body": "How does your <code>pop()</code> function tell you there wasn&#39;t a character to pop?  You haven&#39;t shown how things get pushed, but I do see that you have <code>-1</code> in the <code>top</code> for an empty stack, so the <code>S-&gt;top--</code> isn&#39;t necessarily wrong."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514942575, "post_id": 48069933, "comment_id": 83113829, "body": "In <code>makeEmpty</code> you have a syntax error, <code>S1[0]-&gt;top=-1;</code> is wrong, it should be <code>S1[0].top=-1;</code>. Do you compile your stuff before posting it here? Do you read the compiler error? Besides, doing this is pointless, the <code>create</code> call already assigns <code>-1</code> to <code>top</code>."}, {"owner": {"reputation": 9, "user_id": 8749481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c25e79eabc2accc76628c4af9c5b214?s=128&d=identicon&r=PG&f=1", "display_name": "stella", "link": "https://stackoverflow.com/users/8749481/stella"}, "edited": false, "score": 0, "creation_date": 1514942659, "post_id": 48069933, "comment_id": 83113845, "body": "I tried both one, but S1[0].top=-1 made a compile error."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1514964823, "post_id": 48069933, "comment_id": 83119641, "body": "you requested for memory but didn&#39;t release it. And <a href=\"http://stackoverflow.com/q/605845/995714\">don&#39;t cast the result of <code>malloc</code> in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1514945037, "last_edit_date": 1514945037, "creation_date": 1514944666, "answer_id": 48070209, "question_id": 48069933, "link": "https://stackoverflow.com/questions/48069933/c-character-push-and-pop-operation/48070209#48070209", "title": "C- Character Push and Pop operation", "body": "<p>I've made copy&amp;paste of your code, and it doesn't get compiled. I think that\nyou are either not posting your actually code nor you don't bother to compile and read the compiler warnings. It's rather difficult to help you. Here some things I noticed:</p>\n\n<p>1.\n<code>create</code> must return a pointer to <code>Stack</code>, not the object.</p>\n\n<pre><code>Stack *create(int c)\n{\n    Stack *S = malloc(sizeof *S);\n\n    S-&gt;size=c;\n    S-&gt;top=-1;\n    S-&gt;array = malloc(c);\n\n    return S;\n}\n</code></pre>\n\n<p>2.\nSame goes for <code>makeEmpty</code></p>\n\n<pre><code>Stack *makeEmpty(void)\n{\n    Stack *S1=create(100);\n    S1-&gt;top=-1;\n    return S1;\n}\n</code></pre>\n\n<p>3.\n<code>pop</code> should get a pointer to <code>Stack</code>, not the object</p>\n\n<pre><code>char pop(Stack *S)\n{\n    return S-&gt;array[S-&gt;top--];\n};\n</code></pre>\n\n<p>Here you should check whether there are elements on your stack. <code>int pop(Stack *S, char *val)</code> where it returns 1 and writes on <code>*val</code> on\nsuccess, and returns 0 otherwise would be better.</p>\n\n<p>4.\nJudging from your <code>pop</code> you are pushing <code>char</code> only. I don't get what you\nare trying to do with <code>strcat</code>. Either way, you are doing <code>strcat</code> wrong. You\nare declaring a stack with 100 spaces, but you are only declaring 30 spaces\nfor <code>result</code>. What if you have more than 31 elements on your stack? I know\nthat you are only inspecting 2 elements but it's easy to overlook that and\nexpand it to go through all the stack without changing the memory requirements\nfor <code>result</code>.</p>\n\n<p>Also <code>strcat</code> is a function that works with C-Strings, that means it expects\nC-Strings. A C-String <strong>must</strong> be <code>\\0</code> terminated, yours are not. You have\nsomething that looks like a C-String but it's not. If you insist on using\n<code>strcat</code>, the you should do it like this:</p>\n\n<pre><code>for(j=0; j&lt;2; j++)\n{\n    char result1[] = { pop(S1), 0 };\n    strcat(result, result1);\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8749481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c25e79eabc2accc76628c4af9c5b214?s=128&d=identicon&r=PG&f=1", "display_name": "stella", "link": "https://stackoverflow.com/users/8749481/stella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1602, "favorite_count": 0, "closed_date": 1566986556, "accepted_answer_id": 48070209, "answer_count": 1, "score": -1, "last_activity_date": 1567369082, "creation_date": 1514941849, "last_edit_date": 1567369082, "question_id": 48069933, "link": "https://stackoverflow.com/questions/48069933/c-character-push-and-pop-operation", "closed_reason": "Not suitable for this site", "title": "C- Character Push and Pop operation", "body": "<pre><code>Stack create(int c)\n{\n    Stack S=(Stack)malloc(sizeof(struct stack));\n\n    S-&gt;size=c;\n    S-&gt;top=-1;\n    S-&gt;array=(char *)malloc(sizeof(char)*c);\n\n    return S;\n}\n\nStack makeEmpty(void)\n{\n    Stack *S1=create(100);\n    S1[0]-&gt;top=-1;\n    return S1;\n}\n\nchar pop(Stack S)\n{\n    return S-&gt;array[S-&gt;top--];\n};\n\nint main(void)\n{\n    Stack *S1;\n    S1=makeEmpty();\n    int j;\n    int k=0;\n    char result[30];\n    for(j=0; j&lt;2; j++)\n    {\n        char result1=pop(S1);\n        strcat(result, result1);\n        k++;\n    }\n}\n</code></pre>\n\n<p>I skipped some parts, like <code>typedef struct stack Stack</code>;\nWhat I wanted to do was pop out elements from the stack while for-loop works. Then, store those elements in a new array which is <code>result</code>. To check whether it works or not, I printed out but I had a runtime error. How to store the element and how to print it out?</p>\n"}, {"tags": ["mysql", "c"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1514967953, "post_id": 48069788, "comment_id": 83120888, "body": "From the documentation: &quot;In a nonmulti-threaded environment, the call to <code>mysql_library_init()</code> may be omitted&quot;. Are you in a nonmulti-threaded environment? (seen the trace, I don&#39;t think so)"}, {"owner": {"reputation": 47, "user_id": 7614237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a8ae03a37c20e911f16b740d734319e?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/7614237/helloworld"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1514979625, "post_id": 48069788, "comment_id": 83126959, "body": "I&#39;m sure that the program is in a nonmulti-threaded environment. The documentation says that mysql_library_init() should be called before spawning any threads in multi-threaded environment, but don&#39;t say what should I do in a nonmulti-threaded environment. I just use mysql_init() which call mysql_library_init() automatically as necessary. Thank you anyway! @purplepsycho"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7614237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a8ae03a37c20e911f16b740d734319e?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/7614237/helloworld"}, "edited": false, "score": 0, "creation_date": 1514960358, "post_id": 48071602, "comment_id": 83117881, "body": "Thank you for your response! I mean what you say, but valgrind shows that memories which are still reachable increase with the increment of the number of connections. Why memories used by connection didn&#39;t free after mysql_close? I am worried that if the program runs for a long time it will run out of memory."}, {"owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "reply_to_user": {"reputation": 47, "user_id": 7614237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a8ae03a37c20e911f16b740d734319e?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/7614237/helloworld"}, "edited": false, "score": 0, "creation_date": 1514960819, "post_id": 48071602, "comment_id": 83118045, "body": "I&#39;m sorry, I don&#39;t understand--what kind of connections are we talking about?  You can&#39;t be doing database connections without using the mysql library.  Why do you think the memory is being used by the mysql library instead of elsewhere?  If your program is adding connections, it is going to use more memory to support them; and reachable memory is generally not a problem.  When the connections go away, and then new ones come in, does memory use continue to increase or does it remain largely static?  Valgrind is a useful tool, but you can make yourself crazy chasing nonissues with it also."}, {"owner": {"reputation": 47, "user_id": 7614237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a8ae03a37c20e911f16b740d734319e?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/7614237/helloworld"}, "edited": false, "score": 0, "creation_date": 1514961504, "post_id": 48071602, "comment_id": 83118315, "body": "The connections just mean database connections. After two database connections close(call mysql_close without mysql_library_end), memories that are still reachable are twice as much as just one database connection. Anyway, may be you are right and I shouldn&#39;t chasing nonissues. The document of valgrind also says that still reachable is not very serious. Thank you."}], "tags": [], "owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "is_accepted": true, "score": 0, "last_activity_date": 1514956791, "creation_date": 1514956791, "answer_id": 48071602, "question_id": 48069788, "link": "https://stackoverflow.com/questions/48069788/call-mysql-library-end-after-mysql-close-but-segmentation-fault/48071602#48071602", "title": "call mysql_library_end after mysql_close but segmentation fault", "body": "<p>Kind of a \"Doctor, doctor, it hurts when I do this\" issue--the answer is don't call mysql_library_end().  The fact that valgrind reports that it is still hanging on to some memory after you are done is not a bug--it just means that it allocated some memory and it hasn't freed it yet because it isn't done with it.</p>\n\n<p>It probably shouldn't segfault if you do call mysql_library_end() followed by another mysql_init(), but the man page does say that you only call mysql_library_end() when you are done using the library, so the action when you try to use the library after calling it is undefined.</p>\n"}], "owner": {"reputation": 47, "user_id": 7614237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a8ae03a37c20e911f16b740d734319e?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/7614237/helloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 48071602, "answer_count": 1, "score": 2, "last_activity_date": 1514967621, "creation_date": 1514940301, "last_edit_date": 1514967621, "question_id": 48069788, "link": "https://stackoverflow.com/questions/48069788/call-mysql-library-end-after-mysql-close-but-segmentation-fault", "title": "call mysql_library_end after mysql_close but segmentation fault", "body": "<p>After reading <a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-library-end.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/5.7/en/mysql-library-end.html</a>, I try to call <code>mysql_library_end()</code> after <code>mysql_close()</code> when finishing a query. However, when I need to query again, I get a segmentation fault when calling <code>mysql_real_connect()</code>. What I do is just connect twice:</p>\n\n<pre><code>MYSQL *mysql;\nmysql = mysql_init(NULL);\nif (!mysql_real_connect(mysql, host, user, passwd, db, 3306, NULL, 0))\n{\n    fprintf(stderr, \"connect failed\\n\");\n}\nmysql_close(mysql);\nmysql_library_end();\n\nmysql = mysql_init(NULL);\nif (!mysql_real_connect(mysql, host, user, passwd, db, 3306, NULL, 0)) // segmentation fault here\n{\n    fprintf(stderr, \"connect failed\\n\");\n}\nmysql_close(mysql);\nmysql_library_end();\n</code></pre>\n\n<p>gdb backtrace:</p>\n\n<pre><code>#0 phtread_mutex_lock\n#1 yaSSL::Sessions::lookup\n#2 yaSSL::yaSSL_get_session\n#3 ssl_do\n#4 ssl_connect\n#5 cli_establish_ssl\n#6 mysql_real_connect \n#7 main\n</code></pre>\n\n<p>If I do not call <code>mysql_library_end()</code>, the program runs well but valgrind says some memories are still reachable after <code>mysql_close()</code>. What should I do to fix the program without memory leak? My mysql version is 5.7.19. Thank you for your visit and response! </p>\n"}, {"tags": ["c", "assembly", "arm"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1514940879, "post_id": 48069689, "comment_id": 83113451, "body": "You should not return a pointer to a local, that&#39;s not legal in C either."}, {"owner": {"reputation": 1, "user_id": 9165968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbab601ca3f70e963a375420876d5913?s=128&d=identicon&r=PG&f=1", "display_name": "dralois", "link": "https://stackoverflow.com/users/9165968/dralois"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1514941810, "post_id": 48069689, "comment_id": 83113664, "body": "Okay so if I return the stack pointer that would be returning a pointer to a local variable. What other option is there to put a double in memory and return that pointer without having to use the C malloc?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1514941939, "post_id": 48069689, "comment_id": 83113695, "body": "If you don&#39;t particularly care about reentrancy, declare a variable in your data section. You should really pass in the pointer to your function though."}, {"owner": {"reputation": 1, "user_id": 9165968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbab601ca3f70e963a375420876d5913?s=128&d=identicon&r=PG&f=1", "display_name": "dralois", "link": "https://stackoverflow.com/users/9165968/dralois"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1514942753, "post_id": 48069689, "comment_id": 83113864, "body": "Well I would if I could, the problem is that the function declared in the task specifically asks for a pointer as the return value and no pointer as input."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1514943567, "post_id": 48069689, "comment_id": 83114002, "body": "Why can&#39;t you return a <code>double</code> by value?  Or have the caller pass a pointer for you to store into?  Normally you only need to return a pointer if it&#39;s a newly-allocated object (with <code>malloc</code>, like <code>strdup</code> does).  Returning a pointer to a static buffer is used in some legacy C library functions, like <code>gethostbyname</code>, but that&#39;s only useful with struct return types that would be inefficient to return by value.  <code>double</code> is not like that: it fits in a register (unless you&#39;re using soft-float, in which case it fits in two integer registers)."}, {"owner": {"reputation": 1, "user_id": 9165968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbab601ca3f70e963a375420876d5913?s=128&d=identicon&r=PG&f=1", "display_name": "dralois", "link": "https://stackoverflow.com/users/9165968/dralois"}, "edited": false, "score": 1, "creation_date": 1514944059, "post_id": 48069689, "comment_id": 83114108, "body": "It is indeed soft-float. I don&#39;t know why they formulated the task the way they did, I don&#39;t find it particularly elegant either. I&#39;ll contact my supervisor and ask if it&#39;s okay to change the return value to by value instead."}], "answers": [{"tags": [], "owner": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "is_accepted": false, "score": 1, "last_activity_date": 1515434374, "creation_date": 1515434374, "answer_id": 48155648, "question_id": 48069689, "link": "https://stackoverflow.com/questions/48069689/arm-assembler-return-pointer/48155648#48155648", "title": "ARM assembler return pointer", "body": "<p>You should think how you will do in pure C! You cannot allocate a <code>double</code> on the stack. You either reserve the memory before calling your assembly function. Example</p>\n\n<pre><code>void my_assembly(double* value) {\n    *value = (...);\n}\n\nvoid main(void) {\n    double value;\n\n    my_assembly(&amp;value);\n}\n</code></pre>\n\n<p>Or you allocate it into your assembly function:</p>\n\n<pre><code>double* my_assembly(void) {\n    double *value = malloc(sizeof(double));\n    *value = (...);\n    return value;\n}\n\nvoid main() {\n    double* value = my_assembly();\n}\n</code></pre>\n\n<p>Another option would be to return the double! <a href=\"http://infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/IHI0042F_aapcs.pdf\" rel=\"nofollow noreferrer\">ARM's Procedure call Standard</a> says at <code>5.4 Result Return</code>:</p>\n\n<blockquote>\n  <p>A double-word sized Fundamental Data Type (e.g., long long, double and 64-bit containerized vectors) is returned in r0 and r1</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 9165968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbab601ca3f70e963a375420876d5913?s=128&d=identicon&r=PG&f=1", "display_name": "dralois", "link": "https://stackoverflow.com/users/9165968/dralois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "closed_date": 1515450762, "answer_count": 1, "score": 0, "last_activity_date": 1515451680, "creation_date": 1514939458, "last_edit_date": 1515451680, "question_id": 48069689, "link": "https://stackoverflow.com/questions/48069689/arm-assembler-return-pointer", "closed_reason": "Opinion-based", "title": "ARM assembler return pointer", "body": "<p>I am currently working on a project where I need to return a pointer to a double from an ARM assembly function to a C program.  </p>\n\n<p>I currently tackle this problem by pushing the double onto the stack and then returning the address of the stack pointer.  </p>\n\n<p>However I am not sure if that's the best (safest) way to go about it, hence why I'm asking here for either confirmation that this is a good way to do it or an alternative solution.</p>\n\n<p>The additional problem is that according to the task i'm not allowed to hand another variable in neither am I allowed to use the C malloc function.</p>\n\n<p>Edit: I solved the problem by creating a variable in .data and then just simply return the address of that field.</p>\n"}, {"tags": ["c", "qsort"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1514937161, "post_id": 48069404, "comment_id": 83112557, "body": "Check the numbers for NaN-ness; if one is NaN and the other isn&#39;t, report that the NaN is smaller (or larger, depending on sort direction and where you want the NaNs to appear).  Presumably, if they&#39;re both NaN, return 0.  Otherwise, neither is a NaN and you process them with suitable comparisons.  If you think that there are different values within the NaNs, then you&#39;ll have to characterize the NaNs and produce a valid   comparison according to your chosen rules.  Note that the checks for NaN-ness should probably come first, not last."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1514937216, "post_id": 48069404, "comment_id": 83112572, "body": "Ugh - that code is checking directly for equality on a floating point number.  Depending on what is passed in, this could lead to &quot;interesting&quot; results for numbers that are supposedly equal, but can&#39;t be represented the same exact value.  Beware."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 4, "creation_date": 1514937270, "post_id": 48069404, "comment_id": 83112586, "body": "@MichaelDorgan: I think you&#39;re either mistaken or misstating things if you think that two &quot;supposedly equal&quot; numbers &quot;can&#39;t be represented the same&quot;."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1514937332, "post_id": 48069404, "comment_id": 83112609, "body": "I see equality check on floating point and my eyebrows go up.  Depending on how the sort is used, it might be fine, it might not.  That was my concern."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1514937357, "post_id": 48069404, "comment_id": 83112617, "body": "@EOF For the purpose of this code, 2 different NaN can compare equal - they will just appear in the sorted list next to each other in some order.  Returning 0 does not violate the &#167;7.22.5 4."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1514937391, "post_id": 48069404, "comment_id": 83112632, "body": "If you need a total ordering on NaNs, just use <code>memcmp</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514937494, "post_id": 48069404, "comment_id": 83112656, "body": "@JonathanLeffler &quot;Check the numbers for NaN-ness;&quot; Yes, how do you recommend to do that?  <code>x == x</code>? or <code>isnan(some_long_double)</code>.  Are there any non-well known gotcha&#39;s doing either?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1514937687, "post_id": 48069404, "comment_id": 83112702, "body": "@R.. total ordering on NaNs,with <code>memcmp</code> seems reasonable yet with a 80-bit <code>long double</code> using a 12 or 16 byte memory, I should get stable results, but unclear on order or if some other issues occurs because of the padding.  Perhaps using <code>10</code> and not <code>sizeof *x</code> in that case is sufficient ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1514937890, "post_id": 48069404, "comment_id": 83112749, "body": "@chux: I&#39;d use <code>isnan()</code>, but my requirements are not so exacting as to want to recognize different types of NaN.  I know of signalling and non-signalling NaNs; I believe that there are numerous bit-patterns which represent a NaN. But I&#39;ve never needed to study them in sufficient detail to know what&#39;s what under the <code>isnan()</code> surface. One item that&#39;s key is that if you have two elements in the array -- say <code>x[10]</code> and <code>x[30]</code> -- then comparing <code>x[10]</code> and <code>x[30]</code> should produce consistent results with comparing <code>x[30]</code> and <code>x[10]</code>. If one&#39;s negative, the other must be positive, or both zero."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514938128, "post_id": 48069404, "comment_id": 83112810, "body": "@JonathanLeffler Yes that last part is most important  <a href=\"https://stackoverflow.com/questions/48069404/how-to-compare-long-doubles-with-qsort-and-with-regard-to-nan?noredirect=1#comment83112749_48069404\">If one is negative, the (other) must be positive, or both zero</a>.  For this case the order of NaN is not important other than they are at the end of the sorted array - which simplifies the code.  Ordering <code>NaN</code> seems to only be reasonable with <code>memcmp()</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514938947, "post_id": 48069404, "comment_id": 83113013, "body": "@JonathanLeffler: In IEEE 754 binary floating-point, one the maximum value of the exponent field is assigned for infinities and NaNs. If the significand field is all zeros, it is &#177;\u221e. Otherwise, it is a NaN. So the number of NaNs equals the number of possible sign and significand field values minus two."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1514939089, "post_id": 48069404, "comment_id": 83113046, "body": "Both my clang and gcc don&#39;t print the minus in <code>-nan</code> as shown in the current input and output. Should I be worried about that?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1514941994, "post_id": 48069404, "comment_id": 83113704, "body": "Why not remove the NaNs from the array before sorting?    Even if you can sort in the presence of NaNs, any subsequent code will need to deal with their presence somehow anyway - and the options are not much more than ignore, discard, or complain.     Removing the NaNs allows subsequent code to assume they&#39;re not present i.e. less need for checks."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1514952172, "post_id": 48069404, "comment_id": 83115608, "body": "@usr2564301: The fact that your C implementation does not print the sign of a NaN is not something to be concerned about."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1514959505, "post_id": 48069404, "comment_id": 83117562, "body": "@EricPostpischil: thanks.  Wikipedia on <a href=\"https://wikipedia.org/wiki/IEEE_754\" rel=\"nofollow noreferrer\">IEEE 754</a> and <a href=\"https://wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">NaN</a> explained more than I needed to know."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514996242, "post_id": 48069558, "comment_id": 83136485, "body": "This may make the status of NaN more clear, yet what functional differences to you see with this and the original <code>compare()</code>- if any?  Testing NaN first appears slower with typical data sets where NaN are rare. So is the only advantage code clarity?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514996765, "post_id": 48069558, "comment_id": 83136770, "body": "@chux: you are questioning if your routine sorts correctly. This code uses another ordering of the tests, which <i>could</i> have led to a different result. As it does not, it appears to answer your question &quot;is [my] <code>compare()</code> sufficient ..&quot; (with &quot;yes&quot; \ud83d\ude00). So, nothing to fix and little room left for simplification. (I consider reordering the tests thusly is more readable, but there are no side effects and I assume there are no, or only minor, computational benefits.)"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514997071, "post_id": 48069558, "comment_id": 83136956, "body": "On putting the <code>isNaN</code> test first: this is to clear any lingering doubts regarding <i>possibly</i> undefined behavior. This way, either <code>NaN</code> gets culled out first. A small note: each of these tests gets compiled to a single <code>fucomi</code> instruction. No idea if that could cause a significant slowdown (what with pipelining and all \u2013 really, no idea)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515025089, "post_id": 48069558, "comment_id": 83148942, "body": "It was the good answer and the strength of the <a href=\"https://stackoverflow.com/questions/48069404/how-to-compare-long-doubles-with-qsort-and-with-regard-to-nan/48086996#comment83136956_48069558\">comment</a> that led to accepting this answer."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1515025352, "post_id": 48069558, "comment_id": 83149015, "body": "@chux: cheerio, mate! I had some doubts on answering your <i>highly</i> technical question, especially after following the comments (worthy of preserving). And thanks back for grilling me on my answer, it was a pleasure!"}], "tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": true, "score": 5, "last_activity_date": 1514941235, "last_edit_date": 1514941235, "creation_date": 1514938294, "answer_id": 48069558, "question_id": 48069404, "link": "https://stackoverflow.com/questions/48069404/how-to-compare-long-doubles-with-qsort-and-with-regard-to-nan/48069558#48069558", "title": "How to compare long doubles with qsort and with regard to NaN?", "body": "<p>This is just a simple reordering of your tests, but it makes the status of <code>NaN</code> more clear if you will.</p>\n\n<pre><code>int compare(const void *a, const void *b)\n{\n    const long double fa = *(const long double *) a;\n    const long double fb = *(const long double *) b;\n\n    if (isnan(fa))\n    {\n        if (isnan(fb))\n        {\n            return 0;\n        }\n        return 1;\n    }\n    if (isnan(fb))\n    {\n        return -1;\n    }\n    if (fa &gt; fb) return 1;\n    if (fa &lt; fb) return -1;\n\n    /* no more comparisons needed */\n    return 0;\n}\n</code></pre>\n\n<p>As the tests for <code>NaN</code> are at the top and no NaNs should pass through, the bottom three lines can safely be replaced with your</p>\n\n<pre><code>return (a &gt; b) - (a &lt; b);\n</code></pre>\n\n<p>Apart from the discussion of the different <em>types</em> of <code>NaN</code> (a bit sounding like how many angels can dance on a CPU core), this ought to be stable enough for your purposes, and I can't see any possible issues with this code.</p>\n\n<p>With Clang, neither <code>-ffast-math</code> nor <code>-fdenormal-fp-math=[ieee|preserve-sign|positive-zero]</code> yields other results. Nor did gcc with  <code>-ffast-math</code>,\n<code>-funsafe-math-optimizations</code>, and even <code>-ffinite-math-only</code> (the latter most likely because there are no operations other than a straight compare to <code>NaN</code>).</p>\n\n<p>Just to be complete, I tested with both <code>std::numeric_limits&lt;double&gt;::signaling_NaN();</code> and <code>std::numeric_limits&lt;double&gt;::quiet_NaN();</code> (from C++ <code>&lt;limits.h&gt;</code>) as well \u2013 again, no difference in the sort order.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1515024915, "creation_date": 1515024915, "answer_id": 48086996, "question_id": 48069404, "link": "https://stackoverflow.com/questions/48069404/how-to-compare-long-doubles-with-qsort-and-with-regard-to-nan/48086996#48086996", "title": "How to compare long doubles with qsort and with regard to NaN?", "body": "<p><strong>The <a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">NaN</a> test</strong></p>\n\n<pre><code>int isnan(real-floating x);\n</code></pre>\n\n<blockquote>\n  <p>The <code>isnan</code> macro determines whether its argument value is a NaN. First, an argument represented in a format wider than its semantic type is converted to its semantic type. Then determination is based on the type of the argument.<sup>235</sup><br>\n  <sup>235</sup> For the <code>isnan</code> macro, the type for determination does not matter unless the implementation supports NaNs in the evaluation type but not in the semantic type.</p>\n</blockquote>\n\n<p><code>isnan(some_long_double)</code> will work as hoped except on a rare platform.</p>\n\n<p><code>int isunordered(real-floating x, real-floating y)</code> acts like <code>isnan()</code> expect it accounts for both arguments.</p>\n\n<p>On <em>many</em> platforms, code could use <code>(a == a)</code> as a candidate NaN test as that evaluates to <code>0</code> when <code>a</code> is NaN and <code>1</code> otherwise.  Unfortunately, unless an implementation defines <code>__STDC_IEC_559__</code>, that is not certain to work.</p>\n\n<hr>\n\n<p><strong>The compare</strong><br>\n<strong><code>&gt;=, &gt;, &lt;, &lt;=</code></strong> and C11 7.12.14 Comparison macros</p>\n\n<p>Using <code>&gt;=, &gt;, &lt;, &lt;=</code> when at least one operand is a NaN can result in a \"invalid\" floating-point exception.  So prior testing for <code>NaN</code> is prudent as answered by <a href=\"https://stackoverflow.com/a/48069558/2410359\">@usr2564301</a></p>\n\n<p>C offers macros <code>isgreaterequal(), isgreaterequal(), isless(), islessthna()</code> which do the compare and not raise the \"invalid\" floating-point\nexception.  This is good alternative for <code>double</code>, yet the macros use a <em>real-floating</em> which may differ from <code>long double</code>.  <code>isgreater(long_double_a, long_double_a)</code> may evaluate as <code>double</code> and not provide the desired compare result.</p>\n\n<p>The challenge with classify macros is that the <em>semantic type</em> may be narrower than <code>long double</code>.</p>\n\n<hr>\n\n<p>The following uses the above ideas and  as I read the C spec is well defined and functionally correct  for all cases except the rare one: when <code>long double</code> has NaN but not the <em>real-floating</em> (often <code>double</code>) does not.</p>\n\n<pre><code>#include &lt;math.h&gt;\n\n// compare 2 long double.  All NaN are greater than numbers.\nint compare(const void *a, const void *b) {\n  const long double *fa = (const long double *) a;\n  const long double *fb = (const long double *) b;\n\n  if (!isunordered(*fa, *fb)) {\n    return (*fa &gt; *fb) - (*fa &lt; *fb);\n  }\n\n  if (!isnan(*fa)) {\n    return -1;\n  }\n  return isnan(*fb);  // return 0 or 1\n}\n</code></pre>\n\n<hr>\n\n<p>Note: After reading many of the good comments and learning a great deal, I am posting this self-answer as provided in <a href=\"https://stackoverflow.com/help/self-answer\">Can I answer my own question?</a> in addition to accepting another answer.</p>\n"}], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 1, "accepted_answer_id": 48069558, "answer_count": 2, "score": 6, "last_activity_date": 1515024915, "creation_date": 1514936935, "last_edit_date": 1514939128, "question_id": 48069404, "link": "https://stackoverflow.com/questions/48069404/how-to-compare-long-doubles-with-qsort-and-with-regard-to-nan", "title": "How to compare long doubles with qsort and with regard to NaN?", "body": "<blockquote>\n  <p>How to compare long doubles with <code>qsort()</code> and with regard to <a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">not-a-number</a>?</p>\n</blockquote>\n\n<p>When sorting an array that might contain not-a-numbers, I would like to put all the those <code>NAN</code> to one end of the sorted array.</p>\n\n<hr>\n\n<p><code>qsort()</code> imposes some restriction on the compare function.</p>\n\n<blockquote>\n  <p>The function shall return an integer less than, equal to, or\n  greater than zero if the first argument is considered to be respectively less than, equal to, or greater than the second.<br>\n  C11dr \u00a77.22.5.2 3</p>\n  \n  <p>When the same objects ... are passed more than once to the comparison function, the results shall be consistent with one another. That is, for <code>qsort</code> they shall define a <strong>total ordering</strong> on the array, ... the same object shall always compare the same way with the key.<br>\n  \u00a77.22.5 4</p>\n</blockquote>\n\n<p><code>a &gt; b</code> is false when <code>a &lt;= b</code> or if <code>a</code> is not-a-number or if <code>b</code> is not-a-number.  So <code>a &gt; b</code> is not the same as <code>!(a &lt;= b)</code> as they have opposite results if one of them is NaN.</p>\n\n<p>If the compare function uses <code>return (a &gt; b) - (a &lt; b);</code>, code would return 0 if one or both  <code>a</code> or <code>b</code> are NaN.  The array would not sort as desired and it loses the <em>total ordering</em> requirement.</p>\n\n<p>The <strong><code>long double</code></strong> aspect of this sort is important when using the classify functions like <code>int isnan(real-floating x);</code> or <code>int isfinite(real-floating x);</code>.  I know <code>isfinite( finite_long_double_more_than_DBL_MAX)</code> might return false.  So I have concerns about what <code>isnan(some_long_double)</code> might do <em>something</em> unexpected.</p>\n\n<hr>\n\n<p>I tried the below.  It apparently sorts as desired.</p>\n\n<p><strong>Sub-question:</strong> Is <code>compare()</code> below sufficient to sort as desired?   Any recommended simplifications?  If not - how to fix?\n(For this task, it is OK for values like 0.0L and -0.0L to sort in any way)</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;float.h&gt;\n\nint compare(const void *a, const void *b) {\n  const long double *fa = (const long double *) a;\n  const long double *fb = (const long double *) b;\n  if (*fa &gt; *fb) return 1;\n  if (*fa &lt; *fb) return -1;\n\n  if (*fa == *fb) {\n    //return -memcmp(fa, fb, sizeof *fa); if -0.0, 0.0 order important.\n    return 0;\n  }\n  // At least one of *fa or *fb is NaN\n  // is *fa a non-NaN?\n  if (!isnan(*fa)) return -1;\n  if (!isnan(*fb)) return 1;\n\n  // both NaN\n  return 0;\n  // return -memcmp(fa, fb, tbd size); if NaN order important.\n}\n\nint main(void) {\n  long double x[] = { 0.0L / 0.0, 0.0L / 0.0, 0.0, 1.0L / 0.0, -0.0, LDBL_MIN,\n      LDBL_MAX, 42.0, -1.0L / 0.0, 867-5309, -0.0 };\n  x[0] = -x[0];\n  printf(\"unsorted: \");\n  size_t n = sizeof x / sizeof x[0];\n  for (size_t i = 0; i &lt; n; i++) {\n    printf(\"%.3Le,\", x[i]);\n  }\n  printf(\"\\nsorted: \");\n  qsort(x, n, sizeof x[0], compare);\n  for (size_t i = 0; i &lt; n; i++) {\n    printf(\"%.3Le,\", x[i]);\n  }\n  puts(\"\");\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>unsorted: nan,-nan,0.000e+00,inf,-0.000e+00,3.362e-4932,1.190e+4932,4.200e+01,-inf,-4.442e+03,-0.000e+00,\nsorted: -inf,-4.442e+03,-0.000e+00,0.000e+00,-0.000e+00,3.362e-4932,4.200e+01,1.190e+4932,inf,nan,-nan,\n</code></pre>\n\n<p>If I knew the compare function was correct, I'd post on Code Review for improvement ideas.  Yet I am not confident enough that code works correctly with those pesky NaNs. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1514936958, "post_id": 48069392, "comment_id": 83112505, "body": "What&#39;s the problem? What doesn&#39;t this code do correctly?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1514936991, "post_id": 48069392, "comment_id": 83112516, "body": "<code>switch</code> is not an input statement. Try adding <code>scanf(&quot;%d&quot;, &amp;tem);</code> after the <code>printf()</code> lines. And please try to indent your code properly before posting."}, {"owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514937062, "post_id": 48069392, "comment_id": 83112535, "body": "I am using Code Block, my code is not running, i believe because the way i am using switch with Void function is not correct"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 3, "creation_date": 1514937105, "post_id": 48069392, "comment_id": 83112548, "body": "Your maths is all wrong too. What is <code>(9.0*celsius)&#47;(5.0+32)</code> supposed to do?"}, {"owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514937359, "post_id": 48069392, "comment_id": 83112619, "body": "i changed the math to correct one printf(&quot;%2.f Celsius is equal %2.f Fahrenheit\\n&quot;,celsius, (9*celsius/5)+32);"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1514937478, "post_id": 48069392, "comment_id": 83112651, "body": "<code>tem</code> in not initialized.  Your code won&#39;t do what you want unless you can put something into that value.  See the <code>scanf()</code> comment above."}, {"owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514937944, "post_id": 48069392, "comment_id": 83112765, "body": "Hi all Helpers, i changed the math and add scanf after printf, but after running, the code still does not show me correct conversion"}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1514937957, "post_id": 48069392, "comment_id": 83112771, "body": "@MichaelDorgan <code>tem</code> is initialized"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514938183, "post_id": 48069392, "comment_id": 83112821, "body": "I like: <code>F = (9.0&#47;5.0) * (C + 40.0) - 40.0</code> and <code>C = (5.0&#47;9.0) * (F + 40.0) - 40.0</code>.  It&#39;s nicely symmetric, relying on -40C = -40F."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1514938184, "post_id": 48069392, "comment_id": 83112822, "body": "Try <code>%2.2f</code> while in your printf.. and also do the math pefore your printf instead of in it.. like this   <code>float temp = 0.0;  temp = (5.0&#47;9.0)*(fahr - 32)*5&#47;9; &#47;&#47;Not saying this math is correct or anything printf(&quot;%3f Fahrenheit is equal %3.0f Celsius \\n&quot;,fahr,temp);</code>"}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1514938236, "post_id": 48069392, "comment_id": 83112837, "body": "@JamesMacathy you must be getting compiler errors with this code. Care to share?"}, {"owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "reply_to_user": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1514938669, "post_id": 48069392, "comment_id": 83112952, "body": "@CoreyLakey i did as you advice, but it still show the wrong output."}, {"owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "reply_to_user": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1514938759, "post_id": 48069392, "comment_id": 83112973, "body": "@CoreyLakey my code block is working well with other program i code. so i think the cause is from my own code. Is this correct way to use Swtich with Void Funtions? So far, everything running but the Output is wrong"}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1514939229, "post_id": 48069392, "comment_id": 83113074, "body": "@JamesMacathy Compiler errors does not mean your IDE is broken. Compiler errors means the compiler is telling you that your code in your current project couldn&#39;t be compiled. Read the compiler errors. Do you have them enabled in &quot;Logs&amp;Others&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514939687, "post_id": 48069657, "comment_id": 83113175, "body": "By the way, if i want after the 1st time conversion, the menu appears again to allow user choose to convert and input again. I guess i need to use while or for loop, but not sure how to use it."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "reply_to_user": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514939827, "post_id": 48069657, "comment_id": 83113203, "body": "@JamesMacathy If you want it to go again, start by wrapping main in a while loop from your first printf to the end of your switch statement."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "reply_to_user": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514940123, "post_id": 48069657, "comment_id": 83113260, "body": "@JamesMacathy The fact that your issues were minor compiler errors, tells me you either have no compiler errors enabled or don&#39;t know where to find them in your log.. and must have a look at <a href=\"https://stackoverflow.com/questions/4456165/enable-compiler-output-pane-in-codeblocks\" title=\"enable compiler output pane in codeblocks\">stackoverflow.com/questions/4456165/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514940365, "post_id": 48069657, "comment_id": 83113322, "body": "my compiler was still running and show the math, but it just wrong. after i only changed %2.f to %f as you said, it works. Thanks a lot. I look into while loop now."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "reply_to_user": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "edited": false, "score": 0, "creation_date": 1514940466, "post_id": 48069657, "comment_id": 83113348, "body": "Ok great. @JamesMacathy"}], "tags": [], "owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "is_accepted": true, "score": 0, "last_activity_date": 1514939154, "creation_date": 1514939154, "answer_id": 48069657, "question_id": 48069392, "link": "https://stackoverflow.com/questions/48069392/c-program-combine-switch-with-void-function/48069657#48069657", "title": "C program - Combine Switch with Void Function", "body": "<p>You must be getting compiler issues. Put a parentheses at the end of your printf, and change the <code>%2.f</code> to just %f in your scanfs. </p>\n\n<p>This code works...</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid fahtocel(void);\nvoid celtofah(void);\nint main(void)\n{\n    int tem;\n    printf(\"Please select your choice\\n\");\n    printf(\"Enter 1 if you need to convert Fahrenheit to Celsius\\n\");\n    printf(\"Enter 2 if you need to convert Celsius to Fahrenheit\\n\");\n    scanf(\"%d\", &amp;tem);\n    switch (tem) {\n    case 1:\n        fahtocel();\n        break;\n    case 2:\n        celtofah();\n        break;\n    }\n    return 0;\n}\n\nvoid fahtocel()\n{\n    float fahr;\n    printf(\"Please input Fahrenheit: \");\n    scanf(\"%f\", &amp;fahr);\n    printf(\"%3f Fahrenheit is equal %3.0f Celsius \\n\", fahr, (5.0 / 9.0) * (fahr - 32) * 5 / 9);\n}\nvoid celtofah()\n{\n    float celsius;\n    printf(\"Please input celsius: \");\n    scanf(\"%f\", &amp;celsius);\n    printf(\"%2.f Celsius is equal %2.f Fahrenheit\\n\", celsius, (9 * celsius / 5) + 32);\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9165886, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dc4400fe03009100a7e56b88f83860ea?s=128&d=identicon&r=PG&f=1", "display_name": "James Macathy", "link": "https://stackoverflow.com/users/9165886/james-macathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 0, "accepted_answer_id": 48069657, "answer_count": 1, "score": -1, "last_activity_date": 1514939154, "creation_date": 1514936842, "last_edit_date": 1514937882, "question_id": 48069392, "link": "https://stackoverflow.com/questions/48069392/c-program-combine-switch-with-void-function", "title": "C program - Combine Switch with Void Function", "body": "<p>I am trying to combine Switch into Void Function to convert Celsius to Fahrenheit and vice versa. I am not sure what is correct way to combine Switch and Void Function together.\nMy code is at below. Any advice is valuable for me.\nThank you.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid fahtocel(void);\nvoid celtofah(void);\nint main(void)\n {\n    int tem;\n    printf(\"Please select your choice\\n\");\n    printf(\"Enter 1 if you need to convert Fahrenheit to Celsius\\n\");\n    printf(\"Enter 2 if you need to convert Celsius to Fahrenheit\\n\");\n    scanf(\"%d\", &amp;tem);\n    switch(tem) {\ncase 1:\n    fahtocel();\n    break;\ncase 2:\n    celtofah();\n    break;\n}\nreturn 0;\n}\n\nvoid fahtocel()\n{\n float fahr;\n   printf(\"Please input Fahrenheit: \");\n   scanf(\"%2.f\", &amp;fahr);\n   printf(\"%3f Fahrenheit is equal %3.0f Celsius \\n\",fahr,(5.0/9.0)*(fahr - 32)*5/9;\n} \nvoid celtofah()\n{\n float celsius;\n printf(\"Please input celsius: \");\n scanf(\"%2.f\", &amp;celsius);\n printf(\"%2.f Celsius is equal %2.f Fahrenheit\\n\",celsius, (9*celsius/5)+32);\n }\n</code></pre>\n"}, {"tags": ["c++", "c", "global-variables", "member", "procedural-programming"], "comments": [{"owner": {"reputation": 730, "user_id": 8270416, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/876b251bdfdc25fbda57c01009c054be?s=128&d=identicon&r=PG&f=1", "display_name": "ttemple", "link": "https://stackoverflow.com/users/8270416/ttemple"}, "edited": false, "score": 1, "creation_date": 1514935282, "post_id": 48069096, "comment_id": 83112109, "body": "Why are you converting to C?"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1514935356, "post_id": 48069096, "comment_id": 83112134, "body": "In c++ the singleton is best implemented by replacing the class by a namespace and data member by static data member (internal linkage). I would do the same in C, without the namespace."}, {"owner": {"reputation": 730, "user_id": 8270416, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/876b251bdfdc25fbda57c01009c054be?s=128&d=identicon&r=PG&f=1", "display_name": "ttemple", "link": "https://stackoverflow.com/users/8270416/ttemple"}, "edited": false, "score": 0, "creation_date": 1514935964, "post_id": 48069096, "comment_id": 83112288, "body": "If you have to change to C, I like the struct better than &#39;loose&#39; variables.  Passing around a pointer to the struct is not burdensome.  If you don&#39;t want set/getters for the &#39;loose&#39; variables, they will have to be declared extern in files that need to &#39;see&#39; them.  Then you will deal with all of the pains of uncontrollable side effects caused by a bunch of loose global variables visible to anybody and everybody.  Seems like a big step backward to me."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1514942633, "post_id": 48069096, "comment_id": 83113839, "body": "As mentioned, you would probably be better off explaining what you are trying to accomplish by the conversion."}], "answers": [{"comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1514952186, "post_id": 48070407, "comment_id": 83115609, "body": "Never say never. Oops, I did it :-) There are certainly areas where globals make sense <i>and</i> are more convenient than other solutions without sacrificing readability or maintainability. Not in large complex code with lots of dependencies, no doubt, but there <i>are</i> places. Also I &quot;coded&quot; <code>self</code>/<code>this</code> in your first bullet point since, on first reading, it seemed you were suggesting something and then telling us we shouldn&#39;t do it :-) Other than that, good answer, since you&#39;re basically doing what C++ does but using the C mindset (explicitly and painfully)."}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "reply_to_user": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1514968854, "post_id": 48070407, "comment_id": 83121273, "body": "It&#39;s not that painful. Instead actually extremely well readable. Linux kernel is a good example."}], "tags": [], "owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1514952240, "last_edit_date": 1514952240, "creation_date": 1514946529, "answer_id": 48070407, "question_id": 48069096, "link": "https://stackoverflow.com/questions/48069096/converting-c-class-to-procedural-api-common-way-of-replacing-member-variables/48070407#48070407", "title": "Converting C++ class to procedural API: common way of replacing member variables?", "body": "<p>Eeek.. Globals? Shoot yourself. Never use globals. Big no no. Ruins reentrancy and kills your code.</p>\n\n<p>All C code I write looks like this:</p>\n\n<pre><code>struct object {\n    int data;\n};\n\nvoid object_init(struct object *self);\nvoid object_update(struct object *self, float dt);\nint object_write_to_file(struct object *self, const char *file);\n</code></pre>\n\n<ul>\n<li>for anything that is not trivial like radians(float degrees) use a struct and pass it as first argument called <code>self</code> everywhere (do not use <code>this</code> even if allowed in C because you will have problems mixing with C++)</li>\n<li>keep file name and struct name the same</li>\n<li>prefix all methods that operate on the struct with struct name</li>\n<li>do not use typedef struct ... it makes glancing over code harder</li>\n<li>always keep all data in structs that stem from a root application object. ie struct application { struct object obj; ... }. This allows you to easily make as many instances of the application as you like (provided that all libraries you use also are designed as OOP objects without static state). Regardless, it is a good practice for your code. </li>\n<li>Doing this allows you to have full control over: reentrancy, data locality, data ownership, data modification, code readability. Generally you get much better quality too and can easily make your app multithreaded because without global state everything that needs to be locked is inside the same struct. </li>\n<li>Over time you start to appreciate verbosity a lot because EVERYTHING you do with your code becomes easier and you can understand what the code does just by looking at it. You know that self->member is a reference to a variable that is passed to current method. You know this variable is local to the object. You know self is the object you are currently operating on. You know that any access to members of self probably has to be locked by a lock called self->lock if mutual exclusion is necessary. Easy inferences like these really speed up development time and make your life easier. </li>\n</ul>\n"}], "owner": {"reputation": 783, "user_id": 3995239, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LLKKq.png?s=128&g=1", "display_name": "Accumulator", "link": "https://stackoverflow.com/users/3995239/accumulator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514952240, "creation_date": 1514934611, "question_id": 48069096, "link": "https://stackoverflow.com/questions/48069096/converting-c-class-to-procedural-api-common-way-of-replacing-member-variables", "title": "Converting C++ class to procedural API: common way of replacing member variables?", "body": "<p>I'm converting a C++ class, let's call it <code>render</code>, which only ever had one instance used (singleton-but-not-offically), to a purely procedural style for use in a C program. Which being what it is, a simple software renderer, probably should have been written as such in the first place.</p>\n\n<p>The ex-class mostly just dealt with a ton of generically-named private variables, everything from lone bytes to large arrays of binary data. <code>unsigned char frame_counter</code>, <code>char* frame_data</code>, <code>unsigned char palette[256][128][3]</code>, etc. which is what I'm trying to replace.</p>\n\n<p>I'm renaming my functions in a simple way, like: <code>render::load_sprite(const char* file)</code> -> <code>render_load_sprite(const char* file)</code></p>\n\n<p>Global \"member\" variables:</p>\n\n<ul>\n<li>Generally considered bad / to be avoided. <em>Possible</em> conflicts at some point.</li>\n<li>Don't know how I should rename members. Maybe prefix like <code>renderer_palette</code>? Kinda verbose from the inside.</li>\n<li>What if I want some variables to modifiable without wrapper function?</li>\n</ul>\n\n<p>State struct:</p>\n\n<ul>\n<li><p>OOP-like, but I'm dealing with what should a singular, static API.</p></li>\n<li><p>Has to be passed around everywhere. Kinda verbose from the outside.</p></li>\n<li><p>Has to be initialized.</p></li>\n</ul>\n\n<p>Is the preferred choice in this instance globals, struct, or is there another option?</p>\n"}, {"tags": ["c", "gdb", "overflow"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1514934510, "post_id": 48068964, "comment_id": 83111863, "body": "You ask SO how to be a hacker?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1514935315, "post_id": 48068964, "comment_id": 83112123, "body": "Come on @manni66 . You want this kid to learn in the back of a car?"}, {"owner": {"reputation": 3501, "user_id": 3124409, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/5922e9a9b3b7aef6002860ed4515b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Goodies", "link": "https://stackoverflow.com/users/3124409/goodies"}, "edited": false, "score": 0, "creation_date": 1514956852, "post_id": 48068964, "comment_id": 83116778, "body": "There are non-deterministic factors when compiling/building the application. The existence of stack canaries can be disabled with <code>-fno-stack-protector</code> and Positionally Independent Executable support for ASLR can be disabled with <code>-no-pie</code>. The stack is, by default, generally not executable. You must add <code>-zexecstack</code> if you would like to execute shellcode directly from the stack. If not, you&#39;re going to have to use Return Oriented Programming (sometimes called Ret2Ret), Ret2Libc, or any number of other avenues. Source: I read the Shellcoder&#39;s Handbook in the back of my mom&#39;s Toyota corolla."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 7200739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HPGXW.jpg?s=128&g=1", "display_name": "FlashDaggerX", "link": "https://stackoverflow.com/users/7200739/flashdaggerx"}, "is_accepted": false, "score": 0, "last_activity_date": 1514943448, "creation_date": 1514943448, "answer_id": 48070077, "question_id": 48068964, "link": "https://stackoverflow.com/questions/48068964/cant-overwirte-return-address-outside-of-gdb/48070077#48070077", "title": "can&#39;t overwirte return address outside of gdb", "body": "<p>If you're asking how to return check_auth(), I'd do this:</p>\n\n<pre><code>int main( int argc, char *argv[]){\n    if(argc &lt; 2){\n        printf(\"Usage: %s &lt;password&gt;\\n\\n\", argv[0]);\n        exit(0);\n    }\n\n    int flag = check_auth(argv[1]);\n\n    if(flag){\n\n        printf(\"ACCESS\\n\");\n        printf(\"GRANTED\\n\");\n    }else{\n        printf(\"\\n Access Denied\\n\");\n    }\n    return flag;\n}\n</code></pre>\n\n<p>My main language is Java, actually, so if I'm wrong, please correct me. I'm trying to learn C as we speak.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7487029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb897df6f147e46c1a210572597c6b0c?s=128&d=identicon&r=PG&f=1", "display_name": "onin", "link": "https://stackoverflow.com/users/7487029/onin"}, "edited": false, "score": 0, "creation_date": 1515254740, "post_id": 48070360, "comment_id": 83235021, "body": "Thanks a lot, you saved my day j31d0. You where right, PIE wasn&#39;t enabled. Overflows would be much more fun, if we hadn&#39;t all this security features to protect code ;D"}], "tags": [], "owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "is_accepted": false, "score": 2, "last_activity_date": 1514946004, "creation_date": 1514946004, "answer_id": 48070360, "question_id": 48068964, "link": "https://stackoverflow.com/questions/48068964/cant-overwirte-return-address-outside-of-gdb/48070360#48070360", "title": "can&#39;t overwirte return address outside of gdb", "body": "<p>I don't know about exact build settings in your development environment, but I can guess some problems.</p>\n\n<ul>\n<li><p>on current Linux environment, PIE (Position-Independent-Executive) is enabled. which means, your target address is not always <code>0x0000555555554810</code>. to check that, add this code to main function :</p>\n\n<pre><code>printf(\"CODE: %p\\n\", (void*)main);\n</code></pre>\n\n<p>if this code generates same address every times, then PIE is disabled.</p></li>\n<li><p><code>argv</code> argument cannot include NULL byte (except end of string). but this is not a critical problem because on x86-64 system they uses only 6 low bytes for virtual address.</p></li>\n</ul>\n\n<p>to disable PIE build : <em>use -no-pie</em>. <code>gcc main.c -o main -no-pie</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7487029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb897df6f147e46c1a210572597c6b0c?s=128&d=identicon&r=PG&f=1", "display_name": "onin", "link": "https://stackoverflow.com/users/7487029/onin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1514946004, "creation_date": 1514933859, "last_edit_date": 1514940249, "question_id": 48068964, "link": "https://stackoverflow.com/questions/48068964/cant-overwirte-return-address-outside-of-gdb", "title": "can&#39;t overwirte return address outside of gdb", "body": "<p>I try to use a buffer overflow on the stack to \nredirect the return address. My goal is to overwrite the return address within the \"check_auth\" function, that the main continues at line 22 (\"printf(\"GRANTED\\n\");\"). Here is the C code:</p>\n\n<pre><code>fugi@calc:~/Desktop$ gcc -g auth_overflow.c -o auth_overflow\nfugi@calc:~/Desktop$ gdb auth_overflow -q\nReading symbols from auth_overflow...done.\n(gdb) list 1\n1       #include &lt;stdio.h&gt;\n2       #include &lt;stdlib.h&gt;\n3       #include &lt;string.h&gt;\n4   \n5       int check_auth(char *pass){\n6           char pass_buff[16];\n7           int auth_flag = 0;\n8           strcpy(pass_buff, pass);\n9   \n10          if(strcmp(pass_buff, \"yes\") == 0)\n(gdb) \n11              auth_flag = 1;\n12          return auth_flag; \n13      }\n14  \n15      int main( int argc, char *argv[]){\n16          if(argc &lt; 2){\n17              printf(\"Usage: %s &lt;password&gt;\\n\\n\", argv[0]);\n18              exit(0);\n19          }\n20          if(check_auth(argv[1])){\n(gdb) \n21              printf(\"ACCESS\\n\");\n22              printf(\"GRANTED\\n\");\n23          }\n24          else{\n25              printf(\"\\n Access Denied\\n\");\n26          }\n27          return 0;\n28      }\n</code></pre>\n\n<p>I am using gdb on a 64bit Debian system, to debug the code.\nMy problem is, the overwriting doesn't work outside of gdb.</p>\n\n<p>I know, that the return address in which points back to main and the the beginning of the input variable(pass_buff) are 40 bytes appart.</p>\n\n<pre><code> (gdb) i f \n Stack level 0, frame at 0x7fffffffe170:\n rip = 0x55555555477d in check_auth (auth_overflow.c:8); saved rip = 0x555555554800\n called by frame at 0x7fffffffe190\n source language c.\n Arglist at 0x7fffffffe160, args: pass=0x7fffffffe562 'A' &lt;repeats 56 times&gt;\n Locals at 0x7fffffffe160, Previous frame's sp is 0x7fffffffe170\n Saved registers:\n rbp at 0x7fffffffe160, rip at 0x7fffffffe168\n(gdb) x/x *0x7fffffffe168\n0x55554800: Cannot access memory at address 0x55554800\n(gdb) x/x pass_buff\n0x7fffffffe140: 0x00000001\n(gdb) p 0x7fffffffe168 - 0x7fffffffe140\n$1 = 40\n</code></pre>\n\n<p>So, when I do this:</p>\n\n<pre><code>(gdb) run `python -c 'print(\"A\"*40 + \"\\x10\\x48\\x55\\x55\\x55\\x55\")'`\nStarting program: /home/fugi/Desktop/auth_overflow `python -c 'print(\"A\"*40 + \"\\x10\\x48\\x55\\x55\\x55\\x55\")'`\nGRANTED\n\nProgram received signal SIGBUS, Bus error.\nmain (argc=&lt;error reading variable: Cannot access memory at address 0x414141414141413d&gt;, \nargv=&lt;error reading variable: Cannot access memory at address 0x4141414141414131&gt;) at auth_overflow.c:28\n28      }\n</code></pre>\n\n<p>But when I do it without gdb it doesn't work:</p>\n\n<pre><code>fugi@calc:~/Desktop$ ./auth_overflow `python -c 'print(\"A\"*40 + \"\\x10\\x48\\x55\\x55\\x55\\x55\")'`\nSegmentation fault\n</code></pre>\n\n<p>What can I do to make this work?</p>\n\n<p>I also tried to do this by repeating the address, but the problem here is, that I can't print null bytes:</p>\n\n<pre><code>(gdb) x/12xg $rsp\n0x7fffffffe130: 0x00007fffffffe156  0x00007fffffffe56c\n0x7fffffffe140: 0x4141414141414141  0x4141414141414141\n0x7fffffffe150: 0x4141414141414141  0x4141414141414141\n0x7fffffffe160: 0x4141414141414141  **0x0000555555554810**\n0x7fffffffe170: 0x00007fffffffe268  0x0000000200000000\n0x7fffffffe180: 0x0000555555554840  0x00007ffff7a57561\n</code></pre>\n\n<p>to make the address fit I need to add \\x00\\x00 but then I get:</p>\n\n<pre><code>fugi@calc:~/Desktop$ ./auth_overflow `python -c 'print(\"A\"*40 + \"\\x10\\x48\\x55\\x55\\x55\\x55\\x00\\x00\")'`\n**bash: warning: command substitution: ignored null byte in input**\nSegmentation fault\n</code></pre>\n\n<p>Is there a way to repeat the address like this?</p>\n\n<p>Thanks for you help in advance</p>\n"}, {"tags": ["c", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 2799, "user_id": 1747493, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ro2p4.jpg?s=128&g=1", "display_name": "Harald", "link": "https://stackoverflow.com/users/1747493/harald"}, "edited": false, "score": 1, "creation_date": 1514933200, "post_id": 48068699, "comment_id": 83111440, "body": "Try with firstprivate (j) rather than private (j) to ensure that each private copy of j has the same value (0) assigned to it."}, {"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "reply_to_user": {"reputation": 2799, "user_id": 1747493, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ro2p4.jpg?s=128&g=1", "display_name": "Harald", "link": "https://stackoverflow.com/users/1747493/harald"}, "edited": false, "score": 0, "creation_date": 1514933450, "post_id": 48068699, "comment_id": 83111519, "body": "yes youa re right , thank you."}], "answers": [{"tags": [], "owner": {"reputation": 2799, "user_id": 1747493, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ro2p4.jpg?s=128&g=1", "display_name": "Harald", "link": "https://stackoverflow.com/users/1747493/harald"}, "is_accepted": true, "score": 1, "last_activity_date": 1514934103, "last_edit_date": 1514934103, "creation_date": 1514933591, "answer_id": 48068923, "question_id": 48068699, "link": "https://stackoverflow.com/questions/48068699/why-getting-incorrect-results-from-an-openmp-program/48068923#48068923", "title": "Why getting incorrect results from an OpenMP program?", "body": "<p>Use <code>firstprivate(j)</code> rather than <code>private(j)</code> if you want that each thread has a private copy of <strong><code>j</code></strong> with the initial value being the value before entering the parallel region.</p>\n"}], "owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 48068923, "answer_count": 1, "score": 2, "last_activity_date": 1514934103, "creation_date": 1514931983, "last_edit_date": 1514934072, "question_id": 48068699, "link": "https://stackoverflow.com/questions/48068699/why-getting-incorrect-results-from-an-openmp-program", "title": "Why getting incorrect results from an OpenMP program?", "body": "<p>I'm writing some simple example to understand how the things work with OpenMP programs.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;omp.h&gt;\n\nint main (int argc ,char* argv[]){\n    omp_set_num_threads(4);\n    int j =0;\n    #pragma omp parallel private (j)\n    {\n    int i;\n    for(i=1;i&lt;2;i++){\n        printf(\"from thread %d : i is equel to  %d and j is equal to %d\\n \",omp_get_thread_num(),i,j);\n\n    }\n    }\n}\n</code></pre>\n\n<p>So in this example I should get <strong><code>j=0</code> each time</strong>,<br>\nunfortunately the result is <strong><code>j == 0</code> 3 times</strong> , and <strong><code>j == 32707</code></strong> one time.</p>\n\n<p><strong>What is wrong with my example?</strong></p>\n"}, {"tags": ["c", "windows", "winapi"], "comments": [{"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1514932342, "post_id": 48068664, "comment_id": 83111153, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd144947(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetWindowDC</a> should still work as it is a part of the Win32 API (user32.lib)."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 4, "creation_date": 1514932502, "post_id": 48068664, "comment_id": 83111198, "body": "Please don&#39;t post external link. Insert the code in your question."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1514933275, "post_id": 48068664, "comment_id": 83111460, "body": "Hmmm ... e\u0336a\u0336t\u0336i\u0336n\u0336g\u0336 deleting my previous comments. Maybe I need to see that result. It sounds as if <code>cxSource</code> and <code>cySource</code> point to the wrong part of the window. It still is possible that &quot;frame thickness + default size&quot; is no longer a reliable way to grab the window icon, but that, or an alternative, seems not mentioned on MSDN."}, {"owner": {"reputation": 93172, "user_id": 1734130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZ5Sn.png?s=128&g=1", "display_name": "mvp", "link": "https://stackoverflow.com/users/1734130/mvp"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 2, "creation_date": 1514933945, "post_id": 48068664, "comment_id": 83111682, "body": "@BarmakShemirani: I would agree with you in general about non-linking, but in this particular case mentioning github page specifically created for Petzold book with code sample looks perfectly ok to me."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1514974100, "post_id": 48068664, "comment_id": 83123944, "body": "@BarmakShemirani For me it&#39;s not absolutely clear if publishing source code from Petzold&#39;s books on SO can be considered &quot;fair use&quot; as he writes it in his <a href=\"http://www.charlespetzold.com/faq.html\" rel=\"nofollow noreferrer\">FAQ</a>. So better safe than sorry."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1514977666, "post_id": 48068664, "comment_id": 83125880, "body": "These are stackoverflow&#39;s guidelines, not rules. You can ignore it if you wish. However the guidelines don&#39;t suggest that some websites or some authors are special. This is not a copyright issue, and it&#39;s not how copyright works. If an author doesn&#39;t want to be quoted anywhere on the internet then he can state that clearly."}], "answers": [{"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1514935109, "post_id": 48069122, "comment_id": 83112055, "body": "\ud83d\ude00 Nice work! But now I don&#39;t know how to call this one. OP is wrong in his assumption that BitBlt &quot;doesn&#39;t work the way it is supposed to&quot; \u2013 it still does. And the example code <i>does 100% what it should do</i> (copy a pretty random part of a window all over its client area)."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1514935189, "post_id": 48069122, "comment_id": 83112079, "body": "I did see some of the &quot;bitmap below the window gets sourced&quot; effect the OP talked about but it is very hard to diagnose what is going on."}, {"owner": {"reputation": 145, "user_id": 4843902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8INH.png?s=128&g=1", "display_name": "piquesel", "link": "https://stackoverflow.com/users/4843902/piquesel"}, "edited": false, "score": 0, "creation_date": 1514994400, "post_id": 48069122, "comment_id": 83135419, "body": "Thanks for the comment Anders. I didn&#39;t express myself correctly, but in fact, it&#39;s supposed to copy the small icon in the title bar. As explained by Hans, disabling Aero on the specific Window does the trick and allows to obtain the expected behavior. My point was really to make sure I understand correctly how BitBlt works. Thanks for sharing all those thoughts."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1515009019, "post_id": 48069122, "comment_id": 83143133, "body": "Yes, you can see if you look closely in my example that it is sort of transparent and part of some fast animation. DwmSetWindowAttribute does completely fix the issue."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": false, "score": 4, "last_activity_date": 1514934767, "creation_date": 1514934767, "answer_id": 48069122, "question_id": 48068664, "link": "https://stackoverflow.com/questions/48068664/why-this-bitblt-example-doesnt-work-anymore/48069122#48069122", "title": "Why this BitBlt example doesn&#39;t work anymore?", "body": "<p>It is not supposed to copy the windows icon, it is supposed to copy the windows titlebar part where the icon is located.</p>\n\n<p>There are some issues with this (now 20 year old code):</p>\n\n<ul>\n<li><p><code>GetSystemMetrics</code> values cannot be used for window related dimensions anymore since <code>GetSystemMetrics</code> returns the classic sizes, not the Visual Style sizes.</p></li>\n<li><p>Depending on the Windows version, the <a href=\"https://en.wikipedia.org/wiki/Desktop_Window_Manager\" rel=\"nofollow noreferrer\">DWM</a> might define the window size as something larger than your window (where it draws the window shadow and other effects).</p></li>\n</ul>\n\n<p>Your example works OK on XP:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wO6MR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wO6MR.png\" alt=\"XP\"></a></p>\n\n<p>(There is a small problem because the titlebar is not square (unlike Windows 98/2000 that this example was designed for) so you see a issue in the top left where it is just white. I also modified the example slightly so it varies the HDC source location)</p>\n\n<p>On a modern version of Windows it seems like the DWM or something is not able to properly emulate a simple window DC and parts of the shadow/border/effects area is part of the DC:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CJUwK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CJUwK.png\" alt=\"Windows 8\"></a></p>\n\n<p>I don't know how to fix this but the example is pretty useless anyway, if you want to draw the window icon you should draw the HICON with <code>DrawIconEx</code>. If you want to draw custom non-client area stuff then you need to find more recent examples, not something that only supports the classic theme.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 4843902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8INH.png?s=128&g=1", "display_name": "piquesel", "link": "https://stackoverflow.com/users/4843902/piquesel"}, "edited": false, "score": 1, "creation_date": 1514994193, "post_id": 48069834, "comment_id": 83135285, "body": "Thanks Hans.  You are right on spot. Adding the DwmSetWindowAttribute allows the copy of the icon located in the titlebar. The code is in fact rather old, and it&#39;s even surprising that many of the examples I tried in the book remain compliant even with the latest Windows 10."}], "tags": [], "owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": true, "score": 7, "last_activity_date": 1514979781, "last_edit_date": 1514979781, "creation_date": 1514940786, "answer_id": 48069834, "question_id": 48068664, "link": "https://stackoverflow.com/questions/48068664/why-this-bitblt-example-doesnt-work-anymore/48069834#48069834", "title": "Why this BitBlt example doesn&#39;t work anymore?", "body": "<p>Making screenshots with BitBlt() did not exactly get any easier since the addition of the DWM (Desktop Window Manager, aka Aero).  Petzold's sample code suffers from a subtle timing issue, it is making the screenshot too soon.  It does so while Aero is still busy animating the frame, fading it into view.  So you see what is behind the window, possibly already partly faded depending on how quickly the first WM_PAINT message is generated.</p>\n\n<p>You can easily fix it by disabling the effect:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;dwmapi.h&gt;\n#pragma comment(lib, \"dwmapi.lib\")\n</code></pre>\n\n<p>And after the CreateWindow() call:</p>\n\n<pre><code>BOOL disabled = TRUE;\nDwmSetWindowAttribute(hwnd, DWMWA_TRANSITIONS_FORCEDISABLED, &amp;disabled, sizeof(disabled));\n</code></pre>\n\n<p>Another tricky detail is that the <em>first</em> BitBlt matters, the DWM returns a cached copy afterwards that is not correctly invalidated by the animation.</p>\n\n<p>This gets grittier when you need a screenshot of a window that belongs to another process.  But that was already an issue before Aero, you had to wait long enough to ensure that the window was fully painted.  Notable perhaps is the perf of BitBlt(), it gets bogged-down noticeably by having to do job of composing the final image from the window back-buffers.  Lots of questions about that at SO, without happy answers.</p>\n"}], "owner": {"reputation": 145, "user_id": 4843902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8INH.png?s=128&g=1", "display_name": "piquesel", "link": "https://stackoverflow.com/users/4843902/piquesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 2, "accepted_answer_id": 48069834, "answer_count": 2, "score": 4, "last_activity_date": 1514979781, "creation_date": 1514931811, "question_id": 48068664, "link": "https://stackoverflow.com/questions/48068664/why-this-bitblt-example-doesnt-work-anymore", "title": "Why this BitBlt example doesn&#39;t work anymore?", "body": "<p>I'm currently getting back to some Windows Programming using Petzold's book (5th edition).\nI compiled the <a href=\"https://github.com/recombinant/petzold-pw5e/blob/master/Chap14/BitBlt/BitBlt.c\" rel=\"nofollow noreferrer\">following example</a> using BitBlt and it doesn't work as it is supposed to.</p>\n\n<p>It should copy the Window's icon of (CxSource, CySource) size and replicate it on the whole window's surface.\nWhat happens, in reality, using Windows 7 is that the bitmap below the window gets sourced and copied into the drawing surface i.e. hdcClient.</p>\n\n<p>I don't understand why it behaves like this knowing that it's clear the DC passed to BitBlt is hdcWindow, which refers to a device context obtained via a GetWindowDC(hwnd) of the current application.</p>\n\n<p>I first thought it was due to the fact the transparency mode is enabled by default, but deactivating it doesn't change anything. BitBlt seems to always take the surface below the application Window!\nI don't get it! :) \nAnyone knows why it works that way and how to fix it?</p>\n"}, {"tags": ["c", "floating-point", "byte", "code-composer", "single-precision"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1514930810, "post_id": 48068467, "comment_id": 83110568, "body": "You have not reversed the original (dubious) conversion."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1514930838, "post_id": 48068467, "comment_id": 83110575, "body": "Hmmm <code>aux[]</code> is<code>int[4];</code> and code is using that to <code>convert BYTE to FLOAT</code>??"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1514931048, "post_id": 48068467, "comment_id": 83110651, "body": "Is this the <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem?</a>?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1514931211, "post_id": 48068467, "comment_id": 83110714, "body": "<code>aux</code> should probably be a <code>char[4]</code> or <code>uint8_t[4]</code>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1514931507, "post_id": 48068467, "comment_id": 83110809, "body": "Neither of these conversions does a useful thing--I suspect you actually do have some meaningful conversion in mind, but I can&#39;t decipher it from this question. So what are you actually trying to accomplish?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7418724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3cd1c389ab0c791b272b375d1a62bb71?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/7418724/guilherme"}, "edited": false, "score": 0, "creation_date": 1515456469, "post_id": 48068554, "comment_id": 83299112, "body": "I&#39;m using a microcontroller that does not allow the use of the printf function, you would have another way to do the conversion (bytes to float)?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 35, "user_id": 7418724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3cd1c389ab0c791b272b375d1a62bb71?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/7418724/guilherme"}, "edited": false, "score": 0, "creation_date": 1515463013, "post_id": 48068554, "comment_id": 83300453, "body": "@Guilherme Even without <code>printf(&quot;%.8e\\n&quot;, x.f);</code>, the converted <code>float</code> is in <code>x.f</code>.  <code>printf(&quot;%.8e\\n&quot;, x.f);</code> is only for display purposes."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1514932343, "last_edit_date": 1514932343, "creation_date": 1514931163, "answer_id": 48068554, "question_id": 48068467, "link": "https://stackoverflow.com/questions/48068467/reinterpret-bytes-as-float-in-c-ieee-754-single-precision-binary/48068554#48068554", "title": "Reinterpret bytes as float in C (IEEE 754 single-precision binary)", "body": "<p>2 problems:</p>\n\n<ol>\n<li><p><code>Buff = *(float*)&amp;aux;</code> attempts to use the address of an array of 4 <code>int</code> as a pointer to a float.  <code>aux[]</code> is perhaps 16 bytes long and a <em>IEEE 754 single-precision binary</em> <code>float</code> is expected to be 4 bytes.</p></li>\n<li><p>Both casts: <code>(uint32_t*)</code> and <code>(float*)</code> invoke <em>undefined behavior</em> as well as alignment and anti-aliasing issues.  Better to use a <code>union</code>.</p>\n\n<pre><code>int main(void) {\n  union {\n    float f;\n    unsigned char uc[sizeof(float)];\n  } x;\n\n  // float to bytes\n  x.f = 1.23f;\n  printf(\"%x %x %x %x\\n\", x.uc[0], x.uc[1], x.uc[2], x.uc[3]);\n\n  // bytes to float\n  x.uc[0] = 0xA4;\n  x.uc[1] = 0x70;\n  x.uc[2] = 0x9D;\n  x.uc[3] = 0x3F;\n  printf(\"%.8e\\n\", x.f);\n}\n</code></pre></li>\n</ol>\n\n<p>Output</p>\n\n<pre><code>a4 70 9d 3f\n1.23000002e+00\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7418724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3cd1c389ab0c791b272b375d1a62bb71?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/7418724/guilherme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1514932343, "creation_date": 1514930641, "last_edit_date": 1514931904, "question_id": 48068467, "link": "https://stackoverflow.com/questions/48068467/reinterpret-bytes-as-float-in-c-ieee-754-single-precision-binary", "title": "Reinterpret bytes as float in C (IEEE 754 single-precision binary)", "body": "<p>I want to reinterpret 4 bytes as IEEE 754 single-precision binary in C.</p>\n\n<p>To obtain the bytes that represent <code>float</code>, I used:</p>\n\n<pre><code>num = *(uint32_t*)&amp;MyFloatNumber;\naux[0] = num  &amp; 0xFF;\naux[1] = (num &gt;&gt; 8) &amp; 0xFF;\naux[2] = (num &gt;&gt; 16)  &amp; 0xFF;\naux[3] = (num &gt;&gt; 24)  &amp; 0xFF;\n</code></pre>\n\n<ul>\n<li>num is a uint32_t.</li>\n<li>aux[] is int[4].</li>\n</ul>\n\n<p>To reinterpret the bytes as a <code>float</code>, I\u2019m trying:</p>\n\n<pre><code>Buff = *(float*)&amp;aux;\n</code></pre>\n\n<p>In that second case nothing apears on \"Buff\"</p>\n\n<ul>\n<li>Buff is a <code>float</code>.</li>\n</ul>\n\n<p>What am I doing wrong in the second case?</p>\n"}, {"tags": ["c", "gcc", "g++", "alignment"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1514929196, "post_id": 48068142, "comment_id": 83110007, "body": "Show us what you are doing now.  Then explain exactly what it is you expect from it and what you get instead."}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1514929260, "post_id": 48068142, "comment_id": 83110031, "body": "cpp file compiled with g++: printf(&quot;%p&quot;, &amp;data.substruct.foo) -&gt; 00a79e08. Then call cfunction_dosomething(&amp;data). Then in file compiled with gcc: cfunction_dosomething(struct data *self) -&gt; printf(&quot;%p&quot;, &amp;self-&gt;substruct.foo) -&gt; 00a79e00"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1514929630, "post_id": 48068142, "comment_id": 83110148, "body": "Oh come on. 1800 rep and you post code in comments?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1514929676, "post_id": 48068142, "comment_id": 83110164, "body": "You should put relevant code and such in the question rather than a comment.  And more context would be helpful.  Try to get it to a minimal complete verifiable example because there&#39;s just too much missing to really understand what is going on."}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514929680, "post_id": 48068142, "comment_id": 83110167, "body": "I have not isolated the issue into a small example yet. The struct data is a large hierarchical structure with many objects in it. Usually all code is C but now we have some C++ code that we use on top so we link both C and C++ code together. I have tried linking using both gcc and g++ so far. Same result."}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514930234, "post_id": 48068142, "comment_id": 83110360, "body": "HA! wouldn&#39;t you have guessed. Compiling C++ code with -std=c++14 instead of -std=c++11 makes everything work. Pathetic. gcc version 5.4.0 20160609"}, {"owner": {"reputation": 1733, "user_id": 1472459, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/583f4a0d147f136a5bbc30a29c51abbc?s=128&d=identicon&r=PG", "display_name": "Ed King", "link": "https://stackoverflow.com/users/1472459/ed-king"}, "edited": false, "score": 0, "creation_date": 1514930253, "post_id": 48068142, "comment_id": 83110368, "body": "Could it be that the struct defined in the C++ file is compiled using C++ semantics and therefore has a <code>this</code> pointer that you&#39;re not expecting to be there?"}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514930407, "post_id": 48068142, "comment_id": 83110424, "body": "How do I check? And why would it work when built as c++14 but not when built as c++11? Have the semantics changed somehow?"}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514930558, "post_id": 48068142, "comment_id": 83110476, "body": "Btw, C code is built with -std=gnu99 if that would make any difference."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 1733, "user_id": 1472459, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/583f4a0d147f136a5bbc30a29c51abbc?s=128&d=identicon&r=PG", "display_name": "Ed King", "link": "https://stackoverflow.com/users/1472459/ed-king"}, "edited": false, "score": 0, "creation_date": 1514930619, "post_id": 48068142, "comment_id": 83110510, "body": "@EdKing - What <code>this</code> pointer? A <code>this</code> pointer is an artefact of member functions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1514930676, "post_id": 48068142, "comment_id": 83110525, "body": "Put the solution in an Answer, not as an edit to the Question."}, {"owner": {"reputation": 1733, "user_id": 1472459, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/583f4a0d147f136a5bbc30a29c51abbc?s=128&d=identicon&r=PG", "display_name": "Ed King", "link": "https://stackoverflow.com/users/1472459/ed-king"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1514930906, "post_id": 48068142, "comment_id": 83110592, "body": "@StoryTeller - Sorry, I actually meant the default constructor, and whether that was putting things out of bonk."}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514941097, "post_id": 48068142, "comment_id": 83113509, "body": "I have posted my solution below."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1515078835, "post_id": 48068142, "comment_id": 83171306, "body": "You might be able to make <code>-pedantic</code> less of a pain by having it used only on a single <code>.c</code> file that includes all the headers you&#39;re concerned about instead of using it across all <code>.c</code> files.  Apply it only to the simplest <code>.c</code> file so warnings will only be triggered for code/declarations in the headers. Or maybe even add a special file to your build that does nothing but include the headers for the purpose of getting the pedantic warnings for the headers."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1515078914, "post_id": 48068142, "comment_id": 83171352, "body": "I&#39;m also curious if the C++11 vs C++14 difference was a red herring or if G++ actually treats empty structs differently somehow between those two language versions."}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1515132558, "post_id": 48068142, "comment_id": 83191506, "body": "Yes standard switch turned out to be a false positive."}], "answers": [{"tags": [], "owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1514941046, "creation_date": 1514941046, "answer_id": 48069861, "question_id": 48068142, "link": "https://stackoverflow.com/questions/48068142/gcc-and-g-struct-packing-differences/48069861#48069861", "title": "GCC and G++ struct packing differences?", "body": "<p>The proper solution seems to be to never define empty structs in code that will be used across C++ -> C boundary. I had a:</p>\n\n<pre><code>struct spinlock { } \n</code></pre>\n\n<p>that was empty when building against a single processor target. So g++ would make this 1 byte while gcc would just discard it. Therefore my structs would be different size and offsetof would even return different results depending on whether the code was built with gcc or g++. </p>\n\n<p>So I changed it to </p>\n\n<pre><code>struct spinlock { uint8_t dummy; }\n</code></pre>\n\n<p>and now my structs align perfectly and everything works without any special C++ standard specification. </p>\n"}, {"comments": [{"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514944646, "post_id": 48070018, "comment_id": 83114217, "body": "Do you know how to make it warn about empty structs without having to use -pedantic? (pedantic breaks things like switch ranges and basically all other elegant extensions)"}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514945381, "post_id": 48070018, "comment_id": 83114348, "body": "What&#39;s really disturbing is that the behavior is different between gcc and g++. Had it been the same, code would at least work correctly when something that contains empty structs gets defined in c++ and then passed to a c function. When things work differently in this way it creates really hard to find overflows. C code will think that all data after the empty struct is in a completely different place from where it really is if the struct was declared in a c++ file."}, {"owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514945887, "post_id": 48070018, "comment_id": 83114438, "body": "Since it passes compilation just fine without -pedantic, everything will work fine MOST of the time because C++ struct will always be bigger and if only C code operates on the struct data nothing will break. Until you try to set struct members in C++ and pass the struct to underlying C code for processing only to discover later that C code sees a totally different picture shifted by 1, 2, 3 or more bytes."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "edited": false, "score": 0, "creation_date": 1514968803, "post_id": 48070018, "comment_id": 83121248, "body": "I don&#39;t know of a way to disable or warn on the C zero-sized struct extension.  You are right that there should be a way to disable it (or force it to act the same as C++) since it silently causes the incompatibility that you ran into.  If you opened a GCC bug on this, I suspect they&#39;d be open to adding such an option, but even so it would likely be years.  It&#39;s far from an ideal suggestion, but if you&#39;re using a unit test framework you could probably come up with fairly simple tests that verify that C and C++ see structures as having the same size/layout."}], "tags": [], "owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "is_accepted": false, "score": 1, "last_activity_date": 1514943210, "last_edit_date": 1514943210, "creation_date": 1514942735, "answer_id": 48070018, "question_id": 48068142, "link": "https://stackoverflow.com/questions/48068142/gcc-and-g-struct-packing-differences/48070018#48070018", "title": "GCC and G++ struct packing differences?", "body": "<p>Empty structures gets you a couple of implementation defined or non-standard behaviors.  First of all empty structures aren't supported in standard C. GCC supports them in as an extension with a size == 0.  </p>\n\n<p>C++ supports empty structs, but mandates that they have a non-zero size when used as a \"most derived object\". However, C++ also allows classes/structs that inherit from empty structs to optimize that size away for the subclass.  </p>\n"}], "owner": {"reputation": 3226, "user_id": 2929762, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/875979833128b726a51baf1814c9496f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2929762/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1514945115, "creation_date": 1514928774, "last_edit_date": 1514945115, "question_id": 48068142, "link": "https://stackoverflow.com/questions/48068142/gcc-and-g-struct-packing-differences", "title": "GCC and G++ struct packing differences?", "body": "<p>I'm using C code in my C++ project which I include using extern \"C\". I then define structs in my C++ class which are passed to the C code (compiled using gcc). The problem is that when that C code accesses the struct that was defined in the C++ class, I get different alignment and the code reads and writes WRONG data. This seems bizarre but I have been debugging this for 3 hours and basically when I print pointer to a deep member of that struct from C++ code, everything is fine. But if I print the pointer from within C code, the address is different! </p>\n\n<p>Why is this happening and how do I ensure that my alignment is consistent?</p>\n\n<p>(I have double checked that this is NOT an out of date compilation issue by recompiling everything. Still same result. In C the address is 8 bytes before the address to the member as reported in C++ code)</p>\n\n<p><strong>Edit: the problem was that g++ and gcc would treat empty structs differently. If I had an empty struct foo {} in my code, sizeof my struct would be 1 byte bigger under g++ and all offsets of members would be messed up. So I put a dummy uint8_t into the empty struct so that it would not be empty anymore and all such problems across the codebase seem to have disappeared. Now alignment seems to work the same and struct size is the same as well (for each empty struct g++ would previously add 1 byte). I am not 100% sure what is going on with gcc so if anyone is has anything to add then feel free to fill me in on this</strong></p>\n\n<p>My gcc version is:</p>\n\n<pre><code>Using built-in specs.\nCOLLECT_GCC=g++\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 5.4.0-6ubuntu1~16.04.5' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 5.4.0 20160609\n</code></pre>\n\n<p>My compilation flags under gcc are:</p>\n\n<pre><code>-std=gnu99 -Wchar-subscripts -Wformat -Wformat-nonliteral -Wformat-security -Wmissing-braces -Wparentheses -Wsequence-point -Wswitch -Wtrigraphs -Wno-unused-function -Wunused-label -Wno-unused-parameter -Wunused-variable -Wunused-value -Wuninitialized -Wdiv-by-zero -Wfloat-equal -Wdouble-promotion -fsingle-precis\nion-constant -Wshadow -Wpointer-arith -Wwrite-strings -Wconversion -Wredundant-decls -Wunreachable-code -Winline -Wenum-compare -Wlong-long -Wchar-subscripts -Wextra -Werror -g -Os -ffunction-sections -fdata-sections -m32 -fstack-protector -D_XOPEN_SOURCE=700 -D_GNU_SOURCE -ftest-coverage -fprofile-arcs\n</code></pre>\n\n<p>g++</p>\n\n<pre><code>-std=c++11 -Wextra -Werror -g -Os -ffunction-sections -fdata-sections -m32 -fstack-protector -D_XOPEN_SOURCE=700 -D_GNU_SOURCE -ftest-coverage -fprofile-arcs\n</code></pre>\n\n<p><strong>Edit2: added -pedantic to my C flags to make gcc warn about empty structs. Dropped it previously because it broke many other things and third party headers (we have to use -Werror). Luckily things like macro ({}) statements can be prefixed with __extension__ to make them pass -pedantic. Got a few other things that need to be changed in the codebase. Don't know yet if something will be hard to implement with pedantic enabled. Does anyone know how to only enable warning for empty structs or disable some specific things that pedantic does not allow?</strong></p>\n"}, {"tags": ["android", "c++", "ios", "c"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1514927952, "post_id": 48067940, "comment_id": 83109492, "body": "It probably comes with the compiler. Like Xcode for iOS."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1514928016, "post_id": 48067940, "comment_id": 83109519, "body": "Those libraries come with NDK C/C++ toolchains, and most likely are stuffed into the resulting .apk. Several implementations of C++ standard library are included, from which you can choose."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1514929030, "post_id": 48067940, "comment_id": 83109944, "body": "c and c++ library are different thing. C runtime library is a part of any Linux distribution, so android has to have it. I imagine, iOS is the same thing, since it is Unixy in nature. C++ is a different thing, and probably has to be a separate library inside .apk."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1514929576, "post_id": 48067940, "comment_id": 83110131, "body": "Read: <a href=\"https://developer.android.com/ndk/guides/cpp-support.html\" rel=\"nofollow noreferrer\">developer.android.com/ndk/guides/cpp-support.html</a>"}, {"owner": {"reputation": 239, "user_id": 9163035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada6468289ad5530b418cc1041d3490c?s=128&d=identicon&r=PG&f=1", "display_name": "user9163035", "link": "https://stackoverflow.com/users/9163035/user9163035"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1514931440, "post_id": 48067940, "comment_id": 83110791, "body": "@SergeyA You seemed confused. The CRT and C library are two different things. You have different C libraries, like glibc, uClibc, and newlib which are platform independent. The CRT is platform-dependent. This is going to be a combination of the kernel and files provided by the compiler (see <code>crt0.o</code>, et al.) It is not Linux/Unix specific by any means, nor does it imply that Androis/iOS are forced to use the same CRT/C library."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1514931585, "post_id": 48067940, "comment_id": 83110838, "body": "On iOS with Apple\u2019s tools (Xcode and an iOS SDK), the C standard library is part of general support libraries supplied with the system and rolled up into files integrated with the OS. Also, the compiler is very smart about some things, so some of your library calls may be replaced at compile time (e.g., <code>memcpy</code> might become move instructions, and <code>pow(x, 2)</code> may become <code>x*x</code>). You might be able to link with your own implementations of C library routines instead of Apple\u2019s, but why would you want to? Everything you need should be present once you install Xcode with an iOS SDK."}, {"owner": {"reputation": 3309, "user_id": 7690376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VfvVx.jpg?s=128&g=1", "display_name": "Lluis Felisart", "link": "https://stackoverflow.com/users/7690376/lluis-felisart"}, "edited": false, "score": 0, "creation_date": 1514934477, "post_id": 48067940, "comment_id": 83111856, "body": "There is no such option to write the entire Android application, in C/C++. The Android API and its class library are Java and for example to create the main Activity you have to create a Java object."}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 9163035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada6468289ad5530b418cc1041d3490c?s=128&d=identicon&r=PG&f=1", "display_name": "user9163035", "link": "https://stackoverflow.com/users/9163035/user9163035"}, "is_accepted": true, "score": 7, "last_activity_date": 1514933241, "last_edit_date": 1514933241, "creation_date": 1514932859, "answer_id": 48068827, "question_id": 48067940, "link": "https://stackoverflow.com/questions/48067940/where-is-the-c-c-standard-library-in-android-and-ios/48068827#48068827", "title": "Where is the C/C++ Standard Library in Android and iOS?", "body": "<p>There are several concepts at play here, I'm going to try to keep it brief. Android uses <a href=\"https://en.wikipedia.org/wiki/Bionic_(software)\" rel=\"noreferrer\">Bionic</a> as its C library. It also lists <a href=\"https://developer.android.com/ndk/guides/cpp-support.html\" rel=\"noreferrer\">different C++ libraries</a>, however, they recommend you stick with libc++ (Clang) since they have stopped supporting libstdc++ (what they call gnustl) and STLPort is ancient. Now even though they call <code>libstdc++</code> the system runtime, for <code>libstdc++</code> in particular, the support library is called actually <a href=\"http://wiki.osdev.org/Libsupcxx\" rel=\"noreferrer\">libsupc++</a>. In order to have exception and RTTI support, you need to implement/build this, which doesn't seem to be the case for Android. </p>\n\n<p>For Apple, it's a different story. XCode is the IDE (not the compiler!) On old versions of Mac, they shipped an ancient version of GCC. There was a transition period where they used <code>llvm-gcc</code> and symlinked <code>gcc</code> to <code>clang</code>. Now the latest version of XCode only supports LLVM/Clang. By default, Mac uses libc++, but you can select libstdc++ if you prefer. Keep in mind that although Clang tries to be as ABI-compatible with GCC as possible, it's probably not wise to mix libraries compiled by libc++/libstdc++.</p>\n\n<p>Can you use a different C library in your toolchain? Not easily. You would need to port the C library of choice (i.e, Newlib) to the platform which is not trivial. Further, you would need to build a cross compiler toolchain that not only targets that system but also uses the new library. You will have to look into people who have already done this for you.</p>\n\n<p>Now even if it was easy, there really isn't a good reason to. More often than not you only want to swap out selective parts of the library, like <code>malloc</code>. Android in particular can use <a href=\"https://android.googlesource.com/platform/external/jemalloc/\" rel=\"noreferrer\">jemalloc</a> for example.</p>\n"}], "owner": {"reputation": 1709, "user_id": 3296421, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2d5NH.png?s=128&g=1", "display_name": "Ignorant", "link": "https://stackoverflow.com/users/3296421/ignorant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1508, "favorite_count": 1, "accepted_answer_id": 48068827, "answer_count": 1, "score": 4, "last_activity_date": 1514933241, "creation_date": 1514927763, "question_id": 48067940, "link": "https://stackoverflow.com/questions/48067940/where-is-the-c-c-standard-library-in-android-and-ios", "title": "Where is the C/C++ Standard Library in Android and iOS?", "body": "<p>As far as I know one can can write apps on Android and iOS in C/C++, instead of Java and Objective-C. </p>\n\n<p>Since both C and C++ rely upon their Standard Libraries, where and how the C/C++ Standard Library is implemented in such OSes? Is it part of something bigger like e.g. the Android NDK? If it isn't, can I use a different implementation if needed?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1514924917, "post_id": 48067359, "comment_id": 83108236, "body": "Where does <code>malloc(5 * sizeof(int))</code> come from? I don&#39;t see any array of 5 ints anywhere."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514924960, "post_id": 48067359, "comment_id": 83108250, "body": "I was on that too, are you guessing that a pointer is twice the size of <code>int</code>? <code>curr = malloc(sizeof(*curr));</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514925168, "post_id": 48067359, "comment_id": 83108345, "body": "There are too many magic numbers. The <code>10</code> used twice in the <code>initialize</code> function is unrelated to the <code>10</code> passed to that function? Suppose you want <code>20</code>- which <code>10</code>s do you find/replace?"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 6, "last_activity_date": 1514925198, "last_edit_date": 1514925198, "creation_date": 1514924742, "answer_id": 48067382, "question_id": 48067359, "link": "https://stackoverflow.com/questions/48067359/c-list-incorrect-checksum-for-object-being-freed/48067382#48067382", "title": "C List incorrect checksum for object being freed", "body": "<pre><code>int* bigger_arr = realloc(x-&gt;vals, (2 * x-&gt;max_allowed));\n</code></pre>\n\n<p>will be</p>\n\n<pre><code>int* bigger_arr = realloc(x-&gt;vals, (2 * x-&gt;max_allowed*sizeof(int)));\n</code></pre>\n\n<p>But the way you <code>realloc</code> is wrong, given that <code>realloc</code> may fail also. You should check what it returns before you assign it.</p>\n\n<p>Also <code>curr = malloc(5 * sizeof(int));</code> will be \n<code>curr = malloc(sizeof(List));</code> because <em>for strutures you can't calculate the allocated memory it would need by adding size of individual member elements</em>. There is always a possibility of having padding in which case it would fail. </p>\n"}], "owner": {"reputation": 101, "user_id": 2701720, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/801cca1dff7f8ad9012eba2c01b68e80?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/2701720/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 48067382, "answer_count": 1, "score": 1, "last_activity_date": 1514925198, "creation_date": 1514924624, "question_id": 48067359, "link": "https://stackoverflow.com/questions/48067359/c-list-incorrect-checksum-for-object-being-freed", "title": "C List incorrect checksum for object being freed", "body": "<p>I am trying to write a C Struct for a resizing array and am getting the error: </p>\n\n<pre><code>a.out(34254,0x7fffa17b7340) malloc: *** error for object \n0x7fdd39c02908: incorrect checksum for freed object - object was \nprobably modified after being freed.\n*** set a breakpoint in malloc_error_break to debug\n[1]    34254 abort      ./a.out\n</code></pre>\n\n<p>This is the code I currently have: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\ntypedef struct List {\n    int length;\n    int *vals; // This should be generic somehow\n    int curr_inserted;\n    int max_allowed; \n} List; \n\nList *initialize(int val) {\n    List *curr; \n    curr = malloc(5 * sizeof(int));\n    if (curr == NULL) {\n        printf(\"Memory Allocation Error\\n\");\n        exit(1);\n    } else {\n        curr-&gt;length = 1; \n        curr-&gt;vals = malloc(10 * sizeof(int));\n        curr-&gt;vals[0] = val; \n        curr-&gt;curr_inserted = 1; \n        curr-&gt;max_allowed = 10; \n    }\n    return curr; \n}\nvoid add(List *x, int val) {\n    if (x-&gt;curr_inserted == x-&gt;max_allowed) {\n        int* bigger_arr = realloc(x-&gt;vals, (2 * x-&gt;max_allowed));\n        x-&gt;vals = bigger_arr;\n        x-&gt;max_allowed *= 2;\n    }\n    x-&gt;vals[x-&gt;curr_inserted] = val; \n    x-&gt;length++;\n    x-&gt;curr_inserted++;\n}\n</code></pre>\n\n<p>And I am initialzing and checking the values like this: </p>\n\n<pre><code>int main() {\n    List *x = initialize(10);\n    for (int i = 0; i &lt; 100; i++) {\n        add(x,i); \n    }\n    for (int i =0; i &lt; x-&gt;length; i++) {\n        printf(\"val %d is %d\\n\",i,x-&gt;vals[i]);\n    }\n    free(x);\n    return 0; \n}\n</code></pre>\n\n<p>I believe the error is in the add method where I attempt to resize, but I can not quite figure out how to approach this error. </p>\n"}, {"tags": ["c", "pointers", "nullptr"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1514923012, "post_id": 48066935, "comment_id": 83107376, "body": "You really want to get out of the habit of stubbing that &quot;Not enough RAM&quot; code into every single allocation call. This is going to clutter up your code with an extraordinary number of these things. If you&#39;re concerned about allocation failures write a macro that does that so you have a single place to test for failures, not dozens, hundreds, potentially thousands of independent instances of that."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1514923102, "post_id": 48066935, "comment_id": 83107413, "body": "Another thing to consider from a simplicity and performance perspective is to store the matrix data as a one dimensional array and emulate the other dimensions. A 16 element array is far more efficient than a 4-element pointer array plus an additional 4 times 4 element arrays. The second tier elements can be allocated all over the place which is going to be punishing from a cache perspective."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1514924252, "post_id": 48066935, "comment_id": 83107928, "body": "This is lots of code to find a small bug. Please take your time to provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Also, don&#39;t cast malloc. You don&#39;t need to."}, {"owner": {"reputation": 13, "user_id": 9165267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A4MprhrBoXQ/AAAAAAAAAAI/AAAAAAAAE8Q/8-0HX4n_rmI/photo.jpg?sz=128", "display_name": "Aviel Cohen", "link": "https://stackoverflow.com/users/9165267/aviel-cohen"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1514924545, "post_id": 48066935, "comment_id": 83108072, "body": "Thanks i will use your advices. @klutt,@tadman"}, {"owner": {"reputation": 768, "user_id": 1195482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13b87b51e4e584a8b990895aaa0361fe?s=128&d=identicon&r=PG", "display_name": "dwilliss", "link": "https://stackoverflow.com/users/1195482/dwilliss"}, "edited": false, "score": 1, "creation_date": 1514925624, "post_id": 48066935, "comment_id": 83108536, "body": "<code>c</code> is a pointer-to-a-pointer-to-int.  Since <code>c</code> is initialized as null, then <code>*c</code> will throw an exception.  It&#39;s not clear what you&#39;re actually trying to do with that allocation."}, {"owner": {"reputation": 13, "user_id": 9165267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A4MprhrBoXQ/AAAAAAAAAAI/AAAAAAAAE8Q/8-0HX4n_rmI/photo.jpg?sz=128", "display_name": "Aviel Cohen", "link": "https://stackoverflow.com/users/9165267/aviel-cohen"}, "reply_to_user": {"reputation": 768, "user_id": 1195482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13b87b51e4e584a8b990895aaa0361fe?s=128&d=identicon&r=PG", "display_name": "dwilliss", "link": "https://stackoverflow.com/users/1195482/dwilliss"}, "edited": false, "score": 0, "creation_date": 1514925811, "post_id": 48066935, "comment_id": 83108637, "body": "thanks @dwilliss but someone already helped me. :)"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 0, "last_activity_date": 1514925824, "last_edit_date": 1514925824, "creation_date": 1514922532, "answer_id": 48066957, "question_id": 48066935, "link": "https://stackoverflow.com/questions/48066935/pointer-was-nullptr-error-in-c-programming/48066957#48066957", "title": "*pointer was nullptr* error in C programming", "body": "<pre><code>(*pMat)[i] = (int *)malloc(col * sizeof(int*));\n</code></pre>\n\n<p>will be</p>\n\n<pre><code>(*pMat)[i] = malloc(col * sizeof(int));\n</code></pre>\n\n<p>You have allocated space for <code>col</code> number of <code>int*</code> where you are reading <code>int</code>-s. </p>\n\n<p>Also </p>\n\n<pre><code>**c = (int*)malloc(size1 * sizeof(int*));\n</code></pre>\n\n<p>will be</p>\n\n<pre><code>c = malloc(size1 * sizeof(int*));\n</code></pre>\n\n<p>Otherwise you were trying to dereference NULL value which <em>triggered the error you got</em>.</p>\n\n<p>Also the loop will be</p>\n\n<pre><code>for (i = 0; i &lt; size1; i++) {\n    c[i] = malloc(size3 * sizeof(int));\n    if (c[i] == NULL) {\n        printf(\"*Not enough RAM.\\nTerminating.\\n\");\n        FreeMatrix(&amp;c, size1);\n        exit(1);\n    }\n\n    for (j = 0; j &lt; size3; j++) {\n        c[i][j]=0;\n        for (k = 0; k &lt; size2; k++) {\n            c[i][j] += (a[i][k] * b[k][j]);\n        }\n    }\n}\n</code></pre>\n\n<p>Don't cast the return value of <code>malloc</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9165267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-A4MprhrBoXQ/AAAAAAAAAAI/AAAAAAAAE8Q/8-0HX4n_rmI/photo.jpg?sz=128", "display_name": "Aviel Cohen", "link": "https://stackoverflow.com/users/9165267/aviel-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 48066957, "answer_count": 1, "score": -2, "last_activity_date": 1514925824, "creation_date": 1514922448, "last_edit_date": 1514925632, "question_id": 48066935, "link": "https://stackoverflow.com/questions/48066935/pointer-was-nullptr-error-in-c-programming", "title": "*pointer was nullptr* error in C programming", "body": "<p>I have a serious problame.</p>\n\n<p>at the line <code>**c = (int*)malloc(size1 * sizeof(int*));</code>\nthe compiler gives me this error which I don't really know what it says.</p>\n\n<blockquote>\n  <p>Unhandled exception thrown: read access violation.<br>\n      <strong>c</strong> was nullptr. occurred</p>\n</blockquote>\n\n<p>I don't know what I'm doing wrong..\nI initialize every pointer like this.</p>\n\n<pre><code>void BuildMatrix(int ***, int, int);\nvoid FreeMatrix(int ***, int);\nvoid PrintMatrix(int **, int, int);\nint **MultiplyMatrixes(int **, int**, int, int, int);\n\nint main() {\n    int **matrix1 = NULL, **matrix2 = NULL, **matrix3 = NULL;\n    int * newCol = NULL;\n    int size1, size2, size3, newRow;\n\n    printf(\"-How many rows in the first matrix?: \");\n    scanf(\"%d\", &amp;size1);\n    printf(\"-How many columns in the first matrix and second?[size2, size3]: \");\n    scanf(\"%d %d\", &amp;size2, &amp;size3);  /*size2 = rows of matrix2.*/\n\n    /*Build both matrices*/\n    printf(\"-First matrix input.\\n\");\n    BuildMatrix(&amp;matrix1, size1, size2);\n    PrintMatrix(matrix1, size1, size2);\n    printf(\"-Second matrix input.\\n\");\n    BuildMatrix(&amp;matrix2, size2, size3);\n    PrintMatrix(matrix2, size2, size3);\n\n    /*Combine the 2 matrices to a new matrix*/\n    matrix3 = MultiplyMatrixes(matrix1, matrix2, size1, size2, size3);\n    FreeMatrix(&amp;matrix2, size2); //Free the second matrix\n\n    printf(\"\\n-Multiplied matrix: \\n\");\n    PrintMatrix(matrix3, size1, size3);\n\n    FreeMatrix(&amp;matrix3, size1);\n    FreeMatrix(&amp;matrix1, size1);\n}\nvoid BuildMatrix(int *** pMat, int row, int col) {\n    int i, j;\n    (*pMat) = (int **)malloc(row * sizeof(int*));\n    if (*pMat == NULL) {\n        free(pMat);\n        printf(\"*Not enough RAM.\\nTerminating.\\n\");\n        exit(1);\n    }\n    for (i = 0; i &lt; row; i++) {\n        (*pMat)[i] = (int *)malloc(col * sizeof(int*));\n        if ((*pMat)[i] == NULL) {\n            printf(\"*Not enough RAM.\\nTerminating.\\n\");\n            FreeMatrix(pMat, row);\n            exit(1);\n        }\n        for (j = 0; j &lt; col; j++) {\n            printf(\"-Enter %d element in %d row: \", j + 1, i + 1);\n            scanf(\"%d\", &amp;(*pMat)[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    //FreeMatrix(pMat, row);\n}\nvoid PrintMatrix(int ** pMat, int row, int col) {\n    for (int i = 0; i &lt; row; ++i) {\n        for (int j = 0; j &lt; col; ++j) {\n            printf(\"%d \", pMat[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\nint** MultiplyMatrixes(int ** a, int ** b, int size1, int size2, int size3) {\n    int i, j, k, **c = NULL;\n    **c = (int*)malloc(size1 * sizeof(int*));\n    if (c == NULL) {\n        free(*c);\n        printf(\"*Not enough RAM.\\nTerminating.\\n\");\n        exit(1);\n    }\n    for (i = 0; i &lt; size1; i++) {\n\n        for (j = 0; j &lt; size3; j++) {\n            c[i] = (int *)malloc(size3 * sizeof(int));\n            if (c[i] == NULL) {\n                printf(\"*Not enough RAM.\\nTerminating.\\n\");\n                FreeMatrix(&amp;c, size1);\n                exit(1);\n            }\n            for (k = 0; k &lt; size2; k++) {\n                c[i][j] += (a[i][k] * b[k][j]);\n            }\n        }\n    }\n    return c;\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "qsort"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1514920532, "post_id": 48066494, "comment_id": 83106367, "body": "And if the problem is what the fragments you&#39;ve presented so far suggest it might be, then you need to pay attention to your compiler&#39;s warnings, and to turn them on if you&#39;re not getting any."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1514921761, "post_id": 48066494, "comment_id": 83106857, "body": "It is not legal to pass <code>struct personalData * data[10];</code> as first parameter of <code>weightSort</code>. The types are not compatible. How did you manage to pull this off? What does your calling code look like?"}, {"owner": {"reputation": 137, "user_id": 4796735, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/e8tbT.jpg?s=128&g=1", "display_name": "patryk-szwed", "link": "https://stackoverflow.com/users/4796735/patryk-szwed"}, "edited": false, "score": 0, "creation_date": 1514922303, "post_id": 48066494, "comment_id": 83107067, "body": "I&#39;m getting no errors at the moment as I&#39;ve changed some things, thanks to the answers, and the program doesn&#39;t crash but still pointers point to some rubbish. I&#39;ll change the code in a moment."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4796735, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/e8tbT.jpg?s=128&g=1", "display_name": "patryk-szwed", "link": "https://stackoverflow.com/users/4796735/patryk-szwed"}, "edited": false, "score": 0, "creation_date": 1514921267, "post_id": 48066608, "comment_id": 83106660, "body": "I changed it but it doesn&#39;t fix the problem. But thanks for the advice."}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 3, "last_activity_date": 1514920774, "creation_date": 1514920774, "answer_id": 48066608, "question_id": 48066494, "link": "https://stackoverflow.com/questions/48066494/qsort-doesnt-sort-data-from-structure/48066608#48066608", "title": "qsort() doesn&#39;t sort data from structure", "body": "<p>The signature for the <a href=\"http://en.cppreference.com/w/c/algorithm/qsort\" rel=\"nofollow noreferrer\"><code>qsort</code></a> comparison function is</p>\n\n<pre><code>int (*comp)(const void *, const void *) \n</code></pre>\n\n<p>Returning a <code>float</code> does not work at all.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 4796735, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/e8tbT.jpg?s=128&g=1", "display_name": "patryk-szwed", "link": "https://stackoverflow.com/users/4796735/patryk-szwed"}, "edited": false, "score": 1, "creation_date": 1514922911, "post_id": 48066733, "comment_id": 83107328, "body": "Thanks for your answer. I thought the declaration isn&#39;t suitable for these objects. However, I was given it and supposed to use that declaration but in my opinion it was a mistake. I&#39;ve changed your suggestions in my code but p1-&gt;weight and p2-&gt;weight still point to nothing sensible. As a result, qsort() doesn&#39;t sort the data. I&#39;ve put these changes in the code in the question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 137, "user_id": 4796735, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/e8tbT.jpg?s=128&g=1", "display_name": "patryk-szwed", "link": "https://stackoverflow.com/users/4796735/patryk-szwed"}, "edited": false, "score": 0, "creation_date": 1514927234, "post_id": 48066733, "comment_id": 83109213, "body": "@botq, you did not address one of the key issues I pointed out in my answer: &quot;since the elements you are sorting are pointers to structures, the arguments presented to the comparison function will be pointers to such pointers. You treat them instead as pointers directly to structures.&quot;  Thus, <i>of course</i> <code>p1-&gt;weight</code> and <code>p2-&gt;weight</code> do not point to anything sensible.  No matter how you cast them, these pointers point to other pointers, not to objects of type <code>personalData</code>."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 7, "last_activity_date": 1514921491, "creation_date": 1514921491, "answer_id": 48066733, "question_id": 48066494, "link": "https://stackoverflow.com/questions/48066494/qsort-doesnt-sort-data-from-structure/48066733#48066733", "title": "qsort() doesn&#39;t sort data from structure", "body": "<p>This array declaration:</p>\n\n<blockquote>\n<pre><code>struct personalData * data[10];\n</code></pre>\n</blockquote>\n\n<p>does not declare an object suitable for use as the first parameter to</p>\n\n<blockquote>\n<pre><code>void weightSort(personalData data[], int len)\n</code></pre>\n</blockquote>\n\n<p>The variable and function parameter have different levels of indirection.  Your actual data is an array of <em>pointers to</em> <code>struct personalData</code>, whereas the function parameter is appropriate for an array of the structures themselves.  This produces undefined behavior.  Probably more functionally relevant, the item size that you pass to <code>qsort()</code> is therefore incorrect: with the data as declared in <code>main()</code>, you want as item size not the size of <code>struct personalData</code>, but rather the size of a pointer to one (<code>sizeof(struct personalData *)</code>).</p>\n\n<p>Furthermore, your comparison function is wrong.  In the first place, it must return an <code>int</code>, not a <code>float</code>, but in the second place, since the elements you are sorting are pointers to structures, the arguments presented to the comparison function will be pointers to such pointers.  You treat them instead as pointers directly to structures.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 4796735, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/e8tbT.jpg?s=128&g=1", "display_name": "patryk-szwed", "link": "https://stackoverflow.com/users/4796735/patryk-szwed"}, "edited": false, "score": 0, "creation_date": 1514924878, "post_id": 48067317, "comment_id": 83108215, "body": "That&#39;s it! Thanks a lot."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1514924396, "creation_date": 1514924396, "answer_id": 48067317, "question_id": 48066494, "link": "https://stackoverflow.com/questions/48066494/qsort-doesnt-sort-data-from-structure/48067317#48067317", "title": "qsort() doesn&#39;t sort data from structure", "body": "<p>Your comparison function receives pointers to two elements of the list, each of which is also a pointer.  So the real type of each parameter is <code>personalData **</code>, but you cast them to <code>personalData *</code>.  So you're treating a pointer as a structure instance, which is why you're seeing garbage.</p>\n\n<p>You need to add an additional level of indirection in your comparison function:</p>\n\n<pre><code>int structSortWeight(const void *a, const void *b)\n{\n    // no need to cast from void *\n    const personalData **p1 = a;\n    const personalData **p2 = b;\n\n    return ((*p1)-&gt;weight - (*p2)-&gt;weight);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 4796735, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/e8tbT.jpg?s=128&g=1", "display_name": "patryk-szwed", "link": "https://stackoverflow.com/users/4796735/patryk-szwed"}, "edited": false, "score": 1, "creation_date": 1514931235, "post_id": 48067892, "comment_id": 83110723, "body": "Very useful advice. That fixed my next problem as some close weights wasn&#39;t sorted by qsort(). Thank you."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1514927829, "last_edit_date": 1514927829, "creation_date": 1514927459, "answer_id": 48067892, "question_id": 48066494, "link": "https://stackoverflow.com/questions/48066494/qsort-doesnt-sort-data-from-structure/48067892#48067892", "title": "qsort() doesn&#39;t sort data from structure", "body": "<p><code>return (p1-&gt;weight - p2-&gt;weight);</code> is not a suitable compare. This subtracts 2 <code>float</code> values and converts to <code>int</code>.   The compare function must return the sensible consistent results.</p>\n\n<p>Consider weights A,B,C: 1.1, 2.0, 2.9.</p>\n\n<p>Comparing f(A,B) returns <code>int</code> 0.<br>\nComparing f(B,C) returns <code>int</code> 0.<br>\nComparing f(A,C) returns <code>int</code> 1.  // This does not make sense if A==B and B==C</p>\n\n<p>This inconsistency can fool <code>qsort()</code> resulting in <em>undefined behavior</em> (UB).</p>\n\n<p>A better compare function</p>\n\n<pre><code>int structSortWeight2(const void *a, const void *b) {\n    const personalData **p1 = (const personalData **)a;\n    const personalData **p2 = (const personalData **)b;\n    // 2 compares are done, each returning an `int`\n    return ((*p1)-&gt;weight &gt; (*p2)-&gt;weight) - ((*p1)-&gt;weight &lt; (*p2)-&gt;weight);\n}\n</code></pre>\n\n<p>Code has other issues as detailed in <a href=\"https://stackoverflow.com/a/48066733/2410359\">@John Bollinger</a></p>\n"}], "owner": {"reputation": 137, "user_id": 4796735, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/e8tbT.jpg?s=128&g=1", "display_name": "patryk-szwed", "link": "https://stackoverflow.com/users/4796735/patryk-szwed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 48067317, "answer_count": 4, "score": 0, "last_activity_date": 1514927829, "creation_date": 1514920251, "last_edit_date": 1514924474, "question_id": 48066494, "link": "https://stackoverflow.com/questions/48066494/qsort-doesnt-sort-data-from-structure", "title": "qsort() doesn&#39;t sort data from structure", "body": "<p>I've got a structure:</p>\n\n<pre><code>typedef struct personalData\n{\n    char name[20];\n    char * remarks;\n    int age;\n    float weight;\n} personalData;\n</code></pre>\n\n<p>I need to sort data by weight using <code>qsort()</code>. Here's my <code>weightSort</code> function:</p>\n\n<pre><code>void weightSort(personalData * data[], int len)\n{\n    qsort(data, len, sizeof(struct personalData *), structSortWeight);\n}\n</code></pre>\n\n<p>where <code>len</code> = 10(calculated before using some different functions, but it probably doesn't matter), <code>data[]</code> is defined in <code>main()</code>:</p>\n\n<pre><code>struct personalData * data[10];\n</code></pre>\n\n<p>and finally <code>structSortWeight</code>:</p>\n\n<pre><code>int structSortWeight(const void *a, const void *b)\n{\n    personalData *p1 = (personalData *)a;\n    personalData *p2 = (personalData *)b;\n\n    return (p1-&gt;weight - p2-&gt;weight);\n}\n</code></pre>\n\n<p>My program crashes when it starts sorting. I want to add that when I change the third argument in <code>qsort()</code> to <code>sizeof(float)</code> it doesn't crash but <code>p1-&gt;weight</code> and <code>p2-&gt;weight</code> point to some rubbish.</p>\n\n<p>The calling function in <code>main()</code>:</p>\n\n<pre><code>weightSort(data, len);\n</code></pre>\n\n<p><code>personalData * data[]</code> has some data already assigned.</p>\n"}, {"tags": ["c", "variables"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1514920027, "post_id": 48066397, "comment_id": 83106136, "body": "What changes? What&#39;s the problem? If it&#39;s not used, it&#39;s not used. You&#39;d have to have some bizarre UB or something for that to effect anything."}, {"owner": {"reputation": 3, "user_id": 9161102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Uj8F_uXmMAg/AAAAAAAAAAI/AAAAAAAAAY4/RBX8NMu8C_g/photo.jpg?sz=128", "display_name": "Philipp Hofer", "link": "https://stackoverflow.com/users/9161102/philipp-hofer"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1514920158, "post_id": 48066397, "comment_id": 83106207, "body": "If the variable is part of the program, the program prints out the given parameters. But if its missing, the program crashes or doesnt print anything..."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1514920184, "post_id": 48066397, "comment_id": 83106222, "body": "Crashes with what error?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 3, "creation_date": 1514920252, "post_id": 48066397, "comment_id": 83106249, "body": "You can&#39;t append to <code>text</code> before you initialise the memory region it points to.; that&#39;s Undefined Behaviour, and the actual behaviour can be anything (which means it can vary depend on things which you might think were irrelevant. By the way, <code>sizeof char</code> is always one."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1514925303, "post_id": 48066397, "comment_id": 83108390, "body": "<code>sizeof(char) == 1</code> <i>always</i> - by definition."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515090732, "post_id": 48066397, "comment_id": 83178082, "body": "if this statement: <code>char *text;</code>  is changed to <code>char *text = NULL;</code>  then the call to <code>malloc()</code> can be eliminated."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515090995, "post_id": 48066397, "comment_id": 83178194, "body": "when calling any of the heap allocation functions: (malloc, calloc, realloc): 1) always check (!=NULL) the returned value to assure the operation was successful.  2) when calling <code>realloc()</code>, save the returned value to a temp variable, check the temp variable and if not NULL, then assign to the target variable  Otherwise, when <code>realloc()</code> fails, the original pointer is lost, resulting in a memory leak. 3) regarding: <code>sizeof(char)</code> is defined in the standard as always 1,  multiplying anything by 1 has no effect.  Suggest removing that expression"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515091304, "post_id": 48066397, "comment_id": 83178337, "body": "in the call to <code>realloc()</code>, this expression: <code>strlen(text)));</code> invokes undefined behavior as the allocated memory pointed to by <code>text</code> contains random characters so where the <code>strlen()</code> will encounter a NUL byte (especially on the first pass through the loop) random,"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515091327, "post_id": 48066397, "comment_id": 83178343, "body": "regarding: <code>text++;</code>  why do you want to skip the first character?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515091424, "post_id": 48066397, "comment_id": 83178392, "body": "the variable <code>bin</code> needing to be there is just a result of the undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 3, "user_id": 9161102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Uj8F_uXmMAg/AAAAAAAAAAI/AAAAAAAAAY4/RBX8NMu8C_g/photo.jpg?sz=128", "display_name": "Philipp Hofer", "link": "https://stackoverflow.com/users/9161102/philipp-hofer"}, "edited": false, "score": 2, "creation_date": 1514927550, "post_id": 48066483, "comment_id": 83109359, "body": "@PhilippHofer : It may appear to work, but the code has other serious errors not addressed in this answer.  Failing to initialise the memory pointed to by <code>text</code> and free&#39;ing the <i>modified</i> <code>text</code> pointer are also serious errors."}], "tags": [], "owner": {"reputation": 1449, "user_id": 984986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2113da6f02cd6428b92291c26ba11727?s=128&d=identicon&r=PG", "display_name": "Zrax", "link": "https://stackoverflow.com/users/984986/zrax"}, "is_accepted": true, "score": 1, "last_activity_date": 1515103140, "last_edit_date": 1515103140, "creation_date": 1514920209, "answer_id": 48066483, "question_id": 48066397, "link": "https://stackoverflow.com/questions/48066397/non-used-variable-impacts-program/48066483#48066483", "title": "Non-used variable impacts program", "body": "<pre><code>text = strcat(text, &amp;space);\n</code></pre>\n\n<p>This line is taking the address of a single character variable, and then passing it to <code>strcat</code> which expects a nul-terminated string argument.  The fact that it works with the <code>bin</code> variable probably means that your compiler has chosen to place the variables next to each other on the stack in such a way that it treats it as the nul-terminator; however, relying on this is certainly undefined behavior.</p>\n\n<p>It would be better to actually provide a string literal or constant, e.g.:</p>\n\n<pre><code>const char space[] = \" \";\n...\ntext = strcat(text, space);\n</code></pre>\n\n<p>or simply:</p>\n\n<pre><code>text = strcat(text, \" \");\n</code></pre>\n\n<p>Note that while this may resolve your immediate problem, there are other issues in the code as well that others have pointed out.  Specifically, using <code>text</code> in <code>strlen</code> before initializing the allocated memory and freeing <code>text</code> after the pointer has been moved are both undefined behavior, and I expect you are again just lucky that it happens to work for now.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 3, "last_activity_date": 1514975343, "last_edit_date": 1514975343, "creation_date": 1514925938, "answer_id": 48067620, "question_id": 48066397, "link": "https://stackoverflow.com/questions/48066397/non-used-variable-impacts-program/48067620#48067620", "title": "Non-used variable impacts program", "body": "<p>Your code concatenates to <code>text</code> without initialising <code>text</code>.  You need to start with <code>text</code> as an empty string:</p>\n\n<pre><code>text = malloc(sizeof(char));\ntext[0] = `\\0` ; // empty string\n</code></pre>\n\n<p>Then passing <code>&amp;space</code> to <code>strcat()</code> is erroneous since <code>space</code> is not a nul terminated string.  Simply replace with:</p>\n\n<pre><code>text = strcat(text, \" \" ) ;\n</code></pre>\n\n<p>Then later remove the <code>text++</code> otherwise it will omit the first character, and you cannot <code>free()</code> the modified pointer without causing a heap error:</p>\n\n<pre><code>// text++;   &lt;&lt;&lt; NOT NEEDED and makes free(text) bound to fail.\nprintf(\"%s\", text);\nfree( text ) ;\n</code></pre>\n\n<p>Why it worked with <code>bin</code> present is because you got lucky and it happened to form the nul terminator to <code>&amp;space</code> due to adjacency on the stack.  You got lucky again with whatever <code>text</code> pointed to without initialisation, and free'ing the modified pointer may not have caused an error or fault because the program ends without attempting to allocate any further memory.</p>\n"}], "owner": {"reputation": 3, "user_id": 9161102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Uj8F_uXmMAg/AAAAAAAAAAI/AAAAAAAAAY4/RBX8NMu8C_g/photo.jpg?sz=128", "display_name": "Philipp Hofer", "link": "https://stackoverflow.com/users/9161102/philipp-hofer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 48066483, "answer_count": 2, "score": 0, "last_activity_date": 1515103140, "creation_date": 1514919806, "last_edit_date": 1514920241, "question_id": 48066397, "link": "https://stackoverflow.com/questions/48066397/non-used-variable-impacts-program", "title": "Non-used variable impacts program", "body": "<p>i have to write a small c program for university, which should print the given parameters again on the command line. The task is to do it with pointers. \nSo my problem is, the program works totally right when the unused variable \"bin\" is part of the code. But if i try to delete the code or comment it out, the program isn't working anymore (it crashes or doesn't print anything)... But the variable is not used in the program at all. Also i am also able to change the name of it but not its declarated value. Maybe someone can help/ explain what the problem is :)\nThank you!</p>\n\n<p>Code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main (int argc, char *argv[])\n{\n    char *text;\n    char bin = '\\0'; //&lt;---- unused variable\n    char space = 32;\n    int i = 0;\n\n    if(argc == 1){\n        printf(\"Bitte Parameter mit angeben!\");\n        return 1;\n    }\n\n    text = malloc(sizeof(char));\n\n    for(i = 1; i &lt; argc; i++){\n        text = realloc(text, sizeof(char) * (strlen(argv[i]) + 2 + \n               strlen(text)));\n        if(text == NULL)\n            return 1;\n        text = strcat(text, argv[i]);\n        text = strcat(text, &amp;space);\n    }\n\n    text++;\n    printf(\"%s\", text);\n    free(text);\n    return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "printf"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 4, "creation_date": 1514919517, "post_id": 48066271, "comment_id": 83105919, "body": "&quot;I need to print the memory of a pointer&quot; Hmmm, that&#39;s a bit unclear to me. Do you want to print the value of the pointer or the memory that it points to?"}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 0, "creation_date": 1514919601, "post_id": 48066271, "comment_id": 83105952, "body": "I want to print the memory that is points to, like that &quot;0000 0000 1700 0000 9600 0000 ff00 0000&quot; for example"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1514919601, "post_id": 48066271, "comment_id": 83105953, "body": "Are you saying that you can&#39;t use printf() at all or that you can&#39;t use %p?"}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 0, "creation_date": 1514919659, "post_id": 48066271, "comment_id": 83105977, "body": "Can&#39;t use printf at all, still can use write tho"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1514919702, "post_id": 48066271, "comment_id": 83105992, "body": "How could you possibly print formatted output without <code>printf()</code>?"}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 0, "creation_date": 1514919740, "post_id": 48066271, "comment_id": 83106009, "body": "That&#39;s my question :)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 4, "creation_date": 1514920365, "post_id": 48066271, "comment_id": 83106301, "body": "@machine_1: The code that implements <code>printf</code> does exactly that, so it&#39;s certainly possible."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1514920368, "post_id": 48066271, "comment_id": 83106303, "body": "@machine_1 I certainly skirted the letter of the law here by using <code>sprintf()</code> in the answer posted, but outputting formatted text without <code>printf()</code> is a simple task.  Think about how we outputted formatted output before <code>printf()</code> existed.  Or think about how you would implement <code>printf()</code> if you were implementing a C library while designing an operating system, for example.  It&#39;s pretty trivial, just inconvenient"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 5, "creation_date": 1514920488, "post_id": 48066271, "comment_id": 83106346, "body": "I&#39;m still not sure what you&#39;re trying to do. <code>printf(&quot;%p&quot;, ...)</code> prints the address (pointer value). But in your comment, &quot;0000 0000 1700 0000 9600 0000 ff00 0000&quot; looks more like the contents of 16 byte of memory at that address; that&#39;s 128 bits, which is <i>probably</i> bigger than a pointer value."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1514920859, "post_id": 48066271, "comment_id": 83106485, "body": "@KeithThompson I certainly agree, but then you would be using the same code of <code>printf()</code>, wouldn&#39;t you?"}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1514921075, "post_id": 48066271, "comment_id": 83106569, "body": "@KeithThompson Indeed, I actually have to print several adresses from an array,"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1514921708, "post_id": 48066271, "comment_id": 83106839, "body": "@GautierLemaire: It&#39;s still not clear what you want to do. What are &quot;addresses from an array&quot;? Do you mean you have an array of pointers, and you want to print the value of each element of the array? Probably the clearest way to ask your question would be to show code that does what you want using <code>printf(&quot;%p&quot;, ...)</code> and ask how to do the same thing without using <code>printf</code>. (And since this appears to be a homework problem, I&#39;d be very hesitant to provide a complete answer, though I would be willing to send code to your instructor with your name attached.)"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1514922817, "post_id": 48066271, "comment_id": 83107277, "body": "This isn\u2019t actually implementable with <code>printf(&quot;%p&quot;, ...)</code>, and least not easily or directly. The <i>address</i>, or the value of the pointer, is where in memory something lives; this doesn\u2019t care about that and prints the memory <i>pointed to</i> by the pointer, or which is <i>at</i> that address (assuming little-endian)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1514923145, "post_id": 48066271, "comment_id": 83107423, "body": "The whole thing about <code>&quot;%p&quot;</code> turns out to have been a red herring (unintentionally, I&#39;m sure). The assignment isn&#39;t to print address values. It&#39;s to print the contents of memory (in hexadecimal). <code>&quot;%p&quot;</code> is used to print pointer values, not the contents of the memory a pointer points to."}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1514923702, "post_id": 48066271, "comment_id": 83107667, "body": "@KeithThompson Actually I don&#39;t have a teacher I&#39;m learning alone ont internet and I found this exercice online. I think I misunderstood the exercice, it has nothing to do with &quot;%p&quot; thank you very much, it&#39;s a bit clearer for me now :) Thank you all"}], "answers": [{"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1514919804, "post_id": 48066385, "comment_id": 83106042, "body": "The OP explicitly said he can&#39;t use <code>printf()</code>"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1514919861, "post_id": 48066385, "comment_id": 83106077, "body": "Revised to remove printf."}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 1, "creation_date": 1514920083, "post_id": 48066385, "comment_id": 83106163, "body": "Thank you for your answer, it&#39;s a good way to do it. However would you be able to do it using only the &#39;write&#39; function ?"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1514920233, "post_id": 48066385, "comment_id": 83106241, "body": "Done.  If this satisfies, an upvote and accept would be appreciated. :)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 1, "creation_date": 1514920539, "post_id": 48066385, "comment_id": 83106370, "body": "@GautierLemaire: Why <code>write</code>? That&#39;s POSIX-specific. If you want portability, you should use something like <code>fputc</code> or <code>fputs</code>."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1514920734, "post_id": 48066385, "comment_id": 83106440, "body": "@KeithThompson Or <code>fwrite</code>, but this is obviously a homework assignment and the assignment might specify a POSIX machine."}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 0, "creation_date": 1514920908, "post_id": 48066385, "comment_id": 83106511, "body": "Thank you again, but is there a way to get the adresse without using sprintf() ? As I said, the only function from the library I can use is write."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1514920909, "post_id": 48066385, "comment_id": 83106512, "body": "@DanielH: As the question already stated, and I failed to notice. Sorry about the noise. (My question still applies to the person who created the assignment, but not to the OP.)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 1, "creation_date": 1514920996, "post_id": 48066385, "comment_id": 83106542, "body": "@GautierLemaire: What address? If you&#39;re trying to do the equivalent of <code>printf(&quot;%p&quot;, ...)</code>, please state that in your question. That&#39;s the implication of what you&#39;ve written, but it&#39;s contradicted by some of your comments. The &quot;address of a pointer&quot; could mean the address at which a pointer object is stored, but I think you want the <i>value</i> of the pointer."}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 0, "creation_date": 1514921240, "post_id": 48066385, "comment_id": 83106647, "body": "I want to print the address at which the pointer is stored, using only the write function."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "edited": false, "score": 0, "creation_date": 1514921466, "post_id": 48066385, "comment_id": 83106731, "body": "@GautierLemaire So if I have <code>char const *s = &quot;Hello, world!&quot;</code>, you want the equivalent of <code>printf(&quot;%p&quot;, &amp;s);</code>? That is the address at which the pointer is stored. Or do you want the equivalent of <code>printf(&quot;%p&quot;, s);</code>? That is the address of the string, but the <i>value</i> of the pointer <code>s</code>."}, {"owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1514922402, "post_id": 48066385, "comment_id": 83107097, "body": "@DanielH mmh, I have a serious doubt now, I&#39;m still a beginner and I&#39;m not used to precise vocabulary, I added the statement of my exercice in my question maybe it will be obvious for you"}], "tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": false, "score": 0, "last_activity_date": 1514920184, "last_edit_date": 1514920184, "creation_date": 1514919763, "answer_id": 48066385, "question_id": 48066271, "link": "https://stackoverflow.com/questions/48066271/how-to-print-a-pointer-address-without-printf/48066385#48066385", "title": "How to print a pointer address without printf", "body": "<p>You could do something like this... You said <code>printf()</code> is off limits, but you said nothing about sprintf.</p>\n\n<pre><code> print_bytes(char *ptr, int count)\n {\n   int i;\n   char string[1024];\n   string[0] = 0;\n   for(i = 0; i &lt; count; i++)\n   {\n     sprintf(string,\"%s %2x\", string, *(ptr+i));\n   }\n   puts(string);\n }\n</code></pre>\n\n<p>This should loop through <code>count</code> bytes printing out each hexadecimal byte starting from the passed in address in <code>ptr</code>.</p>\n\n<p>Obviously, this makes no attempt to properly size the string array.  That should be dynamically sized based on the passed in count.</p>\n\n<p>To substitute <code>write()</code> for <code>puts()</code>, you could use:</p>\n\n<pre><code> write(1, string, strlen(string)); /* 1 = STDOUT */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2088, "user_id": 1535706, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fdbc5a75b701551a48a172a534c74e92?s=128&d=identicon&r=PG", "display_name": "rslemos", "link": "https://stackoverflow.com/users/1535706/rslemos"}, "is_accepted": false, "score": 6, "last_activity_date": 1531335435, "last_edit_date": 1531335435, "creation_date": 1514920962, "answer_id": 48066640, "question_id": 48066271, "link": "https://stackoverflow.com/questions/48066271/how-to-print-a-pointer-address-without-printf/48066640#48066640", "title": "How to print a pointer address without printf", "body": "<p><strong>EDIT:</strong> I provided this answer before the OP clarified they actually wanted to <strong>dump</strong> memory contents (before clarifying it they asked for code to act like <code>printf(\"%p\", mem_ptr)</code>. </p>\n\n<p>This code should spell out each digit (in hex):</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\n/* you must provide this function somewhere */\nextern void write_char(char);\n\nchar hex_digit(int v) {\n    if (v &gt;= 0 &amp;&amp; v &lt; 10)\n        return '0' + v;\n    else\n        return 'a' + v - 10; // &lt;-- Here\n}\n\nvoid print_address_hex(void* p0) {\n    int i;\n    uintptr_t p = (uintptr_t)p0;\n\n    write_char('0'); write_char('x');\n    for(i = (sizeof(p) &lt;&lt; 3) - 4; i&gt;=0; i -= 4) {\n        write_char(hex_digit((p &gt;&gt; i) &amp; 0xf));\n    }\n}\n</code></pre>\n\n<p>Here, <code>print_address_hex</code> is a basic algorithm for printing digits one at a time (<a href=\"http://interactivepython.org/runestone/static/pythonds/Recursion/pythondsConvertinganIntegertoaStringinAnyBase.html\" rel=\"nofollow noreferrer\" title=\"like this one\">like this one</a>). [to simplify things I didn't care about leading zeros]</p>\n\n<p>The core of the algorithm are the operators <code>&gt;&gt;</code> (acts like binary integer division) and <code>&amp;</code> (acts like binary remainder). [notice that those operators will only work for bases 2, 4, 8, 16, 2^n in general].</p>\n\n<p>I used <code>uintptr_t</code> to make it portable. This type - declared in <code>&lt;stdint.h&gt;</code> - refers to an integral type capable of holding a pointer (architecture independent). We need an integral type so that we can use arithmetic operators (besides <code>+</code> and <code>-</code>, the only valid operators for pointer arithmetic).</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1514922971, "creation_date": 1514922971, "answer_id": 48067049, "question_id": 48066271, "link": "https://stackoverflow.com/questions/48066271/how-to-print-a-pointer-address-without-printf/48067049#48067049", "title": "How to print a pointer address without printf", "body": "<p>You can try like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid print_memory(const void *addr, size_t size)\n{\n    size_t printed = 0;\n    size_t i;\n    const unsigned char* pc = addr;\n    for (i=0; i&lt;size; ++i)\n    {\n        int  g;\n        g = (*(pc+i) &gt;&gt; 4) &amp; 0xf;\n        g += g &gt;= 10 ? 'a'-10 : '0';\n        putchar(g);\n        printed++;\n\n        g = *(pc+i) &amp; 0xf;\n        g += g &gt;= 10 ? 'a'-10 : '0';\n        putchar(g);\n        printed++;\n        if (printed % 32 == 0) putchar('\\n');\n        else if (printed % 4 == 0) putchar(' ');\n    }\n}\n\nint main(void) {\nint tab[10] = {0, 23, 150, 255, 12, 16, 21, 42};\n\nprint_memory(tab, sizeof(tab)); return (0);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>0000 0000 1700 0000 9600 0000 ff00 0000 \n0c00 0000 1000 0000 1500 0000 2a00 0000 \n0000 0000 0000 0000 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 6817975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3105b56021b2ecf439c7ed5121b2b76b?s=128&d=identicon&r=PG&f=1", "display_name": "Xtx", "link": "https://stackoverflow.com/users/6817975/xtx"}, "is_accepted": false, "score": 2, "last_activity_date": 1527250315, "last_edit_date": 1527250315, "creation_date": 1527237145, "answer_id": 50524865, "question_id": 48066271, "link": "https://stackoverflow.com/questions/48066271/how-to-print-a-pointer-address-without-printf/50524865#50524865", "title": "How to print a pointer address without printf", "body": "<p>You don't have to print the memory, you have to transform each byte from addr in hexadecimal and print it, the second part with dots and asterisk is transform the value of each byte in char, if it isn't printable it will print dot.</p>\n\n<pre><code>#include &lt;string.h&gt;\n\n#include &lt;unistd.h&gt;\n\nvoid    ft_putchar(char c)\n{\n    write(1, &amp;c, 1);\n}\n\nvoid    print_ascii(const char *addr, int i)\n{\n    int j;\n    int len;\n\n    j = 0;\n    if ((i + 1) % 16 == 0)\n        len = 16;\n    else\n        len = (i + 1) % 16;\n    while (j &lt; 16 - len)\n    {\n        ft_putchar(' ');\n        ft_putchar(' ');\n        if (j % 2)\n            ft_putchar(' ');\n        j++;\n    }\n    if ((16 - len) % 2)\n        ft_putchar(' ');\n    j = 0;\n    while (j &lt; len)\n    {\n        if (*(addr + i / 16 * 16 + j) &gt;= 32 &amp;&amp; *(addr + i / 16 * 16 + j) &lt;= 126)\n            ft_putchar(*(addr + i / 16 * 16 + j));\n        else\n            ft_putchar('.');\n        j++;\n    }\n    ft_putchar('\\n');\n}\n\nvoid    print_hex(unsigned char value, int index)\n{\n    if (index &lt; 2)\n    {\n        print_hex(value / 16, index + 1);\n        if (value % 16 &gt;= 10)\n            ft_putchar('a' + value % 16 % 10);\n        else\n            ft_putchar('0' + value % 16);\n    }\n}\n\nvoid    print_memory(const void *addr, size_t size)\n{\n    char    *ptr;\n    size_t  i;\n\n    if (addr &amp;&amp; size &gt; 0)\n    {\n        ptr = (char*)addr;\n        i = 0;\n        while (i &lt; size)\n        {\n            print_hex(*(ptr + i), 0);\n            if (i % 2)\n                ft_putchar(' ');\n            if ((i + 1) % 16 == 0 || (i + 1) == size)\n                print_ascii(addr, i);\n            i++;\n        }\n    }\n}\n</code></pre>\n\n<p>This code works for your exam.</p>\n"}], "owner": {"reputation": 41, "user_id": 9058392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9a6c9fbcec0551d4ea098223a6ae51?s=128&d=identicon&r=PG&f=1", "display_name": "galemair", "link": "https://stackoverflow.com/users/9058392/galemair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4754, "favorite_count": 3, "accepted_answer_id": 48067049, "answer_count": 4, "score": 2, "last_activity_date": 1531335435, "creation_date": 1514919289, "last_edit_date": 1514929233, "question_id": 48066271, "link": "https://stackoverflow.com/questions/48066271/how-to-print-a-pointer-address-without-printf", "title": "How to print a pointer address without printf", "body": "<p>I'm doing an exercise in which I need to print the memory (address) of a pointer. It would be easy to do it with <code>printf(\"%p\", ..)</code> but I'm not allowed to use it.</p>\n\n<p>Do you know how I can get the address without using <code>printf()</code>?\nThe only function I can use is 'write'.</p>\n\n<p>Here is the statement of my exercise : </p>\n\n<p><em>Write a function that takes <code>(const void *addr, size_t size)</code>, and displays the\nmemory as in the example.\nYour function must be declared as follows:</em></p>\n\n<pre><code>void print_memory(const void *addr, size_t size);\n</code></pre>\n\n<hr>\n\n<pre><code>$ cat main.c\n\nvoid  print_memory(const void *addr, size_t size);\n\nint   main(void)\n{    \n      int tab[10] = {0, 23, 150, 255,\n                     12, 16,  21, 42};\n\n      print_memory(tab, sizeof(tab));\n      return (0);\n}\n\n$ gcc -Wall -Wall -Werror main.c print_memory.c &amp;&amp; ./a.out | cat -e\n0000 0000 1700 0000 9600 0000 ff00 0000 ................$\n0c00 0000 1000 0000 1500 0000 2a00 0000 ............*...$\n0000 0000 0000 0000                     ........$\n</code></pre>\n"}, {"tags": ["c", "linux", "multiprocessing"], "comments": [{"owner": {"reputation": 1110, "user_id": 3147123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5MNas.jpg?s=128&g=1", "display_name": "tomix86", "link": "https://stackoverflow.com/users/3147123/tomix86"}, "edited": false, "score": 0, "creation_date": 1514918992, "post_id": 48066168, "comment_id": 83105703, "body": "I know that this is not the main question, but you can replace <code>cat &#47;etc&#47;passwd | grep 1000 | cut -d: -f1</code>, with <code>grep 1000 &#47;etc&#47;passwd | cut -d: -f1</code>. These two are equivalent, this would also affect your C implementation. Furthermore, what you are trying to implement could be done without calling any external processes, but I guess there is some rationale for doing it the way you did (exercise or something)."}, {"owner": {"reputation": 1279, "user_id": 5672176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9070335c339f84105749088ed1d378?s=128&d=identicon&r=PG&f=1", "display_name": "taoufik A", "link": "https://stackoverflow.com/users/5672176/taoufik-a"}, "reply_to_user": {"reputation": 1110, "user_id": 3147123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5MNas.jpg?s=128&g=1", "display_name": "tomix86", "link": "https://stackoverflow.com/users/3147123/tomix86"}, "edited": false, "score": 0, "creation_date": 1514919317, "post_id": 48066168, "comment_id": 83105842, "body": "Yep I know, but what I&#39;m trying to achieve is to use pipe and fork with more than 2 commands"}, {"owner": {"reputation": 1279, "user_id": 5672176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9070335c339f84105749088ed1d378?s=128&d=identicon&r=PG&f=1", "display_name": "taoufik A", "link": "https://stackoverflow.com/users/5672176/taoufik-a"}, "reply_to_user": {"reputation": 1110, "user_id": 3147123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5MNas.jpg?s=128&g=1", "display_name": "tomix86", "link": "https://stackoverflow.com/users/3147123/tomix86"}, "edited": false, "score": 0, "creation_date": 1514919401, "post_id": 48066168, "comment_id": 83105871, "body": "@tomix86 I&#39;m learning system programing"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1514928657, "post_id": 48066168, "comment_id": 83109786, "body": "Without looking at any details, gut instinct says &quot;you&#39;re leaving file descriptors open&quot;.  Looking at your code, that is confirmed.  The template is <code>dup2(fd, 0); close(fd)</code>.  You need to close the descriptor you just dup&#39;d."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1514928740, "post_id": 48066168, "comment_id": 83109813, "body": "And you need to close a lot more than that.  If you open 2 pipes, then you have 7 total open file descriptors.  Each child should have only 3 when you call exec.  If you call dup, then you are up to 8.  So you need to call close 5 times before you exec.  This is true in every child."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1514928776, "post_id": 48066168, "comment_id": 83109832, "body": "(But you get a close for free when you dup if you don&#39;t close the 2nd argument first.)"}, {"owner": {"reputation": 1279, "user_id": 5672176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9070335c339f84105749088ed1d378?s=128&d=identicon&r=PG&f=1", "display_name": "taoufik A", "link": "https://stackoverflow.com/users/5672176/taoufik-a"}, "edited": false, "score": 0, "creation_date": 1514930747, "post_id": 48066168, "comment_id": 83110549, "body": "I did as you said but nothing happened"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514932028, "post_id": 48066168, "comment_id": 83111022, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. There isn&#39;t even a problem description here."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514932126, "post_id": 48066168, "comment_id": 83111072, "body": "You&#39;re calling <code>wait</code> in your parent processes. Cool deadlock."}, {"owner": {"reputation": 1279, "user_id": 5672176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9070335c339f84105749088ed1d378?s=128&d=identicon&r=PG&f=1", "display_name": "taoufik A", "link": "https://stackoverflow.com/users/5672176/taoufik-a"}, "edited": false, "score": 0, "creation_date": 1514932259, "post_id": 48066168, "comment_id": 83111120, "body": "Even without <code>wait</code> it gives the same problem"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514932979, "post_id": 48066168, "comment_id": 83111360, "body": "You probably aren&#39;t closing enough file descriptors. <b>Rule of thumb</b>: If you <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a> one end of a pipe to standard input or standard output, close both ends of the pipe as soon as possible. That means before using any of the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execvp.html\" rel=\"nofollow noreferrer\"><code>exec*()</code></a> family of functions. It includes <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup.html\" rel=\"nofollow noreferrer\"><code>dup()</code></a> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html\" rel=\"nofollow noreferrer\"><code>fcntl()</code></a> with <code>F_DUPFD</code> too."}, {"owner": {"reputation": 1279, "user_id": 5672176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9070335c339f84105749088ed1d378?s=128&d=identicon&r=PG&f=1", "display_name": "taoufik A", "link": "https://stackoverflow.com/users/5672176/taoufik-a"}, "edited": false, "score": 0, "creation_date": 1514933768, "post_id": 48066168, "comment_id": 83111626, "body": "when fork fails it can raise to error <code>EAGAIN</code> and <code>ENOMEM</code>, the first one <code>EAGAIN</code> tells that there is no place in the process table and the second one tells that the kernel had no more memory"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514934018, "post_id": 48066168, "comment_id": 83111705, "body": "You shouldn&#39;t wait before running the <code>cut</code>; you should (close file descriptors and) execute <code>cut</code> immediately.   If you want to wait for the children to die before executing, you create a third child which launches the <code>cut</code>, while the parent waits in a loop before executing."}, {"owner": {"reputation": 1279, "user_id": 5672176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9070335c339f84105749088ed1d378?s=128&d=identicon&r=PG&f=1", "display_name": "taoufik A", "link": "https://stackoverflow.com/users/5672176/taoufik-a"}, "edited": false, "score": 0, "creation_date": 1514934198, "post_id": 48066168, "comment_id": 83111767, "body": "So I remove the wait from both parent and child ?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1514938302, "post_id": 48066168, "comment_id": 83112855, "body": "Your second child is still not closing either side of <code>fd2</code> before it execs.  Close everything that you&#39;re not using."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514962084, "post_id": 48070532, "comment_id": 83118553, "body": "You said &quot;Waiting for children is not needed&quot;, which is accurate, but the criterion is actually stronger than that.  It is crucial, in general, that the code does not wait for the children as you may very well get blockages because one process generates more data than can fit in the pipe buffer (which was historically 5 KiB; POSIX only requires 4 KiB; but many modern O/S use 64 KiB).  Also, because the parent hasn&#39;t closed file descriptors when waiting, the processes can be deadlocked if the parent waits."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1514962177, "last_edit_date": 1514962177, "creation_date": 1514947795, "answer_id": 48070532, "question_id": 48066168, "link": "https://stackoverflow.com/questions/48066168/c-fork-and-pipe-multiple-process/48070532#48070532", "title": "C fork and pipe multiple process", "body": "<p>You need to close all unused file descriptors in both children and parents! In this case, when using dup2(), all file descriptors associated with pipes may be closed.</p>\n\n<p>For clarity I used macros for file descriptors associated with stdin and stdout. Macros STDIN_FILENO and STDOUT_FILENO are declared in unistd.h.</p>\n\n<p>Waiting for children (<code>wait(&amp;pid);</code> and <code>wait(&amp;pid2);</code>) is not needed. You do not need to wait for <code>cat</code> to end before running <code>grep</code>, as grep will process them as they come. Pipe should have a big buffer, like 65536 bytes, so after cat command ends data will be buffered in pipe, but it is not something to count on.</p>\n\n<p>The following code, with only minor changes, works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\nint main(){\n    int fd[2], fd2[2];\n    pid_t pid, pid2;\n    char str[100];\n\n    if(pipe(fd) != 0){\n        fprintf(stderr, \"Error pipe.\\n\");\n        return 1;\n    }\n    if(pipe(fd2) != 0){\n        fprintf(stderr, \"Error pipe.\\n\");\n        return 1;\n    }\n\n    do{\n        pid = fork();\n    }while(pid == -1 &amp;&amp; errno == EAGAIN);\n\n    if(pid == -1){\n        perror(\"fork()\");\n        exit(1);\n    }\n\n    if(pid == 0){\n        pid2 = fork();\n        if(pid2 == 0){\n            // fprintf(stderr, \"1 - Grand Child\\n\");\n            dup2(fd[1], STDOUT_FILENO); // 1);\n            close(fd[0]);\n            close(fd[1]);\n            close(fd2[1]);\n            close(fd2[0]);\n\n            execlp(\"cat\", \"cat\", \"/etc/passwd\", NULL);\n            perror(\"cat error\");\n        }else{\n            // wait(&amp;pid2);\n            // fprintf(stderr, \"2 - Child\\n\");\n            dup2(fd[0], STDIN_FILENO); //0);\n            dup2(fd2[1], STDOUT_FILENO); // 1);\n            close(fd[0]);\n            close(fd[1]);\n            close(fd2[1]);\n            close(fd2[0]);\n\n            execlp(\"grep\", \"grep\", \"1000\", NULL);\n            perror(\"grep failed\");\n        }\n        return 1;\n    }else{\n        // wait(&amp;pid);\n        // fprintf(stderr, \"3 - Parent\\n\");\n        dup2(fd2[0], STDIN_FILENO); //0);\n        close(fd[0]);\n        close(fd[1]);\n        close(fd2[1]);\n        close(fd2[0]);\n\n        execlp(\"cut\", \"cut\", \"-d:\", \"-f1\", NULL);\n        perror(\"cut failed\");\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1279, "user_id": 5672176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9070335c339f84105749088ed1d378?s=128&d=identicon&r=PG&f=1", "display_name": "taoufik A", "link": "https://stackoverflow.com/users/5672176/taoufik-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2487, "favorite_count": 0, "accepted_answer_id": 48070532, "answer_count": 1, "score": 0, "last_activity_date": 1514962177, "creation_date": 1514918774, "last_edit_date": 1514933349, "question_id": 48066168, "link": "https://stackoverflow.com/questions/48066168/c-fork-and-pipe-multiple-process", "title": "C fork and pipe multiple process", "body": "<p>I'm trying to implement this command <code>cat /etc/passwd | grep 1000 | cut -d: -f1</code> in C using system calls fork and pipe.<br>\nWhen I use only two commands <code>cmd1 | cmd2</code> so 1 fork it works fine but when I'm using more than 2 process the problem occurs<br>\nHere is my code, I think the problem is in the grand parent block </p>\n\n<p><strong>Update</strong> :<br>\nI closed some unclosed file descriptors</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n\nint main(){\n    int fd[2], fd2[2];\n    pid_t pid, pid2;\n    char str[100];\n\n    if(pipe(fd) != 0){\n        fprintf(stderr, \"Error pipe.\\n\");\n        return 1;\n    }\n    if(pipe(fd2) != 0){\n        fprintf(stderr, \"Error pipe.\\n\");\n        return 1;\n    }\n\n    do{\n        pid = fork();\n    }while(pid == -1 &amp;&amp; errno == EAGAIN);\n\n    if(pid == -1){\n        perror(\"fork()\");\n        exit(1);\n    }\n\n    if(pid == 0){\n        pid2 = fork();\n        if(pid2 == 0){\n            // fprintf(stderr, \"1 - Grand Child\\n\");\n            close(fd[0]);\n            dup2(fd[1], 1);\n            close(fd[1]);\n            execlp(\"cat\", \"cat\", \"/etc/passwd\", NULL);\n            perror(\"cat error\");\n        }else{\n            wait(&amp;pid2);\n            // fprintf(stderr, \"2 - Child\\n\");\n            close(fd[1]);\n            dup2(fd[0], 0);\n            close(fd[0]);\n\n            up2(fd2[1], 1);\n            close(fd2[1]);\n\n            execlp(\"grep\", \"grep\", \"1000\", NULL);\n            perror(\"grep failed\");\n        }\n        return 1;\n    }else{\n        wait(&amp;pid);\n        // fprintf(stderr, \"3 - Parent\\n\");\n        close(fd[0]);\n        dup2(fd2[0], 0);\n        close(fd2[0]);\n        execlp(\"cut\", \"cut\", \"-d:\", \"-f1\", NULL);\n        perror(\"cut failed\");\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "queue"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514949996, "post_id": 48066147, "comment_id": 83115170, "body": "I don&#39;t understand what you are asking. You don&#39;t need to use <code>isfull</code> or <code>isempty</code> if you are not checking these cases, besides you didn&#39;t implement these functions. Do not use global variables for this. Also your <code>display</code> should only display the elements that the current stack holds."}, {"owner": {"reputation": 57, "user_id": 8646429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/87edd521e88efea4c1e991cbac99a116?s=128&d=identicon&r=PG&f=1", "display_name": "sampleprogrammers", "link": "https://stackoverflow.com/users/8646429/sampleprogrammers"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514962686, "post_id": 48066147, "comment_id": 83118778, "body": "I am asking this code is right or not?,can I implement this way?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1514962997, "post_id": 48066147, "comment_id": 83118890, "body": "yes and no. Surly you can implement this way, but it will be a rather ugly implementation. The idea is not bad, but it needs improvements. For example, do not use a global variables, check the bounds before doing operations like push/pop (enqueue/dequeue), encapsulate the structure with a <code>struct</code>."}, {"owner": {"reputation": 57, "user_id": 8646429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/87edd521e88efea4c1e991cbac99a116?s=128&d=identicon&r=PG&f=1", "display_name": "sampleprogrammers", "link": "https://stackoverflow.com/users/8646429/sampleprogrammers"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514963256, "post_id": 48066147, "comment_id": 83118991, "body": "Thankyou for your concern..."}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1514996637, "post_id": 48066147, "comment_id": 83136699, "body": "Your code is not good enough. There are elements that are in need for improvement. See this example for the full implementation: <a href=\"https://gist.github.com/ArnonEilat/4471278\" rel=\"nofollow noreferrer\">gist.github.com/ArnonEilat/4471278</a>"}], "owner": {"reputation": 57, "user_id": 8646429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/87edd521e88efea4c1e991cbac99a116?s=128&d=identicon&r=PG&f=1", "display_name": "sampleprogrammers", "link": "https://stackoverflow.com/users/8646429/sampleprogrammers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514962631, "creation_date": 1514918695, "last_edit_date": 1514962631, "question_id": 48066147, "link": "https://stackoverflow.com/questions/48066147/is-this-queue-program-right-without-using-isfull-and-isempty-method-in-cprog", "title": "Is this queue program right without using isfull() and isempty() method in cprogram?", "body": "<p>I am beginner in data structures.I tried in <strong>simple way</strong>.I tried sample queue program using c.I coded entire program in my own way.I got the output.but I couldn't used <strong>isfull()</strong> and <strong>isempty()</strong> method in this program.I checked directly <strong>using my own condition</strong>.whether queue is empty or full.can anyone tell me Is this program right or not?I enclosed the output whatever I got.<a href=\"https://i.stack.imgur.com/JeHSM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JeHSM.png\" alt=\"enter image description here\"></a>Thanks in advance....</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#include&lt;stdio.h&gt;\r\n#define MAX 10\r\nint front=0;\r\nint rear=0;\r\nint a[MAX];\r\nvoid enqueue(int x);\r\nvoid dequeue();\r\nvoid peek();\r\nvoid display();\r\nmain()\r\n{\r\n\tenqueue(10);\r\n\tenqueue(21);\r\n\tenqueue(31);\r\n\tdequeue();\r\n    enqueue(19);\r\n    enqueue(07);\r\n    dequeue();\r\n    peek();\r\n\tenqueue(93);\r\n\tenqueue(73);\r\n\tdequeue();\r\n    enqueue(64);\r\n    enqueue(188);\r\n\tenqueue(75);\r\n\r\n\tdisplay();\r\n}\r\nvoid enqueue(int x)\r\n{\r\n\tif(rear==MAX)\r\n\t{\r\n\t   printf(\"queue is full so, data cannot be inserted\\n\");\t\r\n\t}\r\n\telse\r\n\t{\r\n\t   a[rear]=x;\r\n\t   rear++;\r\n\t}\r\n}\r\nvoid dequeue()\r\n{\r\n    if(front==MAX)\r\n\t{\r\n\t\tprintf(\"queue is empty so, data cannot be deleted\\n\");\r\n\t}\r\n\telse\r\n\t{\r\n\t\tfront++;\r\n\t}\t\r\n}\r\nvoid peek()\r\n{\r\n\tprintf(\"FRONT ELEMENT:%d\\n\",a[front]);\r\n}\r\nvoid display()\r\n{\r\n\tint i;\r\n\tfor(i=front;i&lt;=MAX-1;i++)\r\n\t{\r\n\t\tprintf(\"%d\\n\",a[i]);\r\n\t}\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 555, "user_id": 7185816, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/fGp6k.jpg?s=128&g=1", "display_name": "Atul Kumar", "link": "https://stackoverflow.com/users/7185816/atul-kumar"}, "edited": false, "score": 0, "creation_date": 1514917565, "post_id": 48065935, "comment_id": 83105068, "body": "what are the errors?"}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 1, "creation_date": 1514917571, "post_id": 48065935, "comment_id": 83105070, "body": "<code>count</code> contains garbage value!"}, {"owner": {"reputation": 183, "user_id": 8450404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f4bc673dc9c0de86b0387b12877d82?s=128&d=identicon&r=PG&f=1", "display_name": "joey lang", "link": "https://stackoverflow.com/users/8450404/joey-lang"}, "reply_to_user": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1514917638, "post_id": 48065935, "comment_id": 83105097, "body": "@AditiRawat can you please correct the mistake"}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 1, "creation_date": 1514917705, "post_id": 48065935, "comment_id": 83105128, "body": "Of course it contains garbage values. You&#39;re not initializing it to anything."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1514917752, "post_id": 48065935, "comment_id": 83105151, "body": "<code>count</code> is passed by value, so <code>linearsearch</code> will not be able to initialize it for you. And, what do you intend <code>int *b[count]</code> to be if <code>count</code> is not yet initialized?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1514917796, "post_id": 48065935, "comment_id": 83105166, "body": "<code>count</code> being uninitialized is the least of the problems you have. Having <code>b</code> be an array of uninitialized pointers is a few steps worse IMO. It really doesn&#39;t do what you apparently think it does."}, {"owner": {"reputation": 183, "user_id": 8450404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f4bc673dc9c0de86b0387b12877d82?s=128&d=identicon&r=PG&f=1", "display_name": "joey lang", "link": "https://stackoverflow.com/users/8450404/joey-lang"}, "edited": false, "score": 0, "creation_date": 1514917916, "post_id": 48065935, "comment_id": 83105225, "body": "Can you please help the code with a few edits?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514920432, "post_id": 48065935, "comment_id": 83106336, "body": "Check the answer."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514918312, "post_id": 48066050, "comment_id": 83105400, "body": "Almost, but if you look carefully, you leak memory horribly because you need to pass an <code>int **</code> to the function so that you can change the <code>int *</code> in the calling code."}], "tags": [], "owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "is_accepted": false, "score": 0, "last_activity_date": 1514920104, "last_edit_date": 1514920104, "creation_date": 1514918131, "answer_id": 48066050, "question_id": 48065935, "link": "https://stackoverflow.com/questions/48065935/function-for-multiple-occurrences-in-linear-search-using-pointer/48066050#48066050", "title": "function for multiple occurrences in linear search using pointer", "body": "<p>I think there are several errors.</p>\n\n<ul>\n<li><code>count</code> must be initialized, like <code>int count = 0;</code></li>\n<li><code>count</code> variable is not changed after linearsearch function. </li>\n<li><code>b</code> array should allocated dynamically.</li>\n</ul>\n\n<p>suggested patch is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid linearsearch(int n,int a[n],int x,int *count,int **b)\n{\n    count=0;\n    int i;\n    for(i=0;i&lt;n;i++)\n    {\n        if(a[i]==x)\n        {\n            count+=1;\n        }\n    }\n    int j=0;\n    for(i=0;i&lt;n;i++)\n    {\n        if(a[i]==x)\n        {\n            *b = realloc(*b, sizeof(int) * (j + 1));\n            (*b)[j]=i;\n            j++;\n        }\n    }\n}\nint main()\n{\nint n;\nscanf(\"%d\",&amp;n);\nint a[n];\nint i;\nfor(i=0;i&lt;n;i++)\n{\n    scanf(\"%d\",&amp;a[i]);\n}\nint x;\nscanf(\"%d\",&amp;x);\nint count = 0;\nint *b = NULL;\nlinearsearch(n,a,x,&amp;count,&amp;b);\nfor(i=0;i&lt;count;i++)\n{\n    printf(\"%d\",b[i]);\n}  \nreturn 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1514920289, "creation_date": 1514920289, "answer_id": 48066506, "question_id": 48065935, "link": "https://stackoverflow.com/questions/48065935/function-for-multiple-occurrences-in-linear-search-using-pointer/48066506#48066506", "title": "function for multiple occurrences in linear search using pointer", "body": "<p>Well the ideal way would be to allocate the memory dynamically  based of the number of <code>x</code> found. But well let's look at the errors first. Maybe after this discussion you can write the code.</p>\n\n<pre><code>b[j]=i;\n</code></pre>\n\n<p>In the called function let's dissect the type of this. </p>\n\n<p><code>i</code> is of type <code>int</code>. And <code>b[j]</code> is of type <code>int*</code>. Then you assigned them (type mismatched). Then <code>%d</code> expects an <code>int</code> but you passed something of type <code>int*</code>. This is undefined behavior.</p>\n\n<p>Now there was another flaw you had - you passed <code>count</code> and somehow you expect the value you changed in <code>search</code> will be there in <code>main()</code>. C is pass by value and you changed to a local variable. That change is  lost when the called function ends.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint* linearsearch(int n,int* a,int x,int* count)\n{\n    *count=0;\n    if( n &lt;= 0){\n        fprintf(stderr, \"%s\\n\",\"Error\" );\n        exit(1);\n    }\n    int *t = malloc(sizeof(*t)*n);\n    if( t == NULL){\n        perror(\"Malloc failed\");\n        exit(1);\n    }\n    for(int i = 0; i &lt; n; i++)\n        if(a[i] == x)\n            t[(*count)++] = i;\n    int *temp = realloc(t,sizeof(*temp)* (*count));\n    if( temp == NULL){\n        perror(\"Realloc failed\");\n        exit(1);\n    }\n    t = temp;\n    return t;\n}\nint main(void)\n{\n    int n;\n    if( scanf(\"%d\",&amp;n)!= 1){\n        fprintf(stderr, \"%s\\n\", \"Error in input\");\n        exit(1);\n    }\n    if( n &lt;= 0 ){\n        fprintf(stderr, \"%s\\n\", \"Error in input : must be greater than 0\");\n        exit(1);   \n    }\n    int a[n];\n\n    for(int i=0; i &lt; n; i++)\n        if(scanf(\"%d\",&amp;a[i])!=1){\n            fprintf(stderr, \"%s\\n\",\"Error in input.\" );\n            exit(1);\n        }\n\n    int elmt_to_find;\n    if( scanf(\"%d\",&amp;elmt_to_find)!= 1){\n        fprintf(stderr, \"%s\\n\", \"Error in input : Element to find(must be integer)\");\n    }\n    int count;\n    int *b = linearsearch(n,a,elmt_to_find,&amp;count);\n    for(int i = 0; i &lt; count; i++)\n        printf(\"%d \",b[i]);\n    printf(\"%s\",\"\\n\");\n    free(b);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 0, "last_activity_date": 1514920612, "creation_date": 1514920612, "answer_id": 48066571, "question_id": 48065935, "link": "https://stackoverflow.com/questions/48065935/function-for-multiple-occurrences-in-linear-search-using-pointer/48066571#48066571", "title": "function for multiple occurrences in linear search using pointer", "body": "<p>If you want to stick with using VLA for <code>b</code>, you can alter your <code>linearsearch</code> to return <code>count</code> only if <code>b</code> is NULL. Then, you can create <code>b</code> as VLA, and pass it back to <code>linearsearch</code> again to be populated.</p>\n\n<pre><code>int count = linearsearch(n, a, x, 0, 0);\nint b[count];\nlinearsearch(n, a, x, count, b);\n</code></pre>\n\n<p>Then, your function could look like:</p>\n\n<pre><code>int linearsearch(int n,int a[n],int x,int count,int *b[count])\n{\n    int i;\n    if(count==0)\n    {\n        for(i=0;i&lt;n;i++)\n        {\n            if(a[i]==x)\n            {\n                count+=1;\n            }\n        }\n    }\n    if (b==0)\n    {\n        return count;\n    }\n    int j=0;\n    for(i=0;i&lt;n;i++)\n    {\n        if(a[i]==x)\n        {\n            b[j]=i;\n            j++;\n        }\n    }\n    return count;\n}\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 8450404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f4bc673dc9c0de86b0387b12877d82?s=128&d=identicon&r=PG&f=1", "display_name": "joey lang", "link": "https://stackoverflow.com/users/8450404/joey-lang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1514920612, "creation_date": 1514917488, "last_edit_date": 1514918509, "question_id": 48065935, "link": "https://stackoverflow.com/questions/48065935/function-for-multiple-occurrences-in-linear-search-using-pointer", "title": "function for multiple occurrences in linear search using pointer", "body": "<p>This is the code i wrote for multiple occurrences in linear search.Can you please help me point out the mistake ? I want the function to store multiple values in the pointer array and then later to print the array</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid linearsearch(int n,int a[n],int x,int count,int *b[count])\n{\n    count=0;\n    int i;\n    for(i=0;i&lt;n;i++)\n    {\n        if(a[i]==x)\n        {\n            count+=1;\n        }\n    }\n    int j=0;\n    for(i=0;i&lt;n;i++)\n    {\n        if(a[i]==x)\n        {\n            b[j]=i;\n            j++;\n        }\n    }\n}\nint main()\n{\n    int n;\n    scanf(\"%d\",&amp;n);\n    int a[n];\n    int i;\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%d\",&amp;a[i]);\n    }\n    int x;\n    scanf(\"%d\",&amp;x);\n    int count;\n    int *b[count];\n    linearsearch(n,a,x,count,b);\n    for(i=0;i&lt;count;i++)\n    {\n        printf(\"%d\",*b[i]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "microcontroller"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1514917222, "post_id": 48065817, "comment_id": 83104935, "body": "Please avoid asking multiple questions at once."}, {"owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1514917908, "post_id": 48065817, "comment_id": 83105221, "body": "@klutt, man, where are those multiple questions?!!"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1514918488, "post_id": 48065817, "comment_id": 83105488, "body": "Maybe I was a bit quick. The reason was that you wrote &quot;Another issue that I have&quot;, but I&#39;ll retract the close vote."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 6, "last_activity_date": 1514920960, "last_edit_date": 1514920960, "creation_date": 1514917112, "answer_id": 48065860, "question_id": 48065817, "link": "https://stackoverflow.com/questions/48065817/why-doesnt-error-directive-give-the-expected-result-here/48065860#48065860", "title": "Why doesn&#39;t #error directive give the expected result here?", "body": "<p>these statements</p>\n\n<pre><code>#if (port_number != MY_PORT_A &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number!=MY_PORT_D)\n#error \"Wrong Input. You have entered invalid port number.\"\n#endif\n</code></pre>\n\n<p>are evaluated at preprocessing/compile time. So they're evaluated whatever the outcome of the <code>switch</code> statement. In that case you're trying to test <code>port_number</code> which is a variable in the <code>#if</code> macro, which isn't possible.</p>\n\n<p>In general, the <code>#error</code> directive is useful for instance when some preprocessor constants are conflicting, <em>at compilation time</em>, certainly not <em>at run time</em>. The example you're quoting</p>\n\n<pre><code>#if (1)\n#error \"Wrong Input. You have entered invalid port number.\"\n#endif\n</code></pre>\n\n<p>\"works\" (well it's not very useful as is) because <code>1</code> is a compile-time constant.</p>\n\n<p>You want to test that at runtime, and throw a kind of \"exception\" when running:</p>\n\n<pre><code>default:\n{\n   fprintf(stderr,\"at %s line %d: Wrong Input. You have entered invalid port number.\\n\",__FILE__,__LINE__);\n   exit(1);\n}\n</code></pre>\n\n<p>no need for the <code>if</code> since all 4 cases have been ruled out by the <code>switch</code> statement.</p>\n\n<p>Also note that you can insert the handy <code>__FILE__</code> and <code>__LINE__</code> compilation-time values so you know where in the source code the error was raised (unless you want to use <code>assert(0);</code> directly)</p>\n"}, {"tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 3, "last_activity_date": 1514921805, "creation_date": 1514921805, "answer_id": 48066795, "question_id": 48065817, "link": "https://stackoverflow.com/questions/48065817/why-doesnt-error-directive-give-the-expected-result-here/48066795#48066795", "title": "Why doesn&#39;t #error directive give the expected result here?", "body": "<p>The preprocessor  <code>#if</code> can only test for values that have been <code>#define</code>'ed earlier. It knows nothing about variables, parameters, or enum values.</p>\n\n<p>And everything that doesn't come from a <code>#define</code> <a href=\"https://stackoverflow.com/questions/5085392/what-is-the-value-of-an-undefined-constant-used-in-if\">is given a default macro value of 0</a>.</p>\n\n<p>So your test turns out as</p>\n\n<pre><code>#if (0 != 0 &amp;&amp; 0 != 0 &amp;&amp; 0 != 0 &amp;&amp; 0 !=0)\n</code></pre>\n\n<p>And this will of course never trigger the <code>#error</code> message.</p>\n"}], "owner": {"reputation": 29, "user_id": 4487973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000236440055/picture?type=large", "display_name": "Alsayed Alsisi", "link": "https://stackoverflow.com/users/4487973/alsayed-alsisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1514921805, "creation_date": 1514916944, "question_id": 48065817, "link": "https://stackoverflow.com/questions/48065817/why-doesnt-error-directive-give-the-expected-result-here", "title": "Why doesn&#39;t #error directive give the expected result here?", "body": "<p>I am writing a \"gpio\" device driver for my AVR ATmega32 microcontroller. The driver has an initialization function that's shown below. I use enums to pass configuration to the function. An example of calling this function is </p>\n\n<pre><code>gpio_init_port(MY_PORT_A, INPUT, HIGH);\n</code></pre>\n\n<p>This would set PORTA as input with default value HIGH. I use switch statements to check the passed configuration to set the corresponding port as input or output. Now I thought of using #error preprocessor directive in the \"default\" case of the switch statement in case a user enters a wrong input, for example</p>\n\n<pre><code>gpio_init_port(5, INPUT, HIGH);\n</code></pre>\n\n<p>so compilation stops and an error message is printed. But I do not know why it's not working as I expect. The part of the code I am referring to is this:</p>\n\n<pre><code>default:\n#if (port_number != MY_PORT_A &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number!=MY_PORT_D)\n#error \"Wrong Input. You have entered invalid port number.\"\n#endif\n</code></pre>\n\n<p>The expression </p>\n\n<pre><code>(port_number != MY_PORT_A &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number!=MY_PORT_D)\n</code></pre>\n\n<p>doesn't evaluate and the error message isn't printed. But when I change it to</p>\n\n<pre><code>#if (1)\n#error \"Wrong Input. You have entered invalid port number.\"\n#endif\n</code></pre>\n\n<p>It works fine.\nAnother issue that I have is that when I write something like</p>\n\n<pre><code>gpio_init_port(5, ***OUTPUT***, HIGH);\n</code></pre>\n\n<p>The error message is also printed although I am passing \"OUTPUT\" this time and this not supposed to happen since the default case is defined only for the \"INPUT\" case.</p>\n\n<pre><code>gpio.h\n______\n\ntypedef enum port_number{\n   MY_PORT_A=0,\n   MY_PORT_B,\n   MY_PORT_C,\n   MY_PORT_D\n} port_number_t;\ntypedef enum port_direction{\n   INPUT=0,    \n   OUTPUT\n} port_direction_t;\ntypedef enum output_state{\n   LOW=0,\n   HIGH\n}output_state_t;\nvoid gpio_init_port(port_number_t port_number, port_direction_t port_direction, output_state_t initial_value);\n</code></pre>\n\n<hr>\n\n<pre><code>gpio.c\n________\n#include \"gpio.h\"\nvoid gpio_init_port(port_number_t port_number, port_direction_t port_direction, output_state_t initial_value)  \n{\nswitch (port_direction)\n{\ncase INPUT:\n{\n    switch (port_number)\n    {\n    case MY_PORT_A:\n    DDRA=0x00;\n    PORTA=initial_value? 0xff:0x00;\n    break;\n    case MY_PORT_B:\n    DDRB=0x00;\n    PORTB=initial_value? 0xff:0x00;\n    break;\n    case MY_PORT_C:\n    DDRC=0x00;\n    PORTC=initial_value? 0xff:0x00;\n    break;\n    case MY_PORT_D:\n    DDRD=0x00;\n    PORTD=initial_value? 0xff:0x00;\n    break;\n    default:\n    #if (port_number != MY_PORT_A &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number != MY_PORT_B &amp;&amp; port_number!=MY_PORT_D)\n    #error \"Wrong Input. You have entered invalid port number.\"\n    #endif\n    break;\n    }\n}\ncase OUTPUT:\n{\n    switch (port_number)\n    {\n    case MY_PORT_A:\n    DDRA=0xff;\n    PORTA=initial_value? 0xff:0x00;\n    break;\n    case MY_PORT_B:\n    DDRB=0xff;\n    PORTB=initial_value? 0xff:0x00;\n    break;\n    case MY_PORT_C:\n    DDRC=0xff;\n    PORTC=initial_value? 0xff:0x00;\n    break;\n    case MY_PORT_D:\n    DDRD=0xff;\n    PORTD=initial_value? 0xff:0x00;\n    break;  \n    }\n}\n}\n}\n</code></pre>\n\n<p>So, what is exactly wrong here? </p>\n\n<p>I have read that enums can't be used in conditional compilation, but I don't know if that's truly right and the reason of the problem.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "multithreading", "locking", "mutex", "atomic"], "comments": [{"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1514917504, "post_id": 48065769, "comment_id": 83105046, "body": "Writer starvation is a well-explored problem, but not easily solved without some idea of the expected characteristics of the resulting system. Have you given thought to reader vs. writer ratio? The length of read and write operations? There are many other factors and several different solutions besides RW locks as well. Have you considered making your data copy-on-write, for example?"}, {"owner": {"reputation": 353, "user_id": 7290419, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-3qx2L_4dffE/AAAAAAAAAAI/AAAAAAAAARA/ey_BY9GeMKA/photo.jpg?sz=128", "display_name": "Alex Sim", "link": "https://stackoverflow.com/users/7290419/alex-sim"}, "reply_to_user": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1514917873, "post_id": 48065769, "comment_id": 83105203, "body": "@DarkFalcon my structure contains pointers to dynamically allocated memory, so that approach woudn&#39;t work for me"}, {"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1514917941, "post_id": 48065769, "comment_id": 83105238, "body": "Sure it could. Copy everything deeply or keep a counter for how many references a given external pointer has. In any case, you&#39;re going to have to answer the other questions if you want help choosing an approach."}, {"owner": {"reputation": 353, "user_id": 7290419, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-3qx2L_4dffE/AAAAAAAAAAI/AAAAAAAAARA/ey_BY9GeMKA/photo.jpg?sz=128", "display_name": "Alex Sim", "link": "https://stackoverflow.com/users/7290419/alex-sim"}, "reply_to_user": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1514918217, "post_id": 48065769, "comment_id": 83105357, "body": "@DarkFalcon yeah but the allocated memory array could possibly be very long, and malloc is by itself an expensive operation"}, {"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1514918301, "post_id": 48065769, "comment_id": 83105393, "body": "Unless you&#39;re changing it only once every 5 minutes or something, in which case maybe cost doesn&#39;t matter much. <i>You still need to specify the performance characteristics of your system.</i>"}, {"owner": {"reputation": 353, "user_id": 7290419, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-3qx2L_4dffE/AAAAAAAAAAI/AAAAAAAAARA/ey_BY9GeMKA/photo.jpg?sz=128", "display_name": "Alex Sim", "link": "https://stackoverflow.com/users/7290419/alex-sim"}, "reply_to_user": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1514920143, "post_id": 48065769, "comment_id": 83106194, "body": "@DarkFalcon the structure is a basically just a string, which stores, other than the pointer to the string itself, (and the previously cited lock-level and lock-address) also the current string size. The header file it&#39;s declared in provides basic reading-writing-comparing-fileIO operations"}, {"owner": {"reputation": 353, "user_id": 7290419, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-3qx2L_4dffE/AAAAAAAAAAI/AAAAAAAAARA/ey_BY9GeMKA/photo.jpg?sz=128", "display_name": "Alex Sim", "link": "https://stackoverflow.com/users/7290419/alex-sim"}, "reply_to_user": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1514920525, "post_id": 48065769, "comment_id": 83106365, "body": "@DarkFalcon also, the header is a simple library I published, so it&#39;s up to the user to decide the frequency of read operations over write operations"}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 8555304, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nm9_nAmE7Co/AAAAAAAAAAI/AAAAAAAAAF4/JVE2Djql-C4/photo.jpg?sz=128", "display_name": "Emre Dalkiran", "link": "https://stackoverflow.com/users/8555304/emre-dalkiran"}, "is_accepted": false, "score": 1, "last_activity_date": 1514969884, "creation_date": 1514969884, "answer_id": 48074104, "question_id": 48065769, "link": "https://stackoverflow.com/questions/48065769/thread-locking-a-structure-in-read-only-mode-c11-stdatomic/48074104#48074104", "title": "Thread-locking a structure in read only mode (C11 stdatomic)", "body": "<p>You can try to use priority for read-write operations. I am assuming that rw/read ratio is low in your system. Implement a basic queue for rw requests and while there is a rw request waiting in the queue, prevent read requests to acquire the lock. After current read requests completed, acquire lock for rw and wait for it to complete. So as long as there is a rw request waiting in the queue or currently running, block read requests. When rw thread unlocks and there is no more rw requests waiting in the queue allow read requests to acquire lock. </p>\n\n<p>You may also need to use condition variables and signaling them depending on your implementation. </p>\n"}], "owner": {"reputation": 353, "user_id": 7290419, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-3qx2L_4dffE/AAAAAAAAAAI/AAAAAAAAARA/ey_BY9GeMKA/photo.jpg?sz=128", "display_name": "Alex Sim", "link": "https://stackoverflow.com/users/7290419/alex-sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514969884, "creation_date": 1514916652, "question_id": 48065769, "link": "https://stackoverflow.com/questions/48065769/thread-locking-a-structure-in-read-only-mode-c11-stdatomic", "title": "Thread-locking a structure in read only mode (C11 stdatomic)", "body": "<p>I've created a mutex-like lock function with stdatomic that basically does</p>\n\n<pre><code>do atomic_store(&amp;zero, 0);\nwhile (!atomic_compare_exchange_weak(&amp;mystructure-&gt;address, &amp;zero, threadlocal_address));\natomic_fetch_add(&amp;structure-&gt;locklevel, 1);\n</code></pre>\n\n<p>and another unlock function that decrements locklevel and sets the address back to zero ONLY IF locklevel==0 (this allows locking before calling a function which calls another lock, allowing it to still remain locked)</p>\n\n<p>this works fine for RW locking, but I also wanted to make a R-lock function (structure can be read by multiple functions, but trying to write it [calling a RW-lock] will put it to wait) and I tried by simply using a public address instead of a threadlocal one.</p>\n\n<p>The problem with this approach is it would lead to starvation of RW operations if many threads call R-lock in a loop (as locklevel would never [or hardly ever] get to zero)... any ideas?</p>\n"}, {"tags": ["c", "arrays", "printf", "strtok"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514915633, "post_id": 48065548, "comment_id": 83104333, "body": "You wanted to print the word or the first character from the word? <code>strtok</code> doesn&#39;t return  <code>char</code>"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 3, "creation_date": 1514915676, "post_id": 48065548, "comment_id": 83104357, "body": "Do you not get any warning for your code? Also, don&#39;t use <code>gets()</code> ever."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514915887, "post_id": 48065548, "comment_id": 83104440, "body": "It&#39;s still unclear what you want. Please clarify."}, {"owner": {"reputation": 9, "user_id": 8749481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c25e79eabc2accc76628c4af9c5b214?s=128&d=identicon&r=PG&f=1", "display_name": "stella", "link": "https://stackoverflow.com/users/8749481/stella"}, "edited": false, "score": 0, "creation_date": 1514916066, "post_id": 48065548, "comment_id": 83104512, "body": "I wanted to get the first word from my input."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515091805, "post_id": 48065548, "comment_id": 83178569, "body": "never use <code>gets()</code>.  It has been depreciated  for years and is completely removed from the latest C standard.  Suggest using <code>fgets( input, sizeof input, stdin );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515091918, "post_id": 48065548, "comment_id": 83178618, "body": "regarding: <code>word=strtok(input, &quot; &quot;);</code>,  always check (!=NULL) the returned pointer to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515092036, "post_id": 48065548, "comment_id": 83178676, "body": "regarding: <code>str[0]=word;</code>  This will copy the address value, found in <code>word</code> into a single character in the array <code>str[]</code>  This will not work for several reasons, including an address is several bytes.  Perhaps you meant: <code>strcpy( str, word );</code>  and even that is <code>ifffy</code> because there is no guarantee that the string pointed to be <code>word</code> is only 14 characters (plus the NUL terminator byte)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1515092417, "post_id": 48065548, "comment_id": 83178862, "body": "regarding: <code>printf(&quot;%c&quot;, str[0]);</code>  this statement will only place the first character in the array <code>str[]</code> into the <code>stdout</code> stream buffer.  When the program exits the character will be printed.  However, that is a poor method of getting the output displayed on the terminal.  Suggest: <code>printf(&quot;%c\\n&quot;, str[0]);</code> as the &#39;newline&#39; will force the <code>stdout</code> buffer to be printed immediately.  Note: this only prints the first character.  To print the word in <code>str[]</code> use: <code>printf( &quot;%s\\n&quot;, str );</code>"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 2, "last_activity_date": 1514918221, "last_edit_date": 1514918221, "creation_date": 1514915535, "answer_id": 48065571, "question_id": 48065548, "link": "https://stackoverflow.com/questions/48065548/print-character-which-is-in-an-array/48065571#48065571", "title": "Print character which is in an array", "body": "<p>So first of all don't use <code>gets()</code>.</p>\n\n<p>Then you did this <code>str[0]=word;</code> which is wrong. Two way to get away with it. Either use array of pointers and duplicate the string or copy the word in <code>str</code>.</p>\n\n<pre><code>char input[100];\nchar *word;\nchar str[15];\nif(fgets(input,100,stdin)){\n   word=strtok(input, \" \");\n   if( word &amp;&amp; strlen(word)&lt;15){\n      strcpy(str,word);\n      printf(\"First word: %s\\n\", str);   \n   }\n}\n</code></pre>\n\n<p>Or else</p>\n\n<pre><code>char input[100];\nchar *word;\nchar* str[5];\nif(fgets(input,100,stdin)){\n   word=strtok(input, \" \");\n   if( word ){\n      str[0]=strdup(word);\n      printf(\"First word %s\\n\", str[0]);   \n   }\n}\n</code></pre>\n\n<p>Or even more simply if you know that there is space between those words as you said</p>\n\n<pre><code>char input[100];\nchar str[15];\nif(fgets(input,100,stdin)){\n   if( sscanf(input,\"%14s\",str) == 1){\n     printf(\"First word %s\\n\",str);\n   }   \n}\n</code></pre>\n\n<hr>\n\n<p>To store all the words you need to extend the code a bit - I will show you the one with <code>strdup</code> the other can be similarly done.</p>\n\n<pre><code>char input[100];\nchar *word;\nchar* str[5];\nsize_t cnt = 0;\nif(fgets(input,100,stdin)){\n   word=strtok(input, \" \");\n   while( word != NULL ){\n      str[cnt]=strdup(word);\n      printf(\"%zu word %s\\n\",cnt, str[cnt]);\n      cnt++;\n      word=strtok(NULL, \" \");             \n   }\n}\n</code></pre>\n\n<p>Free the duplicated strings after you are done working with it.</p>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 0, "last_activity_date": 1514915538, "creation_date": 1514915538, "answer_id": 48065572, "question_id": 48065548, "link": "https://stackoverflow.com/questions/48065548/print-character-which-is-in-an-array/48065572#48065572", "title": "Print character which is in an array", "body": "<p><code>strtok</code> returns pointer to <code>char</code>. You need to dereference <code>word</code> before assigning it to <code>str[0]</code> as <code>str[0]</code> is of type <code>char</code>.<br>\nChange   </p>\n\n<pre><code>str[0]=word;  \n</code></pre>\n\n<p>to   </p>\n\n<pre><code>str[0] = *word;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "is_accepted": false, "score": 0, "last_activity_date": 1514915666, "creation_date": 1514915666, "answer_id": 48065602, "question_id": 48065548, "link": "https://stackoverflow.com/questions/48065548/print-character-which-is-in-an-array/48065602#48065602", "title": "Print character which is in an array", "body": "<p><a href=\"https://linux.die.net/man/3/strtok\" rel=\"nofollow noreferrer\">strtok</a> returns the pointer which refers to next token (in this case first token), so if you want to access the first character of this token, you must use <code>word[0]</code>. In your code, line <code>str[0]=word</code> is automatically casted to <code>str[0]=(char)word</code>, which means\nfirst byte of address of pointer. </p>\n\n<pre><code>char input[100];\nchar *word;\ngets(input);\nword=strtok(input, \" \");\nchar str[15];\nstr[0]=word[0];\nprintf(\"%c\", str[0]);\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8749481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c25e79eabc2accc76628c4af9c5b214?s=128&d=identicon&r=PG&f=1", "display_name": "stella", "link": "https://stackoverflow.com/users/8749481/stella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 48065571, "answer_count": 3, "score": 1, "last_activity_date": 1514918221, "creation_date": 1514915386, "question_id": 48065548, "link": "https://stackoverflow.com/questions/48065548/print-character-which-is-in-an-array", "title": "Print character which is in an array", "body": "<pre><code>char input[100];\nchar *word;\ngets(input);\nword=strtok(input, \" \");\nchar str[15];\nstr[0]=word;\nprintf(\"%c\", str[0]);\n</code></pre>\n\n<p>This is my code except headers. I tried to print out the character but it didn't work. How could I fix it...? I expected to see the character that I got from strtok().</p>\n"}, {"tags": ["c", "file", "memory"], "comments": [{"owner": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "edited": false, "score": 5, "creation_date": 1514915505, "post_id": 48065547, "comment_id": 83104288, "body": "fread() specifies how much you want to read, the next fread() will continue at the end of the previous call, keep going until you reach end of the file"}, {"owner": {"reputation": 7050, "user_id": 8033585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcd92ce2da15d74815d79b2908132d3?s=128&d=identicon&r=PG&f=1", "display_name": "AGN Gazer", "link": "https://stackoverflow.com/users/8033585/agn-gazer"}, "reply_to_user": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "edited": false, "score": 0, "creation_date": 1514915762, "post_id": 48065547, "comment_id": 83104397, "body": "@MartinBeckett You should make that comment an answer."}, {"owner": {"reputation": 65, "user_id": 6854529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-St1kpBJUkTQ/AAAAAAAAAAI/AAAAAAAAAQQ/cuB7ZbcD4nY/photo.jpg?sz=128", "display_name": "Raul San Martin", "link": "https://stackoverflow.com/users/6854529/raul-san-martin"}, "edited": false, "score": 0, "creation_date": 1514915816, "post_id": 48065547, "comment_id": 83104418, "body": "I need the content to do a checksum, so I need the complete message"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 2, "creation_date": 1514915904, "post_id": 48065547, "comment_id": 83104446, "body": "@RaulSanMartin, checksums can be updated: <code>md5(a+b) = md5(a).update(b)</code>. So, you don&#39;t need to load the whole file."}, {"owner": {"reputation": 7050, "user_id": 8033585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcd92ce2da15d74815d79b2908132d3?s=128&d=identicon&r=PG&f=1", "display_name": "AGN Gazer", "link": "https://stackoverflow.com/users/8033585/agn-gazer"}, "edited": false, "score": 0, "creation_date": 1514916062, "post_id": 48065547, "comment_id": 83104510, "body": "So, you need the whole message but without holding it in memory. Let me then ask you, what do you exactly mean by <i>&quot;need the whole message&quot;</i>? How do you imagine this working?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1514917015, "post_id": 48065547, "comment_id": 83104841, "body": "I am suprised you are asking that. Intuitively, files can be quite big, bigger than the memory... And this has always been the case. Who told you that a file needs to be small enough to fit in memory?"}, {"owner": {"reputation": 90163, "user_id": 10897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/csXHX.png?s=128&g=1", "display_name": "Martin Beckett", "link": "https://stackoverflow.com/users/10897/martin-beckett"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514917177, "post_id": 48065547, "comment_id": 83104914, "body": "@BasileStarynkevitch - presumably the introduction C programming course/book that the user is familiar with. I suspect your answer is a bit too complicated for them"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514921701, "post_id": 48065547, "comment_id": 83106836, "body": "The <i>checksum</i> motivation should be mentioned in your question. Please <b>edit your question</b> to improve it!"}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 3, "last_activity_date": 1514921048, "last_edit_date": 1514921048, "creation_date": 1514915991, "answer_id": 48065652, "question_id": 48065547, "link": "https://stackoverflow.com/questions/48065547/is-it-possible-to-read-a-file-without-loading-it-into-memory/48065652#48065652", "title": "Is it possible to read a file without loading it into memory?", "body": "<blockquote>\n  <p>I want to read a file but it is too big to load it completely into memory. </p>\n</blockquote>\n\n<p>Be aware that -in practice- <a href=\"https://en.wikipedia.org/wiki/Computer_file\" rel=\"nofollow noreferrer\">files</a> are an <a href=\"https://en.wikipedia.org/wiki/Abstraction_(software_engineering)\" rel=\"nofollow noreferrer\">abstraction</a> (so somehow an illusion) provided by your <a href=\"https://en.wikipedia.org/wiki/Operating_system\" rel=\"nofollow noreferrer\">operating system</a> thru <a href=\"https://en.wikipedia.org/wiki/File_system\" rel=\"nofollow noreferrer\">file systems</a>. Read <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\"><em>Operating Systems: Three Easy Pieces</em></a> (freely downloadable) to learn more about OSes. Files can be quite big (even if most of them are small), e.g. many dozens of gigabytes on current laptops or desktops (and many <a href=\"https://en.wikipedia.org/wiki/Terabyte\" rel=\"nofollow noreferrer\">terabytes</a> on servers, and perhaps more).</p>\n\n<p>You don't define what is memory, and the C11 standard <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a> uses that word in a different way, speaking of memory locations in \u00a73.14, and of memory management functions in \u00a77.22.3...</p>\n\n<p>In practice, a <a href=\"https://en.wikipedia.org/wiki/Process_(computing)\" rel=\"nofollow noreferrer\">process</a> has its <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow noreferrer\">virtual address space</a>, related to <a href=\"https://en.wikipedia.org/wiki/Virtual_memory\" rel=\"nofollow noreferrer\">virtual memory</a>.</p>\n\n<p>On many <a href=\"https://en.wikipedia.org/wiki/Operating_system\" rel=\"nofollow noreferrer\">operating systems</a> -notably Linux and POSIX- you can change the virtual address space with <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">mmap(2)</a> and related <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow noreferrer\">system calls</a>, and you could use <a href=\"https://en.wikipedia.org/wiki/Memory-mapped_file\" rel=\"nofollow noreferrer\">memory-mapped files</a>.</p>\n\n<blockquote>\n  <p>Is there a way to read it without loading it into memory? </p>\n</blockquote>\n\n<p>Of course, you can read and write partial chunks of some file (e.g. using <a href=\"http://en.cppreference.com/w/c/io/fread\" rel=\"nofollow noreferrer\">fread</a>, <a href=\"http://en.cppreference.com/w/c/io/fwrite\" rel=\"nofollow noreferrer\">fwrite</a>, <a href=\"http://en.cppreference.com/w/c/io/fseek\" rel=\"nofollow noreferrer\">fseek</a>, or the lower-level system calls <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\">read(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\">write(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/lseek.2.html\" rel=\"nofollow noreferrer\">lseek(2)</a>, ...). For performance reasons, better use large buffers (several kilobytes at least). In practice, most <a href=\"https://en.wikipedia.org/wiki/Checksum\" rel=\"nofollow noreferrer\">checksums</a> (or <a href=\"https://en.wikipedia.org/wiki/Cryptographic_hash_function\" rel=\"nofollow noreferrer\">cryptographic hash functions</a>) can be computed chunkwise, on a very long stream of data.</p>\n\n<p>Many libraries are built above such primitives (doing direct IO by chunks). For example the <a href=\"http://sqlite.org/\" rel=\"nofollow noreferrer\">sqlite</a> database library is able to handle database files of <a href=\"https://softwareengineering.stackexchange.com/a/332071/40065\">many terabytes</a> (more than the available RAM). And you could use <a href=\"https://en.wikipedia.org/wiki/Relational_database_management_system\" rel=\"nofollow noreferrer\">RDBMS</a> (they are software coded in C or C++)</p>\n\n<p>So of course you can deal with files larger than available RAM and read or write them by chunks (or \"records\"), and this has been true since at least the 1960s. I would even say that intuitively, files can (usually) be much larger than RAM, but smaller than a single disk (however, even this is not always true; some file systems are able to span several physical disks, e.g. using <a href=\"https://en.wikipedia.org/wiki/Logical_volume_management\" rel=\"nofollow noreferrer\">LVM</a> techniques).</p>\n\n<p><sup>(on my Linux desktop with 32Gbytes of RAM, the largest file has 69Gbytes, on an ext4 filesystem with 669G available and 780G total space, and I did had in the past files above 100 Gbytes)</sup></p>\n\n<p>You might find worthwhile to use some database like <a href=\"http://sqlite.org/\" rel=\"nofollow noreferrer\">sqlite</a> (or be a client of some RDBMS like <a href=\"http://postgresql.org/\" rel=\"nofollow noreferrer\">PostGreSQL</a>, etc...), or you could be interested in libraries for indexed files like <a href=\"http://www.gnu.org.ua/software/gdbm/manual/gdbm.html\" rel=\"nofollow noreferrer\">gdbm</a>. Of course you can also do direct I/O operations (e.g. <code>fseek</code> then <code>fread</code> or <code>fwrite</code>, or <code>lseek</code> then <code>read</code> or <code>write</code>, or <a href=\"http://man7.org/linux/man-pages/man2/pread.2.html\" rel=\"nofollow noreferrer\">pread(2)</a> or <code>pwrite</code> ...).</p>\n"}, {"tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 2, "last_activity_date": 1514919061, "last_edit_date": 1514919061, "creation_date": 1514917636, "answer_id": 48065963, "question_id": 48065547, "link": "https://stackoverflow.com/questions/48065547/is-it-possible-to-read-a-file-without-loading-it-into-memory/48065963#48065963", "title": "Is it possible to read a file without loading it into memory?", "body": "<p>One way to do this, if the problem is RAM, not virtual address space, is memory mapping the file, either <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">via <code>mmap</code></a> on POSIX systems, or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366537(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>CreateFileMapping</code></a>/<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366761(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>MapViewOfFile</code></a> on Windows.</p>\n\n<p>That can get you what <em>looks</em> like a raw array of the file bytes, but with the OS responsible for paging the contents in (and writing them back to disk if you alter them) as you go. When mapped read-only, it's quite similar to just <code>malloc</code>-ing a block of memory and <code>fread</code>-ing to populate it, but:</p>\n\n<ol>\n<li>It's lazy: For a 1 GB file, you're not waiting the 5-30 seconds for the whole thing to be read in before you can work with any part of it, instead, you just pay for each page on access (and sometimes, the OS will pre-read in the background, so you don't even have to wait on the per-page load in)</li>\n<li>It responds better under memory pressure; if you run out of memory, the OS can just drop clean pages from memory without writing them to swap, knowing it can page them back in from the golden copy in the file whenever they're needed; with <code>malloc</code>-ed memory, it has to write it out to swap, increasing disk traffic at a time when you're likely oversubscribed on the disk already</li>\n</ol>\n\n<p>Performance-wise, this can be slightly slower under default settings (since, without memory pressure, reading the whole file in mostly guarantees it will be in memory when asked for, while random access to a memory mapped file is likely to trigger on-demand page faults to populate each page on first access), though you can use <a href=\"https://linux.die.net/man/3/posix_madvise\" rel=\"nofollow noreferrer\"><code>posix_madvise</code></a> with <code>POSIX_MADV_WILLNEED</code> (POSIX systems) or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/hh780543(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>PrefetchVirtualMemory</code></a> (Windows 8 and higher) to provide a hint that the entire file will be needed, causing the system to (usually) page it in in the background, even as you're accessing it. On POSIX systems, other <code>advise</code> hints can be used for more granular hinting when paging the whole file in at once isn't necessary (or possible), e.g. using <code>POSIX_MADV_SEQUENTIAL</code> if you're reading the file data in order from beginning to end usually triggers more aggressive prefetch of subsequent pages, increasing the odds that they're in memory by the time you get to them. By doing so, you get the best of both worlds; you can begin accessing the data almost immediately, with a delay on accessing pages not paged in yet, but the OS will be pre-loading the pages for you in the background, so you eventually run as full speed (while still being more resilient to memory pressure, since the OS can just drop clean pages, rather than writing them to swap first).</p>\n\n<p>The main limitation here is virtual address space. If you're on a 32 bit system, you're likely limited to (depending on how fragmented the existing address space is) 1-3 GB of contiguous address space, which means you'd have to map the file in chunks, and can't have on-demand random access to any point in the file at any time without additional system calls. Thankfully, on 64 bit systems, this limitation rarely comes up; even the most limiting 64 bit systems (Windows 7) provide 8 TB of user virtual address space per process, far larger than the vast, <em>vast</em> majority of files you're likely to encounter (and later versions increase the cap to 128 TB).</p>\n"}, {"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1514925486, "post_id": 48067358, "comment_id": 83108472, "body": "This gets to the X of the OP&#39;s question Y."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 3, "last_activity_date": 1514925905, "last_edit_date": 1514925905, "creation_date": 1514924622, "answer_id": 48067358, "question_id": 48065547, "link": "https://stackoverflow.com/questions/48065547/is-it-possible-to-read-a-file-without-loading-it-into-memory/48067358#48067358", "title": "Is it possible to read a file without loading it into memory?", "body": "<blockquote>\n  <p><em>I need the content to do a checksum, so I need the complete message</em></p>\n</blockquote>\n\n<p>Many checksum libraries support incremental updates to the checksum. For example, the GLib has <a href=\"https://developer.gnome.org/glib/unstable/glib-Data-Checksums.html#g-checksum-update\" rel=\"nofollow noreferrer\"><code>g_checksum_update()</code></a>. So you can read the file a block at a time with <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fread.htm\" rel=\"nofollow noreferrer\"><code>fread</code></a> and update the checksum as you read.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;glib.h&gt;\n\nint main(void) {\n    char filename[] = \"test.txt\";\n\n    // Create a SHA256 checksum\n    GChecksum *sum = g_checksum_new(G_CHECKSUM_SHA256);\n    if( sum == NULL ) {\n        fprintf(stderr, \"Could not create checksum.\\n\");\n        exit(1);\n    }\n\n    // Open the file we'll be checksuming.\n    FILE *fp = fopen( filename, \"rb\" );\n    if( fp == NULL ) {\n        fprintf(stderr, \"Could not open %s: %s.\\n\", filename, strerror(errno));\n        exit(1);\n    }\n\n    // Read one buffer full at a time (BUFSIZ is from stdio.h)\n    // and update the checksum.    \n    unsigned char buf[BUFSIZ];\n    size_t size_read = 0;\n    while( (size_read = fread(buf, 1, sizeof(buf), fp)) != 0 ) {\n        // Update the checksum\n        g_checksum_update(sum, buf, (gssize)size_read);\n    }\n\n    // Print the checksum.\n    printf(\"%s %s\\n\", g_checksum_get_string(sum), filename);\n}\n</code></pre>\n\n<p>And we can check it works by comparing the result with <code>sha256sum</code>.</p>\n\n<pre><code>$ ./test\n0c46af5bce717d706cc44e8c60dde57dbc13ad8106a8e056122a39175e2caef8 test.txt\n$ sha256sum test.txt \n0c46af5bce717d706cc44e8c60dde57dbc13ad8106a8e056122a39175e2caef8  test.txt\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6854529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-St1kpBJUkTQ/AAAAAAAAAAI/AAAAAAAAAQQ/cuB7ZbcD4nY/photo.jpg?sz=128", "display_name": "Raul San Martin", "link": "https://stackoverflow.com/users/6854529/raul-san-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2631, "favorite_count": 0, "accepted_answer_id": 48067358, "answer_count": 3, "score": 1, "last_activity_date": 1514925905, "creation_date": 1514915384, "last_edit_date": 1514921092, "question_id": 48065547, "link": "https://stackoverflow.com/questions/48065547/is-it-possible-to-read-a-file-without-loading-it-into-memory", "title": "Is it possible to read a file without loading it into memory?", "body": "<p>I want to read a file but it is too big to load it completely into memory. </p>\n\n<p>Is there a way to read it without loading it into memory? Or there is a better solution?</p>\n"}, {"tags": ["c", "binary", "bmp"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514915518, "post_id": 48065528, "comment_id": 83104292, "body": "Have you forgotten about stride? The size of each row of pixel data in a bmp image must be a multiple of 4 bytes, which means there are 0 to 3 padding bytes at the end of each row."}, {"owner": {"reputation": 21, "user_id": 9164809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c8966a69279db9eae4bf9bcc4a3a90?s=128&d=identicon&r=PG&f=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9164809/foxy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514915919, "post_id": 48065528, "comment_id": 83104451, "body": "Can you give me an example, for my code if you can?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514915965, "post_id": 48065528, "comment_id": 83104467, "body": "Ah, you should look up the bmp definition, but now you have posted the image links, I suggest you look at <code>sizeof(RGBQUAD)</code> which is not 3 but 4. Are there 24 or 32 bits per pixel?"}, {"owner": {"reputation": 21, "user_id": 9164809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c8966a69279db9eae4bf9bcc4a3a90?s=128&d=identicon&r=PG&f=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9164809/foxy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514916187, "post_id": 48065528, "comment_id": 83104556, "body": "24 bits per pixel"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1514916220, "post_id": 48065528, "comment_id": 83104570, "body": "So there is your answer."}, {"owner": {"reputation": 21, "user_id": 9164809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c8966a69279db9eae4bf9bcc4a3a90?s=128&d=identicon&r=PG&f=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9164809/foxy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514917389, "post_id": 48065528, "comment_id": 83105002, "body": "So, i must change my array size with a stride, where stride = ( bits per row +31)/32 *4?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1514917659, "post_id": 48065528, "comment_id": 83105105, "body": "You must get the stride right, and you must write to sets of 3 bytes, not 4. You are writing to 3 bytes, then skipping one, then to the next 3 and so on. An easy way to do that you be to have an array of <code>unsigned char</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 0, "last_activity_date": 1514953530, "creation_date": 1514953530, "answer_id": 48071145, "question_id": 48065528, "link": "https://stackoverflow.com/questions/48065528/color-changing-bmp-in-c/48071145#48071145", "title": "Color changing bmp in c", "body": "<p><code>info.biSizeImage</code> can be zero. Check to make sure it is not zero, or calculate it based on stride. Width, height, and bitcount values are always set.</p>\n\n<p>As noted in comments, 24 bit image has 3 bytes (24 bit) per pixel. <code>RGBQUA</code> is for 32-bit image. You have to iterate through the height, and then width 3 bytes at a time.</p>\n\n<pre><code>int main(void)\n{\n    BITMAPFILEHEADER file;\n    BITMAPINFOHEADER info;\n    FILE* f = fopen(\"imagine.bmp\", \"rb\");\n    fread(&amp;file, sizeof(BITMAPFILEHEADER), 1, f);\n    fread(&amp;info, sizeof(BITMAPINFOHEADER), 1, f);\n    if(info.biBitCount != 24)\n        return 0;\n\n    int stride = ((info.biWidth * info.biBitCount + 31) / 32) * 4;\n    int size = stride * info.biHeight;\n    BYTE *a = malloc(stride * info.biHeight);\n    fread(a, 1, size, f);\n    for(int y = info.biHeight - 1; y &gt;= 0; y--)\n    {\n        for(int x = 0; x &lt; stride; x += 3)\n        {\n            int i = y * stride + x;\n            a[i + 0] = 255;\n            a[i + 1] = 255;\n            a[i + 2] = 255;\n        }\n    }\n\n    FILE* f2 = fopen(\"imagine2\", \"wb\");\n    if(f2 == NULL)\n        printf(\"Error\");\n    fwrite(&amp;file, sizeof(BITMAPFILEHEADER), 1, f2);\n    fwrite(&amp;info, sizeof(BITMAPINFOHEADER), 1, f2);\n    fwrite(a, 1, size, f2);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9164809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35c8966a69279db9eae4bf9bcc4a3a90?s=128&d=identicon&r=PG&f=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9164809/foxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "accepted_answer_id": 48071145, "answer_count": 1, "score": 1, "last_activity_date": 1514953530, "creation_date": 1514915307, "last_edit_date": 1514951642, "question_id": 48065528, "link": "https://stackoverflow.com/questions/48065528/color-changing-bmp-in-c", "title": "Color changing bmp in c", "body": "<p>I have a pixel information array who has the biSizeImage size and contains triplets of the form (blue, green, red) with values \u200b\u200bbetween 0 and 255. I must change my bmp color from red, to white, but i have a problem, as can be seen in picture.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\nint main()\n{ \nBITMAPFILEHEADER file;\nBITMAPINFOHEADER info;\nFILE* f=fopen(\"imagine.bmp\",\"rb\");\nfread(&amp;file,sizeof(BITMAPFILEHEADER),1,f);\nfread(&amp;info,sizeof(BITMAPINFOHEADER),1,f);\nRGBQUAD *a=malloc(info.biSizeImage*sizeof(RGBQUAD));\nfread(a,sizeof(RGBQUAD),info.biSizeImage,f);\nfor(int i=0;i&lt;info.biSizeImage;i++)\n  {\n      a[i].rgbBlue=255;\n      a[i].rgbGreen=255;\n      a[i].rgbRed=255;\n  }\nFILE* f2=fopen(\"imagine2.bmp\",\"wb\");\nif(f2==NULL)\n    printf(\"Error\");\nfwrite(&amp;file,sizeof(BITMAPFILEHEADER),1,f2);\nfwrite(&amp;info,sizeof(BITMAPINFOHEADER),1,f2);\nfwrite(a,sizeof(RGBQUAD),info.biSizeImage,f2);\nreturn 0;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aC8fO.png\" rel=\"nofollow noreferrer\">Output</a>\n<br></p>\n\n<p><a href=\"https://i.stack.imgur.com/ldbxg.png\" rel=\"nofollow noreferrer\">Original image</a></p>\n"}, {"tags": ["c", "bison", "yacc"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514915340, "post_id": 48065494, "comment_id": 83104217, "body": "Is it Bison that complains, or the C compiler when compiling the generated code? And please copy-paste the full and complete output of either Bison or the compiler into the question body."}, {"owner": {"reputation": 3821, "user_id": 7387749, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/A8I2m.jpg?s=128&g=1", "display_name": "Simone", "link": "https://stackoverflow.com/users/7387749/simone"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1514916116, "post_id": 48065494, "comment_id": 83104531, "body": "@Someprogrammerdude I run the file by <code>bison file.y</code>, the error that I get (translated in English) is something like <code>is missing a declaration type for $2 in &#39;seq&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1514919319, "post_id": 48065896, "comment_id": 83105843, "body": "&quot;to create your own string from the sequence&quot; <b>and</b> to assign it to <code>$$</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1514917299, "creation_date": 1514917299, "answer_id": 48065896, "question_id": 48065494, "link": "https://stackoverflow.com/questions/48065494/error-undeclared-variable/48065896#48065896", "title": "Error: undeclared variable $", "body": "<p>You haven't told Bison what type <code>seq</code> is, so it doesn't know what to do with <code>$2</code>.</p>\n\n<p>Use the <code>%type</code> directive:</p>\n\n<pre><code>%type &lt;cval&gt; seq\n</code></pre>\n\n<hr>\n\n<p>Note that the type used for <code>$2</code> is a single <code>char</code>, which is not a string as expected by the <code>\"%s\"</code> format. You need to come up with a way to create your own string from the sequence.</p>\n"}], "owner": {"reputation": 3821, "user_id": 7387749, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/A8I2m.jpg?s=128&g=1", "display_name": "Simone", "link": "https://stackoverflow.com/users/7387749/simone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 48065896, "answer_count": 1, "score": 1, "last_activity_date": 1514917299, "creation_date": 1514915141, "last_edit_date": 1514915830, "question_id": 48065494, "link": "https://stackoverflow.com/questions/48065494/error-undeclared-variable", "title": "Error: undeclared variable $", "body": "<p>When I run the <code>bison</code>program below (by <code>bison file.y</code>) , I get the error <code>missing a declaration type for $2 in 'seq'</code> :</p>\n\n<pre><code>%union {\n       char cval;\n}\n%token &lt;cval&gt; AMINO \n%token STARTCODON STOPCODON\n\n%%\nseries: STARTCODON seq STOPCODON {printf(\"%s\", $2);}\nseq : AMINO\n         | seq AMINO\n         ;\n%%\n</code></pre>\n\n<p>I would like to know why I get this error, and how I can correctly declare the variable <code>$2</code></p>\n"}, {"tags": ["c++", "c", "memory-management", "gmp"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1514913759, "post_id": 48065162, "comment_id": 83103575, "body": "Why don&#39;t you use the C++ API for GMP?"}, {"owner": {"reputation": 1497, "user_id": 5504922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bc22b2096bef7bf39b68e241b81efb?s=128&d=identicon&r=PG&f=1", "display_name": "EdmCoff", "link": "https://stackoverflow.com/users/5504922/edmcoff"}, "edited": false, "score": 1, "creation_date": 1514913837, "post_id": 48065162, "comment_id": 83103609, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15139436/why-free-doesnt-really-frees-memory\" title=\"why free doesnt really frees memory\">stackoverflow.com/questions/15139436/&hellip;</a> ?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514913976, "post_id": 48065162, "comment_id": 83103674, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15139436/why-free-doesnt-really-frees-memory\">Why free() doesn&#39;t really frees memory?</a>"}, {"owner": {"reputation": 1, "user_id": 6796582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9fb5e2d94b680a91357bba33f09670c?s=128&d=identicon&r=PG&f=1", "display_name": "Akira Takahashi", "link": "https://stackoverflow.com/users/6796582/akira-takahashi"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1514914424, "post_id": 48065162, "comment_id": 83103871, "body": "@KerrekSB I did. Please look at the second sample code."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1514916059, "post_id": 48065162, "comment_id": 83104508, "body": "Ah, yes. Your system allocator probably just doesn&#39;t return memory to the OS. Which allocator are you using?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1514916150, "post_id": 48065162, "comment_id": 83104548, "body": "@AkiraTakahashi -- What would the results be if you called <code>malloc</code>, and then immediately called <code>free()</code>?  Would your results be the same?  If so, then the issue has nothing to do with <code>gmp</code>, but how the heap manager handles the memory."}, {"owner": {"reputation": 1, "user_id": 6796582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9fb5e2d94b680a91357bba33f09670c?s=128&d=identicon&r=PG&f=1", "display_name": "Akira Takahashi", "link": "https://stackoverflow.com/users/6796582/akira-takahashi"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1514951684, "post_id": 48065162, "comment_id": 83115509, "body": "@KerrekSB I&#39;m using glibc&#39;s malloc on Ubuntu 16.04"}, {"owner": {"reputation": 1, "user_id": 6796582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9fb5e2d94b680a91357bba33f09670c?s=128&d=identicon&r=PG&f=1", "display_name": "Akira Takahashi", "link": "https://stackoverflow.com/users/6796582/akira-takahashi"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1514952191, "post_id": 48065162, "comment_id": 83115611, "body": "@PaulMcKenzie It wasn&#39;t the same (either with <code>calloc</code>). <code>free</code> immediately returned the memory to the OS. Additionally, I experimented with an array/vector of <code>uint64_t</code> but the allocated memory was completely released back in this case."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514972348, "post_id": 48065162, "comment_id": 83122951, "body": "Big chunks are usually allocated by a different method, and <i>are</i> released back to the OS. You probably shouldn&#39;t care about any of this unless you are writing your own allocator."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514972703, "post_id": 48065162, "comment_id": 83123152, "body": "malloc followed immediately by free won&#39;t necessarily be reflected in the RSS. Watching RSS is not a good way to understand your heap performance."}], "owner": {"reputation": 1, "user_id": 6796582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9fb5e2d94b680a91357bba33f09670c?s=128&d=identicon&r=PG&f=1", "display_name": "Akira Takahashi", "link": "https://stackoverflow.com/users/6796582/akira-takahashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514972083, "creation_date": 1514913449, "last_edit_date": 1514972083, "question_id": 48065162, "link": "https://stackoverflow.com/questions/48065162/how-can-i-completely-free-the-memory-allocated-for-array-vector-of-gmp-mpz-t-mpz", "title": "How can I completely free the memory allocated for array/vector of GMP mpz_t/mpz_class?", "body": "<p>I need to handle the large array of <code>mpz_t</code> and release the memory afterwords. However, when profiling the RSS at each stage with <code>htop</code> command, <code>mpz_clear</code> does not seem to free the memory completely. </p>\n\n<p>Here's the sample C code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;gmp.h&gt;\n\nint main(void) {\n    mpz_t *A;\n    int size = 1&lt;&lt;20;\n    A = (mpz_t *) malloc(size*sizeof(mpz_t));\n    getchar(); // RSS=876KB\n\n    for (int i=0; i&lt;size; i++) {\n        mpz_init_set_ui(A[i],0);\n    }\n    getchar(); // RSS=50MB\n\n    for (int i=0; i&lt;size; i++) {\n        mpz_clear(A[i]);\n    }\n    free(A);\n    getchar(); // RSS=34MB!!\n\n    return 0;\n}\n</code></pre>\n\n<p>Looking at the answer <a href=\"https://stackoverflow.com/a/26910710/6796582\">here</a>, the memory deallocation process above (i.e. call <code>mpz_clear</code> on <code>mpz_t</code> elements &amp; <code>free</code> array) is properly done.</p>\n\n<p>I also tried with the vector of <code>mpz_class</code> C++ wrapper as follows, which resulted in the same situation.</p>\n\n<pre><code>#include &lt;gmpxx.h&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main(void) {\n    std::vector&lt;mpz_class&gt; A;\n    int size = 1 &lt;&lt; 20;\n    A.reserve(size);\n    std::cin.ignore();\n\n    for (int i=0; i&lt;(size); i++) {\n        A.emplace_back(0);\n    }\n    std::cin.ignore();\n\n    std::vector&lt;mpz_class&gt;().swap(A);\n    std::cin.ignore();\n\n    return 0;\n}\n</code></pre>\n\n<p>Is there any way to release the whole memory allocated for an <code>mpz_t</code> array?</p>\n\n<h2>Update</h2>\n\n<p>Thanks to the comment section I've learnt that <a href=\"https://stackoverflow.com/questions/15139436/why-free-doesnt-really-frees-memory\"><code>free</code> does not necessarily release the memory back to the OS</a>. But in my case, using glibc on Ubuntu 16.04, <code>free()</code> <strong>does</strong> release the amount of memory reserved by <code>malloc</code> (i.e 16*2^20 = 16MB, assuming that <code>sizeof(mpz_t)</code> is 16-byte) because it exceeds the default <a href=\"http://man7.org/linux/man-pages/man3/mallopt.3.html\" rel=\"nofollow noreferrer\"><code>M_MMAP_THRESHOLD</code></a> value (=128KB). </p>\n\n<p>So I suspect that there is still some orphaned memory implicitly allocated by GMP (\u224832MB in the above example) and <code>free()</code> needs to be called on it separately. </p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 376, "user_id": 3848463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e1e9a81c88bdf7c33e434d1994c1ab?s=128&d=identicon&r=PG", "display_name": "wolff", "link": "https://stackoverflow.com/users/3848463/wolff"}, "edited": false, "score": 0, "creation_date": 1514913479, "post_id": 48065088, "comment_id": 83103466, "body": "The line <code>int KidsInStreets[houses].</code> is the problem. <code>houses</code> is zero, so you create an array with size 0."}, {"owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "reply_to_user": {"reputation": 376, "user_id": 3848463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e1e9a81c88bdf7c33e434d1994c1ab?s=128&d=identicon&r=PG", "display_name": "wolff", "link": "https://stackoverflow.com/users/3848463/wolff"}, "edited": false, "score": 0, "creation_date": 1514913552, "post_id": 48065088, "comment_id": 83103493, "body": "Oh ok, so the array of KidsInStreets[houses] should be made after the first for loops?"}, {"owner": {"reputation": 376, "user_id": 3848463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e1e9a81c88bdf7c33e434d1994c1ab?s=128&d=identicon&r=PG", "display_name": "wolff", "link": "https://stackoverflow.com/users/3848463/wolff"}, "edited": false, "score": 0, "creation_date": 1514913870, "post_id": 48065088, "comment_id": 83103619, "body": "You could either declare it as an array with a size of a known maximum, or - like you proposed - declare it after you know the number of houses. Google for dynamic memory allocation."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 1, "creation_date": 1514914243, "post_id": 48065088, "comment_id": 83103790, "body": "Eerily similar to <a href=\"https://stackoverflow.com/questions/48049598/asking-for-user-input-for-a-2d-array-and-storing-the-data-in-the-array-in-c\" title=\"asking for user input for a 2d array and storing the data in the array in c\">stackoverflow.com/questions/48049598/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514962249, "post_id": 48065088, "comment_id": 83118620, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "edited": false, "score": 0, "creation_date": 1515078715, "post_id": 48065286, "comment_id": 83171247, "body": "Ok, the code works perfectly, what would i need to do in order to have something like: &quot;total kids in street %d is :...&quot;? How would I modify the code?"}, {"owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "edited": false, "score": 0, "creation_date": 1515082153, "post_id": 48065286, "comment_id": 83173311, "body": "This the code I added to modify it to do a sum of teh elemnts in teh array, but it does a cumalitive sum:"}, {"owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "edited": false, "score": 0, "creation_date": 1515082157, "post_id": 48065286, "comment_id": 83173314, "body": "for (i=0;i&lt;10;i++) {     for (j=0;j&lt;houses_in_street[i];j++)     {         printf(&quot;Street:%d\\n House:%d Kids:%d\\n&quot;, i+1, j+1, streets[i][j]);         sum=sum+streets[i][j];     }     printf(&quot;Total number of kids in street %d are %d\\n&quot;, i+1, sum); } }"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "edited": false, "score": 0, "creation_date": 1515083048, "post_id": 48065286, "comment_id": 83173875, "body": "@Jiren - the code in your comment seems fine - just remember to initialize <code>sum</code> to zero"}, {"owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "edited": false, "score": 0, "creation_date": 1515083320, "post_id": 48065286, "comment_id": 83174043, "body": "rather than it doing a cumilative sum, how can I change it to do a sum of each street?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "edited": false, "score": 0, "creation_date": 1515086665, "post_id": 48065286, "comment_id": 83176042, "body": "@jiren Let me suggest that you take the code now and post it as a new answer. It&#39;s hard to view/write code in comments :-)"}, {"owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "edited": false, "score": 0, "creation_date": 1515086853, "post_id": 48065286, "comment_id": 83176131, "body": "Ok, will do, sorry for rhe incovenience"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1514914390, "last_edit_date": 1514914390, "creation_date": 1514914032, "answer_id": 48065286, "question_id": 48065088, "link": "https://stackoverflow.com/questions/48065088/writing-to-an-array-of-arrays-and-displaying-the-seperate-entities-in-the-array/48065286#48065286", "title": "Writing to an array of arrays and displaying the seperate entities in the array of arrays in C", "body": "<p>One problem is that <code>houses</code> is zero when you do <code>int KidsInStreets[houses];</code>. But the real problem is that you just have <strong>one</strong> array but you need an array for <strong>each</strong> street.</p>\n\n<p>Try something like:</p>\n\n<pre><code>int* streets[10];   // Notice *\nint houses=0;\nfor (i=0;i&lt;10;i++)\n{\n    printf(\"How many houses are there in street %d:\\n\", i+1);\n    scanf(\"%d\",&amp;houses);\n    streets[i] = malloc(houses * sizeof(int)); // Allocate array\n    for (j=0;j&lt;houses;j++)\n    {\n        printf(\"How many kids are there in house number %d, in street number %d:\\n\", j+1, i+1);\n        scanf(\"%d\", &amp;streets[i][j]);\n    }\n}\n</code></pre>\n\n<p>The problem is however that now you don't know how many houses there were in each street. So you need to save that information. To do that you could make a struct or an extra array.</p>\n\n<p>An extra array is not so elegant but very easy:</p>\n\n<pre><code>int* streets[10];   // Notice *\nint houses_in_street[10];\nint houses=0;\nfor (i=0;i&lt;10;i++)\n{\n    printf(\"How many houses are there in street %d:\\n\", i+1);\n    scanf(\"%d\",&amp;houses);\n    streets[i] = malloc(houses * sizeof(int)); // Allocate array\n    houses_in_street[i] = houses;\n    for (j=0;j&lt;houses;j++)\n    {\n        printf(\"How many kids are there in house number %d, in street number %d:\\n\", j+1, i+1);\n        scanf(\"%d\", &amp;streets[i][j]);\n    }\n}\n\n\nfor (i=0;i&lt;10;i++)\n{\n    for (j=0;j&lt;houses_in_street[i];j++)\n    {\n        printf(\"Street:%d House:%d Kids:%d\\n\", i+1, j+1, streets[i][j]);\n    }\n}\n</code></pre>\n\n<p>A better solution would be a struct like:</p>\n\n<pre><code>struct street {\n    int number;\n    int houses;\n    int* kids_in_house;\n};\n\n// use it like\nstruct street streets[10];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "is_accepted": false, "score": 0, "last_activity_date": 1515087084, "creation_date": 1515087084, "answer_id": 48100579, "question_id": 48065088, "link": "https://stackoverflow.com/questions/48065088/writing-to-an-array-of-arrays-and-displaying-the-seperate-entities-in-the-array/48100579#48100579", "title": "Writing to an array of arrays and displaying the seperate entities in the array of arrays in C", "body": "<pre><code>void streets()\n{\nint i=0;\nint j=0;\nint* streets[10];\nint houses_in_street[10];\nint houses=0;\nfor (i=0;i&lt;10;i++)\n{\n    printf(\"How many houses are there in street %d:\\n\", i+1);\n    scanf(\"%d\",&amp;houses);\n    streets[i] = malloc(houses * sizeof(int)); // Allocate array\n    houses_in_street[i] = houses;\n    for (j=0;j&lt;houses;j++)\n    {\n        printf(\"How many kids are there in house number %d, in street number \n%d:\\n\", j+1, i+1);\n        scanf(\"%d\", &amp;streets[i][j]);\n    } \n}\n\n\nfor (i=0;i&lt;10;i++)\n{\n    for (j=0;j&lt;houses_in_street[i];j++)\n    {\n        printf(\"Total number of presents required for street:%d house:%d\\n= \n%d\\n\", i+1, j+1, streets[i][j]);\n\n total_number_of_presents_required=\ntotal_number_of_presents_required+streets[i][j];\n    }\n}\nprintf(\"Total number of presents required in the streets \nis:%d\\n\",total_number_of_presents_required);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9164776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275e21317d31f261b563afd342ba3c53?s=128&d=identicon&r=PG&f=1", "display_name": "Jiren", "link": "https://stackoverflow.com/users/9164776/jiren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515087084, "creation_date": 1514913049, "last_edit_date": 1514913400, "question_id": 48065088, "link": "https://stackoverflow.com/questions/48065088/writing-to-an-array-of-arrays-and-displaying-the-seperate-entities-in-the-array", "title": "Writing to an array of arrays and displaying the seperate entities in the array of arrays in C", "body": "<p>I am writing a code which basically has 10 streets, and in each street the user is asked for the number of houses and the number of kids in each house. But when I try to display the number of streets work, the number of houses work, but the number kids in the houses does not. I would also like to know how to add the number of kids in the street, like a street 1 has 10 kids in total (I don't really know how to do this part). I think the problem is in my for loops, but I am not entirely sure what the problem is. The code is shown below:</p>\n\n<pre><code>int main()\n{\n\nint i=0;\nint j=0;\nint streets[10];\nint houses=0;\nint KidsInStreets[houses];\nfor (i=0;i&lt;10;i++)\n{\n    printf(\"How many houses are there in street %d:\\n\", i+1);\n    scanf(\"%d\",&amp;houses);\n    for (j=0;j&lt;houses;j++)\n    {\n        printf(\"How many kids are there in house number %d, in street number %d:\\n\", j+1, i+1);\n        scanf(\"%d\", &amp;KidsInStreets[j]);\n    }\n}\nfor (i=0;i&lt;10;i++)\n{\n    for (j=0;j&lt;houses;j++)\n    {\n        printf(\"Street:%d House:%d Kids:%d\\n\", i+1, j+1, KidsInStreets[j]);//Kids in street output and houses output have bugs, such as all the houses in the street need to be displayed, and the kids thing is just not working\n    }\n}\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "pointers", "data-structures"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1514914274, "post_id": 48065037, "comment_id": 83103803, "body": "unless your edits fix typos you originally had in your code (why copy and paste is preferred), you should not edit your code to fix it based on what answers have been given. This confuses future readers of this question by changing the context in which the answer was given. If one of the answers fixed your problem, leave your code as-is and accept that answer."}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 8033051, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-xwE_VNJHwqs/AAAAAAAAAAI/AAAAAAAAACo/InOvfJOM11Q/photo.jpg?sz=128", "display_name": "Vikas Gautam", "link": "https://stackoverflow.com/users/8033051/vikas-gautam"}, "edited": false, "score": 0, "creation_date": 1514914476, "post_id": 48065175, "comment_id": 83103887, "body": "thanks @David Hoelzer, i was looking for some problem in my pointers this whole time."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514914907, "post_id": 48065175, "comment_id": 83104047, "body": "Any list of good habits should include not using the <i>expletive filtered</i> globals as the top item."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514918127, "post_id": 48065175, "comment_id": 83105317, "body": "@n.m. I don&#39;t disagree (at all) but I find it&#39;s not great to overwhelm people with too much at once."}], "tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": false, "score": 1, "last_activity_date": 1514913498, "creation_date": 1514913498, "answer_id": 48065175, "question_id": 48065037, "link": "https://stackoverflow.com/questions/48065037/passing-top-pointer-of-stack-as-argument/48065175#48065175", "title": "passing top pointer of stack as argument", "body": "<p>You have a simple error here:</p>\n\n<pre><code>void pop()\n{\n    s *temp = top;\n    top = top-&gt;next;\n    free(top);\n}\n</code></pre>\n\n<p>Rather than freeing Top, you likely meant to <code>free(temp);</code></p>\n\n<p>Additionally, consider developing good habits early.  Don't cast the return of <code>malloc()</code> in C.  Also, don't assume that <code>malloc()</code> worked; check to see if it returns something other than NULL.</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1514915081, "last_edit_date": 1514915081, "creation_date": 1514913885, "answer_id": 48065265, "question_id": 48065037, "link": "https://stackoverflow.com/questions/48065037/passing-top-pointer-of-stack-as-argument/48065265#48065265", "title": "passing top pointer of stack as argument", "body": "<p>So there are 3 problems:-</p>\n\n<ul>\n<li><p>You are freeing <code>top</code> rather than <code>temp</code> in <code>pop()</code>.</p></li>\n<li><p>You are changing to the local variable passed in <code>printStack</code>.</p></li>\n</ul>\n\n<p>Simply call this <code>printSack();</code> having function signature <code>void printStack()</code>.</p>\n\n<ul>\n<li><p>Also when creating the nodes</p>\n\n<pre><code>if(!top)\n{\n   neu=top;\n   ^^^^\n}\n</code></pre></li>\n</ul>\n\n<p>This will be <code>top=neu;</code></p>\n\n<hr>\n\n<h3>Some things that you should learn to do:-</h3>\n\n<ul>\n<li><p>Use debugger. Learn how to use it.</p></li>\n<li><p>Don't cast the return value of <code>malloc</code>.</p></li>\n<li><p>Check the return value of <code>malloc</code> and <code>scanf</code>.</p></li>\n<li><p>You have used too many global variables - <em>code that involves lots of global variables are tend to be difficult to debug</em>. You could easily avoid it here.</p></li>\n</ul>\n\n<p>For example:-</p>\n\n<pre><code>if( scanf(\"%d\",&amp;A[i])!= 1){\n   fprintf(stderr,\"Error in input\");\n   exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>In case of <code>malloc</code></p>\n\n<pre><code>neu = malloc(sizeof(s));\nif(neu == NULL ){\n   perror(\"Malloc failed\");\n   exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<hr>\n\n<p>The main thing is - your code is doing nothing basically. It is even useless to create those methods which are so closely couped with each other with data. We use functions so that code becomes modular and each of the function should be reusable.( Atleast to some extent). Here you have missed that part.</p>\n"}], "owner": {"reputation": 363, "user_id": 8033051, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-xwE_VNJHwqs/AAAAAAAAAAI/AAAAAAAAACo/InOvfJOM11Q/photo.jpg?sz=128", "display_name": "Vikas Gautam", "link": "https://stackoverflow.com/users/8033051/vikas-gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 48065265, "answer_count": 2, "score": 1, "last_activity_date": 1514915264, "creation_date": 1514912824, "last_edit_date": 1514915264, "question_id": 48065037, "link": "https://stackoverflow.com/questions/48065037/passing-top-pointer-of-stack-as-argument", "title": "passing top pointer of stack as argument", "body": "<p>My problem is based on pointers, I want to know how can i pass top of stack in function printStack() so that i can access all nodes of stack.I am storing elements in array and same time pushing into stack.</p>\n\n<p>here in this code when i execute it does not print anything.</p>\n\n<p>here my code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstruct stack\n{\n    int data;\n    struct stack *next;\n};\ntypedef struct stack s;\ns *top=NULL,*neu;\n\n//push data into stack\nvoid push(int data)\n{\n    neu = (s *)malloc(sizeof(s));\n    neu-&gt;data= data;\n    neu-&gt;next = NULL;\n\n   if(!top)\n   {\n       neu=top;\n   }\n   else\n   {\n       neu-&gt;next = top;\n       top = neu;\n   }\n}\n\n//pop data and move top to top-&gt;next\nvoid pop()\n{\n    s *temp = top;\n    top = top-&gt;next;\n    free(top);\n}\n\n//print data present in stack\nvoid printStack(s *top)\n{\n\n   while(top)\n   {\n        printf(\"%d \",top-&gt;data);\n        pop();\n    }\n}\n\nint main()\n{\n    int i=0,A[3],d;\n    for(i=0;i&lt;3;i++)\n    {\n        scanf(\"%d\",&amp;A[i]);\n        push(A[i]);\n    }\n    printStack(top);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1514913066, "post_id": 48065011, "comment_id": 83103309, "body": "Yes, malloc accepts a single argument which is size in bytes (did you mean stdlib&#39;s <code>malloc</code>?)"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1514913073, "post_id": 48065011, "comment_id": 83103316, "body": "Yes - what you have is equivalent as far as allocation is concerned. But there are subtle differences (which may or may not matter to your use-cases). See: <a href=\"https://stackoverflow.com/q/1538420/1275169\">stackoverflow.com/q/1538420/1275169</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514913341, "post_id": 48065011, "comment_id": 83103425, "body": "<code>ARRAYSIZE*sizeof(struct piece)</code> may result in an undetectable overflow.  <code>calloc(ARRAYSIZE, sizeof(struct piece))</code> can detect a too large a product."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514913363, "post_id": 48065011, "comment_id": 83103430, "body": "See also <a href=\"https://stackoverflow.com/questions/8752546/how-does-malloc-understand-alignment\" title=\"how does malloc understand alignment\">stackoverflow.com/questions/8752546/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514913515, "post_id": 48065107, "comment_id": 83103477, "body": "Should <code>x*y</code> exceed <code>SIZE_MAX</code>, <code>malloc(x*y)</code> may be easy to satisfy as the product (after overflow) could be quite small.  Of course the memory then allocated is too small."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1514921608, "post_id": 48065107, "comment_id": 83106799, "body": "@chux: That&#39;s one of the behavioral differences I noted between malloc(x*y) and calloc(x,y).  I&#39;ve long been irked by the fact that the Standard Library tends to group what should be independent aspects of functionality, like whether an allocation should be scaled and whether it should guarantee the memory is cleared, or--as some other unwelcome pairings, whether a function receiving a line of input should strip out a newline and whether to allow the caller to set a maximum length, or whether a function should output a string to the console versus something else and whether to add a newline."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 2, "last_activity_date": 1514913159, "creation_date": 1514913159, "answer_id": 48065107, "question_id": 48065011, "link": "https://stackoverflow.com/questions/48065011/malloc-equivalent-for-calloc/48065107#48065107", "title": "Malloc equivalent for calloc", "body": "<p>The things that make <code>calloc(x,y)</code> different from <code>malloc(x*y)</code> are the facts that (1) the size of the former allocation is the arithmetical product of <code>x</code> and <code>y</code>, even if that value would exceed <code>SIZE_MAX</code> [typically an implementation would return a null pointer for such an allocation request, but if an implementation can somehow satisfy the request, the Standard would allow it to do so]; (2) the storage will be cleared and may be read, without UB, as any type where all-bits-zero is a legitimate value [on most platforms all types would qualify, but the Standard would allow all-bits-zero to be a trap value for pointers or floating point types].</p>\n"}], "owner": {"reputation": 360, "user_id": 4350660, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/823224762/picture?type=large", "display_name": "Benjamin Larsen", "link": "https://stackoverflow.com/users/4350660/benjamin-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "closed_date": 1514913225, "answer_count": 1, "score": 1, "last_activity_date": 1514913159, "creation_date": 1514912704, "question_id": 48065011, "link": "https://stackoverflow.com/questions/48065011/malloc-equivalent-for-calloc", "closed_reason": "Duplicate", "title": "Malloc equivalent for calloc", "body": "<p>It's been a white since I've written for Microcontrollers, and I'm trying to refactor some code to work on such a device, in C.</p>\n\n<p>I have a line of code:</p>\n\n<pre><code>Pieces = calloc(ARRAYSIZE, sizeof(struct piece));\n</code></pre>\n\n<p><a href=\"http://www.cplusplus.com\" rel=\"nofollow noreferrer\">http://www.cplusplus.com</a> states that calloc:</p>\n\n<blockquote>\n  <p>Allocates a block of memory for an array of num elements, each of them size bytes long</p>\n</blockquote>\n\n<p>Would the equivalent malloc operation then be:</p>\n\n<pre><code>Pieces = Malloc(ARRAYSIZE*sizeof(struct piece));\n</code></pre>\n\n<p>Disregarding that the bits haven't been set to 0, isn't that about the same? Or would I have to allocate a block of memory for ARRAYSIZE times?</p>\n\n<p>Hope you can help.</p>\n"}, {"tags": ["c", "linux", "memory", "semaphore", "shared"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1514912779, "post_id": 48064961, "comment_id": 83103198, "body": "I recommend you read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a> Also, <code>sign</code> will typically <i>never</i> be equal to <code>EOF</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1514914258, "post_id": 48064961, "comment_id": 83103796, "body": "I have a guess about the nature of the problem, but it cannot be checked against the code fragments you have posted.  If you want an answer then do edit your question to include a <i>bona fide</i> <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem."}, {"owner": {"reputation": 5, "user_id": 5475523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71a472d944128898b479565663980955?s=128&d=identicon&r=PG&f=1", "display_name": "Zar", "link": "https://stackoverflow.com/users/5475523/zar"}, "edited": false, "score": 0, "creation_date": 1514915737, "post_id": 48064961, "comment_id": 83104386, "body": "Edited: minimal code and the problem is still the same"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514962588, "post_id": 48064961, "comment_id": 83118734, "body": "Please indent the code.  The wall-to-wall unindented code is horrible to look at, and you need to make your code inviting to people so that they&#39;ll help you. Also, the logic in <code>end()</code> that is ` if(EXIT_FAILURE == 0) exit(0);  exit(EXIT_FAILURE);` is weird; if <code>EXIT_FAILURE</code> is zero, you&#39;ll exit with the value of <code>EXIT_FAILURE</code>, otherwise you&#39;ll exit with the value of <code>EXIT_FAILURE</code>.  Either you had in mind something like <code>errno</code> in the condition, or you should simply have <code>exit(EXIT_FAILURE);</code>.  Note that testing <code>errno</code> here is not entirely reliable."}], "owner": {"reputation": 5, "user_id": 5475523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71a472d944128898b479565663980955?s=128&d=identicon&r=PG&f=1", "display_name": "Zar", "link": "https://stackoverflow.com/users/5475523/zar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514915519, "creation_date": 1514912459, "last_edit_date": 1514915519, "question_id": 48064961, "link": "https://stackoverflow.com/questions/48064961/semop-stopped-working-c-linux", "title": "semop stopped working, c, linux", "body": "<p>I have a project called \"a consumer and a producer\". I need to use semaphores and shared memory to read signs (one by one) from the file and put them to shared memory (in producer.c) and after read them and put in output file (in consumer.c). Files should be the same after the end of the programs. </p>\n\n<p>Libraries and global variables (both files the same):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nkey_t keySem;\nkey_t keySeg;\nint segment;\nchar *address;\nint semaphore;\nint x;\npid_t w;\n</code></pre>\n\n<p>So I have in producers.c:</p>\n\n<pre><code>int main() {\nsrand(time(0));\nif((keySeg = ftok(\".\", 'X')) == -1) end(\"error - creating a key!\\n\");\nif((segment = shmget(keySeg, sizeof(char), 0777 | IPC_CREAT )) == -1) \n  end(\"error - creating a shared memory!\\n\");\naddress = shmat(segment,0,0);\nif(*address == -1) end(\"error - getting an address\\n\");\nif((keySem = ftok(\".\", 'Y')) == -1) end(\"error - creating a key\\n\");\nif((semaphore = semget(keySem, 2, 0600 | IPC_CREAT )) == -1) \n  end(\"error - creating a semaphore!\\n\");\nif((semctl(semaphore, 0, SETVAL, 1)) == -1) end(\"cant set a semaphore\\n\");\nif((semctl(semaphore, 1, SETVAL, 0)) == -1) end(\"cant set a semaphore\\n\");\n\nchar sign;\nFILE *file;\nfile = fopen(\"in\", \"r\");\nif(file == NULL) end(\"error - opening in file\\n\");\n\nwhile(fscanf(file, \"%c\", &amp;sign) != EOF){\n    semaphore_p(0);\n    *address = sign;\n    semaphore_v(1);\n}\n\nsemaphore_p(0);\n*address = EOF;\nsemaphore_v(1);\n\nfclose(file);\nshmdt(address);\nexit(0);\n}\n</code></pre>\n\n<p>and in consumer.c:</p>\n\n<pre><code>int main() {\nif((keySeg = ftok(\".\", 'X')) == -1) end(\"Error - creating a key!\\n\");\nif((segment = shmget(keySeg, 0, 0600 | IPC_CREAT)) == -1) \n  end(\"Error - get access to shared memory!\\n\");\naddress = shmat(segment,0,0);\nif(*address == -1) end(\"Error - address!\\n\");\nif((keySem = ftok(\".\", 'Y')) == -1) end(\"Error - semaphore key!\\n\");\nif((semaphore = semget(keySem, 2, 0600 | IPC_CREAT)) == -1) \n  end(\"Error - get access to semaphores!\\n\");\nif((semctl(semaphore, 0, SETVAL, 1)) == -1) end(\"cant set a semaphore\\n\");\nif((semctl(semaphore, 1, SETVAL, 0)) == -1) end(\"cant set a semaphore\\n\");\n\nchar sign;\nFILE *file;\nfile = fopen(\"out\", \"w\");\nif(file == NULL) end(\"error - opening out file\\n\");\nwhile(sign != EOF) {\n  semaphore_p(1);\n  sign = *address;\n  fputc(sign, file);\n  printf(\"[CONSUMER] Sign: %c\\n\", sign);\n  semaphore_v(0);\n}\nfclose(file);\nshmdt(address);\nshmctl(segment, IPC_RMID, 0);\nif((semctl(semaphore, 0, IPC_RMID)) == -1) \n  end(\"error - deleting semaphore\\n\");\nexit(0);\n}\n</code></pre>\n\n<p>And it's all working for the small files (below 500 chars), but if I put more chars in a file, a project stops after semaphore_v(0) (after reading a few hundred characters). Here is the result:\n<a href=\"https://i.stack.imgur.com/TISD3.png\" rel=\"nofollow noreferrer\">Result</a></p>\n\n<p>Here is how semaphore_p and semaphore_v functions look like.</p>\n\n<pre><code>static void semaphore_p(int x) {\nstruct sembuf bufor_sem;\nbufor_sem.sem_num=x;\nbufor_sem.sem_op=-1;\nbufor_sem.sem_flg=0;\nwhile((semop(semaphore, &amp;bufor_sem, 1)) == -1) {\n  if (errno == ERANGE) {\n    int a = semctl(semaphore, x, GETVAL);\n    semctl(semaphore, x, SETVAL, a);\n  } else if(errno == 4) {\n    //semaphore_p(x);\n  } else {\n    end(\"ERROR!\\n\");\n  }\n}\nprintf(\"[CONSUMER] Semaphore %d has been closed.\\n\", x);\n}\n\nstatic void semaphore_v(int x) {\nstruct sembuf bufor_sem;\nbufor_sem.sem_num=x;\nbufor_sem.sem_op=1;\nbufor_sem.sem_flg=0;\nwhile((semop(semaphore, &amp;bufor_sem, 1)) == -1) {\n  if (errno == ERANGE) {\n    int a = semctl(semaphore, x, GETVAL);\n    semctl(semaphore, x, SETVAL, a);\n  } else if(errno == 4) {\n    //semaphore_p(x);\n  } else {\n    end(\"ERROR!\\n\");\n  }\n}\nprintf(\"[CONSUMER] Semafor %d has been opened.\\n\", x);\n}\n</code></pre>\n\n<p>And end function </p>\n\n<pre><code>void end(char text[]) {\n perror(text);\n if(EXIT_FAILURE == 0) exit(0);\n exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>I've read something about ERANGE errno, but the program doesn't throw any errors.\nWhat is the reason for the pause? Do semaphore have some kind of vitality? How can I ignore it?</p>\n\n<p>Thank you in advance for your help :)</p>\n"}, {"tags": ["c", "linux", "unix", "signals", "setitimer"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514913879, "post_id": 48064940, "comment_id": 83103625, "body": "It probably isn&#39;t the cause of your trouble, but see <a href=\"https://stackoverflow.com/questions/16891019/\">How to avoid using <code>printf()</code> in a signal handler</a> for information on which functions you&#39;re allowed to call in a signal handler.  Note that <code>printf()</code> is not one of those functions, officially (and neither is <code>strlen()</code> \u2013 and while I can explain <code>printf()</code>, I find <code>strlen()</code> much harder to explain)."}, {"owner": {"reputation": 197, "user_id": 8727379, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-1CIQH1Odgd4/AAAAAAAAAAI/AAAAAAAAADs/rsewUiShkr0/photo.jpg?sz=128", "display_name": "Zeno Raiser", "link": "https://stackoverflow.com/users/8727379/zeno-raiser"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514914008, "post_id": 48064940, "comment_id": 83103693, "body": "thanks man i totally forgot about that!!"}], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 9082567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b73499f293b4a840913620cd8b711b?s=128&d=identicon&r=PG&f=1", "display_name": "Fat-Zer", "link": "https://stackoverflow.com/users/9082567/fat-zer"}, "is_accepted": true, "score": 2, "last_activity_date": 1514913929, "last_edit_date": 1514913929, "creation_date": 1514913881, "answer_id": 48065264, "question_id": 48064940, "link": "https://stackoverflow.com/questions/48064940/understanding-struct-itimerval-field-tv-usec/48065264#48065264", "title": "Understanding struct itimerval field tv_usec", "body": "<p>As far as you don't initialize <code>*.tv_usec</code> fields, theirs values are <strong>undefined</strong>. If it'd contain a value greater that <code>999999</code> or less than <code>0</code>, the <code>setitimer ()</code>  will just fail with <code>EINVAL</code> as described on the man page.</p>\n\n<p>You ought to initialize all the data yourself. If you are willing to save a line of code, you may <code>memset</code> the <code>timer</code> struct to <code>0</code> the same way you have done it for <code>sa</code>.</p>\n"}], "owner": {"reputation": 197, "user_id": 8727379, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-1CIQH1Odgd4/AAAAAAAAAAI/AAAAAAAAADs/rsewUiShkr0/photo.jpg?sz=128", "display_name": "Zeno Raiser", "link": "https://stackoverflow.com/users/8727379/zeno-raiser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2125, "favorite_count": 1, "accepted_answer_id": 48065264, "answer_count": 1, "score": 2, "last_activity_date": 1514913929, "creation_date": 1514912405, "question_id": 48064940, "link": "https://stackoverflow.com/questions/48064940/understanding-struct-itimerval-field-tv-usec", "title": "Understanding struct itimerval field tv_usec", "body": "<p>Hi I'm studying this code:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n\nvolatile sig_atomic_t print_flag = true;\nstatic int count = 0;\n\nvoid timer_handler (int signum)\n{\n\n printf (\"timer expired %d times\\n\", ++count);\n if(count&gt;20) {\n    print_flag = false;\n } \n}\n\nint main ()\n{\n struct sigaction sa;\n struct itimerval timer;\n\n /* Install timer_handler as the signal handler for SIGVTALRM. */\n memset (&amp;sa, 0, sizeof (sa));\n sa.sa_handler = &amp;timer_handler;\n sigaction (SIGALRM, &amp;sa, NULL);\n\n /* Configure the timer to expire after 250 msec... */\n timer.it_value.tv_sec = 0;\n timer.it_value.tv_usec = 250000;\n /* ... and every 250 msec after that. */\n timer.it_interval.tv_sec = 0;\n timer.it_interval.tv_usec = 250000;\n /* Start a virtual timer. It counts down whenever this process is\n   executing. */\n setitimer (ITIMER_REAL, &amp;timer, NULL);\n\n /* Do busy work. */\n while (print_flag) {\n    sleep(1);\n }\n\nprintf(\"job done bye bye\\n\");\n    exit(0);\n\n}\n</code></pre>\n\n<p>With this settings everything goes fine and i get this output</p>\n\n<pre><code>...\ntimer expired 17 times\ntimer expired 18 times\ntimer expired 19 times\ntimer expired 20 times\ntimer expired 21 times\njob done bye bye\n</code></pre>\n\n<p>If i try to alter the code commenting <code>timer.it_interval.tv_usec</code> and      <code>timer.it_interval.tv_usec</code>and setting both  <code>timer.it_value.tv_sec</code> and <code>timer.it_value.tv_sec</code> equal to, for instance, 3 it doesn't do his job.</p>\n\n<p>However if I maintain an explicit declaration of <code>tv_usec</code> like this it works:</p>\n\n<pre><code> timer.it_value.tv_sec = 3;\n timer.it_value.tv_usec = 0;\n timer.it_interval.tv_sec = 3;\n timer.it_interval.tv_usec = 0;\n</code></pre>\n\n<p>Why I'm bonded on the explicit declaration of <code>tv_usec</code> for both fields?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 2, "creation_date": 1514913066, "post_id": 48064923, "comment_id": 83103310, "body": "@FredLarson: at least it&#39;s the first time this is asked <i>in 2018</i>!"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 2, "creation_date": 1514913089, "post_id": 48064923, "comment_id": 83103325, "body": "@FredLarson Yes, it turns out that a lot of people don\u2019t know everything, and there are some things that a lot of people don\u2019t know because they\u2019re confusing and/or poorly taught. Googling doesn\u2019t help because different programming languages treat these concepts differently and even adding \u201cc\u201d to the search doesn\u2019t limit the results to C."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 3, "creation_date": 1514913163, "post_id": 48064923, "comment_id": 83103354, "body": "@DanielH: true. We need to tell this to every single person, again and again."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1514922748, "post_id": 48064923, "comment_id": 83107242, "body": "@DanielH this is not a bad question because the code is bad, (which it is), or because the OP has not done a diligent amount research, (which they have not), or because it&#39;s been asked on SO [FP overflow] times already, (which it has).  It&#39;s bad because it&#39;s pointless.  It&#39;s pointless because the confusing code in it is easily replaced with code that is clear and understandable.   That&#39;s why it&#39;s bad."}], "answers": [{"comments": [{"owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1514916350, "post_id": 48065051, "comment_id": 83104614, "body": "What is the right sentence then, I should say that they are both executed between the same 2 sequence points and thus the order is not defined? Or should I say in the same expression or statement?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1514916856, "post_id": 48065051, "comment_id": 83104780, "body": "C has already switched to a new sequencing model based of <i>sequenced before</i> and <i>sequenced after</i> relations (similar to the one used in C++). So, pedantically speaking, it is not correct to describe the situation in therms of <i>sequence points</i>. The concept still exists in C (<i>sequence point</i> is basically a combination of <i>sequenced before</i> and <i>sequenced after</i> concentrated in a specific point), but it is no longer sufficiently accurate."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1514918975, "post_id": 48065051, "comment_id": 83105693, "body": "@AnT: Can you pack it into simple sentences that newbies understand and get it into an answer that will be voted up? Stack Overflow is not good at this. The new model may have more descriptive power and precision, but how do you teach it to people who are still learning elementary issues like this? And, if you can teach it, how do you get an answer accepted when you come along after somebody has already entered a simplistic answer that is voted up? On top of that, we will have to prevent people from marking post-2011 (C standard) questions as duplicates of pre-2011 questions."}, {"owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "edited": false, "score": 0, "creation_date": 1514919150, "post_id": 48065051, "comment_id": 83105775, "body": "You can expand my answer if you want since I don&#39;t have the knowledge of the new model."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1514941626, "post_id": 48065051, "comment_id": 83113617, "body": "@mdatsev: I rewrote it to comply with the current standard, I think, while still trying to keep the concepts suitable for a student. If you wish, you can revert my edit to the previous version."}], "tags": [], "owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1514941563, "last_edit_date": 1514941563, "creation_date": 1514912853, "answer_id": 48065051, "question_id": 48064923, "link": "https://stackoverflow.com/questions/48064923/why-does-the-following-code-yield-o-p-as-3-and-not-6/48065051#48065051", "title": "Why does the following code yield O/P as 3 and not 6?", "body": "<p>In <code>x = x++</code>, you are saying both to increment <code>x</code> and to assign <code>x</code> a value. The C standard does not define what happens if you do both of these things \u201cat the same time.\u201d For this purpose, \u201cat the same time\u201d means your code has not arranged for one of them to occur before the other.</p>\n\n<p>If you put the increment and the assignment in separate statements, the C standard says that one of them occurs before the other, and then the behavior is fully defined. Technically, there is a <em>sequence point</em> between two such statements. Sequence points are barriers that separate effects. Inside the single statement <code>x = x++</code>, there is no sequence point.</p>\n\n<p>(There is more about sequence points and sequencing in C, but the details are beyond the scope of this question.)</p>\n\n<p>In the simplest C implementation, the compiler might treat <code>x = x++;</code> as if it were <code>x = x; x++;</code> or as if it where <code>int Temporary = x; x++; x = Temporary;</code>. The first would set <code>x</code> to 3 and then to 4. The second would set <code>x</code> to 4 and then to 3. However, the C standard gives implementations a great deal of latitude. In some C implementations, integer types might be made up of parts\u2014a small computer might not be able to handle 32-bit integers all at once, so it might have to do arithmetic in multiple 16-bit steps, or even multiple 8-bit steps. The C standard says, since you have not arranged for the assignment and the increment to occur in a particular order, then, not only is the implementation allowed to do them in either order, it is even allowed to mix the steps. It might do one byte of the assignment, one byte of the increment, the second byte of the assignment, the second byte of the increment, the third byte of the increment, the third byte of the assignment, and so on. In general, you could get a nonsensical answer that is a mishmash of operations on the parts.</p>\n\n<p>So the C standard does not say that, if you do not arrange for the operations to be ordered, then either one happens before the other. It says, if you do not arrange for the operations to be ordered, we <strong>do not guarantee what will happen at all</strong>. You may get a big mess.</p>\n"}], "owner": {"reputation": 9, "user_id": 9159958, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sn1qJMa081I/AAAAAAAAAAI/AAAAAAAAAJU/7mPb0x8eJV8/photo.jpg?sz=128", "display_name": "Tanmay Holay", "link": "https://stackoverflow.com/users/9159958/tanmay-holay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "closed_date": 1514913115, "answer_count": 1, "score": -4, "last_activity_date": 1514941563, "creation_date": 1514912341, "last_edit_date": 1514913599, "question_id": 48064923, "link": "https://stackoverflow.com/questions/48064923/why-does-the-following-code-yield-o-p-as-3-and-not-6", "closed_reason": "Duplicate", "title": "Why does the following code yield O/P as 3 and not 6?", "body": "<p>Why doesn't the value of <code>x</code> increment in the following code? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n   int x = 3, i = 0;\n   do {\n       x = x++;\n       i++;\n   } while (i != 3);\n\n   printf(\"%d\\n\", x);\n}\n</code></pre>\n"}, {"tags": ["c", "python-2.7", "winapi", "callback"], "comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514915692, "post_id": 48064756, "comment_id": 83104364, "body": "Generally it&#39;s simpler and cleaner if your callback is a bound method or closure."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514915753, "post_id": 48064756, "comment_id": 83104391, "body": "As to a difference here between Linux and Windows, there shouldn&#39;t be one. The error implies <code>msg.user_data</code> is <code>NULL</code> in your Windows version, which implies a problem in your C code, not Python."}, {"owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514925493, "post_id": 48064756, "comment_id": 83108478, "body": "Well, that&#39;s a bummer; I&#39;m logging the pointer value in C when it&#39;s initially set and then again right before invoking the callback verifying they are identical at these points. Was hoping it was just a problem with my casts."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514940368, "post_id": 48064756, "comment_id": 83113323, "body": "Do you keep a reference to <code>c_user_data</code>? If not the ctypes pointer gets deallocated, and the <code>PyObject **</code> address would become a random address on the heap rather than referencing your object. IIRC, this entire approach also leads to reference leaks. I can&#39;t recommend enough that you abandon using this <code>void *</code> parameter. It really is pointless and problematic. Bound methods and closures are a much saner option for Python code."}, {"owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514999143, "post_id": 48064756, "comment_id": 83138147, "body": "Thanks, just noticed the additional tip; I hadn&#39;t been doing that so I&#39;ve added it, but doesn&#39;t seem to make any difference."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1515000174, "post_id": 48064756, "comment_id": 83138714, "body": "Please update your question with a simplified, complete problem that recreates the issue. Include C functions to set and call the callback."}], "owner": {"reputation": 137, "user_id": 5058093, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e80c9396e250c345163ee73e200d1c8d?s=128&d=identicon&r=PG&f=1", "display_name": "kov", "link": "https://stackoverflow.com/users/5058093/kov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514911607, "creation_date": 1514911607, "question_id": 48064756, "link": "https://stackoverflow.com/questions/48064756/passing-python-instance-as-opaque-ptr-across-ctypes-c-boundary-succeeds-in-linux", "title": "Passing Python instance as opaque ptr across ctypes C-boundary succeeds in Linux but fails in Win32", "body": "<p>I have a Python2.7 ctypes C-lib wrapper with callback functions called from the C-layer back into Python. This works successfully under Linux but is not entirely working in Windows. My wrapper is a Python class that passes itself into the C functions as the <code>void*</code> opaque user-data that C-callbacks commonly use to pass back the user's class or closure for event-handling. The callback gets invoked, but casting the parameter from that callback back into a Python instance is what fails. I get \"ValueError: NULL pointer access\". </p>\n\n<p>The code that works in Linux is as follows:</p>\n\n<p>When calling the ctypes-wrapped C initialization function from my Python wrapper, I cast <code>self</code> instance to a <code>c_void_p</code> before passing it in as the C <code>user_data</code>. This is stored for future use in the callback and that part at least I can verify has the same value at init time and callback time.</p>\n\n<pre><code>c_user_data = ctypes.cast(pointer(ctypes.py_object(self)), c_void_p)\ndll_.my_init( on_msg_cb, c_user_data )\n</code></pre>\n\n<p>I map a ctypes message-type structure to it's C-struct counterpart and a callback function the C code uses to pass constructed messages back to my Python code:</p>\n\n<pre><code>class msg_evt_type (Structure):\n    _fields_ = [\n        # ... other field definitions ..\n        ('user_data',       c_void_p)\n    ]\n\nmsg_cb_type = CFUNCTYPE(c_void_p, POINTER(msg_evt_type))\n\n@msg_cb_type\ndef on_msg_cb(msg_p):\n    msg = msg_p[0] # dereference the pointer\n    # ...\n</code></pre>\n\n<p>And then within that Python callback invoked by C, I cast the user_data back to my python instance:</p>\n\n<pre><code>    # This fails with 'ValueError: NULL pointer access'\n    myinst = ctypes.cast(msg.user_data, POINTER(ctypes.py_object)).contents.value\n</code></pre>\n\n<p>Any ideas what needs to be done differently for this to work for Win32?</p>\n"}, {"tags": ["c", "string", "format", "special-characters"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1514911550, "post_id": 48064689, "comment_id": 83102581, "body": "Post the code that set <code>home_team_name</code> to <code>&quot;Atl&#233;tico Mineiro&quot;</code>."}, {"owner": {"reputation": 584, "user_id": 7197120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8126abe9e07772cf2b1bce8a7084e3?s=128&d=identicon&r=PG", "display_name": "chriptus13", "link": "https://stackoverflow.com/users/7197120/chriptus13"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1514911637, "post_id": 48064689, "comment_id": 83102625, "body": "I&#39;m using Curl to get that from an url (<a href=\"http://api.football-data.org/v1/competitions/444/teams\" rel=\"nofollow noreferrer\">api.football-data.org/v1/competitions/444/teams</a>) and then using jsonlib to convert that into the string."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1514911663, "post_id": 48064689, "comment_id": 83102640, "body": "Is the <code>home_team_name</code> encoded in UTF-8? Remember that UTF-8 is a variable-length encoding scheme, and that some characters may use two or more bytes. These are probably counted by the (generally) UTF-8 unaware <code>printf</code> function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1514911692, "post_id": 48064689, "comment_id": 83102652, "body": "&quot;even though i specified the max length.&quot; is not coded here.  The 25 in <code>&quot;%-25s&quot;</code> is the <i>minimum</i> width."}, {"owner": {"reputation": 584, "user_id": 7197120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8126abe9e07772cf2b1bce8a7084e3?s=128&d=identicon&r=PG", "display_name": "chriptus13", "link": "https://stackoverflow.com/users/7197120/chriptus13"}, "edited": false, "score": 2, "creation_date": 1514911699, "post_id": 48064689, "comment_id": 83102654, "body": "Yes it is in UTF-8"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514911805, "post_id": 48064689, "comment_id": 83102708, "body": "C and UTF still has a way to go.  I suspect the solution may include  <code>wprintf()</code>"}, {"owner": {"reputation": 584, "user_id": 7197120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8126abe9e07772cf2b1bce8a7084e3?s=128&d=identicon&r=PG", "display_name": "chriptus13", "link": "https://stackoverflow.com/users/7197120/chriptus13"}, "edited": false, "score": 2, "creation_date": 1514911849, "post_id": 48064689, "comment_id": 83102728, "body": "The special characters count as 2 therefore it adds 1 less space so it looks strange in the output. I guess thats it?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1514912043, "post_id": 48064689, "comment_id": 83102818, "body": "Well, <code>printf</code> counts bytes, but your console interprets the characters as UTF-8, which encodes codepoints with variable lengths, so the two disagree on what the length of the string is."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1514912526, "post_id": 48064689, "comment_id": 83103073, "body": "@chriptus13 The link is not a sufficient substitute for showing how your code assigns <code>home_team_name</code>.  Posting code that compiles and replicates the problem will net better answers."}, {"owner": {"reputation": 584, "user_id": 7197120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8126abe9e07772cf2b1bce8a7084e3?s=128&d=identicon&r=PG", "display_name": "chriptus13", "link": "https://stackoverflow.com/users/7197120/chriptus13"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1514912593, "post_id": 48064689, "comment_id": 83103106, "body": "@chux i&#39;ve tried and it doesn&#39;t work."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1514912701, "post_id": 48064689, "comment_id": 83103158, "body": "@chriptus13 &quot;i&#39;ve tried&quot; is unclear as to what you have tried.  &quot;it doesn&#39;t work&quot; is not clear on what or how something does not work.  Post your compilable code and inputs used."}], "answers": [{"comments": [{"owner": {"reputation": 584, "user_id": 7197120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8126abe9e07772cf2b1bce8a7084e3?s=128&d=identicon&r=PG", "display_name": "chriptus13", "link": "https://stackoverflow.com/users/7197120/chriptus13"}, "edited": false, "score": 2, "creation_date": 1514912757, "post_id": 48064972, "comment_id": 83103183, "body": "Ya i&#39;ve thought about that but didn&#39;t want to make this with a big thing so just trying to figure out if there&#39;s a way of avoiding that!"}, {"owner": {"reputation": 617, "user_id": 1286717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DQrBG.jpg?s=128&g=1", "display_name": "Alexander Amelkin", "link": "https://stackoverflow.com/users/1286717/alexander-amelkin"}, "edited": false, "score": 0, "creation_date": 1588978794, "post_id": 48064972, "comment_id": 109118992, "body": "I came up with an almost identical solution. This however doesn&#39;t work for asian characters that can be multiple cursor positions wide. <code>mbstowcs()</code> counts each Kanji character for 1 while in fact it is very often 2 for alignment purposes. Any solution to that?"}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": false, "score": 3, "last_activity_date": 1514964750, "last_edit_date": 1514964750, "creation_date": 1514912540, "answer_id": 48064972, "question_id": 48064689, "link": "https://stackoverflow.com/questions/48064689/c-formatting-string-size-with-special-characters/48064972#48064972", "title": "C - Formatting String size with special characters", "body": "<p>The format string in <code>printf</code> does not take multibyte characters into account.</p>\n\n<p>A possible solution is to count <em>wide characters</em> of a string by <a href=\"http://en.cppreference.com/w/cpp/string/multibyte/mbstowcs\" rel=\"nofollow noreferrer\"><code>mbstowcs</code></a> function. The obtained count is then subtracted from the length (i.e. in bytes) of the examined string. This yields a (nonnegative) \"compensation value\", that may be added to <code>printf</code>'s format field width.</p>\n\n<p>The <code>mbstowcs</code> function is described as:</p>\n\n<blockquote>\n  <p>Converts a multibyte character string from the array whose first\n  element is pointed to by <code>src</code> to its wide character representation.\n  Converted characters are stored in the successive elements of the\n  array pointed to by <code>dst</code>. No more than <code>len</code> wide characters are written\n  to the destination array.</p>\n</blockquote>\n\n<p>In your case, this means that UTF-8 encoded octets (represented within array of <code>char</code>) are converted into <em>some</em> wide representation, that guarantees that any multibyte character (up to locale-specific <a href=\"http://en.cppreference.com/w/cpp/header/cstdlib\" rel=\"nofollow noreferrer\"><code>MB_CUR_MAX</code></a> bytes) can be encoded by no more than one <code>wchar_t</code> object.</p>\n\n<p>The relevant quote from C11 Standard is contained in 7.19/2 <em>Common definitions <code>&lt;stddef.h&gt;</code></em>:</p>\n\n<blockquote>\n  <p><code>wchar_t</code></p>\n  \n  <p>which is an integer type whose range of values can represent distinct\n  codes for all members of the largest extended character set specified\n  among the supported locales;</p>\n</blockquote>\n\n<p>For instance, on Linux platform, wide characters are most likely to be represented in <a href=\"https://en.wikipedia.org/wiki/UTF-32\" rel=\"nofollow noreferrer\">UCS-4</a> (known as UTF-32).</p>\n\n<p>Here is a proof of concept:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;locale.h&gt;\n\nstatic inline size_t widestrlen(const char *str)\n{\n    return mbstowcs(NULL, str, strlen(str));\n}\n\nstatic inline size_t compensation(const char *str)\n{\n    return strlen(str) - widestrlen(str);\n}\n\nint main(void)\n{\n    setlocale(LC_CTYPE, \"\");\n\n    // Print some debugging information regarding selected locale\n    printf(\"Current locale for LC_TYPE category: %s\\n\", setlocale(LC_CTYPE, NULL));\n    printf(\"Maximum number of bytes in a multibyte character: %zu\\n\", MB_CUR_MAX);\n    printf(\"Does current encoding support shift states? : %s\\n\\n\", mblen(NULL, 0) ? \"Yes\" : \"No\");\n\n    int goals_home_teams[] = { 4, 0 };\n    int goals_away_teams[] = { 3, 0 };\n    const char *home_team_names[] = { \"Atl\u00e9tico Mineiro\", \"West Ham United FC\" };\n    const char *away_team_names[] = { \"Gr\u00e9mio\", \"Everton FC\" };\n\n    for (int i = 0; i &lt; 2; i++)\n    {\n        printf(\"=&gt; %-*s (%d) vs (%d) \\t%-*s\\n\",\n            25 + (int) compensation(home_team_names[i]),\n            home_team_names[i], goals_home_teams[i], goals_away_teams[i],\n            25 + (int) compensation(away_team_names[i]),\n            away_team_names[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Current locale for LC_TYPE category: en_US.UTF-8\nMaximum number of bytes in a multibyte character: 6\nDoes current encoding support shift states? : No\n\n=&gt; Atl\u00e9tico Mineiro          (4) vs (3)     Gr\u00e9mio                   \n=&gt; West Ham United FC        (0) vs (0)     Everton FC  \n</code></pre>\n"}], "owner": {"reputation": 584, "user_id": 7197120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8126abe9e07772cf2b1bce8a7084e3?s=128&d=identicon&r=PG", "display_name": "chriptus13", "link": "https://stackoverflow.com/users/7197120/chriptus13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1514964750, "creation_date": 1514911290, "last_edit_date": 1514912640, "question_id": 48064689, "link": "https://stackoverflow.com/questions/48064689/c-formatting-string-size-with-special-characters", "title": "C - Formatting String size with special characters", "body": "<p>So, I was trying to print fixtures from a competition with strings well formatted but i found out that whenever there is a special character like <strong>'\u00e9'</strong> or <strong>'\u00ed'</strong> or <strong>'\u00e1'</strong> it would print +1 size even though i specified the max length.</p>\n\n<p>Where is the code:</p>\n\n<pre><code>printf(\"=&gt; %-25s (%d) vs (%d) \\t%-25s\\n\", f-&gt;home_team_name, f-&gt;goals_home_team, f-&gt;goals_away_team, f-&gt;away_team_name);\n</code></pre>\n\n<p>For teams with those characters the output is like:</p>\n\n<pre><code>=&gt; Palmeiras               (2) vs (0)   Botafogo               \n=&gt; Atl\u00e9tico Mineiro       (4) vs (3)    Gr\u00e9mio                \n=&gt; Atl\u00e9tico PR            (3) vs (0)    Palmeiras              \n=&gt; Botafogo                (2) vs (2)   Cruzeiro   \n</code></pre>\n\n<p>But i want the output to look like, even with special characters:</p>\n\n<pre><code>=&gt; Tottenham Hotspur FC    (0) vs (0)   Leicester City FC      \n=&gt; West Ham United FC      (0) vs (0)   Everton FC             \n=&gt; Burnley FC              (0) vs (0)   AFC Bournemouth   \n</code></pre>\n\n<p>I've tried to look for formatting flags but can't find the solution.</p>\n"}, {"tags": ["python", "c", "swig", "cudd"], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1514916846, "post_id": 48065723, "comment_id": 83104778, "body": "Explanation? This seems like a fix for when stdout is a fake file handle or not connected to a console, but I&#39;m not sure why this would fix the OP&#39;s problem without some explanation. Does PyCUDD or SWIG do something that would cause this problem?"}, {"owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1514917635, "post_id": 48065723, "comment_id": 83105095, "body": "I updated my answer for explanation. Thank you for advice."}], "tags": [], "owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "is_accepted": false, "score": 0, "last_activity_date": 1514917522, "last_edit_date": 1514917522, "creation_date": 1514916391, "answer_id": 48065723, "question_id": 48064686, "link": "https://stackoverflow.com/questions/48064686/make-printf-appear-in-stdout-from-shared-object-library/48065723#48065723", "title": "Make printf appear in stdout from shared object library", "body": "<p>I think problem is that Launched program closes (or redirects original stdout handler/descriptor to somewhere) stdout, so Library cannot gets Handler/descriptor. So I tried to recover devices and reopen.</p>\n\n<p>In linux, console device is located at /dev/stdout (it is symbolic link to specific devices or file located in fd 1 at launched time), so reopen this file and recover file descriptor.</p>\n\n<pre><code>int fd = open(\"/dev/stdout\", O_RDONLY);\nif(fd != -1)\n    dup2(fd,1);\n</code></pre>\n\n<p>In Windows, AllocConsole tries to create new Console if current process does not have console. This is for the case when PyCUDD(Or any program) uses custom console. And freopen makes writable to our allocated console, so printf will work for new console.</p>\n\n<pre><code>AllocConsole();\nfreopen(\"CONOUT$\", \"w\", stdout);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3273, "user_id": 3240038, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b669895a57b0240047828a42c619a3e1?s=128&d=identicon&r=PG", "display_name": "Suhaib Janjua", "link": "https://stackoverflow.com/users/3240038/suhaib-janjua"}, "edited": false, "score": 1, "creation_date": 1518033362, "post_id": 48671922, "comment_id": 84342625, "body": "Please use comment section for your valuable feedback related to the question and use answer section to provide detailed solutions for the asked question. Thanks"}], "tags": [], "owner": {"reputation": 3, "user_id": 8290691, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209735166198834/picture?type=large", "display_name": "Corey Fisher", "link": "https://stackoverflow.com/users/8290691/corey-fisher"}, "is_accepted": false, "score": 0, "last_activity_date": 1518032233, "creation_date": 1518032233, "answer_id": 48671922, "question_id": 48064686, "link": "https://stackoverflow.com/questions/48064686/make-printf-appear-in-stdout-from-shared-object-library/48671922#48671922", "title": "Make printf appear in stdout from shared object library", "body": "<p>I still forget what my problem was before. However, I have found that what was causing my problem here was a linker issue - the linker was looking at an old version of the library, which did not have my changes.</p>\n"}], "owner": {"reputation": 3, "user_id": 8290691, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209735166198834/picture?type=large", "display_name": "Corey Fisher", "link": "https://stackoverflow.com/users/8290691/corey-fisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518032233, "creation_date": 1514911275, "question_id": 48064686, "link": "https://stackoverflow.com/questions/48064686/make-printf-appear-in-stdout-from-shared-object-library", "title": "Make printf appear in stdout from shared object library", "body": "<p>I am currently using PyCUDD, which is a SWIG-generated Python wrapper for the C package CUDD. I'm currently trying to get CUDD to print some debug information from inside the C code, but any printfs inside the C code don't seem to be producing any output - putting them in the .i files for SWIG produces output, putting them in the C code does not. I'm not sure if this is some property of SWIG specifically or of compiling the C code to a shared object library.</p>\n\n<p>(Particularly frustrating is that I know that I have had this problem and gotten it working before, but I can't seem to find anything searching for the problem now, and I apparently forgot to leave notes on that one thing.)</p>\n"}, {"tags": ["c", "stack", "buffer-overflow"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1514910573, "post_id": 48064430, "comment_id": 83102023, "body": "How variables&#39; storage is arranged is implementation-specific.  There doesn&#39;t even need to <i>be</i> a stack.  Moreover, any kind of object overrun invokes undefined behavior as far as C is concerned, so C provides no answer for you about what happens in such a case.  You need to study the characteristics of the particular C implementation you&#39;re working with.  And the relevant characteristics are not necessarily documented."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1514910624, "post_id": 48064430, "comment_id": 83102051, "body": "Sometimes poor programming can allow negative indices to be generated, which can allow memory before a buffer to be accessed."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1514911517, "post_id": 48064430, "comment_id": 83102563, "body": "There are no guarantees on how separate objects are ordered in memory, and you should not expect any ordering to be meaningful.  Some objects may be optimized out of existence altogether.  Buffer overflows will clobber <i>something</i>, but what that something is depends on the specific implementation, code, optimization settings, etc."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 2, "last_activity_date": 1514910999, "creation_date": 1514910999, "answer_id": 48064612, "question_id": 48064430, "link": "https://stackoverflow.com/questions/48064430/overwriting-local-variables-located-located-below-the-buffer-using-buffer-overfl/48064612#48064612", "title": "Overwriting local variables located located below the buffer using buffer overflow", "body": "<p>You get no guarantees about the location of the variables on the stack. The compiler may rearrange them. And it does not matter if <code>pass</code> happens to be located right after <code>buff[19]</code>. Trying to access <code>buff[20]</code> is still undefined behavior. And undefined behavior is undefined, so anything may happen.</p>\n\n<p>However, if you declare a <code>struct</code> it is a bit different. Let's take this simple example:</p>\n\n<pre><code>struct foobar {\n    int foo;\n    char bar;\n    struct foobar * next;\n}\n</code></pre>\n\n<p>Here you have guarantees that <code>foo</code>, <code>bar</code> and <code>next</code> will be in the order you have specified.</p>\n"}], "owner": {"reputation": 61, "user_id": 9164579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf07af72aac5a05fa8baf65946b282d4?s=128&d=identicon&r=PG&f=1", "display_name": "forTheRoad", "link": "https://stackoverflow.com/users/9164579/fortheroad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514910999, "creation_date": 1514910279, "question_id": 48064430, "link": "https://stackoverflow.com/questions/48064430/overwriting-local-variables-located-located-below-the-buffer-using-buffer-overfl", "title": "Overwriting local variables located located below the buffer using buffer overflow", "body": "<p>I am doing some basic research on stack overflow and have some trouble how to overwrite/modify a local variable that is located <strong>below</strong> the buffer in the memory.</p>\n\n<p>Consider the following piece of pseudo C code</p>\n\n<pre><code>char buff[20];\nint pass=0;\n.\n.\n.\ngets(buff)\ncheck if buff equals something, if true set pass == 1\nif pass == 1, grant access\n</code></pre>\n\n<p>Now, from what I gather the variables declared are ordered inversely on the stack. That is, buff is located above pass in the stack. When gets copies something into buff, the buffer grows towards high address space - towards the return address and away from the pass variable. It doesn't matter what input I type - I simply cannot overwrite pass since it is on the 'wrong' side of the buffer?</p>\n"}, {"tags": ["c", "doxygen"], "comments": [{"owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "edited": false, "score": 1, "creation_date": 1514909793, "post_id": 48064256, "comment_id": 83101593, "body": "Depending on your compiler you can define from the flags at compilation"}, {"owner": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "reply_to_user": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "edited": false, "score": 0, "creation_date": 1514910209, "post_id": 48064256, "comment_id": 83101830, "body": "@mdatsev I am not compiling. If I understood correctly the Doxygen parser does all of the work. Compiling would not fit my case either, because this piece of software is used in several use cases, and the documentation should cover all of them, not just one."}], "answers": [{"comments": [{"owner": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "edited": false, "score": 0, "creation_date": 1514915348, "post_id": 48065046, "comment_id": 83104221, "body": "This is the documentation of a bundle of libraries. The libraries are provided in source code format (this is a pre-requisite), and the users can configure them through several defines. This is why all of the code has to be documented, I can&#39;t guess what features the user will choose to use.  My headers are already split into modules, I just need to document them all..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "edited": false, "score": 0, "creation_date": 1514917384, "post_id": 48065046, "comment_id": 83105000, "body": "I am not persuaded, @AmiguelS.  If the libraries have build-time options that affect what features are available or what their details are, then their documentation should be built along with the libraries themselves, based on the build configuration.  Alternatively, if you only have to deal with which of a set of non-exclusive features are enabled, then just configure to enable everything, and build documentation for that, including in the documentation for each optional feature a notice that it is optional, and therefore may not be available in any given build."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "edited": false, "score": 0, "creation_date": 1514917436, "post_id": 48065046, "comment_id": 83105017, "body": "... or you can just filter out the conditional compilation directives, as I already described in this answer."}, {"owner": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "edited": false, "score": 0, "creation_date": 1514969708, "post_id": 48065046, "comment_id": 83121684, "body": "Yes, I will try to filter out the conditional compilation directives as you suggested.   Take Android as an example. If you go to the documentation pages, all of the documentation is available, not only of the components that I&#39;ll be using on my project."}, {"owner": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "edited": false, "score": 0, "creation_date": 1514973175, "post_id": 48065046, "comment_id": 83123436, "body": "Quotation marks are required around the sed, like so <code>INPUT_FILTER = &quot;sed &#39;&#47;^[ ]*#[ ]*\\(if\\|el\\|endif\\)&#47; d&#39;&quot;</code>"}, {"owner": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "edited": false, "score": 0, "creation_date": 1515517884, "post_id": 48065046, "comment_id": 83326265, "body": "Please update you answer, having my last comment in mind.. I&#39;ll then mark it as teh accepted answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "edited": false, "score": 0, "creation_date": 1515522027, "post_id": 48065046, "comment_id": 83328396, "body": "There you go, @AmiguelS"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1515522014, "last_edit_date": 1515522014, "creation_date": 1514912844, "answer_id": 48065046, "question_id": 48064256, "link": "https://stackoverflow.com/questions/48064256/document-define-without-the-preprocessor/48065046#48065046", "title": "Document #define without the preprocessor", "body": "<blockquote>\n  <p>On the Doxygen documentation I am writting, I have set <code>ENABLE_PREPROCESSING = NO</code>, because I want all of the code to be documented, independently of any <code>#if</code> statements.</p>\n</blockquote>\n\n<p>That's got some code smell to it.  The interface presented by your code should be documented <em>according to how it was built</em>.  It's pretty pointless to document features that could have been built but weren't, or to document alternative ways in which your features could have been built.  Generally speaking, that means having Doxygen pre-process conditional-compilation directives.</p>\n\n<p>And if you have conditional compilation that you intend for <em>users</em> of your library to trigger when they build their own programs, then I suggest taking a different approach: split your headers, so that your users select which headers to include instead of relying on conditional compilation to customize the content of a single header.</p>\n\n<p>HOWEVER, if you <em>must</em> document all the code in every conditional-compilation branch in a single set of documentation, and you also want to document macros, then you could consider leaving preprocessing on, and filtering out the conditional compilation directives with an input filter.  The latter part might be specified like this, for example:</p>\n\n<pre><code>INPUT_FILTER = \"sed '/^[ ]*#[ ]*\\(if\\|el\\|endif\\)/ d'\"\n</code></pre>\n\n<p>That does not account for line continuations, so as to keep it relatively simple, but even in that form it might be sufficient for your purposes.  It could be augmented to handle line continuations if needed.</p>\n"}], "owner": {"reputation": 673, "user_id": 4917117, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-o0jqFIMrX9c/AAAAAAAAAAI/AAAAAAAAABY/pPx9FN7YMO8/photo.jpg?sz=128", "display_name": "AmiguelS", "link": "https://stackoverflow.com/users/4917117/amiguels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 48065046, "answer_count": 1, "score": 2, "last_activity_date": 1515522014, "creation_date": 1514909614, "last_edit_date": 1514909688, "question_id": 48064256, "link": "https://stackoverflow.com/questions/48064256/document-define-without-the-preprocessor", "title": "Document #define without the preprocessor", "body": "<p>On the Doxygen documentation I am writting, I have set <code>ENABLE_PREPROCESSING = NO</code>, because I want all of the code to be documented, independently of any <code>#if</code> statements.</p>\n\n<p>The problems is that there is a <code>#define</code> that I need to be documented, but since I have disabled the preprocessor, nothing is generated for it (the other structures on that file are being documented just fine).</p>\n\n<p>One option would be to enable the preprocessor and use the <code>PREDEFINED</code> option to set all the <code>#if</code>, but that is not realistically achievable in my case (too many of them).</p>\n\n<p>Are there any other ways to achieve the intended result?</p>\n\n<p>Thanks!</p>\n"}]