[{"tags": ["c", "linux", "segmentation-fault", "getopt"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1539216441, "post_id": 52750315, "comment_id": 92424972, "body": "what is <code>file = file + &#39;\\0&#39;;</code> supposed to do?"}, {"owner": {"reputation": 1, "user_id": 10486853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3394f7529ae1e733a4470da75afa74b?s=128&d=identicon&r=PG&f=1", "display_name": "MitchShartz", "link": "https://stackoverflow.com/users/10486853/mitchshartz"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539216755, "post_id": 52750315, "comment_id": 92425048, "body": "@pm100 yeah I forgot to delete that but it&#39;s not the issue.  The problem occurred before I added that and is still occurring after I took it out."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1539217017, "post_id": 52750315, "comment_id": 92425109, "body": "put \\n on the end of all your tracing printfs, thet will ensure they get output correctly so you can see where u got up to"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539217085, "post_id": 52750315, "comment_id": 92425122, "body": "also, compile with -g and run under gdb, that will show you where it goes bang"}, {"owner": {"reputation": 1, "user_id": 10486853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3394f7529ae1e733a4470da75afa74b?s=128&d=identicon&r=PG&f=1", "display_name": "MitchShartz", "link": "https://stackoverflow.com/users/10486853/mitchshartz"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539217562, "post_id": 52750315, "comment_id": 92425232, "body": "@pm100 good idea.  the segmentation fault is happening right at the return statement because the print statements before it worked fine once I added a new line char"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539217841, "post_id": 52750315, "comment_id": 92425290, "body": "Note that you should ensure that <code>printf()</code> statements used for &#39;got here&#39; diagnostics at minimum end with a newline.  You might even want/need to use <code>fflush(stdout)</code>.  If you don&#39;t do that, the output can sit in a buffer and not be displayed even after the program crashes."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10486853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3394f7529ae1e733a4470da75afa74b?s=128&d=identicon&r=PG&f=1", "display_name": "MitchShartz", "link": "https://stackoverflow.com/users/10486853/mitchshartz"}, "edited": false, "score": 0, "creation_date": 1539217670, "post_id": 52750454, "comment_id": 92425254, "body": "that is an error, thanks for letting me know, but it isn&#39;t causing the segmentation fault.  It occurs much earlier than that"}, {"owner": {"reputation": 1, "user_id": 10486853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3394f7529ae1e733a4470da75afa74b?s=128&d=identicon&r=PG&f=1", "display_name": "MitchShartz", "link": "https://stackoverflow.com/users/10486853/mitchshartz"}, "edited": false, "score": 0, "creation_date": 1539217752, "post_id": 52750454, "comment_id": 92425269, "body": "wait never mind, that was the issue! you are a gentleman and a scholar"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1539218359, "post_id": 52750454, "comment_id": 92425396, "body": "You should show the fix in the answer. Change <code>i &lt; lines</code> to <code>lineCount &lt; lines</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1539218375, "post_id": 52750454, "comment_id": 92425398, "body": "And the second loop should use <code>curCol &lt; 6</code>."}], "tags": [], "owner": {"reputation": 31, "user_id": 3810400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317d196269613c0b6990195ef3bb9fa1?s=128&d=identicon&r=PG&f=1", "display_name": "Rakiston", "link": "https://stackoverflow.com/users/3810400/rakiston"}, "is_accepted": false, "score": 3, "last_activity_date": 1539217459, "creation_date": 1539217459, "answer_id": 52750454, "question_id": 52750315, "link": "https://stackoverflow.com/questions/52750315/why-am-i-getting-a-segmentation-fault-at-the-end-of-the-function-c/52750454#52750454", "title": "Why am I getting a segmentation fault at the end of the function (C)?", "body": "<p>The problem is here, in the inner loop</p>\n\n<pre><code>for(lineCount = 0; i &lt; lines; lineCount++){\n    for(curCol = 0; i &lt; 6; curCol++){\n        printf(\"%c\",labels[lineCount][curCol]);\n    }\n}\n</code></pre>\n\n<p>The variable i never gets updated in that loop, so both loops will run forever, causing an out of bounds array access of labels.</p>\n"}], "owner": {"reputation": 1, "user_id": 10486853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3394f7529ae1e733a4470da75afa74b?s=128&d=identicon&r=PG&f=1", "display_name": "MitchShartz", "link": "https://stackoverflow.com/users/10486853/mitchshartz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539217459, "creation_date": 1539215949, "question_id": 52750315, "link": "https://stackoverflow.com/questions/52750315/why-am-i-getting-a-segmentation-fault-at-the-end-of-the-function-c", "title": "Why am I getting a segmentation fault at the end of the function (C)?", "body": "<p>I am getting a segmentation fault at the end of readFirst().  If I put in a print statement to check sometimes the print statement doesn't appear.  The code compiles, but when I run it, it just prints the file like it is supposed to, then it gives me the fault at the return statement.  I have no idea what the problem is and no idea how to fix it.</p>\n\n<pre><code>int readFirst(FILE *file){\n    int c;\n    int linecount = 0;\n    int newLineCounter = 0;\n    while ((c = fgetc(file)) != EOF)\n    {\n        printf(\"%c\", c);\n        if(c == '\\n'){\n            newLineCounter++;\n        }\n            linecount++;\n    }\n    file = file + '\\0';\n    printf(\"check 3\");\n    //printf(\"\\n\");\n\n    printf(\"%i\",newLineCounter);\n    return newLineCounter;\n}\n\nint main (int argc, char **argv)\n{\n    char *infile = NULL;\n    char *outfile = NULL;\n    FILE *file = stdin;\n    FILE *text = stdout;\n    char ch[200];\n    int iFlag = 0;\n    int oFlag = 0;\n    char *iValue = NULL;\n    int index;\n    int i;\n\n    opterr = 0;\n\n    while ((i = getopt (argc, argv, \"i:o:\")) != -1) {\n            switch (i)\n            {\n            case 'i':\n                iFlag = 1;\n            infile = optarg;\n                break;\n            case 'o':\n            oFlag = 1;\n                outfile = optarg;\n                break;\n            case '?':\n                if(optopt == 'i') {\n                fprintf(stderr, \"Missing mandatory input option\\n\");\n            } else if (optopt == 'o') {\n                fprintf(stderr, \"Missing mandatory input option\\n\");\n                } else {\n                fprintf(stderr, \"Invalid option received\\n\");\n                }\n            break;\n            }\n    }\n\n    if (infile){\n        file = fopen(infile, \"r\");\n        if (file == NULL){\n            //printf(\"cannot open input file \\n\");\n            exit(1);\n        }\n        //fprintf(file,\"%s\", infile);\n        //fprintf(file,\"%s\", infile);\n\n    }\n    printf(\"check 1\");\n    int lines;\n    lines = readFirst(file);\n    printf(\"check 2\");\n    printf(\"%i\", lines);\n\n    char labels [lines][6];\n\n    int c;\n    int lineCount = 0;\n    int curCol = 0;\n    int flag = 0;\n\n\n    for(lineCount = 0; i &lt; lines; lineCount++){\n        for(curCol = 0; i &lt; 6; curCol++){\n            labels[lineCount][curCol] = ' ';\n        }\n    }\n\n    while(lineCount &lt; lines &amp;&amp; (c = fgetc(file)) != EOF){\n        if(flag != 0){\n            if(c != ' ' || c != '\\t'){\n                labels[lineCount][curCol] = c;\n                curCol++;\n            }else {\n                curCol = 0;\n                flag = 0;\n            }\n        }\n\n        if(c == '\\n'){\n            flag = 1;\n            lineCount++;\n        }\n    }\n\n\n    printf(\"%i\", lineCount);\n\n    for(lineCount = 0; i &lt; lines; lineCount++){\n        for(curCol = 0; i &lt; 6; curCol++){\n            printf(\"%c\",labels[lineCount][curCol]);\n        }\n    }\n\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 4, "creation_date": 1539215882, "post_id": 52750299, "comment_id": 92424858, "body": "Your compiler doesn&#39;t warn you about a function not returning a value like it should?"}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1539216003, "post_id": 52750299, "comment_id": 92424876, "body": "It does not, no."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 6, "creation_date": 1539216014, "post_id": 52750299, "comment_id": 92424881, "body": "Undefined behaviour when you try to use the return value from a function that doesn&#39;t return a value."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539216168, "post_id": 52750299, "comment_id": 92424909, "body": "If your compiler does not complain, you are either not using enough warning options or you need to get a better compiler.  If you&#39;re using Turbo C, get a better compiler \u2014 one from the second decade of the current millennium, not the penultimate decade of the last millennium.  If you use GCC, try <code>gcc -std=c11 -O3 -Wall -Wextra -Werror -Wmissing-prototypes -Wstrict-prototypes</code>.  They&#39;re about my base-level of warnings; I don&#39;t usually run code that doesn&#39;t compile with those (at least, not when it is my code; other people&#39;s code is sometimes a different matter)."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1539216269, "post_id": 52750299, "comment_id": 92424937, "body": "You really should turn on warnings, then (<code>-Wall -Wextra</code> for gcc and clang), and then pay attention to them."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 0, "creation_date": 1539216294, "post_id": 52750299, "comment_id": 92424944, "body": "How do I turn them on in JGRASP?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539216336, "post_id": 52750299, "comment_id": 92424953, "body": "What&#39;s JGRASP?  Oh, it&#39;s <a href=\"https://www.jgrasp.org/\" rel=\"nofollow noreferrer\">JGRASP</a>.  The manual probably tells you.  The help system may tell you."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1539216695, "post_id": 52750299, "comment_id": 92425034, "body": "<a href=\"http://users.csc.calpoly.edu/~jdalbey/101/Resources/GettingStarted/jGRASPSetup.html\" rel=\"nofollow noreferrer\">users.csc.calpoly.edu/~jdalbey/101/Resources/GettingStarted/&zwnj;&#8203;&hellip;</a> shows how to setup warnings."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539216750, "post_id": 52750299, "comment_id": 92425046, "body": "See <a href=\"https://www.jgrasp.org/faq.html#compflags\" rel=\"nofollow noreferrer\">How can I set compiler flags</a> in the jGRASP FAQ."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1539216821, "post_id": 52750299, "comment_id": 92425071, "body": "still amazing that this is not a fatal error by default"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539217186, "post_id": 52750299, "comment_id": 92425146, "body": "@pm100: It&#39;s not because of the legacy of pre-standard C, where there wasn&#39;t a <code>void</code> return type necessarily (and a lot of code pre-dated the late addition of the <code>void</code> return type), so functions were written with no explicit return type (default ot <code>int</code>) and with just <code>return;</code> in the function because there was no returned value, and as long as you didn&#39;t try to capture or test the value that wasn&#39;t returned, it was OK."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539217525, "post_id": 52750299, "comment_id": 92425225, "body": "@pm100:  See C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.9.1p12\" rel=\"nofollow noreferrer\">&#167;6.9.1 Function definitions &#182;12</a>: <i>If the <code>}</code> that terminates a function is reached, and the value of the function call is used by the caller, the behavior is undefined.</i>  <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.8.6.4p1\" rel=\"nofollow noreferrer\">&#167;6.8.6.4 The <code>return</code> statement &#182;1</a> says: <i>A <code>return</code> statement with an expression shall not appear in a function whose return type is <code>void</code>. A <code>return</code> statement without an expression shall only appear in a function whose return type is <code>void</code>.</i> Earlier versions of standard C were more lax, I believe."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539217969, "post_id": 52750299, "comment_id": 92425315, "body": "@JonathanLeffler iamgine how much easier life would be for all if modern c compilers defaulted to -wall -werror. Non beginners would prove that they were not beginners by discovering the -Wdontnag option. Advanced users would also take the dontnag option back off (cos we all like squeaky clean code)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1539218119, "post_id": 52750299, "comment_id": 92425350, "body": "Read the warnings and this question would never been asked"}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1539227022, "post_id": 52750299, "comment_id": 92427192, "body": "@P__J__ I guess you can say I&#39;ve been warned."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539216539, "post_id": 52750346, "comment_id": 92424991, "body": "The trouble with returning a flag like <code>1</code> for success is that your calling code should check for success, but it won&#39;t ever get a failure (there&#39;s only the <code>return 1;</code> in the function), so in fact it would be better if the function returned nothing, which is spelled <code>void</code>: <code>void exchange(\u2026)</code> \u2014 and no <code>return</code> or just <code>return;</code> in the function body (and there should be no attempt to capture or print the non-existent value that wasn&#39;t returned, of course)."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1539216635, "post_id": 52750346, "comment_id": 92425023, "body": "And, in general, C uses 0 to indicate success anyway, IIRC."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1539216968, "post_id": 52750346, "comment_id": 92425101, "body": "@DaveNewton: A lot of C code uses 0 for success, especially if it originated in the Unix world.  Some code does not, though \u2014 a notable example is the OpenSSL library."}, {"owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539217083, "post_id": 52750346, "comment_id": 92425120, "body": "@JonathanLeffler in this case the statement <code>int d = exchange(&amp;a, &amp;b, &amp;c);</code> would cause an error. He uses a return <code>int</code> type function and even stores it in some value during function call. I just assumed that it has some meaning, flag or otherwise (subject to specific interpretation)."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 0, "creation_date": 1539227153, "post_id": 52750346, "comment_id": 92427219, "body": "It helped, in the end I just made it a void."}], "tags": [], "owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "is_accepted": false, "score": 1, "last_activity_date": 1539216389, "creation_date": 1539216389, "answer_id": 52750346, "question_id": 52750299, "link": "https://stackoverflow.com/questions/52750299/the-value-returned-in-this-program-is-queer-to-say-the-least/52750346#52750346", "title": "The value returned in this program is. . . .Queer to say the least", "body": "<p>Your problem is that you have not returned anything from <code>exchange</code> whose return type is <code>int</code>. Hence what you see is garbage for the value of <code>d</code>. Try returning a status flag like <code>1</code> for success.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint exchange(int *xp, int *yp, int *zp) {\n    int x = *xp; \n    int y = *yp; \n    int z = *zp;\n\n    *xp = z;\n    *yp = x; \n    *zp = y;  \n    return 1;\n}\n\n\nint main(){\n    int a = 3;\n    int b = 12;\n    int c = 24;\n    exchange(&amp;a, &amp;b, &amp;c);\n    printf(\"int a = %d, int b = %d, int c = %d : \", a, b, c);\n    int d = exchange(&amp;a, &amp;b, &amp;c);\n    printf(\"\\n int d = %d\\n\", d);\n    return 0;\n\n}\n</code></pre>\n\n<p>You should see something like,</p>\n\n<pre><code>int a = 24, int b = 3, int c = 12 :\n int d = 1 \n</code></pre>\n\n<p>Let me know if this helps !!</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1539216843, "post_id": 52750364, "comment_id": 92425078, "body": "Note that <code>return x, y, z;</code> is a peculiar use of the comma operator, equivalent to writing just <code>return z;</code> (except that a fussy compiler won&#39;t warn you about unused expressions with no side-effects, whereas the version with the comma operator will generate such a warnings).  Note also my <a href=\"https://stackoverflow.com/questions/52750299/the-value-returned-in-this-program-is-queer-to-say-the-least#comment92424991_52750346\">comment</a> to another answer here."}], "tags": [], "owner": {"reputation": 21, "user_id": 10308325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/riQH1.jpg?s=128&g=1", "display_name": "WuJun Tian", "link": "https://stackoverflow.com/users/10308325/wujun-tian"}, "is_accepted": false, "score": 1, "last_activity_date": 1539219531, "last_edit_date": 1539219531, "creation_date": 1539216619, "answer_id": 52750364, "question_id": 52750299, "link": "https://stackoverflow.com/questions/52750299/the-value-returned-in-this-program-is-queer-to-say-the-least/52750364#52750364", "title": "The value returned in this program is. . . .Queer to say the least", "body": "<p>I can't tell where is wrong in your program, so I put your code on my IDE, and surprisingly it even can't build. And the warning shows : <code>Control reaches end of non-void function in Line 12</code> (the end <code>}</code> of the exchange function). so i tried to fix this problem by add a sentence : return z; . And it works!</p>\n\n<p>I think it's because your function exchange is an int value returned function, unlike the void kind, it has to have a return value. so add one to it. it will run very well</p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1539218210, "post_id": 52750489, "comment_id": 92425367, "body": "Nothing interesting in it. It was lower part of the address accidently in the register used for the address calculations."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1539220095, "post_id": 52750489, "comment_id": 92425725, "body": "<code>eax</code> is the register used for return value (most likely)"}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 0, "creation_date": 1539227099, "post_id": 52750489, "comment_id": 92427209, "body": "&quot;The universe might get destroyed, who  knows?&quot; I love that. It&#39;s like one day this robot gave this woman her coffee and BOOM. Fallout 4."}], "tags": [], "owner": {"reputation": 12006, "user_id": 1102056, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d3b5ee75a670827289364ba8dc89ed4?s=128&d=identicon&r=PG", "display_name": "Sufian Latif", "link": "https://stackoverflow.com/users/1102056/sufian-latif"}, "is_accepted": false, "score": 1, "last_activity_date": 1539218406, "last_edit_date": 1539218406, "creation_date": 1539217762, "answer_id": 52750489, "question_id": 52750299, "link": "https://stackoverflow.com/questions/52750299/the-value-returned-in-this-program-is-queer-to-say-the-least/52750489#52750489", "title": "The value returned in this program is. . . .Queer to say the least", "body": "<p><strong>Not a proper answer, just an interesting observation:</strong></p>\n\n<p>I added some <code>printf</code>s in your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint exchange(int *xp, int *yp, int *zp){\n   int x = *xp; \n   int y = *yp; \n   int z = *zp;\n   printf(\"xp = %p, yp = %p, zp = %p\\n\", xp, yp, zp);\n\n   *xp = z;\n   *yp = x; \n   *zp = y; \n}\n\n\nint main(){\n   int a = 3;\n   int b = 12;\n   int c = 24;\n   printf(\"&amp;a = %p, &amp;b = %p, &amp;c = %p\\n\", &amp;a, &amp;b, &amp;c);\n   exchange(&amp;a, &amp;b, &amp;c);\n   int d = exchange(&amp;a, &amp;b, &amp;c);\n   printf(\"int d = %x\\n\", d);\n   return 0;\n}\n</code></pre>\n\n<p>And ran it on my computer (gcc 7.3.0 on Ubuntu 18.04), and got this output:</p>\n\n<pre><code>&amp;a = 0x7ffca0126788, &amp;b = 0x7ffca012678c, &amp;c = 0x7ffca0126790\nxp = 0x7ffca0126788, yp = 0x7ffca012678c, zp = 0x7ffca0126790\nxp = 0x7ffca0126788, yp = 0x7ffca012678c, zp = 0x7ffca0126790\nint d = a0126790\n</code></pre>\n\n<p>It appears that lower 32 bits of the parameter <code>zp</code> is being returned from <code>exchange</code>. But If I move the call to <code>printf</code> to the end of <code>exchange</code>, it always returns 62, which is the value returned from printf itself.</p>\n\n<p>My guess is, when you don't return a value from a function, probably the register used to hold the value to be returned retains the value returned by the subsequent function call. If no more function is called, then <em>somehow</em> it gets the value of a parameter, which I can't explain or guess.</p>\n\n<p>But all these things are specific to the gcc on my computer (maybe yours too). Actually this is undefined behavior and you never know what would happen (quoting one of my professors: \"The universe might get destroyed, who knows?\").</p>\n\n<p>When I ran the same code <a href=\"https://www.ideone.com/BRfBsu\" rel=\"nofollow noreferrer\">on ideone</a> (which is gcc 6.3), I found the returned value to be 0.</p>\n"}], "owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1539219531, "creation_date": 1539215783, "last_edit_date": 1539215927, "question_id": 52750299, "link": "https://stackoverflow.com/questions/52750299/the-value-returned-in-this-program-is-queer-to-say-the-least", "title": "The value returned in this program is. . . .Queer to say the least", "body": "<p>So, I was experimenting with assembly and pointers, so I decided to do a little extra, I made a new integer , d and assigned the function exchange to it: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint exchange(int *xp, int *yp, int *zp){\n   int x = *xp; \n   int y = *yp; \n   int z = *zp;\n\n   *xp = z;\n   *yp = x; \n   *zp = y;  \n}\n\n\nint main(){\n   int a = 3;\n   int b = 12;\n   int c = 24;\n   exchange(&amp;a, &amp;b, &amp;c);\n   printf(\"int a = %d, int b = %d, int c = %d : \", a, b, c);\n   int d = exchange(&amp;a, &amp;b, &amp;c);\n   printf(\"\\n int d = %d\", d);\n   return 0;\n\n}\n</code></pre>\n\n<p>So, when I do the exchange function , it works as intended, switching the values in the registers. Except. . . .d returned a weird number: 6356768. </p>\n\n<p>I'm not sure why d returns that value, but I would be much obliged if somebody would explain how it happened.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539214437, "post_id": 52750077, "comment_id": 92424559, "body": "Please read about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  If you had provided an MCVE, your first paragraph would be unnecessary because your code would show the initializations.  You&#39;d probably avoid the array <code>d</code> and the structure type; those seem to be unnecessary (you&#39;d provide the data, but not the structure or the array).  How big is <code>riga_corrente</code>?  How were we supposed to know?  Note that the delimiter to <code>strtok()</code> is any one of the characters listed, so the <code>l</code> in <code>figlio</code> is a delimiter too.  This probably explains your output."}, {"owner": {"reputation": 63, "user_id": 9434693, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VoLdP7WAe6M/AAAAAAAAAAI/AAAAAAAAAT8/SKlagXjfWbE/photo.jpg?sz=128", "display_name": "Simone Sasso", "link": "https://stackoverflow.com/users/9434693/simone-sasso"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539214923, "post_id": 52750077, "comment_id": 92424653, "body": "I am sorry for the bad example, btw riga_corrente is 200. I didn&#39;t know that the delimiter could be any character. Is there a way to put only the entire word &#39;pelle&#39; as a delimiter?"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 0, "last_activity_date": 1539215786, "last_edit_date": 1539215786, "creation_date": 1539215409, "answer_id": 52750258, "question_id": 52750077, "link": "https://stackoverflow.com/questions/52750077/why-isnt-strtok-separating-this-string-correctly-c/52750258#52750258", "title": "Why isn&#39;t strtok separating this string correctly? C", "body": "<p>Here is your question converted into an MCVE (<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char riga_corrente[200] = \"apelle figlio di apollo\";\n    char stringa[] = \"pelle\";\n    char compresso_s[] = \"$11$\";\n    char temp[200];\n\n    strcpy(temp, strtok(riga_corrente, stringa));\n    strcat(temp, compresso_s);\n    strcat(temp, strtok(NULL, stringa));\n    strcpy(riga_corrente, temp);\n    printf(\"[%s]\\n\", riga_corrente);\n\n    return 0;\n}\n</code></pre>\n\n<p>This produces the following output, which means the library functions are working as designed (but apparently not as you expected):</p>\n\n<pre><code>[a$11$ fig]\n</code></pre>\n\n<p>The first call to <code>strtok()</code> stops at the <code>p</code> in <code>apelle</code>, zapping it with a null byte, and returning a pointer to the <code>a</code>, which is copied into <code>temp</code>.  You then append the <code>$11$</code> from <code>compresso_s</code>.  The next call to <code>strtok()</code> skips over the <code>e</code>, <code>l</code>, <code>l</code> and <code>e</code> of <code>apelle</code> and starts the token at the blank.  The letters <code>f</code>, <code>i</code>, <code>g</code> don't match the delimiters, but <code>l</code> does, so the <code>l</code> in <code>figlio</code> is zapped with a null byte and a pointer to the blank is returned.  This string is correctly added to the end of <code>temp</code>, and then <code>temp</code> overwrites <code>riga_corrente</code> because of the <code>strcpy()</code>.</p>\n\n<p>At first glance, you could fix it by changing the delimiter in the second call to <code>strtok()</code>, maybe to just a newline, or even an empty string.  However, that leaves the <code>elle</code> of <code>apelle</code> as part of the output too.  Fixing that requires different technology \u2014 possibly using the underrated (and little known) <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strspn.html\" rel=\"nofollow noreferrer\"><code>strspn()</code></a> and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strcspn.html\" rel=\"nofollow noreferrer\"><code>strcspn()</code></a> functions that have been in Standard C since the 1989 edition, or possibly using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strstr.html\" rel=\"nofollow noreferrer\"><code>strstr()</code></a> to find the string <code>pelle</code>.</p>\n\n<p>It's not very elegant (there's probably a function in here trying to escape), but this works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char riga_corrente[200] = \"apelle figlio di apollo\";\n    char stringa[] = \"pelle\";\n    char compresso_s[] = \"$11$\";\n    char temp[200];\n\n    char *source = riga_corrente;\n    char *p1 = strstr(source, stringa);\n    if (p1 == NULL)\n        strcpy(temp, source);\n    else\n    {\n        *p1 = '\\0';\n        strcpy(temp, source);\n        source = p1 + strlen(stringa);\n    }\n    strcat(temp, compresso_s);\n    if (p1 != NULL)\n    {\n        p1 = strstr(source, stringa);\n        if (p1 == NULL)\n            strcat(temp, source);\n        else\n        {\n            *p1 = '\\0';\n            strcat(temp, source);\n        }\n    }\n    strcpy(riga_corrente, temp);\n    printf(\"[%s]\\n\", riga_corrente);\n\n    return 0;\n}\n</code></pre>\n\n<p>There's no buffer overflow protection etc here; it usually won't be needed, but in principle, if <code>pelle</code> never appeared in <code>riga_corrente</code>, you could get a buffer overflow.</p>\n"}], "owner": {"reputation": 63, "user_id": 9434693, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VoLdP7WAe6M/AAAAAAAAAAI/AAAAAAAAAT8/SKlagXjfWbE/photo.jpg?sz=128", "display_name": "Simone Sasso", "link": "https://stackoverflow.com/users/9434693/simone-sasso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1539217970, "accepted_answer_id": 52750258, "answer_count": 1, "score": -2, "last_activity_date": 1539215786, "creation_date": 1539213899, "last_edit_date": 1539214576, "question_id": 52750077, "link": "https://stackoverflow.com/questions/52750077/why-isnt-strtok-separating-this-string-correctly-c", "closed_reason": "Not suitable for this site", "title": "Why isn&#39;t strtok separating this string correctly? C", "body": "<ul>\n<li>The string inside riga_corrente is: <code>\"apelle figlio di apollo\"</code>.</li>\n<li>The content of d[0].stringa is \"pelle\", compresso_s is \"$11$\".</li>\n<li>Temp is an array of 200 char.</li>\n</ul>\n\n<p>I want to have <code>\"a$11$ figlio di apollo\"</code> inside <code>riga_corrente</code> but I only get <code>\"a$11$ fig\"</code> and I don't understand why.</p>\n\n<p>Part of my code:</p>\n\n<pre><code>strcpy(temp,strtok(riga_corrente,d[i].stringa));\nstrcat(temp,compresso_s);\nstrcat(temp,strtok(NULL,d[i].stringa));\nstrcpy(riga_corrente,temp);\n</code></pre>\n"}, {"tags": ["python", "c", "python-3.x", "numpy"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1539211120, "post_id": 52749662, "comment_id": 92423777, "body": "Did you try the thing the warning says?"}, {"owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1539211665, "post_id": 52749662, "comment_id": 92423911, "body": "@user2357112 I tried a <code>#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION</code> in <code>my_c_file.c</code>  but I don&#39;t think that helped"}], "answers": [{"tags": [], "owner": {"reputation": 3496, "user_id": 2536294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/5FtIH.png?s=128&g=1", "display_name": "adrin", "link": "https://stackoverflow.com/users/2536294/adrin"}, "is_accepted": false, "score": 6, "last_activity_date": 1573551341, "creation_date": 1573551341, "answer_id": 58815771, "question_id": 52749662, "link": "https://stackoverflow.com/questions/52749662/using-deprecated-numpy-api/58815771#58815771", "title": "Using deprecated Numpy API", "body": "<p>This is a known issue, and it stems from the fact that Cython historically has supported very old <code>numpy</code> versions. As <code>cython</code>'s <a href=\"https://github.com/cython/cython/blob/70d770324a230df6a429d82cf8e8187cd34b9709/docs/src/userguide/source_files_and_compilation.rst\" rel=\"noreferrer\">doc</a> mentions:</p>\n\n<blockquote>\n  <p>Despite this, you will still get warnings like the following from the\n  compiler, because Cython is using a deprecated Numpy API:</p>\n\n<pre><code>.../include/numpy/npy_1_7_deprecated_api.h:15:2: warning: #warning\n\"Using deprecated NumPy API, disable it by \" \"#defining\nNPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-Wcpp]\n</code></pre>\n  \n  <p>For the time being, it is just a warning that you can ignore.</p>\n</blockquote>\n\n<p>However, there's work in progress in several pull requests and the parent issue tracking the progress can be found <a href=\"https://github.com/cython/cython/issues/2498\" rel=\"noreferrer\">here</a>.</p>\n\n<p>Soon these warnings will be gone.</p>\n"}, {"tags": [], "owner": {"reputation": 840, "user_id": 2557404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fac664de62cf73081e721071d5b9d0d?s=128&d=identicon&r=PG", "display_name": "Jim Parker", "link": "https://stackoverflow.com/users/2557404/jim-parker"}, "is_accepted": false, "score": 2, "last_activity_date": 1605825664, "last_edit_date": 1605825664, "creation_date": 1605802470, "answer_id": 64915608, "question_id": 52749662, "link": "https://stackoverflow.com/questions/52749662/using-deprecated-numpy-api/64915608#64915608", "title": "Using deprecated Numpy API", "body": "<p>Until this is resolved upstream as mentioned by adrin, I found a way to insert the preprocessor symbol <code>NPY_NO_DEPRECATED_API</code> into the <code>setup.py</code> code so that the warning will be suppressed.  Add the keyword <code>define_macros=[args]</code> to your <code>Extension</code>. Just putting it in your .h, .cpp, or .pyx files will not help because the auto-generated project .cpp file will not see the preprocessor defines.\n<a href=\"https://docs.python.org/2.0/dist/node13.html\" rel=\"nofollow noreferrer\">https://docs.python.org/2.0/dist/node13.html</a></p>\n<p>Specifically for OP's case:</p>\n<pre><code>module1 = Extension('my_wrapper', sources = ['my_c_file.c'],  \n    include_dirs=[numpy.get_include()],\n    extra_compile_args = ['-fopenmp'],\n    extra_link_args = ['-lgomp']),\n    define_macros=[('NPY_NO_DEPRECATED_API', 'NPY_1_7_API_VERSION')])\n</code></pre>\n<p>This will add <code>-DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION</code> to the compile line.</p>\n<p>Fair warning: doing this may enable several new warnings that were suppressed because it was maintaining compatibility with old versions.</p>\n"}], "owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4703, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1605825664, "creation_date": 1539210743, "question_id": 52749662, "link": "https://stackoverflow.com/questions/52749662/using-deprecated-numpy-api", "title": "Using deprecated Numpy API", "body": "<p>I am writing a small C function that is supposed to accelerate some compute intensive portions of a larger application that I have in Python. Naturally I have written a wrapper that ensures that my C code can talk seamlessly with my Python numpy arrays. All is well and I am using the following <code>setup.py</code></p>\n\n<pre><code>from distutils.core import setup, Extension\nimport numpy\n\nmodule1 = Extension('my_wrapper', \n    sources = ['my_c_file.c'],  \n    include_dirs=[numpy.get_include()],\n    extra_compile_args = ['-fopenmp'],\n    extra_link_args = ['-lgomp'])\n\nsetup(name = 'my_wrapper',\n    version = '1.0',\n    description = 'Some description here',\n    ext_modules = [module1])\n</code></pre>\n\n<p>Everything works when I compile this with the command <code>python3 setup.py install</code> and the code behaviour is as expected but I am getting the following warning,</p>\n\n<pre><code>warning: #warning \"Using deprecated NumPy API, disable it by \" \"#defining NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-Wcpp]\n#warning \"Using deprecated NumPy API, disable it by \" \\\n^\n</code></pre>\n\n<p>Although this is just a warning, I would still like to avoid this if I can. Any ideas on how to do that?</p>\n"}, {"tags": ["c", "struct", "generic-programming"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1539210377, "post_id": 52749409, "comment_id": 92423554, "body": "How do you pass the structs to the method? Via <code>void*</code>?"}, {"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1539211980, "post_id": 52749409, "comment_id": 92423998, "body": "plan is to pass them into <code>frame_render(frame*)</code> more or less. They will be sitting in a single list that gets iterated via a for loop"}], "answers": [{"comments": [{"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539211902, "post_id": 52749649, "comment_id": 92423975, "body": "I kinda like this approach, though ... it will require that all types are known in my <code>renderable</code> (or <code>frame</code>) struct"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 1, "creation_date": 1539212195, "post_id": 52749649, "comment_id": 92424057, "body": "If you do not know all the types, how would you render them?"}, {"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539212350, "post_id": 52749649, "comment_id": 92424094, "body": "They are all rendered the same :) thats the actual fun part.. above scenario is only some broken down example though.. differences are minimal and mostly related to how they actually be used and not related to rendering at all"}, {"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539212860, "post_id": 52749649, "comment_id": 92424223, "body": "according to what was posted by <i>supercat</i>, this could be problematic on some compilers (eg. gcc). Think i will accept the answer of <i>Craig Estey</i> simply due to timing and &quot;completeness&quot;. Have my appreciation though :)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1539272716, "post_id": 52749649, "comment_id": 92451140, "body": "The classical approach is actually to use pointers to whatever structure type is appropriate; a well-known example is the SOCK_ADDR class.The code I&#39;ve seen from that era rarely uses unions for that purpose.  Unfortunately, when compiler writers asked the authors of the Standard whether compilers were required to uphold CIS guarantees even in cases where it would be useless, the authors of the Standard agreed that it was not necessary to have the Standard mandate it, figuring that people seeking to write quality compilers would uphold them in cases where they were useful whether or not..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1539273030, "post_id": 52749649, "comment_id": 92451312, "body": "...the Standard required them to do so.  Support for common patterns of CIS access via pointers used to be a 100% universal extension among commonplace compilers, since it was obviously useful and cost nothing.  Unfortunately, the authors of the Standard neglected to have Standard itself explicitly say that it makes no attempt to mandate all of the behaviors necessary to make any implementation suitable for any particular purposes.  The Rationale acknowledges the possibility of a low-quality implementation being useless but conforming, but the Standard itself doesn&#39;t."}], "tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": false, "score": 2, "last_activity_date": 1539212863, "last_edit_date": 1539212863, "creation_date": 1539210676, "answer_id": 52749649, "question_id": 52749409, "link": "https://stackoverflow.com/questions/52749409/multiple-structs-same-fields-that-need-to-be-accessed-in-a-method/52749649#52749649", "title": "Multiple structs, same fields that need to be accessed in a method", "body": "<p>The \"classical\" method is to have a <code>struct</code> that contains a <code>union</code> of all possible objects and an <code>enum</code> that identifies which exactly object has been passed:</p>\n\n<pre><code>struct renderable {\n    enum {FRAME, BUTTON, WHATVERE, ...} type;\n    union {\n        struct frame frame;\n        struct button button;\n        struct whatever whatever;\n        ....\n    } data;\n};\n</code></pre>\n\n<p>After passing this struct to the renderer, use a <code>switch</code> on the <code>type</code> field to extract the coordinates, etc:</p>\n\n<pre><code>void renderer (renderable *obj, ...) {\n    ...\n    switch(obj-&gt;type) {\n        case FRAME: x = obj-&gt;data.frame.x; ...; break;\n        case BUTTON: x = obj-&gt;data.button.x; ...; break;\n        ...\n    }\n    ...\n}\n</code></pre>\n\n<p>It was reportedly this kind of monstrosity that encouraged Stroustrup to invent C++ :)</p>\n\n<p><strong>Edited</strong></p>\n\n<p>Another \"classical\" solution is to have a separate <code>struct</code> that has the dimensions and the position of any object:</p>\n\n<pre><code>struct geometry {\n    int x, y, width, height;\n}\n</code></pre>\n\n<p>You can store this structure at the beginning of any object-specific <code>struct</code> and use a cast to gain access to it:</p>\n\n<pre><code>struct frame {\n    struct geometry geo;\n    // more stuff\n};\n\nstruct frame frame = {....};\nrendered((void*)&amp;frame, ...);\n</code></pre>\n\n<p>In the renderer:</p>\n\n<pre><code>void renderer (void *obj, ...) {\n    ...\n    struct geometry *geo = (struct geometry *)obj;\n    geo-&gt;x ...\n}\n</code></pre>\n\n<p>The latter approach may be somewhat unsafe. To make it 100% safe, separate the geometry from the object-specific information and pass them to the renderer as two separate structs.</p>\n"}, {"comments": [{"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539211587, "post_id": 52749660, "comment_id": 92423888, "body": "is this approach casting safe? eg. putting all into some array that is of the type <code>frame*</code> and then just accessing <code>frame-&gt;geo</code>? or would that cause any problems with later calls to <code>free(..)</code>?`"}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 3, "last_activity_date": 1539218274, "last_edit_date": 1539218274, "creation_date": 1539210727, "answer_id": 52749660, "question_id": 52749409, "link": "https://stackoverflow.com/questions/52749409/multiple-structs-same-fields-that-need-to-be-accessed-in-a-method/52749660#52749660", "title": "Multiple structs, same fields that need to be accessed in a method", "body": "<blockquote>\n  <p>is it enough to \"just\" put them in the same order at the very begining?</p>\n</blockquote>\n\n<p>Yes, if you're careful as you've done above.</p>\n\n<blockquote>\n  <p>also, how to design the method header to accept it?</p>\n</blockquote>\n\n<p>There are different ways to do this.</p>\n\n<p>Here's an example, using the [ugly] equivalent of a <code>c++</code> \"base\" class:</p>\n\n<pre><code>enum type {\n    FRAME,\n    BUTTON,\n    WHATEVER\n};\n\nstruct geo {\n    int x;\n    int y;\n    int width;\n    int height;\n    enum type type;\n};\n\nstruct frame {\n    struct geo geo;\n};\n\nstruct button {\n    struct geo geo;\n    int updown;\n};\n\nstruct whatever {\n    struct geo geo;\n    int what;\n    int ever;\n};\n\nvoid\nframe_render(struct geo *geo)\n{\n    struct frame *frm;\n    struct button *but;\n    struct whatever *what;\n\n    switch (geo-&gt;type) {\n    case FRAME:\n        frm = (struct frame *) geo;\n        frame_render_frame(frm);\n        break;\n\n    case BUTTON:\n        but = (struct button *) geo;\n        printf(\"x=%d y=%d updown=%d\\n\",geo-&gt;x,geo-&gt;y,but-&gt;updown);\n        frame_render_button(but);\n        break;\n\n    case WHATEVER:\n        what = (struct whatever *) geo;\n        printf(\"x=%d y=%d what=%d ever=%d\\n\",\n            what-&gt;geo.x,what-&gt;geo.y,what-&gt;what,what-&gt;ever);\n        frame_render_whatever(what);\n        break;\n    }\n}\n</code></pre>\n\n<p>Here's a way to use a virtual function table:</p>\n\n<pre><code>enum type {\n    FRAME,\n    BUTTON,\n    WHATEVER\n};\n\nstruct geo;\n\n// virtual function table\nstruct virtfnc {\n    void (*calc)(struct geo *);\n    void (*render)(struct geo *);\n};\n\nstruct geo {\n    int x;\n    int y;\n    int width;\n    int height;\n    enum type type;\n    struct virtfnc *fnc;\n};\n\nstruct frame {\n    struct geo geo;\n};\n\nstruct button {\n    struct geo geo;\n    int updown;\n};\n\nstruct whatever {\n    struct geo geo;\n    int what;\n    int ever;\n};\n\nvoid\nframe_render(struct geo *geo)\n{\n    struct frame *frm = (struct frame *) geo;\n\n    // whatever\n}\n\nvoid\nbutton_render(struct geo *geo)\n{\n    struct button *but = (struct button *) geo;\n\n    // whatever\n}\n\nvoid\nwhatever_render(struct geo *geo)\n{\n    struct whatever *what = (struct whatever *) geo;\n\n    // whatever\n}\n\nvoid\nany_render(struct geo *geo)\n{\n\n    geo-&gt;fnc-&gt;render(geo);\n}\n</code></pre>\n\n<p>Here's a third way that uses a <code>union</code>. It is simpler but requires that the base struct be as large as the largest sub-class:</p>\n\n<pre><code>enum type {\n    FRAME,\n    BUTTON,\n    WHATEVER\n};\n\nstruct frame {\n    ...\n};\n\nstruct button {\n    int updown;\n};\n\nstruct whatever {\n    int what;\n    int ever;\n};\n\nstruct geo {\n    int x;\n    int y;\n    int width;\n    int height;\n    enum type type;\n    union {\n        struct frame frame;\n        struct button button;\n        struct whatever what;\n    } data;\n};\n\nvoid\nany_render(struct geo *geo)\n{\n\n    switch (geo-&gt;type) {\n    case FRAME:\n        render_frame(&amp;geo-&gt;data.frame);\n        break;\n\n    case BUTTON:\n        render_button(&amp;geo-&gt;data.button);\n        break;\n\n    case WHATEVER:\n        render_whatever(&amp;geo-&gt;data.what);\n        break;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>is this approach casting safe? eg. putting all into some array that is of the type <code>frame*</code> and then just accessing <code>frame-&gt;geo</code>? or would that cause any problems with later calls to <code>free(..)</code>?</p>\n</blockquote>\n\n<p>No problem with <code>free</code> if allocations are done with the <em>derived</em> types (e.g. <code>frame</code>, <code>button</code>), but <em>not</em> the base type <code>geo</code>: <code>malloc(sizeof(struct button))</code>.</p>\n\n<p>To have a <em>simple</em> array [of shapes], the <code>union</code> method would need to be used (i.e. all derived structs must have the same size). But, this would be wasteful if we had some subtype that used a <em>lot</em> more space than the others:</p>\n\n<pre><code>struct polyline {\n    int num_points;\n    int x[100];\n    int y[100];\n};\n</code></pre>\n\n<p>This <em>could</em> still be done with methods #1 or #2 [where the subtype structs are of different sizes] with an <em>indirect</em> pointer array:</p>\n\n<pre><code>void\nall_render(struct geo **glist,int ngeo)\n{\n\n    for (;  ngeo &gt; 0;  --ngeo, ++glist)\n        any_render(*glist);\n}\n</code></pre>\n\n<p>Rather than an array of different shapes, I'd consider a [doubly] linked list. This allows the subtype structs to have different sizes. We'd add a <code>struct geo *next</code> element to <code>struct geo</code>. Then, we could do:</p>\n\n<pre><code>void\nall_render(struct geo *geo)\n{\n\n    for (;  geo != NULL;  geo = geo-&gt;next)\n        any_render(geo);\n}\n</code></pre>\n\n<p>The list approach may be preferable, particularly if we add/remove shapes on a dynamic basis [or reorder them based on Z-depth].</p>\n\n<p>Or, some shapes might <em>contain</em> others. So, we could add <code>struct geo *children</code> to <code>struct geo</code>. Then, it's easy to (e.g.) draw a containing box, then all the shapes within that box by traversing the <code>children</code> list. If we go for <code>children</code>, we may as well add <code>struct parent *parent</code> as well so each shape knows what shape contains it.</p>\n"}, {"comments": [{"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539211783, "post_id": 52749738, "comment_id": 92423944, "body": "I am not fully sure if that is a &quot;yes it works&quot; or a &quot;yes it works, as long as you do not use clang/gcc without a special flag&quot;."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 2, "creation_date": 1539211946, "post_id": 52749738, "comment_id": 92423990, "body": "@X39: I think it&#39;s clear that the authors of the Standard intended it to work, and in practice it will work as long as you make certain to use an appropriate flag on compilers that require it.  The only two compilers I know of that require such a flag to make use of the CIS guarantees are clang and gcc, but it&#39;s possible that there are others.  Note that clang and gcc definitely do <i>not</i> support such code without the flag."}, {"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539212245, "post_id": 52749738, "comment_id": 92424067, "body": "so basically, i must fall back to pretty much what has been posted by others if i want to stay safe and clear? As far as my understanding goes from googling quickly, <code>fno-strict-aliasing</code> would disable optimization on some occasions"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 2, "creation_date": 1539212894, "post_id": 52749738, "comment_id": 92424235, "body": "@x39: Write the code how it makes sense and document what is required to make it work.  The Standard makes no attempt to fully specify a language that is useful for any particular purpose, and the dialect processed by clang and gcc with maximum optimizations enabled might be great for a few specialized purposes that don&#39;t involve processing input from unknown sources, but really isn&#39;t suitable for most others.  Rather than bending over backward to write code in an unsuitable dialect, make use of &quot;popular extensions&quot; when appropriate--just document that you&#39;re doing so."}, {"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539213067, "post_id": 52749738, "comment_id": 92424283, "body": "I very much thank you @supercat for literally expanding my knowledge on that topic. But i accepted <i>Craig Estey</i> simply due to his answer containing the approach that i will now use."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 1, "creation_date": 1539213110, "post_id": 52749738, "comment_id": 92424290, "body": "@X39: BTW, a detail I forgot to mention: learn about the <code>restrict</code> qualifier, and use it when appropriate.  Proper use of that qualifier can re-enable most of the useful optimizations blocked by <code>-fno-strict-aliasing</code>, and many more besides.  I find it bizarre that compilers didn&#39;t get really aggressive with type-access rules until after <code>restrict</code> rendered them largely unnecessary."}, {"owner": {"reputation": 2731, "user_id": 2801913, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ffbc065ffbc6e7597c5044f65c1ed40?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme", "link": "https://stackoverflow.com/users/2801913/graeme"}, "edited": false, "score": 0, "creation_date": 1539213432, "post_id": 52749738, "comment_id": 92424368, "body": "I can see your first point being an issue on an architecture that is word addressable. Writing to a <code>char</code> might require a read-modify-write which could be optimised to a write if the compiler thought it was all that was at that address. Very good answer though, nice background on CIS."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 1, "creation_date": 1539213440, "post_id": 52749738, "comment_id": 92424371, "body": "@X39: The approach of prefixing everything with a &quot;base type&quot; can work in some cases, but depending upon object sizes and alignments it may end up requiring that many structures include otherwise-unnecessary padding.  Such an approach may also run afoul of future notions of &quot;pointer provenance&quot; which are being explored for inclusion into the Standard.  Given <code>struct foo {struct bar b; int q; ...} f;</code> a compiler would benefit from knowing whether a call to <code>doSomething(&amp;f.b);</code> might affect <code>f.q</code>, and I think the people pushing pointer provenance would like to allow compilers to assume it won&#39;t."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 1, "creation_date": 1539213688, "post_id": 52749738, "comment_id": 92424422, "body": "@X39: If a programmer writes <code>doSomething((struct s1*)struct2Ptr);</code> a compiler which pays any attention to such things will have all of the information necessary to recognize that the recipient of the pointer might process it as a <code>struct s1</code> or a <code>struct s2</code>.  If a programmer writes <code>doSomething(&amp;struct2Ptr-&gt;header);</code> a compiler would have no information about whether <code>doSomething</code> will limit its actions to just the header, or might access all of .  I believe in giving compilers the information they need to optimize safely and effectively, and passing just the header pointer doesn&#39;t."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1539224378, "post_id": 52749738, "comment_id": 92426659, "body": "@X39: Another advantage of the Common Initial Sequence approach is that on implementations that support it, a function that expects <code>struct polygon { int count; struct vertex points[];};</code> can be passed a static or automatic duration object of type <code>struct triangle { int count; struct vertex points[3];};</code>, or <code>struct pentagon { int count; struct vertex points[5];};</code>, etc. provided that <code>count</code> is set to 3 or 5, respectively.  The header-struct approach won&#39;t support such variadic types that aren&#39;t allocated on the heap."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 5, "last_activity_date": 1539211207, "creation_date": 1539211207, "answer_id": 52749738, "question_id": 52749409, "link": "https://stackoverflow.com/questions/52749409/multiple-structs-same-fields-that-need-to-be-accessed-in-a-method/52749738#52749738", "title": "Multiple structs, same fields that need to be accessed in a method", "body": "<p>If all of the structures start with members of the same types, in the same order, corresponding members will have the same offsets.  Most compilers can be configured to allow a pointer of any structure type to be used to inspect members of the Common Initial Sequence of any other, but there are a few issues:</p>\n\n<ol>\n<li><p>On some unusual platforms, if an object is followed by padding bytes, an instruction that writes the object and padding bytes together (likely storing meaningless values in the latter) may be faster than instructions that write only the object.  If a member is followed by a padding byte in some structures, but by meaningful data in another, a write to that member using the type where it's followed by padding bytes may write overwrite the \"padding bytes\" with meaningless values, thus corrupting the values of the following members in the other structure types.  I am unaware of any architectures in current use where this would be an issue for any struct members other than bitfields, and I am unaware of any current implementations where this would be an issue even for those, but such possibilities could arise on some platforms, especially with bitfields.</p></li>\n<li><p>Given something like:</p>\n\n<pre><code>int readField1OfS1(struct s1 *p) { return p-&gt;field1; }\n\nstruct s2 *myStruct2Ptr;\n\nif (readField1ofS1((struct s1*)myStruct2Ptr)\n   ...\n</code></pre>\n\n<p>some compilers like gcc and clang won't reliably allow for the possibility that the value returned from the function might depend upon a value held by part of the Common Initial Sequence of an object of type <code>struct s2</code> at the time of the call unless optimizations are disabled (e.g. using the <code>-fno-strict-aliasing</code> option).  I would think that presence of a cast from <code>struct s2*</code> to <code>struct s1*</code> within the function call expression should allow a quality compiler to recognize that anything function might do something with an object of type <code>struct s1</code> might be done on a <code>struct s2</code>, but since the Standard doesn't explicitly require that, the authors of gcc and clang refuse to make any effort to reliably recognize such constructs even in straightforward cases like the above.</p></li>\n</ol>\n\n<p>Code which makes use of the Common Initial Sequence rule will work reliably on nearly any suitably-configured compiler, but some like <strong>gcc and clang must be specially configured using <code>-fno-strict-aliasing</code> option</strong>.  The ability to exploit Common Initial Sequence guarantees has been a well-established part of the language since 1974, and when the Standard was written, anyone familiar with the language would have understood that it was designed to allow for constructs like those above, which compilers should have no difficulty recognizing.  Since the authors of the Standard failed to explicitly require that the CIS guarantees be honored in useful fashion, however, the authors of clang and gcc have decided they'd rather claim that programs relying upon the decades-old CIS guarantees is \"broken\" than honor 40+ years of precedent.</p>\n"}], "owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 52749660, "answer_count": 3, "score": 0, "last_activity_date": 1539218274, "creation_date": 1539209143, "question_id": 52749409, "link": "https://stackoverflow.com/questions/52749409/multiple-structs-same-fields-that-need-to-be-accessed-in-a-method", "title": "Multiple structs, same fields that need to be accessed in a method", "body": "<p>I currently try to write some lil literal console game for fun in C.</p>\n\n<p>For that, i need to be able to print window-like structures in ... well ... C.</p>\n\n<p>I want to use a generic rendering method (lets call it <code>frame_render(...)</code>) to render all different \"ui elements\"</p>\n\n<p>The problem now is: how to solve this?</p>\n\n<p>given the scenario:</p>\n\n<pre><code>// Theoretical base\nstruct frame { int x; int y; int width; int height; }\nstruct button { int x; int y; int width; int height; ... }\nstruct whatever { int x; int y; int width; int height; ... }\n</code></pre>\n\n<p>how could i ensure that my <code>x</code>, <code>y</code>, <code>width</code> and <code>height</code> are always in the correct spot memory wise?\nis it enough to \"just\" put them in the same order at the very begining?</p>\n\n<p>also, how to design the method header to accept it?</p>\n"}, {"tags": ["c", "arrays", "vector", "dynamic"], "comments": [{"owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1539209528, "post_id": 52749394, "comment_id": 92423331, "body": "Where is <code>i</code> defined?"}, {"owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1539209621, "post_id": 52749394, "comment_id": 92423363, "body": "Also you&#39;re printing <code>short</code>s, use the <code>%h</code> conversion specifier."}, {"owner": {"reputation": 1, "user_id": 10486546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c19b8bded3607d6bdd9b42c927dd3ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/10486546/milena"}, "reply_to_user": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1539209951, "post_id": 52749394, "comment_id": 92423442, "body": "<code>i</code> is defined inside a <code>for (i = 0; i &lt; num_samples; i++)</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 4, "creation_date": 1539210913, "post_id": 52749394, "comment_id": 92423718, "body": "When <code>i == 0</code>, <code>sample_vector[i-1]</code> accesses outside the array, producing undefined behavior."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1539210997, "post_id": 52749394, "comment_id": 92423750, "body": "Unless you have some other problem, the code should work properly when <code>i &gt; 0</code>."}], "owner": {"reputation": 1, "user_id": 10486546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c19b8bded3607d6bdd9b42c927dd3ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Milena", "link": "https://stackoverflow.com/users/10486546/milena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539209049, "creation_date": 1539209049, "question_id": 52749394, "link": "https://stackoverflow.com/questions/52749394/c-access-to-dynamic-array", "title": "C: access to dynamic array", "body": "<p>I'm trying to print a variable in my dynamic allocated array, but it returns a wrong value.</p>\n\n<p>This the the array declaration:\n<code>int16_t *sample_vector = malloc (num_samples*sizeof(int16_t));</code></p>\n\n<p>And the print attempt</p>\n\n<pre><code>sample_vector[i] =  data_buffer[0] | \n               (data_buffer[1]&lt;&lt;8) | \n               (data_buffer[2]&lt;&lt;16)| \n               (data_buffer[3]&lt;&lt;24);\n\nprintf (\"Sample vector [%ld]: %d\\n\", i, sample_vector [i]); //this works fine, it prints shows the real sample value\n\nprintf (\"Sample vector [%ld]: %d\\n\", (i-1), sample_vector [i-1]); //this doesn't work, it prints garbage\n</code></pre>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208553, "post_id": 52749234, "comment_id": 92423015, "body": "Stop using <code>scanf()</code>. Use <code>fgets()</code> to read a whole line, then use <code>sscanf()</code> to parse it."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1539208805, "creation_date": 1539208805, "answer_id": 52749360, "question_id": 52749234, "link": "https://stackoverflow.com/questions/52749234/getting-one-loop-for-multiple-characters-using-while/52749360#52749360", "title": "Getting one loop for multiple characters using &quot;while&quot;", "body": "<p>The return value of <code>scanf</code> is the number of elements parsed successfully; you can use this to repeat until something has been read successfully:</p>\n\n<pre><code>double nr=0;\nwhile (!feof(stdin) &amp;&amp; scanf(\"%lf\",&amp;nr)!=1) {\n  printf(\"not a number; try again.\");\n  while ( (c = getchar()) != '\\n' &amp;&amp; c != EOF ) { }\n}\n</code></pre>\n\n<p>Note that you have to take \"invalid\" input out of the buffer; otherwise, <code>scanf</code> would fail again and again.</p>\n"}], "owner": {"reputation": 1, "user_id": 10486329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6670b010d2580b89edf699f77bc3ef98?s=128&d=identicon&r=PG&f=1", "display_name": "Freinaugh", "link": "https://stackoverflow.com/users/10486329/freinaugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539208805, "creation_date": 1539208022, "last_edit_date": 1539208559, "question_id": 52749234, "link": "https://stackoverflow.com/questions/52749234/getting-one-loop-for-multiple-characters-using-while", "title": "Getting one loop for multiple characters using &quot;while&quot;", "body": "<p>I'm new on Stackoverflow and I'm very, completely new to coding. Just messing around with C. Here's what I'm trying to do here (don't take this program scientifically accurate), this is a program that calculates for special relativity equations of length, mass and time. I have 3 questions actually:</p>\n\n<p>When I try to put other characters in the y/n questions, everything works but for example if I enter \"sfkl\", the warning comes up 4 times because I entered 4 characters. And if I put space, it doesn't even give a warning until I put another character and then enter. Can I make it give 1 warning no matter how many characters I enter in one line (including space)?</p>\n\n<p>My other question is, I kind of prevented inputting anything other than y/n but for the double value inputs (mass, length and time), I can't figure out a similar system (asking for a double value over and over again). Can you suggest me a solution?</p>\n\n<p>And my third question is, when doing \"scanf_s(\" %c\", &amp;answer);\", if I don't put a space before \"%c\", it doesn't work properly. It registers an enter and asks me to enter y/n only. Why need a space before that?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#define LIGHT 299792458\n\nint input();\n\nint main()\n{\n    printf(\"\\n\\n\\tThis program calculates how length, mass and time changes with respect to your speed.\\n\\n\\tThe values you enter are the quantites which are observed by a stationary observer and the output values are the quantites observed by the person in a vehicle which is moving at the speed that you enter.\");\n\n    input();\n\n    return 0;\n}\n\nint input()\n    {\n        double length, mass, utime, speed;\n        char answer;\n\n        do\n        {\n            printf(\"\\n\\n     **************************************************\");\n\n            printf(\"\\n\\n\\tPlease enter a quantity of length: \");\n            scanf_s(\"%lf\", &amp;length);\n\n            printf(\"\\n\\tPlease enter a quantity of mass: \");\n            scanf_s(\"%lf\", &amp;mass);\n\n            printf(\"\\n\\tPlease enter a quantity of time: \");\n            scanf_s(\"%lf\", &amp;utime);\n\n            printf(\"\\n\\tNow enter the speed of the vehicle (m/s): \");\n            scanf_s(\"%lf\", &amp;speed);\n\n            while (speed &gt; LIGHT)\n            {\n                printf(\"\\n\\n\\tNothing can surpass the speed of light in the universe. Enter a smaller value: \");\n                scanf_s(\"%lf\", &amp;speed);\n            }\n\n            double newlength = length * (sqrt(1 - pow(speed, 2) / pow(LIGHT, 2)));\n            double newmass = mass / (sqrt(1 - pow(speed, 2) / pow(LIGHT, 2)));\n            double newutime = utime / (sqrt(1 - pow(speed, 2) / pow(LIGHT, 2)));\n\n            if (speed == LIGHT)\n            {               \n                printf(\"\\n\\n     **************************************************\");\n\n                printf(\"\\n\\n\\n\\tIt's technically impossible to reach the speed of light if you have mass but here are the mathematical limit results:\\n\\n\\t*The new length quantity is 0\\n\\n\\t*The new mass quantity is infinity\\n\\n\\t*The new time quantity is infinity\\n\\n\\n\\t- Time successfully dilated -\\n\\n\");\n\n                printf(\"\\n\\tDo you want to start over? (y/n): \");\n                scanf_s(\" %c\", &amp;answer);\n\n                if (answer == 'n')\n                {\n                    return 0;\n                }\n                else if (answer == 'y')\n                {\n                    continue;\n                }\n                else\n                {\n                    while (answer != 'y' &amp;&amp; answer != 'n')\n                    {\n                        printf(\"\\n\\tPlease only enter 'y' or 'n': \");\n                        scanf_s(\" %c\", &amp;answer);\n                    }\n                }\n            }\n\n\n            if (speed &lt; LIGHT)\n            {\n                printf(\"\\n\\n     **************************************************\");\n\n                printf(\"\\n\\n\\n\\t*The new length quantity is %.20lf\\n\\n\\t*The new mass quantity is %.20lf\\n\\n\\t*The new time quantity is %.20lf\\n\\n\\n\\t- Time successfully dilated -\\n\\n\", newlength, newmass, newutime);\n\n                printf(\"\\n\\tDo you want to start over? (y/n): \");\n                scanf_s(\" %c\", &amp;answer);\n\n                if (answer == 'n')\n                {\n                    return 0;\n                }\n                else if (answer == 'y')\n                {\n                    continue;\n                }\n                else\n                {\n                    while (answer != 'y' &amp;&amp; answer != 'n')\n                    {\n                        printf(\"\\n\\tPlease only enter 'y' or 'n': \");\n                        scanf_s(\" %c\", &amp;answer);\n                    }\n                }\n            }\n        }\n        while (answer == 'y');\n\n        return 0;\n    }\n</code></pre>\n\n<p>Thank you, have a good day</p>\n"}, {"tags": ["c", "windows", "winapi", "x86", "windows-7"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539208131, "post_id": 52749224, "comment_id": 92422878, "body": "It all sounds rather pointless. Why bother with affinities and priorities at all. I mean, you aren&#39;t running any other processes on this machine I presume."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1539209575, "post_id": 52749224, "comment_id": 92423355, "body": "On this PC its main purpose is run this single program, but there are other programs that also can run (text editor/log stuff/other stuff).  Even if it were the only user process its not <i>really</i> the only process because windows kernal threads are running, occasionally stealing time slices from my TIME_CRITICAL thread."}, {"owner": {"reputation": 713, "user_id": 4880288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OycAQxKvySg/AAAAAAAAAAI/AAAAAAAAEQ0/nM_F7pKQCgQ/photo.jpg?sz=128", "display_name": "mgarey", "link": "https://stackoverflow.com/users/4880288/mgarey"}, "edited": false, "score": 0, "creation_date": 1539211785, "post_id": 52749224, "comment_id": 92423945, "body": "I once tried to write a time-critical application on Windows. After awhile I gave up and moved to Linux. However, I didn&#39;t know about processor affinity at the time. I think using processor affinity is the correct approach if you have to stick with Windows (I&#39;d still set the process priority high)."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1539217272, "post_id": 52749224, "comment_id": 92425172, "body": "The kernel &quot;things&quot; that can steal time from a processors are: APC, DPC, Kernel Threads, ISR. With <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/interrupt-affinity-and-priority\" rel=\"nofollow noreferrer\">IRQ Affinity</a> you should tick off ISR and DPC (most of it). Kernel APC should be rare if you don&#39;t do overlapped IO and no other threads are scheduled on that core. Kernel threads are not under the user control but are infrequent. In general, if you don&#39;t schedule other thread on a core and off-load the IRQs from it you should receive very little OS jittering."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1539217454, "post_id": 52749224, "comment_id": 92425209, "body": "It is said that Windows 8+ is also dynamic ticking/tickless like Linux. I would give IRQ affinity a try and see how much noise remains. BTW, you can query the number of cores but maybe it&#39;s easier to let it a config parameter."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1539222511, "post_id": 52749224, "comment_id": 92426254, "body": "On Linux some systems assign the logical threads of a physical core in 1a 1b 2a 2b order, while for others it&#39;s 1a 2a 1b 2b.  If Windows is the same, you&#39;ll need to be careful to not pin multiple threads to logical cores of the same physical CPU, if that&#39;s not what you want."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539236418, "post_id": 52749224, "comment_id": 92429460, "body": "If you do run other processes then you can&#39;t be sure this will work out. Those process could affinities to the same processors that you choose. Reducing the number of processors that can be used to run your process doesn&#39;t sound like a way to make it more likely to be run. It sounds like you&#39;ll make it less likely to run. Perhaps you should consider a real time OS."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1539292444, "post_id": 52749224, "comment_id": 92460727, "body": "@MargaretBloom Thanks Margaret, this TIME_CRITICAL thread is actually for an ISR that waits for an IRQ generated from a PCI card.  I am trying to do something real time on windows, which i know is hopeless but  atleast i can try to make it perform as best as possible.  I&#39;ll set the relevant IRQ to the core im reserving, and to a separate core, and profile both."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539293721, "post_id": 52749224, "comment_id": 92461190, "body": "@DavidHeffernan I wish i could use a real time OS but that decision it out of my hands.  As a back up plan, I plan on using a small PIC to do essentially what this attempt at a windows ISR is doing, at a later date when the small amount of timing misses i currently get really count."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539313984, "post_id": 52749224, "comment_id": 92465510, "body": "And you know all this and you still intend to run other user processes?"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539321276, "post_id": 52749224, "comment_id": 92467223, "body": "@DavidHeffernan I was under the impression that if i have a deadlocked thread with base priority 31 it would hog the core, prevent all other user processes from being allocated time slices on that core.  Is that not the case?  I appreciate your insight into this.  These PCs are used by other teams that run other things for data collection on certain external HW, like 1553 bus monitoring programs for example.  I can not prevent them from doing that."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539321921, "post_id": 52749224, "comment_id": 92467432, "body": "Kinda pointless to attempt real time if you let other processes have their way. Surely you can see that? A deadlocked thread doesn&#39;t consume CPU, it is not scheduled at all to run because it is waiting for a sync object. Threads can&#39;t run when they are waiting."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1539322402, "post_id": 52749224, "comment_id": 92467614, "body": "I understand that other processes should not &quot;have their way&quot;, thats why I&#39;m trying to reserve a core with these windows API functions.  I was lead to believe that manipulating the base priority would reserve the core for my thread.  It basically just waits for an IRQ from the PCI card, then calls the ISR, in a while loop.  The function to wait for the IRQ was provided by the company that makes the PCI card.  The attempt at real time was to reduce the number of timing errors for a signal going out to external HW.  If, for example, I have 3 misses in 24 hours i consider that pretty good."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539322695, "post_id": 52749224, "comment_id": 92467718, "body": "No, that&#39;s not how it works. Just because you say that a thread can only run on a specific processor does not in any way prevent another thread being scheduled to run there also."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1539322815, "post_id": 52749224, "comment_id": 92467759, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/181723/discussion-between-bwebb-and-david-heffernan\">continue this discussion in chat</a>. NM i cant use chat apparently.  I understand that setting the affinity itself is not an improvement, but if the base priority of the thread is higher than any other thread/process on that core that i thought it would &quot;starve&quot; other threads/processes, effectively blocking out user threads.  If i am way off base can you please link me some relevant info?  I am new to windows API.  I appreciate your help David."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539377342, "post_id": 52749224, "comment_id": 92494975, "body": "I mean, if you want to do this, then clearly no amount of reasoning is going to stop you. You&#39;ve already decided to do this. Difficult to know what more to say."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1539378568, "post_id": 52749224, "comment_id": 92495440, "body": "@DavidHeffernan Well thank you for your contributions to my question.  I did not mean to come off negatively towards you if thats how you read my responses.  I dont have much experience with windows API and i still dont see a reason why my attempt is not valid at preventing user-threads from using the dedicated core im trying to reserve.  I know there are things i cant prevent from running on it but with these windows API functions i figured it would atleast block user level stuff.  This is not for an application that will be distributed to external customers, if that clarifies my situation."}], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539210158, "creation_date": 1539207977, "last_edit_date": 1539210158, "question_id": 52749224, "link": "https://stackoverflow.com/questions/52749224/windows-7-processor-interrogation", "title": "windows 7 processor interrogation", "body": "<p>I have a PC with 24 cores.  I have an application that needs to dedicate a thread to one of those cores, and the process itself to a few of those cores.  The affinity and priorities are now hard-coded, I would like to programmatically determine what set of cores my application should set its affinity to.</p>\n\n<p>I have read to stay away from core 0, I am currently using the last 8 cores on the first CPU for the process and the 12th core for the thread I want to run.  Here is sample code which may not be 100% accurate with the parameters.</p>\n\n<pre><code>SetProirityClass(getCurrentProcess(),REAL_TIME_PRIORITY_CLASS);\nSetProcessAffinityMask(getCurrentProcess(),0xFF0);\nCreatThread(myThread, 0, entryPoint, NUll, 0, 0);//all 0 params besides handle and entry\nSetThreadPriorityClass(myThread, TIME_CRITICAL);\nSetThreadAffinityMask(myThread, 0x1 &lt;&lt; 11);\n</code></pre>\n\n<p>I know that with elevated priorities (even with base priority 31) there is no way to dedicate a core to an application (Please correct me if I am wrong here since this is exactly what I want to do, non-programmatical solutions would be fine if I could do that).  That being said, the OS itself runs \"mostly\" on a core or a couple of cores.  Is it randomly determined on boot?  Can I interrogate available cores to programmatically determine which set of cores my process and <code>TIME_CRITICAL</code> thread should be running on?</p>\n\n<p>Is there any way to prevent the kernel threads from stealing time slices of my <code>TIME_CRITICAL</code> thread?</p>\n\n<p>I understand windows is not real time but I'm doing the best with what I have.  The solution needs to apply to win 7 but if it is also supported under XP that would be great.</p>\n"}, {"tags": ["c", "libc", "rlwrap"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539207488, "post_id": 52749093, "comment_id": 92422688, "body": "An ACL \u2014  Access Control List?  Even if the user-group-other permissions say &quot;user X as a member of group Y cannot create a file here&quot;, and ACL may override that.  Another possible problem could be an NFS auto-mounted home directory, though by the time someone&#39;s logged in, that usually is no longer a problem."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539207635, "post_id": 52749093, "comment_id": 92422729, "body": "Yes, I was thinking about that also. But can an ACL make it impossible for my program to create a file, while still allowing <code>touch</code> to do the same?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539207863, "post_id": 52749093, "comment_id": 92422794, "body": "Given that this is in the home directory of USER, it probably isn&#39;t an ACL issue.  It is surprising.  What diagnostics have you got available? Have you analyzed the permissions on <code>&#47;</code>, <code>&#47;home</code>, <code>&#47;home&#47;USER</code>? Have you double-checked the current permissions on the executable, as opposed to the ones you expect to be on it? If there is a SUID or SGID bit lurking around, <code>access()</code> can give the wrong answer. Is there a chance that the primary group of the user is Group1, but the home directory belongs to Group2? It shouldn&#39;t be an issue if <code>USER</code> owns their home directory, but that&#39;s why you check."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539208012, "post_id": 52749093, "comment_id": 92422842, "body": "As you can tell, I have questions but no answer.  But I&#39;m not sure that anyone can provide a useful answer with the information available as yet.  The issue is going to depend on the platform, the file system(s), the permissions on programs and directories.  Is there any chance you&#39;re looking in the wrong place?  You look in (potentially) different locations if someone uses <code>~&#47;xxx</code> vs <code>~USER&#47;xxx</code>. (On my work machine, <code>~jleffler</code> maps to <code>&#47;u&#47;jleffler</code> and <code>~</code> maps to <code>&#47;work4&#47;jleffler</code> \u2014 as required by POSIX when I set <code>HOME=&#47;work4&#47;jleffler</code>.)"}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539208202, "post_id": 52749093, "comment_id": 92422903, "body": "Many of those questions have already been asked in the discussion <a href=\"https://github.com/hanslub42/rlwrap/issues/90\" rel=\"nofollow noreferrer\">here</a>. I&#39;m still intrigued by the <i>probably</i> in the manpage text. What is the author hinting at?"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1539208214, "post_id": 52749093, "comment_id": 92422905, "body": "How are you creating the file? Where is that error message coming from, it does not seem to be standard?  <code>EACCES</code> can be raised for a number reasons, see <code>man open</code>."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1539208370, "post_id": 52749093, "comment_id": 92422955, "body": "I&#39;m not creating any file yet. <code>access(homedir, W_OK)</code> returns -1, with <code>errno == EACCES</code>, while the user can touch any file in <code>homedir</code>. That is what I don&#39;t understand."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1539208395, "post_id": 52749093, "comment_id": 92422962, "body": "The <i>probably</i> could mean that the create file might still fail for other reasons, for example if the inode table is full."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1539208452, "post_id": 52749093, "comment_id": 92422983, "body": "Sorry, I misunderstood, I thought the creation was failing and the <code>access</code> working.  Check there is execute (search) access on all the directories in the path."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539208575, "post_id": 52749093, "comment_id": 92423021, "body": "I note that the claimed output line <code>drwxr-xr-x  1 &#47;home&#47;REDACTED_USER              users 3.0K Sep 20 10:41 REDACTED_USER</code> is a very curious output from <code>ls</code>; the file name is in the wrong place, and the user/group are missing."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539209276, "post_id": 52749093, "comment_id": 92423258, "body": "I can&#39;t see what&#39;s wrong.  I wonder if <code>&#47;home</code> is a circuitous symlink?  But I&#39;m still not sure whether that explains what is reported.  I also wonder why you get ENOENT rather than EACCES when you try to <code>access()</code> the files <code>&#47;home&#47;USER&#47;.terminfo</code> and <code>&#47;home&#47;USER&#47;.sqlhosts_plus</code> \u2014 I think I&#39;d expect EACCES if the home directory isn&#39;t accessible as indicated by accessing that.  Very peculiar."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1539209377, "post_id": 52749093, "comment_id": 92423285, "body": "You could show us the strace-output for your process, this might shed some light on this (actually, the line with the access-call should suffice)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1539209509, "post_id": 52749093, "comment_id": 92423322, "body": "@Ctx: in the link <a href=\"https://github.com/hanslub42/rlwrap/issues/90\" rel=\"nofollow noreferrer\"><b><code>here</code></b></a> in the <a href=\"https://stackoverflow.com/questions/52749093/directory-not-writable-according-to-access-user-still-able-to-create-files-in?noredirect=1#comment92422903_52749093\">comment</a> to me, there is the <code>strace</code> output."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1539209583, "post_id": 52749093, "comment_id": 92423358, "body": "@Ctx: see the <a href=\"https://github.com/hanslub42/rlwrap/issues/90\" rel=\"nofollow noreferrer\">bug report</a>. The <code>strace</code> output doesn&#39;t give any more information than <code>access(homedir, W_OK)</code> failing with <code>errno == EACCES</code>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1539209646, "post_id": 52749093, "comment_id": 92423371, "body": "@HansLub ah, ok. Btw. the &quot;probably&quot; means, that it is filesystem dependent; on some filesystems, you really can open the directory like a file for writing"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539209664, "post_id": 52749093, "comment_id": 92423377, "body": "Near the top of the <code>strace</code> output, there&#39;s a successful open and read of <code>&#47;etc&#47;ld.so.cache</code>.  Is that normal?  Could that account for any of the trouble if it contains something abnormal?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539209707, "post_id": 52749093, "comment_id": 92423392, "body": "@JonathanLeffler normal for linux, just speeds up finding the libraries for dynamic linking"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1539209920, "post_id": 52749093, "comment_id": 92423432, "body": "@Ctx: Thanks; I wasn&#39;t sure \u2014 it could have been harmless (like not finding <code>&#47;etc&#47;ld.so.preload</code> is harmless, but finding it might not be), or not.  It was probably worth the check."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539209995, "post_id": 52749093, "comment_id": 92423453, "body": "I&#39;m completely out of ideas in the absence of the output from <code>ls -ld &#47; &#47;home &#47;home&#47;USER; ls -la &#47;home&#47;USER</code>.  It couldn&#39;t be something weird like there&#39;s a named (Unix-domain) socket <code>.sqlplus_history</code> or some other eccentric file type?  I still don&#39;t have any good, plausible ideas; this is clutching at straws, but I suspect you&#39;re close to that stage as well.  Is there any chance that some weird file system like AFS is in play?"}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539210166, "post_id": 52749093, "comment_id": 92423499, "body": "@Jonathan: changing the history filename to something else doesn&#39;t make a difference (<i>except</i> when specifying a different directory: creating the file in <code>&#47;tmp</code> works just fine). I&#39;m also out of ideas, that&#39;s why I post here. Thanks a lot for your suggestions anyway!!"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1539210242, "post_id": 52749093, "comment_id": 92423518, "body": "The original poster at github seems to have &quot;redacted&quot; a lot of things. I suspect, that he introduced a inconsistency there."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1539216769, "post_id": 52749093, "comment_id": 92425055, "body": "I&#39;d suggest asking the bug reporter whether their home directory is FUSE mounted. Of course, they might not know but someone probably does. It could well be a buggy or non-existent access implementation in the FUSEd virtual filesystem. But honestly, fix your code. Don&#39;t test before use; it&#39;s a bad idiom and it was bound to get you into trouble sooner or later."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1539239667, "post_id": 52749093, "comment_id": 92430749, "body": "@rci: If I wouldn&#39;t test, <code>readline</code> would only try to create the history file (and fail) when the user closes the session. She might have appreciated the error message before typing in all those obscure commands and then losing them..."}, {"owner": {"reputation": 6904, "user_id": 60462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/64fd87fd2c140ee93f638a624bcc97c9?s=128&d=identicon&r=PG", "display_name": "Volker Stolz", "link": "https://stackoverflow.com/users/60462/volker-stolz"}, "edited": false, "score": 1, "creation_date": 1539241288, "post_id": 52749093, "comment_id": 92431568, "body": "Wild guess: something like AppArmor/SELinux getting in the way? (<code>touch</code> being whitelisted, <code>rlwrap</code> not?)"}], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1539241205, "creation_date": 1539207198, "last_edit_date": 1539241205, "question_id": 52749093, "link": "https://stackoverflow.com/questions/52749093/directory-not-writable-according-to-access-user-still-able-to-create-files-in", "title": "Directory not writable according to access(), user still able to create files in it", "body": "<p>I received a <a href=\"https://github.com/hanslub42/rlwrap/issues/90\" rel=\"nofollow noreferrer\">bug report</a>\nthat has me scratching my head.  In my program, I test the\nwritability of a directory (which is the user's home directory by\ndefault) before having <code>readline</code> collect history and write it to a file in that directory at program exit.</p>\n\n<p>Here is the problematic code:</p>\n\n<pre><code>if (access(dirname, W_OK) != 0)\n  complain(\"cannot create %s in %s\", filename, dirname, errno);\nelse {\n  use_readline_for_stuff();\n  write_history(\"%s/%s\", dirname, filename);\n  exit(0);\n}\n</code></pre>\n\n<p>(This is pseudo-C, of course. The real code is <a href=\"https://github.com/hanslub42/rlwrap/blob/8fd1b6b84529b11ba99eb471b2a780666446ffe9/src/main.c#L614-L623\" rel=\"nofollow noreferrer\">here</a>)</p>\n\n<p>The user (let's call her <code>USER</code>) reports getting an error message \"cannot create xxx in\n/home/USER: permission denied\", that disappears after manually creating the file with <code>USER@host &gt; touch /home/USER/xxx</code>.</p>\n\n<p>I would expect an unwritable home directory to lead to all kind of\nproblems, but the user can even  simply <code>touch</code> a file in that directory. </p>\n\n<p>The program doesn't run suid, USER owns her home directory (and\nclearly can create files in it). My program is apparently the only\nprogram that displays this kind of problem. It has been fairly widely used\nfor years, and this is the first time this bug gets reported</p>\n\n<p>The Linux manpage for <code>access (2)</code> says</p>\n\n<blockquote>\n  <p>if a directory is found to be writable, it probably  means  that\n  files  can  be  created  in the directory</p>\n</blockquote>\n\n<p>Why <em>probably</em>? Why (and when) not <em>always</em> (apart from a race condition like someone changing permissions just after the <code>access()</code> call, full inode tables or hitting user limits) all of which don't seem to be the problem here - especially since the <code>access()</code> call fails, and <code>touch xxx</code> succeeds.</p>\n"}, {"tags": ["c", "mpi", "openmpi", "bucket-sort"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 4, "creation_date": 1539209204, "post_id": 52749059, "comment_id": 92423231, "body": "Please format (e.g. indent) your code correctly ! SO is not a free debugging service, so please trim your program into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and share your efforts."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10159236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EnvtS.jpg?s=128&g=1", "display_name": "kukiduwa", "link": "https://stackoverflow.com/users/10159236/kukiduwa"}, "edited": false, "score": 0, "creation_date": 1547625896, "post_id": 52797100, "comment_id": 95251106, "body": "Thanks a lot for your help, I have submitted the work and decided to change the whole thing."}], "tags": [], "owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "is_accepted": false, "score": 0, "last_activity_date": 1539463038, "creation_date": 1539463038, "answer_id": 52797100, "question_id": 52749059, "link": "https://stackoverflow.com/questions/52749059/mpi-err-rank-invalid-rank-with-cluster/52797100#52797100", "title": "MPI_ERR_RANK: invalid rank with cluster", "body": "<p>they are quite a few mistakes in your code. Hope due date is monday\u2026</p>\n\n<p><strong>First :</strong></p>\n\n<pre><code>int main(int argc, char *argv[])\n</code></pre>\n\n<p>will work better than <code>int main(int argc, char *argv[])</code></p>\n\n<p><strong>Second</strong> :</p>\n\n<p>Process 0 is the one designated to read the number of elements to be generated.<br>\nThen it must brodacast it to all other process otherwise the other processes will have an undefined number in variable <code>num</code>, right ?</p>\n\n<p>Therefore</p>\n\n<pre><code>if (rank == 0)\n{\n        printf(\"Enter number of element to be sort: \");\n        fflush(stdout);\n        scanf(\"%d\", &amp;num);\n        for (i = 0; i &lt; num; i++) //random num elements\n    {\n        array[i] = rand();\n    }\n        n = num;\n        printf(\"\\nBefore Sorting (%i)\\n\", n);\n    for (j = 0; j &lt; n; j++)\n    {\n        printf(\"%d \", array[j]);\n    }\n        fflush(stdout);\n}\nMPI_Bcast(&amp;n, 1, MPI_INT, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p><strong>Third :</strong></p>\n\n<p>Avoid reusing the value involved in loop. I understand that after</p>\n\n<pre><code>for (j = 0; j &lt; n; j++)\n{\n    printf(\"%d \", array[j]);\n}\n</code></pre>\n\n<p>you have</p>\n\n<pre><code>j=n\n</code></pre>\n\n<p>but it is not very clear\u2026</p>\n\n<p><strong>Fourth</strong> :</p>\n\n<p>First argument to MPI_Send or receive is the adress of the first element in the array. So passing </p>\n\n<pre><code>MPI_Send(&amp;array[j], j, MPI_INT, 1, msgtag, MPI_COMM_WORLD);\n</code></pre>\n\n<p>and since <code>j=n</code> (see remark above) I guess you won't get what you desire.</p>\n\n<p>What you need is </p>\n\n<pre><code>MPI_Send(&amp;array[0], n, MPI_INT, 1, msgtag, MPI_COMM_WORLD);\n</code></pre>\n\n<p><strong>Fifth</strong> : </p>\n\n<p><code>MPI_Barrier</code> is your friend. Outputing is a critical operation therefore before an output operation you can (optional) make sure that all processes have reached this point.</p>\n\n<pre><code>if (rank == 2)\n{\n    MPI_Recv(&amp;array, n, MPI_INT, 1, msgtag, MPI_COMM_WORLD, &amp;stat);\n    printf(\"\\nAfter Sorting\\n\");\n    for (k = 0; k &lt; i; k++)\n    {\n        printf(\"%d \", array[k]);\n    }\n}\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>if (rank == 2)\n{\n    MPI_Recv(&amp;(array[0]), n, MPI_INT, 1, msgtag, MPI_COMM_WORLD, &amp;stat);\n}\nMPI_Barrier(MPI_COMM_WORLD);\nif (rank == 2)\n{\n    printf(\"\\nAfter Sorting\\n\");\n    for (k = 0; k &lt; n; k++)\n    {\n        printf(\"%d \", array[k]);\n    }\n}\n    MPI_Barrier(MPI_COMM_WORLD);\n</code></pre>\n\n<p><strong>Conclusion :</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include \"mpi.h\"\n\nstruct bucket\n{\n    int count;\n    int* value;\n};\n\nint compareIntegers(const void* first, const void* second)\n{\n    int x = *((int*)first), y = *((int*)second);\n    if (x == y)\n    {\n        return 0;\n    }\n    else if (x &lt; y)\n    {\n        return -1;\n    }\n    else\n    {\n        return 1;\n    }\n}\n\nvoid bucketSort(int array[], int n)\n{\n    struct bucket buckets[3];\n    int i, j, k;\n    for (i = 0; i &lt; 3; i++)\n    {\n        buckets[i].count = 0;\n        buckets[i].value = (int*)malloc(sizeof(int) * n);\n    }\n\n    for (i = 0; i &lt; n; i++)\n    {\n        if (array[i] &lt; 0)\n        {\n            buckets[0].value[buckets[0].count++] = array[i];\n        }\n        else if (array[i] &gt; 10)\n        {\n            buckets[2].value[buckets[2].count++] = array[i];\n        }\n        else\n        {\n            buckets[1].value[buckets[1].count++] = array[i];\n        }\n    }\n    for (k = 0, i = 0; i &lt; 3; i++)\n    {\n        // now using quicksort to sort the elements of buckets\n        qsort(buckets[i].value, buckets[i].count, sizeof(int), &amp;compareIntegers);\n        for (j = 0; j &lt; buckets[i].count; j++)\n        {\n            array[k + j] = buckets[i].value[j];\n        }\n        k += buckets[i].count;\n        free(buckets[i].value);\n    }\n\n}\n\nint main(int argc, char *argv[])\n{\n    int array[1000000];\n    int i = 0, j, k, n;\n    int num;\n    //for MPI\n    int numProc, rank;\n    char procName[MPI_MAX_PROCESSOR_NAME];\n    int nameLen;\n    int chunksize;\n    double start, end;\n    int msgtag;\n\n    //MPI\n    MPI_Status stat;\n    start = MPI_Wtime();    //timer start\n    MPI_Init(&amp;argc, &amp;argv);\n\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank); //process rank ,comm_world = communication of the process\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;numProc); //number of process\n    msgtag = 1234;\n\n    if (rank == 0)\n    {\n        printf(\"Enter number of element to be sort: \");\n        fflush(stdout);\n        scanf(\"%d\", &amp;num);\n        for (i = 0; i &lt; num; i++) //random num elements\n        {\n            array[i] = rand();\n        }\n        n = num;\n        printf(\"\\nBefore Sorting\\n\");\n        for (j = 0; j &lt; n; j++)\n        {\n            printf(\"%d \", array[j]);\n        }\n        fflush(stdout);\n    }\n    MPI_Bcast(&amp;n, 1, MPI_INT, 0, MPI_COMM_WORLD);\n    if (rank == 0)\n    {\n        MPI_Send(&amp;(array[0]), n, MPI_INT, 1, msgtag, MPI_COMM_WORLD);\n    }\n    if (rank == 1)\n    {\n        MPI_Recv(&amp;(array[0]), n, MPI_INT, 0, msgtag, MPI_COMM_WORLD, &amp;stat);\n        bucketSort(array, n);\n        MPI_Send(&amp;(array[0]), n, MPI_INT, 2, msgtag, MPI_COMM_WORLD);\n    }\n    if (rank == 2)\n    {\n        MPI_Recv(&amp;(array[0]), n, MPI_INT, 1, msgtag, MPI_COMM_WORLD, &amp;stat);\n    }\n    MPI_Barrier(MPI_COMM_WORLD);\n    if (rank == 2)\n    {\n        printf(\"\\nAfter Sorting\\n\");\n        for (k = 0; k &lt; n; k++)\n        {\n            printf(\"%d \", array[k]);\n        }\n    }\n    //MPI END\n    MPI_Barrier(MPI_COMM_WORLD);\n    MPI_Finalize();\n    end = MPI_Wtime();  // timer end   \n    double time_spent = end - start;\n    printf(\"\\ntime used for this program was %f Sec.\", time_spent);\n\n    return 0;\n}\n</code></pre>\n\n<p>running</p>\n\n<pre><code>mpirun -np 3 test_mpi.exe\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>Enter number of element to be sort: 10\n\nBefore Sorting\n1804289383 846930886 1681692777 1714636915 1957747793 424238335 719885386 1649760492 596516649 1189641421\nAfter Sorting\n\n424238335 596516649 719885386 846930886 1189641421 1649760492 1681692777 1714636915 1804289383 1957747793\ntime used for this program was 2.271976 Sec.time used for this program was 2.281183 Sec.\ntime used for this program was 2.277746 Sec.\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10159236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EnvtS.jpg?s=128&g=1", "display_name": "kukiduwa", "link": "https://stackoverflow.com/users/10159236/kukiduwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539476232, "creation_date": 1539206977, "last_edit_date": 1539476232, "question_id": 52749059, "link": "https://stackoverflow.com/questions/52749059/mpi-err-rank-invalid-rank-with-cluster", "title": "MPI_ERR_RANK: invalid rank with cluster", "body": "<p>I'm doing a project for a class and I have used the code for sequential Bucket sort from the internet and I'm trying to make it be a parallel version using OpenMPI.\nThis code will be running on the cluster system. When I test it, it is giving me the following error:</p>\n\n<blockquote>\n  <p>\"[cluster:5379] <strong>* An error occurred in MPI_Send [cluster:5379] <em></strong>\n  on communicator MPI_COMM_WORLD [cluster:5379] <strong></em> MPI_ERR_RANK:\n  invalid rank [cluster:5379] *</strong> MPI_ERRORS_ARE_FATAL: your MPI job\n  will now abort \" </p>\n</blockquote>\n\n<p>Can anybody please suggest me on how to fix it? </p>\n\n<p>ps. I'm quite bad at coding, so I might not be able to answers some question for this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include \"mpi.h\"\n\nstruct bucket\n{\n    int count;\n    int* value;\n};\n\nint compareIntegers(const void* first, const void* second)\n{\n    int x = *((int*)first), y = *((int*)second);\n    if (x == y)\n    {\n        return 0;\n    }\n    else if (x &lt; y)\n    {\n        return -1;\n    }\n    else\n    {\n        return 1;\n    }\n}\n\nvoid bucketSort(int array[], int n)\n{\n    struct bucket buckets[3];\n    int i, j, k;\n    for (i = 0; i &lt; 3; i++)\n    {\n        buckets[i].count = 0;\n        buckets[i].value = (int*)malloc(sizeof(int) * n);\n    }\n\n    for (i = 0; i &lt; n; i++)\n    {\n        if (array[i] &lt; 0)\n        {\n            buckets[0].value[buckets[0].count++] = array[i];\n        }\n        else if (array[i] &gt; 10)\n        {\n            buckets[2].value[buckets[2].count++] = array[i];\n        }\n        else\n        {\n            buckets[1].value[buckets[1].count++] = array[i];\n        }\n    }\n    for (k = 0, i = 0; i &lt; 3; i++)\n    {\n        // now using quicksort to sort the elements of buckets\n        qsort(buckets[i].value, buckets[i].count, sizeof(int), &amp;compareIntegers);\n        for (j = 0; j &lt; buckets[i].count; j++)\n        {\n            array[k + j] = buckets[i].value[j];\n        }\n        k += buckets[i].count;\n        free(buckets[i].value);\n    }\n\n}\n\nint main(char *argv[], int argc)\n{\n    int array[1000000];\n    int i = 0, j, k, n;\n    int num;\n    //for MPI\n    int numProc, rank;\n    char procName[MPI_MAX_PROCESSOR_NAME];\n    int nameLen;\n    int chunksize;\n    double start, end;\n    int msgtag;\n\n    //MPI\n    MPI_Status stat;\n    start = MPI_Wtime();    //timer start\n    MPI_Init(&amp;argc, &amp;argv);\n\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank); //process rank ,comm_world = communication of the process\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;numProc); //number of process\n    msgtag = 1234;\n\n    if (rank == 0)\n    {\n        printf(\"Enter number of element to be sort: \");\n        scanf(\"%d\", &amp;num);\n\n        for (i = 0; i &lt; num; i++) //random num elements\n        {\n            array[i] = rand();\n        }\n\n        n = i;\n        printf(\"\\nBefore Sorting\\n\");\n        for (j = 0; j &lt; i; j++)\n        {\n            printf(\"%d \", array[j]);\n        }\n        MPI_Send(&amp;array[j], j, MPI_INT, 1, msgtag, MPI_COMM_WORLD);\n    }\n\n    if (rank == 1)\n    {\n        MPI_Recv(&amp;array[j], j, MPI_INT, 0, msgtag, MPI_COMM_WORLD, &amp;stat);\n        bucketSort(array, n);\n        MPI_Send(&amp;array, n, MPI_INT, 2, msgtag, MPI_COMM_WORLD);\n    }\n\n    if (rank == 2)\n    {\n        MPI_Recv(&amp;array, n, MPI_INT, 1, msgtag, MPI_COMM_WORLD, &amp;stat);\n        printf(\"\\nAfter Sorting\\n\");\n        for (k = 0; k &lt; i; k++)\n        {\n            printf(\"%d \", array[k]);\n        }\n    }\n    //MPI END\n    MPI_Finalize();\n    end = MPI_Wtime();  // timer end   \n    double time_spent = end - start;\n    printf(\"\\ntime used for this program was %f Sec.\", time_spent);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1539206049, "post_id": 52748870, "comment_id": 92422188, "body": "Please format your code. It is very hard to read."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1539206096, "post_id": 52748870, "comment_id": 92422204, "body": "<code>sprintf(str, &quot;%d&quot;, a);</code> while <code>str</code> is of length of one is definitely writing memory you don&#39;t own."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1539206107, "post_id": 52748870, "comment_id": 92422206, "body": "<code>char str[1];</code> can hold a string of length <code>0</code> ."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1539206154, "post_id": 52748870, "comment_id": 92422222, "body": "Indentation is missing. It is hard to see whats included in an  <code>if</code> block and whats not."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539206157, "post_id": 52748870, "comment_id": 92422224, "body": "@FantasyCookie17 You think so? Then take a look around at the other C questions and see how the code is usually formatted."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1539206269, "post_id": 52748870, "comment_id": 92422263, "body": "Writing code for a living also means <i>reading</i> code to modify/debug it. Formatting code so that its structure is immediately visible makes that much, much, easier."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539206590, "post_id": 52748870, "comment_id": 92422369, "body": "Put newlines at the end of printing operations, not at the beginning."}, {"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1539206618, "post_id": 52748870, "comment_id": 92422382, "body": "@Osiris @EugeneSh. Now I don&#180;t get the error anymore, but it will print <code>2.2 116101115116116</code> if I type &quot;test&quot; for some reason, which means that i is not converted to a string the way I want it to, but that is probably a topic for another question, as long as nobody wants to give me a quick answer here."}, {"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539206703, "post_id": 52748870, "comment_id": 92422407, "body": "@JonathanLeffler Why would that be necessary? I think there was a reason I did that, although I can&#180;t remember."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539206707, "post_id": 52748870, "comment_id": 92422410, "body": "The second and third comments are giving a clear &quot;quick answer&quot;. You are writing into a string which cannot hold any character as it has a space for the null-terminator only."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1539206859, "post_id": 52748870, "comment_id": 92422459, "body": "<code>sprintf(str, &quot;%d&quot;, a);</code> You are printing the ascii value in <code>str</code>. I think you want to use <code>sprintf(str, &quot;%c&quot;, a);</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1539206941, "post_id": 52748870, "comment_id": 92422485, "body": "@Osiris: even <code>sprintf(str, &quot;%c&quot;, a);</code> is going to write out of bounds (though I agree <code>%d</code> writes further out of bouds \u2014 but any writing out of bounds is bad!)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539207061, "post_id": 52748870, "comment_id": 92422528, "body": "You write out of bounds with the lines <code>char str[1], w[70];</code> and <code>strcpy(w, &quot; &quot;);</code> \u2014 it puts a space and a null in <code>str</code>, but <code>str</code> can only hold one character, so you&#39;ve got undefined behaviour (UB) there immediately. You also write out of bounds with <code>sprintf(str, &quot;%d&quot;, a);</code> \u2014 more UB. What else goes wrong, I&#39;m not sure, but this is the start of trouble.  Maybe use <code>char str[16];</code> instead of <code>char str[1];</code> \u2014 that should be a mild case of overkill, but it should avoid writing out of bounds."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539207268, "post_id": 52748870, "comment_id": 92422605, "body": "@JonathanLeffler Yes i totally agree, i only thought since he wrote that he gets another error now, that he maybe fixed it. <code>116101115116116</code> would translate to <code>testt</code> then."}, {"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1539207291, "post_id": 52748870, "comment_id": 92422614, "body": "@Osiris Now it works, but if I enter test, I get &quot;testt&quot;..."}, {"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "edited": false, "score": 0, "creation_date": 1539207856, "post_id": 52748870, "comment_id": 92422792, "body": "@those who made my code more readable That could never happen with Python, where there is a defined way how you have to indent your code to make it work... I guess I&#180;ll have to get used to this as well."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "edited": false, "score": 0, "creation_date": 1539208040, "post_id": 52749122, "comment_id": 92422850, "body": "That was what the people in the comments said as well. That did solve the original problems, but there is still the problem that it prints the last letter of a word two times (e.g <code>test</code> becomes <code>testt</code>)."}, {"owner": {"reputation": 1629, "user_id": 5530486, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2232f4e1883ede4d6723ba40dd3bf8e2?s=128&d=identicon&r=PG&f=1", "display_name": "daedsidog", "link": "https://stackoverflow.com/users/5530486/daedsidog"}, "reply_to_user": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "edited": false, "score": 1, "creation_date": 1539208231, "post_id": 52749122, "comment_id": 92422909, "body": "You will find that it doesn&#39;t do that anymore. Try running the code."}, {"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "edited": false, "score": 0, "creation_date": 1539208664, "post_id": 52749122, "comment_id": 92423057, "body": "Maybe because of the changed position of the <code>\\n</code>. That might actually have changed something."}, {"owner": {"reputation": 1629, "user_id": 5530486, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2232f4e1883ede4d6723ba40dd3bf8e2?s=128&d=identicon&r=PG&f=1", "display_name": "daedsidog", "link": "https://stackoverflow.com/users/5530486/daedsidog"}, "reply_to_user": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "edited": false, "score": 1, "creation_date": 1539208762, "post_id": 52749122, "comment_id": 92423089, "body": "Be sure to check my post again, especially the last part. I explain why the last character was being printed twice. The newline escape shift was just for readability."}, {"owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1539209013, "post_id": 52749122, "comment_id": 92423173, "body": "<code>char str[1]</code> can hold the empty string."}, {"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "edited": false, "score": 0, "creation_date": 1539209207, "post_id": 52749122, "comment_id": 92423234, "body": "@JohannesJ Oh, sorry, I think I didn<code>t read it carefully enough. So it was just some </code>{}` I forgot. I didn`t copy your code, but correct mine, and since someone wrote something different here (I think that answer was deleted or edited), which didn&#180;t work, but used a command that only needs one line, I didn&#180;t notice I forgot the brackets the first I tried writing the program."}, {"owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "reply_to_user": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1539210062, "post_id": 52749122, "comment_id": 92423473, "body": "@giusti Which empty string and why would you ever need an empty string? A &quot;single&quot;-character string always consists out of to characters: the for people important character and <code>\\0</code>."}, {"owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1539225777, "post_id": 52749122, "comment_id": 92426921, "body": "The empty string would be <code>&quot;&quot;</code>. As an array, it is <code>{0}</code> or, equivalently, <code>{&#39;\\0&#39;}</code>. You have certainly used it before. If you initialize an array of 10 chars with zero, you have the empty string."}], "tags": [], "owner": {"reputation": 1629, "user_id": 5530486, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2232f4e1883ede4d6723ba40dd3bf8e2?s=128&d=identicon&r=PG&f=1", "display_name": "daedsidog", "link": "https://stackoverflow.com/users/5530486/daedsidog"}, "is_accepted": true, "score": 3, "last_activity_date": 1539253987, "last_edit_date": 1539253987, "creation_date": 1539207338, "answer_id": 52749122, "question_id": 52748870, "link": "https://stackoverflow.com/questions/52748870/where-am-i-addressing-memory-i-do-not-own-char-array/52749122#52749122", "title": "Where am I addressing memory I do not own? (char array)", "body": "<p><code>char str[1]</code> cannot hold any strings longer than 0, as the definition of C strings is an array of characters terminated by one null character. Therefore, your <code>str</code> array must be 2 bytes in order to contain both at least one <code>char</code> and 1 null character (<code>'\\0'</code>). This is most likely what's ailing you.</p>\n\n<p>I touched up on your code and got it to work the way you want, but you will have to fine tune the abnormalities that you find unwanted. Read the notes I left by the following adjustments:</p>\n\n<blockquote>\n  <p><code>char str[1] -&gt; char str[2]</code></p>\n</blockquote>\n\n<p>Size must be at least 2 to accommodate both a char &amp; a null terminated character (<code>\\0</code>).</p>\n\n<blockquote>\n  <p><code>sprintf(str, \"%d\", a) -&gt; sprintf(str, \"%c\", a)</code></p>\n</blockquote>\n\n<p>You were formatting your char as an <code>int</code>, hence why you were getting numbers instead of text when you later concatenated the string.</p>\n\n<p>Lastly, your final character was being printed twice because of this:</p>\n\n<pre><code>if (a != EOF &amp;&amp; a != ' ' &amp;&amp; a != '\\t' &amp;&amp; a != '\\n')\n    sprintf(str, \"%c\", a);\nstrcat(w, str);\n</code></pre>\n\n<p><code>strcat(w, str);</code> is not inside the scope of the <code>EOF</code> check, so it concatenates the last character anyway.</p>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IkI9u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IkI9u.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int word = 1, line = 1, a = 0;\n    char str[2], w[70];\n    strcpy(w, \" \");\n    while (a != EOF) {\n        a = getchar();\n        if ((a != EOF) &amp;&amp; (a == ' ' || a == '\\t' || a == '\\n')) {\n            ++word;\n            if (a == '\\n')\n                ++line;\n        }\n        if (a != EOF &amp;&amp; a != ' ' &amp;&amp; a != '\\t' &amp;&amp; a != '\\n') {\n            sprintf(str, \"%c\", a);\n            strcat(w, str);\n        }\n        if (a == ' ' || a == '\\t' || a == '\\n' || a == EOF) {\n            printf(\"%d.%d%s\\n \", line, word, w);\n            strcpy(w, \" \");\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10452712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6db43890452d20c1c6448cb83d5024?s=128&d=identicon&r=PG&f=1", "display_name": "FantasyCookie17", "link": "https://stackoverflow.com/users/10452712/fantasycookie17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 52749122, "answer_count": 1, "score": 3, "last_activity_date": 1539253987, "creation_date": 1539205977, "last_edit_date": 1539207494, "question_id": 52748870, "link": "https://stackoverflow.com/questions/52748870/where-am-i-addressing-memory-i-do-not-own-char-array", "title": "Where am I addressing memory I do not own? (char array)", "body": "<p>The aim of this program is to print every word on an own line with number of line and word. It compiles just fine without warnings, but it seems like I\u00b4m addressing memory I do not own somewhere since I am getting me<code>Abort trap:6</code>, but I don\u00b4t know where and why. I have looked up other questions with the same error, but the answers there didn\u00b4t help.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    int word = 1, line = 1, a = 0;\n    char str[1], w[70];\n    strcpy(w, \" \");\n    while (a != EOF)\n    {\n        a = getchar();\n        if ((a != EOF) &amp;&amp; (a == ' ' || a == '\\t' || a == '\\n'))\n        {\n            ++word;\n            if (a == '\\n')\n                ++line;\n        }\n        if (a != EOF &amp;&amp; a != ' ' &amp;&amp; a != '\\t' &amp;&amp; a != '\\n')\n            sprintf(str, \"%d\", a);\n        strcat(w, str);\n        if (a == ' ' || a == '\\t' || a == '\\n' || a == EOF)\n        {\n            printf(\"\\n %d.%d%s\", line, word, w);\n            strcpy(w, \" \");\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1539203967, "post_id": 52748439, "comment_id": 92421355, "body": "This code is incomplete. I don&#39;t see a single allocation here. Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539204163, "post_id": 52748439, "comment_id": 92421426, "body": "If you ran out of memory then <code>malloc</code> returns <code>NULL</code>. Is this the case? Do you check that return value?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539204207, "post_id": 52748439, "comment_id": 92421442, "body": "Most segmentation fault errors come from exercising an invalid pointer or referencing an invalid array index. Have you stepped through this code in a debugger up to the point of failure?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1539204279, "post_id": 52748439, "comment_id": 92421489, "body": "compile your code with the <code>-g</code> flag, gdb will tell now  you the line it failed on"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539204327, "post_id": 52748439, "comment_id": 92421512, "body": "@EugeneSh. &quot;I don&#39;t see a single allocation here&quot; , maybe thats why it crashes (wink)"}, {"owner": {"reputation": 41, "user_id": 3006812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5376b8168b9434486ad93d3119faa8?s=128&d=identicon&r=PG&f=1", "display_name": "user3006812", "link": "https://stackoverflow.com/users/3006812/user3006812"}, "edited": false, "score": 1, "creation_date": 1539204726, "post_id": 52748439, "comment_id": 92421669, "body": "Silly me! I ran the debugger with -g and found the line that crashed it. It turns out I hadn&#39;t defined pointer_traverse1 and pointer_traverse2!"}], "owner": {"reputation": 41, "user_id": 3006812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5376b8168b9434486ad93d3119faa8?s=128&d=identicon&r=PG&f=1", "display_name": "user3006812", "link": "https://stackoverflow.com/users/3006812/user3006812"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539204134, "creation_date": 1539203891, "last_edit_date": 1539204134, "question_id": 52748439, "link": "https://stackoverflow.com/questions/52748439/segmentation-fault-core-dumped-in-c-in-mergesort-using-pointers-and-linkedlist", "title": "Segmentation fault (core dumped) in C in mergesort using pointers and linkedlists", "body": "<p>I am having trouble figuring out which line of code produces the segmentation fault (core dumped) error in my code. I am trying to implement mergesort using linkedlists (with pointers). i.e. an in-place solution where the tail pointers are changed to point to something new.</p>\n\n<p>I tried using gdb to debug and tell me which line caused the segmentation fault but it only tells me the address, which I don't think is helpful. </p>\n\n<p>This is the mergesort function:</p>\n\n<pre><code>    List *mergesort(List *list) { \n  if (list == NULL || list-&gt;tail == NULL) { \n    return list;\n  } else { \n    List *list1;\n    List *list2;\n    split(list, &amp;list1, &amp;list2);\n    list1 = mergesort(list1);\n    list2 = mergesort(list2);\n    return merge(list1, list2);\n  }\n}\n</code></pre>\n\n<p>The error occurs in the split function:</p>\n\n<pre><code>void split(List *list, List **list1, List **list2) { \n  /* TODO */\n  printf(\"split is called\\n\");\n  List * pointer_list1;\n  List * pointer_list2;\n  List * pointer_traverse1;\n  List * pointer_traverse2;\n  printf(\"start\");\n  pointer_list1 = list;\n  pointer_list2 = list-&gt;tail;\n  list = list-&gt;tail;\n  int sentinel = 0;\n  while(list-&gt;tail != NULL){\n    printf(\"entering while loop\");\n    if(sentinel == 0){\n      printf(\"sentinel equals zero\");\n      pointer_traverse1-&gt;tail = list-&gt;tail;\n      pointer_traverse1 = pointer_traverse1-&gt;tail;\n      printf(\"end of if block\");\n    }else{\n      pointer_traverse2-&gt;tail = list-&gt;tail;\n      pointer_traverse2 = pointer_traverse2-&gt;tail;\n    }\n    list = list-&gt;tail;\n    if(sentinel == 0 ){\n      sentinel = 1;\n    }else{\n      sentinel = 0;\n    }\n  }\n  printf(\"END\");\n  list1 = &amp;(pointer_list1);\n  list2 = &amp;(pointer_list2);\n  return;\n}\n</code></pre>\n\n<p>Note that only the first printf statement (\"split is called\") is called. The merge function is never called before the error occurs. No other printf in the split function is run. So my natural guess would be that instantiating those pointers to lists produced the segmentation fault, but that's ridiculous because they are just declarations? Is it possible that I ran out of memory somehow?</p>\n\n<p>// This might be helpful to anyone trying to understand split. Essentially, given a list of integers say [1,2,3,4,5,6] I am trying to create a list1 of [1,3,5] and list2 of [2,4,6]. I do this by creating a pointer for list1, another list2, and iterate through list, throwing the numbers into list1 and list2 alternately.</p>\n"}, {"tags": ["c", "shared-memory", "fibonacci"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539203458, "post_id": 52748324, "comment_id": 92421150, "body": "Thats a very nice looking spaghetti you have there."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539203619, "post_id": 52748324, "comment_id": 92421215, "body": "There is no question in the question."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1539203789, "post_id": 52748324, "comment_id": 92421278, "body": "So you are asking how to create and use shared memory in an unknown operating system?"}, {"owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "edited": false, "score": 0, "creation_date": 1539203859, "post_id": 52748324, "comment_id": 92421315, "body": "I want to know how to have shared memory in a linux system between two c files to complete the program described above."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539204253, "post_id": 52748324, "comment_id": 92421466, "body": "@AlexGordo When you say two C files, do you mean two separate executables (with each C file having its own <code>main</code>) or do you mean two files linked together into a single executable?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539204318, "post_id": 52748324, "comment_id": 92421509, "body": "@EugeneSh. Thats why there is no answer in the answers."}, {"owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539204783, "post_id": 52748324, "comment_id": 92421691, "body": "@dbush two separate processes, a child and a parent each in their own c file"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539204950, "post_id": 52748324, "comment_id": 92421771, "body": "@AlexGordo That doesn&#39;t answer the question.  Will each C file have its own <code>main</code> function (meaning you&#39;ll need to <code>fork</code> <b>and</b> <code>exec</code>), or will they have the same <code>main</code> with one file having the parent-specific functions and one file having the child-specific functions?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1539205046, "post_id": 52748324, "comment_id": 92421807, "body": "<a href=\"https://stackoverflow.com/questions/13762397/fibonacci-sequence-using-shared-memory-in-c?rq=1\" title=\"fibonacci sequence using shared memory in c\">stackoverflow.com/questions/13762397/&hellip;</a>  ??"}, {"owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539205154, "post_id": 52748324, "comment_id": 92421858, "body": "@dbush they both have a main()"}, {"owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1539205257, "post_id": 52748324, "comment_id": 92421899, "body": "@Michael Dorgan I saw that question it isn&#39;t really close to what I&#39;m asking"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208284, "post_id": 52748324, "comment_id": 92422932, "body": "Use a shared key instead of <code>IPC_PRIVATE</code> so that both processes can get the same shared memory. You can use <code>ftok()</code> to generate a unique key from a pathname. Other than that, the code is mostly the same."}, {"owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208500, "post_id": 52748324, "comment_id": 92422995, "body": "@barmar can you show me what that would look like in two separate files, I&#39;m so lost. This is my first post and I need help."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208631, "post_id": 52748324, "comment_id": 92423043, "body": "What part don&#39;t you understand? Why does it matter if this is your first post?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208702, "post_id": 52748324, "comment_id": 92423069, "body": "StackOverflow is not a free coding service. SO expects you to <a href=\"https://meta.stackoverflow.com/questions/261592\">try to solve your own problem first</a>. Please update your question to show what you have already tried in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I think I&#39;ve given you enough information to get you in the right direction."}, {"owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208713, "post_id": 52748324, "comment_id": 92423074, "body": "@barmar I don&#39;t know what part of the code goes into each file to communicate correctly"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208063, "post_id": 52748780, "comment_id": 92422857, "body": "Why can&#39;t he just use the <code>shm</code> functions like he&#39;s already doing?"}, {"owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539208169, "post_id": 52748780, "comment_id": 92422890, "body": "@barmar please help me, I need to get that file into two but I need help"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "edited": false, "score": 0, "creation_date": 1539208359, "post_id": 52748780, "comment_id": 92422950, "body": "@AlexGordo What part of it don&#39;t you understand? Use <code>shmget()</code> in both files with the same key, then they can share the memory."}], "tags": [], "owner": {"reputation": 652, "user_id": 9347417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4eade3369e9b12786525484f752e6ed?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/9347417/theengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1539205517, "creation_date": 1539205517, "answer_id": 52748780, "question_id": 52748324, "link": "https://stackoverflow.com/questions/52748324/fibonacci-shared-memory-processes-between-two-c-files/52748780#52748780", "title": "Fibonacci shared memory processes between two c files", "body": "<p>There are a couple of options for shared memories :</p>\n\n<p>Datapools - Datapool is an allocated location that kernel provides to a process upon request. Then other processes use the name which was used to create the data pool to connect to it and read/write from it. </p>\n\n<p>Pipelines - Pipeline is another form of sharing resources which again kernel provides upon request. The difference is pipeline is usually one-way whereas data pool can be read and written by all the processes. Also, reads from the pipeline are destructive.</p>\n\n<p>Files - You can also use files which is the most basic and you are probably familiar with it.</p>\n\n<p>These are basic explanations, you have to research on these topics to fully understand and use them. Also, each operating system has a specific way of using these concepts, but all of them provide it (in their own way). </p>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1539212753, "creation_date": 1539212753, "answer_id": 52749938, "question_id": 52748324, "link": "https://stackoverflow.com/questions/52748324/fibonacci-shared-memory-processes-between-two-c-files/52749938#52749938", "title": "Fibonacci shared memory processes between two c files", "body": "<p>Instead of attaching the shared memory in the parent and then inheriting it in the client, use <code>ftok()</code> to get a common shared memory key that's used by both processes.</p>\n\n<p>Create a file <code>fibonacci</code> in your current directory, this will be used in the calls to <code>ftok()</code>.</p>\n\n<p>When the parent forks the child process, it calls <code>execl()</code> to execute the child program, rather than including the child code directly. The child program doesn't need any of the <code>fork()</code> code, it just needs to attach to the same shared memory segment and fill in the results.</p>\n\n<p><code>fibonacci.h</code></p>\n\n<pre><code>#ifndef FIBONACCI_H\n#define FIBONACCI_H\n\n// So we could use other sizes without editing the source.\n#ifndef MAX_SEQUENCE\n# define MAX_SEQUENCE 10\n#endif\n\n// Check that MAX_SEQUENCE is large enough!\n#if MAX_SEQUENCE &lt; 2\n#error MAX_SEQUENCE must be at least 2\n#endif\n\n#define TOKEN_PATH \"fibonacci\"\n\ntypedef struct{\n    long fib_sequence[MAX_SEQUENCE];\n    int sequence_size;\n} shared_data;\n\n#endif\n</code></pre>\n\n<p><code>testparent.c</code></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n#include \"fibonacci.h\"\n\nint main()\n{\n    int m, i;\n    printf(\"Enter the number of a Fibonacci Sequence:\\n\");\n    // Always check whether input conversion worked\n    if (scanf(\"%d\", &amp;m) != 1) {\n        printf(\"Invalid input, couldn't be converted.\\n\");\n        return EXIT_FAILURE;\n    }\n\n    if (m &lt;= 0) {\n        printf(\"Please enter a positive integer\\n\");\n        return EXIT_FAILURE; // exit if input is invalid\n    } else if (m &gt; MAX_SEQUENCE) {\n        printf(\"Please enter an integer less than %d\\n\", MAX_SEQUENCE);\n        return EXIT_FAILURE; // exit if input is invalid\n    }\n\n    /* the identifier for the shared memory segment */\n    int segment_id;\n\n    /* the size (in bytes) of the shared memory segment */\n    size_t segment_size = sizeof(shared_data);\n\n    /* Get shared memory token */\n    key_t token = ftok(TOKEN_PATH, 0);\n    if (token == -1) {\n        perror(\"ftok\");\n        return EXIT_FAILURE;\n    }\n\n    /* allocate a shared memory segment */\n    segment_id = shmget(token, segment_size, S_IRUSR | S_IWUSR | IPC_CREAT);\n\n    // Check result of shmget\n    if (segment_id == -1) {\n        perror(\"shmget failed\");\n        return EXIT_FAILURE;\n    }\n\n    /* attach the shared memory segment */\n    shared_data *shared_memory = shmat(segment_id, NULL, 0);\n\n    // Check whether attaching succeeded\n    if ((void*)shared_memory == (void*)-1) {\n        perror(\"shmat failed\");\n        goto destroy; // clean up\n    }\n    printf(\"\\nshared memory segment %d attached at address %p\\n\", segment_id, (void*)shared_memory);\n\n    shared_memory-&gt;sequence_size = m;\n    pid_t pid;\n    pid = fork();\n    if (pid == 0){\n        execl(\"./testchild\", \"./testchild\", (char *)NULL);\n        perror(\"execl\"); // If it returns it must have failed\n        return EXIT_FAILURE;\n    }\n    else{\n        printf(\"Parent is waiting for child to complete...\\n\");\n        wait(NULL);\n        printf(\"Parent ends\\n\");\n        for(i = 0; i &lt; shared_memory-&gt;sequence_size; i++) {\n            printf(\"%ld \", shared_memory-&gt;fib_sequence[i]);\n        }\n        printf(\"\\n\");\n    }\n\n    /* now detach the shared memory segment */\n    if (shmdt(shared_memory) == -1) {\n        fprintf(stderr, \"Unable to detach\\n\");\n    }\n\ndestroy:\n    /* now remove the shared memory segment */\n    shmctl(segment_id, IPC_RMID, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p><code>testchild.c</code></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n#include \"fibonacci.h\"\n\nint main()\n{\n    int a, b, n, i;\n    a = 0; b = 1;\n\n    /* the identifier for the shared memory segment */\n    int segment_id;\n\n    /* the size (in bytes) of the shared memory segment */\n    size_t segment_size = sizeof(shared_data);\n\n    /* Get shared memory token */\n    key_t token = ftok(TOKEN_PATH, 0);\n    if (token == -1) {\n        perror(\"ftok\");\n        return EXIT_FAILURE;\n    }\n\n    /* allocate a shared memory segment */\n    segment_id = shmget(token, segment_size, S_IRUSR | S_IWUSR);\n\n    // Check result of shmget\n    if (segment_id == -1) {\n        perror(\"shmget failed\");\n        return EXIT_FAILURE;\n    }\n\n    /* attach the shared memory segment */\n    shared_data *shared_memory = shmat(segment_id, NULL, 0);\n\n    // Check whether attaching succeeded\n    if ((void*)shared_memory == (void*)-1) {\n        perror(\"shmat failed\");\n        return EXIT_FAILURE;\n    }\n    printf(\"\\nshared memory segment %d attached at address %p\\n\", segment_id, (void*)shared_memory);\n\n    printf(\"Child is producing the Fibonacci Sequence...\\n\");\n    shared_memory-&gt;fib_sequence[0] = a;\n    shared_memory-&gt;fib_sequence[1] = b;\n    for (i = 2; i &lt; shared_memory-&gt;sequence_size; i++){\n        n = a+b;\n        shared_memory-&gt;fib_sequence[i] = n;\n        a = b;\n        b = n;\n    }\n    printf(\"\\nChild ends\\n\");\n\n    /* now detach the shared memory segment */\n    if (shmdt(shared_memory) == -1) {\n        fprintf(stderr, \"Unable to detach\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10486302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff75bec6162d00d9cea16eff42afa6e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Gordo", "link": "https://stackoverflow.com/users/10486302/alex-gordo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539212753, "creation_date": 1539203365, "last_edit_date": 1539203623, "question_id": 52748324, "link": "https://stackoverflow.com/questions/52748324/fibonacci-shared-memory-processes-between-two-c-files", "title": "Fibonacci shared memory processes between two c files", "body": "<p>Hello I have a single file in c that shares memory from the parent to child but I need my code separated into two separate files while still sharing the memory. I need the parent to create the shared memory and get the input of the fib number. Then the child process opens the share memory object to read the value n and overwrite the value n by the value of fib(n). and displays the fib series. This is what I have now</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n// So we could use other sizes without editing the source.\n#ifndef MAX_SEQUENCE\n# define MAX_SEQUENCE 10\n#endif\n\n// Check that MAX_SEQUENCE is large enough!\n#if MAX_SEQUENCE &lt; 2\n#error MAX_SEQUENCE must be at least 2\n#endif\n\ntypedef struct{\n    long fib_sequence[MAX_SEQUENCE];\n    int sequence_size;\n} shared_data;\n\nint main()\n{\n    int a, b, m, n, i;\n    a = 0; b = 1;\n\n    printf(\"Enter the number of a Fibonacci Sequence:\\n\");\n    // Always check whether input conversion worked\n    if (scanf(\"%d\", &amp;m) != 1) {\n        printf(\"Invalid input, couldn't be converted.\\n\");\n        return EXIT_FAILURE;\n    }\n\n    if (m &lt;= 0) {\n        printf(\"Please enter a positive integer\\n\");\n        return EXIT_FAILURE; // exit if input is invalid\n    } else if (m &gt; MAX_SEQUENCE) {\n        printf(\"Please enter an integer less than %d\\n\", MAX_SEQUENCE);\n        return EXIT_FAILURE; // exit if input is invalid\n    }\n\n    /* the identifier for the shared memory segment */\n    int segment_id;\n\n    /* the size (in bytes) of the shared memory segment */\n    size_t segment_size = sizeof(shared_data);\n\n    /* allocate a shared memory segment */\n    segment_id = shmget(IPC_PRIVATE, segment_size, S_IRUSR | S_IWUSR);\n\n    // Check result of shmget\n    if (segment_id == -1) {\n        perror(\"shmget failed\");\n        return EXIT_FAILURE;\n    }\n\n    /* attach the shared memory segment */\n    shared_data *shared_memory = shmat(segment_id, NULL, 0);\n\n    // Check whether attaching succeeded\n    if ((void*)shared_memory == (void*)-1) {\n        perror(\"shmat failed\");\n        goto destroy; // clean up\n    }\n    printf(\"\\nshared memory segment %d attached at address %p\\n\", segment_id, (void*)shared_memory);\n\n    shared_memory-&gt;sequence_size = m;\n    pid_t pid;\n    pid = fork();\n    if (pid == 0){\n        printf(\"Child is producing the Fibonacci Sequence...\\n\");\n        shared_memory-&gt;fib_sequence[0] = a;\n        shared_memory-&gt;fib_sequence[1] = b;\n        for (i = 2; i &lt; shared_memory-&gt;sequence_size; i++){\n            n = a+b;\n            shared_memory-&gt;fib_sequence[i] = n;\n            a = b;\n            b = n;\n        }\n        printf(\"\\nChild ends\\n\");\n    }\n    else{\n        printf(\"Parent is waiting for child to complete...\\n\");\n        wait(NULL);\n        printf(\"Parent ends\\n\");\n        for(i = 0; i &lt; shared_memory-&gt;sequence_size; i++) {\n            printf(\"%ld \", shared_memory-&gt;fib_sequence[i]);\n        }\n        printf(\"\\n\");\n    }\n\n    /* now detach the shared memory segment */\n    if (shmdt(shared_memory) == -1) {\n        fprintf(stderr, \"Unable to detach\\n\");\n    }\n\ndestroy:\n    /* now remove the shared memory segment */\n    shmctl(segment_id, IPC_RMID, NULL);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "ethernet", "bios"], "comments": [{"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 1, "creation_date": 1539205077, "post_id": 52748215, "comment_id": 92421822, "body": "The cards are listening as long as they&#39;re powered, however the only functionality I&#39;m aware of is &quot;Wake On LAN&quot;, which requires that you send a special packet containing the MAC address, and there is no reply. It just turns on the computer."}, {"owner": {"reputation": 568, "user_id": 6175325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCpRY.jpg?s=128&g=1", "display_name": "Shanks", "link": "https://stackoverflow.com/users/6175325/shanks"}, "reply_to_user": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1539205162, "post_id": 52748215, "comment_id": 92421863, "body": "where can I find Info about the signals that the NIC listen?"}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1539205367, "post_id": 52748215, "comment_id": 92421941, "body": "AFAIK, There&#39;s only one: WOL.   There are docs all over the net. You can start here: <a href=\"https://en.wikipedia.org/wiki/Wake-on-LAN#Magic_packet\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Wake-on-LAN#Magic_packet</a>"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1539207676, "post_id": 52748215, "comment_id": 92422737, "body": "Have a look at Intel ME. It&#39;s very proprietary and largely undocumented though."}, {"owner": {"reputation": 568, "user_id": 6175325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCpRY.jpg?s=128&g=1", "display_name": "Shanks", "link": "https://stackoverflow.com/users/6175325/shanks"}, "edited": false, "score": 0, "creation_date": 1539283716, "post_id": 52748215, "comment_id": 92456769, "body": "I need something more compatible with others processors architectures, like AMD..."}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1539614476, "post_id": 52748215, "comment_id": 92555820, "body": "@Shanks There is nothing &quot;more compatible&quot;. A machine that&#39;s off is off. You can turn the machine on if the card supports it, and this is not dependent on the processor, but at that point, all you&#39;ve done is turned on the machine."}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1539615092, "post_id": 52748215, "comment_id": 92556187, "body": "@Shanks IME is available during &quot;sleep&quot; but not &quot;off&quot; and it&#39;s specific to Intel. You&#39;re looking for something that doesn&#39;t exist. There are no commands that will do anything to a powered off computer except turn it on."}], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 6175325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCpRY.jpg?s=128&g=1", "display_name": "Shanks", "link": "https://stackoverflow.com/users/6175325/shanks"}, "edited": false, "score": 0, "creation_date": 1539671802, "post_id": 52773562, "comment_id": 92574989, "body": "I&#39;ll take the second one."}], "tags": [], "owner": {"reputation": 1907, "user_id": 7988287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43klG.jpg?s=128&g=1", "display_name": "Zac67", "link": "https://stackoverflow.com/users/7988287/zac67"}, "is_accepted": true, "score": 1, "last_activity_date": 1539325843, "creation_date": 1539325843, "answer_id": 52773562, "question_id": 52748215, "link": "https://stackoverflow.com/questions/52748215/read-smbios-of-a-remote-pc/52773562#52773562", "title": "Read SMBIOS of a remote PC", "body": "<blockquote>\n  <p>How can I get the SMBIOS table, through the Network Card of a remote and power-off PC?</p>\n</blockquote>\n\n<p>You can't. WoL is a function of the NIC. When it receives a magic packet it triggers a PMI event, waking up the mainboard - that's it. You can't magically talk through the NIC to the powered down system.</p>\n\n<p>There are two solutions, depending on your actual goal:</p>\n\n<ol>\n<li>Many servers, some workstations and PCs feature lights-out management through a baseboard management controller - features differ, you'll need to select the appropriate product.</li>\n<li>Wake the machine, run whatever queries you need and shut it down again. This is a standard procedure for client management.</li>\n</ol>\n"}], "owner": {"reputation": 568, "user_id": 6175325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCpRY.jpg?s=128&g=1", "display_name": "Shanks", "link": "https://stackoverflow.com/users/6175325/shanks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 52773562, "answer_count": 1, "score": -1, "last_activity_date": 1539325843, "creation_date": 1539202944, "last_edit_date": 1539204809, "question_id": 52748215, "link": "https://stackoverflow.com/questions/52748215/read-smbios-of-a-remote-pc", "title": "Read SMBIOS of a remote PC", "body": "<p>I know that when a PC is OFF, some components still working ,like the motherboard, the NIC (network card), and others. I thought that like the 'magic packet' send to the NIC on the <em>Wake-on-Lan</em> do, there is a form of sending another signal to this one.</p>\n\n<p><strong>How can I get the SMBIOS table, through the Network Card of a remote and power-off PC?</strong> </p>\n\n<p>If someone knows of some code example, or manual which can read to learn, it would be very helpful.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539201634, "post_id": 52747885, "comment_id": 92420315, "body": "Functions can return values."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539201903, "post_id": 52747885, "comment_id": 92420447, "body": "Aside: why <code>int N</code> when the result of the multiplications is <code>double</code>?"}, {"owner": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539202067, "post_id": 52747885, "comment_id": 92420519, "body": "@WeatherVane my instructions say to return N as a non-negative integer so i&#39;m just following along"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539202223, "post_id": 52747885, "comment_id": 92420593, "body": "@xKetjow suppose the product is out of range of <code>int</code>? And if it is required to be non-negative would a value of <code>unsigned int</code> be better than <code>int</code>? And since you say &quot;integer&quot; would <code>unsigned long long</code> be even better?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539203132, "post_id": 52747885, "comment_id": 92421001, "body": "...because that is the maximum non-negative integer range you can get from <code>double</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 0, "creation_date": 1539201936, "post_id": 52747922, "comment_id": 92420462, "body": "Is it possible to return all the variables and not just N, so return N, Rstar, fp, ne, f1, fi, fc, L; ? I&#39;ve just tried it and it didn&#39;t work, but i&#39;ve probably done something wrong."}, {"owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "reply_to_user": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 0, "creation_date": 1539202001, "post_id": 52747922, "comment_id": 92420495, "body": "it is possible to &quot;return&quot; multiple values.  the reason i&#39;m using quotes is that you would to that through pointers in the function parameters.  but this is probably outside the scope of this discussion."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 1, "creation_date": 1539202016, "post_id": 52747922, "comment_id": 92420505, "body": "@xKetjow why would you want to return all  the variables passed, since you already know what they are, because you passed them to the function?"}, {"owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539202079, "post_id": 52747922, "comment_id": 92420524, "body": "@WeatherVane is correct, you don&#39;t really need to return values that you pass in, unless you plan on modifying them in the function, but currently that doesn&#39;t appear to be the case."}, {"owner": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 0, "creation_date": 1539202211, "post_id": 52747922, "comment_id": 92420586, "body": "I&#39;m going to run the same equation 3 more times but with different values in each run for all the variables, but I think this should work too"}], "tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": false, "score": 1, "last_activity_date": 1539201665, "creation_date": 1539201665, "answer_id": 52747922, "question_id": 52747885, "link": "https://stackoverflow.com/questions/52747885/how-to-calculate-an-answer-in-a-function-and-then-print-it-from-the-main-funct/52747922#52747922", "title": "How to calculate an answer in a function and then print it from the main() function?", "body": "<p>You should have your function <em>return</em> the result like so:</p>\n\n<pre><code>int equation(double Rstar, double fp, int ne, double f1, double \nfi, double fc, int L)\n{\n    int N = Rstar * fp * ne * f1 * fi * fc * L;\n    return N;\n}\n\nint main(int argc, char **argv)\n{\n    int N = equation(1.0,0.2,1,1.0,1.0,0.1,1000);\n    printf(\"N: %d\\n\", N);\n    return 0;\n}\n</code></pre>\n\n<p>Note that function return type is changed from <em>void</em> to <em>int</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "is_accepted": false, "score": 0, "last_activity_date": 1539201703, "creation_date": 1539201703, "answer_id": 52747939, "question_id": 52747885, "link": "https://stackoverflow.com/questions/52747885/how-to-calculate-an-answer-in-a-function-and-then-print-it-from-the-main-funct/52747939#52747939", "title": "How to calculate an answer in a function and then print it from the main() function?", "body": "<p>You can declare the <code>equation()</code> function to be of type <code>int</code>, and return N.  <code>main()</code> can then say <code>X = equation ...</code> and <code>printf()</code> from there.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 0, "creation_date": 1539202732, "post_id": 52747954, "comment_id": 92420824, "body": "I&#39;d probably use this but i&#39;ve not looked at it in lectures yet, also, i&#39;ve put the return N; bit in the equation function and then changed around the printf and it&#39;s telling me that N is an undeclared variable"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "reply_to_user": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 0, "creation_date": 1539202831, "post_id": 52747954, "comment_id": 92420871, "body": "@xKetjow Where do you get such error? In what line? Here it works just fine: <a href=\"https://ideone.com/tSkryG\" rel=\"nofollow noreferrer\">ideone.com/tSkryG</a>"}, {"owner": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 0, "creation_date": 1539203209, "post_id": 52747954, "comment_id": 92421044, "body": "<a href=\"https://ideone.com/1yWQ4b\" rel=\"nofollow noreferrer\">ideone.com/1yWQ4b</a> here, it&#39;s the first example that you posted.  EDIT: Nevermind i&#39;ve forgotten to add something to the start in main()"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "reply_to_user": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "edited": false, "score": 0, "creation_date": 1539203415, "post_id": 52747954, "comment_id": 92421135, "body": "@xKetjow Looks like you didn&#39;t copy correctly the <code>main()</code> function. Please copy &amp; paste it again"}], "tags": [], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "is_accepted": true, "score": 0, "last_activity_date": 1539202426, "last_edit_date": 1539202426, "creation_date": 1539201765, "answer_id": 52747954, "question_id": 52747885, "link": "https://stackoverflow.com/questions/52747885/how-to-calculate-an-answer-in-a-function-and-then-print-it-from-the-main-funct/52747954#52747954", "title": "How to calculate an answer in a function and then print it from the main() function?", "body": "<p>Make your function return the calculated result and prin t the returned value in the <code>main</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint equation(double Rstar, double fp, int ne, double f1, double \nfi, double fc, int L)\n{\n    int N = Rstar * fp * ne * f1 * fi * fc * L;\n\n    return N;\n}\n\nint main(int argc, char **argv)\n{\n    int N = equation(1.0,0.2,1,1.0,1.0,0.1,1000);\n\n    printf(\"N=%d, Rstar=1.0, fp=0.2, ne=1, f1=1.0, fi=1.0, fc=0.1, L=1000\",N);\n\n    return 0;\n}\n</code></pre>\n\n<p>I would, however, recommend on defining a <code>struct</code> which would hold all the input parameters, and then the function <code>equation</code> would get pointer to that struct instead of 7 parameters.</p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct equ_input_t\n{\n    double rStart;\n    double fp;\n    int ne;\n    double f1;\n    double fi;\n    double fc;\n    int L;\n} equ_input_t;\n\nint equation(const equ_input_t *input)\n{\n    int N = input-&gt;rStart * input-&gt;fp * input-&gt;ne * input-&gt;f1 * input-&gt;fi * input-&gt;fc * input-&gt;L;\n\n    return N;\n}\n\nint main(int argc, char **argv)\n{\n    equ_input_t param = {.rStart = 1.0, \n                         .fp     = 0.2, \n                         .ne     = 1, \n                         .f1     = 1.0, \n                         .fi     = 1.0, \n                         .fc     = 0.1, \n                         .L      = 1000 };\n\n    int N = equation(&amp;param);\n\n    printf(\"N=%d, Rstar=%.1f, fp=%.1f, ne=%d, f1=%.1f, fi=%.1f, fc=%.1f, L=%d\", \n            N, param.rStart, param.fp, param.ne, param.f1, param.fi, param.fc, param.L);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6945751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6572381204ec4c257958617c5f3d27e0?s=128&d=identicon&r=PG&f=1", "display_name": "xKetjow", "link": "https://stackoverflow.com/users/6945751/xketjow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52747954, "answer_count": 3, "score": -2, "last_activity_date": 1539202426, "creation_date": 1539201528, "question_id": 52747885, "link": "https://stackoverflow.com/questions/52747885/how-to-calculate-an-answer-in-a-function-and-then-print-it-from-the-main-funct", "title": "How to calculate an answer in a function and then print it from the main() function?", "body": "<p>I'm trying to create a program which will calculate a number based on a set of pre-set numbers. I've managed to do it, however, I need the printf part which displays the answer to be in the main() function rather than being in the function which does the calculation, and i'm not quite sure how to do it.</p>\n\n<p>I've tried to just move the printf underneath main, but it says that the variables are not defined. I've also tried to put a main() after the equation calculation is done, but this doesn't work either.</p>\n\n<p>The code below does what I want it to do, apart from the fact that print if is located in the equation function, rather than in the main, which is what i'm not quite sure on how to do.</p>\n\n<p>My code:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\n    void equation(double Rstar, double fp, int ne, double f1, double \n    fi, double fc, int L)\n    {\n        int N = Rstar * fp * ne * f1 * fi * fc * L;\n        printf(\"N=%d, Rstar=%.1f, fp=%.1f, ne=%d, f1=%.1f, fi=%.1f, fc=%.1f, L=%d\",N,Rstar,fp,ne,f1,fi,fc,L);\n\n    }\n\n    int main(int argc, char **argv)\n    {\n        equation(1.0,0.2,1,1.0,1.0,0.1,1000);\n        return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "hashtable"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539201449, "post_id": 52747833, "comment_id": 92420233, "body": "Please reduce it to <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1539201768, "post_id": 52747833, "comment_id": 92420380, "body": "learn how to use a debugger."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1539201809, "post_id": 52747833, "comment_id": 92420401, "body": "&quot;<code>while(!feof(list))</code>&quot; is the first wtf."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1539202002, "post_id": 52747833, "comment_id": 92420497, "body": "<code>next_field()</code> looks more than fishy."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1539202229, "post_id": 52747833, "comment_id": 92420596, "body": "You never allocate memory for you global array of pointers to <code>struct individual</code> named <code>hashArray</code>."}, {"owner": {"reputation": 13, "user_id": 10486033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664ab23f2336f5eaf84982f041487500?s=128&d=identicon&r=PG&f=1", "display_name": "E. Cheng", "link": "https://stackoverflow.com/users/10486033/e-cheng"}, "edited": false, "score": 0, "creation_date": 1539205733, "post_id": 52747833, "comment_id": 92422077, "body": "Thank you for replying. The <code>while(!feof(list))</code> is used to load in all the names. I&#39;ve thought it was <code>next_field()</code> as well but I have tested it and it completely runs through. I tested it by adding a <code>printf(&quot;Whatever&quot;)</code> and it displayed this every time the function was called. I&#39;ll try allocating memory to my <code>hashArray</code>. Thank you"}], "owner": {"reputation": 13, "user_id": 10486033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664ab23f2336f5eaf84982f041487500?s=128&d=identicon&r=PG&f=1", "display_name": "E. Cheng", "link": "https://stackoverflow.com/users/10486033/e-cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539201607, "creation_date": 1539201312, "last_edit_date": 1539201607, "question_id": 52747833, "link": "https://stackoverflow.com/questions/52747833/getting-segmentation-faultcore-dumped-on-ubuntu-in-c-for-a-hash-table", "title": "Getting &quot;Segmentation Fault(core dumped)&quot; on Ubuntu in C for a hash table", "body": "<p>I'm trying to implement a hash table in C. I have a csv file, which only consists of a list of surnames on separate lines each. e.g.</p>\n\n<p>Sybott<br>\nO Neill<br>\nPotter  </p>\n\n<p>that I am to read from. I then use a hash function, called hash1, to convert these strings into an integer which would give me my index for my hash table. I am then to store the frequency of the occurrence of each name.\nHowever, I am getting a segmentation fault which I have deduced is coming from my</p>\n\n<pre><code>void insert(struct individual *p)\n</code></pre>\n\n<p>function. I'm clueless as to how to solve this and have only started practising C. </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define maxSize 500\n\n/* Hash function that returns my key as an integer, giving me my index */\nint hash1(char *s){\n    int hash = 0;\n    while(*s){\n        hash = hash + *s;\n        s++;\n    }\nreturn hash;\n}\n\n/* Item to be stored */\nstruct individual{\n    int frequency; /* Value to be stored */\n    char name[50]; /* This is will be my key */\n};\n\n/* The hash table */ \nstruct individual *hashArray[maxSize];\n\n/* Initialising hash table */\nvoid initArray(){\n    for (int i = 0; i &lt; maxSize; i++){\n        hashArray[i]-&gt;frequency = 0;\n        hashArray[i]-&gt;name[i] = 0;\n    }\n}\n\n/* Function to load the names */\nint next_field(FILE *f, char *buffer, int max){\n    int i = 0, end = 0;\n    for(;;){\n        buffer[i] = fgetc(f);\n        if(buffer[i] == '\\n' || feof(f)){ end = 1; break; }\n    }\n    buffer[i] = 0;\n    return end;\n};\n\n/* Loading the names into structs - Done */\nvoid reader(FILE *f, struct individual *n){\n    char buf[50];\n    next_field(f, n-&gt;name, maxSize);\n};\n\n/* Adding to the hash table */\nvoid insert(struct individual *p){\n    struct individual *person =  malloc(sizeof(struct individual));\n    int index = hash1(p-&gt;name) % maxSize;\n\n    // The issue is coming from this line here:\n    int primaryIndex = hash1(hashArray[index]-&gt;name) % maxSize;  \n\n\n    /* Linear Probing */\n    printf(\"Do I get to here\\n\");\n    while(hashArray[index] != NULL){\n\n        if(primaryIndex == index){\n           hashArray[primaryIndex]-&gt;frequency++;  \n        } else{\n            ++index;  /* Going to next block */ \n        }\n        index %= maxSize; /* Looping through the hash table */\n    }\n    hashArray[index] = person;\n};\n\nvoid display(struct individual *duine){\n    printf(\"%s\\n\", duine-&gt;name);\n};\n\nint main(int argc, char *argv[]){\n    FILE *list;\n    struct individual in;\n    //initArray();\n\n    /* Opening file */\n    if( argc &lt; 2 ) { \n        printf(\"Also include csv file name.\\n\"); \n        return EXIT_FAILURE; \n    }\n\n    /* Checking if file is found */\n    list = fopen(argv[1], \"r\");\n    if(!list) { \n        printf(\"File not found. %s\\n\", argv[1]); \n        return EXIT_FAILURE; \n    }\n\n    while(!feof(list)){\n        reader(list, &amp;in);\n        insert(&amp;in);\n        display(&amp;in);\n    }\n\n    fclose(list);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>What I'm trying to do here is to compare two indices, one from the struct p being passed into this function and one from the hash table at this index. If they are the same, I wish to increase the frequency count stored there by 1. If I do remove this line, the rest of my code runs fine.</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["c", "operator-precedence", "post-increment", "side-effects", "sequence-points"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1539200960, "post_id": 52747724, "comment_id": 92420008, "body": "<a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">Operator precedence</a>."}, {"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 1, "creation_date": 1539200960, "post_id": 52747724, "comment_id": 92420009, "body": "That&#39;s not logical AND, it&#39;s bitwise. Logical AND is <code>&amp;&amp;</code>"}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1539200970, "post_id": 52747724, "comment_id": 92420020, "body": "&amp; is the binary operation, you probably meant &amp;&amp;"}, {"owner": {"reputation": 79, "user_id": 7029166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32c3133aca68bba6982e6851a40778c?s=128&d=identicon&r=PG&f=1", "display_name": "rapidDev", "link": "https://stackoverflow.com/users/7029166/rapiddev"}, "edited": false, "score": 0, "creation_date": 1539201016, "post_id": 52747724, "comment_id": 92420039, "body": "Sorry, I fixed it. But the same question still holds."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1539201018, "post_id": 52747724, "comment_id": 92420041, "body": "<code>(a-- == 10 &amp; a-- == 9)</code> why would you write code like that?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1539201051, "post_id": 52747724, "comment_id": 92420057, "body": "The side-effects of increments and decrements are complete at sequence points, and not before.  The <code>&amp;&amp;</code> and <code>||</code> operators provide sequence points; the <code>&amp;</code> and <code>|</code> operators do not."}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1539201052, "post_id": 52747724, "comment_id": 92420059, "body": "Why would you want to put anyone stuck having to read your code through this. It&#39;s not an obfuscation contest. Make it obvious. And that&#39;s a binary operator (<code>&amp;</code>), not a logical one (<code>&amp;&amp;</code>)"}, {"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 0, "creation_date": 1539201113, "post_id": 52747724, "comment_id": 92420086, "body": "<code>a-- ==10 &amp; a-- == 9</code>? Which one do you think will be computed by the compiler first?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539201117, "post_id": 52747724, "comment_id": 92420090, "body": "Note that <code>if (a == --a)</code> is undefined behaviour \u2014 there&#39;s no point in speculating about what will happen.  The first condition is (now) defined; it should print <code>1</code>.  You&#39;d do better with newlines after your printing."}, {"owner": {"reputation": 79, "user_id": 7029166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32c3133aca68bba6982e6851a40778c?s=128&d=identicon&r=PG&f=1", "display_name": "rapidDev", "link": "https://stackoverflow.com/users/7029166/rapiddev"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539201298, "post_id": 52747724, "comment_id": 92420166, "body": "Good answer. @JonathanLeffler"}, {"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 1, "creation_date": 1539201675, "post_id": 52747724, "comment_id": 92420336, "body": "No! This question is not &quot;duplicate&quot; to question on undefined behavior. There is NO any UB because C standard says about <code>logical and</code> operator <code>&quot;guarantees left-to-right evaluation; there is a sequence point after the evaluation of the first operand.&quot;</code>. So that, all side effects of <code>a-- == 10</code> are complete before <code>a-- == 9</code> evaluation. This is jet another case."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 1, "creation_date": 1539201775, "post_id": 52747724, "comment_id": 92420385, "body": "@Observe: Neither is compiled by the compiler first. In a modern compiler, the expression is parsed and converted into an internal representation, which may be some sort of rich data structure. This data structure is transformed by various code in the compiler, including optimization, with results that are effectively unpredictable in general. Then the result is used to generate some internal code which is then used to generate assembly code. Assuming recognizable parts of the expression remain, any part of it could be first in the assembly code."}, {"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1539202021, "post_id": 52747724, "comment_id": 92420507, "body": "@EricPostpischil Post  See comment: &quot;Sorry, I fixed it. But the same question still holds&quot; above. Misprint is in &quot;&amp;&amp; -&gt; &amp;&quot; but <a href=\"https://stackoverflow.com/posts/52747724/revisions\">not in word &quot;logical&quot;</a> (see edit 2)"}, {"owner": {"reputation": 79, "user_id": 7029166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32c3133aca68bba6982e6851a40778c?s=128&d=identicon&r=PG&f=1", "display_name": "rapidDev", "link": "https://stackoverflow.com/users/7029166/rapiddev"}, "edited": false, "score": 0, "creation_date": 1539202109, "post_id": 52747724, "comment_id": 92420533, "body": "Sorry, I missed the &amp; in my description. It&#39;s &amp;&amp;!!!! It&#39;s fixed now"}, {"owner": {"reputation": 79, "user_id": 7029166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32c3133aca68bba6982e6851a40778c?s=128&d=identicon&r=PG&f=1", "display_name": "rapidDev", "link": "https://stackoverflow.com/users/7029166/rapiddev"}, "edited": false, "score": 0, "creation_date": 1539202754, "post_id": 52747724, "comment_id": 92420831, "body": "The answer I was looking for was &quot;sequence points&quot;. I just wanted a name to the concept I was observing in the code."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1539206117, "last_edit_date": 1539206117, "creation_date": 1539202600, "answer_id": 52748146, "question_id": 52747724, "link": "https://stackoverflow.com/questions/52747724/operator-associativity-with-postfix-decrement-and-logical-and-operators-in-c/52748146#52748146", "title": "Operator associativity with &#39;postfix decrement&#39; and &#39;logical AND&#39; operators in c", "body": "<blockquote>\n  <p>This expression (a-- == 10 &amp;&amp; a-- == 9) evaluates left-to-right,</p>\n</blockquote>\n\n<p>Yes, mostly, but only because <code>&amp;&amp;</code> is special.</p>\n\n<blockquote>\n  <p>and a is still 10 at a-- == 10</p>\n</blockquote>\n\n<p>Yes, because <code>a--</code> yields the old value.</p>\n\n<blockquote>\n  <p>but a is 9 for a-- == 9. </p>\n</blockquote>\n\n<p>Yes, because the sequence point at <code>&amp;&amp;</code> guarantees the update to <code>a</code>'s value is complete before the RHS is evaluated.</p>\n\n<blockquote>\n  <p>1) Is there a clear rule as to when post-increment evaluate?</p>\n</blockquote>\n\n<p>The best answer, I think, is \"no\".  The side effects due to <code>++</code> and <code>--</code> are completed at some point prior to the next sequence point, but beyond that, you can't say.  For well-defined expressions, it doesn't matter when the side effects are completed.  If an expression is sensitive to when the side effect is completed, that usually means the expression is undefined.</p>\n\n<blockquote>\n  <p>From this example it seems it evaluates prior to the &amp;&amp; but after the ==. Is that because the &amp;&amp; logical operator makes a-- == 10 a complete expression, so a is updated after it executes?</p>\n</blockquote>\n\n<p>Basically yes.</p>\n\n<blockquote>\n  <p>2) Also for c/c++, certain operators such as prefix decrement occur right to left</p>\n</blockquote>\n\n<p>Careful.  I'm not sure what you mean, but whatever it is, I'm almost certain it's not true.</p>\n\n<blockquote>\n  <p>so a == --a first decrements a to 9 and then compares 9 == 9.</p>\n</blockquote>\n\n<p>No, <code>a == --a</code> is undefined.  There's no telling what it does.</p>\n\n<blockquote>\n  <p>Is there a reason for why c/c++ is designed this way?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>I know for Java, it's the opposite (it's evaluates left to right).</p>\n</blockquote>\n\n<p>Yes, Java is different.</p>\n\n<hr>\n\n<p>Here are some guidelines to help you understand the evaluation of C expressions:</p>\n\n<ol>\n<li><p>Learn the rules of operator precedence and associativity.  For \"simple\" expressions, those rules tell you virtually everything you need to know about an expression's evaluation.  Given <code>a + b * c</code>, <code>b</code> is multiplied by <code>c</code> and then the product added to <code>a</code>, because of the higher precedence of <code>*</code> over <code>+</code>.  Given <code>a + b + c</code>, <code>a</code> is added to <code>b</code> and then the sum added to <code>c</code>, because<code>+</code> associates from left to right.</p></li>\n<li><p>With the exception of associativity (as mentioned in point 1), try not to use the words \"left to right\" or \"right to left\" evaluation <em>at all</em>.  C has nothing like left to right or right to left evaluation.  (Obviously Java is different.)</p></li>\n<li><p>Where it gets tricky is side effects.  (When I said \"'simple' expressions\" in point 1, I basically meant \"expressions without side effects\".)  Side effects include (a) function calls, (b) assignments with <code>=</code>, (c) assignments with <code>+=</code>, <code>-=</code>, etc., and of course (d) increments/decrements with <code>++</code> and <code>--</code>.  (If it matters when you <em>fetch</em> from a variable, which is typically only the case for variables qualified as <code>volatile</code>, we could add (e) fetches from <code>volatile</code> variables to the list.)  In general, <em>you can not tell when side effects happen</em>.  Try not to care.  As long as you don't care (as long as your program is insensitive to the order in which side effects matter), it doesn't matter.  But if your program <em>is</em> sensitive, it's probably undefined.  (See more under points 4 and 5 below.)</p></li>\n<li><p>You must never ever have two side effects in the same expression which attempt to alter the same variable.  (Examples: <code>i = i++</code>, <code>a++ + a++</code>.)  If you do, the expression is undefined.</p></li>\n<li><p>With one class of exceptions, you must never ever have a side effect which attempts to alter a variable which is also being used elsewhere in the same expression.  (Example: <code>a == --a</code>.)  If you do, the expression is undefined.  The exception is when the value accessed is being used to compute the value to be stored, as in <code>i = i + 1</code>.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539299425, "post_id": 52748149, "comment_id": 92462683, "body": "At the moment, this only addresses the first of the two <code>if</code> statements (but it does so correctly, given the edited question)."}, {"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539300588, "post_id": 52748149, "comment_id": 92462872, "body": "Agree, in the second <code>if</code> there is undefined order of <code>==</code> operands evaluation, so that the operator result also undefined."}], "tags": [], "owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "is_accepted": false, "score": 0, "last_activity_date": 1539202606, "creation_date": 1539202606, "answer_id": 52748149, "question_id": 52747724, "link": "https://stackoverflow.com/questions/52747724/operator-associativity-with-postfix-decrement-and-logical-and-operators-in-c/52748149#52748149", "title": "Operator associativity with &#39;postfix decrement&#39; and &#39;logical AND&#39; operators in c", "body": "<p>With \"logical and\" operator <code>(a-- == 10 &amp;&amp; a-- == 9)</code> is well-formed expression (without undefined behavior as it is in <code>a++ + a++</code>).</p>\n\n<p>C standard says about \"logical and\"/\"logical or\" operators:</p>\n\n<blockquote>\n  <p>guarantees left-to-right evaluation; there is a sequence point after\n  the evaluation of the first operand.</p>\n</blockquote>\n\n<p>So that, all side effects of the first subexpression <code>a-- == 10</code> are complete before the second subexpression <code>a-- == 9</code> evaluation.\n<code>a</code> is <code>9</code> before evaluation of second subexpression.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1539202691, "creation_date": 1539202691, "answer_id": 52748162, "question_id": 52747724, "link": "https://stackoverflow.com/questions/52747724/operator-associativity-with-postfix-decrement-and-logical-and-operators-in-c/52748162#52748162", "title": "Operator associativity with &#39;postfix decrement&#39; and &#39;logical AND&#39; operators in c", "body": "<p>The logical <code>&amp;&amp;</code> operator contains a <strong>sequence point</strong> between the evaluation of the first and second operand.  Part of this is that any side effect (such as that performed by the <code>--</code> operator) as part of the left side is complete before the right side is evaluated.</p>\n\n<p>This is detailed in section 6.5.13p4 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> regarding the logical AND operator:</p>\n\n<blockquote>\n  <p>Unlike the bitwise binary &amp; operator, the &amp;&amp; operator guarantees\n  left-to-right evaluation; if  the  second  operand  is  evaluated, \n  there  is  a  sequence  point  between  the  evaluations  of the \n  first  and  second  operands.   If  the  first  operand  compares \n  equal  to  0,  the  second operand is not evaluated.</p>\n</blockquote>\n\n<p>In the case of this expression:</p>\n\n<pre><code>(a-- == 10 &amp;&amp; a-- == 9)\n</code></pre>\n\n<p>The current value of <code>a</code> (10) is first compared for equality against 10.  This is true, so the right side is then evaluated, but not before the side effect of decrementing <code>a</code> that was done on the left side.  Then, the current value of <code>a</code> (now 9) is compared for equality against 9.  This is also true, so the whole expression evaluates to true.  Before the next statement is executed, the side effect of decrementing <code>a</code> that was done on the right side is done.</p>\n\n<p>This expression however:</p>\n\n<pre><code>if (a == --a)\n</code></pre>\n\n<p>Involves reading and writing <code>a</code> in the same expression without a sequence point.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n"}], "owner": {"reputation": 79, "user_id": 7029166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32c3133aca68bba6982e6851a40778c?s=128&d=identicon&r=PG&f=1", "display_name": "rapidDev", "link": "https://stackoverflow.com/users/7029166/rapiddev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 1, "accepted_answer_id": 52748162, "answer_count": 3, "score": 2, "last_activity_date": 1539206117, "creation_date": 1539200771, "last_edit_date": 1539202058, "question_id": 52747724, "link": "https://stackoverflow.com/questions/52747724/operator-associativity-with-postfix-decrement-and-logical-and-operators-in-c", "title": "Operator associativity with &#39;postfix decrement&#39; and &#39;logical AND&#39; operators in c", "body": "<p><strong>Disclaimer: I don't code like this, I'm just trying to understand how the c language works!!!!</strong></p>\n\n<p>The output is 12.</p>\n\n<p>This expression <code>(a-- == 10 &amp;&amp; a-- == 9)</code> evaluates left-to-right, and a is still 10 at <code>a-- == 10</code> but a is 9 for <code>a-- == 9</code>. </p>\n\n<p>1) Is there a clear rule as to when post-increment evaluate? From this example it seems it evaluates prior to the &amp;&amp; but after the ==. Is that because the &amp;&amp; logical operator makes <code>a-- == 10</code> a complete expression, so a is updated after it executes?</p>\n\n<p>2) Also for c/c++, certain operators such as prefix decrement occur right to left so <code>a == --a</code> first decrements a to 9 and then compares 9 == 9. Is there a reason for why c/c++ is designed this way? I know for Java, it's the opposite (it's evaluates left to right).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a = 10;\n    if (a-- == 10 &amp;&amp; a-- == 9)\n        printf(\"1\");\n    a = 10;\n    if (a == --a)\n        printf(\"2\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "variables", "while-loop"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 5, "creation_date": 1539199011, "post_id": 52747292, "comment_id": 92419144, "body": "Never post images of code. Paste the code as text. Use the editor help to learn how to format it correctly."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1539199058, "post_id": 52747292, "comment_id": 92419161, "body": "You mix up assignment operator with equality comparison, switch = and =="}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 2, "creation_date": 1539199064, "post_id": 52747292, "comment_id": 92419166, "body": "That said: <code>==</code> is comparison, <code>=</code> is assignment."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5080502, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-arFzHsqLv_k/AAAAAAAAAAI/AAAAAAAAAL0/1nnKs5L2ArA/photo.jpg?sz=128", "display_name": "Daniel Bod", "link": "https://stackoverflow.com/users/5080502/daniel-bod"}, "edited": false, "score": 0, "creation_date": 1539199286, "post_id": 52747357, "comment_id": 92419282, "body": "Ah okay thank you so much :)"}], "tags": [], "owner": {"reputation": 2331, "user_id": 7207514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSSHk.png?s=128&g=1", "display_name": "Deiv", "link": "https://stackoverflow.com/users/7207514/deiv"}, "is_accepted": true, "score": 4, "last_activity_date": 1539199156, "creation_date": 1539199156, "answer_id": 52747357, "question_id": 52747292, "link": "https://stackoverflow.com/questions/52747292/can-anybody-tell-me-why-this-endless-while-loop-isnt-working-properly/52747357#52747357", "title": "Can anybody tell me why this endless while loop isn&#39;t working properly?", "body": "<p>== is used for equivalency, whereas = is used for assigning a variable.</p>\n\n<p>Change your code to the following for it to work:</p>\n\n<pre><code>int x;\nx = 0;\nwhile(x == 100) {\n  printf(\"this will not print\");\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5080502, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-arFzHsqLv_k/AAAAAAAAAAI/AAAAAAAAAL0/1nnKs5L2ArA/photo.jpg?sz=128", "display_name": "Daniel Bod", "link": "https://stackoverflow.com/users/5080502/daniel-bod"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1539199979, "accepted_answer_id": 52747357, "answer_count": 1, "score": -5, "last_activity_date": 1539199462, "creation_date": 1539198906, "last_edit_date": 1539199189, "question_id": 52747292, "link": "https://stackoverflow.com/questions/52747292/can-anybody-tell-me-why-this-endless-while-loop-isnt-working-properly", "closed_reason": "Not suitable for this site", "title": "Can anybody tell me why this endless while loop isn&#39;t working properly?", "body": "<pre><code>int x;\nx == 0;\nwhile( x = 100 ){\n    printf(\"Endless while loop\");\n}\n</code></pre>\n\n<p>I'm unsure as to why this loop isn't working as intended. I have set x equal to 0 so then the while loop should only run if x is equal to 100 (which it isn't). However the loop seems to run irrespective of this. This seems to happen with the while loop condition set to any value.</p>\n\n<p>Any help would be much appreciated.\nThanks,\nDan.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539198974, "post_id": 52747247, "comment_id": 92419128, "body": "&quot;w  Truncate file to zero length or create text file for writing. The stream is positioned at the beginning of the file.&quot;"}, {"owner": {"reputation": 21, "user_id": 10486019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b21fa85b1c3cb305647f9eab7e11fb?s=128&d=identicon&r=PG&f=1", "display_name": "user10486019", "link": "https://stackoverflow.com/users/10486019/user10486019"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539199154, "post_id": 52747247, "comment_id": 92419210, "body": "@Stargateur, Thanks I don&#39;t need to write to the file if it doesn&#39;t exist I only need the pointer to return as null, is there a way to do this?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539199389, "post_id": 52747247, "comment_id": 92419330, "body": "I believe &quot;r+&quot; will do it, read <a href=\"https://linux.die.net/man/3/fopen\" rel=\"nofollow noreferrer\">doc</a> when you want use a function."}, {"owner": {"reputation": 21, "user_id": 10486019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b21fa85b1c3cb305647f9eab7e11fb?s=128&d=identicon&r=PG&f=1", "display_name": "user10486019", "link": "https://stackoverflow.com/users/10486019/user10486019"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539199555, "post_id": 52747247, "comment_id": 92419405, "body": "thanks that solved the problem"}, {"owner": {"reputation": 1, "user_id": 10486078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e6c0ba719ad875bf698c94258927384?s=128&d=identicon&r=PG&f=1", "display_name": "anunia", "link": "https://stackoverflow.com/users/10486078/anunia"}, "edited": false, "score": 0, "creation_date": 1539199794, "post_id": 52747247, "comment_id": 92424794, "body": "If you just change it to NULL then you will lose a pointer, so you won&#39;t be able to close the file later."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10486019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b21fa85b1c3cb305647f9eab7e11fb?s=128&d=identicon&r=PG&f=1", "display_name": "user10486019", "link": "https://stackoverflow.com/users/10486019/user10486019"}, "edited": false, "score": 0, "creation_date": 1539199248, "post_id": 52747336, "comment_id": 92419256, "body": "Is there a way to stop it doing this and simply flag it as null?"}, {"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "reply_to_user": {"reputation": 21, "user_id": 10486019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b21fa85b1c3cb305647f9eab7e11fb?s=128&d=identicon&r=PG&f=1", "display_name": "user10486019", "link": "https://stackoverflow.com/users/10486019/user10486019"}, "edited": false, "score": 0, "creation_date": 1539199475, "post_id": 52747336, "comment_id": 92419374, "body": "@user10486019 Updated my answer."}], "tags": [], "owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "is_accepted": true, "score": 1, "last_activity_date": 1539199462, "last_edit_date": 1539199462, "creation_date": 1539199091, "answer_id": 52747336, "question_id": 52747247, "link": "https://stackoverflow.com/questions/52747247/my-pointer-is-not-returning-null-but-the-file-it-is-paining-at-does-not-exist/52747336#52747336", "title": "My pointer is not returning NULL but the file it is paining at does not exist", "body": "<p>It is creating a file if it doesn't exist. If you don't want the file to be created then use <code>r+</code> file or simply first open the file in <code>r</code> mode and the proceed with <code>w</code> mode.</p>\n"}], "owner": {"reputation": 21, "user_id": 10486019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b21fa85b1c3cb305647f9eab7e11fb?s=128&d=identicon&r=PG&f=1", "display_name": "user10486019", "link": "https://stackoverflow.com/users/10486019/user10486019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52747336, "answer_count": 1, "score": -2, "last_activity_date": 1539199794, "creation_date": 1539198677, "last_edit_date": 1539198839, "question_id": 52747247, "link": "https://stackoverflow.com/questions/52747247/my-pointer-is-not-returning-null-but-the-file-it-is-paining-at-does-not-exist", "title": "My pointer is not returning NULL but the file it is paining at does not exist", "body": "<p>Im trying to write to files using fopen, with a NULL check in case there is an error opening the file or it does not exist. However despite the file not existing the pointer returns with an arbitrary number instead of being NULL. Why is this happening and how can I correct it?</p>\n\n<p>My code is below:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint writenumstofile(int num1, int num2) \n{\n    FILE* fp;\n\n    if ((fp = fopen(\"outpiuteuo.txt\", \"w\")) == NULL) {\n        return 7;\n        exit(1);\n    }\n    fprintf(fp, \"%d\", num1);\n    fprintf(fp, \"%d\", num2);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "recursion", "mips", "stack-overflow", "stack-pointer"], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1539204745, "post_id": 52748546, "comment_id": 92421673, "body": "<code>$v0</code> <i>is</i> preserved by <code>add $s0, $v0, $0  #$s0 comb(a-1, b-1)</code>."}, {"owner": {"reputation": 23, "user_id": 10485894, "user_type": "registered", "profile_image": "https://graph.facebook.com/2294503090778101/picture?type=large", "display_name": "Yoom", "link": "https://stackoverflow.com/users/10485894/yoom"}, "edited": false, "score": 0, "creation_date": 1539221788, "post_id": 52748546, "comment_id": 92426081, "body": "Thanks a lot for your help!!! I really appreciate you :) Then, can I add &#39;sw&#39; just before the first part of comb, and &#39;lw&#39; before I change the value of $a0 before the second call...?"}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1539204384, "creation_date": 1539204384, "answer_id": 52748546, "question_id": 52747125, "link": "https://stackoverflow.com/questions/52747125/convert-c-code-to-mips-assembly-combination-function-using-recursion/52748546#52748546", "title": "convert C code to MIPS assembly - combination function using recursion", "body": "<p>Your basic problem is that you're not saving register values across the (recursive) calls, so the values are being clobbered.  $a0 and $a1 are caller-save registers, so any call might clobber them, and your function <code>comb</code> does in fact clobber them.  But that means after the first recursive call, the values are gone, so the second recursive call is garbage.</p>\n\n<p>You need to save the values of $a0 and $a1 in your stack frame before the first recursive call and restore them after it returns (before the second call).  You'll also need to save the value of $v0 around the second call, as $v0 is similarly clobbered by calls.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10485894, "user_type": "registered", "profile_image": "https://graph.facebook.com/2294503090778101/picture?type=large", "display_name": "Yoom", "link": "https://stackoverflow.com/users/10485894/yoom"}, "edited": false, "score": 0, "creation_date": 1539221555, "post_id": 52748583, "comment_id": 92426013, "body": "I really appreciate your help! :) I added code to preserve arguments in comb! like this:  comb:  addi $sp, $sp, -16  sw $a0, 12($sp)  sw $a1, 8($sp)  sw $ra, 4($sp)  sw $s0, 0($sp)  and restore $a0, $a1 before I call the second recursive like this:  lw $a1, 8($sp)  lw $a0, 12($sp)  addi $a1, $a1, 1  #$a1 (b)  jal comb  #call comb(a-1, b)  but I have my return value wrong..! Would you tell what did I do wrong again..? Sorry ;-("}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 23, "user_id": 10485894, "user_type": "registered", "profile_image": "https://graph.facebook.com/2294503090778101/picture?type=large", "display_name": "Yoom", "link": "https://stackoverflow.com/users/10485894/yoom"}, "edited": false, "score": 0, "creation_date": 1539233972, "post_id": 52748583, "comment_id": 92428749, "body": "@Yoom If you restore the arguments to their original values between the calls, you have to do <code>addi $a0, $a0, -1</code> to compute <code>n-1</code> from <code>n</code> rather than <code>addi $a1, $a1, 1</code> to compute <code>k</code> from <code>k-1</code>. Alternatively, if you store the value of <code>n-1</code> and the value of <code>k</code> you can avoid the extra arithmetic. In general, I would advise writing the algorithm in a higher-level language like c first and translating it afterwards."}], "tags": [], "owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "is_accepted": true, "score": 1, "last_activity_date": 1539204580, "creation_date": 1539204580, "answer_id": 52748583, "question_id": 52747125, "link": "https://stackoverflow.com/questions/52747125/convert-c-code-to-mips-assembly-combination-function-using-recursion/52748583#52748583", "title": "convert C code to MIPS assembly - combination function using recursion", "body": "<p>There are multiple problems with your code.</p>\n\n<p>First, the recurrence relation you have chosen is very inefficient and much more complicated than necessary. Even <a href=\"https://en.wikipedia.org/wiki/Combination\" rel=\"nofollow noreferrer\">Wikipedia</a> has several better recurrence relations, for example</p>\n\n<p><code>n over k = (n-1 over k-1) * (n/k)</code></p>\n\n<p>avoids recursing into the function multiple times (thus allowing the function to be written tail-recursively).</p>\n\n<p>The recurrence you are using has the additional disadvantage that you must both check for <code>k==0</code> <em>and</em> <code>k==n</code>.</p>\n\n<p>This brings us to your implementation, which fails to check both conditions correctly:</p>\n\n<pre><code>##base case\nbne $a0, $a1, gen  #if (a==b)\naddi $v0, $0, 1 #$v0 (1)\nj rtn\nbne $a1, $0, gen  #if (b==0)\naddi $v0, $0, 1 #$v0 (1)\nj rtn\n</code></pre>\n\n<p>The first of these tests jumps over the second test if <code>a!=b</code>, regardless of whether <code>b==0</code>, so the second test is unreachable. You would have to change the code to</p>\n\n<pre><code>##base case\nbne $a0, $a1, isbzero  #if (a==b)\naddi $v0, $0, 1 #$v0 (1)\nj rtn\nisbzero:\nbne $a1, $0, gen  #if (b==0)\naddi $v0, $0, 1 #$v0 (1)\nj rtn\n</code></pre>\n\n<p>Finally, you do not preserve the values of the function arguments before the recursive calls. If you want to be ABI compliant, you cannot assume the values in the function argument registers are preserved across the call.</p>\n\n<p>In particular after</p>\n\n<pre><code>##recursive call\ngen:\naddi $a0, $a0, -1 #$a0 (a-1)\naddi $a1, $a1, -1 #$a1 (b-1)\njal comb  #call comb(a-1, b-1)\n</code></pre>\n\n<p>the following</p>\n\n<pre><code>add $s0, $v0, $0  #$s0 comb(a-1, b-1)\naddi $a1, $a1, 1  #$a1 (b)\njal comb  #call comb(a-1, b)\n</code></pre>\n\n<p>will have incorrect values for <code>$a0</code> and <code>$a1</code>.</p>\n\n<p>If ABI compliance does not matter to you, you could restore the values before returning by incrementing the arguments again.</p>\n"}], "owner": {"reputation": 23, "user_id": 10485894, "user_type": "registered", "profile_image": "https://graph.facebook.com/2294503090778101/picture?type=large", "display_name": "Yoom", "link": "https://stackoverflow.com/users/10485894/yoom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 52748583, "answer_count": 2, "score": 2, "last_activity_date": 1539204580, "creation_date": 1539198183, "last_edit_date": 1539198222, "question_id": 52747125, "link": "https://stackoverflow.com/questions/52747125/convert-c-code-to-mips-assembly-combination-function-using-recursion", "title": "convert C code to MIPS assembly - combination function using recursion", "body": "<p>I have a problem with conversing C code to MIPS assembly code of combination function (nCr).</p>\n\n<p>nCr = (n-1Cr-1) + (n-1Cr)</p>\n\n<p>and when I put int 5 for n and 3 for r (digit data), the result has to be 10.</p>\n\n<p>I want to use the recursion and stack pointer, but I have an error with stack overflow.</p>\n\n<p>I have my MIPS code below.</p>\n\n<p>What's wrong with my code?</p>\n\n<p>I cannot recognize the problem well...</p>\n\n\n\n<pre><code>##data\n.data\ndigit: .word 5, 3\n\n.text\n.globl main\n\nmain:\n##load data\nla $t0, digit\nlw $a0, 0($t0)  #put 5 in a\nlw $a1, 4($t0)  #put 3 in b\n\n##call Function comb\njal comb\n##save return value in $t1\nmove $t1, $v0\n\n##print result\nli $v0, 1\nadd $a0, $0, $t1\nsyscall\n\n##exit\nli $v0, 10\nsyscall\n\n##Function int comb(int a, int b)\ncomb:\naddi $sp, $sp, -8\nsw $ra, 4($sp)\nsw $s0, 0($sp)\n\n##base case\nbne $a0, $a1, gen  #if (a==b)\naddi $v0, $0, 1 #$v0 (1)\nj rtn\nbne $a1, $0, gen  #if (b==0)\naddi $v0, $0, 1 #$v0 (1)\nj rtn\n\n##recursive call\ngen:\naddi $a0, $a0, -1 #$a0 (a-1)\naddi $a1, $a1, -1 #$a1 (b-1)\njal comb  #call comb(a-1, b-1)\nadd $s0, $v0, $0  #$s0 comb(a-1, b-1)\naddi $a1, $a1, 1  #$a1 (b)\njal comb  #call comb(a-1, b)\nadd $v0, $v0, $s0 #$v0 (comb(a-1, b-1) + comb(a-1, b))\nj rtn\n\nrtn:\nlw $s0, 0($sp)\nlw $ra, 4($sp)\naddi $sp, $sp, 8\njr $ra\n\n.end\n</code></pre>\n"}, {"tags": ["c", "factors", "factorization"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1539197904, "post_id": 52746812, "comment_id": 92418647, "body": "The description of the algorithm on the linked page is stating very clear that the algorithm does not guarantee factorization of all of the numbers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539198818, "post_id": 52746812, "comment_id": 92419069, "body": "Post your <code>uint64_t gcd(uint64_t, uint64_t)</code> implementation. and a  <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is needed to reproduce your &quot;testing that function and noticed that the function is failing to find a factor of 27.&quot;"}, {"owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "edited": false, "score": 0, "creation_date": 1539199451, "post_id": 52746812, "comment_id": 92419361, "body": "I am using the builtin gcd function of C++ STL. And I replaced uint64_t with long long int type. Everything else is the same as the given code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539199759, "post_id": 52746812, "comment_id": 92419501, "body": "<code>long long int</code> is not the same as <code>uint64_t</code> in terms of signedness at the very least."}, {"owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "edited": false, "score": 0, "creation_date": 1539200014, "post_id": 52746812, "comment_id": 92419613, "body": "But I have also tried using unsigned long long int type. It still fails for 27."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1539201058, "post_id": 52746812, "comment_id": 92420062, "body": "It is obligatory for almost all factorization algorithms to check for if the number <code>N</code> can be expressed as <code>n^k</code> with <code>{n,k}</code> in <b>N</b>. so use a quick nth-root test (e.g.: with Newton for these small numbers) for all <code>p &lt;= log_2(N)</code> with <code>p</code> prime to save some work. A small sieve might come handy here. You also have to check for <code>N</code> being prime, the deterministic form of the Rabin-Miller test will do for 64 bit small integers."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "edited": false, "score": 0, "creation_date": 1539246387, "post_id": 52749511, "comment_id": 92434181, "body": "Is there any way to handle this so that the code can find factors for these numbers (except primes)?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "edited": false, "score": 0, "creation_date": 1539247780, "post_id": 52749511, "comment_id": 92435033, "body": "@SadmanRizwan I won&#39;t pretend to fully understand the theory behind this algorithm, I can only guess that in those cases you can consider it to fail and fallback to another factorization method."}, {"owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "edited": false, "score": 0, "creation_date": 1539247987, "post_id": 52749511, "comment_id": 92435143, "body": "As far as I know, this algorithm should find a factor for any number except primes. Maybe I need to change a few logics in that code. Thanks for your help anyway."}], "tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1539282489, "last_edit_date": 1539282489, "creation_date": 1539209789, "answer_id": 52749511, "question_id": 52746812, "link": "https://stackoverflow.com/questions/52746812/shankss-square-form-factorization-implementation/52749511#52749511", "title": "Shanks&#39;s square form factorization implementation", "body": "<p>The algorithm in the Wikipedia page doesn't check if the denominators of any of the integer divisions are equal to zero.</p>\n\n<p>I tested a <a href=\"https://wandbox.org/permlink/qW82W0fT9kipd7sB\" rel=\"nofollow noreferrer\">slightly modified version of it</a> (I also used C++, which is probably what the OP actually used, as they mention the use of \"gcd function of C++ STL\" in the comments) for the first 32768 values of N, obtaining:</p>\n\n<pre>\nN:      3  Q == 0 in the first division\nN:      5  Q == 0 in the first division\nN:      7  Q == 0 in the first division\nN:     11  Q == 0 in the first division\nN:     27  Q == 0 in the first division\nN:    363  Q == 0 in the first division\nN:    867  Q == 0 in the first division\nN:   1445  Q == 0 in the first division\nN:   5043  Q == 0 in the first division\nN:   6845  Q == 0 in the first division\nN:   7803  Q == 0 in the first division\nN:  10443  Q == 0 in the first division\nN:  11163  Q == 0 in the first division\nN:  13467  Q == 0 in the first division\nN:  14283  Q == 0 in the first division\nN:  18491  Q == 0 in the first division\nN:  18723  Q == 0 in the first division\nN:  23763  Q == 0 in the first division\nN:  30603  Q == 0 in the first division\nN:  31827  Q == 0 in the first division\n</pre>\n\n<p>You'll notice that the first cases are prime numbers and are also present in the <code>multipliers</code> array.</p>\n\n<p>Before the inner loop where the first division is performed, the variable <code>Q</code> is calculated essentially as</p>\n\n<pre><code>D = multiplier[k]*N;\nPo = sqrtl(D);\nQ = D - Po*Po;\n</code></pre>\n\n<p>So, <code>Q</code> is zero, when <code>D</code> is a perfect square. You can take care of these corner cases adding a few lines of <a href=\"https://wandbox.org/permlink/DlvpGrgwcJZZ28BK\" rel=\"nofollow noreferrer\">code</a>:</p>\n\n<pre><code>const uint64_t multiplier[] = {\n    1, 3, 5, 7, 11, 3*5, 3*7, 3*11, 5*7, 5*11, 7*11, 3*5*7,\n    3*5*11, 3*7*11, 5*7*11, 3*5*7*11\n};\nconst uint64_t results[] = {\n    1, 0, 0, 0, 0, 3, 3, 3, 5, 5, 7, 3, 3, 3, 5, 3\n};\n    // ... inside the k loop\n    if ( multiplier[k] == N )   \n        return results[k];\n    // ... calculate Q as before\n    if (Q == 0) \n        return std::gcd(multiplier[k], N);\n    // ... rest of the loop\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 7274008, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-JFwi9UvaecM/AAAAAAAAAAI/AAAAAAAAAlE/k6PnWuaJhb4/photo.jpg?sz=128", "display_name": "Sadman Rizwan", "link": "https://stackoverflow.com/users/7274008/sadman-rizwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539282489, "creation_date": 1539196916, "last_edit_date": 1539197506, "question_id": 52746812, "link": "https://stackoverflow.com/questions/52746812/shankss-square-form-factorization-implementation", "title": "Shanks&#39;s square form factorization implementation", "body": "<p>Recently I have been studying about Shanks's square form factorization from this <a href=\"https://en.wikipedia.org/wiki/Shanks%27s_square_forms_factorization\" rel=\"nofollow noreferrer\">wiki page</a>\nAn implementation in C is provided on that page. I was testing that function and noticed that the function is failing to find a factor of 27.</p>\n\n<p>This is the given C function:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n#define nelems(x) (sizeof(x) / sizeof((x)[0]))\n\nconst int multiplier[] = {1, 3, 5, 7, 11, 3*5, 3*7, 3*11, 5*7, 5*11, 7*11, 3*5*7, 3*5*11, 3*7*11, 5*7*11, 3*5*7*11};\n\nuint64_t SQUFOF( uint64_t N )\n{\n    uint64_t D, Po, P, Pprev, Q, Qprev, q, b, r, s;\n    uint32_t L, B, i;\n    s = (uint64_t)(sqrtl(N)+0.5);\n    if (s*s == N) return s;\n    for (int k = 0; k &lt; nelems(multiplier) &amp;&amp; N &lt;= UINT64_MAX/multiplier[k]; k++) {\n        D = multiplier[k]*N;\n        Po = Pprev = P = sqrtl(D);\n        Qprev = 1;\n        Q = D - Po*Po;\n        L = 2 * sqrtl( 2*s );\n        B = 3 * L;\n        for (i = 2 ; i &lt; B ; i++) {\n            b = (uint64_t)((Po + P)/Q);\n            P = b*Q - P;\n            q = Q;\n            Q = Qprev + b*(Pprev - P);\n            r = (uint64_t)(sqrtl(Q)+0.5);\n            if (!(i &amp; 1) &amp;&amp; r*r == Q) break;\n            Qprev = q;\n            Pprev = P;\n        };\n        if (i &gt;= B) continue;\n        b = (uint64_t)((Po - P)/r);\n        Pprev = P = b*r + P;\n        Qprev = r;\n        Q = (D - Pprev*Pprev)/Qprev;\n        i = 0;\n        do {\n            b = (uint64_t)((Po + P)/Q);\n            Pprev = P;\n            P = b*Q - P;\n            q = Q;\n            Q = Qprev + b*(Pprev - P);\n            Qprev = q;\n            i++;\n        } while (P != Pprev);\n        r = gcd(N, Qprev);\n        if (r != 1 &amp;&amp; r != N) return r;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Is this a bug of the given implementation on that page? Can this algorithm fail to find factor for some numbers?</p>\n"}, {"tags": ["c", "time-complexity"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1539195672, "post_id": 52746514, "comment_id": 92417616, "body": "Constant time is O(1)."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1539196203, "post_id": 52746514, "comment_id": 92417860, "body": "Assume that <code>n</code> is the number of bits. The complexity is <code>O(n)</code>. O notation can be a bit tricky. <code>O(2n)</code> is still <code>O(n)</code>. Consider that a simple sort like bubble sort, shell short, etc. have a complexity of <code>O(n**2)</code>. So it&#39;s more about the largest term in the polynomial: If you had an algorithm that had complexity of: <code>O(3n**3 + 97*n**2 + 23n)</code>, the complexity would be <code>O(n**3)</code> because when <code>n</code> diverges, <code>O(n**3)</code> [eventually] swamps the other terms"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1539199160, "post_id": 52746514, "comment_id": 92419213, "body": "Be aware there are two uses of complexity. One is theoretical, where every bit manipulation counts, and we care about the complexity of an algorithm as a function of the number of bits of its input. Another is practical, where we assume a computer with a fixed-word size and care about the complexity of an algorithm as a function of its input value(s) or other sizes, given that elementary operations on words perform in constant time. The latter ignores growth beyond the word size; it is only concerned with growth within the computer\u2019s limits."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1539199260, "post_id": 52746514, "comment_id": 92419264, "body": "In any case, it is unusual to be concerned much about the complexity of bit-reversal. It is not an interesting problem theoretically, and the complexity is either O(<i>n</i>) if you have to reverse the bits yourself or O(1) if the processor has a built-in instruction for it. It is more common to be concerned with the actual performance of a bit-reversal function (such as wanting to optimize it for a specific processor). But you do not ask about that, so it is a bit puzzling why you ask."}, {"owner": {"reputation": 545, "user_id": 8654234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ffdff2f2d5422e6f5b150fa7ff73308?s=128&d=identicon&r=PG&f=1", "display_name": "suresh m", "link": "https://stackoverflow.com/users/8654234/suresh-m"}, "edited": false, "score": 0, "creation_date": 1539230921, "post_id": 52746514, "comment_id": 92428044, "body": "I am concerned about the time complexity of the bit reverse function for this problem."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1539261273, "post_id": 52746514, "comment_id": 92443397, "body": "For strictly-compliant C code, <code>sizeof(unsigned int) * 8</code> should be <code>sizeof(unsigned int) * CHAR_BIT</code>, along with <code>#include &lt;limits.h&gt;</code>  See <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.2.4.2.1\" rel=\"nofollow noreferrer\"><b>5.2.4.2.1 Sizes of integer types &lt;limits.h&gt;</b></a>."}], "answers": [{"tags": [], "owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "is_accepted": false, "score": 0, "last_activity_date": 1567713133, "last_edit_date": 1567713133, "creation_date": 1539197076, "answer_id": 52746855, "question_id": 52746514, "link": "https://stackoverflow.com/questions/52746514/time-complexity-of-bit-reverse-function-in-c/52746855#52746855", "title": "Time complexity of bit reverse function in C", "body": "<p><strong><em>O(n)</em>, for <em>n</em> bits.</strong></p>\n\n<p>For <code>uint_8</code>, the algorithm runs in 8 steps.<br>\nFor <code>uint_16</code>, the alrogithm runs in 16 steps.</p>\n\n<p>etc.</p>\n\n<hr>\n\n<p>I'm no expert, but some instructions sets might have a one-cycle bit reverse (use <code>__asm__</code>), so you can run in O(n) for n <em>bytes</em>; eight times faster. Some compilers might do this automgically if you use <code>-O3</code>.</p>\n"}], "owner": {"reputation": 545, "user_id": 8654234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ffdff2f2d5422e6f5b150fa7ff73308?s=128&d=identicon&r=PG&f=1", "display_name": "suresh m", "link": "https://stackoverflow.com/users/8654234/suresh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1567713133, "creation_date": 1539195607, "question_id": 52746514, "link": "https://stackoverflow.com/questions/52746514/time-complexity-of-bit-reverse-function-in-c", "title": "Time complexity of bit reverse function in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nunsigned int reverseBits(unsigned int num)\n{\n    unsigned int reverse_num = 0;\n    for(int i = 0; i &lt; sizeof(unsigned int) * 8; ++i)\n    {   \n        reverse_num = (reverse_num | (num &amp; 1));\n        num = num &gt;&gt; 1;\n        if(i != (sizeof(unsigned int) * 8) - 1)\n            reverse_num = reverse_num &lt;&lt; 1;\n    }   \n    return reverse_num;\n}\n\nint main()\n{\n    unsigned int num = 0;\n    scanf(\"%u\", &amp;num);\n    printf(\"bit reverse of %u is %u\\n\", num, reverseBits(num));\n    return 0;\n}\n</code></pre>\n\n<p>What is the time complexity of this bit reversing function, if we change the input size to uint_8/uint_16/uint64_t, the for loop runs for the size of the input * 8 times. This functions runs in a constant time for n inputs. so what is the time complexity of this function in big \"O\" notation?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1539193300, "post_id": 52745942, "comment_id": 92416562, "body": "What is the problem with the existing code?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1539193569, "post_id": 52745942, "comment_id": 92416682, "body": "ask a question please"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539193586, "post_id": 52745942, "comment_id": 92416689, "body": "also please post all the code"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1539194699, "post_id": 52745942, "comment_id": 92417159, "body": "the relevant code from main() is missing.   also what&#39;s <code>command</code> supposed to be? your code is not testable please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 21, "user_id": 10470248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0a98b741456ad7ae683c2b0f808874?s=128&d=identicon&r=PG&f=1", "display_name": "rosy", "link": "https://stackoverflow.com/users/10470248/rosy"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1539195643, "post_id": 52745942, "comment_id": 92417605, "body": "@user3121023 Thankyou sir. it worked"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1539193541, "creation_date": 1539193541, "answer_id": 52746009, "question_id": 52745942, "link": "https://stackoverflow.com/questions/52745942/parsing-the-command-and-passing-the-filepath-into-fopen/52746009#52746009", "title": "Parsing the command and passing the filepath into fopen", "body": "<p>You are using an <code>strtok_r</code>-internal data item, which actually shall not be used but just be passed in successive calls to <code>strtok_r</code>.</p>\n\n<p>Write</p>\n\n<pre><code>command = strtok(buf,\" \");\nif (command) {\n   ....\n</code></pre>\n\n<p>instead.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1539194148, "post_id": 52746043, "comment_id": 92416924, "body": "<code>content == EOF</code> can be true if <code>char</code> is signed, but there another problem is distinguishing data <code>0xFF</code> from <code>EOF</code>. That is a reason why so many coders &quot;get away with it&quot; when processing a text file not containing that ambiguous data."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1539193981, "last_edit_date": 1539193981, "creation_date": 1539193694, "answer_id": 52746043, "question_id": 52745942, "link": "https://stackoverflow.com/questions/52745942/parsing-the-command-and-passing-the-filepath-into-fopen/52746043#52746043", "title": "Parsing the command and passing the filepath into fopen", "body": "<p>I will guess the issue</p>\n\n<p><code>fgetc</code> returns an <code>int</code> not a <code>char</code>. see <a href=\"https://linux.die.net/man/3/fgetc\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/fgetc</a>\n So this can never be true</p>\n\n<pre><code>while (content != EOF)\n</code></pre>\n\n<p>so declare content as <code>int</code>;</p>\n"}], "owner": {"reputation": 21, "user_id": 10470248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0a98b741456ad7ae683c2b0f808874?s=128&d=identicon&r=PG&f=1", "display_name": "rosy", "link": "https://stackoverflow.com/users/10470248/rosy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1539201622, "creation_date": 1539193209, "last_edit_date": 1539201622, "question_id": 52745942, "link": "https://stackoverflow.com/questions/52745942/parsing-the-command-and-passing-the-filepath-into-fopen", "title": "Parsing the command and passing the filepath into fopen", "body": "<p>The issues is in the pointer I guess. Please suggest any method to receive a command like \"cat serverpath or filepath\" and parse the command and to pass the path into <code>fopen(filepath, \"r\")</code>.</p>\n\n<p>Here is the code for server:</p>\n\n<pre><code>time_t  start;\nchar    buf[BUFSIZ], *command, content;\nint n,i;\nFILE *fptr;\n\nstart = time(0);\n(void) pthread_mutex_lock(&amp;stats.st_mutex);\nstats.st_concount++;\n(void) pthread_mutex_unlock(&amp;stats.st_mutex);\nwhile (1) {\n    bzero(buf, BUFSIZ);\n    n = recv(fd, buf, BUFSIZ, 0);\n    if (n &lt; 0){\n        errexit(\"echo read: %s\\n\", strerror(errno));\n    }\n    else{\n        printf(\"The client message: %s\\n\",buf);\n    }\n\n    strtok_r (buf, \" \", &amp;command);\n    printf(\"%s\\n\", buf);\n    printf(\"%s\\n\",command);\n\n    //char filename[100], c; \n\n    // printf(\"Enter the filename to open \\n\"); \n    // scanf(\"%s\", command); \n\n    // Open file \n    fptr = fopen(command, \"r\"); \n    if (fptr == NULL) \n    { \n        printf(\"Cannot open file \\n\"); \n        exit(0); \n    } \n\n    // Read contents from file \n    content = fgetc(fptr); \n    while (content != EOF) \n    { \n        printf (\"%c\", content); \n        content = fgetc(fptr); \n    } \n</code></pre>\n\n<p>I get an error in fopen.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 2, "creation_date": 1539192835, "post_id": 52745743, "comment_id": 92416363, "body": "I cannot imagine that this program is constantly asking for input. The only <code>scanf</code> is not appearing in any loop..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539192855, "post_id": 52745743, "comment_id": 92416371, "body": "Can you show your sample input/output session? The questions make a little sense."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539192930, "post_id": 52745743, "comment_id": 92416404, "body": "Also please show the <code>&#47;* adding libraries here*&#47;</code> part."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1539192992, "post_id": 52745743, "comment_id": 92416431, "body": "I don&#39;t see how you print anything with <code>printf(&quot;The sum of sequence&#39;s elements above %f is: %f\\n\\n&quot;, &amp;E, &amp;sum);</code> please read warning, this should be <code>printf(&quot;The sum of sequence&#39;s elements above %f is: %f\\n\\n&quot;, E, sum);</code>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1539193003, "post_id": 52745743, "comment_id": 92416436, "body": "Just a suggestion: instead of writing a comment to explain that the job of <code>calele</code> Is to \u201cCALculate an ELEment\u201d, name it <code>calculate_element</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1539193383, "post_id": 52745743, "comment_id": 92416597, "body": "Asking for E a second time indicates that you&#39;re running an old version of the code. Try deleting the executable, then recompile and make sure that you got a new executable. Note that you have two warnings, so if you&#39;re compiling with <code>-Werror</code> then you definitely won&#39;t get a new executable."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539193464, "post_id": 52745743, "comment_id": 92416637, "body": "Having corrected the <code>printf</code> mistake when I enter <code>0.002</code> the output is <code>... 1.769577</code>. Note that <code>b &lt;= 1.0</code> because of <code>fabs( cos(a) )&#47;a;</code> where <code>a &gt;= 1</code>. Any input &gt; <code>0.54</code> gives an output of <code>0.000000</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539193598, "post_id": 52745743, "comment_id": 92416693, "body": "@EugeneSh. as it happens the libraries are not needed. Perhaps this is a MCVE from fuller code which might explain why OP says it runs twice."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1539200346, "post_id": 52745743, "comment_id": 92419752, "body": "You really, really need to take a step back. <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 3, "user_id": 10485409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6906660f9a146a30979357586b10e959?s=128&d=identicon&r=PG&f=1", "display_name": "George M.", "link": "https://stackoverflow.com/users/10485409/george-m"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539202276, "post_id": 52745743, "comment_id": 92420617, "body": "@EugeneSh. here u are: #include &lt;stdio.h&gt; #include &lt;math.h&gt; #include &lt;stdlib.h&gt; // stdlib.h provides abs() function"}, {"owner": {"reputation": 3, "user_id": 10485409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6906660f9a146a30979357586b10e959?s=128&d=identicon&r=PG&f=1", "display_name": "George M.", "link": "https://stackoverflow.com/users/10485409/george-m"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539202435, "post_id": 52745743, "comment_id": 92420683, "body": "@EugeneSh. It works now, but i still have to type E twice. The prompt doesn&#39;t  appear at the second time, but the whole thing works only after i reenter my E.  typical output:  Enter sequense&#39;s lower limit: 0.002  0.002 The sum of sequence&#39;s elements above 0.002000 is: 1.769577  Program ended with exit code: 0"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539202492, "post_id": 52745743, "comment_id": 92420709, "body": "Try <code>scanf(&quot; %f&quot;, &amp;E);</code> (note the leading space)"}, {"owner": {"reputation": 3, "user_id": 10485409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6906660f9a146a30979357586b10e959?s=128&d=identicon&r=PG&f=1", "display_name": "George M.", "link": "https://stackoverflow.com/users/10485409/george-m"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539202646, "post_id": 52745743, "comment_id": 92420783, "body": "@EugeneSh. Wow, it helped. would you please explain why such a mess happened without &quot;leading space&quot;?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539202798, "post_id": 52745743, "comment_id": 92420854, "body": "The leading space in format string will &quot;consume&quot; all of the whitespace characters (including newline) which might happen to get stuck in your input stream. Not sure why you have these in your case, but that&#39;s it."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1539198910, "last_edit_date": 1539198910, "creation_date": 1539192977, "answer_id": 52745888, "question_id": 52745743, "link": "https://stackoverflow.com/questions/52745743/code-seems-good-but-why-does-it-ask-for-e-two-times-and-constantly-prints-0-000/52745888#52745888", "title": "Code seems good, but why does it ask for E two times and constantly prints 0.000?", "body": "<p>I cannot reproduce the \"Why is it constantly asking for second E\" - thing.\nYet \"Why does it print zeroes as a result no matter what\" is because you pass <code>&amp;E</code> and <code>&amp;sum</code> to <code>printf</code>; I.e., you are passing pointers where float values are expected and thereby yield undefined behaviour.  Instead, write</p>\n\n<pre><code>printf(\"The sum of sequence's elements above %f is: %f\\n\\n\", E, sum);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10485409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6906660f9a146a30979357586b10e959?s=128&d=identicon&r=PG&f=1", "display_name": "George M.", "link": "https://stackoverflow.com/users/10485409/george-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1539208291, "answer_count": 1, "score": -2, "last_activity_date": 1539198910, "creation_date": 1539192419, "last_edit_date": 1539198864, "question_id": 52745743, "link": "https://stackoverflow.com/questions/52745743/code-seems-good-but-why-does-it-ask-for-e-two-times-and-constantly-prints-0-000", "closed_reason": "Not suitable for this site", "title": "Code seems good, but why does it ask for E two times and constantly prints 0.000?", "body": "<p>I'm trying to debug my homework program. It looks good to me, but doesn't seem to work correctly.</p>\n\n<p>Here is the task: <code>{Xn} = |COSn|/n ----&gt;0</code> is a arithmetic sequence with '0' limit. The goal is to count all sequence's elements sum until some nth's element's absolute value becomes &lt; then E (taken from the user).</p>\n\n<p>Here is code:</p>\n\n<pre><code>/* {Xn} = |COSn|/n - is a sequence programm works with*/\n\n#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\n/* adding libraries here*/\n\nfloat calele(float a) // A function to CALculate an ELEment\n{\n    float b;\n    b = fabs( cos(a) )/a; // {Xn} = |COSn|/n\n    return b;\n}\n\nfloat seqsum(float E) //function, that counts sum. \n                      //\"calele\" function is used\n{\n    int n=1;\n    float sum = 0.0;\n    while( fabs(calele(n)) &gt;= E) //if absolute value of counted element is still &gt;= then user's E\n    {\n        sum = sum+calele(n); // then we add it so sum\n        n = n+1;\n    }\n   return sum; // as soon as counted element becomes &lt; then user's E, programm stops and returns the sum\n}\n\nint main(void)\n{\n    float E = 0; // Declaring E's variable\n    float sum = 0; // sum of sequence's elements\n\n    printf(\"Enter sequense's lower limit: \"); // Prompting the user for the E\n    scanf(\"%f\", &amp;E); // Getting E from the user\n    sum = seqsum(E); // counting sum via function above\n    printf(\"The sum of sequence's elements above %f is: %f\\n\\n\", &amp;E, &amp;sum);\n\n    return 0;\n}\n</code></pre>\n\n<p>QUESTIONS:</p>\n\n<ol>\n<li>Why dosen't it work properly ?   </li>\n<li>Why is it constantly asking for second E?  </li>\n<li>Why does it print zeroes as a result no matter what ?  </li>\n</ol>\n"}, {"tags": ["c", "performance", "sockets"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1539190356, "post_id": 52745164, "comment_id": 92415070, "body": "Can you include the relevant code in the question and not as an external link? This helps keep your question self-contained and focused on the problem."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1539190413, "post_id": 52745164, "comment_id": 92415101, "body": "I&#39;m presuming &quot;before I got into doing things like select() or epoll()<code>&quot; means you&#39;re flooding the write buffer without realizing it. You need </code>select` or equivalent to tell you when the socket is <i>ready to write</i> and you must pay attention or the stack will just throw out your writes."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 2, "creation_date": 1539191120, "post_id": 52745164, "comment_id": 92415460, "body": "Running netstat on your computer after each test might be informative -- TCP sockets often stick around in the kernel for a short time after they are closed by the program (to avoid unintended reuse of old connections, IIRC), and it might be the kernel&#39;s socket-table that is getting temporarily filled up."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1539191196, "post_id": 52745164, "comment_id": 92415496, "body": "Could you elaborate a bit more on &quot;<i>It&#39;ll temporarily &#39;crash&#39; the server for a few seconds</i>&quot;?"}, {"owner": {"reputation": 31, "user_id": 9694271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James Huddle", "link": "https://stackoverflow.com/users/9694271/james-huddle"}, "edited": false, "score": 0, "creation_date": 1539193692, "post_id": 52745164, "comment_id": 92416743, "body": "The link that I included has code for both an echo server and an echo client.  I copied both programs, character for character from this machine to my air-gapped machine.  So... in the code (I just copied) below, where it says &quot;Die(&quot;failed to connect to server&quot;);&quot;  that&#39;s what I mean by &#39;crash&#39;ing.  Obviously the server didn&#39;t crash, but the error message hinted at a connectivity issue.  Here is the relevant code (the client code) without link:             (in a minute - it&#39;s too long to just post the whole program)"}, {"owner": {"reputation": 31, "user_id": 9694271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James Huddle", "link": "https://stackoverflow.com/users/9694271/james-huddle"}, "edited": false, "score": 0, "creation_date": 1539195702, "post_id": 52745164, "comment_id": 92417634, "body": "`   for(i=0; i&lt;CLIENT; i++)   { ...     if (connect(sock[i], (struct sockaddr *) &amp;echoserver[i], sizeof(echoserver[i])) &lt; 0) Die(&quot;Failed to connect with server&quot;);      echolen = strlen(argv[2]);     if (send(sock[i], argv[2], echolen, 0) != echolen) Die(&quot;!&quot;);      while (received &lt; echolen) {       int bytes = 0;       if ((bytes = recv(sock, buffer, BUFFSIZE-1, 0)) &lt; 1) Die(&quot;!rcv&quot;);       received += bytes;       buffer[bytes] = &#39;\\0&#39;;     }     close(sock[i]);   } `"}, {"owner": {"reputation": 31, "user_id": 9694271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James Huddle", "link": "https://stackoverflow.com/users/9694271/james-huddle"}, "edited": false, "score": 0, "creation_date": 1539196419, "post_id": 52745164, "comment_id": 92417955, "body": "thanks, tadman, I probably am flooding the write buffer.  I&#39;ll check it out."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1539209207, "post_id": 52745164, "comment_id": 92423235, "body": "<code>if ((bytes = recv(sock[i], buffer[i], BUFFSIZE-1, 0)) &lt; 1) Die(&quot;!rcv&quot;);</code> if read or write return -1, you should always check <code>errno</code> , and act appropiately."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9694271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James Huddle", "link": "https://stackoverflow.com/users/9694271/james-huddle"}, "is_accepted": false, "score": 0, "last_activity_date": 1539227727, "last_edit_date": 1539227727, "creation_date": 1539227423, "answer_id": 52751585, "question_id": 52745164, "link": "https://stackoverflow.com/questions/52745164/c-sockets-mysterious-slowdown-on-air-gapped-linux-laptop/52751585#52751585", "title": "c sockets mysterious slowdown on air-gapped Linux laptop", "body": "<p>Netstat wins the day.  Thanks commentator Jeremy Friesner.  The trouble was the sockets remained open in a <code>TIME_WAIT</code> state.  Of course I'll continue to try to wriggle around that one.  It seems like <code>TIME_WAIT</code> is an inevitability.  If so, I'd like to be able to up the System's <code>MAX_OPEN</code> to a value larger than 16384.  Comments on that one are more than welcome.  If I solve it, I'll comment, myself.  <code>TIME_WAIT</code> lasts precisely 60 seconds on my laptop.  How do I know this?  <code>date; netstat | wc</code>... I'll be honest, I've never been a big fan of netstat, netcat, nc, or other systools that spew volumes of info.  But that was the silly, pre-enlightened me.  netstat good.  Thanks to the other commentors who nudged me in the right direction, as well.  Thanks, man named tad...  Thanks, just alk...</p>\n"}], "owner": {"reputation": 31, "user_id": 9694271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James Huddle", "link": "https://stackoverflow.com/users/9694271/james-huddle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1539227727, "creation_date": 1539190168, "last_edit_date": 1539205307, "question_id": 52745164, "link": "https://stackoverflow.com/questions/52745164/c-sockets-mysterious-slowdown-on-air-gapped-linux-laptop", "title": "c sockets mysterious slowdown on air-gapped Linux laptop", "body": "<p>I coded a simple echo server (from <a href=\"http://gnosis.cx/publish/programming/sockets.html\" rel=\"nofollow noreferrer\">http://gnosis.cx/publish/programming/sockets.html</a>) in C and everything worked well on localhost.  Then I decided to try connecting in a tight loop of 10,000 'client' hits to the server.  It failed immediately claiming that I had opened too many files.  So I scaled back to 1022 and it worked (1022 connections made, data sent and received).  I also found that I could override the upper limit (which also worked, 4094 in non-privileged, lots - 1M? - in privileged mode).  I was feeling pretty good, but before I got into doing things like <code>select()</code> or <code>epoll()</code>, I decided to stress-test the non-privileged run.  I can connect and send 4000 (I avoided the vicinity of 4096) times in about 0.5 seconds (without <code>printf()</code> logging).  I can do that three times in a row with almost identical timings.  The fourth time takes about 6.0 seconds. And then I get times of around 11.0 seconds.  Same client program (sending 4000 5-letter words) UNCHANGED server program (with only FIVE as a value for <code>MAXPENDING</code>)...  After about 3 or four runs where I wait for 11.2097 seconds, it goes back to 0.5 seconds (for three) and then 6 seconds, and then 11 seconds again. -- It FEELS like I'm using up some kind of pool (around 12 or 13,000?) that is there for the taking, and then needs to be garbage collected.... slowly...  I would gladly do things differently, but I don't know what the problem or its solution.  I also moved the server to a VM with its own IP <code>addr</code> with absolutely identical results.  Can anyone tell me what might be going on behind the scenes and what the best practice is to manage it?</p>\n\n<p>I thought it might be solved by the <code>setsockopt(TCP_NODELAY)</code> to suppress Nagle's algorithm, but the results are identical: .5, .5, .5, 6, 11, 11, 11\nIt'll temporarily 'crash' the server for a few seconds if I repeat as fast as possible.  But eventually ('crash' or no 'crash'), we're back in business round-tripping 4000 'echoes' in 0.5 seconds.</p>\n\n<p>running gcc on 64-bit Ubuntu 18.04... gcc -v gives me:</p>\n\n<pre><code>Thread model: posix\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.10) \n\n\nfor(i=0; i&lt;CLIENT; i++)\n{\n    if (connect(sock[i], (struct sockaddr *) &amp;echoserver[i], sizeof(echoserver[i])) &lt; 0) Die(\"Failed to connect with server\");\n\n    echolen = strlen(argv[2]);\n    if (send(sock[i], argv[2], echolen, 0) != echolen) Die(\"!\");\n\n    while (received &lt; echolen) {\n      int bytes = 0;\n      if ((bytes = recv(sock[i], buffer[i], BUFFSIZE-1, 0)) &lt; 1) Die(\"!rcv\");\n      received += bytes;\n      buffer[i][bytes] = '\\0';\n    }\n    close(sock[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 0, "creation_date": 1539188865, "post_id": 52744814, "comment_id": 92414167, "body": "<i>Does offsetting it by 8 make it akin to 0x1000 + 8?</i> Yes, this is called <a href=\"http://chortle.ccsu.edu/assemblytutorial/Chapter-24/ass24_11.html\" rel=\"nofollow noreferrer\">indexed addressing</a>."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "reply_to_user": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 0, "creation_date": 1539189064, "post_id": 52744814, "comment_id": 92414284, "body": "Right! The book mentioned this when describing how pop and push worked in relation to the stack! It&#39;s beginning to make sense, but how do I know what addresses are IN my registry? Does each point of the registry each have addresses 0x1000 , 0x1004, 0x1008? Or do they all have the share addresses? (I feel like this book is simultaneously trying to get me to think and make fun of me with a knowing smile) Also, why offset it by 8 or 12 rather than 4 or 2?"}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1539189610, "post_id": 52744814, "comment_id": 92414623, "body": "There is no registry, only registers. That&#39;s something else. A register just holds a value (32 bit in your case). The meaning of this value is not something the processor is concerned about. Example: eax may contain 0x000003E8, and that may indicate your account balance of $1000 (0x3E8=1000) or it may be a memory address (a pointer), let&#39;s say to your name, which would be &quot;David&quot; with &quot;D&quot; at address 0x3E8, &quot;a&quot; at address 0x3E9, etc."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 1, "creation_date": 1539189673, "post_id": 52744814, "comment_id": 92414674, "body": "Now, if you store a structure of some sort, that is several values one after another, in memory, you usually get a pointer to (= the address of) the first value and access the following ones using an offset."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 0, "creation_date": 1539189876, "post_id": 52744814, "comment_id": 92414800, "body": "Okay, so a register holds a value, and the values can only be 32 bit, and the farther you go into a register. Like say. . . .%eax being the whole register, %ax being 15-31 in value and %ah being 8 - 15 in value, and %al being 0 - 7 in value, correct? So, if I were to hold something like 0x1008, it would be held in %al, but it would be in the register of %eax?"}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 1, "creation_date": 1539189993, "post_id": 52744814, "comment_id": 92414872, "body": "No no, you cannot go &quot;farther into a register&quot;. The register holds a value which may be intended as memory address. If it is, you need to look up your memory to see the value there, and so on. (You are right there are also al, ah, ax, which are only parts of the register. But that&#39;s unrelated to the 0x1000, 0x1004 thing.)"}, {"owner": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 0, "creation_date": 1539190100, "post_id": 52744814, "comment_id": 92414936, "body": "How do you know what values are in the registers? You do because your code is the one that loads the values into the registers :) The value in a register does not have to be a memory address, it can be any value (except of course if the register is explicitly specified to hold memory address, e.g. CS, DS and such). The offset is 8 because... I think you better read about the <a href=\"http://www.cs.virginia.edu/~evans/cs216/guides/x86.html#calling\" rel=\"nofollow noreferrer\">calling convention</a> in x86 :)"}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "reply_to_user": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 0, "creation_date": 1539190172, "post_id": 52744814, "comment_id": 92414981, "body": "@m0skit0 yare yare daze. . . @_@ but alright, I&#39;ll read about the calling convention."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1539190180, "post_id": 52744814, "comment_id": 92414987, "body": "What book are you reading?"}, {"owner": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 1, "creation_date": 1539190402, "post_id": 52744814, "comment_id": 92415096, "body": "Btw as a personal suggestion, x86 is not a recommended architecture to start learning computer architecture and assembly. It is overly complicated (mostly for historical reasons). I would recommend a RISC architecture like Motorola 68K or MIPS to get started. The general concepts are the same and the assembly is much simpler and straightforward."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1539190555, "post_id": 52744814, "comment_id": 92415180, "body": "@jwdonahue Computer Systems - A programmers perspective, 2nd edition."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "reply_to_user": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 0, "creation_date": 1539190591, "post_id": 52744814, "comment_id": 92415201, "body": "@m0skit0 understood"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1539192104, "post_id": 52744814, "comment_id": 92415974, "body": "If You switch optimizations the code will vanish"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 0, "creation_date": 1539198935, "post_id": 52744814, "comment_id": 92419117, "body": "@m0skit0 While I agree with that suggestion from an academic perspective, the truth is it is not as easy to come by architectures other than x86 where you can experiment with what you learned. x86 is abundant in examples and is everywhere, therefore offering the chance to write code you can actually put to use."}, {"owner": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1539376508, "post_id": 52744814, "comment_id": 92494686, "body": "@Havenard There are plenty of emulators for both architectures, and some devices that are MIPS can still be found (e.g. routers). I think for a beginner x86 is overkill to start with (segmentation, virtual 8086/32-bit/64-bit, protected mode, descriptor registers, pagination...). A RISC architecture will teach you the basics and once you feel comfortable enough you can jump to x86. I&#39;m saying this from my own experience."}], "answers": [{"comments": [{"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 2, "creation_date": 1539189470, "post_id": 52744956, "comment_id": 92414541, "body": "Note that you are using Intel syntax while the OP was using AT&amp;T syntax. To avoid confusion: One of the most important differences is that most <i>arguments are reversed</i>, so <code>mov ebp, esp</code> would be <code>movl %esp, %ebp</code> and so on."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 0, "creation_date": 1539189485, "post_id": 52744956, "comment_id": 92414548, "body": "I see, but shouldn&#39;t ebp+2 hold something as well? Furthermore what about ebp+1 aka 0x1000? (If I&#39;m getting my math right.)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1539189545, "post_id": 52744956, "comment_id": 92414582, "body": "No, <code>ebp+2</code> would not anything real (of course it holds something), because addresses and ints here are 32 bit (= 4 bytes)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1539189615, "post_id": 52744956, "comment_id": 92414627, "body": "@CherryDT, thanks for the clarification. Unfortunately I don&#39;t &quot;speak&quot; the AT&amp;T dialect."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 0, "creation_date": 1539189616, "post_id": 52744956, "comment_id": 92414629, "body": "Alright, so ebp+2 EXISTS, but it doesn&#39;t HOLD anything, and because all of the addresses are 32 BIT, they can each only hold information in increments of 2^x % 4 &lt;= 32, correct?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1539189796, "post_id": 52744956, "comment_id": 92414745, "body": "increments of 32 bits, that is correct. Note that for example chars are converted to ints before being pushed as well."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "reply_to_user": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 1, "creation_date": 1539189797, "post_id": 52744956, "comment_id": 92414746, "body": "@The_Senate well they do hold something, but it&#39;s useless. Let&#39;s say we have a structure of two DWORDs (DWORD=32-bit value) with values 0x11223344 stored at address 0x1000 and 0xAABBCCDD at address 0x1004. Since such values are stored in a &quot;bottom-up&quot; byte order, in memory you would see this: [...]"}, {"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1539189799, "post_id": 52744956, "comment_id": 92414749, "body": "shouldn&#39;t the <code>add esp...&#39; be a </code>sub esp...&#39; seeing as how the stack grows down?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1539189836, "post_id": 52744956, "comment_id": 92414772, "body": "@thurizas, yes! Thanks."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 1, "creation_date": 1539189898, "post_id": 52744956, "comment_id": 92414812, "body": "[...] 44 33 22 11 DD CC BB AA. That is, 0x1000 holds 0x44, 0x1001 holds 0x33, etc. - Now if you look at &quot;a DWORD stored at 0x1000&quot;, you see 0x11223344, and &quot;a DWORD stored at 0x1004&quot; you see 0xAABBCCDD, as expected. But &quot;a DWORD stored at 0x1002&quot; would be useless, as you&#39;d read 0xCCDD1122."}, {"owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "reply_to_user": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1539193682, "post_id": 52744956, "comment_id": 92416739, "body": "@CherryDT Okay, but one thing I&#39;m having a hard time grasping is how 0x1000 and 0x10004 relate to other parts of the register such as : (Let&#39;s consider %eax, then we have %ax and %ah and %al. How do these relate to 0x1000 and 0x1004 and 0x1008 and so on?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1539194814, "post_id": 52744956, "comment_id": 92417221, "body": "The 0x1000 etc that Cherrry mentions refer to adresses. %eax is a 32 bit data register. It can be broken down (often for backward compatibility) into ax (a 16 bit register), consisting of ah and al (2x 8 bit registers)."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "reply_to_user": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "edited": false, "score": 0, "creation_date": 1539205591, "post_id": 52744956, "comment_id": 92422021, "body": "@The_Senate: They don&#39;t relate directly, only in their concepts. Talking about registers: As Paul mentioned, some registers may be broken down to subregisters, so assigning 0x11223344 to eax will make you read 0x44 for al, 0x33 for ah and 0x3344 for ax, for example. When I was talking about 0x1000 and 0x1004 I was talking about addresses in memory. (At some point, you probably have an address in the register, let&#39;s say you have 0x1000 in eax. Then you would &quot;dereference&quot; eax to read from the memory it points to, i.e. 0x1000. But at this point we are not talking about ah/al, etc.)"}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1539205679, "post_id": 52744956, "comment_id": 92422053, "body": "The concepts are similar though: If you are storing eax (a 32-bit value) into 0x1000 (meaning: into the 4 bytes in memory from 0x1000 to 0x1003), you would be able to read 1 byte from 0x1001 and get what was previously ah, for example. (But reading <i>4 bytes</i> from 0x1001 would get you garbage as I explained above.)"}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1539206236, "post_id": 52744956, "comment_id": 92422247, "body": "To explain it differently: Memory is just a pool of data, sequentially ordered, each byte having an address. Registers are like a tiny piece of memory but built into the processor and with name. For both, their <i>meaning</i> is not defined, it&#39;s something you need to define (by looking at things the right way). If I put 12 34 56 78 9A into memory at address 0 (so 9A would be at address 4), I can look at &quot;an 8-bit value at address 2&quot; and get 56 (=0x56), &quot;a 16-bit value at address 1&quot; and get 34 56 (=0x5634), &quot;a 32-bit value at address 1&quot; and get 34 56 78 9A (=0x9A785634) or anything else etc. [...]"}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1539206280, "post_id": 52744956, "comment_id": 92422269, "body": "[...] similarly, I can store 12 34 56 78 into eax and then I see eax as 0x78563412, ax as 0x3412, ah as 0x34 and al as 0x12. (The registers and subregisters have names and not addresses.) Similar concepts, but not the same thing here."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1539206533, "post_id": 52744956, "comment_id": 92422348, "body": "Now, memory access often involves registers as well - with a fixed address, you would have a register as source/destination when writing/reading memory (in this case, the amount of bytes you read/write is defined by the size of the (sub)register you use!), and with a variable/calculated address, you would also have the memory address in a register (and it&#39;s possible to calculate an address using an offset, so having the value 0x1000 in eax and accessing 4(%eax) would access address eax+4 = 0x1004). I hope this cleared things up a bit. :)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1539189847, "last_edit_date": 1539189847, "creation_date": 1539189278, "answer_id": 52744956, "question_id": 52744814, "link": "https://stackoverflow.com/questions/52744814/understanding-c-vs-its-assembly-counterpart/52744956#52744956", "title": "Understanding C vs its Assembly counterpart", "body": "<p>Look at the normal function entry in assembler:</p>\n\n<pre><code>    push ebp\n    mov ebp, esp\n    sub esp, &lt;size of local variables&gt;\n</code></pre>\n\n<p>So <code>ebp+4</code> holds the previous value of <code>ebp</code>. Before the old ebp was the return address, at <code>ebp+8</code>. Before that are the parameters of the function, in reverse order, so the first parameter is at <code>ebp+12</code> and the second at <code>ebp+8</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1539189725, "post_id": 52745050, "comment_id": 92414709, "body": "I suggest you draw the stack the other way around because the stack grows down."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1539189901, "post_id": 52745050, "comment_id": 92414814, "body": "@PaulOgilvie <code>esp</code> decreases yes, which means things pushed later are put on top. I think my representation shows that."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1539190069, "post_id": 52745050, "comment_id": 92414918, "body": "I would say that <code>ebp+12</code> is <i>before</i> <code>ebp+8</code>, and &quot;top&quot; meaning &quot;down&quot;"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1539190273, "post_id": 52745050, "comment_id": 92415030, "body": "@PaulOgilvie I think that representation just makes things more confusing. The addresses are in order and data is laid in memory exactly like that, the way <code>esp</code> behaves is an entirely different matter. If you think your view of the stack is more clarifying, you can put it in your answer."}], "tags": [], "owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "is_accepted": false, "score": 2, "last_activity_date": 1539200049, "last_edit_date": 1539200049, "creation_date": 1539189644, "answer_id": 52745050, "question_id": 52744814, "link": "https://stackoverflow.com/questions/52744814/understanding-c-vs-its-assembly-counterpart/52745050#52745050", "title": "Understanding C vs its Assembly counterpart", "body": "<p>Because of how the call stack is structured when using <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#Caller_clean-up\" rel=\"nofollow noreferrer\">C declaration</a>.</p>\n\n<p>First the caller will <code>push</code> the 4-byte <code>y</code>, then the 4-byte <code>xp</code> (this order is important so C can support <a href=\"https://en.wikipedia.org/wiki/Variadic_function\" rel=\"nofollow noreferrer\">Variadic Functions</a>), then the <code>call</code> to your function will implicitly <code>push</code> the return address which is also 4-byte (this is a 32-bit program).</p>\n\n<p>The first thing your function does is <code>push</code> the state of <code>ebp</code> which it will need to recover later so that the caller can continue working properly, and then copy the current state of <code>esp</code> (stack pointer) to <code>ebp</code>. In sum:</p>\n\n<pre><code>push %ebp\nmovl %esp, %ebp\n</code></pre>\n\n<p>This is also known as <a href=\"https://en.wikipedia.org/wiki/Function_prologue\" rel=\"nofollow noreferrer\">function prologue</a>.</p>\n\n<p>When all this is done you are finally ready to actually run the code you wrote, at this stage the stack is something like this:</p>\n\n<pre><code>%ebp- ? = address of your local variables (which in this example you don't have)\n%ebp+ 0 = address of the saved state of previous ebp\n%ebp+ 4 = ret address\n%ebp+ 8 = address where is stored the value of xp\n%ebp+12 = address where is stored the value of y\n%ebp+16 = out of bonds, this memory space belongs to the caller\n</code></pre>\n\n<p>When your function is done it will wrap it up by setting <code>esp</code> back to <code>ebp</code>, then <code>pop</code> the original <code>ebp</code> and <code>ret</code>.</p>\n\n<pre><code>movl %ebp, %esp\npop %ebp\nret\n</code></pre>\n\n<p><code>ret</code> is basically a shortcut to <code>pop</code> a pointer from the stack and <code>jmp</code> to it.</p>\n\n<p>Edit: Fixed order of parameters for AT&amp;T assembly</p>\n"}], "owner": {"reputation": 139, "user_id": 10149813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pygq2.jpg?s=128&g=1", "display_name": "The_Senate", "link": "https://stackoverflow.com/users/10149813/the-senate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1539200049, "creation_date": 1539188691, "last_edit_date": 1539188803, "question_id": 52744814, "link": "https://stackoverflow.com/questions/52744814/understanding-c-vs-its-assembly-counterpart", "title": "Understanding C vs its Assembly counterpart", "body": "<p>Say we are given a function: </p>\n\n<pre><code>    int exchange(int*xp, int y)\n    {\n    x = *xp; \n    *xp = y; \n    return x;\n\n    }\n</code></pre>\n\n<p>So, the book I am reading explains that xp is stored at offsets 8 and 12 relative to the address register %ebp. What I am not understanding is why they are stored as any kind of unit 8 and 12, further more: What is an offset in this context? Finally, how do 8 and 12 fit when the register accepts movement in units of 1 2 and 4 bytes respectively? </p>\n\n<p>The assembly code : </p>\n\n<pre><code>xp at %ebp+8, y at%ebp+12 \n1 movl 8(%ebp), %edx (Get xp By copying to %eax below, x becomes the return value)\n\n2 movl (%edx), %eax (Get x at xp) \n\n3 movl 12(%ebp), %ecx (Get y) \n\n4 movl %ecx, (%edx) (Store y at xp)\n</code></pre>\n\n<p>What I think the answer is: \nSo, when examining registries, it was common to see something like registry %rdi holding a value of 0x1004 which is an address and 0x1004 is in the address which holds a value 0xAA. </p>\n\n<p>Of course, this is a hypothetical example that doesn't line up with the registries listed in the book. Each registry is 16-32 bit and the top four can be used to store integers freely. Does offsetting it by 8 make it akin to 0x1000 + 8? Again, I'm not entirely sure what the offset in this scenario is for when we are storing new units into empty space. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539185076, "post_id": 52743648, "comment_id": 92411946, "body": "So.. what is the problem?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 8, "creation_date": 1539185111, "post_id": 52743648, "comment_id": 92411968, "body": "<code>for(i=1; i!=0; i++)</code> - that&#39;s a weird loop. Do you think it will terminate?"}, {"owner": {"reputation": 805, "user_id": 10424245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0504daecf094f9efeb1e1cf6d231588?s=128&d=identicon&r=PG&f=1", "display_name": "Loufi", "link": "https://stackoverflow.com/users/10424245/loufi"}, "edited": false, "score": 0, "creation_date": 1539185248, "post_id": 52743648, "comment_id": 92412064, "body": "you just want to print it or stock it inside an array and after print what&#39;s inside the array ?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1539185313, "post_id": 52743648, "comment_id": 92412096, "body": "The example value you used is not the best, since it&#39;s a palindrome (reads the same backwards as forwards) - ie. it won&#39;t let you find out if you print the digits in the wrong order. I suggest using a different value to test with."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539185669, "post_id": 52743648, "comment_id": 92412286, "body": "When <code>current++;</code> is first executed, <code>current</code> does not have a prior defined value.  It is not used here, so might as well drop it."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1539186050, "creation_date": 1539186050, "answer_id": 52744008, "question_id": 52743648, "link": "https://stackoverflow.com/questions/52743648/how-to-put-an-integer-in-a-individual-number-by-arry/52744008#52744008", "title": "How to put an integer in a individual number by arry?", "body": "<p>Determine the values for <code>A[]</code> looping in one direction and then print the values in the other loop direction.</p>\n\n<p>Let us assume <code>input &gt;= 0</code>.<br>\nA <code>do</code> loop is useful here to handle the case of <code>input == 0</code> to print <code>\"0\"</code>.</p>\n\n<pre><code>i = 0;\ndo {\n  A[i] = input%10;\n  input = input/10;\n  i++;\n} while (input);\n</code></pre>\n\n<p>Now print looping the other way</p>\n\n<pre><code>while (i) {\n  printf(\"%d \", A[--i]);\n}\nprintf(\"\\n\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 805, "user_id": 10424245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0504daecf094f9efeb1e1cf6d231588?s=128&d=identicon&r=PG&f=1", "display_name": "Loufi", "link": "https://stackoverflow.com/users/10424245/loufi"}, "is_accepted": false, "score": 2, "last_activity_date": 1539188399, "last_edit_date": 1539188399, "creation_date": 1539187146, "answer_id": 52744363, "question_id": 52743648, "link": "https://stackoverflow.com/questions/52743648/how-to-put-an-integer-in-a-individual-number-by-arry/52744363#52744363", "title": "How to put an integer in a individual number by arry?", "body": "<p>You can put your input into your array like you do and display it, but the input will be reverse.</p>\n\n<p>In case of intput: 12345</p>\n\n<p>Value will be stored like this: <code>A[0] = 5, A[1] = 4, ...</code></p>\n\n<p>To change that you will have to display <code>A[]</code> from the end to the start. (already answered by chux)</p>\n\n<p>Or you can store your input into <code>A[]</code> from the end to the start and after simply display it:</p>\n\n<p>Example below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;                                                              \n\nint main(void)                                                                  \n{                                                                                                                                                           \n    int A[100];                                                                   \n    int i, input, len, nb;                                                        \n    printf(\"Input n:\");                                                           \n    scanf(\"%d\",&amp;input);                                                           \n    printf(\"\\n\");                                                                 \n\n    nb = input;           //I do a save of input.                                 \n\n    for(len = 0; nb != 0; len++){ //Calculating the size of the input             \n      nb = nb / 10;               //                                              \n    }                             //                                              \n    len--;\n    for(int z = len; input != 0; z--){ //I copy the input into A.                 \n      A[z] = input % 10;               //                                         \n      input = input / 10;              //                                         \n    }                                                                             \n\n    for(i = 0; i &lt;= len; i++) // I display A                                      \n      printf(\"%d \",A[i]);     //                                                  \n\n    return 0;                                                                     \n}\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>By the way your for:</p>\n\n<pre><code>for(i=1; i!=0; i++){\n    A[i]=input%10;\n    input=input/10;\n    printf(\"%d \",A[i]);\n    current++;\n}\n</code></pre>\n\n<p>Will infinite loop because <code>i</code> is never equals to 0 and the case <code>A[0]</code> of your array will not be used because <code>\u00ec</code> start at <code>1</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10452082"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1539188399, "creation_date": 1539184981, "last_edit_date": 1539186206, "question_id": 52743648, "link": "https://stackoverflow.com/questions/52743648/how-to-put-an-integer-in-a-individual-number-by-arry", "title": "How to put an integer in a individual number by arry?", "body": "<p>I want to input an integer such as 123454321.  Then I want to print it in\nthis form:1 2 3 4 5 4 3 2 1.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n\n  int A[100];\n  int i, input, current;\n  printf(\"Input n:\");\n  scanf(\"%d\",&amp;input);\n  printf(\"\\n\");\n\n  for(i=1; i!=0; i++){\n    A[i]=input%10;\n    input=input/10;\n    printf(\"%d \",A[i]);\n    current++;\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "valgrind", "free"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1539183774, "post_id": 52743208, "comment_id": 92411048, "body": "No, you can&#39;t free and not to loose a value. If you don&#39;t want to loose it, copy it before freeing."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1539184195, "post_id": 52743208, "comment_id": 92411370, "body": "It is an error to access any memory after you have <code>free</code>d it. Perhaps the best solution is for the code that uses the data to take responsibility for freeing it."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539184294, "post_id": 52743208, "comment_id": 92411445, "body": "Based on the code you&#39;ve shown, you don&#39;t use the value after you&#39;ve free&#39;ed it.  So why return it?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1539184302, "post_id": 52743208, "comment_id": 92411451, "body": "So basically you want to set your house on fire and continue to live in it once it has burned down?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1539184398, "post_id": 52743208, "comment_id": 92411514, "body": "The leak is not the issue with your code, but this here is <code>Invalid write of size 1</code> and this <code>Invalid read of size 1</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539184535, "post_id": 52743208, "comment_id": 92411596, "body": "<code>char* temp=malloc(sizeof(char*));</code> makes no sense whatsoever. Fortunately it only leaks memory and does nothing else destructive. In addition please use English identifiers in your programs if you want international audience to understand them."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539184608, "post_id": 52743208, "comment_id": 92411645, "body": "<code>temp[l]=&#39;\\0&#39;;</code> what is <code>l</code> at this point? What was the length argument in the last call to <code>realloc</code>?"}, {"owner": {"reputation": 3, "user_id": 10484781, "user_type": "registered", "profile_image": "https://graph.facebook.com/310862516366483/picture?type=large", "display_name": "Omaima Raddi", "link": "https://stackoverflow.com/users/10484781/omaima-raddi"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1539184611, "post_id": 52743208, "comment_id": 92411650, "body": "@alk how can I fix that, please ?"}, {"owner": {"reputation": 3, "user_id": 10484781, "user_type": "registered", "profile_image": "https://graph.facebook.com/310862516366483/picture?type=large", "display_name": "Omaima Raddi", "link": "https://stackoverflow.com/users/10484781/omaima-raddi"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539184703, "post_id": 52743208, "comment_id": 92411705, "body": "@dbush when I do free temp I end up with losing the last value of the array and a segmentation fault"}, {"owner": {"reputation": 3, "user_id": 10484781, "user_type": "registered", "profile_image": "https://graph.facebook.com/310862516366483/picture?type=large", "display_name": "Omaima Raddi", "link": "https://stackoverflow.com/users/10484781/omaima-raddi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539184753, "post_id": 52743208, "comment_id": 92411729, "body": "@n.m. what would make more sense please ? I will edit it right away sorry."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539184772, "post_id": 52743208, "comment_id": 92411745, "body": "@OmaimaRaddi Leaking memory by itself won&#39;t cause a segfault.  Reading/writing past the end of allocated memory (as reported) will.  You&#39;ve already been given a hint as to where it is."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1539184839, "post_id": 52743208, "comment_id": 92411788, "body": "I&#39;d say 1st compile with symbols (GCC option <code>-g</code>) then rerun Valgrind, and it&#39;ll point you to the critical source lines."}, {"owner": {"reputation": 3, "user_id": 10484781, "user_type": "registered", "profile_image": "https://graph.facebook.com/310862516366483/picture?type=large", "display_name": "Omaima Raddi", "link": "https://stackoverflow.com/users/10484781/omaima-raddi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539184851, "post_id": 52743208, "comment_id": 92411796, "body": "@n.m. l is the length of each word I pass to the array that&#39;s why I keep initializing to fit each word"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539185091, "post_id": 52743208, "comment_id": 92411956, "body": "It would be easier if you operate with specific numbers. Note I asked you to look at <i>two</i> numbers, not one."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539185187, "post_id": 52743208, "comment_id": 92412019, "body": "The english language bit is for the future, don&#39;t do massive edits on existing programs hastily."}, {"owner": {"reputation": 3, "user_id": 10484781, "user_type": "registered", "profile_image": "https://graph.facebook.com/310862516366483/picture?type=large", "display_name": "Omaima Raddi", "link": "https://stackoverflow.com/users/10484781/omaima-raddi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539185834, "post_id": 52743208, "comment_id": 92412393, "body": "@n.m. it was l+1 because I use realloc before incrementing l&#39;s value, for the &#39;\\0&#39; at the end of a string"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539186267, "post_id": 52743208, "comment_id": 92412676, "body": "Please give two <b>specific</b> numbers. Don&#39;t guess, add a <code>printf</code> or use a debugger."}], "answers": [{"tags": [], "owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "is_accepted": false, "score": 0, "last_activity_date": 1539185150, "creation_date": 1539185150, "answer_id": 52743704, "question_id": 52743208, "link": "https://stackoverflow.com/questions/52743208/how-to-free-an-allocated-memory-without-losing-its-value/52743704#52743704", "title": "How to free an allocated memory without losing its value", "body": "<p>Before the for-loop you have </p>\n\n<pre><code>char* temp=malloc(sizeof(char*));\n</code></pre>\n\n<p>but the first thing inside the for-loop is</p>\n\n<pre><code>temp=NULL;\n</code></pre>\n\n<p>So the memory that <code>temp</code> pointed to is lost. If you run this program on a 64 bit computer, you will see a memory leak of size 8. Remove the first declaration of <code>temp</code> and change the first line in the for-loop to</p>\n\n<pre><code>char* temp = NULL;\n</code></pre>\n\n<p>Another problem is the condition of the inner while-loop:</p>\n\n<pre><code>while(chaine[j]!=' ' &amp;&amp; *chaine)\n</code></pre>\n\n<p>as you don't advance the <code>chaine</code> pointer, the value of <code>*chaine</code> will not change. You probably meant to write <code>chaine[j]</code> here:</p>\n\n<pre><code>while(chaine[j]!=' ' &amp;&amp; chaine[j])\n</code></pre>\n\n<p>which is equivalent to </p>\n\n<pre><code>while(chaine[j]!=' ' &amp;&amp; chaine[j]!='\\0')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1539186529, "creation_date": 1539186529, "answer_id": 52744164, "question_id": 52743208, "link": "https://stackoverflow.com/questions/52743208/how-to-free-an-allocated-memory-without-losing-its-value/52744164#52744164", "title": "How to free an allocated memory without losing its value", "body": "<p>The memory leak isn't where you think it is.  It happens at the start of your function:</p>\n\n<pre><code>char* temp=malloc(sizeof(char*));\nchar **words_array=malloc((string_words_number(string)+1)*sizeof(char*)); \nfor(i=0;i&lt;string_words_number(string);i++)\n{   \n\n    temp=NULL;\n</code></pre>\n\n<p>You allocate space for a pointer to <code>temp</code>, but then you overwrite that pointer when  you enter the <code>for</code> loop.  Remove that <code>malloc</code> call and the leak goes away.</p>\n\n<p>You have a bigger problem however, and that is reading and writing past the end of an allocated buffer.  That's happening here:</p>\n\n<pre><code>temp=NULL;\nint l=0;\nwhile(string[j]!=' ' &amp;&amp; *string)\n{   \n    temp=realloc(temp,(l+1)*sizeof(char));\n    temp[l]=string[j];\n    j++;l++;\n}\nj++;\ntemp[l]='\\0';\n</code></pre>\n\n<p>Suppose the string in question has two characters to read.  On the first iteration of your loop, <code>l</code> is 0, so you allocate <code>l+1 == 1</code> bytes to <code>temp</code>.  You then write to <code>temp[l] == temp[0]</code>, which is fine, then you increment <code>l</code> to 1.  On the next iteration, you allocate <code>l+1 == 2</code> bytes for <code>temp</code>, write to <code>temp[l] == temp[1]</code>, and increment <code>l</code> to 2.  Still good so far.</p>\n\n<p>The problem is when you do <code>temp[l]='\\0';</code> outside of the loop.  <code>l</code> is now 2, and the size of the allocated memory is 2, so you're writing one element past the end of the array.</p>\n\n<p>You need to allocate one more byte here:</p>\n\n<pre><code>j++;\ntemp=realloc(temp,(l+1)*sizeof(char));\ntemp[l]='\\0';\n</code></pre>\n\n<p>Note also that you should be checking the return value of <code>malloc</code> and <code>realloc</code> throughout your code in case it fails.</p>\n\n<p>Also, you're not correctly checking for the end of <code>string</code>.  You need to do:</p>\n\n<pre><code>while(string[j]!=' ' &amp;&amp; string[j]!=0)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10484781, "user_type": "registered", "profile_image": "https://graph.facebook.com/310862516366483/picture?type=large", "display_name": "Omaima Raddi", "link": "https://stackoverflow.com/users/10484781/omaima-raddi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 52744164, "answer_count": 2, "score": 0, "last_activity_date": 1539186529, "creation_date": 1539183711, "last_edit_date": 1539186389, "question_id": 52743208, "link": "https://stackoverflow.com/questions/52743208/how-to-free-an-allocated-memory-without-losing-its-value", "title": "How to free an allocated memory without losing its value", "body": "<p>Hello I wrote this function in C that takes a string of words and returns a two dimensional char array with each case initialized to a word in the right order, I compiled and it did the assigned task </p>\n\n<pre><code>char **decompose_string(char *string)\n{\nint i,j=0;\nchar* temp=malloc(sizeof(char*));\nchar **words_array=malloc((string_words_number(string)+1)*sizeof(char*)); //string_words_number return the number of words in string string\nfor(i=0;i&lt;string_words_number(string);i++)\n{   \n\n    temp=NULL;\n    int l=0;\n    while(string[j]!=' ' &amp;&amp; *string)\n    {   \n        temp=realloc(temp,(l+1)*sizeof(char));\n        temp[l]=string[j];\n        j++;l++;\n    }\n    j++;\n    temp[l]='\\0';\n    tab_mots=realloc(words_array,(string_words_number(string)+1)*sizeof(char)*(j-1));\n    words_array[i]=temp;\n\n}\nwords_array[i]=NULL;\nreturn words_array;}\n</code></pre>\n\n<p>And my main:</p>\n\n<pre><code>int main()\n{\nchar* string1= \"word1 and word2 and word3\";\nprintf(\"Our initial string: %s\\n\",string1);\nchar** words_array1;\nprintf(\"After decomposition:\\n\");\nwords_array1=decompose_string(string1);\ndisplay_words_array(words_array1); //displays each element of the array in a line\nwords_array1=destroy_array(words_array1);\nreturn 0;}\n</code></pre>\n\n<p>But as I executed the valgrind command to see weither there are any memory leaks this was the result:</p>\n\n<pre><code>==4648== Memcheck, a memory error detector\n==4648== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==4648== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==4648== Command: ./test_csvl\n==4648== \n\nOur initial array: word1 and word2 and word3\nAfter decomposition:\n==4648== Invalid write of size 1\n==4648==    at 0x4009D9: decompose_string (in /home/omaima/2I001/TME3/test_csvl)\n==4648==    by 0x40078F: main (in /home/omaima/2I001/TME3/test_csvl)\n==4648==  Address 0x5204634 is 0 bytes after a block of size 4 alloc'd\n==4648==    at 0x4C2FD5F: realloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==4648==    by 0x40097D: decompose_string (in /home/omaima/2I001/TME3/test_csvl)\n==4648==    by 0x40078F: main (in /home/omaima/2I001/TME3/test_csvl)\n==4648== \n==4648== Invalid read of size 1\n==4648==    at 0x4C30F74: strlen (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==4648==    by 0x4EA969B: puts (ioputs.c:35)\n==4648==    by 0x400888: display_words_array (in /home/omaima/2I001/TME3/test_csvl)\n==4648==    by 0x40079F: main (in /home/omaima/2I001/TME3/test_csvl)\n==4648==  Address 0x5204634 is 0 bytes after a block of size 4 alloc'd\n==4648==    at 0x4C2FD5F: realloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==4648==    by 0x40097D: decompose_string (in /home/omaima/2I001/TME3/test_csvl)\n==4648==    by 0x40078F: main (in /home/omaima/2I001/TME3/test_csvl)\n==4648== \nword1\nand\nword2\nand\nword3\n==4648== \n==4648== HEAP SUMMARY:\n==4648==     in use at exit: 8 bytes in 1 blocks\n==4648==   total heap usage: 30 allocs, 29 frees, 1,545 bytes allocated\n==4648== \n==4648== LEAK SUMMARY:\n==4648==    definitely lost: 8 bytes in 1 blocks\n==4648==    indirectly lost: 0 bytes in 0 blocks\n==4648==      possibly lost: 0 bytes in 0 blocks\n==4648==    still reachable: 0 bytes in 0 blocks\n==4648==         suppressed: 0 bytes in 0 blocks\n==4648== Rerun with --leak-check=full to see details of leaked memory\n==4648== \n==4648== For counts of detected and suppressed errors, rerun with: -v\n==4648== ERROR SUMMARY: 9 errors from 2 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>I know that the missing free is the one for temp in the function but if I do free it I'll end up losing its value which I need for my array. So my question would be can I free it without losing its value ? or any other solution to guarantee both the functionality of my function and the erase of any memory leaks. Thank you for your time.</p>\n\n<p>Sorry I forgot here's the function I used to free the allocated space:</p>\n\n<pre><code>char **destroy_words_array( char** words_array)\n{\n    int i;\n    for(i=0;i&lt;count_words(words_array);i++) free(words_array[i]); //wount_words return the number of elements of the array\n    free(words_array);\n    return words_array;\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 0, "creation_date": 1539183698, "post_id": 52743003, "comment_id": 92410997, "body": "Why <code>5.0</code> as an argument?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "edited": false, "score": 0, "creation_date": 1539183824, "post_id": 52743003, "comment_id": 92411091, "body": "@Observer OP wants to convert float to string, He was struck with returning string from the function. I just focused on how to return string from function."}, {"owner": {"reputation": 3, "user_id": 10484812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77007d22d1941e1e69459298e4cafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Muschel", "link": "https://stackoverflow.com/users/10484812/muschel"}, "edited": false, "score": 0, "creation_date": 1539183960, "post_id": 52743003, "comment_id": 92411185, "body": "I tried your code, but it has an error: [Error] invalid conversion from &#39;void*&#39; to &#39;char*&#39; [-fpermissive]"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 3, "user_id": 10484812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77007d22d1941e1e69459298e4cafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Muschel", "link": "https://stackoverflow.com/users/10484812/muschel"}, "edited": false, "score": 2, "creation_date": 1539184100, "post_id": 52743003, "comment_id": 92411293, "body": "@Muschel Are you using c++ compiler. if yes cast the <code>malloc</code> return to <code>char *</code> like this (<code>char *str = (char*)malloc(30)</code>)."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 1, "last_activity_date": 1539183019, "creation_date": 1539183019, "answer_id": 52743003, "question_id": 52742932, "link": "https://stackoverflow.com/questions/52742932/how-to-return-a-string-in-a-c-function/52743003#52743003", "title": "How to return a string in a C function?", "body": "<p><code>str</code> is local to <code>function</code> and will be destroyed once control exits <code>function</code>.</p>\n\n<p>Hence you can try as below.</p>\n\n<pre><code>            char* function (float number)\n            {\n                char *str = malloc(30);\n                strcpy(str, \" test\");\n                strcat(str, \" char\");\n                return str;\n            }\n\n            int main()\n            {\n                char *test = function(5.0); \n                printf(\"Hi %s\", test);\n            }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10484812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77007d22d1941e1e69459298e4cafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Muschel", "link": "https://stackoverflow.com/users/10484812/muschel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "closed_date": 1539183126, "accepted_answer_id": 52743003, "answer_count": 1, "score": 0, "last_activity_date": 1539185018, "creation_date": 1539182840, "last_edit_date": 1539185018, "question_id": 52742932, "link": "https://stackoverflow.com/questions/52742932/how-to-return-a-string-in-a-c-function", "closed_reason": "Duplicate", "title": "How to return a string in a C function?", "body": "<p>I have to make a function that has a float as parameter, and the function will return that number in words (As a string)</p>\n\n<p>i.e: function(12.0) will return twelve as a string</p>\n\n<p>But I have some problems returning the string, it returns some weird data, I have this code:</p>\n\n<pre><code>            char* function (float number)\n            {\n                char str[] = \"test\";\n                strcat(str, \" char\");\n                return str;\n            }\n\n            int main()\n            {\n                char *test = function(5.0); \n                printf(\"Hi %s\", test);\n            }\n</code></pre>\n\n<p>That always returns a different thing:</p>\n\n<pre><code>            Hi u.\u00aa\u2563D\n            Hi u\u00ea\u00f5W\u00db\n</code></pre>\n\n<p>I don't know how to fix it, because I really need to use strcat to do things like 'one thousand ten' saving time and lines of code, and it's not possible if I define char str as a pointer...</p>\n\n<p>I'm using Dev-C++ 5.11</p>\n\n<p>Thank you!</p>\n\n<p>I searched a few days but noone of the answers worked with what I need, because they define the string as a pointer or use more than 1 parameter in the function (it only has to receive 1 float parameter, no more parameters are accepted)</p>\n"}, {"tags": ["c", "serial-communication", "bit-fields"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1539182501, "post_id": 52742756, "comment_id": 92410256, "body": "just use <b>boolean data[40]</b>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539182549, "post_id": 52742756, "comment_id": 92410290, "body": "What are the range of values you get for the addresses?  Is it 0 - 39 or something else?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539182630, "post_id": 52742756, "comment_id": 92410332, "body": "Thetr is no way to address a bit. (BTW, a <code>char</code> is a byte not an octet if your code need an octet use <code>uint8_t</code>, this is more pedantic and disallow the compilation of your code on machine where this would not work as expected)"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539182802, "post_id": 52742756, "comment_id": 92410453, "body": "&quot;And I wonder, is this going to map that data[40] into a consequent memory block with a size of 40 bits (5 bytes)?&quot; =&gt; short answer =&gt; No. Why don&#39;t you look yourself with <code>SERIAL_packet foo; printf(&quot;%zu, zu\\n&quot;, sizeof foo, sizeof foo.data);</code> ?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1539182906, "post_id": 52742756, "comment_id": 92410517, "body": "&quot;The problem with this was that the PC will send an unsigned char address telling me the device to turn on/off, so accessing the bit corresponding to that address number turned out to be rather complicated...&quot; you are clearly into a XY problem, please describe with more precision this part of your question."}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1539182939, "post_id": 52742756, "comment_id": 92410538, "body": "Is std::bitset available? Have you considered xor? If you want a command to change one specific address, you don&#39;t need all 40 bits, just that one address."}, {"owner": {"reputation": 53, "user_id": 10484515, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ERQbXJ7LhCE/AAAAAAAAAAI/AAAAAAAAAC0/N23l0vWtZ1U/photo.jpg?sz=128", "display_name": "Tomas Ambrogi", "link": "https://stackoverflow.com/users/10484515/tomas-ambrogi"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539183742, "post_id": 52742756, "comment_id": 92411029, "body": "@Stargateur, yes, will change it to <code>uint8_t</code>, thanks. Yes the PC will send 0 - 39. &quot;you are clearly into a XY problem&quot; I&#39;m not sure what you meant there. But the issue was accessing bit number <code>address</code>, but seems @dbush figured it out. I&#39;ve been reading about low level bit masking but it&#39;s definitely not my forte. Thanks everyone"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539183865, "post_id": 52742756, "comment_id": 92411120, "body": "@TomasAmbrogi Glad I could help.  Feel free to <a href=\"https://stackoverflow.com/help/accepted-answer\">accept my answer</a> if you found it useful."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10484515, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ERQbXJ7LhCE/AAAAAAAAAAI/AAAAAAAAAC0/N23l0vWtZ1U/photo.jpg?sz=128", "display_name": "Tomas Ambrogi", "link": "https://stackoverflow.com/users/10484515/tomas-ambrogi"}, "edited": false, "score": 0, "creation_date": 1539184393, "post_id": 52742951, "comment_id": 92411507, "body": "Thanks for the reply, this seems to be exactly what I was looking for."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 6, "last_activity_date": 1539183901, "last_edit_date": 1539183901, "creation_date": 1539182902, "answer_id": 52742951, "question_id": 52742756, "link": "https://stackoverflow.com/questions/52742756/mapping-a-number-to-bit-position-in-c/52742951#52742951", "title": "Mapping a number to bit position in C", "body": "<p>Assuming the addresses you get back are in the range 0 - 39 and that a <code>char</code> has 8 bits, you can treat your <code>data</code> array as an array of bits:</p>\n\n<pre><code>| data[0]                       | data[1]                           ...\n-----------------------------------------------------------------\n| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15|\n-----------------------------------------------------------------\n</code></pre>\n\n<p>To set bit <code>i</code>:</p>\n\n<pre><code>packet.data[i/8] |= (1 &lt;&lt; (i%8));\n</code></pre>\n\n<p>To clear bit <code>i</code>:</p>\n\n<pre><code>packet.data[i/8] &amp;= (1 &lt;&lt; (i%8)) ^ 0xff;\n</code></pre>\n\n<p>To read bit <code>i</code>:</p>\n\n<pre><code> int flag = (packet.data[i/8] &amp; (1 &lt;&lt; (i%8)) != 0;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10484515, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ERQbXJ7LhCE/AAAAAAAAAAI/AAAAAAAAAC0/N23l0vWtZ1U/photo.jpg?sz=128", "display_name": "Tomas Ambrogi", "link": "https://stackoverflow.com/users/10484515/tomas-ambrogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 919, "favorite_count": 0, "accepted_answer_id": 52742951, "answer_count": 1, "score": 2, "last_activity_date": 1539183901, "creation_date": 1539182310, "last_edit_date": 1539183190, "question_id": 52742756, "link": "https://stackoverflow.com/questions/52742756/mapping-a-number-to-bit-position-in-c", "title": "Mapping a number to bit position in C", "body": "<p>I'm developing an programm running on Atmel AT90CAN128. Connected to this controller there are 40 devices, each with a status (on/off). As I need to report the status of each of this devices to a PC through Serial Communication, I have 40 bits, which define whether the device is on or off. In addition, the PC can turn any of this devices on or off.</p>\n\n<p>So, my first attempt was to create the following struct:</p>\n\n<pre><code>typedef struct {\n     unsigned char length;      //!&lt; Data Length\n     unsigned data_type;        //!&lt; Data type\n     unsigned char data[5];     //!&lt; CAN data array 5 * 8 = 40 bits\n} SERIAL_packet;\n</code></pre>\n\n<p>The problem with this was that the PC will send an <code>unsigned char address</code> telling me the device to turn on/off, so accessing the bit corresponding to that <code>address</code> number turned out to be rather complicated...</p>\n\n<p>So I started looking for options, and I stumbled upon the C99 <code>_Bool</code> type. I thought, great so now I'll just create a <code>_Bool data[40]</code> and I can access the <code>address</code> bit just by indexing my <code>data</code> array. Turns out that in C (or C++) memory mapping needs an entire byte for addressing it. So even if I declare a <code>_Bool</code> the size of that <code>_Bool</code> will be 8 bits which is a problem (it needs to be as fast as possible so the more bits I send the slower it gets, and the PC will be specting 40 bits <em>only</em>) and not very efficient for the communication. So I started looking into Bit Fields, and tried the following:</p>\n\n<pre><code>typedef struct {\n    unsigned char length;   //!&lt; Data Length\n    unsigned data_type;     //!&lt; Data type\n    arrayData data[40]; //!&lt; Data array 5 bytes == 40 bits\n} SERIAL_packet;\n\ntypedef struct {\n    unsigned char aux : 1;\n} arrayData;\n</code></pre>\n\n<p>And I wonder, is this going to map that <code>data[40]</code> into a consequent memory block with a size of 40 bits (5 bytes)?</p>\n\n<p>If not, is there any obvious solution I'm missing? This doesn't seem like a very complicated thing to do (would be much simpler if there were less than 32 devices so I could use a <code>int</code> and just access through a bit mask).</p>\n"}, {"tags": ["c", "spi", "esp32"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1539181572, "post_id": 52742430, "comment_id": 92409663, "body": "Why are you casting a <code>void*</code> to an <code>int16_t**</code> and then try to assign it to a <code>int16_t</code> item? This doesn&#39;t make the slightest sense. Any why would you send a memory address over SPI?"}, {"owner": {"reputation": 33, "user_id": 2207148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489be110f776e91c1c76ca465f12e124?s=128&d=identicon&r=PG", "display_name": "user2207148", "link": "https://stackoverflow.com/users/2207148/user2207148"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539181659, "post_id": 52742430, "comment_id": 92409717, "body": "There&#39;s supposed to be values where rx_buffer is pointing to and that is what I&#39;m trying to read. And because rtrans is a pointer and rx_buffer is a pointer I thought I could cast that to int16."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539182127, "post_id": 52742430, "comment_id": 92410022, "body": "Sending a pointer over SPI is fishy. Why does an external hardware tell your microcontroller where the microcontroller stores its buffers? It still doesn&#39;t make sense.  You realize that you are using a <code>union</code> and not a <code>struct</code>, yes?"}, {"owner": {"reputation": 33, "user_id": 2207148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489be110f776e91c1c76ca465f12e124?s=128&d=identicon&r=PG", "display_name": "user2207148", "link": "https://stackoverflow.com/users/2207148/user2207148"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539182388, "post_id": 52742430, "comment_id": 92410190, "body": "I would say the <code>union</code> is part of <code>struct spi_transaction_t</code>, isn&#39;t it? And that is part of the SPI library from espressif (link above)."}, {"owner": {"reputation": 33, "user_id": 2207148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489be110f776e91c1c76ca465f12e124?s=128&d=identicon&r=PG", "display_name": "user2207148", "link": "https://stackoverflow.com/users/2207148/user2207148"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539183037, "post_id": 52742430, "comment_id": 92410597, "body": "And I don&#39;t think that there is a pointer sent over SPI. That&#39;s the microcontroller who handles the buffer. IMHO"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1539184302, "post_id": 52742430, "comment_id": 92411450, "body": "It sounds like you want to get the address of the buffer from rx_buffer, then read the data from the buffer. So <code>int16_t *p = rtrans-&gt;rx_buffer; data_buffer[x] = *p;</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539184508, "post_id": 52742430, "comment_id": 92411580, "body": "The <i>only</i> reason to use a union with a pointer is if it is getting serialized for transmission over SPI. Which doesn&#39;t make any sense, just as serializing a pointer for any other use doesn&#39;t make any sense either. And why are structs passed by value for a microcontroller application?"}, {"owner": {"reputation": 33, "user_id": 2207148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489be110f776e91c1c76ca465f12e124?s=128&d=identicon&r=PG", "display_name": "user2207148", "link": "https://stackoverflow.com/users/2207148/user2207148"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1539242065, "post_id": 52742430, "comment_id": 92431935, "body": "@stark thanks, exactly what I tried to do but I get a core dump when *p is assigned to data_buffer."}, {"owner": {"reputation": 33, "user_id": 2207148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489be110f776e91c1c76ca465f12e124?s=128&d=identicon&r=PG", "display_name": "user2207148", "link": "https://stackoverflow.com/users/2207148/user2207148"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539242321, "post_id": 52742430, "comment_id": 92432094, "body": "@Lundin there are other functions in the library which use serialization. But I don&#39;t understand enough to clearly see through it"}, {"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 1, "creation_date": 1539245441, "post_id": 52742430, "comment_id": 92433679, "body": "Please include proper <code>spi_transaction_t</code> definition. The comments for <code>rx_buffer</code> and <code>rx_data</code> explain what is going on."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539247537, "post_id": 52742430, "comment_id": 92434882, "body": "Reading that documentation, they apparently use the union members for unrelated purposes, setting rx_buffer to NULL when no read should be done. So they rely on the underlying representation of a null pointer constant somehow, and hoping it isn&#39;t the same as the data. This is wildly fishy practice."}], "owner": {"reputation": 33, "user_id": 2207148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489be110f776e91c1c76ca465f12e124?s=128&d=identicon&r=PG", "display_name": "user2207148", "link": "https://stackoverflow.com/users/2207148/user2207148"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539246911, "creation_date": 1539181339, "last_edit_date": 1539246911, "question_id": 52742430, "link": "https://stackoverflow.com/questions/52742430/read-value-from-a-pointer-to-a-pointer-in-a-structure-spi-transaction", "title": "Read value from a pointer to a pointer in a structure (SPI transaction)", "body": "<p>Hi I'm trying read the value of *rx_buffer which is a member of spi_transaction_t struct in the following example.</p>\n\n<pre><code>struct spi_transaction_t {\n    [...]\n    union {\n       void *rx_buffer; //&lt; Pointer to receive buffer, or NULL for no MISO phase. Written by 4 bytes-unit if DMA is used.\n    uint8_t rx_data[4]; //&lt; If SPI_USE_RXDATA is set, data is received directly to this variable\n    };\n};  \n\n\n//Queue transaction\nstatic void send_lines(spi_device_handle_t spi)\n{\n    esp_err_t ret;\n    int x;\n    [...]\n    for (x=0; x&lt;6; x++) {\n        ret=spi_device_queue_trans(spi, &amp;trans[x], portMAX_DELAY);\n        assert(ret==ESP_OK);\n    }\n\n}\n\n//Dequeue transaction\nstatic void send_line_finish(spi_device_handle_t spi)\n{\n    spi_transaction_t *rtrans;\n    esp_err_t ret;\n    for (int x=0; x&lt;6; x++) {\n        ret=spi_device_get_trans_result(spi, &amp;rtrans, portMAX_DELAY);\n        assert(ret==ESP_OK);\n    }\n}\n</code></pre>\n\n<p>The code is from this example:\n<a href=\"https://github.com/espressif/esp-idf/blob/221eced06daff783afde6e378f6f84a82867f758/examples/peripherals/spi_master/main/spi_master_example_main.c#L342\" rel=\"nofollow noreferrer\">https://github.com/espressif/esp-idf/blob/221eced06daff783afde6e378f6f84a82867f758/examples/peripherals/spi_master/main/spi_master_example_main.c#L342</a></p>\n\n<p>I'm now trying to dequeue the data from *rx_buffer and write it to another buffer. Something like the following, but I'm struggling with the pointer to pointer structure.</p>\n\n<pre><code>//Dequeue transaction\nstatic void send_line_finish(spi_device_handle_t spi)\n{\n    spi_transaction_t *rtrans;\n    esp_err_t ret;\n    int16_t data_buffer[6];\n\n    for (int x=0; x&lt;6; x++) {\n        ret=spi_device_get_trans_result(spi, &amp;rtrans, portMAX_DELAY);\n        assert(ret==ESP_OK);\n        data_buffer[x] = (int16_t**)rtrans-&gt;rx_buffer;\n    }\n}\n</code></pre>\n\n<p>Edit:\nThe docs says:</p>\n\n<blockquote>\n  <p>Normally, data to be transferred to or from a device will be read from\n  or written to a chunk of memory indicated by the rx_buffer and\n  tx_buffer members of the transaction structure. When DMA is enabled\n  for transfers, these buffers are highly recommended [...]</p>\n</blockquote>\n\n<p><a href=\"https://github.com/espressif/esp-idf/blob/master/docs/en/api-reference/peripherals/spi_master.rst\" rel=\"nofollow noreferrer\">https://github.com/espressif/esp-idf/blob/master/docs/en/api-reference/peripherals/spi_master.rst</a></p>\n"}, {"tags": ["c", "openmp", "pragma"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1539188383, "post_id": 52742036, "comment_id": 92413894, "body": "It is hard to see what you really want - you are timing a block of code that takes the same time for each thread - you are even timing it in the serial portion of the program. What do you wish to accomplish with that value?"}], "answers": [{"tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": false, "score": 0, "last_activity_date": 1539328877, "last_edit_date": 1539328877, "creation_date": 1539243360, "answer_id": 52754723, "question_id": 52742036, "link": "https://stackoverflow.com/questions/52742036/private-variable-outside-parallel-for-loop/52754723#52754723", "title": "private variable outside parallel for-loop", "body": "<p>You could try something like the code below. This allocates an array of pointers with a size equal to the number of threads and then each thread allocates private memory i.e. no false sharing.</p>\n\n<pre><code>#include &lt;omp.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n  double delta = 20, epsilon = 0;\n  double **time_taken; \n  omp_set_dynamic(0);\n\n  #pragma omp parallel\n  {\n    int it = omp_get_thread_num();\n    #pragma omp single\n    time_taken = malloc(sizeof *time_taken * omp_get_num_threads());\n    time_taken[it] = malloc(sizeof *time_taken[omp_get_thread_num()]);\n    *time_taken[it] = 0.0;\n  }\n\n  double sum = 0;\n  while(delta &gt;= epsilon) {\n    #pragma omp parallel\n    {\n      int it = omp_get_thread_num();\n      *time_taken[it] -= omp_get_wtime();\n      #pragma omp for reduction(+: sum)\n      for(int i= 0 ; i&lt;2000000000; i++) sum += 1.0*i, delta -=1;\n      *time_taken[it] += omp_get_wtime();\n    }\n  }\n  printf(\"sum %f\\n\", sum);\n\n  #pragma omp parallel\n  {\n    int it = omp_get_thread_num();\n    printf(\"time taken by thread %d: %f\\n\", it, *time_taken[it]);\n    free(time_taken[omp_get_thread_num()]);\n    #pragma omp barrier\n    #pragma omp single\n    free(time_taken);\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 7110923, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206490801023331/picture?type=large", "display_name": "Lars Karlsen", "link": "https://stackoverflow.com/users/7110923/lars-karlsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539328877, "creation_date": 1539180106, "last_edit_date": 1539243560, "question_id": 52742036, "link": "https://stackoverflow.com/questions/52742036/private-variable-outside-parallel-for-loop", "title": "private variable outside parallel for-loop", "body": "<p>I want to know how much time each thread is using in the for loop. I want time_taken to be private for each thread so they can append their own time there. Best cast i would like the total time for each thread, instead of the time for each iteration in the while-loop.</p>\n\n<pre><code>double time_taken = 0.0;\n\nwhile(delta &gt;= epsilon)\u00a0{\n    delta = 0.0;\n\n    double wtime = omp_get_wtime();\n\n    #pragma omp parallel for reduction(+:delta)\n    for (i = 0; i &lt; workSize; i++) { \n        #do some work and change delta\n    }\n    time_taken += omp_get_wtime() - wtime\n    printf(\"time taken by thread %d: %f\\n\", omp_get_thread_num(), time_taken);\n}\n</code></pre>\n\n<p>I've tried to make time_taken private inside the while-loop like this:</p>\n\n<pre><code>double time_taken = 0.0;\n\nwhile(delta &gt;= epsilon)\u00a0{\n    delta = 0.0;\n\n    #pragma omp private(time_taken)\n    {\n        double wtime = omp_get_wtime();\n\n        #pragma omp parallel for reduction(+:delta)\n        for (i = 0; i &lt; workSize; i++) { \n            #do some work and change delta\n        }\n        time_taken += opm_get_wtime() - wtime\n        printf(\"time taken by thread %d: %f\\n\", omp_get_thread_num(), time_taken);\n    }\n}\n</code></pre>\n\n<p>I've also looked into using <code>threadprivate</code>, but I can't figure out how to use it right.</p>\n"}, {"tags": ["c", "recursion", "palindrome"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 3, "creation_date": 1539180226, "post_id": 52742014, "comment_id": 92408820, "body": "Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The code, that you provided <a href=\"https://ideone.com/7vZx1d\" rel=\"nofollow noreferrer\">doesn&#39;t compile</a>."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1539180708, "post_id": 52742014, "comment_id": 92409108, "body": "What do you mean &quot;find palindrome number&quot;? How would that work for <code>625</code>? Would it be an error or should it print something like <code>62526</code>?"}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 1, "creation_date": 1539180738, "post_id": 52742014, "comment_id": 92409133, "body": "Your code has various non-standard things that make it hard for other people to compile it, perhaps you are using a very old or poor quality compiler? A few things to fix: Remove <code>#include &lt;conio.h&gt;</code> and <code>getch()</code>. Include <code>&lt;math.h&gt;</code> for the <code>log10</code> function. Make sure you return a value in the <code>if</code> block at the top of the <code>pal</code> function."}, {"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1539180904, "post_id": 52742014, "comment_id": 92409233, "body": "Once you have fixed those things, it would also help if you clearly explain the behaviour you want from your program. Given that your program clearly doesn&#39;t do what you wanted it to, it is hard for us to guess what you actually wanted."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6848710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LIIMeUKJ_9k/AAAAAAAAAAI/AAAAAAAAACM/8x_jcSeql7k/photo.jpg?sz=128", "display_name": "Mohit Yadav", "link": "https://stackoverflow.com/users/6848710/mohit-yadav"}, "is_accepted": false, "score": 3, "last_activity_date": 1539180789, "creation_date": 1539180789, "answer_id": 52742245, "question_id": 52742014, "link": "https://stackoverflow.com/questions/52742014/palindrome-number-using-recursion-in-c/52742245#52742245", "title": "palindrome number using recursion in C", "body": "<p>What exactly are you trying to do?</p>\n\n<p>1.Checking if a number is palindrome.</p>\n\n<p>2.Finding the next smallest/greater palindrome.</p>\n\n<p>3.Finding the reverse of a number.</p>\n\n<p>Note: A palindrome number is a number that reads the same from both ends.</p>\n\n<p>For example:</p>\n\n<pre><code>         12321 -&gt; palindrome number\n         23143 -&gt; not palindrome number\n         7     -&gt; palindrome number\n</code></pre>\n\n<p>To check if a number is palindrome or not first find the reverse of that number if reverse is equal to that number then that number is palindrome else not.</p>\n"}, {"comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 1, "creation_date": 1539181167, "post_id": 52742352, "comment_id": 92409400, "body": "OP is trying to use recursion."}, {"owner": {"reputation": 1132, "user_id": 8220468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rrwv6_8LSKs/AAAAAAAAAAI/AAAAAAAAAFk/9_IEbaOrQwQ/photo.jpg?sz=128", "display_name": "Ayush Bherwani", "link": "https://stackoverflow.com/users/8220468/ayush-bherwani"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1539181280, "post_id": 52742352, "comment_id": 92409464, "body": "I know @FiddlingBits, but he asked for the easiest way to find and which is understandable."}], "tags": [], "owner": {"reputation": 1132, "user_id": 8220468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rrwv6_8LSKs/AAAAAAAAAAI/AAAAAAAAAFk/9_IEbaOrQwQ/photo.jpg?sz=128", "display_name": "Ayush Bherwani", "link": "https://stackoverflow.com/users/8220468/ayush-bherwani"}, "is_accepted": false, "score": 3, "last_activity_date": 1539181088, "creation_date": 1539181088, "answer_id": 52742352, "question_id": 52742014, "link": "https://stackoverflow.com/questions/52742014/palindrome-number-using-recursion-in-c/52742352#52742352", "title": "palindrome number using recursion in C", "body": "<pre><code>int pal(int num){\n  int n=0;\n  while (num != 0){\n    n = n * 10;\n    n = n + num%10;\n    num = num/10;\n  }\n  return num;\n}\n</code></pre>\n\n<p>This function will return you a reversed number which you can compare with the input and <code>if(input == pal(input))</code> then it is a pallidrome other wise it is not. Hope it will help you.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1539202157, "last_edit_date": 1539202157, "creation_date": 1539182112, "answer_id": 52742683, "question_id": 52742014, "link": "https://stackoverflow.com/questions/52742014/palindrome-number-using-recursion-in-c/52742683#52742683", "title": "palindrome number using recursion in C", "body": "<p>A number of problems:</p>\n\n<ul>\n<li>You're recursively calling <code>pal</code> with <code>index</code> instead of <code>num</code>;</li>\n<li>If <code>index</code> is 0, you need to return a value - what should that value be?</li>\n<li><code>main</code> returns <code>int</code>, not <code>void</code>;</li>\n<li>Your description of what you want your code to do isn't clear - are you trying to reverse a number, determine whether it's palindromic, what?</li>\n</ul>\n\n<p>Assuming you're trying to reverse a number, a recursive algorithm would look something like:</p>\n\n<pre><code>int reverse( int num )\n{\n  /**\n   * Account for negative inputs by preserving the sign and \n   * converting the input to positive for processing.\n   */\n  int sign = 1;\n  if ( num &lt; 0 )\n  {\n    sign = -1;\n    num = -num;\n  }\n\n  /**\n   * If the input is a single digit, then there's\n   * nothing to reverse and we return the original\n   * input value.\n   */\n  if ( num &lt; 10 )\n    return sign * num;\n\n  /**\n   * Otherwise, find and preserve the least significant digit.\n   */\n  int remainder = num % 10; \n\n  /**\n   * Recursively call reverse on the higher-order digits.\n   */\n  int rev = reverse( num / 10 ); \n\n  /**\n   * Determine the order of magnitude of the reversed\n   * value, multiply the remainder by that magnitude\n   * to make it the new most significant digit.\n   */\n  for ( int tmp = rev; tmp; tmp /= 10 )\n    remainder *= 10;\n\n  /**\n   * PARENTHESES MATTER HERE\n   */\n  return sign * (remainder + rev);\n}\n</code></pre>\n\n<p><strong>EDIT</strong> </p>\n\n<p>I've added some documentation to hopefully make that code a little more clear.  I also changed the way I multiply <code>remainder</code> so it doesn't rely on the <code>pow</code> function.  </p>\n"}, {"tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 2, "last_activity_date": 1539192209, "creation_date": 1539192209, "answer_id": 52745699, "question_id": 52742014, "link": "https://stackoverflow.com/questions/52742014/palindrome-number-using-recursion-in-c/52745699#52745699", "title": "palindrome number using recursion in C", "body": "<p>Completely reversing a number to check it against the original seems the wrong way to test if a number is a palindrome. Once digits on the left and right end of the number don't match, you're done, you don't need to continue reversing the number.  The solution is in the process, not in the result.</p>\n\n<p>Here's a simple recursive palindrome number predicate function:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool is_palindrome(unsigned long long number)\n{\n    unsigned int logarithm = log10(number);\n\n    if (logarithm == 0)\n    {\n        return true;  // single digit numbers are palindromes\n    }\n\n    unsigned long long power = pow(10, logarithm);\n\n    unsigned int left = number / power;\n    unsigned int right = number % 10;\n\n    if (left == right)\n    {\n        // ends match, so toss 'em and test what's left recursively\n        return is_palindrome((number - left * power) / 10);\n    }\n\n    return false;  // ends don't match, so not a palindrome\n}\n\nint main(int argc, const char *argv[])\n{\n    printf(\"%s\\n\", is_palindrome(atoll(argv[1])) ? \"Yes\" : \"No\");\n\n    return 1;\n}\n</code></pre>\n\n<p><strong>TEST CASES</strong></p>\n\n<pre><code>% ./a.out 6\nYes\n% ./a.out 66\nYes\n% ./a.out 666\nYes\n% ./a.out 625\nNo\n% ./a.out 12345678987654321\nYes\n% ./a.out 31415\nNo\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9397542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c12f2167c71c5689db37aa3cf5bfb93b?s=128&d=identicon&r=PG&f=1", "display_name": "BossySmaxx", "link": "https://stackoverflow.com/users/9397542/bossysmaxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 1, "closed_date": 1539837318, "answer_count": 4, "score": -2, "last_activity_date": 1539202157, "creation_date": 1539180039, "last_edit_date": 1539189114, "question_id": 52742014, "link": "https://stackoverflow.com/questions/52742014/palindrome-number-using-recursion-in-c", "closed_reason": "Needs details or clarity", "title": "palindrome number using recursion in C", "body": "<p>I'm just trying to find a palindrome number using recursion in C. However I'm making a mistake and that mistake I don't know. Every time it's giving me the result 0.</p>\n\n<p>Here's the source code:</p>\n\n<hr>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\nint pal(int num);\n\nvoid main()\n{\n    int num=625,res=0;\n    res=pal(num);\n    printf(\"%d\",res);\n    getch();\n}\n\nint pal(int num)\n{\n    int ans=0,rem=0,index=0;\n    index=log10(num);\n    if(index==0)\n    {\n        return ;\n    }\n\n    index--;\n\n    rem=num%10;\n    ans=ans*10+rem;\n   return pal(index--);   \n}\n</code></pre>\n\n<p>Please gimme the easiest way to find it. I need an easy to understand program.</p>\n"}, {"tags": ["c", "xcode", "terminal"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539181576, "post_id": 52741928, "comment_id": 92409668, "body": "The terminal output only shows looping up to 200, while your code goes to 300.  Make sure that the code you posted is the code you&#39;re compiling and running."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7491201"}, "edited": false, "score": 0, "creation_date": 1539182152, "post_id": 52741928, "comment_id": 92410036, "body": "Just tried your posted code (adding a <code>#include &lt;stdio.h&gt;</code>): compiled with gcc and ran within xterm (another terminal emulator). The output seems to be correct, with proper tabs and newlines as expected."}], "owner": {"reputation": 1, "user_id": 10484496, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lFi72psx8Eg/AAAAAAAAAAI/AAAAAAAAAAQ/_fHKPtdz6jM/photo.jpg?sz=128", "display_name": "Marcus Favors", "link": "https://stackoverflow.com/users/10484496/marcus-favors"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540178189, "creation_date": 1539179807, "last_edit_date": 1540178189, "question_id": 52741928, "link": "https://stackoverflow.com/questions/52741928/code-executes-properly-in-xcode-but-no-terminal", "title": "Code executes properly in Xcode but no Terminal", "body": "<p>Why this C code won't execute properly within Terminal but runs fine in Xcode?</p>\n\n<pre><code>int main () {\n\n    int farh, celcius;\n    int lower, upper, incr;\n\n    lower = 0;            // The lowest fahrenheit tempeture allowed.\n    upper = 300;        // Highest fahrenheit temperature allowed.\n    incr = 20;            // The increments in which the fahrenheit increases until it reaches (upper)\n\n    printf(\"Thanks for using our converter!\\n \");\n\n    farh = lower;\n    while (farh &lt;= upper) {\n\n        celcius = 5 * (farh - 32) /9;\n        printf(\"%d\\t%d\\n\", farh, celcius);\n        farh = farh + incr;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p><img src=\"https://i.stack.imgur.com/TFMgT.png\" alt=\"\"></p>\n"}, {"tags": ["c", "function", "struct", "scope", "malloc"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1539179816, "post_id": 52741904, "comment_id": 92408556, "body": "The scope of <code>struct block</code> is local to main."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1539180184, "last_edit_date": 1539180184, "creation_date": 1539179801, "answer_id": 52741927, "question_id": 52741904, "link": "https://stackoverflow.com/questions/52741904/error-invalid-use-of-undefined-type-struct-in-c/52741927#52741927", "title": "error: invalid use of undefined type struct in C", "body": "<p>It's about the <a href=\"https://en.wikipedia.org/wiki/Scope_(computer_science)\" rel=\"nofollow noreferrer\">scope</a>. </p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.2.1,</p>\n\n<blockquote>\n  <p>For each different entity that an identifier designates, the identifier is visible (i.e., can be\n  used) only within a region of program text called its scope. [...]</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>[...] If the declarator or type specifier that\n  declares the identifier appears inside a block or within the list of parameter declarations in\n  a function definition, the identifier has block scope, which terminates at the end of the\n  associated block. [...]</p>\n</blockquote>\n\n<p>You have defined <code>struct block</code> inside the <code>main()</code> function, so the scope is limited to that function (i.e., ends with the closing <code>}</code> of <code>main()</code>).</p>\n\n<p>Outside <code>main()</code>, <code>struct block</code> does not have a valid definition. So, your compiler is complaining.</p>\n\n<p>Move the declaration of <code>struct block</code> outside the <code>main()</code>, put it into file scope.</p>\n"}, {"comments": [{"owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "edited": false, "score": 2, "creation_date": 1539180310, "post_id": 52742007, "comment_id": 92408876, "body": "It&#39;s surely nice to have standard references, however note that this question is about C and not C++."}, {"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "reply_to_user": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "edited": false, "score": 0, "creation_date": 1539245012, "post_id": 52742007, "comment_id": 92433480, "body": "@sidyll, fixed."}], "tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": false, "score": 1, "last_activity_date": 1539245059, "last_edit_date": 1539245059, "creation_date": 1539180011, "answer_id": 52742007, "question_id": 52741904, "link": "https://stackoverflow.com/questions/52741904/error-invalid-use-of-undefined-type-struct-in-c/52742007#52742007", "title": "error: invalid use of undefined type struct in C", "body": "<blockquote>\n  <p>Each name that appears in a C++ program is only valid in some possibly\n  discontiguous portion of the source code called its scope. (<a href=\"https://en.cppreference.com/w/c/language/scope\" rel=\"nofollow noreferrer\">ISO/IEC 9899:2011</a>)</p>\n</blockquote>\n\n<p>Basically, your <code>struct</code> is only visible within the <code>{}</code> it is enclosed in. In your case those brackets  are the one of the <code>main</code> function. Outside them, your structure does not exists.</p>\n\n<p>Try something like the following:</p>\n\n<pre><code>struct block\n{\n   int i,j,k;\n};\nint main()\n{\n        block* blocks;\n\n        blocks=malloc(sizeof(struct block));\n        read_block(blocks);\n        printf(\"primo val %d\\n\",blocks[0].i);\n}\nvoid read_block(struct block *blocks)\n{\n        blocks[0].i=1;\n        blocks[0].j=2;\n        blocks[0].k=3;\n\n\n}\n\nreturn(blocks);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 10445266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VLWMIAM17kA/AAAAAAAAAAI/AAAAAAAAABk/0o8RN4GwWnE/photo.jpg?sz=128", "display_name": "federico rovere", "link": "https://stackoverflow.com/users/10445266/federico-rovere"}, "edited": false, "score": 0, "creation_date": 1539181107, "post_id": 52742057, "comment_id": 92409364, "body": "In the declaration i did what you suggest, or you mean when i call the function (line 13)?"}, {"owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "reply_to_user": {"reputation": 53, "user_id": 10445266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VLWMIAM17kA/AAAAAAAAAAI/AAAAAAAAABk/0o8RN4GwWnE/photo.jpg?sz=128", "display_name": "federico rovere", "link": "https://stackoverflow.com/users/10445266/federico-rovere"}, "edited": false, "score": 0, "creation_date": 1539181153, "post_id": 52742057, "comment_id": 92409387, "body": "@federicorovere In your line 3, the first declaration of <code>read_blocks</code>."}], "tags": [], "owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "is_accepted": true, "score": 3, "last_activity_date": 1539180176, "creation_date": 1539180176, "answer_id": 52742057, "question_id": 52741904, "link": "https://stackoverflow.com/questions/52741904/error-invalid-use-of-undefined-type-struct-in-c/52742057#52742057", "title": "error: invalid use of undefined type struct in C", "body": "<p>Since you defined  them inside <code>main()</code>, they  scope is just\n<code>main()</code>. Outside of it, they don't exist. To fix this, move\nthe declaration:</p>\n\n<pre><code>struct block\n{\n    int i,j,k;\n};\n\nint main()\n{\n    struct block *blocks;\n    /* ... */\n</code></pre>\n\n<p>Also note that you need to  declare the types in a parameter\nlist of a function declaration:</p>\n\n<pre><code>void read_block(blocks); /* bad */\nvoid read_block(struct block *blocks);\n</code></pre>\n\n<p>Finally, there is an extra  <code>return</code> statement at the end of\nyour code that would prevent  this program from compiling. I\nsuppose this  is just a typo  when pasting the code  on this\nquestion.</p>\n"}], "owner": {"reputation": 53, "user_id": 10445266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VLWMIAM17kA/AAAAAAAAAAI/AAAAAAAAABk/0o8RN4GwWnE/photo.jpg?sz=128", "display_name": "federico rovere", "link": "https://stackoverflow.com/users/10445266/federico-rovere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 0, "accepted_answer_id": 52742057, "answer_count": 3, "score": 2, "last_activity_date": 1539245059, "creation_date": 1539179722, "last_edit_date": 1539180470, "question_id": 52741904, "link": "https://stackoverflow.com/questions/52741904/error-invalid-use-of-undefined-type-struct-in-c", "title": "error: invalid use of undefined type struct in C", "body": "<p>I received this error compiling in C:</p>\n\n<pre><code>error: invalid use of undefined type \u2018struct block\u2019\n  blocks[0].i=1;\nerror: invalid use of undefined type \u2018struct block\u2019\n  blocks[0].j=1;\nerror: invalid use of undefined type \u2018struct block\u2019\n  blocks[0].k=1;\n</code></pre>\n\n<p>here my code:</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\nvoid read_block(blocks);\n\nint main()\n{\n        struct block\n        {\n                int i,j,k;\n        } *blocks;\n\n        blocks=malloc(sizeof(struct block));\n        read_block(blocks);\n        printf(\"primo val %d\\n\",blocks[0].i);\n}\nvoid read_block(struct block *blocks)\n{\n        blocks[0].i=1;\n        blocks[0].j=2;\n        blocks[0].k=3;\n\n\n}\n\nreturn(blocks);\n}\n</code></pre>\n\n<p>Blocks are defined, and they should be a struct. So why the compiler cannot see them? </p>\n"}, {"tags": ["c", "operating-system", "signals", "system-calls"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1539178860, "post_id": 52741564, "comment_id": 92407948, "body": "This is false: &quot;When we call SIGINT (ctrl+c) on a parent process, I understand that the parent process will relay the signal to its child processes&quot;. Rather, signals generated by actions on the controlling terminal are sent to the entire foreground process group, which includes both the parent and child unless they change their process groups."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539178863, "post_id": 52741564, "comment_id": 92407950, "body": "The child is an almost exact copy of the parent and it\u2019s signal handlers are unchanged.  If there\u2019s an <code>execve()</code> or similar, signal handling changes, but not with <code>fork()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 0, "last_activity_date": 1539179064, "creation_date": 1539179064, "answer_id": 52741680, "question_id": 52741564, "link": "https://stackoverflow.com/questions/52741564/if-i-register-a-custom-signal-handler-on-a-process-before-forking-will-the-subs/52741680#52741680", "title": "If I register a custom signal handler on a process before forking, will the subsequent child processes also have the custom signal handler registered?", "body": "<p>Some notes: Your use of <code>stdio</code> is badly messed up with respect to both signals and forking. Unless (roughly speaking; the detailed rules can be found in the POSIX XSH 2.5.1) you flush the stream before forking, only one forked child can continue to use a given stream (in your case, <code>stdout</code>) after the fork. In general it's unsafe to call functions which are not classified as \"async-signal safe\" from a signal handler too, but as long as you've reached the while loop before you hit Ctrl-C that should not affect you.</p>\n\n<p>With that said, your problem just seems to be that your child processes are immediately exiting:</p>\n\n<pre><code>if (pid == 0) {\n        return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1539179113, "creation_date": 1539179113, "answer_id": 52741700, "question_id": 52741564, "link": "https://stackoverflow.com/questions/52741564/if-i-register-a-custom-signal-handler-on-a-process-before-forking-will-the-subs/52741700#52741700", "title": "If I register a custom signal handler on a process before forking, will the subsequent child processes also have the custom signal handler registered?", "body": "<p>When you do this:</p>\n\n<pre><code>for (int count = 0; count &lt; 10; count++) {\n    int pid = fork();\n    if (pid == 0) {\n        return 0;\n    }\n}\n</code></pre>\n\n<p>You're telling the child processes to exit <em>immediately</em>, so they never get a chance to get the signal.  Instead, have the children <code>break</code> out of the loop:</p>\n\n<pre><code>for (int count = 0; count &lt; 10; count++) {\n    int pid = fork();\n    if (pid == 0) {\n        break;\n    }\n}\n</code></pre>\n\n<p>Then the child processes will be active when CTRL-C is pressed.</p>\n"}], "owner": {"reputation": 35, "user_id": 9977637, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iibdMePQEJ8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1hbis3Qesk7nYjye9E6hRaT7eEVQ/mo/photo.jpg?sz=128", "display_name": "LawlLolz", "link": "https://stackoverflow.com/users/9977637/lawllolz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 52741700, "answer_count": 2, "score": 1, "last_activity_date": 1539179113, "creation_date": 1539178737, "question_id": 52741564, "link": "https://stackoverflow.com/questions/52741564/if-i-register-a-custom-signal-handler-on-a-process-before-forking-will-the-subs", "title": "If I register a custom signal handler on a process before forking, will the subsequent child processes also have the custom signal handler registered?", "body": "<p>When we call SIGINT (ctrl+c) on a parent process, I understand that the parent process will relay the signal to its child processes. However, will the child processes handle the signal in the same way as the parent, assuming that I have registered a custom signal handler before forking. For example:</p>\n\n<pre><code>void interruptHandler(int sig) {\n    int thisPid = (int) getpid();\n    while (1) {\n        int childPid = wait(NULL);\n        if (childPid == -1) break;\n        printf(\"\\t[%d] terminated.\\n\", childPid);\n    }\n\n    printf(\"PID[%d] Ended.\\n\", thisPid);\n    exit(1);\n\n}\n\nint main(int argc, char const *argv[]) {\n    if (signal(SIGINT, interruptHandler) == SIG_ERR) {\n        printf(\"Handler registration error\");\n    }\n\n    for (int count = 0; count &lt; 10; count++) {\n        int pid = fork();\n        if (pid == 0) {\n            return 0;\n        }\n    }\n\n    while (1);\n    return 0;\n}\n</code></pre>\n\n<p>Executing ctrl+c when the above process is running seems to give me the impression that the parent only handles the signal with the custom handler, while the child process handle the signal with the default handler.</p>\n\n<p>This is what the output looks like: <a href=\"https://i.stack.imgur.com/ovI1V.png\" rel=\"nofollow noreferrer\">1</a></p>\n\n<p>Is there a way to get the child processes to use the custom handler?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1539178557, "post_id": 52741470, "comment_id": 92407741, "body": "So you want to transform a 2D array sized [n][m] to [m][n] ? Because you&#39;re code doesn&#39;t match that ."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539178694, "post_id": 52741470, "comment_id": 92407837, "body": "How is your array defined?  Is it a regular 1D array, or a 2D array?  Is it just the print order that has to be changed?"}, {"owner": {"reputation": 127, "user_id": 5892464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/DTjAp.jpg?s=128&g=1", "display_name": "moonPride", "link": "https://stackoverflow.com/users/5892464/moonpride"}, "edited": false, "score": 0, "creation_date": 1539178794, "post_id": 52741470, "comment_id": 92407899, "body": "sorry i forgot to put the code"}, {"owner": {"reputation": 127, "user_id": 5892464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/DTjAp.jpg?s=128&g=1", "display_name": "moonPride", "link": "https://stackoverflow.com/users/5892464/moonpride"}, "edited": false, "score": 0, "creation_date": 1539178829, "post_id": 52741470, "comment_id": 92407926, "body": "i was changed the code....please take a look"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 4, "creation_date": 1539178887, "post_id": 52741470, "comment_id": 92407964, "body": "<code>printf(&quot;(%2i) &quot;,i+1, data[i]);</code> doesn&#39;t do what you appear to think it does."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1539179943, "post_id": 52741470, "comment_id": 92408628, "body": "If it is just about <i>printing</i>, you don&#39;t need to swap. Just print differently."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539182920, "post_id": 52741470, "comment_id": 92410526, "body": "Please (re)read the guidelines on how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  The <code>swapData()</code> and <code>selectionSort()</code> functions are extraneous (non-minimal), and <code>main()</code> is missing (incomplete).  It is possible to deduce some of what you want from what you show, but the printing <code>cetakData()</code> doesn&#39;t print the randomly generated strings.  The <code>5</code> that appears in your code is not clearly related to <code>JUMLAHDATA</code> (you don&#39;t show that definition, either).  Clean parameterization of functions is an art form; you&#39;d do better passing size arguments to the functions."}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 1, "last_activity_date": 1539179769, "last_edit_date": 1539179769, "creation_date": 1539179065, "answer_id": 52741682, "question_id": 52741470, "link": "https://stackoverflow.com/questions/52741470/change-row-to-column-with-array-in-c/52741682#52741682", "title": "change row to column with array in C", "body": "<p>First get your data arrays/pointers straight :)</p>\n\n<pre><code>void cetakData_by_twos(int *data) {\n    for (int i = 0; i &lt; JUMLAHDATA / 2; i++) {\n        printf(\"(%2i) (%2i)\\n\", data[i], data[i + JUMLAHDATA / 2]);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 5892464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/DTjAp.jpg?s=128&g=1", "display_name": "moonPride", "link": "https://stackoverflow.com/users/5892464/moonpride"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539179769, "creation_date": 1539178440, "last_edit_date": 1539178735, "question_id": 52741470, "link": "https://stackoverflow.com/questions/52741470/change-row-to-column-with-array-in-c", "title": "change row to column with array in C", "body": "<p>In the ouput I have array data like this </p>\n\n<p>( 1) ( 2) ( 3) ( 4) ( 5) <br>\n( 6) ( 7) ( 8) ( 9) (10)</p>\n\n<p>I want to change that output with new ouput like this</p>\n\n<p>( 1) ( 6) <br>\n( 2) ( 7) <br>\n( 3) ( 8) <br>\n( 4) ( 9) <br>\n( 5) ( 10) <br></p>\n\n<p>what should i do?</p>\n\n<p>this is my code to display the first output </p>\n\n<pre><code>void generateRandomData(char **data){\nint i, j, max;\nsrand(time(NULL));\nfor(i=0;i&lt;JUMLAHDATA;i++) {\n    max=rand()%(10)+1;\n    data[i]=malloc(max+1); \n    for (j= 0;j&lt;max;j++) {\n        data[i][j]=rand()%(24)+97;\n    }\n    data[i][j] = '\\0';  \n}\n\n}\n\nvoid swapData(char *x,char *y){\n   char temp;\n   temp = *x;\n   *x = *y;\n   *y = temp;\n}\n\nvoid selectionSort(char **data){\n    int i, j, min;\n    for (i=0;i&lt;JUMLAHDATA-1;i++){\n    min=i;\n        for (j=i+1;j&lt;JUMLAHDATA;j++){\n            if (strcmp(data[j],data[min])&lt;0){         \n            min = j;\n            }        \n        }\n        swapData(data[i],data[min]); \n   }\n}\n\nvoid cetakData(char **data){\n    int i;\n    for(i=0;i&lt;JUMLAHDATA;i++){\n        printf(\"(%2i) \",i+1, data[i]);\n        if((i+1)%5==0) printf(\"\\n\");\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1539178538, "post_id": 52741449, "comment_id": 92407726, "body": "It isn&#39;t being calculated based on input, it&#39;s being calculated based on the hardcoded paramaters <code>5, 2</code>."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1539178555, "post_id": 52741449, "comment_id": 92407739, "body": "<code>comb</code> is <code>return</code>ing <code>5! &#47; (2! * (5-2)!)</code>"}, {"owner": {"reputation": 5, "user_id": 10484452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oNCW1bYGO5c/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV9omE_wMyrF3oHrwDFKZOXF2lsSA/mo/photo.jpg?sz=128", "display_name": "Pranav Kumar", "link": "https://stackoverflow.com/users/10484452/pranav-kumar"}, "edited": false, "score": 0, "creation_date": 1539178627, "post_id": 52741449, "comment_id": 92407790, "body": "Yeah but how is it doing so?"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1539178713, "post_id": 52741449, "comment_id": 92407848, "body": "<code>factorial</code> is calculating <code>5!</code> like this: <code>1*2*3*4*5</code>.  It is calculating the other values in a similar way."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 6, "creation_date": 1539178738, "post_id": 52741449, "comment_id": 92407870, "body": "It&#39;s unclear what your question is.  What exactly are you unsure of?  What <b>specifically</b> don&#39;t you understand?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539178814, "post_id": 52741449, "comment_id": 92407913, "body": "Beware of integer Overflow. You can\u2019t do much multiplying of factorials without running into overflow problems."}, {"owner": {"reputation": 5, "user_id": 10484452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oNCW1bYGO5c/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV9omE_wMyrF3oHrwDFKZOXF2lsSA/mo/photo.jpg?sz=128", "display_name": "Pranav Kumar", "link": "https://stackoverflow.com/users/10484452/pranav-kumar"}, "edited": false, "score": 0, "creation_date": 1539178896, "post_id": 52741449, "comment_id": 92407970, "body": "For example lets say the argument is 3, 2 how is the output of the program 3?"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1539178939, "post_id": 52741449, "comment_id": 92408005, "body": "You should understand the equation before you can understand the code."}, {"owner": {"reputation": 5, "user_id": 10484452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oNCW1bYGO5c/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV9omE_wMyrF3oHrwDFKZOXF2lsSA/mo/photo.jpg?sz=128", "display_name": "Pranav Kumar", "link": "https://stackoverflow.com/users/10484452/pranav-kumar"}, "edited": false, "score": 0, "creation_date": 1539179095, "post_id": 52741449, "comment_id": 92408106, "body": "Yes i did not understand the question sir please explain?"}, {"owner": {"reputation": 5, "user_id": 10484452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oNCW1bYGO5c/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV9omE_wMyrF3oHrwDFKZOXF2lsSA/mo/photo.jpg?sz=128", "display_name": "Pranav Kumar", "link": "https://stackoverflow.com/users/10484452/pranav-kumar"}, "edited": false, "score": 0, "creation_date": 1539179188, "post_id": 52741449, "comment_id": 92408166, "body": "I got this question somewhere else and did not understand the working of it"}, {"owner": {"reputation": 1787, "user_id": 1712449, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/PlwBV.gif?s=128&g=1", "display_name": "hymie", "link": "https://stackoverflow.com/users/1712449/hymie"}, "edited": false, "score": 0, "creation_date": 1539183098, "post_id": 52741449, "comment_id": 92410621, "body": "Are you asking about the mathematics, or are you asking about the program that performs the mathematics?  That is -- do you not understand how the program works, or do you not understand the multiplication, division, and factorial operations?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10484452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oNCW1bYGO5c/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV9omE_wMyrF3oHrwDFKZOXF2lsSA/mo/photo.jpg?sz=128", "display_name": "Pranav Kumar", "link": "https://stackoverflow.com/users/10484452/pranav-kumar"}, "edited": false, "score": 0, "creation_date": 1539179007, "post_id": 52741586, "comment_id": 92408052, "body": "And y is the output 10 is my question"}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1539179024, "post_id": 52741586, "comment_id": 92408062, "body": "This is 100% not an answer , and I want to believe the OP knows how to use variables ."}, {"owner": {"reputation": 4073, "user_id": 9926383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4YBxe.jpg?s=128&g=1", "display_name": "kalehmann", "link": "https://stackoverflow.com/users/9926383/kalehmann"}, "reply_to_user": {"reputation": 5, "user_id": 10484452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oNCW1bYGO5c/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV9omE_wMyrF3oHrwDFKZOXF2lsSA/mo/photo.jpg?sz=128", "display_name": "Pranav Kumar", "link": "https://stackoverflow.com/users/10484452/pranav-kumar"}, "edited": false, "score": 0, "creation_date": 1539179773, "post_id": 52741586, "comment_id": 92408524, "body": "@PranavKumar, I have updated my answer trying to understand your question and explain the way to the output."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1539180573, "post_id": 52741586, "comment_id": 92409032, "body": "Very well explained."}], "tags": [], "owner": {"reputation": 4073, "user_id": 9926383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4YBxe.jpg?s=128&g=1", "display_name": "kalehmann", "link": "https://stackoverflow.com/users/9926383/kalehmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1539179728, "last_edit_date": 1539179728, "creation_date": 1539178796, "answer_id": 52741586, "question_id": 52741449, "link": "https://stackoverflow.com/questions/52741449/explanation-on-the-problem-and-piece-of-code/52741586#52741586", "title": "Explanation on the problem and piece of code", "body": "<h1>Why is the output 10 for 5 and 2?</h1>\n\n<p><code>n!</code> means the <a href=\"https://en.wikipedia.org/wiki/Factorial\" rel=\"nofollow noreferrer\">the factorial of n</a>. In this case <code>n = 5</code> and <code>n! = 5 * 4 * 3 * 2 * 1 = 120</code></p>\n\n<p>And <code>p! = 2</code> and <code>(n - p)! = 6</code>.</p>\n\n<p>Therefore you have <code>120 / (2 * 6)</code>, which gives us 10.</p>\n\n<h2>How does the factorial function exactly work?</h2>\n\n<p>When the factorial of n is computed, first a variable called <code>result</code> is set to <code>1</code>.</p>\n\n<p>Then this <code>result</code> variable gets multiplied with every number from <code>2</code> to <code>n</code> inside the for loop, resulting in </p>\n\n<pre><code>result = 1 * 2 * 3 * ... * n\n</code></pre>\n\n<h2>Ask the user to input <code>n</code> and <code>p</code></h2>\n\n<p>You may also want to ask the user for the numbers <code>n</code> and <code>p</code>:</p>\n\n<pre><code>int main()\n{\n    int n, p;\n    printf(\"Enter n and p comma seperated: \");\n    scanf(\"%d, %d\", &amp;n, &amp;p);\n    printf(\"The result is %d\\n\", comb(n,p));\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>Enter n and p comma seperated: 5, 2\nThe result is 10\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10484452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oNCW1bYGO5c/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV9omE_wMyrF3oHrwDFKZOXF2lsSA/mo/photo.jpg?sz=128", "display_name": "Pranav Kumar", "link": "https://stackoverflow.com/users/10484452/pranav-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539179728, "creation_date": 1539178388, "last_edit_date": 1539178812, "question_id": 52741449, "link": "https://stackoverflow.com/questions/52741449/explanation-on-the-problem-and-piece-of-code", "title": "Explanation on the problem and piece of code", "body": "<p><img src=\"https://i.stack.imgur.com/PLyTu.png\" alt=\"Link to the problem\"></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint factorial(int num)\n{\n    int result = 1;\n    for(int i = 2; i &lt;= num; i++)\n    {\n        result *= i;\n    }\n    return result;\n}\n\nint comb(int n, int p)\n{\n    return factorial(n)/(factorial(p)* factorial(n-p));\n}\nint main()\n{\n    int n, p;\n    printf(\"%d\",comb(5,2));\n}\n</code></pre>\n\n<p>How is the combination being calculated based on the values 5,2?\nWhat is the logic behind the program?</p>\n"}, {"tags": ["c", "linux-kernel", "kernel"], "comments": [{"owner": {"reputation": 1678, "user_id": 872496, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9f14f81481ca61ef53fe445dfa7a2f52?s=128&d=identicon&r=PG", "display_name": "rudolf_franek", "link": "https://stackoverflow.com/users/872496/rudolf-franek"}, "edited": false, "score": 0, "creation_date": 1539178951, "post_id": 52741310, "comment_id": 92408015, "body": "Could you try to prepare some example(s) and ask more specific question please?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539179522, "post_id": 52741310, "comment_id": 92408370, "body": "Possible <a href=\"https://stackoverflow.com/questions/9629850/how-to-get-cpu-info-in-c-on-linux-such-as-number-of-cores\">duplicate question</a>. But can&#39;t you get the cpu info directly from the processor itself?"}], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 10470034, "user_type": "registered", "profile_image": "https://graph.facebook.com/1830738737045746/picture?type=large", "display_name": "Nikita Yushchenko", "link": "https://stackoverflow.com/users/10470034/nikita-yushchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1539203834, "creation_date": 1539203834, "answer_id": 52748422, "question_id": 52741310, "link": "https://stackoverflow.com/questions/52741310/c-displaying-cpu-info-using-kernel-module/52748422#52748422", "title": "C- displaying CPU info using kernel module", "body": "<p>/proc/cpuinfo output is generated by kernel code; you can check that code and do the same in your kernel module.</p>\n\n<p>Code is located in fs/proc/cpuinfo.c</p>\n\n<p>It references 'cpuinfo_op' object that is provided by architecture-dependent code, try 'grep cpuinfo_op arch' from toplevel directory of kernel source to locate it.</p>\n"}], "owner": {"reputation": 1, "user_id": 10484432, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0IIlR0jabnI/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVRtuU7SToUZA7tw5Oj7fQza1ESHQ/mo/photo.jpg?sz=128", "display_name": "Aprika Luna", "link": "https://stackoverflow.com/users/10484432/aprika-luna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1605687806, "creation_date": 1539177904, "last_edit_date": 1539179784, "question_id": 52741310, "link": "https://stackoverflow.com/questions/52741310/c-displaying-cpu-info-using-kernel-module", "title": "C- displaying CPU info using kernel module", "body": "<p>I've recently learned about kernel modules and I was thinking on how to create one that does what <code>cat /proc/cpuinfo</code> does.</p>\n\n<p>Is it possible to do this without opening/reading the file directly (fread)? </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1539177126, "post_id": 52741060, "comment_id": 92406826, "body": "When you do <code>int a[20]</code> then there&#39;s already 20 elements, regardless of whether you initialize them or not. The ones you don&#39;t initialize will just have rubbish values."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1539177347, "post_id": 52741060, "comment_id": 92406980, "body": "@Blaze with an initializer, i.e. <code>int a[20] = { 1, 2, 3, 4, 5, 7, 8, 9, 10 }</code>, the remaining 10 values are zero-initialized, that is, initialized as if <code>a[]</code> had static storage duration."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1539177351, "post_id": 52741060, "comment_id": 92406981, "body": "This sounds like a quizz or exam question. Best if you look it up, then you learn more than from us giving you answer c)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1539177366, "post_id": 52741060, "comment_id": 92406992, "body": "&quot;i take only 10 elements as input (and not initialised)&quot;  What does this even mean? Please post some example code in either C or C++."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1539177367, "post_id": 52741060, "comment_id": 92406994, "body": "<code>int a[20]</code> has 20 elements. period. If you want to keep track of what elements hold meaningful values, thats your buisness ;)"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1539177455, "post_id": 52741060, "comment_id": 92407052, "body": "what language is this question about? C and C++ are not the same. Even for something seemingly basic as arrays C and C++ are different (eg C has VLAs C++ not)"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1539177516, "post_id": 52741060, "comment_id": 92407089, "body": "@DavidBowling That&#39;s right. On a related note, I used to think that ` int a[20] = {0}` stands for &quot;init the whole thing with zeros&quot;... not knowing that the first int is set to <code>0</code> for different reasons than the other 19. Luckily the result is the same. :)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1539177584, "post_id": 52741060, "comment_id": 92407134, "body": "@Blaze: These days in C++ you can use <code>int a[20]  = {};</code>"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1539177714, "post_id": 52741060, "comment_id": 92407225, "body": "@Bathsheba I didn&#39;t know that. Thanks for the tip!"}, {"owner": {"reputation": 61, "user_id": 9777508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e92c258ce2e870b693c136297c58bd7e?s=128&d=identicon&r=PG&f=1", "display_name": "yade123", "link": "https://stackoverflow.com/users/9777508/yade123"}, "edited": false, "score": 0, "creation_date": 1539178377, "post_id": 52741060, "comment_id": 92407622, "body": "thank you everyone for clarifying my doubt , guess i was confused with the terminology of &quot;elements&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539180868, "post_id": 52741189, "comment_id": 92409207, "body": "Curious code sample used 6 <code>%d</code> rather than 7 and <code>a+6</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1539181162, "post_id": 52741189, "comment_id": 92409398, "body": "@chux: I wanted to make sure I had a final valid (but uninitialised) array element."}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 3, "last_activity_date": 1539178547, "last_edit_date": 1539178547, "creation_date": 1539177455, "answer_id": 52741189, "question_id": 52741060, "link": "https://stackoverflow.com/questions/52741060/in-an-arrayint-of-x-elements-what-is-the-last-index-of-the-arraystatic-a/52741189#52741189", "title": "in an array(int) of x elements what is the last index of the array(static) ? a) x-1 b)programmer defined?", "body": "<p>You should keep a count of how many elements have a valid value ... and do not attempt to read the unitialized ones.</p>\n\n<pre><code>int a[7];\nint n = scanf(\"%d%d%d%d%d%d\", a+0, a+1, a+2, a+3, a+4, a+5);\nif (n &gt;= 1) {\n    printf(\"last one: %d\\n\", a[n - 1]);\n    //printf(\"UB: %d\\n\", a[n]);\n    //printf(\"UB: %d\\n\", a[6]); //a[6] is uninitialized / not assigned a value\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1539178416, "creation_date": 1539178416, "answer_id": 52741462, "question_id": 52741060, "link": "https://stackoverflow.com/questions/52741060/in-an-arrayint-of-x-elements-what-is-the-last-index-of-the-arraystatic-a/52741462#52741462", "title": "in an array(int) of x elements what is the last index of the array(static) ? a) x-1 b)programmer defined?", "body": "<p>In your example, <code>a</code> has 100 elements.  You then enter a value into the first 10 of those elements.</p>\n\n<p>So you have an array with 100 elements, and of those the first 10 have defined values (e.g. the ones you assigned) and the rest have <strong>indeterminate values</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1539178606, "creation_date": 1539178606, "answer_id": 52741514, "question_id": 52741060, "link": "https://stackoverflow.com/questions/52741060/in-an-arrayint-of-x-elements-what-is-the-last-index-of-the-arraystatic-a/52741514#52741514", "title": "in an array(int) of x elements what is the last index of the array(static) ? a) x-1 b)programmer defined?", "body": "<p>Well, you actually answer the question in your question....</p>\n\n<blockquote>\n  <p>lets say i have an array int a[20] .....</p>\n  \n  <p>eg : in the above array the total elements are just 10 ,but <strong>the last index is 19</strong></p>\n</blockquote>\n\n<p>That's it! For an array of x elements the last index is a) x-1</p>\n\n<p>If you have an array of 100 elements the last index is always 99 (i.e. 100-1).</p>\n\n<p>It does <strong>not</strong> matter that you only write to 10 of the 100 elements. It just means that you have an array with 10 initialized elements and 90 uninitialized elements. But there are still 100 elements and memory have been allocated for 100 elements and the last valid index is always 99.</p>\n\n<p>So you could do:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nmain()\n{\n  int a[100],i;\n  for(i=0;i&lt;10;i++)\n  {\n    scanf(\"%d\",&amp;a[i]);  // you should check return value here...            \n  }\n  a[99] = 42;  // Write to element number 100 using index 99\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9777508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e92c258ce2e870b693c136297c58bd7e?s=128&d=identicon&r=PG&f=1", "display_name": "yade123", "link": "https://stackoverflow.com/users/9777508/yade123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1539178606, "creation_date": 1539177029, "last_edit_date": 1539178097, "question_id": 52741060, "link": "https://stackoverflow.com/questions/52741060/in-an-arrayint-of-x-elements-what-is-the-last-index-of-the-arraystatic-a", "title": "in an array(int) of x elements what is the last index of the array(static) ? a) x-1 b)programmer defined?", "body": "<p>lets say i have an array int a[20]\nand i take only 10 elements as input (and not initialised) ..so when we refer to elements shouldnt it be just 10? are those empty also counted as elements?</p>\n\n<p>eg :\n    in the above array the total elements are just 10 ,but the last index is 19</p>\n\n<p>is this correct?</p>\n\n<p>edit:\n        Yes this was a qutestion in one of my tests  the sameple would be something like:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nmain()\n{\n  int a[100],i;\n  for(i=0;i&lt;10;i++)\n     {\n         scanf(\"%d\",&amp;a[i]);\n     }\n     //will the value of a[99] also come under \"elements\"?\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "cryptography", "public-key-encryption", "libsodium"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5382962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bede225260668ef42bfb94aaf13b2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "hermetik", "link": "https://stackoverflow.com/users/5382962/hermetik"}, "edited": false, "score": 0, "creation_date": 1539203839, "post_id": 52741914, "comment_id": 92421305, "body": "Nope, it actually returns 1, I was surprised as well. You were partly right regarding the size of the data. It is equal to the <i>original_msg_len + crypto_box_SEALBYTES</i>, I will updated my question with the solution."}], "tags": [], "owner": {"reputation": 35, "user_id": 5407027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9308b62e32c5a9dabbcd1002a3b13c08?s=128&d=identicon&r=PG&f=1", "display_name": "DamV", "link": "https://stackoverflow.com/users/5407027/damv"}, "is_accepted": false, "score": 1, "last_activity_date": 1539179758, "creation_date": 1539179758, "answer_id": 52741914, "question_id": 52740857, "link": "https://stackoverflow.com/questions/52740857/libsodium-crypto-box-seal-open-failing/52741914#52741914", "title": "libsodium crypto_box_seal_open failing", "body": "<blockquote>\n  <p>When I retrieve the message for decryption, the call to libsodium fails with an error code of 1</p>\n</blockquote>\n\n<p>You mean it returns -1, right ?</p>\n\n<p>I wonder if the issue can be with the size of the array which contains binary values. I mean if the size of the data stored in hexadecimal form is smaller than the buf you allocated to store it, you will loose the information of which part of the buf has actually been written to.</p>\n\n<p>I am especially concerned about enc_body -> tmp. If the size of the binary data is smaller than BUFLEN, you will give to crypto_box_seal_open a buffer size bigger than the one you want to give. It will cause an issue with decryption, no ?</p>\n\n<p>In practice I think you must recover the size of the data after calling hex2bin (it probably outputs it), then pass it to crypto_box_seal_open instead of sizeof(tmp) (aka BUFLEN).</p>\n"}, {"tags": [], "owner": {"reputation": 1378, "user_id": 953439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgYlS.jpg?s=128&g=1", "display_name": "Frank Denis", "link": "https://stackoverflow.com/users/953439/frank-denis"}, "is_accepted": true, "score": 1, "last_activity_date": 1539198579, "creation_date": 1539198579, "answer_id": 52747216, "question_id": 52740857, "link": "https://stackoverflow.com/questions/52740857/libsodium-crypto-box-seal-open-failing/52747216#52747216", "title": "libsodium crypto_box_seal_open failing", "body": "<p><code>sizeof &lt;pointer&gt;</code> returns a constant, the size of the pointer itself.</p>\n\n<p>In your code <code>sizeof(msg)</code> will always return 4 or 8, no matter what the message size is.</p>\n\n<p><code>sizeof(msg-&gt;enc_body)</code> probably doesn't do what you want either.</p>\n\n<p>If you are new to the C language, I'd recommend forgetting the <code>sizeof</code> keyword. </p>\n\n<p>You rarely need it, and it's the main source of confusion, bugs and vulnerabilities in applications written by people new to the language.</p>\n\n<p>The only thing you need to remember is that <code>sizeof (&lt;type&gt;)</code> or <code>sizeof value</code> always returns a constant.</p>\n"}], "owner": {"reputation": 105, "user_id": 5382962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bede225260668ef42bfb94aaf13b2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "hermetik", "link": "https://stackoverflow.com/users/5382962/hermetik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 52747216, "answer_count": 2, "score": 0, "last_activity_date": 1539204391, "creation_date": 1539176370, "last_edit_date": 1539204391, "question_id": 52740857, "link": "https://stackoverflow.com/questions/52740857/libsodium-crypto-box-seal-open-failing", "title": "libsodium crypto_box_seal_open failing", "body": "<p>I am using the following function to create a sealed box using libsodium:</p>\n\n<pre><code>void encrypt_message(char *msg, char *enc_msg, int db_id)\n{\n    unsigned char pk[crypto_box_PUBLICKEYBYTES] = { '\\0' };\n    char key[BUFLEN] = { '\\0' };\n\n    db_man_get_contacts_public_key(db_id, key);\n\n    sodium_hex2bin(pk, crypto_box_publickeybytes(), key, sizeof(key), \n                    NULL, NULL, NULL);\n\n    crypto_box_seal(enc_msg, msg, sizeof(msg), pk);\n}\n</code></pre>\n\n<p>After which, I convert the binary encrypted message to hex, for storage on disk, utilizing the following libsodium function</p>\n\n<pre><code>sodium_bin2hex(hex_cipher_text, sizeof(hex_cipher_text),\n                       cipher_text, sizeof(cipher_text));\n</code></pre>\n\n<p>The <em>hex_cipher_text</em> is then stored in a SQLite3 database. When I retrieve the message for decryption, the call to libsodium fails with an error code of <strong>1</strong>. My decryption function is as follows:</p>\n\n<pre><code>void decrypt_message(message *msg)\n{\n    unsigned char pk[crypto_box_SECRETKEYBYTES] = { '\\0' };\n    unsigned char pubkey[crypto_box_PUBLICKEYBYTES] = { '\\0' };\n    char key[BUFLEN] = { '\\0' };\n    unsigned char tmp[BUFLEN] = { '\\0' };\n    int dbg = 0;\n\n    db_man_get_my_private_key(key);\n    sodium_hex2bin(pk, crypto_box_secretkeybytes(), key, sizeof(key), NULL, NULL, NULL);\n\n    memset(key, '\\0', BUFLEN);\n\n    db_man_get_my_public_key(key);\n    sodium_hex2bin(pubkey, crypto_box_publickeybytes(), key, sizeof(key), \n                    NULL, NULL, NULL);\n\n    sodium_hex2bin(tmp, sizeof(tmp), msg-&gt;enc_body, sizeof(msg- &gt;enc_body), \n                NULL, NULL, NULL);\n\n    if ((dbg = crypto_box_seal_open(msg-&gt;dec_body, tmp, sizeof(tmp), pubkey, pk) != 0))\n    {\n        fprintf(stderr, \"Decryption failed!\\nError code: %d\\n\\n\", dbg);   \n    }\n}\n</code></pre>\n\n<p>Any advice would be greatly appreciated.</p>\n\n<p><strong>Updated</strong></p>\n\n<p>Following the advice of <strong>Frank Denis</strong> and <strong>DamV</strong> I have modified the previous encryption and decryption functions as follows; note the change from the <em>sizeof()</em> function call to the appropriate <em>strlen()</em> function call.</p>\n\n<hr />\n\n<pre><code>void encrypt_message(char *msg, char *enc_msg, int db_id)\n{\n    unsigned char pk[crypto_box_PUBLICKEYBYTES] = { '\\0' };\n    char key[BUFLEN] = { '\\0' };\n\n    db_man_get_contacts_public_key(db_id, key);\n\n    sodium_hex2bin(pk, crypto_box_publickeybytes(), key, strlen(key), \n                    NULL, NULL, NULL);\n\n    crypto_box_seal(enc_msg, msg, USR_MSG_MAX_LENGTH, pk);\n\n}\n\nvoid decrypt_message(message *msg)\n{\n    unsigned char pk[crypto_box_SECRETKEYBYTES] = { '\\0' };\n    unsigned char pubkey[crypto_box_PUBLICKEYBYTES] = { '\\0' };\n    char key[BUFLEN] = { '\\0' };\n    unsigned char tmp[BUFLEN] = { '\\0' };\n    int dbg = 0;\n\n    db_man_get_my_private_key(key);\n    sodium_hex2bin(pk, crypto_box_secretkeybytes(), key, strlen(key), \n                    NULL, NULL, NULL);\n\n    memset(key, '\\0', BUFLEN);\n\n    db_man_get_my_public_key(key);\n    sodium_hex2bin(pubkey, crypto_box_publickeybytes(), key, \n                    strlen(key), NULL, NULL, NULL);\n\n    sodium_hex2bin(tmp, sizeof(tmp), msg-&gt;enc_body, strlen(msg-&gt;enc_body), \n                    NULL, NULL, NULL);\n\n    if ((dbg = crypto_box_seal_open(msg-&gt;dec_body, tmp, \n        USR_MSG_MAX_LENGTH + crypto_box_SEALBYTES, pubkey, pk) != 0))\n        {\n            fprintf(stderr, \"Decryption failed!\\nError code: %d\\n\\n\", dbg);\n\n        }\n}\n</code></pre>\n"}, {"tags": ["c", "endpoint", "fuse"], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1539247697, "post_id": 52755864, "comment_id": 92434980, "body": "<code>struct fuse_operations operations = {0};</code> does the very same thing, but is easier on the eye."}], "tags": [], "owner": {"reputation": 31593, "user_id": 58082, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61200477cf8983809ec152f484750204?s=128&d=identicon&r=PG", "display_name": "Pierre", "link": "https://stackoverflow.com/users/58082/pierre"}, "is_accepted": true, "score": 0, "last_activity_date": 1539247462, "creation_date": 1539247462, "answer_id": 52755864, "question_id": 52740629, "link": "https://stackoverflow.com/questions/52740629/fuse-transport-endpoint-is-not-connected/52755864#52755864", "title": "FUSE: Transport endpoint is not connected", "body": "<p>got it a simple memset was missing :-)</p>\n\n<pre><code>struct fuse_operations operations;\nmemset((void*)&amp;operations,0,sizeof(struct fuse_operations));\noperations.open = htsfuse_open;\noperations.read = htsfuse_read;\n</code></pre>\n"}], "owner": {"reputation": 31593, "user_id": 58082, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61200477cf8983809ec152f484750204?s=128&d=identicon&r=PG", "display_name": "Pierre", "link": "https://stackoverflow.com/users/58082/pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2847, "favorite_count": 0, "accepted_answer_id": 52755864, "answer_count": 1, "score": 0, "last_activity_date": 1539247462, "creation_date": 1539175574, "question_id": 52740629, "link": "https://stackoverflow.com/questions/52740629/fuse-transport-endpoint-is-not-connected", "title": "FUSE: Transport endpoint is not connected", "body": "<p><strong>Note</strong>: I read <a href=\"https://stackoverflow.com/questions/16002539\">FUSE error: Transport endpoint is not connected</a> but it doesn't help.</p>\n\n<p>I'm working with the FUSE API: <a href=\"https://github.com/libfuse/libfuse\" rel=\"nofollow noreferrer\">https://github.com/libfuse/libfuse</a></p>\n\n<p>I created a small project to test the library. The <code>main</code> looks like:</p>\n\n<pre><code>(...)\n    struct fuse_operations operations;\n    operations.open = htsfuse_open;\n    operations.read = htsfuse_read;\n    operations.release = htsfuse_release;\n    operations.readdir = htsfuse_readdir;\n    operations.getattr = htsfuse_getattr;\n\n    int ret= fuse_main( argc-1, &amp;argv[1], &amp;operations,NULL );\n(...)\n</code></pre>\n\n<p>my program is launched with:</p>\n\n<pre><code>sudo fusermount -u tmp_fuse &amp;&amp; rm -rf tmp_fuse\nmkdir -p tmp_fuse\n./htsfuse config.xml ${PWD}/tmp_fuse\nls tmp_fuse\nls: cannot access 'tmp_fuse': Transport endpoint is not connected\n</code></pre>\n\n<p>I also tried to </p>\n\n<pre><code> sudo umount -l ./tmp_fuse\n</code></pre>\n\n<p>with/without fusermount but I got the same problem.</p>\n\n<p>After my application is launched, the last line of <code>/etc/mtab</code> is</p>\n\n<pre><code>test.xml /path/to/tmp_fuse fuse.test.xml rw,nosuid,nodev,relatime,user_id=1000,group_id=1000 0 0\n</code></pre>\n\n<p>Thank you for your help.</p>\n\n<p>P.</p>\n"}, {"tags": ["c", "flush", "buffering"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1539177010, "post_id": 52740580, "comment_id": 92406762, "body": "Error messages should be reported on standard error so that they do not vanish down a pipeline and confuse following programs.  So, independently of the flushing issues, it is simply wrong to report errors on standard output."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1539177915, "post_id": 52740580, "comment_id": 92407335, "body": "Using \\n only matters if output is sent to the terminal.  What you don&#39;t like.  It makes no difference if it is redirected.  isatty() decides what happens."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539179752, "post_id": 52740580, "comment_id": 92408507, "body": "<a href=\"https://stackoverflow.com/q/39536212/2410359\">What are the rules of automatic flushing stdout buffer in C?</a> is useful here."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539180006, "post_id": 52740580, "comment_id": 92408671, "body": "Andreas: &quot;stdout is line buffered (by default)&quot; --&gt; I have not found that C specifies this.  Certainly that is implementation-defined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539179595, "post_id": 52740747, "comment_id": 92408408, "body": "Interesting assertion &quot;all stdio files  ...&quot;.  Any support/cite for that?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539188324, "post_id": 52740747, "comment_id": 92413862, "body": "@chux: Citations added."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539188838, "post_id": 52740747, "comment_id": 92414154, "body": "Unclear how &quot;line-buffered by default&quot; comes in as the streams are either <i>unbuffered</i>, <i>fully buffered</i> or <i>line buffered</i>.  The interactive device condition sets aside  <i>fully buffered</i>, leaving <i>unbuffered</i>  or  <i>line buffered</i>.  Perhaps there is something more to  insure <code>stdout</code> as <i>line-buffered</i>?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539189547, "post_id": 52740747, "comment_id": 92414584, "body": "@chux: Indeed the standard allows them to be unbuffered in that case too, but no implementors choose to do that because it&#39;s awful and no better than line-buffered for practical purposes. I&#39;ve made a small edit to note that."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1539190776, "post_id": 52740747, "comment_id": 92415290, "body": "Note that this is a pretty weak requirement -- &quot;if and only if the stream <b>can be determined</b> not to refer to an interactive device&quot;.  What if it can&#39;t easily be determined whether or not stdout refers to an interactive device?  How much effort does the standard require, or can an implementation simply say &quot;I can&#39;t determine&quot; and set it to unbuffered or line buffered regardless and still claim conformance?"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1539190993, "post_id": 52740747, "comment_id": 92415399, "body": "I&#39;m also not sure how many implementation really follow this -- on Linux, if stdout refers (directly) to a network socket it will be fully buffered even if that network socket is remotely connected to an interactive device.  If it&#39;s connected to a pty (pseudo-terminal) it will be line buffered even if that pty is not connected to an interactive device.  I guess the standard never defines what &quot;an interactive device&quot; is, so that leaves a lot of wiggle room."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1539192203, "post_id": 52740747, "comment_id": 92416025, "body": "@ChrisDodd: A socket is not an interactive device. The standard leaves it implementation-defined, but for POSIX and practical real-world purposes &quot;interactive device&quot; means a tty. Regarding &quot;can be determined&quot;, an implementation could decide that it can never determine and then always use unbuffered or line buffered mode by default, but it would not be safe to assume an implementation does this, and one which does would have abysmal performance characteristics, e.g. in a loop doing <code>putc(&#39;\\n&#39;,f)</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1539201611, "post_id": 52740747, "comment_id": 92420301, "body": "@R.. <i>the standard leaves it implementation-defined</i> Indeed. <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.2.3p7\" rel=\"nofollow noreferrer\"><b>5.1.2.3 Program execution</b>, paragraph 7</a>: &quot;What constitutes an interactive device is implementation-defined.&quot;  The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap11.html#tag_11\" rel=\"nofollow noreferrer\">POSIX definition for a &quot;terminal&quot;</a> doesn&#39;t seem to preclude much, however, other than seemingly and implicitly stating (at least to me) that <code>isatty()</code> <i>de facto</i> defines an &quot;interactive device&quot;."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1539189506, "last_edit_date": 1539189506, "creation_date": 1539175961, "answer_id": 52740747, "question_id": 52740580, "link": "https://stackoverflow.com/questions/52740580/is-there-a-difference-between-line-buffered-and-unbuffered-file-when-write-end-w/52740747#52740747", "title": "Is there a difference between line buffered and unbuffered file when write end with newline?", "body": "<p>Indeed, if a stream is line buffered and all output to it ends with a newline, then for the purposes of ensuring that output is not delayed and that you do not lose output on abnormal termination, being line buffered is just as good as being unbuffered. (A similar statement can be made if manual use of <code>fflush</code> is done consistently where needed.)</p>\n\n<p>However, the statement you made and that you're relying on, that \"<code>stdout</code> is line buffered (by default)\", is false. Rather, except for <code>stderr</code>, <em>all stdio files</em> are line-buffered (or possibly unbuffered) by default <strong>only when connected to an interactive device</strong> (tty). Otherwise they are fully buffered.</p>\n\n<p>Per 7.21.3 <em>Files</em>, \u00b67 (emphasis mine):</p>\n\n<blockquote>\n  <p>At program startup, three text streams are predefined and need not be opened explicitly -- standard input (for reading conventional input), standard output (for writing conventional output), and standard error (for writing diagnostic output). As initially opened, the standard error stream is not fully buffered; the standard input and standard output streams are <strong>fully buffered if and only if the stream can be determined not to refer to an interactive device</strong>. </p>\n</blockquote>\n\n<p>and 7.21.5.3 <em>The <code>fopen</code> function</em>, \u00b68:</p>\n\n<blockquote>\n  <p>When opened, a stream is <strong>fully buffered if and only if it can be determined not to refer to an interactive device</strong>. The error and end-of-file indicators for the stream are cleared. </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1539200867, "post_id": 52745172, "comment_id": 92419972, "body": "<i>Best to use fflush(stdout); to insure output is flushed by that time.</i>  I&#39;s say if you&#39;re emitting an error message, emit it to <code>stderr</code> and then flush it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1539212562, "post_id": 52745172, "comment_id": 92424151, "body": "@AndrewHenle Yes agree with <a href=\"https://stackoverflow.com/questions/52740580/is-there-a-difference-between-line-buffered-and-unbuffered-file-when-write-end-w/52745172?noredirect=1#comment92406762_52740580\">Jonathan Leffler</a>.  Even with errors out <code>stderr</code>, a prior <code>fflush(stdout)</code> may help to insure the order of output with co-mingled output.  Yet when its time for an error message, sometimes best to avoid extraneous other actively."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1539191395, "last_edit_date": 1592644375, "creation_date": 1539190217, "answer_id": 52745172, "question_id": 52740580, "link": "https://stackoverflow.com/questions/52740580/is-there-a-difference-between-line-buffered-and-unbuffered-file-when-write-end-w/52745172#52745172", "title": "Is there a difference between line buffered and unbuffered file when write end with newline?", "body": "<blockquote>\n<p>Is there a difference between line buffered and unbuffered file when write end with newline?</p>\n<p>is there any difference flush-wise?</p>\n</blockquote>\n<p>Given a <em>flush</em> is &quot;any unwritten buffer contents are transmitted to the host environment&quot; C11dr \u00a77.21.3 4</p>\n<p>If all  <code>stdout</code> output ends with a <code>'\\n'</code> and that stream is <em>unbuffered</em> or <em>line buffered</em>, then a following flush is not expected to do anything as there is no unwritten data.</p>\n<p>The C spec is a bit loose here.  The detailed behavior is <em>implementation defined</em>.  Best to use <code>fflush(stdout);</code> to insure output is flushed by that time. <a href=\"https://stackoverflow.com/q/39536212/2410359\">More info</a>.</p>\n"}], "owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "closed_date": 1539260106, "answer_count": 2, "score": 0, "last_activity_date": 1539191395, "creation_date": 1539175419, "last_edit_date": 1539176936, "question_id": 52740580, "link": "https://stackoverflow.com/questions/52740580/is-there-a-difference-between-line-buffered-and-unbuffered-file-when-write-end-w", "closed_reason": "Duplicate", "title": "Is there a difference between line buffered and unbuffered file when write end with newline?", "body": "<p>There I was, almost sending a rage-mail to a subcontractor (again). They used <code>printf(...)</code> to report error instead of <code>fprintf(stderr, ...)</code>, which I thought was dumb since <code>stdout</code> is (line) buffered. Especially when I found one of the prints in an assert-handler (probably ending in <code>abort</code> which does not flush open files).</p>\n\n<p>Looking closer at the prints however, all of them ended with a newline. And since <code>stdout</code> is line buffered (by default), it got me thinking: is there any difference flush-wise?</p>\n"}, {"tags": ["c", "winapi", "registry"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1539174809, "post_id": 52740356, "comment_id": 92405282, "body": "A <code>DWORD</code> is not a <code>long</code>. Cast it in the printf statement."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 3, "creation_date": 1539175140, "post_id": 52740356, "comment_id": 92405495, "body": "Question has been asked a bazillion times. See <a href=\"https://docs.microsoft.com/en-us/windows/desktop/winprog64/shared-registry-keys\" rel=\"nofollow noreferrer\">Registry Keys Affected by WOW64</a> to learn about the underlying issue. Once you find the appropriate duplicate, you can close this question."}, {"owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1539175500, "post_id": 52740356, "comment_id": 92405711, "body": "@IInspectable Thanks... you gave me a clue, i changed my solution platform to <code>x64</code> and its worked... why is this ok in <code>x64</code>?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1539176025, "post_id": 52740356, "comment_id": 92406098, "body": "you can do this in 32 bit app too, if use <code>KEY_WOW64_64KEY | KEY_READ</code> look for <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion@InstallDate</code> - here really 0."}], "answers": [{"tags": [], "owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "is_accepted": true, "score": 1, "last_activity_date": 1539178392, "last_edit_date": 1539178392, "creation_date": 1539176854, "answer_id": 52741002, "question_id": 52740356, "link": "https://stackoverflow.com/questions/52740356/read-os-install-date-value-from-registry-with-regqueryvalueexa-api-failed/52741002#52741002", "title": "Read &quot;OS install date&quot; value from registry with RegQueryValueExA() api failed", "body": "<p><strong><em>According Microsoft :</em></strong></p>\n\n<ul>\n<li><p><code>KEY_WOW64_32KEY (0x0200)</code> :</p>\n\n<p>Indicates that an application on 64-bit Windows should operate on the 32-bit registry view. This flag is ignored by 32-bit Windows. For more information, see <a href=\"https://msdn.microsoft.com/library/windows/desktop/aa384129\" rel=\"nofollow noreferrer\">Accessing an Alternate Registry View</a>.\nThis flag must be combined using the OR operator with the other flags in this table that either query or access registry values.\nWindows 2000: This flag is not supported.</p></li>\n<li><p><code>KEY_WOW64_64KEY (0x0100)</code> :</p>\n\n<p>Indicates that an application on 64-bit Windows should operate on the 64-bit registry view. This flag is ignored by 32-bit Windows. For more information, see <a href=\"https://msdn.microsoft.com/library/windows/desktop/aa384129\" rel=\"nofollow noreferrer\">Accessing an Alternate Registry View</a>.\nThis flag must be combined using the OR operator with the other flags in this table that either query or access registry values.\nWindows 2000: This flag is not supported.</p></li>\n</ul>\n\n<p>I used of <code>KEY_WOW64_64KEY | KEY_READ</code> either way <code>x86</code> and <code>x64</code> :</p>\n\n<pre><code>// Open a registry key\nlResult = RegOpenKeyExA(HKEY_LOCAL_MACHINE,\n                        \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\",\n                        0, KEY_WOW64_64KEY | KEY_READ, &amp;hKey);\n</code></pre>\n\n<p>It does work.</p>\n"}], "owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 1, "accepted_answer_id": 52741002, "answer_count": 1, "score": -1, "last_activity_date": 1539178392, "creation_date": 1539174695, "last_edit_date": 1539177089, "question_id": 52740356, "link": "https://stackoverflow.com/questions/52740356/read-os-install-date-value-from-registry-with-regqueryvalueexa-api-failed", "title": "Read &quot;OS install date&quot; value from registry with RegQueryValueExA() api failed", "body": "<p>I wanna read <strong><code>Windows Install Date</code></strong> value from <em>registry</em> using Windows API as bellow :</p>\n\n<pre><code>HKEY hKey = { 0 };\nLONG lResult = ERROR_SUCCESS;\n\n// Open a registry key\nlResult = RegOpenKeyExA(HKEY_LOCAL_MACHINE,\n                        \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\",\n                        0, KEY_READ, &amp;hKey);\n\n// If registry key opened\nif (lResult == ERROR_SUCCESS)\n{\n    // Get OS install date/time\n    DWORD dwInstallDate = 0;\n    dwBufferSize = sizeof(DWORD);\n    if (RegQueryValueExA(hKey, \"InstallDate\", 0, NULL, (LPBYTE)&amp;dwInstallDate, &amp;dwBufferSize) == ERROR_SUCCESS)\n    {\n        printf(\"OS Install Date is : %lu\", dwInstallDate);\n    }\n    else\n    {\n        printf(\"The specific key not found!\");\n    }\n\n    // Finally we should close the key when we finished with it\n    RegCloseKey(hKey);\n}\n</code></pre>\n\n<p>But the output is always <code>0</code>, while <code>\"InstallDate\"</code> value is <code>1520291827</code>:</p>\n\n<pre><code>OS Installe Date is : 0\n</code></pre>\n\n<p>Also, I'm used of <code>\"%ld\"</code> and <code>\"d\"</code> formats, but it has the same output...<br>\nThe \"InstallDate\" value in registry, contained a <code>REG_DWORD</code> type.<br>\nBy the way, when i create a new <code>REG_DWORD</code> value, my code cannot read it :</p>\n\n<p>For example , I create a value in bellow reg-address as <code>\"test\"</code> with <code>123</code> data :</p>\n\n<pre><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\n</code></pre>\n\n<p>But <code>dwInstallDate</code> will be <code>0</code> instead of <code>123</code> :</p>\n\n<pre><code>RegQueryValueExA(hKey, \"test\", 0,\n                 NULL, (LPBYTE)&amp;dwInstallDate,\n                 &amp;dwBufferSize);\n</code></pre>\n\n<p>Any Suggestion? I'm confused about this action...</p>\n"}, {"tags": ["c", "interrupt", "avr"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1539194706, "post_id": 52740329, "comment_id": 92417167, "body": "Don&#39;t ` _delay_ms(100);` inside ISR."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1539194759, "post_id": 52740329, "comment_id": 92417190, "body": "Don&#39;t <code>typedef enum{false, true} bool;</code>, do <code>#include &lt;stdbool.h&gt;</code>."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1539194939, "post_id": 52740329, "comment_id": 92417280, "body": "Do a main loop inside your main function and two global variables <code>volatile bool int0_irq, adc_irq;</code>. Inside interrupts only set them to true <code>ISR(INT0_vect) { int0_irq = true; } ISR(ADC_vect) { adc_irq = true; }</code>. Then inside your main loop simply and cleanly react for interrupts <code>while (1) { if (int0_irq) { int0_irq= false; start_adc_conversion_if_it_isnt_started(); } if (adc_irq) { adc_irq = false; och_adc_conversion_ended_get_data(); }</code>. This is a simple way of observing both interrupts. Also, try to get printf working, printf debugging is the best."}], "answers": [{"tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": false, "score": 0, "last_activity_date": 1539192963, "creation_date": 1539192963, "answer_id": 52745883, "question_id": 52740329, "link": "https://stackoverflow.com/questions/52740329/handling-multiple-interrupts-in-avr/52745883#52745883", "title": "Handling multiple interrupts in avr", "body": "<p>First of all, you should make <code>start</code> be <code>volatile</code> since it is being used by both the main loop and the interrupt.  The <code>volatile</code> keyword tells the compiler that the variable might be modified by things outside of its control, so it cannot optimize away any reads or writes to the variable:</p>\n\n<pre><code>volatile bool start = false;\n</code></pre>\n\n<p>Secondly, you probably want to <em>remove</em> this line you wrote at the end of <code>loop</code>:</p>\n\n<pre><code>while(1){}\n</code></pre>\n\n<p>That line is bad because it causes your program to go into an infinite loop where it does nothing.  I think you actually want the code you wrote about it in the <code>loop</code> function to run multiple times.</p>\n\n<p>Secondly, after you detect that the <code>start</code> flag has been set, you probably need to set it to 0, or else it will just be 1 forever.</p>\n\n<p>Third, setting <code>start</code> to false in the INT0 ISR might be a bad idea, because it might get set to false before you main loop has a chance to observe it being true and handle the event.  I guess it really depends on exactly what you are trying to do.  You could try adding details to your question about exactly what problem you are trying to solve using the AVR.  See <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">What is the XY problem?</a>.</p>\n\n<p>There are probably other issues with your code that need to be debugged.  Can you think of any ways to make this simpler?  Maybe you can reduce the number of interrupts you are using.  To debug, you can try blinking some LEDs to figure out what parts of your program are executing.</p>\n"}], "owner": {"reputation": 1, "user_id": 10388251, "user_type": "registered", "profile_image": "https://graph.facebook.com/274336486745035/picture?type=large", "display_name": "CrazyTims", "link": "https://stackoverflow.com/users/10388251/crazytims"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539244303, "creation_date": 1539174605, "last_edit_date": 1539244303, "question_id": 52740329, "link": "https://stackoverflow.com/questions/52740329/handling-multiple-interrupts-in-avr", "title": "Handling multiple interrupts in avr", "body": "<p>I am new to AVR programming, so sorry if question is trivial. </p>\n\n<p>Using : </p>\n\n<ol>\n<li>OS : Windows7 </li>\n<li>IDE : Atmel studio </li>\n<li>uC = m328p</li>\n</ol>\n\n<p>Pins: </p>\n\n<ol>\n<li>ADC signal - ADC0/PC0</li>\n<li>LED_values - (PB0 - PB7)</li>\n<li>LED_START - PD1</li>\n<li>LED_LIGHT - PD0</li>\n<li>BUTTON - PD2</li>\n</ol>\n\n<p>Goal: When you press the button it turns On the LED_START and it needs to start with conversion.\nAVR gets interrupt and starts ADC conversion. Basically program has two interrupts. I know that INT0 interrupt has highest priority. </p>\n\n<p>I dont know how to deal with them. \nI have tried several things like adding global variable \"start\" and changing it. And also when i only set LED START it turns On and it stays in that state until LED_values reach certain value, then LED START turns Off by it self. </p>\n\n<p>So please can you show me how to handle two interrupts so that fulfills stated goal and explain me what im doing wrong.</p>\n\n<pre><code>#include &lt;avr/io.h&gt;\n#include &lt;util/delay.h&gt;\n#include &lt;avr/interrupt.h&gt;\n\n#define F_CPU 1000000UL\n#define BIT_IS_SET(byte, bit) (byte &amp; (1 &lt;&lt; bit))\n#define BIT_IS_CLEAR(byte, bit) (!(byte &amp; (1 &lt;&lt; bit)))\n\ntypedef enum{false, true} bool;\n\nbool previousState = false;\nbool start = false;\n\nchar num;\n\nvoid setup();\nvoid loop();\nvoid ADC_init();\nvoid EI_init(); // External Interrupt\n\nint main(void)\n{\n    setup();\n    loop();\n}\n\nvoid setup(){\n    DDRC &amp;= ~(0x1); // LDR Input\n    DDRB = 0xFF; //LEDs value Output\n    DDRD |= 0x3; //LED light LED start Output\n    DDRD &amp;= ~(1 &lt;&lt; PIND2); //Button Input\n}\n\nvoid loop(){\n    PORTD |= (1 &lt;&lt; PIND2);\n    EI_init();\n    ADC_init();\n    sei();\n    if(start){\n        ADCSRA |= (1 &lt;&lt; ADSC);  \n    }\n    while(1){}\n\n}\n\nvoid ADC_init(){\n    ADMUX = 0x60;\n    ADCSRA = 0x8B;\n    ADCSRB = 0x0;\n    ADCH = 0x0;\n}\n\nISR(ADC_vect) {\n    PORTB = ADCH;   // assign contents of ADC high register to Port D pins\n    int b = (int)ADCH;\n    if(b &gt; 180) { //100\n        PORTD = 0x1;\n    }else{\n        PORTD &amp;= ~(0x1);\n    }\n    _delay_ms(100);\n    ADCSRA |= (1 &lt;&lt; ADSC);      // start next ADC\n}\n\nvoid EI_init(){\n    EIMSK |= (1 &lt;&lt; INT0); // Interrupt enabled\n    EICRA |= (1 &lt;&lt; ISC00); // any state change\n}\n\nISR(INT0_vect){\n    if(BIT_IS_CLEAR(PORTD,PIND2)){\n        start = true;\n    }else{\n    start = false;\n    }\n}\n</code></pre>\n\n<p>Here is scheme : <a href=\"https://i.stack.imgur.com/lcG1V.jpg\" rel=\"nofollow noreferrer\">scheme</a> </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539173960, "post_id": 52740019, "comment_id": 92404750, "body": "It is kindness by <code>printf</code> instead of dereferencing a <code>NULL</code> pointer and exploding."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1539174126, "post_id": 52740019, "comment_id": 92404874, "body": "Run your code through valgrind.  If you&#39;re mismanaging memory, it will tell you where."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1539174156, "post_id": 52740019, "comment_id": 92404884, "body": "malloc(sizeof *newCard) is wrong, that only allocates enough space for a pointer.  The subsequent heap corruption is undiagnosable.  Make that sizeof cardStack."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539174507, "post_id": 52740019, "comment_id": 92405100, "body": "The two <code>struct</code>s are both defined as a pointer type, which will be hard to manage. Try <code>printf(&quot;%zu\\n&quot;, sizeof(Game));</code>. That gives the size of a pointer, not the size of the <code>struct</code>. A pointer <code>typedef</code> is at best confusing, especially when its name contains no hint of that."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1539174836, "post_id": 52740019, "comment_id": 92405301, "body": "When you <code>printf</code> <code>NULL</code> the behaviour is <i>undefined</i>, not <code>(nil)</code>..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539181744, "post_id": 52740019, "comment_id": 92409777, "body": "<code>head = newCard;</code> in <code>addToStack()</code> serves no purpose.  Review that code.  Perhaps  code should be <code>head-&gt;next = newCard;</code>  Best to post a  `<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "owner": {"reputation": 51, "user_id": 10481580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afff180bccf5980a7a804a37bdb664d4?s=128&d=identicon&r=PG", "display_name": "yxting", "link": "https://stackoverflow.com/users/10481580/yxting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3267, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539173660, "creation_date": 1539173660, "question_id": 52740019, "link": "https://stackoverflow.com/questions/52740019/member-access-within-misaligned-address-0xbebebebe-for-type-struct-which-req", "title": "Member access within misaligned address 0xbebebebe for type struct ... which requires 4 byte alignment", "body": "<p>I have these 2 structs and function (the typedef pointers are unfortunately enforced I can't change them) for a card game</p>\n\n<pre><code>typedef struct cardStack {\n    struct cardStack *next;\n    Card card;\n} *CardStack;\n\ntypedef struct _game {\n    CardStack discardPile;\n    CardStack drawPile; \n    CardStack playerHand[4];\n    int currentPlayer;\n    int previousTurnPlayer;\n    int currentTurn;\n    int currentTurnMoves;\n    int numTurns;\n    int topDiscardTurnNumber;\n} *Game;\n\nstatic void addToStack(Card card, CardStack head){  \n    CardStack newCard = malloc(sizeof *newCard);\n    newCard-&gt;card = card;\n    newCard-&gt;next = NULL;\n\n    if (head-&gt;next == NULL) {\n        head = newCard;\n    } else {    \n        CardStack current = head;\n        while (current-&gt;next != NULL) {\n            current = current-&gt;next;\n        }\n        current-&gt;next = newCard;\n    }\n}\n</code></pre>\n\n<p>I initialise my 4 players' hands, setting next member of the head node to NULL.</p>\n\n<pre><code>game-&gt;playerHand[0] = malloc(sizeof(CardStack));\ngame-&gt;playerHand[0]-&gt;next = NULL;\nprintf(\"%p\\n\", game-&gt;playerHand[0]-&gt;next);\ngame-&gt;playerHand[1] = malloc(sizeof(CardStack));\ngame-&gt;playerHand[1]-&gt;next = NULL;\ngame-&gt;playerHand[2] = malloc(sizeof(CardStack));\ngame-&gt;playerHand[2]-&gt;next = NULL;\ngame-&gt;playerHand[3] = malloc(sizeof(CardStack));\ngame-&gt;playerHand[3]-&gt;next = NULL;\n</code></pre>\n\n<p>The printf gives me (nil)</p>\n\n<p>I then want to deal 7 cards to each player (add to the end of their hand linked list)</p>\n\n<pre><code>for (int i = 0; i &lt; 7; i++) {\n    for (int j = 0; j &lt; NUM_PLAYERS; j++) {\n        Card card = newCard(values[4 * i + j], colors[4 * i + j], suits[4 * i + j]);\n        addToStack(card, game-&gt;playerHand[j]);\n    }\n}\n</code></pre>\n\n<p>But I get this error in the function:</p>\n\n<pre><code>runtime error: member access within misaligned address 0xbebebebe for type 'struct cardStack', which requires 4 byte alignment\n0xbebebebe: note: pointer points here\n&lt;memory cannot be printed&gt;\n\nExecution stopped here in addToStack(card=0xf5500ef0, head=0xf5500f10) in Game.c at line 156:\n\n        } else {\n                CardStack current = head;\n--&gt;             while (current-&gt;next != NULL) {\n                        current = current-&gt;next;\n                }\n</code></pre>\n\n<p>I have no idea why I can print the NULL pointer perfectly fine, but when I pass it into the function it gives this error. Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++", "c", "gcc", "g++", "nios"], "comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1539174057, "post_id": 52739978, "comment_id": 92404821, "body": "How was your GCC built? Please add the output of <code>gcc -v</code> to your question."}, {"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1539178480, "post_id": 52739978, "comment_id": 92407689, "body": "You need niosii-gcc cross-compiler (included in Nios II EDS or self-built)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10473446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c19ebecfeac78ddcb95dc8ef02f027?s=128&d=identicon&r=PG&f=1", "display_name": "Struan Murray", "link": "https://stackoverflow.com/users/10473446/struan-murray"}, "edited": false, "score": 0, "creation_date": 1539192309, "post_id": 52744368, "comment_id": 92416082, "body": "Thanks for that, the aim is to use it as a cross-compiler so I&#39;ll work my way through the relevant documentation."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": true, "score": 0, "last_activity_date": 1539187159, "creation_date": 1539187159, "answer_id": 52744368, "question_id": 52739978, "link": "https://stackoverflow.com/questions/52739978/gcc-g-compilation-into-nios-2-assembly/52744368#52744368", "title": "Gcc/G++ compilation into NIOS 2 Assembly", "body": "<p>Your compiler only includes support for the x86 targets (x86-64, i386 and its variantsm and the x32 x86-64 subset).  The <code>multilib</code> and <code>multiarch</code> bits refer to something else, not multiple targets.</p>\n\n<p>I don't think there are pre-built cross-compilers targeting NIOS or NIOS 2 as part of Ubuntu (not even universe), so you probably have to build a cross-toolchain yourself, starting with a cross-binutils.</p>\n"}], "owner": {"reputation": 23, "user_id": 10473446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c19ebecfeac78ddcb95dc8ef02f027?s=128&d=identicon&r=PG&f=1", "display_name": "Struan Murray", "link": "https://stackoverflow.com/users/10473446/struan-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 52744368, "answer_count": 1, "score": 2, "last_activity_date": 1539187159, "creation_date": 1539173498, "last_edit_date": 1539176365, "question_id": 52739978, "link": "https://stackoverflow.com/questions/52739978/gcc-g-compilation-into-nios-2-assembly", "title": "Gcc/G++ compilation into NIOS 2 Assembly", "body": "<p>I am trying to have gcc/g++ convert C or C++ code into assembly using the -S and -march commands but I am unable to find an exact answer as to whether it supports NIOS 2. --target shows a list of architectures but no obvious NIOS 2. THe GNU compiler website DOES contain a list of NIOS 2 commands. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Nios-II-Options.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Nios-II-Options.html</a>\nDoes anyone know the -march architecture required for the compiler or whether support was dropped in a previous version? Currently using gcc 7.3</p>\n\n<p>-v Dump 13:58</p>\n\n<pre><code>Using built-in specs.\nCOLLECT_GCC=gcc\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Ubuntu 7.3.0-27ubuntu1~18.04' --with-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 7.3.0 (Ubuntu 7.3.0-27ubuntu1~18.04) \nCOLLECT_GCC_OPTIONS='-o' 'test' '-S' '-O3' '-march=nios2' '-v'\n /usr/lib/gcc/x86_64-linux-gnu/7/cc1plus -quiet -v -imultiarch x86_64-linux-gnu -D_GNU_SOURCE loop.cpp -quiet -dumpbase loop.cpp -march=nios2 -auxbase-strip test -O3 -version -o test -fstack-protector-strong -Wformat -Wformat-security\nGNU C++14 (Ubuntu 7.3.0-27ubuntu1~18.04) version 7.3.0 (x86_64-linux-gnu)\n    compiled by GNU C version 7.3.0, GMP version 6.1.2, MPFR version 4.0.1, MPC version 1.1.0, isl version isl-0.19-GMP\n\nGGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072\nignoring duplicate directory \"/usr/include/x86_64-linux-gnu/c++/7\"\nignoring nonexistent directory \"/usr/local/include/x86_64-linux-gnu\"\nignoring nonexistent directory \"/usr/lib/gcc/x86_64-linux-gnu/7/../../../../x86_64-linux-gnu/include\"\n#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n /usr/include/c++/7\n /usr/include/x86_64-linux-gnu/c++/7\n /usr/include/c++/7/backward\n /usr/lib/gcc/x86_64-linux-gnu/7/include\n /usr/local/include\n /usr/lib/gcc/x86_64-linux-gnu/7/include-fixed\n /usr/include/x86_64-linux-gnu\n /usr/include\nEnd of search list.\ncc1plus: error: bad value (\u2018nios2\u2019) for \u2018-march=\u2019 switch\ncc1plus: note: valid arguments to \u2018-march=\u2019 switch are: nocona core2 nehalem corei7 westmere sandybridge corei7-avx ivybridge core-avx-i haswell core-avx2 broadwell skylake skylake-avx512 bonnell atom silvermont slm knl x86-64 eden-x2 nano nano-1000 nano-2000 nano-3000 nano-x2 eden-x4 nano-x4 k8 k8-sse3 opteron opteron-sse3 athlon64 athlon64-sse3 athlon-fx amdfam10 barcelona bdver1 bdver2 bdver3 bdver4 znver1 btver1 btver2\nGNU C++14 (Ubuntu 7.3.0-27ubuntu1~18.04) version 7.3.0 (x86_64-linux-gnu)\n    compiled by GNU C version 7.3.0, GMP version 6.1.2, MPFR version 4.0.1, MPC version 1.1.0, isl version isl-0.19-GMP\n\nGGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072\n</code></pre>\n"}, {"tags": ["c", "struct", "type-conversion", "malloc"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1539173281, "post_id": 52739894, "comment_id": 92404296, "body": "Does it work with an explicit cast, like <code>triangle *tr = (triangle*)malloc(n * sizeof(triangle));</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1539173337, "post_id": 52739894, "comment_id": 92404334, "body": "C and C++ are two <i>very</i> different languages with very different behavior and rules. Please use only the language-tag of the language you&#39;re actually program in."}, {"owner": {"reputation": 86506, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1539173341, "post_id": 52739894, "comment_id": 92404338, "body": "@Yksisarvinen The reason he&#39;s getting the error is because he&#39;s using a C++ compiler."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1539173380, "post_id": 52739894, "comment_id": 92404367, "body": "@Yksisarvinen Considering the error, I&#39;d say it&#39;s the opposite."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539173396, "post_id": 52739894, "comment_id": 92404371, "body": "<code>#ifdef __cplusplus</code> / <code>#error wrong compiler</code> / <code>#endif</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1539173511, "post_id": 52739894, "comment_id": 92404450, "body": "It means that you&#39;re using a C++ compiler to compile C code.   Not forbidden, but one incompatibility between C and C++ is that C allows implicit conversion from <code>void *</code> to other pointer types, and C++ doesn&#39;t.    Read documentation for your compiler suite to work out how to compile your code as C.   With some compiler suites you may need to use a different command/driver."}, {"owner": {"reputation": 73, "user_id": 9136879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oroQ5.jpg?s=128&g=1", "display_name": "ibrahimG.", "link": "https://stackoverflow.com/users/9136879/ibrahimg"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1539173542, "post_id": 52739894, "comment_id": 92404470, "body": "@Blaze It work, amazing."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1539173733, "post_id": 52739894, "comment_id": 92404589, "body": "@ibrahimG. - it may have worked, but it also means your compiler is a C++ compiler.   Blaze&#39;s approach is bad practice in C.   Better solution, if you intend to program in C, is to use a C compiler."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1539173796, "post_id": 52739894, "comment_id": 92404635, "body": "I would suggest a bit more modern IDE"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1539173798, "post_id": 52739894, "comment_id": 92404636, "body": "As an aside, avoid <code>sizeof(TYPE)</code>. <code>sizeof expression</code> is better for maintainability and error-avoidance."}, {"owner": {"reputation": 73, "user_id": 9136879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oroQ5.jpg?s=128&g=1", "display_name": "ibrahimG.", "link": "https://stackoverflow.com/users/9136879/ibrahimg"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1539173865, "post_id": 52739894, "comment_id": 92404680, "body": "@Peter I see. If you lead me to use a good C compiler, i would be glad."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9136879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oroQ5.jpg?s=128&g=1", "display_name": "ibrahimG.", "link": "https://stackoverflow.com/users/9136879/ibrahimg"}, "edited": false, "score": 0, "creation_date": 1539173740, "post_id": 52739953, "comment_id": 92404596, "body": "I see, this was really helpful. Thanks."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 10, "last_activity_date": 1539173429, "creation_date": 1539173429, "answer_id": 52739953, "question_id": 52739894, "link": "https://stackoverflow.com/questions/52739894/invalid-conversion-void-to-struct/52739953#52739953", "title": "Invalid conversion &#39;void*&#39; to &#39;struct*&#39;", "body": "<p>This looks like C code, but you're compiling with a C++ compiler.  As such, it complains on the line you mentioned because <code>malloc</code> returns a <code>void *</code> but you're assigning the result to a <code>triangle *</code>.  </p>\n\n<p>In C++ an explicit cast is required for this.  In C, a <code>void *</code> may be implicitly converted to or from any object pointer type.</p>\n\n<p>Since this appears to be C code and not C++ code, you should compile with a C compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1539173459, "creation_date": 1539173459, "answer_id": 52739967, "question_id": 52739894, "link": "https://stackoverflow.com/questions/52739894/invalid-conversion-void-to-struct/52739967#52739967", "title": "Invalid conversion &#39;void*&#39; to &#39;struct*&#39;", "body": "<p>You compile this program as C++ program and this implicit conversion is not allowed in C++.</p>\n\n<p>As I know dev C++ uses MinGW and you may use -xc option to compile program as C program or Settings -> language standard -> and choose the language standard needed</p>\n"}, {"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1539174000, "post_id": 52740082, "comment_id": 92404784, "body": "Unnecessarily overriding the type-system is an abomination, and there&#39;s no need to cast a <code>void*</code> to a different data-pointer-type ever. Also, avoid <code>sizeof(TYPE)</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1539174008, "post_id": 52740082, "comment_id": 92404790, "body": "He should compile using the compiler for language the program was written."}], "tags": [], "owner": {"reputation": 49, "user_id": 6278766, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kdreFfjaJSI/AAAAAAAAAAI/AAAAAAAAACg/UhvtH-tIXAI/photo.jpg?sz=128", "display_name": "Mayuresh Sardar", "link": "https://stackoverflow.com/users/6278766/mayuresh-sardar"}, "is_accepted": false, "score": 0, "last_activity_date": 1539173849, "last_edit_date": 1592644375, "creation_date": 1539173849, "answer_id": 52740082, "question_id": 52739894, "link": "https://stackoverflow.com/questions/52739894/invalid-conversion-void-to-struct/52740082#52740082", "title": "Invalid conversion &#39;void*&#39; to &#39;struct*&#39;", "body": "<pre><code>triangle *tr = (triangle*)malloc(n * sizeof(triangle));\n</code></pre>\n<p>Change the line as shown above. malloc returns generic pointer, so you need to explicitly typecast it to your desired pointer.</p>\n<p><a href=\"https://stackoverflow.com/questions/20094394/why-do-we-cast-return-value-of-malloc\">Refer this</a></p>\n"}, {"tags": [], "owner": {"reputation": 673, "user_id": 7339602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3xm3Z.jpg?s=128&g=1", "display_name": "shirish", "link": "https://stackoverflow.com/users/7339602/shirish"}, "is_accepted": false, "score": 2, "last_activity_date": 1539275816, "last_edit_date": 1539275816, "creation_date": 1539174262, "answer_id": 52740220, "question_id": 52739894, "link": "https://stackoverflow.com/questions/52739894/invalid-conversion-void-to-struct/52740220#52740220", "title": "Invalid conversion &#39;void*&#39; to &#39;struct*&#39;", "body": "<p>The code looks like C code but you are compiling it with C++ compiler.<br/>    </p>\n\n<ul>\n<li><p>Make sure that the file has proper extension for C++(not .c extension).<br /> </p></li>\n<li><p>malloc() returns a <code>(void *)</code> pointer by default, so you have to explicitly cast the <code>(void *)</code> to <code>(triangle *)</code> in your code.\n<br/></p></li>\n<li>But if you are writing C++ code then I would recommend not to use malloc and free, instead try to use \"new\" operator in C++ since while instantiating objects it will call the constructors as well(unlike in malloc). <br /></li>\n</ul>\n\n<p>So to avoid complications go with new and delete in C++.</p>\n\n<p><br/>\nThe code in C should look like (file a.c)<br/>\nCompile using: <code>gcc a.c -o a.o</code><br/>\nRun using    : ./a.o</p>\n\n<p><br /></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nstruct triangle {\n  int a;\n  int b;\n  int c;\n};\n\ntypedef struct triangle triangle;\n\nint main() {\n  int n;\n  scanf(\"%d\", &amp;n);\n  triangle *tr = (triangle *)malloc(n * sizeof(triangle));\n  for (int i = 0; i &lt; n; i++) {\n    scanf(\"%d%d%d\", &amp;tr[i].a, &amp;tr[i].b, &amp;tr[i].c);\n  }\n  //sort_by_area(tr, n);\n  for (int i = 0; i &lt; n; i++) {\n    printf(\"%d %d %d\\n\", tr[i].a, tr[i].b, tr[i].c);\n  }\n  free(tr);\n  return 0;\n}\n</code></pre>\n\n<p><br />\nThe same code in C++ would look like (file a.cpp)<br/>\nCompile using: <code>g++ a.cpp -o a.o</code><br/>\nRun using    : ./a.o\n<br/></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nstruct triangle {\n  int a;\n  int b;\n  int c;\n};\n\nint main() {\n  int n;\n  cin &gt;&gt; n;\n  triangle *tr = new triangle[n];\n  for (int i = 0; i &lt; n; i++) {\n    cin &gt;&gt; tr[i].a &gt;&gt; tr[i].b &gt;&gt; tr[i].c;\n  }\n  // sort_by_area(tr, n);\n  for (int i = 0; i &lt; n; i++) {\n    cout &lt;&lt; tr[i].a &lt;&lt; \" \" &lt;&lt; tr[i].b &lt;&lt; \" \" &lt;&lt; tr[i].c &lt;&lt; \"\\n\";\n  }\n  delete [] tr;\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 9136879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oroQ5.jpg?s=128&g=1", "display_name": "ibrahimG.", "link": "https://stackoverflow.com/users/9136879/ibrahimg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1741, "favorite_count": 1, "closed_date": 1539176868, "accepted_answer_id": 52739953, "answer_count": 4, "score": 3, "last_activity_date": 1539275816, "creation_date": 1539173195, "last_edit_date": 1539173665, "question_id": 52739894, "link": "https://stackoverflow.com/questions/52739894/invalid-conversion-void-to-struct", "closed_reason": "Duplicate", "title": "Invalid conversion &#39;void*&#39; to &#39;struct*&#39;", "body": "<p>I'm beginner in C. I'm trying to practice with solving some problems. And I'm getting this error when I compile my code. </p>\n\n<blockquote>\n  <p>[Error] invalid conversion from 'void*' to 'triangle*' [-fpermissive]</p>\n</blockquote>\n\n<p>The code and purpose is explained below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nstruct triangle\n{\n    int a;\n    int b;\n    int c;\n};\n\ntypedef struct triangle triangle;\n\n//sort_by_area() function is here\nint main()\n{\n    int n;\n    scanf(\"%d\", &amp;n);\n    triangle *tr = malloc(n * sizeof(triangle));\n    for (int i = 0; i &lt; n; i++) {\n        scanf(\"%d%d%d\", &amp;tr[i].a, &amp;tr[i].b, &amp;tr[i].c);\n    }\n    sort_by_area(tr, n);\n    for (int i = 0; i &lt; n; i++) {\n        printf(\"%d %d %d\\n\", tr[i].a, tr[i].b, tr[i].c);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>As you can see I have structure and I tried to allocate memory for it with the quantity of input. And try to use it for <code>sort_by_area</code> function. But the problem is <code>triangle *tr = malloc(n * sizeof(triangle));</code> line gives me the error mentioned above. </p>\n\n<p>Also this code is working for online compilers. I tried to run this code on <em>DEV C++</em> with default settings. I don't know about the versions and changing the versions of my compiler. I don't even know whether it is about the compiler version. But I am wondering why I'm getting this error. What is the logic behind.</p>\n"}, {"tags": ["c", "linux", "gdb", "shared-libraries"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1539174116, "post_id": 52739881, "comment_id": 92404870, "body": "I have reopened, as your question isn&#39;t about DLLs, but .so libs"}, {"owner": {"reputation": 477, "user_id": 2638191, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/HYhDR.jpg?s=128&g=1", "display_name": "Karthik Raj Palanichamy", "link": "https://stackoverflow.com/users/2638191/karthik-raj-palanichamy"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1539177440, "post_id": 52739881, "comment_id": 92407044, "body": "@Jean-Fran&#231;oisFabre Thanks for reopening. Does your earlier comment  about the behaviour still holds good? Why is that address mismatch?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1539177512, "post_id": 52739881, "comment_id": 92407085, "body": "I can talk about Windows and the damn DLLs, but probably different on Linux. that said, notice that there are 2 addresses: the theorical address and the actual load address, so maybe the problem is the same for linux. I cannot help more, except by voting on your question."}], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 2, "last_activity_date": 1539184838, "creation_date": 1539184838, "answer_id": 52743610, "question_id": 52739881, "link": "https://stackoverflow.com/questions/52739881/why-do-syslog-and-gdb-show-different-load-address-for-the-same-shared-library/52743610#52743610", "title": "Why do syslog and gdb show different load address for the same shared library?", "body": "<blockquote>\n  <p>So, libprotobuf-c.so is loaded at <code>0xf71f8000</code>. When I loaded the respective core file in gdb and tried info sharedlibrary, it shows FROM address as <code>0xf71f9f70</code> which is different from what syslog showed.</p>\n</blockquote>\n\n<p>Actually they <em>are</em> the same. GDB shows start of <code>.text</code> as the <code>From</code> address.</p>\n\n<p>If you do <code>readelf -WS /usr/lib/libprotobuf-c.so.0 | grep '\\.text'</code>, you'll discover that <code>.text</code> starts at <code>0xf71f9f70 - 0xf71f8000 == 0x1f70</code>.</p>\n"}], "owner": {"reputation": 477, "user_id": 2638191, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/HYhDR.jpg?s=128&g=1", "display_name": "Karthik Raj Palanichamy", "link": "https://stackoverflow.com/users/2638191/karthik-raj-palanichamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52743610, "answer_count": 1, "score": 5, "last_activity_date": 1539184838, "creation_date": 1539173167, "last_edit_date": 1539177181, "question_id": 52739881, "link": "https://stackoverflow.com/questions/52739881/why-do-syslog-and-gdb-show-different-load-address-for-the-same-shared-library", "title": "Why do syslog and gdb show different load address for the same shared library?", "body": "<p>I'm facing a segmentation fault. Syslog reports the following:</p>\n\n<pre><code>segfault at 0 ip 00000000f71ff256 sp 00000000f44fee50 error 4 in libprotobuf-c.so.0.0.0[f71f8000+f000]\n</code></pre>\n\n<p>So, libprotobuf-c.so is loaded at <code>0xf71f8000</code>. When I loaded the respective core file in gdb and tried <code>info sharedlibrary</code>, it shows <code>FROM</code> address as <code>0xf71f9f70</code> which is different from what syslog showed. I'm not able to understand this mismatch. Could someone please help? </p>\n\n<pre><code>0xf71f9f70  0xf7204028  Yes (*)     /usr/lib/libprotobuf-c.so.0\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1539171889, "post_id": 52739489, "comment_id": 92403429, "body": "No, it doesn&#39;t compile: <a href=\"https://ideone.com/nUfAEo\" rel=\"nofollow noreferrer\">ideone.com/nUfAEo</a>"}, {"owner": {"reputation": 143, "user_id": 10452136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6H4ZH.jpg?s=128&g=1", "display_name": "Sivaprakash B", "link": "https://stackoverflow.com/users/10452136/sivaprakash-b"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1539171951, "post_id": 52739489, "comment_id": 92403459, "body": "i compiled it and it works @UnholySheep"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1539171953, "post_id": 52739489, "comment_id": 92403460, "body": "<code>&quot;hai&quot;</code> returns a <code>const char*</code>, which can be casted to <code>int</code>. I would assume that it requires an explicit cast in c++ at least, though."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539171970, "post_id": 52739489, "comment_id": 92403478, "body": "Enable warnings and the compiler should complain."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1539171994, "post_id": 52739489, "comment_id": 92403496, "body": "It compiles in C, but not without warnings: <a href=\"https://godbolt.org/z/fIQzVv\" rel=\"nofollow noreferrer\">godbolt.org/z/fIQzVv</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539172018, "post_id": 52739489, "comment_id": 92403514, "body": "Also note that the behavior is most likely different in C and C++, because they are two very different languages. For future questions please don&#39;t mix language tags like that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539172038, "post_id": 52739489, "comment_id": 92403530, "body": "In C, for any other function than <code>main</code> the compiler would issue a warning like &quot;C4047: &#39;return&#39;: &#39;int&#39; differs in levels of indirection from &#39;char [4]&#39;&quot;. But <code>main</code> has different rules for its return."}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1539172096, "post_id": 52739489, "comment_id": 92403567, "body": "Please remove the c++ tag since it doesn&#39;t compile with c++ and you are using a c compiler."}, {"owner": {"reputation": 143, "user_id": 10452136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6H4ZH.jpg?s=128&g=1", "display_name": "Sivaprakash B", "link": "https://stackoverflow.com/users/10452136/sivaprakash-b"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1539172226, "post_id": 52739489, "comment_id": 92403649, "body": "@UnholySheep Yes you right, but i expected a error for difference in datatype that&#39;s y raised a question. anyways thanks for the response"}, {"owner": {"reputation": 143, "user_id": 10452136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6H4ZH.jpg?s=128&g=1", "display_name": "Sivaprakash B", "link": "https://stackoverflow.com/users/10452136/sivaprakash-b"}, "reply_to_user": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1539172262, "post_id": 52739489, "comment_id": 92403667, "body": "ok @ThomasSablik will do that"}, {"owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "edited": false, "score": 0, "creation_date": 1539172308, "post_id": 52739489, "comment_id": 92403695, "body": "Do it in a user defined function and it won&#39;t work. In main it is implied, it works even if you don&#39;t return 0;"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1539172429, "post_id": 52739489, "comment_id": 92403773, "body": "@Blaze: &quot;hai&quot; has type <code>char[4]</code> and converts to <code>char*</code> in the context of the <code>return</code> statement, with no <code>const</code>"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1539172496, "post_id": 52739489, "comment_id": 92403810, "body": "Thanks for the correction. I keep forgetting about that."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1539172928, "post_id": 52739489, "comment_id": 92404065, "body": "@aschleper : it&#39;s not (necessarily) valid in C. Converting a pointer to an integer type has implementation defined behavior. It might even have undefined behavior (if the result of the conversion cannot be represented in the integer type)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1539173113, "post_id": 52739489, "comment_id": 92404166, "body": "This is not valid C at all. There is no implicit cast from <code>char *</code> to <code>int</code>. It is a constraints violation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539177496, "post_id": 52739489, "comment_id": 92407078, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52186834/pointer-from-integer-integer-from-pointer-without-a-cast-issues\">\u201cPointer from integer/integer from pointer without a cast\u201d issues</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1539177572, "post_id": 52739489, "comment_id": 92407124, "body": "And if you want to block invalid C code from compiling in gcc, you must compile with <code>-pedantic-errors</code>."}, {"owner": {"reputation": 143, "user_id": 10452136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6H4ZH.jpg?s=128&g=1", "display_name": "Sivaprakash B", "link": "https://stackoverflow.com/users/10452136/sivaprakash-b"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539177996, "post_id": 52739489, "comment_id": 92407378, "body": "Thanks for the information @Lundin"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1539207642, "post_id": 52739489, "comment_id": 92422731, "body": "@AnttiHaapala Ah, I see. Deleting my comment that this is valid C.  (I was thrown off by the fact that Standard section 6.3 &quot;Conversions&quot; doesn&#39;t mention many differences between explicit and implicit conversions. Instead, the restrictions on implicit conversions are listed in 6.5.16.1 about the <code>=</code> operator, and other implicit conversions like for parameters of a function with prototype and for return values are done &quot;as if by assignment&quot;.)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1539232227, "post_id": 52739489, "comment_id": 92428346, "body": "@aschepler exactly"}], "answers": [{"comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 4, "creation_date": 1539172203, "post_id": 52739563, "comment_id": 92403629, "body": "C++ does allow implicit conversions. Just not this particular one."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1539172604, "post_id": 52739563, "comment_id": 92403884, "body": "@aschepler I think this question is only C. Beginners tend to put both languages in the tags"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1539172829, "post_id": 52739563, "comment_id": 92404015, "body": "If answering for C++, I would add that C++ would accept this if the cast is explicit (i.e. <code>return (long)&quot;hai&quot;;</code>)"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539172839, "post_id": 52739563, "comment_id": 92404020, "body": "@P__J__ &quot;I think this question is only C.&quot; =&gt; So why did you answer for C++ ?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539173246, "post_id": 52739563, "comment_id": 92404266, "body": "@Stargateur because there is a <code>C++</code> tag there. Logical I think"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1539177799, "post_id": 52739563, "comment_id": 92407261, "body": "Neither C nor C++ allow implicit conversions from <code>char*</code> to <code>int</code>. This code has never been valid in either language. Therefore this answer is misleading. &quot;It compiles&quot; is not a term enforced by the languages, they only enforce diagnostic messages. If you wish to prevent non-standard-C from compiling with gcc, you must use <code>-pedantic-errors</code>. Which doesn&#39;t mean &quot;give me pedantic errors&quot; but rather &quot;give me an error if I write invalid C code&quot;."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539191172, "post_id": 52739563, "comment_id": 92415486, "body": "@Lundin did I write that it is a valid code? If no your long elaborate is completely useless. BTW converions from pointers to integer types are common in the uC programming, and the code is valid of cohrse5"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539245786, "post_id": 52739563, "comment_id": 92433865, "body": "My point is that C and C++ behave exactly identically here, so there is no need to make a distinction between the languages. The only difference is with the default settings of the gcc compiler + the gcc wannabe compilers (clang, icc), all of them producing a warning instead of an error. Wheras other C compilers, as well as C++ compilers, produce an error when they find this constraint violation of the simple assignment rule. This is no fault of the C language."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 3, "last_activity_date": 1539172294, "last_edit_date": 1592644375, "creation_date": 1539172078, "answer_id": 52739563, "question_id": 52739489, "link": "https://stackoverflow.com/questions/52739489/why-main-runs-with-return-type-string-even-though-it-is-defined-with-a-integer-r/52739563#52739563", "title": "Why main runs with return type string even though it is defined with a integer return type?", "body": "<h1>C</h1>\n<p>You do not return the string or pointer, only the pointer casted to integer. And Compiler will warn you that you have converted the pointer without the explicit cast.</p>\n<h1>C++</h1>\n<p>this code will not compile as C++ does not allow this kind of implicit casts.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 7, "last_activity_date": 1539173031, "creation_date": 1539173031, "answer_id": 52739847, "question_id": 52739489, "link": "https://stackoverflow.com/questions/52739489/why-main-runs-with-return-type-string-even-though-it-is-defined-with-a-integer-r/52739847#52739847", "title": "Why main runs with return type string even though it is defined with a integer return type?", "body": "<p>The program is an <strong>invalid</strong> C program. <code>\"hai\"</code> has type <code>char [4]</code> and in the context of return statement it decays to <code>char *</code>. </p>\n\n<p>However the function needs to return <code>int</code>. In the context of <code>return</code> this happens if by assignment.</p>\n\n<p>A <code>char *</code> can be converted to <code>int</code> but it requires an explicit cast. In absence of an explicit cast, it is a constraint violation and a compiler <strong>must</strong> produce a diagnostics message, which <code>gcc</code> does:</p>\n\n<pre><code>warning: return makes integer from pointer without a cast [-Wint-conversion]\n    return \"hai\";\n           ^~~~~\n</code></pre>\n\n<hr>\n\n<p>Finally: the C standard mentions in a <a href=\"http://port70.net/~nsz/c/c11/n1570.html#note9\" rel=\"noreferrer\">footnote</a>:</p>\n\n<blockquote>\n  <p>[a conforming implementation] may also successfully translate an invalid program.</p>\n</blockquote>\n"}], "owner": {"reputation": 143, "user_id": 10452136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6H4ZH.jpg?s=128&g=1", "display_name": "Sivaprakash B", "link": "https://stackoverflow.com/users/10452136/sivaprakash-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 52739563, "answer_count": 2, "score": 1, "last_activity_date": 1539178211, "creation_date": 1539171798, "last_edit_date": 1539172279, "question_id": 52739489, "link": "https://stackoverflow.com/questions/52739489/why-main-runs-with-return-type-string-even-though-it-is-defined-with-a-integer-r", "title": "Why main runs with return type string even though it is defined with a integer return type?", "body": "<p>The code is compiling evan though the main has a return type of <strong>int</strong> it works with the return type string without and errors what is the reason behind it. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i=0;\n    printf(\"Hello World\");\n    //if(i!=0)\n       return \"hai\";\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "stdin", "file-descriptor"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539171711, "post_id": 52739376, "comment_id": 92403334, "body": "Have you looked at <code>freopen()</code>?"}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539171920, "post_id": 52739376, "comment_id": 92403449, "body": "Can&#39;t use dat... tbh I don&#39;t even care about reopening it I just want to reset the file descriptor to the beginning of the stream but can&#39;t use any function other than <code>open</code>, <code>close</code>, <code>read</code> &amp; <code>write</code> :/"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1539172151, "post_id": 52739376, "comment_id": 92403599, "body": "<code>close(0); open(something);</code> but it&#39;s unclear what you just said, once something is read in stdin, this is gone for (;ever;), if you want to be able to get it again you must save it somewhere."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539172184, "post_id": 52739376, "comment_id": 92403616, "body": "Then <code>close(0);</code> to close it, and <code>open(pathname, O_RDONLY);</code>. The file descriptor returned by <code>open()</code> is the lowest not already open.  Since zero was closed, open returns zero.  But this won\u2019t work well if the input was a pipe or socket or FIFO, and may not work with character special devices.  You need a good name for the file to be (re)opened."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539172198, "post_id": 52739376, "comment_id": 92403625, "body": "@Stargateur \u221a Got it that&#39;s all i wanted to make sure of."}, {"owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539172295, "post_id": 52739376, "comment_id": 92403687, "body": "@JonathanLeffler... I want to use stdin&#39;s bytes multiple times not some other file descriptors bytes."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539172522, "post_id": 52739376, "comment_id": 92403829, "body": "There\u2019s no guarantee that you can reread the bytes unless the standard input is from a regular file (and even then the guarantee is limited; other programs could also modify the file).  Almost all other file types are subject to giving different results.  I\u2019m getting the impression there\u2019s an XY problem here. What are you really trying to do, and why are there restrictions on what system calls you can use?"}], "owner": {"reputation": 429, "user_id": 9302544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiWhL.jpg?s=128&g=1", "display_name": "AymenTM", "link": "https://stackoverflow.com/users/9302544/aymentm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539173301, "creation_date": 1539171470, "last_edit_date": 1539172142, "question_id": 52739376, "link": "https://stackoverflow.com/questions/52739376/c-how-to-reopen-the-standard-in-file-descriptor-after-having-closed-it", "title": "C: How to reopen the &#39;Standard-In&#39; file descriptor, after having closed it?", "body": "<p>Is there any way of reopening or repositioning the <strong>standard input</strong> file descriptor at the beginning of the stream, with only the use of the following functions: <code>open</code>, <code>close</code>, <code>read</code>, <code>write</code> ?</p>\n"}, {"tags": ["c", "gcc", "warnings", "compiler-warnings"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1539171638, "post_id": 52739253, "comment_id": 92403284, "body": "&quot;If I understand correctly, this should throw a Wreturn-type warning,...&quot; No, it should not. With C99 this is optional. Your expectation is not correct."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539172203, "post_id": 52739253, "comment_id": 92403630, "body": "As can be <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Standards.html#Standards\" rel=\"nofollow noreferrer\">seen on the gcc documentation</a>: &quot;The default, if no C language dialect options are given, is <code>-std=gnu11</code>.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 6, "last_activity_date": 1539172371, "last_edit_date": 1539172371, "creation_date": 1539171303, "answer_id": 52739325, "question_id": 52739253, "link": "https://stackoverflow.com/questions/52739253/gcc-not-warning-although-it-should/52739325#52739325", "title": "GCC not warning although it should", "body": "<p>Use</p>\n\n<pre><code>gcc -std=c89 -pedantic ...\n</code></pre>\n\n<p>because in C99 <a href=\"https://port70.net/~nsz/c/c99/n1256.html#5.1.2.2.3\" rel=\"nofollow noreferrer\">1</a> <code>main()</code> does not need a <code>return 0;</code>. It's as if there was one right before the closing brace.</p>\n"}], "owner": {"reputation": 85, "user_id": 10483836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acfffdc92d5f9dee35918ecd5cbff1b9?s=128&d=identicon&r=PG&f=1", "display_name": "Hex", "link": "https://stackoverflow.com/users/10483836/hex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 52739325, "answer_count": 1, "score": 2, "last_activity_date": 1539172371, "creation_date": 1539171040, "question_id": 52739253, "link": "https://stackoverflow.com/questions/52739253/gcc-not-warning-although-it-should", "title": "GCC not warning although it should", "body": "<p>I have a very simple Hello World program, that doesn't have a return at the end of its main() function. If I understand correctly, this should throw a Wreturn-type warning, but when I compile it, no output at all is given. It simply compiles it and is done.</p>\n\n<p>program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n  printf(\"Hello World!\\n\");\n}\n</code></pre>\n\n<p>compilation commmand:</p>\n\n<pre><code>gcc -Wall -Wextra -o hello.o hello.c\n</code></pre>\n\n<p>I also tried specifically with the <code>Wreturn-type</code> option.</p>\n\n<p>On Manjaro 18.0.0 with GCC 8.2.1</p>\n"}, {"tags": ["c", "linux", "timer", "signals", "interrupt"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1539170323, "post_id": 52738878, "comment_id": 92402547, "body": "What does <i>&quot;pseudo code that explains on timer and software interrupts&quot;</i> mean?"}, {"owner": {"reputation": 13, "user_id": 4840854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bac4fb854d9b27f6fb22be9f7cbb08?s=128&d=identicon&r=PG", "display_name": "user3654", "link": "https://stackoverflow.com/users/4840854/user3654"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1539171853, "post_id": 52738878, "comment_id": 92403410, "body": "Not Pseudo may be a sample code might help"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1539173192, "creation_date": 1539173192, "answer_id": 52739892, "question_id": 52738878, "link": "https://stackoverflow.com/questions/52738878/timer-interrupt-in-linux-c/52739892#52739892", "title": "Timer Interrupt in Linux C", "body": "<p>IMO the timer callback (which can be considered as timer interrupt :) ) can be only done if you start a new thread, which will call your callback functions when the time condition(s) is (are) met.  </p>\n"}], "owner": {"reputation": 13, "user_id": 4840854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bac4fb854d9b27f6fb22be9f7cbb08?s=128&d=identicon&r=PG", "display_name": "user3654", "link": "https://stackoverflow.com/users/4840854/user3654"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539173192, "creation_date": 1539169764, "last_edit_date": 1539171827, "question_id": 52738878, "link": "https://stackoverflow.com/questions/52738878/timer-interrupt-in-linux-c", "title": "Timer Interrupt in Linux C", "body": "<p>Am working on a LTE host testing application where I have call a function A at first ofdma symbol and another function B on 7th OFDMA symbol where a frame will have 14 ofdma symbols. Let me take care care of the timing later. But how to implement this C with Linux.</p>\n\n<p>Is there any sample code that explains on timer and software interrupts. I have 2 separate binaries running where once will give me the time. Let say a frame tick is 1 second. This one second will be divided into 14 and function A and B will be called 1st and 7st part of a second.</p>\n\n<p>Considering linux interrupt or timer or signals, Suggest me which will be efficient in this case. Any info on how to implement this.</p>\n"}, {"tags": ["c", "linux-kernel", "filesystems", "kernel-module"], "comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1539170886, "post_id": 52738838, "comment_id": 92402848, "body": "My understanding is that /proc/pid is entirely virtual. It doesn&#39;t actually exist physically, and is only accessible while the pid is live?"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1539173079, "post_id": 52738838, "comment_id": 92404152, "body": "You&#39;d probably still need to write a kernel module, but you don&#39;t have to recompile the kernel, no. Creating a &quot;file&quot; in /proc: <a href=\"https://linux.die.net/lkmpg/x769.html\" rel=\"nofollow noreferrer\">linux.die.net/lkmpg/x769.html</a>"}, {"owner": {"reputation": 31, "user_id": 10243568, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PccCBTvAIP4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNqWXakx9tTG08Zt3yqV0eBQ75gQg/mo/photo.jpg?sz=128", "display_name": "mrlin", "link": "https://stackoverflow.com/users/10243568/mrlin"}, "reply_to_user": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 0, "creation_date": 1539173974, "post_id": 52738838, "comment_id": 92404764, "body": "@Cinder Biscuits I know how to write in /proc but not how to write in /proc/pid"}, {"owner": {"reputation": 31, "user_id": 10243568, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PccCBTvAIP4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNqWXakx9tTG08Zt3yqV0eBQ75gQg/mo/photo.jpg?sz=128", "display_name": "mrlin", "link": "https://stackoverflow.com/users/10243568/mrlin"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1539174912, "post_id": 52738838, "comment_id": 92405354, "body": "@Gem Taylor yes it is true, this why I think the solution is to dynamically add an entry to tgid_base_stuff in fs/proc/base.c, but I don t know how"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "edited": false, "score": 1, "creation_date": 1539177701, "post_id": 52738838, "comment_id": 92407215, "body": "You&#39;d have to modify the kernel. The only way I can think to do it is to create your own /proc/pidplus tree or whatever."}, {"owner": {"reputation": 196, "user_id": 10470034, "user_type": "registered", "profile_image": "https://graph.facebook.com/1830738737045746/picture?type=large", "display_name": "Nikita Yushchenko", "link": "https://stackoverflow.com/users/10470034/nikita-yushchenko"}, "edited": false, "score": 0, "creation_date": 1539204333, "post_id": 52738838, "comment_id": 92421516, "body": "Adding stuff under /proc/pid is not a good idea...  E.g. how are you going to handle unexpected termination of process - when /proc/pid gets removed?  If you really need per-pid objects on procfs then better to create those under your own hierarchy, i.e. /proc/yourmodule/pid"}], "owner": {"reputation": 31, "user_id": 10243568, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PccCBTvAIP4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNqWXakx9tTG08Zt3yqV0eBQ75gQg/mo/photo.jpg?sz=128", "display_name": "mrlin", "link": "https://stackoverflow.com/users/10243568/mrlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1539169997, "creation_date": 1539169628, "last_edit_date": 1539169997, "question_id": 52738838, "link": "https://stackoverflow.com/questions/52738838/how-to-create-a-folder-inside-proc-pid", "title": "How to create a folder inside proc/pid", "body": "<p>I am writing a character device with a Linux Kernel Module and the kernel version is : 4.14.\nBasically, a user space process with a given tgid can interact with my device through ioctl.</p>\n\n<p>I need to make a new directory inside /proc/pid (where pid is the tgid of the processes that have interacted with my device) so that I can create inside this new directory some files with some logs.</p>\n\n<p>Is it possible to create a new directory inside /proc/pid without re-compiling the linux kernel?</p>\n\n<p>In particular, I have tried to use :</p>\n\n<pre><code>struct proc_dir_entry *proc_create(\nconst char *name, umode_t mode,\nstruct proc_dir_entry *parent,\nconst struct file_operations *proc_fops)\n</code></pre>\n\n<p>but I am not able to get the <code>struct proc_dir_entry *</code> of the pid folder I want to write in because I am not able to include <code>fs/proc/internal.h</code> where PDE is defined.  </p>\n\n<p>This is what I have tried to do :</p>\n\n<pre><code>struct file *fp = filp_open(\"/proc/1\",....);\nstruct proc_dir_entry *parent ;\nparent = PDE(fp-&gt;f_dentry-&gt;d_inode);\n</code></pre>\n\n<p>Any solution ?</p>\n"}, {"tags": ["c", "memory-management"], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 5, "last_activity_date": 1539169548, "creation_date": 1539169548, "answer_id": 52738806, "question_id": 52738688, "link": "https://stackoverflow.com/questions/52738688/significance-of-bss-section/52738806#52738806", "title": "Significance of .bss section", "body": "<p>.bss section accommodates the unitialized static storage objects. It is zeroed by the startup code (before the <code>main</code> is called).</p>\n\n<p>Existence of the .bss section is of course up to implementation and the placement of the explicit zero initialized object is also implementation defined. There is no rule defined by the C standard.</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1539170586, "creation_date": 1539170586, "answer_id": 52739113, "question_id": 52738688, "link": "https://stackoverflow.com/questions/52738688/significance-of-bss-section/52739113#52739113", "title": "Significance of .bss section", "body": "<p>Unlike a data section, a BSS section requires no storage in the object file - it's an optimisation.</p>\n"}], "owner": {"reputation": 19, "user_id": 9554206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nikhil Dhende", "link": "https://stackoverflow.com/users/9554206/nikhil-dhende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1539170878, "answer_count": 2, "score": 0, "last_activity_date": 1539170586, "creation_date": 1539169079, "question_id": 52738688, "link": "https://stackoverflow.com/questions/52738688/significance-of-bss-section", "closed_reason": "Duplicate", "title": "Significance of .bss section", "body": "<p>What is the significance of .bss section as we have already separate data section. What advantage it gives over data section ?\nIs in .bss section all variables will be initialized to zero ? \nIf I declare variable like this - \nint a = 0;\nSo this variable will go in which section ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1539167760, "post_id": 52738218, "comment_id": 92401031, "body": "AFAIK there is no portable way to obtain weak references. Most implementations I&#39;ve seen, uses the assembler + the linker to achieve this: <a href=\"https://stackoverflow.com/questions/19765335/assembler-weak-directive-does-only-work-with-cross-compile-gcc\" title=\"assembler weak directive does only work with cross compile gcc\">stackoverflow.com/questions/19765335/&hellip;</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1539168966, "post_id": 52738218, "comment_id": 92401733, "body": "@AlexF: The question is not whether the code shown in the question contains a weak linkage as usually implemented by compiler extensions and/or linkers. The question is whether the code in the question serves, by way of relying on default initialization of a pointer with external linkage, as a method of implement its own weak linkage."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1539169045, "post_id": 52738218, "comment_id": 92401780, "body": "Yes. In &quot;runtime&quot; (may be optimized) and prior to main function. From <a href=\"https://en.wikipedia.org/wiki/Weak_symbol#Use_cases\" rel=\"nofollow noreferrer\">wiki</a>: <code>Weak symbols can be used as a mechanism to provide default implementations of functions that can be replaced by more specialized (e.g. optimized) ones at link-time.</code>. I want the same functionality, but without using the weak attribute."}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1539176282, "post_id": 52738609, "comment_id": 92406275, "body": "It&#39;s a well-established convention of traditional unix linking rules, not something allowed by C."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1539257275, "post_id": 52738609, "comment_id": 92440914, "body": "@R..: It is just convention and tradition, or is there documentation?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1539262746, "post_id": 52738609, "comment_id": 92444337, "body": "I&#39;m pretty sure it&#39;s documented in the ELF/SYSV gABI documents. It&#39;s clearly the motivation for why commons exist in object files as opposed to just getting converted to bss at assembly time."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1539257363, "last_edit_date": 1539257363, "creation_date": 1539168865, "answer_id": 52738609, "question_id": 52738218, "link": "https://stackoverflow.com/questions/52738218/is-implementing-weak-linkage-using-variable-declaration-definition-portable/52738609#52738609", "title": "Is implementing weak linkage using variable declaration/definition portable?", "body": "<p>In <code>lib.c</code>, <code>void (* const lib_callback_pnt)(int);</code> is a declaration of an identifier for an object (in this case, a pointer) that has file scope without an initializer and without a storage-class specifier. Then C 2018 6.9.2 2 tells us:</p>\n\n<blockquote>\n  <p>A declaration of an identifier for an object that has file scope without an initializer, and without a storage-class specifier or with the storage-class specifier <strong>static</strong>, constitutes a <em>tentative definition</em>. If a translation unit contains one or more tentative definitions for an identifier, and the translation unit contains no external definition for that identifier, then the behavior is exactly as if the translation unit contains a file scope declaration of that identifier, with the composite type as of the end of the translation unit, with an initializer equal to 0.</p>\n</blockquote>\n\n<p>This tells us that in standard C, <code>lib_callback_pnt</code> is initialized to zero even if it is defined in a different translation unit. And the fact that it behaves as if it had an initializer means it is defined in <code>lib.c</code>.</p>\n\n<p>Furthermore, when <code>lib_callback_pnt</code> is defined in <code>main2.c</code>, this violates C 2018 6.9 5:</p>\n\n<blockquote>\n  <p>If an identifier declared with external linkage is used in an expression (other than as part of the operand of a <strong>sizeof</strong> or <strong>_Alignof</strong> operator whose result is an integer constant), somewhere in the entire program there shall be exactly one external definition for the identifier; otherwise, there shall be no more than one.</p>\n</blockquote>\n\n<h1>Note</h1>\n\n<p>There is some tradition in Unix of permitting the declaration of <code>int foo;</code> in one translation unit and <code>int foo = 1;</code> in another. Technically, this violates the C standard, but it may be commonly available in compilers and linkers.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1539170625, "post_id": 52739040, "comment_id": 92402692, "body": "Notably, declaring a file scope variable without <code>static</code>, but with internal linkage, is an obsolete language feature (C17 6.11.2). This feature may be removed from the C language and we shouldn&#39;t write code like that."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1539170991, "post_id": 52739040, "comment_id": 92402910, "body": "@Lundin <code>lib_callback_pnt</code> has external linkage. C does not have the C++ rule that &quot;<code>const</code> implies <code>static</code>&quot;, and the first declaration is actually marked <code>extern</code> via lib.h in each translation unit."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1539172753, "post_id": 52739040, "comment_id": 92403968, "body": "It may not apply in this case, just saying that it is good practice to use either <code>static</code> or <code>extern</code>. (Although using <code>extern</code> is in itself often bad practice because it leads to spaghetti coding with globals.)"}], "tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 2, "last_activity_date": 1539170321, "creation_date": 1539170321, "answer_id": 52739040, "question_id": 52738218, "link": "https://stackoverflow.com/questions/52738218/is-implementing-weak-linkage-using-variable-declaration-definition-portable/52739040#52739040", "title": "Is implementing weak linkage using variable declaration/definition portable?", "body": "<p>Your lib.c actually does define <code>lib_callback_pnt</code>.  C11 says at <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.9.2p2\" rel=\"nofollow noreferrer\">6.9.2p2</a>:</p>\n\n<blockquote>\n  <p>A declaration of an identifier for an object that has file scope without an initializer, and without a storage-class specifier or with the storage-class specifier <code>static</code>, constitutes a <em>tentative definition</em>. If a translation unit contains one or more tentative definitions for an identifier, and the translation unit contains no external definition for that identifier, then the behavior is exactly as if the translation unit contains a file scope declaration of that identifier, with the composite type as of the end of the translation unit, with an initializer equal to 0.</p>\n</blockquote>\n\n<p>So the declaration of <code>lib_callback_pnt</code> in lib.c is a tentative definition. Since that translation unit doesn't contain any other declaration of <code>lib_callback_pnt</code> that explicitly defines it, the behavior should be the same as a true definition that initializes it with \"<code>= 0</code>\".</p>\n\n<p>Apparently gcc with ELF output doesn't follow this requirement exactly by default.<br>\n On my Linux system, if I <code>gcc -c lib.c; nm lib.o | grep lib_callback_pnt</code>, I get:</p>\n\n<pre><code>0000000000000008 C lib_callback_pnt\n</code></pre>\n\n<p>And my <code>man nm</code> documentation explains \"C\" means a \"common symbol\":</p>\n\n<blockquote>\n  <p>\"C\" The symbol is common.  Common symbols are uninitialized data.  When linking, multiple common symbols may appear with the same name.  If the symbol is defined anywhere, the common symbols are treated as undefined references.</p>\n</blockquote>\n\n<p>So your method does work with gcc/ELF, but it's incorrect according to the C Standard, so you can't count on it to work with other compilers.</p>\n"}], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 1, "accepted_answer_id": 52738609, "answer_count": 2, "score": 2, "last_activity_date": 1539257363, "creation_date": 1539167594, "last_edit_date": 1539248707, "question_id": 52738218, "link": "https://stackoverflow.com/questions/52738218/is-implementing-weak-linkage-using-variable-declaration-definition-portable", "title": "Is implementing weak linkage using variable declaration/definition portable?", "body": "<p>I recently learned that:</p>\n\n<pre><code>int a;\n</code></pre>\n\n<p>at file scope is a variable declaration and by default has external linkage.<br>\nSo I can use this to implement something like weak symbol/function linkage:</p>\n\n<pre><code>cat &gt;lib.c &lt;&lt;'EOF'\n#include \"lib.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n// This is declaration\n// It will be initialized to NULL in case no definition is found\nvoid (* const lib_callback_pnt)(int);\n\nvoid lib_callback_default(int a) \n{\n   printf(\"%s %d\\n\", __func__, a);\n}\n\nvoid lib_call(int a)\n{\n   printf(\"%s calling %p\\n\", __func__, \n    // this is not really portable\n    (void*)(uintptr_t)(intmax_t)lib_callback_pnt\n   );\n   // call callback\n   void (* const lib_callback_to_call)(int) = \n      lib_callback_pnt == NULL\n      ? lib_callback_default\n      : lib_callback_pnt;\n   lib_callback_to_call(a);\n}\n\nEOF\n</code></pre>\n\n<p></p>\n\n<pre><code>cat &gt;lib.h &lt;&lt;'EOF'\n#ifndef LIB_H_\n#define LIB_H_\n\nextern void (* const lib_callback_pnt)(int);\n\nvoid lib_callback_default(int a);\nvoid lib_call(int a);\n\n#endif\nEOF\n</code></pre>\n\n<p></p>\n\n<pre><code>cat &gt;main1.c &lt;&lt;EOF\n#include \"lib.h\"\n\nint main() {\n    lib_call(42);\n}\n\nEOF\n</code></pre>\n\n<p></p>\n\n<pre><code>cat &gt;main2.c &lt;&lt;'EOF'\n#include \"lib.h\"\n#include &lt;stdio.h&gt;\n\nstatic void my_lib_callback(int a)\n{\n    printf(\"Hah! Overwritten lib callback!\\n\");\n}\n\n// this is definition\nvoid (* const lib_callback_pnt)(int) = my_lib_callback;\n\nint main() {\n    lib_call(42);\n}\n\nEOF\n</code></pre>\n\n<p></p>\n\n<pre><code>cat &gt;Makefile &lt;&lt;'EOF'\nCC=gcc\nCFLAGS=-Wall -Wextra -pedantic -std=c11\nall:\n    $(CC) $(CFLAGS) lib.c main1.c -o main1\n    $(CC) $(CFLAGS) lib.c main2.c -o main2\nEOF\n</code></pre>\n\n<p></p>\n\n<p>Inside <code>lib.c</code> library I declare a function pointer <code>void (* const lib_callback_pnt)(int)</code>, which serves as a callback. The function pointer is not initialized in <code>lib.c</code> and will be default initialized to NULL (cause static storage duration).  </p>\n\n<p>Then I have two programs or user applications, that is  <code>main1.c</code> and <code>main2.c</code>.   </p>\n\n<p>The <code>main1.c</code> simply calls library function which calls the callback - the callback is nowhere initialized, so it is default initialized to NULL - I can compare that inside library and call the default callback / choose action appropriately.</p>\n\n<p>The <code>main2.c</code> however declares the function pointer <code>lib_callback_pnt</code> with initialization - it is a definition. There is a single definition of this variable in all source files, so the linker does not complain about multiple symbol definitions. When we call the library, the pointer is initialized, thus the user application <code>main2</code> has successfully overwritten the callback.</p>\n\n<p>We can compile:</p>\n\n<pre><code>$ make\ngcc -Wall -Wextra -pedantic -std=c11 lib.c main1.c -o main1\ngcc -Wall -Wextra -pedantic -std=c11 lib.c main2.c -o main2\n</code></pre>\n\n<p>And call:</p>\n\n<pre><code>$ ./main1 \nlib_call calling (nil)\nlib_callback_default 42\n$ ./main2 \nlib_call calling 0x5627c07871cf\nHah! overwritten lib callback!\n</code></pre>\n\n<p>Questions:</p>\n\n<ul>\n<li>Is this portable? Is this conforming to C standard?</li>\n<li>Are there any / Which libraries use such method to enable user application to pass user defined callbacks and/or parameters? Why isn't such method used that often?</li>\n</ul>\n"}, {"tags": ["c", "for-loop", "struct", "printf", "malloc"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1539166181, "post_id": 52737733, "comment_id": 92400087, "body": "<code>sizeof(blocks)</code> is the size of a <i>pointer</i>. You <i>sure</i> that&#39;s what you wanted? Doesn&#39;t look like it. Try <code>blocks=malloc(n_block * sizeof *blocks);</code> ?"}, {"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 0, "creation_date": 1539166304, "post_id": 52737733, "comment_id": 92400165, "body": "<code>sizeof(struct block)</code> and <code>count &lt; n_block</code>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539166392, "post_id": 52737733, "comment_id": 92400237, "body": "not a problem, but <code>for(int count=0;count&lt;=n_block-1;count++)</code> is usually written as <code>for (int count = 0; count &lt; n_block; count++)</code>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539166753, "post_id": 52737733, "comment_id": 92400464, "body": "<a href=\"https://ideone.com/IhEjoK\" rel=\"nofollow noreferrer\">Your code as is</a> gives some strange output. <a href=\"https://ideone.com/jn06Xn\" rel=\"nofollow noreferrer\">A version with the correct <code>sizeof</code></a> gives the expected output."}, {"owner": {"reputation": 53, "user_id": 10445266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VLWMIAM17kA/AAAAAAAAAAI/AAAAAAAAABk/0o8RN4GwWnE/photo.jpg?sz=128", "display_name": "federico rovere", "link": "https://stackoverflow.com/users/10445266/federico-rovere"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539167403, "post_id": 52737733, "comment_id": 92400824, "body": "@pmg yes, i think that the problem was on the sizeof(block) as suggested in the answer by u_"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10445266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VLWMIAM17kA/AAAAAAAAAAI/AAAAAAAAABk/0o8RN4GwWnE/photo.jpg?sz=128", "display_name": "federico rovere", "link": "https://stackoverflow.com/users/10445266/federico-rovere"}, "edited": false, "score": 0, "creation_date": 1539167070, "post_id": 52737916, "comment_id": 92400632, "body": "Ok, now it works. Why  sizeof(blocks) != sizeof(struct block) ?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1539167972, "post_id": 52737916, "comment_id": 92401165, "body": "<code>sizeof *blocks</code> would maybe be better, in case the type of <code>blocks</code> changes."}], "tags": [], "owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "is_accepted": true, "score": 1, "last_activity_date": 1539166610, "creation_date": 1539166610, "answer_id": 52737916, "question_id": 52737733, "link": "https://stackoverflow.com/questions/52737733/unexpected-result-in-c-program-using-malloc-and-for-loop/52737916#52737916", "title": "Unexpected result in C program, using Malloc and for loop", "body": "<p>In case of <code>malloc</code> the statement <code>sizeof(blocks)</code> will evaluates to size of a pointer and in your case <code>sizeof(blocks) != sizeof(struct block)</code></p>\n\n<p>change the <code>malloc</code> to  </p>\n\n<pre><code> blocks = malloc(n_block * (sizeof( struct block) ) ); // more readable\n</code></pre>\n\n<p><code>for loop</code> is over complicated one here, stick to basics</p>\n\n<pre><code>for(int count=0; count &lt; n_block; count++ )\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10445266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VLWMIAM17kA/AAAAAAAAAAI/AAAAAAAAABk/0o8RN4GwWnE/photo.jpg?sz=128", "display_name": "federico rovere", "link": "https://stackoverflow.com/users/10445266/federico-rovere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 52737916, "answer_count": 1, "score": 0, "last_activity_date": 1539166652, "creation_date": 1539166100, "last_edit_date": 1539166652, "question_id": 52737733, "link": "https://stackoverflow.com/questions/52737733/unexpected-result-in-c-program-using-malloc-and-for-loop", "title": "Unexpected result in C program, using Malloc and for loop", "body": "<p>i have a trouble with my code in C:</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n\n\nint main()\n{\n    int i1,j1,k1;\n    int n_block;\n    struct  block\n    {\n        int i,j,k;\n    } *blocks;\n    n_block=3;\n    i1=4;\n    k1=3;\n    j1=2;\n    blocks=malloc(n_block*sizeof(blocks));\n    for(int count=0;count&lt;=n_block-1;count++){\n        printf(\"count %d\\n\",count);\n        blocks[count].i=i1;\n        blocks[count].j=j1;\n        blocks[count].k=k1;\n        printf(\"results:%d\\n\",blocks[count].i);\n        printf(\"results:%d\\n\",blocks[count].j);\n        printf(\"results:%d\\n\",blocks[count].k);\n    }\n}\n</code></pre>\n\n<p>the expected output is:</p>\n\n<pre><code>count 0\nresults:4\nresults:2\nresults:3\ncount 1\nresults:4\nresults:2\nresults:3\ncount 2\nresults:4\nresults:2\nresults:3\n</code></pre>\n\n<p>but I obtain:</p>\n\n<pre><code>count 0\nresults:4\nresults:2\nresults:3\ncount 1\nresults:4\nresults:2\nresults:3\ncount 2\nresults:4\nresults:2\nresults:1970496882\n</code></pre>\n\n<p>I suppose that the last result is the value of the pointer, but why do it happen?</p>\n\n<p>I tried to modify the for loop (without modify the n_block):</p>\n\n<pre><code>for(int count=0;count&lt;=n_block+1;count++)\n</code></pre>\n\n<p>and I obtain:</p>\n\n<pre><code>count 0\nresults:4\nresults:2\nresults:3\ncount 1\nresults:4\nresults:2\nresults:3\ncount 2\nresults:4\nresults:2\nresults:1970496882\ncount 3\nresults:4\nresults:2612\nresults:10\ncount 4\nresults:4\nresults:2\nresults:3\n</code></pre>\n\n<p>so, the question is, why does it happen?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "data-structures", "tree", "avl-tree"], "comments": [{"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1539168095, "post_id": 52737600, "comment_id": 92401238, "body": "You can always &quot;emulate&quot; recursion using an explicit stack."}, {"owner": {"reputation": 5, "user_id": 10061925, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GccxT_0Sihg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o2Mh8Hu_yMl8u_en6Etj-vper5Jg/mo/photo.jpg?sz=128", "display_name": "Jong-joon Lee", "link": "https://stackoverflow.com/users/10061925/jong-joon-lee"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1539168662, "post_id": 52737600, "comment_id": 92401556, "body": "How can i do using stack?"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1539168928, "post_id": 52737600, "comment_id": 92401711, "body": "Lots of related tutorials around, e.g. <a href=\"https://www.codeproject.com/Articles/418776/How-to-replace-recursive-functions-using-stack-and\" rel=\"nofollow noreferrer\">this</a>. Google + have a go at doing it yourself."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1539183832, "post_id": 52737600, "comment_id": 92411093, "body": "avl_node should have a field that keeps track of the height, which you update during insert/delete operations."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1539186033, "post_id": 52737600, "comment_id": 92412516, "body": "@MattTimmermans it depends on the implementation; <a href=\"http://interactivepython.org/runestone/static/pythonds/Trees/AVLTreeImplementation.html\" rel=\"nofollow noreferrer\">some</a> only have a balance factor."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1539189033, "post_id": 52737600, "comment_id": 92414266, "body": "@meowgoesthedog that&#39;s true, but if you&#39;re going to be calling get_height a lot then you should store the height instead.  If you cant modify the node, but you have a balance factor, then you can do get_height in O(log N) without recursion while traversing down to the left-most node"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1539189647, "post_id": 52737600, "comment_id": 92414650, "body": "@MattTimmermans I agree; however we don&#39;t know whether OP is allowed to modify the implementation (it could be for a homework assignment based on a provided / pre-existing library)."}], "owner": {"reputation": 5, "user_id": 10061925, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GccxT_0Sihg/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o2Mh8Hu_yMl8u_en6Etj-vper5Jg/mo/photo.jpg?sz=128", "display_name": "Jong-joon Lee", "link": "https://stackoverflow.com/users/10061925/jong-joon-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539166249, "creation_date": 1539165699, "last_edit_date": 1539166249, "question_id": 52737600, "link": "https://stackoverflow.com/questions/52737600/non-recursive-avl-tree-height", "title": "Non Recursive AVL Tree height", "body": "<pre><code>int get_height(struct avl_node *node)\n{\n    int height=0;\n    if( node != NULL )\n        height = 1 + max(get_height(node-&gt;left_child), \n                        get_height(node-&gt;right_child));\n    return height;\n}\n</code></pre>\n\n<p>I run AVL tree program in C. But at compile time generating 50 thousand random data that were different from each other in range of 1 to 50 thousand is too long. I find out that recursive form of function <code>get_height</code> is problem of too long compile time. I tired to make non-recursive form of <code>get_height</code> function to reduce compile time by using level traversal. But later I understand using level traversal is improper. is there correct non recursive form of <code>get_height</code>?</p>\n"}, {"tags": ["c", "r", "performance", "parallel-processing"], "comments": [{"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1539167436, "post_id": 52737371, "comment_id": 92400846, "body": "If you type <code>colMeans</code> (with no <code>()</code>) in the console, you&#39;ll see the R code for it. The actual work takes place in a couple of function calls which start <code>.Internal(colMeans</code>, which is a clear indication that a compiled C function which is built into the R interpreter is being invoked. Since R is open source, you could look up the code for that function if you want."}], "answers": [{"comments": [{"owner": {"reputation": 3752, "user_id": 4133063, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QC9Pv.jpg?s=128&g=1", "display_name": "D1X", "link": "https://stackoverflow.com/users/4133063/d1x"}, "edited": false, "score": 0, "creation_date": 1539171157, "post_id": 52737999, "comment_id": 92403016, "body": "Does it actually make sense to parallelize these?"}, {"owner": {"reputation": 4044, "user_id": 2974951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4596e20fc7b9882d10758f75da4d4b7c?s=128&d=identicon&r=PG&f=1", "display_name": "user2974951", "link": "https://stackoverflow.com/users/2974951/user2974951"}, "reply_to_user": {"reputation": 3752, "user_id": 4133063, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QC9Pv.jpg?s=128&g=1", "display_name": "D1X", "link": "https://stackoverflow.com/users/4133063/d1x"}, "edited": false, "score": 1, "creation_date": 1539172948, "post_id": 52737999, "comment_id": 92404080, "body": "@D1X Maybe, if your dimensions are too damn hiiiigh."}], "tags": [], "owner": {"reputation": 4044, "user_id": 2974951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4596e20fc7b9882d10758f75da4d4b7c?s=128&d=identicon&r=PG&f=1", "display_name": "user2974951", "link": "https://stackoverflow.com/users/2974951/user2974951"}, "is_accepted": true, "score": 6, "last_activity_date": 1539166858, "creation_date": 1539166858, "answer_id": 52737999, "question_id": 52737371, "link": "https://stackoverflow.com/questions/52737371/are-colmeans-colsums-in-r-also-parallelized/52737999#52737999", "title": "Are colMeans(), colSums()... in R also parallelized?", "body": "<p>Nothing is automatically parallelized in R, however these exact functions exist in the <code>Rfast</code> package with a parallel argument.</p>\n"}, {"comments": [{"owner": {"reputation": 4051, "user_id": 1072091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rdNf7.jpg?s=128&g=1", "display_name": "HenrikB", "link": "https://stackoverflow.com/users/1072091/henrikb"}, "edited": false, "score": 0, "creation_date": 1539822580, "post_id": 52749943, "comment_id": 92644794, "body": "Note that there is also <code>base::.colSums()</code> which comes with less overhead than <code>base::colSums()</code>."}, {"owner": {"reputation": 742, "user_id": 4729755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d003ad75c484a0762235ed776d5cc740?s=128&d=identicon&r=PG&f=1", "display_name": "Stefanos", "link": "https://stackoverflow.com/users/4729755/stefanos"}, "reply_to_user": {"reputation": 4051, "user_id": 1072091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rdNf7.jpg?s=128&g=1", "display_name": "HenrikB", "link": "https://stackoverflow.com/users/1072091/henrikb"}, "edited": false, "score": 4, "creation_date": 1540737305, "post_id": 52749943, "comment_id": 92965493, "body": "@HenrikB As you can see in the updated benchmarks, the overhead difference between base::.colSums() and base::colSums() is insignificant, comparing to how little time it takes for Rfast to compute the same results"}], "tags": [], "owner": {"reputation": 742, "user_id": 4729755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d003ad75c484a0762235ed776d5cc740?s=128&d=identicon&r=PG&f=1", "display_name": "Stefanos", "link": "https://stackoverflow.com/users/4729755/stefanos"}, "is_accepted": false, "score": 3, "last_activity_date": 1540737466, "last_edit_date": 1540737466, "creation_date": 1539212790, "answer_id": 52749943, "question_id": 52737371, "link": "https://stackoverflow.com/questions/52737371/are-colmeans-colsums-in-r-also-parallelized/52749943#52749943", "title": "Are colMeans(), colSums()... in R also parallelized?", "body": "<p>Even without parallelization the Rfast implementation is better.</p>\n\n<pre><code>x = matrix(rnorm(1000*100),ncol=100)\n\nmicrobenchmark::microbenchmark(.colSums(x,1000,100), colSums(x),Rfast::colsums(x,parallel=0),times=1000)\nUnit: microseconds\n                          expr     min      lq     mean  median      uq     max    neval\n         .colSums(x, 1000, 100) 124.870 125.725 127.28580 125.726 126.153 301.911  1000\n                     colSums(x) 132.567 133.423 136.30507 134.705 135.134 282.668  1000\nRfast::colsums(x, parallel = 0)  79.541  80.824  84.00742  81.252  82.107 307.470  1000\n</code></pre>\n\n<p>Bigger matrixes make parallelization relevant (benchmarks from 2 core laptop)</p>\n\n<pre><code>x = matrix(rnorm(1000*1000),ncol=1000)\n\nmicrobenchmark::microbenchmark(.colSums(x,1000,1000), colSums(x),Rfast::colsums(x,parallel=0),\n    Rfast::colsums(x,parallel=1),times=1000)\nUnit: microseconds\n                           expr      min       lq      mean    median        uq      max  neval\n        .colSums(x, 1000, 1000) 1313.268 1336.3600 1366.5152 1344.486 1355.1760 2468.310  1000\n                     colSums(x) 1350.473 1366.2950 1401.0574 1374.420 1386.8210 2826.241  1000\nRfast::colsums(x, parallel = 0)  755.205  769.7440  801.5617  779.152  796.6850 1796.068  1000\nRfast::colsums(x, parallel = 1)  604.249  637.8185  680.3327  651.289  674.1675 1808.042  1000\n\nx = matrix(rnorm(100000*100),ncol=100)\n\nmicrobenchmark::microbenchmark(.colSums(x,100000,100), colSums(x),Rfast::colsums(x,parallel=0),\n    Rfast::colsums(x,parallel=1),times=1000)\n\n Unit: milliseconds\n                            expr       min        lq      mean    median        uq     max    neval\n         .colSums(x, 1e+05, 100) 12.910733 12.971671 13.124897 13.011441 13.087346 26.914502  1000\n                      colSums(x) 12.944944 13.012511 13.142074 13.058268 13.128400 14.879138  1000\n Rfast::colsums(x, parallel = 0)  6.988414  7.009796  7.165310  7.068810  7.154765 16.826589  1000\n Rfast::colsums(x, parallel = 1)  4.061679  4.251977  4.373995  4.296451  4.385827  7.610196  1000\n</code></pre>\n"}], "owner": {"reputation": 3752, "user_id": 4133063, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QC9Pv.jpg?s=128&g=1", "display_name": "D1X", "link": "https://stackoverflow.com/users/4133063/d1x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 52737999, "answer_count": 2, "score": 2, "last_activity_date": 1540737466, "creation_date": 1539165009, "question_id": 52737371, "link": "https://stackoverflow.com/questions/52737371/are-colmeans-colsums-in-r-also-parallelized", "title": "Are colMeans(), colSums()... in R also parallelized?", "body": "<p>We know that using functions like <code>colMeans()</code>, <code>colSums()</code> is a lot faster than their equivalent using <code>apply()</code>, as this are precompiled (in <code>C</code>, <code>C++</code>...?)</p>\n\n<p>Are these functions also automatically parallelized in these languages? </p>\n\n<p>Maybe it does not really make sense the overhead cost of parallelizing as it is only a very simple function, Right? But still, for very large matrices it could make sense?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1539164627, "post_id": 52737198, "comment_id": 92399118, "body": "the &quot;equal sign&quot; as you call it is more commonly called &quot;assignment operator&quot; (<code>=</code>). The &quot;equals operator&quot; would be <code>==</code>. I&#39;ve taken the liberty to edit your question to avoid confusion."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 3, "creation_date": 1539164675, "post_id": 52737198, "comment_id": 92399148, "body": "The second one is undefined behavior. You&#39;re writing the string to an address where there&#39;s just a pointer, without any memory allocated to hold that string."}], "answers": [{"comments": [{"owner": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1539165585, "post_id": 52737301, "comment_id": 92399723, "body": "@bolov well, technically speaking, showing data on scheme as multi-character literal is okay, I think. Because value of expression <code>&quot;s&quot;</code> is pointer, and value of <code>&#39;s&#39;</code> is representation of <code>&#39;s&#39;</code> itself. But yeah, good point, it would be simpler to read for novice with double quotes."}, {"owner": {"reputation": 105, "user_id": 7833786, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e9409a3d38ccc1c47b6e4245c3ce2514?s=128&d=identicon&r=PG&f=1", "display_name": "Chris N", "link": "https://stackoverflow.com/users/7833786/chris-n"}, "edited": false, "score": 0, "creation_date": 1539165824, "post_id": 52737301, "comment_id": 92399876, "body": "Thanks for the great explanation."}], "tags": [], "owner": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "is_accepted": true, "score": 7, "last_activity_date": 1539165623, "last_edit_date": 1539165623, "creation_date": 1539164812, "answer_id": 52737301, "question_id": 52737198, "link": "https://stackoverflow.com/questions/52737198/c-strcpy-vs-assignment/52737301#52737301", "title": "C - strcpy vs assignment", "body": "<p><code>strcpy</code> performs deep copy. It copies data contained in memory at address, which is equal to value of pointer, to memory at address, which is equal to second pointer.</p>\n\n<p>Assignment simply assigns second pointer value of the first pointer.</p>\n\n<p>Here is a small figure for you:</p>\n\n<pre><code>A -&gt; \"some data           \"\nB -&gt; \"some other data     \"\n</code></pre>\n\n<p>After assignment:</p>\n\n<pre><code>A -&gt; \"some data           \"\n   /\n  /\nB    \"some other data     \"\n</code></pre>\n\n<p>After strcpy:</p>\n\n<pre><code>A -&gt; \"some data           \"\nB -&gt; \"some data           \"\n</code></pre>\n\n<p>Mind the fact that memory for <code>strcpy</code> to copy to must be allocated beforehand.</p>\n"}], "owner": {"reputation": 105, "user_id": 7833786, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e9409a3d38ccc1c47b6e4245c3ce2514?s=128&d=identicon&r=PG&f=1", "display_name": "Chris N", "link": "https://stackoverflow.com/users/7833786/chris-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1669, "favorite_count": 0, "closed_date": 1539165124, "accepted_answer_id": 52737301, "answer_count": 1, "score": 3, "last_activity_date": 1539165623, "creation_date": 1539164528, "last_edit_date": 1539164718, "question_id": 52737198, "link": "https://stackoverflow.com/questions/52737198/c-strcpy-vs-assignment", "closed_reason": "Duplicate", "title": "C - strcpy vs assignment", "body": "<p>Are they any difference if i use <code>strcpy()</code> fuction and the assignment operator ? </p>\n\n<pre><code>char word[][40],*first;\n</code></pre>\n\n<p>Below is the 2 example. </p>\n\n<pre><code>*first=word[0]; \nstrcpy(first,&amp;word[0]);\n</code></pre>\n"}, {"tags": ["python", "c", "cmake", "mingw", "python-c-api"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1539163086, "post_id": 52736687, "comment_id": 92398173, "body": "You need a shared library, no a static one. But you have the right intuition. Look at the documentation to get to the shared library (.dll on Windows by default but you will have to change the suffix to pyd)."}, {"owner": {"reputation": 506, "user_id": 1316105, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BGznF.png?s=128&g=1", "display_name": "Santanor", "link": "https://stackoverflow.com/users/1316105/santanor"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1539169875, "post_id": 52736687, "comment_id": 92402316, "body": "Right, I see. Thanks @MatthieuBrucher I&#39;ve added the &quot;SHARED&quot; keyworkd to my CMake and at least I&#39;m getting a <code>.dll.a</code> file so it&#39;s trying to do it. It fails with this error <code>undefined reference to _imp__PyModule_Create2</code> which I think it requires another question by itself. :)"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1539172660, "post_id": 52736687, "comment_id": 92403910, "body": "Yes, that&#39;s another problem, seems the python libraries don&#39;t match or something."}], "owner": {"reputation": 506, "user_id": 1316105, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BGznF.png?s=128&g=1", "display_name": "Santanor", "link": "https://stackoverflow.com/users/1316105/santanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539162890, "creation_date": 1539162890, "question_id": 52736687, "link": "https://stackoverflow.com/questions/52736687/linking-c-module-with-python-3-7-cmake-in-windows", "title": "Linking C module with Python 3.7. CMake in Windows", "body": "<p>I'm trying to create a C library that can be called from Python, so far I've created the proxy C file that exposes the module information and the method table (For simplicity just one method is added <code>get_cycle_count</code> and its implementation irrelevant):</p>\n\n<pre><code>static PyMethodDef NESulator_methods[] = {\n        {\"NESulator\",  get_cycle_count, METH_VARARGS, \"Retrieves the current cycle count\"},\n        {NULL, NULL, 0, NULL}        /* Sentinel */\n};\n\nstatic struct PyModuleDef NESulator_module = {\n        PyModuleDef_HEAD_INIT,\n        \"NESulator\",    /* name of module */\n        NULL,           /* module documentation, may be NULL */\n        -1,             /* size of per-interpreter state of the module,\n                           or -1 if the module keeps state in global variables. */\n        NESulator_methods\n};\n\n/*\n * Should this be called somewhere? Will the linker do something with this?\n */\nPyMODINIT_FUNC PyInit_NESulator(void)\n{\n    return PyModule_Create(&amp;NESulator_module);\n}\n</code></pre>\n\n<p>Now, the <a href=\"https://docs.python.org/3/extending/windows.html#building-on-windows\" rel=\"nofollow noreferrer\">documentation</a> says that (Obviously) my C library has to be processed somehow so that Python can actually import it. I've gotten  as far as creating a C library instead of an executable with CMake (And CLion, not VS so the compiler is gcc from MinGW) but I can't find nor understand how I'm suposed to do that with CMake. </p>\n\n<p>This piece of CMake produces a file called <code>libNESulator.a</code> but no <code>dll</code> or <code>lib</code> files are produced and the <code>.py</code> file (in the same location as the <code>.a</code> library) can't find it when doing <code>import libNESulator</code> or <code>import NESulator</code> the latter one being the name defined in the <code>PyModuleDef</code> structure. So I'm pretty sure there's something missing there </p>\n\n<pre><code>project(NESulator)\nset(CMAKE_C_STANDARD 11)\nadd_subdirectory(src)\n\nfind_package(PythonLibs REQUIRED)\n\ninclude_directories(${PYTHON_INCLUDE_DIRS})\n\nadd_library(NESulator \"all of my .c files in the src directory previously included\" )\n\ntarget_link_libraries(NESulator ${PYTHON_LIBRARIES})\n</code></pre>\n\n<p>So.... yeah, do you have any idea how to turn that <code>libNESulator.a</code> into a Python callable module? What do I need to do in this CMake to make it happen? </p>\n\n<p>If you have an easier way of doing it or any other way at all please feel free to propose it. I'm quite new to CMake and Python so I don't know if you need more information from me like the project structure or so but please let me know if you do. </p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["c", "struct", "header-files"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 2, "creation_date": 1539161352, "post_id": 52736170, "comment_id": 92397061, "body": "What <i>does</i> it print?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10433234"}, "reply_to_user": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1539161426, "post_id": 52736170, "comment_id": 92397101, "body": "it doesn&#39;t print anything."}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 5, "creation_date": 1539161592, "post_id": 52736170, "comment_id": 92397208, "body": "<code>prog.c:22:19: warning: format specifies type &#39;float *&#39; but the argument has type &#39;double&#39; [-Wformat]</code> Why can&#39;t people just listen to the compiler :("}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1539161656, "post_id": 52736170, "comment_id": 92397245, "body": "You should look at examples on how to use <code>scanf</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1539161692, "post_id": 52736170, "comment_id": 92397269, "body": "<code>if (scanf(&quot;%lf%lf&quot;, &amp;a, &amp;b) != 2) &#47;* error *&#47;;</code>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1539161755, "post_id": 52736170, "comment_id": 92397310, "body": "Why not use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/complex.h.html\" rel=\"nofollow noreferrer\"><code>&lt;complex.h&gt;</code></a>?"}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1539162290, "post_id": 52736170, "comment_id": 92397677, "body": "Please update your question. Your comment to an answer <code>This is not the problem, the problem is &quot;undefines reference to make&quot;</code> shows, that there is no output because you wasn&#39;t able to compile the program."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10433234"}, "edited": false, "score": 0, "creation_date": 1539162568, "post_id": 52736170, "comment_id": 92397836, "body": "I have edited the question."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 3, "creation_date": 1539162682, "post_id": 52736170, "comment_id": 92397918, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10433234"}, "edited": false, "score": 0, "creation_date": 1539162028, "post_id": 52736357, "comment_id": 92397485, "body": "This is not the problem, the problem is &quot;undefines reference to make&quot;."}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1539162105, "post_id": 52736357, "comment_id": 92397531, "body": "@Hicher, what? Your question does not state that problem in any way!"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1539162151, "post_id": 52736357, "comment_id": 92397557, "body": "@Hicher Not according to your question. You claim that &quot;it will take my inputs, ...&quot;. If it&#39;s running, it must have linked successfully (no linker errors such as undefined references)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10433234"}, "edited": false, "score": 0, "creation_date": 1539162883, "post_id": 52736357, "comment_id": 92398039, "body": "Your second live version works just fine, also on my computer.. but in that version, no .c file is defined, right? why is this?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1539162988, "post_id": 52736357, "comment_id": 92398107, "body": "@Hicher Because that online compiler doesn&#39;t support more than one source file, AFAIK. I&#39;ve edited the answer to address your question&#39;s edit."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10433234"}, "edited": false, "score": 0, "creation_date": 1539163279, "post_id": 52736357, "comment_id": 92398320, "body": "Now I get a new error:  request for member &#39;i&#39; in something not a structure or union. I tried writing z-&gt;r instead of z.r, but it still wouldn&#39;t work, why could this be?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10433234"}, "edited": false, "score": 0, "creation_date": 1539163452, "post_id": 52736357, "comment_id": 92398425, "body": "Sorry for asking stupid questions, but I am super new to programming and some things that seem so logical to others don&#39;t seem to get to me ..."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1539163582, "post_id": 52736357, "comment_id": 92398503, "body": "@Hicher Please stop editing the question and invalidating existing answers, that&#39;s not how SO works. And also please note that SO is not a &quot;fix my code for me&quot; service. If you&#39;re so new, following a good tutorial or book might be a better idea as it will give you overall understanding and not piecemeal answers."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1539163746, "post_id": 52736357, "comment_id": 92398600, "body": "@Hicher Also, as the live examples in my answer (<a href=\"http://coliru.stacked-crooked.com/a/59b1ee849e45d103\" rel=\"nofollow noreferrer\">and this one</a>) show, the error with unrecgnised <code>i</code> is not reproducible with code in the question. If you&#39;re really getting it, double-check everything, do some research etc. and if it&#39;s still persistent, you could post it as a new SO question."}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 4, "last_activity_date": 1539162951, "last_edit_date": 1539162951, "creation_date": 1539161804, "answer_id": 52736357, "question_id": 52736170, "link": "https://stackoverflow.com/questions/52736170/use-struct-from-header-file-in-main-in-c/52736357#52736357", "title": "Use struct from header file in main (in C)", "body": "<p>The \"undefined reference\" error comes from the fact that you're not linking the oobject file produced by compiling <code>complex.c</code> into your executable. You need to add it to your linking command line or project settings, depending on how you develop. We have a FAQ that deals with this aspect of linking in great detail: <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a> (The FAQ is for C++, but this part of linking is the same in C).</p>\n\n<hr>\n\n<p>In addition to this, however, you code has the following issue:</p>\n\n<p>Building with warnings enabled (which you should <em>always,</em> <strong>always</strong> do) produces these warnings (among others) from your code:</p>\n\n<pre><code>main.cpp: In function 'main':\n\nmain.cpp:28:13: warning: format '%f' expects argument of type 'float *', but argument 2 has type 'double' [-Wformat=]\n     scanf(\"%f %f\",a,b);\n            ~^     ~\nmain.cpp:28:16: warning: format '%f' expects argument of type 'float *', but argument 3 has type 'double' [-Wformat=]\n     scanf(\"%f %f\",a,b);\n           ~^    ~\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/23316b6a1f453f89\" rel=\"nofollow noreferrer\">[Live example]</a></p>\n\n<p>You're passing <code>double</code>s where a <code>float*</code> is expected, so the program has Undefined Behaviour (and, as in the live example above, will most likely crash).</p>\n\n<p>The correct form is to use pointers as arguments, and format specifiers for the correct type (<code>lf</code> for <code>double</code>):</p>\n\n<pre><code>scanf(\"%lf %lf\",&amp;a,&amp;b);\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/a803a883d998e74d\" rel=\"nofollow noreferrer\">[Live example]</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10433234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539163596, "creation_date": 1539161226, "last_edit_date": 1539163596, "question_id": 52736170, "link": "https://stackoverflow.com/questions/52736170/use-struct-from-header-file-in-main-in-c", "title": "Use struct from header file in main (in C)", "body": "<p>I have the following header file:</p>\n\n<pre><code>#ifndef COMPLEX_H_INCLUDED\n#define COMPLEX_H_INCLUDED\n\ntypedef struct {\n    double r; //real part\n    double i; //imag part\n} complex;\n\ncomplex make(double r,double i);\n\n#endif // COMPLEX_H_INCLUDED\n</code></pre>\n\n<p>and .c file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include \"complex.h\"\n\ncomplex make(double re,double im)\n{\n    complex z;\n    z.r=re;\n    z.i=im;\n    return z\n}\n</code></pre>\n\n<p>Now, when I try to create a complex in a main file, I don't seem to be able to print a complex number that I've created. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"complex.h\"\n\nint main()\n{\n    double a,b;\n    printf(\"Enter real, then imaginary part:\");\n    scanf(\"%f %f\",a,b);\n\n    complex z;\n    z=make(a,b);\n\n    printf(\"The number is: %f%+fi\",z.r,z.i);\n    return 0;\n}\n</code></pre>\n\n<p>I get an error: undefined reference to make.</p>\n"}, {"tags": ["c", "string", "pointers", "substring"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1539161176, "post_id": 52736110, "comment_id": 92396975, "body": "Simple and effective, I would say. No need for <code>ptr</code> I think?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539161249, "post_id": 52736110, "comment_id": 92397009, "body": "empty braces are invalid C initialization. Are you using a C++ compiler?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539161361, "post_id": 52736110, "comment_id": 92397068, "body": "<code>strncpy()</code>, despite its name, was not designed to work with strings. In your case, it will not write a <code>&#39;\\0&#39;</code> to <code>sub[12]</code> <i>(which may already be there)</i>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1539161377, "post_id": 52736110, "comment_id": 92397076, "body": "That should be: <code>if (ptr = strstr(src,&quot;CBC:&quot;)) strncpy(sub,ptr,sizeof(sub)-1);</code> because the substring could not have been found."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1539161456, "post_id": 52736110, "comment_id": 92397129, "body": "@pmg, the string was initialized and so will have a zero at its end."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1539161524, "post_id": 52736110, "comment_id": 92397164, "body": "@PaulOgilvie: illegally initialized :)"}, {"owner": {"reputation": 1281, "user_id": 1356096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTexs.png?s=128&g=1", "display_name": "YesThatIsMyName", "link": "https://stackoverflow.com/users/1356096/yesthatismyname"}, "edited": false, "score": 0, "creation_date": 1539162105, "post_id": 52736110, "comment_id": 92397530, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2114377/strings-in-c-how-to-get-substring\">Strings in C, how to get subString</a>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1539162155, "post_id": 52736110, "comment_id": 92397561, "body": "Functions from the C standard library are normally optimized, so using <code>strstr</code> is probably more efficient than trying to roll your own..."}, {"owner": {"reputation": 340, "user_id": 10341985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d242bfa7a0d328a2830bec3561a0c39b?s=128&d=identicon&r=PG&f=1", "display_name": "Iman H", "link": "https://stackoverflow.com/users/10341985/iman-h"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1539163841, "post_id": 52736110, "comment_id": 92398648, "body": "@MatthieuBrucher without ptr, we can not assign the strstr output."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539182106, "post_id": 52736110, "comment_id": 92410006, "body": "With <code>sub,src</code> lengths of B and C, a simple solution is <code>O(B*C)</code>. An effective  solution is <code>O(B + C)</code>.  Choose one.   <code>strstr()</code> might be encoded either way.  Recommend  to  just trust the lib."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1539183694, "post_id": 52736110, "comment_id": 92410995, "body": "&quot;I just want to find a <b>special</b> sub-string in another string and <b>save</b> it as another string&quot; Is it only me who thinks the task has no sense? Why not just set a flag?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1539183923, "post_id": 52736110, "comment_id": 92411161, "body": "@Matt <code>sub[]</code>and its <i>special data</i> after the matching sub-string, may be needed long after <code>str[]</code> is changed."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539184376, "post_id": 52736110, "comment_id": 92411499, "body": "@chux But that data is just a constant string. In practice it&#39;s almost always easier to operate with flags/indexes into arrays of literals."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1539184540, "post_id": 52736110, "comment_id": 92411601, "body": "@Matt As a typical <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, it is reasonable to assume <code>char src[]</code> is not constant but only given the value of <code>&quot;SOME DATE HERE CBC: 2345,23, SOME OTHER DATA&quot;</code> to illustrate the issue."}, {"owner": {"reputation": 340, "user_id": 10341985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d242bfa7a0d328a2830bec3561a0c39b?s=128&d=identicon&r=PG&f=1", "display_name": "Iman H", "link": "https://stackoverflow.com/users/10341985/iman-h"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1539234570, "post_id": 52736110, "comment_id": 92428916, "body": "@Matt The data after CBC: is changing every 1 seconds. It should be extracted and then interpreted in some way."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1539244221, "post_id": 52736110, "comment_id": 92433076, "body": "@ImanH Still I don&#39;t see the need to save the literal prefix &quot;CBC: &quot;. Also the intepretation of a 13-byte string should not be too elaborate, so it could probably be done in-place effectively eliminating any need to save it."}], "answers": [{"comments": [{"owner": {"reputation": 340, "user_id": 10341985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d242bfa7a0d328a2830bec3561a0c39b?s=128&d=identicon&r=PG&f=1", "display_name": "Iman H", "link": "https://stackoverflow.com/users/10341985/iman-h"}, "edited": false, "score": 0, "creation_date": 1539235395, "post_id": 52743108, "comment_id": 92429126, "body": "<i>strncpy(sub,ptr,sizeof(sub)-1) can unnecessarily mostly fill the array with null characters.</i>  The memory for <i>src</i> is allocated so far. Is the inefficiency in its computational complexity?"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1539184355, "last_edit_date": 1539184355, "creation_date": 1539183390, "answer_id": 52743108, "question_id": 52736110, "link": "https://stackoverflow.com/questions/52736110/efficient-way-to-find-and-then-copy-a-substring-in-c/52743108#52743108", "title": "Efficient way to find and then copy a substring in C", "body": "<blockquote>\n  <p>Is this an efficient way or does a better method exist for this?</p>\n</blockquote>\n\n<p><strong>Pros:</strong></p>\n\n<p>Uses <code>strstr()</code> which is likely more efficient and correct that coding your own search.</p>\n\n<p><strong>Cons:</strong></p>\n\n<p>Does not handle the case when <code>strstr()</code> return <code>NULL</code> resulting in <em>undefined behavior</em> (UB). <a href=\"https://stackoverflow.com/questions/52736110/efficient-way-to-find-and-then-copy-a-substring-in-c/52743108#comment92397076_52736110\">@Paul Ogilvie</a></p>\n\n<pre><code>ptr = strstr(src,\"CBC:\");\n// add test\nif (ptr) {\n  // copy\n} else {\n  // Handle not found, perhaps `sub[0] = '\\0';`\n}\n</code></pre>\n\n<p><code>char sub[13]={};</code> is not compliant C code.  <a href=\"https://stackoverflow.com/questions/52736110/efficient-way-to-find-and-then-copy-a-substring-in-c/52743108#comment92397164_52736110\">@pmg</a>.  A full initialization of the array is not needed - even though it is a common good practice.</p>\n\n<p>Code does not quite fulfill \"want to find a special sub-string in another string and save it as another string\".  Its more like \"want to find a special sub-string in another string and save it <em>and more</em> as another string\".</p>\n\n<p><code>strncpy(sub,ptr,sizeof(sub)-1)</code> can unnecessarily mostly fill the array with null characters.  This is inefficient when <code>ptr</code> points to a string much less than <code>sizeof(sub)</code>.  Code could use <code>strncat()</code> but that is tricky.  See this good answer <a href=\"https://stackoverflow.com/a/6904422/2410359\">@AnT</a>.</p>\n\n<pre><code>// alternative\nchar src[100] = \"SOME DATE HERE CBC: 2345,23, SOME OTHER DATA\";\n\nchar sub[13];\nsub[0] = '\\0';\n\nconst char *ptr = strstr(src, \"CBC:\");\nif (ptr) {\n  strncat(sub, p, sizeof sub - 1);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 303, "user_id": 1877011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c2bdc6dfae6040614ad62e0b82810a4?s=128&d=identicon&r=PG", "display_name": "Angstrom", "link": "https://stackoverflow.com/users/1877011/angstrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1539185251, "last_edit_date": 1539185251, "creation_date": 1539184343, "answer_id": 52743449, "question_id": 52736110, "link": "https://stackoverflow.com/questions/52736110/efficient-way-to-find-and-then-copy-a-substring-in-c/52743449#52743449", "title": "Efficient way to find and then copy a substring in C", "body": "<p>Unless this piece of code is in a critical path <strong>and</strong> it's the actual source of a performance bottleneck, then just stick to what you have. Default <code>strstr</code> implementation should be quite adequate for the task.</p>\n\n<p>You <em>can</em> squeeze some peanuts by pre-computing the end of <code>src</code>, for example, so you could use <code>memcmp</code> (an unconditional loop) instead of <code>strncpy</code> (which has a conditional loop) when extracting the <code>sub</code>. If you know beforehand the substring you are searching for, you can optimize around that too; especially if it's exactly 4 characters. And so on and so forth.</p>\n\n<p>But if you <em>are</em> after these peanuts, you might be (much) better off by redoing the code to not extract <code>sub</code> to begin with and use something like ranged strings to keep track of where it is in the source string.</p>\n"}], "owner": {"reputation": 340, "user_id": 10341985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d242bfa7a0d328a2830bec3561a0c39b?s=128&d=identicon&r=PG&f=1", "display_name": "Iman H", "link": "https://stackoverflow.com/users/10341985/iman-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 52743108, "answer_count": 2, "score": 1, "last_activity_date": 1539185251, "creation_date": 1539161059, "last_edit_date": 1539163004, "question_id": 52736110, "link": "https://stackoverflow.com/questions/52736110/efficient-way-to-find-and-then-copy-a-substring-in-c", "title": "Efficient way to find and then copy a substring in C", "body": "<p>I just want to find a special sub-string in another string and save it as another string. Here is the code:</p>\n\n<pre><code>char sub[13]={};\nchar *ptr = sub;\nchar src[100] = \"SOME DATE HERE CBC: 2345,23, SOME OTHER DATA\";\n//                              |----------|\nptr = strstr(src,\"CBC:\");\nstrncpy(sub,ptr,sizeof(sub)-1);\n</code></pre>\n\n<p>Is this an efficient way or does a better method exist for this?\nThanks.</p>\n"}, {"tags": ["c", "file", "io", "stdin"], "answers": [{"tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 4, "last_activity_date": 1539160771, "creation_date": 1539160771, "answer_id": 52736018, "question_id": 52735958, "link": "https://stackoverflow.com/questions/52735958/reading-from-stdin-into-a-file/52736018#52736018", "title": "Reading from stdin into a FILE*", "body": "<p><code>stdin</code>, <code>stdout</code> and <code>stderr</code> are already of type <code>FILE *</code>. So you can use it like any other <code>FILE *</code> variable.</p>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "is_accepted": false, "score": 0, "last_activity_date": 1539160854, "creation_date": 1539160854, "answer_id": 52736054, "question_id": 52735958, "link": "https://stackoverflow.com/questions/52735958/reading-from-stdin-into-a-file/52736054#52736054", "title": "Reading from stdin into a FILE*", "body": "<p>You can use <code>getchar()</code> on a line buffered terminal and read it like this:</p>\n\n<pre><code> int i;\n while((i=getchar())!=EOF)\n</code></pre>\n\n<p>And then use it to write it into a file.</p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 1, "last_activity_date": 1539160923, "creation_date": 1539160923, "answer_id": 52736075, "question_id": 52735958, "link": "https://stackoverflow.com/questions/52735958/reading-from-stdin-into-a-file/52736075#52736075", "title": "Reading from stdin into a FILE*", "body": "<p>Yes, just use <code>fp</code> and <code>stdin</code> as needed</p>\n\n<pre><code>void copyline(FILE *fp) {\n    int ch;\n    while ((ch = fgetc(stdin) != EOF) &amp;&amp; (ch != '\\n')) {\n        fputc(ch, fp);\n    }\n    if (ch != EOF) fputc('\\n', fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 9310248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2579a166628727e019613e521c489e87?s=128&d=identicon&r=PG&f=1", "display_name": "krise", "link": "https://stackoverflow.com/users/9310248/krise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 52736018, "answer_count": 3, "score": 0, "last_activity_date": 1539160923, "creation_date": 1539160553, "question_id": 52735958, "link": "https://stackoverflow.com/questions/52735958/reading-from-stdin-into-a-file", "title": "Reading from stdin into a FILE*", "body": "<p>I have a functions that expects a FILE* and I usually create that by reading from a file. Now under certain circumstances I want to read from stdin. Is there a way to read a sentence with previously unspecified length from stdin and write it into a FILE* ? </p>\n"}, {"tags": ["c", "regex"], "answers": [{"comments": [{"owner": {"reputation": 480, "user_id": 1152213, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/41d1befc6b5b4da115c39605ce118357?s=128&d=identicon&r=PG", "display_name": "user1990", "link": "https://stackoverflow.com/users/1152213/user1990"}, "edited": false, "score": 0, "creation_date": 1539160053, "post_id": 52735771, "comment_id": 92396364, "body": "I m sorry i little bit change my regex. How to support lookarounds ?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 480, "user_id": 1152213, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/41d1befc6b5b4da115c39605ce118357?s=128&d=identicon&r=PG", "display_name": "user1990", "link": "https://stackoverflow.com/users/1152213/user1990"}, "edited": false, "score": 1, "creation_date": 1539160095, "post_id": 52735771, "comment_id": 92396386, "body": "With another regex library: PCRE, PCRE2, Boost, etc."}, {"owner": {"reputation": 480, "user_id": 1152213, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/41d1befc6b5b4da115c39605ce118357?s=128&d=identicon&r=PG", "display_name": "user1990", "link": "https://stackoverflow.com/users/1152213/user1990"}, "edited": false, "score": 1, "creation_date": 1539160390, "post_id": 52735771, "comment_id": 92396555, "body": "Thanks a lot for your answers"}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1539159884, "creation_date": 1539159884, "answer_id": 52735771, "question_id": 52735485, "link": "https://stackoverflow.com/questions/52735485/how-to-avoid-regcomp-error-13-with-this-regular-expression/52735771#52735771", "title": "How to avoid regcomp error 13 with this regular expression?", "body": "<p><code>&lt;regex.h&gt;</code> POSIX regex does not support lookarounds.</p>\n\n<p>You may match the simple pattern you have in the lookahead as a consuming pattern and if the <code>ret</code> is <code>REG_NOMATCH</code>, consider the match valid:</p>\n\n<pre><code>regex_t preg;\nint ret;\nret = regcomp(&amp;preg,\"01418710[0-9]{2}\", REG_EXTENDED);\n... \nret = regexec(&amp;preg, \"your_string\", 0, NULL, 0);\nif (ret == REG_NOMATCH) {\n    printf(\"Matched!!!\");\n}\n</code></pre>\n"}], "owner": {"reputation": 480, "user_id": 1152213, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/41d1befc6b5b4da115c39605ce118357?s=128&d=identicon&r=PG", "display_name": "user1990", "link": "https://stackoverflow.com/users/1152213/user1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 52735771, "answer_count": 1, "score": 2, "last_activity_date": 1539159884, "creation_date": 1539158892, "last_edit_date": 1539159716, "question_id": 52735485, "link": "https://stackoverflow.com/questions/52735485/how-to-avoid-regcomp-error-13-with-this-regular-expression", "title": "How to avoid regcomp error 13 with this regular expression?", "body": "<p>I would like to use regular expression from here but a little bit differently :</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc3986#appendix-B\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc3986#appendix-B</a></p>\n\n<p>I am trying  it like this:</p>\n\n<pre><code>ret = regcomp(preg,\"^(?!01418710[0-9]{2}).*\", REG_EXTENDED);\nif (ret) {\n    char errmsg[256];\n    regerror(ret, preg, errmsg, sizeof(errmsg));\n    printf(\"Error msg :%s (ret = %d) for regex:%s\\n\",errmsg,ret, prefix);\n   return -1;\n}\n</code></pre>\n\n<p>this is my regex: <code>^(?!01418710[0-9]{2}).*</code></p>\n\n<p>But I am stuck with return value of <code>regcomp</code>:</p>\n\n<pre><code>REG_BADRPT\n</code></pre>\n\n<p>According to man it means:</p>\n\n<blockquote>\n  <p>Invalid use of repetition operators such as using '*' as the first character.</p>\n</blockquote>\n\n<p>I currently can avoid this error with <code>^(\\?!01418710[0-9]{2}).*</code> but the regular expression is different.</p>\n\n<p>Similar meaning at this man:</p>\n\n<blockquote>\n  <p>?, * or + is not preceded by valid regular expression</p>\n</blockquote>\n\n<p>How am I supposed to avoid this error ? Is my regex correct ?</p>\n"}, {"tags": ["c", "pointers", "initialization", "binary-search-tree", "valgrind"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539158056, "post_id": 52735227, "comment_id": 92395269, "body": "It would help if you decided between <code>node::key_</code> and <code>node::key</code>."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1539158124, "post_id": 52735227, "comment_id": 92395313, "body": "some mistakes: <code>search(root-&gt;left_,key);</code> should be <code>return search(root-&gt;left_,key);</code>. <code>if(key == root-&gt;key){ return NULL; }</code> should <code>return root;</code>..."}, {"owner": {"reputation": 97, "user_id": 6800342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a65a7e7a1a9f86cb0e85e15f1b2014a9?s=128&d=identicon&r=PG&f=1", "display_name": "calgara12", "link": "https://stackoverflow.com/users/6800342/calgara12"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1539158808, "post_id": 52735227, "comment_id": 92395706, "body": "@Swordfish yeah those are typos, it always should be root-&gt;key_"}, {"owner": {"reputation": 97, "user_id": 6800342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a65a7e7a1a9f86cb0e85e15f1b2014a9?s=128&d=identicon&r=PG&f=1", "display_name": "calgara12", "link": "https://stackoverflow.com/users/6800342/calgara12"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1539158846, "post_id": 52735227, "comment_id": 92395721, "body": "@mch Thanks for your suggestion, I changed it, but valgrind still complains..."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1539159206, "post_id": 52735227, "comment_id": 92395929, "body": "I wonder if it could make sense to post the output from valgrind"}, {"owner": {"reputation": 97, "user_id": 6800342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a65a7e7a1a9f86cb0e85e15f1b2014a9?s=128&d=identicon&r=PG&f=1", "display_name": "calgara12", "link": "https://stackoverflow.com/users/6800342/calgara12"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1539159847, "post_id": 52735227, "comment_id": 92396244, "body": "@4386427 Edited and added it at the end"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6800342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a65a7e7a1a9f86cb0e85e15f1b2014a9?s=128&d=identicon&r=PG&f=1", "display_name": "calgara12", "link": "https://stackoverflow.com/users/6800342/calgara12"}, "edited": false, "score": 1, "creation_date": 1539160230, "post_id": 52735621, "comment_id": 92396467, "body": "First of all thanks for your help, This kind of helps, so instead of 6 valgrind warnings i get 4."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1539160456, "post_id": 52735621, "comment_id": 92396593, "body": "Did you also fix the same problem with <code>new_node</code> twice some lines below?"}, {"owner": {"reputation": 97, "user_id": 6800342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a65a7e7a1a9f86cb0e85e15f1b2014a9?s=128&d=identicon&r=PG&f=1", "display_name": "calgara12", "link": "https://stackoverflow.com/users/6800342/calgara12"}, "edited": false, "score": 0, "creation_date": 1539161810, "post_id": 52735621, "comment_id": 92397347, "body": "Now i also fixed the problem with newNode, thanks for your help!"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1539159449, "creation_date": 1539159449, "answer_id": 52735621, "question_id": 52735227, "link": "https://stackoverflow.com/questions/52735227/binary-search-tree-valgrind-conditional-jump-or-move-depends-on-uninitialized-v/52735621#52735621", "title": "Binary Search Tree, Valgrind Conditional jump or move depends on uninitialized values", "body": "<p>Not sure this covers all your problems but here</p>\n\n<pre><code>if(root == NULL){\n  root = malloc(sizeof(node));\n  if(root != NULL){\n      root-&gt;key_ = key;\n  }\n</code></pre>\n\n<p>I would expect something like:</p>\n\n<pre><code>if(root == NULL){\n   root = malloc(sizeof(node));\n   if(root != NULL){\n      root-&gt;key_ = key;\n      root-&gt;left_ = NULL;    // new initialization\n      root-&gt;right_ = NULL;   // new initialization\n  }\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6800342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a65a7e7a1a9f86cb0e85e15f1b2014a9?s=128&d=identicon&r=PG&f=1", "display_name": "calgara12", "link": "https://stackoverflow.com/users/6800342/calgara12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 52735621, "answer_count": 1, "score": 1, "last_activity_date": 1539160512, "creation_date": 1539157861, "last_edit_date": 1539160512, "question_id": 52735227, "link": "https://stackoverflow.com/questions/52735227/binary-search-tree-valgrind-conditional-jump-or-move-depends-on-uninitialized-v", "title": "Binary Search Tree, Valgrind Conditional jump or move depends on uninitialized values", "body": "<p>i'm trying to implement a bst and all the functions needed for it to work (insert, delete, traverse, delete_tree).</p>\n\n<p>Everything seems to work fine. But Valgrind complains about uninitialized Values, but how and what would i have to initialize in my example. I read a few other threads that were talking about this problem, but i'm having trouble applying it to my example.</p>\n\n<p>Every help is greatly appreciated. Thanks</p>\n\n<p>Here is my Code:</p>\n\n<pre><code>node* insert(node* root, int key)\n{\n  if(root == NULL){\n      root = malloc(sizeof(node));\n      if(root != NULL){\n          root-&gt;key_ = key;\n      }\n\n  }\n  else{\n\n      if(key == root-&gt;key){\n        return NULL;\n      }\n      else if(key &lt; root-&gt;key){\n        if(root-&gt;left_ != NULL ){\n          insert(root-&gt;left_, key);\n        }\n        else{\n            root-&gt;left_ = NULL;\n            node* newNode = malloc(sizeof(node));\n            if(newNode != NULL){\n                newNode -&gt;key_ = key;\n                root-&gt;left_ = newNode;\n            }\n\n        }\n      }\n      else{\n        if(root-&gt;right_ != NULL){\n            insert(root-&gt;right_, key);\n        }\n        else{\n            root-&gt;right_ = NULL;\n            node* newNode = malloc(sizeof(node));\n            if(newNode != NULL){\n                newNode -&gt;key_ = key;\n                root-&gt;right_ = newNode;\n            }\n\n        }\n      }\n  }\n\n\n  return root;\n}\n\n\nnode* search(node* root, int key)\n{ \n  if(key == root-&gt;key){\n      return root;\n  }\n  else{\n      if(key &lt; root-&gt;key{\n          if(root-&gt;left_ != NULL){\n              search(root-&gt;left_,key);\n          }\n          else{\n              return NODE_NOT_FOUND;\n          }\n      }\n      else{\n          if(root-&gt;right_ != NULL){\n              search(root-&gt;right_,key);\n          }\n          else{\n              root-&gt;right_ = NULL;\n              return NODE_NOT_FOUND;\n          }\n      }\n  }\n\n\n  return root;\n\n}\n\nnode* findMin(node* root){\n    while(root-&gt;left_ != NULL){\n        root = root-&gt;left_;\n    }\n    return root;\n}\n\nnode* delete(node* root, int key)\n{\n if(key &lt; root-&gt;key){\n     root-&gt;left_ = delete(root-&gt;left_,key);\n }\n else if (key &gt; root-&gt;key){\n     root-&gt;right_ = delete(root-&gt;right_,key);\n }\n else{\n     if(root-&gt;left_ == NULL &amp;&amp; root-&gt;right_ == NULL){\n         free(root);\n         root = NULL;\n     }\n     else if(root-&gt;left_ == NULL){\n         node* temp = root;\n         root = root-&gt;right_;\n         free(temp);\n     }\n     else if(root-&gt;right_ == NULL){\n         node* temp = root;\n         root = root-&gt;left_;\n         free(temp);\n     }\n     else{\n         node* temp = findMin(root-&gt;right_);\n         root-&gt;key_= temp-&gt;key_;\n         root-&gt;right_= delete(root-&gt;right_,temp-&gt;key_);\n     }\n }\nreturn root;\n}\nvoid delete_tree(node* root)\n{\n  if(root != NULL){\n      delete_tree(root-&gt;left_);\n      delete_tree(root-&gt;right_);\n      root-&gt;left_ = NULL;\n      root-&gt;right_ = NULL;\n      free(root);\n  }\n}\n</code></pre>\n\n<p>Valgrind output:</p>\n\n<pre><code>==6289== Memcheck, a memory error detector\n==6289== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==6289== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==6289== Command: ./bst.out\n==6289== \n==6289== Conditional jump or move depends on uninitialised value(s) [gone]\n==6289==    at 0x108816: insert (bst.c:64)\n==6289==    by 0x108B42: main (main.c:12)\n==6289== \n==6289== Conditional jump or move depends on uninitialised value(s) [gone]\n==6289==    at 0x1087B7: insert (bst.c:50)\n==6289==    by 0x108B57: main (main.c:13)\n==6289== \n==6289== Conditional jump or move depends on uninitialised value(s) [still here]\n==6289==    at 0x1089DA: delete (bst.c:139)\n==6289==    by 0x1089BE: delete (bst.c:136)\n==6289==    by 0x108C0B: main (main.c:17)\n==6289== \n==6289== Conditional jump or move depends on uninitialised value(s) [still here]\n==6289==    at 0x1089E7: delete (bst.c:139)\n==6289==    by 0x1089BE: delete (bst.c:136)\n==6289==    by 0x108C0B: main (main.c:17)\n==6289== \n==6289== Conditional jump or move depends on uninitialised value(s) [still here]\n==6289==    at 0x1089DA: delete (bst.c:139)\n==6289==    by 0x10897E: delete (bst.c:133)\n==6289==    by 0x108C20: main (main.c:18)\n==6289== \n==6289== Conditional jump or move depends on uninitialised value(s) [still here]\n==6289==    at 0x1089E7: delete (bst.c:139)\n==6289==    by 0x10897E: delete (bst.c:133)\n==6289==    by 0x108C20: main (main.c:18)**\n==6289== \n==6289== \n==6289== HEAP SUMMARY:\n==6289==     in use at exit: 0 bytes in 0 blocks\n==6289==   total heap usage: 3 allocs, 3 frees, 72 bytes allocated\n==6289== \n==6289== All heap blocks were freed -- no leaks are possible\n==6289== \n==6289== For counts of detected and suppressed errors, rerun with: -v\n==6289== Use --track-origins=yes to see where uninitialised values come from\n==6289== ERROR SUMMARY: 6 errors from 6 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "iostream", "uint32-t"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1539155949, "post_id": 52734662, "comment_id": 92394127, "body": "I&#39;m afraid <code>unsigned int</code> has no guaranteed size, just like regular <code>int</code>."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 2, "creation_date": 1539156319, "post_id": 52734662, "comment_id": 92394320, "body": "<code>&lt;iostream&gt;</code> is a C++ header, you can&#39;t use it in C."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1539156343, "post_id": 52734662, "comment_id": 92394337, "body": "woop Im an idiot. Thank you :) Was googling stuff didnt realize I was looking at C++ stuff :)"}, {"owner": {"reputation": 5790, "user_id": 3258851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fUPld.jpg?s=128&g=1", "display_name": "Marc.2377", "link": "https://stackoverflow.com/users/3258851/marc-2377"}, "edited": false, "score": 0, "creation_date": 1539156361, "post_id": 52734662, "comment_id": 92394345, "body": "You are not supposed to include <code>&lt;iostream&gt;</code> in C code, since it is a C++ header and is not part of the C standard in any way."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1539161154, "post_id": 52734662, "comment_id": 92396959, "body": "To the person who &quot;helpfully&quot; added the C++ tag: that hides the problem. The title correctly points out this is a C question."}], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1539156252, "post_id": 52734767, "comment_id": 92394295, "body": "This is C though, not C++. Same applies?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 4, "creation_date": 1539156298, "post_id": 52734767, "comment_id": 92394313, "body": "@Duxa and just how are you using <code>iostream</code> in C ???"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1539156401, "post_id": 52734767, "comment_id": 92394362, "body": "@Duxa and yes, it applies to C as well. Except the header is <code>stdint.h</code> instead."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1539156531, "post_id": 52734767, "comment_id": 92394424, "body": "Yeah I am an idiot, I didnt realize I was looking at C++ documentation. was trying to include it to read a file. Need to find a C solution. Thank you. And I was aware of stdint.h but figured it would be including too much unneeded stuff so opted to use typedef instead. Good to know that this is illegal."}], "tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 5, "last_activity_date": 1539156457, "last_edit_date": 1539156457, "creation_date": 1539156196, "answer_id": 52734767, "question_id": 52734662, "link": "https://stackoverflow.com/questions/52734662/include-iostream-breaks-uint32-t-definition-c/52734767#52734767", "title": "include iostream breaks uint32_t definition (C)", "body": "<p>Declaring <code>uint32_t</code> yourself is illegal afaik. Don't do that. C++ has a standard one. Use that. It's declared in <code>cstdint</code>.</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/types/integer\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/types/integer</a></p>\n\n<p>If you are in <code>C</code> then the header you need to use is <code>stdint.h</code> instead:</p>\n\n<p><a href=\"https://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/types/integer</a></p>\n"}], "owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "closed_date": 1539163405, "answer_count": 1, "score": -3, "last_activity_date": 1539161109, "creation_date": 1539155796, "last_edit_date": 1539161109, "question_id": 52734662, "link": "https://stackoverflow.com/questions/52734662/include-iostream-breaks-uint32-t-definition-c", "closed_reason": "Not suitable for this site", "title": "include iostream breaks uint32_t definition (C)", "body": "<p><strong>Edit: Please disregard this question. I realized that I am an idiot and very nice and helpful people pointed out iostream is not a C but a C++ library.</strong></p>\n\n<p>I am encountering a very strange problem.</p>\n\n<p>I have a fully working program (about 1000 lines). I need to </p>\n\n<pre><code>#include &lt;iostream&gt; \n</code></pre>\n\n<p>When I do so typedef of uint32_t breaks.</p>\n\n<p>It is defined as such </p>\n\n<pre><code>typedef unsigned __int32 uint32_t;\n</code></pre>\n\n<p>I am using Visual Studio 2017. And this is the error it gives</p>\n\n<blockquote>\n  <p>\\vc\\tools\\msvc\\14.15.26726\\include\\cstdlib(19): error C2061: syntax\n  error: identifier 'noexcept'</p>\n</blockquote>\n\n<p>and when I hover over now underlined uint32_t the following is said:</p>\n\n<blockquote>\n  <p> uint32_t variable \"uint32_t\" is not a type name</p>\n</blockquote>\n\n<p>commenting just the line </p>\n\n<pre><code>#include &lt;iostream&gt;\n</code></pre>\n\n<p>the program compiles and runs as expected.</p>\n\n<p>What gives?</p>\n\n<p>Side question. The reason I am using uint32_t is to guarantee that my variable is 32 bit long as I am doing a lot of bit manipulation. Would using unsigned int instead be safe? </p>\n\n<p>Here is a list of everything I am including:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;iostream&gt;\n\ntypedef unsigned __int32 uint32_t;\n</code></pre>\n"}, {"tags": ["c", "embedded", "cross-compiling", "microcontroller"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 11, "creation_date": 1539155227, "post_id": 52734501, "comment_id": 92393710, "body": "Take a look at the linker-generated map file, it should hopefully tell you everything you need."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1539158990, "post_id": 52734501, "comment_id": 92395806, "body": "I&#39;d like to see your own answer on how did you actually solve this ;)"}, {"owner": {"reputation": 8565, "user_id": 1763035, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wpk6X.jpg?s=128&g=1", "display_name": "Andy Brown", "link": "https://stackoverflow.com/users/1763035/andy-brown"}, "edited": false, "score": 0, "creation_date": 1539186144, "post_id": 52734501, "comment_id": 92412599, "body": "look for invisible (i.e. the compiler/linker put them there, not you) routines in the map file for unwanted &#39;pc&#39; stuff like process exit handlers, exception handlers, divide-by-zero handlers."}], "answers": [{"tags": [], "owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "is_accepted": true, "score": 20, "last_activity_date": 1539248454, "last_edit_date": 1539248454, "creation_date": 1539155297, "answer_id": 52734552, "question_id": 52734501, "link": "https://stackoverflow.com/questions/52734501/what-parts-of-the-codebase-are-making-binaries-large/52734552#52734552", "title": "What parts of the codebase are making binaries large?", "body": "<p>GNU binutils has tools to help you determine the size of each symbol or just each object file. </p>\n\n<p>Have a look at <code>size</code> for instance: <a href=\"https://manpages.debian.org/jessie/binutils/size.1.en.html\" rel=\"nofollow noreferrer\">https://manpages.debian.org/jessie/binutils/size.1.en.html</a></p>\n\n<p><code>nm</code> is also worth a try, as it can show the size of each symbol in the object code: <a href=\"https://manpages.debian.org/jessie/binutils/nm.1.en.html\" rel=\"nofollow noreferrer\">https://manpages.debian.org/jessie/binutils/nm.1.en.html</a></p>\n\n<p>Carefully inspecting the output of <code>size</code> and <code>nm</code> will give you intuition for what takes up much space and what doesn't.</p>\n\n<p>Know that <code>printf</code>, <code>sprintf</code> and many of the more complex library functions can often take up quite a few kB of extra ROM. </p>\n\n<p>Floating point support using soft-floats will also bloat the code compared to using hard-float, i.e. using software emulation vs. hardware instructions to handle floating point.</p>\n\n<p>Sometimes the compiler will add an astonishing amount of bloat :) </p>\n"}, {"tags": [], "owner": {"reputation": 765, "user_id": 10143388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95f5ed267f8601015469bc5617750a?s=128&d=identicon&r=PG&f=1", "display_name": "A.R.C.", "link": "https://stackoverflow.com/users/10143388/a-r-c"}, "is_accepted": false, "score": 6, "last_activity_date": 1539184519, "last_edit_date": 1539184519, "creation_date": 1539159892, "answer_id": 52735776, "question_id": 52734501, "link": "https://stackoverflow.com/questions/52734501/what-parts-of-the-codebase-are-making-binaries-large/52735776#52735776", "title": "What parts of the codebase are making binaries large?", "body": "<p>I once also had memory issues with a tiny MSP430 controller.\nThe TI toolchain is linking large libraries into your binary if negative values are possible or floating point is used. In my case, it was about 10% - 20% of total memory usage.</p>\n\n<p>TI's free Code composer Studio does provide a very powerful memory visualization (View -> Memory Allocation)</p>\n\n<p>What helped me a lot was changing the Initialization Model in the Linker settings and other optimization options. I am currently not working with an MSP430 controller so I can not tell you details any more.</p>\n"}, {"tags": [], "owner": {"reputation": 956, "user_id": 695984, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/786df6016cd1358b1e72c83cbaf18bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Chapman", "link": "https://stackoverflow.com/users/695984/christian-chapman"}, "is_accepted": false, "score": 0, "last_activity_date": 1542086088, "creation_date": 1542086088, "answer_id": 53274239, "question_id": 52734501, "link": "https://stackoverflow.com/questions/52734501/what-parts-of-the-codebase-are-making-binaries-large/53274239#53274239", "title": "What parts of the codebase are making binaries large?", "body": "<p>There is also AMAP, a small and easy gui to view .map files: <a href=\"http://www.sikorskiy.net/prj/amap/\" rel=\"nofollow noreferrer\">http://www.sikorskiy.net/prj/amap/</a></p>\n\n<p>It would have been nice to have a kdirstat-like tool that lets you visually compare symbol sizes.</p>\n\n<p>Although not a direct answer to the question, I ended up using Voidware's CORDIC implementation to avoid using the large functions in <code>&lt;math.h&gt;</code>: <a href=\"https://github.com/enthdegree/cordic_wrapped\" rel=\"nofollow noreferrer\">https://github.com/enthdegree/cordic_wrapped</a></p>\n"}], "owner": {"reputation": 956, "user_id": 695984, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/786df6016cd1358b1e72c83cbaf18bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Chapman", "link": "https://stackoverflow.com/users/695984/christian-chapman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2347, "favorite_count": 1, "accepted_answer_id": 52734552, "answer_count": 3, "score": 24, "last_activity_date": 1542086088, "creation_date": 1539155100, "question_id": 52734501, "link": "https://stackoverflow.com/questions/52734501/what-parts-of-the-codebase-are-making-binaries-large", "title": "What parts of the codebase are making binaries large?", "body": "<p>I have built some code for a simulator and am now trying to use TI's free toolchain to cross-compile to a target with 64kb of nvram. The compiler claims that my code is about 34kb beyond the ROM:</p>\n\n<pre><code>(...) msp430-elf/bin/ld: region `ROM' overflowed by 33716 bytes\n</code></pre>\n\n<p>Another line says it cannot fit the <code>.text</code> field into its allotted space. I cannot believe that my additions are 34kb in total, let alone causing the binaries to overflow by this amount. </p>\n\n<ul>\n<li>The .o files my code has added to the project are a small fraction (200kb of the 1.9MB) of the project's total, and I have taken out a great deal of components that were in the project to begin with.</li>\n<li>I am already passing the compiler the <code>-Os -s</code> flags. </li>\n<li>The new code has about 100 characters worth of string literals.</li>\n<li>My code uses many <code>math.h</code> functions (in fact it is the only part that does floating point arithmetic), make a call to <code>strtod</code>, and make a call to <code>sprintf</code></li>\n</ul>\n\n<p>Are there any tools or methods to breaks down what is causing the binaries to be so large?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1539153868, "post_id": 52733978, "comment_id": 92393036, "body": "You need to have one more index variable (<code>j</code>) to for copying."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1539153997, "post_id": 52733978, "comment_id": 92393090, "body": "What is <code>full_len</code> ? what is <code>word</code> ? Please provide a complete code example."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1539155377, "post_id": 52733978, "comment_id": 92393790, "body": "Consider a string like &quot;a_very_new_and_exciting_string&quot;. What should it convert to? Place the original and the converted string one under another. What can you say about offsets between their corresponding characters?"}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1539155685, "last_edit_date": 1539155685, "creation_date": 1539154862, "answer_id": 52734438, "question_id": 52733978, "link": "https://stackoverflow.com/questions/52733978/how-do-i-convert-an-underscored-pointer-to-a-char-array-into-camelcasing/52734438#52734438", "title": "How do I convert an underscored pointer to a char array into camelCasing?", "body": "<p>You are not handling the removing <code>_</code> properly for that you need one more loop index(<code>j</code>).</p>\n\n<p>And you don't need one more loop to remove the non alpha numeric chars it can be done with <code>_</code> loop only,\nalso you need to terminate the <code>string</code> once trimming is completed otherwise your <code>string</code> will have junk chars.</p>\n\n<pre><code>void toCamelCase(char* phrase){\n    int j=0;\n    for (int i=0;i&lt;strlen(phrase);i++){\n\n        if(phrase[i] != '_' &amp;&amp; isalnum(phrase[i])){ //Copy Alpha numeric chars not including _.\n            phrase[j++] = phrase[i];\n        }\n        else if(phrase[i] == '_'){\n            phrase[j++] = toupper(phrase[i+1]);\n            i++;\n        }\n     }\n      phrase[j] = '\\0'; //Terminate the string\n }\n</code></pre>\n\n<blockquote>\n  <p>Note::This method does not handle consecutive <code>_</code>(<code>word____string</code>).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539180795, "post_id": 52734546, "comment_id": 92409161, "body": "The <code>continue;</code> doesn&#39;t provide much benefit since if it is omitted, the code will continue on the next cycle of the loop anyway."}], "tags": [], "owner": {"reputation": 351, "user_id": 10412218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad1ce79320e48f9e0b4b341d38cc551?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan N.", "link": "https://stackoverflow.com/users/10412218/bogdan-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1539161856, "last_edit_date": 1539161856, "creation_date": 1539155269, "answer_id": 52734546, "question_id": 52733978, "link": "https://stackoverflow.com/questions/52733978/how-do-i-convert-an-underscored-pointer-to-a-char-array-into-camelcasing/52734546#52734546", "title": "How do I convert an underscored pointer to a char array into camelCasing?", "body": "<p>Maybe something like this might help :</p>\n\n<pre><code>void toCamelCase(char* phrase){\n    int length = strlen(phrase);\n    int res_ind = 0; \n    for (int i = 0; i &lt; length ; i++) { \n        // check for underscore in the sentence \n        if (phrase[i] == '_') { \n            // conversion into upper case \n            phrase[i + 1] = toupper(s[i + 1]); \n            continue; \n        } \n        // If not space, copy character  \n        else \n            phrase[res_ind++] = s[i];         \n    } \n    phrase[res_ind] = '\\0'; \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539179724, "post_id": 52734712, "comment_id": 92408491, "body": "The <code>(int)</code> cast in <code>str[k] = toupper((int)str[++k]);</code> isn&#39;t protection against accented characters with a signed plain <code>char</code> type (character values which convert to a negative <code>int</code> when promoted).  You need to cast to <code>(unsigned char)</code>.  Casting to <code>int</code> leaves the negative character value as a negative integer value, and the only negative value that can be passed safely is EOF."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 2, "last_activity_date": 1539237876, "last_edit_date": 1539237876, "creation_date": 1539155957, "answer_id": 52734712, "question_id": 52733978, "link": "https://stackoverflow.com/questions/52733978/how-do-i-convert-an-underscored-pointer-to-a-char-array-into-camelcasing/52734712#52734712", "title": "How do I convert an underscored pointer to a char array into camelCasing?", "body": "<p>All other solutions presented so far turn <code>\"_\"</code> into an empty string and remove <code>_</code> from the end of the string.</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;ctype.h&gt;\n\nvoid to_camel_case(char *str)  // pun_intended\n{\n    for (size_t i = 0, k = 0; str[i]; ++i, ++k)\n    {\n        while (k &amp;&amp; str[k] == '_' &amp;&amp; str[k + 1])                           // 1)\n            str[k] = k - 1 ? toupper((char unsigned)str[++k]) : str[++k];  // 2)\n        str[i] = str[k];\n    }\n}\n</code></pre>\n\n<ol>\n<li>Skip consecutive <code>'_'</code>. Make sure to leave at least one at the beginning and one at the end of the string if present.<br /></li>\n<li>Replace <code>'_'</code> with the next character, capitalized if needed.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "is_accepted": false, "score": 0, "last_activity_date": 1539158734, "last_edit_date": 1539158734, "creation_date": 1539157717, "answer_id": 52735190, "question_id": 52733978, "link": "https://stackoverflow.com/questions/52733978/how-do-i-convert-an-underscored-pointer-to-a-char-array-into-camelcasing/52735190#52735190", "title": "How do I convert an underscored pointer to a char array into camelCasing?", "body": "<p>Note that in your current implementation you are trying to use <code>new</code> character array to store the processed string but you won't be able to use it outside that function since it is local variable and its end of life is the very moment the flow exits that function.</p>\n\n<p>Here is my proposal for such function:</p>\n\n<pre><code>#define MAX_STR_LEN 50\n\n// assuming that 'str' is a null terminated string\nvoid to_camel_case(char *str)\n{\n    int idx = 0;\n    int newIdx = 0;\n    int wasUnderscore = 0;\n\n    // just to be on the safe side\n    if (!str || strlen(str) &gt;= MAX_STR_LEN)\n        return;\n\n    while (str[idx])\n    {\n        if (str[idx] == '_')\n        {\n            idx++;\n            // no copy in this case, just raise a flag that '_' was met\n            wasUnderscore = 1;\n        }\n        else if (wasUnderscore)\n        {\n            // next letter after the '_' should be uppercased\n            str[newIdx++] = toupper(str[idx++]);\n            // drop the flag which indicates that '_' was met\n            wasUnderscore = 0;\n        }\n        else\n        {\n            // copy the character and increment the indices\n            str[newIdx++] = str[idx++];\n        }\n    }\n\n    str[newIdx] = '\\0';\n}\n</code></pre>\n\n<p>I <a href=\"https://ideone.com/CzBQru\" rel=\"nofollow noreferrer\">tested</a> it with some inputs and this is what I got:</p>\n\n<pre><code>String hello_world became helloWorld\nString hello___world became helloWorld\nString hel_lo_wo_rld__ became helLoWoRld\nString __hello_world__ became HelloWorld\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10482296, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rK4Bl0zfGtc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUvSnVBTnYHLi06vg7kgAFFfeQk0w/mo/photo.jpg?sz=128", "display_name": "Gila River", "link": "https://stackoverflow.com/users/10482296/gila-river"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 4, "score": -5, "last_activity_date": 1539237876, "creation_date": 1539153133, "last_edit_date": 1539196618, "question_id": 52733978, "link": "https://stackoverflow.com/questions/52733978/how-do-i-convert-an-underscored-pointer-to-a-char-array-into-camelcasing", "title": "How do I convert an underscored pointer to a char array into camelCasing?", "body": "<p>I am trying to write a function that will convert a \"word_string\" to \"wordString\". However, my output from the code below is \"wordSttring\". I'm having trouble skipping to the next element of the array after I replace the undescore with the uppercase of the next element. Any suggestions?</p>\n\n<hr>\n\n<pre><code>void convert_to_camel(char* phrase){\nint j =0;\nfor(int i=0;i&lt;full_len-1;i++){\n    if(isalphanum(phrase[i])){\n        phrase[j] = phrase[i];\n        j++;\n        length++;\n    }\n}\nint flag = 0;\nchar new[50];\nfor (int i=0;i&lt;length;i++){\n\n    if(phrase[i]== '95'){\n        flag = 1;\n    }\n    if(flag ==1){\n        new[i] = toUpper(phrase[i+1]);\n        i++;\n        new[i] = phrase[i+1];\n        flag = 0;\n    }\n    else{\n        new[i] = phrase[i];\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "character-encoding", "mainframe", "3270"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1539153725, "post_id": 52733821, "comment_id": 92392985, "body": "TN3270 is a terminal, not a make  of mainframe. Try printing character codes of your <code>pc_regexpInt</code> string."}, {"owner": {"reputation": 49, "user_id": 7630079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a52363d3a17d8838559bb91231cae0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Agrawal", "link": "https://stackoverflow.com/users/7630079/s-agrawal"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539157824, "post_id": 52733821, "comment_id": 92395130, "body": "yes TN3270 is a terminal, what I mean I am using it with mainframe. And printing character codes, you mean ASCII code for each character including &#39;[&#39;. &#39;{&#39; ?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1539157961, "post_id": 52733821, "comment_id": 92395206, "body": "Well I have no idea if your mainframe uses ASCII. I mean printing each character in the string as an integer."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1539158522, "post_id": 52733821, "comment_id": 92395532, "body": "When looking at <a href=\"https://en.wikipedia.org/wiki/IBM_3270#Technical_Information\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/IBM_3270#Technical_Information</a> I can&#39;t find the characters []{} in the character set, maybe that&#39;s the problem here?"}, {"owner": {"reputation": 589, "user_id": 9996677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13449a17a4c18ed091939cf1b501c185?s=128&d=identicon&r=PG", "display_name": "meat", "link": "https://stackoverflow.com/users/9996677/meat"}, "edited": false, "score": 0, "creation_date": 1539179393, "post_id": 52733821, "comment_id": 92408289, "body": "Based on the snippet, <code>-3.1415</code> would not pass the regular expression anyway. One thing you could do is verify that the encoding of the input matches the source encoding by printing out the numeric value of each character."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 2, "creation_date": 1539179767, "post_id": 52733821, "comment_id": 92408521, "body": "Worst case you can use <a href=\"https://en.wikipedia.org/wiki/Digraphs_and_trigraphs\" rel=\"nofollow noreferrer\">digraphs</a>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1539186351, "post_id": 52733821, "comment_id": 92412726, "body": "I think you can create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> with just a <code>puts()</code> to demonstrate this - you don&#39;t need most of that code (but you <i>do</i> need a <code>main()</code>)."}, {"owner": {"reputation": 2882, "user_id": 6943197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbce82fcea72325bc7cc3f874b5cf3ab?s=128&d=identicon&r=PG", "display_name": "Hogstrom", "link": "https://stackoverflow.com/users/6943197/hogstrom"}, "edited": false, "score": 0, "creation_date": 1539214040, "post_id": 52733821, "comment_id": 92424492, "body": "What emulator are you using ?"}], "answers": [{"tags": [], "owner": {"reputation": 622, "user_id": 3512964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63aacbbdac4e381c6ce2f105b67a022?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin McKenzie", "link": "https://stackoverflow.com/users/3512964/kevin-mckenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1539179350, "creation_date": 1539179350, "answer_id": 52741788, "question_id": 52733821, "link": "https://stackoverflow.com/questions/52733821/string-regular-expression-characters-replaced-by-spaces-on-ma/52741788#52741788", "title": "String/Regular expression characters &#39;[&#39;, &#39;]&#39;, &#39;{&#39;, &#39;}&#39; replaced by spaces on Mainframe TN3270 (with code page 1047,1147,500,249) in C language", "body": "<p>TN3270 is a protocol for connecting to z/OS and other operating systems.  I'm assuming you're using z/OS, here.  z/OS, in general, uses EBCDIC, not ASCII, for character encodings.  As @Ctx says, different character sets have different mappings, and the TN3270 client needs to be using the appropriate mapping, along with the host system.  </p>\n\n<p>So you need to be using a code page with {, }, (, and ) in it.  Code page 1047 is often used for this.  But you need to make sure that you're using it on both the host system, probably set through ISPF option 0, and in your client, which could be done a variety of different ways.  See <a href=\"https://www.askthezoslady.com/tag/setting-tso-code-page/\" rel=\"nofollow noreferrer\">https://www.askthezoslady.com/tag/setting-tso-code-page/</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 2882, "user_id": 6943197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbce82fcea72325bc7cc3f874b5cf3ab?s=128&d=identicon&r=PG", "display_name": "Hogstrom", "link": "https://stackoverflow.com/users/6943197/hogstrom"}, "is_accepted": false, "score": 2, "last_activity_date": 1539230336, "creation_date": 1539230336, "answer_id": 52751983, "question_id": 52733821, "link": "https://stackoverflow.com/questions/52733821/string-regular-expression-characters-replaced-by-spaces-on-ma/52751983#52751983", "title": "String/Regular expression characters &#39;[&#39;, &#39;]&#39;, &#39;{&#39;, &#39;}&#39; replaced by spaces on Mainframe TN3270 (with code page 1047,1147,500,249) in C language", "body": "<p>There are a few factors at play.  The code page of the editor in ISPF (if that is what you are using), the terminal setup for the 3270 session in ISPF and the code page for the code your running.</p>\n\n<p>For 3270 I find that using codepage Codepage 1047 works for me.  That code page maps the open and close brackets to 0xAD <code>[</code> and 0xBD <code>]</code> respectively.  There are a variety of other code pages but they are generally mapped for the coding needs of locales that need other characters to Latin-1.</p>\n\n<p>Setting up the code page for the emulator.  For example, I use HostOnDemand by selecting the properties on the session and then:\n<a href=\"https://i.stack.imgur.com/aT2kC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aT2kC.png\" alt=\"Setting 1047 Code page for terminal session\"></a></p>\n\n<p>Next you need ISPF setup.  This is choosing a terminal type that supports the brackets.  In ISPF set your terminal type to 3277A by selection Menu -> Settings.\n<a href=\"https://i.stack.imgur.com/Z4clN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z4clN.png\" alt=\"This screen shows the options in place for my session.  Note that I selected number 2\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tJwl1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tJwl1.png\" alt=\"Showing the brackets correctly displayed.\"></a></p>\n\n<p>The final piece is the your setup for C and its Locale.  Found this <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.cbcpx01/ispfedt.htm\" rel=\"nofollow noreferrer\">reference</a> that should help get you through the last pieces.</p>\n"}], "owner": {"reputation": 49, "user_id": 7630079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a52363d3a17d8838559bb91231cae0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Agrawal", "link": "https://stackoverflow.com/users/7630079/s-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539230336, "creation_date": 1539152472, "last_edit_date": 1539186243, "question_id": 52733821, "link": "https://stackoverflow.com/questions/52733821/string-regular-expression-characters-replaced-by-spaces-on-ma", "title": "String/Regular expression characters &#39;[&#39;, &#39;]&#39;, &#39;{&#39;, &#39;}&#39; replaced by spaces on Mainframe TN3270 (with code page 1047,1147,500,249) in C language", "body": "<p>I have created a function in C language for identifying the integer with some conditions using regex.\nThe regex expression is working fine on UNIX and other platform, but when I used the same piece of code on Mainframe TN3270, characters in string/regular expression like '[', ']', '{', '}' are replaced by spaces during compilation.\nI tried using '\\' before all these characters and , REG_EXTENDED during regcomp, but no change in result.</p>\n\n<pre><code>int VALNUM ()\n{                                        \n   regex_t s_regex, *ps_regex = &amp;s_regex;\n   char pc_regexpInt[ ] = \"^[+-]{0,1}[0-9]{1,} *\";\n   printf(\"pc_regexpInt value:%s\\n\",pc_regexpInt);\n   regcomp(ps_regex, pc_regexpInt, REG_EXTENDED)\n   regexec(ps_regex, pc_buffer, 0, NULL, 0);\n   regfree(ps_regex);\n}\n</code></pre>\n\n<p>For me the printf returns:</p>\n\n<pre><code>pc_regexpInt value:^ +-  0,1  0-9  1,  *\n</code></pre>\n\n<p>And regexec also failed for the pc_buffer value like (+120 or -3.1415).</p>\n\n<p>Note: There is no issue with code compilation, here I have just written a piece of my code. The declaration and all are missing here, that's not an issue.</p>\n\n<p>Anyone please suggest.</p>\n"}, {"tags": ["c", "cmake", "clion"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539152044, "post_id": 52733663, "comment_id": 92392199, "body": "Unrelated to your problem (perhaps) but if you include a source file into another source file, then you&#39;re probably doing something wrong."}, {"owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1539152248, "post_id": 52733663, "comment_id": 92392301, "body": "@Someprogrammerdude you are most certainly right but unfortunately this is not something I programmed and I would like to change it as little as I can. The original developer did this so he/she could easily generate different targets with various versions of a.c while keeping the same b.c"}], "answers": [{"comments": [{"owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "edited": false, "score": 0, "creation_date": 1539267810, "post_id": 52735850, "comment_id": 92447961, "body": "This does not really provide an answer to my question, but, yes, I agree: this what the original developer should have done (you would be surprised, he is from a well-known shop :)). Thus, +1"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "edited": false, "score": 0, "creation_date": 1539327120, "post_id": 52735850, "comment_id": 92469538, "body": "Ah, you wanted IDE to provide identifier info even if it is not related for the current translation unit? Well, &quot;real&quot; IDEs like Clion, MSVC and KDevelop are trying hard to specifically not provide info for symbols that aren&#39;t defined in the current TU. For instance, even <code>printf</code> would be undefined if <code>&lt;stdio.h&gt;</code> isn&#39;t included. On the contrary, VS Code is just an advanced text editor, and it doesn&#39;t fully understand code semantics, so it just shows whatever info it has."}, {"owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "edited": false, "score": 0, "creation_date": 1539342730, "post_id": 52735850, "comment_id": 92478083, "body": "Yes. That is right. I take your comment as an answer (that it is not doable with CLion) and then award it to you. Thanks"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 1, "last_activity_date": 1539161041, "last_edit_date": 1539161041, "creation_date": 1539160170, "answer_id": 52735850, "question_id": 52733663, "link": "https://stackoverflow.com/questions/52733663/clion-fixing-an-undefined-identifier/52735850#52735850", "title": "clion: fixing an undefined identifier", "body": "<p>This identifier is not defined for <code>b.c</code>, obviously. And it is rather strange to include <code>.c</code> file.</p>\n\n<p>What you probably want is <code>a.h</code> file with following contents:</p>\n\n<pre><code>#ifndef _A_H\n#define _A_H\n\n#define A 1\n\n#endif // _A_H\n</code></pre>\n\n<p>And then use <code>#include \"a.h\"</code> in both <code>a.c</code> and <code>b.c</code>.</p>\n"}], "owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 52735850, "answer_count": 1, "score": 0, "last_activity_date": 1539346685, "creation_date": 1539151840, "last_edit_date": 1539346685, "question_id": 52733663, "link": "https://stackoverflow.com/questions/52733663/clion-fixing-an-undefined-identifier", "title": "clion: fixing an undefined identifier", "body": "<p>I have inherited a C project using make and I am no expert in either cmake or Clion</p>\n\n<p>I have a file a.c</p>\n\n<pre><code>#define A 1\n#include \"b.c\"\n</code></pre>\n\n<p>b.c</p>\n\n<pre><code>int i=A*3; //&lt;=== undefined identifier A here in Clion\n</code></pre>\n\n<p>This compiles fine with simple CMake file</p>\n\n<pre><code>add_library(myLib a.c)\n</code></pre>\n\n<p>How do I tell Clion that identifier <code>A</code> is defined in a.c when editing b.c</p>\n\n<p><strong>Note</strong></p>\n\n<p>VSCode seems a bit \"smarter\": editing both a.c and b.c at the same time will have b.c use the identifier defined in a.c. Still, I would appreciate a CLion solution, if any.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1539151125, "post_id": 52733459, "comment_id": 92391793, "body": "@Someprogrammerdude: OP didn&#39;t invent those double-underscore names--they are names decided by the implementation.  So it&#39;s all good."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1539151238, "post_id": 52733459, "comment_id": 92391838, "body": "See <a href=\"https://stackoverflow.com/questions/3025050/error-initializer-element-is-not-constant-when-trying-to-initialize-variable-w\" title=\"error initializer element is not constant when trying to initialize variable w\">stackoverflow.com/questions/3025050/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/23040769/initializer-not-constant-on-global-variable\" title=\"initializer not constant on global variable\">stackoverflow.com/questions/23040769/&hellip;</a>"}, {"owner": {"reputation": 176, "user_id": 3130072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25bc899ee1fdc2a1febc60b124aa90?s=128&d=identicon&r=PG", "display_name": "katamaster818", "link": "https://stackoverflow.com/users/3130072/katamaster818"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1539151590, "post_id": 52733459, "comment_id": 92391991, "body": "@JohnZwinck I actually think I looked at one of these already - correct me if I am wrong, but it seems as though these suggest two solutions: 1) I can have an initializer method, or 2) I can use #define to make it a constant. I&#39;m struggling with understanding how to apply either of these to this specific scenario as I don&#39;t think I can have an init method for compiler prehooks? And I can&#39;t seem to understand how to create a struct using #define, I have spent the last half hour trying to do this unsuccessfully."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539151950, "post_id": 52733459, "comment_id": 92392143, "body": "Maybe you&#39;re looking for C++ \u2014 it allows you to use functions in initializers at global scope."}, {"owner": {"reputation": 176, "user_id": 3130072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25bc899ee1fdc2a1febc60b124aa90?s=128&d=identicon&r=PG", "display_name": "katamaster818", "link": "https://stackoverflow.com/users/3130072/katamaster818"}, "edited": false, "score": 0, "creation_date": 1539152070, "post_id": 52733459, "comment_id": 92392223, "body": "This assignment must be completed in C, so I don&#39;t think that&#39;s the way I&#39;m supposed to go with this."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1539152254, "post_id": 52733459, "comment_id": 92392303, "body": "Since you&#39;re already using GCC specific constructs (<code>__attribute__</code>) then perhaps to create a &quot;constructor&quot; function that will be called before <code>main</code> and could do any initialization you need? See <a href=\"https://gcc.gnu.org/onlinedocs/gcc-8.2.0/gcc/Common-Function-Attributes.html#Common-Function-Attributes\" rel=\"nofollow noreferrer\">this list of common function attributes</a> for more information about it."}, {"owner": {"reputation": 176, "user_id": 3130072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25bc899ee1fdc2a1febc60b124aa90?s=128&d=identicon&r=PG", "display_name": "katamaster818", "link": "https://stackoverflow.com/users/3130072/katamaster818"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1539153948, "post_id": 52733459, "comment_id": 92393072, "body": "@Someprogrammerdude Thanks, this actually worked really well, was exactly what I was looking for!"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1539151947, "post_id": 52733638, "comment_id": 92392140, "body": "I think to solve OPs problem (lack of an init function) you need to help design the time/location to execute the malloc() call."}, {"owner": {"reputation": 176, "user_id": 3130072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25bc899ee1fdc2a1febc60b124aa90?s=128&d=identicon&r=PG", "display_name": "katamaster818", "link": "https://stackoverflow.com/users/3130072/katamaster818"}, "edited": false, "score": 0, "creation_date": 1539152037, "post_id": 52733638, "comment_id": 92392191, "body": "This solution doesn&#39;t seem to help resolve the problem unfortunately..."}], "tags": [], "owner": {"reputation": 81, "user_id": 8879320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CBgrrXDuNsU/AAAAAAAAAAI/AAAAAAAAEQE/aZ6Mj7sr5pw/photo.jpg?sz=128", "display_name": "NeRa", "link": "https://stackoverflow.com/users/8879320/nera"}, "is_accepted": false, "score": 0, "last_activity_date": 1539152279, "last_edit_date": 1539152279, "creation_date": 1539151719, "answer_id": 52733638, "question_id": 52733459, "link": "https://stackoverflow.com/questions/52733459/initializer-element-is-not-constant-when-trying-to-declare-a-global-struct/52733638#52733638", "title": "Initializer element is not constant when trying to declare a global struct", "body": "<p>In C you can't call a function when initialising a variable in file or global scope.</p>\n\n<p>You should be calling <code>malloc</code> to allocate some memory for you, something like this:</p>\n\n<pre><code>static stack_t* entry_times = NULL;\n\nentry_times = (stack_t*)malloc(500 * sizeof(stack_t));\n</code></pre>\n\n<p>That will give you 500 instances of <code>stack_t</code>.</p>\n\n<p>You need to <code>free</code> when you no longer need the memory.</p>\n\n<p>EDIT:</p>\n\n<p>Here is my solution for your problem - not pretty but if you only have those two functions, you are quite restricted...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include \"mystack.h\"\n\nstatic stack_t* entry_times=NULL;\nstatic unsigned int count_entered=0;\nstatic unsigned int count_completed=0;\n\n\n__attribute__((no_instrument_function))\nvoid __cyg_profile_func_enter(void *this_fn, void *call_site){\n    if (entry_times == NULL) {\n        entry_times = (stack_t *)malloc(500 * sizeof(stack_t));\n    }\n    count_entered++;\n    time_t start_time;\n    time(&amp;start_time);\n    stack_enqueue(entry_times, start_time);\n    printf(\"Total Functions Entered: %d\\n\", count_entered);\n\n}\n\n__attribute__((no_instrument_function))\nvoid __cyg_profile_func_exit(void *this_fn, void *call_site){\n\n    time_t end_time;\n    time(&amp;end_time);\n    time_t start_time = stack_dequeue(entry_times);\n    double difference = difftime(end_time, start_time);\n    count_completed++;\n    if (entry_times != NULL) {\n        free(entry_times);\n        entry_times = NULL;\n    }\n    printf(\"Time in Function: %d\\n\", difference);\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 176, "user_id": 3130072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25bc899ee1fdc2a1febc60b124aa90?s=128&d=identicon&r=PG", "display_name": "katamaster818", "link": "https://stackoverflow.com/users/3130072/katamaster818"}, "edited": false, "score": 0, "creation_date": 1539153998, "post_id": 52733777, "comment_id": 92393091, "body": "The first solution worked for me! Thank you so much!"}], "tags": [], "owner": {"reputation": 1607, "user_id": 1068165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28f9e838ea9db914cd65de2c1a1a938?s=128&d=identicon&r=PG", "display_name": "Mindaugas", "link": "https://stackoverflow.com/users/1068165/mindaugas"}, "is_accepted": true, "score": 3, "last_activity_date": 1539152294, "creation_date": 1539152294, "answer_id": 52733777, "question_id": 52733459, "link": "https://stackoverflow.com/questions/52733459/initializer-element-is-not-constant-when-trying-to-declare-a-global-struct/52733777#52733777", "title": "Initializer element is not constant when trying to declare a global struct", "body": "<p>Why you are getting error is explained in John Zwinck's links, but how to solve it for you, it depends. You could create constructor function which does initialisation for you e.g.</p>\n\n<pre><code>static stack_t* entry_times;\n__attribute__((constructor))\nvoid my_init(){\n    entry_times=create_stack(500);\n}\n</code></pre>\n\n<p>or you could create a wrapper function around it </p>\n\n<pre><code>stack_t* my_entry_times(){\n    static stack_t* entry_times;\n    if (!entry_times) {\n        entry_times=create_stack(500);\n    }\n    return entry_times;\n}\n</code></pre>\n\n<p>and use <code>my_entry_times()</code> instead of <code>entry_times</code> in code</p>\n"}], "owner": {"reputation": 176, "user_id": 3130072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25bc899ee1fdc2a1febc60b124aa90?s=128&d=identicon&r=PG", "display_name": "katamaster818", "link": "https://stackoverflow.com/users/3130072/katamaster818"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 52733777, "answer_count": 2, "score": 0, "last_activity_date": 1539152294, "creation_date": 1539150911, "last_edit_date": 1539151160, "question_id": 52733459, "link": "https://stackoverflow.com/questions/52733459/initializer-element-is-not-constant-when-trying-to-declare-a-global-struct", "title": "Initializer element is not constant when trying to declare a global struct", "body": "<p>I am currently a Java programmer doing some work in C for a class, and I've been struggling a lot with the differences between the two. Currently, I am trying to add functionality with compiler hooks to count the time that is spent within each function of the program that is being executed. My struggle for this is that my solution is to use a stack, and I'm having trouble instantiating (if that's even the right word to use?) the stack since I can't add a main method or something of that sort to create it at the beginning. Here is my code now:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include \"mystack.h\"\n\nstatic stack_t* entry_times=create_stack(500);\nstatic unsigned int count_entered=0;\nstatic unsigned int count_completed=0;\n\n\n__attribute__((no_instrument_function))\nvoid __cyg_profile_func_enter(void *this_fn, void *call_site){\n    count_entered++;\n    time_t start_time;\n    time(&amp;start_time);\n    stack_enqueue(entry_times, start_time);\n    printf(\"Total Functions Entered: %d\\n\", count_entered);\n\n}\n\n__attribute__((no_instrument_function))\nvoid __cyg_profile_func_exit(void *this_fn, void *call_site){\n\n    time_t end_time;\n    time(&amp;end_time);\n    time_t start_time = stack_dequeue(entry_times);\n    double difference = difftime(end_time, start_time);\n    count_completed++;\n    printf(\"Time in Function: %d\\n\", difference);\n\n}\n</code></pre>\n\n<p>Right now, when I try to compile this code, I am getting a \"initializer element is not constant\" error point to the line where I create my entry_times stack. How can I solve this error, or refactor my code to prevent this issue?</p>\n\n<p>I'm sorry if this is a duplicate topic, I have done a fair amount of searching, and I suspect I simply do not know what to actually search for to find the information that I am looking for.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 3, "creation_date": 1539150308, "post_id": 52733310, "comment_id": 92391460, "body": "<code>sum, sizeof(double);</code>, <code>sum = +grade;</code>, etc: much weirdness.  What the heck are you trying to accomplish here???"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1539150428, "post_id": 52733310, "comment_id": 92391509, "body": "You are prematurely returning from the function in the <code>else</code> condition."}, {"owner": {"reputation": 11, "user_id": 10482193, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6EjBDatD32s/AAAAAAAAAAI/AAAAAAAAACs/G-MAyMchxE8/photo.jpg?sz=128", "display_name": "Chris Schmierer", "link": "https://stackoverflow.com/users/10482193/chris-schmierer"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1539150706, "post_id": 52733310, "comment_id": 92391636, "body": "@paulsm4 the type cast is in order to not have a type mismatch when calculating the average, the sum is increased by grade each time that part of the code is reached. I&#39;m trying to create a program that continually asks for grades adds those grades to sum and increases count by one each time a new grade runs through, then is terminated when -1 is input."}, {"owner": {"reputation": 11, "user_id": 10482193, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6EjBDatD32s/AAAAAAAAAAI/AAAAAAAAACs/G-MAyMchxE8/photo.jpg?sz=128", "display_name": "Chris Schmierer", "link": "https://stackoverflow.com/users/10482193/chris-schmierer"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1539150774, "post_id": 52733310, "comment_id": 92391664, "body": "@TimBiegeleisen how so? the else condition is only returned from prematurely if an incorrect value is an input, otherwise, there is no other way to leave the loop besides letting it run out."}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 3, "creation_date": 1539151223, "post_id": 52733310, "comment_id": 92391833, "body": "<code>sum, sizeof(double)</code> is an expression that does not have any effect. The compiler does not even generate code for it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1539152378, "post_id": 52733310, "comment_id": 92392349, "body": "The same holds true for <code>count, sizeof(double);</code> ??  Time for a talk with the rubber-duck, see <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\"><b>How to debug small programs</b></a> -- really, it helps..."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1539152390, "post_id": 52733310, "comment_id": 92392355, "body": "Do you successfully scan for grade? Is the returnvalue of <code>scanf()</code> as expected? I.e. does it indicate 1 successfully scanned variable?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1539152559, "post_id": 52733310, "comment_id": 92392454, "body": "<code>void calculateAverage()</code> does not allow to return any value. You do return a value here <code>return count;</code> and futily attempt to return a second value here <code>return sum;</code>. Where do you expect those values to go? Are you aware that you only can return one value (even if the function head DOES allow it?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1539152568, "post_id": 52733310, "comment_id": 92392459, "body": "May also be very helpful to separate your <i>input</i> routines from your <code>calculateAverage</code> function. Handle your input either in <code>main()</code> or in a separate function and pass an array of values and the number of values as parameters to <code>calculateAverage</code>. That allows separate validation of your input before attempting to manipulate the values. Short functions that do a single-job help keep your logic and error handling straight."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1539152707, "post_id": 52733310, "comment_id": 92392526, "body": "You intend this <code>coolvalue = 1;</code> to end the loop. Then when do you expect it to be executed? It seems to be outside of the loop."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1539159075, "post_id": 52733310, "comment_id": 92395849, "body": "@ChrisSchmierer - understand that none of these are dings to you, but a collection of advise and suggestions as well as a dissection of your posted code to help you understand how to approach coding (beyond which functions do what -- you can get that from the man-pages). The read gems are understanding the thought-process of &quot;How do I approach a project that I haven&#39;t done, of feel uncomfortable doing. As with all, start with the basics, compile with <i>warnings enabled</i>, and do not accept code until it compiles without warning (you will learn as much from your compiler as you will from a book"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1539152725, "post_id": 52733846, "comment_id": 92392535, "body": "Yep, that about covers it, aside from not checking the return of <code>scanf</code>, so there is little assurance of processing valid data before the remainder of issues are hit."}], "tags": [], "owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": false, "score": 4, "last_activity_date": 1539153734, "last_edit_date": 1592644375, "creation_date": 1539152565, "answer_id": 52733846, "question_id": 52733310, "link": "https://stackoverflow.com/questions/52733310/why-are-my-values-for-sum-and-count-being-lost-each-loop/52733846#52733846", "title": "Why are my values for sum and count being lost each loop?", "body": "<p>There are multiple issues in your code.</p>\n<p><code>scanf(&quot;%d&quot;, &amp;grade);</code> - you don't check the value returned by <code>scanf()</code>. It returns the number of values successfully read. If you enter a string of letters instead of a number, <code>scanf(&quot;%d&quot;)</code> returns <code>0</code> and it does not change the value of <code>grade</code>. Because of this the code will execute the rest of the loop using the previous value of <code>grade</code>. You should restart the loop if the value returned by <code>scanf()</code> is not <code>1</code>:</p>\n<pre><code>if (scanf(&quot;%d&quot;, &amp;grade) != 1) {\n    continue;\n}\n</code></pre>\n<p>Assuming you enter <code>10</code> for <code>grade</code> this block of code executes:</p>\n<pre><code>sum = +grade;\ncount = count + 1;\nreturn count;\nreturn sum;\n</code></pre>\n<ul>\n<li><p><code>sum = +grade</code> is the same as <code>sum = grade</code>. The <code>+</code> sign in front of <code>grade</code> doesn't have any effect. It is just the same as <code>0 + grade</code>.</p>\n<p>You want to add the value of <code>grade</code> to <code>sum</code> and it should be <code>sum += grade</code>. This is a shortcut of <code>sum = sum + grade</code>.</p>\n</li>\n<li><p><code>return count</code> makes the function complete and return the value of <code>count</code> (which is <code>1</code> at this point) to the caller. The caller is the function <code>main()</code> but it doesn't use the return value in any way. Even more, your function is declared as returning <code>void</code> (i.e. nothing) and this renders <code>return count</code> incorrect (and the compiler should warn you about this).</p>\n</li>\n<li><p><code>return sum</code> is never executed (the compiler should warn you about it being dead code) because the function completes and the execution is passed back to the caller because of the <code>return count</code> statement above it.</p>\n<p>Remove both <code>return</code> statements. They must not stay here.</p>\n</li>\n</ul>\n<p>If you enter <code>-1</code> for <code>grade</code>, this block of code is executed:</p>\n<pre><code>sum, sizeof(double);\ncount, sizeof(double);\naverage = (sum / count);\nprintf(&quot;%lf&quot;, &amp;average);\nbreak;\n</code></pre>\n<ul>\n<li><p><code>sum, sizeof(double)</code> is an expression that does not have any effect; it takes the value of <code>sum</code> then discards it then takes the value of <code>sizeof(double)</code> (which is a constant) and discards it too. The compiler does not even generate code for it.</p>\n</li>\n<li><p>the same as above for <code>count, sizeof(double)</code>;</p>\n</li>\n<li><p><code>average = (sum / count);</code>:</p>\n<ul>\n<li><p>the parenthesis are useless;</p>\n</li>\n<li><p>because both <code>sum</code> and <code>count</code> are integers, <code>sum / count</code> is also an integer (the integral result of <code>sum / count</code>, the remainder is ignored).</p>\n<p>you declared <code>average</code> as <code>double</code>; to get a <code>double</code> result you have to cast one of the values to <code>double</code> on the division: <code>average = (double)sum / count;</code></p>\n</li>\n<li><p>if you enter <code>-1</code> as the first value when the program starts, <code>count</code> is <code>0</code> when this code is executed and the division fails (division by zero).</p>\n</li>\n</ul>\n</li>\n<li><p><code>printf(&quot;%lf&quot;, &amp;average);</code> - you want to print the value of <code>average</code> but you print its address in memory. Remove the <code>&amp;</code> operator; it is required by <code>scanf()</code> (to know where to put the read values). It is not required by <code>printf()</code>; the compiler generates code that passes to <code>printf()</code> the values to print.</p>\n</li>\n<li><p><code>break;</code> - it passes the execution control after the innermost <code>switch</code> or loop statement (<code>do</code>, <code>while</code> or <code>for</code>). It is correct here and makes the variable <code>coolvalue</code> useless. You can simply remove <code>coolvalue</code> and use <code>while (1)</code> instead.</p>\n</li>\n</ul>\n<p>All in all, your function should look like:</p>\n<pre><code>void calculateAverage()\n{\n    int sum = 0;\n    int count = 0;\n    int grade = 0;\n    double average = 0.0;\n\n    while (1) {\n        if (scanf(&quot;%d&quot;, &amp;grade) != 1) {\n            // Invalid value (not a number); ignore it\n            continue;\n        }\n\n        // A value of -1 signals the end of the input\n        if (grade == -1) {\n            if (count &gt; 0) {\n                // Show the average\n                average = (double)sum / count;\n                printf(&quot;Average: %lf\\n&quot;, average);\n            } else {\n                // Cannot compute the average\n                puts(&quot;You didn't enter any value. Cannot compute the average.\\n&quot;);\n            }\n            // End function\n            return;\n        }\n\n        if ((grade &lt; -1) || (100 &lt; grade)) {\n            puts(&quot;Error, incorrect input.\\n&quot;);\n            // Invalid input, ignore it\n            continue;\n        }\n\n        sum += grade;\n        count ++;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 10395587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b548dbfa2977701ebe0b35d9ed8207?s=128&d=identicon&r=PG&f=1", "display_name": "manoliar", "link": "https://stackoverflow.com/users/10395587/manoliar"}, "is_accepted": false, "score": -1, "last_activity_date": 1539157218, "creation_date": 1539157218, "answer_id": 52735051, "question_id": 52733310, "link": "https://stackoverflow.com/questions/52733310/why-are-my-values-for-sum-and-count-being-lost-each-loop/52735051#52735051", "title": "Why are my values for sum and count being lost each loop?", "body": "<p>Perhaps it is better for the function to be of type double instead of void. Although it is not my favorite solution it is close to what you want. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\ndouble  calculateAverage(void)\n    {\n        double average;\n        int sum = 0, count=0, grade;\n        while (1)\n        {           \n            scanf(\"%d\", &amp;grade);    \n            if ((grade &gt; 100) || (grade &lt; -1))              \n                printf(\"Error, incorrect input.\\n\");    \n            else if (grade != -1)\n                {sum = sum+ grade;  count = count + 1;}             \n            else\n                break;              \n        }\n        if (count==0) \n            average=-1.0; //none valid input. Notify the main()\n        else    \n            average=(double)sum/count;\n        return average;  \n     }\n\nint main(void)\n    {\n        double result;\n        result= calculateAverage();\n        if (result!=-1.0)\n            printf(\"\\n average= %lf\",result);\n        else    \n            printf(\"No grades to calculate average\");\n        getchar();\n        return 0;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "is_accepted": false, "score": 2, "last_activity_date": 1539240001, "last_edit_date": 1539240001, "creation_date": 1539162487, "answer_id": 52736565, "question_id": 52733310, "link": "https://stackoverflow.com/questions/52733310/why-are-my-values-for-sum-and-count-being-lost-each-loop/52736565#52736565", "title": "Why are my values for sum and count being lost each loop?", "body": "<p>Quite a few corrections need to be made.</p>\n\n<ol>\n<li>The <code>while</code> loop in the <code>calculateAverage()</code> function. That's an infinite loop buddy, because you are not changing the value of that <code>coolValue</code> variable anywhere inside, instead you make it <code>1</code> only when it exits the loops, which it never will. \nSo, use <code>while(1) {...}</code>, and inside it, check for the stopping condition, i.e, <code>if (grade == -1) { ... }</code> and inside it calculate and print the <code>average</code> and <code>return</code>. This will automatically break the <code>while</code>.</li>\n<li>You're not checking if the input <code>grade</code> is actually a valid integer or not. Check the value of <code>scanf</code> for that, i.e, use <code>if (scanf(\"%d\", &amp;grade) != 1) { ... }</code></li>\n<li>The expression <code>sum = +grade;</code> is just another way of writing <code>sum = 0+grade</code> which in turn is nothing but <code>sum = grade</code>. Replace this with <code>sum += grade;</code>. This is the right way to write a shorthand for addition.</li>\n<li>Two <code>return</code> statements..a very wrong idea. First of all, a function can have just one <code>return</code>(in an obvious way I mean, at once). Secondly, the function <code>calculateAverage()</code> is of return-type <code>void</code>. there's no way how you can return <code>double</code> value from it. So remove these two statements.</li>\n</ol>\n\n<p>I have attached the code below which works. Also do go through the output which I have attached.</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid calculateAverage()\n{\n    int grade, count = 0, sum = 0;\n    double average;\n    printf(\"\\nenter the grades... enter -1 to terminate the entries\\n.\");\n    while (1) {\n        printf(\"\\nEnter the grade: \");\n        if (scanf(\"%d\", &amp;grade) != 1) {\n            printf(\"\\nInvalid characters entered!!!\");\n            continue;\n        }\n        else if(((grade &gt; 100) || (grade &lt; -1))) {\n            printf(\"\\nInvalid grade entered!!!\");\n            continue;\n        }\n        else {\n            if (grade == -1) {\n                average = sum/count;\n                printf(\"\\nAverage value of grades: %.3lf\",average);\n                return;\n            }\n            else {\n                sum += grade;\n                count++;\n            }\n        }\n    }\n}\n\nint main(void)\n{\n  calculateAverage();\n  return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT:</strong></p>\n\n<blockquote>\n  <p>enter the grades... enter -1 to terminate the entries.</p>\n  \n  <p>Enter the grade:  50</p>\n  \n  <p>Enter the grade:  100</p>\n  \n  <p>Enter the grade:  60</p>\n  \n  <p>Enter the grade:  -1</p>\n  \n  <p>Average value of grades: 70.000</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 10482193, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6EjBDatD32s/AAAAAAAAAAI/AAAAAAAAACs/G-MAyMchxE8/photo.jpg?sz=128", "display_name": "Chris Schmierer", "link": "https://stackoverflow.com/users/10482193/chris-schmierer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1539240001, "creation_date": 1539150167, "last_edit_date": 1539151013, "question_id": 52733310, "link": "https://stackoverflow.com/questions/52733310/why-are-my-values-for-sum-and-count-being-lost-each-loop", "title": "Why are my values for sum and count being lost each loop?", "body": "<p>I'm getting a consistent divide by zero error, even though each loop should be populating the variables. Code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n void calculateAverage()\n{\nint grade, count, sum;\ndouble average;\n\n\nsum = 0;\ncount = 0;\ngrade = 0;\naverage = 0.0;\nint coolvalue = 0;\n\nwhile (coolvalue==0)\n{\n    scanf(\"%d\", &amp;grade);\n    if (grade == -1)\n    {\n        sum, sizeof(double);\n        count, sizeof(double);\n        average = (sum / count);\n        printf(\"%lf\", &amp;average);\n        break;\n    }\n    else\n    {\n        if ((grade &gt; 100) || (grade &lt; -1))\n        {\n            printf(\"Error, incorrect input.\\n\");\n            break;\n        }\n        else\n        {\n            sum = +grade;\n            count = count + 1;\n            return count;\n            return sum;\n        }\n    }\n}\ncoolvalue = 1;\n}\n\nint main(void)\n{\nwhile (1)\ncalculateAverage();\n\nwhile (1) getchar();\nreturn 0;\n}\n</code></pre>\n\n<p>Even while using return, I'm not able to properly increment the value of sum or count.</p>\n"}, {"tags": ["c++", "c", "arrays", "compiler-errors", "static-initialization"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1539150146, "post_id": 52732931, "comment_id": 92391393, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1637332/static-const-vs-define\">static const vs #define</a>"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 1, "creation_date": 1539176677, "post_id": 52732931, "comment_id": 92406540, "body": "@SamuelLiew: I think you may have moved one comment too many. n.m. made a direct comment - variable-length arrays <b>are</b> valid C, in direct contradiction of the very premise of this question. (Which is unrelated to the C versus C++ discussion, which I agree belongs in chat)"}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1539149175, "post_id": 52733112, "comment_id": 92391070, "body": "They cannot be modified by the program. To even attempt it makes your program have undefined behavior."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539150487, "post_id": 52733112, "comment_id": 92391541, "body": "If a variable is const in your unit, you are not not allowed to change it, however if a extern thing can change it you can declare it as volatile but still if it&#39;s const you are not allowed yourself to change it."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1539150699, "last_edit_date": 1539150699, "creation_date": 1539148938, "answer_id": 52733112, "question_id": 52732931, "link": "https://stackoverflow.com/questions/52732931/is-it-bad-practice-to-specify-an-array-size-using-a-variable-instead-of-define/52733112#52733112", "title": "Is it bad practice to specify an array size using a variable instead of `#define` in C++? (C error: variably modified at file scope)", "body": "<p>Because <code>SIZE</code> was defined as a <code>const</code> variable. In C, unlike C++ <code>const</code> values are not <strong>true constants</strong>. They are stored in memory and can be referenced and modified indirectly (by modifying the contents in memory).  That's why, in C++ there is <code>const</code> that would allow <code>const int SIZE = 2;</code> to work, but even <code>const</code> is not enough in C.</p>\n\n<p><strong>C11-\u00a76.7.9/3:</strong></p>\n\n<blockquote>\n  <p>The type of the entity to be initialized shall be an array of unknown\n  size or a complete object type that is <strong>not a variable length array\n  type.</strong></p>\n</blockquote>\n\n<p>Preprocessor macro replace at compile time, that's why it's work fine.</p>\n\n<p>Reference Link : <a href=\"https://stackoverflow.com/a/35162075/5612562\">https://stackoverflow.com/a/35162075/5612562</a></p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1539149677, "post_id": 52733208, "comment_id": 92391239, "body": "So to answer the Q in the title: no, quite the contrary."}, {"owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "edited": false, "score": 0, "creation_date": 1539152183, "post_id": 52733208, "comment_id": 92392268, "body": "I think this thought process that &quot;<code>#define</code> is the way to go&quot; must certainly be an ingrained habit and essentially a &quot;ritualistic belief&quot; (ie: believed it is the most correct simply because one has been doing it for years) then from years of writing in pure C. For pure C, I&#39;ll use #define for array sizes, as apparently I have no other options. For embedded <i>C++</i>, I&#39;ll use <code>const</code>. Besides, I&#39;m more used to <code>const</code> and like it better anyway :) (in small part due to my own form of &quot;ritualistic belief&quot;, and in large part because of answers like this)."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "edited": false, "score": 0, "creation_date": 1539152534, "post_id": 52733208, "comment_id": 92392439, "body": "@GabrielStaples: As an embedded systems programmer who worked mainly in C, I can understand what you are saying."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 7, "last_activity_date": 1539149684, "last_edit_date": 1539149684, "creation_date": 1539149573, "answer_id": 52733208, "question_id": 52732931, "link": "https://stackoverflow.com/questions/52732931/is-it-bad-practice-to-specify-an-array-size-using-a-variable-instead-of-define/52733208#52733208", "title": "Is it bad practice to specify an array size using a variable instead of `#define` in C++? (C error: variably modified at file scope)", "body": "<p>It would be good to follow Scott Meyer's advice in this matter. From his book \"Effective C++\":<br>\n<strong>Item 2: Prefer consts, enums, and inlines to #defines.</strong>  </p>\n\n<p>Summary of the item adapted to your example.</p>\n\n<blockquote>\n  <p>This Item might better be called \u201cprefer the compiler to the preprocessor,\u201d\n  because <code>#define</code> may be treated as if it\u2019s not part of the language\n  per se. That\u2019s one of its problems. </p>\n  \n  <p>When you do something like this,</p>\n\n<pre><code>#define SIZE 2\n</code></pre>\n  \n  <p>the symbolic name <code>SIZE</code>  may never be seen by compilers; it\n  may be removed by the preprocessor before the source code ever gets\n  to a compiler. As a result, the name <code>SIZE</code> may not get entered\n  into the symbol table. This can be confusing if you get an error during\n  compilation involving the use of the constant, because the error message\n  may refer to <code>2</code>, not <code>SIZE</code> . If <code>SIZE</code> were\n  defined in a header file you didn\u2019t write, you\u2019d have no idea where that\n  <code>2</code> came from, and you\u2019d waste time tracking it down. This problem\n  can also crop up in a symbolic debugger, because, again, the name\n  you\u2019re programming with may not be in the symbol table.\n  The solution is to replace the macro with a constant:<br>\n  <code>const double SIZE = 2; // uppercase names are usually for macros, hence the name change</code><br>\n  As a language constant, <code>SIZE</code> is definitely seen by compilers and\n  is certainly entered into their symbol tables. </p>\n  \n  <p>\u2726 For simple constants, prefer const objects or enums to #defines.<br>\n  \u2726 For function-like macros, prefer inline functions to #defines.</p>\n</blockquote>\n\n<p>Also refer to \"Item 3: Use const whenever possible.\" for more info on its usage and exceptions to its usage.</p>\n\n<p>So to answer your question in the title:<br>\n<strong>No</strong>, it is NOT a bad practice to specify an array size using a variable instead of <code>#define</code> in C++. </p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539151023, "post_id": 52733403, "comment_id": 92391750, "body": "I share the love for <code>std::vector</code> but it is often a poor choice when writing for a lightweight embedded system where memory fragmentation is a problem. There are, of course, ways around this, but they may not be worth the effort or the neutering of <code>vector</code>."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539151190, "post_id": 52733403, "comment_id": 92391816, "body": "@user4581301 Agreed, however, I don&#39;t know if the user writes for embedded. Custom allocators that use a pool can still work, so does std::array. However, for the code I write daily, std::vector is the default."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1539151572, "post_id": 52733403, "comment_id": 92391983, "body": "From the question: <i>Recently I started doing a lot of microcontroller programming</i>. I&#39;n not the downvoter mind you. That was just a comment left for those who follow. I think the downvote is because the answer kind of focusses on minutia and misses the point of the question: <b>Is it bad practice in C++ to use const variables instead of #define when specifying array sizes? If so, why?</b>"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1539152522, "post_id": 52733403, "comment_id": 92392432, "body": "I&#39;ve must have missed that, let me remove that from the answer"}, {"owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "edited": false, "score": 0, "creation_date": 1539152649, "post_id": 52733403, "comment_id": 92392500, "body": "Tough world; sometimes we all get downvotes for trying (note: I&#39;m also not your downvoter). I am talking about embedded work though FYI."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1539154287, "post_id": 52733403, "comment_id": 92393239, "body": "Fantastic point about the language evolving and allowing for far more expressive constant specification. My <a href=\"https://godbolt.org/z/mmz2nz\" rel=\"nofollow noreferrer\">favorite example of this in C++17</a>."}], "tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": false, "score": 0, "last_activity_date": 1539152732, "last_edit_date": 1539152732, "creation_date": 1539150645, "answer_id": 52733403, "question_id": 52732931, "link": "https://stackoverflow.com/questions/52732931/is-it-bad-practice-to-specify-an-array-size-using-a-variable-instead-of-define/52733403#52733403", "title": "Is it bad practice to specify an array size using a variable instead of `#define` in C++? (C error: variably modified at file scope)", "body": "<p>I like your question! C++ is evolving to a language where you no longer need <code>#define</code>. Depending on the version, you can replace other constructs. Their are several reasons for  this, including problems with IDEs, unexpected replacement of variable names of enum values  with other constants, (Don't combine ERROR and ) and the absence of namespaces as this is all preprocessor replacement.</p>\n\n<p>For this example, you create a C-style array, which requires a constant. Writing <code>const int SIZE = 2</code> however does not create a constant, it creates a immutable variable. This can be used in a lot of ways and can be initialized with almost any code, including something you calculated from reading a file.</p>\n\n<p>The thing you are searching for is <code>constexpr</code>. The keyword that promotes your variable to a compile time constant and limits the initialization options to all code that can be executed at compile time. So: constants, calculations with them and constexpr functions that group these calculations.\nIf you want to know more about it, Google for constexpr (or use a different search engine).</p>\n\n<p><em>Note</em> C++11 is required for constexpr, C++14 is recommended when you want to write constexpr functions. For constexpr standard library functions, you'll have to wait C++20, if I remember well.</p>\n\n<pre><code>constexpr int SIZE = 2;\nint a[SIZE];\n</code></pre>\n"}], "owner": {"reputation": 11050, "user_id": 4561887, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/1ecb6a74fca21551bd8157504ad47faf?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Staples", "link": "https://stackoverflow.com/users/4561887/gabriel-staples"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 1, "closed_date": 1539155842, "answer_count": 3, "score": 1, "last_activity_date": 1539154308, "creation_date": 1539147856, "last_edit_date": 1539154308, "question_id": 52732931, "link": "https://stackoverflow.com/questions/52732931/is-it-bad-practice-to-specify-an-array-size-using-a-variable-instead-of-define", "closed_reason": "Opinion-based", "title": "Is it bad practice to specify an array size using a variable instead of `#define` in C++? (C error: variably modified at file scope)", "body": "<p>In C, declaring an array size using a variable, even if it is a <code>const</code> variable, is NOT allowed. Ex: this fails to compile in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst int SIZE = 2;\nint a[SIZE];\n\nint main()\n{\n    a[0] = 1;\n    a[1] = 2;\n    printf(\"%i, %i\", a[0], a[1]);       \n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://tpcg.io/9skvN5\" rel=\"nofollow noreferrer\">Run this code in C.</a></p>\n\n<p>Output:</p>\n\n<pre><code>$gcc -o main *.c\nmain.c:5:5: error: variably modified \u2018a\u2019 at file scope\n int a[SIZE];\n     ^\n</code></pre>\n\n<p>In C++, however, it runs just fine.<br>\n<a href=\"http://tpcg.io/HgbYT8\" rel=\"nofollow noreferrer\">Run the above code in C++.</a></p>\n\n<p>Output:</p>\n\n<pre><code>$g++ -o main *.cpp\n$main\n1, 2\n</code></pre>\n\n<p>To make it run in C, you must use <code>#define</code> instead of a variable. ie:</p>\n\n<p>This runs just fine in C OR C++:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define SIZE 2\n// const int SIZE = 2;\nint a[SIZE];\n\nint main()\n{\n    a[0] = 1;\n    a[1] = 2;\n    printf(\"%i, %i\", a[0], a[1]);\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://tpcg.io/7x6f4y\" rel=\"nofollow noreferrer\">Run this code in C.</a></p>\n\n<p>So, in C++ I've <em>almost always</em> used a variable, rather than <code>#define</code>, to declare my array sizes. I just make the array size variable <code>const</code> and it's all good! Recently I started doing a lot of microcontroller programming in pure C, however, and when I ran into this error and figured out the problem, a senior developer told me it's bad practice to use anything but <code>#define</code>-ed constants (or maybe hard-coded numbers) to declare array sizes. </p>\n\n<p><strong>Is this true? Is it bad practice in C++ to use <code>const</code> variables instead of <code>#define</code> when specifying array sizes? If so, why?</strong> </p>\n\n<p><strong>In C, apparently you're stuck with <code>#define</code>: you have no other choice. But in C++ you clearly have at least 2 choices, so is one better than the other?</strong> Is there a risk to using one over the other?</p>\n\n<h1>Related:</h1>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/13645936/variably-modified-array-at-file-scope-in-c\">variably modified array at file scope in C</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1637332/static-const-vs-define\">static const vs #define</a> &lt;-- this is a solid question and very helpful. It is most definitely related to my question, but my question is NOT a duplicate because although they are both about const vs #define, my question is a very special case where one of the options doesn't even work in a language which is regularly considered to be a subset of C++. That's pretty unusual, and makes my question a more narrow subset which fits within the broad scope of this other question. Therefore, not a duplicate.</li>\n<li><a href=\"https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#es31-dont-use-macros-for-constants-or-functions\" rel=\"nofollow noreferrer\">https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#es31-dont-use-macros-for-constants-or-functions</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1674032/static-const-vs-define-vs-enum/1674459#1674459\">&quot;static const&quot; vs &quot;#define&quot; vs &quot;enum&quot;</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Variable-length_array#C99\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Variable-length_array#C99</a></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 185, "user_id": 2842468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx6Oc.gif?s=128&g=1", "display_name": "ulix", "link": "https://stackoverflow.com/users/2842468/ulix"}, "edited": false, "score": 4, "creation_date": 1539144422, "post_id": 52732398, "comment_id": 92389871, "body": "Because it overflows the max positive 32 bit integer. Try using long long integer and %lld."}, {"owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "edited": false, "score": 1, "creation_date": 1539145175, "post_id": 52732398, "comment_id": 92390044, "body": "check <a href=\"https://stackoverflow.com/questions/9052088/why-int-i-400400-400-gives-result-72-is-datatype-circular\">integer overflow</a> for a proper explanation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539149189, "post_id": 52732398, "comment_id": 92391071, "body": "If you want to check the value using <code>double</code>, you need to force at least one of <code>n</code>, <code>m</code> or <code>nsamples</code> to a floating point value in the calculation as otherwise the calculation is done using integer arithmetic and the result converted to <code>double</code>.  Hence: <code>double num_points = (double)n * m * nsamples + 99;</code> would yield a positive floating point value."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1539153000, "post_id": 52732461, "comment_id": 92392657, "body": "<i>&quot;then the maximum value it can have is 4,294,967,295&quot;</i>: not quite, remember that <code>int</code> is signed."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1539153186, "post_id": 52732461, "comment_id": 92392750, "body": "Updated, Thanks."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1539156804, "last_edit_date": 1539156804, "creation_date": 1539144284, "answer_id": 52732461, "question_id": 52732398, "link": "https://stackoverflow.com/questions/52732398/negative-number-is-printing/52732461#52732461", "title": "negative number is printing", "body": "<p>The value of your multiplication is <code>20,480,000,000</code>.\nIf <code>int</code> is 4 bytes long on your system, then the maximum value it can have is <code>2,147,483,647</code>.\nYou can check the value of <code>INT_MIN</code> and <code>INT_MAX</code> macros defined in <code>limits.h</code>\nThe values of both these macros are compiler dependent because <code>sizeof(int)</code> is implementation defined in both C &amp; C++.</p>\n\n<p>When this <code>INT_MAX</code> value is exceeded, it prints a negative value in this particular instance.\u00a0But note that <em>signed integer overflow is undefined behaviour</em> as per the standard.</p>\n\n<p>So, you can use <code>unsigned long long</code> instead of <code>int</code> to store the value of your arithmetic operation.</p>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 10334659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6afc02c5a2d072d70358d1712a0439d3?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/10334659/gaurav"}, "is_accepted": true, "score": 5, "last_activity_date": 1542192802, "last_edit_date": 1542192802, "creation_date": 1539144436, "answer_id": 52732489, "question_id": 52732398, "link": "https://stackoverflow.com/questions/52732398/negative-number-is-printing/52732489#52732489", "title": "negative number is printing", "body": "<p>The limit/range of signed <code>int</code> or just <code>int</code> you are using, even on a <strong>64</strong> bit machine with a <strong>4</strong> byte integer is <strong>2,147,483,647</strong> (as its maximum value) and <strong>\u22122,147,483,648</strong> (as its minimum value) - the value you are trying to generate/print is <strong>20480000000</strong> which is greater than the limit/range - hence it is wrapping and producing -ve results. </p>\n\n<p>Example:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    printf(\"%d\\n\",2147483647+1);\n    return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT:</strong> <code>\u22122147483648</code> </p>\n\n<p>Use <strong>long unsigned</strong> instead of <code>int</code> to contain the result.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 7681379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b3cf4225d2cafe9c62f349d4c4d5adb?s=128&d=identicon&r=PG&f=1", "display_name": "Kaidi Wang", "link": "https://stackoverflow.com/users/7681379/kaidi-wang"}, "is_accepted": false, "score": 2, "last_activity_date": 1539144504, "creation_date": 1539144504, "answer_id": 52732500, "question_id": 52732398, "link": "https://stackoverflow.com/questions/52732398/negative-number-is-printing/52732500#52732500", "title": "negative number is printing", "body": "<p>change </p>\n\n<pre><code> int nrpoinnts\n</code></pre>\n\n<p>to</p>\n\n<pre><code> unsigned long int nrpoinnts\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10481901, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EYBB8gVsFVU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV6su5e4uyXmmMXy6KuSMVhnvw14w/mo/photo.jpg?sz=128", "display_name": "EveSz", "link": "https://stackoverflow.com/users/10481901/evesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 52732489, "answer_count": 3, "score": 0, "last_activity_date": 1542192802, "creation_date": 1539143825, "last_edit_date": 1539144366, "question_id": 52732398, "link": "https://stackoverflow.com/questions/52732398/negative-number-is-printing", "title": "negative number is printing", "body": "<p>I am new to C programming and trying to understand data types.</p>\n\n<p>I specified following variables:</p>\n\n<pre><code>  int nsamples = 10000000;\n  int n = 32;\n  int m = 64;\n\n\n  int nrpoinnts = n*m*nsamples+99;\n  printf(\"Nr points %d\\n\",nrpoinnts);\n</code></pre>\n\n<p>For some reason the printed number is negative. Why is that happening? I tough the value range of nrpoinnts was exceeded, so I checked double. The final result was that I was getting negative value either. </p>\n"}, {"tags": ["c", "security", "buffer", "buffer-overflow"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1539146149, "post_id": 52732307, "comment_id": 92390249, "body": "The <code>get_sp</code> function does nothing meaningful because the author did not understand inline asm. It copies the stack pointer to the <code>eax</code> register, but then does nothing with it, assuming (invalidly) that  it will still be there when the function returns. The correct form would be <code>unsigned ret; __asm__(&quot;mov %%esp,%0&quot; : &quot;=r&quot;(ret)); return ret;</code>"}, {"owner": {"reputation": 47988, "user_id": 267540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2v58W.jpg?s=128&g=1", "display_name": "e4c5", "link": "https://stackoverflow.com/users/267540/e4c5"}, "edited": false, "score": 1, "creation_date": 1554974816, "post_id": 52732307, "comment_id": 97949669, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14916004/buffer-overflow-vulnerability-lab-problems\">Buffer Overflow Vulnerability Lab problems</a>"}], "owner": {"reputation": 85, "user_id": 9997104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2645106cfee70e83df8f7584302fc44?s=128&d=identicon&r=PG&f=1", "display_name": "bjoshi", "link": "https://stackoverflow.com/users/9997104/bjoshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1586, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575909392, "creation_date": 1539143105, "last_edit_date": 1575909392, "question_id": 52732307, "link": "https://stackoverflow.com/questions/52732307/exploit-c-buffer-overflow", "title": "exploit.c -- buffer overflow", "body": "<p>I am writing exploit.c for my buffer overflow program and am lost trying to get return address. The code return below is my strategy, where <code>ret</code> would be the return address. </p>\n\n<p>How do I get this return address from the gdb? (Base code is at the end.)</p>\n\n<p>My strategy was to set a break point at bof function in stack and run the code and use the saved eip there as the return address.</p>\n\n<pre><code>long* ptr = (long*)(buffer + 24);\n ret = 0x-------;\n*ptr = ret;\n strcpy(buffer + 517 - strlen(shellcode), shellcode);\n</code></pre>\n\n<p>Shouldn't this piece of code do the job for me? Why do I need to fill any part of buffer array with other information?</p>\n\n<hr>\n\n<p>Base code:</p>\n\n<pre><code>/* stack.c */\n/* This program has a buffer overflow vulnerability. */\n/* Our task is to exploit this vulnerability */\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint bof(char *str)\n{\n    char buffer[24];\n    /* The following statement has a buffer overflow problem */\n    strcpy(buffer, str);\n    return 1;\n}\nint main(int argc, char **argv)\n{\n    char str[517];\n    FILE *badfile;\n    badfile = fopen(\"badfile\", \"r\");\n    fread(str, sizeof(char), 517, badfile);\n    bof(str);\n    printf(\"Returned Properly\\n\");\n    return 1;\n}\n\n/* exploit.c  */\n\n/* A program that creates a file containing code for launching shell*/\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nchar shellcode[]=\n    \"\\x31\\xc0\"             /* xorl    %eax,%eax              */\n    \"\\x50\"                 /* pushl   %eax                   */\n    \"\\x68\"\"//sh\"           /* pushl   $0x68732f2f            */\n    \"\\x68\"\"/bin\"           /* pushl   $0x6e69622f            */\n    \"\\x89\\xe3\"             /* movl    %esp,%ebx              */\n    \"\\x50\"                 /* pushl   %eax                   */\n    \"\\x53\"                 /* pushl   %ebx                   */\n    \"\\x89\\xe1\"             /* movl    %esp,%ecx              */\n    \"\\x99\"                 /* cdq                            */\n    \"\\xb0\\x0b\"             /* movb    $0x0b,%al              */\n    \"\\xcd\\x80\"             /* int     $0x80                  */\n;\n\nvoid main(int argc, char **argv)\n{\n    char buffer[517];\n    FILE *badfile;\n\n    /* Initialize buffer with 0x90 (NOP instruction) */\n    memset(&amp;buffer, 0x90, 517);\n\n    /* You need to fill the buffer with appropriate contents here */ \n\n    /* Save the contents to the file \"badfile\" */\n    badfile = fopen(\"./badfile\", \"w\");\n    fwrite(buffer, 517, 1, badfile);\n</code></pre>\n"}, {"tags": ["c", "data-structures"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8730918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3efe42507293fd463c3e65b0fef33b6?s=128&d=identicon&r=PG&f=1", "display_name": "RobertoGarcia", "link": "https://stackoverflow.com/users/8730918/robertogarcia"}, "edited": false, "score": 0, "creation_date": 1539144207, "post_id": 52732342, "comment_id": 92389821, "body": "this-&gt;queue[this-&gt;last] = *x; //or something like this, depends on the definition of Reloj_t                                                                                                                  error: incompatible types when assigning to type \u2018int\u2019 from type \u2018Reloj_t {aka const struct Reloj}"}, {"owner": {"reputation": 55, "user_id": 5674389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73823ebcda49a48966af2fddf8e87592?s=128&d=identicon&r=PG&f=1", "display_name": "27Blend", "link": "https://stackoverflow.com/users/5674389/27blend"}, "reply_to_user": {"reputation": 1, "user_id": 8730918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3efe42507293fd463c3e65b0fef33b6?s=128&d=identicon&r=PG&f=1", "display_name": "RobertoGarcia", "link": "https://stackoverflow.com/users/8730918/robertogarcia"}, "edited": false, "score": 0, "creation_date": 1539144829, "post_id": 52732342, "comment_id": 92389972, "body": "use x-&gt;SOMESTUFF if reloj_t is a struct"}], "tags": [], "owner": {"reputation": 55, "user_id": 5674389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73823ebcda49a48966af2fddf8e87592?s=128&d=identicon&r=PG&f=1", "display_name": "27Blend", "link": "https://stackoverflow.com/users/5674389/27blend"}, "is_accepted": false, "score": 0, "last_activity_date": 1539149333, "last_edit_date": 1539149333, "creation_date": 1539143360, "answer_id": 52732342, "question_id": 52732204, "link": "https://stackoverflow.com/questions/52732204/assignment-makes-integer-from-pointer-without-a-cast-in-c-error-invalid-initia/52732342#52732342", "title": "assignment makes integer from pointer without a cast in C [error: invalid initializer]", "body": "<p>for the warning, you are assigning a pointer to an integer.</p>\n\n<p>i.e: <code>this-&gt;queue[this-&gt;last]</code> is an integer, while <code>x</code> is a pointer(points to a Reloj_t).</p>\n\n<p>I think what you're trying to do is</p>\n\n<pre><code>this-&gt;queue[this-&gt;last] = x-&gt;SOMESTUFF; //or something like this, depends on the definition of Reloj_t\n</code></pre>\n\n<p>I can't tell what causes the error, could you post the definition of Reloj_t?</p>\n\n<p>if Reloj_t is a struct, you could do</p>\n\n<pre><code>Reloj_t x\nx.SOMESTUFF = this-&gt;queue[this-&gt;first];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8730918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3efe42507293fd463c3e65b0fef33b6?s=128&d=identicon&r=PG&f=1", "display_name": "RobertoGarcia", "link": "https://stackoverflow.com/users/8730918/robertogarcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539149333, "creation_date": 1539142390, "last_edit_date": 1539144095, "question_id": 52732204, "link": "https://stackoverflow.com/questions/52732204/assignment-makes-integer-from-pointer-without-a-cast-in-c-error-invalid-initia", "title": "assignment makes integer from pointer without a cast in C [error: invalid initializer]", "body": "<p>sorry for my bad english!</p>\n\n<p>i have this Warning and one error in this code </p>\n\n<blockquote>\n  <p>PD: this program store Watches object(ADT) in a Circular Queue</p>\n</blockquote>\n\n<p><strong>Error and Warning</strong></p>\n\n<blockquote>\n  <p>CQueue.c: In function \u2018CQueue_Insert\u2019:\n  CQueue.c:59:26: warning: assignment makes integer from pointer without a cast [-Wint-conversion]\n    this->queue[this->last] = x;</p>\n  \n  <p>CQueue.c: In function \u2018CQueue_Remove\u2019:\n  CQueue.c:70:14: error: invalid initializer\n    Reloj_t x = this->queue[this->first];</p>\n</blockquote>\n\n<p><strong>CODE CIRCULAR QUEUE STRUCT</strong></p>\n\n<pre><code>typedef struct{\nint* queue;\nsize_t first;\nsize_t last;\nsize_t max;\nsize_t cont;\n} CQueue;\n</code></pre>\n\n<p><strong>Reloj_t struct</strong></p>\n\n<pre><code>typedef struct Reloj\n{\n  int horas;\n  int minutos;\n  int segundos;\n //char nombre[MAX_TAM];\n } Reloj_t;\n</code></pre>\n\n<p><strong>FUNCTIONS WITH PROBLEMS</strong></p>\n\n<pre><code>void CQueue_Insert( CQueue* this, const Reloj_t* x )\n{\n if(CQueue_IsFull(this)==true){exit(1);}\n\n this-&gt;queue[this-&gt;last] = x;\n ++this-&gt;cont;\n ++this-&gt;last;\n if(this-&gt;last == this-&gt;max){\n this-&gt;last=0;\n }\n}\n\nReloj_t CQueue_Remove( CQueue* this )//this function returns Reloj_t objects\n{\n if(CQueue_IsEmpty(this) == true){exit(1);}\n Reloj_t x = this-&gt;queue[this-&gt;first];\n --this-&gt;cont;\n ++this-&gt;first;\n if(this-&gt;first == this-&gt;max){\n this-&gt;first=0;\n }\n return x;\n}\n</code></pre>\n"}, {"tags": ["directory", "sorting", "c"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "edited": false, "score": 0, "creation_date": 1539183855, "post_id": 52734324, "comment_id": 92411110, "body": "Excuse my ignorance, but so basically the stat st is where I&#39;m getting my byte sizes from, if you attempt to run my code on a directory it would print out all the files of the given choice followed by their byte size."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "edited": false, "score": 0, "creation_date": 1539186819, "post_id": 52734324, "comment_id": 92413001, "body": "@LiWang Are you asking me how to get the size of a file ? Or you just describe what your code is doing ?"}, {"owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "edited": false, "score": 0, "creation_date": 1539195929, "post_id": 52734324, "comment_id": 92417733, "body": "My code can already print out a byte size if you were to run it, I&#39;m been trying to figure out how I could sort it. The say if I run my code as /scan ini 5 I would get the output as: <a href=\"https://prnt.sc/l4k1rr\" rel=\"nofollow noreferrer\">prnt.sc/l4k1rr</a>"}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": false, "score": 0, "last_activity_date": 1539155910, "last_edit_date": 1539155910, "creation_date": 1539154488, "answer_id": 52734324, "question_id": 52734032, "link": "https://stackoverflow.com/questions/52734032/how-does-one-use-qsort-to-sort-a-char-containing-pathnames-files-based-on-their/52734324#52734324", "title": "How does one use qsort to sort a char containing pathnames/files based on their bytes?", "body": "<p>If we suppose your input is valid, your question could be simplified with:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define filesMax 5000\n\nint cmpfunc(const void const *a, const void *b) { return *(char *)a + *(char *)b; }\n\nint main(void) {\n  int nFiles = 4;\n  char *files[filesMax] = {\"amazing\", \"hello\", \"this is a file\", \"I'm a bad file\"};\n  qsort(files, strlen(files), sizeof(char), cmpfunc);\n\n  for (int i = 0; i &lt; nFiles;; i++) {\n    printf(\"%s\\n\", files[i]);\n  }\n}\n</code></pre>\n\n<p>If you compile with warning that give you:</p>\n\n<pre><code>source_file.c:11:23: warning: incompatible pointer types passing 'char *[5000]' to parameter of type 'const char *' [-Wincompatible-pointer-types]\n  qsort(files, strlen(files), sizeof(char), cmpfunc);\n                      ^~~~~\n</code></pre>\n\n<p><code>qsort()</code> expect the size of your array (or in your case a subsize) and it's also expect the size of one element of your array. In both you wrongly give it to it. Also, your compare function doesn't compare anything, you are currently adding the first bytes of both pointer of char, that doesn't make a lot of sense.</p>\n\n<p>To fix your code you must write:</p>\n\n<pre><code>qsort(files, nFiles, sizeof *files, &amp;cmpfunc);\n</code></pre>\n\n<p>and also fix your compare function:</p>\n\n<pre><code>int cmpfunc_aux(char * const *a, char * const *b) { return strcmp(*a, *b); }\n\nint cmpfunc(void const *a, void const *b) { return cmpfunc_aux(a, b); }\n</code></pre>\n\n<p>also size should be of type <code>size_t</code>:</p>\n\n<pre><code>size_t nFiles = 0;\n</code></pre>\n\n<p>Don't forget that all informations about how to use a function are write in their <a href=\"https://linux.die.net/man/3/qsort\" rel=\"nofollow noreferrer\">doc</a>.</p>\n\n<hr>\n\n<blockquote>\n  <p>how would I print out a sorted version of my print statements featuring the first statement being the most bytes and finishes at the least bytes?</p>\n</blockquote>\n\n<p>Your code don't show any clue that your are trying to do that, you are currently storing name file and only that. How do you expect sort your file with an information you didn't acquired ?</p>\n\n<p>However, that simple create a struct that contain both file name and size, acquire information needed to sort it and sort it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;inttypes.h&gt;\n\nstruct file {\n  off_t size;\n  char *name;\n};\n\nint cmpfunc_aux(struct file const *a, struct file const *b) {\n  if (a-&gt;size &gt; b-&gt;size) {\n    return -1;\n  } else if (a-&gt;size &lt; b-&gt;size) {\n    return 1;\n  } else {\n    return 0;\n  }\n}\n\nint cmpfunc(void const *a, void const *b) { return cmpfunc_aux(a, b); }\n\n#define filesMax 5000\n\nint main(void) {\n  size_t nFiles = 4;\n  struct file files[filesMax] = {{42, \"amazing\"},\n                                 {21, \"hello\"},\n                                 {168, \"this is a file\"},\n                                 {84, \"I'm a bad file\"}};\n  qsort(files, nFiles, sizeof *files, &amp;cmpfunc);\n\n  for (size_t i = 0; i &lt; nFiles; i++) {\n    printf(\"%s, %\" PRId64 \"\\n\", files[i].name, (intmax_t)files[i].size);\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1540210712, "last_edit_date": 1540210712, "creation_date": 1540209874, "answer_id": 52928911, "question_id": 52734032, "link": "https://stackoverflow.com/questions/52734032/how-does-one-use-qsort-to-sort-a-char-containing-pathnames-files-based-on-their/52928911#52928911", "title": "How does one use qsort to sort a char containing pathnames/files based on their bytes?", "body": "<p>The function <code>cmpfunc()</code> provided adds the first character of each string, and that's not a proper comparison function (it should give a opposite sign value when you switch the parameters, e.g. if <code>\"a\"</code> and <code>\"b\"</code> are the strings to compare, it adds the first two characters of both strings, giving <code>97+98 == 195</code>, which is positive on <code>unsigned char</code>s, then calling with <code>\"b\"</code> and <code>\"a\"</code> should give a negative number (and it again gives you <code>98 + 97 == 195</code>), more on, it always gives the same result ---even with <code>signed char</code>s--- so it cannot be used as a sorting comparator) </p>\n\n<p>As you are comparing strings, why not to use the standard library function <code>strcmp(3)</code> which is a valid comparison function?  It gives a negative number if first string is less lexicographically than the second, <code>0</code> if both are equal, and positive if first is greater lexicographically than the second.</p>\n\n<p>if your function has to check (and sort) by the lenght of the filenames, then you can define it as:</p>\n\n<pre><code>int cmpfunc(char *a, char *b) /* yes, you can define parameters as char * */\n{\n    return strlen(a) - strlen(b);\n}\n</code></pre>\n\n<p>or, first based on file length, then lexicographically:</p>\n\n<pre><code>int cmpfunc(char *a, char *b)\n{\n    int la = strlen(a), lb = strlen(b);\n    if (la != lb) return la - lb;\n    /* la == lb, so we must check lexicographycally */\n    return strcmp(a, b);\n}\n</code></pre>\n\n<p>Now, to continue helping you, I need to know why do you need to sort anything, as you say that you want to search a directory for a file, where does the sorting take place in the problem?</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1539153308, "question_id": 474394}, "owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1540210712, "creation_date": 1539141368, "question_id": 52734032, "link": "https://stackoverflow.com/questions/52734032/how-does-one-use-qsort-to-sort-a-char-containing-pathnames-files-based-on-their", "title": "How does one use qsort to sort a char containing pathnames/files based on their bytes?", "body": "<p>I basically wrote a code in which I take two command line arguments one being the type of file that I want to search in my directory and they other being the amount I want(which is not implemented yet, but I can fix that) \nThe code is like so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n\n#define sizeFileName 500\n#define filesMax 5000\n\nint cmpfunc( const void *a, const void *b) {\n  return *(char*)a + *(char*)b;\n}\n\nint main( int argc, char ** argv) {\n  FILE * fp = popen( \"find . -type f\", \"r\");\n  char * type = argv[1];\n  char * extension = \".\";\n\n  char* tExtension;\n  tExtension = malloc(strlen(type)+1+4);\n  strcpy(tExtension, extension);\n  strcat(tExtension, type);\n  // printf(\"%s\\n\",tExtension);\n\n  int amount = atoi(argv[2]);\n  //printf(\"%d\\n\",amount);\n\n  char buff[sizeFileName];\n  int nFiles = 0;\n  char * files[filesMax];\n  while(fgets(buff,sizeFileName,fp)) {\n    int leng = strlen(buff) - 1;\n    if (strncmp(buff + leng - 4, tExtension, 4) == 0){\n      files[nFiles] = strndup(buff,leng);\n      //printf(\"\\t%s\\n\", files[nFiles]);\n      nFiles ++;\n    }\n  }\n  fclose(fp);\n  printf(\"Found %d files\\n\", nFiles);\n\n  long long totalBytes = 0;\n  struct stat st;\n\n  // sorting based on byte size from greatest to least\n  qsort(files, (size_t) strlen(files), (size_t) sizeof(char), cmpfunc);\n\n  for(int i = 0;i&lt; nFiles; i ++) {\n    if(0!= stat(files[i],&amp;st)){\n      perror(\"stat failed:\");\n      exit(-1);\n    }\n    totalBytes += st.st_size;\n    printf(\"%s : %ld\\n\",files[i],st.st_size);\n  }\n  printf(\"Total size: %lld\\n\", totalBytes);\n  // clean up\n  for(int i = 0; i &lt; nFiles ; i ++ ) {\n    free(files[i]);\n }\n  return 0;\n}\n</code></pre>\n\n<p>So far I have every section set up properly, upon running the code say <code>$./find ini 5,</code> it would print out all the <code>ini files</code> followed by their byte size(it's currently ignore the 5). However, for the <code>qsort()</code>, I'm not exactly sure how I would sort the contents of <code>char * files</code> as while it holds the pathnames, I had to use <code>stat</code> to get the byte sizes, how would I print out a sorted version of my print statements featuring the first statement being the most bytes and finishes at the least bytes?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1539141331, "post_id": 52732038, "comment_id": 92389151, "body": "And what do you have so far?"}, {"owner": {"reputation": 1, "user_id": 10481773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa2e7b413d801319c1394b7cd43b2dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/10481773/gio"}, "reply_to_user": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1539141636, "post_id": 52732038, "comment_id": 92389239, "body": "while(b&gt;=1){                   a=a*2;                   b=b/2;                   if(b%2==1)                   c=c+a;                     }\t                     printf(&quot;Russian Multiplication result is=%d\\n&quot;,c);                   getchar(); \t\t\t\t  { \t\t\t\t\t  int num, bin; \t\t\t\t   \t\t\t\t      scanf(&quot;%d&quot;, &amp;num); \t\t\t\t      bin = printbinary(num); \t\t\t\t      printf(&quot;The binary equivalent of %d is %d\\n&quot;, num, bin); \t\t\t\t  } \t\t\t\t  int printbinary(int num); {     if (&quot;%d&quot; == 0)     {         return 0;     }     else     {         return (&quot;%d&quot; % 2) + 10 * printbinary(&quot;%d&quot; / 2);      }"}, {"owner": {"reputation": 1, "user_id": 10481773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa2e7b413d801319c1394b7cd43b2dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/10481773/gio"}, "reply_to_user": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1539141825, "post_id": 52732038, "comment_id": 92389294, "body": "I have the multiplication down, and a way to convert a value to binary. I just don&#39;t know how to combine the two so that the result is whats being converted"}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 1, "creation_date": 1539142150, "post_id": 52732038, "comment_id": 92389351, "body": "The code you have should be part of the question. Aside from that, though, it&#39;s not clear what you&#39;re looking for. You have the parts you need...what&#39;s keeping you from wiring them up together?"}, {"owner": {"reputation": 5478, "user_id": 8268644, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/9Crzt.jpg?s=128&g=1", "display_name": "core114", "link": "https://stackoverflow.com/users/8268644/core114"}, "edited": false, "score": 0, "creation_date": 1539142282, "post_id": 52732038, "comment_id": 92389383, "body": "Hi , Welcome to stack overflow   Please take the time to read to see <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>,"}, {"owner": {"reputation": 1, "user_id": 10481773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa2e7b413d801319c1394b7cd43b2dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/10481773/gio"}, "edited": false, "score": 0, "creation_date": 1539142920, "post_id": 52732038, "comment_id": 92389516, "body": "Sorry I&#39;m new to this site. And thats how i put it together, but im getting implicit declaration of function &#39;printbinary&#39; error. also very new to coding so go easy on me"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1539143304, "post_id": 52732038, "comment_id": 92389603, "body": "@Gio: Your code is not sufficient to reproduce the error, and clearly isn&#39;t a complete program. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (edited into the question). It looks like you failed to actually define <code>printbinary</code>, but the code you posted failed to define <i>main</i>, so we have no idea what your code might or might not be doing."}, {"owner": {"reputation": 1, "user_id": 10481773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa2e7b413d801319c1394b7cd43b2dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/10481773/gio"}, "edited": false, "score": 0, "creation_date": 1539144100, "post_id": 52732038, "comment_id": 92389802, "body": "I left some of the code out because when i pasted it, it didn&#39;t come out right but i fixed it. There is the complete program"}], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "is_accepted": false, "score": 0, "last_activity_date": 1539147400, "creation_date": 1539147400, "answer_id": 52732865, "question_id": 52732038, "link": "https://stackoverflow.com/questions/52732038/multiplication-and-binary-conversion-at-same-time/52732865#52732865", "title": "Multiplication and Binary Conversion at same time", "body": "<p>I'm not sure what you really are up to, because there are a lot of logical errors in the code. I am going to point out and give alternatives to what caused the errors which you have mentioned in the question.</p>\n\n<ol>\n<li><blockquote>\n  <p>implicit declaration of function 'printbinary'\n  [-Wimplicit-function-declaration]</p>\n</blockquote>\n\n<p>This is a result of not defining the function before using or calling it. So declare it globally first as follows before <code>main()</code>:  </p>\n\n<p><code>#include&lt;stdio.h&gt;\nint printbinary(int);\nint main() {...</code></p>\n\n<p>And what is <code>int printbinary(int num);</code> supposed to do after that block of code which \nso strangely enclosed in <code>{...}</code>(I've mentioned this in the next point)? When a function is said to have a return type which isn't <code>void</code>, in this case <code>int</code>, there should be some int variable or something which is taking it. else it's useless.</p></li>\n<li><p></p></li>\n</ol>\n\n<blockquote>\n  <p>'num' undeclared (first use in this function) if(num == 0):</p>\n</blockquote>\n\n<p>This is because of this code:</p>\n\n<pre><code>          {\n              int num, bin;\n              scanf(\"%d\", &amp;num);\n              bin = printbinary(num);\n              printf(\"The binary equivalent of %d is %d\\n\", num, bin);\n          }   //what's the point of these braces buddy??????\n</code></pre>\n\n<p>The variables <code>num</code> and <code>bin</code> are accessible only inside this block. So when you try to access <code>num</code> outside of it (i.e, after the closing bracket(<code>}</code>) ), it naturally says it's not not declared.</p>\n"}], "owner": {"reputation": 1, "user_id": 10481773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa2e7b413d801319c1394b7cd43b2dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/10481773/gio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1539147400, "creation_date": 1539140971, "last_edit_date": 1539144407, "question_id": 52732038, "link": "https://stackoverflow.com/questions/52732038/multiplication-and-binary-conversion-at-same-time", "title": "Multiplication and Binary Conversion at same time", "body": "<p>I'm trying to multiply two user inputs using Russian Multiplication and convert that result into Binary at the same time. Keep getting errors</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\nwhile(1){\nint i, choice;\nprintf(\"What would you like to do?\\n 1. Multiplication \\n 2. Exit\\n\\n\");\n\nif(choice == 1){\n int a,b,c;\n  a=0;b=0;\n  c=0;\n  printf(\"enter your first number\\n\");\n  scanf(\"%d\",&amp;a);\n  printf(\"enter your second number\\n\");\n  scanf(\"%d\",&amp;b);\n  while(b&gt;=1){\n\n              a=a*2;\n              b=b/2;\n              if(b%2==1)\n              c=c+a;\n\n              }\n\n              printf(\"Russian Multiplication result is=%d\\n\",c);\n              getchar();\n\n              {\n                  int num, bin;\n\n                  scanf(\"%d\", &amp;num);\n                  bin = printbinary(num);\n                  printf(\"The binary equivalent of %d is %d\\n\", num, bin);\n              }\n              int printbinary(int num);\n\nif (num == 0)\n\n{\n\n    return 0;\n\n}\n\nelse\n\n{\n\n    return (num % 2) + 10 * printbinary(num / 2);\n\n}\n}\nif(choice ==2){\nreturn 0;\n}\nelse{\n    printf(\"That's not an option dude, try again\\n\");\n   }\n  }\n}\n</code></pre>\n\n<p>Keep getting implicit declaration of function 'printbinary' [-Wimplicit-function-declaration]\n                bin == printbinary(num);\nAlso getting an error that states: 'num' undeclared (first use in this function)   if(num == 0) </p>\n"}, {"tags": ["c", "casting", "type-conversion"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1539140767, "creation_date": 1539140767, "answer_id": 52732013, "question_id": 52731920, "link": "https://stackoverflow.com/questions/52731920/switching-between-data-types/52732013#52732013", "title": "Switching between data types", "body": "<p>Rather than trying to change the values, just output the result as an int:</p>\n\n<pre><code>printf(\"The sum is: %d\\n\", (int)(a + b));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10384953, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uayw4CIaVco/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMdb3zJCn9xZ2lt30aIRXg77kYpEA/mo/photo.jpg?sz=128", "display_name": "Hank", "link": "https://stackoverflow.com/users/10384953/hank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539142465, "creation_date": 1539140013, "question_id": 52731920, "link": "https://stackoverflow.com/questions/52731920/switching-between-data-types", "title": "Switching between data types", "body": "<p>I'm attempting to create a simple calculator in C. For the calculator, I'm trying to include an option to switch between using double precision variables and integers. By default the calculator is in double precision mode. </p>\n\n<p>Is there a way to easily toggle my data types back and forth between int and double? Preferably through type casting?</p>\n\n<p>For example, here's the addition part of switch statement (the first case):</p>\n\n<pre><code>    case 1:\n      printf(\"Enter first term: \");\n      scanf(\"%lf\", &amp;a);\n      printf(\"Enter second term: \");\n      scanf(\"%lf\", &amp;b);\n      printf(\"The sum is: %.15lf\\n\", a + b);\n      break;\n</code></pre>\n\n<p>The cases for subtracting, multiplying, and dividing follow the same format; respectively, cases 2, 3, and 4. Is there a way to apply a case (say add a case 5) to switch all double values to int?</p>\n"}, {"tags": ["python", "c", "python-3.x", "numpy"], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "edited": false, "score": 0, "creation_date": 1539143101, "post_id": 52732077, "comment_id": 92389552, "body": "Thanks a bunch ... that was really neat ... seems to have actually plugged my leak ... couldn&#39;t find this anywhere when I was searching for a fix. Very elegant. Just a couple of pointers though,  (a) <code>void *memory = PyCapsule_GetPointer(capsule, NULL);</code> (b) when I compile the above code, I get the following warning -   <code>passing argument 1 of \u2018(int (*)(PyArrayObject *, PyObject *))*(PyArray_API + 2256u)\u2019 from incompatible pointer type [-Wincompatible-pointer-types]</code>  Any ideas on averting this?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "edited": false, "score": 0, "creation_date": 1539145206, "post_id": 52732077, "comment_id": 92390048, "body": "@ArnabSanyal: Thanks for pointing out the missing argument; I&#39;d forgotten capsule names were used for that. As for the pointer type warning, there was a missing cast."}, {"owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "edited": false, "score": 0, "creation_date": 1539145716, "post_id": 52732077, "comment_id": 92390153, "body": "You&#39;re welcome @user2357112. This was a real lifesaver though. Tested it. works like a charm !!"}, {"owner": {"reputation": 343, "user_id": 4068296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BYt8u.png?s=128&g=1", "display_name": "Roger Figueroa Quintero", "link": "https://stackoverflow.com/users/4068296/roger-figueroa-quintero"}, "edited": false, "score": 0, "creation_date": 1565257611, "post_id": 52732077, "comment_id": 101299732, "body": "I found this in caffe library, maybe someone will help: &quot;boost python expects a void (missing) return value, while import_array&quot; &quot;returns NULL for python3. import_array1() forces a void return value.&quot;"}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1539145152, "last_edit_date": 1539145152, "creation_date": 1539141243, "answer_id": 52732077, "question_id": 52731884, "link": "https://stackoverflow.com/questions/52731884/pyarray-simplenewfromdata/52732077#52732077", "title": "PyArray_SimpleNewFromData", "body": "<p>The technique described in the link you didn't understand is a good one: create a Python object that knows how to free your memory when destroyed, and make it the base of the returned array.</p>\n\n<p>It sounds like you might have been overwhelmed by the complexity of creating a new extension type. Fortunately, that's not necessary. Python comes with a type designed to perform arbitrary C-level cleanup when destroyed: <a href=\"https://docs.python.org/3.7/c-api/capsule.html\" rel=\"noreferrer\">capsules</a>, which bundle together a pointer and a destructor function and call the destructor when the capsule is destroyed.</p>\n\n<p>To create a capsule for your memory, first, we define a destructor function:</p>\n\n<pre><code>void capsule_cleanup(PyObject *capsule) {\n    void *memory = PyCapsule_GetPointer(capsule, NULL);\n    // I'm going to assume your memory needs to be freed with free().\n    // If it needs different cleanup, perform whatever that cleanup is\n    // instead of calling free().\n    free(memory);\n}\n</code></pre>\n\n<p>And you set a capsule as your array's base with</p>\n\n<pre><code>PyObject *capsule = PyCapsule_New(data, NULL, capsule_cleanup);\nPyArray_SetBaseObject((PyArrayObject *) arr, capsule);\n// Do not Py_DECREF the capsule; PyArray_SetBaseObject stole your\n// reference.\n</code></pre>\n\n<p>And that should ensure your memory gets freed once it's no longer in use.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 12087339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a53186a87ed5fae4b730e3618c30f352?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Betz", "link": "https://stackoverflow.com/users/12087339/robin-betz"}, "is_accepted": false, "score": 4, "last_activity_date": 1568843012, "creation_date": 1568843012, "answer_id": 58001107, "question_id": 52731884, "link": "https://stackoverflow.com/questions/52731884/pyarray-simplenewfromdata/58001107#58001107", "title": "PyArray_SimpleNewFromData", "body": "<p>While the <code>PyCapsule</code> approach works more generally, you can get numpy to free the memory in the array for you when it's garbage collected by setting the <code>OWNDATA</code> flag.</p>\n\n<pre><code>double *data = some_function_that_returns_a_double_star(x, y, z);\nPyObject *arr = PyArray_SimpleNewFromData(nd, dims, NPY_DOUBLE, (void *)data);\nPyArray_ENABLEFLAGS((PyArrayObject*) arr, NPY_ARRAY_OWNDATA);\n</code></pre>\n"}], "owner": {"reputation": 541, "user_id": 7517511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/326VD.jpg?s=128&g=1", "display_name": "Arnab Sanyal", "link": "https://stackoverflow.com/users/7517511/arnab-sanyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1530, "favorite_count": 0, "accepted_answer_id": 52732077, "answer_count": 2, "score": 3, "last_activity_date": 1568843012, "creation_date": 1539139708, "last_edit_date": 1539140565, "question_id": 52731884, "link": "https://stackoverflow.com/questions/52731884/pyarray-simplenewfromdata", "title": "PyArray_SimpleNewFromData", "body": "<p>So I am trying to write a C function that accepts a numpy array object, extracts the data, does some manipulations and returns another c array as a numpy array object. Everything works seamlessly and I use python wrappers which help easy manipulation on the python side. However, I am facing a memory leak. I have an output pointer of doubles that I malloc-ed and which I wrap into a Python array object just before returning it to the calling python function,</p>\n\n<pre><code>PyObject *arr;\nint nd = 2;\nnpy_intp dims[] = {5, 10};\ndouble *data = some_function_that_returns_a_double_star(x, y, z);\n\narr = PyArray_SimpleNewFromData(nd, dims, NPY_DOUBLE, (void *)data);\nreturn arr;\n</code></pre>\n\n<p>However, this creates a memory leak, because data is never freed and I did some googling to find that this is a problem in such applications and solution is non-trivial. The most helpful resource that I found on this is <a href=\"http://blog.enthought.com/python/numpy-arrays-with-pre-allocated-memory/#.W71cEWhKhEY\" rel=\"nofollow noreferrer\">given here</a>. I could not implement the destructor that this page talks about from the given example. Can someone help me with this? More concretely I am looking for something like,</p>\n\n<pre><code>PyObject *arr;\nint nd = 2;\nnpy_intp dims[] = {5, 10};\ndouble *data = some_function_that_returns_a_double_star(x, y, z);\n\narr = PyArray_SimpleNewFromData(nd, dims, NPY_DOUBLE, (void *)data);\nsome_destructor_that_plug_memLeak_due_to_data_star(args);\nreturn arr;\n</code></pre>\n\n<blockquote>\n  <ul>\n  <li><a href=\"https://docs.scipy.org/doc/numpy-1.14.0/reference/c-api.array.html\" rel=\"nofollow noreferrer\">Numpy Array C APIs</a></li>\n  <li><a href=\"https://docs.scipy.org/doc/numpy-1.13.0/reference/c-api.html\" rel=\"nofollow noreferrer\">Numpy C APIs</a></li>\n  </ul>\n</blockquote>\n"}, {"tags": ["c", "linux", "exec", "wait", "waitpid"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1539139688, "creation_date": 1539139688, "answer_id": 52731878, "question_id": 52731842, "link": "https://stackoverflow.com/questions/52731842/how-to-get-the-return-value-of-child-process-to-its-parent-which-was-created-usi/52731878#52731878", "title": "How to get the return value of child process to its parent which was created using exec?", "body": "<blockquote>\n  <p>My question is how can a parent process receive the returned value which is larger than 255?</p>\n</blockquote>\n\n<p>It can't.  The return value of a process <strong>must</strong> be from 0 to 255.  If you want to communicate any other value between a child and a parent, you need some form of interprocess communication such as pipes.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1540590464, "post_id": 52733125, "comment_id": 92936864, "body": "See <a href=\"https://stackoverflow.com/questions/52918189/\">How do I get information from <code>&#47;proc</code> about a child process</a> for some code which shows some use of <code>SA_SIGINFO</code> et al.  That particular context also accesses information from the <code>&#47;proc</code> file system, but the code using the signal handling is independent of the access to <code>&#47;proc</code> (but the access to <code>&#47;proc</code> is not wholly independent of the signal handling \u2014 most of the alternative methods won&#39;t work reliably)."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1539149015, "last_edit_date": 1592644375, "creation_date": 1539149015, "answer_id": 52733125, "question_id": 52731842, "link": "https://stackoverflow.com/questions/52731842/how-to-get-the-return-value-of-child-process-to-its-parent-which-was-created-usi/52733125#52733125", "title": "How to get the return value of child process to its parent which was created using exec?", "body": "<p>It depends on the o/s and its support for <code>SA_SIGINFO</code>.  If you read the specification of POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigaction.html\" rel=\"nofollow noreferrer\"><code>sigaction()</code></a> carefully, and if you use <code>SA_SIGINFO</code> to capture extra information about the signals delivered, and you catch the <code>SIGCHLD</code> signal, then you <em>may</em> be able to get extra information, as documented in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03\" rel=\"nofollow noreferrer\">Signal Actions</a> and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/signal.h.html\" rel=\"nofollow noreferrer\"><code>&lt;signal.h&gt;</code></a>.</p>\n<p>In particular, the <code>&lt;signal.h&gt;</code> documentation notes that when the signal is <code>SIGCHLD</code>, then:</p>\n<blockquote>\n<p><code>int si_status</code></p>\n<p>If <code>si_code</code> is equal to <code>CLD_EXITED</code>, then <code>si_status</code> holds the exit value of the process; otherwise, it is equal to the signal that caused the process to change state. The exit value in <code>si_status</code> shall be equal to the full exit value (that is, the value passed to <code>_exit()</code>, <code>_Exit()</code>, or <code>exit()</code>, or returned from <code>main()</code>); it shall not be limited to the least significant eight bits of the value.</p>\n</blockquote>\n<p>The documentation for Linux <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\"><code>sigaction()</code></a> indicates that this is supported on Linux.  It is, however, considerably harder to organize than using <code>waitpid()</code> or one of its family of functions, and I have not demonstrated that it really works as POSIX specifies.</p>\n"}], "owner": {"reputation": 49, "user_id": 7278209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bce0d734d8ec0d8b361a4457e9fcfa8?s=128&d=identicon&r=PG&f=1", "display_name": "psin", "link": "https://stackoverflow.com/users/7278209/psin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 52733125, "answer_count": 2, "score": 0, "last_activity_date": 1539149015, "creation_date": 1539139395, "question_id": 52731842, "link": "https://stackoverflow.com/questions/52731842/how-to-get-the-return-value-of-child-process-to-its-parent-which-was-created-usi", "title": "How to get the return value of child process to its parent which was created using exec?", "body": "<p>I have seen similar questions <a href=\"https://stackoverflow.com/questions/2667095/how-to-get-the-return-value-of-a-program-ran-via-calling-a-member-of-the-exec-fa\">here</a> and <a href=\"https://stackoverflow.com/questions/22138007/how-to-find-the-return-value-of-a-program-after-execlp\">here</a>. The answers suggest to use WEXITSTATUS. But according to man page of WAIT(2), it has a limitation. It says:\nWEXITSTATUS(wstatus)\n              returns the exit status of the child.  <strong>This consists of the least significant 8 bits of the status</strong> argument that the child specified in a call to exit(3) or _exit(2) or as the argument\n              for a return statement in main().  This macro should be employed only if WIFEXITED returned true.</p>\n\n<p>So, if the child returns a value larger than 255, parent doesn't get the correct value. My question is how can a parent process receive the returned value which is larger than 255? Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1447, "user_id": 5162155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GouJq.jpg?s=128&g=1", "display_name": "Moshe Rabaev", "link": "https://stackoverflow.com/users/5162155/moshe-rabaev"}, "edited": false, "score": 0, "creation_date": 1539136996, "post_id": 52731535, "comment_id": 92388239, "body": "You are getting confused with <code>malloc</code> when you use <code>*Game</code> If Game is really a pointer than <code>sizeof(Game)</code> isn&#39;t correct allocation!"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 2, "creation_date": 1539137014, "post_id": 52731535, "comment_id": 92388246, "body": "ok... this time I bet I have it... <code>Game</code> is a pointer.  So, this line doesn&#39;t allocate enough space: <code>Game game = (Game)malloc(sizeof(Game));</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1539138414, "post_id": 52731535, "comment_id": 92388521, "body": "Probably worth noting that the line <code>game-&gt;players[0] = &amp;(Player){0, NULL};</code> not only causes a memory leak, but also takes the address of an object allocated on the stack. That object will cease to exist when the function returns. &#167;6.5.2.5/5"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539150611, "post_id": 52731535, "comment_id": 92391600, "body": "Note that you should not create function, variable, tag or macro names that start with an underscore, in general. <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.3\" rel=\"nofollow noreferrer\">C11 &#167;7.1.3 Reserved identifiers</a> says (in part): \u2014 <i>All identifiers that begin with an underscore and either an uppercase letter or another underscore are always reserved for any use.</i> \u2014 <i>All identifiers that begin with an underscore are always reserved for use as identifiers with file scope in both the ordinary and tag name spaces.</i> See also <a href=\"https://stackoverflow.com/a/1449301\">What does double underscore (<code>__const</code>) mean in C?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539151256, "post_id": 52731535, "comment_id": 92391844, "body": "Bad luck on being given a header to work with that illustrates several ways in which you should not write C code.  Presumably, you were also given a structure for the type <code>Card</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10481580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afff180bccf5980a7a804a37bdb664d4?s=128&d=identicon&r=PG", "display_name": "yxting", "link": "https://stackoverflow.com/users/10481580/yxting"}, "edited": false, "score": 0, "creation_date": 1539137352, "post_id": 52731584, "comment_id": 92388315, "body": "Thanks, that fixed it. Unfortunately I have to follow a given header file with that definition. I understand the malloc issue, but could you explain why the error was an illegal operation?"}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "reply_to_user": {"reputation": 51, "user_id": 10481580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afff180bccf5980a7a804a37bdb664d4?s=128&d=identicon&r=PG", "display_name": "yxting", "link": "https://stackoverflow.com/users/10481580/yxting"}, "edited": false, "score": 1, "creation_date": 1539137570, "post_id": 52731584, "comment_id": 92388360, "body": "<code>sizeof(Game)</code> does not allocate enough memory. Writing to <code>-&gt;players</code> accesses memory outside of the malloc&#39;ed area."}], "tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": false, "score": 3, "last_activity_date": 1539137697, "last_edit_date": 1539137697, "creation_date": 1539137100, "answer_id": 52731584, "question_id": 52731535, "link": "https://stackoverflow.com/questions/52731535/illegal-operation-when-setting-array-values-in-struct/52731584#52731584", "title": "Illegal operation when setting array values in struct", "body": "<pre><code>typedef struct _game {\n    ...\n} *Game;\n</code></pre>\n\n<p><code>Game</code> is defined as an alias for <code>struct _game *</code>, a pointer.</p>\n\n<pre><code>Game game = (Game)malloc(sizeof(Game));\n</code></pre>\n\n<p>That means that <code>sizeof(Game)</code> is the size of a pointer and not the entire struct. A pointer is smaller than the entire struct, so it's not enough memory. Writing to <code>-&gt;players</code> accesses memory outside of the malloc'ed area which causes the illegal operation error.</p>\n\n<p>A correct allocation would be:</p>\n\n<pre><code>Game game = malloc(sizeof *game);\n</code></pre>\n\n<p>Lesson learned: use <code>p = malloc(sizeof *p)</code> rather than <code>p = malloc(sizeof(Type))</code> to avoid this kind of mistake. The compiler won't catch a size mismatch. <code>sizeof *p</code> will always be the right size, even if <code>p</code> changes type.</p>\n\n<p>And if possible, get rid of the <code>*</code> in the definition of <code>Game</code>! It's quite out of place.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539147294, "post_id": 52731610, "comment_id": 92390548, "body": "Curious \u2014 I don&#39;t think I&#39;ve ever seen the advice &quot;don&#39;t use pointers at the end of <code>struct</code> definitions; it&#39;s ugly&quot; before.  Would you care to elaborate on why it is ugly, and can you perhaps provide a URL where the reasoning is explained?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1539150494, "post_id": 52731610, "comment_id": 92391543, "body": "Oh \u2014 do you mean <a href=\"https://stackoverflow.com/questions/750178/\">&quot;Don&#39;t typedef pointers&quot;</a>?  If so, then the linked question is the canonical reference on the topic. Note that when you say &quot;don&#39;t use pointers at the end of struct definitions&quot;, people are likely to assume that you mean &quot;don&#39;t use <code>struct Whatever { \u2026; SomeType *ptr; }</code> because that is at the end of the structure definition. In the question, there is <code>typedef struct _game { \u2026\u00a0} *Game;</code> which is defining the name <code>Game</code> as a pointer to <code>struct _game</code>, but it&#39;s not part of the structure definition per se. English is weird sometimes!"}], "tags": [], "owner": {"reputation": 1447, "user_id": 5162155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GouJq.jpg?s=128&g=1", "display_name": "Moshe Rabaev", "link": "https://stackoverflow.com/users/5162155/moshe-rabaev"}, "is_accepted": false, "score": 0, "last_activity_date": 1539137309, "creation_date": 1539137309, "answer_id": 52731610, "question_id": 52731535, "link": "https://stackoverflow.com/questions/52731535/illegal-operation-when-setting-array-values-in-struct/52731610#52731610", "title": "Illegal operation when setting array values in struct", "body": "<p>Don't use pointers at the end of struct definitions it's ugly.</p>\n\n<p>Change it to:</p>\n\n<pre><code>typedef struct _game {\n   CardStack *discardPile;\n   CardStack *drawPile;    \n   Player *players[4];\n   int currentPlayer;\n   int currentTurn;\n} Game;\n</code></pre>\n\n<p>And in your <code>malloc</code> replace that statement with the following:</p>\n\n<p><code>Game* games = (Game*)malloc(sizeof(Game));</code></p>\n\n<p>Bonn-appetite!</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1539147863, "creation_date": 1539147863, "answer_id": 52732933, "question_id": 52731535, "link": "https://stackoverflow.com/questions/52731535/illegal-operation-when-setting-array-values-in-struct/52732933#52732933", "title": "Illegal operation when setting array values in struct", "body": "<p>Quite apart from the <a href=\"https://stackoverflow.com/a/52731584/15168\">memory allocation</a> issue identified by <a href=\"https://stackoverflow.com/users/68587/john-kugelman\">John Kugelman</a>, you have at least one more major problem\u2026</p>\n\n<h3>Another problem</h3>\n\n<p>Note that the lines like these two:</p>\n\n<pre><code>game-&gt;players[0] = (Player*)malloc(sizeof(Player));\ngame-&gt;players[0] = &amp;(Player){0, NULL};\n</code></pre>\n\n<p>carefully leak the allocated memory.  You replace the just allocated pointer with a pointer to the compound literal, which leaves you no way to free the allocated memory.  It is perfectly legitimate to modify the compound literal as long as it doesn't go out of scope \u2014 but it does go out of scope when the function returns, so you not only leak memory but you also modify data you no longer own if you ever change the player information.</p>\n\n<p>You probably want this instead, which copies the compound literal to the allocated memory:</p>\n\n<pre><code>game-&gt;players[0] = (Player*)malloc(sizeof(Player));\n*game-&gt;players[0] = (Player){0, NULL};\n</code></pre>\n\n<p>I wouldn't be surprised to find there are other issues lurking, but the code is not an MCVE (<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>) so it is hard to be sure.</p>\n"}], "owner": {"reputation": 51, "user_id": 10481580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afff180bccf5980a7a804a37bdb664d4?s=128&d=identicon&r=PG", "display_name": "yxting", "link": "https://stackoverflow.com/users/10481580/yxting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1539147863, "creation_date": 1539136553, "last_edit_date": 1539137451, "question_id": 52731535, "link": "https://stackoverflow.com/questions/52731535/illegal-operation-when-setting-array-values-in-struct", "title": "Illegal operation when setting array values in struct", "body": "<p>I have the following 3 structs for a card game program</p>\n\n<pre><code>// Linked list of cards, used for draw &amp; discard pile, players' hands\ntypedef struct cardStack {\n    struct cardStack *next;\n    Card *card;\n} CardStack;\n\n// A player and their hand\ntypedef struct player {\n    int playerNumber;\n    CardStack *hand;\n} Player;\n\ntypedef struct _game {\n    CardStack *discardPile;\n    CardStack *drawPile;    \n    Player *players[4];\n    int currentPlayer;\n    int currentTurn;\n} *Game;\n</code></pre>\n\n<p>and this function to initialise the game struct</p>\n\n<pre><code>Game newGame(int deckSize, value values[], color colors[], suit suits[]) {\n\n    Game game = (Game)malloc(sizeof(Game));\n\n    game-&gt;players[0] = (Player*)malloc(sizeof(Player));\n    game-&gt;players[0] = &amp;(Player){0, NULL};\n    game-&gt;players[1] = (Player*)malloc(sizeof(Player));\n    game-&gt;players[1] = &amp;(Player){1, NULL};\n    game-&gt;players[2] = (Player*)malloc(sizeof(Player));\n    game-&gt;players[2] = &amp;(Player){2, NULL};\n    game-&gt;players[3] = (Player*)malloc(sizeof(Player));\n    game-&gt;players[3] = &amp;(Player){3, NULL};\n\n    for (int i = 1; i &lt;= 7; i++) {\n        for (int j = 1; i &lt;= NUM_PLAYERS; i++) {\n            Card card = newCard(values[i * j - 1], colors[i * j - 1], suits[i * j - 1]);\n            addToStack(card, game-&gt;players[j-1]-&gt;hand);\n        }\n    }\n\n    CardStack *discardPile = (CardStack*)malloc(sizeof(CardStack));\n    Card firstDiscard = newCard(values[28], colors[28], suits[28]);\n    addToStack(firstDiscard, discardPile);\n    game-&gt;discardPile = discardPile;\n\n    CardStack *drawPile = (CardStack*)malloc(sizeof(CardStack));\n    for (int i = 29; i &lt; deckSize; i++) {\n        Card card = newCard(values[i], colors[i], suits[i]);\n        addToStack(card, drawPile);\n    }\n    game-&gt;drawPile = drawPile;\n\n    game-&gt;currentPlayer = 0;\n    game-&gt;currentTurn = 1;\n\n    return game;\n}\n</code></pre>\n\n<p>It compiles fine, but when I try to run it, this line </p>\n\n<pre><code>game-&gt;players[0] = (Player*)malloc(sizeof(Player));\n</code></pre>\n\n<p>and similar, give an error\n\"illegal array, pointer or other operation\"\nI'm not sure whats wrong as I am just setting one pointer (in the array of pointers in the struct) to another</p>\n\n<p>EDIT: unfortunately this is an assignment where the header file was given so I have no choice but to use the pointer typedef</p>\n"}, {"tags": ["c", "arrays", "loops", "struct"], "answers": [{"tags": [], "owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "is_accepted": false, "score": 0, "last_activity_date": 1539145133, "last_edit_date": 1539145133, "creation_date": 1539144696, "answer_id": 52732522, "question_id": 52731231, "link": "https://stackoverflow.com/questions/52731231/how-to-store-elements-of-a-string-array-into-a-struct-in-c/52732522#52732522", "title": "How to store elements of a string array into a struct in C?", "body": "<p>I am not really understanding what you are trying to do, but <code>arr</code> is an array of pointers, <code>myPoint.connectingPoints</code> is an array of <code>char</code> and <code>myPoint.weights</code> is an array of <code>int</code>. So <code>myPoint.connectingPoints[x] = arr[y+1]</code> and <code>myPoint.weights[x] = arr[y+1]</code> will do pointer to <code>char</code> or <code>int</code> conversion, which is generally a bad idea.</p>\n\n<p>Maybe you wanted to do</p>\n\n<pre><code>myPoint.connectingPoints[x] = arr[y+1][0];\n</code></pre>\n\n<p>and</p>\n\n<pre><code>myPoint.weights[x] = arr[y+1][0];\n</code></pre>\n\n<p>The same goes for the comparisons with <code>arr[y+1]</code>. 97, 122, 48 and 57 are not hardcoded memory addresses, are they?</p>\n\n<p>This is totally ignoring the fact that you have a buffer overflow in <code>myPoint.connectingPoints</code> and <code>myPoint.weights</code>. Hint: <code>sizeofstring</code> is larger than 10.</p>\n\n<p>Please, always compile with <code>-Wall</code>. The flag exists for a reason</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 10435797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eee92c46fac16820bb955cabd8ff3dc?s=128&d=identicon&r=PG&f=1", "display_name": "vipawahel", "link": "https://stackoverflow.com/users/10435797/vipawahel"}, "edited": false, "score": 0, "creation_date": 1539210265, "post_id": 52733620, "comment_id": 92423522, "body": "This is amazing. thanks so much. I actually spent a lot of time looking at my code after posting this and found every single mistake i made, corrected it, added a few more stuff, and was able to successfully fill my entire struct with the contents of my string. I unfortunately didn&#39;t see this post until now. I will definitely have more questions in the near future regarding this program."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1539151649, "creation_date": 1539151649, "answer_id": 52733620, "question_id": 52731231, "link": "https://stackoverflow.com/questions/52731231/how-to-store-elements-of-a-string-array-into-a-struct-in-c/52733620#52733620", "title": "How to store elements of a string array into a struct in C?", "body": "<p>First, very good job on the detail, the minimum complete and verifiable example, and the formatting of your question. Next, it is apparent you are quite lost...</p>\n\n<p>It is hard to imagine a more awkward approach to doing what you are attempting to do, but for the sake of learning, there is quite a bit of learning that can be had in doing it in an awkward fashion.</p>\n\n<p>To begin, do not use <em>magic numbers</em> in your code. This is for readability and maintainability as your code grows. <code>10, 30, 97, 122, 48 and 57</code> are all <em>magic numbers</em>.</p>\n\n<pre><code>#define CPWT 10     /* if you need a constant, #define one (or more) */\n#define NPTR 30     /*   (do not use \"magic numbers\" in your code)   */\n</code></pre>\n\n<p>Do not use <em>magic numbers</em> for characters. While you should use the macros provided in <code>ctype.h</code> for <code>islower()</code> and <code>isdigit()</code>, if you are going to use characters, then use <em>characters</em>, e.g. <code>if (foo &gt;= 'a' &amp;&amp; foo &lt;= 'z')</code> not <code>97</code> and <code>122</code>. Just single quote the character.</p>\n\n<p>Next, you are overwriting every pointer in <code>arr</code> every time you assign <code>arr[i+1] = pch;</code> Why?</p>\n\n<pre><code>    char *arr[NPTR];                /* array of 30 UNINITIALIZED pointers */\n</code></pre>\n\n<p>While <code>strtok</code> does return a pointer, when you assign <code>arr[i+1] = pch;</code>, you are assigning the <strong>same pointer</strong> to each pointer in <code>arr</code>. When you are done, every element in <code>arr</code> will hold the last value returned by <code>strtok</code> (and since you assign <strong>after</strong> the last call to <code>strtok</code> returns <code>NULL</code> -- you most likely SegFault)</p>\n\n<p>Further, before you \"store\" anything at the address of <code>arr[0]</code> to <code>arr[NPTR-1]</code>, you must allocate storage based on the length of the string you are storing. (and yes, even though you are only storing a <em>single-character</em> in many elements, you are storing <em>strings</em> -- and every string requires a <em>nul-terminating character</em>).</p>\n\n<p>You cannot assign strings in C (except for the assignment of <em>string literals</em> or during initialization of an array). Otherwise, you must <strong>copy</strong> strings in C.</p>\n\n<p>So since you begin with <em>uninitialized, unallocated</em> pointers in <code>arr</code>, you must <em>allocate</em> and then <em>copy</em> to store information at each pointer address. You have two ways of doing so, (1) either <code>malloc (length + 1)</code> characters, <strong>validate</strong> the allocation, and then <code>strcpy</code> (or more efficiently <code>memcpy</code> since you have already scanned to find the <em>nul-character</em> with <code>strlen()</code>), or (2) if you have <code>strdup()</code> it will both allocate and copy as you did in (1) in a single function call. (<strong>note:</strong> since <code>strdup</code> allocates, you still must <strong>validate</strong> the allocation succeeded)</p>\n\n<p>Example (1)</p>\n\n<pre><code>    if ((pch = strtok (str,\" ;=,.-\")) != NULL) {    /* validate each call */\n        size_t len = strlen (pch);                  /* get length */\n        if ((arr[0] = malloc (len + 1)) == NULL) {  /* allocate/validate */\n            perror (\"arr[0]-malloc\");\n            exit (EXIT_FAILURE);\n        }\n        memcpy (arr[0], pch, len+1);    /* copy! string to arr[0] */\n        i++;\n    }\n</code></pre>\n\n<p>Example 2 (using <code>strdup</code> to allocate/copy)</p>\n\n<pre><code>    /* only loop if good return from strtok */\n    while ((pch  = strtok (NULL, \" ;=,.-\")) != NULL)\n    {\n        /* allocate/copy all at once with strdup (if you have it) */\n        if ((arr[i] = strdup (pch)) == NULL) {\n            perror (\"arr[n]-strdup\");\n            exit (EXIT_FAILURE);\n        }\n        i++;\n    }\n</code></pre>\n\n<p>Since you have just filled <code>i</code> elements of <code>arr</code>, there is no need for:</p>\n\n<pre><code>    int sizeofstring = sizeof(str)/sizeof(str[0]);\n</code></pre>\n\n<p>You know you have <code>i</code> strings in <code>arr</code> -- use <code>i</code> not <code>sizeofstring</code> and step through each string you stored in <code>arr</code>, not each character in <code>str</code>. That defeats the entire purpose of having <em>tokenized</em> <code>str</code>. Further, you only want to consider <em>single character</em> or <em>single digit</em> strings in <code>arr</code> (not <code>\"milk\"</code> and <code>\"cheese\"</code>) when setting <code>connectingPoints</code> and <code>weights</code>, so check whether the 2nd character is the <em>nul-character</em>, otherwise skip the element of <code>arr</code>.</p>\n\n<p>You can't use <code>y</code> for both <code>connectingPoints</code> and <code>weights</code>, you have <code>a, b, d</code> <code>connectingPoints</code> (3 of them) and only 2 <code>weights</code>. You would be attempting to access outside the valid data in <code>weights</code> if you iterated from <code>j = 0; j &lt; y; ...</code></p>\n\n<p>Again, you cannot assign a pointer as a character, so the easiest way to assign the 1st character in a string as a character, is simply to <em>dereference</em> the pointer, e.g. <code>*arr[x]</code> (which is equivalent to the character <code>arr[x][0]</code>). That in mind, you could do:</p>\n\n<pre><code>    /* i contains the number of strings in arr - use it */\n    for (x = 0; x &lt; i; x++) {\n        if (arr[x][1] == 0) {   /* only consider single char strings in arr */\n            if (cpts &lt; CPWT &amp;&amp; islower(*arr[x])) { /* check bound/lowercase */\n                myPoint.connectingPoints[cpts] = *arr[x];  /* assign char */\n                cpts++;\n            }\n            else if (weights &lt; CPWT &amp;&amp; isdigit(*arr[x])) { /* same w/digits */\n                myPoint.weights[weights] = *arr[x];\n                weights++;\n            }\n        }\n    }\n</code></pre>\n\n<p>(<strong>note:</strong> the separate use of the counters <code>cpts</code> and <code>weights</code> instead of a single <code>y</code>)</p>\n\n<p>Putting all the pieces together, you could do the awkward approach with something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define CPWT 10     /* if you need a constant, #define one (or more) */\n#define NPTR 30     /*   (do not use \"magic numbers\" in your code)   */\n\nstruct stopPoints {\n    int  weights[CPWT];\n    char connectingPoints[CPWT];\n    char *items;\n    int startBool;\n};\n\nint main (void)\n{\n    struct stopPoints myPoint = { .weights = {0} };\n    char *arr[NPTR];                /* array of 30 UNINITIALIZED pointers */\n    char str[] =\"a = 2.b 1.d; milk cheese\";\n    char *pch;\n    int i = 0, x, cpts = 0, weights = 0;\n\n    if ((pch = strtok (str,\" ;=,.-\")) != NULL) {    /* validate each call */\n        size_t len = strlen (pch);                  /* get length */\n        if ((arr[0] = malloc (len + 1)) == NULL) {  /* allocate/validate */\n            perror (\"arr[0]-malloc\");\n            exit (EXIT_FAILURE);\n        }\n        memcpy (arr[0], pch, len+1);    /* copy! string to arr[0] */\n        i++;\n    }\n\n    /* only loop if good return from strtok */\n    while ((pch  = strtok (NULL, \" ;=,.-\")) != NULL)\n    {\n        /* allocate/copy all at once with strdup (if you have it) */\n        if ((arr[i] = strdup (pch)) == NULL) {\n            perror (\"arr[n]-strdup\");\n            exit (EXIT_FAILURE);\n        }\n        i++;\n    }\n\n    /* i contains the number of strings in arr - use it */\n    for (x = 0; x &lt; i; x++) {\n        if (arr[x][1] == 0) {   /* only consider single char strings in arr */\n            if (cpts &lt; CPWT &amp;&amp; islower(*arr[x])) { /* check bound/lowercase */\n                myPoint.connectingPoints[cpts] = *arr[x];  /* assign char */\n                cpts++;\n            }\n            else if (weights &lt; CPWT &amp;&amp; isdigit(*arr[x])) { /* same w/digits */\n                myPoint.weights[weights] = *arr[x];\n                weights++;\n            }\n        }\n    }\n\n    puts (\"arr contents:\");\n    for (x = 0; x &lt; i; x++)\n        printf (\" arr[%2d]: %s\\n\", x, arr[x]);\n\n    puts (\"\\nconnectingPoints:\");\n    for (x = 0; x &lt; cpts; x++)\n        printf (\" myPoint.connectionPoints[%2d]: %c\\n\", \n                x, myPoint.connectingPoints[x]);\n\n    puts (\"\\nweights:\");\n    for (x = 0; x &lt; weights; x++)\n        printf (\" myPoint.weights[%2d]: %c\\n\", \n                x, myPoint.weights[x]);\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> the use of <code>islower()</code> and <code>isdigit()</code> from <code>ctype.h</code>)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/strtokarrptrs\narr contents:\n arr[ 0]: a\n arr[ 1]: 2\n arr[ 2]: b\n arr[ 3]: 1\n arr[ 4]: d\n arr[ 5]: milk\n arr[ 6]: cheese\n\nconnectingPoints:\n myPoint.connectionPoints[ 0]: a\n myPoint.connectionPoints[ 1]: b\n myPoint.connectionPoints[ 2]: d\n\nweights:\n myPoint.weights[ 0]: 2\n myPoint.weights[ 1]: 1\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": false, "score": 0, "last_activity_date": 1539153260, "creation_date": 1539153260, "answer_id": 52734014, "question_id": 52731231, "link": "https://stackoverflow.com/questions/52731231/how-to-store-elements-of-a-string-array-into-a-struct-in-c/52734014#52734014", "title": "How to store elements of a string array into a struct in C?", "body": "<p>You do not initialize your struct at any point and you alternate by assigning values\nto myPoint.connectionPoints[x] and myPoint.weights[x] but then skip a spot in the other\narray so that is the reason you get random values</p>\n\n<pre><code>      if (arr[y+1] &gt;= 97 &amp;&amp; arr[y+1] &lt;= 122){\n            myPoint.connectingPoints[x] = arr[y+1];  // myPoint.weights[x] left unassigned \n            y++;\n      }\n      else if (arr[y+1] &gt;= 48 &amp;&amp; arr[y+1] &lt;= 57){\n            myPoint.weights[x] = arr[y+1]; // myPoint.connectingPoints[x] left unassigned\n            y++;\n      }\n</code></pre>\n\n<p>I would suggest you convert your values to the struct already when you get the\nreturn value from strtok to avoid allocating for things you do not later\nneed.</p>\n\n<p>E.g.</p>\n\n<pre><code>    int index = 0;\n    for (char* pch = strtok(str, \" ;=,.-\"); pch != NULL; pch = strtok(NULL, \" ;=,.-\")\n    {\n      switch (index++)\n      {\n      case 0:\n      case 1:\n      case 2:\n      ...\n      default:\n        break;\n      }\n    }\n</code></pre>\n\n<p>EDIT: in fact I am not sure you need the switch at all, just have a counter for each array and increment when you assign to it.</p>\n\n<p>In the case of the return value of <code>strtok()</code> you must take care to allocate memory for the return value in order to store the value between each iteration since it uses a static buffer of the original string when it returns tokens, but if you directly convert the token you don't need to.</p>\n\n<p>When you check the value of the character use one of the standard c runtime\nfunctions for that purpose isdigit() isalpha()/islower() instead of checking ASCII \nvalue directly.</p>\n"}], "owner": {"reputation": 43, "user_id": 10435797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eee92c46fac16820bb955cabd8ff3dc?s=128&d=identicon&r=PG&f=1", "display_name": "vipawahel", "link": "https://stackoverflow.com/users/10435797/vipawahel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 52733620, "answer_count": 3, "score": 1, "last_activity_date": 1539153260, "creation_date": 1539133468, "question_id": 52731231, "link": "https://stackoverflow.com/questions/52731231/how-to-store-elements-of-a-string-array-into-a-struct-in-c", "title": "How to store elements of a string array into a struct in C?", "body": "<p>So I have a string: <code>a = 2.b 1.d; milk cheese</code></p>\n\n<p>I separate it by removing all the special characters (the equal sign, the period, the semicolon) and this is done using the strtok function in C. I take each element and store it into an array of strings, like this:</p>\n\n<pre><code>arr[0]=\"a\"\narr[1]=\"2\"\narr[2]=\"b\"\narr[3]=\"1\"\narr[4]=\"d\"\narr[5]=\"milk\"\narr[6]=\"cheese\"\n</code></pre>\n\n<p>Now, I want to take those values and put them into a struct. Here is my struct:</p>\n\n<pre><code>struct stopPoints {\n    int  weights[10];\n    char connectingPoints[10];\n    char *items;\n    int startBool;\n};\n</code></pre>\n\n<p>I've declared the struct and called it myPoint. Now, I want to store each of the separated elements up top into my struct. For example, i want to store the \"2\" and \"1\" into <code>myPoint.weights[0]</code> and <code>myPoint.weights[1]</code>. I want to store the \"a\" and \"b\" into <code>myPoint.connectingPoints[0]</code> and <code>myPoint.connectingPoints[1]</code>.</p>\n\n<p>I approached this by trying to distinguish between letters and numbers. I loop through the \"arr\" array and check if each index has either a letter or number. This is done by using the ASCII values (I know there's a better method to doing this according to the answers on my previous post). But when I try printing out the first weight element in my struct, I get a random value. How can I fix this? My code is below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct stopPoints {\n    int  weights[10];\n    char connectingPoints[10];\n    char *items;\n    int startBool;\n};\n\nint main ()\n{\n    struct stopPoints myPoint;\n  char *arr[30];\n  char str[] =\"a = 2.b 1.d; milk cheese\";\n  char * pch;\n  pch = strtok (str,\" ;=,.-\");\n  arr[0] = pch;\n  int i=0;\n  while (pch != NULL)\n  {\n    //printf (\"%s\\n\",pch);\n    pch = strtok (NULL, \" ;=,.-\");\n    arr[i+1] = pch;\n    printf(\"%s\\n\", arr[i]);\n    i++;\n  }\n    int sizeofstring = sizeof(str)/sizeof(str[0]);\n\n    int x,y=0;\n     for (x=0; x&lt;sizeofstring; x++){\n          if (arr[y+1] &gt;= 97 &amp;&amp; arr[y+1] &lt;= 122){\n                myPoint.connectingPoints[x] = arr[y+1];\n                y++;\n          }\n          else if (arr[y+1] &gt;= 48 &amp;&amp; arr[y+1] &lt;= 57){\n                myPoint.weights[x] = arr[y+1];\n                y++;\n          }\n     }\n\n    printf(\"%d\\n\", myPoint.weights[1]);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "valgrind", "glibc"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1539134798, "post_id": 52731193, "comment_id": 92387762, "body": "some of the libc function do not bother freeing memory to save performance. This means take care of keeping small amounts they use a bay. valgrind reports this memory as leaked, but it gets returned at the app exit."}, {"owner": {"reputation": 13754, "user_id": 2113226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gPovY.png?s=128&g=1", "display_name": "Digital Trauma", "link": "https://stackoverflow.com/users/2113226/digital-trauma"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1539134989, "post_id": 52731193, "comment_id": 92387797, "body": "@Serge <i>some of the libc function do not bother freeing memory to save performance</i> &lt;sup&gt;citation needed&lt;/sup&gt;."}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539133509, "post_id": 52731194, "comment_id": 92387502, "body": "odd, but I don&#39;t agree about your wording here valgrind clearly say &quot;possibly lost&quot; so it&#39;s just possible, it never say it was certain, so valgrind is not incorrect here."}, {"owner": {"reputation": 13754, "user_id": 2113226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gPovY.png?s=128&g=1", "display_name": "Digital Trauma", "link": "https://stackoverflow.com/users/2113226/digital-trauma"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539134049, "post_id": 52731194, "comment_id": 92387615, "body": "@Stargateur Fair enough, though <a href=\"https://stackoverflow.com/questions/3537713/valgrind-can-possibly-lost-be-treated-as-definitely-lost\">earlier SO advice</a> recommends that &quot;possibly-lost&quot; should generally be treated as &quot;lost&quot;."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539134401, "post_id": 52731194, "comment_id": 92387680, "body": "Well, the question you link quote valgrind doc, &quot;Possibly lost, or \u201cdubious\u201d&quot;, this is clearly the case, this implementation do something really unsafe and totally implemented behavior. You are not suppose to play with pointer like that but they can because they are the implementation (glibc). Still, valgrind is right about this pointer no longer exist, the pointer have &quot;moved&quot; a little so valgrind report possibly because a pointer still refer to something close to the original address. Again this is the case so I don&#39;t see why valgrind should be considered buged here."}, {"owner": {"reputation": 13754, "user_id": 2113226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gPovY.png?s=128&g=1", "display_name": "Digital Trauma", "link": "https://stackoverflow.com/users/2113226/digital-trauma"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539134784, "post_id": 52731194, "comment_id": 92387759, "body": "@Stargateur If you find any implications in this post that this is a valgrind bug, then that was not my intention."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1539139427, "post_id": 52731194, "comment_id": 92388729, "body": "&quot;Possibly lost&quot; is not &quot;lost&quot;. In C, you can perform any invertible transformation you like on the representation of a pointer, even encrypting it and uploading it to the cloud and later downloading and decrypting it, without &quot;losing&quot; the object pointed to. The only hack here is the (implementation-specific) knowledge that <code>|1</code> is invertible on pointers returned by <code>malloc</code>."}], "tags": [], "owner": {"reputation": 13754, "user_id": 2113226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gPovY.png?s=128&g=1", "display_name": "Digital Trauma", "link": "https://stackoverflow.com/users/2113226/digital-trauma"}, "is_accepted": false, "score": 4, "last_activity_date": 1539134338, "last_edit_date": 1539134338, "creation_date": 1539133095, "answer_id": 52731194, "question_id": 52731193, "link": "https://stackoverflow.com/questions/52731193/why-does-valgrind-report-that-glibc-tsearch-randomly-leaks-memory/52731194#52731194", "title": "Why does valgrind report that glibc tsearch() randomly leaks memory?", "body": "<p>It turns out that the glibc <code>tsearch()</code> implementation is a bit naughty and can twiddle low-order bits in pointers to blocks that it has stored in a binary-search tree.  It uses low-order bits in pointers to store flags:\n<a href=\"https://code.woboq.org/userspace/glibc/misc/tsearch.c.html#341\" rel=\"nofollow noreferrer\">https://code.woboq.org/userspace/glibc/misc/tsearch.c.html#341</a></p>\n\n<p>In particular, the implementation uses these macros to set or clear the low-order pointer bit to mark a block as red or black respectively:</p>\n\n<pre><code>#define SETRED(N) (N)-&gt;left_node |= ((uintptr_t) 0x1)\n#define SETBLACK(N) (N)-&gt;left_node &amp;= ~((uintptr_t) 0x1)\n</code></pre>\n\n<p>The pointers are effectively incremented which makes valgrind think these valid pointers (which are stored in a <code>tsearch()</code> tree) have been <a href=\"http://valgrind.org/docs/manual/faq.html#faq.deflost\" rel=\"nofollow noreferrer\">overwritten and therefore possibly lost</a>.  But these are not lost blocks - They are successfully stored in the binary-search tree, modulo the low-order bit.  <code>tsearch()</code> will do the necessary masking of these bits when accessing the tree.  tsearch() can do this because <code>malloc()</code>ed blocks are generally aligned to at least even addresses.</p>\n\n<p>Only the blocks that are marked as \"red\" nodes in the binary tree have this bit set, so the pattern of which are \"possibly lost\" or not is entirely dependent on how the implementation categorises blocks as \"red\" or \"black\" during add, delete and rebalance operations.</p>\n\n<p>So <code>tsearch()</code>s bit-twiddling makes valgrind incorrectly think these blocks are lost.  In this case, valgrind is reporting false positives.</p>\n"}], "owner": {"reputation": 13754, "user_id": 2113226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gPovY.png?s=128&g=1", "display_name": "Digital Trauma", "link": "https://stackoverflow.com/users/2113226/digital-trauma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1539134338, "creation_date": 1539133095, "last_edit_date": 1539134103, "question_id": 52731193, "link": "https://stackoverflow.com/questions/52731193/why-does-valgrind-report-that-glibc-tsearch-randomly-leaks-memory", "title": "Why does valgrind report that glibc tsearch() randomly leaks memory?", "body": "<p>I'm using the glibc <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/tsearch.html\" rel=\"nofollow noreferrer\"><code>tsearch()</code></a> API family to store dynamically allocated data blocks in an example program.</p>\n\n<p>I am finding that when I use <code>tsearch()</code> to add several <code>malloc()</code>ed blocks to a tree, then valgrind reports some of those blocks as \"possibly lost\".  While \"possibly lost\" is not quite the same as \"definitely lost\", the <a href=\"https://stackoverflow.com/questions/3537713/valgrind-can-possibly-lost-be-treated-as-definitely-lost\">previous SO advice</a> is generally to investigate what is causing these.</p>\n\n<p>My example program is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;search.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n\nstruct data {\n    int id;\n    char *str;\n};\n\nstatic int\ncompare (const void *a, const void *b) {\n    const struct data *data_a = a, *data_b = b;\n\n    if (data_a-&gt;id &lt; data_b-&gt;id) {\n        return -1;\n    } else if (data_a-&gt;id &gt; data_b-&gt;id) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\n\nint main (int argc, char **argv) {\n    void *tree = NULL;\n    struct data *d1, *d2, *d3, *d4;\n\n    d1 = malloc(sizeof(struct data));\n    d1-&gt;id = 10;\n    d1-&gt;str = \"Hello\";\n    tsearch(d1, &amp;tree, compare);\n\n    d2 = malloc(sizeof(struct data));\n    d2-&gt;id = 30;\n    d2-&gt;str = \"Goodbye\";\n    tsearch(d2, &amp;tree, compare);\n\n    d3 = malloc(sizeof(struct data));\n    d3-&gt;id = 20;\n    d3-&gt;str = \"Thanks\";\n    tsearch(d3, &amp;tree, compare);\n\n    d4 = malloc(sizeof(struct data));\n    d4-&gt;id = 40;\n    d4-&gt;str = \"OK\";\n    tsearch(d4, &amp;tree, compare);\n\n    raise(SIGINT);\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that I'm calling <code>raise(SIGINT)</code> at the end of <code>main()</code> so that valgrind is still able to analyse allocated blocks before they are implicitly <code>free()</code>d.</p>\n\n<p>I am compiling and running under <code>valgrind</code> as follows:</p>\n\n<pre><code>$ gcc ts.c -o ts\n$ valgrind --leak-check=full ./ts\n==2091== Memcheck, a memory error detector\n==2091== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==2091== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==2091== Command: ./ts\n==2091== \n==2091== \n==2091== Process terminating with default action of signal 2 (SIGINT)\n==2091==    at 0x4E7AE97: raise (raise.c:51)\n==2091==    by 0x1088CE: main (in /home/ubuntu/ts)\n==2091== \n==2091== HEAP SUMMARY:\n==2091==     in use at exit: 160 bytes in 8 blocks\n==2091==   total heap usage: 8 allocs, 0 frees, 160 bytes allocated\n==2091== \n==2091== 24 bytes in 1 blocks are possibly lost in loss record 8 of 8\n==2091==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==2091==    by 0x4F59483: tsearch (tsearch.c:338)\n==2091==    by 0x108801: main (in /home/ubuntu/ts)\n==2091== \n==2091== LEAK SUMMARY:\n==2091==    definitely lost: 0 bytes in 0 blocks\n==2091==    indirectly lost: 0 bytes in 0 blocks\n==2091==      possibly lost: 24 bytes in 1 blocks\n==2091==    still reachable: 136 bytes in 7 blocks\n==2091==         suppressed: 0 bytes in 0 blocks\n==2091== Reachable blocks (those to which a pointer was found) are not shown.\n==2091== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==2091== \n==2091== For counts of detected and suppressed errors, rerun with: -v\n==2091== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\n\n$ \n</code></pre>\n\n<p>Valgrind is reporting that one 24 byte block is lost.  If I move the <code>raise(SIGINT)</code> ahead of the <code>d4</code> allocation and tree add, then no blocks are reported lost.</p>\n\n<p>Why is one block lost when adding 4 blocks, even when none are lost when adding 3 blocks?</p>\n"}, {"tags": ["c", "segmentation-fault", "fork", "master-slave", "execvp"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1539132073, "post_id": 52731050, "comment_id": 92387198, "body": "&quot;The list of arguments must be terminated by a NULL pointer, and, since these are variadic functions, this pointer must be cast (char *) NULL.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": true, "score": 0, "last_activity_date": 1539132204, "creation_date": 1539132204, "answer_id": 52731110, "question_id": 52731050, "link": "https://stackoverflow.com/questions/52731050/getting-segmentation-fault-on-master-slave/52731110#52731110", "title": "Getting segmentation fault on master/slave", "body": "<p>first problem is that you did not allocate any memory for <code>sums</code> and <code>sums[i]</code> accesses a trashy location. do this:</p>\n\n<pre><code> int sums[argc];\n</code></pre>\n\n<p>Secondly, for <code>execvp</code> function argument array has to have\n1. [0] -- a legal string.\n2. the last element [3] must be NULL</p>\n\n<pre><code>       args[0] = \"some-execution-file-name\";\n       args[1] = argv[count];\n       args[2] = argv[count + 1];\n       args[3] = NULL;\n</code></pre>\n\n<p>Otherwise the function has no idea about the size of the array and slave can die trying to read element [0].</p>\n"}], "owner": {"reputation": 5, "user_id": 7397480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vsn6N.png?s=128&g=1", "display_name": "Christian Mcdermott", "link": "https://stackoverflow.com/users/7397480/christian-mcdermott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52731110, "answer_count": 1, "score": 0, "last_activity_date": 1539132204, "creation_date": 1539131656, "question_id": 52731050, "link": "https://stackoverflow.com/questions/52731050/getting-segmentation-fault-on-master-slave", "title": "Getting segmentation fault on master/slave", "body": "<p>can anyone explain to me why I am getting a segmentation fault on this code? I have been trying to figure it out and have come up empty on various searches. When I run the code without calling main(argc, argv) it runs. Slave only transforms the 2 numbers in argv to ints then returns them. Thanks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char* argv[])\n{\n    int i;\n    int* sums;\n    sums[argc];\n    pid_t cpid;\n    int status;\n    char* args[10];\n    int count = 1;\n\n    for(i = 0; i &lt; (argc / 2); i++) {\n        cpid = fork();\n\n        if(cpid == 0) {\n            args[1] = argv[count];\n            args[2] = argv[count + 1];\n            execvp(\"./slave\", args);\n        } else {\n            waitpid(cpid, &amp;status, 0);\n            sums[i] = WEXITSTATUS(status);\n\n            printf(\"Child returned the number %d\\n\", sums[i]);\n            sprintf(argv[i+1], \"%d\", sums[i]);\n        }\n        count += 2;\n    }\n\n    if(sums[0] == 0) {\n        printf(\"done\\n\");\n    } else {\n        main(argc/2, args);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "input", "scanf"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539129794, "post_id": 52730828, "comment_id": 92386694, "body": "what did you see in readValue and ID when you used your debugger?"}, {"owner": {"reputation": 2295, "user_id": 792779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99528e625676b23a593f5a3daa005793?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/792779/john"}, "edited": false, "score": 3, "creation_date": 1539129807, "post_id": 52730828, "comment_id": 92386698, "body": "It appears that you may be misunderstanding the question. It seems that the quantities are provided on one line of input (to be then stored into an array), and then an index is provide on the next line. I think you&#39;re supposed to output the quantity at the given index (index of the array you built from the first line of input)."}, {"owner": {"reputation": 51, "user_id": 9819777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327f64edf41ead5c1caa1b43447b114b?s=128&d=identicon&r=PG&f=1", "display_name": "Losercoder2345", "link": "https://stackoverflow.com/users/9819777/losercoder2345"}, "edited": false, "score": 0, "creation_date": 1539130197, "post_id": 52730828, "comment_id": 92386798, "body": "My bad, I meant to say it displays the value at that index, which was my intention with: printf(&quot;%d&quot;,ingred[ID]);"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1539133324, "post_id": 52730828, "comment_id": 92387462, "body": "@VictorNovelo: Then please update your question, including the title."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9819777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327f64edf41ead5c1caa1b43447b114b?s=128&d=identicon&r=PG&f=1", "display_name": "Losercoder2345", "link": "https://stackoverflow.com/users/9819777/losercoder2345"}, "edited": false, "score": 0, "creation_date": 1539131816, "post_id": 52731029, "comment_id": 92387150, "body": "Thank you, it turns out that where the error was. I was taking 9 ingredients instead of 10. Much appreciated :)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1539241647, "post_id": 52731029, "comment_id": 92431733, "body": "Note, this input routine is horribly fragile. One slip of the keyboard and an <code>&#39;r&#39;</code> tapped instead of <code>&#39;5&#39;</code> and it is toast. Always check the <b>return</b> of <code>scanf</code> and handle the 3-cases (1) <code>EOF</code>; (2) a <i>matching</i> or <i>input</i> failure (and in case of a <i>matching</i> failure remove the unmatched characters from your input buffer); and finally (3) handle the good-input case."}], "tags": [], "owner": {"reputation": 83, "user_id": 10475607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/529d9dee77b15c4a0587613e556bef20?s=128&d=identicon&r=PG&f=1", "display_name": "kaylani2", "link": "https://stackoverflow.com/users/10475607/kaylani2"}, "is_accepted": false, "score": 1, "last_activity_date": 1539131476, "creation_date": 1539131476, "answer_id": 52731029, "question_id": 52730828, "link": "https://stackoverflow.com/questions/52730828/stuck-on-how-to-get-the-indexs-value-from-an-array-of-a-user-defined-value/52731029#52731029", "title": "Stuck on how to get the index&#39;s value from an array of a user defined value", "body": "<p>Is it a requirement to read all of the quantities from a single line? Because that can be a little tricky to perform with scanf.\nYou could iterate trough a loop and get all of the quantities one by one, like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n  int ingredients [10];\n  int newQuantity = 0;\n  int ingredientId;\n  int index;\n\n  for (index = 0; index &lt; 10; index++)\n  {\n      printf (\"Enter quantity #%d: \", index);\n      scanf (\"%d\", &amp;newQuantity);\n      ingredients [index] = newQuantity;\n\n  }\n\n  printf (\"Enter the ID: \");\n  scanf (\"%d\", &amp;ingredientId);\n  printf (\"Quantity: %d\\n\", ingredients [ingredientId]);\n\n  return 0;\n}\n</code></pre>\n\n<p>On your code you tried to read a pair of integer values nine times in your loop. That's also something to note: despite array indexes beginning at 0, when you declare an array, the value between brackets is the number of elements of the array, not the index of the last element.</p>\n"}], "owner": {"reputation": 51, "user_id": 9819777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327f64edf41ead5c1caa1b43447b114b?s=128&d=identicon&r=PG&f=1", "display_name": "Losercoder2345", "link": "https://stackoverflow.com/users/9819777/losercoder2345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539230439, "creation_date": 1539129585, "last_edit_date": 1539230439, "question_id": 52730828, "link": "https://stackoverflow.com/questions/52730828/stuck-on-how-to-get-the-indexs-value-from-an-array-of-a-user-defined-value", "title": "Stuck on how to get the index&#39;s value from an array of a user defined value", "body": "<p>I'm trying to write C code where the user inputs 10 values and the index, and the output should display the index's value from the 10 values set by the user.</p>\n\n<p>The problem statement:</p>\n\n<p>Your grandparents gave you a fantastic cooking recipe but you can never remember how much of each ingredient you have to use! There are 10 ingredients in the recipe and the quantities needed for each of them are given as input (in grams). Your program must read 10 integers (the quantities needed for each of the ingredients, in order) and store them in an array. It should then read an integer which represents an ingredient's ID number (between 0 and 9), and output the corresponding quantity</p>\n\n<p>Example Input:</p>\n\n<p>500 180 650 25 666 42 421 1 370 211</p>\n\n<p>3</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\nint ingred[9];\nint readValue = 0;\nint ID;\nfor(int i = 0; i &lt; 9;i++){\n    scanf(\"%d %d\", &amp;readValue,&amp;ID);\n    ingred[i] = readValue;\n\n}\nprintf(\"%d\",ingred[ID]);\nreturn 0;\n}\n</code></pre>\n\n<p>My output is always 0. Doesn't the scanf() function read the next line of code after the user presses \"enter\"? Please help.</p>\n"}, {"tags": ["c", "directory"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539131157, "post_id": 52730791, "comment_id": 92387009, "body": "Yes, it can be done. It is fairly straight-forward to sort the files so that they are listed in order biggest to smallest.  There are some trickinesses to do with FIFOs, Unix-domain sockets and other odd-ball file types that you can probably ignore, and you need to decide what to do with symlinks and directories, but the basic process is to read the name and the size from the <code>stat()</code> \u2014 or <code>lstat()</code> \u2014 data and sort according to that saved size."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539131641, "post_id": 52730791, "comment_id": 92387108, "body": "Note that you have to have a mechanism (probably an array) of some suitable (structure) type to store all the names and sizes before you can sort them into order.  Which platform are you on?  POSIX-like, or Windows, or something else?  The basic POSIX functions to use a <code>opendir()</code>, <code>readdir()</code> etc; but you&#39;d probably do better using <code>nftw()</code> or even <code>fts</code> (<code>fts_open()</code>, <code>fts_read()</code>, etc), perhaps."}, {"owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539133048, "post_id": 52730791, "comment_id": 92387386, "body": "I&#39;m using a Windows by I&#39;m writing my code through Putty via connecting to my universities server, so I&#39;m doing everything through a Linux Unix terminal, if that changes anything."}], "owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539131040, "creation_date": 1539129310, "last_edit_date": 1539131040, "question_id": 52730791, "link": "https://stackoverflow.com/questions/52730791/in-c-code-is-there-any-possible-way-i-could-sort-the-files-in-directory-such-th", "title": "In C code, is there any possible way I could sort the files in directory such that it prints most bytes to the least bytes?", "body": "<p>So currently my current code is as so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n\n#define sizeFileName 500\n#define filesMax 5000\n\nint main( int argc, char ** argv) {\n  FILE * fp = popen( \"find . -type f\", \"r\");\n  char * type = argv[1];\n  //printf(\"%s\\n\",type);\n  int amount = atoi(argv[2]);\n  //printf(\"%d\\n\",amount);\n  char buff[sizeFileName];\n  int nFiles = 0;\n  char * files[filesMax];\n  while(fgets(buff,sizeFileName,fp)) {\n    int leng = strlen(buff) - 1;\n    if (strncmp(buff + leng - 4, type, 4) == 0){\n      files[nFiles] = strndup(buff,leng);\n      //printf(\"\\t%s\\n\", files[nFiles]);\n      nFiles ++;\n    }\n  }\n  fclose(fp);\n  printf(\"Found %d files\\n\", nFiles);\n\n  long long totalBytes = 0;\n  struct stat st;\n  for(int i = 0;i&lt; nFiles; i ++) {\n    if(0!= stat(files[i],&amp;st)){\n      perror(\"stat failed:\");\n      exit(-1);\n    }\n    totalBytes += st.st_size;\n    printf(\"%s : %ld\\n\",files[i],st.st_size);\n  }\n  printf(\"Total size: %lld\\n\", totalBytes);\n  // clean up\n  for(int i = 0; i &lt; nFiles ; i ++ ) {\n    free(files[i]);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>The output would be: </p>\n\n<pre><code> ./find .txt 5\nFound 39 files\n./Work/assignment 3/testing/README.txt : 234\n./Work/assignment 3/testing/typescript.txt : 30998\n./Work/assignment 5/README.txt : 175\n./Work/assignment 2/README.txt : 233\n./Work/assignment 2/typescript.txt : 18095\n./Work/typescript.txt : 12503\n./Work/assignment 1/assignment01_test.txt : 3356\n./Work/assignment 1/cpsc231_A1_dou.txt : 1807\n./.pki/nssdb/pkcs11.txt : 452\n./simple.txt : 55\n./.cache/tracker/locale-for-miner-user-guides.txt : 11\n./.cache/tracker/no-need-mtime-check.txt : 5\n./.cache/tracker/locale-for-miner-apps.txt : 11\n./.cache/tracker/db-version.txt : 2\n./.cache/tracker/first-index.txt : 5\n./.cache/tracker/parser-sha1.txt : 40\n./.cache/tracker/parser-version.txt : 22\n./.cache/tracker/db-locale.txt : 11\n./.cache/tracker/last-crawl.txt : 10\n./romeo-and-juliet.txt : 178983\n./335/335 assign1/script2.txt : 2517\n./335/335 assign1/script1.txt : 4543\n./335/assign4 folder/script.txt : 42042\n./script.txt : 8918\n./readme.txt : 3243\n./.mozilla/firefox/7rzagn8z.default/AlternateServices.txt : 0\n./.mozilla/firefox/7rzagn8z.default/revocations.txt : 43369\n./.mozilla/firefox/7rzagn8z.default/TRRBlacklist.txt : 0\n./.mozilla/firefox/7rzagn8z.default/serviceworker.txt : 310\n./.mozilla/firefox/7rzagn8z.default/SecurityPreloadState.txt : 0\n./.mozilla/firefox/7rzagn8z.default/SiteSecurityServiceState.txt : 7776\n./.mozilla/firefox/7rzagn8z.default/pkcs11.txt : 890\n./.config/libreoffice/4/user/uno_packages/cache/log.txt : 1015\n./.thunderbird/os4hur49.default/SiteSecurityServiceState.txt : 150\n./.thunderbird/os4hur49.default/revocations.txt : 8243\n./.thunderbird/os4hur49.default/SecurityPreloadState.txt : 0\n./.thunderbird/os4hur49.default/AlternateServices.txt : 0\n./Templates/demo.txt : 9\n./Templates/typescript.txt : 1549\nTotal size: 371582\n</code></pre>\n\n<p>Currently my first argument is take in the file type I am looking for while the second argument is suppose to take in the int value of the amount I want. (This is not set up yet in my code however I can take care of that on my own) However as shown in the output, it's all unsorted. I was wondering that is their anyway to print out the contents of <code>char * files</code> but in a sorted order from most bytes to least bytes?</p>\n"}, {"tags": ["c++", "c", "gcc", "dynamic-library", "unix-ar"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1539126504, "post_id": 52730365, "comment_id": 92385958, "body": "<code>ar</code> is really just a tool for concatenating multiple files into a single file, and allow you to extract them, possibly with an index. It is not a tool that knows anything about the C++ or C build process  or dynamic libraries."}, {"owner": {"reputation": 656, "user_id": 2370920, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62919ba29b5559eb7bd436694b757f3f?s=128&d=identicon&r=PG", "display_name": "abdus_salam", "link": "https://stackoverflow.com/users/2370920/abdus-salam"}, "edited": false, "score": 0, "creation_date": 1539127016, "post_id": 52730365, "comment_id": 92386064, "body": "@NeilButterworth yes, I appreciate that. So, I&#39;m more after an option to add something to a section in the archive/elf headers which then to be parsed and processed by the linker. A bit like the compiler passing whatever goes after -Wl, to the linker, without having to understand what it means."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1539128667, "post_id": 52730365, "comment_id": 92386430, "body": "Modifying the headers? At build phase (when an <i>.elf</i> might not even be generated)? Please check <a href=\"https://stackoverflow.com/help/mcve\">&#91;SO&#93;: How to create a Minimal, Complete, and Verifiable example (mcve)</a> and then reduce the problem you think you&#39;re having into an answerable one."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1539129255, "post_id": 52730365, "comment_id": 92386582, "body": "Shared libraries allow you to relay that information if you&#39;re careful; static libraries do not.  If you want the convenience, use shared libraries.  If you can&#39;t use shared libraries, I believe you&#39;ll have to accept the inconvenience of knowing which other libraries to link without being able to record it in the archive library files in a way that the compiler/linker can use."}, {"owner": {"reputation": 656, "user_id": 2370920, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62919ba29b5559eb7bd436694b757f3f?s=128&d=identicon&r=PG", "display_name": "abdus_salam", "link": "https://stackoverflow.com/users/2370920/abdus-salam"}, "edited": false, "score": 0, "creation_date": 1539164675, "post_id": 52730365, "comment_id": 92399149, "body": "this link <a href=\"http://www.kaizou.org/2015/01/linux-libraries/\" rel=\"nofollow noreferrer\">kaizou.org/2015/01/linux-libraries</a> provides a very detailed, all around explanation to different options and consequences."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543392888, "post_id": 52730365, "comment_id": 93898652, "body": "You could look and see whether <code>libtool</code> handles dependencies for static libraries; it might, but I&#39;m not sure and am feeling too lazy to research it right now."}], "owner": {"reputation": 656, "user_id": 2370920, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62919ba29b5559eb7bd436694b757f3f?s=128&d=identicon&r=PG", "display_name": "abdus_salam", "link": "https://stackoverflow.com/users/2370920/abdus-salam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539125706, "creation_date": 1539125706, "question_id": 52730365, "link": "https://stackoverflow.com/questions/52730365/hint-the-dynamic-library-dependencies-in-the-archive-file", "title": "hint the dynamic library dependencies in the archive file", "body": "<p>In my c/c++ mixed project, I'm building the source files of individual folders, archiving them with <code>ar</code> into their own <code>.a</code> files and then  linking them all together at the final stage. So far so good. My question is, is it possible to hint any dynamic library dependencies at the <code>ar</code> stage so, they don't have to be specified explicitly at the linking stage?</p>\n\n<p>I mean, if a component depends on pthread and the final binary will need to link against it, possibly dynamically, can it not add this dependency to the archive, to be resolved later by the linker?</p>\n\n<p>Would using the linker instead of <code>ar</code> to create partially linked objects rather than archives provide any such facility to hint dynamic lib dependencies to be satisfied at the final linking stage?</p>\n"}, {"tags": ["c", "gcc", "x86", "floating-point", "double"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1539125285, "post_id": 52730270, "comment_id": 92385711, "body": "Print <code>x</code> and <code>d</code> with the <code>%a</code> format specifier both before and after the calculation.  It will print them as hex floating point and will give you a better idea of where the differences are."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1539125503, "post_id": 52730270, "comment_id": 92385746, "body": "Try checking to see the differences in your floating-point environment.  There&#39;s a lot of information to digest in section 7.6 of the C11 standard.  Of particular interest may be the rounding mechanism which can be gotten with <code>fegetround()</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1539126681, "post_id": 52730270, "comment_id": 92385997, "body": "Can you use SSE2 math in 32-bit mode as well, avoiding the 80-bit x87 temporary registers entirely?  <code>gcc -m32 -msse2 -mfpmath=sse</code>.  Oh NVM, if <code>-ffloat-store</code> does the opposite of what you want, then you need to use x87 in 64-bit mode, maybe with <code>-mfpmath=x87</code>.  This might have big performance downsides, and auto-vectorization can still use SSE2.  You&#39;re compiling with <code>-O3</code>, right?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539126829, "post_id": 52730270, "comment_id": 92386021, "body": "Is your goal to get the <i>same</i> result or the <i>best</i> result?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1539126837, "post_id": 52730270, "comment_id": 92386022, "body": "@ChristianGibbons: The default rounding mode is always NEAREST.  The C11 standard won&#39;t help you with this: <code>gcc -m32</code> using x87 FP violates it by keeping extra precision for temporaries even across statements, because <code>-ffloat-store</code> has extreme performance downsides.  And the OP says they want the extra precision in 64-bit mode as well, rather than strict rounding to 64-bit <code>double</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1539127077, "post_id": 52730270, "comment_id": 92386079, "body": "@Ronan: related: <a href=\"https://randomascii.wordpress.com/2012/03/21/intermediate-floating-point-precision/\" rel=\"nofollow noreferrer\">randomascii.wordpress.com/2012/03/21/&hellip;</a> and <a href=\"https://randomascii.wordpress.com/2013/07/16/floating-point-determinism/\" rel=\"nofollow noreferrer\">randomascii.wordpress.com/2013/07/16/floating-point-determin&zwnj;&#8203;ism</a> for more about x86 FP gotchas.  You might need to use <code>long double</code>.  (It&#39;s 80-bit x87 FP on Linux, but in the Windows x64 ABI <code>long double</code> = <code>double</code>, so even <code>long double</code> might not help you on Windows.).  (correction to a previous comment: <code>-m64 -mfpmath=387</code>, not <code>=x87</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1539127226, "post_id": 52730270, "comment_id": 92386110, "body": "It is useful to report <code>FLT_EVAL_METHOD</code> of both systems. <code>printf(&quot;FLT_EVAL_METHOD %d\\n&quot;, FLT_EVAL_METHOD);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539127771, "post_id": 52730270, "comment_id": 92386219, "body": "&quot;but in my full test cases the error can add up and be enough to double my output.&quot; --&gt; As the difference in the 2 products is only 1 ULB, that difference is explainable from from different <code>FLT_EVAL_METHOD</code>.  Yet the <i>real</i> solution is to adjust your unposted code to not &quot;double my output&quot;.  IOWs, Your approach is too sensitive and needs to be re-thought.  Posting code to demonstrate  &quot;double my output&quot;  would be useful."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1539128577, "post_id": 52730270, "comment_id": 92386398, "body": "I changed the 64-bit tag to floating-point, since floating-point is more relevant. (64-bit is not even Intel-specific; it is a pretty generic tag which is not as useful here as the floating-point tag.)"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1539128485, "post_id": 52730637, "comment_id": 92386368, "body": "@R..: I would recommend that too if they only needed determinism, but the question says they really want the more precise <code>..01</code> result, not the <code>..03</code> result."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1539128627, "post_id": 52730637, "comment_id": 92386415, "body": "@R..: but thanks for pointing that out, added a section at the top to recommend that for everyone else."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1539128761, "post_id": 52730637, "comment_id": 92386458, "body": "I see OP requested the \u201copposite\u201d result but not that they requested a more precise or more accurate result. My interpretation of their request for the \u201copposite\u201d result was they were requesting the 32-bit result, not requesting a more accurate result."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1539130324, "post_id": 52730637, "comment_id": 92386824, "body": "@EricPostpischil: That&#39;s true, perhaps there&#39;s some other reason for needing to match the 32-bit result.  I upvoted R..&#39;s answer.  But it seems likely they do think they need extra precision, because they&#39;re considering things like recompiling the 32-bit version with <code>-ffloat-store</code>.  Anyway, I think the multiple answers collectively answer whatever someone might be asking if a search takes them here, or at least get them started."}, {"owner": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1539269933, "post_id": 52730637, "comment_id": 92449457, "body": "Absolutely great answer! Many concepts I still need to grasp are touched. However, what really fixed my problem was actually your comment to my question: since I was still debugging, optimizations were off. When I enabled, even with only <code>-O1</code>, my program started giving correct results. Thanks a lot @PeterCordes! Now I have a starting point and can check each optimization to find what is the problem. What still puzzles me is that on 32-bit the optimizations were also off, but I didn&#39;t hit this problem."}, {"owner": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1539270333, "post_id": 52730637, "comment_id": 92449706, "body": "@PeterCordes to clarify my requirements, I don&#39;t need <i>absolute, bit-by-bit precision</i> on my calculations, and probably I traced the test sample to something which may not be correct. However, I&#39;m implementing a standard, which has (printed) tables with some results I need to replicate by some decimal places. Due to those problems I met, some results were doubled or halved, which of course is unacceptable for any number of significant digits. Anyway, as some people write, some results are wrong if you can&#39;t replicate it bit-by-bit."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1539276603, "post_id": 52730637, "comment_id": 92453121, "body": "@RonanPaix&#227;o: <code>-O0</code> still computes a single statement in registers, not rounding off the <code>30.07*x</code> to 64-bit <code>double</code> before adding the old value of <code>d</code>.  Since it&#39;s 32-bit using x87, this is done in 80-bit precision."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1539276846, "post_id": 52730637, "comment_id": 92453252, "body": "@RonanPaix&#227;o: IEEE FP requires that all the basic operators (+ - * / and sqrt) give correct results to within 0.5ulp, i.e. all the signficand bits correct to the nearest representable value.  If a chain of calculations doesn&#39;t have enough precision after that, you should be looking at the numerical stability of what you&#39;re doing.  e.g. look for catastrophic cancellation when subtracting two nearby number.  Simply increasing precision for temporaries might be a sufficient band-aid for some compilers / options, but numerical techniques for side-stepping / correcting rounding error are possible."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1539128595, "last_edit_date": 1539128595, "creation_date": 1539128083, "answer_id": 52730637, "question_id": 52730270, "link": "https://stackoverflow.com/questions/52730270/how-do-i-get-the-same-behavior-for-double-precision-operations-in-both-32-bit-an/52730637#52730637", "title": "How do I get the same behavior for double precision operations in both 32-bit and 64-bit modes?", "body": "<p>Since you said you need the more precise <code>...01</code> result, as well as determinism, you unfortunately can't just use <code>-msse2 -mfpmath=sse</code> in your 32-bit build.  Future readers looking for determinism should use that.</p>\n\n<hr>\n\n<p>You can use <code>-mfpmath=387</code> to ask gcc to use slow/obsolete x87 math in 64-bit mode, where it's not the default.  The calling convention passes/returns FP args in xmm registers, so this is even worse than in 32-bit mode, sometimes requiring extra store/reload.</p>\n\n<pre><code>peter@volta:/tmp$ gcc -m64 -mfpmath=387 -O3 fp-prec.c -o fp-64-387\npeter@volta:/tmp$ ./fp-64-387 \n64 bits: 13.904254700000001\n</code></pre>\n\n<p>I'm not sure if gcc strictly limits itself to x87 when auto-vectorization is possible.  If so, you're missing out on performance.</p>\n\n<hr>\n\n<p>And BTW, in your example the <code>...01</code> is the result of keeping <em>extra</em> precision in an 80-bit temporary for the <code>x*30.07</code> before adding it to <code>d</code>.  (<code>d</code> is <code>volatile</code>, but <code>d += stuff</code> is still equivalent to <code>d = d + stuff</code> so the <code>x*30.07</code> doesn't get rounded to 64-bit <code>double</code> first).</p>\n\n<p><strong>You could use <code>long double</code>, e.g. <code>d += x * (long double)30.07</code> to force an 80-bit temporary there.</strong>  <code>long double</code> is 80 bits in the x86-64 System V ABI Linux/OS X/*BSD/etc, but on x64 Windows it's the same as 64-bit <code>double</code>.  So that might not be an option for you.</p>\n\n<hr>\n\n<p>In this case you can get the same result with an FMA which keeps infinite precision for the multiply before doing the add.  This is slow on hardware without FMA support, but <code>fma(d, 30.07, x)</code> will reliably give the result you want.</p>\n\n<p>If you need this, use it in the places where that precision is required.</p>\n\n<p>If you compile with FMA enabled, it can inline to an FMA instruction.  (e.g. <code>-march=native</code> on my Skylake CPU)</p>\n\n<p>Even without using the <code>fma()</code> math.h function, gcc will contract mul+add expressions into FMA when optimizing.  (Unlike Clang, which I think doesn't do <code>FP_CONTRACT</code> by default without <code>-ffast-math</code>).  Note that I'm <em>not</em> using <code>-march=387</code></p>\n\n<pre><code> # your original source code, using an FMA instruction (native=skylake in my case)\npeter@volta:/tmp$ gcc -m64 -march=native -O3 fp-prec.c -o fp-64-native\npeter@volta:/tmp$ ./fp-64-native \n64 bits: 13.904254700000001\n</code></pre>\n\n<p>The relevant part of <code>main</code> is:</p>\n\n<pre><code> 57e:   c5 fb 10 44 24 08       vmovsd xmm0,QWORD PTR [rsp+0x8] # load x\n 584:   c5 fb 10 0c 24          vmovsd xmm1,QWORD PTR [rsp]     # load d\n 589:   c4 e2 f1 99 05 d6 01 00 00      vfmadd132sd xmm0,xmm1,QWORD PTR [rip+0x1d6]        # the 30.07 constant\n 592:   c5 fb 11 04 24          vmovsd QWORD PTR [rsp],xmm0     # store d\n 597:   c5 fb 10 04 24          vmovsd xmm0,QWORD PTR [rsp]     # reload d\n 59c:   e8 8f ff ff ff          call   530 &lt;printf@plt&gt;\n</code></pre>\n\n<hr>\n\n<p>FP determinism is <em>hard</em> in general.</p>\n\n<p>See also <a href=\"https://randomascii.wordpress.com/2013/07/16/floating-point-determinism/\" rel=\"nofollow noreferrer\">https://randomascii.wordpress.com/2013/07/16/floating-point-determinism/</a> and <a href=\"https://randomascii.wordpress.com/2012/03/21/intermediate-floating-point-precision/\" rel=\"nofollow noreferrer\">https://randomascii.wordpress.com/2012/03/21/intermediate-floating-point-precision/</a></p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 2, "last_activity_date": 1539128879, "creation_date": 1539128879, "answer_id": 52730730, "question_id": 52730270, "link": "https://stackoverflow.com/questions/52730270/how-do-i-get-the-same-behavior-for-double-precision-operations-in-both-32-bit-an/52730730#52730730", "title": "How do I get the same behavior for double precision operations in both 32-bit and 64-bit modes?", "body": "<p>I would not aim to reproduce the 32-bit output, since it's a consequence of excess precision in the 32-bit x86 (x87) ABI and possibly also compiler non-conformance. Instead try to match the 64-bit output which is what you should expect on good targets. As long as you're okay with requiring a machine with sse2+, <code>-mfpmath=sse</code> will make 32-bit x86 behave like 64-bit and other more reasonable targets.</p>\n\n<p>If you really need the result from 32-bit x86, ideally you should write it portably. This might involve breaking things down into a pair of <code>double</code>s, but for x86-only you could just use <code>long double</code>. In the particular example in your question, the <code>fma</code> function would work, too.</p>\n"}], "owner": {"reputation": 6319, "user_id": 3754432, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcf9ff1192f75be8c4b94b025019d4c2?s=128&d=identicon&r=PG&f=1", "display_name": "Ronan Paix&#227;o", "link": "https://stackoverflow.com/users/3754432/ronan-paix%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 52730637, "answer_count": 2, "score": 3, "last_activity_date": 1539128879, "creation_date": 1539124827, "last_edit_date": 1539128533, "question_id": 52730270, "link": "https://stackoverflow.com/questions/52730270/how-do-i-get-the-same-behavior-for-double-precision-operations-in-both-32-bit-an", "title": "How do I get the same behavior for double precision operations in both 32-bit and 64-bit modes?", "body": "<p>I have a library that I'm converting to 64-bits. However, I can't get bit-exact results on 64-bit mode, so my tests are failing.</p>\n\n<p>I reduced the problem to a simple test case:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    printf(\"%d bits: \", sizeof(void*) * 8);\n    volatile double d = 10.870191700000001;\n    volatile double x = 0.10090000000000002;\n    d += x * 30.07;\n    printf(\"%0.15f\\n\", d);\n}\n</code></pre>\n\n<p>To avoid compiler differences, I'm using the same compiler and cross compiling. In this case, I'm using TDM-GCC 64-bit 5.1.0 on Windows 7 in a Core i5 CPU. Here is my command-line:</p>\n\n<pre><code>gcc double_test.c -o double_test.exe -m32 -O0 &amp;&amp; double_test.exe &amp;&amp; gcc double_test.c -o double_test.exe -m64 -O0 &amp;&amp; double_test.exe\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>32 bits: 13.904254700000001\n64 bits: 13.904254700000003\n</code></pre>\n\n<p>In this case the error is minimal, but in my full test cases the error can add up and be enough to double my output.</p>\n\n<p><strong>How can I get bit-exact operations to match the 32-bit output?</strong></p>\n\n<p>The nearest I got to something relevant was to use <code>-ffloat-store</code>, but in this snippet it got the 32-bit execution like the 64-bit one, while I need just the opposite. However, this didn't have any noticeable effect upon my library. I also tested the <code>-fexcess-precision=standard</code> and <code>-mfp-math</code> options to no avail.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 0, "creation_date": 1539123292, "post_id": 52730027, "comment_id": 92385214, "body": "post your code even if it not work, it would be easier to help."}, {"owner": {"reputation": 15524, "user_id": 10366495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pRi10.png?s=128&g=1", "display_name": "Shidersz", "link": "https://stackoverflow.com/users/10366495/shidersz"}, "edited": false, "score": 0, "creation_date": 1539123400, "post_id": 52730027, "comment_id": 92385244, "body": "Give an example with your code, and read about how to pass elements by reference in C."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1539124329, "post_id": 52730027, "comment_id": 92385492, "body": "Take the <a href=\"https://stackoverflow.com/tour\">tour</a>, read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1539123301, "creation_date": 1539123301, "answer_id": 52730067, "question_id": 52730027, "link": "https://stackoverflow.com/questions/52730027/argument-for-function-to-edit-an-array-of-structs/52730067#52730067", "title": "Argument for function to edit an array of structs", "body": "<pre><code>int performTask(struct npc**sums)\n{\n// to hit sums 5\n    sums[5]-&gt;thingy = 42;\n}\n</code></pre>\n\n<p>note that you will also have to pass in a size argument. There is no way to determine the size of the array in <code>performTask</code></p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10480989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53bca2e3b1d1131bb08ef7b480cc15f9?s=128&d=identicon&r=PG", "display_name": "user10480989", "link": "https://stackoverflow.com/users/10480989/user10480989"}, "edited": false, "score": 0, "creation_date": 1539126839, "post_id": 52730201, "comment_id": 92386025, "body": "Thanks alot. Seems like I wasn&#39;t far off, didn&#39;t know you could iterate with a pointer like that. Very quick and thorough answer!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 23, "user_id": 10480989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53bca2e3b1d1131bb08ef7b480cc15f9?s=128&d=identicon&r=PG", "display_name": "user10480989", "link": "https://stackoverflow.com/users/10480989/user10480989"}, "edited": false, "score": 0, "creation_date": 1539130066, "post_id": 52730201, "comment_id": 92386757, "body": "Just remember when working with an array of struct when passed as a pointer, the <code>[..]</code> serves as a <b>dereference</b> of the pointer. So if you pass an array of struct as <code>struct foo *arr</code> then <code>arr[i]</code> is a dereference of the pointer leaving type <code>struct foo</code> requiring the use of the <code>&#39;.&#39;</code> (dot) operator to access the <i>members</i> instead of the <code>&#39;-&gt;&#39;</code> (arrow operator) you use when dereferencing a <i>pointer to struct</i>. The <code>[..]</code> already serves as the dereference here."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1539124123, "creation_date": 1539124123, "answer_id": 52730201, "question_id": 52730027, "link": "https://stackoverflow.com/questions/52730027/argument-for-function-to-edit-an-array-of-structs/52730201#52730201", "title": "Argument for function to edit an array of structs", "body": "<p>If you need to pass an array of struct (or an array of anything), simply pass a pointer. An array, on access, is converted to a pointer<sup>1</sup>.</p>\n\n<p>The only caveat is if you are passing the address for a linked list to a function where the list address may change (in that case you must pass the <strong>address of</strong> the pointer so that the list address may be changed if the first node is changed)</p>\n\n<p>Otherwise, in your case, as long as there has been storage allocated for the array of struct prior to passing to the function, simply passing a pointer is fine, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NS 4\n\ntypedef struct {    /* structure */\n    int a, b;\n} ints;\n\nvoid change (ints *s)   /* function taking pointer to struct */\n{\n    for (int i = 0; i &lt; NS; i++)\n        s[i].a = i+1, s[i].b = i+1;\n}\n\nint main (void) {\n\n    ints arr[NS] = {{0}};   /* array of struct initialized zero */\n\n    change (arr);           /* passed to function */\n\n    for (int i = 0; i &lt; NS; i++)    /* changes output */\n        printf (\"arr[%d]: (%d, %d)\\n\", i, arr[i].a, arr[i].b);\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/structpass\narr[0]: (1, 1)\narr[1]: (2, 2)\narr[2]: (3, 3)\narr[3]: (4, 4)\n</code></pre>\n\n<p><strong>footnotes:</strong></p>\n\n<p><strong>[1]</strong> <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a></p>\n"}], "owner": {"reputation": 23, "user_id": 10480989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53bca2e3b1d1131bb08ef7b480cc15f9?s=128&d=identicon&r=PG", "display_name": "user10480989", "link": "https://stackoverflow.com/users/10480989/user10480989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 52730201, "answer_count": 2, "score": 1, "last_activity_date": 1539124123, "creation_date": 1539122976, "question_id": 52730027, "link": "https://stackoverflow.com/questions/52730027/argument-for-function-to-edit-an-array-of-structs", "title": "Argument for function to edit an array of structs", "body": "<p>I have a Array of structs <code>struct npc sum[arraysize];</code> in which every struct represents an NPC with different integer values. I want to loop-through <code>sum[i]</code> a set number of times and call a function:</p>\n\n<p><code>int performTask(argument???);</code></p>\n\n<p>This function is supposed to update some integers in the structs (such as one for experience), and return how much experience the npc currently has.</p>\n\n<p>However, I am obviously doing things wrong because whatever I into the function isn't saved in the array. I have tried to pass the struct contained in <code>sum[1]</code> into the function for example. Also to pass pointers as an argument but can't get that to work either.</p>\n\n<p>What would be the proper argument to send in this function in order to edit the structs already saved in the array?</p>\n\n<p>Or more generally, how can I update an array of structs with a function?</p>\n"}, {"tags": ["c", "gcc", "assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1539123103, "post_id": 52730007, "comment_id": 92385163, "body": "And your problem is what exactly?"}, {"owner": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1539123352, "post_id": 52730007, "comment_id": 92385223, "body": "question edited with problems definitions"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1539123531, "post_id": 52730007, "comment_id": 92385282, "body": "Not sure how inlining works, it may very well reuse the same <code>__LINE__</code>. As for your map file: how do you create that?"}, {"owner": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1539123734, "post_id": 52730007, "comment_id": 92385346, "body": "map file - it is output by the linker, not sure which argument triggers that. But what I want to know is how actually to make compiler create an actual symbol for that label and the linker to actually treat it as something &quot;needed&quot; and not just to throw it away as not referenced .."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1539123781, "post_id": 52730007, "comment_id": 92385360, "body": "Globals should not be thrown away, referenced or not, unless you explicitly request that."}, {"owner": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1539123913, "post_id": 52730007, "comment_id": 92385407, "body": "I do ask linker to optimise those away. But since this fellow is not expected to occupy any space in the binary, I am looking for a way to &quot;reference&quot; it, some sort of &quot;__attribute((used))&quot; over it, to tell the linker I want to include it .."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1539124657, "post_id": 52730007, "comment_id": 92385560, "body": "It would probably be simpler to extract the address information before stripping the binary."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1539123760, "post_id": 52730124, "comment_id": 92385354, "body": "GNU C Basic <code>asm</code> (no operands) is implicitly <code>volatile</code>.  So is Extended <code>asm</code> with no output operands."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1539123813, "post_id": 52730124, "comment_id": 92385372, "body": "Hm, interesting. I was unaware of this."}, {"owner": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "edited": false, "score": 0, "creation_date": 1539124004, "post_id": 52730124, "comment_id": 92385428, "body": "Any idea how to also add something like __attribute((used)) for that, so even if the linker is asked to throw away any unreferenced symbols - those labels stay ?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "edited": false, "score": 0, "creation_date": 1539124096, "post_id": 52730124, "comment_id": 92385447, "body": "@LouisShraga: What linker options are you specifically using that is causing this?"}, {"owner": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "edited": false, "score": 0, "creation_date": 1539124251, "post_id": 52730124, "comment_id": 92385476, "body": "Not sure about the linker optimisation flags as this is how I got the build system. The thing is, I dont want to change it since the project is very scarce in memory. So I am just looking for a way to dummy-reference those labels"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "edited": false, "score": 1, "creation_date": 1539124654, "post_id": 52730124, "comment_id": 92385559, "body": "@LouisShraga: You&#39;re going to have to tell us more about the built toolchain. The way <code>__attribute__((used))</code> works is different on different systems."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "edited": false, "score": 0, "creation_date": 1539124772, "post_id": 52730124, "comment_id": 92385581, "body": "@LouisShraga: Note that if your build system includes a call to <code>strip</code>, which is not exactly uncommon, you might just want to start there. You can do things like extract the symbol information into a separate file. It depends on the build system and toolchain."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 0, "last_activity_date": 1539124808, "last_edit_date": 1539124808, "creation_date": 1539123674, "answer_id": 52730124, "question_id": 52730007, "link": "https://stackoverflow.com/questions/52730007/define-a-unique-and-global-assembly-label-symbol-inside-c-functions/52730124#52730124", "title": "Define a unique and global assembly label/symbol inside C functions", "body": "<p>One problem is that you may get multiple copies of the same label due to inlining. Add the following attribute to functions containing these labels:</p>\n\n<pre><code>__attribute__((noinline))\n</code></pre>\n\n<p>Also note that you need to mark the symbol as global. Let's extract this into a macro so we can format nicely without changing the value of <code>__LINE__</code>:</p>\n\n<pre><code>#define MAKE_LABEL \\\n    __asm__( \\\n        \"GLOBAL_LABEL_\" UNIQUE(MYFILE_ID, __LINE__) \":\" \\\n        \"\\n\\t.global GLOBAL_LABEL_\" UNIQUE(MYFILE_ID, __LINE__) \\\n    )\n</code></pre>\n\n<p>But the macro-expansion is off. Unfortunately, I cannot explain to you why this works. But here is the correct macro definition:</p>\n\n<pre><code>#define UN(X) #X\n#define UNIQUE2(X,Y) UN(X##Y)\n#define UNIQUE(X,Y) UNIQUE2(X,Y)\n</code></pre>\n\n<p>Otherwise you will get <code>__LINE__</code> instead of, say, 23.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 2, "last_activity_date": 1539124694, "creation_date": 1539124694, "answer_id": 52730258, "question_id": 52730007, "link": "https://stackoverflow.com/questions/52730007/define-a-unique-and-global-assembly-label-symbol-inside-c-functions/52730258#52730258", "title": "Define a unique and global assembly label/symbol inside C functions", "body": "<p>You can use <code>%=</code> (e.g. <code>label%=:</code>) inside an <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow noreferrer\">Extended-<code>asm</code> template</a> to get the compiler to generate a unique number to avoid name collisions when a function containing inline-asm is inlined multiple times in one compilation unit.</p>\n\n<pre><code>#define STRINGIFY(x) #x\n#define STR(x) STRINGIFY(x)\nint foo(int x) {\n    asm(\"marker\" __FILE__ \"_line\" STR(__LINE__)  \"_uniqueid%=:\" :::);\n    return x+1;\n}\n\n\nint caller1(int x) {\n    return foo(x);\n}\n\nint caller2(int x) {\n    return foo(x);\n}\n</code></pre>\n\n<p>compiles to the following asm with <code>gcc -O3</code> (<a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23define+STRINGIFY(x)+%23x%0A%23define+STR(x)+STRINGIFY(x)%0Aint+foo(int+x)+%7B%0A++++asm(%22marker%22+__FILE__+%22_line%22+STR(__LINE__)++%22_uniqueid%25%3D:%22+:::)%3B%0A++++return+x%2B1%3B%0A%7D%0A%0A%0Aint+caller1(int+x)+%7B%0A++++return+foo(x)%3B%0A%7D%0A%0Aint+caller2(int+x)+%7B%0A++++return+foo(x)+%2B+2%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:51.99203187250996,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:g82,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+8.2+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:48.007968127490045,l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:output,i:(compiler:1,editor:1,wrap:&#39;1&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%231+with+x86-64+gcc+8.2&#39;,t:&#39;0&#39;)),l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:48.007968127490045,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),l:&#39;2&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">on Godbolt</a>):</p>\n\n<pre><code>foo(int):\n        marker/tmp/compiler-explorer-compiler11899-55-1ki0cth.pehm/example.cpp_line4_uniqueid7:\n        lea     eax, [rdi+1]\n        ret\ncaller1(int):\n        marker/tmp/compiler-explorer-compiler11899-55-1ki0cth.pehm/example.cpp_line4_uniqueid22:\n        lea     eax, [rdi+1]\n        ret\ncaller2(int):\n        marker/tmp/compiler-explorer-compiler11899-55-1ki0cth.pehm/example.cpp_line4_uniqueid41:\n        lea     eax, [rdi+3]\n        ret\n</code></pre>\n\n<p>This of course won't assemble because <code>/</code> isn't a valid label character in GAS.</p>\n\n<p>Using <code>MYFILE_ID</code> which contains only characters that can appear in symbol names, this would assemble just fine, and you should be able to see all the <code>marker</code> labels in <code>nm</code> output.</p>\n"}], "owner": {"reputation": 559, "user_id": 1693887, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf662be79feed9f78b2871a2d47d528d?s=128&d=identicon&r=PG", "display_name": "Louis Shraga", "link": "https://stackoverflow.com/users/1693887/louis-shraga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1205, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539124808, "creation_date": 1539122832, "last_edit_date": 1539123918, "question_id": 52730007, "link": "https://stackoverflow.com/questions/52730007/define-a-unique-and-global-assembly-label-symbol-inside-c-functions", "title": "Define a unique and global assembly label/symbol inside C functions", "body": "<p>I want to mark specific C lines with sort of assembler label/symbol which will not occupy any space in the binary but by examining the linker output map file I will know all occurrences of such generated labels and, eventually, of the C code that was \"marked\" this way. So I want to be able to define such labels, and to make them global, and <strong>used</strong> so the linker does not throw it away\nI also need some macros magic to have those labels have a unique name each time the C code is preprocessed ( to make sure each inlined instance of the function has its own label - otherwise I will have duplicate symbols, I guess )</p>\n\n<p>Example :</p>\n\n<pre><code>// my build system will pass -DMYFILE_ID for each file, here I am trying to create a unique literal for each inline instance of the function\n#define UN(X) #X\n#define UNIQUE(X,Y) UN(X##Y)\n\nvoid my_func(void)\n{\n    _asm(\"GLOBAL_LABEL_\"UNIQUE(MYFILE_ID,__LINE__)\":\\n\\t\")\n    my_c_code_I_want_to_track();\n}\n</code></pre>\n\n<p>And what I would like to have at the end, is in the linker output symbols map file, something like that </p>\n\n<pre><code>0xsome_address GLOBAL_LABEL_12_1\n0xdifferent_address GLOBAL_LABEL_12_2\n0xyeanotheraddress GLOBAL_LABEL_13_1\n</code></pre>\n\n<p>which basically should give me an idea at which addresses my_c_code_i_want_to_track got instantiated</p>\n\n<p>The whole idea is sort of inspired by how the labels in assembly are actually \"symbols\" that have a placement and so their addresses can be checked but they dont actually occupy its own space.</p>\n\n<p>Problems :\n1. Is it even possible to have assembly labels be defined like that\n2. How to make those labels stay and appear in the output symbols map file\n3. Something is wrong with the UNIQUE macro as I get \"label redefined\" when trying to compile </p>\n"}, {"tags": ["c", "refactoring", "automated-refactoring", "libclang"], "answers": [{"tags": [], "owner": {"reputation": 727, "user_id": 4866865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7789b80c26c3bc3f9d69580734c220b?s=128&d=identicon&r=PG&f=1", "display_name": "Gamification", "link": "https://stackoverflow.com/users/4866865/gamification"}, "is_accepted": false, "score": 0, "last_activity_date": 1539125695, "creation_date": 1539125695, "answer_id": 52730363, "question_id": 52729963, "link": "https://stackoverflow.com/questions/52729963/how-to-auto-refactor-c-for-loops/52730363#52730363", "title": "how to auto refactor C for loops", "body": "<p>I don't believe this can be done fully automatic without the possibility to introduce bugs.</p>\n\n<p>However, you could use a perl script and manually review changes.</p>\n\n<pre><code>perl -0777 -pe 's/for\\s*\\(\\s*int\\s+([a-zA-Z_][a-zA-Z0-9_]*)\\s*=\\s*0;\\s*\\1\\s*&lt;\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\s*;\\s*\\1\\s*\\+\\+\\s*\\)\\s*\\{\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\[\\1\\]\\s*=\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\[\\1\\]\\s*\\*\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\[\\1\\]\\s*;\\s\\}/vector_multiply(\\4,\\5,\\3,\\2);/igs' test.c\n</code></pre>\n"}], "owner": {"reputation": 553, "user_id": 1736389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eadA5.png?s=128&g=1", "display_name": "Sam P", "link": "https://stackoverflow.com/users/1736389/sam-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539125695, "creation_date": 1539122567, "question_id": 52729963, "link": "https://stackoverflow.com/questions/52729963/how-to-auto-refactor-c-for-loops", "title": "how to auto refactor C for loops", "body": "<p>I have a very large old code base I am slowly updating.</p>\n\n<p>Throughout large parts of the code there are <code>for loops</code> preforming basic math routines that I would like to call back to a function ie to change</p>\n\n<pre><code>for(int i=0;i&lt; NUM_EL; i++)\n{\n   x[i] = a[i] * b[i];\n}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>vector_multiply(a,b,x,NUM_EL);\n</code></pre>\n\n<p>where the prototype for vector_multiply would be</p>\n\n<pre><code>void vector_multiply(const double *a, const double * b, double *x, int num_el);\n</code></pre>\n\n<p>Is there anything out there that scans your source code and converts standard math operations to callback routines?</p>\n\n<p>more specifically would make change your code to make blass callbacks in your code automatically?</p>\n\n<p>Im guessing I could use libclang to do this.</p>\n"}, {"tags": ["c", "struct", "typedef"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 2849789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45cf0a100f7c6d21c7558bb3d739bffb?s=128&d=identicon&r=PG&f=1", "display_name": "user2849789", "link": "https://stackoverflow.com/users/2849789/user2849789"}, "edited": false, "score": 0, "creation_date": 1539122148, "post_id": 52729747, "comment_id": 92384853, "body": "Wow! That was a simple thing and I was breaking my head on it for a while."}], "tags": [], "owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "is_accepted": true, "score": 3, "last_activity_date": 1539121813, "last_edit_date": 1539121813, "creation_date": 1539121407, "answer_id": 52729747, "question_id": 52729700, "link": "https://stackoverflow.com/questions/52729700/incompatible-pointer-types-warning-with-typedef-and-struct/52729747#52729747", "title": "Incompatible pointer types warning with typedef and struct", "body": "<p>Use this:</p>\n\n<pre><code>typedef struct f_queue_node {\n        int pid;\n        struct f_queue_node *next;\n} f_queue_node;\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>typedef struct {\n        int pid;\n        struct f_queue_node *next;\n} f_queue_node;\n</code></pre>\n\n<p>That's happens because of you <code>typedef</code> an <code>anonymous struct</code>.</p>\n\n<p>Also, you miss <code>semicolon</code> here <code>f_queue_node *node</code>, I don't know if you miss it while posting it here or in your code, just a reminder.  </p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 2849789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45cf0a100f7c6d21c7558bb3d739bffb?s=128&d=identicon&r=PG&f=1", "display_name": "user2849789", "link": "https://stackoverflow.com/users/2849789/user2849789"}, "edited": false, "score": 0, "creation_date": 1539122224, "post_id": 52729763, "comment_id": 92384886, "body": "Thanks a lot dbush. Unfortunately, I can only accept one answer. I have accepted the first one."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1539121465, "creation_date": 1539121465, "answer_id": 52729763, "question_id": 52729700, "link": "https://stackoverflow.com/questions/52729700/incompatible-pointer-types-warning-with-typedef-and-struct/52729763#52729763", "title": "Incompatible pointer types warning with typedef and struct", "body": "<p>You have the <code>next</code> field of <code>f_queue_node</code> (a typedef for an anonymous struct) defined as a pointer to <code>struct f_queue_node</code>, but you don't have <code>struct f_queue_node</code> defined anywhere in your code.</p>\n\n<p>You need to give that anonymous struct a tag:</p>\n\n<pre><code>typedef struct f_queue_node {\n        int pid;\n        struct f_queue_node *next;\n}f_queue_node;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 10467442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oOJT0.jpg?s=128&g=1", "display_name": "SegFault42", "link": "https://stackoverflow.com/users/10467442/segfault42"}, "is_accepted": false, "score": 0, "last_activity_date": 1539122083, "creation_date": 1539122083, "answer_id": 52729885, "question_id": 52729700, "link": "https://stackoverflow.com/questions/52729700/incompatible-pointer-types-warning-with-typedef-and-struct/52729885#52729885", "title": "Incompatible pointer types warning with typedef and struct", "body": "<p>You cannot assign node without alloc queue and node.</p>\n\n<p>You have to alloc on the stack :</p>\n\n<pre><code>f_queue queue;\nf_queue_node node \nqueue.rear-&gt;next = &amp;node;\n</code></pre>\n\n<p>or on the heap with malloc :</p>\n\n<pre><code>f_queue *queue = malloc(sizeof(f_queue));\nf_queue_node *node = malloc(sizeof(f_queue_node));\nqueue-&gt;rear-&gt;next = node;\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 2849789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45cf0a100f7c6d21c7558bb3d739bffb?s=128&d=identicon&r=PG&f=1", "display_name": "user2849789", "link": "https://stackoverflow.com/users/2849789/user2849789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 52729747, "answer_count": 3, "score": 2, "last_activity_date": 1539122083, "creation_date": 1539121113, "question_id": 52729700, "link": "https://stackoverflow.com/questions/52729700/incompatible-pointer-types-warning-with-typedef-and-struct", "title": "Incompatible pointer types warning with typedef and struct", "body": "<pre><code>typedef struct {\n        int pid;\n        struct f_queue_node *next;\n}f_queue_node;\n\n\ntypedef struct {\n        f_queue_node *front, *rear;\n}f_queue;\n\nf_queue *queue;\nf_queue_node *node \nqueue-&gt;rear-&gt;next = node;\n</code></pre>\n\n<p>I get a warning whenever I use a pointer of f_queue_node with front and rear. </p>\n\n<p>queue_f.c:39:21: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]</p>\n\n<p>queue->rear->next = node;\n                     ^</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1539120642, "post_id": 52729605, "comment_id": 92384331, "body": "Have you tried <i>iteration</i> ? No headers involved."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1539120669, "post_id": 52729605, "comment_id": 92384342, "body": "<code>&lt;conio.h&gt;</code> isn&#39;t even a standard C header."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1539120735, "post_id": 52729605, "comment_id": 92384364, "body": "<code>strcmp</code> is implemented as a loop.  You could write that yourself."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1539120772, "post_id": 52729605, "comment_id": 92384379, "body": "You could reimplement pretty much all of <code>&lt;string.h&gt;</code> by hand if you&#39;re bored."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1539120792, "post_id": 52729605, "comment_id": 92384390, "body": "and you should show what you have tried"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1539120843, "post_id": 52729605, "comment_id": 92384404, "body": "If you show the code for some of your attempts, someone could find the issue in that code and help you - so please do that instead of just presenting a problem and hope someone writes tall the code for you."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539121149, "post_id": 52729605, "comment_id": 92384509, "body": "You can use a state machine."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1539123170, "post_id": 52729929, "comment_id": 92385180, "body": "And s1 and s2 are not <code>null_ptr</code> or assert this.  And the whole <code>strcmp</code> is evil thing explained.  This is why we can&#39;t have nice things security comment and such. :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1539123616, "post_id": 52729929, "comment_id": 92385311, "body": "@MichaelDorgan The standard lib <code>strcmp()</code> does not require a test for <code>s1, s2</code>   as <code>NULL</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1539123793, "post_id": 52729929, "comment_id": 92385365, "body": "1) <code>return (s1[i] - s2[i]);</code> is not correct when <code>s1[i] &lt; 0</code> (should be an <code>unsigned char</code> compare.) 2)  <code>int i;</code> --&gt; <code>size_t i;</code>."}], "tags": [], "owner": {"reputation": 56, "user_id": 10467442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oOJT0.jpg?s=128&g=1", "display_name": "SegFault42", "link": "https://stackoverflow.com/users/10467442/segfault42"}, "is_accepted": false, "score": 0, "last_activity_date": 1539122366, "creation_date": 1539122366, "answer_id": 52729929, "question_id": 52729605, "link": "https://stackoverflow.com/questions/52729605/is-it-possible-to-compare-string-in-c-just-by-using-stdio-h-and-conio-h-header/52729929#52729929", "title": "is it possible to compare string in c just by using stdio.h and conio.h header?", "body": "<p>You can write your own strcmp.</p>\n\n<p>like this :</p>\n\n<pre><code>int strcmp(const char *s1, const char *s2)\n{\n    int i;\n\n    i = 0;\n    while (s1[i] != '\\0' || s2[i] != '\\0')\n    {\n        if (s2[i] != s1[i])\n            return (s1[i] - s2[i]);\n        i++;\n    }\n    return (0);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10400155, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MLcwEqPe6Is/AAAAAAAAAAI/AAAAAAAAAAc/LFENzfZbG88/photo.jpg?sz=128", "display_name": "Deworm Hood", "link": "https://stackoverflow.com/users/10400155/deworm-hood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1539122366, "creation_date": 1539120596, "last_edit_date": 1539120653, "question_id": 52729605, "link": "https://stackoverflow.com/questions/52729605/is-it-possible-to-compare-string-in-c-just-by-using-stdio-h-and-conio-h-header", "title": "is it possible to compare string in c just by using stdio.h and conio.h header?", "body": "<p>I've tried all ideas of me but all of it doesn't work. I just make a program that when the user type EXIT then the program will exit also just by using two header. The <code>#include&lt;stdio.h&gt;</code> and the <code>#include&lt;conio.h&gt;</code>.</p>\n"}, {"tags": ["c", "pointers", "struct", "file-io"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1539120340, "post_id": 52729480, "comment_id": 92384225, "body": "Once you have a pointer to the character after the semicolon, you can use <code>strtok</code> to break the line into individual tokens. You need to count the tokens, then <code>malloc</code> memory for pointers, then <code>malloc</code> memory for each string, then use <code>strcpy</code> to copy the strings. When allocating memory for a string, remember to allocate one extra byte to hold the NUL terminator."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539121278, "post_id": 52729480, "comment_id": 92384568, "body": "Move <code>i++</code> after the <code>printf()</code> so you don&#39;t have to use <code>i-1</code> in all the array references."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1539121404, "post_id": 52729480, "comment_id": 92384611, "body": "Don&#39;t use magic numbers like <code>str[i] &lt; 58 &amp;&amp; str[i] &gt; 47</code>. C has built-in functions like <code>isdigit()</code> and <code>islower()</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1539121450, "post_id": 52729480, "comment_id": 92384625, "body": "Or <code>str[i] &lt;= &#39;9&#39; &amp;&amp; str[i] &gt;= &#39;0&#39;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539122282, "post_id": 52729480, "comment_id": 92384905, "body": "@Barmar agreed, and (to OP) one thing worse than hard coding a value is to also hard code adjacent values. When the sun rises and you realise they should refer to a common definition, that makes the job even harder. Moroever when you do that edit and you have hard coded say <code>&lt; 8</code> and <code>&lt;= 7</code> it is a dangerous job to distinguish them from every other <code>8</code> and <code>7</code> that you have hard coded in another context."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1539122878, "post_id": 52729480, "comment_id": 92385097, "body": "Also, just a curiosity, why use a <i>relative</i> instead <i>absolute</i> coordinate system?"}, {"owner": {"reputation": 43, "user_id": 10435797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eee92c46fac16820bb955cabd8ff3dc?s=128&d=identicon&r=PG&f=1", "display_name": "vipawahel", "link": "https://stackoverflow.com/users/10435797/vipawahel"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1539125423, "post_id": 52729480, "comment_id": 92385735, "body": "@user3386109 thanks for your input! I was able to figure out how to split each different word in the string.Now i just have to figure out how to store each of them in the struct...."}], "owner": {"reputation": 43, "user_id": 10435797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eee92c46fac16820bb955cabd8ff3dc?s=128&d=identicon&r=PG&f=1", "display_name": "vipawahel", "link": "https://stackoverflow.com/users/10435797/vipawahel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539119936, "creation_date": 1539119936, "question_id": 52729480, "link": "https://stackoverflow.com/questions/52729480/how-to-store-an-array-of-strings-from-a-file-input-into-a-struct-element-in-c", "title": "How to store an array of strings from a file input into a struct element in C?", "body": "<p>So I have this text file (cartCoords.txt):</p>\n\n<pre><code>a = 2b, 1d; milk cheese eggs\nb = 2a, 1e, 2c;\nc = 2b, 1f;\nd = 1a, 1g;\ne = 1h, 1b;\nf = 1i, 1c;\ng = 1j, 1d;\nh = 1k, 1e;\ni = 1l, 1f;\nj = 1m, 1g;\nk = 1n, 1h;\nl = 1o, 1i;\nm = 2n, 1j;\nn = 2m, 1k, 2o;\no = S, 2n, 1l;\n</code></pre>\n\n<p>These represent my version of a map layout. Point \"a\" is 2 units away from \"b\" and 1 unit away from \"d\" and at point a, we have the items \"milk\", \"cheese\", and \"eggs\". </p>\n\n<p>I've constructed a struct:</p>\n\n<pre><code>struct stopPoints {\n   char **items;\n   char connectingPoints[10];\n   int  weights[10];\n   int startBool;\n};\n</code></pre>\n\n<p>So each \"stop point\" (a,b,c...etc) contains a list of items (milk, cheese, etc), a list of connected points (the b and d in 2b and 1d), the \"weight\" of each corresponding connecting point (the 2 and 1 in 2b and 1d), and a boolean value representing if it's a start point or not (indicated by an \"S).</p>\n\n<p>I've been able to store each connecting point and it's weight into each point's struct, but I'm having trouble storing each individual string of items into an array. What I want to do is for each struct to have an array that stores each item in each index, like this: </p>\n\n<pre><code>[\"milk\", \"cheese\", \"eggs\"]\n</code></pre>\n\n<p>How would I go about doing this?</p>\n\n<pre><code>Below is my code:\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define N 10\n\nstruct stopPoints {\n   char **theItem;\n   char connectingPoints[10];\n   int  weights[10];\n   int startBool;\n};\n\n\nstruct stopPoints makeStruct(char* str)\n{\n    char items[10];\n    int i,j=0,k=0, l=0, semiCheck =0, a;\n    struct stopPoints point;\n\n    for(i=4; i&lt;strlen(str); i++)\n    {\n        //check if its a starting point\n        if(i==4 &amp;&amp; str[i] == 'S')\n        {\n            point.startBool = 1;\n            i+=3;\n        }\n        else if(i==4)\n        {\n            point.startBool = 0;\n        }\n\n        //if there's no semicolon present, proceed with the code\n       if (semiCheck == 0) {\n            //checks if its a number\n            if(str[i] &lt; 58 &amp;&amp; str[i] &gt; 47){\n                point.weights[j] = str[i];\n                j++;\n            }\n            //checks if its a letter\n            else if(str[i] &lt; 122 &amp;&amp; str[i] &gt; 96){\n                point.connectingPoints[k] = str[i];\n                k++;\n            }\n\n            else if (str[i] == 59){\n                semiCheck = 1;\n                i++;\n                }\n            }\n        else if(semiCheck==1){\n             for (a=1; a&lt;(strlen(str)-i); a++){\n                if (str[i+a] != 32){\n                    items[a-1] = str[i+a];\n                }\n        }\n\n       }\n\n    }\n    return point;\n}\n\nint main(){\n    int selections[100];\n    int numOfItems,x,y,j,z,temp;\n    int i = 0;\n    struct stopPoints store[26];\n\n    FILE *fp;\n    char str[60];\n\n    /* opening file for reading */\n    fp = fopen(\"cartCoords.txt\" , \"r\");\n    if(fp == NULL) {\n      perror(\"Error opening file\");\n      return(-1);\n    }\n\n    while( fgets (str, 600, fp)!= NULL ) {\n      /* writing content to stdout */\n      //printf(\"test1\");\n      store[i] = makeStruct(str);\n      i++;\n      printf(\"store[%d] connecting points = %c and %c and %c\\n\", i-1, store[i-1].connectingPoints[0], store[i-1].connectingPoints[1], store[i-1].connectingPoints[2]);\n    }\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>The output of this program is:</p>\n\n<pre><code>store[0] connecting points = b and d and\nstore[1] connecting points = a and e and c\nstore[2] connecting points = b and f and\nstore[3] connecting points = a and g and\nstore[4] connecting points = h and b and\nstore[5] connecting points = i and c and\nstore[6] connecting points = j and d and\nstore[7] connecting points = k and e and\nstore[8] connecting points = l and f and\nstore[9] connecting points = m and g and\nstore[10] connecting points = n and h and\nstore[11] connecting points = o and i and\nstore[12] connecting points = n and j and\nstore[13] connecting points = m and k and o\nstore[14] connecting points = n and l and\n</code></pre>\n\n<p>So I've been able to properly store the letters and numbers. I just don't know how to take a complete string and store it into an array. My approach was to have my loop check for a semicolon (using its ascii value) and once a semicolon is detected, it would start gathering each separate string. The only problem is is that I have no idea how to implement that.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1539119441, "post_id": 52729371, "comment_id": 92383893, "body": "What is wrong with your code?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1539119483, "post_id": 52729371, "comment_id": 92383917, "body": "you are missing the + character"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1539119554, "post_id": 52729371, "comment_id": 92383942, "body": "i love the &#39;i am not allowed to use the if statement&#39;. Another assignment with &#39;clever&#39; rules"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1539119596, "post_id": 52729371, "comment_id": 92383959, "body": "Number sign is <code>#</code>."}, {"owner": {"reputation": 51, "user_id": 7106822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cf8e5746351193dd791d5da4d6477d9b?s=128&d=identicon&r=PG&f=1", "display_name": "RPAnimation", "link": "https://stackoverflow.com/users/7106822/rpanimation"}, "edited": false, "score": 0, "creation_date": 1539119615, "post_id": 52729371, "comment_id": 92383965, "body": "2nd value can be either +/-, the thing is that I need to put &quot;i&quot; right after the sign."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539119634, "post_id": 52729371, "comment_id": 92383973, "body": "to clarify Eugene comment. What you have should work (apart from +). So what is your problem? Does it not compile? run? give the wrong result?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1539119639, "post_id": 52729371, "comment_id": 92383977, "body": "Sounds like you need to use a ternary expression."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1539119701, "post_id": 52729371, "comment_id": 92383997, "body": "perhaps this question and the answers would help: <a href=\"https://stackoverflow.com/q/4099433/1212725\">stackoverflow.com/q/4099433/1212725</a>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539119729, "post_id": 52729371, "comment_id": 92384007, "body": "so your actual question is &quot;how can I put a + or - depending on the value of z.im?&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1539119734, "post_id": 52729371, "comment_id": 92384011, "body": "Isn&#39;t it more usual to place the <i><code>i</code></i> on the right with an imaginary number, like <code>9999.999 + 9999.999i</code>?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539119817, "post_id": 52729371, "comment_id": 92384039, "body": "@WeatherVane yes but then this would be too easy, just add &#39;i&#39; after the number. Here we need the sign character then &#39;i&#39; then the abs value of z.im"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1539119965, "post_id": 52729371, "comment_id": 92384091, "body": "I think you&#39;re saying that the <code>+</code> or <code>-</code> corresponds to the sign of <code>z.im</code>, but you didn&#39;t actually say so. Can you update your question to clarify that point?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1539120103, "post_id": 52729371, "comment_id": 92384140, "body": "You mention in a comment that you&#39;re not allowed to use the <code>?:</code> operator. Please update your question to say that as well."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1539120368, "post_id": 52729371, "comment_id": 92384236, "body": "@pm100 still need to force a sign for the imaginary part, like format <code>&quot;%+f&quot;</code>."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1539120400, "post_id": 52729371, "comment_id": 92384249, "body": "can&#39;t you just do this? <code>printf(&quot;%f%+fi\\n&quot;, z.re, z.im);</code>, and let the format specifier choose the correct sign for you?"}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539119912, "post_id": 52729440, "comment_id": 92384072, "body": "yup, the &#39;if&#39; rule was clearly intended to force use of ternary. Now I wonder if its doable without ternary or if - intersting challenge"}, {"owner": {"reputation": 51, "user_id": 7106822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cf8e5746351193dd791d5da4d6477d9b?s=128&d=identicon&r=PG&f=1", "display_name": "RPAnimation", "link": "https://stackoverflow.com/users/7106822/rpanimation"}, "edited": false, "score": 0, "creation_date": 1539119980, "post_id": 52729440, "comment_id": 92384096, "body": "The thing is, that&#39;s not allowed either... I just didn&#39;t know how it was called."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1539120034, "post_id": 52729440, "comment_id": 92384115, "body": "ternary not allowed either?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1539120083, "post_id": 52729440, "comment_id": 92384134, "body": "@pm100 No problem: printf(&quot;...&quot;, z.re, &#39;-&#39;-(z.im &gt;= 0)*2, fabs(z.im));"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 51, "user_id": 7106822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cf8e5746351193dd791d5da4d6477d9b?s=128&d=identicon&r=PG&f=1", "display_name": "RPAnimation", "link": "https://stackoverflow.com/users/7106822/rpanimation"}, "edited": false, "score": 0, "creation_date": 1539120124, "post_id": 52729440, "comment_id": 92384148, "body": "@RPAnimation Is this exercise associated with a lesson on a particular topic? What is the topic?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1539120126, "post_id": 52729440, "comment_id": 92384149, "body": "@Ctx I would bet the instructor would forbid it as well if could think about it :)"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1539120243, "post_id": 52729440, "comment_id": 92384190, "body": "if you use the <code>%+f</code> format specifier, it will choose the correct sign for you"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1539120441, "post_id": 52729440, "comment_id": 92384259, "body": "@bruceg Yes, but it puts it after the <code>i</code>, not before."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1539120554, "post_id": 52729440, "comment_id": 92384291, "body": "I would be willing to bet that the OP is confused about where the <code>i</code> is supposed to go."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1539120755, "post_id": 52729440, "comment_id": 92384372, "body": "@bruceg Possibly. Complex numbers are normally <code>&lt;realpart&gt;(+-)&lt;imaginarypart&gt;i</code>"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1539120421, "last_edit_date": 1539120421, "creation_date": 1539119760, "answer_id": 52729440, "question_id": 52729371, "link": "https://stackoverflow.com/questions/52729371/how-to-insert-character-in-between-value-using-printf/52729440#52729440", "title": "How to insert character in-between value using printf?", "body": "<p>Use a conditional (aka \"ternary\") expression to print <code>+</code> or <code>-</code> depending on the sign of the imaginary part. Then print the absolute value of the imaginary part.</p>\n\n<pre><code>void show(struct z z) {\n    printf(\"%.3f%ci%.3f\", z.re, (z.im &gt;= 0 ? '+' : '-'), fabs(z.im));\n}\n</code></pre>\n\n<p>If you can't use a ternary, either, you can format the number with a forced sign into a string, then swap the <code>i</code> and sign in the result.</p>\n\n<pre><code>void show(struct z z) {\n    char result[100];\n    sprintf(result, \"%.3fi%+.3f\", z.re, z.im);\n    int iloc = strchr(result, 'i');\n    result[iloc] = result[iloc+1];\n    result[iloc+1] = 'i';\n    printf(\"%s\", result);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1539120567, "post_id": 52729509, "comment_id": 92384296, "body": "Nice solution, but I somehow doubt the instructor have meant this."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1539120882, "post_id": 52729509, "comment_id": 92384416, "body": "@EugeneSh. Well if is banned, ternary is banned, this is a &#39;clever &#39; trick so maybe it is OK. Who knows"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 2, "last_activity_date": 1539120106, "creation_date": 1539120106, "answer_id": 52729509, "question_id": 52729371, "link": "https://stackoverflow.com/questions/52729371/how-to-insert-character-in-between-value-using-printf/52729509#52729509", "title": "How to insert character in-between value using printf?", "body": "<p>without if or ternary</p>\n\n<pre><code>void show(struct z z) {\n    printf(\"%.3f%ci%.3f\", z.re, \"+-\"[z.im&lt;0], fabs(z.im));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1539125732, "last_edit_date": 1539125732, "creation_date": 1539125426, "answer_id": 52730336, "question_id": 52729371, "link": "https://stackoverflow.com/questions/52729371/how-to-insert-character-in-between-value-using-printf/52730336#52730336", "title": "How to insert character in-between value using printf?", "body": "<p>To properly handle <code>-0.0</code> and <code>NAN</code>, extract the sign with <code>signbit()</code> and use the string trick as in <a href=\"https://stackoverflow.com/a/52729509/2410359\">@pm100</a>.</p>\n\n<blockquote>\n  <p>The <code>signbit</code> macro determines whether the sign of its argument value is negative. (footnote)<br>\n  The <code>signbit</code> macro returns a nonzero value if and only if the sign of its argument value\n  is negative.<br>\n  The <code>signbit</code> macro reports the sign of all values, including infinities, zeros, and NaNs.</p>\n</blockquote>\n\n<pre><code>#include &lt;math.h&gt;\n\n// 9999.999(+/-)i9999.999\nprintf(\"%.3f%ci%.3f\", z.re, \"-+\"[!signbit(z.im)], fabs(z.im));\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7106822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cf8e5746351193dd791d5da4d6477d9b?s=128&d=identicon&r=PG&f=1", "display_name": "RPAnimation", "link": "https://stackoverflow.com/users/7106822/rpanimation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 52729509, "answer_count": 3, "score": -1, "last_activity_date": 1539125732, "creation_date": 1539119400, "last_edit_date": 1539120760, "question_id": 52729371, "link": "https://stackoverflow.com/questions/52729371/how-to-insert-character-in-between-value-using-printf", "title": "How to insert character in-between value using printf?", "body": "<p>I have a problem. I need to insert a specific char (number sign) into my output value. I am not allowed to use if statement and \"? :\" statement. My output needs to look like this:</p>\n\n<pre><code>9999.999(+/-)i9999.999\n</code></pre>\n\n<p>Where character \"i\" needs to go right after the 2nd number sign. Here is my code so far: </p>\n\n<pre><code>void show(struct z z) {\n    printf(\"%.3fi%.3f\", z.re, z.im);\n}\n</code></pre>\n"}, {"tags": ["c", "search", "directory"], "comments": [{"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 1, "creation_date": 1539117999, "post_id": 52729027, "comment_id": 92383264, "body": "I might be wrong, but to me, you&#39;re comparing <code>&quot;.TXT&quot;</code> against <code>&quot;.txt&quot;</code>"}, {"owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "reply_to_user": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1539118235, "post_id": 52729027, "comment_id": 92383376, "body": "It can&#39;t be because I&#39;m sure that strncmp could have taken into consideration say &quot;.Txt&quot; or &quot;.tXT&quot;, etc."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539119215, "post_id": 52729027, "comment_id": 92383804, "body": "I don&#39;t know the function <code>strup</code> but would a function <code>strdn</code> be better to compare with <code>&quot;.txt&quot;</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539122675, "post_id": 52729027, "comment_id": 92385023, "body": "Note: <code>int len = strlen(buff) - 1; ... strup(buff,len) + len - 4</code> is subject exploits and problems when <code>strlen(buff)</code> is less than 4.  Better to test the length."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539122942, "post_id": 52729027, "comment_id": 92385115, "body": "&quot;&#39; sure that strncmp could have taken into consideration say &quot;.Txt&quot; or &quot;.tXT&quot;&quot; --&gt; this is very doubtful.  Try <code>&quot;.TXT&quot;</code> and see what happens."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539123099, "post_id": 52729027, "comment_id": 92385161, "body": "Note that the filenames include a <code>&#39;\\n&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "edited": false, "score": 0, "creation_date": 1539118942, "post_id": 52729141, "comment_id": 92383681, "body": "I tried yours, it does actual run now, but I feel like the condition isn&#39;t working since now it says &quot;0 files&quot;, which I know is not true since I have quiet a couple .txt files in my directory. <i>UPDATE</i> Nvm, I added a int len = strlen(buff) -1; and that fixed it."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1539118275, "creation_date": 1539118275, "answer_id": 52729141, "question_id": 52729027, "link": "https://stackoverflow.com/questions/52729027/how-do-design-a-if-statement-for-a-condition-to-only-print-out-a-specific-type-o/52729141#52729141", "title": "How do design a IF statement for a condition to only print out a specific type of file from my directory? (Explained more in body)", "body": "<p>You're not starting at the correct offset of the string.  You want to check the last 4 characters, so start at offset <code>strlen(buf) - 4</code>.</p>\n\n<pre><code>int len = strlen(buff);\nif (strncmp(buff + len - 4, \".txt\", 4) == 0) {\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10470086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ABpfO8koRkA/AAAAAAAAAAI/AAAAAAAAAMQ/0Glud0tdsKM/photo.jpg?sz=128", "display_name": "Li Wang", "link": "https://stackoverflow.com/users/10470086/li-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1539118275, "creation_date": 1539117775, "question_id": 52729027, "link": "https://stackoverflow.com/questions/52729027/how-do-design-a-if-statement-for-a-condition-to-only-print-out-a-specific-type-o", "title": "How do design a IF statement for a condition to only print out a specific type of file from my directory? (Explained more in body)", "body": "<p>As of currently if you remove the IF statement <code>if(strncmp(strup(buff,len) + len - 4, \".txt\", 4) == 0)</code> the code will print out all the files in my current directory and the directories inside the current directory etc. However I want to design a IF statement such that I would only print out the files that i choose, in the below example I attempted to have it only print out \".txt\" but that being said I can't seem to figure out how to properly design my condition statement. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n\n#define sizeFileName 500\n#define filesMax 5000\n\nint main( int argc, char ** argv) {\n  FILE * fp = popen( \"find . -type f\", \"r\");\n  char buff[sizeFilesName];\n  int nFiles = 0;\n  char * files[filesMax];\n  while(fgets(buff,sizeFileName,fp)) {\n    int len = strlen(buff) - 1;\n    if(strncmp(strup(buff,len) + len - 4, \".txt\", 4) == 0){\n    files[nFiles] = strndup(buff,len);\n    printf(\"\\t%s\\n\", files[nFiles]);\n    nFiles ++;\n    }\n  }\n  fclose(fp);\n  printf(\"Found %d files:\\n\", nFiles);\n  // clean up\n  for(int i = 0; i &lt; nFiles ; i ++ ) {\n    free(files[i]);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>SIDENOTE: Basically my idea is that I believe some char is holding a large path name say \"folder/folder/folder/file.txt\" and basically if I could to a comparison between the files \".txt\" and \".txt\" then therefore it would be accepted and printed into the console. </p>\n"}, {"tags": ["c", "file", "scanf", "stdio"], "comments": [{"owner": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 0, "creation_date": 1539117451, "post_id": 52728913, "comment_id": 92383053, "body": "I think <code>fscanf(&quot;%s%[\\n]+&quot;, &amp;word)</code> works.  Not sure, it&#39;s been a while."}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "reply_to_user": {"reputation": 2279, "user_id": 1370785, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/oASta.jpg?s=128&g=1", "display_name": "jiveturkey", "link": "https://stackoverflow.com/users/1370785/jiveturkey"}, "edited": false, "score": 0, "creation_date": 1539117493, "post_id": 52728913, "comment_id": 92383072, "body": "That&#39;s exactly what I tried and it didn&#39;t work. Thanks for commenting, I&#39;ll edit my question."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1539117691, "post_id": 52728913, "comment_id": 92383140, "body": "Skip whitespace before the word, not after. <code>fscanf(fp, &quot; %s&quot;, buf);</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1539117705, "post_id": 52728913, "comment_id": 92383147, "body": "<code>%s</code> implicitly skips leading whitespace."}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1539117855, "post_id": 52728913, "comment_id": 92383212, "body": "@melpomene Thank you. I&#39;ll fix it now."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539117991, "post_id": 52728913, "comment_id": 92383260, "body": "Curious to know <i>why</i> you want to include a newline in the input, when it is more common to filter it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539118317, "post_id": 52728913, "comment_id": 92383404, "body": "Do you need to be able to read a line that is only <code>&quot;\\n&quot;</code>?"}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1539118487, "post_id": 52728913, "comment_id": 92383484, "body": "@chux Nope. I need to read the last word of each line as &quot;test\\n&quot;."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1539118752, "post_id": 52728913, "comment_id": 92383604, "body": "Is this homework?"}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1539118825, "post_id": 52728913, "comment_id": 92383633, "body": "@melpomene It&#39;s part of a program I&#39;m writing for university. I just need to figure out this problem and I can finally call it a day."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1539118922, "post_id": 52728913, "comment_id": 92383671, "body": "Suppose the last line does not <i>have</i> a <code>&#39;\\n&#39;</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1539118949, "post_id": 52728913, "comment_id": 92383686, "body": "Sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1539119648, "post_id": 52728913, "comment_id": 92383981, "body": "What is the maximum word length, including ones that might end with <code>&#39;\\n&#39;</code>?"}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1539119717, "post_id": 52728913, "comment_id": 92384004, "body": "@chux 200 characters"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1539118116, "post_id": 52729036, "comment_id": 92383315, "body": "Note:: <code>&quot; &quot; </code> not needed in <code>&quot; %99s%*1[\\n]&quot;</code>.  Further this will block until a non-white-space is entered."}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "edited": false, "score": 0, "creation_date": 1539118375, "post_id": 52729036, "comment_id": 92383431, "body": "I&#39;ve tried your code and got the same problem. I should get something like &quot;test\\n&quot; as the last word of a line, but I only get &quot;test&quot;."}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "edited": false, "score": 0, "creation_date": 1539118753, "post_id": 52729036, "comment_id": 92383605, "body": "I&#39;m sorry to bother you, but I have to read multiple lines and I don&#39;t exactly know when to add &#39;\\n&#39;, so that&#39;s why I need fscanf() to do it for me."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "edited": false, "score": 0, "creation_date": 1539118785, "post_id": 52729036, "comment_id": 92383615, "body": "@user10480767: the code above will include the newline only if present just after the word. It will ignore and whitespace before the word, you can call it in a loop but other newlines will be ignored."}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "edited": false, "score": 0, "creation_date": 1539119513, "post_id": 52729036, "comment_id": 92383927, "body": "Maybe it&#39;s just me but it doesn&#39;t wanna work. I&#39;ve also tried debugging and it doesn&#39;t even read the &#39;\\n&#39;. What am I missing? I&#39;ve copied your entire code D:"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "edited": false, "score": 0, "creation_date": 1539119832, "post_id": 52729036, "comment_id": 92384048, "body": "@user10480767 Its just you :p. The <code>FILE*</code> parameter to <code>fscanf()</code> is missing from the examples. You&#39;ll have to run the code in a loop to read the entire file."}, {"owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "edited": false, "score": 0, "creation_date": 1539120072, "post_id": 52729036, "comment_id": 92384126, "body": "Ok, I&#39;ve adjusted my code and now it seems to work really well! Thank you!"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 2, "last_activity_date": 1539119839, "last_edit_date": 1539119839, "creation_date": 1539117810, "answer_id": 52729036, "question_id": 52728913, "link": "https://stackoverflow.com/questions/52728913/include-newline-character-when-reading-with-fscanf/52729036#52729036", "title": "Include newline character when reading with fscanf", "body": "<p>You can consume and ignore a single newline character with this conversion format: <code>%*1[\\n]</code>. It consumes at most one newline and discards it. Note that if you have multiple consecutive newlines, only the first one will be skipped. Note too that <code>fscanf()</code> will read an extra byte to verify whether it matches or not. This byte will be pushed back into the stream with <code>ungetc()</code> if it does not match.</p>\n\n<p>If you used <code>%*[\\n]</code>, <code>fscanf</code> would keep reading the stream until it gets a byte different from newline or reaches the end of file, which would cause surprising behavior when handling interactive input from the terminal.</p>\n\n<p>Your code <code>fscanf(fp, \"%s[\\n]\", buf);</code> causes undefined behavior because you do not provide a destination array for the newline characters. Furthermore, it has another flaw because you do not specify the maximum number of bytes to store into <code>buf</code>, causing undefined behavior on input with long words.</p>\n\n<p>Try this:</p>\n\n<pre><code>    char buf[100];\n    if (fscanf(\" %99s%*1[\\n]\", buf) == 1) {\n        printf(\"read a word: |%s|\\n\", buf);\n    } else {\n        printf(\"no more words\\n\");\n    }\n</code></pre>\n\n<p>If you want to include the newline in the buffer, you will need to store it into a variable and add it by hand:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    for (;;) {\n        char buf[100];\n        char nl[2] = \"\";\n        int n = fscanf(stdin, \" %98s%1[\\n]\", buf, nl);\n        if (n &gt; 0) {\n            strcat(buf, nl);\n            printf(\"read a word: |%s|\\n\", buf);\n        } else {\n            printf(\"no more words\\n\");\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>Hello word\n  I     am   ready    \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>read a word: |Hello|\nread a word: |word\n|\nread a word: |I|\nread a word: |am|\nread a word: |ready|\nno more words\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10480767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9024daf07691e8bf793bc3661c8a2dc9?s=128&d=identicon&r=PG", "display_name": "user10480767", "link": "https://stackoverflow.com/users/10480767/user10480767"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1431, "favorite_count": 0, "accepted_answer_id": 52729036, "answer_count": 1, "score": 1, "last_activity_date": 1539119839, "creation_date": 1539117233, "last_edit_date": 1539117880, "question_id": 52728913, "link": "https://stackoverflow.com/questions/52728913/include-newline-character-when-reading-with-fscanf", "title": "Include newline character when reading with fscanf", "body": "<p>How can I read a(n optional) newline character when reading a file word by word using <code>fscanf()</code>?</p>\n\n<p>I know I could use <code>fgets()</code> + <code>strtok()</code>, but my program specifically requires <code>fscanf()</code>.</p>\n\n<p>I've tried the following:</p>\n\n<pre><code>fscanf(fp, \"%s%[\\n]+\", buf);\n</code></pre>\n\n<p>But it doesn't work whatsoever.</p>\n"}, {"tags": ["c", "parallel-processing", "opencl", "gpgpu"], "comments": [{"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1539217979, "post_id": 52728702, "comment_id": 92425319, "body": "You can have overlapped (since you cant know which workitem can find it) searching per item and reduce their results in local memory then reduce local results in global memory. Let item-0 search 0 - 110 while item-1 doing 90 - 210 and item-2 doing 190-310 if word is 20 chars. Also loading memory into local memory before this, can be useful for random accessing."}, {"owner": {"reputation": 121, "user_id": 10458110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f40c72839e8d9b78271651cef43cda?s=128&d=identicon&r=PG&f=1", "display_name": "Helton F&#225;bio", "link": "https://stackoverflow.com/users/10458110/helton-f%c3%a1bio"}, "reply_to_user": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1541056478, "post_id": 52728702, "comment_id": 93089479, "body": "so, my strings&#39; length is variable, how can I do this access type?"}, {"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1541063201, "post_id": 52728702, "comment_id": 93092055, "body": "make kernel launch length variable then. I don&#39;t know maybe you use dynamic parallelism and let the gpu cores decide how far they compute?"}], "owner": {"reputation": 121, "user_id": 10458110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f40c72839e8d9b78271651cef43cda?s=128&d=identicon&r=PG&f=1", "display_name": "Helton F&#225;bio", "link": "https://stackoverflow.com/users/10458110/helton-f%c3%a1bio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1539118186, "creation_date": 1539116218, "last_edit_date": 1539118186, "question_id": 52728702, "link": "https://stackoverflow.com/questions/52728702/gpgpu-search-string-in-another-one", "title": "GPGPU search String in another one", "body": "<p>I'm looking for an algorithm to search one string in another one, but I know that strings are'nt supported in CUDA or OpenCL natively (but I saw a post which shows that OpenCL can receive a character array like the code below)</p>\n\n<pre><code>__kernel void test(__global word_t *data,  __global res_t *result)\n{\n   size_t id=get_global_id(0);\n   int size=0;\n   int size=data[id].len;\n   // local memory \"allocator\"\n   __local int offset = 0;\n   volatile __local int* pOffset = &amp;offset;\n   __local char wordBuffer[BUFFER_SIZE];\n   // \"allocate\" memory\n   int myOffset = atomic_add( pOffset, size );\n   //working with the word\n   __local char* pThreadWord = &amp;wordBuffer[ myOffset ];\n}\n</code></pre>\n\n<p>I have a lot of big and little strings and I have to search the presence (and detect the position) of these little on big strings in parallel, can anyone help me?</p>\n\n<p>ps: this code was found at: <a href=\"https://stackoverflow.com/questions/26492263/using-string-in-opencl-kernel\">Using &quot;String&quot; in openCl Kernel</a></p>\n"}]